<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1686387663657" as="style"/><link rel="stylesheet" href="styles.css?v=1686387663657"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://matklad.github.io/2023/05/06/zig-language-server-and-cancellation.html">Zig Language Server and Cancellation</a>Â <span class="domain">(<a href="https://matklad.github.io">matklad.github.io</a>)</span></div><div class="subtext"><span>goranmoomin</span> | <span>10 comments</span></div><br/><div><div id="36268753" class="c"><input type="checkbox" id="c-36268753" checked=""/><div class="controls bullet"><span class="by">ninepoints</span><span>|</span><a href="#36268517">next</a><span>|</span><label class="collapse" for="c-36268753">[-]</label><label class="expand" for="c-36268753">[1 more]</label></div><br/><div class="children"><div class="content">As someone actually working on some symbol indexing stuff at the moment, I can mention that this model is ignoring some pretty important details, and I think there&#x27;s some classic overengineering happening here (easy trap to fall into when you&#x27;re still in the design space).<p>Generally, when you need a code completion action, it&#x27;s expected that you have an AST (post semantic analysis). This AST is still very useful even after a user continues to edit the code! Outside of where the cursor is, most of the symbols, definitions, and declarations are relevant, and source locations can be easily translated from a previous version of the document, provided that deltas are tracked. Cancelling an existing translation unit parse on edit is wasteful, because the majority of the time, that parse will produce meaningful results. The better approach (IMO) is to let the parse finish, but immediately enqueue a subsequent parse (with some debouncing timer to avoid overly consuming user resources). If you wanted to level this up further, you could perform incremental parsing&#x2F;analysis, provided your language supports it. In the presence of a preprocessor, this can be very difficult, but it&#x27;s the next &quot;upgrade&quot; from the previous approach mentioned in my opinion.</div><br/></div></div><div id="36268517" class="c"><input type="checkbox" id="c-36268517" checked=""/><div class="controls bullet"><span class="by">riwsky</span><span>|</span><a href="#36268753">prev</a><span>|</span><a href="#36268792">next</a><span>|</span><label class="collapse" for="c-36268517">[-]</label><label class="expand" for="c-36268517">[5 more]</label></div><br/><div class="children"><div class="content">&gt; We divide the available memory in two equal parts, use one half as a working copy which accumulates useful objects and garbage, and then at some point switch the halves, copying the live objects (but not the garbage) over<p>So, generational garbage collection?</div><br/><div id="36268577" class="c"><input type="checkbox" id="c-36268577" checked=""/><div class="controls bullet"><span class="by">spullara</span><span>|</span><a href="#36268517">parent</a><span>|</span><a href="#36268806">next</a><span>|</span><label class="collapse" for="c-36268577">[-]</label><label class="expand" for="c-36268577">[2 more]</label></div><br/><div class="children"><div class="content">Nah, just a copying gc:<p><a href="http:&#x2F;&#x2F;www.cs.cornell.edu&#x2F;courses&#x2F;cs312&#x2F;2003fa&#x2F;lectures&#x2F;sec24.htm" rel="nofollow">http:&#x2F;&#x2F;www.cs.cornell.edu&#x2F;courses&#x2F;cs312&#x2F;2003fa&#x2F;lectures&#x2F;sec2...</a><p>Generational has more heaps where objects are promoted between them when they last longer.</div><br/><div id="36268831" class="c"><input type="checkbox" id="c-36268831" checked=""/><div class="controls bullet"><span class="by">dontlaugh</span><span>|</span><a href="#36268517">root</a><span>|</span><a href="#36268577">parent</a><span>|</span><a href="#36268806">next</a><span>|</span><label class="collapse" for="c-36268831">[-]</label><label class="expand" for="c-36268831">[1 more]</label></div><br/><div class="children"><div class="content">More specifically, semi space.</div><br/></div></div></div></div><div id="36268806" class="c"><input type="checkbox" id="c-36268806" checked=""/><div class="controls bullet"><span class="by">tankenmate</span><span>|</span><a href="#36268517">parent</a><span>|</span><a href="#36268577">prev</a><span>|</span><a href="#36268581">next</a><span>|</span><label class="collapse" for="c-36268806">[-]</label><label class="expand" for="c-36268806">[1 more]</label></div><br/><div class="children"><div class="content">Think of it more like a blue &#x2F; green object store; but each switch only copies over valid objects (for some definition of valid; in use, type checked, etc).</div><br/></div></div><div id="36268581" class="c"><input type="checkbox" id="c-36268581" checked=""/><div class="controls bullet"><span class="by">esjeon</span><span>|</span><a href="#36268517">parent</a><span>|</span><a href="#36268806">prev</a><span>|</span><a href="#36268792">next</a><span>|</span><label class="collapse" for="c-36268581">[-]</label><label class="expand" for="c-36268581">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s no generation here. Just live or dead objects. It also sounds like they don&#x27;t scan the pool, and instead just deep-copy the top-level state object.</div><br/></div></div></div></div><div id="36268792" class="c"><input type="checkbox" id="c-36268792" checked=""/><div class="controls bullet"><span class="by">avgcorrection</span><span>|</span><a href="#36268517">prev</a><span>|</span><a href="#36268490">next</a><span>|</span><label class="collapse" for="c-36268792">[-]</label><label class="expand" for="c-36268792">[2 more]</label></div><br/><div class="children"><div class="content">Should a language be designed with these things in mind? Or is it completely orthogonal?</div><br/><div id="36268863" class="c"><input type="checkbox" id="c-36268863" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#36268792">parent</a><span>|</span><a href="#36268490">next</a><span>|</span><label class="collapse" for="c-36268863">[-]</label><label class="expand" for="c-36268863">[1 more]</label></div><br/><div class="children"><div class="content">Designing syntax and semantics that are easier to parse can also make the language easier to understand to humans, as long as optimizing for these goals doesn&#x27;t impede on useful language features.</div><br/></div></div></div></div><div id="36268490" class="c"><input type="checkbox" id="c-36268490" checked=""/><div class="controls bullet"><span class="by">KRAKRISMOTT</span><span>|</span><a href="#36268792">prev</a><span>|</span><label class="collapse" for="c-36268490">[-]</label><label class="expand" for="c-36268490">[1 more]</label></div><br/><div class="children"><div class="content">Can this be done on the runtime level? Zig, if I recall, supports multi-colored functions. Would it be possible to terminate an awaitable early?</div><br/></div></div></div></div></div></div></div></body></html>