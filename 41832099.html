<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728896464040" as="style"/><link rel="stylesheet" href="styles.css?v=1728896464040"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.kylemanna.com/hardware/nanopi-r5s-as-ptp-grandmaster-clock-with-gnss-gps-discipline/">FriendlyElec NanoPi R5S as PTP Grandmaster Clock with GNSS/GPS Discipline (2022)</a> <span class="domain">(<a href="https://blog.kylemanna.com">blog.kylemanna.com</a>)</span></div><div class="subtext"><span>pbrowne011</span> | <span>6 comments</span></div><br/><div><div id="41833505" class="c"><input type="checkbox" id="c-41833505" checked=""/><div class="controls bullet"><span class="by">lightswitch05</span><span>|</span><a href="#41834775">next</a><span>|</span><label class="collapse" for="c-41833505">[-]</label><label class="expand" for="c-41833505">[4 more]</label></div><br/><div class="children"><div class="content">&gt; It’s unclear to me why there’s so much delay and jitter in the PPS timestamping.<p>I’ve messed around with this on a couple different GPS chips. I’ve found improvements can be made by increasing the baud rate to the maximum supported. 9600 tends to be the default, but 57600 works a lot better. Also, disable all NMEA sentences except the one you are using. Finally ramp up the update interval to be much more often. The default tends to be every 1000 milliseconds, but 100 milliseconds works better for less jitter. I’ve been using NTPsec, not Chrony, so maybe there are more nuances.<p>Im just a hobbyist, but I have a bit more details written up here, checkout the poorly designed hamburger menu for some charts and graphs: <a href="https:&#x2F;&#x2F;www.developerdan.com&#x2F;ntp&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.developerdan.com&#x2F;ntp&#x2F;</a></div><br/><div id="41833538" class="c"><input type="checkbox" id="c-41833538" checked=""/><div class="controls bullet"><span class="by">seedless-sensat</span><span>|</span><a href="#41833505">parent</a><span>|</span><a href="#41834775">next</a><span>|</span><label class="collapse" for="c-41833538">[-]</label><label class="expand" for="c-41833538">[3 more]</label></div><br/><div class="children"><div class="content">In the article, they are using a PPS output into a GPIO IRQ. I don&#x27;t think they&#x27;re using serial&#x2F;NMEA for the timestamping</div><br/><div id="41833599" class="c"><input type="checkbox" id="c-41833599" checked=""/><div class="controls bullet"><span class="by">lightswitch05</span><span>|</span><a href="#41833505">root</a><span>|</span><a href="#41833538">parent</a><span>|</span><a href="#41834775">next</a><span>|</span><label class="collapse" for="c-41833599">[-]</label><label class="expand" for="c-41833599">[2 more]</label></div><br/><div class="children"><div class="content">I’m not familiar with Chrony. With NTPsec, the PPS driver docs say [0]:<p>&gt; While this driver can discipline the time and frequency relative to the PPS source, it cannot number the seconds. For this purpose an auxiliary source is required;<p>And so (with NTPsec), you need to define two sources even though it’s coming from the same device. One for the PPS signal for clock discipline, the other for the clock value.<p>&gt; refclock pps ppspath &#x2F;dev&#x2F;gpspps0 prefer<p>&gt; refclock nmea baud 57600 prefer<p>0: <a href="https:&#x2F;&#x2F;docs.ntpsec.org&#x2F;latest&#x2F;driver_pps.html" rel="nofollow">https:&#x2F;&#x2F;docs.ntpsec.org&#x2F;latest&#x2F;driver_pps.html</a></div><br/><div id="41835618" class="c"><input type="checkbox" id="c-41835618" checked=""/><div class="controls bullet"><span class="by">willis936</span><span>|</span><a href="#41833505">root</a><span>|</span><a href="#41833599">parent</a><span>|</span><a href="#41834775">next</a><span>|</span><label class="collapse" for="c-41835618">[-]</label><label class="expand" for="c-41835618">[1 more]</label></div><br/><div class="children"><div class="content">Sure, but that aux data should not be used for any sub-second accuracy information.  The PPS is the end-all be-all definition of the start-of-second.  Improving performance of another band should never affect the performance of the sub-second jitter.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>