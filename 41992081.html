<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730365268680" as="style"/><link rel="stylesheet" href="styles.css?v=1730365268680"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.infoq.com/presentations/1brc/">1BRC Coding Challenge: Nerd Sniping the Java Community</a> <span class="domain">(<a href="https://www.infoq.com">www.infoq.com</a>)</span></div><div class="subtext"><span>saikatsg</span> | <span>39 comments</span></div><br/><div><div id="41992966" class="c"><input type="checkbox" id="c-41992966" checked=""/><div class="controls bullet"><span class="by">gunnarmorling</span><span>|</span><a href="#41994919">next</a><span>|</span><label class="collapse" for="c-41992966">[-]</label><label class="expand" for="c-41992966">[4 more]</label></div><br/><div class="children"><div class="content">Presenter of that talk here, very cool to see it being shared here.<p>Running 1BRC was immensely fun, I learned a ton from it. Had you told me before how far the community would be able to push this, I&#x27;d have not believed you.<p>One main take-away for me was that you could improve performance by one order of magnitude over the baseline basically by just doing a good job and avoiding basic mistakes. The resulting code is still well readable and maintainable. In most scenarios, this is where you should stop.<p>If you want to improve by another order of magnitude (like leaders in the challenge did), code becomes completely non-idiomatic, super-dense, and hard to maintain. You should go there only where it really, really matters, like when building a database kernel for instance. Or well, when trying to win a coding challenge ;)<p>Some more resources for those interested:<p>* Blog post with the results: <a href="https:&#x2F;&#x2F;www.morling.dev&#x2F;blog&#x2F;1brc-results-are-in&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.morling.dev&#x2F;blog&#x2F;1brc-results-are-in&#x2F;</a><p>* Show &amp; Tell, featuring implementations in languages other than Java: <a href="https:&#x2F;&#x2F;github.com&#x2F;gunnarmorling&#x2F;1brc&#x2F;discussions&#x2F;categories&#x2F;show-and-tell">https:&#x2F;&#x2F;github.com&#x2F;gunnarmorling&#x2F;1brc&#x2F;discussions&#x2F;categories...</a><p>* List of many more blog posts discussing 1BRC in different languages: <a href="https:&#x2F;&#x2F;github.com&#x2F;gunnarmorling&#x2F;1brc?tab=readme-ov-file#1brc-on-the-web">https:&#x2F;&#x2F;github.com&#x2F;gunnarmorling&#x2F;1brc?tab=readme-ov-file#1br...</a><p>* 3h deep-dive into the implementation techniques by Thomas Würthinger and Roy van Rijn, two of the top participants of the challenge: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=_w4-BqeeC0k" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=_w4-BqeeC0k</a></div><br/><div id="41993497" class="c"><input type="checkbox" id="c-41993497" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41992966">parent</a><span>|</span><a href="#42003842">next</a><span>|</span><label class="collapse" for="c-41993497">[-]</label><label class="expand" for="c-41993497">[1 more]</label></div><br/><div class="children"><div class="content">&gt; One main take-away for me was that you could improve performance by one order of magnitude over the baseline basically by just doing a good job and avoiding basic mistakes. The resulting code is still well readable and maintainable. In most scenarios, this is where you should stop.<p>I’ve done a lot of performance work but never heard this expressed so clearly before. Thanks - I’m stealing that.<p>I’ve found exactly the same thing in my own work optimising text CRDTs. Just writing crdt code in a straightforward, correct way, without unnecessary allocations (and ideally using some good data structures) will get you very, very far. But there’s another order of magnitude available to anyone interested in using exotic, task specific data structures.<p>I suspect the same is true in just about every field of computer science. Write good code in go &#x2F; c# &#x2F; Java &#x2F; JavaScript &#x2F; etc and 99% of the time, performance will be just fine. Well, so long as you don’t do anything silly like pull in immutablejs. But there’s usually 10-100x more performance available if you really try.<p>If you want some examples, I highly recommend Algorithms for Modern Hardware, available for free online:<p><a href="https:&#x2F;&#x2F;en.algorithmica.org&#x2F;hpc&#x2F;" rel="nofollow">https:&#x2F;&#x2F;en.algorithmica.org&#x2F;hpc&#x2F;</a></div><br/></div></div><div id="42003842" class="c"><input type="checkbox" id="c-42003842" checked=""/><div class="controls bullet"><span class="by">cookiengineer</span><span>|</span><a href="#41992966">parent</a><span>|</span><a href="#41993497">prev</a><span>|</span><a href="#41993063">next</a><span>|</span><label class="collapse" for="c-42003842">[-]</label><label class="expand" for="c-42003842">[1 more]</label></div><br/><div class="children"><div class="content">This was such a great challenge to follow. I learned a ton about different programming languages, their advantages and disadvantages, their idioms and paradigms.<p>Overall this was just such a great event! Thanks for organizing it!<p>(A silent observer)</div><br/></div></div><div id="41993063" class="c"><input type="checkbox" id="c-41993063" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992966">parent</a><span>|</span><a href="#42003842">prev</a><span>|</span><a href="#41994919">next</a><span>|</span><label class="collapse" for="c-41993063">[-]</label><label class="expand" for="c-41993063">[1 more]</label></div><br/><div class="children"><div class="content">Amazing! I&#x27;ve just asked few secs ago to share more posts discussing 1BRC in different languages, and here we go. Thank you!</div><br/></div></div></div></div><div id="41994919" class="c"><input type="checkbox" id="c-41994919" checked=""/><div class="controls bullet"><span class="by">redcodenl</span><span>|</span><a href="#41992966">prev</a><span>|</span><a href="#42004611">next</a><span>|</span><label class="collapse" for="c-41994919">[-]</label><label class="expand" for="c-41994919">[1 more]</label></div><br/><div class="children"><div class="content">Roy van Rijn here, the guy that got an honerable mention for being “first”. Ended up 7th or something.<p>If you’re interested in even more in-depth tips and tricks that were used in this contest, I highly recommend this three hour (!) long deep dive I did with Thomas Wuerthinger (the winner of 1BRC):<p><a href="https:&#x2F;&#x2F;youtu.be&#x2F;_w4-BqeeC0k?si=p4NsRFPe6Jtq7HvA" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;_w4-BqeeC0k?si=p4NsRFPe6Jtq7HvA</a><p>There is so much valuable content in that talk, some things that I didn’t even realize until long after the contest was over.<p>It’s probably the best and most detailed conference talk I’ve ever done.</div><br/></div></div><div id="42004611" class="c"><input type="checkbox" id="c-42004611" checked=""/><div class="controls bullet"><span class="by">amanda99</span><span>|</span><a href="#41994919">prev</a><span>|</span><a href="#41992704">next</a><span>|</span><label class="collapse" for="c-42004611">[-]</label><label class="expand" for="c-42004611">[1 more]</label></div><br/><div class="children"><div class="content">1BRC = 1 Billion Row Challenge: &quot;Calculate the min, max, and average of 1 billion measurements&quot;</div><br/></div></div><div id="41992704" class="c"><input type="checkbox" id="c-41992704" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#42004611">prev</a><span>|</span><a href="#41992683">next</a><span>|</span><label class="collapse" for="c-41992704">[-]</label><label class="expand" for="c-41992704">[10 more]</label></div><br/><div class="children"><div class="content">As part of learning zig I did an implementation in zig. It got under 1 second within the contest rules on a 6 year old desktop machine. I need to write up a blog when I get the chance.</div><br/><div id="41992888" class="c"><input type="checkbox" id="c-41992888" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992704">parent</a><span>|</span><a href="#41992683">next</a><span>|</span><label class="collapse" for="c-41992888">[-]</label><label class="expand" for="c-41992888">[9 more]</label></div><br/><div class="children"><div class="content">please share! it&#x27;s such great challenge to map each language internals. here&#x27;s an idea how to write up <a href="https:&#x2F;&#x2F;r2p.dev&#x2F;b&#x2F;2024-03-18-1brc-go&#x2F;" rel="nofollow">https:&#x2F;&#x2F;r2p.dev&#x2F;b&#x2F;2024-03-18-1brc-go&#x2F;</a></div><br/><div id="42004569" class="c"><input type="checkbox" id="c-42004569" checked=""/><div class="controls bullet"><span class="by">JohnKemeny</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41992888">parent</a><span>|</span><a href="#41993048">next</a><span>|</span><label class="collapse" for="c-42004569">[-]</label><label class="expand" for="c-42004569">[1 more]</label></div><br/><div class="children"><div class="content">Great write-up, thanks a lot!  If I may come with a suggestion, please round all the running times to significant digits.  Reading 100s of numbers of the form 8.327305 becomes hard in the end, and I&#x27;d wager it&#x27;s actually not more accurate than saying 8.3, or even 8.  The only place where you seem to need 2 digits is when comparing the hashes,  0.07 vs 0.01.<p>Please always round to a meaningful number of significant digits.</div><br/></div></div><div id="41993048" class="c"><input type="checkbox" id="c-41993048" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41992888">parent</a><span>|</span><a href="#42004569">prev</a><span>|</span><a href="#41992683">next</a><span>|</span><label class="collapse" for="c-41993048">[-]</label><label class="expand" for="c-41993048">[7 more]</label></div><br/><div class="children"><div class="content">Besides the standard tricks to speed up the running time like threads and mmap, the biggest speed up is to use a custom hash table that is tuned for the data. I have implemented 5 different versions of hash tables including the Swiss hash table and more recent researched ones. None of them beats a simple linear probing approach. It’s because there’re so few keys, only couple hundreds of them. Tuning a custom hashing function to minimize key collision helps more than anything.<p>There are also lots of SIMD operations, which Zig has great support in the form of vector programming.<p>The only thing novel I did was to line up the temperature data from the back instead of from the front for the SIMD operations. That is for temperatures 12.3, 4.5, 67.8, 0.1, I line them up by the last digit after the decimal before packing them into a SIMD register. That way I know their exact positions in the register.</div><br/><div id="41993173" class="c"><input type="checkbox" id="c-41993173" checked=""/><div class="controls bullet"><span class="by">anonymoushn</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993048">parent</a><span>|</span><a href="#41993354">next</a><span>|</span><label class="collapse" for="c-41993173">[-]</label><label class="expand" for="c-41993173">[2 more]</label></div><br/><div class="children"><div class="content">I had similar results exploring hash tables for a nearly identical task here[0].<p>It seems like swiss tables are tuned for workloads of mostly gets of keys that are not present. Otherwise the two-level lookup is an extra cost with not much benefit.<p>IIRC Joad Nacer says he is using a hash table for this (again, essentially identical) task on highload.fun[1]. This was sort if surprising for the other competitors because the top couple solutions below that one use some variety of bloom filter instead.<p>0: <a href="https:&#x2F;&#x2F;easyperf.net&#x2F;blog&#x2F;2022&#x2F;05&#x2F;28&#x2F;Performance-analysis-and-tuning-contest-6" rel="nofollow">https:&#x2F;&#x2F;easyperf.net&#x2F;blog&#x2F;2022&#x2F;05&#x2F;28&#x2F;Performance-analysis-an...</a><p>1: <a href="https:&#x2F;&#x2F;highload.fun&#x2F;tasks&#x2F;2&#x2F;leaderboard" rel="nofollow">https:&#x2F;&#x2F;highload.fun&#x2F;tasks&#x2F;2&#x2F;leaderboard</a></div><br/><div id="41997604" class="c"><input type="checkbox" id="c-41997604" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993173">parent</a><span>|</span><a href="#41993354">next</a><span>|</span><label class="collapse" for="c-41997604">[-]</label><label class="expand" for="c-41997604">[1 more]</label></div><br/><div class="children"><div class="content">Yes. Swiss is good for non-duplicate lookups. For highly duplicate data the extra memory fetch for the metadata byte really kills the performance.<p>For this contest, there’re a billion lookups with only couple hundreds distinct keys. That means for most lookups, the full path of locating the key is executed - hashing, metadata comparison, hashed value comparison, and full key comparison. It’s actually quite expensive. Removing any part from the execution path really helps.</div><br/></div></div></div></div><div id="41993354" class="c"><input type="checkbox" id="c-41993354" checked=""/><div class="controls bullet"><span class="by">norskeld</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993048">parent</a><span>|</span><a href="#41993173">prev</a><span>|</span><a href="#41993079">next</a><span>|</span><label class="collapse" for="c-41993354">[-]</label><label class="expand" for="c-41993354">[2 more]</label></div><br/><div class="children"><div class="content">When it comes to custom hash tables, I always remember this video [0] by Strager about implementing the perfect hash table and hash function. Fascinating insights and perf hints.<p>[0]: <a href="https:&#x2F;&#x2F;youtu.be&#x2F;DMQ_HcNSOAI" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;DMQ_HcNSOAI</a></div><br/><div id="41998812" class="c"><input type="checkbox" id="c-41998812" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993354">parent</a><span>|</span><a href="#41993079">next</a><span>|</span><label class="collapse" for="c-41998812">[-]</label><label class="expand" for="c-41998812">[1 more]</label></div><br/><div class="children"><div class="content">Many videos on hash table are great.  I found this one particularly good.<p>[<a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=M2fKMP47slQ" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=M2fKMP47slQ</a>] C++Now 2018: You Can Do Better than std::unordered_map: New Improvements to Hash Table Performance</div><br/></div></div></div></div><div id="41993079" class="c"><input type="checkbox" id="c-41993079" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993048">parent</a><span>|</span><a href="#41993354">prev</a><span>|</span><a href="#41992683">next</a><span>|</span><label class="collapse" for="c-41993079">[-]</label><label class="expand" for="c-41993079">[2 more]</label></div><br/><div class="children"><div class="content">Gosh, ant thnx for sharing. Hope this would never become a mainstream during coding interview. Imaging - please list top 10 hash table implementations and its time and space complexity</div><br/><div id="41997525" class="c"><input type="checkbox" id="c-41997525" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#41992704">root</a><span>|</span><a href="#41993079">parent</a><span>|</span><a href="#41992683">next</a><span>|</span><label class="collapse" for="c-41997525">[-]</label><label class="expand" for="c-41997525">[1 more]</label></div><br/><div class="children"><div class="content">Ha. I didn’t know the detail of any of these tables beforehand. It’s just a matter of doing a bit of research. The main takeaway is there’s no perfect hash table. It all depends on the data and the operations. Contests like this are the perfect excuse to deep dive into these kinds of topic.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41992683" class="c"><input type="checkbox" id="c-41992683" checked=""/><div class="controls bullet"><span class="by">seinecle</span><span>|</span><a href="#41992704">prev</a><span>|</span><a href="#41992339">next</a><span>|</span><label class="collapse" for="c-41992683">[-]</label><label class="expand" for="c-41992683">[3 more]</label></div><br/><div class="children"><div class="content">There should be a book about Java perf &#x2F; hacks derived from this challenge. I&#x27;d buy it fore sure.</div><br/><div id="41993103" class="c"><input type="checkbox" id="c-41993103" checked=""/><div class="controls bullet"><span class="by">abhi9u</span><span>|</span><a href="#41992683">parent</a><span>|</span><a href="#41992339">next</a><span>|</span><label class="collapse" for="c-41993103">[-]</label><label class="expand" for="c-41993103">[2 more]</label></div><br/><div class="children"><div class="content">I think most of the optimizations were pretty low level and had nothing to do with Java itself. You could implement the same techniques in any other (compiled) language and get similar performance results. Things like cache locality, ILP, work stealing, multithreading, SWAR etc. In fact, the top solutions mostly used unsafe to use off-heap memory to avoid GC and copying of data.</div><br/><div id="41994326" class="c"><input type="checkbox" id="c-41994326" checked=""/><div class="controls bullet"><span class="by">papercrane</span><span>|</span><a href="#41992683">root</a><span>|</span><a href="#41993103">parent</a><span>|</span><a href="#41992339">next</a><span>|</span><label class="collapse" for="c-41994326">[-]</label><label class="expand" for="c-41994326">[1 more]</label></div><br/><div class="children"><div class="content">In this particular instance Unsafe was used to skip boundary checks. The main difference between the fastest safe version and the fastest unsafe version was how the file was read. The safe version used MappedByteBuffer to read the file, which under the hood memory maps the file and enforces boundaries. The unsafe version memory mapped the file and then read the memory directly using Unsafe.<p>The fastest version also used Graal  which would&#x27;ve helped with startup time.</div><br/></div></div></div></div></div></div><div id="41992339" class="c"><input type="checkbox" id="c-41992339" checked=""/><div class="controls bullet"><span class="by">forlornacorn</span><span>|</span><a href="#41992683">prev</a><span>|</span><a href="#41992843">next</a><span>|</span><label class="collapse" for="c-41992339">[-]</label><label class="expand" for="c-41992339">[1 more]</label></div><br/><div class="children"><div class="content">Gunnar is brilliant.</div><br/></div></div><div id="41992843" class="c"><input type="checkbox" id="c-41992843" checked=""/><div class="controls bullet"><span class="by">oneeyedpigeon</span><span>|</span><a href="#41992339">prev</a><span>|</span><a href="#41993871">next</a><span>|</span><label class="collapse" for="c-41992843">[-]</label><label class="expand" for="c-41992843">[1 more]</label></div><br/><div class="children"><div class="content">If there must be a cookie popup at all, this site is a great example of how to do it.<p>(Edit: although it kinda then spoils it with the newsletter popup)</div><br/></div></div><div id="41993871" class="c"><input type="checkbox" id="c-41993871" checked=""/><div class="controls bullet"><span class="by">akoboldfrying</span><span>|</span><a href="#41992843">prev</a><span>|</span><a href="#41997902">next</a><span>|</span><label class="collapse" for="c-41993871">[-]</label><label class="expand" for="c-41993871">[2 more]</label></div><br/><div class="children"><div class="content">Nice write-up! (I read the transcript.)<p>Maybe this is covered in the actual video, but one potential target for optimisation that I didn&#x27;t see in the transcript was how the temperature values are converted to integers.<p>One suggestion is that, after deleting the period, if the numbers have at most 4 digits and 64-bit multiplication is available, the conversion to an integer can be done with a single such multiplication and a few shifts. Ensure each digit is in the low byte of a separate 16-bit word (that is, &quot;space them out&quot; with a zero byte in between each digit; this may require extra work, though there&#x27;s often a SIMD &quot;scatter&quot;-type instruction that will accomplish it), subtract the ASCII value of the &quot;0&quot; digit from each 16-bit word&#x27;s low byte (one instruction), then multiply by a constant which has 1000 in its lowest 16-bit word, 100 in the next-lowest, ..., 1 in the highest. The final answer will now be in the highest word, available with a 48-bit right shift.<p>If multiplication is slow, another trick to gain some speed is to <i>not actually convert from decimal until you need to</i>, possibly right at the end. That is, just subtract the ASCII value of the &quot;0&quot; digit from each 16-bit word&#x27;s low byte, and then treat the resulting 64-bit value as a very wasteful BCD representation in which each decimal digit occupies 16 bits. These &quot;integers&quot; can be safely added to each other up to 65535&#x2F;9=7281 times before there is a risk of overflow; you only need to convert to regular binary then. This representation also honours min and max operations.</div><br/><div id="41994858" class="c"><input type="checkbox" id="c-41994858" checked=""/><div class="controls bullet"><span class="by">gunnarmorling</span><span>|</span><a href="#41993871">parent</a><span>|</span><a href="#41997902">next</a><span>|</span><label class="collapse" for="c-41994858">[-]</label><label class="expand" for="c-41994858">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for sharing!<p>I don&#x27;t think people did exactly that, but most indeed did leverage the fact that values only ranged from -99.9 to 99.9 with exactly one fractional digit and handled them as integers (avoiding FP maths) up until the very end when printing out the results.</div><br/></div></div></div></div><div id="41997902" class="c"><input type="checkbox" id="c-41997902" checked=""/><div class="controls bullet"><span class="by">pytness</span><span>|</span><a href="#41993871">prev</a><span>|</span><a href="#41992873">next</a><span>|</span><label class="collapse" for="c-41997902">[-]</label><label class="expand" for="c-41997902">[1 more]</label></div><br/><div class="children"><div class="content">Obligatory xkcd: <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;356&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;356&#x2F;</a></div><br/></div></div><div id="41992873" class="c"><input type="checkbox" id="c-41992873" checked=""/><div class="controls bullet"><span class="by">baq</span><span>|</span><a href="#41997902">prev</a><span>|</span><a href="#41992849">next</a><span>|</span><label class="collapse" for="c-41992873">[-]</label><label class="expand" for="c-41992873">[9 more]</label></div><br/><div class="children"><div class="content">The main takeaway is that 1 billion rows is just not that much nowadays.<p>A corollary is &#x27;postgres is really all you need&#x27; unless you have <i>irrefutable</i> proof it isn&#x27;t.</div><br/><div id="41993117" class="c"><input type="checkbox" id="c-41993117" checked=""/><div class="controls bullet"><span class="by">silvestrov</span><span>|</span><a href="#41992873">parent</a><span>|</span><a href="#41993051">next</a><span>|</span><label class="collapse" for="c-41993117">[-]</label><label class="expand" for="c-41993117">[1 more]</label></div><br/><div class="children"><div class="content">Most people seriously underestimate how much power there is in a modern Intel&#x2F;ARM server.<p>Many businesses think &quot;we have <i>a lot</i> of products&quot;.  Nope, even when you have more than a million products we can load all of them into RAM, even with  4 KB of memory  allocate to each product.<p>So a million products is small business from a &quot;load into RAM&quot; perspective. Easily handled on a single server.</div><br/></div></div><div id="41993051" class="c"><input type="checkbox" id="c-41993051" checked=""/><div class="controls bullet"><span class="by">pkolaczk</span><span>|</span><a href="#41992873">parent</a><span>|</span><a href="#41993117">prev</a><span>|</span><a href="#41993290">next</a><span>|</span><label class="collapse" for="c-41993051">[-]</label><label class="expand" for="c-41993051">[3 more]</label></div><br/><div class="children"><div class="content">Modern hardware has really impressive speed. A single core of my not-so-new M2 laptop can decompress data at more than 4 GB&#x2F;s using lz4. Sometimes I wonder where all that performance goes, eg when waiting for Slack to open ;)</div><br/><div id="41993116" class="c"><input type="checkbox" id="c-41993116" checked=""/><div class="controls bullet"><span class="by">bobnamob</span><span>|</span><a href="#41992873">root</a><span>|</span><a href="#41993051">parent</a><span>|</span><a href="#41993290">next</a><span>|</span><label class="collapse" for="c-41993116">[-]</label><label class="expand" for="c-41993116">[2 more]</label></div><br/><div class="children"><div class="content">&gt;  eg when waiting for Slack to open ;)<p>Run a Wireshark capture while opening slack, those ~30ms round trips add up</div><br/><div id="41998138" class="c"><input type="checkbox" id="c-41998138" checked=""/><div class="controls bullet"><span class="by">mrguyorama</span><span>|</span><a href="#41992873">root</a><span>|</span><a href="#41993116">parent</a><span>|</span><a href="#41993290">next</a><span>|</span><label class="collapse" for="c-41998138">[-]</label><label class="expand" for="c-41998138">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m so tired of every single app requiring a hundred minuscule file system ops and another hundred full round trip web requests to do anything. How do you even write code that badly? Meanwhile I&#x27;m over here trying to make sure we won&#x27;t get screwed when my linear loop has to iterate over 100 million items somehow. Oh, that only takes 50ms?<p>How do you write code this badly.</div><br/></div></div></div></div></div></div><div id="41993290" class="c"><input type="checkbox" id="c-41993290" checked=""/><div class="controls bullet"><span class="by">gunnarmorling</span><span>|</span><a href="#41992873">parent</a><span>|</span><a href="#41993051">prev</a><span>|</span><a href="#41993909">next</a><span>|</span><label class="collapse" for="c-41993290">[-]</label><label class="expand" for="c-41993290">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not that much, but it&#x27;s also not nothing. The input file of the challenge was very narrow, just a relatively short text column and a numeric value. It still is &gt;13 GB uncompressed; an actual table with a few more columns with 1B rows will easily be beyond 100 GB. And chances are it&#x27;s not the only table in your database, so it won&#x27;t fit into RAM of most common database machines. I.e. still a non-trivial dataset in most contexts.</div><br/><div id="41993498" class="c"><input type="checkbox" id="c-41993498" checked=""/><div class="controls bullet"><span class="by">dspillett</span><span>|</span><a href="#41992873">root</a><span>|</span><a href="#41993290">parent</a><span>|</span><a href="#41999170">next</a><span>|</span><label class="collapse" for="c-41993498">[-]</label><label class="expand" for="c-41993498">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt; an actual table with a few more columns with 1B rows will easily be beyond 100 GB</i><p>Especially if you need to have supplementary indexes to support common queries on that data.</div><br/></div></div><div id="41999170" class="c"><input type="checkbox" id="c-41999170" checked=""/><div class="controls bullet"><span class="by">baq</span><span>|</span><a href="#41992873">root</a><span>|</span><a href="#41993290">parent</a><span>|</span><a href="#41993498">prev</a><span>|</span><a href="#41993909">next</a><span>|</span><label class="collapse" for="c-41999170">[-]</label><label class="expand" for="c-41999170">[1 more]</label></div><br/><div class="children"><div class="content">non-trival yes, but still small enough for a hobbyist. my desktop box has 96GB of ram and I don&#x27;t feel special about it, nor was it expensive.</div><br/></div></div></div></div></div></div><div id="41992849" class="c"><input type="checkbox" id="c-41992849" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992873">prev</a><span>|</span><label class="collapse" for="c-41992849">[-]</label><label class="expand" for="c-41992849">[5 more]</label></div><br/><div class="children"><div class="content">@ThePrimeTimeagen trigger ... BRazil mentioned ...<p>New Go Billion Row Challenge w&#x2F; Great Optimizations | Prime Reacts<p>- <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=SZ1PDS7iRU8" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=SZ1PDS7iRU8</a><p>- <a href="https:&#x2F;&#x2F;r2p.dev&#x2F;b&#x2F;2024-03-18-1brc-go&#x2F;" rel="nofollow">https:&#x2F;&#x2F;r2p.dev&#x2F;b&#x2F;2024-03-18-1brc-go&#x2F;</a><p>Spoiler:<p>SwissMap: A smaller, faster Golang Hash Table<p>- <a href="https:&#x2F;&#x2F;www.dolthub.com&#x2F;blog&#x2F;2023-03-28-swiss-map&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.dolthub.com&#x2F;blog&#x2F;2023-03-28-swiss-map&#x2F;</a><p>- <a href="https:&#x2F;&#x2F;github.com&#x2F;dolthub&#x2F;swiss">https:&#x2F;&#x2F;github.com&#x2F;dolthub&#x2F;swiss</a><p>Want to see Paul Allen&#x27;s implementation in Rust, Zig, Mojo ... and even Bun.sh, Deno.com</div><br/><div id="41992854" class="c"><input type="checkbox" id="c-41992854" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992849">parent</a><span>|</span><a href="#41992997">next</a><span>|</span><label class="collapse" for="c-41992854">[-]</label><label class="expand" for="c-41992854">[1 more]</label></div><br/><div class="children"><div class="content">... previously <a href="https:&#x2F;&#x2F;github.com&#x2F;shraddhaag&#x2F;1brc">https:&#x2F;&#x2F;github.com&#x2F;shraddhaag&#x2F;1brc</a></div><br/></div></div><div id="41992997" class="c"><input type="checkbox" id="c-41992997" checked=""/><div class="controls bullet"><span class="by">neonsunset</span><span>|</span><a href="#41992849">parent</a><span>|</span><a href="#41992854">prev</a><span>|</span><label class="collapse" for="c-41992997">[-]</label><label class="expand" for="c-41992997">[3 more]</label></div><br/><div class="children"><div class="content">Twice as slow as top submissions in C# and C++ which is still pretty good for Go but a likely indicator that memory here has become the major bottleneck.<p><a href="https:&#x2F;&#x2F;hotforknowledge.com&#x2F;2024&#x2F;01&#x2F;13&#x2F;1brc-in-dotnet-among-fastest-on-linux-my-optimization-journey&#x2F;" rel="nofollow">https:&#x2F;&#x2F;hotforknowledge.com&#x2F;2024&#x2F;01&#x2F;13&#x2F;1brc-in-dotnet-among-...</a></div><br/><div id="41995617" class="c"><input type="checkbox" id="c-41995617" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#41992849">root</a><span>|</span><a href="#41992997">parent</a><span>|</span><a href="#41993044">next</a><span>|</span><label class="collapse" for="c-41995617">[-]</label><label class="expand" for="c-41995617">[1 more]</label></div><br/><div class="children"><div class="content">In theory it could be improved, as Go also has most tools for that, with exception of having to manually dive into SIMD, as discussed in previous threads.<p>Even though I am not a big fan of Go, I feel that in the spirit of the guild of systems stuff with GC languages it always deserves some cheering nonetheless.</div><br/></div></div><div id="41993044" class="c"><input type="checkbox" id="c-41993044" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#41992849">root</a><span>|</span><a href="#41992997">parent</a><span>|</span><a href="#41995617">prev</a><span>|</span><label class="collapse" for="c-41993044">[-]</label><label class="expand" for="c-41993044">[1 more]</label></div><br/><div class="children"><div class="content">thanx! 2.9 seconds (4.5 GB&#x2F;s using .NET 8 on my Xeon Mac)</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>