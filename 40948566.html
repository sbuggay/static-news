<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1720861252406" as="style"/><link rel="stylesheet" href="styles.css?v=1720861252406"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/clarkmcc/cel-rust">Common Expression Language interpreter written in Rust</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>PaulHoule</span> | <span>20 comments</span></div><br/><div><div id="40952528" class="c"><input type="checkbox" id="c-40952528" checked=""/><div class="controls bullet"><span class="by">clarkmcc</span><span>|</span><a href="#40950212">next</a><span>|</span><label class="collapse" for="c-40952528">[-]</label><label class="expand" for="c-40952528">[1 more]</label></div><br/><div class="children"><div class="content">Ah, I was wondering why the project was getting a few more eyes today! Maintainer here, I took over this excellent project from Tom Forbes in April 2023. He did a phenomenal job writing the parser and laying the groundwork for an interpreter. One of the beautiful things right now about this project is its simplicity — it’s tiny compared to cel-go for example. I’m also a huge fan of our Axum-style functions[1] where you can register pretty much any closure as a custom function to be used in your CEL expressions. There’s still some mileage to go to support some of the more obscure aspects of the spec, but I feel like we’re getting close, and we have an excellent little cadre  of contributors that have been extremely helpful in moving this forward.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;clarkmcc&#x2F;cel-rust&#x2F;blob&#x2F;master&#x2F;example&#x2F;src&#x2F;functions.rs">https:&#x2F;&#x2F;github.com&#x2F;clarkmcc&#x2F;cel-rust&#x2F;blob&#x2F;master&#x2F;example&#x2F;src...</a></div><br/></div></div><div id="40950212" class="c"><input type="checkbox" id="c-40950212" checked=""/><div class="controls bullet"><span class="by">zackbrown</span><span>|</span><a href="#40952528">prev</a><span>|</span><a href="#40950041">next</a><span>|</span><label class="collapse" for="c-40950212">[-]</label><label class="expand" for="c-40950212">[7 more]</label></div><br/><div class="children"><div class="content">This is really cool.  I&#x27;ve been building a GUI system in Rust that features an expression language[0] — and we ruled out using CEL a while ago because the canonical Go CEL interpreter would cost several megabytes of runtime footprint (e.g. in a WASM bundle.)<p>Haven&#x27;t measured the footprint of cel-rust yet, but I expect it&#x27;s orders of magnitude smaller than cel-go.  The Go runtime itself is the culprit with cel-go.<p>This Rust implementation may let us port to CEL after all, while maintaining Pax&#x27;s &lt;100KB wasm footprint.  Nice work!<p>---<p>[0] <a href="https:&#x2F;&#x2F;www.pax.dev" rel="nofollow">https:&#x2F;&#x2F;www.pax.dev</a></div><br/><div id="40952353" class="c"><input type="checkbox" id="c-40952353" checked=""/><div class="controls bullet"><span class="by">brabel</span><span>|</span><a href="#40950212">parent</a><span>|</span><a href="#40951098">next</a><span>|</span><label class="collapse" for="c-40952353">[-]</label><label class="expand" for="c-40952353">[4 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know why people don&#x27;t just use Lua. It&#x27;s extremely small, can be embedded only with the Lua modules you want it to include (e.g. you do not need to provide file system access, networking etc. making it similar to CEL, just better), can be compiled to every possible target being written in standard C, is very mature and is completely open source.</div><br/><div id="40952394" class="c"><input type="checkbox" id="c-40952394" checked=""/><div class="controls bullet"><span class="by">jey</span><span>|</span><a href="#40950212">root</a><span>|</span><a href="#40952353">parent</a><span>|</span><a href="#40952362">next</a><span>|</span><label class="collapse" for="c-40952394">[-]</label><label class="expand" for="c-40952394">[1 more]</label></div><br/><div class="children"><div class="content">The problem is that Lua is Turing complete, so you can write programs that don&#x27;t halt or which take an input-dependent duration to halt. Example:<p><pre><code>    while true do
      print(&quot;meow?&quot;)
    end
</code></pre>
In contrast, each CEL expression has a maximum depth which directly determines how long it takes to execute. (More precisely: by calculating the maximum costs up the expression tree from leaves to root.)</div><br/></div></div><div id="40952398" class="c"><input type="checkbox" id="c-40952398" checked=""/><div class="controls bullet"><span class="by">01HNNWZ0MV43FF</span><span>|</span><a href="#40950212">root</a><span>|</span><a href="#40952353">parent</a><span>|</span><a href="#40952362">prev</a><span>|</span><a href="#40951098">next</a><span>|</span><label class="collapse" for="c-40952398">[-]</label><label class="expand" for="c-40952398">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not popular enough. I love Lua (except for 1-indexing) but I can&#x27;t use a language if nobody else uses it</div><br/></div></div></div></div><div id="40951098" class="c"><input type="checkbox" id="c-40951098" checked=""/><div class="controls bullet"><span class="by">darby_nine</span><span>|</span><a href="#40950212">parent</a><span>|</span><a href="#40952353">prev</a><span>|</span><a href="#40950041">next</a><span>|</span><label class="collapse" for="c-40951098">[-]</label><label class="expand" for="c-40951098">[2 more]</label></div><br/><div class="children"><div class="content">&gt; canonical Go CEL interpreter would cost several megabytes of runtime footprint (e.g. in a WASM bundle.)<p>At first blush Go seems incompatible with WASM in terms of maintaining Go&#x27;s strengths—the two runtimes have different memory models and stack representations. I&#x27;m curious why one would choose Go if WASM were a target to begin with.</div><br/><div id="40951315" class="c"><input type="checkbox" id="c-40951315" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40950212">root</a><span>|</span><a href="#40951098">parent</a><span>|</span><a href="#40950041">next</a><span>|</span><label class="collapse" for="c-40951315">[-]</label><label class="expand" for="c-40951315">[1 more]</label></div><br/><div class="children"><div class="content">because very few people porting things to wasm understand the model more than they understand the abi they are compiling code to.<p>asm is a dead art.</div><br/></div></div></div></div></div></div><div id="40950041" class="c"><input type="checkbox" id="c-40950041" checked=""/><div class="controls bullet"><span class="by">ay</span><span>|</span><a href="#40950212">prev</a><span>|</span><a href="#40952166">next</a><span>|</span><label class="collapse" for="c-40950041">[-]</label><label class="expand" for="c-40950041">[3 more]</label></div><br/><div class="children"><div class="content">Very interesting, and looks extremely flexible.<p>I had needed a small interpretive environment that would be highly controlled, used in a proprietary configuration templating solution for parametrizing various values.<p>I wrote <a href="https:&#x2F;&#x2F;github.com&#x2F;ayourtch&#x2F;aycalc">https:&#x2F;&#x2F;github.com&#x2F;ayourtch&#x2F;aycalc</a> - very rudimentary by default with just basic arithmetic, but easy to give different security guarantees, depending on the context - the references to functions and variables can be either separate from each other or share the space, also it’s easy to special-case the handling for both variables and functions.<p>The entire source code for the library is just around 400 lines, so i thought it can be a different enough type of a beast to mention, in case someone finds it useful.</div><br/><div id="40950157" class="c"><input type="checkbox" id="c-40950157" checked=""/><div class="controls bullet"><span class="by">verdverm</span><span>|</span><a href="#40950041">parent</a><span>|</span><a href="#40952166">next</a><span>|</span><label class="collapse" for="c-40950157">[-]</label><label class="expand" for="c-40950157">[2 more]</label></div><br/><div class="children"><div class="content">CEL is becoming a &quot;standard&quot; implementation found in a lot of places. I generally like it, but loathe how much it&#x27;s been growing the Yaml Engineering (devops) space. We need better options like CUE and Starlark that can scale and CEL feels more like duct tape in a lot of places. You kind of need CEL-in-config when the values are dynamic and processed within another system. In time, I expect that if something like GitHub Actions supported CUE natively, we could remove the `when: &quot;CEL expression&quot;` even with the dynamic values from previous steps. Eventually CUE&#x27;s evaluator will be smart enough to know when &#x2F; how to order sub-values.<p>- <a href="https:&#x2F;&#x2F;cel.dev" rel="nofollow">https:&#x2F;&#x2F;cel.dev</a><p>- <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;cel-spec">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;cel-spec</a></div><br/></div></div></div></div><div id="40952166" class="c"><input type="checkbox" id="c-40952166" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#40950041">prev</a><span>|</span><a href="#40949897">next</a><span>|</span><label class="collapse" for="c-40952166">[-]</label><label class="expand" for="c-40952166">[1 more]</label></div><br/><div class="children"><div class="content">Man I almost built this exact thing about a year ago and while I would have used it just didn&#x27;t have enough of a usecase to justify investing the time.<p>This is awesome work.</div><br/></div></div><div id="40949897" class="c"><input type="checkbox" id="c-40949897" checked=""/><div class="controls bullet"><span class="by">dlahoda</span><span>|</span><a href="#40952166">prev</a><span>|</span><a href="#40949963">next</a><span>|</span><label class="collapse" for="c-40949897">[-]</label><label class="expand" for="c-40949897">[1 more]</label></div><br/><div class="children"><div class="content">there is visual editor which exports cel <a href="https:&#x2F;&#x2F;github.com&#x2F;react-querybuilder&#x2F;react-querybuilder">https:&#x2F;&#x2F;github.com&#x2F;react-querybuilder&#x2F;react-querybuilder</a></div><br/></div></div><div id="40949963" class="c"><input type="checkbox" id="c-40949963" checked=""/><div class="controls bullet"><span class="by">ramon156</span><span>|</span><a href="#40949897">prev</a><span>|</span><a href="#40949518">next</a><span>|</span><label class="collapse" for="c-40949963">[-]</label><label class="expand" for="c-40949963">[2 more]</label></div><br/><div class="children"><div class="content">Probably a silly and useless idea, but what if there was an ORM that was designed around CEL?</div><br/><div id="40950016" class="c"><input type="checkbox" id="c-40950016" checked=""/><div class="controls bullet"><span class="by">processunknown</span><span>|</span><a href="#40949963">parent</a><span>|</span><a href="#40949518">next</a><span>|</span><label class="collapse" for="c-40950016">[-]</label><label class="expand" for="c-40950016">[1 more]</label></div><br/><div class="children"><div class="content">Not a silly or useless idea at all. Ive seen a custom built ORM that parsed a CEL-like syntax into a SQL query using a query builder. It was pretty nifty. The use-case was to allow users to craft arbitrary queries on a data-driven application.</div><br/></div></div></div></div><div id="40949518" class="c"><input type="checkbox" id="c-40949518" checked=""/><div class="controls bullet"><span class="by">lalaithion</span><span>|</span><a href="#40949963">prev</a><span>|</span><a href="#40949671">next</a><span>|</span><label class="collapse" for="c-40949518">[-]</label><label class="expand" for="c-40949518">[2 more]</label></div><br/><div class="children"><div class="content">CEL is super cool, it&#x27;s really great to have a quick and easy way to add a filter parameter to every list API on your server. This project should add an easy way to take a list&#x2F;iterator of something that implements Serde Serialize, and filter based on a CEL expression.</div><br/><div id="40949570" class="c"><input type="checkbox" id="c-40949570" checked=""/><div class="controls bullet"><span class="by">PaulHoule</span><span>|</span><a href="#40949518">parent</a><span>|</span><a href="#40949671">next</a><span>|</span><label class="collapse" for="c-40949570">[-]</label><label class="expand" for="c-40949570">[1 more]</label></div><br/><div class="children"><div class="content">In my mind it has some similarity to<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Object_Constraint_Language" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Object_Constraint_Language</a><p>insofar as there is an expression language inside of OCL.  OMG uses OCL in many parts of standards that can use that functionality.</div><br/></div></div></div></div><div id="40949671" class="c"><input type="checkbox" id="c-40949671" checked=""/><div class="controls bullet"><span class="by">tempodox</span><span>|</span><a href="#40949518">prev</a><span>|</span><a href="#40951287">next</a><span>|</span><label class="collapse" for="c-40949671">[-]</label><label class="expand" for="c-40949671">[1 more]</label></div><br/><div class="children"><div class="content">Cool!  I made something remotely similar, a library for complex arithmetic that  dynamically evaluates user-defined expressions.  Since it only has pre-defined functions, the compiler can do pervasive constant folding.</div><br/></div></div><div id="40951287" class="c"><input type="checkbox" id="c-40951287" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40949671">prev</a><span>|</span><label class="collapse" for="c-40951287">[-]</label><label class="expand" for="c-40951287">[1 more]</label></div><br/><div class="children"><div class="content">is CEL just a buzzword&#x2F;certification gate keeping for typed data?!</div><br/></div></div></div></div></div></div></div></body></html>