<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732179670512" as="style"/><link rel="stylesheet" href="styles.css?v=1732179670512"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/doxx/darkflare">Doxx/Darkflare: DarkFlare TCPoCDN (TCP over CDN)</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>josephscott</span> | <span>17 comments</span></div><br/><div><div id="42201093" class="c"><input type="checkbox" id="c-42201093" checked=""/><div class="controls bullet"><span class="by">ignoramous</span><span>|</span><a href="#42201446">next</a><span>|</span><label class="collapse" for="c-42201093">[-]</label><label class="expand" for="c-42201093">[1 more]</label></div><br/><div class="children"><div class="content">You could straight up connect to the destination (over TCP) from Cloudflare without needing relays; a project I wrote demonstrates TCP over HTTP (for Deno Deploy) and TCP over WebSockets (for Workers): <a href="https:&#x2F;&#x2F;github.com&#x2F;serverless-proxy&#x2F;serverless-proxy">https:&#x2F;&#x2F;github.com&#x2F;serverless-proxy&#x2F;serverless-proxy</a><p>Proxying projects utilising HTTP&#x2F;TLS are popular in the anti-censorship community (discussion board: <a href="https:&#x2F;&#x2F;github.com&#x2F;net4people&#x2F;bbs">https:&#x2F;&#x2F;github.com&#x2F;net4people&#x2F;bbs</a>) and there are many variants of it; ex:<p>- KCP (over UDP): <a href="https:&#x2F;&#x2F;github.com&#x2F;xtaci&#x2F;kcp-go">https:&#x2F;&#x2F;github.com&#x2F;xtaci&#x2F;kcp-go</a><p>- Bepass: <a href="https:&#x2F;&#x2F;github.com&#x2F;bepass-org&#x2F;bepass-worker">https:&#x2F;&#x2F;github.com&#x2F;bepass-org&#x2F;bepass-worker</a></div><br/></div></div><div id="42201446" class="c"><input type="checkbox" id="c-42201446" checked=""/><div class="controls bullet"><span class="by">novakwok</span><span>|</span><a href="#42201093">prev</a><span>|</span><a href="#42201341">next</a><span>|</span><label class="collapse" for="c-42201446">[-]</label><label class="expand" for="c-42201446">[1 more]</label></div><br/><div class="children"><div class="content">There seems another way to achieve this, using Cloudflare&#x27;s own cloudflared tunnel.<p>Install a cloudflared tunnel on your remote server, configure it to forward traffic to that server&#x27;s hosts proxy server(maybe Shadowsocks) using Zero Trust dashboard, and run the following command on your local computer:<p>cloudflared access tcp --hostname some.your-domain.tld --url localhost:8080<p>Then localhost:8080&#x27;s traffic will be forwarded to cloudflareds&#x27; host, the whole traffic is using HTTP2 so might look legitimate to Firewall.<p>For example if using Shadowsocks on server, your Shadowsocks&#x27;s local client can connect to localhost:8080 as server to forward traffic.</div><br/></div></div><div id="42201341" class="c"><input type="checkbox" id="c-42201341" checked=""/><div class="controls bullet"><span class="by">est</span><span>|</span><a href="#42201446">prev</a><span>|</span><a href="#42202076">next</a><span>|</span><label class="collapse" for="c-42201341">[-]</label><label class="expand" for="c-42201341">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Services like Cloudflare, Akamai Technologies, Fastly, and Amazon CloudFront ...  support millions of websites across critical sectors, including government and healthcare, making them indispensable<p>The author is pretty naive. There is a reason why Google was left out of the list, in the 2010s people argue &quot;Google is too important and China never dare to block it&quot; then google&#x27;s whole IP range is blocked.<p>Amazon Cloudfront, Akmai, Fastly are also (partially) blocked and barely working.<p>IMHO cleve tricks like &quot;domain fronting&quot; is just freebooting</div><br/><div id="42201606" class="c"><input type="checkbox" id="c-42201606" checked=""/><div class="controls bullet"><span class="by">dlenski</span><span>|</span><a href="#42201341">parent</a><span>|</span><a href="#42202076">next</a><span>|</span><label class="collapse" for="c-42201606">[-]</label><label class="expand" for="c-42201606">[3 more]</label></div><br/><div class="children"><div class="content">&gt; IMHO cleve tricks like &quot;domain fronting&quot; is just freebooting<p>What do you mean by &quot;freebooting&quot;?<p>We added domain fronting support to the OpenConnect TLS-VPN client _in 2022_ because it is still working and useful for many people working in censored countries and environments. <a href="https:&#x2F;&#x2F;gitlab.com&#x2F;openconnect&#x2F;openconnect&#x2F;-&#x2F;merge_requests&#x2F;297" rel="nofollow">https:&#x2F;&#x2F;gitlab.com&#x2F;openconnect&#x2F;openconnect&#x2F;-&#x2F;merge_requests&#x2F;...</a></div><br/><div id="42201756" class="c"><input type="checkbox" id="c-42201756" checked=""/><div class="controls bullet"><span class="by">est</span><span>|</span><a href="#42201341">root</a><span>|</span><a href="#42201606">parent</a><span>|</span><a href="#42202076">next</a><span>|</span><label class="collapse" for="c-42201756">[-]</label><label class="expand" for="c-42201756">[2 more]</label></div><br/><div class="children"><div class="content">&gt; because it is still working<p>That&#x27;s a big &quot;still&quot; and you don&#x27;t loose anything in case the real owner of the &quot;fronted&quot; domain suffers loss.</div><br/><div id="42201990" class="c"><input type="checkbox" id="c-42201990" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#42201341">root</a><span>|</span><a href="#42201756">parent</a><span>|</span><a href="#42202076">next</a><span>|</span><label class="collapse" for="c-42201990">[-]</label><label class="expand" for="c-42201990">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it&#x27;s right to assign blame here to any party other than the authoritarian regime that decides to block the whole CDN.</div><br/></div></div></div></div></div></div></div></div><div id="42202076" class="c"><input type="checkbox" id="c-42202076" checked=""/><div class="controls bullet"><span class="by">theblazehen</span><span>|</span><a href="#42201341">prev</a><span>|</span><a href="#42201313">next</a><span>|</span><label class="collapse" for="c-42202076">[-]</label><label class="expand" for="c-42202076">[1 more]</label></div><br/><div class="children"><div class="content">How does this differ from tunneling a VPN over something like wstunnel?<p>We&#x27;ve been running that in prod for several years without any issues, also going through cloudflare</div><br/></div></div><div id="42201313" class="c"><input type="checkbox" id="c-42201313" checked=""/><div class="controls bullet"><span class="by">a-ve</span><span>|</span><a href="#42202076">prev</a><span>|</span><a href="#42200584">next</a><span>|</span><label class="collapse" for="c-42201313">[-]</label><label class="expand" for="c-42201313">[1 more]</label></div><br/><div class="children"><div class="content">Is this something like WebTunnel from the Tor Project?<p><a href="https:&#x2F;&#x2F;gitlab.torproject.org&#x2F;tpo&#x2F;anti-censorship&#x2F;pluggable-transports&#x2F;webtunnel" rel="nofollow">https:&#x2F;&#x2F;gitlab.torproject.org&#x2F;tpo&#x2F;anti-censorship&#x2F;pluggable-...</a></div><br/></div></div><div id="42200584" class="c"><input type="checkbox" id="c-42200584" checked=""/><div class="controls bullet"><span class="by">tomsonj</span><span>|</span><a href="#42201313">prev</a><span>|</span><label class="collapse" for="c-42200584">[-]</label><label class="expand" for="c-42200584">[8 more]</label></div><br/><div class="children"><div class="content">chisel is a similar tool in this space <a href="https:&#x2F;&#x2F;github.com&#x2F;jpillora&#x2F;chisel">https:&#x2F;&#x2F;github.com&#x2F;jpillora&#x2F;chisel</a><p>I don’t get why headers and requests need to be spoofed if all traffic is over https?</div><br/><div id="42200828" class="c"><input type="checkbox" id="c-42200828" checked=""/><div class="controls bullet"><span class="by">mhio</span><span>|</span><a href="#42200584">parent</a><span>|</span><a href="#42201273">next</a><span>|</span><label class="collapse" for="c-42200828">[-]</label><label class="expand" for="c-42200828">[1 more]</label></div><br/><div class="children"><div class="content">The headers are seen by the monster-in-the-middle CDN.<p>It&#x27;s obfuscation at best. I&#x27;m not sure the encrypted traffic will look particularly php-ish for example. Compressed formats might look vaguely passable.<p>I can&#x27;t see any stenography code or libraries in the repo.</div><br/></div></div><div id="42201273" class="c"><input type="checkbox" id="c-42201273" checked=""/><div class="controls bullet"><span class="by">coretx</span><span>|</span><a href="#42200584">parent</a><span>|</span><a href="#42200828">prev</a><span>|</span><a href="#42201386">next</a><span>|</span><label class="collapse" for="c-42201273">[-]</label><label class="expand" for="c-42201273">[2 more]</label></div><br/><div class="children"><div class="content">Because SNI. Also, State (sponsored) Actors are certificate authorities.
HTTPS is the biggest scam in internet history.
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Server_Name_Indication" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Server_Name_Indication</a></div><br/><div id="42201851" class="c"><input type="checkbox" id="c-42201851" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#42200584">root</a><span>|</span><a href="#42201273">parent</a><span>|</span><a href="#42201386">next</a><span>|</span><label class="collapse" for="c-42201851">[-]</label><label class="expand" for="c-42201851">[1 more]</label></div><br/><div class="children"><div class="content">This certainly was an issue but it&#x27;s solved by ECH&#x2F;DoH. As long as they aren&#x27;t blocked on your network anyway.<p>&gt; Also, State (sponsored) Actors are certificate authorities.<p>To generate a fake certificate as a CA you have to either put it in the Certificate Transparency log, in which case everyone will notice, or don&#x27;t, in which case browsers will notice (they know what top sites&#x27; certificates are supposed to look like) and your CA will get shut down.</div><br/></div></div></div></div><div id="42201386" class="c"><input type="checkbox" id="c-42201386" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#42200584">parent</a><span>|</span><a href="#42201273">prev</a><span>|</span><a href="#42200669">next</a><span>|</span><label class="collapse" for="c-42201386">[-]</label><label class="expand" for="c-42201386">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I don’t get why headers and requests need to be spoofed if all traffic is over https?<p>Because the traffic is to a CDN endpoint (like Cloudflare) which expects it to be a HTTP message.</div><br/></div></div><div id="42200669" class="c"><input type="checkbox" id="c-42200669" checked=""/><div class="controls bullet"><span class="by">Titan2189</span><span>|</span><a href="#42200584">parent</a><span>|</span><a href="#42201386">prev</a><span>|</span><label class="collapse" for="c-42200669">[-]</label><label class="expand" for="c-42200669">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I don’t get why headers and requests need to be spoofed if all traffic is over https?<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Deep_packet_inspection" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Deep_packet_inspection</a></div><br/><div id="42200815" class="c"><input type="checkbox" id="c-42200815" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#42200584">root</a><span>|</span><a href="#42200669">parent</a><span>|</span><label class="collapse" for="c-42200815">[-]</label><label class="expand" for="c-42200815">[2 more]</label></div><br/><div class="children"><div class="content">how are they looking inside the packet if it&#x27;s encrypted?</div><br/><div id="42200924" class="c"><input type="checkbox" id="c-42200924" checked=""/><div class="controls bullet"><span class="by">sodality2</span><span>|</span><a href="#42200584">root</a><span>|</span><a href="#42200815">parent</a><span>|</span><label class="collapse" for="c-42200924">[-]</label><label class="expand" for="c-42200924">[1 more]</label></div><br/><div class="children"><div class="content">DPI doesn&#x27;t have to decrypt it to make certain guesses about its content. For example, timing information, packet sizes, routing info, etc could lead you to believe it&#x27;s certain kinds of things (SSH, VPN, etc).</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>