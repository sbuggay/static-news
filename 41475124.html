<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725786069084" as="style"/><link rel="stylesheet" href="styles.css?v=1725786069084"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://purplesyringa.moe/blog/webp-the-webpage-compression-format/">WebP: The WebPage Compression Format</a> <span class="domain">(<a href="https://purplesyringa.moe">purplesyringa.moe</a>)</span></div><div class="subtext"><span>Kubuxu</span> | <span>144 comments</span></div><br/><div><div id="41475528" class="c"><input type="checkbox" id="c-41475528" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475565">next</a><span>|</span><label class="collapse" for="c-41475528">[-]</label><label class="expand" for="c-41475528">[47 more]</label></div><br/><div class="children"><div class="content">&gt; <i>the longest post on my site, takes 92 KiB instead of 37 KiB. This amounts to an unnecessary 2.5x increase in load time</i><p>Sure, if you ignore latency. In reality it&#x27;s an unnecessary 0.001% increase in load time because that size increase isn&#x27;t enough to matter vs the round trip time. And the time you save transmitting 55 fewer KiB is probably less than the time lost to decompression. :p<p>While fun, I would expect this specific scenario to actually be worse for the user experience not better. Speed will be a complete wash and compatibility will be worse.</div><br/><div id="41476428" class="c"><input type="checkbox" id="c-41476428" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41475879">next</a><span>|</span><label class="collapse" for="c-41476428">[-]</label><label class="expand" for="c-41476428">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s certainly reasonable if you optimize only for loading time (and make certain assumptions about everybody&#x27;s available data rate), but sometimes I really wish website (and more commonly app) authors wouldn&#x27;t make that speed&#x2F;data tradeoff so freely on my behalf, for me to find out <i>after</i> they&#x27;ve already pushed that extra data over my metered connection.<p>The tragedy here is that while some people, such as the author of TFA, go to great lengths to get from about 100 to 50 kB, others don&#x27;t think twice to send me literally tens of megabytes of images, when I just want to know when a restaurant is open – on roaming data.<p>Resource awareness exists, but it&#x27;s unfortunately very unevenly distributed.</div><br/><div id="41476636" class="c"><input type="checkbox" id="c-41476636" checked=""/><div class="controls bullet"><span class="by">k__</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476428">parent</a><span>|</span><a href="#41475879">next</a><span>|</span><label class="collapse" for="c-41476636">[-]</label><label class="expand" for="c-41476636">[3 more]</label></div><br/><div class="children"><div class="content">We need a MoSh-based browser with gopher support.</div><br/><div id="41477473" class="c"><input type="checkbox" id="c-41477473" checked=""/><div class="controls bullet"><span class="by">nox101</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476636">parent</a><span>|</span><a href="#41475879">next</a><span>|</span><label class="collapse" for="c-41477473">[-]</label><label class="expand" for="c-41477473">[2 more]</label></div><br/><div class="children"><div class="content">and you&#x27;d need AI to tell you whats in the pictures because lots of restaurant sites just have photos of their menu and some designer with no web knowledge put their phone number, address, and hours in an image designed in Photoshop</div><br/><div id="41478661" class="c"><input type="checkbox" id="c-41478661" checked=""/><div class="controls bullet"><span class="by">tacone</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41477473">parent</a><span>|</span><a href="#41475879">next</a><span>|</span><label class="collapse" for="c-41478661">[-]</label><label class="expand" for="c-41478661">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re in for bad luck. Some time ago I tried some photos of pasta dishes with Gemini and it could not guess the recipe name.</div><br/></div></div></div></div></div></div></div></div><div id="41475879" class="c"><input type="checkbox" id="c-41475879" checked=""/><div class="controls bullet"><span class="by">edflsafoiewq</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41476428">prev</a><span>|</span><a href="#41477484">next</a><span>|</span><label class="collapse" for="c-41475879">[-]</label><label class="expand" for="c-41475879">[15 more]</label></div><br/><div class="children"><div class="content">Well, that, and there&#x27;s an 850K Symbols-2048-em%20Nerd%20Font%20Complete.woff2 file that sort of drowns out the difference, at least if it&#x27;s not in cache.</div><br/><div id="41476495" class="c"><input type="checkbox" id="c-41476495" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475879">parent</a><span>|</span><a href="#41477978">next</a><span>|</span><label class="collapse" for="c-41476495">[-]</label><label class="expand" for="c-41476495">[6 more]</label></div><br/><div class="children"><div class="content">Now I got curious, and there&#x27;s also a 400 kB CSS file to go with it: <a href="https:&#x2F;&#x2F;purplesyringa.moe&#x2F;fonts&#x2F;webfont.css" rel="nofollow">https:&#x2F;&#x2F;purplesyringa.moe&#x2F;fonts&#x2F;webfont.css</a><p>I&#x27;m not up to date on web&#x2F;font development – does anybody know what that does?</div><br/><div id="41476572" class="c"><input type="checkbox" id="c-41476572" checked=""/><div class="controls bullet"><span class="by">bobbylarrybobby</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476495">parent</a><span>|</span><a href="#41476601">next</a><span>|</span><label class="collapse" for="c-41476572">[-]</label><label class="expand" for="c-41476572">[4 more]</label></div><br/><div class="children"><div class="content">It adds unicode characters before elements with the given class. Then it&#x27;s up to the font to display those Unicode characters — in this case, based on the class names, one can infer that the font assigns an icon to each character used.</div><br/><div id="41476606" class="c"><input type="checkbox" id="c-41476606" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476572">parent</a><span>|</span><a href="#41476601">next</a><span>|</span><label class="collapse" for="c-41476606">[-]</label><label class="expand" for="c-41476606">[3 more]</label></div><br/><div class="children"><div class="content">That makes sense, thank you!<p>So the purpose is effectively to have human-readable CSS class names to refer to given glyphs in the font, rather than having stray private use Unicode characters in the HTML?</div><br/><div id="41476646" class="c"><input type="checkbox" id="c-41476646" checked=""/><div class="controls bullet"><span class="by">lobsterthief</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476606">parent</a><span>|</span><a href="#41476601">next</a><span>|</span><label class="collapse" for="c-41476646">[-]</label><label class="expand" for="c-41476646">[2 more]</label></div><br/><div class="children"><div class="content">Yep<p>This is a reasonable approach if you have a large number of icons across large parts of the site, but you should always compile the CSS&#x2F;icon set down to only those used.<p>If only a few icons, and the icons are small, then inlining the SVG is a better option. But if you have too many SVGs directly embedded on the site, the page size itself will suffer.<p>As always with website optimization, whether something is a good option always “depends”.</div><br/><div id="41478127" class="c"><input type="checkbox" id="c-41478127" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476646">parent</a><span>|</span><a href="#41476601">next</a><span>|</span><label class="collapse" for="c-41478127">[-]</label><label class="expand" for="c-41478127">[1 more]</label></div><br/><div class="children"><div class="content">I think at least some recent tools will produce ligatures to turn a plain text into an icon to avoid this issue.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41477978" class="c"><input type="checkbox" id="c-41477978" checked=""/><div class="controls bullet"><span class="by">est</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475879">parent</a><span>|</span><a href="#41476495">prev</a><span>|</span><a href="#41476657">next</a><span>|</span><label class="collapse" for="c-41477978">[-]</label><label class="expand" for="c-41477978">[4 more]</label></div><br/><div class="children"><div class="content">seriously, why can&#x27;t modern browsers turn off features like remote fonts, webrtc, etc. in settings. I hate when reading a bit then the font changes. Not to say fingerprinting risks.</div><br/><div id="41478286" class="c"><input type="checkbox" id="c-41478286" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41477978">parent</a><span>|</span><a href="#41476657">next</a><span>|</span><label class="collapse" for="c-41478286">[-]</label><label class="expand" for="c-41478286">[3 more]</label></div><br/><div class="children"><div class="content">You can, and then when someone uses an icon font instead of graphics their page breaks.</div><br/><div id="41478348" class="c"><input type="checkbox" id="c-41478348" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41478286">parent</a><span>|</span><a href="#41476657">next</a><span>|</span><label class="collapse" for="c-41478348">[-]</label><label class="expand" for="c-41478348">[2 more]</label></div><br/><div class="children"><div class="content">Skill issue.<p>Pictures are pictures, text is text. &lt;img&gt; tag exists for a reason.</div><br/><div id="41478948" class="c"><input type="checkbox" id="c-41478948" checked=""/><div class="controls bullet"><span class="by">lenkite</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41478348">parent</a><span>|</span><a href="#41476657">next</a><span>|</span><label class="collapse" for="c-41478948">[-]</label><label class="expand" for="c-41478948">[1 more]</label></div><br/><div class="children"><div class="content">Its a convenience packaging issue. An icon font is simply more convenient to handle. &lt;img&gt; tags for a hundred images requires more work.<p>Icon fonts are used all over the place - look at the terminal nowadays. Most TUI&#x27;s require an icon font to be installed.</div><br/></div></div></div></div></div></div></div></div><div id="41476594" class="c"><input type="checkbox" id="c-41476594" checked=""/><div class="controls bullet"><span class="by">marcellus23</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475879">parent</a><span>|</span><a href="#41476657">prev</a><span>|</span><a href="#41477484">next</a><span>|</span><label class="collapse" for="c-41476594">[-]</label><label class="expand" for="c-41476594">[3 more]</label></div><br/><div class="children"><div class="content">Wow, yeah. That kind of discredits the blog author a bit.</div><br/><div id="41478951" class="c"><input type="checkbox" id="c-41478951" checked=""/><div class="controls bullet"><span class="by">purplesyringa</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476594">parent</a><span>|</span><a href="#41476635">next</a><span>|</span><label class="collapse" for="c-41478951">[-]</label><label class="expand" for="c-41478951">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s cached. Not ideal, sure, and I&#x27;ll get rid of that bloat someday, but that file is not mission-critical and the cost is amortized between visits. I admit my fault though.</div><br/></div></div><div id="41476635" class="c"><input type="checkbox" id="c-41476635" checked=""/><div class="controls bullet"><span class="by">edflsafoiewq</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476594">parent</a><span>|</span><a href="#41478951">prev</a><span>|</span><a href="#41477484">next</a><span>|</span><label class="collapse" for="c-41476635">[-]</label><label class="expand" for="c-41476635">[1 more]</label></div><br/><div class="children"><div class="content">I mean, it&#x27;s all just for fun of course.</div><br/></div></div></div></div></div></div><div id="41477484" class="c"><input type="checkbox" id="c-41477484" checked=""/><div class="controls bullet"><span class="by">oefrha</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41475879">prev</a><span>|</span><a href="#41475574">next</a><span>|</span><label class="collapse" for="c-41477484">[-]</label><label class="expand" for="c-41477484">[1 more]</label></div><br/><div class="children"><div class="content">It’s not just decompression time. They need to download the whole thing before decompression, whereas the browser can decompress and render HTML as it’s streamed from the server. If the connection is interrupted you lose everything, instead of being able to read the part you’ve downloaded.<p>So, for any reasonable connection the difference doesn’t matter; for actually gruesomely slow&#x2F;unreliable connections where 50KB matters this is markedly worse. While a fun experiment, please don’t do it on your site.</div><br/></div></div><div id="41475574" class="c"><input type="checkbox" id="c-41475574" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41477484">prev</a><span>|</span><a href="#41477138">next</a><span>|</span><label class="collapse" for="c-41475574">[-]</label><label class="expand" for="c-41475574">[14 more]</label></div><br/><div class="children"><div class="content">That size difference is large enough to make a difference in the number of round trips required (should be roughly one fewer roundtrip with any sensible modern value for the initial congestion window).<p>Won&#x27;t be a 2.5x difference, but also not 0.001%.</div><br/><div id="41475650" class="c"><input type="checkbox" id="c-41475650" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475574">parent</a><span>|</span><a href="#41475847">next</a><span>|</span><label class="collapse" for="c-41475650">[-]</label><label class="expand" for="c-41475650">[7 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need a new roundtrip for every packet. That would be devastating for throughput. One vs two vs three file packets get acked as a batch either way, not serially.<p>Also when you get to the end, you then see<p>&gt; <i>The actual savings here are moderate: the original is 88 KiB with gzip, and the WebP one is 83 KiB with gzip. In contrast, Brotli would provide 69 KiB.</i><p>At 69 KiB you&#x27;re still over the default TCP packet max, which means both cases transmit the same number of packets, one just has a bunch of extra overhead added for the extra JavaScript fetch, load, and execute.<p>The time saved here is going to be negligible at best anyway, but there looks to be actually <i>negative</i> because we&#x27;re burning time without reducing the number of needed packets at all.</div><br/><div id="41475770" class="c"><input type="checkbox" id="c-41475770" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475650">parent</a><span>|</span><a href="#41475847">next</a><span>|</span><label class="collapse" for="c-41475770">[-]</label><label class="expand" for="c-41475770">[6 more]</label></div><br/><div class="children"><div class="content">Those numbers are for a different page. For the original page, the article quotes 44 kB with this method vs. 92 kB for gzip.<p>&gt; At 69 KiB you&#x27;re still over the default TCP packet max, which means both cases transmit the same number of packets,<p>What? No, they absolutely don&#x27;t transmit the same number of packets. Did you mean some other word?</div><br/><div id="41476170" class="c"><input type="checkbox" id="c-41476170" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475770">parent</a><span>|</span><a href="#41476153">next</a><span>|</span><label class="collapse" for="c-41476170">[-]</label><label class="expand" for="c-41476170">[3 more]</label></div><br/><div class="children"><div class="content">I expect what GP meant is the default TCP <i>window</i> size, so in a situation where bandwidth costs are dwarfed by roundtrip costs, these two cases will end up taking essentially the same time, because they will incur the same number of ACK roundtrips. Don’t know if the numbers work out, but they at least sound plausible.</div><br/><div id="41477081" class="c"><input type="checkbox" id="c-41477081" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476170">parent</a><span>|</span><a href="#41476531">next</a><span>|</span><label class="collapse" for="c-41477081">[-]</label><label class="expand" for="c-41477081">[1 more]</label></div><br/><div class="children"><div class="content">No, there is no way the numbers would work out to the same number of roundtrips. The sizes are different by a factor of 2.5x, and the congestion window will only double in a single roundtrip. The only way the number of roundtrips would be the same is if both transfers fit in the initial congestion window.</div><br/></div></div><div id="41476531" class="c"><input type="checkbox" id="c-41476531" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476170">parent</a><span>|</span><a href="#41477081">prev</a><span>|</span><a href="#41476153">next</a><span>|</span><label class="collapse" for="c-41476531">[-]</label><label class="expand" for="c-41476531">[1 more]</label></div><br/><div class="children"><div class="content">Yes, sorry</div><br/></div></div></div></div><div id="41476153" class="c"><input type="checkbox" id="c-41476153" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475770">parent</a><span>|</span><a href="#41476170">prev</a><span>|</span><a href="#41475847">next</a><span>|</span><label class="collapse" for="c-41476153">[-]</label><label class="expand" for="c-41476153">[2 more]</label></div><br/><div class="children"><div class="content">They were probably thinking of the max size for packets in TCP, which is 64K (65535 bytes).<p>However, Ethernet has a MTU (Maximum Transmission Unit) of 1500 bytes. Unless jumbo frames are used.<p>And so I agree with you, the number of packets that will be sent for 69 KiB vs 92 KiB will likely be different.</div><br/></div></div></div></div></div></div><div id="41475847" class="c"><input type="checkbox" id="c-41475847" checked=""/><div class="controls bullet"><span class="by">pierrec</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475574">parent</a><span>|</span><a href="#41475650">prev</a><span>|</span><a href="#41477138">next</a><span>|</span><label class="collapse" for="c-41475847">[-]</label><label class="expand" for="c-41475847">[6 more]</label></div><br/><div class="children"><div class="content">Interesting, how does that add a round trip? For the record here&#x27;s what I believe to be the common definition of an additional &quot;round trip&quot;, in a web development context:<p><pre><code>  - client requests X
  - client gets X, which contains a reference to Y
  - therefore client requests Y
</code></pre>
So you&#x27;re starting a new request that depends on the client having received the first one. (although upon closer inspection I think the technique described in the blog post manages to fit everything into the first response, so I&#x27;m not sure how relevant this is)</div><br/><div id="41475952" class="c"><input type="checkbox" id="c-41475952" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475847">parent</a><span>|</span><a href="#41476260">next</a><span>|</span><label class="collapse" for="c-41475952">[-]</label><label class="expand" for="c-41475952">[1 more]</label></div><br/><div class="children"><div class="content">Unless a resource is very small, it won&#x27;t be transmitted in a single atomic unit. The sender will only send a part of it, wait the client to acknowledge having received them, and only then send more. That requires a network roundtrip. The larger the resource, the more network roundtrips will be required.<p>If you want to learn more, pretty much any resource on TCP should explain this stuff. Here&#x27;s something I wrote years ago, the background section should be pretty applicable:
<a href="https:&#x2F;&#x2F;www.snellman.net&#x2F;blog&#x2F;archive&#x2F;2017-08-19-slow-ps4-downloads&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.snellman.net&#x2F;blog&#x2F;archive&#x2F;2017-08-19-slow-ps4-do...</a></div><br/></div></div><div id="41476260" class="c"><input type="checkbox" id="c-41476260" checked=""/><div class="controls bullet"><span class="by">crote</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475847">parent</a><span>|</span><a href="#41475952">prev</a><span>|</span><a href="#41477138">next</a><span>|</span><label class="collapse" for="c-41476260">[-]</label><label class="expand" for="c-41476260">[4 more]</label></div><br/><div class="children"><div class="content">In reality it&#x27;s more like:<p><pre><code>  - client requests X
  - server sends bytes 0-2k of X
  - client acknowledges bytes 0-2k of X
  - server sends bytes 2k-6k of X
  - client acknowledges bytes 2k-6k of X
  - server sends bytes 6k-14k of X
  - client acknowledges bytes 6k-14k of X
  - server sends bytes 14k-30k of X
  - client acknowledges bytes 14k-30k of X
  - server sends bytes 30k-62k of X
  - client acknowledges bytes 30k-62k of X
  - server sends bytes 62k-83k of X
  - client acknowledges bytes 62k-83k of X
  - client has received X, which contains a reference to Y
  - therefore client requests Y
</code></pre>
It&#x27;s all about TCP congestion control here. There are dozens of algorithms used to handle it, but in pretty much all cases you want to have <i>some</i> kind of slow buildup in order to avoid completely swamping a slower connection and having all but the first few of your packets getting dropped.</div><br/><div id="41477124" class="c"><input type="checkbox" id="c-41477124" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476260">parent</a><span>|</span><a href="#41476476">prev</a><span>|</span><a href="#41477138">next</a><span>|</span><label class="collapse" for="c-41477124">[-]</label><label class="expand" for="c-41477124">[2 more]</label></div><br/><div class="children"><div class="content">&gt; client acknowledges bytes 0-2k of X<p>Doesn’t client see reference to Y at this point? Modern browsers start parsing HTML even before they receive the whole document.</div><br/><div id="41478291" class="c"><input type="checkbox" id="c-41478291" checked=""/><div class="controls bullet"><span class="by">Timwi</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41477124">parent</a><span>|</span><a href="#41477138">next</a><span>|</span><label class="collapse" for="c-41478291">[-]</label><label class="expand" for="c-41478291">[1 more]</label></div><br/><div class="children"><div class="content">Not just modern. This was even more significant on slow connections, so they&#x27;ve kind of always done that. One could even argue that HTML, HTTP (specifically, chunked encoding) and gzip are all intentionally designed to enable this.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41477138" class="c"><input type="checkbox" id="c-41477138" checked=""/><div class="controls bullet"><span class="by">zahlman</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41475574">prev</a><span>|</span><a href="#41475649">next</a><span>|</span><label class="collapse" for="c-41477138">[-]</label><label class="expand" for="c-41477138">[1 more]</label></div><br/><div class="children"><div class="content">Actually, I was rather wondering about that claim, because it seems accidentally cherry-picked. Regarding that post:<p>&gt; This code minifies to about 550 bytes. Together with the WebP itself, this amounts to 44 KiB. In comparison, gzip was 92 KiB, and Brotli would be 37 KiB.<p>But regarding the current one:<p>&gt; The actual savings here are moderate: the original is 88 KiB with gzip, and the WebP one is 83 KiB with gzip. In contrast, Brotli would provide 69 KiB. Better than nothing, though.<p>Most of the other examples don&#x27;t show dramatic (like more than factor-of-2) differences between the compression methods either. In my own local testing (on Python wheel data, which should be mostly Python source code, thus text that&#x27;s full of common identifiers and keywords) I find that XZ typically outperforms gzip by about 25%, while Brotli doesn&#x27;t do any better than XZ.</div><br/></div></div><div id="41475649" class="c"><input type="checkbox" id="c-41475649" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41477138">prev</a><span>|</span><a href="#41476515">next</a><span>|</span><label class="collapse" for="c-41475649">[-]</label><label class="expand" for="c-41475649">[5 more]</label></div><br/><div class="children"><div class="content">Why is there more latency?<p>Edit: Ah, I see OP&#x27;s code requests the webp separately. You can avoid the extra request if you write a self-extracting html&#x2F;webp polyglot file, as is typically done in the demoscene.</div><br/><div id="41478959" class="c"><input type="checkbox" id="c-41478959" checked=""/><div class="controls bullet"><span class="by">purplesyringa</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475649">parent</a><span>|</span><a href="#41475666">next</a><span>|</span><label class="collapse" for="c-41478959">[-]</label><label class="expand" for="c-41478959">[1 more]</label></div><br/><div class="children"><div class="content">Hmm? I&#x27;m not sure where you&#x27;re taking that from. The webp is inlined.</div><br/></div></div><div id="41475666" class="c"><input type="checkbox" id="c-41475666" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475649">parent</a><span>|</span><a href="#41478959">prev</a><span>|</span><a href="#41476515">next</a><span>|</span><label class="collapse" for="c-41475666">[-]</label><label class="expand" for="c-41475666">[3 more]</label></div><br/><div class="children"><div class="content">It takes more time for your message to get back and forth between your computer and the server than it takes for the server to pump out some extra bits.<p>Even if you transmit the js stuff inline, the op&#x27;s notion of time still just ignores the fact that it takes the caller time to even ask the server for the data in the first place, and at such small sizes that time swallows the time to transmit from the user&#x27;s perspective.</div><br/><div id="41475772" class="c"><input type="checkbox" id="c-41475772" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475666">parent</a><span>|</span><a href="#41476515">next</a><span>|</span><label class="collapse" for="c-41475772">[-]</label><label class="expand" for="c-41475772">[2 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s a demo that only uses a single request for the whole page load: <a href="https:&#x2F;&#x2F;retr0.id&#x2F;stuff&#x2F;bee_movie.webp.html" rel="nofollow">https:&#x2F;&#x2F;retr0.id&#x2F;stuff&#x2F;bee_movie.webp.html</a><p>It is technically 2 requests, but the second one is a cache hit, in my testing.</div><br/><div id="41475791" class="c"><input type="checkbox" id="c-41475791" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41475772">parent</a><span>|</span><a href="#41476515">next</a><span>|</span><label class="collapse" for="c-41475791">[-]</label><label class="expand" for="c-41475791">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s fine, but if you&#x27;re evaluating the amount of time it takes to load a webpage, you cannot ignore the time it takes for the client request to reach your server in the first place or for the client to then unpack the data. The time saved transmitting such a small number of bits will be a fraction of the time spent making that initial request anyway. That&#x27;s all I&#x27;m saying.<p>OP is only looking at transmit size differences, which is both not the same as transmit time differences and also not what the user actually experiences when requesting the page.</div><br/></div></div></div></div></div></div></div></div><div id="41476515" class="c"><input type="checkbox" id="c-41476515" checked=""/><div class="controls bullet"><span class="by">sleepydog</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41475649">prev</a><span>|</span><a href="#41475628">next</a><span>|</span><label class="collapse" for="c-41476515">[-]</label><label class="expand" for="c-41476515">[3 more]</label></div><br/><div class="children"><div class="content">Seriously, if you&#x27;re saving less than a TCP receive window&#x27;s worth of space it&#x27;s not going to make any difference to latency.<p>I suppose it could make a difference on lossy networks, but I&#x27;m not sure.</div><br/><div id="41476651" class="c"><input type="checkbox" id="c-41476651" checked=""/><div class="controls bullet"><span class="by">lelandfe</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476515">parent</a><span>|</span><a href="#41475628">next</a><span>|</span><label class="collapse" for="c-41476651">[-]</label><label class="expand" for="c-41476651">[2 more]</label></div><br/><div class="children"><div class="content">If the blob contains requests (images, but also stylesheets, JS, or worst case fonts), it will actually instead be a net negative to latency. The browser&#x27;s preload scanner begins fetching resources even before the HTML is finished being parsed. That can&#x27;t happen if the HTML doesn&#x27;t exist until after JS decodes it. In other words, the entire body has become a blocking resource.<p>These are similar conversations people have around hydration, by the by.</div><br/><div id="41478430" class="c"><input type="checkbox" id="c-41478430" checked=""/><div class="controls bullet"><span class="by">rrr_oh_man</span><span>|</span><a href="#41475528">root</a><span>|</span><a href="#41476651">parent</a><span>|</span><a href="#41475628">next</a><span>|</span><label class="collapse" for="c-41478430">[-]</label><label class="expand" for="c-41478430">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt; These are similar conversations people have around hydration</i><p>For the uninitiated: <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Hydration_(web_development)" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Hydration_(web_development)</a></div><br/></div></div></div></div></div></div><div id="41476756" class="c"><input type="checkbox" id="c-41476756" checked=""/><div class="controls bullet"><span class="by">fsndz</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41475628">prev</a><span>|</span><a href="#41475683">next</a><span>|</span><label class="collapse" for="c-41476756">[-]</label><label class="expand" for="c-41476756">[1 more]</label></div><br/><div class="children"><div class="content">exactly what I thought too</div><br/></div></div><div id="41475683" class="c"><input type="checkbox" id="c-41475683" checked=""/><div class="controls bullet"><span class="by">jgalt212</span><span>|</span><a href="#41475528">parent</a><span>|</span><a href="#41476756">prev</a><span>|</span><a href="#41475565">next</a><span>|</span><label class="collapse" for="c-41475683">[-]</label><label class="expand" for="c-41475683">[1 more]</label></div><br/><div class="children"><div class="content">I have similar feelings on js minification especially if you&#x27;re sending via gzip.</div><br/></div></div></div></div><div id="41475565" class="c"><input type="checkbox" id="c-41475565" checked=""/><div class="controls bullet"><span class="by">gkbrk</span><span>|</span><a href="#41475528">prev</a><span>|</span><a href="#41478207">next</a><span>|</span><label class="collapse" for="c-41475565">[-]</label><label class="expand" for="c-41475565">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Why readPixels is not subject to anti-fingerprinting is beyond me. It does not sprinkle hardly visible typos all over the page, so that works for me.<p>&gt; keep the styling and the top of the page (about 8 KiB uncompressed) in the gzipped HTML and only compress the content below the viewport with WebP<p>Ah, that explains why the article suddenly cut off after a random sentence, with an empty page that follows. I&#x27;m using LibreWolf which disables WebGL, and I use Chromium for random web games that need WebGL. The article worked just fine with WebGL enabled, neat technique to be honest.</div><br/><div id="41477004" class="c"><input type="checkbox" id="c-41477004" checked=""/><div class="controls bullet"><span class="by">niutech</span><span>|</span><a href="#41475565">parent</a><span>|</span><a href="#41478207">next</a><span>|</span><label class="collapse" for="c-41477004">[-]</label><label class="expand" for="c-41477004">[2 more]</label></div><br/><div class="children"><div class="content">It isn&#x27;t neat as long as it doesn&#x27;t work with all modern web browsers (even with fingerprinting protection) and doesn&#x27;t have a fallback for older browsers. WWW should be universally accessible and progressively enhanced, starting with plain HTML.</div><br/><div id="41477533" class="c"><input type="checkbox" id="c-41477533" checked=""/><div class="controls bullet"><span class="by">afavour</span><span>|</span><a href="#41475565">root</a><span>|</span><a href="#41477004">parent</a><span>|</span><a href="#41478207">next</a><span>|</span><label class="collapse" for="c-41477533">[-]</label><label class="expand" for="c-41477533">[1 more]</label></div><br/><div class="children"><div class="content">It isn’t a serious proposal. It’s a creative hack that no one, author included is suggesting should be used in production.</div><br/></div></div></div></div></div></div><div id="41478207" class="c"><input type="checkbox" id="c-41478207" checked=""/><div class="controls bullet"><span class="by">jfoster</span><span>|</span><a href="#41475565">prev</a><span>|</span><a href="#41479054">next</a><span>|</span><label class="collapse" for="c-41478207">[-]</label><label class="expand" for="c-41478207">[1 more]</label></div><br/><div class="children"><div class="content">I work on Batch Compress (<a href="https:&#x2F;&#x2F;batchcompress.com&#x2F;en" rel="nofollow">https:&#x2F;&#x2F;batchcompress.com&#x2F;en</a>) and recently added WebP support, then made it the default soon after.<p>As far as I know, it was already making the smallest JPEGs out of any of the web compression tools, but WebP was coming out only ~50% of the size of the JPEGs. It was an easy decision to make WebP the default not too long after adding support for it.<p>Quite a lot of people use the site, so I was anticipating some complaints after making WebP the default, but it&#x27;s been about a month and so far there has been only one complaint&#x2F;enquiry about WebP. It seems that almost all tools &amp; browsers now support WebP. I&#x27;ve only encountered one website recently where uploading a WebP image wasn&#x27;t handled correctly and blocked the next step. Almost everything supports it well these days.</div><br/></div></div><div id="41479054" class="c"><input type="checkbox" id="c-41479054" checked=""/><div class="controls bullet"><span class="by">phh</span><span>|</span><a href="#41478207">prev</a><span>|</span><a href="#41477935">next</a><span>|</span><label class="collapse" for="c-41479054">[-]</label><label class="expand" for="c-41479054">[1 more]</label></div><br/><div class="children"><div class="content">&gt; A real-world web page compressed with WebP? Oh, how about the one you’re reading right now? Unless you use an old browser or have JavaScript turned off, WebP compresses this page starting from the “Fool me twice” section. If you haven’t noticed this, I’m happy the trick is working :-)<p>Well it didn&#x27;t work in Materialistic (I guess their webview disable js), and the failure mode is really not comfortable.</div><br/></div></div><div id="41477935" class="c"><input type="checkbox" id="c-41477935" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41479054">prev</a><span>|</span><a href="#41475714">next</a><span>|</span><label class="collapse" for="c-41477935">[-]</label><label class="expand" for="c-41477935">[2 more]</label></div><br/><div class="children"><div class="content">It is actually possible to use Brotli directly in the web browser... with caveats of course. I believe my 2022 submission to JS1024 [1] is the first ever demonstration of this concept, and I also have a proof-of-concept code for the arbitrary compression (which sadly didn&#x27;t work for the original size-coding purpose though). The main caveat is that you are effectively limited to the ASCII character, and that it is highly sensitive to the rendering stack for the obvious reason---it no longer seems to function in Firefox right now.<p>[1] <a href="https:&#x2F;&#x2F;js1024.fun&#x2F;demos&#x2F;2022&#x2F;18&#x2F;readme" rel="nofollow">https:&#x2F;&#x2F;js1024.fun&#x2F;demos&#x2F;2022&#x2F;18&#x2F;readme</a><p>[2] <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;lifthrasiir&#x2F;1c7f9c5a421ad39c1af19a9c4f060743" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;lifthrasiir&#x2F;1c7f9c5a421ad39c1af19a9c...</a></div><br/><div id="41478964" class="c"><input type="checkbox" id="c-41478964" checked=""/><div class="controls bullet"><span class="by">purplesyringa</span><span>|</span><a href="#41477935">parent</a><span>|</span><a href="#41475714">next</a><span>|</span><label class="collapse" for="c-41478964">[-]</label><label class="expand" for="c-41478964">[1 more]</label></div><br/><div class="children"><div class="content">This technique is amazing and way cooler than my post. Kudos!</div><br/></div></div></div></div><div id="41475714" class="c"><input type="checkbox" id="c-41475714" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#41477935">prev</a><span>|</span><a href="#41477795">next</a><span>|</span><label class="collapse" for="c-41475714">[-]</label><label class="expand" for="c-41475714">[8 more]</label></div><br/><div class="children"><div class="content">Chromies got in the way of it for a very long time, but zstd is now coming to the web too, as it’s finally landed in chrome - now we’ve gotta get safari onboard</div><br/><div id="41475848" class="c"><input type="checkbox" id="c-41475848" checked=""/><div class="controls bullet"><span class="by">CharlesW</span><span>|</span><a href="#41475714">parent</a><span>|</span><a href="#41476217">next</a><span>|</span><label class="collapse" for="c-41475848">[-]</label><label class="expand" for="c-41475848">[1 more]</label></div><br/><div class="children"><div class="content">Looks like it&#x27;s on the To Do list, at least: <a href="https:&#x2F;&#x2F;webkit.org&#x2F;standards-positions&#x2F;#position-168" rel="nofollow">https:&#x2F;&#x2F;webkit.org&#x2F;standards-positions&#x2F;#position-168</a></div><br/></div></div><div id="41476217" class="c"><input type="checkbox" id="c-41476217" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41475714">parent</a><span>|</span><a href="#41475848">prev</a><span>|</span><a href="#41477795">next</a><span>|</span><label class="collapse" for="c-41476217">[-]</label><label class="expand" for="c-41476217">[6 more]</label></div><br/><div class="children"><div class="content">I’d love to go all-Zstandard, but in this particular case, as far as I know, Brotli and Zstandard are basically on par at identical values of decompressor memory consumption.</div><br/><div id="41477910" class="c"><input type="checkbox" id="c-41477910" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#41475714">root</a><span>|</span><a href="#41476217">parent</a><span>|</span><a href="#41476943">next</a><span>|</span><label class="collapse" for="c-41477910">[-]</label><label class="expand" for="c-41477910">[1 more]</label></div><br/><div class="children"><div class="content">Brotli and zstd are close, each trading in various configurations and cases - but zstd is muuuuuch more usable in a practical sense, because the code base can be easily compiled and linked against in a wider number of places with less effort, and the cli tools turn up all over for similar reasons. Brotli like many Google libraries in the last decade are infected with googlisms. Brotli is less bad, in a way, for example the C comes with zero build system at all, which is marginally better than a bazel disaster of generated stuff, but it’s still not in a state the average distro contributor gives a care to go turn into a library, prepare pkgconf rules for and whatnot - plus no versioning and so on. Oh and the tests are currently failing.</div><br/></div></div><div id="41476943" class="c"><input type="checkbox" id="c-41476943" checked=""/><div class="controls bullet"><span class="by">simondotau</span><span>|</span><a href="#41475714">root</a><span>|</span><a href="#41476217">parent</a><span>|</span><a href="#41477910">prev</a><span>|</span><a href="#41477795">next</a><span>|</span><label class="collapse" for="c-41476943">[-]</label><label class="expand" for="c-41476943">[4 more]</label></div><br/><div class="children"><div class="content">Realistically, everything should just support everything. There’s no reason why every (full featured) web server and every (full featured) web browser couldn’t support all compelling data compression algorithms.<p>Unfortunately we live in a world where Google decides to rip JPEG-XL support out of Chrome for seemingly no reason other than spite. If the reason was a lack of maturity in the underlying library, fine, but that wasn’t the reason they offered.</div><br/><div id="41477178" class="c"><input type="checkbox" id="c-41477178" checked=""/><div class="controls bullet"><span class="by">madeofpalk</span><span>|</span><a href="#41475714">root</a><span>|</span><a href="#41476943">parent</a><span>|</span><a href="#41477494">next</a><span>|</span><label class="collapse" for="c-41477178">[-]</label><label class="expand" for="c-41477178">[2 more]</label></div><br/><div class="children"><div class="content">&gt; There’s no reason<p>Of course, there is - and it&#x27;s really boring. Prioritisation, and maintenance.<p>It&#x27;s a big pain to add, say, 100 compressions formats and support them indefinitely, especially with little differentiation between them. Once we agree on what the upper bound of useless formats is, we can start to negotiate what the lower limit is.</div><br/><div id="41477890" class="c"><input type="checkbox" id="c-41477890" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#41475714">root</a><span>|</span><a href="#41477178">parent</a><span>|</span><a href="#41477494">next</a><span>|</span><label class="collapse" for="c-41477890">[-]</label><label class="expand" for="c-41477890">[1 more]</label></div><br/><div class="children"><div class="content">It’s not prioritization of the code - it’s relatively little implementation and low maintenance but security is critical here and everyone is very afraid of compressors because gzip, jpeg and various others were pretty bad. Zstd, unlike lz4 before it (at least early on) has a good amount of tests and fuzzing. The implementation could probably be safer (with fairly substantial effort) but having test and fuzzing coverage is a huge step forward over prior industry norms</div><br/></div></div></div></div><div id="41477494" class="c"><input type="checkbox" id="c-41477494" checked=""/><div class="controls bullet"><span class="by">rafaelmn</span><span>|</span><a href="#41475714">root</a><span>|</span><a href="#41476943">parent</a><span>|</span><a href="#41477178">prev</a><span>|</span><a href="#41477795">next</a><span>|</span><label class="collapse" for="c-41477494">[-]</label><label class="expand" for="c-41477494">[1 more]</label></div><br/><div class="children"><div class="content">How many CVEs came out of different file format handling across platforms ? Including shit in browsers has insane impact.</div><br/></div></div></div></div></div></div></div></div><div id="41477795" class="c"><input type="checkbox" id="c-41477795" checked=""/><div class="controls bullet"><span class="by">divbzero</span><span>|</span><a href="#41475714">prev</a><span>|</span><a href="#41475534">next</a><span>|</span><label class="collapse" for="c-41477795">[-]</label><label class="expand" for="c-41477795">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Typically, Brotli is better than gzip, and gzip is better than nothing. gzip is so cheap everyone enables it by default, but Brotli is way slower.</i><p>Note that <i>way slower</i> applies to speed of compression, not decompression. So Brotli is a good bet if you can precompress.<p>&gt; <i>Annoyingly, I host my blog on GitHub pages, which doesn’t support Brotli.</i><p>If your users all use modern browsers and you host static pages through a service like Cloudflare or CloudFront that supports custom HTTP headers, you can implement your own Brotli support by precompressing the static files with Brotli and adding a <i>Content-Encoding: br</i> HTTP header. This is kind of cheating because you are ignoring proper content negotiation with <i>Accept-Encoding</i>, but I’ve done it successfully for sites with targeted user bases.</div><br/></div></div><div id="41475534" class="c"><input type="checkbox" id="c-41475534" checked=""/><div class="controls bullet"><span class="by">98469056</span><span>|</span><a href="#41477795">prev</a><span>|</span><a href="#41476377">next</a><span>|</span><label class="collapse" for="c-41475534">[-]</label><label class="expand" for="c-41475534">[3 more]</label></div><br/><div class="children"><div class="content">While peeking at the source, I noticed that the doctype declaration is missing a space. It currently reads &lt;!doctypehtml&gt;, but it should be &lt;!doctype html&gt;</div><br/><div id="41478560" class="c"><input type="checkbox" id="c-41478560" checked=""/><div class="controls bullet"><span class="by">palsecam</span><span>|</span><a href="#41475534">parent</a><span>|</span><a href="#41477596">next</a><span>|</span><label class="collapse" for="c-41478560">[-]</label><label class="expand" for="c-41478560">[1 more]</label></div><br/><div class="children"><div class="content">`&lt;!doctype html&gt;` can be minified into `&lt;!doctypehtml&gt;`.<p>It’s, strictly speaking, invalid HTML, but it still successfully triggers standards mode.<p>See <a href="https:&#x2F;&#x2F;GitHub.com&#x2F;kangax&#x2F;html-minifier&#x2F;pull&#x2F;970">https:&#x2F;&#x2F;GitHub.com&#x2F;kangax&#x2F;html-minifier&#x2F;pull&#x2F;970</a> &#x2F; <a href="https:&#x2F;&#x2F;HTML.spec.WHATWG.org&#x2F;multipage&#x2F;parsing.html#parse-error-missing-whitespace-before-doctype-name" rel="nofollow">https:&#x2F;&#x2F;HTML.spec.WHATWG.org&#x2F;multipage&#x2F;parsing.html#parse-er...</a><p>(I too use that trick on <a href="https:&#x2F;&#x2F;FreeSolitaire.win" rel="nofollow">https:&#x2F;&#x2F;FreeSolitaire.win</a>)</div><br/></div></div><div id="41477596" class="c"><input type="checkbox" id="c-41477596" checked=""/><div class="controls bullet"><span class="by">BugsJustFindMe</span><span>|</span><a href="#41475534">parent</a><span>|</span><a href="#41478560">prev</a><span>|</span><a href="#41476377">next</a><span>|</span><label class="collapse" for="c-41477596">[-]</label><label class="expand" for="c-41477596">[1 more]</label></div><br/><div class="children"><div class="content">Maybe their javascript adds it back in :)</div><br/></div></div></div></div><div id="41476377" class="c"><input type="checkbox" id="c-41476377" checked=""/><div class="controls bullet"><span class="by">butz</span><span>|</span><a href="#41475534">prev</a><span>|</span><a href="#41475643">next</a><span>|</span><label class="collapse" for="c-41476377">[-]</label><label class="expand" for="c-41476377">[6 more]</label></div><br/><div class="children"><div class="content">Dropping google fonts should improve page load time a bit too, considering those are loaded from remote server that requires additional handshake.</div><br/><div id="41476433" class="c"><input type="checkbox" id="c-41476433" checked=""/><div class="controls bullet"><span class="by">kevindamm</span><span>|</span><a href="#41476377">parent</a><span>|</span><a href="#41475643">next</a><span>|</span><label class="collapse" for="c-41476433">[-]</label><label class="expand" for="c-41476433">[5 more]</label></div><br/><div class="children"><div class="content">..but if enough other sites are also using that font then it may already be available locally.</div><br/><div id="41476613" class="c"><input type="checkbox" id="c-41476613" checked=""/><div class="controls bullet"><span class="by">pornel</span><span>|</span><a href="#41476377">root</a><span>|</span><a href="#41476433">parent</a><span>|</span><a href="#41476639">next</a><span>|</span><label class="collapse" for="c-41476613">[-]</label><label class="expand" for="c-41476613">[3 more]</label></div><br/><div class="children"><div class="content">This has stopped working many years ago. Every top-level domain now has its own private cache <i>of all other domains</i>.<p>You likely have dozens of copies of Google Fonts, each in a separate silo, with absolutely zero reuse between websites.<p>This is because a global cache use to work like a cookie, and has been used for tracking.</div><br/><div id="41476711" class="c"><input type="checkbox" id="c-41476711" checked=""/><div class="controls bullet"><span class="by">kevindamm</span><span>|</span><a href="#41476377">root</a><span>|</span><a href="#41476613">parent</a><span>|</span><a href="#41477184">next</a><span>|</span><label class="collapse" for="c-41476711">[-]</label><label class="expand" for="c-41476711">[1 more]</label></div><br/><div class="children"><div class="content">ah, I had forgotten about that, you&#x27;re right.<p>well at least you don&#x27;t have to download it more than once for the site, but first impressions matter yeah</div><br/></div></div><div id="41477184" class="c"><input type="checkbox" id="c-41477184" checked=""/><div class="controls bullet"><span class="by">madeofpalk</span><span>|</span><a href="#41476377">root</a><span>|</span><a href="#41476613">parent</a><span>|</span><a href="#41476711">prev</a><span>|</span><a href="#41476639">next</a><span>|</span><label class="collapse" for="c-41477184">[-]</label><label class="expand" for="c-41477184">[1 more]</label></div><br/><div class="children"><div class="content">Where &quot;many years ago&quot; is... 11 years ago for Safari! <a href="https:&#x2F;&#x2F;bugs.webkit.org&#x2F;show_bug.cgi?id=110269" rel="nofollow">https:&#x2F;&#x2F;bugs.webkit.org&#x2F;show_bug.cgi?id=110269</a></div><br/></div></div></div></div><div id="41476639" class="c"><input type="checkbox" id="c-41476639" checked=""/><div class="controls bullet"><span class="by">SushiHippie</span><span>|</span><a href="#41476377">root</a><span>|</span><a href="#41476433">parent</a><span>|</span><a href="#41476613">prev</a><span>|</span><a href="#41475643">next</a><span>|</span><label class="collapse" for="c-41476639">[-]</label><label class="expand" for="c-41476639">[1 more]</label></div><br/><div class="children"><div class="content">No, because of cache partitioning, which has been a thing for a while.<p><a href="https:&#x2F;&#x2F;developer.chrome.com&#x2F;blog&#x2F;http-cache-partitioning" rel="nofollow">https:&#x2F;&#x2F;developer.chrome.com&#x2F;blog&#x2F;http-cache-partitioning</a></div><br/></div></div></div></div></div></div><div id="41475643" class="c"><input type="checkbox" id="c-41475643" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#41476377">prev</a><span>|</span><a href="#41476119">next</a><span>|</span><label class="collapse" for="c-41475643">[-]</label><label class="expand" for="c-41475643">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve used this trick before! Oddly enough I can&#x27;t remember <i>what</i> I used it for (perhaps just to see if I could), and I commented on it here: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;gasman&#x2F;2560551?permalink_comment_id=4431196#gistcomment-4431196" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;gasman&#x2F;2560551?permalink_comment_id=...</a><p>Edit: I found my prototype from way back, I guess I was just testing heh: <a href="https:&#x2F;&#x2F;retr0.id&#x2F;stuff&#x2F;bee_movie.webp.html" rel="nofollow">https:&#x2F;&#x2F;retr0.id&#x2F;stuff&#x2F;bee_movie.webp.html</a></div><br/><div id="41477962" class="c"><input type="checkbox" id="c-41477962" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41475643">parent</a><span>|</span><a href="#41476819">next</a><span>|</span><label class="collapse" for="c-41477962">[-]</label><label class="expand" for="c-41477962">[1 more]</label></div><br/><div class="children"><div class="content">In my experience WebP didn&#x27;t work well for the general case where this technique is actually useful (i.e. data less than 10 KB), because the most additions of WebP lossless to PNG are about modelling and not encoding, while this textual compression would only use the encoding part of WebP.</div><br/></div></div><div id="41476819" class="c"><input type="checkbox" id="c-41476819" checked=""/><div class="controls bullet"><span class="by">lucb1e</span><span>|</span><a href="#41475643">parent</a><span>|</span><a href="#41477962">prev</a><span>|</span><a href="#41476119">next</a><span>|</span><label class="collapse" for="c-41476819">[-]</label><label class="expand" for="c-41476819">[2 more]</label></div><br/><div class="children"><div class="content">That page breaks my mouse gestures add-on! (Or, I guess we don&#x27;t have add-ons anymore but rather something like script injections that we call extensions, yay...) Interesting approach to first deliver &#x27;garbage&#x27; and then append a bit of JS to transform it back into a page. The inner security nerd in me wonders if this might open up attacks if you would have some kind of user-supplied data, such as a comment form. One could probably find a sequence of bytes to comment that will, after compression, turn into a script tag, positioned (running) before yours would?</div><br/><div id="41477035" class="c"><input type="checkbox" id="c-41477035" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#41475643">root</a><span>|</span><a href="#41476819">parent</a><span>|</span><a href="#41476119">next</a><span>|</span><label class="collapse" for="c-41477035">[-]</label><label class="expand" for="c-41477035">[1 more]</label></div><br/><div class="children"><div class="content">Yeah that&#x27;s plausible, you definitely don&#x27;t want any kind of untrusted data in the input.<p>Something I wanted to do but clearly never got around to, was figuring out how to put an open-comment sequence (&lt;!--) in a header somewhere, so that most of the garbage gets commented out</div><br/></div></div></div></div></div></div><div id="41476119" class="c"><input type="checkbox" id="c-41476119" checked=""/><div class="controls bullet"><span class="by">niutech</span><span>|</span><a href="#41475643">prev</a><span>|</span><a href="#41476612">next</a><span>|</span><label class="collapse" for="c-41476119">[-]</label><label class="expand" for="c-41476119">[3 more]</label></div><br/><div class="children"><div class="content">This page is broken at least on Sailfish OS browser, there is a long empty space after the paragraph:<p>&gt; Alright, so we’re dealing with 92 KiB for gzip vs 37 + 71 KiB for Brotli. Umm…<p>That said, the overhead of gzip vs brotli HTML compression is nothing compared with amount of JS&#x2F;images&#x2F;video current websites use.</div><br/><div id="41476358" class="c"><input type="checkbox" id="c-41476358" checked=""/><div class="controls bullet"><span class="by">mediumsmart</span><span>|</span><a href="#41476119">parent</a><span>|</span><a href="#41476612">next</a><span>|</span><label class="collapse" for="c-41476358">[-]</label><label class="expand" for="c-41476358">[2 more]</label></div><br/><div class="children"><div class="content">same on orion and safari and librewolf - is this a chrome page?</div><br/><div id="41476610" class="c"><input type="checkbox" id="c-41476610" checked=""/><div class="controls bullet"><span class="by">simmonmt</span><span>|</span><a href="#41476119">root</a><span>|</span><a href="#41476358">parent</a><span>|</span><a href="#41476612">next</a><span>|</span><label class="collapse" for="c-41476610">[-]</label><label class="expand" for="c-41476610">[1 more]</label></div><br/><div class="children"><div class="content">A different comment says librewolf disables webgl by default, breaking OP&#x27;s decompression. Is that what you&#x27;re seeing?</div><br/></div></div></div></div></div></div><div id="41476612" class="c"><input type="checkbox" id="c-41476612" checked=""/><div class="controls bullet"><span class="by">gildas</span><span>|</span><a href="#41476119">prev</a><span>|</span><a href="#41475360">next</a><span>|</span><label class="collapse" for="c-41476612">[-]</label><label class="expand" for="c-41476612">[1 more]</label></div><br/><div class="children"><div class="content">In the same vein, you can package HTML pages as self-extracting ZIP files with SingleFile [1]. You can even include a PNG image to produce files compatible with HTML, ZIP and PNG [2], and for example display the PNG image in the HTML page [3].<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile?tab=readme-ov-file#file-format-comparison">https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile?tab=readme-ov-f...</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;Polyglot-HTML-ZIP-PNG">https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;Polyglot-HTML-ZIP-PNG</a><p>[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;Polyglot-HTML-ZIP-PNG&#x2F;raw&#x2F;main&#x2F;demo.png.zip.html">https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;Polyglot-HTML-ZIP-PNG&#x2F;raw&#x2F;...</a></div><br/></div></div><div id="41475360" class="c"><input type="checkbox" id="c-41475360" checked=""/><div class="controls bullet"><span class="by">next_xibalba</span><span>|</span><a href="#41476612">prev</a><span>|</span><a href="#41476748">next</a><span>|</span><label class="collapse" for="c-41475360">[-]</label><label class="expand" for="c-41475360">[24 more]</label></div><br/><div class="children"><div class="content">If only we hadn&#x27;t lost Jan Sloot&#x27;s Digital Coding System [1], we&#x27;d be able to transmit GB in milliseconds across the web!<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sloot_Digital_Coding_System" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sloot_Digital_Coding_System</a></div><br/><div id="41475452" class="c"><input type="checkbox" id="c-41475452" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#41475360">parent</a><span>|</span><a href="#41476504">next</a><span>|</span><label class="collapse" for="c-41475452">[-]</label><label class="expand" for="c-41475452">[14 more]</label></div><br/><div class="children"><div class="content">This claim itself is probably a hoax and not relevant to the article at hand; but these days with text-to-image models and browser support, you could probably do something like &lt;img prompt=&quot;...&quot;&gt; and have the browser render something that matches the description, similar to the &quot;cookbook&quot; analogy used in the Wikipedia article.</div><br/><div id="41475471" class="c"><input type="checkbox" id="c-41475471" checked=""/><div class="controls bullet"><span class="by">Lorin</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475452">parent</a><span>|</span><a href="#41476008">next</a><span>|</span><label class="collapse" for="c-41475471">[-]</label><label class="expand" for="c-41475471">[8 more]</label></div><br/><div class="children"><div class="content">That&#x27;s an interesting concept, although it would generate a ton of bogomips since each client has to generate the image themselves instead of one time on the server.<p>You&#x27;d also want &quot;seed&quot; and &quot;engine&quot; attributes to ensure all visitors see the same result.</div><br/><div id="41476401" class="c"><input type="checkbox" id="c-41476401" checked=""/><div class="controls bullet"><span class="by">onion2k</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475471">parent</a><span>|</span><a href="#41475516">next</a><span>|</span><label class="collapse" for="c-41476401">[-]</label><label class="expand" for="c-41476401">[2 more]</label></div><br/><div class="children"><div class="content">Unless you don&#x27;t actually care if everyone sees the same results. So long as the generated image is approximately what you prompted for, and the content of the image is decorative so it doesn&#x27;t really need to be a specific, accurate representation of something, it&#x27;s fine to display a different picture for every user.<p>One of the best uses of responsive design I&#x27;ve ever seen was a site that looked <i>completely</i> different at different breakpoints - different theme, font, images, and content. It&#x27;s was beautiful, and creative, and fun. Lots of users saw different things and had no idea other versions were there.</div><br/><div id="41476735" class="c"><input type="checkbox" id="c-41476735" checked=""/><div class="controls bullet"><span class="by">semolino</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476401">parent</a><span>|</span><a href="#41475516">next</a><span>|</span><label class="collapse" for="c-41476735">[-]</label><label class="expand" for="c-41476735">[1 more]</label></div><br/><div class="children"><div class="content">What site are you referring to?</div><br/></div></div></div></div><div id="41475516" class="c"><input type="checkbox" id="c-41475516" checked=""/><div class="controls bullet"><span class="by">LeoPanthera</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475471">parent</a><span>|</span><a href="#41476401">prev</a><span>|</span><a href="#41476008">next</a><span>|</span><label class="collapse" for="c-41475516">[-]</label><label class="expand" for="c-41475516">[5 more]</label></div><br/><div class="children"><div class="content">You could at least push the work closer to the edge, by having genAI servers on each LAN, and in each ISP, similar to the idea of a caching web proxy before HTTPS rendered them impossible.</div><br/><div id="41475576" class="c"><input type="checkbox" id="c-41475576" checked=""/><div class="controls bullet"><span class="by">lucianbr</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475516">parent</a><span>|</span><a href="#41476008">next</a><span>|</span><label class="collapse" for="c-41475576">[-]</label><label class="expand" for="c-41475576">[4 more]</label></div><br/><div class="children"><div class="content">Push the work closer to the edge, <i>and multiply</i> it by quite a lot. Generate each image many times. Why would we want this? Seems like the opposite of caching in a sense.</div><br/><div id="41475912" class="c"><input type="checkbox" id="c-41475912" checked=""/><div class="controls bullet"><span class="by">sroussey</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475576">parent</a><span>|</span><a href="#41476581">next</a><span>|</span><label class="collapse" for="c-41475912">[-]</label><label class="expand" for="c-41475912">[2 more]</label></div><br/><div class="children"><div class="content">If you are reading a web page on mars and bandwidth is more precious than processing power, then &lt;img prompt=“…”&gt; might make sense.<p>Not so much for us on earth however.</div><br/><div id="41476069" class="c"><input type="checkbox" id="c-41476069" checked=""/><div class="controls bullet"><span class="by">roywiggins</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475912">parent</a><span>|</span><a href="#41476581">next</a><span>|</span><label class="collapse" for="c-41476069">[-]</label><label class="expand" for="c-41476069">[1 more]</label></div><br/><div class="children"><div class="content">This sort of thing (but applied to video) is a plot point in <i>A Fire Upon The Deep</i>. Vinge&#x27;s term for the result is an &quot;evocation.&quot;</div><br/></div></div></div></div><div id="41476581" class="c"><input type="checkbox" id="c-41476581" checked=""/><div class="controls bullet"><span class="by">bobbylarrybobby</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475576">parent</a><span>|</span><a href="#41475912">prev</a><span>|</span><a href="#41476008">next</a><span>|</span><label class="collapse" for="c-41476581">[-]</label><label class="expand" for="c-41476581">[1 more]</label></div><br/><div class="children"><div class="content">All compression is, in a sense, the opposite of caching. You have to do more work to get the data, but you save space.</div><br/></div></div></div></div></div></div></div></div><div id="41476008" class="c"><input type="checkbox" id="c-41476008" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475452">parent</a><span>|</span><a href="#41475471">prev</a><span>|</span><a href="#41476586">next</a><span>|</span><label class="collapse" for="c-41476008">[-]</label><label class="expand" for="c-41476008">[1 more]</label></div><br/><div class="children"><div class="content">Similar to what Samsung does if you take a picture of the moon.</div><br/></div></div><div id="41476586" class="c"><input type="checkbox" id="c-41476586" checked=""/><div class="controls bullet"><span class="by">everforward</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475452">parent</a><span>|</span><a href="#41476008">prev</a><span>|</span><a href="#41475532">next</a><span>|</span><label class="collapse" for="c-41476586">[-]</label><label class="expand" for="c-41476586">[2 more]</label></div><br/><div class="children"><div class="content">Similar ideas have floated around for a while. I’ve always enjoyed the elegance of compressing things down to a start and end index of digits of Pi.<p>It’s utterly impractical, but fun to muse about how neat it would be if it weren’t.</div><br/><div id="41477102" class="c"><input type="checkbox" id="c-41477102" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476586">parent</a><span>|</span><a href="#41475532">next</a><span>|</span><label class="collapse" for="c-41477102">[-]</label><label class="expand" for="c-41477102">[1 more]</label></div><br/><div class="children"><div class="content">AFAIK it&#x27;s not been proved that every combination does exist in π.<p>By comparison, you could easily define a number that goes 0,123456789101112131415… and use indexes to that number. However the index would probably be larger than what you&#x27;re trying to encode.</div><br/></div></div></div></div><div id="41475532" class="c"><input type="checkbox" id="c-41475532" checked=""/><div class="controls bullet"><span class="by">7bit</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475452">parent</a><span>|</span><a href="#41476586">prev</a><span>|</span><a href="#41476504">next</a><span>|</span><label class="collapse" for="c-41475532">[-]</label><label class="expand" for="c-41475532">[2 more]</label></div><br/><div class="children"><div class="content">That would require a lot of GBs in libraries in the browser and a lot of processing power on the client CPU to render an image that is so unimportant that it doesn&#x27;t really matter if it shows exactly what the author intended. To summarize that in three words: a useless technology.<p>That idea is something that is only cool in theory.</div><br/><div id="41476587" class="c"><input type="checkbox" id="c-41476587" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41475532">parent</a><span>|</span><a href="#41476504">next</a><span>|</span><label class="collapse" for="c-41476587">[-]</label><label class="expand" for="c-41476587">[1 more]</label></div><br/><div class="children"><div class="content">At least for LLMs, something very similar is already happening: <a href="https:&#x2F;&#x2F;huggingface.co&#x2F;blog&#x2F;Xenova&#x2F;run-gemini-nano-in-your-browser" rel="nofollow">https:&#x2F;&#x2F;huggingface.co&#x2F;blog&#x2F;Xenova&#x2F;run-gemini-nano-in-your-b...</a><p>Currently, we&#x27;re definitely not there in terms of space&#x2F;time tradeoffs for images, but I could imagine at least parameterized ML-based upscaling (i.e. ship a low-resolution image and possibly a textual description, have a local model upscale it to display resolution) at some point.</div><br/></div></div></div></div></div></div><div id="41476504" class="c"><input type="checkbox" id="c-41476504" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475360">parent</a><span>|</span><a href="#41475452">prev</a><span>|</span><a href="#41476152">next</a><span>|</span><label class="collapse" for="c-41476504">[-]</label><label class="expand" for="c-41476504">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The Sloot Digital Coding System is an alleged data sharing technique that its inventor claimed could store a complete digital movie file in 8 kilobytes of data<p>8 kilobytes? Rookie numbers. I&#x27;ll do it in 256 bytes, as long as you&#x27;re fine with a somewhat limited selection of available digital movie files ;)</div><br/><div id="41477231" class="c"><input type="checkbox" id="c-41477231" checked=""/><div class="controls bullet"><span class="by">MBCook</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476504">parent</a><span>|</span><a href="#41476152">next</a><span>|</span><label class="collapse" for="c-41477231">[-]</label><label class="expand" for="c-41477231">[1 more]</label></div><br/><div class="children"><div class="content">I can shrink any file down to just 32 bits using my unique method.<p>I call it the High Amplitude Shrinkage Heuristic, or H.A.S.H.<p>It is also reversible, but only safely to the last encoded file due to quantum hyperspace entanglement of ionic bonds. H.A.S.H.ing a different file will disrupt them preventing recovery of the original data.</div><br/></div></div></div></div><div id="41476152" class="c"><input type="checkbox" id="c-41476152" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#41475360">parent</a><span>|</span><a href="#41476504">prev</a><span>|</span><a href="#41475810">next</a><span>|</span><label class="collapse" for="c-41476152">[-]</label><label class="expand" for="c-41476152">[4 more]</label></div><br/><div class="children"><div class="content">Reminds me of when I was like 13 and learned about CRC codes for the first time. Infinite compression here we come! Just calculate the 32bit CRC code for say 64 bits, transmit the CRC, then on the other hand just loop over all possible 64 bit numbers until you got the same CRC. So brilliant! Why wasn&#x27;t this already used?!<p>Of course, the downsides became apparent once the euphoria had faded.</div><br/><div id="41476597" class="c"><input type="checkbox" id="c-41476597" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476152">parent</a><span>|</span><a href="#41476243">next</a><span>|</span><label class="collapse" for="c-41476597">[-]</label><label class="expand" for="c-41476597">[1 more]</label></div><br/><div class="children"><div class="content">Very relatable! &quot;If this MD5 hash uniquely identifies that entire movie, why would anyone need to ever send the actual... Oh, I get it.&quot;<p>Arguably the cruelest implication of the pigeonhole principle.</div><br/></div></div><div id="41476243" class="c"><input type="checkbox" id="c-41476243" checked=""/><div class="controls bullet"><span class="by">_factor</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476152">parent</a><span>|</span><a href="#41476597">prev</a><span>|</span><a href="#41476589">next</a><span>|</span><label class="collapse" for="c-41476243">[-]</label><label class="expand" for="c-41476243">[1 more]</label></div><br/><div class="children"><div class="content">Even better, take a physical object and slice it precisely in a ratio that contains your data in the fraction!</div><br/></div></div></div></div><div id="41475810" class="c"><input type="checkbox" id="c-41475810" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#41475360">parent</a><span>|</span><a href="#41476152">prev</a><span>|</span><a href="#41476362">next</a><span>|</span><label class="collapse" for="c-41475810">[-]</label><label class="expand" for="c-41475810">[1 more]</label></div><br/><div class="children"><div class="content">Time Lords probably, saving us from the inevitable end of this technology path, where all data in the universe is compressed into one bit which leads to an information-theoretic black hole that destroys everything.</div><br/></div></div><div id="41476362" class="c"><input type="checkbox" id="c-41476362" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#41475360">parent</a><span>|</span><a href="#41475810">prev</a><span>|</span><a href="#41476748">next</a><span>|</span><label class="collapse" for="c-41476362">[-]</label><label class="expand" for="c-41476362">[2 more]</label></div><br/><div class="children"><div class="content">The real version of this is  Nvidia&#x27;s web conferencing demo where they make a 3d model of your face and then only transfer the wireframe movements which is super clever.<p><a href="https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=TQy3EU8BCmo" rel="nofollow">https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=TQy3EU8BCmo</a><p>You can really feel the &quot;compute has massively outpaced networking speed&quot; where this kind of thing is actually practical. Maybe I&#x27;ll see 10G residential in my lifetime.</div><br/><div id="41476621" class="c"><input type="checkbox" id="c-41476621" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#41475360">root</a><span>|</span><a href="#41476362">parent</a><span>|</span><a href="#41476748">next</a><span>|</span><label class="collapse" for="c-41476621">[-]</label><label class="expand" for="c-41476621">[1 more]</label></div><br/><div class="children"><div class="content">This messages comes to you via a 10Gbps, $50 residential fiber connection.<p>The future is already here – it&#x27;s just not very evenly distributed.</div><br/></div></div></div></div></div></div><div id="41476748" class="c"><input type="checkbox" id="c-41476748" checked=""/><div class="controls bullet"><span class="by">somishere</span><span>|</span><a href="#41475360">prev</a><span>|</span><a href="#41476468">next</a><span>|</span><label class="collapse" for="c-41476748">[-]</label><label class="expand" for="c-41476748">[1 more]</label></div><br/><div class="children"><div class="content">Lots of nice tricks in here, definitely fun! Only minor nitpick is that it departs fairly rapidly from the lede ... which espouses the dual virtues of an accessible and js-optional reading experience ;)</div><br/></div></div><div id="41476468" class="c"><input type="checkbox" id="c-41476468" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41476748">prev</a><span>|</span><a href="#41476981">next</a><span>|</span><label class="collapse" for="c-41476468">[-]</label><label class="expand" for="c-41476468">[7 more]</label></div><br/><div class="children"><div class="content">From the linked Github issue giving the rationale why Brotli is not available in the CompressionStream API:<p>&gt; As far as I know, browsers are only shipping the decompression dictionary. Brotli has a separate dictionary needed for compression, which would significantly increase the size of the browser.<p>How can the decompression dictionary be smaller than the compression one? Does the latter contain something like a space-time tradeoff in the form of precalculated most efficient representations of given input substrings or something similar?</div><br/><div id="41477984" class="c"><input type="checkbox" id="c-41477984" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41476468">parent</a><span>|</span><a href="#41477341">next</a><span>|</span><label class="collapse" for="c-41477984">[-]</label><label class="expand" for="c-41477984">[3 more]</label></div><br/><div class="children"><div class="content">I believe the compression dictionary refers to [1], which is used to quickly match dictionary-compressable byte sequences. I don&#x27;t know where 170 KB comes from, but that hash alone does take 128 KiB and might be significant if it can&#x27;t be easily recomputed. But I&#x27;m sure that it can be quickly computed on the loading time if the binary size is that important.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;brotli&#x2F;blob&#x2F;master&#x2F;c&#x2F;enc&#x2F;dictionary_hash.c">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;brotli&#x2F;blob&#x2F;master&#x2F;c&#x2F;enc&#x2F;dictionar...</a></div><br/><div id="41478004" class="c"><input type="checkbox" id="c-41478004" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41476468">root</a><span>|</span><a href="#41477984">parent</a><span>|</span><a href="#41477341">next</a><span>|</span><label class="collapse" for="c-41478004">[-]</label><label class="expand" for="c-41478004">[2 more]</label></div><br/><div class="children"><div class="content">I was wondering that too, but that dictionary itself compresses down to 29 KB (using regular old gzip), so it seems pretty lightweight to include even if it were hard&#x2F;annoying to precompute at runtime or install time.</div><br/><div id="41478092" class="c"><input type="checkbox" id="c-41478092" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41476468">root</a><span>|</span><a href="#41478004">parent</a><span>|</span><a href="#41477341">next</a><span>|</span><label class="collapse" for="c-41478092">[-]</label><label class="expand" for="c-41478092">[1 more]</label></div><br/><div class="children"><div class="content">Once installed it will occupy 128 KiB of data though, so it might be still relevant for the Chromium team.</div><br/></div></div></div></div></div></div><div id="41477341" class="c"><input type="checkbox" id="c-41477341" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#41476468">parent</a><span>|</span><a href="#41477984">prev</a><span>|</span><a href="#41476981">next</a><span>|</span><label class="collapse" for="c-41477341">[-]</label><label class="expand" for="c-41477341">[3 more]</label></div><br/><div class="children"><div class="content">Perhaps I&#x27;m reading past some of the surrounding context but that doesn&#x27;t actually say the problem is about the relative sizes, just that the compression dictionary isn&#x27;t already in browsers while the decompression dictionary already is.<p>It&#x27;s a bit disappointing you can&#x27;t use Brotli in the DecompressionStream() interface just because it may or may not be available in the CompressionStream() interface though.</div><br/><div id="41477968" class="c"><input type="checkbox" id="c-41477968" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#41476468">root</a><span>|</span><a href="#41477341">parent</a><span>|</span><a href="#41476981">next</a><span>|</span><label class="collapse" for="c-41477968">[-]</label><label class="expand" for="c-41477968">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m actually not convinced that there are two different dictionaries at all. The Brotli RFC only talks about a static dictionary, not a separate encoding vs. a decoding dictionary.<p>My suspicion is that this is a confusion of the (runtime) sliding window, which limits maximum required memory on the decoder&#x27;s side to 16 MB, with the actual shared static dictionary (which needs to be present in the decoder only, as far as I can tell; the encoder can use it, and if it does, it would be the same one the decoder has as well).</div><br/><div id="41478181" class="c"><input type="checkbox" id="c-41478181" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#41476468">root</a><span>|</span><a href="#41477968">parent</a><span>|</span><a href="#41476981">next</a><span>|</span><label class="collapse" for="c-41478181">[-]</label><label class="expand" for="c-41478181">[1 more]</label></div><br/><div class="children"><div class="content">IIRC from working with Brotli before it&#x27;s not that the it&#x27;s truly a &quot;different dictionary&quot; but rather more like a &quot;reverse view&quot; of what is ultimately the same dictionary mappings.<p>On one hand it seems a bit silly to worry about ~100 KB in browser for what will probably, on average, save more than that in upload&#x2F;download the first time it is used. On the other hand &quot;it&#x27;s just a few hundred KB&quot; each release for a few hundred releases ends up being a lot of cruft you can&#x27;t remove without breaking old stuff. On the third hand coming out of our head... it&#x27;s not like Chrome has been against shipping more for functionality for features they&#x27;d like to impose on users even if users don&#x27;t actually want them anyways so what are small ones users can actually benefit from against that.</div><br/></div></div></div></div></div></div></div></div><div id="41476981" class="c"><input type="checkbox" id="c-41476981" checked=""/><div class="controls bullet"><span class="by">Pesthuf</span><span>|</span><a href="#41476468">prev</a><span>|</span><a href="#41476208">next</a><span>|</span><label class="collapse" for="c-41476981">[-]</label><label class="expand" for="c-41476981">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s impressive how close this is to Brotli even though brotli has this massive pre-shared dictionary. Is the actual compression algorithm used by it just worse, or does the dictionary just matter much less than I think?</div><br/><div id="41477993" class="c"><input type="checkbox" id="c-41477993" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41476981">parent</a><span>|</span><a href="#41476208">next</a><span>|</span><label class="collapse" for="c-41477993">[-]</label><label class="expand" for="c-41477993">[1 more]</label></div><br/><div class="children"><div class="content">Pre-shared dictionary is most effective for the small size that can&#x27;t reach the stationary distribution required for typical compressors. I don&#x27;t know the exact threshold, but my best guess is around 1--10 KB.</div><br/></div></div></div></div><div id="41476208" class="c"><input type="checkbox" id="c-41476208" checked=""/><div class="controls bullet"><span class="by">Dibby053</span><span>|</span><a href="#41476981">prev</a><span>|</span><a href="#41476694">next</a><span>|</span><label class="collapse" for="c-41476208">[-]</label><label class="expand" for="c-41476208">[4 more]</label></div><br/><div class="children"><div class="content">I didn&#x27;t know canvas anti-fingerprinting was so rudimentary. I don&#x27;t think it increases uniqueness (the noise is different every run) but bypassing it seems trivial: run the thing n times and take the mode. With so little noise, 4 or 5 times should be more than enough.</div><br/><div id="41476340" class="c"><input type="checkbox" id="c-41476340" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#41476208">parent</a><span>|</span><a href="#41476694">next</a><span>|</span><label class="collapse" for="c-41476340">[-]</label><label class="expand" for="c-41476340">[3 more]</label></div><br/><div class="children"><div class="content">The article says it’s predictable within a given client, so your trick wouldn’t work.<p>So, just use the anti-fingerprint noise as a cookie, I guess?</div><br/><div id="41476567" class="c"><input type="checkbox" id="c-41476567" checked=""/><div class="controls bullet"><span class="by">Dibby053</span><span>|</span><a href="#41476208">root</a><span>|</span><a href="#41476340">parent</a><span>|</span><a href="#41476694">next</a><span>|</span><label class="collapse" for="c-41476567">[-]</label><label class="expand" for="c-41476567">[2 more]</label></div><br/><div class="children"><div class="content">Huh, it seems it&#x27;s just my browser that resets the noise every run.<p>I opened the page in Firefox like the article suggests and I get a different pattern per site and session. That prevents using the noise as a supercookie, I think, if its pattern changes every time cookies are deleted.</div><br/><div id="41476769" class="c"><input type="checkbox" id="c-41476769" checked=""/><div class="controls bullet"><span class="by">sunaookami</span><span>|</span><a href="#41476208">root</a><span>|</span><a href="#41476567">parent</a><span>|</span><a href="#41476694">next</a><span>|</span><label class="collapse" for="c-41476769">[-]</label><label class="expand" for="c-41476769">[1 more]</label></div><br/><div class="children"><div class="content">It is different per site and per session, yes.</div><br/></div></div></div></div></div></div></div></div><div id="41476694" class="c"><input type="checkbox" id="c-41476694" checked=""/><div class="controls bullet"><span class="by">astrostl</span><span>|</span><a href="#41476208">prev</a><span>|</span><a href="#41475797">next</a><span>|</span><label class="collapse" for="c-41476694">[-]</label><label class="expand" for="c-41476694">[3 more]</label></div><br/><div class="children"><div class="content">Things I seek in an image format:<p>(1) compatibility<p>(2) features<p>WebP still seems far behind on (1) to me so I don&#x27;t care about the rest. I hope it gets there, though, because folks like this seem pretty enthusiastic about (2).</div><br/><div id="41478305" class="c"><input type="checkbox" id="c-41478305" checked=""/><div class="controls bullet"><span class="by">jfoster</span><span>|</span><a href="#41476694">parent</a><span>|</span><a href="#41477380">next</a><span>|</span><label class="collapse" for="c-41478305">[-]</label><label class="expand" for="c-41478305">[1 more]</label></div><br/><div class="children"><div class="content">The compatibility gap on WebP is already quite small. Every significant web browser now supports it. Almost all image tools &amp; viewers do as well.<p>Lossy WebP comes out a lot smaller than JPEG. It&#x27;s definitely worth taking the saving.</div><br/></div></div><div id="41477380" class="c"><input type="checkbox" id="c-41477380" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#41476694">parent</a><span>|</span><a href="#41478305">prev</a><span>|</span><a href="#41475797">next</a><span>|</span><label class="collapse" for="c-41477380">[-]</label><label class="expand" for="c-41477380">[1 more]</label></div><br/><div class="children"><div class="content">agree - webp has a lib on Linux but somehow, standard image viewers just do not read it, so -&gt; &quot;FAIL&quot;</div><br/></div></div></div></div><div id="41475797" class="c"><input type="checkbox" id="c-41475797" checked=""/><div class="controls bullet"><span class="by">csjh</span><span>|</span><a href="#41476694">prev</a><span>|</span><a href="#41476755">next</a><span>|</span><label class="collapse" for="c-41475797">[-]</label><label class="expand" for="c-41475797">[5 more]</label></div><br/><div class="children"><div class="content">I think the most surprising part here is the gzipped-base64&#x27;d-compressed data almost entirely removes the base64 overhead.</div><br/><div id="41477402" class="c"><input type="checkbox" id="c-41477402" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#41475797">parent</a><span>|</span><a href="#41477395">next</a><span>|</span><label class="collapse" for="c-41477402">[-]</label><label class="expand" for="c-41477402">[3 more]</label></div><br/><div class="children"><div class="content">It feels somewhat intuitive since (as the article notes) the Huffman encoding stage effectively &quot;reverses&quot; the original base64 overhead issue that an 8 bit (256 choices) index is used for 6 bits (64 choices) of actual characters. A useful compression algorithm which _didn&#x27;t_ do this sort of thing would be very surprising as it would mean it doesn&#x27;t notice simple patterns in the data but somehow compresses things anyways.</div><br/><div id="41477419" class="c"><input type="checkbox" id="c-41477419" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#41475797">root</a><span>|</span><a href="#41477402">parent</a><span>|</span><a href="#41477395">next</a><span>|</span><label class="collapse" for="c-41477419">[-]</label><label class="expand" for="c-41477419">[2 more]</label></div><br/><div class="children"><div class="content">how does it affect error correction though?</div><br/><div id="41477634" class="c"><input type="checkbox" id="c-41477634" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#41475797">root</a><span>|</span><a href="#41477419">parent</a><span>|</span><a href="#41477395">next</a><span>|</span><label class="collapse" for="c-41477634">[-]</label><label class="expand" for="c-41477634">[1 more]</label></div><br/><div class="children"><div class="content">Neither base64 nor the gzipped version have error correction as implemented. The extra overhead bits in base64 come from selecting only a subset of printable characters, not by adding redundancy to the useful bits.</div><br/></div></div></div></div></div></div></div></div><div id="41476755" class="c"><input type="checkbox" id="c-41476755" checked=""/><div class="controls bullet"><span class="by">bogzz</span><span>|</span><a href="#41475797">prev</a><span>|</span><a href="#41475878">next</a><span>|</span><label class="collapse" for="c-41476755">[-]</label><label class="expand" for="c-41476755">[1 more]</label></div><br/><div class="children"><div class="content">Still waiting on a webp encoder to be added to the Go stdlib...</div><br/></div></div><div id="41475878" class="c"><input type="checkbox" id="c-41475878" checked=""/><div class="controls bullet"><span class="by">galaxyLogic</span><span>|</span><a href="#41476755">prev</a><span>|</span><a href="#41476397">next</a><span>|</span><label class="collapse" for="c-41475878">[-]</label><label class="expand" for="c-41475878">[2 more]</label></div><br/><div class="children"><div class="content">Is there a tool or some other way to easily encode a JPG image so it can be embedded into HTML?  I know there is something like that, but is it easy? Could it be made easier?</div><br/><div id="41475931" class="c"><input type="checkbox" id="c-41475931" checked=""/><div class="controls bullet"><span class="by">throwanem</span><span>|</span><a href="#41475878">parent</a><span>|</span><a href="#41476397">next</a><span>|</span><label class="collapse" for="c-41475931">[-]</label><label class="expand" for="c-41475931">[1 more]</label></div><br/><div class="children"><div class="content">You can convert it to base64 and inline it anywhere an image URL is accepted, eg<p><pre><code>    &lt;img src=&quot;data:image&#x2F;jpeg;base64,abc123...&quot; &#x2F;&gt;
</code></pre>
(Double-check the exact syntax and the MIME type before you use it; it&#x27;s been a few years since I have, and this example is from perhaps imperfect memory.)</div><br/></div></div></div></div><div id="41476397" class="c"><input type="checkbox" id="c-41476397" checked=""/><div class="controls bullet"><span class="by">butz</span><span>|</span><a href="#41475878">prev</a><span>|</span><a href="#41478723">next</a><span>|</span><label class="collapse" for="c-41476397">[-]</label><label class="expand" for="c-41476397">[2 more]</label></div><br/><div class="children"><div class="content">I wonder what is the difference in CPU usage on client side for WebP variant vs standard HTML? Are you causing more battery drain on visitor devices?</div><br/><div id="41476860" class="c"><input type="checkbox" id="c-41476860" checked=""/><div class="controls bullet"><span class="by">lucb1e</span><span>|</span><a href="#41476397">parent</a><span>|</span><a href="#41478723">next</a><span>|</span><label class="collapse" for="c-41476860">[-]</label><label class="expand" for="c-41476860">[1 more]</label></div><br/><div class="children"><div class="content">It depends. Quite often (this is how you can tell I live in Germany) mobile data switches to &quot;you&#x27;re at the EDGE of the network range&quot; mode¹ and transferring a few KB means keeping the screen on and radio active for a couple of minutes. If the page is now 45KB instead of 95KB, that&#x27;s a significant reduction in battery drain!<p><i>Under normal circumstances</i> you&#x27;re probably very right<p>¹ Now I wonder if the makers foresaw how their protocol name might sound to us now</div><br/></div></div></div></div><div id="41478723" class="c"><input type="checkbox" id="c-41478723" checked=""/><div class="controls bullet"><span class="by">Jamie9912</span><span>|</span><a href="#41476397">prev</a><span>|</span><a href="#41476309">next</a><span>|</span><label class="collapse" for="c-41478723">[-]</label><label class="expand" for="c-41478723">[1 more]</label></div><br/><div class="children"><div class="content">Why don&#x27;t they make zstd images surely that would beat webp</div><br/></div></div><div id="41476309" class="c"><input type="checkbox" id="c-41476309" checked=""/><div class="controls bullet"><span class="by">toddmorey</span><span>|</span><a href="#41478723">prev</a><span>|</span><a href="#41475929">next</a><span>|</span><label class="collapse" for="c-41476309">[-]</label><label class="expand" for="c-41476309">[1 more]</label></div><br/><div class="children"><div class="content">&quot;I hope you see where I’m going with this and are yelling &#x27;Oh why the fuck&#x27; right now.&quot;<p>I love reading blogpost like these.</div><br/></div></div><div id="41475929" class="c"><input type="checkbox" id="c-41475929" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#41476309">prev</a><span>|</span><a href="#41477412">next</a><span>|</span><label class="collapse" for="c-41475929">[-]</label><label class="expand" for="c-41475929">[1 more]</label></div><br/><div class="children"><div class="content">I <i>loved</i> that (encoding stuff in <i>webp</i>) but my takeaway from the figures in the article is this: brotli is so good I&#x27;ll host from somewhere where I can serve brotli (when and if the client supports brotli ofc).</div><br/></div></div><div id="41477412" class="c"><input type="checkbox" id="c-41477412" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#41475929">prev</a><span>|</span><a href="#41477411">next</a><span>|</span><label class="collapse" for="c-41477412">[-]</label><label class="expand" for="c-41477412">[2 more]</label></div><br/><div class="children"><div class="content">&gt;ensure it works without JavaScript enabled<p>&gt;manually decompress it in JavaScript<p>&gt;Brotli decompressor in WASM<p>the irony seems lost</div><br/><div id="41478992" class="c"><input type="checkbox" id="c-41478992" checked=""/><div class="controls bullet"><span class="by">purplesyringa</span><span>|</span><a href="#41477412">parent</a><span>|</span><a href="#41477411">next</a><span>|</span><label class="collapse" for="c-41478992">[-]</label><label class="expand" for="c-41478992">[1 more]</label></div><br/><div class="children"><div class="content">A nojs version is compiled separately and is linked via a meta refresh. Not ideal, and I could add some safeguards for people without webgl, but I&#x27;m not an idiot.</div><br/></div></div></div></div><div id="41477411" class="c"><input type="checkbox" id="c-41477411" checked=""/><div class="controls bullet"><span class="by">ajsnigrutin</span><span>|</span><a href="#41477412">prev</a><span>|</span><a href="#41475380">next</a><span>|</span><label class="collapse" for="c-41477411">[-]</label><label class="expand" for="c-41477411">[1 more]</label></div><br/><div class="children"><div class="content">So... 60kB less of transfer... and how much slower is it on an eg. galaxy s8 phone my mom has, because of all the shenanigans done to save those 60kB?</div><br/></div></div><div id="41475380" class="c"><input type="checkbox" id="c-41475380" checked=""/><div class="controls bullet"><span class="by">niceguy4</span><span>|</span><a href="#41477411">prev</a><span>|</span><a href="#41476666">next</a><span>|</span><label class="collapse" for="c-41475380">[-]</label><label class="expand" for="c-41475380">[2 more]</label></div><br/><div class="children"><div class="content">Not to side track the conversation but to side track the conversation, has there been many other major WebP exploits like the serious one in the past?</div><br/></div></div></div></div></div></div></div></body></html>