<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1729501267894" as="style"/><link rel="stylesheet" href="styles.css?v=1729501267894"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://bgolus.medium.com/the-best-darn-grid-shader-yet-727f9278b9d8">The Best Darn Grid Shader (Yet) (2023)</a> <span class="domain">(<a href="https://bgolus.medium.com">bgolus.medium.com</a>)</span></div><div class="subtext"><span>eliasylonen</span> | <span>20 comments</span></div><br/><div><div id="41900125" class="c"><input type="checkbox" id="c-41900125" checked=""/><div class="controls bullet"><span class="by">nightowl_games</span><span>|</span><a href="#41896916">next</a><span>|</span><label class="collapse" for="c-41900125">[-]</label><label class="expand" for="c-41900125">[1 more]</label></div><br/><div class="children"><div class="content">&quot;Which, if you’re like me and didn’t finish their college level math courses, means absolutely nothing. I dropped out of art school, so it’s mostly over my head.&quot;<p>This is why Ben Golus&#x27;s posts on shaders are the best. Cause they&#x27;re actually accessible.</div><br/></div></div><div id="41896916" class="c"><input type="checkbox" id="c-41896916" checked=""/><div class="controls bullet"><span class="by">singron</span><span>|</span><a href="#41900125">prev</a><span>|</span><a href="#41898592">next</a><span>|</span><label class="collapse" for="c-41896916">[-]</label><label class="expand" for="c-41896916">[2 more]</label></div><br/><div class="children"><div class="content">This was really interesting. I don&#x27;t love the fading out to solve the moire in the final solution. I wonder if some dithering would feel better and give the impression there are lines out there rather than a smooth gray surface? Or maybe some jitter to break up the pattern?<p>This isn&#x27;t shown in the post, but sometimes the moire feels worse if you are walking around and the moire has a movement of its own (either flickering&#x2F;shimmering or sweeping across in uv space), and it&#x27;s probably a decent benefit to get rid of the moire even if it&#x27;s imperfect.</div><br/><div id="41901338" class="c"><input type="checkbox" id="c-41901338" checked=""/><div class="controls bullet"><span class="by">LegionMammal978</span><span>|</span><a href="#41896916">parent</a><span>|</span><a href="#41898592">next</a><span>|</span><label class="collapse" for="c-41901338">[-]</label><label class="expand" for="c-41901338">[1 more]</label></div><br/><div class="children"><div class="content">As far as dithering-while-in-motion goes, Lucas Pope has a whole series of posts [0] [1] [2] [3] [4] on his various attempts at implementing the 1-bit dithering effect for his game <i>Return of the Obra Dinn</i>. It seems like for every strategy that does work well, there are many more that don&#x27;t (or at least, not at the scale he applies it).<p>[0] <a href="https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg1045205#msg1045205" rel="nofollow">https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg104520...</a><p>[1] <a href="https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg1045555#msg1045555" rel="nofollow">https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg104555...</a><p>[2] <a href="https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg1217196#msg1217196" rel="nofollow">https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg121719...</a><p>[3] <a href="https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg1359120#msg1359120" rel="nofollow">https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg135912...</a><p>[4] <a href="https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg1363742#msg1363742" rel="nofollow">https:&#x2F;&#x2F;forums.tigsource.com&#x2F;index.php?topic=40832.msg136374...</a></div><br/></div></div></div></div><div id="41898592" class="c"><input type="checkbox" id="c-41898592" checked=""/><div class="controls bullet"><span class="by">arandomhuman</span><span>|</span><a href="#41896916">prev</a><span>|</span><a href="#41896813">next</a><span>|</span><label class="collapse" for="c-41898592">[-]</label><label class="expand" for="c-41898592">[3 more]</label></div><br/><div class="children"><div class="content">This is really awesome. to ask a dumb question, what’s a good way to get acclimated with running and building shaders? Just going straight to OpenGL tooling and extrapolating from there?</div><br/><div id="41898762" class="c"><input type="checkbox" id="c-41898762" checked=""/><div class="controls bullet"><span class="by">joenot443</span><span>|</span><a href="#41898592">parent</a><span>|</span><a href="#41896813">next</a><span>|</span><label class="collapse" for="c-41898762">[-]</label><label class="expand" for="c-41898762">[2 more]</label></div><br/><div class="children"><div class="content">Book of Shaders + ShaderToy is how a lot of people cut their teeth.</div><br/><div id="41901858" class="c"><input type="checkbox" id="c-41901858" checked=""/><div class="controls bullet"><span class="by">animal531</span><span>|</span><a href="#41898592">root</a><span>|</span><a href="#41898762">parent</a><span>|</span><a href="#41896813">next</a><span>|</span><label class="collapse" for="c-41901858">[-]</label><label class="expand" for="c-41901858">[1 more]</label></div><br/><div class="children"><div class="content">What makes ShaderToy great is the extremely fast turnaround time.<p>Make changes, compile (in e.g. &lt; 0.1s) and you immediately see the result. In Unity&#x2F;Unreal you can also work on them, and in certain places you can see results in near real time too, but it takes a few more clicks and saves etc.</div><br/></div></div></div></div></div></div><div id="41896813" class="c"><input type="checkbox" id="c-41896813" checked=""/><div class="controls bullet"><span class="by">tobr</span><span>|</span><a href="#41898592">prev</a><span>|</span><a href="#41896315">next</a><span>|</span><label class="collapse" for="c-41896813">[-]</label><label class="expand" for="c-41896813">[4 more]</label></div><br/><div class="children"><div class="content">Looks very interesting. I’m confused by the note in the intro though:<p>&gt; Note: I highly recommend viewing this article in dark mode.<p>I’m trying, but it seems like Medium doesn’t even have a dark mode? Is this reposted from somewhere else?</div><br/><div id="41900387" class="c"><input type="checkbox" id="c-41900387" checked=""/><div class="controls bullet"><span class="by">soulofmischief</span><span>|</span><a href="#41896813">parent</a><span>|</span><a href="#41896948">next</a><span>|</span><label class="collapse" for="c-41900387">[-]</label><label class="expand" for="c-41900387">[1 more]</label></div><br/><div class="children"><div class="content">Plugins are unnecessary. On the right side of your address bar in Firefox should be a little icon of a page. Click it to enter Reader View, which can apply various themes to a page.<p>More information: <a href="https:&#x2F;&#x2F;support.mozilla.org&#x2F;en-US&#x2F;kb&#x2F;firefox-reader-view-clutter-free-web-pages" rel="nofollow">https:&#x2F;&#x2F;support.mozilla.org&#x2F;en-US&#x2F;kb&#x2F;firefox-reader-view-clu...</a></div><br/></div></div><div id="41896948" class="c"><input type="checkbox" id="c-41896948" checked=""/><div class="controls bullet"><span class="by">drdebug</span><span>|</span><a href="#41896813">parent</a><span>|</span><a href="#41900387">prev</a><span>|</span><a href="#41900212">next</a><span>|</span><label class="collapse" for="c-41896948">[-]</label><label class="expand" for="c-41896948">[1 more]</label></div><br/><div class="children"><div class="content">You can install the &quot;Dark Reader&quot; plugin on Firefox, works great.</div><br/></div></div><div id="41900212" class="c"><input type="checkbox" id="c-41900212" checked=""/><div class="controls bullet"><span class="by">Chilko</span><span>|</span><a href="#41896813">parent</a><span>|</span><a href="#41896948">prev</a><span>|</span><a href="#41896315">next</a><span>|</span><label class="collapse" for="c-41900212">[-]</label><label class="expand" for="c-41900212">[1 more]</label></div><br/><div class="children"><div class="content">I assumed this was a general note regarding browser settings. I used the &#x27;Immersive Reader&#x27; mode in Edge and set that to a dark mode.</div><br/></div></div></div></div><div id="41896315" class="c"><input type="checkbox" id="c-41896315" checked=""/><div class="controls bullet"><span class="by">slimbuck</span><span>|</span><a href="#41896813">prev</a><span>|</span><a href="#41900201">next</a><span>|</span><label class="collapse" for="c-41896315">[-]</label><label class="expand" for="c-41896315">[2 more]</label></div><br/><div class="children"><div class="content">I love this article! I used it as a basis for the multi-level grid in SuperSplat (<a href="https:&#x2F;&#x2F;playcanvas.com&#x2F;supersplat&#x2F;editor" rel="nofollow">https:&#x2F;&#x2F;playcanvas.com&#x2F;supersplat&#x2F;editor</a>).</div><br/></div></div><div id="41900201" class="c"><input type="checkbox" id="c-41900201" checked=""/><div class="controls bullet"><span class="by">bschwindHN</span><span>|</span><a href="#41896315">prev</a><span>|</span><a href="#41896782">next</a><span>|</span><label class="collapse" for="c-41900201">[-]</label><label class="expand" for="c-41900201">[1 more]</label></div><br/><div class="children"><div class="content">This is great! I have a little viewer app for a code-based CAD tool and I&#x27;ve been delaying making a grid for it as I haven&#x27;t found a satisfactory solution for it until I just read this article :)</div><br/></div></div><div id="41896782" class="c"><input type="checkbox" id="c-41896782" checked=""/><div class="controls bullet"><span class="by">unclad5968</span><span>|</span><a href="#41900201">prev</a><span>|</span><a href="#41901911">next</a><span>|</span><label class="collapse" for="c-41896782">[-]</label><label class="expand" for="c-41896782">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s awesome so much effort was put into rendering a grid. Great write up.</div><br/></div></div><div id="41901911" class="c"><input type="checkbox" id="c-41901911" checked=""/><div class="controls bullet"><span class="by">exDM69</span><span>|</span><a href="#41896782">prev</a><span>|</span><a href="#41898220">next</a><span>|</span><label class="collapse" for="c-41901911">[-]</label><label class="expand" for="c-41901911">[1 more]</label></div><br/><div class="children"><div class="content">I have an even better darn grid shader that I use in my graphics projects.<p>The shader in this article wants to emulate the look of a sampled texture so that it blurs to medium gray at distance while avoiding moire patterns. And it does indeed look quite good at what it&#x27;s aiming for.<p>I on the other hand wanted an &quot;infinitely zoomable grid paper&quot; look with constant-ish pixel width lines, such that the density of the grid changes. If applied to a &quot;ground&quot; plane, the grid gets sparser near the horizon. When you zoom in, the grid gets denser with a new &quot;decade&quot; of grid fading in with the old grid fading out.<p>I generally apply this to a &quot;full screen triangle&quot;, and do a raycast against the ground plane (e.g. the y = 0 plane) and extract the &quot;uv&quot; coordinates from the raycast result (that would be the x,z coordinate of the ray hit). I&#x27;ve also applied this technique to a skybox, where I take the view ray direction unit vector and convert it to spherical coordinates (latitude, longitude) for the UV.<p>This shader gives a very clean looking grid at almost any viewing angle and distance. If your world space units are meters, this can be zoomed in from nanometers to gigameters while looking crisp and clean. Unfortunately, floating point issues take over after that point and there are some pixel artifacts when the camera is very close to the ground plane and the viewing angle is extreme. This could be fixed by adding some clamping to the the `log_width` variable, but I haven&#x27;t bothered with that as I don&#x27;t work in nanometers in computer graphics projects. There&#x27;s also some flickering at the horizon line, which I&#x27;ve solved with a trivial fade out factor (not visible in the source code below).<p>As it is shown below, it&#x27;ll show a grid with a subdivision factor of 10, like millimeter paper with the primary grid in centimeters and secondary grid in millimeters. The subdivision can be changed by adjusting the `base` and `N` variables. See the comments for explanation.<p>Here&#x27;s the thing in all its glory. Apologies that I don&#x27;t have a screenshot hosted where I could share. Please let me know if you&#x27;re trying this out in your projects.<p><pre><code>    float grid(vec2 uv, float linewidth) {
        vec2 width = linewidth * fwidth(uv);
        vec2 grid = abs(fract(uv - 0.5) - 0.5) &#x2F; width;
        float line = min(1.0, min(grid.x, grid.y));
        return 1.0 - line;
    }

    float decade_grid(vec2 uv) {
        &#x2F;&#x2F; grid subdivision factor (logarithm base)
        float base = 10.0;
        &#x2F;&#x2F; grid density, primary grid is approximately base^N pixels wide
        &#x2F;&#x2F; with N = 3, primary grid is 100 pixels, secondary grid 10 px
        float N = 3.0; &#x2F;&#x2F; 3.0 is the densest grid that does not have moire patterns

        &#x2F;&#x2F; approximate grid cell size using screen space uv partial derivatives
        vec2 width = fwidth(uv);
        &#x2F;&#x2F;vec2 width = vec2(length(dFdx(uv)), length(dFdy(uv)));
        float w = max(width.x, width.y);
        &#x2F;&#x2F;float w = length(width.xy);

        &#x2F;&#x2F; take logarithm of grid cell size to find zoom factor
        float log_width = log2(w) &#x2F; log2(base); &#x2F;&#x2F; logarithm change of base

        &#x2F;&#x2F; round down to find grid zoom factor (power of ten)
        float exponent = -floor(log_width) - N;
        float blend = 1.0 - fract(log_width); &#x2F;&#x2F; blend between powers of ten

        &#x2F;&#x2F; primary grid with wider lines
        float grid1 = grid(uv * pow(base, exponent), 1.0 + blend);
        &#x2F;&#x2F; secondary grid with narrow lines
        float grid2 = grid(uv * pow(base, exponent + 1.0), 1.0);

        &#x2F;&#x2F; mix primary and secondary grid with linear interpolation
        return mix(grid1, grid2, blend);
    }</code></pre></div><br/></div></div><div id="41898220" class="c"><input type="checkbox" id="c-41898220" checked=""/><div class="controls bullet"><span class="by">ansgri</span><span>|</span><a href="#41901911">prev</a><span>|</span><a href="#41901246">next</a><span>|</span><label class="collapse" for="c-41898220">[-]</label><label class="expand" for="c-41898220">[1 more]</label></div><br/><div class="children"><div class="content">Very nice, I&#x27;d use it as one of the starting points if I was to learn 3D graphics as it touches upon a lot of math details in a seemingly simple problem.</div><br/></div></div><div id="41901246" class="c"><input type="checkbox" id="c-41901246" checked=""/><div class="controls bullet"><span class="by">zadler</span><span>|</span><a href="#41898220">prev</a><span>|</span><a href="#41898356">next</a><span>|</span><label class="collapse" for="c-41901246">[-]</label><label class="expand" for="c-41901246">[1 more]</label></div><br/><div class="children"><div class="content">Can’t wait to try this.</div><br/></div></div></div></div></div></div></div></body></html>