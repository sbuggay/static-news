<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728637262492" as="style"/><link rel="stylesheet" href="styles.css?v=1728637262492"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.changs.co.uk/typeddicts-are-better-than-you-think.html">TypedDicts are better than you think</a> <span class="domain">(<a href="https://blog.changs.co.uk">blog.changs.co.uk</a>)</span></div><div class="subtext"><span>rbanffy</span> | <span>88 comments</span></div><br/><div><div id="41805604" class="c"><input type="checkbox" id="c-41805604" checked=""/><div class="controls bullet"><span class="by">binary132</span><span>|</span><a href="#41804093">next</a><span>|</span><label class="collapse" for="c-41805604">[-]</label><label class="expand" for="c-41805604">[41 more]</label></div><br/><div class="children"><div class="content">I feel like the dynamic typing crowd are slowly coming around to the fact that having a typesystem is just better.<p>While we’re on the topic, a better typesystem is better than a worse typesystem.  Thanks for coming to my TED talk.</div><br/><div id="41806753" class="c"><input type="checkbox" id="c-41806753" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41805877">next</a><span>|</span><label class="collapse" for="c-41806753">[-]</label><label class="expand" for="c-41806753">[18 more]</label></div><br/><div class="children"><div class="content">I don’t think that’s strictly true. Python developers are finding there are advantages to having a type system in larger programs such as readability and a reduction in certain classes of bugs.<p>That said, I’ve found Python’s approach lets me still build things through experimentation then fixing the types when I’m a bit more confident that I’ve built the right thing.<p>As a comparison, I found Go really clunky when I tried to learn it because it wouldn’t compile if the code wasn’t totally correct. It makes it hard to find the right solution through experimentation.</div><br/><div id="41807291" class="c"><input type="checkbox" id="c-41807291" checked=""/><div class="controls bullet"><span class="by">noelwelsh</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806753">parent</a><span>|</span><a href="#41807203">next</a><span>|</span><label class="collapse" for="c-41807291">[-]</label><label class="expand" for="c-41807291">[2 more]</label></div><br/><div class="children"><div class="content">Two things here:<p>1. You need to understand how to express concepts in a form the type system can understand. Each type system will have patterns it understands, and patterns it does not.<p>2. Go isn&#x27;t a great example. It has a Java-circa-2000 type system. Modern type systems are much more expressive.</div><br/><div id="41807609" class="c"><input type="checkbox" id="c-41807609" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807291">parent</a><span>|</span><a href="#41807203">next</a><span>|</span><label class="collapse" for="c-41807609">[-]</label><label class="expand" for="c-41807609">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Go isn&#x27;t a great example.<p>I picked Go as an example of a language that gets a lot of praise specifically for having strict compiler rules.<p>I&#x27;ve also tried Scala and found it clunky but I do suspect most of its problems came from the insane operator overloading and opaque build system rather than the type system. I understand it&#x27;s gotten better since I looked 8 years ago but I&#x27;ve not had a reason to check it out again.</div><br/></div></div></div></div><div id="41807203" class="c"><input type="checkbox" id="c-41807203" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806753">parent</a><span>|</span><a href="#41807291">prev</a><span>|</span><a href="#41806847">next</a><span>|</span><label class="collapse" for="c-41807203">[-]</label><label class="expand" for="c-41807203">[5 more]</label></div><br/><div class="children"><div class="content">Python’s problem is that there’s multiple 3rd party type checkers and they all disagree in subtle ways about what the spec says. It’s a mess.<p>Python is probably an all-round better language than JavaScript. But typescript absolutely embarrasses Python’s “gradual” type system with just how good it is in comparison.</div><br/><div id="41807484" class="c"><input type="checkbox" id="c-41807484" checked=""/><div class="controls bullet"><span class="by">setopt</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807203">parent</a><span>|</span><a href="#41807216">next</a><span>|</span><label class="collapse" for="c-41807484">[-]</label><label class="expand" for="c-41807484">[1 more]</label></div><br/><div class="children"><div class="content">I would love to instead have one official upstream runtime type checker which can be enabled per function, class, or module via decorators. Basically, providing opt-in strong typing as a language feature.<p>Currently, I’m using the third-party Beartype decorators to provide this feature, but I would prefer something built-in and ideally something with more readable error messages for users when type errors occur, which might be easier to provide if it was built into Python.<p>(I use Pyright too, but I find the runtime type checking to be more robust since it understands also the types returned by highly dynamic untyped code.)</div><br/></div></div><div id="41807216" class="c"><input type="checkbox" id="c-41807216" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807203">parent</a><span>|</span><a href="#41807484">prev</a><span>|</span><a href="#41806847">next</a><span>|</span><label class="collapse" for="c-41807216">[-]</label><label class="expand" for="c-41807216">[3 more]</label></div><br/><div class="children"><div class="content">I don’t see that as a problem since you’re not going to run multiple type checkers over your code, much like most C++ codebases pick a compiler and stick to it.</div><br/><div id="41807326" class="c"><input type="checkbox" id="c-41807326" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807216">parent</a><span>|</span><a href="#41806847">next</a><span>|</span><label class="collapse" for="c-41807326">[-]</label><label class="expand" for="c-41807326">[2 more]</label></div><br/><div class="children"><div class="content">Nobody wants to recreate the mess of mutually incompatible c++ compilers.<p>And it does matter when 3rd party libraries are involved. Types are a wonderful gift to anyone who imports &amp; needs to figure out your library.</div><br/><div id="41807595" class="c"><input type="checkbox" id="c-41807595" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807326">parent</a><span>|</span><a href="#41806847">next</a><span>|</span><label class="collapse" for="c-41807595">[-]</label><label class="expand" for="c-41807595">[1 more]</label></div><br/><div class="children"><div class="content">&gt; And it does matter when 3rd party libraries are involved.<p>That&#x27;s a fair point.</div><br/></div></div></div></div></div></div></div></div><div id="41806847" class="c"><input type="checkbox" id="c-41806847" checked=""/><div class="controls bullet"><span class="by">sinfulprogeny</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806753">parent</a><span>|</span><a href="#41807203">prev</a><span>|</span><a href="#41807342">next</a><span>|</span><label class="collapse" for="c-41806847">[-]</label><label class="expand" for="c-41806847">[6 more]</label></div><br/><div class="children"><div class="content">&gt; then fixing the types<p>man I wish my coworkers did this step</div><br/><div id="41807188" class="c"><input type="checkbox" id="c-41807188" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806847">parent</a><span>|</span><a href="#41807342">next</a><span>|</span><label class="collapse" for="c-41807188">[-]</label><label class="expand" for="c-41807188">[5 more]</label></div><br/><div class="children"><div class="content">Having CI hard fail definitely helps. I won’t pretend I’d be so judicious without it.</div><br/><div id="41807560" class="c"><input type="checkbox" id="c-41807560" checked=""/><div class="controls bullet"><span class="by">camjw</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807188">parent</a><span>|</span><a href="#41807342">next</a><span>|</span><label class="collapse" for="c-41807560">[-]</label><label class="expand" for="c-41807560">[4 more]</label></div><br/><div class="children"><div class="content">Sorry this is probably a stupid question - how do you make your CI hard fail if you don&#x27;t have types? This sounds like the missing piece for me, someone who also prefers just to crack on without types and then add them later.</div><br/><div id="41807584" class="c"><input type="checkbox" id="c-41807584" checked=""/><div class="controls bullet"><span class="by">spacemanspiffii</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807560">parent</a><span>|</span><a href="#41807588">next</a><span>|</span><label class="collapse" for="c-41807584">[-]</label><label class="expand" for="c-41807584">[1 more]</label></div><br/><div class="children"><div class="content">You can add `mypy` to your CI pipeline <a href="https:&#x2F;&#x2F;mypy.readthedocs.io&#x2F;en&#x2F;stable&#x2F;running_mypy.html" rel="nofollow">https:&#x2F;&#x2F;mypy.readthedocs.io&#x2F;en&#x2F;stable&#x2F;running_mypy.html</a>. Pyright is an alternative, and there are more.</div><br/></div></div><div id="41807588" class="c"><input type="checkbox" id="c-41807588" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807560">parent</a><span>|</span><a href="#41807584">prev</a><span>|</span><a href="#41807633">next</a><span>|</span><label class="collapse" for="c-41807588">[-]</label><label class="expand" for="c-41807588">[1 more]</label></div><br/><div class="children"><div class="content">I was referring more specifically to fixing the types. It looks like it&#x27;s possible to enforce type-hinting with config files to mypy (but I&#x27;ve not tried it): <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;55944201&#x2F;python-type-hinting-how-do-i-enforce-that-project-wide" rel="nofollow">https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;55944201&#x2F;python-type-hin...</a></div><br/></div></div><div id="41807633" class="c"><input type="checkbox" id="c-41807633" checked=""/><div class="controls bullet"><span class="by">jascha_eng</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807560">parent</a><span>|</span><a href="#41807588">prev</a><span>|</span><a href="#41807342">next</a><span>|</span><label class="collapse" for="c-41807633">[-]</label><label class="expand" for="c-41807633">[1 more]</label></div><br/><div class="children"><div class="content">Run mypy in strict mode and make that check required.</div><br/></div></div></div></div></div></div></div></div><div id="41807342" class="c"><input type="checkbox" id="c-41807342" checked=""/><div class="controls bullet"><span class="by">pif</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806753">parent</a><span>|</span><a href="#41806847">prev</a><span>|</span><a href="#41805877">next</a><span>|</span><label class="collapse" for="c-41807342">[-]</label><label class="expand" for="c-41807342">[4 more]</label></div><br/><div class="children"><div class="content">&gt; it wouldn’t compile if the code wasn’t totally correct.<p>Oh, the horror! How could it dare?<p>If ever I saw a line screaming the &quot;spoiled brat&quot; equivalent for programmers, this is it! Please, do not ever come next to my working place, we have enough problems already.</div><br/><div id="41807362" class="c"><input type="checkbox" id="c-41807362" checked=""/><div class="controls bullet"><span class="by">noelwelsh</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807342">parent</a><span>|</span><a href="#41807570">next</a><span>|</span><label class="collapse" for="c-41807362">[-]</label><label class="expand" for="c-41807362">[2 more]</label></div><br/><div class="children"><div class="content">This is both rude and ignorant. There is great value to exploration and experimentation, particularly for beginner programmers. Type systems do get in the way, and I say this as someone with 20+ years experience of modern (Scala, Haskell) type systems.</div><br/><div id="41807627" class="c"><input type="checkbox" id="c-41807627" checked=""/><div class="controls bullet"><span class="by">pif</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807362">parent</a><span>|</span><a href="#41807570">next</a><span>|</span><label class="collapse" for="c-41807627">[-]</label><label class="expand" for="c-41807627">[1 more]</label></div><br/><div class="children"><div class="content">&gt; There is great value to exploration and experimentation<p>I agree. Typing in some code and trying to compile it is experimentation. Trying to fix the error in your code is exploration. Discarding the compiler&#x27;s output as getting in the way means ignoring very, very precious advice.</div><br/></div></div></div></div><div id="41807570" class="c"><input type="checkbox" id="c-41807570" checked=""/><div class="controls bullet"><span class="by">scott_w</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41807342">parent</a><span>|</span><a href="#41807362">prev</a><span>|</span><a href="#41805877">next</a><span>|</span><label class="collapse" for="c-41807570">[-]</label><label class="expand" for="c-41807570">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Please, do not ever come next to my working place<p>Ok, I won&#x27;t.<p>&gt; we have enough problems already.<p>I agree.</div><br/></div></div></div></div></div></div><div id="41805877" class="c"><input type="checkbox" id="c-41805877" checked=""/><div class="controls bullet"><span class="by">btilly</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41806753">prev</a><span>|</span><a href="#41806355">next</a><span>|</span><label class="collapse" for="c-41805877">[-]</label><label class="expand" for="c-41805877">[9 more]</label></div><br/><div class="children"><div class="content">No. It&#x27;s that when people who prefer type systems go to use a popular dynamic language, they try to drag in features that they like from other languages.<p>Very honestly, optional type systems tend to be the worst of all worlds. Because people who don&#x27;t care, don&#x27;t need to use it, you don&#x27;t get safety. But people who enjoy ceremony can inflict verbosity on others. While missing the most important reason to do it.</div><br/><div id="41806631" class="c"><input type="checkbox" id="c-41806631" checked=""/><div class="controls bullet"><span class="by">gklitz</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41805877">parent</a><span>|</span><a href="#41806404">next</a><span>|</span><label class="collapse" for="c-41806631">[-]</label><label class="expand" for="c-41806631">[2 more]</label></div><br/><div class="children"><div class="content">&gt; No. It&#x27;s that when people who prefer type systems go to use a popular dynamic language, they try to drag in features that they like from other languages.<p>Very much. The “problem” people try to solve with things like dependency injection isn’t even a problem in python. 99.99% of the time you can just import you dependencies everywhere they are needed.<p>So many times now I’ve had to unteach bulky OOP patterns for people coming from strictly typed languages to python believe are “good practices” or are “needed for reliable code” and you go from 20 different interdependent classes down to 3 functions that just directly do what they are supposed to do. 
And you always end up with someone being disappointed that all of these complex patterns they learned to solve problems that don’t exist in python aren’t needed, rather than someone just happy that you can proceed directly to a value adding solution and skip the crud and design pattern spam.<p>And then they start arguing crazy stuff like the 200 extra lines unneeded code makes the solution “more readable” or “more reliable”, when in reality it’s just a desire to use the solutions they are used to even when the problems don’t exist.</div><br/><div id="41807582" class="c"><input type="checkbox" id="c-41807582" checked=""/><div class="controls bullet"><span class="by">indigo945</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806631">parent</a><span>|</span><a href="#41806404">next</a><span>|</span><label class="collapse" for="c-41807582">[-]</label><label class="expand" for="c-41807582">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  &gt; The “problem” people try to   
  &gt; solve with things like  
  &gt; dependency injection isn’t  
  &gt; even a problem in python.  
  &gt; 99.99% of the time you can  
  &gt; just import you dependencies  
  &gt; everywhere they are needed.
</code></pre>
That&#x27;s... Just not the problem DI fixes in any language? Sure, in C++ or Java you can just create a global static instance and use that everywhere. That&#x27;s pretty much equivalent to just importing the same thing everywhere. But the downside of both approaches is testability: it becomes much harder to test units in isolation when they access global resources.<p>Consider a function with `import datetime`, that gets the current time and does something with it. You want to make sure that this function still does the right thing in the extreme case of the current time being 23:59:59. How do you write this test without DI?</div><br/></div></div></div></div><div id="41806404" class="c"><input type="checkbox" id="c-41806404" checked=""/><div class="controls bullet"><span class="by">binary132</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41805877">parent</a><span>|</span><a href="#41806631">prev</a><span>|</span><a href="#41806328">next</a><span>|</span><label class="collapse" for="c-41806404">[-]</label><label class="expand" for="c-41806404">[2 more]</label></div><br/><div class="children"><div class="content">I’m not into the whole optional typing thing either.  I would consider that far down the “worse typesystem” end of the spectrum I mentioned, only slightly better than “types are just arbitrary labels the language doesn’t even know about”, which is maybe even worse than lean dynamic typesystems, because you might make the mistake of believing in the shadows on the wall.</div><br/><div id="41806955" class="c"><input type="checkbox" id="c-41806955" checked=""/><div class="controls bullet"><span class="by">jimmaswell</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806404">parent</a><span>|</span><a href="#41806328">next</a><span>|</span><label class="collapse" for="c-41806955">[-]</label><label class="expand" for="c-41806955">[1 more]</label></div><br/><div class="children"><div class="content">“types are just arbitrary labels the language doesn’t even know about” is ok if you&#x27;re aware of the limitations. I add typedefs and other jsdocs to javascript just because it makes it easier to work with in an IDE. it&#x27;s nice to hover over a variable and see what it&#x27;s &quot;supposed&quot; to be (if all went well this object should have a .id, might have a .name, etc), sometimes even declared as two types like &quot;this variable is either an int or a boolean&quot;. I don&#x27;t really want to bother learning typescript or trying to get coworkers to do so&#x2F;put it in the pipeline so it&#x27;s the best I can do and it certainly makes life a bit easier.</div><br/></div></div></div></div><div id="41806328" class="c"><input type="checkbox" id="c-41806328" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41805877">parent</a><span>|</span><a href="#41806404">prev</a><span>|</span><a href="#41806355">next</a><span>|</span><label class="collapse" for="c-41806328">[-]</label><label class="expand" for="c-41806328">[4 more]</label></div><br/><div class="children"><div class="content">Optional types are the best.*<p>I can prototype, script, move fast. Then I can solidify, stabilize, collaborate.<p>* To get top performance, of course you&#x27;ll need compiler, types, static dispatch.</div><br/><div id="41806436" class="c"><input type="checkbox" id="c-41806436" checked=""/><div class="controls bullet"><span class="by">binary132</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806328">parent</a><span>|</span><a href="#41806355">next</a><span>|</span><label class="collapse" for="c-41806436">[-]</label><label class="expand" for="c-41806436">[3 more]</label></div><br/><div class="children"><div class="content">I find that good types help me model the problem and solution with clarity, and the procedures and functions take a back seat.  After all, most procedures are just transformations of structured data, so putting the datastructure first makes good sense and keeps the code clean and lean.  I used to believe in the “moving fast with no types” thing but in practice I find myself modeling the problem either way, it’s just clumsier without strong types.</div><br/><div id="41807214" class="c"><input type="checkbox" id="c-41807214" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806436">parent</a><span>|</span><a href="#41806577">next</a><span>|</span><label class="collapse" for="c-41807214">[-]</label><label class="expand" for="c-41807214">[1 more]</label></div><br/><div class="children"><div class="content">Yep. And even when prototyping, I make a lot more dumb mistakes without a type checker watching my back.<p>It’s amazing how quickly a few interfaces &#x2F; typedefs repay the time you spent typing them in.</div><br/></div></div><div id="41806577" class="c"><input type="checkbox" id="c-41806577" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806436">parent</a><span>|</span><a href="#41807214">prev</a><span>|</span><a href="#41806355">next</a><span>|</span><label class="collapse" for="c-41806577">[-]</label><label class="expand" for="c-41806577">[1 more]</label></div><br/><div class="children"><div class="content">It depends how large the problem is.</div><br/></div></div></div></div></div></div></div></div><div id="41806355" class="c"><input type="checkbox" id="c-41806355" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41805877">prev</a><span>|</span><a href="#41806952">next</a><span>|</span><label class="collapse" for="c-41806355">[-]</label><label class="expand" for="c-41806355">[8 more]</label></div><br/><div class="children"><div class="content">Have an optional one is nice for python. Would suck to be forced to use it all the time.</div><br/><div id="41807604" class="c"><input type="checkbox" id="c-41807604" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806355">parent</a><span>|</span><a href="#41806745">next</a><span>|</span><label class="collapse" for="c-41807604">[-]</label><label class="expand" for="c-41807604">[1 more]</label></div><br/><div class="children"><div class="content">Yes. I like to use type annotations on functions because it&#x27;s documentation. If you use good names then it makes docstrings redundant. I&#x27;m thinking something like this:<p><pre><code>    def bounding_box(points: list[Point]) -&gt; Box:
        ...
</code></pre>
A decent IDE will be able to quickly jump to definition of those Box and Point etc. if you need it. This is much better than having a docstring and having to look stuff up manually. The fact you can run a static type checker like mypy is a bonus!<p>I also really like being able to document the imperative code like `def do_thing() -&gt; None`. Of course, it&#x27;s completely up to the programmer to follow the rule of not doing side effects in routines that return something.<p>But having to do it everywhere? Ugh. I don&#x27;t think people realise how powerful duck typing is for doing polymorphic code. I can write something like:<p><pre><code>    def mean(things):
        return sum(things)&#x2F;len(things)
</code></pre>
And I don&#x27;t care what concrete type you pass me as long as it supports `sum` and `len`. What am I going to do, define an ABC or typing.Protocol called `ListLike` or something? Hell no, I&#x27;ve got better things to do.<p>But of course learning when to define static types vs when not to comes down to experience. Python treats you like an adult. I feel like a lot of people who want static typing everywhere want it as training wheels for other devs they don&#x27;t trust to make the right judgement calls.</div><br/></div></div><div id="41806745" class="c"><input type="checkbox" id="c-41806745" checked=""/><div class="controls bullet"><span class="by">vrighter</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806355">parent</a><span>|</span><a href="#41807604">prev</a><span>|</span><a href="#41806820">next</a><span>|</span><label class="collapse" for="c-41806745">[-]</label><label class="expand" for="c-41806745">[2 more]</label></div><br/><div class="children"><div class="content">a type system is useless if you have no guarantees whether it will be used by any code you use. And if any code that declares types can violate them at will.<p>Optional is equivalent to no type system at all, in my opinion.</div><br/><div id="41806902" class="c"><input type="checkbox" id="c-41806902" checked=""/><div class="controls bullet"><span class="by">nickm12</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806745">parent</a><span>|</span><a href="#41806820">next</a><span>|</span><label class="collapse" for="c-41806902">[-]</label><label class="expand" for="c-41806902">[1 more]</label></div><br/><div class="children"><div class="content">Just because a type system is optional doesn&#x27;t mean it doesn&#x27;t do anything, it just means that you can control how much checking you get, both in terms of the code that is typechecked and how strictly it is checked. Avoiding some type errors through type checking is much better than not having any type checking. Or put another way, optional seat belts are much better than not seat belts at all.</div><br/></div></div></div></div><div id="41806820" class="c"><input type="checkbox" id="c-41806820" checked=""/><div class="controls bullet"><span class="by">khafra</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806355">parent</a><span>|</span><a href="#41806745">prev</a><span>|</span><a href="#41806683">next</a><span>|</span><label class="collapse" for="c-41806820">[-]</label><label class="expand" for="c-41806820">[3 more]</label></div><br/><div class="children"><div class="content">I guess you could just write the program in Python, then have ChatGPT automatically translate it into a strongly-typed language.</div><br/><div id="41806909" class="c"><input type="checkbox" id="c-41806909" checked=""/><div class="controls bullet"><span class="by">yen223</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806820">parent</a><span>|</span><a href="#41806683">next</a><span>|</span><label class="collapse" for="c-41806909">[-]</label><label class="expand" for="c-41806909">[2 more]</label></div><br/><div class="children"><div class="content">What is ChatGPT written in?<p>Because it would be hilarious if ChatGPT was itself written in Python.</div><br/><div id="41807234" class="c"><input type="checkbox" id="c-41807234" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806909">parent</a><span>|</span><a href="#41806683">next</a><span>|</span><label class="collapse" for="c-41807234">[-]</label><label class="expand" for="c-41807234">[1 more]</label></div><br/><div class="children"><div class="content">I have no inside knowledge. But given the performance and scale chatgpt runs at (and the caliber of the team), I think it’s safe to assume a lot of their production code is written in C++ &#x2F; cuda.</div><br/></div></div></div></div></div></div><div id="41806683" class="c"><input type="checkbox" id="c-41806683" checked=""/><div class="controls bullet"><span class="by">echelon</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806355">parent</a><span>|</span><a href="#41806820">prev</a><span>|</span><a href="#41806952">next</a><span>|</span><label class="collapse" for="c-41806683">[-]</label><label class="expand" for="c-41806683">[1 more]</label></div><br/><div class="children"><div class="content">As an undergrad, Python was my favorite language. Now it&#x27;s one of my least favorite because of dynamic typing and the poor dependency management.<p>Python dicts, when used as composite types or records, are a literal hellscape. Grepping through the code to find out where stringly-keyed fields get written takes way more time than thinking about types ever would. These should be structs.<p>Static typing has so many advantages:<p>- It lowers the software defect rate. All type errors are caught for free at compile time instead of runtime. This makes the software strong and rigid instead of brittle, and it removes an entire category of tests you would have to write and maintain.<p>- Static typing makes code maintainable for other people, including future you. It&#x27;s self-documenting. You know precisely what things are in the immediate scope.<p>- Static typing makes bug-free automated refactoring with tools possible. There is no greater pleasure than mutating code via its AST.<p>Static typing is not hard, either. Most typed languages don&#x27;t require type declarations except in structs and function declarations - that&#x27;s really not a lot of effort.</div><br/></div></div></div></div><div id="41806952" class="c"><input type="checkbox" id="c-41806952" checked=""/><div class="controls bullet"><span class="by">jgb1984</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41806355">prev</a><span>|</span><a href="#41807067">next</a><span>|</span><label class="collapse" for="c-41806952">[-]</label><label class="expand" for="c-41806952">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been writing python for a living for almost 20 years. Big projects. Never felt the need for static typing. And I strongly dislike the verbosity and complexity it adds to the language.
Python is beautiful because it&#x27;s simple, easy to read, easy to understand. The typing tagged on to it looks like an ugly word salad to me.<p>I&#x27;ll keep my dynamic typing, thanks!</div><br/><div id="41807605" class="c"><input type="checkbox" id="c-41807605" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41805604">root</a><span>|</span><a href="#41806952">parent</a><span>|</span><a href="#41807067">next</a><span>|</span><label class="collapse" for="c-41807605">[-]</label><label class="expand" for="c-41807605">[1 more]</label></div><br/><div class="children"><div class="content">Have you ever <i>tried</i> static typing though? I suspect you don&#x27;t know what you&#x27;re missing. Static types make Python way easier to understand.</div><br/></div></div></div></div><div id="41807067" class="c"><input type="checkbox" id="c-41807067" checked=""/><div class="controls bullet"><span class="by">zephyrfalcon</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41806952">prev</a><span>|</span><a href="#41807086">next</a><span>|</span><label class="collapse" for="c-41807067">[-]</label><label class="expand" for="c-41807067">[1 more]</label></div><br/><div class="children"><div class="content">There is definitely a push for it; not all of us think it&#x27;s an improvement. When I see modern Python code, it looks nothing like the (relatively) clean, smallish and easy-to-understand language that it was 25 years ago. I get it, things change. The language now caters to a different crowd and attracts different people.<p>But I have often wondered, if someone wants static typing, why not just use a statically typed language?</div><br/></div></div><div id="41806704" class="c"><input type="checkbox" id="c-41806704" checked=""/><div class="controls bullet"><span class="by">zo1</span><span>|</span><a href="#41805604">parent</a><span>|</span><a href="#41807086">prev</a><span>|</span><a href="#41804093">next</a><span>|</span><label class="collapse" for="c-41806704">[-]</label><label class="expand" for="c-41806704">[1 more]</label></div><br/><div class="children"><div class="content">Python&#x27;s optional type-hinting is leaps and bounds better than a static typing system (on its own). It&#x27;s fluid, allows expressibility whilst balancing guard-rails, and is making crazy cool use of &quot;execute-time&quot; or &quot;import-time&quot; time concepts (as an alternative to design-time and run-time).<p>So no, we&#x27;re not coming around. Static typing as dictated by a heavy-handed and super-strict compiler has it&#x27;s place, but has gimped our industry for decades.<p>However, we do have to be very careful. Static, compile-time typing has kept the hipsters and junior-devs at-bay, and kept them from causing too-much havoc as we&#x27;ve seen in the JS world. So it&#x27;s definitely an up-coming hazard for us to navigate around and make sure we don&#x27;t fall prey to. Otherwise python will turn into another JS dumpster fire. Luckily, the JS developers are too-distracted and enthralled with node.js to jump ship.</div><br/></div></div></div></div><div id="41804093" class="c"><input type="checkbox" id="c-41804093" checked=""/><div class="controls bullet"><span class="by">miohtama</span><span>|</span><a href="#41805604">prev</a><span>|</span><a href="#41805340">next</a><span>|</span><label class="collapse" for="c-41804093">[-]</label><label class="expand" for="c-41804093">[19 more]</label></div><br/><div class="children"><div class="content">Reasons to use dataclass(slots=True) instead of TypedDict<p>- Faster attribute access: your code is faster<p>- Slotted classes take less RAM, less L1 cache pressure, your code is faster<p>- Wrist friendly to with .foobar instead of [&quot;foobar&quot;]<p>- Runtime error if you misspell an attribute name</div><br/><div id="41804189" class="c"><input type="checkbox" id="c-41804189" checked=""/><div class="controls bullet"><span class="by">fovc</span><span>|</span><a href="#41804093">parent</a><span>|</span><a href="#41804563">next</a><span>|</span><label class="collapse" for="c-41804189">[-]</label><label class="expand" for="c-41804189">[4 more]</label></div><br/><div class="children"><div class="content">It’s Python. Does L1 matter at  all? I assume anything you’re accessing is behind a few pointers and __dict__ accesses anyway.<p>For me it’s mostly about .attribute being more in line with the rest of the language. Kwargs aside, I find overuse of dicts to clunky in Python</div><br/><div id="41804250" class="c"><input type="checkbox" id="c-41804250" checked=""/><div class="controls bullet"><span class="by">gshulegaard</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804189">parent</a><span>|</span><a href="#41807256">next</a><span>|</span><label class="collapse" for="c-41804250">[-]</label><label class="expand" for="c-41804250">[1 more]</label></div><br/><div class="children"><div class="content">Nope, __slots__ exist explicitly as an alternative to __dict__:<p><a href="https:&#x2F;&#x2F;wiki.python.org&#x2F;moin&#x2F;UsingSlots" rel="nofollow">https:&#x2F;&#x2F;wiki.python.org&#x2F;moin&#x2F;UsingSlots</a><p>Whether or not the performance matters...well that&#x27;s somewhat subjective since Python has a fairly high performance floor which makes performance concerns a bit of a, &quot;Why are you doing it in Python?&quot; question rather than a, &quot;How do I do this faster in Python?&quot; most of the time.  That said it _is_ more memory efficient and faster on attribute lookup.<p><a href="https:&#x2F;&#x2F;medium.com&#x2F;@stephenjayakar&#x2F;a-quick-dive-into-pythons-slots-72cdc2d334e" rel="nofollow">https:&#x2F;&#x2F;medium.com&#x2F;@stephenjayakar&#x2F;a-quick-dive-into-pythons...</a><p>Anecdotally, I have used Slotted Objects to buy performance headroom before to delay&#x2F;postpone a component rewrite.</div><br/></div></div><div id="41807256" class="c"><input type="checkbox" id="c-41807256" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804189">parent</a><span>|</span><a href="#41804250">prev</a><span>|</span><a href="#41804692">next</a><span>|</span><label class="collapse" for="c-41807256">[-]</label><label class="expand" for="c-41807256">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It’s Python. Does L1 matter at all?<p>In many ways it matters more <i>because</i> it’s Python.<p>I’ve met a lot of teams throughout my career who struggle daily with a badly performing Python codebase. You can write a no-frills web service in c#, go, rust or JavaScript. And, so long as you don’t do anything stupid, it’s usually plenty fast enough from day 1 to handle your users. But in my experience, the same isn’t true of Python. I’m sure Python web services can be made to run ok, but because it’s slow by default, I bet a lot more time is spent optimising Python programs around the world than optimising JavaScript.</div><br/></div></div><div id="41804692" class="c"><input type="checkbox" id="c-41804692" checked=""/><div class="controls bullet"><span class="by">zemo</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804189">parent</a><span>|</span><a href="#41807256">prev</a><span>|</span><a href="#41804563">next</a><span>|</span><label class="collapse" for="c-41804692">[-]</label><label class="expand" for="c-41804692">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It’s Python. Does L1 matter at all?<p>depends on the type in question. If you are fetching and operating on a large number of records then it can matter. But otherwise the answer is more often that it does not really matter.</div><br/></div></div></div></div><div id="41804563" class="c"><input type="checkbox" id="c-41804563" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#41804093">parent</a><span>|</span><a href="#41804189">prev</a><span>|</span><a href="#41805137">next</a><span>|</span><label class="collapse" for="c-41804563">[-]</label><label class="expand" for="c-41804563">[13 more]</label></div><br/><div class="children"><div class="content">Better than both use Pydantic. You&#x27;ll never want to use anything else ever again. It&#x27;s truly transformative in how you write code. Full type hinting support as well as strong verification that your data actually conforms to the types you set. Full recursive parsing of types arbitrarily nested and can parse tagged and untagged unions.</div><br/><div id="41805111" class="c"><input type="checkbox" id="c-41805111" checked=""/><div class="controls bullet"><span class="by">serjester</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804563">parent</a><span>|</span><a href="#41805595">next</a><span>|</span><label class="collapse" for="c-41805111">[-]</label><label class="expand" for="c-41805111">[4 more]</label></div><br/><div class="children"><div class="content">TypedDicts are enormously helpful in defining args a function takes. You can’t do that with either dataclasses &#x2F; pydantic without passing instantiated objects as args - which is really cumbersome.</div><br/><div id="41805730" class="c"><input type="checkbox" id="c-41805730" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805111">parent</a><span>|</span><a href="#41805595">next</a><span>|</span><label class="collapse" for="c-41805730">[-]</label><label class="expand" for="c-41805730">[3 more]</label></div><br/><div class="children"><div class="content">I actually have a function for this! I use it all the time and it&#x27;s super helpful.<p><pre><code>    T = TypeVar(&quot;T&quot;)
    U = TypeVar(&quot;U&quot;)
    V = TypeVar(&quot;V&quot;)
    P = ParamSpec(&quot;P&quot;)

    def modelargs(model: Callable[P, U]):
        def _modelargs(func: Callable[[T], V]) -&gt; Callable[P, V]:
            def __modelargs(*args: P.args, **kwargs: P.kwargs) -&gt; V:
                return func(model(*args, **kwargs))  # type: ignore
            return __modelargs  # type: ignore
        return _modelargs

    class MyModel(BaseModel):
        foo: str
        bar: int = 4

    @modelargs(MyModel)
    def test_func(model: MyModel):
        print(model.foo, model.bar)
        return 4

    test_func(foo=&quot;Hello&quot;, bar=20)  # -&gt; prints Hello 20
</code></pre>
If you look in your editor you&#x27;ll see that the type signature for test_func is `(*, foo: str, bar: int = 4) -&gt; int`. It&#x27;s unfortunate that you have to write the model type twice but in exchange you don&#x27;t have to write the args twice.</div><br/><div id="41806358" class="c"><input type="checkbox" id="c-41806358" checked=""/><div class="controls bullet"><span class="by">FreakLegion</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805730">parent</a><span>|</span><a href="#41806072">next</a><span>|</span><label class="collapse" for="c-41806358">[-]</label><label class="expand" for="c-41806358">[1 more]</label></div><br/><div class="children"><div class="content">I think serjester was talking about PEP 692 for typing kwargs with TypedDicts. Your recipe is a bit different.<p>Pydantic is targeting other use cases. The point of TypedDicts is compile-time safety without run-time overhead. Pydantic is useful for a lot of things, but performance isn&#x27;t exactly its strong suit (written as of 2.9.2, I was just revisiting it earlier this week).<p>Anyway, in the same spirit of function signature hacking, I&#x27;ve found the following useful for &quot;inheriting&quot; them:<p><pre><code>  _T = TypeVar(&quot;_T&quot;, bound=Callable)

  def inherit_signature(_function: _T) -&gt; Callable[..., _T]:
    return lambda f: f

  # Requests for example has some long signatures (via typeshed).
  class CustomSession(requests.Session):

      @inherit_signature(requests.Session.post)
      def post(self, url: str, *args: Any, **kwargs: Any) -&gt; requests.Response:
          ...
</code></pre>
And now for CustomSession.post the editor sees:<p><pre><code>  def post(
    self: Session,
    url: str | bytes,
    data: _Data | None = None,
    json: Any | None = None,
    *,
    params: _Params | None = ...,
    headers: _HeadersUpdateMapping | None = ...,
    cookies: RequestsCookieJar | _TextMapping | None = ...,
    files: _Files | None = ...,
    auth: _Auth | None = ...,
    timeout: _Timeout | None = ...,
    allow_redirects: bool = ...,
    proxies: _TextMapping | None = ...,
    hooks: _HooksInput | None = ...,
    stream: bool | None = ...,
    verify: _Verify | None = ...,
    cert: _Cert | None = ...
  ) -&gt; Response</code></pre></div><br/></div></div><div id="41806072" class="c"><input type="checkbox" id="c-41806072" checked=""/><div class="controls bullet"><span class="by">rattray</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805730">parent</a><span>|</span><a href="#41806358">prev</a><span>|</span><a href="#41805595">next</a><span>|</span><label class="collapse" for="c-41806072">[-]</label><label class="expand" for="c-41806072">[1 more]</label></div><br/><div class="children"><div class="content">Interesting! How does that work for nested properties?</div><br/></div></div></div></div></div></div><div id="41805595" class="c"><input type="checkbox" id="c-41805595" checked=""/><div class="controls bullet"><span class="by">neeleshs</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804563">parent</a><span>|</span><a href="#41805111">prev</a><span>|</span><a href="#41805139">next</a><span>|</span><label class="collapse" for="c-41805595">[-]</label><label class="expand" for="c-41805595">[1 more]</label></div><br/><div class="children"><div class="content">The author touches upon why typeddicts with  total=False are more ergonomic than Pydantic for the examples they have.</div><br/></div></div><div id="41805139" class="c"><input type="checkbox" id="c-41805139" checked=""/><div class="controls bullet"><span class="by">darkteflon</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41804563">parent</a><span>|</span><a href="#41805595">prev</a><span>|</span><a href="#41805137">next</a><span>|</span><label class="collapse" for="c-41805139">[-]</label><label class="expand" for="c-41805139">[7 more]</label></div><br/><div class="children"><div class="content">Really like Pydantic - assuming you’re happy to step outside the standard library. It does have a few sharp edges, but out of the box it includes all the stuff you eventually end up needing anyway. attrs is the other big Python parsing &#x2F; validation library. I know nothing about it other than it’s also popular and that it distinguishes itself philosophically from Pydantic in a number of ways.<p>Don’t forget to use ‘ConfigDict(frozen=True)’ absolutely everywhere!</div><br/><div id="41805910" class="c"><input type="checkbox" id="c-41805910" checked=""/><div class="controls bullet"><span class="by">ddejohn</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805139">parent</a><span>|</span><a href="#41805294">next</a><span>|</span><label class="collapse" for="c-41805910">[-]</label><label class="expand" for="c-41805910">[1 more]</label></div><br/><div class="children"><div class="content">Huge proponent of Pydantic.<p>That said, there&#x27;s also msgspec [1], which I&#x27;ve not used yet but plan to for my next project. It is supposedly quite a bit faster than Pydantic in de&#x2F;serialization.<p>[1] <a href="https:&#x2F;&#x2F;jcristharif.com&#x2F;msgspec&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jcristharif.com&#x2F;msgspec&#x2F;</a></div><br/></div></div><div id="41805294" class="c"><input type="checkbox" id="c-41805294" checked=""/><div class="controls bullet"><span class="by">richrichie</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805139">parent</a><span>|</span><a href="#41805910">prev</a><span>|</span><a href="#41805137">next</a><span>|</span><label class="collapse" for="c-41805294">[-]</label><label class="expand" for="c-41805294">[5 more]</label></div><br/><div class="children"><div class="content">I looked up the docs as to what frozen does:<p>&gt; whether or not models are faux-immutable, i.e. whether __setattr__ is allowed (default: True)<p>Seems everything is “faux” in Python world when it comes to typing ;)</div><br/><div id="41805553" class="c"><input type="checkbox" id="c-41805553" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805294">parent</a><span>|</span><a href="#41805430">next</a><span>|</span><label class="collapse" for="c-41805553">[-]</label><label class="expand" for="c-41805553">[2 more]</label></div><br/><div class="children"><div class="content">Python very much lives up to its goal of being a language for consenting adults. It&#x27;s part of the culture that you don&#x27;t write code that tries to forbid users of your code from doing &quot;wrong&quot; things and such efforts are mostly futile anyway. You can reach right into a Python object&#x27;s internal data and modify it directly, taking away __setattr__ is just a suggestion. It&#x27;s the same as in C where you can modify const variables if you&#x27;re determined enough.</div><br/><div id="41806159" class="c"><input type="checkbox" id="c-41806159" checked=""/><div class="controls bullet"><span class="by">richrichie</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805553">parent</a><span>|</span><a href="#41805430">next</a><span>|</span><label class="collapse" for="c-41806159">[-]</label><label class="expand" for="c-41806159">[1 more]</label></div><br/><div class="children"><div class="content">I love Python and use it extensively. I just find the extensive typing rituals a bit funny. If one needs this much bandaid (essentially for code editors), then Python is not a good choice for the task.</div><br/></div></div></div></div><div id="41805430" class="c"><input type="checkbox" id="c-41805430" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805294">parent</a><span>|</span><a href="#41805553">prev</a><span>|</span><a href="#41805137">next</a><span>|</span><label class="collapse" for="c-41805430">[-]</label><label class="expand" for="c-41805430">[2 more]</label></div><br/><div class="children"><div class="content">Unfortunately I can&#x27;t downvote, but this comment is just flamebait.</div><br/><div id="41806163" class="c"><input type="checkbox" id="c-41806163" checked=""/><div class="controls bullet"><span class="by">richrichie</span><span>|</span><a href="#41804093">root</a><span>|</span><a href="#41805430">parent</a><span>|</span><a href="#41805137">next</a><span>|</span><label class="collapse" for="c-41806163">[-]</label><label class="expand" for="c-41806163">[1 more]</label></div><br/><div class="children"><div class="content">Ah, sensitive type you are!
Read my reply above.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41805340" class="c"><input type="checkbox" id="c-41805340" checked=""/><div class="controls bullet"><span class="by">calibas</span><span>|</span><a href="#41804093">prev</a><span>|</span><a href="#41804694">next</a><span>|</span><label class="collapse" for="c-41805340">[-]</label><label class="expand" for="c-41805340">[4 more]</label></div><br/><div class="children"><div class="content">I feel like this needs to be mentioned more: If you don&#x27;t have some kind of system to enforce types, then TypedDict does nothing at all.<p>You can store a float in an attribute annotated as a string, and default Python will not stop you, or display any kind of warning. The typing is purely for development, and does nothing once compiled.<p>If you want typing to actually be enforced, you need to use something like Pydantic.</div><br/><div id="41806682" class="c"><input type="checkbox" id="c-41806682" checked=""/><div class="controls bullet"><span class="by">MrJohz</span><span>|</span><a href="#41805340">parent</a><span>|</span><a href="#41804694">next</a><span>|</span><label class="collapse" for="c-41806682">[-]</label><label class="expand" for="c-41806682">[3 more]</label></div><br/><div class="children"><div class="content">Counter argument: this is actually a myth that gets repeated far too often, and misses the point of what static types do.<p>If your input data is the correct type (big if #1), and if your types are sounds and consistent with each other (big if #2), then you don&#x27;t need something like Pydantic, because the types guarantee that there will never be a float stored somewhere that&#x27;s annotated as a string. It cannot happen, because as soon as you try to store a float in a string attribute, your type checker (Pyright, Mypy, etc) will complain. And if you&#x27;re consistently running that type checker over your code, e.g. in a CI job that runs over your codebase for every push, then you can never have checked-in code where the types are incorrect.<p>There are the two big caveats above, but these turn out not to be such big deals. Caveat #1 is that you can&#x27;t rely on external data to match the types you&#x27;ve described internally. This is an ideal use case for Pydantic, like you say: you check external types once, at the boundaries of your program, and then internally you can be confident that the types will always be correct.<p>Caveat #2 is that you don&#x27;t break the type checker&#x27;s limits. This generally means avoiding things like `Any`, and ensuring that your typed code always calls other typed code, and never untyped, un-annotated code. The easiest way to do this is to start by typing the leaf files in your program (the ones that only get imported, and never import anything in turn). These can&#x27;t import untyped code, so if they&#x27;re fully typed and the type checker passes, then you can be confident that their types are correct. Now sure, a bad caller could try and call one of these functions with invalid input, but as they say, Python is for adults, and you&#x27;re free to call a function with the wrong arguments, and you&#x27;re free to deal with the results.<p>Now, you can add types to code that only imports typed code, and because you&#x27;ve checked the imported code you know it&#x27;s correct, so if you also check the importer and it&#x27;s also correct, then you can be confident at that level too. You can keep going until you&#x27;ve added types to the entire codebase, and now you can be confident that the entire codebase always passes the correct types, and therefore that no runtime enforcement is necessary.<p>There is a third caveat, which is that this relies on having a powerful enough type system to model all the things that you were originally doing in Python&#x27;s dynamic type system. This is hard, because you can do some pretty wild things in Python, and my own experience with Python type checkers has been a bit disappointing - they handle more boilerplate-heavy code fairly well, but seem to struggle on more idiomatic code that uses Python&#x27;s dynamic features. However, that seems to be improving all the time, and Typescript demonstrates that it&#x27;s certainly possible to model a dynamic language with static types to a very reasonable accuracy.</div><br/><div id="41806770" class="c"><input type="checkbox" id="c-41806770" checked=""/><div class="controls bullet"><span class="by">vrighter</span><span>|</span><a href="#41805340">root</a><span>|</span><a href="#41806682">parent</a><span>|</span><a href="#41804694">next</a><span>|</span><label class="collapse" for="c-41806770">[-]</label><label class="expand" for="c-41806770">[2 more]</label></div><br/><div class="children"><div class="content">the lsp will complain about i~.<p>The language happily does it anyway.</div><br/><div id="41806861" class="c"><input type="checkbox" id="c-41806861" checked=""/><div class="controls bullet"><span class="by">MrJohz</span><span>|</span><a href="#41805340">root</a><span>|</span><a href="#41806770">parent</a><span>|</span><a href="#41804694">next</a><span>|</span><label class="collapse" for="c-41806861">[-]</label><label class="expand" for="c-41806861">[1 more]</label></div><br/><div class="children"><div class="content">Which is why you use a type checker to ensure that it never happens in the codebase. If there is no line of code that ever does something like<p><pre><code>    int_field: int = &quot;string&quot;
</code></pre>
or<p><pre><code>    self.int_field = &quot;string&quot;
</code></pre>
Then you can be confident that the language will never store a string value in that integer field. And if you expand this to cover all fields and variables in your codebase, you can see that, if you use the type system correctly, the language won&#x27;t violate those constraints.<p>There are some exceptions to this, like I said in the previous comment, but I think when getting started with typed Python, it&#x27;s easier to assume that the types will be valid, because that&#x27;s the case almost all of the time. Usually, overriding type assertions requires some kind of explicit cast or statement, and this is usually documented.</div><br/></div></div></div></div></div></div></div></div><div id="41804694" class="c"><input type="checkbox" id="c-41804694" checked=""/><div class="controls bullet"><span class="by">flysand7</span><span>|</span><a href="#41805340">prev</a><span>|</span><a href="#41803803">next</a><span>|</span><label class="collapse" for="c-41804694">[-]</label><label class="expand" for="c-41804694">[6 more]</label></div><br/><div class="children"><div class="content">&gt; Here we have a problem, for subscription does None mean don&#x27;t change or remove subscription<p>I read this like 10 times and I still dont understand this mess of grammar. Am I having a fucking stroke rn?</div><br/><div id="41804765" class="c"><input type="checkbox" id="c-41804765" checked=""/><div class="controls bullet"><span class="by">dan-robertson</span><span>|</span><a href="#41804694">parent</a><span>|</span><a href="#41806215">next</a><span>|</span><label class="collapse" for="c-41804765">[-]</label><label class="expand" for="c-41804765">[1 more]</label></div><br/><div class="children"><div class="content">I’m going to send you some json to update your object – an HTTP PATCH request. There are three possible updates I might want to make to the subscription field:<p>- change it to a new value<p>- set it to None<p>- leave it as-is<p>In the json the first two options are specified by sending an object with a &quot;subscription&quot; field, either set to a string or to null. The third case is expressed by omitting the field.<p>The OP asks how all three cases could be represented in python, and points out that one could not use subscription=None to represent both case 2 and 3 above.</div><br/></div></div><div id="41806215" class="c"><input type="checkbox" id="c-41806215" checked=""/><div class="controls bullet"><span class="by">gorgoiler</span><span>|</span><a href="#41804694">parent</a><span>|</span><a href="#41804765">prev</a><span>|</span><a href="#41804704">next</a><span>|</span><label class="collapse" for="c-41806215">[-]</label><label class="expand" for="c-41806215">[1 more]</label></div><br/><div class="children"><div class="content">Here we have a problem:<p>If the “subscription” part of the “patch” data-structure is set to “None” it is impossible to tell if this means:<p>1&#x2F; leave the “subscription” unchanged; or<p>2&#x2F; set the “subscription” to None.<p>—<p>You could solve this by requiring that a subscription is either a value or some other sentinel value meaning “not subscribed”:<p><pre><code>  from typing import Union
  class T: pass
  NotSubscribed = T()
  Subscription = Union[int, T]
  def f(s: Subscription): pass
  f(44)
  f(NotSubscribed)
  f(None)  # wrong
</code></pre>
Is there a better way of doing this?  (One that isn’t just “use Haskell” :)</div><br/></div></div><div id="41804704" class="c"><input type="checkbox" id="c-41804704" checked=""/><div class="controls bullet"><span class="by">roywiggins</span><span>|</span><a href="#41804694">parent</a><span>|</span><a href="#41806215">prev</a><span>|</span><a href="#41805424">next</a><span>|</span><label class="collapse" for="c-41804704">[-]</label><label class="expand" for="c-41804704">[2 more]</label></div><br/><div class="children"><div class="content">for &quot;subscription&quot;, does `None` mean &quot;don&#x27;t change&quot;, or &quot;remove subscription&quot;?</div><br/><div id="41805033" class="c"><input type="checkbox" id="c-41805033" checked=""/><div class="controls bullet"><span class="by">Ericson2314</span><span>|</span><a href="#41804694">root</a><span>|</span><a href="#41804704">parent</a><span>|</span><a href="#41805424">next</a><span>|</span><label class="collapse" for="c-41805033">[-]</label><label class="expand" for="c-41805033">[1 more]</label></div><br/><div class="children"><div class="content">Quoting, important when (meta-)programming and in natural language!</div><br/></div></div></div></div><div id="41805424" class="c"><input type="checkbox" id="c-41805424" checked=""/><div class="controls bullet"><span class="by">syockit</span><span>|</span><a href="#41804694">parent</a><span>|</span><a href="#41804704">prev</a><span>|</span><a href="#41803803">next</a><span>|</span><label class="collapse" for="c-41805424">[-]</label><label class="expand" for="c-41805424">[1 more]</label></div><br/><div class="children"><div class="content">Better punctuated:<p>&gt; Here we have a problem: for subscription, does None mean don&#x27;t change or remove subscription?</div><br/></div></div></div></div><div id="41803803" class="c"><input type="checkbox" id="c-41803803" checked=""/><div class="controls bullet"><span class="by">jjtheblunt</span><span>|</span><a href="#41804694">prev</a><span>|</span><a href="#41803898">next</a><span>|</span><label class="collapse" for="c-41803803">[-]</label><label class="expand" for="c-41803803">[14 more]</label></div><br/><div class="children"><div class="content">&quot;thank you think&quot; in a title is overtly condescending...you know your audience and their educational deficiencies?<p>&quot;than i thought&quot; would be compelling to read.</div><br/><div id="41804231" class="c"><input type="checkbox" id="c-41804231" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41803803">parent</a><span>|</span><a href="#41803841">next</a><span>|</span><label class="collapse" for="c-41804231">[-]</label><label class="expand" for="c-41804231">[9 more]</label></div><br/><div class="children"><div class="content">This is the kind of copyediting advice ChatGPT gives. I think everyone gets that the author doesn&#x27;t know what you, in particular, think about TypedDicts. Read things more charitably; this is not a good use of time to discuss.</div><br/><div id="41805131" class="c"><input type="checkbox" id="c-41805131" checked=""/><div class="controls bullet"><span class="by">AmericanChopper</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804231">parent</a><span>|</span><a href="#41804633">next</a><span>|</span><label class="collapse" for="c-41805131">[-]</label><label class="expand" for="c-41805131">[1 more]</label></div><br/><div class="children"><div class="content">I’m not a big fan of the “my opinion is fact” or “your opinion is wrong” headlines. They can be mildly funny in the right context, but it’s been done so much that they’re just a bit boring now. I’m especially bored of seeing this convention in conference presentation titles.</div><br/></div></div><div id="41804633" class="c"><input type="checkbox" id="c-41804633" checked=""/><div class="controls bullet"><span class="by">CyberDildonics</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804231">parent</a><span>|</span><a href="#41805131">prev</a><span>|</span><a href="#41803841">next</a><span>|</span><label class="collapse" for="c-41804633">[-]</label><label class="expand" for="c-41804633">[7 more]</label></div><br/><div class="children"><div class="content">Or people could post what they think, since that&#x27;s the point of an internet forum.</div><br/><div id="41805582" class="c"><input type="checkbox" id="c-41805582" checked=""/><div class="controls bullet"><span class="by">binary132</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804633">parent</a><span>|</span><a href="#41804658">next</a><span>|</span><label class="collapse" for="c-41805582">[-]</label><label class="expand" for="c-41805582">[1 more]</label></div><br/><div class="children"><div class="content">And here I thought the point of Internet forums was to prove who has the bigger uppey votey number!</div><br/></div></div><div id="41804658" class="c"><input type="checkbox" id="c-41804658" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804633">parent</a><span>|</span><a href="#41805582">prev</a><span>|</span><a href="#41803841">next</a><span>|</span><label class="collapse" for="c-41804658">[-]</label><label class="expand" for="c-41804658">[5 more]</label></div><br/><div class="children"><div class="content"><i>Please don&#x27;t pick the most provocative thing in an article or post to complain about in the thread. Find something interesting to respond to instead.</i><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;newsguidelines.html">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;newsguidelines.html</a></div><br/><div id="41804922" class="c"><input type="checkbox" id="c-41804922" checked=""/><div class="controls bullet"><span class="by">selcuka</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804658">parent</a><span>|</span><a href="#41806655">next</a><span>|</span><label class="collapse" for="c-41804922">[-]</label><label class="expand" for="c-41804922">[1 more]</label></div><br/><div class="children"><div class="content">Ironically, you seem to have found the most provocative comment to respond to.</div><br/></div></div><div id="41806655" class="c"><input type="checkbox" id="c-41806655" checked=""/><div class="controls bullet"><span class="by">zo1</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804658">parent</a><span>|</span><a href="#41804922">prev</a><span>|</span><a href="#41805540">next</a><span>|</span><label class="collapse" for="c-41806655">[-]</label><label class="expand" for="c-41806655">[1 more]</label></div><br/><div class="children"><div class="content">Honestly, right now it looks like you are the one derailing the discussion. And when it didn&#x27;t go your way, you started quoting the &quot;guidelines&quot; as if to smack us over our fingers for misbehaving. This entire sub-thread at time of writing this is like 20% of the entire discussion; and that&#x27;s sad.</div><br/></div></div><div id="41805540" class="c"><input type="checkbox" id="c-41805540" checked=""/><div class="controls bullet"><span class="by">CyberDildonics</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41804658">parent</a><span>|</span><a href="#41806655">prev</a><span>|</span><a href="#41806012">next</a><span>|</span><label class="collapse" for="c-41805540">[-]</label><label class="expand" for="c-41805540">[1 more]</label></div><br/><div class="children"><div class="content">Seems a little ironic and self righteous since stories are upvoted based on the most provocative titles.</div><br/></div></div></div></div></div></div></div></div><div id="41803841" class="c"><input type="checkbox" id="c-41803841" checked=""/><div class="controls bullet"><span class="by">crazygringo</span><span>|</span><a href="#41803803">parent</a><span>|</span><a href="#41804231">prev</a><span>|</span><a href="#41804454">next</a><span>|</span><label class="collapse" for="c-41803841">[-]</label><label class="expand" for="c-41803841">[2 more]</label></div><br/><div class="children"><div class="content">Yup, using &quot;you&quot; in headlines is a pattern that needs to die.<p>I get that it&#x27;s attention-grabbing, but it&#x27;s because it&#x27;s rude.<p>You don&#x27;t know anything about me. You don&#x27;t know what I think or what I already know or what I won&#x27;t believe.<p>I know it&#x27;s not a big deal in the grand scheme of things, but it&#x27;s just one of those little aggravating things that makes life just a little bit worse each time you come across them.</div><br/><div id="41804570" class="c"><input type="checkbox" id="c-41804570" checked=""/><div class="controls bullet"><span class="by">robswc</span><span>|</span><a href="#41803803">root</a><span>|</span><a href="#41803841">parent</a><span>|</span><a href="#41804454">next</a><span>|</span><label class="collapse" for="c-41804570">[-]</label><label class="expand" for="c-41804570">[1 more]</label></div><br/><div class="children"><div class="content">The one I hate the most is:<p>&quot;X thing did Y, here&#x27;s why Z&quot;<p>Where X and Y can range from meaningless to national security but Z always remains an opinion (usually uninformed too).<p>Just search &quot;here&#x27;s why that&#x27;s bad&#x2F;good&quot; on google news and there&#x27;s so much &quot;slop.&quot;</div><br/></div></div></div></div><div id="41804454" class="c"><input type="checkbox" id="c-41804454" checked=""/><div class="controls bullet"><span class="by">sqeaky</span><span>|</span><a href="#41803803">parent</a><span>|</span><a href="#41803841">prev</a><span>|</span><a href="#41803861">next</a><span>|</span><label class="collapse" for="c-41804454">[-]</label><label class="expand" for="c-41804454">[1 more]</label></div><br/><div class="children"><div class="content">100%! If people are dumb enough to think I am dumb, then they generally aren&#x27;t saying anything worth listening to.</div><br/></div></div><div id="41803861" class="c"><input type="checkbox" id="c-41803861" checked=""/><div class="controls bullet"><span class="by">lopatin</span><span>|</span><a href="#41803803">parent</a><span>|</span><a href="#41804454">prev</a><span>|</span><a href="#41803898">next</a><span>|</span><label class="collapse" for="c-41803861">[-]</label><label class="expand" for="c-41803861">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a qualifier. In a sense, they <i>do</i> know their audience fairly well because someone who clicks on that link is intrigued and feel they have more to learn about it. Anyone who is pretty knowledgeable about the subject will go &quot;pff .. yeah right&quot; and not even click on it.<p>That said, it does annoy me too.<p>Also what annoys me is that I constantly try to play devils advocate for things like this even if I don&#x27;t always agree with the conclusion of the advocate.</div><br/></div></div></div></div><div id="41803898" class="c"><input type="checkbox" id="c-41803898" checked=""/><div class="controls bullet"><span class="by">benmmurphy</span><span>|</span><a href="#41803803">prev</a><span>|</span><a href="#41806364">next</a><span>|</span><label class="collapse" for="c-41803898">[-]</label><label class="expand" for="c-41803898">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  &lt;Option&lt;Option&lt;subscription&gt;&gt;</code></pre></div><br/></div></div><div id="41806364" class="c"><input type="checkbox" id="c-41806364" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#41803898">prev</a><span>|</span><a href="#41804277">next</a><span>|</span><label class="collapse" for="c-41806364">[-]</label><label class="expand" for="c-41806364">[1 more]</label></div><br/><div class="children"><div class="content">TypedDict features are nice, but the syntax to declare it is aweful</div><br/></div></div></div></div></div></div></div></body></html>