<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1696410064615" as="style"/><link rel="stylesheet" href="styles.css?v=1696410064615"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.apnic.net/2023/06/21/enabling-ipv6-support-for-ipv4-only-apps-on-linux/">Enabling IPv6 support for IPv4-only apps on Linux</a> <span class="domain">(<a href="https://blog.apnic.net">blog.apnic.net</a>)</span></div><div class="subtext"><span>pabs3</span> | <span>31 comments</span></div><br/><div><div id="37762611" class="c"><input type="checkbox" id="c-37762611" checked=""/><div class="controls bullet"><span class="by">sschueller</span><span>|</span><a href="#37762373">next</a><span>|</span><label class="collapse" for="c-37762611">[-]</label><label class="expand" for="c-37762611">[1 more]</label></div><br/><div class="children"><div class="content">Does anyone have a good write up of taking ones home network and going 100% ipv6 including dealing with iot devices that can&#x27;t? I am thinking of doing it but I have a huge mix of devices from linux to windows and servers.</div><br/></div></div><div id="37762373" class="c"><input type="checkbox" id="c-37762373" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37762611">prev</a><span>|</span><a href="#37762043">next</a><span>|</span><label class="collapse" for="c-37762373">[-]</label><label class="expand" for="c-37762373">[4 more]</label></div><br/><div class="children"><div class="content">The main advantage of Linux over other systems is that its available from source and thus can be patched and recompiled easily. Here we see someone using LD_PRELOAD to patch the behavior of a binary, because they rely on distributions pre-compiled packages without means to change the source code themselves. This sort of negates that advantage, right?</div><br/><div id="37762600" class="c"><input type="checkbox" id="c-37762600" checked=""/><div class="controls bullet"><span class="by">nightfly</span><span>|</span><a href="#37762373">parent</a><span>|</span><a href="#37762603">next</a><span>|</span><label class="collapse" for="c-37762600">[-]</label><label class="expand" for="c-37762600">[1 more]</label></div><br/><div class="children"><div class="content">Having an additional way to effect changes in behavior without recompiling an application hardly negates the benefit you described. They don&#x27;t say the _cant_ or _couldn&#x27;t_ change the source themselves either. And what you described is hardly the main advantage of Linux, FreeBSD enables that _much_ easier.</div><br/></div></div><div id="37762603" class="c"><input type="checkbox" id="c-37762603" checked=""/><div class="controls bullet"><span class="by">yrro</span><span>|</span><a href="#37762373">parent</a><span>|</span><a href="#37762600">prev</a><span>|</span><a href="#37762043">next</a><span>|</span><label class="collapse" for="c-37762603">[-]</label><label class="expand" for="c-37762603">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think openssh upstream would accept a patch that makes ssh interpret ipv4 addresses as anything other than ipv4 addresses, and who wants to carry such a patch downstream forever?</div><br/><div id="37762619" class="c"><input type="checkbox" id="c-37762619" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37762373">root</a><span>|</span><a href="#37762603">parent</a><span>|</span><a href="#37762043">next</a><span>|</span><label class="collapse" for="c-37762619">[-]</label><label class="expand" for="c-37762619">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need to merge upstream! Its your source, your build, your rules.</div><br/></div></div></div></div></div></div><div id="37762043" class="c"><input type="checkbox" id="c-37762043" checked=""/><div class="controls bullet"><span class="by">heartjudytenuta</span><span>|</span><a href="#37762373">prev</a><span>|</span><a href="#37761852">next</a><span>|</span><label class="collapse" for="c-37762043">[-]</label><label class="expand" for="c-37762043">[5 more]</label></div><br/><div class="children"><div class="content">&quot;To prove that IPv6 is ready for production use, I built a second PC so I can access the IPv4 Internet&quot;</div><br/><div id="37762096" class="c"><input type="checkbox" id="c-37762096" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#37762043">parent</a><span>|</span><a href="#37762126">next</a><span>|</span><label class="collapse" for="c-37762096">[-]</label><label class="expand" for="c-37762096">[2 more]</label></div><br/><div class="children"><div class="content">Being able to access legacy systems from new ones is a good property of new systems. This workaround is important.<p>(Also that may be done on routers which today deal with NAT anyway)</div><br/><div id="37762132" class="c"><input type="checkbox" id="c-37762132" checked=""/><div class="controls bullet"><span class="by">heartjudytenuta</span><span>|</span><a href="#37762043">root</a><span>|</span><a href="#37762096">parent</a><span>|</span><a href="#37762126">next</a><span>|</span><label class="collapse" for="c-37762132">[-]</label><label class="expand" for="c-37762132">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t a workaround; it is a kludge. There are far better solutions in this problem space (some mentioned in this very thread).</div><br/></div></div></div></div><div id="37762126" class="c"><input type="checkbox" id="c-37762126" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#37762043">parent</a><span>|</span><a href="#37762096">prev</a><span>|</span><a href="#37762297">next</a><span>|</span><label class="collapse" for="c-37762126">[-]</label><label class="expand" for="c-37762126">[1 more]</label></div><br/><div class="children"><div class="content">An average user is not expected to do that. But I understand there are mobile operators out there who have been doing this (instead of NAT) for a while because they don&#x27;t have IPv4 addresses for ever consumer subscription? Wasn&#x27;t T-Mobile US one of them? (Not living in the US.)</div><br/></div></div><div id="37762297" class="c"><input type="checkbox" id="c-37762297" checked=""/><div class="controls bullet"><span class="by">sgjohnson</span><span>|</span><a href="#37762043">parent</a><span>|</span><a href="#37762126">prev</a><span>|</span><a href="#37761852">next</a><span>|</span><label class="collapse" for="c-37762297">[-]</label><label class="expand" for="c-37762297">[1 more]</label></div><br/><div class="children"><div class="content">This is actually a very good workaround&#x2F;transition mechanism, because it lets you go fully IPv6 native, keeping the translation layer for things that absolutely must use IPv4.<p>And after transition is done, in theory, all you’d do would be turn off the translation box. In practice you’ll have to keep it up until the end of days, but that’s a separate matter.</div><br/></div></div></div></div><div id="37761852" class="c"><input type="checkbox" id="c-37761852" checked=""/><div class="controls bullet"><span class="by">zekica</span><span>|</span><a href="#37762043">prev</a><span>|</span><a href="#37761873">next</a><span>|</span><label class="collapse" for="c-37761852">[-]</label><label class="expand" for="c-37761852">[2 more]</label></div><br/><div class="children"><div class="content">If the network already supports NAT64 I would use CLAT running on the system. That way you don&#x27;t need LD_PRELOAD.</div><br/><div id="37762064" class="c"><input type="checkbox" id="c-37762064" checked=""/><div class="controls bullet"><span class="by">Kaxo</span><span>|</span><a href="#37761852">parent</a><span>|</span><a href="#37761873">next</a><span>|</span><label class="collapse" for="c-37762064">[-]</label><label class="expand" for="c-37762064">[1 more]</label></div><br/><div class="children"><div class="content">I feel the exact opposite. I&#x27;ve recently been experimenting with ipv6 only via NAT64&#x2F;DNS64 and run into the same problem (with steam trying to connect out to hard-coded ipv4 addresses).<p>I started to look into CLAT and really didn&#x27;t want to have to go through the hassle of a whole new virtual interface with routes etc, when one single app can&#x27;t just pass a couple different args to connect().<p>I actually had thought about trying to write something exactly like this myself.<p>I&#x27;m glad to learn it already exists.</div><br/></div></div></div></div><div id="37761873" class="c"><input type="checkbox" id="c-37761873" checked=""/><div class="controls bullet"><span class="by">trustingtrust</span><span>|</span><a href="#37761852">prev</a><span>|</span><a href="#37762174">next</a><span>|</span><label class="collapse" for="c-37761873">[-]</label><label class="expand" for="c-37761873">[1 more]</label></div><br/><div class="children"><div class="content">&gt; To prove that IPv6 is ready for production use<p>No one is debating it&#x27;s not ready for production use. It&#x27;s just that it&#x27;s a lot easier to configure clients in dual stack than do a 6 to 4 translation.</div><br/></div></div><div id="37762174" class="c"><input type="checkbox" id="c-37762174" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#37761873">prev</a><span>|</span><a href="#37761789">next</a><span>|</span><label class="collapse" for="c-37762174">[-]</label><label class="expand" for="c-37762174">[4 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    ssh 64:ff9b::1.3.3.7
</code></pre>
What address syntax is that? I mean I can easily guess what it means, but I wasn&#x27;t aware such mixture exists. Do connect(2) and friends support that?</div><br/><div id="37762264" class="c"><input type="checkbox" id="c-37762264" checked=""/><div class="controls bullet"><span class="by">chungy</span><span>|</span><a href="#37762174">parent</a><span>|</span><a href="#37762240">next</a><span>|</span><label class="collapse" for="c-37762264">[-]</label><label class="expand" for="c-37762264">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an IPv4-mapped IPv6 address. Just interpret the IPv4 address like it&#x27;s the last 32 bits of the v6 address.<p>In the example, 64:ff9b::103:307 is equivalent. A more complicated example might be akin to 64:ff9b::198.51.100.231, equivalent to 64:ff9b::c633:64e7.</div><br/></div></div><div id="37762240" class="c"><input type="checkbox" id="c-37762240" checked=""/><div class="controls bullet"><span class="by">g232089</span><span>|</span><a href="#37762174">parent</a><span>|</span><a href="#37762264">prev</a><span>|</span><a href="#37761789">next</a><span>|</span><label class="collapse" for="c-37762240">[-]</label><label class="expand" for="c-37762240">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an RFC6052 address.</div><br/><div id="37762410" class="c"><input type="checkbox" id="c-37762410" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#37762174">root</a><span>|</span><a href="#37762240">parent</a><span>|</span><a href="#37761789">next</a><span>|</span><label class="collapse" for="c-37762410">[-]</label><label class="expand" for="c-37762410">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the pointer. Actually RFC6052 just refers to RFC4291 from 2006 in this case. And that simply calls it an alternative representation.<p>Edit: RFC1884 from 1995 already had it, nothing has changed in that aspect.</div><br/></div></div></div></div></div></div><div id="37761789" class="c"><input type="checkbox" id="c-37761789" checked=""/><div class="controls bullet"><span class="by">imoverclocked</span><span>|</span><a href="#37762174">prev</a><span>|</span><label class="collapse" for="c-37761789">[-]</label><label class="expand" for="c-37761789">[13 more]</label></div><br/><div class="children"><div class="content">Super cool! I tried doing a pure IPv6 network a little over a decade ago; Maybe I’ll try it again. Though, my cheap IoT devices likely still need IPv4… but perhaps not internet connectivity. It might be fun to explore just how much IPv4 continues to be ingrained into cheap Things (eg: Arduino WiFI?) There always seems to be a long tail of small places where IPv4 pops straight back into the equation.</div><br/><div id="37761966" class="c"><input type="checkbox" id="c-37761966" checked=""/><div class="controls bullet"><span class="by">red_trumpet</span><span>|</span><a href="#37761789">parent</a><span>|</span><a href="#37762217">next</a><span>|</span><label class="collapse" for="c-37761966">[-]</label><label class="expand" for="c-37761966">[11 more]</label></div><br/><div class="children"><div class="content">Small places?<p>When I disabled IPv4 a few weeks ago, I couldn&#x27;t use: HN, GitHub, Reddit, Discord, Duckduckgo.</div><br/><div id="37762135" class="c"><input type="checkbox" id="c-37762135" checked=""/><div class="controls bullet"><span class="by">broeng</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37761966">parent</a><span>|</span><a href="#37762266">next</a><span>|</span><label class="collapse" for="c-37762135">[-]</label><label class="expand" for="c-37762135">[1 more]</label></div><br/><div class="children"><div class="content"><i>Almost</i> sounds like a productivity enhancement.</div><br/></div></div><div id="37762266" class="c"><input type="checkbox" id="c-37762266" checked=""/><div class="controls bullet"><span class="by">Dagger2</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37761966">parent</a><span>|</span><a href="#37762135">prev</a><span>|</span><a href="#37762193">next</a><span>|</span><label class="collapse" for="c-37762266">[-]</label><label class="expand" for="c-37762266">[1 more]</label></div><br/><div class="children"><div class="content">Those all work for me, on my v6-only desktop. (I don&#x27;t use Discord, but their homepage loads at least.)<p>None of those sites have v6 though, so you&#x27;ll need some form of backwards compatibility running to reach them. Presumably you were missing that.</div><br/></div></div><div id="37762193" class="c"><input type="checkbox" id="c-37762193" checked=""/><div class="controls bullet"><span class="by">roygbiv2</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37761966">parent</a><span>|</span><a href="#37762266">prev</a><span>|</span><a href="#37762217">next</a><span>|</span><label class="collapse" for="c-37762193">[-]</label><label class="expand" for="c-37762193">[8 more]</label></div><br/><div class="children"><div class="content">Also Android doesn&#x27;t support DHCPv6</div><br/><div id="37762212" class="c"><input type="checkbox" id="c-37762212" checked=""/><div class="controls bullet"><span class="by">piperswe</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762193">parent</a><span>|</span><a href="#37762217">next</a><span>|</span><label class="collapse" for="c-37762212">[-]</label><label class="expand" for="c-37762212">[7 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the benefit of DHCPv6 over SLAAC (genuine question, never looked into DHCPv6 at all)</div><br/><div id="37762316" class="c"><input type="checkbox" id="c-37762316" checked=""/><div class="controls bullet"><span class="by">sgjohnson</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762212">parent</a><span>|</span><a href="#37762291">next</a><span>|</span><label class="collapse" for="c-37762316">[-]</label><label class="expand" for="c-37762316">[5 more]</label></div><br/><div class="children"><div class="content">all of the DHCP options, for example.<p>SLAAC just tells the endpoint device to self-assign an address and to roll with it. For example, there’s no way to pass in DNS servers with SLAAC.</div><br/><div id="37762584" class="c"><input type="checkbox" id="c-37762584" checked=""/><div class="controls bullet"><span class="by">rnhmjoj</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762316">parent</a><span>|</span><a href="#37762475">next</a><span>|</span><label class="collapse" for="c-37762584">[-]</label><label class="expand" for="c-37762584">[1 more]</label></div><br/><div class="children"><div class="content">The DNS bit it&#x27;s not true: there&#x27;s RFC8106 [1] for this and it&#x27;s widely supported. You can set a list of DNS servers to use (RDNSS) and a domain suffix for resolving unqualified hostnames (DNSSL), exactly as for DHCP.<p>[1]: <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8106" rel="nofollow noreferrer">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8106</a></div><br/></div></div><div id="37762475" class="c"><input type="checkbox" id="c-37762475" checked=""/><div class="controls bullet"><span class="by">MayeulC</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762316">parent</a><span>|</span><a href="#37762584">prev</a><span>|</span><a href="#37762291">next</a><span>|</span><label class="collapse" for="c-37762475">[-]</label><label class="expand" for="c-37762475">[3 more]</label></div><br/><div class="children"><div class="content">Can&#x27;t you provide DNS servers as part of router advertisement packets ? RFC8106</div><br/><div id="37762532" class="c"><input type="checkbox" id="c-37762532" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762475">parent</a><span>|</span><a href="#37762516">next</a><span>|</span><label class="collapse" for="c-37762532">[-]</label><label class="expand" for="c-37762532">[1 more]</label></div><br/><div class="children"><div class="content">This requires client support though, which isn&#x27;t a given.</div><br/></div></div><div id="37762516" class="c"><input type="checkbox" id="c-37762516" checked=""/><div class="controls bullet"><span class="by">sgjohnson</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762475">parent</a><span>|</span><a href="#37762532">prev</a><span>|</span><a href="#37762291">next</a><span>|</span><label class="collapse" for="c-37762516">[-]</label><label class="expand" for="c-37762516">[1 more]</label></div><br/><div class="children"><div class="content">I stand corrected, but I haven&#x27;t seen this in practice yet.</div><br/></div></div></div></div></div></div><div id="37762291" class="c"><input type="checkbox" id="c-37762291" checked=""/><div class="controls bullet"><span class="by">chungy</span><span>|</span><a href="#37761789">root</a><span>|</span><a href="#37762212">parent</a><span>|</span><a href="#37762316">prev</a><span>|</span><a href="#37762217">next</a><span>|</span><label class="collapse" for="c-37762291">[-]</label><label class="expand" for="c-37762291">[1 more]</label></div><br/><div class="children"><div class="content">You can do finer-grained subnets with DHCP than SLAAC will give you.</div><br/></div></div></div></div></div></div></div></div><div id="37762217" class="c"><input type="checkbox" id="c-37762217" checked=""/><div class="controls bullet"><span class="by">nelgaard</span><span>|</span><a href="#37761789">parent</a><span>|</span><a href="#37761966">prev</a><span>|</span><label class="collapse" for="c-37762217">[-]</label><label class="expand" for="c-37762217">[1 more]</label></div><br/><div class="children"><div class="content">plus these individual devices will live for a long time.<p>I recently had to setup a non-encrypted website because I have a few old devices that can no longer do HTTPS.<p>IPv4 on local networks will probably exist for a very long time.</div><br/></div></div></div></div></div></div></div></div></div></body></html>