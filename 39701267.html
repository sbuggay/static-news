<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710579650748" as="style"/><link rel="stylesheet" href="styles.css?v=1710579650748"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://netflixtechblog.com/bending-pause-times-to-your-will-with-generational-zgc-256629c9386b?gi=f77216038c95">Bending pause times to your will with Generational ZGC</a> <span class="domain">(<a href="https://netflixtechblog.com">netflixtechblog.com</a>)</span></div><div class="subtext"><span>lichtenberger</span> | <span>18 comments</span></div><br/><div><div id="39721440" class="c"><input type="checkbox" id="c-39721440" checked=""/><div class="controls bullet"><span class="by">WJW</span><span>|</span><a href="#39723813">next</a><span>|</span><label class="collapse" for="c-39721440">[-]</label><label class="expand" for="c-39721440">[7 more]</label></div><br/><div class="children"><div class="content">I find it incredible how much design room there is in GC research and how much is as yet unexplored. In my opinion, GC (and relatedly, event loop scheduling) are often way too integrated in a language runtime. I would love seeing this become more configurable, and am glad to see developments in this direction like the fiber schedulers in modern Ruby and custom allocators in Zig.<p>I once inquired about making the Haskell IO manager configurable at runtime but the GHC maintainer team was extremely apprehensive about it because they feared that they would be on the hook for any bugs introduced by third-party IO managers. As it is, Java gets all the GC research love while most other languages make do with very basic GC algorithms. It doesn&#x27;t have to be like this.</div><br/><div id="39721987" class="c"><input type="checkbox" id="c-39721987" checked=""/><div class="controls bullet"><span class="by">rbranson</span><span>|</span><a href="#39721440">parent</a><span>|</span><a href="#39723759">next</a><span>|</span><label class="collapse" for="c-39721987">[-]</label><label class="expand" for="c-39721987">[2 more]</label></div><br/><div class="children"><div class="content">The reason is that runtime design forms the constraints of the GC design. Java allows relocating objects, Go does not. Go allows interior pointers, Java does not. These decisions have deep impact on GC design. Something this performance critical needs to be tailored to the runtime.</div><br/><div id="39723703" class="c"><input type="checkbox" id="c-39723703" checked=""/><div class="controls bullet"><span class="by">felixge</span><span>|</span><a href="#39721440">root</a><span>|</span><a href="#39721987">parent</a><span>|</span><a href="#39723759">next</a><span>|</span><label class="collapse" for="c-39723703">[-]</label><label class="expand" for="c-39723703">[1 more]</label></div><br/><div class="children"><div class="content">AFAIK Go’s spec allows relocating objects. The door towards a moving GC is kept open.</div><br/></div></div></div></div><div id="39723759" class="c"><input type="checkbox" id="c-39723759" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#39721440">parent</a><span>|</span><a href="#39721987">prev</a><span>|</span><a href="#39722550">next</a><span>|</span><label class="collapse" for="c-39723759">[-]</label><label class="expand" for="c-39723759">[3 more]</label></div><br/><div class="children"><div class="content">Which is a reason why randomly talking about programming language capabilities with automatic memory management is nonsense, without actually looking into the details.<p>Unfortunately that is exactly what the manual memory management crowd does.</div><br/><div id="39724048" class="c"><input type="checkbox" id="c-39724048" checked=""/><div class="controls bullet"><span class="by">mynameisnoone</span><span>|</span><a href="#39721440">root</a><span>|</span><a href="#39723759">parent</a><span>|</span><a href="#39722550">next</a><span>|</span><label class="collapse" for="c-39724048">[-]</label><label class="expand" for="c-39724048">[2 more]</label></div><br/><div class="children"><div class="content"><i>Erlang enters the chat to brag about efficient HiPE GC by tying objects to processes.</i><p><i>Pony enters the chat to brag about ORCA.</i><p><i>Rust enters the chat to brag about precise memory management without GC per se.</i><p>Those bastards!</div><br/><div id="39724145" class="c"><input type="checkbox" id="c-39724145" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#39721440">root</a><span>|</span><a href="#39724048">parent</a><span>|</span><a href="#39722550">next</a><span>|</span><label class="collapse" for="c-39724145">[-]</label><label class="expand" for="c-39724145">[1 more]</label></div><br/><div class="children"><div class="content">Your Erlang and Pony examples use automatic memory management and only reinforce my remarks.<p>Additionally, linear and affine type systems isn&#x27;t the same as manual memory management.</div><br/></div></div></div></div></div></div><div id="39722550" class="c"><input type="checkbox" id="c-39722550" checked=""/><div class="controls bullet"><span class="by">memco</span><span>|</span><a href="#39721440">parent</a><span>|</span><a href="#39723759">prev</a><span>|</span><a href="#39723813">next</a><span>|</span><label class="collapse" for="c-39722550">[-]</label><label class="expand" for="c-39722550">[1 more]</label></div><br/><div class="children"><div class="content">In that same vein of thought Nim recently launched version 2 of the language which makes the ORC GC the default with options to use a few others. I don’t know if there’s new ones on the horizon but there’s already plumbing in case that’s an interest for you to explore further.</div><br/></div></div></div></div><div id="39723813" class="c"><input type="checkbox" id="c-39723813" checked=""/><div class="controls bullet"><span class="by">KingOfCoders</span><span>|</span><a href="#39721440">prev</a><span>|</span><a href="#39722500">next</a><span>|</span><label class="collapse" for="c-39723813">[-]</label><label class="expand" for="c-39723813">[2 more]</label></div><br/><div class="children"><div class="content">Java has been pushing out new and better GC constantly the last decades.<p>I wish Go would invest in GC the same way Java does.</div><br/><div id="39724087" class="c"><input type="checkbox" id="c-39724087" checked=""/><div class="controls bullet"><span class="by">zigzag312</span><span>|</span><a href="#39723813">parent</a><span>|</span><a href="#39722500">next</a><span>|</span><label class="collapse" for="c-39724087">[-]</label><label class="expand" for="c-39724087">[1 more]</label></div><br/><div class="children"><div class="content">Same for C#. It&#x27;s a little weird that it&#x27;s used in games, but doesn&#x27;t have a low latency GC.</div><br/></div></div></div></div><div id="39722500" class="c"><input type="checkbox" id="c-39722500" checked=""/><div class="controls bullet"><span class="by">exabrial</span><span>|</span><a href="#39723813">prev</a><span>|</span><a href="#39722760">next</a><span>|</span><label class="collapse" for="c-39722500">[-]</label><label class="expand" for="c-39722500">[1 more]</label></div><br/><div class="children"><div class="content">What sort of heap sizes does g1 vs zgc really start to make a difference?</div><br/></div></div><div id="39722760" class="c"><input type="checkbox" id="c-39722760" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#39722500">prev</a><span>|</span><a href="#39724033">next</a><span>|</span><label class="collapse" for="c-39722760">[-]</label><label class="expand" for="c-39722760">[6 more]</label></div><br/><div class="children"><div class="content">You can try to explain to people that enabling Transparent Hugepages is going to win them 5-20% CPU throughput and they just won&#x27;t believe you.</div><br/><div id="39724327" class="c"><input type="checkbox" id="c-39724327" checked=""/><div class="controls bullet"><span class="by">znpy</span><span>|</span><a href="#39722760">parent</a><span>|</span><a href="#39723293">next</a><span>|</span><label class="collapse" for="c-39724327">[-]</label><label class="expand" for="c-39724327">[1 more]</label></div><br/><div class="children"><div class="content">It does also bring occasional latency spikes.<p>You can solve that by manually allocating hugepages.</div><br/></div></div><div id="39723293" class="c"><input type="checkbox" id="c-39723293" checked=""/><div class="controls bullet"><span class="by">ladberg</span><span>|</span><a href="#39722760">parent</a><span>|</span><a href="#39724327">prev</a><span>|</span><a href="#39723732">next</a><span>|</span><label class="collapse" for="c-39723293">[-]</label><label class="expand" for="c-39723293">[1 more]</label></div><br/><div class="children"><div class="content">Some articles explaining huge pages for anyone curious (and hopefully people will trust that a high frequency trading firm has enough money on the line to get this right):<p><a href="https:&#x2F;&#x2F;www.hudsonrivertrading.com&#x2F;hrtbeat&#x2F;low-latency-optimization-part-1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.hudsonrivertrading.com&#x2F;hrtbeat&#x2F;low-latency-optim...</a><p><a href="https:&#x2F;&#x2F;www.hudsonrivertrading.com&#x2F;hrtbeat&#x2F;low-latency-optimization-part-2&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.hudsonrivertrading.com&#x2F;hrtbeat&#x2F;low-latency-optim...</a></div><br/></div></div><div id="39723732" class="c"><input type="checkbox" id="c-39723732" checked=""/><div class="controls bullet"><span class="by">crotchfire</span><span>|</span><a href="#39722760">parent</a><span>|</span><a href="#39723293">prev</a><span>|</span><a href="#39723496">next</a><span>|</span><label class="collapse" for="c-39723732">[-]</label><label class="expand" for="c-39723732">[2 more]</label></div><br/><div class="children"><div class="content">Software people desperately want to believe that MMUs come at no cost whatsoever.<p>A few of them accept that they have a cost, but insist that it is totally predictable and deterministic.<p>You can&#x27;t talk them out of these beliefs.  I have tried.  They just get very angry at you.</div><br/><div id="39724079" class="c"><input type="checkbox" id="c-39724079" checked=""/><div class="controls bullet"><span class="by">mynameisnoone</span><span>|</span><a href="#39722760">root</a><span>|</span><a href="#39723732">parent</a><span>|</span><a href="#39723496">next</a><span>|</span><label class="collapse" for="c-39724079">[-]</label><label class="expand" for="c-39724079">[1 more]</label></div><br/><div class="children"><div class="content">Everyone knows 4 KiB memory pages just magically appear in the page table and OS kernel data structures with exactly the same computational and storage complexity as 1 GiB ones.<p>&#x2F;s in case it wasn&#x27;t transparent.<p>It&#x27;s stupid egotists who get emotional and defend their &quot;alternative facts&quot;.</div><br/></div></div></div></div><div id="39723496" class="c"><input type="checkbox" id="c-39723496" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#39722760">parent</a><span>|</span><a href="#39723732">prev</a><span>|</span><a href="#39724033">next</a><span>|</span><label class="collapse" for="c-39723496">[-]</label><label class="expand" for="c-39723496">[1 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t this depend on your usage pattern?</div><br/></div></div></div></div><div id="39724033" class="c"><input type="checkbox" id="c-39724033" checked=""/><div class="controls bullet"><span class="by">mynameisnoone</span><span>|</span><a href="#39722760">prev</a><span>|</span><label class="collapse" for="c-39724033">[-]</label><label class="expand" for="c-39724033">[1 more]</label></div><br/><div class="children"><div class="content">Wondering if anyone here runs Azul&#x27;s C4 in production and how it compares to ZGC.</div><br/></div></div></div></div></div></div></div></body></html>