<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1721293263115" as="style"/><link rel="stylesheet" href="styles.css?v=1721293263115"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://ninjakoa.la/curly_curves/posts/quadratic_bezier_arc_length_parametrization/">Closed form arc length parametrization is impossible for quadratic Bézier curves</a> <span class="domain">(<a href="https://ninjakoa.la">ninjakoa.la</a>)</span></div><div class="subtext"><span>NinjaKoala</span> | <span>31 comments</span></div><br/><div><div id="40993757" class="c"><input type="checkbox" id="c-40993757" checked=""/><div class="controls bullet"><span class="by">ForOldHack</span><span>|</span><a href="#40991689">next</a><span>|</span><label class="collapse" for="c-40993757">[-]</label><label class="expand" for="c-40993757">[1 more]</label></div><br/><div class="children"><div class="content">If you swing a tree in a forest, and do not hit a tree, are you still in a forest? A lot of dancing was done here - no music.<p>If two irrational numbers have no rational cofactors, than their sum cannot ever be rational. ( I.e. pi + e, pi + sqrt ( n E primes ), or e + etc...)<p>There is only one exception.<p>Next is squaring of a circle cannot be done because a third order polynomial has no real roots, guess what happens when. That third order polynomial is a bezier curve? Now the general case cannot be proven by elementary means, but it still can be approximated, and since these types of approxmiatins have a lot in common, they can be calculated quicky, and even pre calculated. I.e. looked up in a table,which of course trivizes the numeric methods and potential time cost in rendering   these at raster image processing speeds, i.e which was the speed breakthrough for postscript at high resolution. Most unfortunately, the lookups for the Chinese character stroke dictionaries was never optimized which would have been a much improved speed up, but just for those specific classes of beazier curves, called rosettes and teardrops.<p>Although there exists no closed parameterazation, the numeric methods at low (screen), medium (laser) and high (phototypesetter) all can produce high speed lookups, and get pages printed, and or rendered to the screen.<p>True type uses cubic spilnes and are not they much faster, because they are pre-calculated lookups too. I.e. it makes little diffence if the parameterization is impossible in the general case.<p>I will get back with a formal proof of why the sum of two irrational numbers without common cofactors can never be rational. I think it was solved by VonNewman.</div><br/></div></div><div id="40991689" class="c"><input type="checkbox" id="c-40991689" checked=""/><div class="controls bullet"><span class="by">magnio</span><span>|</span><a href="#40993757">prev</a><span>|</span><a href="#40991949">next</a><span>|</span><label class="collapse" for="c-40991689">[-]</label><label class="expand" for="c-40991689">[13 more]</label></div><br/><div class="children"><div class="content">&gt; It is well known in the computer graphics community that the arc length of cubic Bézier curves has no closed form and has to be computed numerically. Sadly, I’ve not yet seen a proof sketch for that, though.<p>A cubic Bezier curve B(t) is a cubic polynomial of t in [0, 1], parameterized by the four control points. Since it is continuously differentiable, its length is the integral from 0 to 1 of the square root of (1 + (B&#x27;)^2), a quartic. Such an integral is well known to be reducible to the elliptic integrals, which have no closed form.</div><br/><div id="40991883" class="c"><input type="checkbox" id="c-40991883" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#40991689">parent</a><span>|</span><a href="#40993452">next</a><span>|</span><label class="collapse" for="c-40991883">[-]</label><label class="expand" for="c-40991883">[11 more]</label></div><br/><div class="children"><div class="content">&gt; Such an integral is well known to be reducible to the elliptic integrals, which have no closed form.<p>I believe you&#x27;re stating the reduction in the wrong direction?</div><br/><div id="40991983" class="c"><input type="checkbox" id="c-40991983" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40991883">parent</a><span>|</span><a href="#40993452">next</a><span>|</span><label class="collapse" for="c-40991983">[-]</label><label class="expand" for="c-40991983">[10 more]</label></div><br/><div class="children"><div class="content">Second paragraph of the Wikipedia article on elliptic integrals: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Elliptic_integral" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Elliptic_integral</a></div><br/><div id="40992163" class="c"><input type="checkbox" id="c-40992163" checked=""/><div class="controls bullet"><span class="by">kevinventullo</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40991983">parent</a><span>|</span><a href="#40993452">next</a><span>|</span><label class="collapse" for="c-40992163">[-]</label><label class="expand" for="c-40992163">[9 more]</label></div><br/><div class="children"><div class="content">The point is that the general non-reducibility of elliptic integrals to closed form does not preclude the possibility of reducing to closed form some particular elliptic integral or combination thereof.</div><br/><div id="40993289" class="c"><input type="checkbox" id="c-40993289" checked=""/><div class="controls bullet"><span class="by">eigenket</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992163">parent</a><span>|</span><a href="#40992641">next</a><span>|</span><label class="collapse" for="c-40993289">[-]</label><label class="expand" for="c-40993289">[1 more]</label></div><br/><div class="children"><div class="content">This is obvious because a straight line is a (degenerate) example of a quadratic or cubic Bezier curve.</div><br/></div></div><div id="40992641" class="c"><input type="checkbox" id="c-40992641" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992163">parent</a><span>|</span><a href="#40993289">prev</a><span>|</span><a href="#40993452">next</a><span>|</span><label class="collapse" for="c-40992641">[-]</label><label class="expand" for="c-40992641">[7 more]</label></div><br/><div class="children"><div class="content">The specific form in question is basically sqrt(any quartic). Seems like almost all of these will be able to be expressed in terms of elliptic integrals and that&#x27;s it. Outer post summarizes this just fine.</div><br/><div id="40992820" class="c"><input type="checkbox" id="c-40992820" checked=""/><div class="controls bullet"><span class="by">bubblyworld</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992641">parent</a><span>|</span><a href="#40992802">next</a><span>|</span><label class="collapse" for="c-40992820">[-]</label><label class="expand" for="c-40992820">[5 more]</label></div><br/><div class="children"><div class="content">They&#x27;re just pointing out that strictly speaking this is not a valid proof that these integrals have no closed form.<p>Compare: halting problem being uncomputable tells you nothing about whether you can solve it for a subset of valid programs.</div><br/><div id="40992919" class="c"><input type="checkbox" id="c-40992919" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992820">parent</a><span>|</span><a href="#40993076">next</a><span>|</span><label class="collapse" for="c-40992919">[-]</label><label class="expand" for="c-40992919">[2 more]</label></div><br/><div class="children"><div class="content">We&#x27;re talking about Bezier curves in the context of CAD and graphics. In this case, I believe there is no reason to assume that these curves will have a more special form than sqrt(arbitrary quartic). Do you think that they do have a more special form, and that this form will simplify nicely? Or are you suggesting that sqrt(abrbitrary quartic) might simplify more?</div><br/><div id="40993615" class="c"><input type="checkbox" id="c-40993615" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992919">parent</a><span>|</span><a href="#40993076">next</a><span>|</span><label class="collapse" for="c-40993615">[-]</label><label class="expand" for="c-40993615">[1 more]</label></div><br/><div class="children"><div class="content">The issue is that &quot;sqrt(arbitrary quartic)&quot; is <i>already</i> more specialized than &quot;elliptic integral&quot;.  So we can&#x27;t just talk about elliptic integrals in general, we need proof that this specialization doesn&#x27;t give rise to closed forms.</div><br/></div></div></div></div><div id="40993076" class="c"><input type="checkbox" id="c-40993076" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#40991689">root</a><span>|</span><a href="#40992820">parent</a><span>|</span><a href="#40992919">prev</a><span>|</span><a href="#40992890">next</a><span>|</span><label class="collapse" for="c-40993076">[-]</label><label class="expand" for="c-40993076">[1 more]</label></div><br/><div class="children"><div class="content">If they had then the elliptic integrals that they&#x27;re reducible to would also have closed form. They don&#x27;t though.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40993452" class="c"><input type="checkbox" id="c-40993452" checked=""/><div class="controls bullet"><span class="by">NinjaKoala</span><span>|</span><a href="#40991689">parent</a><span>|</span><a href="#40991883">prev</a><span>|</span><a href="#40991949">next</a><span>|</span><label class="collapse" for="c-40993452">[-]</label><label class="expand" for="c-40993452">[1 more]</label></div><br/><div class="children"><div class="content">Yes, you&#x27;re right. I didn&#x27;t find a proof for the fact that elliptic integrals have no closed form, though.</div><br/></div></div></div></div><div id="40991949" class="c"><input type="checkbox" id="c-40991949" checked=""/><div class="controls bullet"><span class="by">nvpr</span><span>|</span><a href="#40991689">prev</a><span>|</span><a href="#40992017">next</a><span>|</span><label class="collapse" for="c-40991949">[-]</label><label class="expand" for="c-40991949">[2 more]</label></div><br/><div class="children"><div class="content">The linked article says:<p>&gt; The arc length of quadratic Bézier curves actually can be computed with a closed form expression.<p>While indeed true, the article doesn&#x27;t provide the closed form expression.  The curious or unsatisfied reader can find the solution for the 2D case at the top of page 7 of this SIGGRAPH paper:<p><a href="https:&#x2F;&#x2F;developer.download.nvidia.com&#x2F;devzone&#x2F;devcenter&#x2F;gamegraphics&#x2F;files&#x2F;opengl&#x2F;gpupathrender.pdf" rel="nofollow">https:&#x2F;&#x2F;developer.download.nvidia.com&#x2F;devzone&#x2F;devcenter&#x2F;game...</a><p>The quadratic function Q(t)=(x,y) is of the monomial form A<i>t^2 + B</i>t + C where A, B, and C are 2D coefficients (see page 5) where A is non-zero.<p>Simply convert your Bezier quadratic form to monomial form to apply this equation.<p>This equation still doesn&#x27;t provide an arc length parameterization, the article&#x27;s actual focus.<p>But if you did, say, want to move 26% (or N%, more generally) of the arc length along a quadratic Bezier segment, first compute the total (100%) arc length with the paper&#x27;s formula (take care doing so as the paper suggests).  Then split the Bezier at a halfway guess (try t=0.5).  Again use the formula to evaluate the split quadratic.  Repeating this in a divide and conquer fashion, you narrow in on the t value very close to 26% (or N%) of the arc length.<p>2D vector graphics standards expect to dash cubic &amp; quadratic Bezier segments so some practical strategy to provide an arc length parameterization -- even if unavailable in closed form.</div><br/><div id="40993467" class="c"><input type="checkbox" id="c-40993467" checked=""/><div class="controls bullet"><span class="by">NinjaKoala</span><span>|</span><a href="#40991949">parent</a><span>|</span><a href="#40992017">next</a><span>|</span><label class="collapse" for="c-40993467">[-]</label><label class="expand" for="c-40993467">[1 more]</label></div><br/><div class="children"><div class="content">Yes, the procedure you mention works, but it&#x27;s a numerical method.
I&#x27;m not saying such numerical method&#x27;s are impractical or something, but depending on your general setup, closed form formulas might be faster.</div><br/></div></div></div></div><div id="40992017" class="c"><input type="checkbox" id="c-40992017" checked=""/><div class="controls bullet"><span class="by">LiamPowell</span><span>|</span><a href="#40991949">prev</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992017">[-]</label><label class="expand" for="c-40992017">[8 more]</label></div><br/><div class="children"><div class="content">&gt; It is well known in the computer graphics community that the arc length of cubic Bézier curves has no closed form and has to be computed numerically. Sadly, I’ve not yet seen a proof sketch for that, though.<p>On a somewhat related note: There are of course exceptions to this, such as Pythagorean-Hodograph curves, which do have closed form solutions and would be suitable for a huge number of use-cases. Sadly there&#x27;s not too many mathematicians working in computer graphics so we just end up with numerical solutions to everything.</div><br/><div id="40992123" class="c"><input type="checkbox" id="c-40992123" checked=""/><div class="controls bullet"><span class="by">raphlinus</span><span>|</span><a href="#40992017">parent</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992123">[-]</label><label class="expand" for="c-40992123">[7 more]</label></div><br/><div class="children"><div class="content">Numerical solutions are better. Having a closed form solution is overrated. For example, the closed form solution for arc length of a quadratic Bézier becomes numerically unstable for curves that are close to a straight line. In those cases, you definitely want the numerical approach.<p>I also think Pythagorean Hodograph curves are overrated. Euler spirals, on the other hand, are extremely easy to work with in an arc length parametrization, it&#x27;s just that you need to compute a &quot;special function&quot; to get back to parametrized land. Fortunately, that&#x27;s easy enough to compute very accurately using standard numerical techniques.</div><br/><div id="40992319" class="c"><input type="checkbox" id="c-40992319" checked=""/><div class="controls bullet"><span class="by">infogulch</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992123">parent</a><span>|</span><a href="#40993490">next</a><span>|</span><label class="collapse" for="c-40992319">[-]</label><label class="expand" for="c-40992319">[1 more]</label></div><br/><div class="children"><div class="content">Hey I was about to write a comment suggesting Euler spirals may be easier to calculate the arc length because they are literally defined as a curve whose curvature changes linearly with its curve length, and then the Euler spiral guy himself shows up. :)<p>GPU-Friendly Stroke Expansion - 177 points - 11 days ago - 40 comments <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40856431">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40856431</a></div><br/></div></div><div id="40993490" class="c"><input type="checkbox" id="c-40993490" checked=""/><div class="controls bullet"><span class="by">NinjaKoala</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992123">parent</a><span>|</span><a href="#40992319">prev</a><span>|</span><a href="#40992471">next</a><span>|</span><label class="collapse" for="c-40993490">[-]</label><label class="expand" for="c-40993490">[1 more]</label></div><br/><div class="children"><div class="content">Numerical solutions are usually much more accurate, yes.
However, especially when computing with fragment shaders for example, closed form formulas tend to be faster. But the main reason for looking into it was because i had fun doing it.</div><br/></div></div><div id="40992471" class="c"><input type="checkbox" id="c-40992471" checked=""/><div class="controls bullet"><span class="by">jacobolus</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992123">parent</a><span>|</span><a href="#40993490">prev</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992471">[-]</label><label class="expand" for="c-40992471">[4 more]</label></div><br/><div class="children"><div class="content">Pythagorean hodograph curves may be impractical, but they&#x27;re a pretty theoretically cute idea. Farouki&#x27;s book is nice.<p>(From what I can tell PH curves are rarely if ever used in practice. They were ostensibly developed for CNC machining and robot motion planning, etc., but are there real products or even serious physical research projects implementing them? What they do have going for them is a <i>huge</i> pile of research papers, of highly variable quality – Google Scholar turns up &gt;2,500 entries.)</div><br/><div id="40992514" class="c"><input type="checkbox" id="c-40992514" checked=""/><div class="controls bullet"><span class="by">LiamPowell</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992471">parent</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992514">[-]</label><label class="expand" for="c-40992514">[3 more]</label></div><br/><div class="children"><div class="content">We&#x27;re using them in practice for C⁴ corner smoothing in a motion controller [1]. All credit for the actual maths to [2].<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;Prunt3D&#x2F;prunt_notebooks&#x2F;blob&#x2F;master&#x2F;Pythagorean-Hodograph%20Splines.ipynb">https:&#x2F;&#x2F;github.com&#x2F;Prunt3D&#x2F;prunt_notebooks&#x2F;blob&#x2F;master&#x2F;Pytha...</a><p>[2]: <a href="https:&#x2F;&#x2F;link.springer.com&#x2F;article&#x2F;10.1007&#x2F;s00170-022-09463-y" rel="nofollow">https:&#x2F;&#x2F;link.springer.com&#x2F;article&#x2F;10.1007&#x2F;s00170-022-09463-y</a></div><br/><div id="40992538" class="c"><input type="checkbox" id="c-40992538" checked=""/><div class="controls bullet"><span class="by">jacobolus</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992514">parent</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992538">[-]</label><label class="expand" for="c-40992538">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for the links! What&#x27;s Prunt, and does it have a website?</div><br/><div id="40992562" class="c"><input type="checkbox" id="c-40992562" checked=""/><div class="controls bullet"><span class="by">LiamPowell</span><span>|</span><a href="#40992017">root</a><span>|</span><a href="#40992538">parent</a><span>|</span><a href="#40991998">next</a><span>|</span><label class="collapse" for="c-40992562">[-]</label><label class="expand" for="c-40992562">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What&#x27;s Prunt, and does it have a website?<p>A motion controller for 3D printers (notably with crackle-constrained trajectory planning), and no website since it is still in the early stages.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40991998" class="c"><input type="checkbox" id="c-40991998" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#40992017">prev</a><span>|</span><a href="#40991551">next</a><span>|</span><label class="collapse" for="c-40991998">[-]</label><label class="expand" for="c-40991998">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure how much more &quot;closed form&quot; you need than elliptic integrals.<p>For another approach, expand sqrt(1 + B&#x27;(t)^2) in a Chebyshev series and you&#x27;re off to the races.</div><br/></div></div><div id="40991551" class="c"><input type="checkbox" id="c-40991551" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#40991998">prev</a><span>|</span><a href="#40991607">next</a><span>|</span><label class="collapse" for="c-40991551">[-]</label><label class="expand" for="c-40991551">[1 more]</label></div><br/><div class="children"><div class="content">I love articles that walk a lay person through a mathematical discovery, piece by piece. An incredibly fun read.</div><br/></div></div><div id="40991607" class="c"><input type="checkbox" id="c-40991607" checked=""/><div class="controls bullet"><span class="by">cyanmagenta</span><span>|</span><a href="#40991551">prev</a><span>|</span><a href="#40991233">next</a><span>|</span><label class="collapse" for="c-40991607">[-]</label><label class="expand" for="c-40991607">[2 more]</label></div><br/><div class="children"><div class="content">Unless Schanuel’s conjecture is wrong, of course.</div><br/><div id="40991631" class="c"><input type="checkbox" id="c-40991631" checked=""/><div class="controls bullet"><span class="by">scythmic_waves</span><span>|</span><a href="#40991607">parent</a><span>|</span><a href="#40991233">next</a><span>|</span><label class="collapse" for="c-40991631">[-]</label><label class="expand" for="c-40991631">[1 more]</label></div><br/><div class="children"><div class="content">… maybe</div><br/></div></div></div></div></div></div></div></div></div></body></html>