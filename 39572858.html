<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1709456456555" as="style"/><link rel="stylesheet" href="styles.css?v=1709456456555"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sdomi.pl/weblog/15-witchcraft-minecraft-server-in-bash/">Writing a Minecraft server from scratch in Bash (2022)</a> <span class="domain">(<a href="https://sdomi.pl">sdomi.pl</a>)</span></div><div class="subtext"><span>LorenDB</span> | <span>41 comments</span></div><br/><div><div id="39573284" class="c"><input type="checkbox" id="c-39573284" checked=""/><div class="controls bullet"><span class="by">TeaVMFan</span><span>|</span><a href="#39573158">next</a><span>|</span><label class="collapse" for="c-39573284">[-]</label><label class="expand" for="c-39573284">[2 more]</label></div><br/><div class="children"><div class="content">As someone who&#x27;s done a lot of work with scriptable Minecraft servers for both Java and Bedrock (ScraM), this is impressive.  Bonus points for using &quot;duckduckgoing&quot; in a sentence.</div><br/></div></div><div id="39573158" class="c"><input type="checkbox" id="c-39573158" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#39573284">prev</a><span>|</span><a href="#39573575">next</a><span>|</span><label class="collapse" for="c-39573158">[-]</label><label class="expand" for="c-39573158">[2 more]</label></div><br/><div class="children"><div class="content">Discussion at the time <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30347501">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30347501</a> 92 comments</div><br/><div id="39575971" class="c"><input type="checkbox" id="c-39575971" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#39573158">parent</a><span>|</span><a href="#39573575">next</a><span>|</span><label class="collapse" for="c-39575971">[-]</label><label class="expand" for="c-39575971">[1 more]</label></div><br/><div class="children"><div class="content">Thanks! Macroexpanded:<p><i>My thoughts on writing a Minecraft server from scratch in Bash</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30347501">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30347501</a> - Feb 2022 (90 comments)</div><br/></div></div></div></div><div id="39573575" class="c"><input type="checkbox" id="c-39573575" checked=""/><div class="controls bullet"><span class="by">BearOso</span><span>|</span><a href="#39573158">prev</a><span>|</span><a href="#39573626">next</a><span>|</span><label class="collapse" for="c-39573575">[-]</label><label class="expand" for="c-39573575">[2 more]</label></div><br/><div class="children"><div class="content">A negative power, i.e. 2^(-n) is just 1&#x2F;(2^n). I&#x27;m surprised the author didn&#x27;t remember that with their own 2^-1 = 0.5 example and eventually reached out to awk for it.</div><br/><div id="39575985" class="c"><input type="checkbox" id="c-39575985" checked=""/><div class="controls bullet"><span class="by">tryauuum</span><span>|</span><a href="#39573575">parent</a><span>|</span><a href="#39573626">next</a><span>|</span><label class="collapse" for="c-39575985">[-]</label><label class="expand" for="c-39575985">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand how this would help the author. Since the bash doesn&#x27;t support floating point numbers anyway</div><br/></div></div></div></div><div id="39573626" class="c"><input type="checkbox" id="c-39573626" checked=""/><div class="controls bullet"><span class="by">taviso</span><span>|</span><a href="#39573575">prev</a><span>|</span><a href="#39577115">next</a><span>|</span><label class="collapse" for="c-39573626">[-]</label><label class="expand" for="c-39573626">[5 more]</label></div><br/><div class="children"><div class="content">They should have used my (dumb?) library, ctypes.sh:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;taviso&#x2F;ctypes.sh">https:&#x2F;&#x2F;github.com&#x2F;taviso&#x2F;ctypes.sh</a><p>Then they can access libm, poll(), select() and so on from bash :)</div><br/><div id="39575100" class="c"><input type="checkbox" id="c-39575100" checked=""/><div class="controls bullet"><span class="by">MrBuddyCasino</span><span>|</span><a href="#39573626">parent</a><span>|</span><a href="#39576357">next</a><span>|</span><label class="collapse" for="c-39575100">[-]</label><label class="expand" for="c-39575100">[1 more]</label></div><br/><div class="children"><div class="content">I‘m not sure you should have done that, but it is impressive for the sheer chuzpa of it. Like reanimating Frankenstein.</div><br/></div></div><div id="39576357" class="c"><input type="checkbox" id="c-39576357" checked=""/><div class="controls bullet"><span class="by">jethro_tell</span><span>|</span><a href="#39573626">parent</a><span>|</span><a href="#39575100">prev</a><span>|</span><a href="#39574073">next</a><span>|</span><label class="collapse" for="c-39576357">[-]</label><label class="expand" for="c-39576357">[1 more]</label></div><br/><div class="children"><div class="content">Lol, holy shit what did I just read?<p>Amazing, installing now.  I want to be part of the problem.</div><br/></div></div><div id="39574073" class="c"><input type="checkbox" id="c-39574073" checked=""/><div class="controls bullet"><span class="by">lagniappe</span><span>|</span><a href="#39573626">parent</a><span>|</span><a href="#39576357">prev</a><span>|</span><a href="#39576645">next</a><span>|</span><label class="collapse" for="c-39574073">[-]</label><label class="expand" for="c-39574073">[1 more]</label></div><br/><div class="children"><div class="content">woah that&#x27;s cool :) also hello tavis</div><br/></div></div><div id="39576645" class="c"><input type="checkbox" id="c-39576645" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#39573626">parent</a><span>|</span><a href="#39574073">prev</a><span>|</span><a href="#39577115">next</a><span>|</span><label class="collapse" for="c-39576645">[-]</label><label class="expand" for="c-39576645">[1 more]</label></div><br/><div class="children"><div class="content">Awesome, but beside the point of writing something in bash that never needed to be in bash for any technical reason.<p>Meaning if it requires bash plus some specially installed compiled c code, then it might as well require c or python or anything else and there is no point in calling it &quot;written in bash&quot;, or writing it in mostly-bash-plus-special-plugin.<p>I do know who I&#x27;m speaking to so please assume I say this respectfully. :)
I have no problem with a &quot;pointless&quot; project like that as I&#x27;ll show in a second.<p>That said, this minecraft project itself relies on externals like xxd when it doesn&#x27;t need to, so using ctypes.sh would be no worse in this case, so you are right, in this case they might as well have.<p>But for the record it is possible to read, store, manipulate, do math on, and output binary in pure bash without anything like dd or xxd.<p>The only byte that is a problem is null, and there is a way to deal with that. You can&#x27;t directly store a null, but you can detect that you read one and store that info, and reconstruct it on output later, or do math on it, use it&#x27;s numerical value as an array index or byte offset or whatever the byte is for.<p>For a minimal example, just copying a binary file:
  while LANG=C IFS= read -d &#x27;&#x27; -r -n 1 x ;do printf &#x27;%c&#x27; &quot;$x&quot; ;done &lt;bin1 &gt;bin2<p>That&#x27;s a bit too minimal since it doesn&#x27;t show what other kinds of things you can do that are more useful than cat-without-cat.<p>A bit more generic and useful:
<a href="https:&#x2F;&#x2F;gist.github.com&#x2F;bkw777&#x2F;c1413d0e3de6c54524ddae890fe8d705" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;bkw777&#x2F;c1413d0e3de6c54524ddae890fe8d...</a><p>The LANG=C, IFS= , and -d&#x27;&#x27; all combine to render all bytes accessible except 0x00, and then the return value from read() tells you the difference between &quot;we read a 0x00&quot; and &quot;we didn&#x27;t read anything&quot; and &quot;input ended&quot;<p>And it doesn&#x27;t have to use &lt; and &gt; on the overall while() comand either. You can exec 3&lt;&gt;file_or_fifo_or_tty and read -u3 &#x2F; printf &gt;&amp;3 etc inside the loop instead.<p>An example reading from a serial port:
<a href="https:&#x2F;&#x2F;gist.github.com&#x2F;bkw777&#x2F;ddde771cc85fdd888c7ec74953193d66" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;bkw777&#x2F;ddde771cc85fdd888c7ec74953193...</a><p>Used in anger: <a href="https:&#x2F;&#x2F;github.com&#x2F;bkw777&#x2F;pdd.sh">https:&#x2F;&#x2F;github.com&#x2F;bkw777&#x2F;pdd.sh</a>
see tpdd_read, tpdd_write, file_to_fhex, str_to_shex
reading and writing both a serial port and local files and doing all kinds of processing on the data.<p>And these loops are not even subshells let alone externals. You can manipulate variables inside the loop and you are still in the same original context. I&#x27;d say parent shell but there are no childern.<p>Those all read a single byte at a time with read -n 1, but they don&#x27;t have to.<p>You can read without the -n1 and each iteration of the loop will collect as much as it can between nulls instead of always one byte. That would consume less ram and less loop iterations.<p>But the things I&#x27;m using them for want to slice &amp; dice the individual bytes and byte-ranges at numerical offsets anyway and the data is always small (by todays standards) so the array-of-hex-pairs is just too convenient where a[n] == byte n, and all bytes are treated the same whether printable, non-printable, or null, and aside from merely storing and regenerating the bytes with printf you can also use the numerical values directly as well by simply prepending 0x, so 0x$n or 0x${a[n]} almost anywhere you would normally have a simple integer. So you can do math on them and use them as array indexes and byte offsets etc.<p>Read the 2nd byte of h[] as a length of the payload to follow, and clip out that payload: ${h[@]:2:0x${h[1]}}</div><br/></div></div></div></div><div id="39577115" class="c"><input type="checkbox" id="c-39577115" checked=""/><div class="controls bullet"><span class="by">osigurdson</span><span>|</span><a href="#39573626">prev</a><span>|</span><a href="#39573565">next</a><span>|</span><label class="collapse" for="c-39577115">[-]</label><label class="expand" for="c-39577115">[1 more]</label></div><br/><div class="children"><div class="content">While I am not good at bash programming, I am surprised how capable &#x2F; non horrible it actually is.</div><br/></div></div><div id="39573565" class="c"><input type="checkbox" id="c-39573565" checked=""/><div class="controls bullet"><span class="by">SunlitCat</span><span>|</span><a href="#39577115">prev</a><span>|</span><a href="#39573268">next</a><span>|</span><label class="collapse" for="c-39573565">[-]</label><label class="expand" for="c-39573565">[19 more]</label></div><br/><div class="children"><div class="content">Just wondering, but is writing custom servers for commercial games still a thing?</div><br/><div id="39574184" class="c"><input type="checkbox" id="c-39574184" checked=""/><div class="controls bullet"><span class="by">madeofpalk</span><span>|</span><a href="#39573565">parent</a><span>|</span><a href="#39574512">next</a><span>|</span><label class="collapse" for="c-39574184">[-]</label><label class="expand" for="c-39574184">[13 more]</label></div><br/><div class="children"><div class="content">For Minecraft, very much so. Minecraft, especially the Java version, is in a comparatively odd place in that it receives significant free content updates AND officially supports running any historical version AND has an extremely vibrant modding community.<p>Minecraft (Java) is as much of a game engine for others to build on as it is a game itself.</div><br/><div id="39574537" class="c"><input type="checkbox" id="c-39574537" checked=""/><div class="controls bullet"><span class="by">themoonisachees</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574184">parent</a><span>|</span><a href="#39574536">next</a><span>|</span><label class="collapse" for="c-39574537">[-]</label><label class="expand" for="c-39574537">[6 more]</label></div><br/><div class="children"><div class="content">This is because in addition to being the most sold video game of all time, minecraft is effectively open source. It&#x27;s not literally open source, but you can decompile java bytecode with standard tooling, and symbols are available, either community-reversed, or official.</div><br/><div id="39574797" class="c"><input type="checkbox" id="c-39574797" checked=""/><div class="controls bullet"><span class="by">teaearlgraycold</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574537">parent</a><span>|</span><a href="#39578011">next</a><span>|</span><label class="collapse" for="c-39574797">[-]</label><label class="expand" for="c-39574797">[4 more]</label></div><br/><div class="children"><div class="content">Frustrating how game studios can see Minecraft&#x27;s success here and not change a thing about their development practices.</div><br/><div id="39575341" class="c"><input type="checkbox" id="c-39575341" checked=""/><div class="controls bullet"><span class="by">Aurornis</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574797">parent</a><span>|</span><a href="#39578011">next</a><span>|</span><label class="collapse" for="c-39575341">[-]</label><label class="expand" for="c-39575341">[3 more]</label></div><br/><div class="children"><div class="content">There’s actually a very large and vibrant community for modding Unity games like this.<p>More competitive games can’t afford any type of easy reverse engineering due to the cheating factor.</div><br/><div id="39575744" class="c"><input type="checkbox" id="c-39575744" checked=""/><div class="controls bullet"><span class="by">darknavi</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39575341">parent</a><span>|</span><a href="#39578011">next</a><span>|</span><label class="collapse" for="c-39575744">[-]</label><label class="expand" for="c-39575744">[2 more]</label></div><br/><div class="children"><div class="content">Mods are the (amazing) end game for Lethal Company.  So many fun, new tweaks and content.</div><br/><div id="39576084" class="c"><input type="checkbox" id="c-39576084" checked=""/><div class="controls bullet"><span class="by">noah91734</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39575744">parent</a><span>|</span><a href="#39578011">next</a><span>|</span><label class="collapse" for="c-39576084">[-]</label><label class="expand" for="c-39576084">[1 more]</label></div><br/><div class="children"><div class="content">For the curious: <a href="https:&#x2F;&#x2F;thunderstore.io&#x2F;c&#x2F;lethal-company&#x2F;" rel="nofollow">https:&#x2F;&#x2F;thunderstore.io&#x2F;c&#x2F;lethal-company&#x2F;</a><p>Click on any mod, and you can see the decompiled source. The mods use function hooking to run before or after certain functions are called rather than the event based system you see in Minecraft plugins.</div><br/></div></div></div></div></div></div></div></div><div id="39578011" class="c"><input type="checkbox" id="c-39578011" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574537">parent</a><span>|</span><a href="#39574797">prev</a><span>|</span><a href="#39574536">next</a><span>|</span><label class="collapse" for="c-39578011">[-]</label><label class="expand" for="c-39578011">[1 more]</label></div><br/><div class="children"><div class="content">minetest is open source for real though</div><br/></div></div></div></div><div id="39574536" class="c"><input type="checkbox" id="c-39574536" checked=""/><div class="controls bullet"><span class="by">Filligree</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574184">parent</a><span>|</span><a href="#39574537">prev</a><span>|</span><a href="#39578004">next</a><span>|</span><label class="collapse" for="c-39574536">[-]</label><label class="expand" for="c-39574536">[4 more]</label></div><br/><div class="children"><div class="content">The four great game engines: Unreal, Unity, Minecraft and Godot.<p>I don’t think Minecraft is number four on the list. It might be number two.</div><br/><div id="39574915" class="c"><input type="checkbox" id="c-39574915" checked=""/><div class="controls bullet"><span class="by">jasonjayr</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574536">parent</a><span>|</span><a href="#39578004">next</a><span>|</span><label class="collapse" for="c-39574915">[-]</label><label class="expand" for="c-39574915">[3 more]</label></div><br/><div class="children"><div class="content">Roblox is somewhere on that list too ....</div><br/><div id="39576597" class="c"><input type="checkbox" id="c-39576597" checked=""/><div class="controls bullet"><span class="by">Filligree</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574915">parent</a><span>|</span><a href="#39578004">next</a><span>|</span><label class="collapse" for="c-39576597">[-]</label><label class="expand" for="c-39576597">[2 more]</label></div><br/><div class="children"><div class="content">How many thousand mods does it have?</div><br/><div id="39576641" class="c"><input type="checkbox" id="c-39576641" checked=""/><div class="controls bullet"><span class="by">BalinKing</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39576597">parent</a><span>|</span><a href="#39578004">next</a><span>|</span><label class="collapse" for="c-39576641">[-]</label><label class="expand" for="c-39576641">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t each server its own mod, in effect?</div><br/></div></div></div></div></div></div></div></div><div id="39578004" class="c"><input type="checkbox" id="c-39578004" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574184">parent</a><span>|</span><a href="#39574536">prev</a><span>|</span><a href="#39574512">next</a><span>|</span><label class="collapse" for="c-39578004">[-]</label><label class="expand" for="c-39578004">[2 more]</label></div><br/><div class="children"><div class="content">Minetest is much more of a game engine.<p>I&#x27;ve heard from someone I know that played both extensively that minetest is less prone to losing everything for data corruption (never happened once in minetest, regularly in minecraft after a while. But sample size is 1).</div><br/><div id="39579391" class="c"><input type="checkbox" id="c-39579391" checked=""/><div class="controls bullet"><span class="by">tehbeard</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39578004">parent</a><span>|</span><a href="#39574512">next</a><span>|</span><label class="collapse" for="c-39579391">[-]</label><label class="expand" for="c-39579391">[1 more]</label></div><br/><div class="children"><div class="content">Is that sample size of one from the java edition or bedrock edition of minecraft?</div><br/></div></div></div></div></div></div><div id="39574512" class="c"><input type="checkbox" id="c-39574512" checked=""/><div class="controls bullet"><span class="by">haunter</span><span>|</span><a href="#39573565">parent</a><span>|</span><a href="#39574184">prev</a><span>|</span><a href="#39573920">next</a><span>|</span><label class="collapse" for="c-39574512">[-]</label><label class="expand" for="c-39574512">[3 more]</label></div><br/><div class="children"><div class="content">Not just servers but for some games clients too <a href="https:&#x2F;&#x2F;runelite.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;runelite.net&#x2F;</a></div><br/><div id="39575029" class="c"><input type="checkbox" id="c-39575029" checked=""/><div class="controls bullet"><span class="by">static_motion</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39574512">parent</a><span>|</span><a href="#39573920">next</a><span>|</span><label class="collapse" for="c-39575029">[-]</label><label class="expand" for="c-39575029">[2 more]</label></div><br/><div class="children"><div class="content">I find RuneLite a fascinatingly well-built piece of software. The lead dev, Adam, did a fantastic job with it, and good on Jagex for allowing its use, even as far as advertising it on their own front page.</div><br/><div id="39575268" class="c"><input type="checkbox" id="c-39575268" checked=""/><div class="controls bullet"><span class="by">hoten</span><span>|</span><a href="#39573565">root</a><span>|</span><a href="#39575029">parent</a><span>|</span><a href="#39573920">next</a><span>|</span><label class="collapse" for="c-39575268">[-]</label><label class="expand" for="c-39575268">[1 more]</label></div><br/><div class="children"><div class="content">It really papers over (some of) the tedium of the game and let&#x27;s you enjoy the rest easier. Love it.</div><br/></div></div></div></div></div></div><div id="39573920" class="c"><input type="checkbox" id="c-39573920" checked=""/><div class="controls bullet"><span class="by">petee</span><span>|</span><a href="#39573565">parent</a><span>|</span><a href="#39574512">prev</a><span>|</span><a href="#39574329">next</a><span>|</span><label class="collapse" for="c-39573920">[-]</label><label class="expand" for="c-39573920">[1 more]</label></div><br/><div class="children"><div class="content">I think it will always be a thing for those who play games &amp; like to dabble with tech, either to fix a bug, learn a language, or just see how the sausage is made.</div><br/></div></div><div id="39574329" class="c"><input type="checkbox" id="c-39574329" checked=""/><div class="controls bullet"><span class="by">firtoz</span><span>|</span><a href="#39573565">parent</a><span>|</span><a href="#39573920">prev</a><span>|</span><a href="#39573268">next</a><span>|</span><label class="collapse" for="c-39574329">[-]</label><label class="expand" for="c-39574329">[1 more]</label></div><br/><div class="children"><div class="content">AFAIK yes, the RE scene is still active.</div><br/></div></div></div></div><div id="39573268" class="c"><input type="checkbox" id="c-39573268" checked=""/><div class="controls bullet"><span class="by">dinkleberg</span><span>|</span><a href="#39573565">prev</a><span>|</span><a href="#39577481">next</a><span>|</span><label class="collapse" for="c-39573268">[-]</label><label class="expand" for="c-39573268">[7 more]</label></div><br/><div class="children"><div class="content">Now this is a proper hacker site. This is great.</div><br/></div></div><div id="39577481" class="c"><input type="checkbox" id="c-39577481" checked=""/><div class="controls bullet"><span class="by">fddrdplktrew</span><span>|</span><a href="#39573268">prev</a><span>|</span><a href="#39576923">next</a><span>|</span><label class="collapse" for="c-39577481">[-]</label><label class="expand" for="c-39577481">[1 more]</label></div><br/><div class="children"><div class="content">Minecraft, one of greatest game since Quake</div><br/></div></div><div id="39576923" class="c"><input type="checkbox" id="c-39576923" checked=""/><div class="controls bullet"><span class="by">bilekas</span><span>|</span><a href="#39577481">prev</a><span>|</span><label class="collapse" for="c-39576923">[-]</label><label class="expand" for="c-39576923">[1 more]</label></div><br/><div class="children"><div class="content">So that happened... Jesus. I&#x27;ve read a lot of articles about the way they implement stuff but this takes the cake. Hands down one of, if not the best write up of something wild I&#x27;ve ever read. Top shelf.</div><br/></div></div></div></div></div></div></div></body></html>