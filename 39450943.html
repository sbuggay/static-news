<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1708506072825" as="style"/><link rel="stylesheet" href="styles.css?v=1708506072825"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://becca.ooo/blog/so-you-want-to-ship-a-command-line-tool-for-macos/">So You Want to Ship a Command-Line Tool for macOS (2022)</a> <span class="domain">(<a href="https://becca.ooo">becca.ooo</a>)</span></div><div class="subtext"><span>freetonik</span> | <span>56 comments</span></div><br/><div><div id="39451302" class="c"><input type="checkbox" id="c-39451302" checked=""/><div class="controls bullet"><span class="by">dagmx</span><span>|</span><a href="#39451161">next</a><span>|</span><label class="collapse" for="c-39451302">[-]</label><label class="expand" for="c-39451302">[1 more]</label></div><br/><div class="children"><div class="content">Seems like part of the problem is that the author wants to both bootstrap homebrew, without users knowing the command line?<p>In which case, they should do the same thing other platforms do: user scripts.<p>Much like bat files on windows, macOS allows writing AppleScript which would sidestep their issues completely, or command files for shell scripts.<p>Otherwise they don’t need to sign command line tools. macOS doesn’t block tools run in the terminal to the best of my knowledge.<p>If they want to make an app, that also doubles as a command line tool, it’s pretty simple as well. You can check for command line options when running the main executable. I’ve done this several times. Apps aren’t magic.<p>They can self sign that app, and their end users can bypass the unknown developer warning, or just launch the command line part.<p>But again, just use AppleScript or command files.</div><br/></div></div><div id="39451161" class="c"><input type="checkbox" id="c-39451161" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39451302">prev</a><span>|</span><a href="#39451195">next</a><span>|</span><label class="collapse" for="c-39451161">[-]</label><label class="expand" for="c-39451161">[9 more]</label></div><br/><div class="children"><div class="content">Ok, so I gotta ask - why package it at all? I&#x27;d never recommend it for a public tool, but in an internal, trusted environment, why not post a &quot;curl ... | sh&quot; command? Or point them at the master&#x2F;main.zip of the repo where that script lives in gitlab&#x2F;hub&#x2F;something?<p>If this is aimed for developers, going through all of that to provide an installable and clickable thing feels a bit unnecessary...<p>Alternatively, since you&#x27;re already using nixpkgs, that contains some wrappers and examples for signing Darwin binaries. May be easier than doing it from scratch.</div><br/><div id="39451232" class="c"><input type="checkbox" id="c-39451232" checked=""/><div class="controls bullet"><span class="by">madduci</span><span>|</span><a href="#39451161">parent</a><span>|</span><a href="#39451248">next</a><span>|</span><label class="collapse" for="c-39451232">[-]</label><label class="expand" for="c-39451232">[5 more]</label></div><br/><div class="children"><div class="content">&gt; Ok, so I gotta ask - why package it at all? I&#x27;d never recommend it for a public tool, but in an internal, trusted environment, why not post a &quot;curl ... | sh&quot; command?<p>Because I don&#x27;t want to install some tools on my PC just to build _your tool_. A packaged application is less complicated for the final user to use it.<p>In this, Windows and some Linux distribution have managed to create a good experience (MSI, AppImage, Flatpack)</div><br/><div id="39451307" class="c"><input type="checkbox" id="c-39451307" checked=""/><div class="controls bullet"><span class="by">threeseed</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451232">parent</a><span>|</span><a href="#39451254">next</a><span>|</span><label class="collapse" for="c-39451307">[-]</label><label class="expand" for="c-39451307">[1 more]</label></div><br/><div class="children"><div class="content">But this is about the Mac and curl etc is built-in.<p>And the Mac has equivalents such as the standard installer, DMG images etc.</div><br/></div></div><div id="39451254" class="c"><input type="checkbox" id="c-39451254" checked=""/><div class="controls bullet"><span class="by">fodkodrasz</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451232">parent</a><span>|</span><a href="#39451307">prev</a><span>|</span><a href="#39451280">next</a><span>|</span><label class="collapse" for="c-39451254">[-]</label><label class="expand" for="c-39451254">[2 more]</label></div><br/><div class="children"><div class="content">You call MSI a good experience until you had to create one.</div><br/><div id="39451404" class="c"><input type="checkbox" id="c-39451404" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451254">parent</a><span>|</span><a href="#39451280">next</a><span>|</span><label class="collapse" for="c-39451404">[-]</label><label class="expand" for="c-39451404">[1 more]</label></div><br/><div class="children"><div class="content">The end user isn&#x27;t privy to how an MSI is created - and that&#x27;s all that matters.<p>Developers suffer what they must, while the user suffers what they will.</div><br/></div></div></div></div><div id="39451280" class="c"><input type="checkbox" id="c-39451280" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451232">parent</a><span>|</span><a href="#39451254">prev</a><span>|</span><a href="#39451248">next</a><span>|</span><label class="collapse" for="c-39451280">[-]</label><label class="expand" for="c-39451280">[1 more]</label></div><br/><div class="children"><div class="content">This post describes installing a script to install other things. So that decision&#x27;s already been made in this case.</div><br/></div></div></div></div><div id="39451248" class="c"><input type="checkbox" id="c-39451248" checked=""/><div class="controls bullet"><span class="by">eesmith</span><span>|</span><a href="#39451161">parent</a><span>|</span><a href="#39451232">prev</a><span>|</span><a href="#39451195">next</a><span>|</span><label class="collapse" for="c-39451248">[-]</label><label class="expand" for="c-39451248">[3 more]</label></div><br/><div class="children"><div class="content">The author wrote the following concerning a curl option:<p>&quot;&quot;&quot;So, what can we do with all of this? We have a few options, but none of them are particularly appealing. ...<p>Download the file with curl. Unix command-line tools like curl and tar don’t add the quarantine bit to the files they create on macOS, so it’s pretty easy to run software downloaded with them.<p>Unfortunately, the repository where this tool is developed is private, so unauthenticated curl downloads won’t work. I’m seriously considering asking the CTO if we can make the repository public <i>solely</i> so we can use curl as a distribution mechanism. I could even write a platform-detecting shell script!
&quot;&quot;&quot;<p>The &quot;curl ... | sh&quot; technique could get pass through the authentication information for a subsequent curl call, but then authentication becomes a facade.</div><br/><div id="39451260" class="c"><input type="checkbox" id="c-39451260" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451248">parent</a><span>|</span><a href="#39451538">next</a><span>|</span><label class="collapse" for="c-39451260">[-]</label><label class="expand" for="c-39451260">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why I added the bit about downloading master&#x2F;main.zip. You can do that from the logged in browser and it&#x27;s still around the same number of steps as installing a custom package and running it. (Login. Download the package&#x2F;script. Install the package or unzip the script. Run it.)</div><br/></div></div><div id="39451538" class="c"><input type="checkbox" id="c-39451538" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39451161">root</a><span>|</span><a href="#39451248">parent</a><span>|</span><a href="#39451260">prev</a><span>|</span><a href="#39451195">next</a><span>|</span><label class="collapse" for="c-39451538">[-]</label><label class="expand" for="c-39451538">[1 more]</label></div><br/><div class="children"><div class="content">Just add an authentication header to the curl command.</div><br/></div></div></div></div></div></div><div id="39451195" class="c"><input type="checkbox" id="c-39451195" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39451161">prev</a><span>|</span><a href="#39451287">next</a><span>|</span><label class="collapse" for="c-39451195">[-]</label><label class="expand" for="c-39451195">[12 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been through the same hell and there&#x27;s basically just one way to publish software for macOS with no hassle for the user: Completely lock yourself in their ecosystem. That means working on a Mac, building in Xcode using Swift and publishing in the official app store. If you want to do anything that resembles the free software approaches of Linux, stay far away from Apple. If you really need to publish on Mac for whatever reason, it is so much better to dump the hassle on the user. Even if the core targets are not developers. And who knows, if you ruin the experience for enough users, Apple might actually bother to fix their system.</div><br/><div id="39451321" class="c"><input type="checkbox" id="c-39451321" checked=""/><div class="controls bullet"><span class="by">threeseed</span><span>|</span><a href="#39451195">parent</a><span>|</span><a href="#39451290">next</a><span>|</span><label class="collapse" for="c-39451321">[-]</label><label class="expand" for="c-39451321">[2 more]</label></div><br/><div class="children"><div class="content">This is simply not true.<p>I build a cross-platform app using Tauri and have never had to touch Xcode, Swift or the App Store.<p>And if you want to a similar experience to Linux then just package your app using homebrew.</div><br/><div id="39451536" class="c"><input type="checkbox" id="c-39451536" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451321">parent</a><span>|</span><a href="#39451290">next</a><span>|</span><label class="collapse" for="c-39451536">[-]</label><label class="expand" for="c-39451536">[1 more]</label></div><br/><div class="children"><div class="content">Of course it&#x27;s possible. Noone ever said anything on the contrary. The issue is how many hoops you have to jump through. And things like Tauri create at least as many problems as they solve once you build more complex things that are not minimal PoCs.</div><br/></div></div></div></div><div id="39451290" class="c"><input type="checkbox" id="c-39451290" checked=""/><div class="controls bullet"><span class="by">Klonoar</span><span>|</span><a href="#39451195">parent</a><span>|</span><a href="#39451321">prev</a><span>|</span><a href="#39451275">next</a><span>|</span><label class="collapse" for="c-39451290">[-]</label><label class="expand" for="c-39451290">[3 more]</label></div><br/><div class="children"><div class="content">Plenty of open source software out there is able to figure out how to ship in the Mac ecosystem without needing to go through the app store.</div><br/><div id="39451316" class="c"><input type="checkbox" id="c-39451316" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451290">parent</a><span>|</span><a href="#39451275">next</a><span>|</span><label class="collapse" for="c-39451316">[-]</label><label class="expand" for="c-39451316">[2 more]</label></div><br/><div class="children"><div class="content">That was never in question. Read what was said again.</div><br/><div id="39451325" class="c"><input type="checkbox" id="c-39451325" checked=""/><div class="controls bullet"><span class="by">Klonoar</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451316">parent</a><span>|</span><a href="#39451275">next</a><span>|</span><label class="collapse" for="c-39451325">[-]</label><label class="expand" for="c-39451325">[1 more]</label></div><br/><div class="children"><div class="content">I did, and I&#x27;ll highlight the relevant sections of your comment for you.<p>&gt; I&#x27;ve been through the same hell and <i>there&#x27;s basically just one way</i> to publish software for macOS with no hassle for the user: Completely lock yourself in their ecosystem. That means working on a Mac, <i>building in Xcode using Swift and publishing in the official app store.</i><p>Your highlighted portions are false.</div><br/></div></div></div></div></div></div><div id="39451275" class="c"><input type="checkbox" id="c-39451275" checked=""/><div class="controls bullet"><span class="by">isodev</span><span>|</span><a href="#39451195">parent</a><span>|</span><a href="#39451290">prev</a><span>|</span><a href="#39451287">next</a><span>|</span><label class="collapse" for="c-39451275">[-]</label><label class="expand" for="c-39451275">[6 more]</label></div><br/><div class="children"><div class="content">And why not respect the platform you want to support? Just like you get various Linux&#x2F;BSD distros and they all have a different take on packaging and distributions... you also have the way macOS does it. There is no inherent expectation that &quot;what I do on Linux&quot; will work on macOS... or every Linux even.</div><br/><div id="39451333" class="c"><input type="checkbox" id="c-39451333" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451275">parent</a><span>|</span><a href="#39451287">next</a><span>|</span><label class="collapse" for="c-39451333">[-]</label><label class="expand" for="c-39451333">[5 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly what&#x27;s happening. But while most software devs still steer around Apple for these kinda of things, Windows and Linux have figured out a way to work nicely together. If you want to ship from one of them to the other, it is trivial - which is by no means expected or how it always was. And it did make everyone&#x27;s lives easier.</div><br/><div id="39451441" class="c"><input type="checkbox" id="c-39451441" checked=""/><div class="controls bullet"><span class="by">threeseed</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451333">parent</a><span>|</span><a href="#39451355">next</a><span>|</span><label class="collapse" for="c-39451441">[-]</label><label class="expand" for="c-39451441">[3 more]</label></div><br/><div class="children"><div class="content">I have no idea what magical thing Windows and Linux have figured out.<p>Is it WSL2 ? Because you can distribute Mac CLI apps exactly the same way.<p>The issue here is with the code-signing process which is optional but recommended just like on Windows.</div><br/><div id="39451495" class="c"><input type="checkbox" id="c-39451495" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451441">parent</a><span>|</span><a href="#39451355">next</a><span>|</span><label class="collapse" for="c-39451495">[-]</label><label class="expand" for="c-39451495">[2 more]</label></div><br/><div class="children"><div class="content">It is &quot;optional&quot; in the sense that it removes hassle from the user. This is what the original article and my comment are all about. And don&#x27;t get me started on building anything remotely more complex stuff for Mac from Windows or Linux. With the other too it&#x27;s trivial to build and ship across by comparison.</div><br/><div id="39451600" class="c"><input type="checkbox" id="c-39451600" checked=""/><div class="controls bullet"><span class="by">AnonymousPlanet</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451495">parent</a><span>|</span><a href="#39451355">next</a><span>|</span><label class="collapse" for="c-39451600">[-]</label><label class="expand" for="c-39451600">[1 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t call WSL hassle free for the user. Quite the contrary. And compiling stuff on Windows is a nightmare compared to Linux and macOS. It&#x27;s become marginally better since you don&#x27;t have to install the entire Visual Studio monstrosity anymore just to get a compiler that plays nice with the system. But it wasn&#x27;t always like that. On macOS you could always install the necessary parts from Xcode without App store and activate it via command line.</div><br/></div></div></div></div></div></div><div id="39451355" class="c"><input type="checkbox" id="c-39451355" checked=""/><div class="controls bullet"><span class="by">isodev</span><span>|</span><a href="#39451195">root</a><span>|</span><a href="#39451333">parent</a><span>|</span><a href="#39451441">prev</a><span>|</span><a href="#39451287">next</a><span>|</span><label class="collapse" for="c-39451355">[-]</label><label class="expand" for="c-39451355">[1 more]</label></div><br/><div class="children"><div class="content">To be exact though, Windows didn&#x27;t figure out how to work together, they transplanted &quot;a thing&quot; (WSL) and I&#x27;m not sure that&#x27;s a tool one can expect users who are not developers or IT folks to install or use. All &quot;native&quot; windows ways also require windowsy tooling (e.g. MSI, powershell etc...)</div><br/></div></div></div></div></div></div></div></div><div id="39451287" class="c"><input type="checkbox" id="c-39451287" checked=""/><div class="controls bullet"><span class="by">shp0ngle</span><span>|</span><a href="#39451195">prev</a><span>|</span><a href="#39451257">next</a><span>|</span><label class="collapse" for="c-39451287">[-]</label><label class="expand" for="c-39451287">[1 more]</label></div><br/><div class="children"><div class="content">Hm, this doesn&#x27;t match my experience at all, I just use rcodesign (the third party rust tool), some plist and xar magic (that I honestly forgot) and call it a day<p>it&#x27;s sad that we need third party tool to be able to codesign and notarize effectively (and from other OSes and CIs), but it works now<p>but maybe I miss something that the author needed and I didn&#x27;t. The hardest part was cross-compiling for macOS but we did it too with these images from elasticsearch<p><a href="https:&#x2F;&#x2F;github.com&#x2F;elastic&#x2F;golang-crossbuild">https:&#x2F;&#x2F;github.com&#x2F;elastic&#x2F;golang-crossbuild</a></div><br/></div></div><div id="39451257" class="c"><input type="checkbox" id="c-39451257" checked=""/><div class="controls bullet"><span class="by">isodev</span><span>|</span><a href="#39451287">prev</a><span>|</span><a href="#39451354">next</a><span>|</span><label class="collapse" for="c-39451257">[-]</label><label class="expand" for="c-39451257">[1 more]</label></div><br/><div class="children"><div class="content">It seems strange to try and make a sandboxed tool to perform work which is not sandboxed at all...<p>There is a class of macOS applications which can perform such functions and they&#x27;re called Packages or Distributions (it&#x27;s the wizard you see sometimes when an app needs to make changes to the system before you can use it). That&#x27;s the way to deliver such applications from a downloadable source. Packages can be signed and notarised and none of the crazy workarounds listed in the post will be necessary.</div><br/></div></div><div id="39451354" class="c"><input type="checkbox" id="c-39451354" checked=""/><div class="controls bullet"><span class="by">ludovicianul</span><span>|</span><a href="#39451257">prev</a><span>|</span><a href="#39451442">next</a><span>|</span><label class="collapse" for="c-39451354">[-]</label><label class="expand" for="c-39451354">[2 more]</label></div><br/><div class="children"><div class="content">As this targets developers, aren&#x27;t developers supposed to be familiar with the terminal. So doing `chmod +x` is trivial. Especially since they probably use a lot of other tooling to build, package, deploy, etc.</div><br/><div id="39451550" class="c"><input type="checkbox" id="c-39451550" checked=""/><div class="controls bullet"><span class="by">sssilverman</span><span>|</span><a href="#39451354">parent</a><span>|</span><a href="#39451442">next</a><span>|</span><label class="collapse" for="c-39451550">[-]</label><label class="expand" for="c-39451550">[1 more]</label></div><br/><div class="children"><div class="content">Seriously. You want to ask the CTO to make artifacts public because you don&#x27;t want devs to set or clear an attribute bit? Talk about entirely the wrong priorities.<p>Where did this coddled sense of entitlement come from? Are they creating their own SSH keys? Do they know the basics of the git cli? Or are these &quot;magic commands&quot; too? Do they know how to do their job?<p>I sympathise that Apple&#x27;s tooling could be better, but the conclusion and tone is ridiculous given what could charitably be described as &#x27;unique&#x27; requirements.<p>Our internal CLI tools have all largely been hassle free regardless of devs OS. We do use GoReleaser which abstracts away the multi arch builds, signing, and publishing to GitHub and Homebrew, which can be criticised sometimes as a bit of a crutch. But it&#x27;s also been zero hassle for all of our Mac devs (the most junior of which are still expected to be able to download and execute a binary from a terminal.) and lets us get on with our day without prioritising &#x27;requirements&#x27; that aren&#x27;t even worth spending any time on.</div><br/></div></div></div></div><div id="39451442" class="c"><input type="checkbox" id="c-39451442" checked=""/><div class="controls bullet"><span class="by">hibbelig</span><span>|</span><a href="#39451354">prev</a><span>|</span><a href="#39451432">next</a><span>|</span><label class="collapse" for="c-39451442">[-]</label><label class="expand" for="c-39451442">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t quite understand what the problem is with asking the developers to download the tool using curl.  The developers could add their username and password to the command line...</div><br/></div></div><div id="39451432" class="c"><input type="checkbox" id="c-39451432" checked=""/><div class="controls bullet"><span class="by">gigatexal</span><span>|</span><a href="#39451442">prev</a><span>|</span><a href="#39451078">next</a><span>|</span><label class="collapse" for="c-39451432">[-]</label><label class="expand" for="c-39451432">[3 more]</label></div><br/><div class="children"><div class="content">I’ve not used macOS in forever but I never had issues with cli binaries installed with Brew or Nix or just manually added to some path. Are they forcing all binaries to be signed now?</div><br/><div id="39451465" class="c"><input type="checkbox" id="c-39451465" checked=""/><div class="controls bullet"><span class="by">threeseed</span><span>|</span><a href="#39451432">parent</a><span>|</span><a href="#39451078">next</a><span>|</span><label class="collapse" for="c-39451465">[-]</label><label class="expand" for="c-39451465">[2 more]</label></div><br/><div class="children"><div class="content">Nothing has changed.<p>For some reason they want to distribute this command line script as a double-click installer which doesn&#x27;t need to be signed either. Users will simply need to override the &quot;this is untrusted and you shouldn&#x27;t open this&quot; dialog.</div><br/><div id="39451537" class="c"><input type="checkbox" id="c-39451537" checked=""/><div class="controls bullet"><span class="by">angulardragon03</span><span>|</span><a href="#39451432">root</a><span>|</span><a href="#39451465">parent</a><span>|</span><a href="#39451078">next</a><span>|</span><label class="collapse" for="c-39451537">[-]</label><label class="expand" for="c-39451537">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. It doesn’t seem like there is anything you’d want to do in a binary that couldn’t be done by creating an installer .pkg and just including all the logic in the post install script.<p>The user gets a double-click “installer”, and like you said, you don’t even need to sign it.</div><br/></div></div></div></div></div></div><div id="39451078" class="c"><input type="checkbox" id="c-39451078" checked=""/><div class="controls bullet"><span class="by">physicsguy</span><span>|</span><a href="#39451432">prev</a><span>|</span><a href="#39451228">next</a><span>|</span><label class="collapse" for="c-39451078">[-]</label><label class="expand" for="c-39451078">[4 more]</label></div><br/><div class="children"><div class="content">It’s a weird time as a developer when it’s now easier to install WSL2 on an enterprise machine and use that for development than it is to use an actually Unix based OS</div><br/><div id="39451163" class="c"><input type="checkbox" id="c-39451163" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#39451078">parent</a><span>|</span><a href="#39451228">next</a><span>|</span><label class="collapse" for="c-39451163">[-]</label><label class="expand" for="c-39451163">[3 more]</label></div><br/><div class="children"><div class="content">Linux runs mostly fine nowadays – I&#x27;d say the experience is smoother than with Windows, even. Have you tried it recently?</div><br/><div id="39451176" class="c"><input type="checkbox" id="c-39451176" checked=""/><div class="controls bullet"><span class="by">reactordev</span><span>|</span><a href="#39451078">root</a><span>|</span><a href="#39451163">parent</a><span>|</span><a href="#39451228">next</a><span>|</span><label class="collapse" for="c-39451176">[-]</label><label class="expand" for="c-39451176">[2 more]</label></div><br/><div class="children"><div class="content">I think they were making a jab at Apple. Not saying they can’t run Unix.</div><br/><div id="39451502" class="c"><input type="checkbox" id="c-39451502" checked=""/><div class="controls bullet"><span class="by">asystole</span><span>|</span><a href="#39451078">root</a><span>|</span><a href="#39451176">parent</a><span>|</span><a href="#39451228">next</a><span>|</span><label class="collapse" for="c-39451502">[-]</label><label class="expand" for="c-39451502">[1 more]</label></div><br/><div class="children"><div class="content">&lt;obligatory &quot;macOS is Unix&quot;&gt;</div><br/></div></div></div></div></div></div></div></div><div id="39451228" class="c"><input type="checkbox" id="c-39451228" checked=""/><div class="controls bullet"><span class="by">fredsted</span><span>|</span><a href="#39451078">prev</a><span>|</span><a href="#39451270">next</a><span>|</span><label class="collapse" for="c-39451228">[-]</label><label class="expand" for="c-39451228">[1 more]</label></div><br/><div class="children"><div class="content">My company ships a simple CLI, it&#x27;s written in Node.js so it can be installed on any platform using npm. A a Docker image is also provided. Most of the target audience has either of these installed.</div><br/></div></div><div id="39451270" class="c"><input type="checkbox" id="c-39451270" checked=""/><div class="controls bullet"><span class="by">Klonoar</span><span>|</span><a href="#39451228">prev</a><span>|</span><a href="#39451197">next</a><span>|</span><label class="collapse" for="c-39451270">[-]</label><label class="expand" for="c-39451270">[1 more]</label></div><br/><div class="children"><div class="content">This is really specific, but for this point in the article:<p><i>&gt; There’s a long guide on Embedding a Command-Line Tool in a Sandboxed App, so I followed that, and then slowly, painfully, factored Xcode out of it, so that I wouldn’t have to figure out how to get a 10GB Xcode install onto the CI machine (remember, you need to be signed in to an Apple ID to download Xcode, and there’s no way to do it from the command-line).</i><p>You could actually solve this with Rust and no Xcode whatsoever. cacao [1] and cargo-bundle [2] will produce an app bundle you could sign&#x2F;notarize&#x2F;distribute without needing to ever open Xcode.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;ryanmcgrath&#x2F;cacao">https:&#x2F;&#x2F;github.com&#x2F;ryanmcgrath&#x2F;cacao</a>
[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;burtonageo&#x2F;cargo-bundle">https:&#x2F;&#x2F;github.com&#x2F;burtonageo&#x2F;cargo-bundle</a><p>You wouldn&#x27;t need to tangle with Swift, would only need enough Rust to hoist whatever script you&#x27;re trying to run.<p>In general though I find the article a bit odd - there are also quite a few examples of signing&#x2F;notarizing&#x2F;etc for GitHub Actions out there already, I went through this exercise a week ago and it wasn&#x27;t that bad.<p><i>Edit: Hell, you could also potentially just bundle your scripts up into a `.pkg` installer</i></div><br/></div></div><div id="39451197" class="c"><input type="checkbox" id="c-39451197" checked=""/><div class="controls bullet"><span class="by">iansinnott</span><span>|</span><a href="#39451270">prev</a><span>|</span><a href="#39451154">next</a><span>|</span><label class="collapse" for="c-39451197">[-]</label><label class="expand" for="c-39451197">[1 more]</label></div><br/><div class="children"><div class="content">At a past job the team had a custom CLI tool to manage all sorts of dev tooling. Worked great, highly recommended.<p>The distribution mechanism was to build from source[<i>]. Once compiled, all other dev tasks were handled by the tool.<p>If you compile it yourself you don&#x27;t run into any of these issues. This approach is only viable for developer tools of course, but that&#x27;s what the post is about.<p>[</i>]: This was a Go project, so building from source was relatively straight forward.</div><br/></div></div><div id="39451154" class="c"><input type="checkbox" id="c-39451154" checked=""/><div class="controls bullet"><span class="by">modernerd</span><span>|</span><a href="#39451197">prev</a><span>|</span><a href="#39451210">next</a><span>|</span><label class="collapse" for="c-39451154">[-]</label><label class="expand" for="c-39451154">[3 more]</label></div><br/><div class="children"><div class="content">Apple’s tools really could emit better messages when things go wrong. It’s sad that they hit a dead-end with this after everything they went through.<p>Windows isn’t a cakewalk either (you now have to use a hardware security module to store your certs, which means USB stick based signing or using a cloud service that supports HSMs, plus certs themselves are a racket in terms of pricing).</div><br/><div id="39451317" class="c"><input type="checkbox" id="c-39451317" checked=""/><div class="controls bullet"><span class="by">pansa2</span><span>|</span><a href="#39451154">parent</a><span>|</span><a href="#39451210">next</a><span>|</span><label class="collapse" for="c-39451317">[-]</label><label class="expand" for="c-39451317">[2 more]</label></div><br/><div class="children"><div class="content">But Windows is still happy to run downloaded executables that aren’t signed, isn’t it? OTOH it sounds like macOS requires everything to be signed.</div><br/><div id="39451481" class="c"><input type="checkbox" id="c-39451481" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39451154">root</a><span>|</span><a href="#39451317">parent</a><span>|</span><a href="#39451210">next</a><span>|</span><label class="collapse" for="c-39451481">[-]</label><label class="expand" for="c-39451481">[1 more]</label></div><br/><div class="children"><div class="content">No, you have to do a bit of work to proceed with the installation. Windows with throw some scary warnings at you if you download something unsigned and try to run it. And if you&#x27;re very unlucky and anger the SmartScreen, you may need to use power user level workarounds.</div><br/></div></div></div></div></div></div><div id="39451210" class="c"><input type="checkbox" id="c-39451210" checked=""/><div class="controls bullet"><span class="by">saurik</span><span>|</span><a href="#39451154">prev</a><span>|</span><a href="#39451222">next</a><span>|</span><label class="collapse" for="c-39451210">[-]</label><label class="expand" for="c-39451210">[1 more]</label></div><br/><div class="children"><div class="content">You actually can pass certificates in files on disk to Apple&#x27;s codesign utility, it just involves understanding .keychain files.<p>Also, while this only sometimes helps, it is worth looking for more error information in dmesg as that is where verification errors go.</div><br/></div></div><div id="39451222" class="c"><input type="checkbox" id="c-39451222" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#39451210">prev</a><span>|</span><a href="#39451351">next</a><span>|</span><label class="collapse" for="c-39451222">[-]</label><label class="expand" for="c-39451222">[1 more]</label></div><br/><div class="children"><div class="content">Apparently it&#x27;s about a command line tool that&#x27;s not downloaded and started on the command line, but instead downloaded in a browser and started by double clicking in the Finder (apparently for non-technical users?). TBF, this also wouldn&#x27;t work on Windows without an expensive EV code signing certificate (which isn&#x27;t exactly trivial to use with GH Actions either: <a href="https:&#x2F;&#x2F;melatonin.dev&#x2F;blog&#x2F;how-to-code-sign-windows-installers-with-an-ev-cert-on-github-actions&#x2F;" rel="nofollow">https:&#x2F;&#x2F;melatonin.dev&#x2F;blog&#x2F;how-to-code-sign-windows-installe...</a>)<p>...from what I&#x27;m seeing on macOS, downloading and running a cmdline tool (built with the Xcode cmdline toolchain on GH Actions) inside the terminal still works without all the hassle described in the article - of course I wouldn&#x27;t be surprised if that stopped working too one day :&#x2F;<p>PS: I kinda wish that operating systems had builtin WASI runners for this kind of bootstrapping work.</div><br/></div></div><div id="39451351" class="c"><input type="checkbox" id="c-39451351" checked=""/><div class="controls bullet"><span class="by">p0w3n3d</span><span>|</span><a href="#39451222">prev</a><span>|</span><a href="#39451158">next</a><span>|</span><label class="collapse" for="c-39451351">[-]</label><label class="expand" for="c-39451351">[1 more]</label></div><br/><div class="children"><div class="content">Didn&#x27;t we have recently a docker image here on HN that allows to build for macOS?<p>Sadly I can&#x27;t find it in a zounds of articles containing macOS and build</div><br/></div></div><div id="39451158" class="c"><input type="checkbox" id="c-39451158" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#39451351">prev</a><span>|</span><a href="#39451145">next</a><span>|</span><label class="collapse" for="c-39451158">[-]</label><label class="expand" for="c-39451158">[5 more]</label></div><br/><div class="children"><div class="content">Why not just ship it as a Homebrew package instead? It&#x27;s jankier than any of the usual Linux packaging systems, but should get the work done. (Of course, it doesn&#x27;t solve the “running from Finder” problem, but then again you don&#x27;t usually run your command line tools by double clicking them in file manager, do you?)</div><br/><div id="39451167" class="c"><input type="checkbox" id="c-39451167" checked=""/><div class="controls bullet"><span class="by">reactordev</span><span>|</span><a href="#39451158">parent</a><span>|</span><a href="#39451145">next</a><span>|</span><label class="collapse" for="c-39451167">[-]</label><label class="expand" for="c-39451167">[4 more]</label></div><br/><div class="children"><div class="content">If you read the article, you’d know.</div><br/><div id="39451217" class="c"><input type="checkbox" id="c-39451217" checked=""/><div class="controls bullet"><span class="by">kreetx</span><span>|</span><a href="#39451158">root</a><span>|</span><a href="#39451167">parent</a><span>|</span><a href="#39451145">next</a><span>|</span><label class="collapse" for="c-39451217">[-]</label><label class="expand" for="c-39451217">[3 more]</label></div><br/><div class="children"><div class="content">Do you understand the reasoning though? The explanation says the tool is responsible for &quot;installing homebrew&quot;, but also that the developers this thing is for &quot;refuse to install homebrew&quot;. Seems paradoxical.<p>But if this blog post gets Apple to improve their code signing process, then it does have value :)</div><br/><div id="39451327" class="c"><input type="checkbox" id="c-39451327" checked=""/><div class="controls bullet"><span class="by">dagmx</span><span>|</span><a href="#39451158">root</a><span>|</span><a href="#39451217">parent</a><span>|</span><a href="#39451429">next</a><span>|</span><label class="collapse" for="c-39451327">[-]</label><label class="expand" for="c-39451327">[1 more]</label></div><br/><div class="children"><div class="content">The reason is that this is meant to be a script to bootstrap their startups systems to the way the poster wants.<p>But I think they have a really odd set of requirements in that they don’t want their devs to run a CLI tool from the terminal, but want to run it from Finder?</div><br/></div></div><div id="39451429" class="c"><input type="checkbox" id="c-39451429" checked=""/><div class="controls bullet"><span class="by">hibbelig</span><span>|</span><a href="#39451158">root</a><span>|</span><a href="#39451217">parent</a><span>|</span><a href="#39451327">prev</a><span>|</span><a href="#39451145">next</a><span>|</span><label class="collapse" for="c-39451429">[-]</label><label class="expand" for="c-39451429">[1 more]</label></div><br/><div class="children"><div class="content">My understanding is that the goal is as follows:<p>1. New team member gets new fresh Mac
2. New team member downloads the tool and runs it
3. New fresh Mac is now set up with a development environment suitable for the company, including a working Homebrew installation (or Nix or whatever)</div><br/></div></div></div></div></div></div></div></div><div id="39451145" class="c"><input type="checkbox" id="c-39451145" checked=""/><div class="controls bullet"><span class="by">nox101</span><span>|</span><a href="#39451158">prev</a><span>|</span><a href="#39451200">next</a><span>|</span><label class="collapse" for="c-39451145">[-]</label><label class="expand" for="c-39451145">[4 more]</label></div><br/><div class="children"><div class="content">it&#x27;s not clear to me what you want to happen. It sounds like you have a command line tool that takes no arguments. you want a Mac user to be able to download a file, click that file, have it run once?  and then delete itself? Not sure about this last part<p>in any case I think there are plenty of apps that do this. Some are distributed as packages instead of apps.<p>I&#x27;m not a Mac dev expert at all but I have used enough apps to know it&#x27;s possible. Many of those apps are open source maybe look into them if you want to solve this issue.<p>Electron apps have tools for automatically signing on GitHub actions so looking though what they do might help?<p>sorry I don&#x27;t have concrete suggestions. I&#x27;m just confident there are solutions.<p>I&#x27;m totally sympathetic to the fact they it&#x27;s a pain in the ass and Apple, probably intentionally, doesn&#x27;t document the process well or at all</div><br/><div id="39451190" class="c"><input type="checkbox" id="c-39451190" checked=""/><div class="controls bullet"><span class="by">reactordev</span><span>|</span><a href="#39451145">parent</a><span>|</span><a href="#39451159">next</a><span>|</span><label class="collapse" for="c-39451190">[-]</label><label class="expand" for="c-39451190">[1 more]</label></div><br/><div class="children"><div class="content">This can all be achieved with a simple shell script to compile the binary on the devs machine.<p>Xcode-select —install<p>git clone…<p>make</div><br/></div></div><div id="39451159" class="c"><input type="checkbox" id="c-39451159" checked=""/><div class="controls bullet"><span class="by">aslilac</span><span>|</span><a href="#39451145">parent</a><span>|</span><a href="#39451190">prev</a><span>|</span><a href="#39451169">next</a><span>|</span><label class="collapse" for="c-39451159">[-]</label><label class="expand" for="c-39451159">[1 more]</label></div><br/><div class="children"><div class="content">I think the point is pretty clearly “Apple should do better and provide better tools”</div><br/></div></div><div id="39451169" class="c"><input type="checkbox" id="c-39451169" checked=""/><div class="controls bullet"><span class="by">modernerd</span><span>|</span><a href="#39451145">parent</a><span>|</span><a href="#39451159">prev</a><span>|</span><a href="#39451200">next</a><span>|</span><label class="collapse" for="c-39451169">[-]</label><label class="expand" for="c-39451169">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Electron apps have tools for automatically signing on GitHub actions so looking though what they do might help?<p>These only sign&#x2F;notarise the dmg or app bundles (or the binaries inside them), so I don’t think that will help the OP unless they’re willing to wrap their CLI app in an Electron app, unfortunately.</div><br/></div></div></div></div><div id="39451200" class="c"><input type="checkbox" id="c-39451200" checked=""/><div class="controls bullet"><span class="by">pikseladam</span><span>|</span><a href="#39451145">prev</a><span>|</span><a href="#39451501">next</a><span>|</span><label class="collapse" for="c-39451200">[-]</label><label class="expand" for="c-39451200">[1 more]</label></div><br/><div class="children"><div class="content">good article actually. apple don&#x27;t want you to do it :)
but why not use swift on xcode? i get that you don&#x27;t want to but why is that?</div><br/></div></div><div id="39451105" class="c"><input type="checkbox" id="c-39451105" checked=""/><div class="controls bullet"><span class="by">palad1n</span><span>|</span><a href="#39451501">prev</a><span>|</span><label class="collapse" for="c-39451105">[-]</label><label class="expand" for="c-39451105">[1 more]</label></div><br/><div class="children"><div class="content">tldr: &quot;don&#x27;t&quot;</div><br/></div></div></div></div></div></div></div></body></html>