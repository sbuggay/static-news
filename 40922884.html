<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1720602064561" as="style"/><link rel="stylesheet" href="styles.css?v=1720602064561"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.jetify.com/blog/automated-dev-envs-with-devbox-and-direnv/">Automate Project Environments with Devbox and Direnv</a>Â <span class="domain">(<a href="https://www.jetify.com">www.jetify.com</a>)</span></div><div class="subtext"><span>jljljl</span> | <span>14 comments</span></div><br/><div><div id="40924874" class="c"><input type="checkbox" id="c-40924874" checked=""/><div class="controls bullet"><span class="by">weitzj</span><span>|</span><a href="#40924589">next</a><span>|</span><label class="collapse" for="c-40924874">[-]</label><label class="expand" for="c-40924874">[1 more]</label></div><br/><div class="children"><div class="content">Great project which you can also use as your package manager on your system.
This works nice if your developers have a MacBook with an Arm processor and want to have the build process close to what you do in your ci server which might be a Linux amd64</div><br/></div></div><div id="40924589" class="c"><input type="checkbox" id="c-40924589" checked=""/><div class="controls bullet"><span class="by">aerzen</span><span>|</span><a href="#40924874">prev</a><span>|</span><a href="#40924885">next</a><span>|</span><label class="collapse" for="c-40924589">[-]</label><label class="expand" for="c-40924589">[1 more]</label></div><br/><div class="children"><div class="content">This is the way. We should make it a standard practice for oss projects that one is able to git clone, direnv allow and build the project.<p>Regardless of the distro or even OS. An easy thing to say, but hard to execute on actual projects with patched versions of cPython and some obscure in-house build tool.</div><br/></div></div><div id="40924885" class="c"><input type="checkbox" id="c-40924885" checked=""/><div class="controls bullet"><span class="by">Iridescent_</span><span>|</span><a href="#40924589">prev</a><span>|</span><a href="#40924753">next</a><span>|</span><label class="collapse" for="c-40924885">[-]</label><label class="expand" for="c-40924885">[1 more]</label></div><br/><div class="children"><div class="content">It looks quite smaller in scope than devenv (<a href="https:&#x2F;&#x2F;devenv.sh&#x2F;" rel="nofollow">https:&#x2F;&#x2F;devenv.sh&#x2F;</a>)</div><br/></div></div><div id="40924569" class="c"><input type="checkbox" id="c-40924569" checked=""/><div class="controls bullet"><span class="by">cquintana92</span><span>|</span><a href="#40924753">prev</a><span>|</span><a href="#40924893">next</a><span>|</span><label class="collapse" for="c-40924569">[-]</label><label class="expand" for="c-40924569">[1 more]</label></div><br/><div class="children"><div class="content">Been using Devbox recently both at work and for personal projects and I can only say good things.
It abstracts away the complexity of nix, defining the dependencies in a simple json with a lock file, the shell starts quite fast and from then on you have everything under your PATH, and it works the same in macOS and Linux.<p>Also, as a benefit, by tracking the JSON and lockfile, the CI can work with the exact same environment. I highly recommend giving it a try.</div><br/></div></div><div id="40924893" class="c"><input type="checkbox" id="c-40924893" checked=""/><div class="controls bullet"><span class="by">undecisive</span><span>|</span><a href="#40924569">prev</a><span>|</span><a href="#40923802">next</a><span>|</span><label class="collapse" for="c-40924893">[-]</label><label class="expand" for="c-40924893">[2 more]</label></div><br/><div class="children"><div class="content">My experience of Devbox on Linux has been highly disappointing. I gave it a good go, had it running on my main project from February to May.<p>In case you hadn&#x27;t realised, the very concept of having two sets of binary distributions on one machine, vying for superiority and the correct version of glibc...  is fraught.<p>Most of my use was with rails projects, and I can&#x27;t recommend it.<p>Coupled with an abstraction that tries to save you from Nix, but almost entirely fails, you end up with a bloated hellscape where every time you load your project it will unnecessarily reinstall your packages and several times an hour it will have forgotten curl exists and so you have to manually reinstall curl (not-so-slowly increasing your &#x2F;nix folder&#x27;s size), every week or two a new version of devbox completely changes the workarounds you need to do, and don&#x27;t try to garbage collect nix or it will delete vital files, and you end up scrubbing it all and starting again.<p>In python, it overrode the path so I couldn&#x27;t get it to reliably use the binaries in the venv. Pip and Python were using packages in different places and I couldn&#x27;t get them to converge for love nor money.<p>The devbox team were great and really tried to get things working, but in the end I couldn&#x27;t get it to work with enough stability to properly recommend it to my team, and if I wanted it to half-work for any substantial length of time I had to lock to a version of devbox.<p>Obviously, ymmv, please do give it a try, it&#x27;s an impressive project. But my view is that it&#x27;s trying to do something that is very very hard, and for that you need a very clever solution. And this is a very clever solution, with very clever bugs, and so it&#x27;s not something I&#x27;d recommend jumping into with both feet.</div><br/><div id="40924937" class="c"><input type="checkbox" id="c-40924937" checked=""/><div class="controls bullet"><span class="by">KingMob</span><span>|</span><a href="#40924893">parent</a><span>|</span><a href="#40923802">next</a><span>|</span><label class="collapse" for="c-40924937">[-]</label><label class="expand" for="c-40924937">[1 more]</label></div><br/><div class="children"><div class="content">We had a similar experience with devenv. It didn&#x27;t really prevent us from needing to learn nix, and then we had two things to deal with instead of one. We eventually switched back to just nix.</div><br/></div></div></div></div><div id="40923802" class="c"><input type="checkbox" id="c-40923802" checked=""/><div class="controls bullet"><span class="by">Mathnerd314</span><span>|</span><a href="#40924893">prev</a><span>|</span><a href="#40924332">next</a><span>|</span><label class="collapse" for="c-40923802">[-]</label><label class="expand" for="c-40923802">[3 more]</label></div><br/><div class="children"><div class="content">&gt;  despite it being a very useful tool, its setup requires investing time and getting over the Nix ecosystem&#x27;s learning curve.<p>They mention Nix but I guess they are referring to the use_nix integration built-in to direnv? There is a fairly detailed (but old) comparison in <a href="https:&#x2F;&#x2F;github.com&#x2F;direnv&#x2F;direnv&#x2F;wiki&#x2F;Nix#some-factors-to-consider">https:&#x2F;&#x2F;github.com&#x2F;direnv&#x2F;direnv&#x2F;wiki&#x2F;Nix#some-factors-to-co...</a> and in the meantime lorri and nix-direnv are the only ones still maintained. But you aren&#x27;t limited to Nix when using direnv, for example there is nvm. <a href="https:&#x2F;&#x2F;github.com&#x2F;direnv&#x2F;direnv&#x2F;wiki&#x2F;Node#using-nvm">https:&#x2F;&#x2F;github.com&#x2F;direnv&#x2F;direnv&#x2F;wiki&#x2F;Node#using-nvm</a><p>Actually, the post&#x27;s solution, besides being built on top of direnv, uses Devbox, which itself is built on top of Nix... <a href="https:&#x2F;&#x2F;www.jetify.com&#x2F;devbox&#x2F;docs&#x2F;faq&#x2F;#how-does-devbox-work" rel="nofollow">https:&#x2F;&#x2F;www.jetify.com&#x2F;devbox&#x2F;docs&#x2F;faq&#x2F;#how-does-devbox-work</a> So they are saying they are outside the Nix ecosystem when in fact they are in it. It is yet another set of nice scripts on top of Nix.</div><br/><div id="40924724" class="c"><input type="checkbox" id="c-40924724" checked=""/><div class="controls bullet"><span class="by">dudus</span><span>|</span><a href="#40923802">parent</a><span>|</span><a href="#40924584">next</a><span>|</span><label class="collapse" for="c-40924724">[-]</label><label class="expand" for="c-40924724">[1 more]</label></div><br/><div class="children"><div class="content">This seems to be mostly a thin wrapper with a nice interface around nix-shell. Replaces Nix (the language) with this random json format inspired by node package.js. Keeps Nix packages.</div><br/></div></div><div id="40924584" class="c"><input type="checkbox" id="c-40924584" checked=""/><div class="controls bullet"><span class="by">a1445c8b</span><span>|</span><a href="#40923802">parent</a><span>|</span><a href="#40924724">prev</a><span>|</span><a href="#40924332">next</a><span>|</span><label class="collapse" for="c-40924584">[-]</label><label class="expand" for="c-40924584">[1 more]</label></div><br/><div class="children"><div class="content">Maybe they meant to reference nix-direnv?</div><br/></div></div></div></div><div id="40924332" class="c"><input type="checkbox" id="c-40924332" checked=""/><div class="controls bullet"><span class="by">azaras</span><span>|</span><a href="#40923802">prev</a><span>|</span><label class="collapse" for="c-40924332">[-]</label><label class="expand" for="c-40924332">[3 more]</label></div><br/><div class="children"><div class="content">Why do not use asdf?</div><br/><div id="40924543" class="c"><input type="checkbox" id="c-40924543" checked=""/><div class="controls bullet"><span class="by">FireInsight</span><span>|</span><a href="#40924332">parent</a><span>|</span><a href="#40924348">next</a><span>|</span><label class="collapse" for="c-40924543">[-]</label><label class="expand" for="c-40924543">[1 more]</label></div><br/><div class="children"><div class="content">Use mise instead; it&#x27;s fast, it gets out of your way, it&#x27;s easy to use, and it&#x27;s compatible with asdf plugins.<p><a href="http:&#x2F;&#x2F;mise.jdx.dev&#x2F;" rel="nofollow">http:&#x2F;&#x2F;mise.jdx.dev&#x2F;</a><p>Can&#x27;t manage lower-level deps like dynamic libraries and C compilers, though. I just containerize those.</div><br/></div></div><div id="40924348" class="c"><input type="checkbox" id="c-40924348" checked=""/><div class="controls bullet"><span class="by">pprotas</span><span>|</span><a href="#40924332">parent</a><span>|</span><a href="#40924543">prev</a><span>|</span><label class="collapse" for="c-40924348">[-]</label><label class="expand" for="c-40924348">[1 more]</label></div><br/><div class="children"><div class="content">Asdf slows down the shell</div><br/></div></div></div></div></div></div></div></div></div></body></html>