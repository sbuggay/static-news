<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1701853256376" as="style"/><link rel="stylesheet" href="styles.css?v=1701853256376"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/m57/dnsteal">DNS Exfiltration Tool</a>Â <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>CodeCat</span> | <span>4 comments</span></div><br/><div><div id="38541626" class="c"><input type="checkbox" id="c-38541626" checked=""/><div class="controls bullet"><span class="by">insanitybit</span><span>|</span><label class="collapse" for="c-38541626">[-]</label><label class="expand" for="c-38541626">[3 more]</label></div><br/><div class="children"><div class="content">Generally DNS exfil isn&#x27;t really &quot;stealthy&quot;. It&#x27;s just that it often bypasses the controls of poorly configured networks. But DNS isn&#x27;t inherently a stealthy protocol, it&#x27;s something most people monitor in a corp environment, in my experience.<p>For production environments it&#x27;s really unnecessary to allow most egress traffic, but it&#x27;s especially unnecessary to allow DNS. What addresses are your servers resolving publicly? You might want DNS for service discovery but obviously that requires no public resolvers, and any DNS exfil requires public resolvers. If you do require some public DNS I&#x27;d suggest limiting it considerably in a production environment, you rarely need legitimately arbitrary public DNS access. Even for niche scenarios (like maybe a &quot;scan this URL&quot; service) you can isolate the DNS resolution.<p>For corporate environments I feel like you can just drop all TXT records. The most trivial form of DNS exfil is always via TXT. Based on the code this appears to be TXT-based as well (hence the 255 character limit, which is because TXT records encode length with a single byte).<p>Is there even a legitimate use for a public TXT record for corporate devices? Genuine question, I legit do not know of one but I could easily be missing something.</div><br/><div id="38541729" class="c"><input type="checkbox" id="c-38541729" checked=""/><div class="controls bullet"><span class="by">Ayesh</span><span>|</span><a href="#38541626">parent</a><span>|</span><a href="#38541695">next</a><span>|</span><label class="collapse" for="c-38541729">[-]</label><label class="expand" for="c-38541729">[1 more]</label></div><br/><div class="children"><div class="content">I monitor DNS queries made by some of my servers by setting a DoH server to systemd-resolve, some of the top queries are:<p>- OCSP servers to query TLS certificate validity. This is necessary because I have configured my web server to staple OCSP responses. (`e1.o.lencr.org`)<p>- Software repos (apt, dnf, etc). `livepatch.canonical.com` being the top contender.<p>- GitHub<p>The only place that TXT records are used in the very popular use cases would be an email server. SPF, DMARC, and DKIM all piggy back in TXT records. I would also imagine a lot of Microsoft stuff like AD use DNS .</div><br/></div></div><div id="38541695" class="c"><input type="checkbox" id="c-38541695" checked=""/><div class="controls bullet"><span class="by">maurice2k</span><span>|</span><a href="#38541626">parent</a><span>|</span><a href="#38541729">prev</a><span>|</span><label class="collapse" for="c-38541695">[-]</label><label class="expand" for="c-38541695">[1 more]</label></div><br/><div class="children"><div class="content">the problem is that most people do not monitor heavy use of TXT records; it&#x27;s rather A&#x2F;AAAA resolves in my experience.<p>but most production system i&#x27;ve seen allow all outgoing traffic (if poorly managed) or restrict it to port 443 (for some APIs) which is kind of all.<p>so if you&#x27;re not in a very very restricted system (and then DNS should be restricted as well!) you&#x27;ll most likely find an easy way to copy stuff over HTTPS.</div><br/></div></div></div></div></div></div></div></div></div></body></html>