<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1722416514608" as="style"/><link rel="stylesheet" href="styles.css?v=1722416514608"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://jstrieb.github.io/posts/c-reflection-zig/">C Macro Reflection in Zig</a> <span class="domain">(<a href="https://jstrieb.github.io">jstrieb.github.io</a>)</span></div><div class="subtext"><span>jstrieb</span> | <span>125 comments</span></div><br/><div><div id="41107260" class="c"><input type="checkbox" id="c-41107260" checked=""/><div class="controls bullet"><span class="by">skywal_l</span><span>|</span><a href="#41111594">next</a><span>|</span><label class="collapse" for="c-41107260">[-]</label><label class="expand" for="c-41107260">[77 more]</label></div><br/><div class="children"><div class="content">@cImport is on the chopping block though [0]. You will still be able to import c files but it will require a little more work. This is because they want this functionality out of the language so they can remove libclang dependency.<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630</a></div><br/><div id="41113403" class="c"><input type="checkbox" id="c-41113403" checked=""/><div class="controls bullet"><span class="by">whitehexagon</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41109879">next</a><span>|</span><label class="collapse" for="c-41113403">[-]</label><label class="expand" for="c-41113403">[2 more]</label></div><br/><div class="children"><div class="content">Do we know if this means the Reflection as mentioned in the article via @typeInfo will no longer work? or was it anyway comptime info?  My Zig so far has been SoC level stuff, but using something like raylib or glfw is somewhere on my todo list, and this example sounds mighty useful.  Anyway seems a strange thing to remove when Zig has the potential to be the new C.  Hopefully also as stable for the next 30 years :)</div><br/><div id="41113784" class="c"><input type="checkbox" id="c-41113784" checked=""/><div class="controls bullet"><span class="by">pbaam</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41113403">parent</a><span>|</span><a href="#41109879">next</a><span>|</span><label class="collapse" for="c-41113784">[-]</label><label class="expand" for="c-41113784">[1 more]</label></div><br/><div class="children"><div class="content">It will still work. If you look at the type signature of @cImport in the language reference[1], it returns a type just as @import. So you can call @typeInfo on it. But instead of writing<p><pre><code>  const win32 = @cImport({
    @cInclude(&quot;windows.h&quot;);
    @cInclude(&quot;winuser.h&quot;);
  });
</code></pre>
You will write:<p><pre><code>  const win32 = @import(&quot;win32&quot;);
</code></pre>
Where the module &quot;win32&quot; is declared in build.zig.<p>[1] <a href="https:&#x2F;&#x2F;ziglang.org&#x2F;documentation&#x2F;master&#x2F;#cImport" rel="nofollow">https:&#x2F;&#x2F;ziglang.org&#x2F;documentation&#x2F;master&#x2F;#cImport</a></div><br/></div></div></div></div><div id="41109879" class="c"><input type="checkbox" id="c-41109879" checked=""/><div class="controls bullet"><span class="by">deagle50</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41113403">prev</a><span>|</span><a href="#41109490">next</a><span>|</span><label class="collapse" for="c-41109879">[-]</label><label class="expand" for="c-41109879">[1 more]</label></div><br/><div class="children"><div class="content">It seems the build system has gotten enough traction and Andrew is going for broke to enshrine its place in the C space. I wouldn&#x27;t bet against him.</div><br/></div></div><div id="41109490" class="c"><input type="checkbox" id="c-41109490" checked=""/><div class="controls bullet"><span class="by">ajnin</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41109879">prev</a><span>|</span><a href="#41107393">next</a><span>|</span><label class="collapse" for="c-41109490">[-]</label><label class="expand" for="c-41109490">[3 more]</label></div><br/><div class="children"><div class="content">&gt; remove libclang<p>So `zig cc` will have to go as well ? I was under the impression Zig as a drop-in C (cross-)compiler was one of its main selling points.</div><br/><div id="41117379" class="c"><input type="checkbox" id="c-41117379" checked=""/><div class="controls bullet"><span class="by">pta2002</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109490">parent</a><span>|</span><a href="#41109624">next</a><span>|</span><label class="collapse" for="c-41117379">[-]</label><label class="expand" for="c-41117379">[1 more]</label></div><br/><div class="children"><div class="content">I think for better or for worse it makes sense that this is delegated to a separate package. For me it always seemed like a weird tangential thing that Zig did that is not really related to Zig The Language, and more to Zig The Build System. It made more sense when they were depending on LLVM either way, but now that they&#x27;re closer to getting rid of it, it does not make sense to keep the dependency just for something that always seemed more like a &#x27;neat thing&#x27; than a core language feature.</div><br/></div></div><div id="41109624" class="c"><input type="checkbox" id="c-41109624" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109490">parent</a><span>|</span><a href="#41117379">prev</a><span>|</span><a href="#41107393">next</a><span>|</span><label class="collapse" for="c-41109624">[-]</label><label class="expand" for="c-41109624">[1 more]</label></div><br/><div class="children"><div class="content">See: <a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-1616115039">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-161...</a><p>The ability to seamlessly compile C&#x2F;C++&#x2F;ObjC code within a Zig project is extremely important for me as well, but I&#x27;m fine with that job being delegated to a Zig package and the Zig build system.</div><br/></div></div></div></div><div id="41107393" class="c"><input type="checkbox" id="c-41107393" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41109490">prev</a><span>|</span><a href="#41110593">next</a><span>|</span><label class="collapse" for="c-41107393">[-]</label><label class="expand" for="c-41107393">[5 more]</label></div><br/><div class="children"><div class="content">It would actually be nice if the translate-c build system step would also allow some restricted symbol transformation (at least stripping the &#x27;namespace prefix&#x27; from C library symbols).<p>For instance Odin allows to define a &#x27;link_prefix&#x27; for C APIs which is then stripped from the imported symbols:<p><pre><code>    @(default_calling_convention=&quot;c&quot;, link_prefix=&quot;sg_&quot;)
</code></pre>
This causes name transformations like:<p><pre><code>    sg_setup() =&gt; setup()
    sg_shutdown() =&gt; shutdown()
</code></pre>
...maybe even convert from common case-conventions (like snake-, camel-, pascal- case etc...) to Zig&#x27;s naming convention so that imported C interfaces don&#x27;t look so alien relative to native Zig interfaces.</div><br/><div id="41109911" class="c"><input type="checkbox" id="c-41109911" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107393">parent</a><span>|</span><a href="#41107405">next</a><span>|</span><label class="collapse" for="c-41109911">[-]</label><label class="expand" for="c-41109911">[3 more]</label></div><br/><div class="children"><div class="content">&gt; common case-conventions<p>Unfortunately, we must not forget forget ABOMINATIONCase and NAMESPACED_PascalCase (we could also generalize this to <i>any</i> switch from one convention to another after the first word). I&#x27;ve found they usually are, in fact, identifiable and roundtrippable. I&#x27;ve found the following usually works (it fails for multi-word prefixes or non-leading exceptions, and of course single-word identifiers are ambiguous):<p><pre><code>  count and strip all leading, then trailing, symbols (in some languages this is not limited to underscore but said languages usually need special handling anyway)
  for every chunk separated by underscore, space, or hyphen (this may be nothing):
    if the chunk either has no uppercase or has no lowercase, simply use it as a word. Otherwise:
    for every sliding-window pair of letters (c, d) in the chunk:
      if c is uppercase:
        if d is lowercase, or d is a digit and there is lowercase elsewhere:
          start a new word before c
</code></pre>
Then for the words-to-convention direction:<p><pre><code>  space and kebab case don&#x27;t have any good answer for affixes AFAIK. Otherwise, restore at least the leading underscores (trailing underscores are usually keyword-avoiding)
  for snake and screaming case, be sure to prepend an underscore if the *result* would start with a digit
  for camel variants, prepend an underscore to each *word* that starts with a digit. But if there were originally more than 1 leading underscores, use those instead for the first word.</code></pre></div><br/><div id="41110026" class="c"><input type="checkbox" id="c-41110026" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109911">parent</a><span>|</span><a href="#41107405">next</a><span>|</span><label class="collapse" for="c-41110026">[-]</label><label class="expand" for="c-41110026">[2 more]</label></div><br/><div class="children"><div class="content">I mean, there can always be a function on the TranslateC step which maps &#x27;special case&#x27; names (or even translate them to an entirely different name, for instance when there&#x27;s collisions with Zig reserved keywords):<p><pre><code>    translateSpecialCaseNames(.{
        .{ .src = &quot;ABOMINATIONCase&quot;, .dst = &quot;case&quot; },
        .{ .src = &quot;NAMESPACED_PascalCase&quot;, .dst = &quot;pascalCase&quot; },
    });
</code></pre>
...in my own language bindings generator, being able to define such special case mappings is actually quite important, mainly for handling that situation where an automatic mapping would result in a reserved keyword.</div><br/><div id="41111986" class="c"><input type="checkbox" id="c-41111986" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110026">parent</a><span>|</span><a href="#41107405">next</a><span>|</span><label class="collapse" for="c-41111986">[-]</label><label class="expand" for="c-41111986">[1 more]</label></div><br/><div class="children"><div class="content">Reserved words really shouldn&#x27;t require manual care; &quot;list of keywords in X language&quot; is really easy to handle so you can just append an underscore.<p>I do think that namespaces need to be semi-manually managed though (likely only at the project level), since often there are things that look like a namespace but shouldn&#x27;t be treated like one, and it&#x27;s not always obvious from a single identifier how many words should be treated as the namespace in some styles.<p>One special case is that sometimes C-ish libraries have class-likes like {Foo, FooBar, FooBaz} where the desired mapping is {foo.Foo, foo.Bar, foo.Baz}.</div><br/></div></div></div></div></div></div><div id="41107405" class="c"><input type="checkbox" id="c-41107405" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107393">parent</a><span>|</span><a href="#41109911">prev</a><span>|</span><a href="#41110593">next</a><span>|</span><label class="collapse" for="c-41107405">[-]</label><label class="expand" for="c-41107405">[1 more]</label></div><br/><div class="children"><div class="content">From the issue<p>&gt; As a consolation prize, the TranslateC build step can be enhanced with advanced settings, such as namespace stripping and validation of existing bindings. Since changes to this don&#x27;t require changing the language, it&#x27;s OK if the scope &amp; complexity increase to some extent.</div><br/></div></div></div></div><div id="41110593" class="c"><input type="checkbox" id="c-41110593" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41107393">prev</a><span>|</span><a href="#41107515">next</a><span>|</span><label class="collapse" for="c-41110593">[-]</label><label class="expand" for="c-41110593">[10 more]</label></div><br/><div class="children"><div class="content">It will require a little more work in a trivial way, but not in a meaningful way.<p>What&#x27;s happening is that C imports are moving to the build system, instead of being a compiler builtin.  It&#x27;s part of making LLVM and libclang optional for programs which don&#x27;t use it, but the use case of building C programs, and integrating C libraries with Zig programs, remains a central design goal.<p>The build system is relatively new, and a lot of things which were originally independent subcommands are being consolidated into the build system.<p>There&#x27;s a sort of ambient impression that &quot;Zig won&#x27;t support C anymore&quot; floating around, I&#x27;m not sure from your post whether you have that impression or not, but it isn&#x27;t even vaguely true.<p>It just means that importing C libraries will be a build step, and not something you write directly into the relevant source code.  This is not a big deal.</div><br/><div id="41111507" class="c"><input type="checkbox" id="c-41111507" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110593">parent</a><span>|</span><a href="#41107515">next</a><span>|</span><label class="collapse" for="c-41111507">[-]</label><label class="expand" for="c-41111507">[9 more]</label></div><br/><div class="children"><div class="content">&gt; It just means that importing C libraries will be a build step, and not something you write directly into the relevant source code. This is not a big deal.<p>It 100% is a big deal. I explained this in another comment [0].<p>[0]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111445">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111445</a></div><br/><div id="41111735" class="c"><input type="checkbox" id="c-41111735" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41111507">parent</a><span>|</span><a href="#41114176">next</a><span>|</span><label class="collapse" for="c-41111735">[-]</label><label class="expand" for="c-41111735">[5 more]</label></div><br/><div class="children"><div class="content">I think you are operating from a mistaken understanding, as responded to in the linked comment.</div><br/><div id="41112880" class="c"><input type="checkbox" id="c-41112880" checked=""/><div class="controls bullet"><span class="by">TwentyPosts</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41111735">parent</a><span>|</span><a href="#41112010">next</a><span>|</span><label class="collapse" for="c-41112880">[-]</label><label class="expand" for="c-41112880">[1 more]</label></div><br/><div class="children"><div class="content">Andrew (in the linked Github page) answered a question as follows:<p>&gt; Question: &quot;So after this change, is there way I can still simply call zig run or do I have to use a build.zig file?&quot;<p>Andrew&#x27;s answer: &quot;No, this use case will regress.&quot;<p>This in fact literally states that &quot;just&quot; calling &quot;zig run&quot; won&#x27;t be possible anymore, and heavily implies you&#x27;ll need a build.zig file.</div><br/></div></div><div id="41112010" class="c"><input type="checkbox" id="c-41112010" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41111735">parent</a><span>|</span><a href="#41112880">prev</a><span>|</span><a href="#41114176">next</a><span>|</span><label class="collapse" for="c-41112010">[-]</label><label class="expand" for="c-41112010">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I think you are operating from a mistaken understanding, as responded to in the linked comment.<p>No, I’m not. Respectfully, you’re responding to my point while admitting in your comment [0] that you don’t actually know.<p>If you read the relevant discussions, the conclusion, last time I checked, was that there’s going to be a build system requirement.<p>[0]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111542">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111542</a></div><br/><div id="41112040" class="c"><input type="checkbox" id="c-41112040" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41112010">parent</a><span>|</span><a href="#41114176">next</a><span>|</span><label class="collapse" for="c-41112040">[-]</label><label class="expand" for="c-41112040">[2 more]</label></div><br/><div class="children"><div class="content">I &quot;don&#x27;t know&quot; because zig 0.14 is not released yet and anything could happen but I DO know that imports do not currently require the build system. And I THINK that&#x27;s because the core parts of the build system (including binding imports) are dependent on the command line anyways. So I am ASSUMING that property will be invariant when the c @import gets implemented, and my &quot;don&#x27;t know&quot; is merely being explicit about that assumption.  You are the one coming from a place of ignorance here, and your refusal to acknowledge that you might be wrong makes me suspect your argument is not being made in good faith.</div><br/><div id="41112229" class="c"><input type="checkbox" id="c-41112229" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41112040">parent</a><span>|</span><a href="#41114176">next</a><span>|</span><label class="collapse" for="c-41112229">[-]</label><label class="expand" for="c-41112229">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You are the one coming from a place of ignorance here, and your refusal to acknowledge that you might be wrong makes me suspect your argument is not being made in good faith.<p>You’re making a lot of “assumptions” when you could just read the GitHub issue regarding this change, written by Andrew himself, titled “move @cImport to the build system” [0].<p>By the way, please note that I not only write Zig code almost daily, I’ve personally contributed to the Zig build system.<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630</a></div><br/></div></div></div></div></div></div></div></div><div id="41114176" class="c"><input type="checkbox" id="c-41114176" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41111507">parent</a><span>|</span><a href="#41111735">prev</a><span>|</span><a href="#41107515">next</a><span>|</span><label class="collapse" for="c-41114176">[-]</label><label class="expand" for="c-41114176">[3 more]</label></div><br/><div class="children"><div class="content">We have different ideas of what a big deal is, clearly.<p>The idea that C programmers, <i>C programmers</i>, are going to start bailing en masse out of the top of the Zig funnel, because they have to copy-paste a build.zig gist to get started? This is risible.<p>The complexity has moved to a slightly different place. That&#x27;s it.</div><br/><div id="41114974" class="c"><input type="checkbox" id="c-41114974" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41114176">parent</a><span>|</span><a href="#41107515">next</a><span>|</span><label class="collapse" for="c-41114974">[-]</label><label class="expand" for="c-41114974">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The idea that C programmers, C programmers, are going to start bailing en masse out of the top of the Zig funnel, because they have to copy-paste a build.zig gist to get started? This is risible.<p>What I find incredible about these takes is that they’re so removed from reality. It’s quite unfortunate how difficult it is to get a lot of programmers to evaluate things from the shoes of others.<p>I have firsthand experience trying to get fellow C programmers to try Zig (and Rust too), and it’s already extremely difficult as is. The three things that have helped me sell Zig has been the combination of (1) how easy it is to get up and running with it (no prerequisites or installs necessary) [0], (2) the C interop story (which was a selling point for me [1]), and (3) the very simple yet impressive and complete build process [0].<p>What’s interesting is that you call my point risible when, based on your response, it’s clear to me you don’t understand the audience we’re talking about.<p>For example, you say:<p>&gt; […] because they have to copy-paste a build.zig gist to get started […]<p>Professional C programmers generally favor actually understanding what’s happening under the hood, so unlike, e.g., JavaScript or Python developers, suggesting they get started by copying and pasting build code they don’t understand is a nonstarter for a lot of C programmers. And understanding Zig’s build system doesn’t happen as quickly [1] as being able to use Zig directly. Even after writing a decent amount of Zig build code, I’ve had to, on a number of occasions, go read the Zig build system code to understand how something is implemented (e.g., how it deals with certain paths, peculiarities of the dependency system, caching semantics, etc.)—if I had to figure out the build system before I was able to get started with Zig and be productive, I would’ve never taken it seriously.<p>There’s a reason why Zig has been marketed as a compiler that can also serve as a drop-in replacement for GCC&#x2F;Clang. What you’re effectively saying is that this main selling point doesn’t matter even though that’s been one of the main things that makes Zig attractive to C programmers. Incredible.<p>[0]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111445">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41111445</a><p>[1]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41107515">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41107515</a></div><br/><div id="41117455" class="c"><input type="checkbox" id="c-41117455" checked=""/><div class="controls bullet"><span class="by">mafuyu</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41114974">parent</a><span>|</span><a href="#41107515">next</a><span>|</span><label class="collapse" for="c-41117455">[-]</label><label class="expand" for="c-41117455">[1 more]</label></div><br/><div class="children"><div class="content">As an embedded C developer who has since branched out to Rust and C++, I’m definitely curious about Zig. Reading about this, I’m a bit split. Losing some of the C interop “magic” sucks, but the proposal to use the Zig build system seems pretty reasonable.<p>Really, I think what C developers want is a modern, opinionated tooling solution a la cargo. If the Zig build system can deliver that (plus the much better ergonomics of the language itself), I think it could be very compelling.<p>I’m sick of Make, CMake, Nix flakes, Docker, manually bundling specific arm cross toolchains, etc. If I can send someone a Zig + C project and the zig.build Just Works, I’m all for it.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41107515" class="c"><input type="checkbox" id="c-41107515" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">parent</a><span>|</span><a href="#41110593">prev</a><span>|</span><a href="#41111594">next</a><span>|</span><label class="collapse" for="c-41107515">[-]</label><label class="expand" for="c-41107515">[55 more]</label></div><br/><div class="children"><div class="content">While I understand the reasoning, I think this is one of the most disappointing decisions by the Zig team.<p>One of the main reasons I took Zig seriously was their C interop story—as someone who loves C and dislikes almost every implementation of C interop and FFI I’ve used in other languages (Rust is a notable exception to this), I was pretty much sold on Zig when I was able to, in a total of &lt; 3-ish hours, (1) implement a complete Zig wrapper over a C library I wrote without introducing any overhead, (2) build a Zig program using the wrapper, and (3) cross-compile the program, statically, producing single binaries for 5 different targets…Linux (amd64, arm64), macOS (amd64, arm64), and Windows (amd64), ALL from one laptop using a single Zig executable and some simple flags. This was C interop and productivity I’ve never experienced before.<p>I respect Andrew a lot (I think he’s pretty brilliant), so I hope this turns out to not be as bad as I think it’ll be for those of us who love Zig for what brings to the table for programmers who are biased toward C.</div><br/><div id="41107716" class="c"><input type="checkbox" id="c-41107716" checked=""/><div class="controls bullet"><span class="by">Laremere</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107792">next</a><span>|</span><label class="collapse" for="c-41107716">[-]</label><label class="expand" for="c-41107716">[19 more]</label></div><br/><div class="children"><div class="content">See these posts on the LLVM issue by Andrew.  They clearly state that this functionality isn&#x27;t going anywhere, just the method of achieving said functionality is changing:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-1615388680">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-161...</a>
<a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-1616115039">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;16270#issuecomment-161...</a></div><br/><div id="41109445" class="c"><input type="checkbox" id="c-41109445" checked=""/><div class="controls bullet"><span class="by">ajnin</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107716">parent</a><span>|</span><a href="#41109866">next</a><span>|</span><label class="collapse" for="c-41109445">[-]</label><label class="expand" for="c-41109445">[10 more]</label></div><br/><div class="children"><div class="content">Not involved with Zig at all, but this comment is a bit concerning :<p>&gt; This is not the first controversial change I have made to the Zig project, and it won&#x27;t be the last. I have a vision, and I know how to execute it. People are often surprised by what Zig has accomplished, and they wonder why other projects have not done what Zig does. Well, you are seeing the magic right now. I ignore the peanut gallery and do what I know is right, while taking care of my users&#x27; needs at the same time. If you don&#x27;t understand now, you will understand once this plan unfolds. By that time it will seem obvious in hindsight.<p>He&#x27;s probably brillant and all but this ... feels like hubris.</div><br/><div id="41110268" class="c"><input type="checkbox" id="c-41110268" checked=""/><div class="controls bullet"><span class="by">eyelidlessness</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41109580">next</a><span>|</span><label class="collapse" for="c-41110268">[-]</label><label class="expand" for="c-41110268">[1 more]</label></div><br/><div class="children"><div class="content">I simultaneously understand why that comment gives you pause, and find comfort in seeing such a clear expression of vision.<p>As someone who often thinks several steps ahead about where I want to take a project, I find it’s just as often difficult to communicate that vision at the level of detail necessary to establish a shared understanding of what those steps mean, and how various apparent minutiae come together to make them all valuable together.<p>I would be lying if I said I don’t wish I shared this particular hubris, and the corresponding expectation that execution will be sufficient to bolster any trust challenged along the way.</div><br/></div></div><div id="41109580" class="c"><input type="checkbox" id="c-41109580" checked=""/><div class="controls bullet"><span class="by">acedTrex</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41110268">prev</a><span>|</span><a href="#41109528">next</a><span>|</span><label class="collapse" for="c-41109580">[-]</label><label class="expand" for="c-41109580">[3 more]</label></div><br/><div class="children"><div class="content">Wow, that actually makes me want to look into zig a lot more. so many projects, rust included, get bogged down in design by committee and half baked decisions that please no one.</div><br/><div id="41109937" class="c"><input type="checkbox" id="c-41109937" checked=""/><div class="controls bullet"><span class="by">bunderbunder</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109580">parent</a><span>|</span><a href="#41112851">next</a><span>|</span><label class="collapse" for="c-41109937">[-]</label><label class="expand" for="c-41109937">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. Andrew Kelley&#x27;s ability to have, communicate <i>and maintain</i> a clear and consistent vision is one of the most refreshing things about Zig. I don&#x27;t actually use it, but this might actually be the main thing attracting me to it.<p>Plenty has already been said about design-by-committee and relying overmuch on user feedback, but one thing that doesn&#x27;t get mentioned as often is that this approach tends to transform additive bias[1] from a cognitive bias into an iron law. Once you let that happen, you&#x27;re on a relatively short and slippery slope to having a kitchen sink language. And one refreshing thing about Zig is that&#x27;s it&#x27;s clearly working very hard at <i>not</i> becoming a kitchen sink language. I&#x27;m not sure I can say the same about most other newer systems programming languages.<p>That doesn&#x27;t mean having a BDFL is all kittens and rainbows, and I&#x27;m sure Andrew has made plenty of mistakes. But I&#x27;ve also never seen any indication that he&#x27;s acted out of anything other than good faith. That last paragraph is possibly the closest I&#x27;ve ever seen to him saying something arrogant, and I see it as the exception that proves the rule. Finding such a tactful way to remind people that this is a BDFL project and he&#x27;s the BDFL could not have been easy, and I imagine he put a <i>lot</i> of care into crafting that paragraph.<p>1: <a href="https:&#x2F;&#x2F;www.scientificamerican.com&#x2F;article&#x2F;our-brain-typically-overlooks-this-brilliant-problem-solving-strategy&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.scientificamerican.com&#x2F;article&#x2F;our-brain-typical...</a></div><br/></div></div><div id="41112851" class="c"><input type="checkbox" id="c-41112851" checked=""/><div class="controls bullet"><span class="by">nkozyra</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109580">parent</a><span>|</span><a href="#41109937">prev</a><span>|</span><a href="#41109528">next</a><span>|</span><label class="collapse" for="c-41112851">[-]</label><label class="expand" for="c-41112851">[1 more]</label></div><br/><div class="children"><div class="content">I agree that letting the community completely dictate direction is a bad idea, but so too is being so dogmatic and idealist that you ignore the feedback.<p>Rust definitely swayed more to the former than I&#x27;d have liked, but you also have Go as a counterexample where generics were dismissed for a decade+ in response to user feedback and then kind of :shrug: ok fine we&#x27;ll add generics.</div><br/></div></div></div></div><div id="41109528" class="c"><input type="checkbox" id="c-41109528" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41109580">prev</a><span>|</span><a href="#41112669">next</a><span>|</span><label class="collapse" for="c-41109528">[-]</label><label class="expand" for="c-41109528">[1 more]</label></div><br/><div class="children"><div class="content">Or very high confidence backed up by experience and skill, expressed through an honest personality.<p>In a world of humble bragging and cheap talk, I find it refreshing.</div><br/></div></div><div id="41112669" class="c"><input type="checkbox" id="c-41112669" checked=""/><div class="controls bullet"><span class="by">dangets</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41109528">prev</a><span>|</span><a href="#41111949">next</a><span>|</span><label class="collapse" for="c-41112669">[-]</label><label class="expand" for="c-41112669">[1 more]</label></div><br/><div class="children"><div class="content">This type of stance is what de-popularized the Elm language.<p>Don&#x27;t get me wrong - I wish the best for both languages and am thoroughly impressed by the work of their creators.  I can see that it must be a hard thing to balance.</div><br/></div></div><div id="41111949" class="c"><input type="checkbox" id="c-41111949" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41112669">prev</a><span>|</span><a href="#41109500">next</a><span>|</span><label class="collapse" for="c-41111949">[-]</label><label class="expand" for="c-41111949">[1 more]</label></div><br/><div class="children"><div class="content">&gt; He&#x27;s probably brillant and all but this ... feels like hubris.<p>I don’t think it’s hubris, because Andrew’s results speak for him, but it’s certainly alienating, to be honest.<p>Although I understand the struggle of having to prioritize opinions and perspectives, it comes across like Andrew only values the opinions and perspectives of very specific folks, whom he often calls out.<p>Here’s what I mean: I love Zig and I write a lot of Zig code, especially within the past year (almost daily), but none of the Zig code I’ve been working on is publicly available or open-source (although I hope I can open-source various components soon, fingers crossed). I’ve gained a lot of valuable experience with Zig—including successfully convincing folks (mainly C programmers) to use it who wouldn’t have tried it otherwise. When I read these interactions, even though I have thoughts I’d like to share as a committed user who wants to see the project succeed and gain mainstream adoption, I get the feeling that my thoughts aren’t welcome since I don’t have a huge Zig project or something, so I just keep my thoughts to myself. Andrew seems to mostly care about feedback from the creators of Bun, TigerBeetle, etc., which, if I’m correct, is fine (it’s his project and therefore his right), but I imagine there are plenty of users like me who aren’t just part of “the peanut gallery” yet staying out of it to avoid the drama.</div><br/></div></div><div id="41109500" class="c"><input type="checkbox" id="c-41109500" checked=""/><div class="controls bullet"><span class="by">JasonSage</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41111949">prev</a><span>|</span><a href="#41109569">next</a><span>|</span><label class="collapse" for="c-41109500">[-]</label><label class="expand" for="c-41109500">[1 more]</label></div><br/><div class="children"><div class="content">Reading that comment for the first time just now, and I love that. More power to them.</div><br/></div></div><div id="41109569" class="c"><input type="checkbox" id="c-41109569" checked=""/><div class="controls bullet"><span class="by">carapace</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109445">parent</a><span>|</span><a href="#41109500">prev</a><span>|</span><a href="#41109866">next</a><span>|</span><label class="collapse" for="c-41109569">[-]</label><label class="expand" for="c-41109569">[1 more]</label></div><br/><div class="children"><div class="content">Don Quixote or St. George?  Only time will tell.  Meanwhile the code works.</div><br/></div></div></div></div><div id="41109866" class="c"><input type="checkbox" id="c-41109866" checked=""/><div class="controls bullet"><span class="by">kasajian</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107716">parent</a><span>|</span><a href="#41109445">prev</a><span>|</span><a href="#41107792">next</a><span>|</span><label class="collapse" for="c-41109866">[-]</label><label class="expand" for="c-41109866">[8 more]</label></div><br/><div class="children"><div class="content">Sounds like damage control.   I have to say, for a brilliant guy, andrewrk knows nothing about marketing.   The fact that the Zig project can make this significant of a change to their core-value because &quot;trust me i know what I&#x27;m doing&quot;, makes it impossible (for now) to rely on this in any type of a widely-deployed Enterprise setting.  This just made the highly risky move of moving to Zig make it darn near impossible.<p>What he should have done is announce a project at the same time that will maintain the current developer experience, even if that project is not part of the zig foundation.   The developer doesn&#x27;t care about how he builds zig.  They want 1) download 2) use.  It doesn&#x27;t matter from where.  If today it&#x27;s directly from zig, and tomorrow it&#x27;s from elsewhere to download a combined package, that &#x27;s all the devs needed to hear.</div><br/><div id="41110137" class="c"><input type="checkbox" id="c-41110137" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109866">parent</a><span>|</span><a href="#41112307">next</a><span>|</span><label class="collapse" for="c-41110137">[-]</label><label class="expand" for="c-41110137">[5 more]</label></div><br/><div class="children"><div class="content">Unfortunately there&#x27;s a lot of people on the internet who haven&#x27;t even used Zig nor plan to use it anytime in the future and who just enjoy to create drama by amplifying any decision with a hint of controversy around it (also see the &#x27;unused variables are errors&#x27; drama which turned out to be a non-issue after it was actually implemented).<p>Unrelated to Zig, it&#x27;s the exact same thing with &quot;WASM can&#x27;t access the DOM&quot; btw, comes up everytime when WASM is in the news, but is a complete non-issue in practice for anybody actually using WASM, and I&#x27;m sure each popular software project has at least one such &#x27;drama issues&#x27;.<p>The &#x27;LLVM divorce&#x27; has been announced waaaay ahead (maybe years) of any actual steps to make that happen, for a language ecosystem that&#x27;s still unstable anyway, and with the promise that a solution will be in place before LLVM is actually kicked out.<p>Not sure what else could have been done better, and as other have said, this sort of decision making process is much preferable to a committee approach.</div><br/><div id="41110633" class="c"><input type="checkbox" id="c-41110633" checked=""/><div class="controls bullet"><span class="by">jeltz</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110137">parent</a><span>|</span><a href="#41110991">next</a><span>|</span><label class="collapse" for="c-41110633">[-]</label><label class="expand" for="c-41110633">[2 more]</label></div><br/><div class="children"><div class="content">The LLVM divorce has also gotten criticism since it first was announced and we have so far not seen any complete solution. Maybe we will land in one but if people did not voice their concerns there is no reason to think such a solution would be found.</div><br/><div id="41111012" class="c"><input type="checkbox" id="c-41111012" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110633">parent</a><span>|</span><a href="#41110991">next</a><span>|</span><label class="collapse" for="c-41111012">[-]</label><label class="expand" for="c-41111012">[1 more]</label></div><br/><div class="children"><div class="content">What is there to criticize though?  What &quot;solution&quot; is necessary?<p>LLVM is not and was never going away as a compiler backend, it will just not be the default one and you will be able to compile zig without it (though in practice everyone will for prod releases)</div><br/></div></div></div></div><div id="41110991" class="c"><input type="checkbox" id="c-41110991" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110137">parent</a><span>|</span><a href="#41110633">prev</a><span>|</span><a href="#41110737">next</a><span>|</span><label class="collapse" for="c-41110991">[-]</label><label class="expand" for="c-41110991">[1 more]</label></div><br/><div class="children"><div class="content">You have to admit that &quot;divorce&quot; was not really a good metaphor, though it did get eyes on the drama.</div><br/></div></div><div id="41110737" class="c"><input type="checkbox" id="c-41110737" checked=""/><div class="controls bullet"><span class="by">kasajian</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110137">parent</a><span>|</span><a href="#41110991">prev</a><span>|</span><a href="#41112307">next</a><span>|</span><label class="collapse" for="c-41110737">[-]</label><label class="expand" for="c-41110737">[1 more]</label></div><br/><div class="children"><div class="content">The fact that WASM requires a JS is a marketing fail and misses what could have been a marketing opportunity to make the claim, &quot;finally an alternative to JavaScript&quot;.<p>In this case, this is not a non-issue.  If you look at the original github issue, it does a lot of damage, followed by a lot of confusion, followed by a damage-control post that shouldn&#x27;t have been required if it the original issue was written with more care.   It wasn&#x27;t, because the marketing aspect of Zig was not the focus -- the technical issue was.   So it blew up.  Hopefully it&#x27;ll be a lesson learned, but I suspect it isn&#x27;t.  It will take 20 more of such incidents before it sinks in.<p>As far as it was &quot;announced years ago&quot;, I don&#x27;t see how that matters.  The people who are seeing the issue now, and this discussion weren&#x27;t there to see the announcement years ago.<p>But I do understand what you&#x27;re saying.   You&#x27;re point is that the onus is on the the reader to the do their research before overreacting.   That&#x27;s a perfectly fine position.   I have a counter opinion which is that the person making the statement &#x2F; claim &#x2F; annoucement, simply be understanding of the implication of their statements.<p>This thing blowing up should not have been a surprise to anyone.  Sounds like it would have been to you, so the fact that it blew up is evidence that you would have misjudged.   Unless you also agree that the initial message should could have been better worded, in which case, what exactly are you disagreeing with?</div><br/></div></div></div></div><div id="41112307" class="c"><input type="checkbox" id="c-41112307" checked=""/><div class="controls bullet"><span class="by">pharrington</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109866">parent</a><span>|</span><a href="#41110137">prev</a><span>|</span><a href="#41110037">next</a><span>|</span><label class="collapse" for="c-41112307">[-]</label><label class="expand" for="c-41112307">[1 more]</label></div><br/><div class="children"><div class="content">Zig&#x27;s not at version 1.0.0 yet. Yes, it would be very irresponsible to use current-day Zig in a widely-deployed Enterprise setting. The release notes explicitly acknowledge Zig is currently immature, and is currently only suited to people willing to participate in the language development process.</div><br/></div></div><div id="41110037" class="c"><input type="checkbox" id="c-41110037" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109866">parent</a><span>|</span><a href="#41112307">prev</a><span>|</span><a href="#41107792">next</a><span>|</span><label class="collapse" for="c-41110037">[-]</label><label class="expand" for="c-41110037">[1 more]</label></div><br/><div class="children"><div class="content">Wait what is controversial here?  Removing llvm as a dependency and making it a (probably default available) plugin instead?  Seems &quot;obviously good&quot;, if you ask me.<p>Weird machinations around projects that are and aren&#x27;t (but are privileged because he&#x27;s the creator) part of the zig foundation would be more concerning, quite frankly.</div><br/></div></div></div></div></div></div><div id="41107792" class="c"><input type="checkbox" id="c-41107792" checked=""/><div class="controls bullet"><span class="by">brabel</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107716">prev</a><span>|</span><a href="#41107605">next</a><span>|</span><label class="collapse" for="c-41107792">[-]</label><label class="expand" for="c-41107792">[3 more]</label></div><br/><div class="children"><div class="content">&gt; as someone who loves C and dislikes almost every implementation of C interop and FFI I’ve used in other languages (Rust is a notable exception to this),<p>Have you tried D? It can import C files as if they were D modules: <a href="https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;importc.html" rel="nofollow">https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;importc.html</a><p>Basically, if there&#x27;s a `hello.c` file next to your D file, you simply import it with:<p><pre><code>    import hello
</code></pre>
And use the functions it provides. You can also import only a subset of it, of course:<p><pre><code>    import hello: square;
</code></pre>
Or rename the import:<p><pre><code>    import hi = hello;

</code></pre>
The C stdlib is exposed by D&#x27;s stdlib as if it were a D library: <a href="https:&#x2F;&#x2F;dlang.org&#x2F;phobos&#x2F;core_stdc_assert_.html" rel="nofollow">https:&#x2F;&#x2F;dlang.org&#x2F;phobos&#x2F;core_stdc_assert_.html</a><p>C libraries (header files) can be compiled to D and then used as D modules as well, see <a href="https:&#x2F;&#x2F;github.com&#x2F;jacob-carlborg&#x2F;dstep">https:&#x2F;&#x2F;github.com&#x2F;jacob-carlborg&#x2F;dstep</a><p>Is that as good as Rust?</div><br/><div id="41107843" class="c"><input type="checkbox" id="c-41107843" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107792">parent</a><span>|</span><a href="#41107605">next</a><span>|</span><label class="collapse" for="c-41107843">[-]</label><label class="expand" for="c-41107843">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Have you tried D?<p>I tried D years ago (at least 5 years ago, I think), but I don’t remember experimenting with the C interop.<p>Your explanation sounds intriguing though. And a couple pretty smart folks I respect have talked about D too. So thanks for bringing it up. I’m going to make some time to experiment with it again some time soon.<p>&gt; Is that as good as Rust?<p>Franky, although I don’t have firsthand experience with D, your explanation and example make the D C interop experience sound actually better than Rust’s. It seems more similar to Zig.</div><br/><div id="41107931" class="c"><input type="checkbox" id="c-41107931" checked=""/><div class="controls bullet"><span class="by">brabel</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107843">parent</a><span>|</span><a href="#41107605">next</a><span>|</span><label class="collapse" for="c-41107931">[-]</label><label class="expand" for="c-41107931">[1 more]</label></div><br/><div class="children"><div class="content">I think the feature that allows importing c, called &quot;importC&quot;, is newer than 5 years.
I think they may have &quot;copied&quot; it from Zig :D they definitely are trying to not &quot;fall behind&quot; Zig and keep making the language better.
With DMD, you can cross compile just as with Zig, but only to object files as the linker is not multi-platform... so I am experimenting with using Zig&#x27;s linker to &quot;finish&quot; the job. Unfortunately, Zig is not being able to link Phobos, the D stdlib, for reasons I don&#x27;t understand yet.</div><br/></div></div></div></div></div></div><div id="41107605" class="c"><input type="checkbox" id="c-41107605" checked=""/><div class="controls bullet"><span class="by">jll29</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107792">prev</a><span>|</span><a href="#41107591">next</a><span>|</span><label class="collapse" for="c-41107605">[-]</label><label class="expand" for="c-41107605">[14 more]</label></div><br/><div class="children"><div class="content">This sounds amazing, and it&#x27;s great that tooling is so strong of some &quot;new kids on the block&quot; (Zig, Rust), even better than C.<p>With hindsight, it is strange that the C community, with all the people and money behind it (and what scale!) never even managed to build a proper packaging manager (okay, there&#x27;s now Conan, but that came from Python guys).<p>But then, there even still isn&#x27;t a perfect C string library around (something that would combine GLib, SDS, ICU, say, and then standardize it in C2038).<p>[1] Hanson&#x27;s C: Interfaces &amp; Implementations (CII) - Str: <a href="https:&#x2F;&#x2F;cii.s3.amazonaws.com&#x2F;book&#x2F;pdf&#x2F;quickref.pdf" rel="nofollow">https:&#x2F;&#x2F;cii.s3.amazonaws.com&#x2F;book&#x2F;pdf&#x2F;quickref.pdf</a><p>[2] ICU - <a href="https:&#x2F;&#x2F;icu.unicode.org" rel="nofollow">https:&#x2F;&#x2F;icu.unicode.org</a><p>[3] SDS - <a href="https:&#x2F;&#x2F;github.com&#x2F;antirez&#x2F;sds">https:&#x2F;&#x2F;github.com&#x2F;antirez&#x2F;sds</a><p>[4] GLib - <a href="https:&#x2F;&#x2F;docs.gtk.org&#x2F;glib&#x2F;struct.String.html" rel="nofollow">https:&#x2F;&#x2F;docs.gtk.org&#x2F;glib&#x2F;struct.String.html</a></div><br/><div id="41112718" class="c"><input type="checkbox" id="c-41112718" checked=""/><div class="controls bullet"><span class="by">uecker</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107605">parent</a><span>|</span><a href="#41108921">next</a><span>|</span><label class="collapse" for="c-41112718">[-]</label><label class="expand" for="c-41112718">[1 more]</label></div><br/><div class="children"><div class="content">In the unix world we use distribution package managers.  This has many advantages, including security updates, some robustness against supply chain attacks, large-scale integration.  All this language-level packaging systems are a mistake in my opinion.</div><br/></div></div><div id="41108921" class="c"><input type="checkbox" id="c-41108921" checked=""/><div class="controls bullet"><span class="by">bluGill</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107605">parent</a><span>|</span><a href="#41112718">prev</a><span>|</span><a href="#41107645">next</a><span>|</span><label class="collapse" for="c-41108921">[-]</label><label class="expand" for="c-41108921">[7 more]</label></div><br/><div class="children"><div class="content">&gt; With hindsight, it is strange that the C community, with all the people and money behind it (and what scale!) never even managed to build a proper packaging manager (okay, there&#x27;s now Conan, but that came from Python guys).<p>Package managers are a lot more complex than people realize.  Every attempt I&#x27;ve seen in every language has significant lacks for common real world cases.<p>Most commonly they assume all the world is their language. Very commonly they want to take over all package management but don&#x27;t have a good easy story for working with the OS package manager (I know Windows doesn&#x27;t really have a package manager - but you still need to interoperate with it!). Those are big issues anyone in a complex project will face in the real world, there are also lots of little warts that will bite you.<p>Yes package managers are nice on your trival project. However they all get in the way in your non-complex project - some more than others.</div><br/><div id="41109697" class="c"><input type="checkbox" id="c-41109697" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41108921">parent</a><span>|</span><a href="#41109328">next</a><span>|</span><label class="collapse" for="c-41109697">[-]</label><label class="expand" for="c-41109697">[3 more]</label></div><br/><div class="children"><div class="content">Why would anyone want to integrate with the OS package manager? Windows, as you&#x27;ve said yourself, doesn&#x27;t even have one (and thank goodness for that) while on Linux, the distributed packages are normally about 2 to 4 years out of date — unless you discover and use specific 3rd-party repositories at which point what&#x27;s even the point then? Just use the language&#x27;s CPAN&#x2F;PyPI&#x2F;Hex&#x2F;Crates.io&#x2F;etc. analogue.</div><br/><div id="41109767" class="c"><input type="checkbox" id="c-41109767" checked=""/><div class="controls bullet"><span class="by">bluGill</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109697">parent</a><span>|</span><a href="#41115310">next</a><span>|</span><label class="collapse" for="c-41109767">[-]</label><label class="expand" for="c-41109767">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why would anyone want to integrate with the OS package manage<p>Because if they don&#x27;t integrate you end up with several different versions of the same package installed. When you program grabs the wrong version how do you fix it.  Now what if you are in support trying to help a customer.<p>&gt; on Linux, the distributed packages are normally about 2 to 4 years out of date<p>Maybe you need to find a different distribution. Some make it a point to be out of date. Some make it a point to be up to date.</div><br/></div></div><div id="41115310" class="c"><input type="checkbox" id="c-41115310" checked=""/><div class="controls bullet"><span class="by">kitkat_new</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109697">parent</a><span>|</span><a href="#41109767">prev</a><span>|</span><a href="#41109328">next</a><span>|</span><label class="collapse" for="c-41115310">[-]</label><label class="expand" for="c-41115310">[1 more]</label></div><br/><div class="children"><div class="content">Windows has winget</div><br/></div></div></div></div><div id="41109328" class="c"><input type="checkbox" id="c-41109328" checked=""/><div class="controls bullet"><span class="by">greenavocado</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41108921">parent</a><span>|</span><a href="#41109697">prev</a><span>|</span><a href="#41107645">next</a><span>|</span><label class="collapse" for="c-41109328">[-]</label><label class="expand" for="c-41109328">[3 more]</label></div><br/><div class="children"><div class="content">Weird take. Does pip have to interface with the Windows or iOS package managers? No. Yet it&#x27;s wildly successful.</div><br/><div id="41109814" class="c"><input type="checkbox" id="c-41109814" checked=""/><div class="controls bullet"><span class="by">jordanozang</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109328">parent</a><span>|</span><a href="#41109725">next</a><span>|</span><label class="collapse" for="c-41109814">[-]</label><label class="expand" for="c-41109814">[1 more]</label></div><br/><div class="children"><div class="content">If you use pip without protection, it will gladly and malevolently mess up your system. Every Python user learns quickly about the virtual environment work around. Various distributions (e.g. through Homebrew on Os X, Arch Linux, Ubuntu Linux) ship pip without the ability to make system-wide installations (externally-managed-environment). Even on Windows, where there is no standardized package management system, doing a pip install will place a bunch of dlls in the system&#x27;s PATH that could get in the way of any program on your system.<p>The anti-solution of ignoring the problem is what got us here.</div><br/></div></div><div id="41109725" class="c"><input type="checkbox" id="c-41109725" checked=""/><div class="controls bullet"><span class="by">bluGill</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109328">parent</a><span>|</span><a href="#41109814">prev</a><span>|</span><a href="#41107645">next</a><span>|</span><label class="collapse" for="c-41109725">[-]</label><label class="expand" for="c-41109725">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Does pip have to interface with the Windows or iOS package managers? No. Yet it&#x27;s wildly successful.<p>Successful I agree. I have issues on any system I use it on because now I have the package installed by PIP and the package installed by my OS package manager - slightly different.</div><br/></div></div></div></div></div></div><div id="41107645" class="c"><input type="checkbox" id="c-41107645" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107605">parent</a><span>|</span><a href="#41108921">prev</a><span>|</span><a href="#41107735">next</a><span>|</span><label class="collapse" for="c-41107645">[-]</label><label class="expand" for="c-41107645">[3 more]</label></div><br/><div class="children"><div class="content">The interesting thing is that the Zig build system <i>could</i> be implemented in a C&#x2F;C++ compiler without any language changes. All that&#x27;s needed is that (for instance) Clang would have a new option `clang build` which looks for a build.c&#x2F;cpp file, compiles that into an executable and runs it.<p>The actual build system functionality is &#x27;just&#x27; an extension to the stdlib.</div><br/><div id="41109526" class="c"><input type="checkbox" id="c-41109526" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107645">parent</a><span>|</span><a href="#41107735">next</a><span>|</span><label class="collapse" for="c-41109526">[-]</label><label class="expand" for="c-41109526">[2 more]</label></div><br/><div class="children"><div class="content">It could, but then it would be tied to that specific compiler and the platforms it supports.<p>So is the mess of ISO defined languages, where compiler toolchains are an abstract concept.<p>Also a good point to note that OpenGroup and POSIX never bothered to standardise UNIX package management.</div><br/><div id="41110262" class="c"><input type="checkbox" id="c-41110262" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109526">parent</a><span>|</span><a href="#41107735">next</a><span>|</span><label class="collapse" for="c-41110262">[-]</label><label class="expand" for="c-41110262">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, just Clang doing its own thing would be useless. It would have to go through the C and C++ committees, at least for the stdlib parts (and this is basically the show stopper for the idea unfortunately).</div><br/></div></div></div></div></div></div><div id="41107735" class="c"><input type="checkbox" id="c-41107735" checked=""/><div class="controls bullet"><span class="by">fxtentacle</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107605">parent</a><span>|</span><a href="#41107645">prev</a><span>|</span><a href="#41107591">next</a><span>|</span><label class="collapse" for="c-41107735">[-]</label><label class="expand" for="c-41107735">[2 more]</label></div><br/><div class="children"><div class="content">vcpkg + CMake ?<p>It can compile almost any dependency on demand, even doing cross-compilation. And it&#x27;s used by at least Microsoft and Google.</div><br/><div id="41107786" class="c"><input type="checkbox" id="c-41107786" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107735">parent</a><span>|</span><a href="#41107591">next</a><span>|</span><label class="collapse" for="c-41107786">[-]</label><label class="expand" for="c-41107786">[1 more]</label></div><br/><div class="children"><div class="content">Such a setup includes two complex tools from two different parties plus a different C&#x2F;C++ compiler toolchain per platform and platform SDKs (at least GCC, Clang (plus its Apple flavour) and MSVC). All those tools working together flawlessly at any given time is a minor miracle.<p>In Zig all those things are in the same toolchain install, which is a a single executable plus a bunch of platform-system-headers and -libraries, all under a single version number and trivially downloadable as a zip archive which works right after unzipping without setting up paths or running an &#x27;installer&#x27;.</div><br/></div></div></div></div></div></div><div id="41107591" class="c"><input type="checkbox" id="c-41107591" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107605">prev</a><span>|</span><a href="#41107582">next</a><span>|</span><label class="collapse" for="c-41107591">[-]</label><label class="expand" for="c-41107591">[7 more]</label></div><br/><div class="children"><div class="content">How I see is that the only thing that changes is that you can&#x27;t do @importC anymore. You&#x27;ll instead do something in build.zig that produces a module which you can then addImport(&quot;my-c-lib&quot;, generated_module); which you then @import(&quot;my-c-lib&quot;); in your zig code as you would with @cImport.<p>This does not seem bad in paper. One thing that does worsen with this is that in @cImport you could also comptime define preprocessor macros which was really cool, now that would have to be handled by build.zig I guess.</div><br/><div id="41108081" class="c"><input type="checkbox" id="c-41108081" checked=""/><div class="controls bullet"><span class="by">jeltz</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107591">parent</a><span>|</span><a href="#41107626">next</a><span>|</span><label class="collapse" for="c-41108081">[-]</label><label class="expand" for="c-41108081">[1 more]</label></div><br/><div class="children"><div class="content">Having worked with Rust I would say that is bad. @cImport is way better than the C introp in Rust.</div><br/></div></div><div id="41107626" class="c"><input type="checkbox" id="c-41107626" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107591">parent</a><span>|</span><a href="#41108081">prev</a><span>|</span><a href="#41109428">next</a><span>|</span><label class="collapse" for="c-41107626">[-]</label><label class="expand" for="c-41107626">[4 more]</label></div><br/><div class="children"><div class="content">This makes the experience more similar to Rust (which I don’t think is bad—it’s just not as unique, smooth, and impressive as the current Zig experience).<p>I’ve been able to convince C programmers to try out and use Zig just due to this unique ability alone, and to be clear, getting C programmers to seriously consider any language other than C is generally very difficult!<p>Having to consider another build system (with its own semantics), which the current Zig experience doesn’t require, changes the experience much more substantially than I think the Zig team realizes.</div><br/><div id="41107666" class="c"><input type="checkbox" id="c-41107666" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107626">parent</a><span>|</span><a href="#41109428">next</a><span>|</span><label class="collapse" for="c-41107666">[-]</label><label class="expand" for="c-41107666">[3 more]</label></div><br/><div class="children"><div class="content">&gt; This makes the experience more similar to Rust<p>The big difference to the Rust ecosystem (or rather the &#x27;cc&#x27; crates.io package which AFAIK is the current standard solution) is that there will be a Clang toolchain package with integrated cross-compilation headers and libraries that is used across all platforms instead of relying on a &quot;platform C&#x2F;C++ compiler toolchain&quot; - which is the actually brittle part: different compilers, linkers and platform SDKs used on different platforms).<p>Ideally that same integrated Clang toolchain package used and provided by Zig could also be used by Rust to improve the C&#x2F;C++&#x2F;ObjC cross-compilation situation (similar to how the Zig toolchain is sometimes already used for this purpose).</div><br/><div id="41110185" class="c"><input type="checkbox" id="c-41110185" checked=""/><div class="controls bullet"><span class="by">steveklabnik</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107666">parent</a><span>|</span><a href="#41107680">next</a><span>|</span><label class="collapse" for="c-41110185">[-]</label><label class="expand" for="c-41110185">[1 more]</label></div><br/><div class="children"><div class="content">I truly wish that Rust would steal this from Zig, but I haven&#x27;t heard any actual interest in it from the project. Oh well. I think it&#x27;s a real missed opportunity.<p><a href="https:&#x2F;&#x2F;crates.io&#x2F;crates&#x2F;cargo-zigbuild" rel="nofollow">https:&#x2F;&#x2F;crates.io&#x2F;crates&#x2F;cargo-zigbuild</a> exists though.</div><br/></div></div><div id="41107680" class="c"><input type="checkbox" id="c-41107680" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107666">parent</a><span>|</span><a href="#41110185">prev</a><span>|</span><a href="#41109428">next</a><span>|</span><label class="collapse" for="c-41107680">[-]</label><label class="expand" for="c-41107680">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The big difference to the Rust ecosystem (or rather the &#x27;cc&#x27; crates.io package which AFAIK is the current standard solution) is that there will be a Clang toolchain package with integrated cross-compilation headers and libraries that is used across all platforms instead of relying on a &quot;platform C&#x2F;C++ compiler toolchain&quot; - which is the actually brittle part: different compilers, linkers and platform SDKs used on different platforms).<p>Yes, this is a very good point. Zig remains unique and impressive in that sense. The fact that Zig compiles the correct libc and other system libraries on demand is actually another one of those, “How come no other language considered doing this before Zig?!?”</div><br/></div></div></div></div></div></div><div id="41109428" class="c"><input type="checkbox" id="c-41109428" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107591">parent</a><span>|</span><a href="#41107626">prev</a><span>|</span><a href="#41107582">next</a><span>|</span><label class="collapse" for="c-41109428">[-]</label><label class="expand" for="c-41109428">[1 more]</label></div><br/><div class="children"><div class="content">You will probably be able to do it from the command line too (for build-exe, run, etc).</div><br/></div></div></div></div><div id="41107582" class="c"><input type="checkbox" id="c-41107582" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107591">prev</a><span>|</span><a href="#41109149">next</a><span>|</span><label class="collapse" for="c-41107582">[-]</label><label class="expand" for="c-41107582">[1 more]</label></div><br/><div class="children"><div class="content">The translate-c build system step and wrapping the output in a Zig module is currently about 10 lines in build.zig, and I guess this could be reduced further by merging those two steps into a single step.<p>I think that&#x27;s an acceptable compromise.<p>Especially for C libraries which require configuration via preprocessor defines or compilation flags, the build.zig way is a lot cleaner than the @-builtins that are currently used (IMHO).</div><br/></div></div><div id="41109149" class="c"><input type="checkbox" id="c-41109149" checked=""/><div class="controls bullet"><span class="by">1980phipsi</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41107582">prev</a><span>|</span><a href="#41109379">next</a><span>|</span><label class="collapse" for="c-41109149">[-]</label><label class="expand" for="c-41109149">[1 more]</label></div><br/><div class="children"><div class="content">D has made some improvements on C interop with importC, if you want to check that out: <a href="https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;importc.html" rel="nofollow">https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;importc.html</a></div><br/></div></div><div id="41109379" class="c"><input type="checkbox" id="c-41109379" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41107515">parent</a><span>|</span><a href="#41109149">prev</a><span>|</span><a href="#41111594">next</a><span>|</span><label class="collapse" for="c-41109379">[-]</label><label class="expand" for="c-41109379">[9 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the problem?  @cImport is becoming just @import.</div><br/><div id="41110259" class="c"><input type="checkbox" id="c-41110259" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109379">parent</a><span>|</span><a href="#41111445">next</a><span>|</span><label class="collapse" for="c-41110259">[-]</label><label class="expand" for="c-41110259">[6 more]</label></div><br/><div class="children"><div class="content">@cImport works without build.zig and even with build.zig requires no special configuration (ignoring linking).<p>As it is currently described, @import of C will require build.zig and specific configuration therein.</div><br/><div id="41114359" class="c"><input type="checkbox" id="c-41114359" checked=""/><div class="controls bullet"><span class="by">mk12</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110259">parent</a><span>|</span><a href="#41110936">next</a><span>|</span><label class="collapse" for="c-41114359">[-]</label><label class="expand" for="c-41114359">[1 more]</label></div><br/><div class="children"><div class="content">It won&#x27;t require build.zig, you&#x27;ll just have to run zig translate-c on the C file. Andrew&#x27;s comment here[1] says that @cImport is basically @import + the compiler implicitly running translate-c for you. There was some discussion of removing the translate-c subcommand as well (which <i>would</i> force you to use build.zig), but I don&#x27;t think it&#x27;s been decided to do that.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630#issuecomment-2259213229">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20630#issuecomment-225...</a></div><br/></div></div><div id="41110936" class="c"><input type="checkbox" id="c-41110936" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110259">parent</a><span>|</span><a href="#41114359">prev</a><span>|</span><a href="#41110656">next</a><span>|</span><label class="collapse" for="c-41110936">[-]</label><label class="expand" for="c-41110936">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think that&#x27;s the case.  In general you can set up @import modules from the command line, and I&#x27;m not 100% sure but I think build.zig generally just templates a command line call anyways.</div><br/><div id="41111251" class="c"><input type="checkbox" id="c-41111251" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110936">parent</a><span>|</span><a href="#41110656">next</a><span>|</span><label class="collapse" for="c-41111251">[-]</label><label class="expand" for="c-41111251">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think this DSL is finalized yet, but you can see on a linked issue what the build.zig to support @import of C looks like on nightly:<p><pre><code>    const translate_c = b.addTranslateC(.{
        .root_source_file = b.path(&quot;src&#x2F;c.h&quot;),
        .target = target,
        .optimize = optimize,
    });
    exe.root_module.addImport(&quot;c&quot;, translate_c.createModule());
</code></pre>
<a href="https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20648">https:&#x2F;&#x2F;github.com&#x2F;ziglang&#x2F;zig&#x2F;issues&#x2F;20648</a></div><br/></div></div></div></div><div id="41110656" class="c"><input type="checkbox" id="c-41110656" checked=""/><div class="controls bullet"><span class="by">jeltz</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110259">parent</a><span>|</span><a href="#41110936">prev</a><span>|</span><a href="#41110676">next</a><span>|</span><label class="collapse" for="c-41110656">[-]</label><label class="expand" for="c-41110656">[1 more]</label></div><br/><div class="children"><div class="content">And form my experience from Rust that is much less ergonomic. Maybe Zig will do it better than Rust but who knows?</div><br/></div></div><div id="41110676" class="c"><input type="checkbox" id="c-41110676" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41110259">parent</a><span>|</span><a href="#41110656">prev</a><span>|</span><a href="#41111445">next</a><span>|</span><label class="collapse" for="c-41110676">[-]</label><label class="expand" for="c-41110676">[1 more]</label></div><br/><div class="children"><div class="content">build.zig is on its way to being essential.<p>I consider that an appropriate development. Binaries need to be built, this should be integrated with the rest of the system in any modern language.<p>It&#x27;s not incompatible with using something like CMake or Ninja either, it just puts certain responsibilities inside of build.zig. Where they belong.</div><br/></div></div></div></div><div id="41111445" class="c"><input type="checkbox" id="c-41111445" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41109379">parent</a><span>|</span><a href="#41110259">prev</a><span>|</span><a href="#41111594">next</a><span>|</span><label class="collapse" for="c-41111445">[-]</label><label class="expand" for="c-41111445">[2 more]</label></div><br/><div class="children"><div class="content">&gt; What&#x27;s the problem? @cImport is becoming just @import.<p>You’re oversimplifying what’s actually a significant change.<p>Right now, I can do the following:<p>1. Download a prebuilt Zig release [0], on a fresh computer (zero prerequisites).<p>2. Implement a C library foo via foo.h and foo.c.<p>3. Compile foo.c into an object file foo.o via `zig cc`, using standard GNU-compatible compiler flags, for virtually any of the common (and even not-so-common) compilation targets.<p>4. Implement a Zig program bar via bar.zig.<p>5. Directly import foo.h into bar.zig via `@cImport` and use the C API as if it was Zig code.<p>6. Compile bar.zig and foo.o into a statically-linked executable baz via `zig build-exe`, for virtually any of the common (and even not-so-common) compilation targets.<p>No knowledge of the Zig build system and its semantics necessary. This is one of the most attractive aspects of Zig for a C programmer. I’ve gone through these exact steps with C programmers who thought Zig seemed interesting in theory but just didn’t want to have to learn a new ecosystem, build system, etc. The moment I showed them how quickly they could get up and running with Zig (and test it out with C code), without even having to install anything, it suddenly was impressive enough to experiment with.<p>The build system requirement may seem minor if you’re already a Zig programmer, but it’s massive if you want to attract C systems programmers.<p>[0]: <a href="https:&#x2F;&#x2F;ziglang.org&#x2F;download" rel="nofollow">https:&#x2F;&#x2F;ziglang.org&#x2F;download</a></div><br/><div id="41111542" class="c"><input type="checkbox" id="c-41111542" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41107260">root</a><span>|</span><a href="#41111445">parent</a><span>|</span><a href="#41111594">next</a><span>|</span><label class="collapse" for="c-41111542">[-]</label><label class="expand" for="c-41111542">[1 more]</label></div><br/><div class="children"><div class="content">I think someone who doesn&#x27;t know what they are talking about about is asserting a build.zig requirement.  I don&#x27;t know for sure, but probably it will work with the command line?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41111594" class="c"><input type="checkbox" id="c-41111594" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#41107260">prev</a><span>|</span><a href="#41107361">next</a><span>|</span><label class="collapse" for="c-41111594">[-]</label><label class="expand" for="c-41111594">[5 more]</label></div><br/><div class="children"><div class="content">Example from the article:<p><pre><code>    const win32 = @cImport({
        @cInclude(&quot;windows.h&quot;);
        @cInclude(&quot;winuser.h&quot;);
    });

    pub fn main() !void {
        _ = win32.MessageBoxA(null, &quot;world!&quot;, &quot;Hello&quot;, 0);
    }
</code></pre>
Equivalent D:<p><pre><code>    import windows, winuser;
    void main() {
        MessageBoxA(null, &quot;world!&quot;, &quot;Hello&quot;, 0);
    }
</code></pre>
In essence pared it down to the essentials. The compiler figures out the rest.<p>Sometimes people ask for a special syntax for importing C files, but I like this simplicity so much better.</div><br/><div id="41111671" class="c"><input type="checkbox" id="c-41111671" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41111594">parent</a><span>|</span><a href="#41107361">next</a><span>|</span><label class="collapse" for="c-41111671">[-]</label><label class="expand" for="c-41111671">[4 more]</label></div><br/><div class="children"><div class="content">Some of us like explicit invocations, not being unsure if something comes from a .h filenor some other importing mechanism (what if a .h file collides with another import mechanism)<p>Naked imports are also annoying.  Which import did that MessageBoxA come from?  windows? or winuser?  Is it in the language kernel?<p>Explicit is better than implicit.  The utter pain for the code writer of four or five keystrokes here and there is not worth confounding the code reader.</div><br/><div id="41111774" class="c"><input type="checkbox" id="c-41111774" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#41111594">root</a><span>|</span><a href="#41111671">parent</a><span>|</span><a href="#41107361">next</a><span>|</span><label class="collapse" for="c-41111774">[-]</label><label class="expand" for="c-41111774">[3 more]</label></div><br/><div class="children"><div class="content">Imports are found along the search path (just like .h files are searched for by the C preprocessor). The first one found it the one selected (just like the C preprocessor does).<p>&gt; Which import did that MessageBoxA come from?<p>If it exists in two or more imports, the compiler will give an ambiguity error. To resolve the ambiguity error, qualify the call with the name of the import:<p><pre><code>    windows.MessageBoxA(null, &quot;world!&quot;, &quot;Hello&quot;, 0);
</code></pre>
or, one can do this:<p><pre><code>    import windows : MessageBoxA;
</code></pre>
or this:<p><pre><code>    import windows, winuser;
    alias MessageBoxA = windows.MessageBoxA;
</code></pre>
You can be as explicit as you like, and don&#x27;t need to worry about ambiguity because the compiler will issue an error for that. It works the same way for D imports.</div><br/><div id="41111980" class="c"><input type="checkbox" id="c-41111980" checked=""/><div class="controls bullet"><span class="by">throwawaymaths</span><span>|</span><a href="#41111594">root</a><span>|</span><a href="#41111774">parent</a><span>|</span><a href="#41107361">next</a><span>|</span><label class="collapse" for="c-41111980">[-]</label><label class="expand" for="c-41111980">[2 more]</label></div><br/><div class="children"><div class="content">Compiler giving a compiler error still favors the writer, not the reader of code.  It seems like in its design in general D favors the writer of code with all its complicated bells and whistles that one must keep in mind as a reader.  I think decades of experience has shown us that it is way better to favor the reader.</div><br/><div id="41113034" class="c"><input type="checkbox" id="c-41113034" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#41111594">root</a><span>|</span><a href="#41111980">parent</a><span>|</span><a href="#41107361">next</a><span>|</span><label class="collapse" for="c-41113034">[-]</label><label class="expand" for="c-41113034">[1 more]</label></div><br/><div class="children"><div class="content">You can do it either way in D. It&#x27;s nice to have a choice! I use both methods, depending on the context.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41107361" class="c"><input type="checkbox" id="c-41107361" checked=""/><div class="controls bullet"><span class="by">voidUpdate</span><span>|</span><a href="#41111594">prev</a><span>|</span><a href="#41107337">next</a><span>|</span><label class="collapse" for="c-41107361">[-]</label><label class="expand" for="c-41107361">[21 more]</label></div><br/><div class="children"><div class="content">I really want to like zig, but I&#x27;ve just had some annoying problems with it, most of which I think are just a result of it not being in 1.0 yet. For example, the recommended way to start a project, with `zig init`, has a load of code that I really don&#x27;t need when I just want a bare project to get started. I only recently found out that you can just `zig build-exe filename.zig` and skip the whole init part. Also I&#x27;ve had a lot of issues getting editor integration to work correctly. I&#x27;ve installed the VSCode extension but I don&#x27;t seem to be getting autocomplete etc. It is quite possibly just an ID-10T problem though, so I&#x27;ll probably take another look at it some weekend</div><br/><div id="41108577" class="c"><input type="checkbox" id="c-41108577" checked=""/><div class="controls bullet"><span class="by">dgb23</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41107439">next</a><span>|</span><label class="collapse" for="c-41108577">[-]</label><label class="expand" for="c-41108577">[3 more]</label></div><br/><div class="children"><div class="content">&gt; For example, the recommended way to start a project, with `zig init`, has a load of code that I really don&#x27;t need when I just want a bare project to get started.<p>I recently started a new project. zig-init provides you with a working build.zig file and two very minimal project files under &#x2F;src, one of which is a hello world binary and the other is a hello world library.<p>&gt; Also I&#x27;ve had a lot of issues getting editor integration to work correctly.<p>ZLS is not at the same level of what you would expect from a more mature language. For example by default it will not help you with anything related to comptime.<p>I highly recommend reading this fairly recent blog post by Loris Cro:<p><a href="https:&#x2F;&#x2F;kristoff.it&#x2F;blog&#x2F;improving-your-zls-experience&#x2F;" rel="nofollow">https:&#x2F;&#x2F;kristoff.it&#x2F;blog&#x2F;improving-your-zls-experience&#x2F;</a><p>It explains how you set up your build.zig and ZLS (a few lines of configuration) in order to get much more help from ZLS. It will then perform the equivalent of what `cargo check` (Rust) does.</div><br/><div id="41109151" class="c"><input type="checkbox" id="c-41109151" checked=""/><div class="controls bullet"><span class="by">voidUpdate</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41108577">parent</a><span>|</span><a href="#41107439">next</a><span>|</span><label class="collapse" for="c-41109151">[-]</label><label class="expand" for="c-41109151">[2 more]</label></div><br/><div class="children"><div class="content">Really? I get a main.zig file with a hello world as well as some maths, and a build.zig that has stuff that I can&#x27;t work out how to correctly get rid of. I&#x27;m not currently at that workstation so I can&#x27;t give specifics though. I feel it would be easier if it was literally just a hello world print and the build literally just built it, rather than doing tests on code I already know works, because it shipped with the language</div><br/><div id="41113838" class="c"><input type="checkbox" id="c-41113838" checked=""/><div class="controls bullet"><span class="by">dgb23</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41109151">parent</a><span>|</span><a href="#41107439">next</a><span>|</span><label class="collapse" for="c-41113838">[-]</label><label class="expand" for="c-41113838">[1 more]</label></div><br/><div class="children"><div class="content">Yes, that&#x27;s what I meant. But I think I talked passed you in a way.<p>I think its fair criticism that as a beginner, you don&#x27;t actually want to deal with build.zig or even understand it. You just want to write some code and run it and look at build.zig after you gained some familiarity with the language itself.</div><br/></div></div></div></div></div></div><div id="41107439" class="c"><input type="checkbox" id="c-41107439" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41108577">prev</a><span>|</span><a href="#41107494">next</a><span>|</span><label class="collapse" for="c-41107439">[-]</label><label class="expand" for="c-41107439">[7 more]</label></div><br/><div class="children"><div class="content">Tbf, when coming from the C&#x2F;C++ ecosystem, these types of problems are &#x27;just another Tuesday&#x27; (especially for cross-platform projects and the official VSCode C&#x2F;C++ extension).</div><br/><div id="41107882" class="c"><input type="checkbox" id="c-41107882" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107439">parent</a><span>|</span><a href="#41109548">next</a><span>|</span><label class="collapse" for="c-41107882">[-]</label><label class="expand" for="c-41107882">[4 more]</label></div><br/><div class="children"><div class="content">This is part of the reason why I don&#x27;t use VSCode for C(++). Jetbrains Clion seems to be the best IDE for those languages, with Visual Studio (the full fat one, costing a grand, as the free version lacks a bunch of features) as a close second, depending on what platform you&#x27;re developing for.<p>VSCode is great when it works, but in cases like these it quickly becomes obvious that it&#x27;s a hodge-podge of tools glued together via extensions and command lines rather than a purpose-built IDE.</div><br/><div id="41109437" class="c"><input type="checkbox" id="c-41109437" checked=""/><div class="controls bullet"><span class="by">Quothling</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107882">parent</a><span>|</span><a href="#41108549">next</a><span>|</span><label class="collapse" for="c-41109437">[-]</label><label class="expand" for="c-41109437">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not one to defend VSC as such, but I do think it&#x27;s fair to mention that a lot of the Zig issues have been directly with the Zig LSP (zls) and not necessarily with any specific editor extension. Though I suppose some of it may be worse with VSC as it&#x27;s often been rather important to keep both your Zig and zls versions up-to-date and synchronized. I&#x27;m not sure how that happens with the VSC extension, but if it auto-updates your zls version (which it probably does) then it may race ahead of your Zig version which might cause problems.</div><br/></div></div><div id="41108549" class="c"><input type="checkbox" id="c-41108549" checked=""/><div class="controls bullet"><span class="by">markus_zhang</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107882">parent</a><span>|</span><a href="#41109437">prev</a><span>|</span><a href="#41109548">next</a><span>|</span><label class="collapse" for="c-41108549">[-]</label><label class="expand" for="c-41108549">[2 more]</label></div><br/><div class="children"><div class="content">I have never used Clion. Can you please share why you believe it is the top of the crop? I&#x27;m writing a C++&#x2F;SDL2 game engine in Visual Studio but I think the IDE is really slow and error prone even for a small project. Everything just runs so slow. Maybe I need a better machine though.</div><br/><div id="41116451" class="c"><input type="checkbox" id="c-41116451" checked=""/><div class="controls bullet"><span class="by">winrid</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41108549">parent</a><span>|</span><a href="#41109548">next</a><span>|</span><label class="collapse" for="c-41116451">[-]</label><label class="expand" for="c-41116451">[1 more]</label></div><br/><div class="children"><div class="content">CLion has a free trial you can try. I find it works really well. I use it on a 6yo laptop quite often for C++.</div><br/></div></div></div></div></div></div><div id="41109548" class="c"><input type="checkbox" id="c-41109548" checked=""/><div class="controls bullet"><span class="by">bobajeff</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107439">parent</a><span>|</span><a href="#41107882">prev</a><span>|</span><a href="#41107476">next</a><span>|</span><label class="collapse" for="c-41109548">[-]</label><label class="expand" for="c-41109548">[1 more]</label></div><br/><div class="children"><div class="content">Note for people wanting to use vscode for c or c++ development. The clangd extension* is provides much better code completion and jump to definition compared to the default c&#x2F;c++ extension.<p>* <a href="https:&#x2F;&#x2F;marketplace.visualstudio.com&#x2F;items?itemName=llvm-vs-code-extensions.vscode-clangd" rel="nofollow">https:&#x2F;&#x2F;marketplace.visualstudio.com&#x2F;items?itemName=llvm-vs-...</a></div><br/></div></div><div id="41107476" class="c"><input type="checkbox" id="c-41107476" checked=""/><div class="controls bullet"><span class="by">voidUpdate</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107439">parent</a><span>|</span><a href="#41109548">prev</a><span>|</span><a href="#41107494">next</a><span>|</span><label class="collapse" for="c-41107476">[-]</label><label class="expand" for="c-41107476">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that&#x27;s one of the reasons I dislike the C++ ecosystem so much and want to like Zig haha</div><br/></div></div></div></div><div id="41107494" class="c"><input type="checkbox" id="c-41107494" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41107439">prev</a><span>|</span><a href="#41107855">next</a><span>|</span><label class="collapse" for="c-41107494">[-]</label><label class="expand" for="c-41107494">[5 more]</label></div><br/><div class="children"><div class="content">zls should generally work out of the box but I don&#x27;t use vscode, so your mileage may vary. Make sure your zls and zig versions match. zig build-exe, zig run can be fine for small things, but when you want to start importing modules or do something more fancy, build.zig is nice to have.</div><br/><div id="41107563" class="c"><input type="checkbox" id="c-41107563" checked=""/><div class="controls bullet"><span class="by">voidUpdate</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107494">parent</a><span>|</span><a href="#41107855">next</a><span>|</span><label class="collapse" for="c-41107563">[-]</label><label class="expand" for="c-41107563">[4 more]</label></div><br/><div class="children"><div class="content">According to the extension, ZLS is optional, but according to some zig docs I found, its part of the extension. I may have misread, I&#x27;ll try this stuff again sometime</div><br/><div id="41107818" class="c"><input type="checkbox" id="c-41107818" checked=""/><div class="controls bullet"><span class="by">brabel</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107563">parent</a><span>|</span><a href="#41107855">next</a><span>|</span><label class="collapse" for="c-41107818">[-]</label><label class="expand" for="c-41107818">[3 more]</label></div><br/><div class="children"><div class="content">As with all VSCode language extensions, they will try to download and manage ZLS for you. That&#x27;s ok if it&#x27;s done well, but they probably have some ways to go still.<p>I just prefer using Zig on emacs with the built-in eglot LSP client. You just tell it where you installed ZLS (and it won&#x27;t do magic to get it for you) and off you go. It&#x27;s the same level of support as with VS Code. If you&#x27;re not new to emacs, maybe consider that (otherwise emacs may be too much of a rabbit hole :)).</div><br/><div id="41107875" class="c"><input type="checkbox" id="c-41107875" checked=""/><div class="controls bullet"><span class="by">voidUpdate</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107818">parent</a><span>|</span><a href="#41107855">next</a><span>|</span><label class="collapse" for="c-41107875">[-]</label><label class="expand" for="c-41107875">[2 more]</label></div><br/><div class="children"><div class="content">My terminal editor of choice is nano :P</div><br/><div id="41110017" class="c"><input type="checkbox" id="c-41110017" checked=""/><div class="controls bullet"><span class="by">MobiusHorizons</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107875">parent</a><span>|</span><a href="#41107855">next</a><span>|</span><label class="collapse" for="c-41110017">[-]</label><label class="expand" for="c-41110017">[1 more]</label></div><br/><div class="children"><div class="content">It sounds like you have two editors at least, vscode and nano. Based on this description, I would assume you use nano for commit messages, config file updates, and not much more. If that’s the case, you may want to at least check out what emacs or vim can do for you with some basic lsp integration. These would be replacements for vscode not nano, although once you get used to them, you might switch EDITOR over. Compared to the complexity of systems programming, vim or eMacs should be well within your grasp.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41107855" class="c"><input type="checkbox" id="c-41107855" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41107494">prev</a><span>|</span><a href="#41107808">next</a><span>|</span><label class="collapse" for="c-41107855">[-]</label><label class="expand" for="c-41107855">[2 more]</label></div><br/><div class="children"><div class="content">I have the same issue. It&#x27;s hard to say if the tooling is working but incomplete, or if the tooling doesn&#x27;t work for some reason. I can get syntax highlighting to work, but basic variable autocomplete doesn&#x27;t, so I&#x27;m guessing the language server ran into some kind of issue.<p>I really want to get started with Zig but I don&#x27;t want to go back to the age of nano&#x2F;edit.com for learning a new language. Zig is complex enough already.</div><br/><div id="41110716" class="c"><input type="checkbox" id="c-41110716" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41107361">root</a><span>|</span><a href="#41107855">parent</a><span>|</span><a href="#41107808">next</a><span>|</span><label class="collapse" for="c-41110716">[-]</label><label class="expand" for="c-41110716">[1 more]</label></div><br/><div class="children"><div class="content">For what it&#x27;s worth, outside of some outstanding issues with comptime (which are genuinely difficult, if ultimately solvable), I&#x27;ve found autocomplete, go-to-definition, and the other LSP semantic tools, to work fine in vs-code.<p>You could hop on the Discord and get some help with your configuration if you&#x27;d like. All things Zig are somewhat underdocumented currently, that could use some polish for sure.</div><br/></div></div></div></div><div id="41107808" class="c"><input type="checkbox" id="c-41107808" checked=""/><div class="controls bullet"><span class="by">nindalf</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41107855">prev</a><span>|</span><a href="#41108268">next</a><span>|</span><label class="collapse" for="c-41107808">[-]</label><label class="expand" for="c-41107808">[1 more]</label></div><br/><div class="children"><div class="content">Honestly same. I think it has the potential to be a great language and I&#x27;ll definitely have a look at 1.0. Right now it&#x27;s more for the people who are fine living on the bleeding edge.<p>Nothing wrong with that, imo. It&#x27;s hard to evolve a language without having the ability to make breaking changes. They&#x27;re doing the right things, generally making the right calls, and taking their time building instead of rushing.</div><br/></div></div><div id="41107573" class="c"><input type="checkbox" id="c-41107573" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#41107361">parent</a><span>|</span><a href="#41108268">prev</a><span>|</span><a href="#41107337">next</a><span>|</span><label class="collapse" for="c-41107573">[-]</label><label class="expand" for="c-41107573">[1 more]</label></div><br/><div class="children"><div class="content">&gt; […] I&#x27;ve had a lot of issues getting editor integration to work correctly. I&#x27;ve installed the VSCode extension but I don&#x27;t seem to be getting autocomplete etc. […]<p>If you use ZLS [0], make sure you’re always using the right version for the Zig version you have installed on your machine. In my experience, that fixes 90% of editor issues I’ve encountered using Zig (I don’t use Visual Studio Code though, so it’s possible your editor issues are related to the editor itself).<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;zigtools&#x2F;zls">https:&#x2F;&#x2F;github.com&#x2F;zigtools&#x2F;zls</a></div><br/></div></div></div></div><div id="41107337" class="c"><input type="checkbox" id="c-41107337" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41107361">prev</a><span>|</span><a href="#41113988">next</a><span>|</span><label class="collapse" for="c-41107337">[-]</label><label class="expand" for="c-41107337">[9 more]</label></div><br/><div class="children"><div class="content">Clang&#x27;s preprocessor is actually <i>not</i> implemented as a separate compilation pre-pass, it&#x27;s essentially a part of the lexer and I would be willing to bet that gcc uses a similar scheme.<p>So there is nothing technically impossible about having the access to macro names as a compiler-specific extension, it&#x27;s just that there is no much demand for it.</div><br/><div id="41107421" class="c"><input type="checkbox" id="c-41107421" checked=""/><div class="controls bullet"><span class="by">JonChesterfield</span><span>|</span><a href="#41107337">parent</a><span>|</span><a href="#41113988">next</a><span>|</span><label class="collapse" for="c-41107421">[-]</label><label class="expand" for="c-41107421">[8 more]</label></div><br/><div class="children"><div class="content">Clang prints out things about macro instantiations on the semantic error reporting paths. That probably means it has all the macro information available already.<p>It&#x27;s not probably reflected to the language because C++ fears reflection in general and hates macros in particular.</div><br/><div id="41108965" class="c"><input type="checkbox" id="c-41108965" checked=""/><div class="controls bullet"><span class="by">bluGill</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41107421">parent</a><span>|</span><a href="#41107517">next</a><span>|</span><label class="collapse" for="c-41108965">[-]</label><label class="expand" for="c-41108965">[5 more]</label></div><br/><div class="children"><div class="content">Reflection is on track for C++26 so it is completely wrong to say C++ fears reflection.</div><br/><div id="41109657" class="c"><input type="checkbox" id="c-41109657" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41108965">parent</a><span>|</span><a href="#41107517">next</a><span>|</span><label class="collapse" for="c-41109657">[-]</label><label class="expand" for="c-41109657">[4 more]</label></div><br/><div class="children"><div class="content">Reflection proposals have been around at least since 2014, so I&#x27;d say it&#x27;s exactly right to say that C++ <i>fears</i> it — otherwise it&#x27;d have arrived much sooner.</div><br/><div id="41109706" class="c"><input type="checkbox" id="c-41109706" checked=""/><div class="controls bullet"><span class="by">bluGill</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41109657">parent</a><span>|</span><a href="#41107517">next</a><span>|</span><label class="collapse" for="c-41109706">[-]</label><label class="expand" for="c-41109706">[3 more]</label></div><br/><div class="children"><div class="content">C++ fears getting reflection wrong, which is why it takes a long time to get it in.</div><br/><div id="41112443" class="c"><input type="checkbox" id="c-41112443" checked=""/><div class="controls bullet"><span class="by">3836293648</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41109706">parent</a><span>|</span><a href="#41107517">next</a><span>|</span><label class="collapse" for="c-41112443">[-]</label><label class="expand" for="c-41112443">[2 more]</label></div><br/><div class="children"><div class="content">C++ fears getting lots of stuff wrong, which is why they got rid of good concepts, waited 20 years and then added bad concepts</div><br/><div id="41116825" class="c"><input type="checkbox" id="c-41116825" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41112443">parent</a><span>|</span><a href="#41107517">next</a><span>|</span><label class="collapse" for="c-41116825">[-]</label><label class="expand" for="c-41116825">[1 more]</label></div><br/><div class="children"><div class="content">So is the fate of design by committee languages and APIs, where not always the best comes out, rather what the people that decided to show up voted on, and those hard enough to keep battling for their papers throughout all voting sessions until the final victory.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41107517" class="c"><input type="checkbox" id="c-41107517" checked=""/><div class="controls bullet"><span class="by">g15jv2dp</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41107421">parent</a><span>|</span><a href="#41108965">prev</a><span>|</span><a href="#41107848">next</a><span>|</span><label class="collapse" for="c-41107517">[-]</label><label class="expand" for="c-41107517">[1 more]</label></div><br/><div class="children"><div class="content">&gt; C++ fears reflection in general and hates macros in particular.<p>Macros aren&#x27;t a particular case of reflection... And at least in the way they&#x27;re done in C++, they&#x27;re a big source of bugs &#x2F; spaghetti.</div><br/></div></div><div id="41107848" class="c"><input type="checkbox" id="c-41107848" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#41107337">root</a><span>|</span><a href="#41107421">parent</a><span>|</span><a href="#41107517">prev</a><span>|</span><a href="#41113988">next</a><span>|</span><label class="collapse" for="c-41107848">[-]</label><label class="expand" for="c-41107848">[1 more]</label></div><br/><div class="children"><div class="content">&gt; C++ fears reflection and hates macros<p>But only wicked gods would banish us from paradise<p>Why do they fear our power?<p>Because evil is what they are.</div><br/></div></div></div></div></div></div><div id="41113988" class="c"><input type="checkbox" id="c-41113988" checked=""/><div class="controls bullet"><span class="by">david2ndaccount</span><span>|</span><a href="#41107337">prev</a><span>|</span><a href="#41107291">next</a><span>|</span><label class="collapse" for="c-41113988">[-]</label><label class="expand" for="c-41113988">[1 more]</label></div><br/><div class="children"><div class="content">I wrote a blogpost showing how you could do a similar thing in D with ImportC.<p><a href="https:&#x2F;&#x2F;www.davidpriver.com&#x2F;C-macro-reflection-in-D.html" rel="nofollow">https:&#x2F;&#x2F;www.davidpriver.com&#x2F;C-macro-reflection-in-D.html</a></div><br/></div></div><div id="41107291" class="c"><input type="checkbox" id="c-41107291" checked=""/><div class="controls bullet"><span class="by">eska</span><span>|</span><a href="#41113988">prev</a><span>|</span><a href="#41108822">next</a><span>|</span><label class="collapse" for="c-41107291">[-]</label><label class="expand" for="c-41107291">[5 more]</label></div><br/><div class="children"><div class="content">Wouldn’t this add at least UINT16_MAX*sizeof(intptr_t) bytes into the executable per enum?</div><br/><div id="41107380" class="c"><input type="checkbox" id="c-41107380" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41107291">parent</a><span>|</span><a href="#41107360">next</a><span>|</span><label class="collapse" for="c-41107380">[-]</label><label class="expand" for="c-41107380">[3 more]</label></div><br/><div class="children"><div class="content">It adds 65536 pointers to the binary. Alternative would be to use a hash map. I think if they made function that used inline for instead it would optimize to a switch. No need for a LUT.<p><pre><code>   fn stringFromMsg(umsg: c_int) [:0]const u8 {
       @setEvalBranchQuota(1000000);
       inline for (@typeInfo(win32).Struct.decls) |field| {
           if (field.name.len &gt;= 3 and std.mem.eql(u8, field.name[0..3], &quot;WM_&quot;)) {
               if (umsg == @field(win32, field.name)) {
                   return field.name;
               }
           }
       }
       unreachable; &#x2F;&#x2F; umsg is not valid, programming mistake
   }
</code></pre>
godbolt: <a href="https:&#x2F;&#x2F;zig.godbolt.org&#x2F;z&#x2F;7b73aoosf" rel="nofollow">https:&#x2F;&#x2F;zig.godbolt.org&#x2F;z&#x2F;7b73aoosf</a><p>In zig-budoux, I also do comptime reflection on cImport struct to assert compile time that we won&#x27;t produce broken runtime code<p><a href="https:&#x2F;&#x2F;github.com&#x2F;Cloudef&#x2F;zig-budoux&#x2F;blob&#x2F;master&#x2F;src&#x2F;c.zig#L8-L18">https:&#x2F;&#x2F;github.com&#x2F;Cloudef&#x2F;zig-budoux&#x2F;blob&#x2F;master&#x2F;src&#x2F;c.zig#...</a></div><br/><div id="41107537" class="c"><input type="checkbox" id="c-41107537" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107291">root</a><span>|</span><a href="#41107380">parent</a><span>|</span><a href="#41107360">next</a><span>|</span><label class="collapse" for="c-41107537">[-]</label><label class="expand" for="c-41107537">[2 more]</label></div><br/><div class="children"><div class="content">&gt; ...instead it would optimize to a switch. No need for a LUT.<p>IME there&#x27;s is no difference in (optimized) code generation between an if-else chain, a switch or (like in your example) an unrolled for-loop with an if inside. All those high level constructs will be optimized into a single lookup table, or a combination of multiple lookup tables and binary search to select between those. Only if there are absolutely no consecutive ranges in the switch-set, a binary search without jump tables will be used.</div><br/><div id="41107552" class="c"><input type="checkbox" id="c-41107552" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41107291">root</a><span>|</span><a href="#41107537">parent</a><span>|</span><a href="#41107360">next</a><span>|</span><label class="collapse" for="c-41107552">[-]</label><label class="expand" for="c-41107552">[1 more]</label></div><br/><div class="children"><div class="content">Note that you can&#x27;t use normal for here as you are accessing comptime known variables. Inline for will unroll the loop so that comptime constants get resolved for testing against runtime variables and then the optimizer picks out the best code (often jump tables &#x2F; switch) to generate. You are right though.</div><br/></div></div></div></div></div></div><div id="41107360" class="c"><input type="checkbox" id="c-41107360" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41107291">parent</a><span>|</span><a href="#41107380">prev</a><span>|</span><a href="#41108822">next</a><span>|</span><label class="collapse" for="c-41107360">[-]</label><label class="expand" for="c-41107360">[1 more]</label></div><br/><div class="children"><div class="content">I think the executable will essentially contain a lookup table with 2^16 slots and the string data for each macro name matching WM_* in Windows.h. But it&#x27;s hard to come up with a better solution since the actually required names are unpredictable at compile time. The size of the lookup table could be reduced though if the WM_* values occupy a much smaller range.</div><br/></div></div></div></div><div id="41108822" class="c"><input type="checkbox" id="c-41108822" checked=""/><div class="controls bullet"><span class="by">Uptrenda</span><span>|</span><a href="#41107291">prev</a><span>|</span><a href="#41116520">next</a><span>|</span><label class="collapse" for="c-41108822">[-]</label><label class="expand" for="c-41108822">[1 more]</label></div><br/><div class="children"><div class="content">Those function definitions really look amazingly readable. I&#x27;ve seen this done before in other languages and its usually quite horrible. Maybe Zig is worth learning? This is a killer feature.</div><br/></div></div><div id="41116520" class="c"><input type="checkbox" id="c-41116520" checked=""/><div class="controls bullet"><span class="by">classified</span><span>|</span><a href="#41108822">prev</a><span>|</span><a href="#41108193">next</a><span>|</span><label class="collapse" for="c-41116520">[-]</label><label class="expand" for="c-41116520">[3 more]</label></div><br/><div class="children"><div class="content">Thank Apple for Reader View in Safari. If you are as incompetent in visual design as the author of that page, you should really stay away from dark mode. Your readers will thank you.</div><br/><div id="41116979" class="c"><input type="checkbox" id="c-41116979" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#41116520">parent</a><span>|</span><a href="#41108193">next</a><span>|</span><label class="collapse" for="c-41116979">[-]</label><label class="expand" for="c-41116979">[2 more]</label></div><br/><div class="children"><div class="content">What&#x27;s wrong with green-on-black? I&#x27;ll take that over amber-on-black any day even if amber is apparently better for CRT burn-in.</div><br/><div id="41117444" class="c"><input type="checkbox" id="c-41117444" checked=""/><div class="controls bullet"><span class="by">rk06</span><span>|</span><a href="#41116520">root</a><span>|</span><a href="#41116979">parent</a><span>|</span><a href="#41108193">next</a><span>|</span><label class="collapse" for="c-41117444">[-]</label><label class="expand" for="c-41117444">[1 more]</label></div><br/><div class="children"><div class="content">It is jarring when you use light mode. There is also issue with contrast. The red const gave me enough pain that I switched to reader view</div><br/></div></div></div></div></div></div><div id="41108888" class="c"><input type="checkbox" id="c-41108888" checked=""/><div class="controls bullet"><span class="by">montyanderson</span><span>|</span><a href="#41108193">prev</a><span>|</span><label class="collapse" for="c-41108888">[-]</label><label class="expand" for="c-41108888">[1 more]</label></div><br/><div class="children"><div class="content">i like your site! seems like zig is really taking off.</div><br/></div></div></div></div></div></div></div></body></html>