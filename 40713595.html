<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719046861062" as="style"/><link rel="stylesheet" href="styles.css?v=1719046861062"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://dtsec.us/2023-04-24-Sleep/">An Introduction to Sleep Obfuscation for Malware (2023)</a>Â <span class="domain">(<a href="https://dtsec.us">dtsec.us</a>)</span></div><div class="subtext"><span>jstrieb</span> | <span>2 comments</span></div><br/><div><div id="40756915" class="c"><input type="checkbox" id="c-40756915" checked=""/><div class="controls bullet"><span class="by">enoent</span><span>|</span><label class="collapse" for="c-40756915">[-]</label><label class="expand" for="c-40756915">[1 more]</label></div><br/><div class="children"><div class="content">Sleep obfuscation seems to be viable because scanners only execute periodically. I&#x27;m not very familiar with Windows internals, but why don&#x27;t these scanners hook the VirtualProtect calls and only then scan the associated memory region? My understanding on using ROP is to make the calls seem to originate from trusted modules, but couldn&#x27;t a kernel driver &#x2F; hypervisor be able to detect all these calls regardless? Is it just too taxing on overall system performance or is there some other limitation?</div><br/></div></div></div></div></div></div></div></body></html>