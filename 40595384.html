<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717750850254" as="style"/><link rel="stylesheet" href="styles.css?v=1717750850254"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.qemu.org/2018/02/09/understanding-qemu-devices/">Understanding QEMU Devices (2018)</a> <span class="domain">(<a href="https://www.qemu.org">www.qemu.org</a>)</span></div><div class="subtext"><span>sipofwater</span> | <span>50 comments</span></div><br/><div><div id="40595497" class="c"><input type="checkbox" id="c-40595497" checked=""/><div class="controls bullet"><span class="by">SunlitCat</span><span>|</span><a href="#40606006">next</a><span>|</span><label class="collapse" for="c-40595497">[-]</label><label class="expand" for="c-40595497">[5 more]</label></div><br/><div class="children"><div class="content">QEMU along with Bochs were my first tries getting into virtualization &#x2F; emulation way back (maybe around early 2000s? I can&#x27;t remember!).<p>Although the emulation &#x2F; virtualization market already grew larger with more and more options available today, QEMU was (and still is) one of the most awesome projects out there.</div><br/><div id="40598913" class="c"><input type="checkbox" id="c-40598913" checked=""/><div class="controls bullet"><span class="by">koala_man</span><span>|</span><a href="#40595497">parent</a><span>|</span><a href="#40595871">next</a><span>|</span><label class="collapse" for="c-40598913">[-]</label><label class="expand" for="c-40598913">[1 more]</label></div><br/><div class="children"><div class="content">Back in the day I ran Bochs in all its 4 Bogomips glory on a university IP address and went to IRC channels where script kiddies were &quot;trading root&quot;.<p>I let them go first, and watched through an instrumented terminal how they clumsily installed a rootkit, then inevitably refused to give anything in return and laughed calling me a noob.<p>Their laughter was short lived.<p>I had even spent quite a bit of effort kludging the kernel to report much higher specs than Bochs could deliver, but all that effort was wasted because no one knew how to check.</div><br/></div></div><div id="40595871" class="c"><input type="checkbox" id="c-40595871" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40595497">parent</a><span>|</span><a href="#40598913">prev</a><span>|</span><a href="#40600117">next</a><span>|</span><label class="collapse" for="c-40595871">[-]</label><label class="expand" for="c-40595871">[2 more]</label></div><br/><div class="children"><div class="content">A lot of the options (especially the free ones) are either using qemu or using ideas that were developed early (not actually first) for qemu like virtio.  There are just a lot more layers on top these days, and not always for the better.</div><br/><div id="40602344" class="c"><input type="checkbox" id="c-40602344" checked=""/><div class="controls bullet"><span class="by">skrtskrt</span><span>|</span><a href="#40595497">root</a><span>|</span><a href="#40595871">parent</a><span>|</span><a href="#40600117">next</a><span>|</span><label class="collapse" for="c-40602344">[-]</label><label class="expand" for="c-40602344">[1 more]</label></div><br/><div class="children"><div class="content">Proxmox is great as a FOSS hypervisor, but their docs for doing pretty much anything advanced are just &quot;here&#x27;s a qemu command&quot;.</div><br/></div></div></div></div><div id="40600117" class="c"><input type="checkbox" id="c-40600117" checked=""/><div class="controls bullet"><span class="by">swozey</span><span>|</span><a href="#40595497">parent</a><span>|</span><a href="#40595871">prev</a><span>|</span><a href="#40606006">next</a><span>|</span><label class="collapse" for="c-40600117">[-]</label><label class="expand" for="c-40600117">[1 more]</label></div><br/><div class="children"><div class="content">QEMU is used in basically every single hardware vendor today and has been since I&#x27;ve been in virtualization&#x2F;containerization tech (2010+).<p>I&#x27;ve only seen Vmware (gsx&#x2F;esx) at Windows shops for things like big Exchange clusters, etc. Every CDN I&#x27;ve worked at used qemu.</div><br/></div></div></div></div><div id="40606006" class="c"><input type="checkbox" id="c-40606006" checked=""/><div class="controls bullet"><span class="by">israrkhan</span><span>|</span><a href="#40595497">prev</a><span>|</span><a href="#40596729">next</a><span>|</span><label class="collapse" for="c-40606006">[-]</label><label class="expand" for="c-40606006">[1 more]</label></div><br/><div class="children"><div class="content">QEMU is a great piece of software. I use it regularly to debug various cross compiled kernel images under gdb without requiring actual ARM hardware (buildroot + custom kernel + gdb).</div><br/></div></div><div id="40596729" class="c"><input type="checkbox" id="c-40596729" checked=""/><div class="controls bullet"><span class="by">dlachausse</span><span>|</span><a href="#40606006">prev</a><span>|</span><a href="#40595579">next</a><span>|</span><label class="collapse" for="c-40596729">[-]</label><label class="expand" for="c-40596729">[5 more]</label></div><br/><div class="children"><div class="content">If you’re on a Mac, UTM is an excellent wrapper around Qemu.<p><a href="https:&#x2F;&#x2F;mac.getutm.app&#x2F;" rel="nofollow">https:&#x2F;&#x2F;mac.getutm.app&#x2F;</a></div><br/><div id="40597190" class="c"><input type="checkbox" id="c-40597190" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40596729">parent</a><span>|</span><a href="#40595579">next</a><span>|</span><label class="collapse" for="c-40597190">[-]</label><label class="expand" for="c-40597190">[4 more]</label></div><br/><div class="children"><div class="content">you can choose Apple virtualisation in UTM instead of QEMU too. Apple virtualization is optimized for M1+</div><br/><div id="40601153" class="c"><input type="checkbox" id="c-40601153" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#40596729">root</a><span>|</span><a href="#40597190">parent</a><span>|</span><a href="#40598204">next</a><span>|</span><label class="collapse" for="c-40601153">[-]</label><label class="expand" for="c-40601153">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a bit like saying &quot;instead of ext4 you can use an SSD&quot; in that the things involved span multiple layers. When you select the option to use Apple virtualization framework in UTM you&#x27;re still using QEMU, what you&#x27;re changing is the backend QEMU is using for the CPU virtualization.</div><br/><div id="40603126" class="c"><input type="checkbox" id="c-40603126" checked=""/><div class="controls bullet"><span class="by">ashconnor</span><span>|</span><a href="#40596729">root</a><span>|</span><a href="#40601153">parent</a><span>|</span><a href="#40598204">next</a><span>|</span><label class="collapse" for="c-40603126">[-]</label><label class="expand" for="c-40603126">[1 more]</label></div><br/><div class="children"><div class="content">Docs: <a href="https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;virtualization" rel="nofollow">https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;virtualization</a></div><br/></div></div></div></div><div id="40598204" class="c"><input type="checkbox" id="c-40598204" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40596729">root</a><span>|</span><a href="#40597190">parent</a><span>|</span><a href="#40601153">prev</a><span>|</span><a href="#40595579">next</a><span>|</span><label class="collapse" for="c-40598204">[-]</label><label class="expand" for="c-40598204">[1 more]</label></div><br/><div class="children"><div class="content">QEMU has a Hypervisor[0] backend these days, called “hvf”.<p><a href="https:&#x2F;&#x2F;wiki.qemu.org&#x2F;Features&#x2F;HVF" rel="nofollow">https:&#x2F;&#x2F;wiki.qemu.org&#x2F;Features&#x2F;HVF</a><p>[0] “Hypervisor” is a “sibling” to the Virtualization framework. IMHO, the naming is incredibly confusing (:</div><br/></div></div></div></div></div></div><div id="40595579" class="c"><input type="checkbox" id="c-40595579" checked=""/><div class="controls bullet"><span class="by">checker659</span><span>|</span><a href="#40596729">prev</a><span>|</span><a href="#40596487">next</a><span>|</span><label class="collapse" for="c-40595579">[-]</label><label class="expand" for="c-40595579">[21 more]</label></div><br/><div class="children"><div class="content">What is the definitive new-comer friendly guide to QEMU? Not just about using it but also understanding its internals (say to add new instructions to a supported ISA etc)?</div><br/><div id="40596597" class="c"><input type="checkbox" id="c-40596597" checked=""/><div class="controls bullet"><span class="by">pm215</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40597506">next</a><span>|</span><label class="collapse" for="c-40596597">[-]</label><label class="expand" for="c-40596597">[8 more]</label></div><br/><div class="children"><div class="content">Unfortuately there is none. QEMU is a large project and doesn&#x27;t have much formal design or API documentation. On the other hand it&#x27;s not big enough (compared for instance to the Linux kernel) to have a wider community interested in trying to provide internals documentation for newcomers.<p>Our general advice is &quot;look at the existing code for the bit you&#x27;re interested in to see how it works&quot;. You can sometimes find descriptions of the overall architecture online in third party blog posts and the like, but if they&#x27;re more than a few years old then be wary that they might be out of date -- they&#x27;re likely to be right in general principles and wrong in details, because things change.<p>For adding new instructions to an existing ISA: the first couple of sections of <a href="https:&#x2F;&#x2F;www.qemu.org&#x2F;docs&#x2F;master&#x2F;devel&#x2F;index-tcg.html" rel="nofollow">https:&#x2F;&#x2F;www.qemu.org&#x2F;docs&#x2F;master&#x2F;devel&#x2F;index-tcg.html</a> are relevant here. Depending on the target it might or might not use decodetree (decodetree is much easier to add a new insn to, but some older targets still do by-hand switch-statement based decoding.) Look at how an existing insn that is similar to what you want to do works.<p>Implementing CHERI in particular is going to be pretty awful, because the things it does (like 128-bit pointers) break various assumptions QEMU makes. The University of Cambridge forked QEMU to add CHERI support for MIPS and RISC-V and I think also AArch64: <a href="https:&#x2F;&#x2F;www.cl.cam.ac.uk&#x2F;research&#x2F;security&#x2F;ctsrd&#x2F;cheri&#x2F;cheri-qemu.html" rel="nofollow">https:&#x2F;&#x2F;www.cl.cam.ac.uk&#x2F;research&#x2F;security&#x2F;ctsrd&#x2F;cheri&#x2F;cheri...</a> -- but the changes are pretty invasive and also not likely to be very fast. (The fork looks like it&#x27;s based on 6.0, so three years old now.)<p>(If anybody is interested in trying to write up some documentation for QEMU&#x27;s internals (either a general overview&#x2F;roadmap or something on a particular subsystem), I&#x27;d be happy to code-review patches that add something to the &quot;Developer Information&quot; subsection of our manual.)</div><br/><div id="40597359" class="c"><input type="checkbox" id="c-40597359" checked=""/><div class="controls bullet"><span class="by">isjamesalive</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40596597">parent</a><span>|</span><a href="#40596812">next</a><span>|</span><label class="collapse" for="c-40597359">[-]</label><label class="expand" for="c-40597359">[4 more]</label></div><br/><div class="children"><div class="content">&gt; QEMU is a large project and doesn&#x27;t have much formal design or API documentation.<p>This is bonkers to me considering how it’s used in industry.</div><br/><div id="40597405" class="c"><input type="checkbox" id="c-40597405" checked=""/><div class="controls bullet"><span class="by">pm215</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40597359">parent</a><span>|</span><a href="#40596812">next</a><span>|</span><label class="collapse" for="c-40597405">[-]</label><label class="expand" for="c-40597405">[3 more]</label></div><br/><div class="children"><div class="content">Wake me up when those industry users want to pay somebody to improve the developer documentation :-)</div><br/><div id="40598773" class="c"><input type="checkbox" id="c-40598773" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40597405">parent</a><span>|</span><a href="#40596812">next</a><span>|</span><label class="collapse" for="c-40598773">[-]</label><label class="expand" for="c-40598773">[2 more]</label></div><br/><div class="children"><div class="content">Well, every time this line of thinking comes up, I don&#x27;t believe there is a gofundme, indiegogo, patreon, etc to which I could donate. Because I for sure think that would be a good investment for future generations, but you are correct that I almost certainly couldn&#x27;t convince my employer to spend the money. I&#x27;d guess that&#x27;s partially because they don&#x27;t <i>directly</i> benefit from qemu, setting aside the daily use of buildkit which for sure does. Come to think of it, I&#x27;d guess Docker(Mirantis?) is BY FAR the most &quot;you really, really should be a corporate sponsor&quot; of qemu</div><br/><div id="40598928" class="c"><input type="checkbox" id="c-40598928" checked=""/><div class="controls bullet"><span class="by">pm215</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40598773">parent</a><span>|</span><a href="#40596812">next</a><span>|</span><label class="collapse" for="c-40598928">[-]</label><label class="expand" for="c-40598928">[1 more]</label></div><br/><div class="children"><div class="content">Well, you <i>can</i> donate to the project (there&#x27;s a paypal link at the bottom of <a href="https:&#x2F;&#x2F;www.qemu.org&#x2F;sponsors&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.qemu.org&#x2F;sponsors&#x2F;</a> which donates to the Software Freedom Conservancy earmarking it as being for QEMU), *but* doing that won&#x27;t cause somebody to be paid to work on the project (it can cover random project expenses like CI usage, I think). Mostly our sponsorship is either &quot;in-kind&quot; (access to compute hosts, hosting downloads, cloud compute credits etc) or else is sponsorship to help pay for the annual KVM Forum conference.<p>In general there is no mechanism for &quot;pay money to have work happen&quot; because pretty much all non-hobbyist QEMU developers are doing it because they&#x27;re paid by some company (RedHat, Linaro, etc etc etc) to do that work as their full time job. So they&#x27;re not in the market for random small side jobs.</div><br/></div></div></div></div></div></div></div></div><div id="40596812" class="c"><input type="checkbox" id="c-40596812" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40596597">parent</a><span>|</span><a href="#40597359">prev</a><span>|</span><a href="#40597506">next</a><span>|</span><label class="collapse" for="c-40596812">[-]</label><label class="expand" for="c-40596812">[3 more]</label></div><br/><div class="children"><div class="content">Out of curiosity, how does one reach you? (Saw no info&#x2F;contact details in your profile.)<p>Also, where does QEMU people hang out online? AFAICT the IRC channel is not very active. (Based on few and random visits, so I could be wrong.)</div><br/><div id="40597061" class="c"><input type="checkbox" id="c-40597061" checked=""/><div class="controls bullet"><span class="by">pm215</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40596812">parent</a><span>|</span><a href="#40597506">next</a><span>|</span><label class="collapse" for="c-40597061">[-]</label><label class="expand" for="c-40597061">[2 more]</label></div><br/><div class="children"><div class="content">The primary nexus for QEMU developers is the qemu-devel mailing list. (Very high traffic because it&#x27;s also used for patchmails.) The irc channel is a bit more variable and tends in particular to be quiet outside UK&#x2F;Europe working hours, just because most QEMU devs happen to be Europe based.<p>I discourage private emails sent direct to me on QEMU topics (because they should generally be to public lists so other community members can answer them or benefit from the answer), but you can find me on the mailing lists and irc.</div><br/><div id="40598070" class="c"><input type="checkbox" id="c-40598070" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40597061">parent</a><span>|</span><a href="#40597506">next</a><span>|</span><label class="collapse" for="c-40598070">[-]</label><label class="expand" for="c-40598070">[1 more]</label></div><br/><div class="children"><div class="content">Ok, cool!</div><br/></div></div></div></div></div></div></div></div><div id="40597506" class="c"><input type="checkbox" id="c-40597506" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40596597">prev</a><span>|</span><a href="#40598235">next</a><span>|</span><label class="collapse" for="c-40597506">[-]</label><label class="expand" for="c-40597506">[2 more]</label></div><br/><div class="children"><div class="content">Start with libvirt, it provides a full GUI around QEMU operations.  Run ps to see the underlying QEMU commands it runs.  Inspect the XML files to understand how it builds machines.</div><br/><div id="40598139" class="c"><input type="checkbox" id="c-40598139" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40597506">parent</a><span>|</span><a href="#40598235">next</a><span>|</span><label class="collapse" for="c-40598139">[-]</label><label class="expand" for="c-40598139">[1 more]</label></div><br/><div class="children"><div class="content">A coworker came up with a similar idea: We started a VM using Lima, then ran ps to see what args it passed to QEMU. It was enlightening!</div><br/></div></div></div></div><div id="40598235" class="c"><input type="checkbox" id="c-40598235" checked=""/><div class="controls bullet"><span class="by">Neywiny</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40597506">prev</a><span>|</span><a href="#40595701">next</a><span>|</span><label class="collapse" for="c-40598235">[-]</label><label class="expand" for="c-40598235">[1 more]</label></div><br/><div class="children"><div class="content">I implemented a bit of a STM32 and it was a <i>chore</i> and a half. I&#x27;ve noticed 2 things with the code base:
1. It&#x27;s C but they really want C++. Qemu wrote their own class system, foreach loops, containers, etc. And because of that, when I tried to use actual cpp, compilation failed due to how many reserved keywords were used in headers and other mess. 
2. As noted in other comments, copy paste and modify. It got me where I need to go. But it was a slog. Eventually I had gdb debugging my qemu build, and gdb debugging the program I was running. I could even connect in from the STM32 IDE which was nice</div><br/></div></div><div id="40595701" class="c"><input type="checkbox" id="c-40595701" checked=""/><div class="controls bullet"><span class="by">sipofwater</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40598235">prev</a><span>|</span><a href="#40602370">next</a><span>|</span><label class="collapse" for="c-40595701">[-]</label><label class="expand" for="c-40595701">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.qemu.org&#x2F;documentation&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.qemu.org&#x2F;documentation&#x2F;</a></div><br/><div id="40596284" class="c"><input type="checkbox" id="c-40596284" checked=""/><div class="controls bullet"><span class="by">checker659</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40595701">parent</a><span>|</span><a href="#40602370">next</a><span>|</span><label class="collapse" for="c-40596284">[-]</label><label class="expand" for="c-40596284">[2 more]</label></div><br/><div class="children"><div class="content">I am looking for some hand-holding with this. The documentation seems more for reference (albeit a bit lack-luster if I may say so).</div><br/><div id="40605661" class="c"><input type="checkbox" id="c-40605661" checked=""/><div class="controls bullet"><span class="by">bonzini</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40596284">parent</a><span>|</span><a href="#40602370">next</a><span>|</span><label class="collapse" for="c-40605661">[-]</label><label class="expand" for="c-40605661">[1 more]</label></div><br/><div class="children"><div class="content">If there are any specific topics that you&#x27;d like covered, please ask.</div><br/></div></div></div></div></div></div><div id="40602370" class="c"><input type="checkbox" id="c-40602370" checked=""/><div class="controls bullet"><span class="by">skrtskrt</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40595701">prev</a><span>|</span><a href="#40595921">next</a><span>|</span><label class="collapse" for="c-40602370">[-]</label><label class="expand" for="c-40602370">[1 more]</label></div><br/><div class="children"><div class="content">probably just start using Proxmox, as it&#x27;s a pretty beginner-friendly FOSS hypervisor with extensive docs and forums, and it&#x27;s largely a wrapper around qemu.<p>Their docs often include equivalent qemu commands for any UI actions.<p>For anything the UI can&#x27;t do yet, they only give the QEMU command</div><br/></div></div><div id="40595921" class="c"><input type="checkbox" id="c-40595921" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40595579">parent</a><span>|</span><a href="#40602370">prev</a><span>|</span><a href="#40596487">next</a><span>|</span><label class="collapse" for="c-40595921">[-]</label><label class="expand" for="c-40595921">[5 more]</label></div><br/><div class="children"><div class="content">What are your goals? Are you interested in emulation (i.e. running a VM that uses another architecture than your physical computer) or in virtualization? (i.e. running a VM that uses the same architecture)</div><br/><div id="40596268" class="c"><input type="checkbox" id="c-40596268" checked=""/><div class="controls bullet"><span class="by">checker659</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40595921">parent</a><span>|</span><a href="#40597836">next</a><span>|</span><label class="collapse" for="c-40596268">[-]</label><label class="expand" for="c-40596268">[1 more]</label></div><br/><div class="children"><div class="content">Well both. I&#x27;m interested in implementing an ISA extension (not sure if you know about CHERI). Also, there are reference implementations for aarch64 and risc-v that I&#x27;d like to understand.</div><br/></div></div><div id="40597836" class="c"><input type="checkbox" id="c-40597836" checked=""/><div class="controls bullet"><span class="by">hnthrowaway0328</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40595921">parent</a><span>|</span><a href="#40596268">prev</a><span>|</span><a href="#40596487">next</a><span>|</span><label class="collapse" for="c-40597836">[-]</label><label class="expand" for="c-40597836">[3 more]</label></div><br/><div class="children"><div class="content">Just curious, what about simulation? I heard that simulation is more serious than emulation and targets for say pipeline level emulation, but maybe it&#x27;s just a fancier word?</div><br/><div id="40598100" class="c"><input type="checkbox" id="c-40598100" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40597836">parent</a><span>|</span><a href="#40596487">next</a><span>|</span><label class="collapse" for="c-40598100">[-]</label><label class="expand" for="c-40598100">[2 more]</label></div><br/><div class="children"><div class="content">Beats me. What does simulation mean in this context?</div><br/><div id="40598180" class="c"><input type="checkbox" id="c-40598180" checked=""/><div class="controls bullet"><span class="by">hnthrowaway0328</span><span>|</span><a href="#40595579">root</a><span>|</span><a href="#40598100">parent</a><span>|</span><a href="#40596487">next</a><span>|</span><label class="collapse" for="c-40598180">[-]</label><label class="expand" for="c-40598180">[1 more]</label></div><br/><div class="children"><div class="content">Ah nevermind then, probably just a synonym for emulation.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40596487" class="c"><input type="checkbox" id="c-40596487" checked=""/><div class="controls bullet"><span class="by">zorked</span><span>|</span><a href="#40595579">prev</a><span>|</span><a href="#40600425">next</a><span>|</span><label class="collapse" for="c-40596487">[-]</label><label class="expand" for="c-40596487">[1 more]</label></div><br/><div class="children"><div class="content">qemu is a treasure and reading its source to learn how computers work is very fun.</div><br/></div></div><div id="40600425" class="c"><input type="checkbox" id="c-40600425" checked=""/><div class="controls bullet"><span class="by">apitman</span><span>|</span><a href="#40596487">prev</a><span>|</span><a href="#40595430">next</a><span>|</span><label class="collapse" for="c-40600425">[-]</label><label class="expand" for="c-40600425">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Understanding QEMU...<p>Best of luck</div><br/><div id="40603312" class="c"><input type="checkbox" id="c-40603312" checked=""/><div class="controls bullet"><span class="by">ashconnor</span><span>|</span><a href="#40600425">parent</a><span>|</span><a href="#40595430">next</a><span>|</span><label class="collapse" for="c-40603312">[-]</label><label class="expand" for="c-40603312">[1 more]</label></div><br/><div class="children"><div class="content">Followed by libvirt, VirtIO, KVM, qcow2. If only there was one book or course to pull it all together.</div><br/></div></div></div></div><div id="40595430" class="c"><input type="checkbox" id="c-40595430" checked=""/><div class="controls bullet"><span class="by">sipofwater</span><span>|</span><a href="#40600425">prev</a><span>|</span><a href="#40595385">next</a><span>|</span><label class="collapse" for="c-40595430">[-]</label><label class="expand" for="c-40595430">[1 more]</label></div><br/><div class="children"><div class="content">&quot;USB disk as &#x2F;dev&#x2F;sda on a not-rooted smartphone using Termux, QEMU, Alpine Linux&quot;: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40507319">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40507319</a></div><br/></div></div><div id="40596685" class="c"><input type="checkbox" id="c-40596685" checked=""/><div class="controls bullet"><span class="by">anonymousDan</span><span>|</span><a href="#40595385">prev</a><span>|</span><a href="#40604825">next</a><span>|</span><label class="collapse" for="c-40596685">[-]</label><label class="expand" for="c-40596685">[1 more]</label></div><br/><div class="children"><div class="content">This is such a fantastic description of what is going on underneath the hood - it took me quite a while to understand how qemu works, wish I had seen this before!</div><br/></div></div><div id="40604825" class="c"><input type="checkbox" id="c-40604825" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#40596685">prev</a><span>|</span><a href="#40595905">next</a><span>|</span><label class="collapse" for="c-40604825">[-]</label><label class="expand" for="c-40604825">[1 more]</label></div><br/><div class="children"><div class="content">&gt; QEMU actually has the ability to glue together a lot of different host formats (raw, qcow2, qed, vhdx, …)<p>&gt; and protocols (file system, block device, NBD, Ceph, gluster, …)<p>Yeah, and it&#x27;s awesome. With qcow2 images mounted via nbd, I was able to manipulate ddrescue images without modifying the original. Truly one of the most useful software ever written. I even use it on Android with Termux to use and test x86_64 software.<p>I wish there was a step by step porting and implementation guide. I tried to port the open source Sensor Watch board to QEMU in order to facillitate software development for it. Didn&#x27;t get very far. I&#x27;m not particularly knowledgeable about electronics but I had all the hardware documentation, I feel like it should have been enough.</div><br/></div></div><div id="40597101" class="c"><input type="checkbox" id="c-40597101" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40595905">prev</a><span>|</span><label class="collapse" for="c-40597101">[-]</label><label class="expand" for="c-40597101">[9 more]</label></div><br/><div class="children"><div class="content">Warning for humans! If you are trying to run a virtual PC on QEMY let&#x27;s say on bare metal hosting from hetzner, you will very soon discover - QEMU is a dead slow without actual graphic card or at best you will get all kind of funky missing libs error messages on Ubuntu and other OS in very surprise spots.<p>Had a very good experience simulating K8s cluster with QEMU aka studing K8s hard way once I figure out how networking actually works between virtual machines and domains can be assigned with external proxy.</div><br/><div id="40598322" class="c"><input type="checkbox" id="c-40598322" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40597101">parent</a><span>|</span><a href="#40600615">next</a><span>|</span><label class="collapse" for="c-40598322">[-]</label><label class="expand" for="c-40598322">[3 more]</label></div><br/><div class="children"><div class="content">Why would qemu care about having a graphics card? Do you mean that whatever system you were running inside qemu expected a GPU and was slow without it?</div><br/><div id="40603489" class="c"><input type="checkbox" id="c-40603489" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#40597101">root</a><span>|</span><a href="#40598322">parent</a><span>|</span><a href="#40600615">next</a><span>|</span><label class="collapse" for="c-40603489">[-]</label><label class="expand" for="c-40603489">[2 more]</label></div><br/><div class="children"><div class="content">If the OP was running a virtual <i>desktop</i> on a server with no GPU then they probably had to fall back to software rendering which can be slow. This isn&#x27;t QEMU&#x27;s fault per se; if you physically don&#x27;t have a GPU then you don&#x27;t have a GPU.</div><br/><div id="40603924" class="c"><input type="checkbox" id="c-40603924" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40597101">root</a><span>|</span><a href="#40603489">parent</a><span>|</span><a href="#40600615">next</a><span>|</span><label class="collapse" for="c-40603924">[-]</label><label class="expand" for="c-40603924">[1 more]</label></div><br/><div class="children"><div class="content">correct. thank you for phrasing it better</div><br/></div></div></div></div></div></div><div id="40600615" class="c"><input type="checkbox" id="c-40600615" checked=""/><div class="controls bullet"><span class="by">navaati</span><span>|</span><a href="#40597101">parent</a><span>|</span><a href="#40598322">prev</a><span>|</span><a href="#40600064">next</a><span>|</span><label class="collapse" for="c-40600615">[-]</label><label class="expand" for="c-40600615">[3 more]</label></div><br/><div class="children"><div class="content">Hi, one probably really wants to use libvirt rather than qemu directly. That way you can create your VMs remotely with a GUI (virt-manager) using a ssh-based libvirt url, or a CLI (virsh) and it will handle all the right parameters for qemu, the required networking setup, etc. Check it out !</div><br/><div id="40603961" class="c"><input type="checkbox" id="c-40603961" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40597101">root</a><span>|</span><a href="#40600615">parent</a><span>|</span><a href="#40603950">next</a><span>|</span><label class="collapse" for="c-40603961">[-]</label><label class="expand" for="c-40603961">[1 more]</label></div><br/><div class="children"><div class="content">as @wmf correctly stated &quot;If the OP was running a virtual desktop on a server with no GPU then they probably had to fall back to software rendering which can be slow. This isn&#x27;t QEMU&#x27;s fault per se; if you physically don&#x27;t have a GPU then you don&#x27;t have a GPU.&quot;<p>and 99% cheap servers in the wild dont have a GPU or even hardware graphic card</div><br/></div></div><div id="40603950" class="c"><input type="checkbox" id="c-40603950" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40597101">root</a><span>|</span><a href="#40600615">parent</a><span>|</span><a href="#40603961">prev</a><span>|</span><a href="#40600064">next</a><span>|</span><label class="collapse" for="c-40603950">[-]</label><label class="expand" for="c-40603950">[1 more]</label></div><br/><div class="children"><div class="content">yes, i connect with virt-manager and ssh-based libvirt url.<p>my main case was to scrape multiple messangers and apps with desktop ui only.<p>everything must run and render on server.</div><br/></div></div></div></div><div id="40600064" class="c"><input type="checkbox" id="c-40600064" checked=""/><div class="controls bullet"><span class="by">TeeMassive</span><span>|</span><a href="#40597101">parent</a><span>|</span><a href="#40600615">prev</a><span>|</span><label class="collapse" for="c-40600064">[-]</label><label class="expand" for="c-40600064">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Had a very good experience simulating K8s cluster with QEMU aka studing K8s hard way once I figure out how networking actually works between virtual machines and domains can be assigned with external proxy.<p>This is an awesome use of QEMU! I&#x27;m both interested in learning K8s and what goes on under the hood at the kernel level because I do cloud connected IoT stuff, so I&#x27;ll definitely use that!<p>Is there any kind of &quot;build the kernel from scratch&quot; project for that kind of stuff?</div><br/><div id="40604043" class="c"><input type="checkbox" id="c-40604043" checked=""/><div class="controls bullet"><span class="by">adeptima</span><span>|</span><a href="#40597101">root</a><span>|</span><a href="#40600064">parent</a><span>|</span><label class="collapse" for="c-40604043">[-]</label><label class="expand" for="c-40604043">[1 more]</label></div><br/><div class="children"><div class="content">I was inspired by the article &quot;Kubernetes The Hard Way&quot; ... cant find the original article now<p>Had to study concepts like &quot;bridged networking with libvirt&quot;
<a href="https:&#x2F;&#x2F;linuxconfig.org&#x2F;how-to-use-bridged-networking-with-libvirt-and-kvm" rel="nofollow">https:&#x2F;&#x2F;linuxconfig.org&#x2F;how-to-use-bridged-networking-with-l...</a><p>No way I would recommend my way to study k8s ... it was just a pet project for a greater good.<p>Now in 2024 it&#x27;s better to start from projects like minikube or k3s (my preference) on local computer<p><a href="https:&#x2F;&#x2F;minikube.sigs.k8s.io&#x2F;docs&#x2F;" rel="nofollow">https:&#x2F;&#x2F;minikube.sigs.k8s.io&#x2F;docs&#x2F;</a>
<a href="https:&#x2F;&#x2F;docs.k3s.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.k3s.io&#x2F;</a><p>and later use terraform to provision infra<p>or<p>Forget it all and just use managed kubernets from cheaper providers like digital ocean<p>The result of inflicting pain on myself - I do value the work done by people who provide stable managed kubernets and upgrade it flawlessly.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>