<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1692090071808" as="style"/><link rel="stylesheet" href="styles.css?v=1692090071808"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://jdk.java.net/loom/">Features of Project Loom incorporated in JDK 21</a> <span class="domain">(<a href="https://jdk.java.net">jdk.java.net</a>)</span></div><div class="subtext"><span>philonoist</span> | <span>24 comments</span></div><br/><div><div id="37131530" class="c"><input type="checkbox" id="c-37131530" checked=""/><div class="controls bullet"><span class="by">nvm0n2</span><span>|</span><a href="#37130915">next</a><span>|</span><label class="collapse" for="c-37131530">[-]</label><label class="expand" for="c-37131530">[5 more]</label></div><br/><div class="children"><div class="content">A good step forward and nice that it&#x27;s in the next (Oracle) LTS version. But is it too late? NodeJS started cleaning up by pushing async-for-all over a decade ago. Then Go came along and did the same thing but with a simple statically typed language. The Java world developed async server frameworks + GraalVM native image in response and now will be able to incrementally phase them out, but Java lost significant ground server-side because it took so long to identify and respond to these moves by competitors.<p>The question is now whether Java will regain some of that lost ground, or whether people came for the async but stay for the &quot;isomorphism&quot; (same language in both browser and server) &#x2F; AOT compilation model.<p>My gut says it&#x27;s not too late for them and devs do engage in a kind of continuous rolling evaluation of platforms. Once Java 21 launches people might start to re-evaluate Java vs Node and once Loom is fully supported in native images, you might start to see people re-evaluate Java vs Go at least. Where by &quot;Java vs&quot; I really mean &quot;JVM languages vs&quot; like with Kotlin, Scala and Clojure as well. Or maybe even Loom will be compatible with GraalJS and then you can do fully blocking programming with Node-style efficiency but on the JVM.</div><br/><div id="37131655" class="c"><input type="checkbox" id="c-37131655" checked=""/><div class="controls bullet"><span class="by">matsemann</span><span>|</span><a href="#37131530">parent</a><span>|</span><a href="#37131587">next</a><span>|</span><label class="collapse" for="c-37131655">[-]</label><label class="expand" for="c-37131655">[1 more]</label></div><br/><div class="children"><div class="content">My experience is that most Java people didn&#x27;t switch to other languages nor to async abstractions. So this will not have people revert lots of work, just improve their existing way of working.<p>If one&#x27;s only reading HN it may be easy to think of Java on the decline and almost dead. But I&#x27;ve done lots of greenfield java projects (or, mostly Kotlin, but still on the JVM) various places until recently (when I switched job).</div><br/></div></div><div id="37131587" class="c"><input type="checkbox" id="c-37131587" checked=""/><div class="controls bullet"><span class="by">pmontra</span><span>|</span><a href="#37131530">parent</a><span>|</span><a href="#37131655">prev</a><span>|</span><a href="#37130915">next</a><span>|</span><label class="collapse" for="c-37131587">[-]</label><label class="expand" for="c-37131587">[3 more]</label></div><br/><div class="children"><div class="content">There are companies that use Java and will keep using Java no matter what. A 10+ years old Java is fine for them.<p>An example: all the incumbent financial sector.</div><br/><div id="37131614" class="c"><input type="checkbox" id="c-37131614" checked=""/><div class="controls bullet"><span class="by">nvm0n2</span><span>|</span><a href="#37131530">root</a><span>|</span><a href="#37131587">parent</a><span>|</span><a href="#37130915">next</a><span>|</span><label class="collapse" for="c-37131614">[-]</label><label class="expand" for="c-37131614">[2 more]</label></div><br/><div class="children"><div class="content">Yes, but there&#x27;s little growth to be had there. I think the Java guys don&#x27;t want to be the new COBOL, they&#x27;d like new apps to be written in Java too.</div><br/><div id="37131645" class="c"><input type="checkbox" id="c-37131645" checked=""/><div class="controls bullet"><span class="by">rbanffy</span><span>|</span><a href="#37131530">root</a><span>|</span><a href="#37131614">parent</a><span>|</span><a href="#37130915">next</a><span>|</span><label class="collapse" for="c-37131645">[-]</label><label class="expand" for="c-37131645">[1 more]</label></div><br/><div class="children"><div class="content">Java and, to a lesser degree, C#, seem to have joined COBOL in the list of “forever languages”. Unless financial institutions trust LLMs to rewrite them in newer languages (and finds that cost-effective), there is no way that humongous corpus of business-critical software will ever be ported.</div><br/></div></div></div></div></div></div></div></div><div id="37130915" class="c"><input type="checkbox" id="c-37130915" checked=""/><div class="controls bullet"><span class="by">dveeden2</span><span>|</span><a href="#37131530">prev</a><span>|</span><a href="#37131347">next</a><span>|</span><label class="collapse" for="c-37130915">[-]</label><label class="expand" for="c-37130915">[1 more]</label></div><br/><div class="children"><div class="content">Info on what Project Loom is: <a href="https:&#x2F;&#x2F;cr.openjdk.org&#x2F;~rpressler&#x2F;loom&#x2F;Loom-Proposal.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;cr.openjdk.org&#x2F;~rpressler&#x2F;loom&#x2F;Loom-Proposal.html</a></div><br/></div></div><div id="37131347" class="c"><input type="checkbox" id="c-37131347" checked=""/><div class="controls bullet"><span class="by">misja111</span><span>|</span><a href="#37130915">prev</a><span>|</span><a href="#37131320">next</a><span>|</span><label class="collapse" for="c-37131347">[-]</label><label class="expand" for="c-37131347">[6 more]</label></div><br/><div class="children"><div class="content">Does anybody know what this will mean for the already existing green threads implementations in e.g. Kotlin and Scala Cats?
Will these benefit from project Loom, or are they somehow incompatible?</div><br/><div id="37131550" class="c"><input type="checkbox" id="c-37131550" checked=""/><div class="controls bullet"><span class="by">doikor</span><span>|</span><a href="#37131347">parent</a><span>|</span><a href="#37131535">next</a><span>|</span><label class="collapse" for="c-37131550">[-]</label><label class="expand" for="c-37131550">[1 more]</label></div><br/><div class="children"><div class="content">One of the main authors of ZIO (another effect runtime in Scala) gave a talk about ZIO + Loom.<p><a href="https:&#x2F;&#x2F;youtu.be&#x2F;ygOmwze5ETk" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;ygOmwze5ETk</a><p>For some use cases there seems to be a performance advantage for using Loom if the library properly supports Loom. (Mainly gain it from using plain old boring blocking IO instead of async NIO stuff which has overhead. <a href="https:&#x2F;&#x2F;youtu.be&#x2F;ygOmwze5ETk?t=2396" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;ygOmwze5ETk?t=2396</a>)<p>And at least according to JDG cats-effect is heavily tied down to their Async means they can&#x27;t as easily work around the async overhead as ZIO can. Don&#x27;t know if this is actually true or not. Would need input from actual cats-effect maintainers on this.</div><br/></div></div><div id="37131535" class="c"><input type="checkbox" id="c-37131535" checked=""/><div class="controls bullet"><span class="by">ceronman</span><span>|</span><a href="#37131347">parent</a><span>|</span><a href="#37131550">prev</a><span>|</span><a href="#37131487">next</a><span>|</span><label class="collapse" for="c-37131535">[-]</label><label class="expand" for="c-37131535">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know about Scala, but there are benefits for Kotlin indeed. For example a special dispatcher could be made to schedule each coroutine on a single virtual thread. This would be very handy for coroutines that suspend on IO, and it would be a better alternative to Dispatchers.IO which currently uses a threadpool like strategy. Also it&#x27;s possible that debugging and profiling is improved given that each virtual thread has its own stack. And you can still take advantage of all the nice things in Kotlin for structured concurrency, flows, etc.<p>On the other hand, Kotlin already committed to a colored function approach, and it will likely remain. Java on the other hand, will not need that, which is nice.</div><br/><div id="37131675" class="c"><input type="checkbox" id="c-37131675" checked=""/><div class="controls bullet"><span class="by">matsemann</span><span>|</span><a href="#37131347">root</a><span>|</span><a href="#37131535">parent</a><span>|</span><a href="#37131487">next</a><span>|</span><label class="collapse" for="c-37131675">[-]</label><label class="expand" for="c-37131675">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, with this I&#x27;m a bit unsure if using coroutines in Kotlin will be worth it?<p>Coroutines will probably benefit from Loom, but will it be worth writing stuff using coroutines vs just using fibers&#x2F;loom and write it the &quot;old&quot; way? Or are there other benefits to be had with coroutines?</div><br/></div></div></div></div><div id="37131487" class="c"><input type="checkbox" id="c-37131487" checked=""/><div class="controls bullet"><span class="by">nvm0n2</span><span>|</span><a href="#37131347">parent</a><span>|</span><a href="#37131535">prev</a><span>|</span><a href="#37131506">next</a><span>|</span><label class="collapse" for="c-37131487">[-]</label><label class="expand" for="c-37131487">[1 more]</label></div><br/><div class="children"><div class="content">Language-level coroutines derive no direct benefit from Loom but it also doesn&#x27;t hurt them. The benefit is you can just stop using those language features, or if you already have them in wide use, you can just wrap all your code in runBlocking{} and virtual threads. Also, no work is needed to start using virtual threads because they&#x27;re a library&#x2F;runtime feature not something a language has to support. One of the benefits of being a JVM language - free upgrades.<p>Exception: GUI code. Kotlin Coroutines is deeply integrated into Jetpack Compose. In theory parts of the framework are thread safe but it&#x27;s not well documented and all the examples &#x2F; tutorials want you to learn coroutines.</div><br/></div></div><div id="37131506" class="c"><input type="checkbox" id="c-37131506" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37131347">parent</a><span>|</span><a href="#37131487">prev</a><span>|</span><a href="#37131320">next</a><span>|</span><label class="collapse" for="c-37131506">[-]</label><label class="expand" for="c-37131506">[1 more]</label></div><br/><div class="children"><div class="content">Like any guest language, it is up to them to eventually adopt platform features, or not.</div><br/></div></div></div></div><div id="37131320" class="c"><input type="checkbox" id="c-37131320" checked=""/><div class="controls bullet"><span class="by">tomaytotomato</span><span>|</span><a href="#37131347">prev</a><span>|</span><a href="#37131208">next</a><span>|</span><label class="collapse" for="c-37131320">[-]</label><label class="expand" for="c-37131320">[1 more]</label></div><br/><div class="children"><div class="content">Nice, Project Loom is often summarised as just incorporating the main feature of Virtual Threads however it will also add a whole bunch of other features or improvements for doing tasks concurrently and not having to worry about blocking IO or race conditions like you would have in the past.<p>Some useful code examples are here to play around with <a href="https:&#x2F;&#x2F;github.com&#x2F;nipafx&#x2F;loom-lab">https:&#x2F;&#x2F;github.com&#x2F;nipafx&#x2F;loom-lab</a></div><br/></div></div><div id="37131208" class="c"><input type="checkbox" id="c-37131208" checked=""/><div class="controls bullet"><span class="by">deutschepost</span><span>|</span><a href="#37131320">prev</a><span>|</span><a href="#37131353">next</a><span>|</span><label class="collapse" for="c-37131208">[-]</label><label class="expand" for="c-37131208">[1 more]</label></div><br/><div class="children"><div class="content">At first I misread and wondered what Project Loon[1] could possibly contribute to JDK 21.<p>[1]<a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Loon_LLC" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Loon_LLC</a></div><br/></div></div><div id="37131353" class="c"><input type="checkbox" id="c-37131353" checked=""/><div class="controls bullet"><span class="by">spullara</span><span>|</span><a href="#37131208">prev</a><span>|</span><a href="#37130931">next</a><span>|</span><label class="collapse" for="c-37131353">[-]</label><label class="expand" for="c-37131353">[2 more]</label></div><br/><div class="children"><div class="content">Basically you ignore a bunch of the work done for async, callbaks, etc and go back to making a new &quot;thread&quot; and handling a request.</div><br/><div id="37131576" class="c"><input type="checkbox" id="c-37131576" checked=""/><div class="controls bullet"><span class="by">gonzo41</span><span>|</span><a href="#37131353">parent</a><span>|</span><a href="#37130931">next</a><span>|</span><label class="collapse" for="c-37131576">[-]</label><label class="expand" for="c-37131576">[1 more]</label></div><br/><div class="children"><div class="content">I got off the java train at 8. 21 seems like a good place to get back on.</div><br/></div></div></div></div><div id="37130931" class="c"><input type="checkbox" id="c-37130931" checked=""/><div class="controls bullet"><span class="by">zackees</span><span>|</span><a href="#37131353">prev</a><span>|</span><a href="#37131366">next</a><span>|</span><label class="collapse" for="c-37130931">[-]</label><label class="expand" for="c-37130931">[1 more]</label></div><br/><div class="children"><div class="content">Aka green threads.</div><br/></div></div><div id="37131366" class="c"><input type="checkbox" id="c-37131366" checked=""/><div class="controls bullet"><span class="by">mgaunard</span><span>|</span><a href="#37130931">prev</a><span>|</span><label class="collapse" for="c-37131366">[-]</label><label class="expand" for="c-37131366">[6 more]</label></div><br/><div class="children"><div class="content">People still use Java?</div><br/><div id="37131531" class="c"><input type="checkbox" id="c-37131531" checked=""/><div class="controls bullet"><span class="by">asien</span><span>|</span><a href="#37131366">parent</a><span>|</span><a href="#37131522">next</a><span>|</span><label class="collapse" for="c-37131531">[-]</label><label class="expand" for="c-37131531">[1 more]</label></div><br/><div class="children"><div class="content">&gt; People still use Java?<p>In Fortune 500 ? YES , pretty much everywhere.<p>In Startups ? It&#x27;s Kotlin or Scala mostly.<p>JVM is far from being unpopular , but fore sure it&#x27;s not as sexy as [&#x27;React&#x27;,&#x27;Deno&#x27;].push(...)</div><br/></div></div><div id="37131522" class="c"><input type="checkbox" id="c-37131522" checked=""/><div class="controls bullet"><span class="by">kaba0</span><span>|</span><a href="#37131366">parent</a><span>|</span><a href="#37131531">prev</a><span>|</span><a href="#37131443">next</a><span>|</span><label class="collapse" for="c-37131522">[-]</label><label class="expand" for="c-37131522">[1 more]</label></div><br/><div class="children"><div class="content">As it is continuously in the top 3 most popular languages, yes.</div><br/></div></div><div id="37131443" class="c"><input type="checkbox" id="c-37131443" checked=""/><div class="controls bullet"><span class="by">misja111</span><span>|</span><a href="#37131366">parent</a><span>|</span><a href="#37131522">prev</a><span>|</span><a href="#37131390">next</a><span>|</span><label class="collapse" for="c-37131443">[-]</label><label class="expand" for="c-37131443">[1 more]</label></div><br/><div class="children"><div class="content">You wouldn&#x27;t say so if you only read HN</div><br/></div></div><div id="37131390" class="c"><input type="checkbox" id="c-37131390" checked=""/><div class="controls bullet"><span class="by">Rebelgecko</span><span>|</span><a href="#37131366">parent</a><span>|</span><a href="#37131443">prev</a><span>|</span><a href="#37131478">next</a><span>|</span><label class="collapse" for="c-37131390">[-]</label><label class="expand" for="c-37131390">[1 more]</label></div><br/><div class="children"><div class="content">Yes, it&#x27;s a fairly popular language</div><br/></div></div><div id="37131478" class="c"><input type="checkbox" id="c-37131478" checked=""/><div class="controls bullet"><span class="by">re-thc</span><span>|</span><a href="#37131366">parent</a><span>|</span><a href="#37131390">prev</a><span>|</span><label class="collapse" for="c-37131478">[-]</label><label class="expand" for="c-37131478">[1 more]</label></div><br/><div class="children"><div class="content">Companies do</div><br/></div></div></div></div></div></div></div></div></div></body></html>