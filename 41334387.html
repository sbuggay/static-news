<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1724490066257" as="style"/><link rel="stylesheet" href="styles.css?v=1724490066257"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://rosszurowski.com/log/2022/makefiles">Makefiles for Web Work (2022)</a> <span class="domain">(<a href="https://rosszurowski.com">rosszurowski.com</a>)</span></div><div class="subtext"><span>crcastle</span> | <span>9 comments</span></div><br/><div><div id="41336463" class="c"><input type="checkbox" id="c-41336463" checked=""/><div class="controls bullet"><span class="by">augusto-moura</span><span>|</span><a href="#41336432">next</a><span>|</span><label class="collapse" for="c-41336463">[-]</label><label class="expand" for="c-41336463">[3 more]</label></div><br/><div class="children"><div class="content">The problem that I find with Makefiles, in Node projects, is that node scripts and tools are pretty slow to startup and pretty much all of them have some run-on-all-files type of setup<p>So, for example, instead of running the typescript compiler for a single file<p><pre><code>  tsc src&#x2F;index.ts
</code></pre>
You are better suited to run the compiler to the whole repository:<p><pre><code>  tsc --build .&#x2F;tsconfig.json
</code></pre>
Which implements incremental building and dependency tracking automatically.<p>For this case having make run tsc for each file individually hurts performance pretty bad. Something like this will not scale very well:<p><pre><code>  src&#x2F;%.js: src&#x2F;%.ts
    tsc $&lt;
</code></pre>
There&#x27;s definitely a overlap where each JS tool implements its own incremental building, cache system and dependency resolver. Eslint, prettier, npm, webpack could all benefit from being more Unixy and forwarding the task management to a tool to rule them all.<p>Things are changing though, and tools like swc and esbuild are getting pretty fast. And there a few attempts for an universal build system on NX and TurboRepo. My dream scenario is where we get a single command interface, similar to gradle or bazel, where you just run `tool build` and everything gets setup for you without fuzz</div><br/><div id="41336517" class="c"><input type="checkbox" id="c-41336517" checked=""/><div class="controls bullet"><span class="by">pushupentry1219</span><span>|</span><a href="#41336463">parent</a><span>|</span><a href="#41336432">next</a><span>|</span><label class="collapse" for="c-41336517">[-]</label><label class="expand" for="c-41336517">[2 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t read the article yet but why not make a PHONY target that just runs that build command?<p><pre><code>    .PHONY all
    all:
        tsc --build .&#x2F;tsconfig.json</code></pre></div><br/><div id="41336586" class="c"><input type="checkbox" id="c-41336586" checked=""/><div class="controls bullet"><span class="by">augusto-moura</span><span>|</span><a href="#41336463">root</a><span>|</span><a href="#41336517">parent</a><span>|</span><a href="#41336432">next</a><span>|</span><label class="collapse" for="c-41336586">[-]</label><label class="expand" for="c-41336586">[1 more]</label></div><br/><div class="children"><div class="content">You could, but the you lose most of make&#x27;s benefits, this way you are only using make as a script bundle. Looking back now it does align with what the article is proposing. But I still a bit annoyed that we don&#x27;t get proper use of Makefiles, and that we need to reinvent incremental building for every tool</div><br/></div></div></div></div></div></div><div id="41336432" class="c"><input type="checkbox" id="c-41336432" checked=""/><div class="controls bullet"><span class="by">throw156754228</span><span>|</span><a href="#41336463">prev</a><span>|</span><a href="#41336251">next</a><span>|</span><label class="collapse" for="c-41336432">[-]</label><label class="expand" for="c-41336432">[1 more]</label></div><br/><div class="children"><div class="content">I like this, package.json starts to look really ugly when you build up lots of scripts that need to run interdependently. For example some stubbed back ends, front end, some auth service, etc. You end up with ugly long npm scripts with &amp;&amp;s everywhere. However for this sort of thing, personally I&#x27;d rather use docker compose, dependencies are explicit and declarative, like this I guess. You can define 
health checks for services with docker compose too.</div><br/></div></div><div id="41336251" class="c"><input type="checkbox" id="c-41336251" checked=""/><div class="controls bullet"><span class="by">muratsu</span><span>|</span><a href="#41336432">prev</a><span>|</span><a href="#41336198">next</a><span>|</span><label class="collapse" for="c-41336251">[-]</label><label class="expand" for="c-41336251">[3 more]</label></div><br/><div class="children"><div class="content">I like make but I don’t understand the logic here. If you’re going to install node anyway, why be so against using node for scripts? Perhaps less of an issue these days but make also isnt included in windows.</div><br/><div id="41336598" class="c"><input type="checkbox" id="c-41336598" checked=""/><div class="controls bullet"><span class="by">JodieBenitez</span><span>|</span><a href="#41336251">parent</a><span>|</span><a href="#41336356">next</a><span>|</span><label class="collapse" for="c-41336598">[-]</label><label class="expand" for="c-41336598">[1 more]</label></div><br/><div class="children"><div class="content">The article makes this pretty clear. Some of us work simultaneously in different stacks: js, python, php, go, whatever... each and every one having their own dependency&#x2F;building tools. Having a consistent DX (make this, make that) across all projects has value.</div><br/></div></div><div id="41336356" class="c"><input type="checkbox" id="c-41336356" checked=""/><div class="controls bullet"><span class="by">unwind</span><span>|</span><a href="#41336251">parent</a><span>|</span><a href="#41336598">prev</a><span>|</span><a href="#41336198">next</a><span>|</span><label class="collapse" for="c-41336356">[-]</label><label class="expand" for="c-41336356">[1 more]</label></div><br/><div class="children"><div class="content">One reason the article points out is to make the developer experience &quot;portable&quot; between projects regardless of underlying technology platform&#x2F;framework.<p>That is not necessarily something everone agrees with (&quot;when in Rome&quot; etc) but it is a reason.</div><br/></div></div></div></div></div></div></div></div></div></body></html>