<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719306050237" as="style"/><link rel="stylesheet" href="styles.css?v=1719306050237"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://xeiaso.net/blog/2024/fixing-rss-mailcap/">MIME, RSS, and Existential Torment</a> <span class="domain">(<a href="https://xeiaso.net">xeiaso.net</a>)</span></div><div class="subtext"><span>xena</span> | <span>22 comments</span></div><br/><div><div id="40782373" class="c"><input type="checkbox" id="c-40782373" checked=""/><div class="controls bullet"><span class="by">egypturnash</span><span>|</span><a href="#40783133">next</a><span>|</span><label class="collapse" for="c-40782373">[-]</label><label class="expand" for="c-40782373">[13 more]</label></div><br/><div class="children"><div class="content">&gt; One of the weirdest things my website does is that it serves everything from a .zip file<p><i>whyyyyyyy</i><p>why would you <i>do</i> this to yourself<p>It looks like you&#x27;re still pushing a bunch of stuff over with git so it&#x27;s not like you&#x27;re making it easier to just ftp over one file or something, whyyyyyyy</div><br/><div id="40784812" class="c"><input type="checkbox" id="c-40784812" checked=""/><div class="controls bullet"><span class="by">TeMPOraL</span><span>|</span><a href="#40782373">parent</a><span>|</span><a href="#40782434">next</a><span>|</span><label class="collapse" for="c-40784812">[-]</label><label class="expand" for="c-40784812">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>why would you do this to yourself</i><p>Why not? It&#x27;s not <i>that</i> bad of an idea. I mean, of course they should&#x27;ve used SQLite instead of ZIP as the container, but... ;).<p>There&#x27;s a turn-key solution for this too: <a href="https:&#x2F;&#x2F;redbean.dev&#x2F;" rel="nofollow">https:&#x2F;&#x2F;redbean.dev&#x2F;</a>. See also, <a href="https:&#x2F;&#x2F;justine.lol&#x2F;redbean2&#x2F;" rel="nofollow">https:&#x2F;&#x2F;justine.lol&#x2F;redbean2&#x2F;</a>.</div><br/></div></div><div id="40782434" class="c"><input type="checkbox" id="c-40782434" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#40782373">parent</a><span>|</span><a href="#40784812">prev</a><span>|</span><a href="#40785254">next</a><span>|</span><label class="collapse" for="c-40782434">[-]</label><label class="expand" for="c-40782434">[8 more]</label></div><br/><div class="children"><div class="content">My website binary builds the static site on every commit to the repo. This putting things in a zipfile strategy is probably a bad idea, but it makes it easy for the preview site to handle: <a href="https:&#x2F;&#x2F;xeiaso.net&#x2F;blog&#x2F;2024&#x2F;overengineering-preview-site&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xeiaso.net&#x2F;blog&#x2F;2024&#x2F;overengineering-preview-site&#x2F;</a></div><br/><div id="40784054" class="c"><input type="checkbox" id="c-40784054" checked=""/><div class="controls bullet"><span class="by">egypturnash</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782434">parent</a><span>|</span><a href="#40782461">next</a><span>|</span><label class="collapse" for="c-40784054">[-]</label><label class="expand" for="c-40784054">[2 more]</label></div><br/><div class="children"><div class="content"><i>boggles</i><p>From the perspective of someone whose site is a 12-year-old Wordpress installation on cheap hosting that she only does anything technical to when it&#x27;s time to make a custom template for a new multi-year comics project, your website is a <i>shimmering fractal of terrible ideas</i>. Assembling a list of posts can be done with <i>so</i> much less work than this hyper-complicated machine you&#x27;ve made.<p>But then again a glance at your resume suggests you&#x27;re probably making at <i>least</i> two orders of magnitude more money off of fooling around with tools for making enormously complicated websites than my broke ass is making off of drawing comics and furry porn, so what do I know? You&#x27;ve probably solved some big problems at work super fast because of dealing with the toy problems you&#x27;ve created for yourself with this Rube Goldberg machine of a website.</div><br/><div id="40784694" class="c"><input type="checkbox" id="c-40784694" checked=""/><div class="controls bullet"><span class="by">hiAndrewQuinn</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40784054">parent</a><span>|</span><a href="#40782461">next</a><span>|</span><label class="collapse" for="c-40784694">[-]</label><label class="expand" for="c-40784694">[1 more]</label></div><br/><div class="children"><div class="content">Xe&#x27;s site feels more like a <i>kinetic playground</i>, constantly adding wild new inventions, than a shimmering fractal of bad ideas to me.<p>This is where the niche excellence is first built which later, almost by accident, drives enormous amounts of business value when put into the right place. I totally get it. There is machine empathy you simply cannot build any other way.</div><br/></div></div></div></div><div id="40782461" class="c"><input type="checkbox" id="c-40782461" checked=""/><div class="controls bullet"><span class="by">peter_l_downs</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782434">parent</a><span>|</span><a href="#40784054">prev</a><span>|</span><a href="#40785254">next</a><span>|</span><label class="collapse" for="c-40782461">[-]</label><label class="expand" for="c-40782461">[5 more]</label></div><br/><div class="children"><div class="content">Maybe I missed it, but why are you embedding a zipfile of gzip streams rather than just embedding the static site&#x27;s files with an `embed.FS` and serving from that?</div><br/><div id="40782480" class="c"><input type="checkbox" id="c-40782480" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782461">parent</a><span>|</span><a href="#40785254">next</a><span>|</span><label class="collapse" for="c-40782480">[-]</label><label class="expand" for="c-40782480">[4 more]</label></div><br/><div class="children"><div class="content">That way I don&#x27;t have to rebuild the binary to update the website. This makes posting new articles take tens of seconds at most.</div><br/><div id="40783615" class="c"><input type="checkbox" id="c-40783615" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782480">parent</a><span>|</span><a href="#40782535">next</a><span>|</span><label class="collapse" for="c-40783615">[-]</label><label class="expand" for="c-40783615">[1 more]</label></div><br/><div class="children"><div class="content">I wonder what compression gains, are you serving the gziped version directly based on Accept-Encoding headers to avoid a decompression and compression? If not it would be possible to just use Store[1] to use the zip as a container format but not a compression format.<p>[1]: <a href="https:&#x2F;&#x2F;pkg.go.dev&#x2F;archive&#x2F;zip#Store" rel="nofollow">https:&#x2F;&#x2F;pkg.go.dev&#x2F;archive&#x2F;zip#Store</a></div><br/></div></div><div id="40782535" class="c"><input type="checkbox" id="c-40782535" checked=""/><div class="controls bullet"><span class="by">peter_l_downs</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782480">parent</a><span>|</span><a href="#40783615">prev</a><span>|</span><a href="#40785254">next</a><span>|</span><label class="collapse" for="c-40782535">[-]</label><label class="expand" for="c-40782535">[2 more]</label></div><br/><div class="children"><div class="content">Makes sense, thanks for answering.<p>Aside — the architecture diagrams on <a href="https:&#x2F;&#x2F;xeiaso.net&#x2F;blog&#x2F;xesite-v4&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xeiaso.net&#x2F;blog&#x2F;xesite-v4&#x2F;</a> are not displaying in-browser for me, but do transfer correctly and are viewable on my computer. Maybe another mime issue, as the network inspector shows them being transferred with type &quot;octet-stream&quot;?<p>Repro by visiting the URL in latest Firefox, Safari, or Chrome.</div><br/><div id="40782606" class="c"><input type="checkbox" id="c-40782606" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#40782373">root</a><span>|</span><a href="#40782535">parent</a><span>|</span><a href="#40785254">next</a><span>|</span><label class="collapse" for="c-40782606">[-]</label><label class="expand" for="c-40782606">[1 more]</label></div><br/><div class="children"><div class="content">This is something I&#x27;m aware of and need to fix when I have the time. Just need to figure out how to best write this migration. I know exactly what I need to do, just gotta write code to do it.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40785254" class="c"><input type="checkbox" id="c-40785254" checked=""/><div class="controls bullet"><span class="by">frontalier</span><span>|</span><a href="#40782373">parent</a><span>|</span><a href="#40782434">prev</a><span>|</span><a href="#40783625">next</a><span>|</span><label class="collapse" for="c-40785254">[-]</label><label class="expand" for="c-40785254">[1 more]</label></div><br/><div class="children"><div class="content">why port doom on a dishwasher?<p>why create brainfuck?<p>why encode the matrix movie into an ascii stream?</div><br/></div></div><div id="40783234" class="c"><input type="checkbox" id="c-40783234" checked=""/><div class="controls bullet"><span class="by">est</span><span>|</span><a href="#40782373">parent</a><span>|</span><a href="#40783625">prev</a><span>|</span><a href="#40783133">next</a><span>|</span><label class="collapse" for="c-40783234">[-]</label><label class="expand" for="c-40783234">[1 more]</label></div><br/><div class="children"><div class="content">&gt; serves everything from a .gzip file<p>Could this make you feel better?</div><br/></div></div></div></div><div id="40783133" class="c"><input type="checkbox" id="c-40783133" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#40782373">prev</a><span>|</span><a href="#40782835">next</a><span>|</span><label class="collapse" for="c-40783133">[-]</label><label class="expand" for="c-40783133">[1 more]</label></div><br/><div class="children"><div class="content">This is fixable with a small patch, which implements enough seek to work with http.<p><pre><code>    func (r *checksumReader) Seek(offset int64, whence int) (int64, error) {
        if whence == io.SeekEnd {
                return int64(r.f.FileHeader.UncompressedSize), nil
        }
        r2, _ := r.f.Open()
        rr := r2.(*checksumReader)
        *r = *rr
        return 0, nil
    }</code></pre></div><br/></div></div><div id="40782835" class="c"><input type="checkbox" id="c-40782835" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#40783133">prev</a><span>|</span><a href="#40783097">next</a><span>|</span><label class="collapse" for="c-40782835">[-]</label><label class="expand" for="c-40782835">[1 more]</label></div><br/><div class="children"><div class="content">Another issue is that without seek support, the HTTP server can&#x27;t implement range requests.<p>Interesting comment by Russ Cox about this: <a href="https:&#x2F;&#x2F;github.com&#x2F;golang&#x2F;go&#x2F;issues&#x2F;61791#issuecomment-1671917758">https:&#x2F;&#x2F;github.com&#x2F;golang&#x2F;go&#x2F;issues&#x2F;61791#issuecomment-16719...</a></div><br/></div></div><div id="40783097" class="c"><input type="checkbox" id="c-40783097" checked=""/><div class="controls bullet"><span class="by">kdbg</span><span>|</span><a href="#40782835">prev</a><span>|</span><a href="#40785927">next</a><span>|</span><label class="collapse" for="c-40783097">[-]</label><label class="expand" for="c-40783097">[1 more]</label></div><br/><div class="children"><div class="content">Reminds me a little of a stored XSS I read about last year.<p><a href="https:&#x2F;&#x2F;tttang-com.translate.goog&#x2F;archive&#x2F;1880&#x2F;?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=en&amp;_x_tr_pto=wapp" rel="nofollow">https:&#x2F;&#x2F;tttang-com.translate.goog&#x2F;archive&#x2F;1880&#x2F;?_x_tr_sl=aut...</a><p>Had that same root of not having the mime.types in the container, leading to server-side sniffing of the mime type for the Content-Type header.<p>It&#x27;s just a bit interesting the impact such a file can have</div><br/></div></div><div id="40785927" class="c"><input type="checkbox" id="c-40785927" checked=""/><div class="controls bullet"><span class="by">ccvccu</span><span>|</span><a href="#40783097">prev</a><span>|</span><a href="#40781905">next</a><span>|</span><label class="collapse" for="c-40785927">[-]</label><label class="expand" for="c-40785927">[2 more]</label></div><br/><div class="children"><div class="content">Why is his site full of cartoon children saying things? It&#x27;s a bit off-putting and, to be honest, a bit of a red flag.</div><br/><div id="40786084" class="c"><input type="checkbox" id="c-40786084" checked=""/><div class="controls bullet"><span class="by">Vecr</span><span>|</span><a href="#40785927">parent</a><span>|</span><a href="#40781905">next</a><span>|</span><label class="collapse" for="c-40786084">[-]</label><label class="expand" for="c-40786084">[1 more]</label></div><br/><div class="children"><div class="content">Those aren&#x27;t children&#x27;s cartoons. I mean, maybe they are, but think more Zootopia squished into weird Dilbert.</div><br/></div></div></div></div><div id="40781905" class="c"><input type="checkbox" id="c-40781905" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#40785927">prev</a><span>|</span><a href="#40783068">next</a><span>|</span><label class="collapse" for="c-40781905">[-]</label><label class="expand" for="c-40781905">[1 more]</label></div><br/><div class="children"><div class="content">Languages do such a bad job at modeling the IO hierarchy ...<p>One minor point that should be relevant here: there are files that support `rewind` (`seek` at offset `0`) but no other seeking.</div><br/></div></div><div id="40783068" class="c"><input type="checkbox" id="c-40783068" checked=""/><div class="controls bullet"><span class="by">throwayaw84330</span><span>|</span><a href="#40781905">prev</a><span>|</span><a href="#40784455">next</a><span>|</span><label class="collapse" for="c-40783068">[-]</label><label class="expand" for="c-40783068">[1 more]</label></div><br/><div class="children"><div class="content">Things that happen when xe stopped to use NixOS</div><br/></div></div></div></div></div></div></div></body></html>