<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717578075940" as="style"/><link rel="stylesheet" href="styles.css?v=1717578075940"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://chrisdown.name/2018/01/02/in-defence-of-swap.html">In defence of swap: common misconceptions</a> <span class="domain">(<a href="https://chrisdown.name">chrisdown.name</a>)</span></div><div class="subtext"><span>ingve</span> | <span>65 comments</span></div><br/><div><div id="40582477" class="c"><input type="checkbox" id="c-40582477" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#40582814">next</a><span>|</span><label class="collapse" for="c-40582477">[-]</label><label class="expand" for="c-40582477">[4 more]</label></div><br/><div class="children"><div class="content">&gt; This means that, in general, vm.swappiness is simply a ratio of how costly reclaiming and refaulting anonymous memory is compared to file memory for your hardware and workload.<p>But I think this ignores the likelihood that I want this particular memory reclaimed. It is not equal for files and anon memory. At least on my systems, if anon memory is dirty, it&#x27;s because I did something with it, and if I haven&#x27;t freed it, that means I&#x27;m still working with it. But there&#x27;s all sorts of stuff that just kind of ends up in the disk cache, which I will never touch again. It is irrelevant to me that refaulting a swapped anon page is no slower than rereading a file, because the probability that the first will happen is so much greater than the second.<p>For all that systems try to guess about which pages are in use, or will be used again soon, I find they pretty much all get it wrong and as a result the system gets janky, and it&#x27;s best to simply weight keeping anon memory in core much higher. I expect disk access to be slow when I read a file. I do not expect ctrl-tab to be slow, ever.</div><br/><div id="40582596" class="c"><input type="checkbox" id="c-40582596" checked=""/><div class="controls bullet"><span class="by">Thorrez</span><span>|</span><a href="#40582477">parent</a><span>|</span><a href="#40582541">next</a><span>|</span><label class="collapse" for="c-40582596">[-]</label><label class="expand" for="c-40582596">[2 more]</label></div><br/><div class="children"><div class="content">&gt;I do not expect ctrl-tab to be slow, ever.<p>I think ctrl-tab might cause a disk read even without swap, because some&#x2F;all of the binary of the program you&#x27;re running might have been evicted from memory (backed by the program file, not swap) and need to get faulted back in when you hit ctrl-tab. The disk read might occur even without eviction, if that part of the program had never been read into memory yet.</div><br/><div id="40582761" class="c"><input type="checkbox" id="c-40582761" checked=""/><div class="controls bullet"><span class="by">mnw21cam</span><span>|</span><a href="#40582477">root</a><span>|</span><a href="#40582596">parent</a><span>|</span><a href="#40582541">next</a><span>|</span><label class="collapse" for="c-40582761">[-]</label><label class="expand" for="c-40582761">[1 more]</label></div><br/><div class="children"><div class="content">Yes.<p>Please realise that things that can be evicted from RAM include the code and static data for the programs you are running. If you switch off swap, then you are disqualifying stuff like data pages that a program will set up on process start and then never touch again, which is sometimes a distressingly large amount. That then uses up RAM that could be used to provide a more responsive system.<p>The ideal contents of swap are those data pages that are never going to be touched again. On a normally running system that doesn&#x27;t have massive memory pressure, that is basically all that will make it into swap, and that&#x27;s fine because those genuinely are pages that you won&#x27;t need, and they aren&#x27;t causing the problems with alt-tab.<p>What probably <i>is</i> causing the problems with alt-tab are one of two possibilities. Either the system is over-burdened and it is having to swap out large amounts of working set (to which the solution is to install more RAM or reduce the load, not switch off swap), or you have been transferring large amounts of data through RAM, causing the disc cache system to evict parts of a program you haven&#x27;t used for a long time in favour of these files that another program keeps loading in (and switching off swap won&#x27;t help much with that either, because the system is being quite happy to evict parts of that program that aren&#x27;t anonymous pages - a solution is to get the program that is handling lots of data to ask the OS kindly not to cache certain things, if it for instance knows that it will only load them once).<p>I do think that Linux&#x27;s behaviour has improved massively over the last 10 years or so. A lot of these myths about swap were created before the improvements, and we should stop believing them.</div><br/></div></div></div></div><div id="40582541" class="c"><input type="checkbox" id="c-40582541" checked=""/><div class="controls bullet"><span class="by">blauditore</span><span>|</span><a href="#40582477">parent</a><span>|</span><a href="#40582596">prev</a><span>|</span><a href="#40582814">next</a><span>|</span><label class="collapse" for="c-40582541">[-]</label><label class="expand" for="c-40582541">[1 more]</label></div><br/><div class="children"><div class="content">Do I understand correctly that a low swappiness basically also means higher priority of anon pages over disk caching, simply because the former uses more space and the latter &quot;runs out&quot; eventually?
I.e. low swappiness would achieve what you want, sort of?</div><br/></div></div></div></div><div id="40582814" class="c"><input type="checkbox" id="c-40582814" checked=""/><div class="controls bullet"><span class="by">stncls</span><span>|</span><a href="#40582477">prev</a><span>|</span><a href="#40582218">next</a><span>|</span><label class="collapse" for="c-40582814">[-]</label><label class="expand" for="c-40582814">[1 more]</label></div><br/><div class="children"><div class="content">The article is from 2018 and has had interesting discussion here before [1].<p>My conclusion is: In production, in a datacenter, when code is stable and compute-per-dollar efficiency matters? Yeah, sure, I can believe that swap makes sense.<p>On a dev machine? Not on mine for sure. If you think swap is a net positive on a dev machine, then try pasting the following (wrong) code in a terminal:<p><pre><code>  cat | cc -O3 -o crash_my_laptop &lt;&lt; EOF
  #include &lt;stdlib.h&gt;
  #include &lt;stdio.h&gt;
  #include &lt;string.h&gt;
  
  int main()
  {
    for (int i = 0; ; i++) {
      char *mem = malloc(1 &lt;&lt; 30);
      if (mem == NULL)
        return 0;
      memset(mem, 42, 1 &lt;&lt; 30);
      printf(&quot;%5zd GiB\n&quot;, i);
    }
  }
  EOF
  .&#x2F;crash_my_laptop
</code></pre>
We can discuss the results in a couple of hours, when you recover control of your machine.
(Note: with no swap and no z-ram, it crashes after 10 seconds; no side effects.)<p>[1]<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40582029">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40582029</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39650114">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39650114</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38263901">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38263901</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=31104126">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=31104126</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=29159755">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=29159755</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23455051">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23455051</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16145294">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16145294</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16109058">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16109058</a></div><br/></div></div><div id="40582218" class="c"><input type="checkbox" id="c-40582218" checked=""/><div class="controls bullet"><span class="by">patrakov</span><span>|</span><a href="#40582814">prev</a><span>|</span><a href="#40582324">next</a><span>|</span><label class="collapse" for="c-40582218">[-]</label><label class="expand" for="c-40582218">[9 more]</label></div><br/><div class="children"><div class="content">Swap is still actively harmful if placed on an unsuitable device.<p>A few days ago, I got a complaint about slow ops in a Ceph cluster, and one of the Ceph OSDs spent quite a visible amount of time in response to a simple &quot;ceph tell osd.13 ops&quot; query that is a natural first step when debugging slow ops. Upon investigation, it was found that one of the nodes had a significantly higher load average (50) vs others (14-18). In &quot;top&quot;, out of 256 GB of RAM that the node had, approximately 100 GB were cached and thus formally available, yet, out of 8 GB of swap, 6 GB were used, and kswapd consumed a non-negligible percentage of the CPU time.<p>The kernel is some 5.15.x Ubuntu kernel; the root disk (which also holds the swap file) is a cheap SATADOM, and SATADOMs, in general (yes I know there are exceptions), have miserable performance and low write endurance; I forgot to check SMART statistics but cannot exclude that the drive might have started failing. I did check the dmesg, though, and there were no I&#x2F;O errors.<p>The problem has been resolved by disabling the swap file. I should probably have set up swap on ZRAM instead, but a configuration without swap also works.</div><br/><div id="40582263" class="c"><input type="checkbox" id="c-40582263" checked=""/><div class="controls bullet"><span class="by">martinsnow</span><span>|</span><a href="#40582218">parent</a><span>|</span><a href="#40582599">next</a><span>|</span><label class="collapse" for="c-40582263">[-]</label><label class="expand" for="c-40582263">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a configuration issue on your part. You shouldn&#x27;t put SWAP on devices that has basically no throughput.</div><br/></div></div><div id="40582599" class="c"><input type="checkbox" id="c-40582599" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#40582218">parent</a><span>|</span><a href="#40582263">prev</a><span>|</span><a href="#40582555">next</a><span>|</span><label class="collapse" for="c-40582599">[-]</label><label class="expand" for="c-40582599">[1 more]</label></div><br/><div class="children"><div class="content">But why do you have only 8 gigs of swap?<p>the OSD&#x27;s main job is file serving, so you need to use as much ram as possible to act as virtual tiered storage (caveats apply) so having a large swap to hold useful but not often used bits of ram is really useful for performance.<p>Our file servers used to have ram+~30% as swap.</div><br/></div></div><div id="40582555" class="c"><input type="checkbox" id="c-40582555" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#40582218">parent</a><span>|</span><a href="#40582599">prev</a><span>|</span><a href="#40582592">next</a><span>|</span><label class="collapse" for="c-40582555">[-]</label><label class="expand" for="c-40582555">[5 more]</label></div><br/><div class="children"><div class="content">&gt; Swap is still actively harmful if placed on an unsuitable device.<p>Reading that, I just realized it could be done over the network - that would be impressively glacial. Should be a good laugh.<p>Heck, why not over a db9 null modem slip connection? Start a compile and send it off to the Long Now Foundation - set it up next to John Cage&#x27;s ASLSP organ.</div><br/><div id="40582802" class="c"><input type="checkbox" id="c-40582802" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40582218">root</a><span>|</span><a href="#40582555">parent</a><span>|</span><a href="#40582688">next</a><span>|</span><label class="collapse" for="c-40582802">[-]</label><label class="expand" for="c-40582802">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the vision of CXL :-)  To be fair, the network is very very fast.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Compute_Express_Link" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Compute_Express_Link</a></div><br/><div id="40582819" class="c"><input type="checkbox" id="c-40582819" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#40582218">root</a><span>|</span><a href="#40582802">parent</a><span>|</span><a href="#40582688">next</a><span>|</span><label class="collapse" for="c-40582819">[-]</label><label class="expand" for="c-40582819">[1 more]</label></div><br/><div class="children"><div class="content">Oh this is a special cluster interconnect.<p>Yes, those have always been impressive.</div><br/></div></div></div></div><div id="40582688" class="c"><input type="checkbox" id="c-40582688" checked=""/><div class="controls bullet"><span class="by">SSLy</span><span>|</span><a href="#40582218">root</a><span>|</span><a href="#40582555">parent</a><span>|</span><a href="#40582802">prev</a><span>|</span><a href="#40582592">next</a><span>|</span><label class="collapse" for="c-40582688">[-]</label><label class="expand" for="c-40582688">[2 more]</label></div><br/><div class="children"><div class="content">swap would be fast enough on NVMe-oF for anything not a DB, no?</div><br/><div id="40582769" class="c"><input type="checkbox" id="c-40582769" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#40582218">root</a><span>|</span><a href="#40582688">parent</a><span>|</span><a href="#40582592">next</a><span>|</span><label class="collapse" for="c-40582769">[-]</label><label class="expand" for="c-40582769">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d imagine latency matters more than throughout. Complicated disk operations over my 10Gb fiber network still sucks like it did over 10baseT 30 years ago. Maybe there&#x27;s smarter ways to set things up but NFS&#x2F;sshfs is still bogged down for me. 1&#x2F;5th - ~1&#x2F;100th depending on the application.<p>Also I don&#x27;t have fancy money. I was imagining the $20 gear on Amazon&#x2F;eBay. Maybe that&#x27;s my problem...</div><br/></div></div></div></div></div></div><div id="40582592" class="c"><input type="checkbox" id="c-40582592" checked=""/><div class="controls bullet"><span class="by">worthless-trash</span><span>|</span><a href="#40582218">parent</a><span>|</span><a href="#40582555">prev</a><span>|</span><a href="#40582324">next</a><span>|</span><label class="collapse" for="c-40582592">[-]</label><label class="expand" for="c-40582592">[1 more]</label></div><br/><div class="children"><div class="content">I just searched to see what Ceph reccomended, and here is the funny part:<p>--
Configuring the operating system with swap to provide additional virtual memory for daemons is not advised for modern systems. Doing may result in lower performance, and your Ceph cluster may well be happier with a daemon that crashes vs one that slows to a crawl.
--<p>If a single ceph node crashes and restarts, I assume that the cluster will pick up the slack and heal&#x2F;deal?</div><br/></div></div></div></div><div id="40582324" class="c"><input type="checkbox" id="c-40582324" checked=""/><div class="controls bullet"><span class="by">seppel</span><span>|</span><a href="#40582218">prev</a><span>|</span><a href="#40582264">next</a><span>|</span><label class="collapse" for="c-40582324">[-]</label><label class="expand" for="c-40582324">[29 more]</label></div><br/><div class="children"><div class="content">This reads like something from the 90s. Buy whatever you think you need as swap as &quot;more RAM&quot; and call it a day. I&#x27;m running my desktop Linux without swap since maybe 20 years, and I never had any of this &quot;pathological behaviour at near-OOM&quot; afterwards.<p>And I have time to think about better problems than &quot;You can achieve better swap behaviour under memory pressure and prevent thrashing by utilising memory.low and friends in cgroup v2.&quot;<p>The core problem with swap is that nowadays you need gigabytes of swap to actually make a difference (when you have 32GB of RAM, 1GB of swap is 1&#x2F;32 of a difference). And you certainly don&#x27;t want to system to swap in and out gigabytes of memory.</div><br/><div id="40582639" class="c"><input type="checkbox" id="c-40582639" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582797">next</a><span>|</span><label class="collapse" for="c-40582639">[-]</label><label class="expand" for="c-40582639">[3 more]</label></div><br/><div class="children"><div class="content">Given that the author works at a large company, that has millions of machines, and where any swap change has cost implications in the tens of millions pounds, I suspect the article is based on data, rather than vibes.<p>Swap is less critical now, and given that k8s has some pathological dislike of it (again I suspect based on vibes) I can see why people dont have it.<p>However when you are using close to 70% of your total ram, swap improves performance significantly. Also where I work, it also stop the OOM from killing my repo VFS layer when I&#x27;m compiling something.<p>&gt; The core problem with swap is that nowadays you need gigabytes of swap to actually make a difference<p>It was always the case. but then a TB of disk isn&#x27;t that expensive anymore.</div><br/><div id="40582701" class="c"><input type="checkbox" id="c-40582701" checked=""/><div class="controls bullet"><span class="by">seppel</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582639">parent</a><span>|</span><a href="#40582797">next</a><span>|</span><label class="collapse" for="c-40582701">[-]</label><label class="expand" for="c-40582701">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Given that the author works at a large company, that has millions of machines, and where any swap change has cost implications in the tens of millions pounds, I suspect the article is based on data, rather than vibes.<p>Yes, but the author is most likely optimizing for a metric that I don&#x27;t care so much in my per personal computer while dismissing metrics that I care about.<p>&gt; It was always the case. but then a TB of disk isn&#x27;t that expensive anymore.<p>But swapping out GB of RAM is expensive in terms of latency.</div><br/><div id="40582750" class="c"><input type="checkbox" id="c-40582750" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582701">parent</a><span>|</span><a href="#40582797">next</a><span>|</span><label class="collapse" for="c-40582750">[-]</label><label class="expand" for="c-40582750">[1 more]</label></div><br/><div class="children"><div class="content">but its rarely gb at the same time. Thats the point. Its a dumping ground for stuff thats not used very often. meaning that you can have a bigger VFS cache, which reduces latency</div><br/></div></div></div></div></div></div><div id="40582797" class="c"><input type="checkbox" id="c-40582797" checked=""/><div class="controls bullet"><span class="by">hejdufufjrj</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582639">prev</a><span>|</span><a href="#40582671">next</a><span>|</span><label class="collapse" for="c-40582797">[-]</label><label class="expand" for="c-40582797">[1 more]</label></div><br/><div class="children"><div class="content">Your on a desktop.<p>In a server environment you don&#x27;t have the luxury of running your 4 GB needing app on a 128 GB machine - that means you have overprovissioned and are paying a stupid tax.<p>A modern server aims to run as close as possible to 100% CPU and RAM usage.<p>In those cases you need swap to kick out rarely used memory (initialization, ...)</div><br/></div></div><div id="40582671" class="c"><input type="checkbox" id="c-40582671" checked=""/><div class="controls bullet"><span class="by">adrian_b</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582797">prev</a><span>|</span><a href="#40582360">next</a><span>|</span><label class="collapse" for="c-40582671">[-]</label><label class="expand" for="c-40582671">[1 more]</label></div><br/><div class="children"><div class="content">I have the same experience.<p>I have stopped using swap on any computers, laptops, desktops or servers, more than 2 decades ago.<p>At that time, removing the swap was definitely a great improvement (with the condition of having installed enough real memory in the computers; but even with insufficient memory it was much better to have a few processes killed instead of having an unusable computer that had to be forcefully rebooted, losing everything that had not been already saved).<p>Perhaps the handling of swap has been improved meanwhile and in certain unusual niche environments having swap might provide some benefits.<p>Nevertheless, I doubt very much that this is true. I have never seen any such case where swap could have been useful.<p>When there is enough memory, there should be no writes to the swap, because such writes can only diminish the performance, and in an unpredictable way, because they can trigger the SSD garbage collector. If there are no writes to the swap, there is no reason for it to exist. If there isn&#x27;t enough memory, the cheapest solution is to buy more memory, instead of trying to find a software workaround for that.<p>The memory pages that are not dirty can always be discarded by the operating system and read again later from the SSD if needed. No swap is needed for that.<p>Swap memory is certainly never needed in personal computers, outside of temporary use in certain exceptional situations, when one would be willing to run very slowly a program that does not fit in the memory, due to lack of access to a computer with more memory.<p>Swap could be useful only when configured in a great number of servers that run a well characterized workload, where one could make a trade-off between application performance and total memory cost.</div><br/></div></div><div id="40582360" class="c"><input type="checkbox" id="c-40582360" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582671">prev</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582360">[-]</label><label class="expand" for="c-40582360">[21 more]</label></div><br/><div class="children"><div class="content">&gt; And you certainly don&#x27;t want to system to swap in and out gigabytes of memory.<p>Why though?<p>Swapping 32GB of memory in and out of an NVMe SSD is much faster than swapping 1GB out of a spinning disk so I really don&#x27;t get that argument.</div><br/><div id="40582451" class="c"><input type="checkbox" id="c-40582451" checked=""/><div class="controls bullet"><span class="by">seppel</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582360">parent</a><span>|</span><a href="#40582392">next</a><span>|</span><label class="collapse" for="c-40582451">[-]</label><label class="expand" for="c-40582451">[6 more]</label></div><br/><div class="children"><div class="content">&gt; Swapping 32GB of memory in and out of an NVMe SSD is much faster than swapping 1GB out of a spinning disk so I really don&#x27;t get that argument.<p>This is true, but it still takes time. What kind of workload do you have where you swap out 32GB of RAM? If you are in this situation you almost certainly need to buy these additional 32GB of RAM.</div><br/><div id="40582504" class="c"><input type="checkbox" id="c-40582504" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582451">parent</a><span>|</span><a href="#40582500">next</a><span>|</span><label class="collapse" for="c-40582504">[-]</label><label class="expand" for="c-40582504">[2 more]</label></div><br/><div class="children"><div class="content">What if I don&#x27;t have no more free DIMM slots but I already have 1 TiB NVMe and I am fine with my workload being finished slightly (or even noticeably) slower as opposed to not being able to do at all?<p>As an example of such workload: a server, one of the many, that runs financial calculations from many web users. It&#x27;s fine for it to become somewhat slower: we&#x27;ll notice the performance degradation in the metrics and stop accepting new connections for a while. It is not fine for it to just die with OOM ― the users automatically will reconnect to other servers, leading to a sort of a thundering herd scenario.</div><br/><div id="40582710" class="c"><input type="checkbox" id="c-40582710" checked=""/><div class="controls bullet"><span class="by">seppel</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582504">parent</a><span>|</span><a href="#40582500">next</a><span>|</span><label class="collapse" for="c-40582710">[-]</label><label class="expand" for="c-40582710">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What if I don&#x27;t have no more free DIMM slots but I already have 1 TiB NVMe and I am fine with my workload being finished slightly (or even noticeably) slower as opposed to not being able to do at all?<p>Then you obviously have a workload where having swap make sense (and you could even add swap on the fly in such a case). But that is not typical at all.</div><br/></div></div></div></div><div id="40582500" class="c"><input type="checkbox" id="c-40582500" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582451">parent</a><span>|</span><a href="#40582504">prev</a><span>|</span><a href="#40582392">next</a><span>|</span><label class="collapse" for="c-40582500">[-]</label><label class="expand" for="c-40582500">[3 more]</label></div><br/><div class="children"><div class="content">On a desktop&#x2F;laptop, where most of the “used” RAM (browser tabs) isn&#x27;t actually used at once.</div><br/><div id="40582718" class="c"><input type="checkbox" id="c-40582718" checked=""/><div class="controls bullet"><span class="by">seppel</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582500">parent</a><span>|</span><a href="#40582392">next</a><span>|</span><label class="collapse" for="c-40582718">[-]</label><label class="expand" for="c-40582718">[2 more]</label></div><br/><div class="children"><div class="content">Firefox (and I guess Chrome as well) throws aways memory of unused tabs.</div><br/><div id="40582780" class="c"><input type="checkbox" id="c-40582780" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582718">parent</a><span>|</span><a href="#40582392">next</a><span>|</span><label class="collapse" for="c-40582780">[-]</label><label class="expand" for="c-40582780">[1 more]</label></div><br/><div class="children"><div class="content">You can&#x27;t do that in all situations, since they could have important state.</div><br/></div></div></div></div></div></div></div></div><div id="40582392" class="c"><input type="checkbox" id="c-40582392" checked=""/><div class="controls bullet"><span class="by">shakow</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582360">parent</a><span>|</span><a href="#40582451">prev</a><span>|</span><a href="#40582429">next</a><span>|</span><label class="collapse" for="c-40582392">[-]</label><label class="expand" for="c-40582392">[8 more]</label></div><br/><div class="children"><div class="content">But it is still more than an order of magnitude slower than RAM, and is harmful for the disk cells.<p>If you have enough money to provision NVMe and still swap multiple gigabytes, just get a 16GB RAM stick for $40.</div><br/><div id="40582491" class="c"><input type="checkbox" id="c-40582491" checked=""/><div class="controls bullet"><span class="by">Rinzler89</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582392">parent</a><span>|</span><a href="#40582422">next</a><span>|</span><label class="collapse" for="c-40582491">[-]</label><label class="expand" for="c-40582491">[3 more]</label></div><br/><div class="children"><div class="content"><i>&gt;just get a 16GB RAM stick for $40</i><p>Laptops come with soldered RAM now where upgrades are not possible. And most people use laptops nowadays instead of desktops.<p>Buying another laptop to double your ram just because you hit the swap once in a blue moon is kinda wasteful.</div><br/><div id="40582546" class="c"><input type="checkbox" id="c-40582546" checked=""/><div class="controls bullet"><span class="by">shakow</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582491">parent</a><span>|</span><a href="#40582422">next</a><span>|</span><label class="collapse" for="c-40582546">[-]</label><label class="expand" for="c-40582546">[2 more]</label></div><br/><div class="children"><div class="content">If you are frequently swapping out 32GB, a laptop is not the right tool for the job.</div><br/><div id="40582559" class="c"><input type="checkbox" id="c-40582559" checked=""/><div class="controls bullet"><span class="by">Rinzler89</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582546">parent</a><span>|</span><a href="#40582422">next</a><span>|</span><label class="collapse" for="c-40582559">[-]</label><label class="expand" for="c-40582559">[1 more]</label></div><br/><div class="children"><div class="content">Where did I say anything about swapping out entire 32GB? Why does everything need to be binary in this argument? As in you either swap 32GB or have swap disabled?<p>What if you from time to time you only swap a couple of GB? Isn&#x27;t that better than having your system completely lock up and need rebooting?</div><br/></div></div></div></div></div></div><div id="40582422" class="c"><input type="checkbox" id="c-40582422" checked=""/><div class="controls bullet"><span class="by">dale_glass</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582392">parent</a><span>|</span><a href="#40582491">prev</a><span>|</span><a href="#40582515">next</a><span>|</span><label class="collapse" for="c-40582422">[-]</label><label class="expand" for="c-40582422">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not that hard to max out system capacity on desktop boards. I&#x27;m using the maximum possible 128 GB RAM on my desktop.</div><br/></div></div><div id="40582515" class="c"><input type="checkbox" id="c-40582515" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582392">parent</a><span>|</span><a href="#40582422">prev</a><span>|</span><a href="#40582465">next</a><span>|</span><label class="collapse" for="c-40582515">[-]</label><label class="expand" for="c-40582515">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If you have enough money to provision NVMe and still swap multiple gigabytes, just get a 16GB RAM stick for $40.<p>Why should I pay $40 when I have way more than 16GB of free SSD storage on my computer already?!</div><br/><div id="40582538" class="c"><input type="checkbox" id="c-40582538" checked=""/><div class="controls bullet"><span class="by">shakow</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582515">parent</a><span>|</span><a href="#40582465">next</a><span>|</span><label class="collapse" for="c-40582538">[-]</label><label class="expand" for="c-40582538">[1 more]</label></div><br/><div class="children"><div class="content">Because:<p>&gt; it is still more than an order of magnitude slower than RAM, and is harmful for the disk cells.<p>I mean, if that&#x27;s not an issue for you, be my guest. But that&#x27;s not the global optimum.</div><br/></div></div></div></div><div id="40582465" class="c"><input type="checkbox" id="c-40582465" checked=""/><div class="controls bullet"><span class="by">teaearlgraycold</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582392">parent</a><span>|</span><a href="#40582515">prev</a><span>|</span><a href="#40582429">next</a><span>|</span><label class="collapse" for="c-40582465">[-]</label><label class="expand" for="c-40582465">[1 more]</label></div><br/><div class="children"><div class="content">NVMe is cheap in that I don’t really need everything I bought. But I use all of the RAM I have.</div><br/></div></div></div></div><div id="40582429" class="c"><input type="checkbox" id="c-40582429" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582360">parent</a><span>|</span><a href="#40582392">prev</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582429">[-]</label><label class="expand" for="c-40582429">[6 more]</label></div><br/><div class="children"><div class="content">SSD write endurance scares me more than running out of memory.</div><br/><div id="40582532" class="c"><input type="checkbox" id="c-40582532" checked=""/><div class="controls bullet"><span class="by">bmacho</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582429">parent</a><span>|</span><a href="#40582469">next</a><span>|</span><label class="collapse" for="c-40582532">[-]</label><label class="expand" for="c-40582532">[1 more]</label></div><br/><div class="children"><div class="content">Spend your 40$ on backups first, and not on more RAM</div><br/></div></div><div id="40582469" class="c"><input type="checkbox" id="c-40582469" checked=""/><div class="controls bullet"><span class="by">Rinzler89</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582429">parent</a><span>|</span><a href="#40582532">prev</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582469">[-]</label><label class="expand" for="c-40582469">[4 more]</label></div><br/><div class="children"><div class="content">Why? Have you actually looked at the numbers and did the math, or are you scared out of FUD and think the sky is falling every time write calls are made to the SSD?<p>I treat my 1TB SSD like a loaner and after doing the math, based on my write patterns in the last 2 years, the SSD should wear out in about ..<i>checks notes</i>.. 12 years. I&#x27;m a lot more likely to replace it 2-4 years though to upgrade to a bigger and faster model anyway.<p>Plus, all storage dies eventually, that&#x27;s why backups are important. You paid for it, you might as well make the most use of it while it lasts instead of trying to &quot;hypermile it&quot; since you won&#x27;t be leaving it as inheritance to your grandchildren.</div><br/><div id="40582508" class="c"><input type="checkbox" id="c-40582508" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582469">parent</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582508">[-]</label><label class="expand" for="c-40582508">[3 more]</label></div><br/><div class="children"><div class="content">You&#x27;re correct but I&#x27;m not sure it&#x27;s FUD though and more a legacy of the limitations of early SSDs, which were indeed quite vulnerable to wear.</div><br/><div id="40582512" class="c"><input type="checkbox" id="c-40582512" checked=""/><div class="controls bullet"><span class="by">Rinzler89</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582508">parent</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582512">[-]</label><label class="expand" for="c-40582512">[2 more]</label></div><br/><div class="children"><div class="content">But we don&#x27;t live in legacy times we live in present times. So is it too much to expect people on a tech forum to be at least a bit up to date on the present tech instead of regurgitating fears 10 years out of date?<p>If you&#x27;re wearing out your SSD life endurance in a few years, you have an issue.</div><br/><div id="40582521" class="c"><input type="checkbox" id="c-40582521" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#40582324">root</a><span>|</span><a href="#40582512">parent</a><span>|</span><a href="#40582496">next</a><span>|</span><label class="collapse" for="c-40582521">[-]</label><label class="expand" for="c-40582521">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not disputing that (hence the “You&#x27;re correct” at the beginning of my response), I&#x27;m just reacting to your mention of “FUD”.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40582496" class="c"><input type="checkbox" id="c-40582496" checked=""/><div class="controls bullet"><span class="by">moffkalast</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582360">prev</a><span>|</span><a href="#40582472">next</a><span>|</span><label class="collapse" for="c-40582496">[-]</label><label class="expand" for="c-40582496">[1 more]</label></div><br/><div class="children"><div class="content">Yeah the only reason I&#x27;ve ever needed swap was to compile chonk cpp packages on SBC systems that simply don&#x27;t have enough ram to load it all. With swap it works fine, otherwise the system just freezes entirely. Despite what OP claims, emergency memory is literally the only case I&#x27;ve ever had for it over the years. On desktop buying more ram is trivial.</div><br/></div></div><div id="40582472" class="c"><input type="checkbox" id="c-40582472" checked=""/><div class="controls bullet"><span class="by">raverbashing</span><span>|</span><a href="#40582324">parent</a><span>|</span><a href="#40582496">prev</a><span>|</span><a href="#40582264">next</a><span>|</span><label class="collapse" for="c-40582472">[-]</label><label class="expand" for="c-40582472">[1 more]</label></div><br/><div class="children"><div class="content">Yeah. Some of the reasons on that list are debatable<p>I think swap is useful as a <i>temporary</i> memory overflow area, but that&#x27;s it. Actually &quot;running relying on swap&quot; is harmful<p>Items 1 and 2 on the list sound like fiction. Item 4 sounds plausible (same for the Windows 9X series - sigh - where cache and swap would allegedly fight each other)</div><br/></div></div></div></div><div id="40582264" class="c"><input type="checkbox" id="c-40582264" checked=""/><div class="controls bullet"><span class="by">mixedbit</span><span>|</span><a href="#40582324">prev</a><span>|</span><a href="#40582471">next</a><span>|</span><label class="collapse" for="c-40582264">[-]</label><label class="expand" for="c-40582264">[3 more]</label></div><br/><div class="children"><div class="content">This is important knowledge. My past misconception was that without swap system will be more efficient, programs will be killed when running out of memory instead of inefficiently running on hard disk-backed memory. In reality, Linux becomes totally unresponsive when running out of memory on systems without swap. This is because instead of swapping the least used parts of memory, it frees RAM by removing from it executable program code and shared libraries, because these things can be re-read from disk.</div><br/><div id="40582818" class="c"><input type="checkbox" id="c-40582818" checked=""/><div class="controls bullet"><span class="by">kangda123</span><span>|</span><a href="#40582264">parent</a><span>|</span><a href="#40582774">next</a><span>|</span><label class="collapse" for="c-40582818">[-]</label><label class="expand" for="c-40582818">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if there&#x27;s knobs to fix that. One of the organizations I worked at had a very aggressive OOM killer.</div><br/></div></div><div id="40582774" class="c"><input type="checkbox" id="c-40582774" checked=""/><div class="controls bullet"><span class="by">adrian_b</span><span>|</span><a href="#40582264">parent</a><span>|</span><a href="#40582818">prev</a><span>|</span><a href="#40582471">next</a><span>|</span><label class="collapse" for="c-40582774">[-]</label><label class="expand" for="c-40582774">[1 more]</label></div><br/><div class="children"><div class="content">My experience is opposite.<p>Linux (long ago) always became unresponsive when running out of memory <i>with swap</i>. Removing the swap solved this problem and it remained perfectly responsive when running out of memory.<p>I have no longer used swap for many years, so I do not know the current behavior with swap, but I have seen out of memory cases on modern systems without swap and I have never seen again a case when the computer becomes unresponsive.</div><br/></div></div></div></div><div id="40582471" class="c"><input type="checkbox" id="c-40582471" checked=""/><div class="controls bullet"><span class="by">dale_glass</span><span>|</span><a href="#40582264">prev</a><span>|</span><a href="#40582371">next</a><span>|</span><label class="collapse" for="c-40582471">[-]</label><label class="expand" for="c-40582471">[1 more]</label></div><br/><div class="children"><div class="content">The problem isn&#x27;t really with swap, it&#x27;s that people try to use a very blunt instrument (disabling swap) to deal with with an ill-defined problem (thrashing and the system slowing down to a crawl).<p>There&#x27;s really no way to tune a system&#x27;s swap size for ideal responsiveness. You can have a 32GB RAM + 32GB swap system perform great, and a 32 GB + 8 GB system perform miserably.<p>The problem is the working set, which is an often hard to predict quantity dependent on runtime factors. You can swap out 30GB of unused junk to disk and have excellent performance, but if you&#x27;re constantly going through 33 GB of data on a 32 GB system, performance is going to be awful.<p>So really want you want to avoid this last case from hanging the system is to measure the system&#x27;s responsiveness and act in response to that, instead of going for trying to get rid of the swap file. You can do that with something like systemd-oomd, which starts killing stuff when things are starting to get slow rather than when some arbitrary usage number is reached.</div><br/></div></div><div id="40582371" class="c"><input type="checkbox" id="c-40582371" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#40582471">prev</a><span>|</span><a href="#40582548">next</a><span>|</span><label class="collapse" for="c-40582371">[-]</label><label class="expand" for="c-40582371">[3 more]</label></div><br/><div class="children"><div class="content">I have yet to see substantial swap usage outside of memory pressure scenario. Means the benefit is marginal. All processes seem to be reasonably optimized not to leave lots of not accessed memory around. Or they have sparse access pattern which is touching a lot of pages.</div><br/><div id="40582482" class="c"><input type="checkbox" id="c-40582482" checked=""/><div class="controls bullet"><span class="by">bjackman</span><span>|</span><a href="#40582371">parent</a><span>|</span><a href="#40582548">next</a><span>|</span><label class="collapse" for="c-40582482">[-]</label><label class="expand" for="c-40582482">[2 more]</label></div><br/><div class="children"><div class="content">I think you&#x27;re talking about your personal machines and this author is talking about data centres. If there&#x27;s never any memory pressure in your data centre you&#x27;re wasting money on RAM.</div><br/><div id="40582573" class="c"><input type="checkbox" id="c-40582573" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#40582371">root</a><span>|</span><a href="#40582482">parent</a><span>|</span><a href="#40582548">next</a><span>|</span><label class="collapse" for="c-40582573">[-]</label><label class="expand" for="c-40582573">[1 more]</label></div><br/><div class="children"><div class="content">The article does not mention anything like that. And even in DCs, overoptimizing the memory pressures carries the risk of latency spikes or worse.</div><br/></div></div></div></div></div></div><div id="40582548" class="c"><input type="checkbox" id="c-40582548" checked=""/><div class="controls bullet"><span class="by">mcc1ane</span><span>|</span><a href="#40582371">prev</a><span>|</span><a href="#40582628">next</a><span>|</span><label class="collapse" for="c-40582548">[-]</label><label class="expand" for="c-40582548">[1 more]</label></div><br/><div class="children"><div class="content">Previously<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16145294">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=16145294</a><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23455051">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23455051</a></div><br/></div></div><div id="40582628" class="c"><input type="checkbox" id="c-40582628" checked=""/><div class="controls bullet"><span class="by">radisb</span><span>|</span><a href="#40582548">prev</a><span>|</span><a href="#40582605">next</a><span>|</span><label class="collapse" for="c-40582628">[-]</label><label class="expand" for="c-40582628">[3 more]</label></div><br/><div class="children"><div class="content">Assuming that OP is correct in everything, it isn&#x27;t shown anywhere that swap must reside in persistent storage. It could be stored in RAM, couldn&#x27;t it? I mean you always have a fixed max amount of swap, so if it fits in memory , then why not put it in memory? But then why bother with swap?</div><br/><div id="40582810" class="c"><input type="checkbox" id="c-40582810" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40582628">parent</a><span>|</span><a href="#40582677">next</a><span>|</span><label class="collapse" for="c-40582810">[-]</label><label class="expand" for="c-40582810">[1 more]</label></div><br/><div class="children"><div class="content">It can be, that&#x27;s what zswap is all about.</div><br/></div></div><div id="40582677" class="c"><input type="checkbox" id="c-40582677" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#40582628">parent</a><span>|</span><a href="#40582810">prev</a><span>|</span><a href="#40582605">next</a><span>|</span><label class="collapse" for="c-40582677">[-]</label><label class="expand" for="c-40582677">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  then why not put it in memory? But then why bother with swap?<p>because ram is expensive compared to disk.<p>Ram is normally fixed compared to disk<p>by storing not-used but still needed pages on disk, allows for much greater performance with less resources. for example it allows a bigger VFS cache.</div><br/></div></div></div></div><div id="40582605" class="c"><input type="checkbox" id="c-40582605" checked=""/><div class="controls bullet"><span class="by">ranger207</span><span>|</span><a href="#40582628">prev</a><span>|</span><a href="#40582564">next</a><span>|</span><label class="collapse" for="c-40582605">[-]</label><label class="expand" for="c-40582605">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a desktop user, with most of my usage either being gaming or compiling. I don&#x27;t typically run into memory limits in either usecase. Given that I almost always have free RAM available, what does swapping to the disk do for me? I have free RAM; why not use it?</div><br/></div></div><div id="40582564" class="c"><input type="checkbox" id="c-40582564" checked=""/><div class="controls bullet"><span class="by">bmacho</span><span>|</span><a href="#40582605">prev</a><span>|</span><a href="#40582250">next</a><span>|</span><label class="collapse" for="c-40582564">[-]</label><label class="expand" for="c-40582564">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t get this article. Especially not the things about unreclaimable memory, and the <i>With swap</i> &#x2F; <i>Without swap</i> distinctions. It seems what OP is describing is just .. having more RAM.</div><br/></div></div><div id="40582250" class="c"><input type="checkbox" id="c-40582250" checked=""/><div class="controls bullet"><span class="by">drsopp</span><span>|</span><a href="#40582564">prev</a><span>|</span><a href="#40582256">next</a><span>|</span><label class="collapse" for="c-40582250">[-]</label><label class="expand" for="c-40582250">[4 more]</label></div><br/><div class="children"><div class="content">Swap is still mostly mysterious to me (and the article is mostly over my head). My current naïve understanding is that swap is slower memory, and a disk cache is faster disk. I remember back in the windows xp days moving the pagefile to a RAM disk. That significantly decreased latency (re)running programs. These days I disable swap in my 64GiB windows box and have temp files in a RAM disk mostly for security reasons.</div><br/><div id="40582413" class="c"><input type="checkbox" id="c-40582413" checked=""/><div class="controls bullet"><span class="by">22c</span><span>|</span><a href="#40582250">parent</a><span>|</span><a href="#40582409">next</a><span>|</span><label class="collapse" for="c-40582413">[-]</label><label class="expand" for="c-40582413">[1 more]</label></div><br/><div class="children"><div class="content">I think what many people forget is that applications can ask for a bunch of memory and then never do anything with it (or just do something with it once).<p>Imagine you want to write something down, so you ask me for a notebook. Now you start writing very slowly such that I can tell you&#x27;re not going to need more than one page of that notebook for quite a while.<p>I don&#x27;t want to take the notebook away from you because you&#x27;re fussy and you insist on having the entire notebook to yourself, but someone else comes along also wanting to write something down.<p>Me being the clever kernel that I am, decide to let you keep a &quot;virtual&quot; copy of your notebook, but really only the first page of it is &quot;real&quot; paper and I give the notebook to the next person who ALSO insists on having an entire notebook to write down a few words on a page.<p>I can now have 20 people all writing in their own &quot;virtual&quot; 100 page notebooks, while I really only have a single 100 page notebook to go around.<p>Only when the combined total of all needed pages REALLY hits 100 pages will I start to run into issues.</div><br/></div></div><div id="40582409" class="c"><input type="checkbox" id="c-40582409" checked=""/><div class="controls bullet"><span class="by">corysama</span><span>|</span><a href="#40582250">parent</a><span>|</span><a href="#40582413">prev</a><span>|</span><a href="#40582280">next</a><span>|</span><label class="collapse" for="c-40582409">[-]</label><label class="expand" for="c-40582409">[1 more]</label></div><br/><div class="children"><div class="content">“moving the pagefile to a RAM disk.” is a hacky way to emulate disabling swap :P<p>In an ideal world, swap would automagically move stuff that you are not likely use soon out of RAM even when you use poorly written programs that don’t do that explicitly. And, disk cache would automagically keep stuff in RAM that you are likely to need again soon even when using poorly written programs that don’t do that explicitly.<p>So, ideally, they work together to max the effectiveness of you RAM.</div><br/></div></div><div id="40582280" class="c"><input type="checkbox" id="c-40582280" checked=""/><div class="controls bullet"><span class="by">SunlitCat</span><span>|</span><a href="#40582250">parent</a><span>|</span><a href="#40582409">prev</a><span>|</span><a href="#40582256">next</a><span>|</span><label class="collapse" for="c-40582280">[-]</label><label class="expand" for="c-40582280">[1 more]</label></div><br/><div class="children"><div class="content">Wait? Moving the pagefile, which should cover large memory allocations (not necessarily large memory usage, just the allocation), to a Memory based disk. Well...that&#x27;s interesting, to say the least!</div><br/></div></div></div></div><div id="40582256" class="c"><input type="checkbox" id="c-40582256" checked=""/><div class="controls bullet"><span class="by">SunlitCat</span><span>|</span><a href="#40582250">prev</a><span>|</span><a href="#40582427">next</a><span>|</span><label class="collapse" for="c-40582256">[-]</label><label class="expand" for="c-40582256">[1 more]</label></div><br/><div class="children"><div class="content">Although for different reasons (and different talking points) it reminds me on the discussion about swap (virtual memory &#x2F; paging file) on windows (and all those &quot;great&quot; guides suggesting to set it to a fixed size or bluntly just to turn it off because &quot;no one needs it anyways&quot;).</div><br/></div></div><div id="40582427" class="c"><input type="checkbox" id="c-40582427" checked=""/><div class="controls bullet"><span class="by">beardyw</span><span>|</span><a href="#40582256">prev</a><span>|</span><a href="#40582340">next</a><span>|</span><label class="collapse" for="c-40582427">[-]</label><label class="expand" for="c-40582427">[1 more]</label></div><br/><div class="children"><div class="content">I found that helpful.</div><br/></div></div><div id="40582340" class="c"><input type="checkbox" id="c-40582340" checked=""/><div class="controls bullet"><span class="by">pizza234</span><span>|</span><a href="#40582427">prev</a><span>|</span><a href="#40582408">next</a><span>|</span><label class="collapse" for="c-40582340">[-]</label><label class="expand" for="c-40582340">[1 more]</label></div><br/><div class="children"><div class="content">Common fallacy in sysadmin:<p>- A user has a system with X RAM and Y swap. They buy Y RAM. If one compares (X RAM + Y swap) versus (X+Y RAM), it&#x27;s obvious that they don&#x27;t need swap anymore.<p>Thing is, the correct comparison is (X RAM + Y swap) versus (X+Y RAM + Z swap), where Z is a new amount of swap.</div><br/></div></div><div id="40582408" class="c"><input type="checkbox" id="c-40582408" checked=""/><div class="controls bullet"><span class="by">csande17</span><span>|</span><a href="#40582340">prev</a><span>|</span><label class="collapse" for="c-40582408">[-]</label><label class="expand" for="c-40582408">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t totally fair, but I often find it useful to think of modern OS performance engineering as basically working around the fact that every computer these days runs a hundred background processes that consume resources but don&#x27;t meaningfully contribute to the user experience. The bloatware problem, in other words.<p>It&#x27;s often infeasible to simply delete bloatware from a system. The kernel people don&#x27;t control what Ubuntu ships in userspace; auto-updates do need to happen eventually but are not top-priority at any particular moment; important stakeholders&#x27; careers often depend on being able to say lots of systems are running code they wrote; etc. So instead we devise increasingly elaborate ways to have bloatware processes technically still be &quot;running&quot; while minimizing their ability to do anything.<p>Under this model, the &quot;efficiency cores&quot; present on newer CPUs exist primarily so that the OS can schedule bloatware onto them, such that the <i>real</i> CPU cores are free to run the useful stuff. And swap frees up the bloatware&#x27;s RAM to use as more disk cache or whatever.</div><br/></div></div></div></div></div></div></div></body></html>