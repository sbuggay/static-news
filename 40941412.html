<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1720774863287" as="style"/><link rel="stylesheet" href="styles.css?v=1720774863287"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/aws/aws-secretsmanager-agent">AWS Secrets Manager Agent</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>plurby</span> | <span>18 comments</span></div><br/><div><div id="40942533" class="c"><input type="checkbox" id="c-40942533" checked=""/><div class="controls bullet"><span class="by">slaughtr</span><span>|</span><a href="#40942700">next</a><span>|</span><label class="collapse" for="c-40942533">[-]</label><label class="expand" for="c-40942533">[6 more]</label></div><br/><div class="children"><div class="content">This seems like quite a lot of setup and hassle for what could be handled some other way with less fuss, like chamber[0] or Doppler[1]. Heck, even the classic .env seems like a better choice in every way.<p>What are the advantages to a configuration like this? Seems the HTTP interface with non-encrypted cache and separate agent situation isn’t something secure enough to satisfy most companies these days.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;segmentio&#x2F;chamber">https:&#x2F;&#x2F;github.com&#x2F;segmentio&#x2F;chamber</a><p>[1] <a href="https:&#x2F;&#x2F;www.doppler.com&#x2F;">https:&#x2F;&#x2F;www.doppler.com&#x2F;</a></div><br/><div id="40942598" class="c"><input type="checkbox" id="c-40942598" checked=""/><div class="controls bullet"><span class="by">gurchik</span><span>|</span><a href="#40942533">parent</a><span>|</span><a href="#40943838">next</a><span>|</span><label class="collapse" for="c-40942598">[-]</label><label class="expand" for="c-40942598">[3 more]</label></div><br/><div class="children"><div class="content">I think the audience for this is someone who is already using AWS Secrets Manager, but wants to reduce their API usage (perhaps due to cost).<p>Chamber uses SSM Parameter Store, which for many cases is similar, but some people might have a preference for Secrets Manager. For example, a team might like the automatic RDS password rotation for Secrets Manager and decide to put everything there for consistency.<p>For Doppler, well maybe someone doesn&#x27;t want to pay for it, or they&#x27;d rather control access to their secrets via IAM instead of through a separate tool.</div><br/><div id="40942758" class="c"><input type="checkbox" id="c-40942758" checked=""/><div class="controls bullet"><span class="by">SamuelAdams</span><span>|</span><a href="#40942533">root</a><span>|</span><a href="#40942598">parent</a><span>|</span><a href="#40942722">next</a><span>|</span><label class="collapse" for="c-40942758">[-]</label><label class="expand" for="c-40942758">[1 more]</label></div><br/><div class="children"><div class="content">Yes, we use something similar for debugging lambdas locally. We use Dotnet, and this library:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;Kralizek&#x2F;AWSSecretsManagerConfigurationExtensions">https:&#x2F;&#x2F;github.com&#x2F;Kralizek&#x2F;AWSSecretsManagerConfigurationEx...</a><p>Normally Boto uses the current account context to get secrets, but if we run a lambda as a local build, it uses this library to pull secrets from the actual dev AWS account.<p>This makes it easier to onboard new developers, reduces problems of figuring out what secrets to get for each lambda, etc.<p>Also if secrets are rotated in dev, local stacks get them automatically.<p>I am curious to see if this tool is remarkably different.</div><br/></div></div><div id="40942722" class="c"><input type="checkbox" id="c-40942722" checked=""/><div class="controls bullet"><span class="by">drodgers</span><span>|</span><a href="#40942533">root</a><span>|</span><a href="#40942598">parent</a><span>|</span><a href="#40942758">prev</a><span>|</span><a href="#40943838">next</a><span>|</span><label class="collapse" for="c-40942722">[-]</label><label class="expand" for="c-40942722">[1 more]</label></div><br/><div class="children"><div class="content">Chamber can also use S3 + KMS as a backend, which reduces the API costs to ~0 and massively improves the scalability (since SSM has annoyingly low rate limits, or at least it did a few years ago when we last tried it).</div><br/></div></div></div></div><div id="40943838" class="c"><input type="checkbox" id="c-40943838" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#40942533">parent</a><span>|</span><a href="#40942598">prev</a><span>|</span><a href="#40942572">next</a><span>|</span><label class="collapse" for="c-40943838">[-]</label><label class="expand" for="c-40943838">[1 more]</label></div><br/><div class="children"><div class="content">I was going to say you can rotate secrets in secrets manager without redeploying all your services. But this caches the secrets so you&#x27;ll still get stale results for up to 5 minutes by default. Not sure what the point is then.</div><br/></div></div><div id="40942572" class="c"><input type="checkbox" id="c-40942572" checked=""/><div class="controls bullet"><span class="by">mac-chaffee</span><span>|</span><a href="#40942533">parent</a><span>|</span><a href="#40943838">prev</a><span>|</span><a href="#40942700">next</a><span>|</span><label class="collapse" for="c-40942572">[-]</label><label class="expand" for="c-40942572">[1 more]</label></div><br/><div class="children"><div class="content">The use-case seems to be intentionally narrow:<p>&gt; The Secrets Manager Agent provides compatibility for legacy applications that access secrets through an existing agent or that need caching for languages not supported through other solutions.</div><br/></div></div></div></div><div id="40942700" class="c"><input type="checkbox" id="c-40942700" checked=""/><div class="controls bullet"><span class="by">WatchDog</span><span>|</span><a href="#40942533">prev</a><span>|</span><a href="#40943468">next</a><span>|</span><label class="collapse" for="c-40942700">[-]</label><label class="expand" for="c-40942700">[7 more]</label></div><br/><div class="children"><div class="content">So the point of this is just to cache secrets, to avoid caching them in your app memory?<p>Seems like kinda a niche threat model, if your app is already compromised to the point where it&#x27;s secret cache can be read, it seems likely that the attacker could also pivot to just read from the cache, or use the instance credentials to read from secrets manager itself.</div><br/><div id="40943156" class="c"><input type="checkbox" id="c-40943156" checked=""/><div class="controls bullet"><span class="by">bruce343434</span><span>|</span><a href="#40942700">parent</a><span>|</span><a href="#40942751">next</a><span>|</span><label class="collapse" for="c-40943156">[-]</label><label class="expand" for="c-40943156">[5 more]</label></div><br/><div class="children"><div class="content">No, the point is to get sensitive data out of the env variables, which nowadays get stored in plaintext in an .env file or similar. This is a solution for storing and retrieving secrets using AWS credentials. Essentially an online password manager for your application.</div><br/><div id="40943229" class="c"><input type="checkbox" id="c-40943229" checked=""/><div class="controls bullet"><span class="by">kriops</span><span>|</span><a href="#40942700">root</a><span>|</span><a href="#40943156">parent</a><span>|</span><a href="#40942751">next</a><span>|</span><label class="collapse" for="c-40943229">[-]</label><label class="expand" for="c-40943229">[4 more]</label></div><br/><div class="children"><div class="content">What about the credentials used to access AWS credentials? I think there&#x27;s a good case for centralised credentials where they are shared across applications, though I would seriously question the need to share them across applications. But what you&#x27;re achieving here as far as I can tell is just making secret retrieval more convoluted (for both devs and hypothetical attackers). Not to beat the dead horse, but obscurity != security.</div><br/><div id="40943796" class="c"><input type="checkbox" id="c-40943796" checked=""/><div class="controls bullet"><span class="by">bruce343434</span><span>|</span><a href="#40942700">root</a><span>|</span><a href="#40943229">parent</a><span>|</span><a href="#40943440">next</a><span>|</span><label class="collapse" for="c-40943796">[-]</label><label class="expand" for="c-40943796">[1 more]</label></div><br/><div class="children"><div class="content">When you deploy your code to AWS lambda or EC2 the code can simply access the appropriate secret stores as dictated by the IAM policy. If you haven&#x27;t bought into AWS as a whole you&#x27;re right that there&#x27;s no good reason to use secret manager.</div><br/></div></div><div id="40943440" class="c"><input type="checkbox" id="c-40943440" checked=""/><div class="controls bullet"><span class="by">mixxit</span><span>|</span><a href="#40942700">root</a><span>|</span><a href="#40943229">parent</a><span>|</span><a href="#40943796">prev</a><span>|</span><a href="#40942751">next</a><span>|</span><label class="collapse" for="c-40943440">[-]</label><label class="expand" for="c-40943440">[2 more]</label></div><br/><div class="children"><div class="content">Ah that&#x27;s where we have the Credentials for AWS Credentials Service Agent<p>Just simply pass it a credential and it will provide you the necessary credentials to access the Credentials for AWS Credentials Service</div><br/><div id="40943813" class="c"><input type="checkbox" id="c-40943813" checked=""/><div class="controls bullet"><span class="by">bruce343434</span><span>|</span><a href="#40942700">root</a><span>|</span><a href="#40943440">parent</a><span>|</span><a href="#40942751">next</a><span>|</span><label class="collapse" for="c-40943813">[-]</label><label class="expand" for="c-40943813">[1 more]</label></div><br/><div class="children"><div class="content">What are you talking about dude? Maybe read up on IAM and swallow your snarky and sarcastic remark next time before you put your ignorance on display like this.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40943468" class="c"><input type="checkbox" id="c-40943468" checked=""/><div class="controls bullet"><span class="by">webprofusion</span><span>|</span><a href="#40942700">prev</a><span>|</span><a href="#40943010">next</a><span>|</span><label class="collapse" for="c-40943468">[-]</label><label class="expand" for="c-40943468">[1 more]</label></div><br/><div class="children"><div class="content">So a bit like Hashicorp Vault (in that it has a locally accessed secrets store) but backed by AWS Secrets Manager.</div><br/></div></div><div id="40943010" class="c"><input type="checkbox" id="c-40943010" checked=""/><div class="controls bullet"><span class="by">wrs</span><span>|</span><a href="#40943468">prev</a><span>|</span><a href="#40943619">next</a><span>|</span><label class="collapse" for="c-40943010">[-]</label><label class="expand" for="c-40943010">[1 more]</label></div><br/><div class="children"><div class="content">FYI, there is an AWS-provided Lambda layer similar in principle to this, also including access to Parameter Store.<p><a href="https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;compute&#x2F;using-the-aws-parameter-and-secrets-lambda-extension-to-cache-parameters-and-secrets&#x2F;" rel="nofollow">https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;compute&#x2F;using-the-aws-parameter...</a></div><br/></div></div><div id="40943619" class="c"><input type="checkbox" id="c-40943619" checked=""/><div class="controls bullet"><span class="by">Sparkyte</span><span>|</span><a href="#40943010">prev</a><span>|</span><a href="#40942587">next</a><span>|</span><label class="collapse" for="c-40943619">[-]</label><label class="expand" for="c-40943619">[1 more]</label></div><br/><div class="children"><div class="content">I got to use secrets manager a while back it was a breath of fresh air as it was all of those things you seeking in vault without all of the problems of it being hashicorp. No offense hashicorp. I rather blame AWS than a self-managed solution.</div><br/></div></div><div id="40942587" class="c"><input type="checkbox" id="c-40942587" checked=""/><div class="controls bullet"><span class="by">420official</span><span>|</span><a href="#40943619">prev</a><span>|</span><label class="collapse" for="c-40942587">[-]</label><label class="expand" for="c-40942587">[1 more]</label></div><br/><div class="children"><div class="content">This is really cool, I&#x27;ve been running something similar to simplify rotating database credentials for legacy projects.</div><br/></div></div></div></div></div></div></div></body></html>