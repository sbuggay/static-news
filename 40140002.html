<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1713949264676" as="style"/><link rel="stylesheet" href="styles.css?v=1713949264676"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/google/maxtext">Maxtext: A simple, performant and scalable Jax LLM</a>Â <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>zerojames</span> | <span>3 comments</span></div><br/><div><div id="40140784" class="c"><input type="checkbox" id="c-40140784" checked=""/><div class="controls bullet"><span class="by">arjvik</span><span>|</span><label class="collapse" for="c-40140784">[-]</label><label class="expand" for="c-40140784">[2 more]</label></div><br/><div class="children"><div class="content">What are people&#x27;s thoughts on how this compares to:<p>- EasyLM [1]
- Levanter [2]
- T5X [3]
- and more?<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;young-geng&#x2F;EasyLM">https:&#x2F;&#x2F;github.com&#x2F;young-geng&#x2F;EasyLM</a>
[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;stanford-crfm&#x2F;levanter">https:&#x2F;&#x2F;github.com&#x2F;stanford-crfm&#x2F;levanter</a>
[3]: <a href="https:&#x2F;&#x2F;github.com&#x2F;google-research&#x2F;t5x">https:&#x2F;&#x2F;github.com&#x2F;google-research&#x2F;t5x</a><p>Asking because I have worked extensively on training a large model on a TPU cluster, and started with Levanter, then tried MaxText, and finally ended up on EasyLM. My thoughts are:<p>- Levanter is well intentioned but is unproven and lacking in features. For instance, their sharding is odd in that it requires embedding dimension to be a multiple of the number of devices, so I can&#x27;t test using a model with embedding dimension 768 on a 512-device pod. Lost confidence in Levanter after finding some glaring correctness bugs (and helping get them fixed). Also, while I&#x27;m a huge fan of Equinox&#x27;s approach, it&#x27;s sadly underdeveloped (for instance, there&#x27;s no way to specify non-default weight initialization strategies without manually doing model surgery to set weights).<p>- MaxText was just very difficult to work with. We felt like we were fighting against it every time we needed to change something because we would be digging through numerous needless layers of abstraction. My favorite was after one long day of debugging, I found a function who&#x27;s only purpose was to pass its arguments to another function untouched; this function&#x27;s only purpose was to pass its arguments untouched to a new, third function, that then slightly changed them and passed them to a fourth function that did the work.<p>- EasyLM is, as the name says, easy. But on a deeper dive, the sharding functionality seems to be underdeveloped. What they call &quot;FSDP&quot; is not necessarily true FSDP, it&#x27;s literally just a certain axis that the JAX mesh is being sharded around that happens to shard some data axes and some model weight axes.<p>I&#x27;m still searching for a &quot;perfect&quot; JAX LLM codebase - any pointers?</div><br/><div id="40141203" class="c"><input type="checkbox" id="c-40141203" checked=""/><div class="controls bullet"><span class="by">logicchains</span><span>|</span><a href="#40140784">parent</a><span>|</span><label class="collapse" for="c-40141203">[-]</label><label class="expand" for="c-40141203">[1 more]</label></div><br/><div class="children"><div class="content">&gt;MaxText was just very difficult to work with. We felt like we were fighting against it every time we needed to change something because we would be digging through numerous needless layers of abstraction. My favorite was after one long day of debugging, I found a function who&#x27;s only purpose was to pass its arguments to another function untouched; this function&#x27;s only purpose was to pass its arguments untouched to a new, third function, that then slightly changed them and passed them to a fourth function that did the work<p>Some of this complexity may be necessary for achieving optimal performance in Jax.  E.g. extra indirection to avoid the compiler making some bad fusion decision, or multiple calls so something can be marked as static for the jit in the outer call. As far as I&#x27;m aware MaxText is the only public Jax codebase that&#x27;s demonstrated scaling to models with 100s of billions of weights. I&#x27;ve just started evaluating it and it seems to scale better than the Torch implementation I was using previously (even on GPU). Most of the abstraction seems to have a reason behind it (at least for me since I&#x27;m making some modifications to the vanilla model, which is easier when the components are less tightly coupled).</div><br/></div></div></div></div></div></div></div></div></div></body></html>