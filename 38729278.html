<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1703235655988" as="style"/><link rel="stylesheet" href="styles.css?v=1703235655988"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://lwn.net/Articles/954018/">Modern C for Fedora (and the World)</a> <span class="domain">(<a href="https://lwn.net">lwn.net</a>)</span></div><div class="subtext"><span>signa11</span> | <span>22 comments</span></div><br/><div><div id="38732225" class="c"><input type="checkbox" id="c-38732225" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38732218">next</a><span>|</span><label class="collapse" for="c-38732225">[-]</label><label class="expand" for="c-38732225">[1 more]</label></div><br/><div class="children"><div class="content">There is some discussion there about whether it&#x27;s a good idea to enable -Werror: make all warnings errors (which breaks builds for users that use a newer compiler that introduces new warnings) Someone said, how about doing that for version control checkouts. But downstream users use version control checkouts too.<p>I have a solution for that kind of thing: .&#x2F;configure --maintainer.<p>If the building user identifies as a maintainer, then some things can happen differently. Stricter compiler options may be one. Another thing you might do in maintainer mode is update generated files (e.g. Yacc parsers) rather than using the canned, shipped code.<p>In TXR&#x27;s .&#x2F;configure, maintainer mode enables parallel make, which is suppressed otherwise. There is a way to enable it without requesting maintainer mode. Parallel make asks for problems because it can introduce race conditions into build steps, causing builds to intermittently fail. So in keeping with the theme of not breaking users, we disable it --- unless they announce themselves to be developing users via maintainer mode.</div><br/></div></div><div id="38732218" class="c"><input type="checkbox" id="c-38732218" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#38732225">prev</a><span>|</span><a href="#38732252">next</a><span>|</span><label class="collapse" for="c-38732218">[-]</label><label class="expand" for="c-38732218">[4 more]</label></div><br/><div class="children"><div class="content">&gt; <i>C++ has already adopted type inference, where the compiler figures out what the appropriate type for the variable should be from how it is used, in this case. There are schemes afoot to add a similar feature to C, but type inference is incompatible with implicit int.</i><p>Please no. In C++ this only makes sense when you have huge templated types such as iterators etc. Or inside templates where the types are not fixed.<p>Neither exist in C. It is just a distraction with no benefits in C.</div><br/><div id="38732334" class="c"><input type="checkbox" id="c-38732334" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38732218">parent</a><span>|</span><a href="#38732242">next</a><span>|</span><label class="collapse" for="c-38732334">[-]</label><label class="expand" for="c-38732334">[1 more]</label></div><br/><div class="children"><div class="content">It is already there in C23.</div><br/></div></div><div id="38732242" class="c"><input type="checkbox" id="c-38732242" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38732218">parent</a><span>|</span><a href="#38732334">prev</a><span>|</span><a href="#38732252">next</a><span>|</span><label class="collapse" for="c-38732242">[-]</label><label class="expand" for="c-38732242">[2 more]</label></div><br/><div class="children"><div class="content">C has type generic math (which came first) and something called generic selection via _Generic (which came later, and provides a model for implementing the type generic math stuff).<p>I suspect that a C++-like <i>auto</i> could be of benefit in conjunction with that stuff.</div><br/><div id="38732349" class="c"><input type="checkbox" id="c-38732349" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38732218">root</a><span>|</span><a href="#38732242">parent</a><span>|</span><a href="#38732252">next</a><span>|</span><label class="collapse" for="c-38732349">[-]</label><label class="expand" for="c-38732349">[1 more]</label></div><br/><div class="children"><div class="content">C23 has that auto, although the semantics are more limiting.</div><br/></div></div></div></div></div></div><div id="38732252" class="c"><input type="checkbox" id="c-38732252" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38732218">prev</a><span>|</span><a href="#38732163">next</a><span>|</span><label class="collapse" for="c-38732252">[-]</label><label class="expand" for="c-38732252">[1 more]</label></div><br/><div class="children"><div class="content">One K&amp;RC construct can sneak into new C by accident. A lost C++ developer might wander into a C program and write:<p><pre><code>  void fun() {  }
</code></pre>
which is fully declared in C++, but in C it is an old-style function definition that doesn&#x27;t declare anything about its arguments.</div><br/></div></div><div id="38732163" class="c"><input type="checkbox" id="c-38732163" checked=""/><div class="controls bullet"><span class="by">fractalb</span><span>|</span><a href="#38732252">prev</a><span>|</span><a href="#38732125">next</a><span>|</span><label class="collapse" for="c-38732163">[-]</label><label class="expand" for="c-38732163">[2 more]</label></div><br/><div class="children"><div class="content">Is there some place where I can see all the packages that need to be fixed and raise a pull request for any package? Maybe, I can help with some fixes during the holiday season.</div><br/><div id="38732224" class="c"><input type="checkbox" id="c-38732224" checked=""/><div class="controls bullet"><span class="by">asicsp</span><span>|</span><a href="#38732163">parent</a><span>|</span><a href="#38732125">next</a><span>|</span><label class="collapse" for="c-38732224">[-]</label><label class="expand" for="c-38732224">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;lwn.net&#x2F;ml&#x2F;fedora-devel&#x2F;87jzpztbfg.fsf@oldenburg.str.redhat.com&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;lwn.net&#x2F;ml&#x2F;fedora-devel&#x2F;87jzpztbfg.fsf@oldenburg.str...</a> might help</div><br/></div></div></div></div><div id="38732125" class="c"><input type="checkbox" id="c-38732125" checked=""/><div class="controls bullet"><span class="by">ho_schi</span><span>|</span><a href="#38732163">prev</a><span>|</span><a href="#38732101">next</a><span>|</span><label class="collapse" for="c-38732125">[-]</label><label class="expand" for="c-38732125">[2 more]</label></div><br/><div class="children"><div class="content"><i>The C Programming Language</i><p>Does someone now a source of the 2nd Edition “ANSI C” with a good print quality? The ones sold by Amazon seem to be scans and no based on digital typesetting - which is mentioned in the first pages.</div><br/><div id="38732292" class="c"><input type="checkbox" id="c-38732292" checked=""/><div class="controls bullet"><span class="by">anthk</span><span>|</span><a href="#38732125">parent</a><span>|</span><a href="#38732101">next</a><span>|</span><label class="collapse" for="c-38732292">[-]</label><label class="expand" for="c-38732292">[1 more]</label></div><br/><div class="children"><div class="content">I have one in HTML.</div><br/></div></div></div></div><div id="38732101" class="c"><input type="checkbox" id="c-38732101" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38732125">prev</a><span>|</span><a href="#38731870">next</a><span>|</span><label class="collapse" for="c-38732101">[-]</label><label class="expand" for="c-38732101">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>first edition of The C Programming Language that many of us still have on our bookshelves</i><p>I suspect that plenty of people with the <i>second</i> edition on their bookshelves have retired already.</div><br/></div></div><div id="38731870" class="c"><input type="checkbox" id="c-38731870" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#38732101">prev</a><span>|</span><a href="#38731453">next</a><span>|</span><label class="collapse" for="c-38731870">[-]</label><label class="expand" for="c-38731870">[5 more]</label></div><br/><div class="children"><div class="content">Why not just change the defaults and then add some bypass flags to the compiler to allow old code to compile without hard errors?</div><br/><div id="38732031" class="c"><input type="checkbox" id="c-38732031" checked=""/><div class="controls bullet"><span class="by">ungamedplayer</span><span>|</span><a href="#38731870">parent</a><span>|</span><a href="#38731453">next</a><span>|</span><label class="collapse" for="c-38732031">[-]</label><label class="expand" for="c-38732031">[4 more]</label></div><br/><div class="children"><div class="content">Read the article comments for some of the pedantry on why C compiling has be painful forever.<p>There is no keeping people happy.</div><br/><div id="38732052" class="c"><input type="checkbox" id="c-38732052" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#38731870">root</a><span>|</span><a href="#38732031">parent</a><span>|</span><a href="#38731453">next</a><span>|</span><label class="collapse" for="c-38732052">[-]</label><label class="expand" for="c-38732052">[3 more]</label></div><br/><div class="children"><div class="content">I did read the article. Unless I missed something, I didn&#x27;t see anything about why they couldn&#x27;t add some mechanism to bypass these warnings for old files.</div><br/><div id="38732115" class="c"><input type="checkbox" id="c-38732115" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38731870">root</a><span>|</span><a href="#38732052">parent</a><span>|</span><a href="#38731453">next</a><span>|</span><label class="collapse" for="c-38732115">[-]</label><label class="expand" for="c-38732115">[2 more]</label></div><br/><div class="children"><div class="content">&quot;They&quot; (e.g. GCC maintainers) do. You have dialect options like -std=c90, and fine-grained control over diagnostics: you can disable or enable individual warnings, or have them treated as errors.<p>GCC compiles C with a certain default dialect. It used to be gnu89 for the longest time, then gnu99 for a while. Now it is gnu11, if not higher. This default dialect is not ISO C; it&#x27;s a GNU dialect.<p>So just to have your code processed as ISO C, you have to use a non-default option. Some GNU extensions are still recognized (rather than diagnosed as syntax errors) so if you wish not to accidentally use those, you need -pedantic also.<p>In Makefiles, you can tweak compiler options for individual files. E.g. with target-specific assignments in GNU Make.<p><pre><code>  # don&#x27;t warn about conversions in old_parser.c
  old_parser.o: CFLAGS += -Wno-conversion</code></pre></div><br/><div id="38732295" class="c"><input type="checkbox" id="c-38732295" checked=""/><div class="controls bullet"><span class="by">anthk</span><span>|</span><a href="#38731870">root</a><span>|</span><a href="#38732115">parent</a><span>|</span><a href="#38731453">next</a><span>|</span><label class="collapse" for="c-38732295">[-]</label><label class="expand" for="c-38732295">[1 more]</label></div><br/><div class="children"><div class="content">Or use TCC or CParser for C89&#x2F;C99 and much faster compiling times.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38731453" class="c"><input type="checkbox" id="c-38731453" checked=""/><div class="controls bullet"><span class="by">hulitu</span><span>|</span><a href="#38731870">prev</a><span>|</span><a href="#38732123">next</a><span>|</span><label class="collapse" for="c-38731453">[-]</label><label class="expand" for="c-38731453">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Part of the problem, perhaps, is that it appears to have fallen on Fedora and GCC developers to make these fixes.<p>Well, they were playing with fire, and now are complaining.</div><br/><div id="38731507" class="c"><input type="checkbox" id="c-38731507" checked=""/><div class="controls bullet"><span class="by">choeger</span><span>|</span><a href="#38731453">parent</a><span>|</span><a href="#38732123">next</a><span>|</span><label class="collapse" for="c-38731507">[-]</label><label class="expand" for="c-38731507">[3 more]</label></div><br/><div class="children"><div class="content">Huh? Who&#x27;s been playing with fire? Fedora ships 15k packages. They don&#x27;t develop them. They&#x27;re trying to modernize hundreds of packages on a volunteer basis.</div><br/><div id="38731663" class="c"><input type="checkbox" id="c-38731663" checked=""/><div class="controls bullet"><span class="by">BlackFingolfin</span><span>|</span><a href="#38731453">root</a><span>|</span><a href="#38731507">parent</a><span>|</span><a href="#38732123">next</a><span>|</span><label class="collapse" for="c-38731663">[-]</label><label class="expand" for="c-38731663">[2 more]</label></div><br/><div class="children"><div class="content">Well... &quot;it appears to have fallen on Fedora and GCC developers&quot; suggests they are are forced into doing this. But it&#x27;s the reverse: they decided this is a sensible goal. OK, they are free to do that, but painting it as if they are unfairly left alone in their plight is framing it rather strongly.</div><br/><div id="38731759" class="c"><input type="checkbox" id="c-38731759" checked=""/><div class="controls bullet"><span class="by">marcthe12</span><span>|</span><a href="#38731453">root</a><span>|</span><a href="#38731663">parent</a><span>|</span><a href="#38732123">next</a><span>|</span><label class="collapse" for="c-38731759">[-]</label><label class="expand" for="c-38731759">[1 more]</label></div><br/><div class="children"><div class="content">Well Clang also did this for clang 16 and tried to ship it with 16. Most of these were K&amp;R C constructs that were deprecated in c89. c23 kinda removes and in one case even repurposes the code. So on GCC and Clang side, it was c23 compliance and on fedora and gentoo(which also helped) force by compiler defaults.</div><br/></div></div></div></div></div></div></div></div><div id="38732123" class="c"><input type="checkbox" id="c-38732123" checked=""/><div class="controls bullet"><span class="by">IWeldMelons</span><span>|</span><a href="#38731453">prev</a><span>|</span><label class="collapse" for="c-38732123">[-]</label><label class="expand" for="c-38732123">[1 more]</label></div><br/><div class="children"><div class="content">Futile exercise. Compilers should follow the standard, even if it is ugly or dated.</div><br/></div></div></div></div></div></div></div></body></html>