<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1737795674365" as="style"/><link rel="stylesheet" href="styles.css?v=1737795674365"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.cambridge.org/core/journals/journal-of-functional-programming/article/you-could-have-invented-fenwick-trees/B4628279D4E54229CED97249E96F721D">You could have invented Fenwick trees</a> <span class="domain">(<a href="https://www.cambridge.org">www.cambridge.org</a>)</span></div><div class="subtext"><span>matt_d</span> | <span>18 comments</span></div><br/><div><div id="42818617" class="c"><input type="checkbox" id="c-42818617" checked=""/><div class="controls bullet"><span class="by">vh311</span><span>|</span><a href="#42818697">next</a><span>|</span><label class="collapse" for="c-42818617">[-]</label><label class="expand" for="c-42818617">[5 more]</label></div><br/><div class="children"><div class="content">I used them in my paper: <a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;1701.07072" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;1701.07072</a><p>They appear quite naturally in the fermion-qubit mappings we looked at and I worked the data structure out at the time and only then found out about Fenwick’s work.<p>So I guess I also agree with the title :)</div><br/><div id="42819131" class="c"><input type="checkbox" id="c-42819131" checked=""/><div class="controls bullet"><span class="by">guimplen</span><span>|</span><a href="#42818617">parent</a><span>|</span><a href="#42819080">next</a><span>|</span><label class="collapse" for="c-42819131">[-]</label><label class="expand" for="c-42819131">[3 more]</label></div><br/><div class="children"><div class="content">While it might be ok to use colloquially the term, &quot;Fenwick trees&quot; since it became a common name, calling them &quot;a Fenwick&#x27;s work&quot; and not mentioning Ryabko is a clear misattribution.</div><br/><div id="42819212" class="c"><input type="checkbox" id="c-42819212" checked=""/><div class="controls bullet"><span class="by">vh311</span><span>|</span><a href="#42818617">root</a><span>|</span><a href="#42819131">parent</a><span>|</span><a href="#42819080">next</a><span>|</span><label class="collapse" for="c-42819212">[-]</label><label class="expand" for="c-42819212">[2 more]</label></div><br/><div class="children"><div class="content">Sure, by what I wrote above I meant more of a &quot;Fenwick&#x27;s paper&quot; than &quot;Fenwick&#x27;s work&quot; :)<p>That said, as far as I remember, I did not know about Ryabko. So while it might have been a misatribution, it&#x27;s far from a clear one.<p>Did he publish it btw.? If so, do you have a reference?</div><br/><div id="42819376" class="c"><input type="checkbox" id="c-42819376" checked=""/><div class="controls bullet"><span class="by">guimplen</span><span>|</span><a href="#42818617">root</a><span>|</span><a href="#42819212">parent</a><span>|</span><a href="#42819080">next</a><span>|</span><label class="collapse" for="c-42819376">[-]</label><label class="expand" for="c-42819376">[1 more]</label></div><br/><div class="children"><div class="content">All the references are on the wiki page:
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Fenwick_tree" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Fenwick_tree</a></div><br/></div></div></div></div></div></div><div id="42819080" class="c"><input type="checkbox" id="c-42819080" checked=""/><div class="controls bullet"><span class="by">cosmic_quanta</span><span>|</span><a href="#42818617">parent</a><span>|</span><a href="#42819131">prev</a><span>|</span><a href="#42818697">next</a><span>|</span><label class="collapse" for="c-42819080">[-]</label><label class="expand" for="c-42819080">[1 more]</label></div><br/><div class="children"><div class="content">I always feel warm inside when I hear of concepts in separate fields connecting in some way. Very cool</div><br/></div></div></div></div><div id="42818697" class="c"><input type="checkbox" id="c-42818697" checked=""/><div class="controls bullet"><span class="by">code_biologist</span><span>|</span><a href="#42818617">prev</a><span>|</span><a href="#42818689">next</a><span>|</span><label class="collapse" for="c-42818697">[-]</label><label class="expand" for="c-42818697">[1 more]</label></div><br/><div class="children"><div class="content">Written by Brent Yorgey — I&#x27;ll definitely give it a read when I have time. When I was learning Haskell, I found his Typeclassopedia [1] to be the best explanation of Monads, Monoids, Applicative and such. His pedagogical approach was delightful in contrast to all the &quot;monad is like a burrito&quot; tutorials.<p>[1] <a href="https:&#x2F;&#x2F;wiki.haskell.org&#x2F;wikiupload&#x2F;e&#x2F;e9&#x2F;Typeclassopedia.pdf" rel="nofollow">https:&#x2F;&#x2F;wiki.haskell.org&#x2F;wikiupload&#x2F;e&#x2F;e9&#x2F;Typeclassopedia.pdf</a></div><br/></div></div><div id="42818689" class="c"><input type="checkbox" id="c-42818689" checked=""/><div class="controls bullet"><span class="by">SerCe</span><span>|</span><a href="#42818697">prev</a><span>|</span><a href="#42818605">next</a><span>|</span><label class="collapse" for="c-42818689">[-]</label><label class="expand" for="c-42818689">[1 more]</label></div><br/><div class="children"><div class="content">I remember trying to memorise the implementation by following the e-maxx guides [1] (back then it was <a href="http:&#x2F;&#x2F;e-maxx.ru&#x2F;" rel="nofollow">http:&#x2F;&#x2F;e-maxx.ru&#x2F;</a>) for use in competitive programming contests. They&#x27;re so simple once you understand them, yet it&#x27;s pretty easy to forget the details of the simple implementation if you haven&#x27;t done it for a while.<p>[1]: <a href="https:&#x2F;&#x2F;cp-algorithms.com&#x2F;data_structures&#x2F;fenwick.html" rel="nofollow">https:&#x2F;&#x2F;cp-algorithms.com&#x2F;data_structures&#x2F;fenwick.html</a></div><br/></div></div><div id="42818605" class="c"><input type="checkbox" id="c-42818605" checked=""/><div class="controls bullet"><span class="by">celeritascelery</span><span>|</span><a href="#42818689">prev</a><span>|</span><a href="#42818588">next</a><span>|</span><label class="collapse" for="c-42818605">[-]</label><label class="expand" for="c-42818605">[4 more]</label></div><br/><div class="children"><div class="content">In the same way that B-trees have emerged as a more cache friendly version of binary trees, it seems like you could create a Fenwick tree that stores multiple “children” at the same location. It would probably be less algorithmically beautiful, but would be faster over all.</div><br/><div id="42818683" class="c"><input type="checkbox" id="c-42818683" checked=""/><div class="controls bullet"><span class="by">kadoban</span><span>|</span><a href="#42818605">parent</a><span>|</span><a href="#42818588">next</a><span>|</span><label class="collapse" for="c-42818683">[-]</label><label class="expand" for="c-42818683">[3 more]</label></div><br/><div class="children"><div class="content">I am not sure that is something worth trying. In practice Fenwick trees are array-encoded, in memory they&#x27;re just an array you index into. The reason B-trees are used is kind of because you can&#x27;t do that with a dynamic binary tree.</div><br/><div id="42818844" class="c"><input type="checkbox" id="c-42818844" checked=""/><div class="controls bullet"><span class="by">celeritascelery</span><span>|</span><a href="#42818605">root</a><span>|</span><a href="#42818683">parent</a><span>|</span><a href="#42818588">next</a><span>|</span><label class="collapse" for="c-42818844">[-]</label><label class="expand" for="c-42818844">[2 more]</label></div><br/><div class="children"><div class="content">They are array encoded, but you still will be jumping all over the array to do your operations. Putting multiple “nodes” at the same location will mean fewer jumps, and hence fewer cache misses.</div><br/><div id="42819078" class="c"><input type="checkbox" id="c-42819078" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#42818605">root</a><span>|</span><a href="#42818844">parent</a><span>|</span><a href="#42818588">next</a><span>|</span><label class="collapse" for="c-42819078">[-]</label><label class="expand" for="c-42819078">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s what the Eytzinger ordering is for. Using 1-based indexing like the article, a single lookup will only hit the following nodes:<p><pre><code>  1
  2 or 3 (let&#x27;s assume 2)
  4 or 5 (let&#x27;s assume 5)
  10 or 11
</code></pre>
Remember these are all adjacent. So the nodes near the root stay in cache (regardless of whether a path through them in particular was taken), and the other nodes are in cache if you&#x27;ve recently looked up a similar key.<p>There won&#x27;t be any further improvement from using a B-tree, which only scatters the memory further. (if anything, you <i>might</i> consider using a higher-base Eytzinger tree for SIMD reasons, but I&#x27;ve never actually seen anyone do this)</div><br/></div></div></div></div></div></div></div></div><div id="42818588" class="c"><input type="checkbox" id="c-42818588" checked=""/><div class="controls bullet"><span class="by">SethTro</span><span>|</span><a href="#42818605">prev</a><span>|</span><a href="#42819578">next</a><span>|</span><label class="collapse" for="c-42818588">[-]</label><label class="expand" for="c-42818588">[1 more]</label></div><br/><div class="children"><div class="content">Totally agree with the title. I discovered Fenwick trees as part of solving a Project Euler, then from the problem forum I found out someone had invented this in the 90s and other people had imagined it much earlier.</div><br/></div></div><div id="42819578" class="c"><input type="checkbox" id="c-42819578" checked=""/><div class="controls bullet"><span class="by">dreamcompiler</span><span>|</span><a href="#42818588">prev</a><span>|</span><a href="#42819357">next</a><span>|</span><label class="collapse" for="c-42819578">[-]</label><label class="expand" for="c-42819578">[1 more]</label></div><br/><div class="children"><div class="content">Skip lists also have [statistically] sublinear times for insertions and range queries. Both are O(logn).<p>Fenwick trees seem to use much less memory while not being quite as general-purpose as skip lists.</div><br/></div></div><div id="42819357" class="c"><input type="checkbox" id="c-42819357" checked=""/><div class="controls bullet"><span class="by">kevmo314</span><span>|</span><a href="#42819578">prev</a><span>|</span><a href="#42819693">next</a><span>|</span><label class="collapse" for="c-42819357">[-]</label><label class="expand" for="c-42819357">[1 more]</label></div><br/><div class="children"><div class="content">I used to think inventing new things was the hard part. Now I&#x27;m finding that realizing solutions are novel and noteworthy is a lot harder.</div><br/></div></div><div id="42819693" class="c"><input type="checkbox" id="c-42819693" checked=""/><div class="controls bullet"><span class="by">nayuki</span><span>|</span><a href="#42819357">prev</a><span>|</span><a href="#42819431">next</a><span>|</span><label class="collapse" for="c-42819693">[-]</label><label class="expand" for="c-42819693">[1 more]</label></div><br/><div class="children"><div class="content">When making my implementation, the math felt unintuitive. <a href="https:&#x2F;&#x2F;www.nayuki.io&#x2F;page&#x2F;binary-indexed-tree" rel="nofollow">https:&#x2F;&#x2F;www.nayuki.io&#x2F;page&#x2F;binary-indexed-tree</a></div><br/></div></div><div id="42819764" class="c"><input type="checkbox" id="c-42819764" checked=""/><div class="controls bullet"><span class="by">agnishom</span><span>|</span><a href="#42819431">prev</a><span>|</span><label class="collapse" for="c-42819764">[-]</label><label class="expand" for="c-42819764">[1 more]</label></div><br/><div class="children"><div class="content">This is the beauty of some of the best algorithms. It always feels like &quot;I could have written that paper&quot;</div><br/></div></div></div></div></div></div></div></body></html>