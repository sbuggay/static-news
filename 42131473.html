<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1731574862022" as="style"/><link rel="stylesheet" href="styles.css?v=1731574862022"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://isocpp.org/files/papers/P2900R6.pdf">Contracts for C++ (DbC) [pdf]</a>Â <span class="domain">(<a href="https://isocpp.org">isocpp.org</a>)</span></div><div class="subtext"><span>xo5vik</span> | <span>18 comments</span></div><br/><div><div id="42134246" class="c"><input type="checkbox" id="c-42134246" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#42133263">next</a><span>|</span><label class="collapse" for="c-42134246">[-]</label><label class="expand" for="c-42134246">[1 more]</label></div><br/><div class="children"><div class="content">Assuming that this or something substantially identical does land for C++ 26 I think we should start betting on when SG23 (the committee&#x27;s Study Group for &quot;Safety and Security&quot;) is replaced by some hypothetical SG24 &quot;Safety and Security No But Really&quot;.<p>We already know that because C++ Undefined Behaviour can cause what are called &quot;Time Travel&quot; defects and this paper doesn&#x27;t do anything to prevent it, adding contracts in C++ can make your software <i>less</i> safe and induce <i>more</i> surprise behaviour. We also already know that C++ programmers tend to write erroneous UB tests when trying to grapple with edge cases that might induce Undefined Behaviour, setting off the very calamity they fear. So this new feature, rather than being (as its proponents claim) a way to improve the safety of C++ software, or neutrally becoming a dead letter as the UB &quot;passes&quot; contracts that in fact are not met, might instead become another footgun for the language.<p>A functioning SG23 should have caused this proposal to stall out until it can explain <i>how</i> it will prevent this problem, rather than merely re-stating the problem (in 3.6.4) and saying well that&#x27;s unfortunate but maybe somebody else will fix it. That stance might be extremely unpopular with some C++ programmers, who believe they don&#x27;t make mistakes, but as it stands this work will instead cause all the people who <i>do</i> make mistakes (which is in practice everybody) to regret using contracts. If SG23 isn&#x27;t interested in preventing C++ from becoming even more unsafe, what&#x27;s the point in the group existing?</div><br/></div></div><div id="42133263" class="c"><input type="checkbox" id="c-42133263" checked=""/><div class="controls bullet"><span class="by">pbrowne011</span><span>|</span><a href="#42134246">prev</a><span>|</span><a href="#42133698">next</a><span>|</span><label class="collapse" for="c-42133263">[-]</label><label class="expand" for="c-42133263">[3 more]</label></div><br/><div class="children"><div class="content">More recent revision: <a href="https:&#x2F;&#x2F;isocpp.org&#x2F;files&#x2F;papers&#x2F;P2900R10.pdf" rel="nofollow">https:&#x2F;&#x2F;isocpp.org&#x2F;files&#x2F;papers&#x2F;P2900R10.pdf</a>. It seems like they&#x27;ve added a few things since this draft.<p>It&#x27;s somewhat funny to hear &quot;minimum viable product&quot; in the context of a language standard&#x2F;specification. I&#x27;d never thought of adding a feature to a language in that way before.<p>The idea of design by contract (DbC) in C++ appears to have been around for a while too. The authors link to a &quot;forthcoming companion paper&quot; (currently a 404 error), but you can find proposals from as early as 2004 with the idea: <a href="https:&#x2F;&#x2F;www.open-std.org&#x2F;JTC1&#x2F;SC22&#x2F;WG21&#x2F;docs&#x2F;papers&#x2F;2004&#x2F;n1613.pdf" rel="nofollow">https:&#x2F;&#x2F;www.open-std.org&#x2F;JTC1&#x2F;SC22&#x2F;WG21&#x2F;docs&#x2F;papers&#x2F;2004&#x2F;n16...</a><p>(and potentially earlier, I just haven&#x27;t seen one yet)</div><br/><div id="42134027" class="c"><input type="checkbox" id="c-42134027" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#42133263">parent</a><span>|</span><a href="#42133778">next</a><span>|</span><label class="collapse" for="c-42134027">[-]</label><label class="expand" for="c-42134027">[1 more]</label></div><br/><div class="children"><div class="content">Languages are software products as well.<p>Many features in Java, C#, C++ have evolved as MVP across several language revisions before.<p>Lambdas, type inference, modules, unsafe code, constexpr,...</div><br/></div></div><div id="42133778" class="c"><input type="checkbox" id="c-42133778" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#42133263">parent</a><span>|</span><a href="#42134027">prev</a><span>|</span><a href="#42133698">next</a><span>|</span><label class="collapse" for="c-42133778">[-]</label><label class="expand" for="c-42133778">[1 more]</label></div><br/><div class="children"><div class="content">You have now :-)</div><br/></div></div></div></div><div id="42133698" class="c"><input type="checkbox" id="c-42133698" checked=""/><div class="controls bullet"><span class="by">discardable_dan</span><span>|</span><a href="#42133263">prev</a><span>|</span><a href="#42133751">next</a><span>|</span><label class="collapse" for="c-42133698">[-]</label><label class="expand" for="c-42133698">[6 more]</label></div><br/><div class="children"><div class="content">I did my dissertation work on software contracts. They are generally useless: programmers won&#x27;t write them, or will write them incorrectly. Moreover, the runtime enforcement dominates all but the most-expensive functions, and contracts become an antipattern for helper functions due to their enforcement cost.<p>Without intense compiler support and contract erasure such as David Van Horne&#x27;s work, this is a dead idea that needs to stay that way.</div><br/><div id="42133849" class="c"><input type="checkbox" id="c-42133849" checked=""/><div class="controls bullet"><span class="by">fermigier</span><span>|</span><a href="#42133698">parent</a><span>|</span><a href="#42133874">next</a><span>|</span><label class="collapse" for="c-42133849">[-]</label><label class="expand" for="c-42133849">[1 more]</label></div><br/><div class="children"><div class="content">A reference for your dissertation?<p>The usefulness (or lack thereof) of contracts was famously discussed in 1997 in this paper: <a href="https:&#x2F;&#x2F;www.irisa.fr&#x2F;pampa&#x2F;EPEE&#x2F;Ariane5.html" rel="nofollow">https:&#x2F;&#x2F;www.irisa.fr&#x2F;pampa&#x2F;EPEE&#x2F;Ariane5.html</a> (with additional comments here: <a href="https:&#x2F;&#x2F;www.irisa.fr&#x2F;pampa&#x2F;EPEE&#x2F;Ariane5-comments.html" rel="nofollow">https:&#x2F;&#x2F;www.irisa.fr&#x2F;pampa&#x2F;EPEE&#x2F;Ariane5-comments.html</a> ).<p>I have tried several times (a couple of decades ago) to introduce DBC in Python, using one of the many available libraries (for an overview: see <a href="https:&#x2F;&#x2F;lab.abilian.com&#x2F;Tech&#x2F;Python&#x2F;DbC%20in%20Python&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lab.abilian.com&#x2F;Tech&#x2F;Python&#x2F;DbC%20in%20Python&#x2F;</a> ) but, like you, wasn&#x27;t convinced.<p>I believe your argument on the performance penalty is right, and as a corollary, this implies that contracts are mostly useful if associated with a formal proof system. Contracts in production are probably a bad idea, in most cases.</div><br/></div></div><div id="42133874" class="c"><input type="checkbox" id="c-42133874" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#42133698">parent</a><span>|</span><a href="#42133849">prev</a><span>|</span><a href="#42134041">next</a><span>|</span><label class="collapse" for="c-42133874">[-]</label><label class="expand" for="c-42133874">[1 more]</label></div><br/><div class="children"><div class="content">It sounds like you&#x27;re specifically talking about runtime-enforced contracts rather than ones that the compiler uses to prove compliance? Your first sentence makes it sound like you think all contracts are useless, but your last sentence makes it seem like you think they&#x27;re useful if they&#x27;re compile time.</div><br/></div></div><div id="42134041" class="c"><input type="checkbox" id="c-42134041" checked=""/><div class="controls bullet"><span class="by">zerr</span><span>|</span><a href="#42133698">parent</a><span>|</span><a href="#42133874">prev</a><span>|</span><a href="#42133876">next</a><span>|</span><label class="collapse" for="c-42134041">[-]</label><label class="expand" for="c-42134041">[2 more]</label></div><br/><div class="children"><div class="content">Is anyone using Eiffel language in the real world? The community seems so tiny, barely existing.</div><br/><div id="42134258" class="c"><input type="checkbox" id="c-42134258" checked=""/><div class="controls bullet"><span class="by">rramadass</span><span>|</span><a href="#42133698">root</a><span>|</span><a href="#42134041">parent</a><span>|</span><a href="#42133876">next</a><span>|</span><label class="collapse" for="c-42134258">[-]</label><label class="expand" for="c-42134258">[1 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t matter when it comes to concepts&#x2F;ideas which are useful overall. In this context DbC is a general idea&#x2F;technique (derived from the Floyd&#x2F;Hoare&#x2F;Dijkstra school of &quot;Program Correctness&quot;) useful for &quot;large scale&quot; Software Engineering.</div><br/></div></div></div></div><div id="42133876" class="c"><input type="checkbox" id="c-42133876" checked=""/><div class="controls bullet"><span class="by">rramadass</span><span>|</span><a href="#42133698">parent</a><span>|</span><a href="#42134041">prev</a><span>|</span><a href="#42133751">next</a><span>|</span><label class="collapse" for="c-42133876">[-]</label><label class="expand" for="c-42133876">[1 more]</label></div><br/><div class="children"><div class="content">Interesting. I am a fan of DbC (following Meyer&#x27;s <i>Applying &quot;Design by Contract&quot;</i> - pdf at <a href="https:&#x2F;&#x2F;se.inf.ethz.ch&#x2F;~meyer&#x2F;publications&#x2F;computer&#x2F;contract.pdf" rel="nofollow">https:&#x2F;&#x2F;se.inf.ethz.ch&#x2F;~meyer&#x2F;publications&#x2F;computer&#x2F;contract...</a>) though due to runtime costs (as you point out) i limit it to pre-conditions only everywhere (almost all &quot;policy&quot; part of the code and less on the &quot;mechanism&quot; side) and tighter pre&#x2F;post-conditions on module boundaries only.<p>&gt; programmers won&#x27;t write them, or will write them incorrectly.<p>I think this is a matter of education and discipline and not an argument for not using DbC.<p>If it is okay with you could you share your dissertation and maybe highlight the key points which led you to your conclusion of &quot;They are generally useless&quot;? I think it would be useful to know.</div><br/></div></div></div></div><div id="42133751" class="c"><input type="checkbox" id="c-42133751" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#42133698">prev</a><span>|</span><a href="#42133568">next</a><span>|</span><label class="collapse" for="c-42133751">[-]</label><label class="expand" for="c-42133751">[5 more]</label></div><br/><div class="children"><div class="content">Contract programming for C++ was implemented back in the 90&#x27;s.<p><a href="https:&#x2F;&#x2F;www.digitalmars.com&#x2F;ctg&#x2F;contract.html" rel="nofollow">https:&#x2F;&#x2F;www.digitalmars.com&#x2F;ctg&#x2F;contract.html</a><p>It also appears in the D programming language:<p><a href="https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;contracts.html" rel="nofollow">https:&#x2F;&#x2F;dlang.org&#x2F;spec&#x2F;contracts.html</a></div><br/><div id="42133967" class="c"><input type="checkbox" id="c-42133967" checked=""/><div class="controls bullet"><span class="by">fermigier</span><span>|</span><a href="#42133751">parent</a><span>|</span><a href="#42133764">next</a><span>|</span><label class="collapse" for="c-42133967">[-]</label><label class="expand" for="c-42133967">[3 more]</label></div><br/><div class="children"><div class="content">&quot;Contract programming for C++ was implemented back in the 90&#x27;s.&quot;<p>-&gt; Did the proposal authors contact you or refer to your work (or any other previous work)? It not, that would be a shame.<p>&quot;It also appears in the D programming language&quot;<p>-&gt; Do people use it?</div><br/><div id="42134029" class="c"><input type="checkbox" id="c-42134029" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#42133751">root</a><span>|</span><a href="#42133967">parent</a><span>|</span><a href="#42133764">next</a><span>|</span><label class="collapse" for="c-42134029">[-]</label><label class="expand" for="c-42134029">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Did the proposal authors contact you<p>No<p>&gt; or refer to your work (or any other previous work)?<p>No<p>I presume they simply didn&#x27;t know about it. I emailed the authors.<p>&gt; Do people use it?<p>Yes</div><br/><div id="42134054" class="c"><input type="checkbox" id="c-42134054" checked=""/><div class="controls bullet"><span class="by">zerr</span><span>|</span><a href="#42133751">root</a><span>|</span><a href="#42134029">parent</a><span>|</span><a href="#42133764">next</a><span>|</span><label class="collapse" for="c-42134054">[-]</label><label class="expand" for="c-42134054">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Yes<p>The tiny subset of D userbase, which is tiny in its own.</div><br/></div></div></div></div></div></div><div id="42133764" class="c"><input type="checkbox" id="c-42133764" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#42133751">parent</a><span>|</span><a href="#42133967">prev</a><span>|</span><a href="#42133568">next</a><span>|</span><label class="collapse" for="c-42133764">[-]</label><label class="expand" for="c-42133764">[1 more]</label></div><br/><div class="children"><div class="content">The programming world has massive anterograde amnesia.</div><br/></div></div></div></div><div id="42133568" class="c"><input type="checkbox" id="c-42133568" checked=""/><div class="controls bullet"><span class="by">arunc</span><span>|</span><a href="#42133751">prev</a><span>|</span><label class="collapse" for="c-42133568">[-]</label><label class="expand" for="c-42133568">[2 more]</label></div><br/><div class="children"><div class="content">Are there HTML version of these docs? Would make it easier to read without having to download a PDF.</div><br/><div id="42133793" class="c"><input type="checkbox" id="c-42133793" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#42133568">parent</a><span>|</span><label class="collapse" for="c-42133793">[-]</label><label class="expand" for="c-42133793">[1 more]</label></div><br/><div class="children"><div class="content">The pdf rendered nicely for me.</div><br/></div></div></div></div></div></div></div></div></div></body></html>