<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1703754056152" as="style"/><link rel="stylesheet" href="styles.css?v=1703754056152"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://securelist.com/operation-triangulation-the-last-hardware-mystery/111669/">Operation Triangulation: What you get when attack iPhones of researchers</a> <span class="domain">(<a href="https://securelist.com">securelist.com</a>)</span></div><div class="subtext"><span>ruik</span> | <span>169 comments</span></div><br/><div><div id="38787238" class="c"><input type="checkbox" id="c-38787238" checked=""/><div class="controls bullet"><span class="by">sweis</span><span>|</span><a href="#38785043">next</a><span>|</span><label class="collapse" for="c-38787238">[-]</label><label class="expand" for="c-38787238">[1 more]</label></div><br/><div class="children"><div class="content">The video of the talk is online now too: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=7VWNUUldBEE" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=7VWNUUldBEE</a></div><br/></div></div><div id="38785043" class="c"><input type="checkbox" id="c-38785043" checked=""/><div class="controls bullet"><span class="by">mike_hearn</span><span>|</span><a href="#38787238">prev</a><span>|</span><a href="#38787197">next</a><span>|</span><label class="collapse" for="c-38785043">[-]</label><label class="expand" for="c-38785043">[25 more]</label></div><br/><div class="children"><div class="content">That&#x27;s pretty astonishing. The MMIO abuse implies either the attackers have truly phenomenal research capabilities, and&#x2F;or that they hacked Apple and obtained internal hardware documentation (more likely).<p>I was willing to believe that maybe it was just a massive NSA-scale research team up until the part with a custom hash function sbox. Apple appears to have known that the feature in question was dangerous and deliberately both hidden it, whatever it is, and then gone further and protected it with a sort of (fairly weak) digital signing feature.<p>As the blog post points out, there&#x27;s no obvious way you could find the right magic knock to operate this feature short of doing a full silicon teardown and reverse engineering (impractical at these nodes). That leaves hacking the developers to steal their internal documentation.<p>The way it uses a long chain of high effort zero days only to launch an invisible Safari that then starts from scratch, loading a web page that uses a completely different chain of exploits to re-hack the device, also is indicative of a massive organization with truly abysmal levels of internal siloing.<p>Given that the researchers in question are Russians at Kaspersky, this pretty much has to be the work of the NSA or maybe GCHQ.<p><i>Edit: misc other interesting bits from the talk: the malware can enable ad tracking, and also can detect cloud iPhone service hosting that&#x27;s often used by security researchers. The iOS&#x2F;macOS malware platform seems to have been in development for over a decade and actually does ML on the device to do object recognition and OCR on photos on-device, to avoid uploading image bytes: they only upload ML generated labels. They truly went to a lot of effort, but all that was no match for a bunch of smart Russian students.<p>I&#x27;m not sure I agree with the speaker that security through obscurity doesn&#x27;t work, however. This platform has been in the wild for ten years and nobody knows how long they&#x27;ve been exploiting this hidden hardware &quot;feature&quot;. If the hardware feature was openly documented it&#x27;d have been found much, much sooner.</i></div><br/><div id="38787590" class="c"><input type="checkbox" id="c-38787590" checked=""/><div class="controls bullet"><span class="by">black_puppydog</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38790920">next</a><span>|</span><label class="collapse" for="c-38787590">[-]</label><label class="expand" for="c-38787590">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If the hardware feature was openly documented it&#x27;d have been found much, much sooner.<p>Well, the point of kerckhoff&#x27;s principle is that it <i>should</i> have been openly documented and then anyone lookindg at the docs even pre-publication would have said &quot;we can&#x27;t ship it like that, that feature needs to go.&quot;</div><br/></div></div><div id="38790920" class="c"><input type="checkbox" id="c-38790920" checked=""/><div class="controls bullet"><span class="by">eastof</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38787590">prev</a><span>|</span><a href="#38787187">next</a><span>|</span><label class="collapse" for="c-38790920">[-]</label><label class="expand" for="c-38790920">[1 more]</label></div><br/><div class="children"><div class="content">Maybe more likely they just have people inside Apple?</div><br/></div></div><div id="38787187" class="c"><input type="checkbox" id="c-38787187" checked=""/><div class="controls bullet"><span class="by">aberoham</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38790920">prev</a><span>|</span><a href="#38785081">next</a><span>|</span><label class="collapse" for="c-38787187">[-]</label><label class="expand" for="c-38787187">[1 more]</label></div><br/><div class="children"><div class="content">Also note the IoC script — This script allows to scan iTunes backups for indicator of compromise by Operation Triangulation. <a href="https:&#x2F;&#x2F;github.com&#x2F;KasperskyLab&#x2F;triangle_check">https:&#x2F;&#x2F;github.com&#x2F;KasperskyLab&#x2F;triangle_check</a></div><br/></div></div><div id="38785081" class="c"><input type="checkbox" id="c-38785081" checked=""/><div class="controls bullet"><span class="by">sampa</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38787187">prev</a><span>|</span><a href="#38790345">next</a><span>|</span><label class="collapse" for="c-38785081">[-]</label><label class="expand" for="c-38785081">[13 more]</label></div><br/><div class="children"><div class="content">or Apple just implemented this &quot;API&quot; for them, because they&#x27;ve asked nicely</div><br/><div id="38785174" class="c"><input type="checkbox" id="c-38785174" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785081">parent</a><span>|</span><a href="#38788616">next</a><span>|</span><label class="collapse" for="c-38785174">[-]</label><label class="expand" for="c-38785174">[10 more]</label></div><br/><div class="children"><div class="content">Or they have assets working at Apple... or they hired an ex-Apple employee... etc.<p>That&#x27;s the problem with this sort of security through obscurity; it&#x27;s only secure as long as the people who know about it can keep it secret.</div><br/><div id="38785302" class="c"><input type="checkbox" id="c-38785302" checked=""/><div class="controls bullet"><span class="by">mike_hearn</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785174">parent</a><span>|</span><a href="#38788616">next</a><span>|</span><label class="collapse" for="c-38785302">[-]</label><label class="expand" for="c-38785302">[9 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think hiring an ex-Apple dev would let you get the needed sbox unless they stole technical documentation as they left.<p>So it either has to be stolen technical docs, or a feature that was put there specifically for their usage. The fact that the ranges didn&#x27;t appear in the DeviceTree is indeed a bit suspicious, the fact that the description after being added is just &#x27;DENY&#x27; is also suspicious. Why is it OK to describe every range <i>except</i> that one?<p>But the really suspicious thing is the hash. What kind of hardware interface does arbitrary DMA protected by a secret but weak hash function? Is there any legitimate usage for such a thing? I&#x27;ve never heard of such an interface before.<p>If it&#x27;s a genuine backdoor and not a weird debugging feature then it <i>should</i> be rather difficult to add one that looks like this without other people in Apple realizing it&#x27;s there. Chips are written in source code using version control, just like software. You&#x27;d have to have a way to modify the source without anyone noticing or sounding the alarm, or modifying it before synthesis is performed. That&#x27;d imply either a very deep penetration of Apple&#x27;s internal network sufficient to inject backdoors into hardware, or they have one or more agents.<p>This really shows how dangerous it is to intel agencies when they decide to attack security professionals. Attacking Kaspersky has led directly to them burning numerous zero days including several that might have taken fairly extreme efforts to set up. It makes you wonder what is on these guy&#x27;s iPhones that&#x27;s considered so valuable. Presumably, they were after emails describing more zero days in other programs.</div><br/><div id="38789446" class="c"><input type="checkbox" id="c-38789446" checked=""/><div class="controls bullet"><span class="by">mrandish</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785302">parent</a><span>|</span><a href="#38787952">next</a><span>|</span><label class="collapse" for="c-38789446">[-]</label><label class="expand" for="c-38789446">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What kind of hardware interface does arbitrary DMA protected by a secret but weak hash function?<p>I agree. This appears to likely be an intentional backdoor injected at the hardware level during design. At such a low-level I think it could have been accomplished with only a handful of employees in on it. There would have been no need to subvert Apple from the top down with large numbers of people at many levels being privy.<p>In early silicon there can be a bunch of registers and functions implemented for testing which are later pulled out. Except maybe one set of registers doesn&#x27;t get pulled but instead a door knock is added with a weak hash function, making the registers invisible to testers and fuzzing.<p>It seems a little too convenient that the door knock hash was weak. After all, strong hash functions aren&#x27;t unknown or hard. The reason it had to be a weak hash function was to create &quot;plausible deniability&quot;. If it was a strong hash then once any exploitation was discovered there would be no denying the vuln was intentionally placed. If it really was just a test DMA function that someone supposedly &#x27;forgot&#x27; to remove before production silicon, I can&#x27;t think of a reason to have it behind any kind of door knock in the first place.<p>I read that it was patched by adding these addresses to the &quot;access denied&quot; list. While I don&#x27;t know anything about Apple security, I&#x27;m stunned that any such low-level access list isn&#x27;t &#x27;opt-in&#x27; instead of &#x27;opt-out&#x27;. If it was &#x27;opt-in&#x27; it seems like any such &#x27;undocumented&#x27; register addresses would by denied by default. And if they were on the &#x27;opt-in&#x27; list, yet remained undocumented, then it would be obvious to anyone looking at the security docs that something was amiss.</div><br/></div></div><div id="38787952" class="c"><input type="checkbox" id="c-38787952" checked=""/><div class="controls bullet"><span class="by">Veserv</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785302">parent</a><span>|</span><a href="#38789446">prev</a><span>|</span><a href="#38785943">next</a><span>|</span><label class="collapse" for="c-38787952">[-]</label><label class="expand" for="c-38787952">[2 more]</label></div><br/><div class="children"><div class="content">It should be very easy to add one without somebody noticing. This is the same Apple which shipped a version of macOS for months that added the ability to login to root with any password only a few years ago.<p>Their review processes are so incompetent even one of the most security critical components, root login, let a totally basic “fail your security 101 class” bug through. It is absolutely inexcusable to have a process that bad and is indicative of their overall approach. As they say, “one cockroach means an infestation”.</div><br/><div id="38789970" class="c"><input type="checkbox" id="c-38789970" checked=""/><div class="controls bullet"><span class="by">henriquez</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38787952">parent</a><span>|</span><a href="#38785943">next</a><span>|</span><label class="collapse" for="c-38789970">[-]</label><label class="expand" for="c-38789970">[1 more]</label></div><br/><div class="children"><div class="content">I’m not trying to defend Apple but I think that line of thinking is pretty cynical and could be used to condemn basically any company or open source project that attracts enough interest for attackers.</div><br/></div></div></div></div><div id="38785943" class="c"><input type="checkbox" id="c-38785943" checked=""/><div class="controls bullet"><span class="by">contingencies</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785302">parent</a><span>|</span><a href="#38787952">prev</a><span>|</span><a href="#38786182">next</a><span>|</span><label class="collapse" for="c-38785943">[-]</label><label class="expand" for="c-38785943">[2 more]</label></div><br/><div class="children"><div class="content">APTs probably routinely identify and target such developers. With multi-million dollar payouts for single bugs and high state level actor attention, employee profiling is clearly a known attack vector and internal security teams probably now brief on relevant opsec. FWIW the only Apple kernel developer I knew has somewhat recently totally removed themselves from LinkedIn.</div><br/><div id="38790560" class="c"><input type="checkbox" id="c-38790560" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785943">parent</a><span>|</span><a href="#38786182">next</a><span>|</span><label class="collapse" for="c-38790560">[-]</label><label class="expand" for="c-38790560">[1 more]</label></div><br/><div class="children"><div class="content">People who work on the kernel are not hard to find.</div><br/></div></div></div></div><div id="38786182" class="c"><input type="checkbox" id="c-38786182" checked=""/><div class="controls bullet"><span class="by">malfist</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785302">parent</a><span>|</span><a href="#38785943">prev</a><span>|</span><a href="#38788616">next</a><span>|</span><label class="collapse" for="c-38786182">[-]</label><label class="expand" for="c-38786182">[3 more]</label></div><br/><div class="children"><div class="content">&gt; But the really suspicious thing is the hash. What kind of hardware interface does arbitrary DMA protected by a secret but weak hash function? Is there any legitimate usage for such a thing? I&#x27;ve never heard of such an interface before.<p>Never attribute to malice that which can be attributed to incompetence. There are plenty of examples in the wild of going halfway with strong security, but halfway still leaves the barn door open.</div><br/><div id="38787198" class="c"><input type="checkbox" id="c-38787198" checked=""/><div class="controls bullet"><span class="by">joe_the_user</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38786182">parent</a><span>|</span><a href="#38788616">next</a><span>|</span><label class="collapse" for="c-38787198">[-]</label><label class="expand" for="c-38787198">[2 more]</label></div><br/><div class="children"><div class="content"><i>Never attribute to malice that which can be attributed to incompetence. There are plenty of examples in the wild of going halfway with strong security, but halfway still leaves the barn door open.</i><p>That rule should only be applied in the normal world. The world of security where you know bad actors are out there trying to do stuff, it doesn&#x27;t apply. And there are examples of spy types injecting plans to go halfway with security for their purposes - not that this proves the origin of a given plan, incompetence is still one possibility, it just returns to original point, that this stuff is mysterious.</div><br/><div id="38787926" class="c"><input type="checkbox" id="c-38787926" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38787198">parent</a><span>|</span><a href="#38788616">next</a><span>|</span><label class="collapse" for="c-38787926">[-]</label><label class="expand" for="c-38787926">[1 more]</label></div><br/><div class="children"><div class="content">As a defender, you should treat malice and incompetence as functionally equivalent. Save the attribution for the post-mortem (or better yet, don&#x27;t let it come to that).</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38788616" class="c"><input type="checkbox" id="c-38788616" checked=""/><div class="controls bullet"><span class="by">markus_zhang</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785081">parent</a><span>|</span><a href="#38785174">prev</a><span>|</span><a href="#38785569">next</a><span>|</span><label class="collapse" for="c-38788616">[-]</label><label class="expand" for="c-38788616">[1 more]</label></div><br/><div class="children"><div class="content">I wouldn’t be surprised if one or two very senior people in large tech companies are agency agents, willingly or not.<p>I don’t really have any proof but considering the massive gain it shouldn’t surprise anyone. The agencies might not even need to pay large sum of $$$ if the said assets have vulnerabilities.</div><br/></div></div><div id="38785569" class="c"><input type="checkbox" id="c-38785569" checked=""/><div class="controls bullet"><span class="by">WhackyIdeas</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38785081">parent</a><span>|</span><a href="#38788616">prev</a><span>|</span><a href="#38790345">next</a><span>|</span><label class="collapse" for="c-38785569">[-]</label><label class="expand" for="c-38785569">[1 more]</label></div><br/><div class="children"><div class="content">I think the way it’s done is that the code is presented to them to use, Apple probably don’t even code those parts themselves.</div><br/></div></div></div></div><div id="38790345" class="c"><input type="checkbox" id="c-38790345" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38785081">prev</a><span>|</span><a href="#38788381">next</a><span>|</span><label class="collapse" for="c-38790345">[-]</label><label class="expand" for="c-38790345">[1 more]</label></div><br/><div class="children"><div class="content">So much misinformation in this thread. It’s a Hamming ECC, as described here[1].<p>[1] <a href="https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583" rel="nofollow">https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583</a></div><br/></div></div><div id="38788381" class="c"><input type="checkbox" id="c-38788381" checked=""/><div class="controls bullet"><span class="by">malaya_zemlya</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38790345">prev</a><span>|</span><a href="#38790333">next</a><span>|</span><label class="collapse" for="c-38788381">[-]</label><label class="expand" for="c-38788381">[2 more]</label></div><br/><div class="children"><div class="content">&gt;also is indicative of a massive organization with truly abysmal levels of internal siloing.<p>Or a joint project between several organizations.</div><br/><div id="38788511" class="c"><input type="checkbox" id="c-38788511" checked=""/><div class="controls bullet"><span class="by">LargeTomato</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38788381">parent</a><span>|</span><a href="#38790333">next</a><span>|</span><label class="collapse" for="c-38788511">[-]</label><label class="expand" for="c-38788511">[1 more]</label></div><br/><div class="children"><div class="content">Or, like, they have a root kit and it works so why reinvent the wheel? They have an attack payload so why reinvent the wheel? Just plug and play all the packages you need until you can compromise your target device.</div><br/></div></div></div></div><div id="38790333" class="c"><input type="checkbox" id="c-38790333" checked=""/><div class="controls bullet"><span class="by">throwaway2037</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38788381">prev</a><span>|</span><a href="#38787599">next</a><span>|</span><label class="collapse" for="c-38790333">[-]</label><label class="expand" for="c-38790333">[1 more]</label></div><br/><div class="children"><div class="content">&gt; truly phenomenal research capabilities<p>Maybe a nation state, e.g., APT?</div><br/></div></div><div id="38787599" class="c"><input type="checkbox" id="c-38787599" checked=""/><div class="controls bullet"><span class="by">jsjohnst</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38790333">prev</a><span>|</span><a href="#38789922">next</a><span>|</span><label class="collapse" for="c-38787599">[-]</label><label class="expand" for="c-38787599">[2 more]</label></div><br/><div class="children"><div class="content">Seems likely a compromise at the GPU or ARM side as equally possible routes.</div><br/><div id="38790002" class="c"><input type="checkbox" id="c-38790002" checked=""/><div class="controls bullet"><span class="by">stephen_g</span><span>|</span><a href="#38785043">root</a><span>|</span><a href="#38787599">parent</a><span>|</span><a href="#38789922">next</a><span>|</span><label class="collapse" for="c-38790002">[-]</label><label class="expand" for="c-38790002">[1 more]</label></div><br/><div class="children"><div class="content">What do you mean? Both the GPU and CPU design are proprietary to Apple. They used to use regular ARM designed cores but the last one of those before switching to their own core design was something like the A5 days (from memory). It uses the ARM instruction set but isn’t actually designed by ARM at all.<p>Similar for the GPU too. They may have started with HDL licensed from others (like I think their GPU might actually have been directly based on the PowerVR ones they used to use, but I believe the ARM one is basically from-scratch) but this vulnerability seems unlikely to have existed since then…</div><br/></div></div></div></div><div id="38789922" class="c"><input type="checkbox" id="c-38789922" checked=""/><div class="controls bullet"><span class="by">henriquez</span><span>|</span><a href="#38785043">parent</a><span>|</span><a href="#38787599">prev</a><span>|</span><a href="#38787713">next</a><span>|</span><label class="collapse" for="c-38789922">[-]</label><label class="expand" for="c-38789922">[1 more]</label></div><br/><div class="children"><div class="content">This is a fairly incredible attack, and agree with your analysis. The hidden Safari tab portion where they “re-hack” the device could be bad organizational siloing as you mentioned or indicative of a “build your virus” approach that script kiddies used in the 90s. Could be a modular design for rapid adaptation, ie. perhaps less targeted.</div><br/></div></div></div></div><div id="38787197" class="c"><input type="checkbox" id="c-38787197" checked=""/><div class="controls bullet"><span class="by">DantesKite</span><span>|</span><a href="#38785043">prev</a><span>|</span><a href="#38785017">next</a><span>|</span><label class="collapse" for="c-38787197">[-]</label><label class="expand" for="c-38787197">[1 more]</label></div><br/><div class="children"><div class="content">Steve Weis on Twitter described it best:<p>“This iMessage exploit is crazy. TrueType vulnerability that has existed since the 90s, 2 kernel exploits, a browser exploit, and an undocumented hardware feature that was not used in shipped software”<p><a href="https:&#x2F;&#x2F;x.com&#x2F;sweis&#x2F;status&#x2F;1740092722487361809?s=46&amp;t=E3U2EI7EXIhlBQmxg6oZ2g" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;sweis&#x2F;status&#x2F;1740092722487361809?s=46&amp;t=E3U2EI...</a></div><br/></div></div><div id="38785017" class="c"><input type="checkbox" id="c-38785017" checked=""/><div class="controls bullet"><span class="by">Muehe</span><span>|</span><a href="#38787197">prev</a><span>|</span><a href="#38787755">next</a><span>|</span><label class="collapse" for="c-38785017">[-]</label><label class="expand" for="c-38785017">[2 more]</label></div><br/><div class="children"><div class="content">For those interested in the talk by the Kaspersky researches, the cleaned video isn&#x27;t uploaded yet but you can find a stream replay here:<p><a href="https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;a91c6e01-49cf-4227-baae-aece190e9de5" rel="nofollow">https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;a91c6e01-49cf-422...</a><p>(talk starts at minute 26:20)</div><br/><div id="38790728" class="c"><input type="checkbox" id="c-38790728" checked=""/><div class="controls bullet"><span class="by">Sweepi</span><span>|</span><a href="#38785017">parent</a><span>|</span><a href="#38787755">next</a><span>|</span><label class="collapse" for="c-38790728">[-]</label><label class="expand" for="c-38790728">[1 more]</label></div><br/><div class="children"><div class="content">...and its online: <a href="https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_what_you_get_when_attack_iphones_of_researchers" rel="nofollow">https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_wh...</a></div><br/></div></div></div></div><div id="38787755" class="c"><input type="checkbox" id="c-38787755" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38785017">prev</a><span>|</span><a href="#38788735">next</a><span>|</span><label class="collapse" for="c-38787755">[-]</label><label class="expand" for="c-38787755">[4 more]</label></div><br/><div class="children"><div class="content">Coresight is not some backdoor - it&#x27;s a debug feature of all ARM CPU&#x27;s.  This looks like a necessary extension to coresight to work with Apples memory protection stuff.<p>Even though no public documentation exists, I&#x27;m sure thousands of Apple engineers have access to a modded gdb or other tooling to make use of it.</div><br/><div id="38788830" class="c"><input type="checkbox" id="c-38788830" checked=""/><div class="controls bullet"><span class="by">repiret</span><span>|</span><a href="#38787755">parent</a><span>|</span><a href="#38788724">next</a><span>|</span><label class="collapse" for="c-38788830">[-]</label><label class="expand" for="c-38788830">[1 more]</label></div><br/><div class="children"><div class="content">One persons debug tool is another’s back door.</div><br/></div></div><div id="38788724" class="c"><input type="checkbox" id="c-38788724" checked=""/><div class="controls bullet"><span class="by">smallnix</span><span>|</span><a href="#38787755">parent</a><span>|</span><a href="#38788830">prev</a><span>|</span><a href="#38788735">next</a><span>|</span><label class="collapse" for="c-38788724">[-]</label><label class="expand" for="c-38788724">[2 more]</label></div><br/><div class="children"><div class="content">That does not explain the weird hashing.</div><br/><div id="38789965" class="c"><input type="checkbox" id="c-38789965" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#38787755">root</a><span>|</span><a href="#38788724">parent</a><span>|</span><a href="#38788735">next</a><span>|</span><label class="collapse" for="c-38789965">[-]</label><label class="expand" for="c-38789965">[1 more]</label></div><br/><div class="children"><div class="content">As explained by marcan: it&#x27;s not &quot;hashing&quot;, it&#x27;s an error-correcting code. Much more understandable in that light.<p><a href="https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583" rel="nofollow">https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583</a></div><br/></div></div></div></div></div></div><div id="38788735" class="c"><input type="checkbox" id="c-38788735" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38787755">prev</a><span>|</span><a href="#38786185">next</a><span>|</span><label class="collapse" for="c-38788735">[-]</label><label class="expand" for="c-38788735">[6 more]</label></div><br/><div class="children"><div class="content">As its about a 37c3 presentation here a comment from Fefe¹ in German
<a href="https:&#x2F;&#x2F;blog.fefe.de&#x2F;?ts=9b729398" rel="nofollow">https:&#x2F;&#x2F;blog.fefe.de&#x2F;?ts=9b729398</a><p>According to him the exploit chain was likely worth in the region of a 8-digit dollar value.<p>¹ <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Felix_von_Leitner" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Felix_von_Leitner</a><p>I guess somebody is going to get fired.</div><br/><div id="38790499" class="c"><input type="checkbox" id="c-38790499" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38788735">parent</a><span>|</span><a href="#38786185">next</a><span>|</span><label class="collapse" for="c-38790499">[-]</label><label class="expand" for="c-38790499">[5 more]</label></div><br/><div class="children"><div class="content">Why? Having exploits “burned” is part of the business.</div><br/><div id="38790529" class="c"><input type="checkbox" id="c-38790529" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38788735">root</a><span>|</span><a href="#38790499">parent</a><span>|</span><a href="#38786185">next</a><span>|</span><label class="collapse" for="c-38790529">[-]</label><label class="expand" for="c-38790529">[4 more]</label></div><br/><div class="children"><div class="content">Exploit yes<p>Decade old Backdoors no</div><br/><div id="38790633" class="c"><input type="checkbox" id="c-38790633" checked=""/><div class="controls bullet"><span class="by">_kbh_</span><span>|</span><a href="#38788735">root</a><span>|</span><a href="#38790529">parent</a><span>|</span><a href="#38790915">prev</a><span>|</span><a href="#38786185">next</a><span>|</span><label class="collapse" for="c-38790633">[-]</label><label class="expand" for="c-38790633">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Decade old Backdoors no<p>I really doubt it&#x27;s a backdoor after reading the blog post and this thread chain from a prolific M1 MacBook hacker (macran) I think it was just an unused or very rarely used feature that was left enabled by accident.<p><a href="https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583" rel="nofollow">https:&#x2F;&#x2F;social.treehouse.systems&#x2F;@marcan&#x2F;111655847458820583</a><p>Some choice quotes.<p><i>First, yeah, the dbgwrap stuff makes perfect sense. I knew about it for the main CPUs, makes perfect sense it&#x27;d exist for the ASCs too. Someone had a lightbulb moment. We might even be able to use some of those tricks for debugging stuff ourselves :)</i><p><i>Second, that &quot;hash&quot; is almost certainly not a hash. It&#x27;s an ECC code*. I bet this is a cache RAM debug register, and it&#x27;s writing directly to the raw cache memory array, including the ECC bits, so it has to manually calculate them (yes, caches in Apple SoCs have ECC, I know at least AMCC does and there&#x27;s no reason to think GPU&#x2F;ASC caches wouldn&#x27;t too). The &quot;sbox&quot; is just the order of the input bits to the ECC generator, and the algorithm is a textbook ECC code. I don&#x27;t know why it&#x27;s somewhat interestingly shuffled like that, but I bet there&#x27;s a hardware reason (I think for some of these things they&#x27;ll even let the hardware synthesis shuffle the bits to whatever happens to be physically optimal, and that&#x27;s why you won&#x27;t find the same table anywhere else).</i></div><br/><div id="38790947" class="c"><input type="checkbox" id="c-38790947" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38788735">root</a><span>|</span><a href="#38790633">parent</a><span>|</span><a href="#38786185">next</a><span>|</span><label class="collapse" for="c-38790947">[-]</label><label class="expand" for="c-38790947">[1 more]</label></div><br/><div class="children"><div class="content">&gt;I really doubt it&#x27;s a backdoor after reading the blog post and this thread chain from a prolific M1 MacBook hacker (macran) I think it was just an unused or very rarely used feature that was left enabled by accident.<p>Why? Apple isnt exactly a small family business and this is quite the drastic &quot;feature&quot; to be left enabled by accident.<p>How would one look from your perspective?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38786185" class="c"><input type="checkbox" id="c-38786185" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38788735">prev</a><span>|</span><a href="#38785311">next</a><span>|</span><label class="collapse" for="c-38786185">[-]</label><label class="expand" for="c-38786185">[3 more]</label></div><br/><div class="children"><div class="content">What are the chances this MMIO register could have been discovered by brute force probing every register address?<p>Mere differences in timing could have indicated the address was a valid address, and then the hash could perhaps have been brute forced too since it is effectively  a 20 bit hash.</div><br/><div id="38788974" class="c"><input type="checkbox" id="c-38788974" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#38786185">parent</a><span>|</span><a href="#38786851">next</a><span>|</span><label class="collapse" for="c-38788974">[-]</label><label class="expand" for="c-38788974">[1 more]</label></div><br/><div class="children"><div class="content">It looks like the registers could have been identified fairly easily via brute force. They&#x27;re physically close to documented GPU registers, and accessing them triggers a GPU panic, which is how the researchers attributed them to the GPU component. The attackers could have used that same test to identify the existence of the registers.<p>The part that&#x27;s less easily explained is how they were able to reconstruct a custom sbox table to execute the debug code. That&#x27;s where the &quot;insider threat&quot; insinuations are strongest, but personally I&#x27;m not convinced that it precludes any number of other plausible explanations. For example, the attackers could have extracted the sbox from: older firmwares, OTA update patches, pre-release development devices (probably purchasable on ebay at some points), iOS beta releases, or a bunch of other leaky vectors.<p>The researcher basically says &quot;I couldn&#x27;t find this sbox table in any other binary where I looked for it.&quot; Well, that&#x27;s not necessarily surprising since it appears to be Apple specific and thus there are a limited number of binaries where it might have appeared. And as the researcher notes, this includes now unpublished binaries that might have been mistakenly released. It&#x27;s totally plausible that the attackers got lucky at some point while they were systematically sniffing for this sort of leak, and that the researcher is unlikely to have the same luck any time soon.</div><br/></div></div><div id="38786851" class="c"><input type="checkbox" id="c-38786851" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38786185">parent</a><span>|</span><a href="#38788974">prev</a><span>|</span><a href="#38785311">next</a><span>|</span><label class="collapse" for="c-38786851">[-]</label><label class="expand" for="c-38786851">[1 more]</label></div><br/><div class="children"><div class="content">Looking at that sbox implementation, I can&#x27;t believe it was implemented as a lookup table in the hardware of the chip - there must be some condensed Boolean expression that gives the same result.<p>The fact the attackers didn&#x27;t know that Boolean expression suggests they reverse engineered it rather than had documentation.</div><br/></div></div></div></div><div id="38785311" class="c"><input type="checkbox" id="c-38785311" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38786185">prev</a><span>|</span><a href="#38784976">next</a><span>|</span><label class="collapse" for="c-38785311">[-]</label><label class="expand" for="c-38785311">[7 more]</label></div><br/><div class="children"><div class="content">iMessage can be disabled by local MDM for supervised devices, via free Apple Configurator in macOS app store, <a href="https:&#x2F;&#x2F;support.apple.com&#x2F;guide&#x2F;deployment&#x2F;restrictions-for-iphone-and-ipad-dep0f7dd3d8&#x2F;web" rel="nofollow">https:&#x2F;&#x2F;support.apple.com&#x2F;guide&#x2F;deployment&#x2F;restrictions-for-...</a><p><pre><code>  For Wi-Fi–only devices, the Messages app is hidden. 
  For devices with Wi-Fi and cellular, the Messages app is still available, but only the SMS&#x2F;MMS service can be used.
</code></pre>
SMS&#x2F;MMS messages and non-emergency cellular radio traffic can be disabled by a SIM PIN, e.g. when using device for an extended period via WiFi.</div><br/><div id="38785556" class="c"><input type="checkbox" id="c-38785556" checked=""/><div class="controls bullet"><span class="by">fishywang</span><span>|</span><a href="#38785311">parent</a><span>|</span><a href="#38784976">next</a><span>|</span><label class="collapse" for="c-38785556">[-]</label><label class="expand" for="c-38785556">[6 more]</label></div><br/><div class="children"><div class="content">We purchased an iPad with cellular, with the plan to put my home country&#x27;s sim card in it so I can still receive SMS (as most of the banks there still requires SMS verification when you login), and it turns out that iPad with cellular does not really show you SMS&#x27;s that&#x27;s not from the carrier of the sim card.</div><br/><div id="38785773" class="c"><input type="checkbox" id="c-38785773" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38785311">root</a><span>|</span><a href="#38785556">parent</a><span>|</span><a href="#38788659">next</a><span>|</span><label class="collapse" for="c-38785773">[-]</label><label class="expand" for="c-38785773">[3 more]</label></div><br/><div class="children"><div class="content"><i>&gt; iPad with cellular does not really show you SMS&#x27;s that&#x27;s not from the carrier of the sim card.</i><p>Does iPad support SMS? The cellular line is usually only for data, <a href="https:&#x2F;&#x2F;www.howtogeek.com&#x2F;710767&#x2F;how-to-send-sms-text-messages-from-an-ipad&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.howtogeek.com&#x2F;710767&#x2F;how-to-send-sms-text-messag...</a><p><pre><code>  iPads can&#x27;t send SMS text messages through Apple&#x27;s Messages app. Even if you have an iPad with a cellular data plan for mobile internet on the go, you still can&#x27;t send SMS text messages.</code></pre></div><br/><div id="38786313" class="c"><input type="checkbox" id="c-38786313" checked=""/><div class="controls bullet"><span class="by">fishywang</span><span>|</span><a href="#38785311">root</a><span>|</span><a href="#38785773">parent</a><span>|</span><a href="#38788659">next</a><span>|</span><label class="collapse" for="c-38786313">[-]</label><label class="expand" for="c-38786313">[2 more]</label></div><br/><div class="children"><div class="content">Apple&#x27;s own user guide (<a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20201223140550&#x2F;https:&#x2F;&#x2F;support.apple.com&#x2F;guide&#x2F;ipad&#x2F;set-up-messages-ipad70482978&#x2F;ipados" rel="nofollow">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20201223140550&#x2F;https:&#x2F;&#x2F;support.a...</a>) suggests otherwise:<p>&gt;In the Messages app , you can send text messages as SMS&#x2F;MMS messages through your cellular service, or ...<p>Also my own experience is that it at least can receive SMS text messages, just it won&#x27;t show you if it&#x27;s not from your carrier (if it&#x27;s from your carrier, it shows you via a popup window or something, can&#x27;t really remember as that was several years ago).</div><br/><div id="38786410" class="c"><input type="checkbox" id="c-38786410" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38785311">root</a><span>|</span><a href="#38786313">parent</a><span>|</span><a href="#38788659">next</a><span>|</span><label class="collapse" for="c-38786410">[-]</label><label class="expand" for="c-38786410">[1 more]</label></div><br/><div class="children"><div class="content">No direct experience to share, but that sentence may be referencing Continuity via iCloud, which is optional:<p><pre><code>  With Continuity, you can send and receive SMS&#x2F;MMS messages on iPad using the cellular connection on your iPhone.
</code></pre>
<i>&gt; if it&#x27;s from your carrier, it shows you via a popup window</i><p>If it&#x27;s not shown in Apple&#x27;s Messages app, maybe it was a carrier-specific app?</div><br/></div></div></div></div></div></div><div id="38788659" class="c"><input type="checkbox" id="c-38788659" checked=""/><div class="controls bullet"><span class="by">fsckboy</span><span>|</span><a href="#38785311">root</a><span>|</span><a href="#38785556">parent</a><span>|</span><a href="#38785773">prev</a><span>|</span><a href="#38784976">next</a><span>|</span><label class="collapse" for="c-38788659">[-]</label><label class="expand" for="c-38788659">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve never understood why iPads can&#x27;t be used as phones with an ordinary cellphone SIM. Is it simply because Apple doesn&#x27;t want to pay a Qualcomm licensing fee or some equivalent? Who is it in the chain&#x2F;ecosystem that does not want tablets being used as full phones, the carriers? Apple?</div><br/><div id="38790506" class="c"><input type="checkbox" id="c-38790506" checked=""/><div class="controls bullet"><span class="by">jrockway</span><span>|</span><a href="#38785311">root</a><span>|</span><a href="#38788659">parent</a><span>|</span><a href="#38784976">next</a><span>|</span><label class="collapse" for="c-38790506">[-]</label><label class="expand" for="c-38790506">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing it doesn&#x27;t fit well with the carriers&#x27; price structure.  Adding a tablet &#x2F; smart watch &#x2F; etc. is cheaper than adding another phone to your account.   I wouldn&#x27;t have a cellular iPad if it was a lot extra per month, but I think I pay $10 for both the tablet and the watch, which is fine with me.</div><br/></div></div></div></div></div></div></div></div><div id="38784976" class="c"><input type="checkbox" id="c-38784976" checked=""/><div class="controls bullet"><span class="by">soupdiver</span><span>|</span><a href="#38785311">prev</a><span>|</span><a href="#38786948">next</a><span>|</span><label class="collapse" for="c-38784976">[-]</label><label class="expand" for="c-38784976">[5 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;11859" rel="nofollow">https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;11859</a></div><br/><div id="38786747" class="c"><input type="checkbox" id="c-38786747" checked=""/><div class="controls bullet"><span class="by">mb4nck</span><span>|</span><a href="#38784976">parent</a><span>|</span><a href="#38785122">next</a><span>|</span><label class="collapse" for="c-38786747">[-]</label><label class="expand" for="c-38786747">[1 more]</label></div><br/><div class="children"><div class="content">The (first?) version of the real recording is now up:
<a href="https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_what_you_get_when_attack_iphones_of_researchers" rel="nofollow">https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_wh...</a></div><br/></div></div><div id="38785122" class="c"><input type="checkbox" id="c-38785122" checked=""/><div class="controls bullet"><span class="by">contingencies</span><span>|</span><a href="#38784976">parent</a><span>|</span><a href="#38786747">prev</a><span>|</span><a href="#38786948">next</a><span>|</span><label class="collapse" for="c-38785122">[-]</label><label class="expand" for="c-38785122">[3 more]</label></div><br/><div class="children"><div class="content">Begins @ 27:21<p>In addition contents of the presentation, in terms of timeline...<p>2018 (September): First undocumented MMIO-present CPU launched, Apple A12 Bionic SOC.<p>2021 (December): Early exploit chain infrastructure backuprabbit.com created 2021-12-15T18:33:19Z, cloudsponcer.com created 2021-12-17T16:33:50Z.<p>2022 (April): Later exploit chain infrastructure snoweeanalytics.com created 2022-04-20T15:09:17Z suggesting exploit weaponized by this date.<p>2023 (December): Approximate date of capture (working back from &quot;half year&quot; quoted analysis period + mid-2023 Apple reports.<p>The presenters also state that signs within the code reportedly suggested the origin APT group has used the same attack codebase for &quot;10 years&quot; (ie. since ~2013) and also uses it to attack MacOS laptops (with antivirus circumvention). The presenters note that the very &quot;backdoor-like&quot; signed debug functionality may have been included in the chips without Apple&#x27;s knowledge, eg. by the GPU developer.<p>So... in less than 3.5 years since the first vulnerable chip hit the market, a series of undocumented debug MMIOs in the Apple CoreSight GPU requiring knowledge of a lengthy secret were successfully weaponized and exploited by an established APT group with a 10+ year history. Kaspersky are &quot;not speculating&quot; but IMHO this is unlikely to be anything but a major state actor.<p>Theory: I guess since Apple was handed ample evidence of ~40 self-doxxed APT-related AppleIDs, we can judge the identity using any follow-up national security type announcements from the US. If all is quiet it&#x27;s probably the NSA.</div><br/><div id="38785204" class="c"><input type="checkbox" id="c-38785204" checked=""/><div class="controls bullet"><span class="by">mike_hearn</span><span>|</span><a href="#38784976">root</a><span>|</span><a href="#38785122">parent</a><span>|</span><a href="#38786948">next</a><span>|</span><label class="collapse" for="c-38785204">[-]</label><label class="expand" for="c-38785204">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s really a pity they explain all the mistakes that helped the malware be detected.</div><br/><div id="38786005" class="c"><input type="checkbox" id="c-38786005" checked=""/><div class="controls bullet"><span class="by">halJordan</span><span>|</span><a href="#38784976">root</a><span>|</span><a href="#38785204">parent</a><span>|</span><a href="#38786948">next</a><span>|</span><label class="collapse" for="c-38786005">[-]</label><label class="expand" for="c-38786005">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not, it really isnt. Honestly just apply this mentality to one other scenario to test the waters. We should stop publishing yara rules because it flips our hand to the malware makers? It&#x27;s nonsense to even say.</div><br/></div></div></div></div></div></div></div></div><div id="38786948" class="c"><input type="checkbox" id="c-38786948" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38784976">prev</a><span>|</span><a href="#38784603">next</a><span>|</span><label class="collapse" for="c-38786948">[-]</label><label class="expand" for="c-38786948">[4 more]</label></div><br/><div class="children"><div class="content">Notice that the hash value for a data write of all zero&#x27;s is zero...<p>And for a single bit, the hash value is a single value from the sbox table.   That means this hash algorithm could reasonably have been reverse engineered without internal documentation.</div><br/><div id="38787304" class="c"><input type="checkbox" id="c-38787304" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38786948">parent</a><span>|</span><a href="#38784603">next</a><span>|</span><label class="collapse" for="c-38787304">[-]</label><label class="expand" for="c-38787304">[3 more]</label></div><br/><div class="children"><div class="content">This &#x27;smells&#x27; like a typical way to prevent memory writes to random addresses accidentally triggering this hardware.  Doesn&#x27;t look like it was intended as a security feature.<p>In fact, this is how I&#x27;d implement it if someone said to me it was important that bugs couldn&#x27;t lead to random writes.  This implementation also effectively prevents someone using this feature whilst giving a buffer address they don&#x27;t know the contents of.<p>10 bits of security is probably enough for that as long as you reboot the system whenever the hash value is wrong.   The coresight debug functionality can totally reboot the system if it wants to.</div><br/><div id="38789187" class="c"><input type="checkbox" id="c-38789187" checked=""/><div class="controls bullet"><span class="by">the-rc</span><span>|</span><a href="#38786948">root</a><span>|</span><a href="#38787304">parent</a><span>|</span><a href="#38787719">next</a><span>|</span><label class="collapse" for="c-38789187">[-]</label><label class="expand" for="c-38789187">[1 more]</label></div><br/><div class="children"><div class="content">On the Amiga, you had to write to a blitter control register (BLTSIZE?) twice with the same value or it wouldn&#x27;t do anything. This might be the same, only a lot more paranoid.<p>But it might also be a backdoor, intended or not.</div><br/></div></div><div id="38787719" class="c"><input type="checkbox" id="c-38787719" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#38786948">root</a><span>|</span><a href="#38787304">parent</a><span>|</span><a href="#38789187">prev</a><span>|</span><a href="#38784603">next</a><span>|</span><label class="collapse" for="c-38787719">[-]</label><label class="expand" for="c-38787719">[1 more]</label></div><br/><div class="children"><div class="content">Like a CRC? I&#x27;m reminded of the the Broadcom compression algorithm that required tedious reverse engineering, or a look at the Wikipedia page with sample code.</div><br/></div></div></div></div></div></div><div id="38784603" class="c"><input type="checkbox" id="c-38784603" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#38786948">prev</a><span>|</span><a href="#38789704">next</a><span>|</span><label class="collapse" for="c-38784603">[-]</label><label class="expand" for="c-38784603">[13 more]</label></div><br/><div class="children"><div class="content">The extra hardware registers might have been discovered by examining the chip itself. One could find where the registers were on it, and notice some extra registers, then do some experimenting to see what they did.</div><br/><div id="38784880" class="c"><input type="checkbox" id="c-38784880" checked=""/><div class="controls bullet"><span class="by">mhh__</span><span>|</span><a href="#38784603">parent</a><span>|</span><a href="#38787424">next</a><span>|</span><label class="collapse" for="c-38784880">[-]</label><label class="expand" for="c-38784880">[1 more]</label></div><br/><div class="children"><div class="content">Maybe, but chips already have vast, vast, quantities of physical registers in a big blob.<p>Assuming it wasn&#x27;t a lucky guess, timing attacks are often used to find this stuff.</div><br/></div></div><div id="38787424" class="c"><input type="checkbox" id="c-38787424" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#38784603">parent</a><span>|</span><a href="#38784880">prev</a><span>|</span><a href="#38785812">next</a><span>|</span><label class="collapse" for="c-38787424">[-]</label><label class="expand" for="c-38787424">[4 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t it easier just to pay to one of hundreds employees having access to chip design? Or even get it without paying by appealing to patriotism?</div><br/><div id="38787913" class="c"><input type="checkbox" id="c-38787913" checked=""/><div class="controls bullet"><span class="by">sangnoir</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38787424">parent</a><span>|</span><a href="#38788084">next</a><span>|</span><label class="collapse" for="c-38787913">[-]</label><label class="expand" for="c-38787913">[2 more]</label></div><br/><div class="children"><div class="content">How many ex-Apple employees work(ed) at NSA? It may just have been the right person doing their regular 9-5 job, with no subterfuge. The list of employers for Hardware security folks is likely a  couple of dozen companies, and Apple and NSA are among the most prestigious of them. I expect some employees to move in both directions.</div><br/><div id="38788567" class="c"><input type="checkbox" id="c-38788567" checked=""/><div class="controls bullet"><span class="by">cryu</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38787913">parent</a><span>|</span><a href="#38788084">next</a><span>|</span><label class="collapse" for="c-38788567">[-]</label><label class="expand" for="c-38788567">[1 more]</label></div><br/><div class="children"><div class="content">I know of two, one from my team.  Don&#x27;t know how long they stayed there, though.</div><br/></div></div></div></div><div id="38788084" class="c"><input type="checkbox" id="c-38788084" checked=""/><div class="controls bullet"><span class="by">WitCanStain</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38787424">parent</a><span>|</span><a href="#38787913">prev</a><span>|</span><a href="#38785812">next</a><span>|</span><label class="collapse" for="c-38788084">[-]</label><label class="expand" for="c-38788084">[1 more]</label></div><br/><div class="children"><div class="content">Or just covertly tell Apple to hand over its documentation &#x2F; to knowingly leave gaps in the defenses for NSA to exploit.</div><br/></div></div></div></div><div id="38785812" class="c"><input type="checkbox" id="c-38785812" checked=""/><div class="controls bullet"><span class="by">gusfoo</span><span>|</span><a href="#38784603">parent</a><span>|</span><a href="#38787424">prev</a><span>|</span><a href="#38784707">next</a><span>|</span><label class="collapse" for="c-38785812">[-]</label><label class="expand" for="c-38785812">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The extra hardware registers might have been discovered by examining the chip itself.<p>Perhaps. But it&#x27;s easier to phone the technical librarian and say &quot;Hi! I&#x27;m Bob from the password inspection department. Can you verify your current password for me?&quot;</div><br/></div></div><div id="38784707" class="c"><input type="checkbox" id="c-38784707" checked=""/><div class="controls bullet"><span class="by">smith7018</span><span>|</span><a href="#38784603">parent</a><span>|</span><a href="#38785812">prev</a><span>|</span><a href="#38786146">next</a><span>|</span><label class="collapse" for="c-38784707">[-]</label><label class="expand" for="c-38784707">[5 more]</label></div><br/><div class="children"><div class="content">Do you know how this is possible? Would decapping the SoC or taking an xray of it provide a physical map of the registers?</div><br/><div id="38784902" class="c"><input type="checkbox" id="c-38784902" checked=""/><div class="controls bullet"><span class="by">mhh__</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38784707">parent</a><span>|</span><a href="#38786146">next</a><span>|</span><label class="collapse" for="c-38784902">[-]</label><label class="expand" for="c-38784902">[4 more]</label></div><br/><div class="children"><div class="content">You can find the register file relatively easily because it&#x27;s a block of memory that&#x27;s the same on each core but isn&#x27;t cache, but it isn&#x27;t a 1:1 map from architectural registers that we would recognize: the chip is designed to find an optimal allocation of slots in the register file to runtime values.</div><br/><div id="38785616" class="c"><input type="checkbox" id="c-38785616" checked=""/><div class="controls bullet"><span class="by">pm215</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38784902">parent</a><span>|</span><a href="#38785581">next</a><span>|</span><label class="collapse" for="c-38785616">[-]</label><label class="expand" for="c-38785616">[2 more]</label></div><br/><div class="children"><div class="content">These particular registers aren&#x27;t part of the CPU proper anyway, so not in the register file in that sense -- they&#x27;re mmio mapped, and <a href="https:&#x2F;&#x2F;securelist.com&#x2F;operation-triangulation-the-last-hardware-mystery&#x2F;111669&#x2F;" rel="nofollow">https:&#x2F;&#x2F;securelist.com&#x2F;operation-triangulation-the-last-hard...</a> concludes that they are &quot;a block of CoreSight MMIO debug registers for the GPU coprocessor&quot;.</div><br/><div id="38787130" class="c"><input type="checkbox" id="c-38787130" checked=""/><div class="controls bullet"><span class="by">mhh__</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38785616">parent</a><span>|</span><a href="#38785581">next</a><span>|</span><label class="collapse" for="c-38787130">[-]</label><label class="expand" for="c-38787130">[1 more]</label></div><br/><div class="children"><div class="content">Indeed, my bad for only skimming.</div><br/></div></div></div></div><div id="38785581" class="c"><input type="checkbox" id="c-38785581" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38784603">root</a><span>|</span><a href="#38784902">parent</a><span>|</span><a href="#38785616">prev</a><span>|</span><a href="#38786146">next</a><span>|</span><label class="collapse" for="c-38785581">[-]</label><label class="expand" for="c-38785581">[1 more]</label></div><br/><div class="children"><div class="content">That’s where the GPRs would live. There’s no reason you have to put weird MMIO there too.</div><br/></div></div></div></div></div></div><div id="38786146" class="c"><input type="checkbox" id="c-38786146" checked=""/><div class="controls bullet"><span class="by">_ink_</span><span>|</span><a href="#38784603">parent</a><span>|</span><a href="#38784707">prev</a><span>|</span><a href="#38789704">next</a><span>|</span><label class="collapse" for="c-38786146">[-]</label><label class="expand" for="c-38786146">[1 more]</label></div><br/><div class="children"><div class="content">Maybe, or somebody talked.</div><br/></div></div></div></div><div id="38789704" class="c"><input type="checkbox" id="c-38789704" checked=""/><div class="controls bullet"><span class="by">trustingtrust</span><span>|</span><a href="#38784603">prev</a><span>|</span><a href="#38786595">next</a><span>|</span><label class="collapse" for="c-38789704">[-]</label><label class="expand" for="c-38789704">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Hardware security very often relies on “security through obscurity”, and it is much more difficult to reverse-engineer than software, but this is a flawed approach, because sooner or later, all secrets are revealed.<p>The later works when you are not as big as Apple. When you are as big as Apple, you are a very hot target for attackers. There is always the effort vs reward when it comes to exploiting vulnerabilities. The amount of effort that goes into all this is worth thousands of dollars even if someone is doing it just for research. If I was doing this for some random aliexpress board it would be worth nothing and probably security by obscurity would mean no one really cares and the later part works here. But I wonder what Apple is thinking when they use obscurity cause people must start working on exploiting new hardware from day 1. You literally can get one on every corner in a city these days. Hardware Security by obscurity for example would be fine for cards sold by someone like nvidia to only some cloud customers and those are then assumed obsolete in a few years so even if someone gets those on eBay the reward is very low. iPhones on the other hand are a very consumer device and people hang on to their devices for very long.</div><br/></div></div><div id="38786595" class="c"><input type="checkbox" id="c-38786595" checked=""/><div class="controls bullet"><span class="by">I_Am_Nous</span><span>|</span><a href="#38789704">prev</a><span>|</span><a href="#38787862">next</a><span>|</span><label class="collapse" for="c-38786595">[-]</label><label class="expand" for="c-38786595">[10 more]</label></div><br/><div class="children"><div class="content">&gt;Although infections didn’t survive a reboot<p>Reminder to reboot your iPhone at least weekly if you are concerned about this kind of attack.</div><br/><div id="38787904" class="c"><input type="checkbox" id="c-38787904" checked=""/><div class="controls bullet"><span class="by">x1sec</span><span>|</span><a href="#38786595">parent</a><span>|</span><a href="#38789475">next</a><span>|</span><label class="collapse" for="c-38787904">[-]</label><label class="expand" for="c-38787904">[3 more]</label></div><br/><div class="children"><div class="content">In a week, a lot of data can be exfiltrated. Then after you have rebooted, the threat actor reinfects your device.<p>Frequently rebooting the device can’t hurt but it likely isn’t going to prevent a threat actor from achieving their objectives.<p>The best mitigation we have is to enable lockdown mode.</div><br/><div id="38788020" class="c"><input type="checkbox" id="c-38788020" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38786595">root</a><span>|</span><a href="#38787904">parent</a><span>|</span><a href="#38789475">next</a><span>|</span><label class="collapse" for="c-38788020">[-]</label><label class="expand" for="c-38788020">[2 more]</label></div><br/><div class="children"><div class="content">Why not both? Lockdown + frequent reboots.</div><br/><div id="38789128" class="c"><input type="checkbox" id="c-38789128" checked=""/><div class="controls bullet"><span class="by">x1sec</span><span>|</span><a href="#38786595">root</a><span>|</span><a href="#38788020">parent</a><span>|</span><a href="#38789475">next</a><span>|</span><label class="collapse" for="c-38789128">[-]</label><label class="expand" for="c-38789128">[1 more]</label></div><br/><div class="children"><div class="content">How frequent?</div><br/></div></div></div></div></div></div><div id="38789475" class="c"><input type="checkbox" id="c-38789475" checked=""/><div class="controls bullet"><span class="by">HumanOstrich</span><span>|</span><a href="#38786595">parent</a><span>|</span><a href="#38787904">prev</a><span>|</span><a href="#38787150">next</a><span>|</span><label class="collapse" for="c-38789475">[-]</label><label class="expand" for="c-38789475">[1 more]</label></div><br/><div class="children"><div class="content">No, they could monitor when devices rebooted and re-infect them immediately, as the article states.</div><br/></div></div><div id="38787150" class="c"><input type="checkbox" id="c-38787150" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38786595">parent</a><span>|</span><a href="#38789475">prev</a><span>|</span><a href="#38787862">next</a><span>|</span><label class="collapse" for="c-38787150">[-]</label><label class="expand" for="c-38787150">[5 more]</label></div><br/><div class="children"><div class="content"><i>&gt; reboot your iPhone at least weekly</i><p>with the Hard Reset key sequence, <a href="https:&#x2F;&#x2F;www.wikihow.com&#x2F;Hard-Reset-an-iPhone" rel="nofollow">https:&#x2F;&#x2F;www.wikihow.com&#x2F;Hard-Reset-an-iPhone</a></div><br/><div id="38787570" class="c"><input type="checkbox" id="c-38787570" checked=""/><div class="controls bullet"><span class="by">wyre</span><span>|</span><a href="#38786595">root</a><span>|</span><a href="#38787150">parent</a><span>|</span><a href="#38787862">next</a><span>|</span><label class="collapse" for="c-38787570">[-]</label><label class="expand" for="c-38787570">[4 more]</label></div><br/><div class="children"><div class="content">Sorry for the lay question but what’s the benefit of the hard reset over a general restart?</div><br/><div id="38788398" class="c"><input type="checkbox" id="c-38788398" checked=""/><div class="controls bullet"><span class="by">Mattwmaster58</span><span>|</span><a href="#38786595">root</a><span>|</span><a href="#38787570">parent</a><span>|</span><a href="#38789181">next</a><span>|</span><label class="collapse" for="c-38788398">[-]</label><label class="expand" for="c-38788398">[1 more]</label></div><br/><div class="children"><div class="content">Layperson here so just guessing. If not using the hard reset method, the exploit might fake the reboot sequence to maintain its own persistence. AFAIK, a hard reset is built in hardware and thus impossible to fake.</div><br/></div></div><div id="38789181" class="c"><input type="checkbox" id="c-38789181" checked=""/><div class="controls bullet"><span class="by">carleton</span><span>|</span><a href="#38786595">root</a><span>|</span><a href="#38787570">parent</a><span>|</span><a href="#38788398">prev</a><span>|</span><a href="#38788088">next</a><span>|</span><label class="collapse" for="c-38789181">[-]</label><label class="expand" for="c-38789181">[1 more]</label></div><br/><div class="children"><div class="content">I believe they’re assuming that malware can do a pretend reboot whereas the hardware keystroke can’t be faked.</div><br/></div></div></div></div></div></div></div></div><div id="38787862" class="c"><input type="checkbox" id="c-38787862" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#38786595">prev</a><span>|</span><a href="#38789999">next</a><span>|</span><label class="collapse" for="c-38787862">[-]</label><label class="expand" for="c-38787862">[5 more]</label></div><br/><div class="children"><div class="content">I see that one of the steps in exploit was to use GPU registers to bypass kernel memory protection. Does it mean that the vulnerability cannot be fixed by an update and existing devices will stay vulnerable?</div><br/><div id="38788463" class="c"><input type="checkbox" id="c-38788463" checked=""/><div class="controls bullet"><span class="by">ipython</span><span>|</span><a href="#38787862">parent</a><span>|</span><a href="#38788259">next</a><span>|</span><label class="collapse" for="c-38788463">[-]</label><label class="expand" for="c-38788463">[1 more]</label></div><br/><div class="children"><div class="content">The mitigation is that the mmio range in question has been marked as unwritable in the device trees on recent versions of iOS.</div><br/></div></div><div id="38788259" class="c"><input type="checkbox" id="c-38788259" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38787862">parent</a><span>|</span><a href="#38788463">prev</a><span>|</span><a href="#38788358">next</a><span>|</span><label class="collapse" for="c-38788259">[-]</label><label class="expand" for="c-38788259">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;x.com&#x2F;alfiecg_dev&#x2F;status&#x2F;1740025569600020708" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;alfiecg_dev&#x2F;status&#x2F;1740025569600020708</a><p><pre><code>  It’s a hardware exploit, using undocumented registers. It can only be mitigated against, but not fully patched.</code></pre></div><br/></div></div><div id="38788358" class="c"><input type="checkbox" id="c-38788358" checked=""/><div class="controls bullet"><span class="by">flakiness</span><span>|</span><a href="#38787862">parent</a><span>|</span><a href="#38788259">prev</a><span>|</span><a href="#38789999">next</a><span>|</span><label class="collapse" for="c-38788358">[-]</label><label class="expand" for="c-38788358">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think there is any JIT on GPU and all the code has to go through a host-side kernel call so it should be able to protect the register I guess?</div><br/><div id="38790513" class="c"><input type="checkbox" id="c-38790513" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38787862">root</a><span>|</span><a href="#38788358">parent</a><span>|</span><a href="#38789999">next</a><span>|</span><label class="collapse" for="c-38790513">[-]</label><label class="expand" for="c-38790513">[1 more]</label></div><br/><div class="children"><div class="content">The kernel cannot protect against this, in fact the attackers have full read&#x2F;write control and code execution capabilities to mount this attack. The fix is blocking this range from being mapped using features that are more powerful than the kernel.</div><br/></div></div></div></div></div></div><div id="38789999" class="c"><input type="checkbox" id="c-38789999" checked=""/><div class="controls bullet"><span class="by">throwaway81523</span><span>|</span><a href="#38787862">prev</a><span>|</span><a href="#38787427">next</a><span>|</span><label class="collapse" for="c-38789999">[-]</label><label class="expand" for="c-38789999">[2 more]</label></div><br/><div class="children"><div class="content">Philip Zimmermann a while back was working on a secure phone product called the Black Phone.  I tried to convince him that a secure phone should not contain any microphones of any kind.  That sounds a bit weird for a phone, but it&#x27;s ok, if you want to make a voice call, just plug a headset into it for the duration of the call.  He wasn&#x27;t convinced, but this iphone exploit makes me believe it more than ever.</div><br/><div id="38790078" class="c"><input type="checkbox" id="c-38790078" checked=""/><div class="controls bullet"><span class="by">x1sec</span><span>|</span><a href="#38789999">parent</a><span>|</span><a href="#38787427">next</a><span>|</span><label class="collapse" for="c-38790078">[-]</label><label class="expand" for="c-38790078">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps a physical switch that connects or disconnects the electrical signal from the microphone to the handset could be a more convenient approach.<p>There is a photo of Mark Zuckerberg with a cut off 3.5mm jack plugged into his laptop - likely to achieve a similar outcome.</div><br/></div></div></div></div><div id="38787427" class="c"><input type="checkbox" id="c-38787427" checked=""/><div class="controls bullet"><span class="by">luke-stanley</span><span>|</span><a href="#38789999">prev</a><span>|</span><a href="#38789392">next</a><span>|</span><label class="collapse" for="c-38787427">[-]</label><label class="expand" for="c-38787427">[5 more]</label></div><br/><div class="children"><div class="content">I didn&#x27;t hear anyone mention fuzzing once. I guess there was probably very specific insider knowledge being made use of and they wanted to point a finger, which is fair enough I guess. I&#x27;m just a bit surprised that it has not been mentioned so far in the discussion. Anyhow it seems that a allow-list approach by Apple would have been better than a deny list approach! Literally not checking out of expected bounds!</div><br/><div id="38787504" class="c"><input type="checkbox" id="c-38787504" checked=""/><div class="controls bullet"><span class="by">camkego</span><span>|</span><a href="#38787427">parent</a><span>|</span><a href="#38787521">next</a><span>|</span><label class="collapse" for="c-38787504">[-]</label><label class="expand" for="c-38787504">[2 more]</label></div><br/><div class="children"><div class="content">This is a really good question.<p>Fuzzing is about searching a state-space of an entity: function, method, and I suppose even a hardware-block for unexpected or undefined, or maybe even undocumented behavior.<p>Certainly this could have been used by the exploiters of these bugs to find undocumented but desirable effects in the hardware of iOS hardware blocks or devices.</div><br/><div id="38789218" class="c"><input type="checkbox" id="c-38789218" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38787427">root</a><span>|</span><a href="#38787504">parent</a><span>|</span><a href="#38787521">next</a><span>|</span><label class="collapse" for="c-38789218">[-]</label><label class="expand" for="c-38789218">[1 more]</label></div><br/><div class="children"><div class="content">Its one of the major arguments against backdooring systems even if you think this to be acceptable.
In the end you create a backdoor for everyone, even if you dont do it as moronic as here. You are the hostile actor.</div><br/></div></div></div></div><div id="38787521" class="c"><input type="checkbox" id="c-38787521" checked=""/><div class="controls bullet"><span class="by">Alex3917</span><span>|</span><a href="#38787427">parent</a><span>|</span><a href="#38787504">prev</a><span>|</span><a href="#38789392">next</a><span>|</span><label class="collapse" for="c-38787521">[-]</label><label class="expand" for="c-38787521">[2 more]</label></div><br/><div class="children"><div class="content">If they were using a deny list, that sounds like an intentional backdoor.</div><br/><div id="38791222" class="c"><input type="checkbox" id="c-38791222" checked=""/><div class="controls bullet"><span class="by">luke-stanley</span><span>|</span><a href="#38787427">root</a><span>|</span><a href="#38787521">parent</a><span>|</span><a href="#38789392">next</a><span>|</span><label class="collapse" for="c-38791222">[-]</label><label class="expand" for="c-38791222">[1 more]</label></div><br/><div class="children"><div class="content">It might just be that they couldn&#x27;t think of another way to code it though.</div><br/></div></div></div></div></div></div><div id="38789392" class="c"><input type="checkbox" id="c-38789392" checked=""/><div class="controls bullet"><span class="by">g-b-r</span><span>|</span><a href="#38787427">prev</a><span>|</span><a href="#38785888">next</a><span>|</span><label class="collapse" for="c-38789392">[-]</label><label class="expand" for="c-38789392">[1 more]</label></div><br/><div class="children"><div class="content">Are hashes of the data ever used in known chip debugging features?<p>Since they&#x27;re supposed to be disabled in production, what would be their point?<p>I&#x27;m no electronic engineer, but isn&#x27;t it best for them to be fast and simple, to reduce the chance that they cause interference themselves..?<p>And isn&#x27;t it strongly unlikely that an attacker in the supply chain (TSMC??) would be able to reliably plant this in all Apple chips from the A12 to the A16 and the M1 ??</div><br/></div></div><div id="38785888" class="c"><input type="checkbox" id="c-38785888" checked=""/><div class="controls bullet"><span class="by">Despegar</span><span>|</span><a href="#38789392">prev</a><span>|</span><a href="#38786217">next</a><span>|</span><label class="collapse" for="c-38785888">[-]</label><label class="expand" for="c-38785888">[34 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious to know from experts if there&#x27;s anything Apple can do to create a step-change in terms of security of iPhones? Like if the going rate for a zero day is $1 million, is there anything Apple can do that can drive that up to $2 or $3 million? Or is it just going to be a perpetual cat and mouse game with no real &quot;progress&quot;?</div><br/><div id="38786111" class="c"><input type="checkbox" id="c-38786111" checked=""/><div class="controls bullet"><span class="by">develatio</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38786525">next</a><span>|</span><label class="collapse" for="c-38786111">[-]</label><label class="expand" for="c-38786111">[6 more]</label></div><br/><div class="children"><div class="content">I am by no means a security expert whatsoever. Period. But reading the article carefully, there is a step in the chain of exploits (CVE-2023-32435) which depends on exploiting Safari. Apple implemented a &quot;Lockdown mode&quot; (<a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120" rel="nofollow">https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120</a>) which might have handled this (?).<p>Answering more broadly to your question, the &quot;step-change&quot; that you&#x27;re asking for is precisely the &quot;Lockdown mode&quot; in iOS devices. It disables most of the features in order to reduce the attack surface of the device.</div><br/><div id="38787320" class="c"><input type="checkbox" id="c-38787320" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786111">parent</a><span>|</span><a href="#38789000">next</a><span>|</span><label class="collapse" for="c-38787320">[-]</label><label class="expand" for="c-38787320">[3 more]</label></div><br/><div class="children"><div class="content">If you read a better article with technical details [1], you&#x27;ll see that Apple SOCs contain a &quot;feature&quot; (that resembles a debugging tool) that allows to bypass memory protection by writing into undocumented and unused GPU registers. Apple locks down kernel memory to stop exploits, but these registers allow to bypass the lock.<p>This vulnerability is they key vulnerability without which all the exploit chain would be useless.<p>[1] <a href="https:&#x2F;&#x2F;securelist.com&#x2F;operation-triangulation-the-last-hardware-mystery&#x2F;111669&#x2F;" rel="nofollow">https:&#x2F;&#x2F;securelist.com&#x2F;operation-triangulation-the-last-hard...</a></div><br/></div></div><div id="38789000" class="c"><input type="checkbox" id="c-38789000" checked=""/><div class="controls bullet"><span class="by">hn_throwaway_99</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786111">parent</a><span>|</span><a href="#38787320">prev</a><span>|</span><a href="#38787381">next</a><span>|</span><label class="collapse" for="c-38789000">[-]</label><label class="expand" for="c-38789000">[1 more]</label></div><br/><div class="children"><div class="content">The Safari vulnerability wasn&#x27;t necessary (the device was completely owned before that), and was really just a &quot;nice to have&quot; - it allowed verification of the targeted user and, presumably, customizable malware delivery. From the article, if you look at the bullet points under the Kaspersky diagram of the exploit chain:<p>&gt; After exploiting all the vulnerabilities, the JavaScript exploit can do whatever it wants to the device and run spyware, but attackers chose to: a) launch the imagent process and inject a payload that cleans the exploitation artifacts from the device; b) run the Safari process in invisible mode and forward it to the web page with the next stage.<p>In other words, if looking at the diagram, <a href="https:&#x2F;&#x2F;cdn.arstechnica.net&#x2F;wp-content&#x2F;uploads&#x2F;2023&#x2F;12&#x2F;triangulation-exploit-chain.png" rel="nofollow">https:&#x2F;&#x2F;cdn.arstechnica.net&#x2F;wp-content&#x2F;uploads&#x2F;2023&#x2F;12&#x2F;trian...</a> , it&#x27;s completely &quot;game over&quot; once you get to the skull icon in the lower left corner, and the Safari exploit is after that.</div><br/></div></div><div id="38787381" class="c"><input type="checkbox" id="c-38787381" checked=""/><div class="controls bullet"><span class="by">dunham</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786111">parent</a><span>|</span><a href="#38789000">prev</a><span>|</span><a href="#38786525">next</a><span>|</span><label class="collapse" for="c-38787381">[-]</label><label class="expand" for="c-38787381">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, lockdown mode might have handled it. If I&#x27;m reading the article right, the first step of the exploit was a PDF file sent with iMessage.<p>When I tried out lockdown mode out of curiousity, I found that it was aggressive about blocking PDF viewing.  I quickly bailed on it because I often read research papers on the web, and it switched them from view to download.</div><br/></div></div></div></div><div id="38786525" class="c"><input type="checkbox" id="c-38786525" checked=""/><div class="controls bullet"><span class="by">doctorpangloss</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38786111">prev</a><span>|</span><a href="#38787844">next</a><span>|</span><label class="collapse" for="c-38786525">[-]</label><label class="expand" for="c-38786525">[7 more]</label></div><br/><div class="children"><div class="content">It could author its format parsers in <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;wuffs">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;wuffs</a>, and make them BSD-like open source to maximize adoption.<p>An even bigger change: It could allow users to choose their iMessage client freely. Why not open up the protocol? I’m sure a security focused client would be popular and in the grand scheme of things easy to author.<p>Perhaps they could open up more of the OS and apps. Perhaps their claims about the security of users and the App Store is kind of BS.</div><br/><div id="38787450" class="c"><input type="checkbox" id="c-38787450" checked=""/><div class="controls bullet"><span class="by">madeofpalk</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786525">parent</a><span>|</span><a href="#38789026">next</a><span>|</span><label class="collapse" for="c-38787450">[-]</label><label class="expand" for="c-38787450">[4 more]</label></div><br/><div class="children"><div class="content">I struggle to believe that a third party iMessage iOS app would be a security improvement, beyond Lockdown Mode <a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120" rel="nofollow">https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120</a>.<p>Either a third party app would still use the same vulnerable frameworks as iMessage, or they would re-implement them potentially with more vulnerabilities, or just not implement the features, which is what Lockdown Mode gives you.</div><br/><div id="38787817" class="c"><input type="checkbox" id="c-38787817" checked=""/><div class="controls bullet"><span class="by">sangnoir</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787450">parent</a><span>|</span><a href="#38789026">next</a><span>|</span><label class="collapse" for="c-38787817">[-]</label><label class="expand" for="c-38787817">[3 more]</label></div><br/><div class="children"><div class="content">One could argue the same about alternatives to Safari, and yet Chrome has proven to be more secure  than Safari (based on Pwn2Own results).</div><br/><div id="38788052" class="c"><input type="checkbox" id="c-38788052" checked=""/><div class="controls bullet"><span class="by">madeofpalk</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787817">parent</a><span>|</span><a href="#38789026">next</a><span>|</span><label class="collapse" for="c-38788052">[-]</label><label class="expand" for="c-38788052">[2 more]</label></div><br/><div class="children"><div class="content">I would not argue that about web browsers, because there’s plenty others out there. I don’t think Google would make a iMessage client for iOS.</div><br/><div id="38788428" class="c"><input type="checkbox" id="c-38788428" checked=""/><div class="controls bullet"><span class="by">Sayrus</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38788052">parent</a><span>|</span><a href="#38789026">next</a><span>|</span><label class="collapse" for="c-38788428">[-]</label><label class="expand" for="c-38788428">[1 more]</label></div><br/><div class="children"><div class="content">But others probably would. Maybe the user-experience on the security focused clients will be degraded (missing features or disabled features for the sake of privacy and security, lower performance due to some other security features), but you&#x27;d still have this kind of niche clients.<p>Browsers are not the only thing concerned here, there are many sectors impacted by this philosophy. Qubes-OS for Linux Distributions, replacing containers (and especially Docker) with daemon-less or even MicroVM (Firecracker, Podman, ...). I&#x27;m sure there are also heavily sandboxed clients for Matrix, SMS or Emails.</div><br/></div></div></div></div></div></div></div></div><div id="38789026" class="c"><input type="checkbox" id="c-38789026" checked=""/><div class="controls bullet"><span class="by">Ar-Curunir</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786525">parent</a><span>|</span><a href="#38787450">prev</a><span>|</span><a href="#38788303">next</a><span>|</span><label class="collapse" for="c-38789026">[-]</label><label class="expand" for="c-38789026">[1 more]</label></div><br/><div class="children"><div class="content">You do realize that this is an extremely complicated exploit which is not being used on the average user, right?<p>And being open source hasn’t prevented Android from being much more vulnerable to these kinds of exploits.</div><br/></div></div></div></div><div id="38787844" class="c"><input type="checkbox" id="c-38787844" checked=""/><div class="controls bullet"><span class="by">maldev</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38786525">prev</a><span>|</span><a href="#38785993">next</a><span>|</span><label class="collapse" for="c-38787844">[-]</label><label class="expand" for="c-38787844">[7 more]</label></div><br/><div class="children"><div class="content">It&#x27;s already 2-3 million +. Apple has amazing security, especially for the Iphone and continously monitors it and dishes out silent patches. For a REALLY high level example, it restricts system calls per process and requires all calls to be signed with an apple key, AND it restricts who you can do the system call to, these are continuously monitored and updated. Not only this, but persistence on Iphone is effectively dead, meaning you have to reinfect the device after every reboot. One of the big things you notice in the article is the use of ROP, apple requires every executable page to be signed by them, hence why you have to have these assfisting of rop chains.</div><br/><div id="38788062" class="c"><input type="checkbox" id="c-38788062" checked=""/><div class="controls bullet"><span class="by">Veserv</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787844">parent</a><span>|</span><a href="#38789012">next</a><span>|</span><label class="collapse" for="c-38788062">[-]</label><label class="expand" for="c-38788062">[4 more]</label></div><br/><div class="children"><div class="content">2-3 million dollars is not “amazing”. That is less than the cost to open a McDonalds. You can get a small business loan in the US for more than that. There are literally tens of millions of people in the world who can afford that. That is 1&#x2F;5 the cost of a tank.<p>2-3 million dollars is pocket lint to people conducting serious business, let alone governments. It is at best okay if you are conducting minor personal business. This ignores the fact that attacks at the 2-3 million dollar range are trivially wormable. If you had actual cause to hack every phone you are only incurring marginal cents per attack. Even relatively minor attacks like targeting 10,000 people are less than one phone of cost per attack.</div><br/><div id="38789540" class="c"><input type="checkbox" id="c-38789540" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38788062">parent</a><span>|</span><a href="#38789012">next</a><span>|</span><label class="collapse" for="c-38789540">[-]</label><label class="expand" for="c-38789540">[3 more]</label></div><br/><div class="children"><div class="content">&gt; 2-3 million dollars is not “amazing”.<p>I don&#x27;t know. $2-3m for reading code in Ghidra and throwing stuff at a wall until something sticks? Maybe some fuzzing, etc.<p>I get that you theoretically could find an exploit that for example, you send to 100 known wealthy people, and with it you steal saved cookies + device IDs from financial apps and then try to transfer their funds&#x2F;assets to an account you control but...<p>Could you really pull that off 100 times before Apple catches on?<p>I guess you could... easily... now that I think about it.</div><br/><div id="38790757" class="c"><input type="checkbox" id="c-38790757" checked=""/><div class="controls bullet"><span class="by">sweetjuly</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38789540">parent</a><span>|</span><a href="#38790087">prev</a><span>|</span><a href="#38789012">next</a><span>|</span><label class="collapse" for="c-38790757">[-]</label><label class="expand" for="c-38790757">[1 more]</label></div><br/><div class="children"><div class="content">this has the (un)fortunate consequence of being illegal. Writing exploits and selling them to a friendly government, on the other hand, is totally legal. Plus, then you can sell support contracts for that sweet recurring revenue!</div><br/></div></div></div></div></div></div><div id="38789012" class="c"><input type="checkbox" id="c-38789012" checked=""/><div class="controls bullet"><span class="by">hnburnsy</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787844">parent</a><span>|</span><a href="#38788062">prev</a><span>|</span><a href="#38785993">next</a><span>|</span><label class="collapse" for="c-38789012">[-]</label><label class="expand" for="c-38789012">[2 more]</label></div><br/><div class="children"><div class="content">That is good info, but why does Apple make it non obvious on how to reboot an iOS device and AFAICT there is no way to schedule a regular reboot.</div><br/><div id="38789105" class="c"><input type="checkbox" id="c-38789105" checked=""/><div class="controls bullet"><span class="by">hnburnsy</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38789012">parent</a><span>|</span><a href="#38785993">next</a><span>|</span><label class="collapse" for="c-38789105">[-]</label><label class="expand" for="c-38789105">[1 more]</label></div><br/><div class="children"><div class="content">Need to restart your non responsive iPhone, hope you have some dexterity...<p>----<p>Force restart iPhone<p>If iPhone isn’t responding, and you can’t turn it off then on, try forcing it to restart.<p><pre><code>    Press and quickly release the volume up button.


    Press and quickly release the volume down button.


    Press and hold the side button.


    When the Apple logo appears, release the side button.</code></pre></div><br/></div></div></div></div></div></div><div id="38785993" class="c"><input type="checkbox" id="c-38785993" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38787844">prev</a><span>|</span><a href="#38787555">next</a><span>|</span><label class="collapse" for="c-38785993">[-]</label><label class="expand" for="c-38785993">[9 more]</label></div><br/><div class="children"><div class="content">What do you mean &quot;no real progress&quot;? The price used to be $100.</div><br/><div id="38786007" class="c"><input type="checkbox" id="c-38786007" checked=""/><div class="controls bullet"><span class="by">Despegar</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38785993">parent</a><span>|</span><a href="#38787555">next</a><span>|</span><label class="collapse" for="c-38786007">[-]</label><label class="expand" for="c-38786007">[8 more]</label></div><br/><div class="children"><div class="content">I mean progress from today.</div><br/><div id="38786029" class="c"><input type="checkbox" id="c-38786029" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786007">parent</a><span>|</span><a href="#38787555">next</a><span>|</span><label class="collapse" for="c-38786029">[-]</label><label class="expand" for="c-38786029">[7 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand what you mean. They&#x27;ve always been making progress, driving the price up. They can just keep doing what they&#x27;re doing, and there will be progress from today.</div><br/><div id="38786081" class="c"><input type="checkbox" id="c-38786081" checked=""/><div class="controls bullet"><span class="by">Despegar</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786029">parent</a><span>|</span><a href="#38787555">next</a><span>|</span><label class="collapse" for="c-38786081">[-]</label><label class="expand" for="c-38786081">[6 more]</label></div><br/><div class="children"><div class="content">Is that actually true? Has the price of these exploits been going up year after year, or has it topped out at some level?</div><br/><div id="38786401" class="c"><input type="checkbox" id="c-38786401" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786081">parent</a><span>|</span><a href="#38786291">next</a><span>|</span><label class="collapse" for="c-38786401">[-]</label><label class="expand" for="c-38786401">[4 more]</label></div><br/><div class="children"><div class="content">It’s been going up consistently. The number of groups that can field a full chain these days is dwindling.</div><br/><div id="38788977" class="c"><input type="checkbox" id="c-38788977" checked=""/><div class="controls bullet"><span class="by">Despegar</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786401">parent</a><span>|</span><a href="#38786291">next</a><span>|</span><label class="collapse" for="c-38788977">[-]</label><label class="expand" for="c-38788977">[3 more]</label></div><br/><div class="children"><div class="content">Perhaps Apple should provide research devices directly to the US&#x27;s and China&#x27;s intelligence agencies and pit them against each other to help close more vulnerabilities. The agencies can decide on their own where to strike the balance between offense and defense, but I suspect it would lead to more closed vulnerabilities over time.</div><br/><div id="38790467" class="c"><input type="checkbox" id="c-38790467" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38788977">parent</a><span>|</span><a href="#38786291">next</a><span>|</span><label class="collapse" for="c-38790467">[-]</label><label class="expand" for="c-38790467">[2 more]</label></div><br/><div class="children"><div class="content">Intelligence agencies unfortunately seem to have a bad track record when it comes to disclosing vulnerabilities, they’re very offensive-focused.</div><br/><div id="38790683" class="c"><input type="checkbox" id="c-38790683" checked=""/><div class="controls bullet"><span class="by">Despegar</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38790467">parent</a><span>|</span><a href="#38786291">next</a><span>|</span><label class="collapse" for="c-38790683">[-]</label><label class="expand" for="c-38790683">[1 more]</label></div><br/><div class="children"><div class="content">I think that would be the case if they were given to the US and other Western intelligence agencies. My scenario requires competition between geopolitical opponents to create an incentive to worry about defense as well.</div><br/></div></div></div></div></div></div></div></div><div id="38786291" class="c"><input type="checkbox" id="c-38786291" checked=""/><div class="controls bullet"><span class="by">westhanover</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38786081">parent</a><span>|</span><a href="#38786401">prev</a><span>|</span><a href="#38787555">next</a><span>|</span><label class="collapse" for="c-38786291">[-]</label><label class="expand" for="c-38786291">[1 more]</label></div><br/><div class="children"><div class="content">Yes it has been going up.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38787555" class="c"><input type="checkbox" id="c-38787555" checked=""/><div class="controls bullet"><span class="by">nvm0n2</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38785993">prev</a><span>|</span><a href="#38789011">next</a><span>|</span><label class="collapse" for="c-38787555">[-]</label><label class="expand" for="c-38787555">[3 more]</label></div><br/><div class="children"><div class="content">Sure. Rewrite sensitive parts of their stack in memory safe languages. They have Swift after all. A lot of the iOS security improvements over time have really been more like mitigations that try to contain the damage when the giant of pile of decades old C gets exploited.</div><br/><div id="38789910" class="c"><input type="checkbox" id="c-38789910" checked=""/><div class="controls bullet"><span class="by">stephen_g</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787555">parent</a><span>|</span><a href="#38790491">next</a><span>|</span><label class="collapse" for="c-38789910">[-]</label><label class="expand" for="c-38789910">[1 more]</label></div><br/><div class="children"><div class="content">That is exactly their plan. Swift could always link into C applications, and they have recently come out with C++ interoperability [1] so things like WebKit etc. can start having parts re-written or new parts written from the start in Swift so they can gradually replace C and C++ codebases instead of trying to rewrite everything (which sucks because even for things much, much less complex than WebKit, you can have a team working for three years working on a replacement and it’ll have less features than the original had when you started).<p>They’re even working on an embedded subset for embedded devices so things like microcontrollers like battery management, the Secure Enclave etc. can run it.<p>1. <a href="https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=lgivCGdmFrw" rel="nofollow">https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=lgivCGdmFrw</a></div><br/></div></div><div id="38790491" class="c"><input type="checkbox" id="c-38790491" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785888">root</a><span>|</span><a href="#38787555">parent</a><span>|</span><a href="#38789910">prev</a><span>|</span><a href="#38789011">next</a><span>|</span><label class="collapse" for="c-38790491">[-]</label><label class="expand" for="c-38790491">[1 more]</label></div><br/><div class="children"><div class="content">They’re working on it, but a memory-safe language doesn’t help you in some of the surface that the attackers exploited here.</div><br/></div></div></div></div><div id="38789011" class="c"><input type="checkbox" id="c-38789011" checked=""/><div class="controls bullet"><span class="by">Ar-Curunir</span><span>|</span><a href="#38785888">parent</a><span>|</span><a href="#38787555">prev</a><span>|</span><a href="#38786217">next</a><span>|</span><label class="collapse" for="c-38789011">[-]</label><label class="expand" for="c-38789011">[1 more]</label></div><br/><div class="children"><div class="content">I mean, this is already an extremely complex chaining of exploits that requires extremely sophisticated research. I can assure you that this is not being used on the average person.</div><br/></div></div></div></div><div id="38786217" class="c"><input type="checkbox" id="c-38786217" checked=""/><div class="controls bullet"><span class="by">kevinwang</span><span>|</span><a href="#38785888">prev</a><span>|</span><a href="#38785052">next</a><span>|</span><label class="collapse" for="c-38786217">[-]</label><label class="expand" for="c-38786217">[2 more]</label></div><br/><div class="children"><div class="content">Wow, that&#x27;s amazing. I wonder if attacker like this feel unappreciated since they can&#x27;t take credit for their work.</div><br/><div id="38787151" class="c"><input type="checkbox" id="c-38787151" checked=""/><div class="controls bullet"><span class="by">belter</span><span>|</span><a href="#38786217">parent</a><span>|</span><a href="#38785052">next</a><span>|</span><label class="collapse" for="c-38787151">[-]</label><label class="expand" for="c-38787151">[1 more]</label></div><br/><div class="children"><div class="content">Public key cryptography was developed in 1970s at GCHQ but that was classified.</div><br/></div></div></div></div><div id="38785052" class="c"><input type="checkbox" id="c-38785052" checked=""/><div class="controls bullet"><span class="by">neilv</span><span>|</span><a href="#38786217">prev</a><span>|</span><a href="#38789777">next</a><span>|</span><label class="collapse" for="c-38785052">[-]</label><label class="expand" for="c-38785052">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>If we try to describe this feature and how the attackers took advantage of it, it all comes down to this: they are able to write data to a certain physical address while bypassing the hardware-based memory protection by writing the data, destination address, and data hash to unknown hardware registers of the chip unused by the firmware.</i><p>Did the systems software developers know about these registers?</div><br/></div></div><div id="38789777" class="c"><input type="checkbox" id="c-38789777" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38785052">prev</a><span>|</span><a href="#38786739">next</a><span>|</span><label class="collapse" for="c-38789777">[-]</label><label class="expand" for="c-38789777">[1 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>4-year campaign backdoored iPhones using advanced exploit</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38784073">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38784073</a><p>(We moved the comments hither, but the article might still be of interest)</div><br/></div></div><div id="38786739" class="c"><input type="checkbox" id="c-38786739" checked=""/><div class="controls bullet"><span class="by">mb4nck</span><span>|</span><a href="#38789777">prev</a><span>|</span><a href="#38785648">next</a><span>|</span><label class="collapse" for="c-38786739">[-]</label><label class="expand" for="c-38786739">[1 more]</label></div><br/><div class="children"><div class="content">At least the first version of the recording is now up:
<a href="https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_what_you_get_when_attack_iphones_of_researchers" rel="nofollow">https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;37c3-11859-operation_triangulation_wh...</a></div><br/></div></div><div id="38785648" class="c"><input type="checkbox" id="c-38785648" checked=""/><div class="controls bullet"><span class="by">patrickhogan1</span><span>|</span><a href="#38786739">prev</a><span>|</span><a href="#38785437">next</a><span>|</span><label class="collapse" for="c-38785648">[-]</label><label class="expand" for="c-38785648">[4 more]</label></div><br/><div class="children"><div class="content">Knowing more about the exfiltration component where it sends data to a remote server would be helpful. According to the article it’s sending large audio microphone recordings. I assume a company like Kapersky would explicit deny all outgoing network connections and then approve one by one.</div><br/><div id="38785723" class="c"><input type="checkbox" id="c-38785723" checked=""/><div class="controls bullet"><span class="by">hnburnsy</span><span>|</span><a href="#38785648">parent</a><span>|</span><a href="#38788304">next</a><span>|</span><label class="collapse" for="c-38785723">[-]</label><label class="expand" for="c-38785723">[1 more]</label></div><br/><div class="children"><div class="content">There is a series of posts on this including one that details the malware payload...<p><a href="https:&#x2F;&#x2F;securelist.com&#x2F;trng-2023&#x2F;" rel="nofollow">https:&#x2F;&#x2F;securelist.com&#x2F;trng-2023&#x2F;</a></div><br/></div></div><div id="38788304" class="c"><input type="checkbox" id="c-38788304" checked=""/><div class="controls bullet"><span class="by">twobitshifter</span><span>|</span><a href="#38785648">parent</a><span>|</span><a href="#38785723">prev</a><span>|</span><a href="#38785437">next</a><span>|</span><label class="collapse" for="c-38788304">[-]</label><label class="expand" for="c-38788304">[2 more]</label></div><br/><div class="children"><div class="content">yeah, I’m wondering the same. Maybe they can’t point a finger at who did it, but there were no clues on the exfiltration?</div><br/><div id="38789712" class="c"><input type="checkbox" id="c-38789712" checked=""/><div class="controls bullet"><span class="by">hnburnsy</span><span>|</span><a href="#38785648">root</a><span>|</span><a href="#38788304">parent</a><span>|</span><a href="#38785437">next</a><span>|</span><label class="collapse" for="c-38789712">[-]</label><label class="expand" for="c-38789712">[1 more]</label></div><br/><div class="children"><div class="content">&gt; yeah, I’m wondering the same. Maybe they can’t point a finger at who did it, but there were no clues on the exfiltration?<p>From the articles at the above link...<p>C&amp;C domains<p>Using the forensic artifacts, it was possible to identify the set of domain name used by the exploits and further malicious stages. They can be used to check the DNS logs for historical information, and to identify the devices currently running the malware:
addatamarket[.]net
backuprabbit[.]com
businessvideonews[.]com
cloudsponcer[.]com
datamarketplace[.]net
mobilegamerstats[.]com
snoweeanalytics[.]com
tagclick-cdn[.]com
topographyupdates[.]com
unlimitedteacup[.]com
virtuallaughing[.]com
web-trackers[.]com
growthtransport[.]com
anstv[.]net
ans7tv[.]net</div><br/></div></div></div></div></div></div><div id="38785437" class="c"><input type="checkbox" id="c-38785437" checked=""/><div class="controls bullet"><span class="by">jeffreygoesto</span><span>|</span><a href="#38785648">prev</a><span>|</span><a href="#38784608">next</a><span>|</span><label class="collapse" for="c-38785437">[-]</label><label class="expand" for="c-38785437">[2 more]</label></div><br/><div class="children"><div class="content">Some agencies will be very sad now...</div><br/><div id="38787528" class="c"><input type="checkbox" id="c-38787528" checked=""/><div class="controls bullet"><span class="by">barryrandall</span><span>|</span><a href="#38785437">parent</a><span>|</span><a href="#38784608">next</a><span>|</span><label class="collapse" for="c-38787528">[-]</label><label class="expand" for="c-38787528">[1 more]</label></div><br/><div class="children"><div class="content">Those will be the most delicious tears wept in all of 2023.</div><br/></div></div></div></div><div id="38784608" class="c"><input type="checkbox" id="c-38784608" checked=""/><div class="controls bullet"><span class="by">anotherhue</span><span>|</span><a href="#38785437">prev</a><span>|</span><a href="#38785608">next</a><span>|</span><label class="collapse" for="c-38784608">[-]</label><label class="expand" for="c-38784608">[1 more]</label></div><br/><div class="children"><div class="content">More important than getting their newly found exploits, you get to know which of yours might be compromised. Prevents counterintelligence.</div><br/></div></div><div id="38785608" class="c"><input type="checkbox" id="c-38785608" checked=""/><div class="controls bullet"><span class="by">stefan_</span><span>|</span><a href="#38784608">prev</a><span>|</span><a href="#38785525">next</a><span>|</span><label class="collapse" for="c-38785608">[-]</label><label class="expand" for="c-38785608">[1 more]</label></div><br/><div class="children"><div class="content">Maybe I&#x27;m too dumb to find it on this page but if you are looking for the actual recording instead of a calendar entry in the past, it&#x27;s here (a stream dump for now, fast forward to 27 mins):<p><a href="https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;11859" rel="nofollow">https:&#x2F;&#x2F;streaming.media.ccc.de&#x2F;37c3&#x2F;relive&#x2F;11859</a></div><br/></div></div><div id="38785525" class="c"><input type="checkbox" id="c-38785525" checked=""/><div class="controls bullet"><span class="by">xvector</span><span>|</span><a href="#38785608">prev</a><span>|</span><a href="#38785471">next</a><span>|</span><label class="collapse" for="c-38785525">[-]</label><label class="expand" for="c-38785525">[3 more]</label></div><br/><div class="children"><div class="content">Does Lockdown Mode prevent agains this?</div><br/><div id="38785905" class="c"><input type="checkbox" id="c-38785905" checked=""/><div class="controls bullet"><span class="by">542458</span><span>|</span><a href="#38785525">parent</a><span>|</span><a href="#38786033">next</a><span>|</span><label class="collapse" for="c-38785905">[-]</label><label class="expand" for="c-38785905">[1 more]</label></div><br/><div class="children"><div class="content">I think lockdown drops most iMessage features, so I would suspect the answer is yes. But as far as I can tell, lockdown prevents use of mdm, so it might be a net negative for security… instead, using the mdm policy that disables iMessage might be preferable.</div><br/></div></div><div id="38786033" class="c"><input type="checkbox" id="c-38786033" checked=""/><div class="controls bullet"><span class="by">halJordan</span><span>|</span><a href="#38785525">parent</a><span>|</span><a href="#38785905">prev</a><span>|</span><a href="#38785471">next</a><span>|</span><label class="collapse" for="c-38786033">[-]</label><label class="expand" for="c-38786033">[1 more]</label></div><br/><div class="children"><div class="content">It likely does. Lockdown mode stops most ios auto-processing wrt to message attachments and this was delivered via a message attachment.</div><br/></div></div></div></div><div id="38785471" class="c"><input type="checkbox" id="c-38785471" checked=""/><div class="controls bullet"><span class="by">vGPU</span><span>|</span><a href="#38785525">prev</a><span>|</span><a href="#38787855">next</a><span>|</span><label class="collapse" for="c-38785471">[-]</label><label class="expand" for="c-38785471">[20 more]</label></div><br/><div class="children"><div class="content">&gt; Our guess is that this unknown hardware feature was most likely intended to be used for debugging or testing purposes by Apple engineers or the factory, or was included by mistake. Since this feature is not used by the firmware, we have no idea how attackers would know how to use it<p>Considering the targets were primarily Russia and China, odds are fairly high this was a US intelligence backdoor.</div><br/><div id="38785520" class="c"><input type="checkbox" id="c-38785520" checked=""/><div class="controls bullet"><span class="by">TaylorAlexander</span><span>|</span><a href="#38785471">parent</a><span>|</span><a href="#38786359">next</a><span>|</span><label class="collapse" for="c-38785520">[-]</label><label class="expand" for="c-38785520">[11 more]</label></div><br/><div class="children"><div class="content">Yeah people keep talking about reverse engineering but it’s just as real a possibility that this was simply engineered to be there. Apple and the government made a big public show about the San Bernardino iPhone situation[1] but that could have easily been a cover to convince people the government can’t get in to iPhones - because eventually the government dropped the court case, got in anyway, and the whole thing was quickly forgotten.<p>We can imagine that the government either has ideological capture of apple - that the management of apple agree to install hard to exploit vulnerabilities tailored for US government use - or legal capture through FISA rulings.<p>I’d be curious if anyone can summarize the latest understanding of FISA court actions in this realm.<p>[1] <a href="https:&#x2F;&#x2F;www.theguardian.com&#x2F;technology&#x2F;2016&#x2F;mar&#x2F;28&#x2F;apple-fbi-case-dropped-san-bernardino-iphone" rel="nofollow">https:&#x2F;&#x2F;www.theguardian.com&#x2F;technology&#x2F;2016&#x2F;mar&#x2F;28&#x2F;apple-fbi...</a></div><br/><div id="38785610" class="c"><input type="checkbox" id="c-38785610" checked=""/><div class="controls bullet"><span class="by">jrexilius</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785520">parent</a><span>|</span><a href="#38786521">next</a><span>|</span><label class="collapse" for="c-38785610">[-]</label><label class="expand" for="c-38785610">[1 more]</label></div><br/><div class="children"><div class="content">&quot;the government&quot; isn&#x27;t really a single entity. domestic LE and foreign intelligence have different laws and processes enforced by the constitution (thankfully).  Its certainly reasonable that domestic LE really can&#x27;t force Apple to handover US citizens data, while foreign intelligence services can effect supply chain attacks, back-dooring and other methods not permitted for US citizens..</div><br/></div></div><div id="38786521" class="c"><input type="checkbox" id="c-38786521" checked=""/><div class="controls bullet"><span class="by">JumpCrisscross</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785520">parent</a><span>|</span><a href="#38785610">prev</a><span>|</span><a href="#38786359">next</a><span>|</span><label class="collapse" for="c-38786521">[-]</label><label class="expand" for="c-38786521">[9 more]</label></div><br/><div class="children"><div class="content">&gt; <i>that could have easily been a cover</i><p>The problem with conspiracies is everyone involved knows it’s a secret. If you’re the CIA, it’s much less risky to compromise a chip design engineer than have everyone from the CEO down at Apple in on the plant.</div><br/><div id="38786666" class="c"><input type="checkbox" id="c-38786666" checked=""/><div class="controls bullet"><span class="by">TaylorAlexander</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38786521">parent</a><span>|</span><a href="#38786359">next</a><span>|</span><label class="collapse" for="c-38786666">[-]</label><label class="expand" for="c-38786666">[8 more]</label></div><br/><div class="children"><div class="content">Maybe but then again what’s another secret when at a high level these firms are already very secretive.<p>It’s not apple but I think a lot about how Eric Schmidt of google was directly meeting with US military officials and talking about how important US defense was.<p>You can end up with a situation where the chip designer and some higher up both know what is happening and the higher up is there as a check to provide cover in case the chip designer is caught up in suspicion. (“No we asked for this for the manufacturing team.” Kind of thing.)<p>Of course this is all conjecture with no evidence and I understand why we don’t want to spend much energy on discussions we can’t confirm, but at the same time it is frustrating when the default assumption is that apple had no knowledge about this. The truth is that we don’t know and likely will never know.</div><br/><div id="38787785" class="c"><input type="checkbox" id="c-38787785" checked=""/><div class="controls bullet"><span class="by">LargeTomato</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38786666">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38787785">[-]</label><label class="expand" for="c-38787785">[6 more]</label></div><br/><div class="children"><div class="content">There are different levels of secret. I would never leak a normal company secret. But a national security secret is a different story.</div><br/><div id="38788364" class="c"><input type="checkbox" id="c-38788364" checked=""/><div class="controls bullet"><span class="by">TaylorAlexander</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38787785">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38788364">[-]</label><label class="expand" for="c-38788364">[5 more]</label></div><br/><div class="children"><div class="content">I do wonder if the people earning millions of dollars a year think the same way however. Considering how compartmentalized Apple is it would not take many people to be in on this.</div><br/><div id="38788869" class="c"><input type="checkbox" id="c-38788869" checked=""/><div class="controls bullet"><span class="by">klausa</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38788364">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38788869">[-]</label><label class="expand" for="c-38788869">[4 more]</label></div><br/><div class="children"><div class="content">Yes, the famously compartmentalized Apple, whose roadmap regularly leaks out to the press years (cars, AirTags, Vision Pro) and months in advance (leaks about every iPhone), absolutely a great target for subterfuge.</div><br/><div id="38790530" class="c"><input type="checkbox" id="c-38790530" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38788869">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38790530">[-]</label><label class="expand" for="c-38790530">[3 more]</label></div><br/><div class="children"><div class="content">“Undocumented registers” is uninteresting to the general public and only needs to be known to a handful of people.</div><br/><div id="38791324" class="c"><input type="checkbox" id="c-38791324" checked=""/><div class="controls bullet"><span class="by">klausa</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38790530">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38791324">[-]</label><label class="expand" for="c-38791324">[2 more]</label></div><br/><div class="children"><div class="content">Oh absolutely! But that&#x27;s true of ~anyone making chips; my point was that Apple isn&#x27;t any worse in that regard due to their &quot;secrecy&quot;.</div><br/><div id="38791406" class="c"><input type="checkbox" id="c-38791406" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38791324">parent</a><span>|</span><a href="#38787784">next</a><span>|</span><label class="collapse" for="c-38791406">[-]</label><label class="expand" for="c-38791406">[1 more]</label></div><br/><div class="children"><div class="content">Right. Hardware is scary…</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38787784" class="c"><input type="checkbox" id="c-38787784" checked=""/><div class="controls bullet"><span class="by">LargeTomato</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38786666">parent</a><span>|</span><a href="#38787785">prev</a><span>|</span><a href="#38786359">next</a><span>|</span><label class="collapse" for="c-38787784">[-]</label><label class="expand" for="c-38787784">[1 more]</label></div><br/><div class="children"><div class="content">There are different levels of secret. I would never leak a normal company secret. But a national security secret is a different story.</div><br/></div></div></div></div></div></div></div></div><div id="38786359" class="c"><input type="checkbox" id="c-38786359" checked=""/><div class="controls bullet"><span class="by">OneLeggedCat</span><span>|</span><a href="#38785471">parent</a><span>|</span><a href="#38785520">prev</a><span>|</span><a href="#38785595">next</a><span>|</span><label class="collapse" for="c-38786359">[-]</label><label class="expand" for="c-38786359">[1 more]</label></div><br/><div class="children"><div class="content">&gt; several of MMIO addresses the attackers used to bypass the memory protections weren’t identified in any device tree documentation, which acts as a reference for engineers creating hardware or software for iPhones. Even after the researchers further scoured source codes, kernel images, and firmware, they were still unable to find any mention of the MMIO addresses<p>It sure quacks like a duck.</div><br/></div></div><div id="38785595" class="c"><input type="checkbox" id="c-38785595" checked=""/><div class="controls bullet"><span class="by">TheCaptain4815</span><span>|</span><a href="#38785471">parent</a><span>|</span><a href="#38786359">prev</a><span>|</span><a href="#38787855">next</a><span>|</span><label class="collapse" for="c-38785595">[-]</label><label class="expand" for="c-38785595">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;d disagree with this. Apple execs surely know if this information gets leaked they&#x27;re losing 30% market cap in a single day, why would they risk something like that when administrations change every 4-8 years?</div><br/><div id="38786476" class="c"><input type="checkbox" id="c-38786476" checked=""/><div class="controls bullet"><span class="by">MertsA</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785595">parent</a><span>|</span><a href="#38786507">next</a><span>|</span><label class="collapse" for="c-38786476">[-]</label><label class="expand" for="c-38786476">[1 more]</label></div><br/><div class="children"><div class="content">I think the charitable explanation here is that this was an undocumented debugging interface. Apple knew about it and did not disclose it in any publicly available material. The NSA almost certainly has access to Apple&#x27;s source code and documentation. Just look at the Snowden leaks when it was disclosed that the NSA was mitming Google&#x27;s DC to DC links. They already knew Google wasn&#x27;t encrypting those links before they surreptitiously dug up the fiber and they already knew enough about the system architecture to make sense of that firehose of data. Clearly either through NSL or bribing some insiders, they already exfiltrated a bunch of internal documentation and source code. Why would Apple be any different?<p>I wouldn&#x27;t expect them to have HSM keys or anything but a mirror of their VCS? Yeah the NSA probably has that.</div><br/></div></div><div id="38786507" class="c"><input type="checkbox" id="c-38786507" checked=""/><div class="controls bullet"><span class="by">d0mine</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785595">parent</a><span>|</span><a href="#38786476">prev</a><span>|</span><a href="#38788956">next</a><span>|</span><label class="collapse" for="c-38786507">[-]</label><label class="expand" for="c-38786507">[1 more]</label></div><br/><div class="children"><div class="content">Highly unlikely. Nobody cares.<p>What stock was crushed by Snowden revelations?</div><br/></div></div><div id="38788956" class="c"><input type="checkbox" id="c-38788956" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785595">parent</a><span>|</span><a href="#38786507">prev</a><span>|</span><a href="#38785774">next</a><span>|</span><label class="collapse" for="c-38788956">[-]</label><label class="expand" for="c-38788956">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;finance.yahoo.com&#x2F;quote&#x2F;AAPL&#x2F;" rel="nofollow">https:&#x2F;&#x2F;finance.yahoo.com&#x2F;quote&#x2F;AAPL&#x2F;</a> seems you are wrong<p>Compare with minute 22:40 of the talk<p>As well as <a href="https:&#x2F;&#x2F;imgur.com&#x2F;a&#x2F;82JV7I9" rel="nofollow">https:&#x2F;&#x2F;imgur.com&#x2F;a&#x2F;82JV7I9</a></div><br/></div></div><div id="38785774" class="c"><input type="checkbox" id="c-38785774" checked=""/><div class="controls bullet"><span class="by">kornhole</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785595">parent</a><span>|</span><a href="#38788956">prev</a><span>|</span><a href="#38787855">next</a><span>|</span><label class="collapse" for="c-38785774">[-]</label><label class="expand" for="c-38785774">[3 more]</label></div><br/><div class="children"><div class="content">Power is more important than profit. Those running the national security apparatus have been in power for 60 years. The fact that they still haven&#x27;t released the documents on the JFK assassination evidences that they are still in power.</div><br/><div id="38786419" class="c"><input type="checkbox" id="c-38786419" checked=""/><div class="controls bullet"><span class="by">SV_BubbleTime</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785774">parent</a><span>|</span><a href="#38786407">next</a><span>|</span><label class="collapse" for="c-38786419">[-]</label><label class="expand" for="c-38786419">[1 more]</label></div><br/><div class="children"><div class="content">Eh.<p>Let’s say your old boss was embezzling and got away with it. Now you are the boss, and if you go public with it, not only are they out of power and likely nothing will happen, but all the freedom and flexibility you have in the same position is gone, and you or your friends have an island-problem you would rather not get into.<p>Maybe it’s just better to not rile up the shareholders.</div><br/></div></div><div id="38786407" class="c"><input type="checkbox" id="c-38786407" checked=""/><div class="controls bullet"><span class="by">westhanover</span><span>|</span><a href="#38785471">root</a><span>|</span><a href="#38785774">parent</a><span>|</span><a href="#38786419">prev</a><span>|</span><a href="#38787855">next</a><span>|</span><label class="collapse" for="c-38786407">[-]</label><label class="expand" for="c-38786407">[1 more]</label></div><br/><div class="children"><div class="content">People will call you a crank or a conspiracy theorist but that is only because they are afraid to think about the answers to those questions themselves. Its easier to pretend it couldn&#x27;t happen.</div><br/></div></div></div></div></div></div></div></div><div id="38787855" class="c"><input type="checkbox" id="c-38787855" checked=""/><div class="controls bullet"><span class="by">apienx</span><span>|</span><a href="#38785471">prev</a><span>|</span><a href="#38788884">next</a><span>|</span><label class="collapse" for="c-38787855">[-]</label><label class="expand" for="c-38787855">[2 more]</label></div><br/><div class="children"><div class="content">Reminder that Lockdown Mode helps reduce the attack surface of your iPhone. It also helps tremendously with detection.
<a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120" rel="nofollow">https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;105120</a></div><br/><div id="38787898" class="c"><input type="checkbox" id="c-38787898" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#38787855">parent</a><span>|</span><a href="#38788884">next</a><span>|</span><label class="collapse" for="c-38787898">[-]</label><label class="expand" for="c-38787898">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve had Lockdown mode enabled for a few months. It&#x27;s great, and not much of an annoyance at all. You do need to be fairly tech-savvy and remember that it&#x27;s enabled, because sometimes something silently breaks and you need to opt-out of it (which you can do for a specific website, or WebViews within a specific app). And it won&#x27;t auto-join &quot;insecure&quot; WiFi which can be annoying at a hotel, but frankly it&#x27;s probably for the best. Also you won&#x27;t receive texts with attachments in them, which is usually desirable but breaks workflows like activating a new SIM card while traveling (it&#x27;s possible this was broken for me due to some other setting to exclude texts from unknown numbers).<p>The most noticeable difference is that SVG elements (?) are replaced with emojis. I&#x27;m not sure how that fallback works but it&#x27;s funny to see buttons have seemingly random emojis embedded in them. (Does anyone know the details of how this replacement is done? Is it actually glyph fonts being replaced, not SVG?)</div><br/></div></div></div></div><div id="38788884" class="c"><input type="checkbox" id="c-38788884" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38787855">prev</a><span>|</span><label class="collapse" for="c-38788884">[-]</label><label class="expand" for="c-38788884">[1 more]</label></div><br/><div class="children"><div class="content">Years ago i argued about the danger of pdfs with another account and was told not to be a paranoid nutjob.<p>Told you so.<p>edit: The fact that this obvious statement gets upvoted above the apple backdoor on 22:40 of the talk also says alot.<p>edit1: <a href="https:&#x2F;&#x2F;imgur.com&#x2F;a&#x2F;82JV7I9" rel="nofollow">https:&#x2F;&#x2F;imgur.com&#x2F;a&#x2F;82JV7I9</a></div><br/></div></div></div></div></div></div></div></body></html>