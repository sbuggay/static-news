<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1733734861769" as="style"/><link rel="stylesheet" href="styles.css?v=1733734861769"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://bitfieldconsulting.com/posts/iota">The Smallest Thing in Go</a> <span class="domain">(<a href="https://bitfieldconsulting.com">bitfieldconsulting.com</a>)</span></div><div class="subtext"><span>gus_leonel</span> | <span>16 comments</span></div><br/><div><div id="42362833" class="c"><input type="checkbox" id="c-42362833" checked=""/><div class="controls bullet"><span class="by">unsnap_biceps</span><span>|</span><a href="#42363091">next</a><span>|</span><label class="collapse" for="c-42362833">[-]</label><label class="expand" for="c-42362833">[5 more]</label></div><br/><div class="children"><div class="content">This is a great primer on iota but the title doesn&#x27;t make sense to me. I expected talking about an empty struct that uses zero bytes</div><br/><div id="42363028" class="c"><input type="checkbox" id="c-42363028" checked=""/><div class="controls bullet"><span class="by">js2</span><span>|</span><a href="#42362833">parent</a><span>|</span><a href="#42363266">next</a><span>|</span><label class="collapse" for="c-42363028">[-]</label><label class="expand" for="c-42363028">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a pun on the English definition of &quot;iota&quot;: an infinitesimal amount<p><a href="https:&#x2F;&#x2F;www.merriam-webster.com&#x2F;dictionary&#x2F;iota" rel="nofollow">https:&#x2F;&#x2F;www.merriam-webster.com&#x2F;dictionary&#x2F;iota</a></div><br/></div></div><div id="42363266" class="c"><input type="checkbox" id="c-42363266" checked=""/><div class="controls bullet"><span class="by">codegladiator</span><span>|</span><a href="#42362833">parent</a><span>|</span><a href="#42363028">prev</a><span>|</span><a href="#42363040">next</a><span>|</span><label class="collapse" for="c-42363266">[-]</label><label class="expand" for="c-42363266">[1 more]</label></div><br/><div class="children"><div class="content">I was expecting the smallest binary possible from go</div><br/></div></div><div id="42363040" class="c"><input type="checkbox" id="c-42363040" checked=""/><div class="controls bullet"><span class="by">wgrover</span><span>|</span><a href="#42362833">parent</a><span>|</span><a href="#42363266">prev</a><span>|</span><a href="#42363091">next</a><span>|</span><label class="collapse" for="c-42363040">[-]</label><label class="expand" for="c-42363040">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing the title was meant to be a nod toward the meaning of the English word <i>iota</i>, 
&quot;an extremely small amount&quot;.</div><br/><div id="42363107" class="c"><input type="checkbox" id="c-42363107" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#42362833">root</a><span>|</span><a href="#42363040">parent</a><span>|</span><a href="#42363091">next</a><span>|</span><label class="collapse" for="c-42363107">[-]</label><label class="expand" for="c-42363107">[1 more]</label></div><br/><div class="children"><div class="content">Also the physically smallest letter of the Greek alphabet.</div><br/></div></div></div></div></div></div><div id="42363091" class="c"><input type="checkbox" id="c-42363091" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#42362833">prev</a><span>|</span><label class="collapse" for="c-42363091">[-]</label><label class="expand" for="c-42363091">[10 more]</label></div><br/><div class="children"><div class="content">This looks like plain old enum in plain c.<p>Did I miss something that makes it remarkable?</div><br/><div id="42363511" class="c"><input type="checkbox" id="c-42363511" checked=""/><div class="controls bullet"><span class="by">Someone</span><span>|</span><a href="#42363091">parent</a><span>|</span><a href="#42363955">next</a><span>|</span><label class="collapse" for="c-42363511">[-]</label><label class="expand" for="c-42363511">[1 more]</label></div><br/><div class="children"><div class="content">The thing that’s remarkable is that, with <i>iota</i>, you can specify an expression that computes the enum value:<p>For example, this:<p><pre><code>  const (
    Foo = 2 * iota &#x2F;&#x2F; 0
    Bar = 2 * iota &#x2F;&#x2F; 2
    Baz = 3 * iota &#x2F;&#x2F; 6
    &#x2F;&#x2F; ...
  )
</code></pre>
It typically is combined with another feature, explicit repetition of the last non-empty expression list (<a href="https:&#x2F;&#x2F;go.dev&#x2F;ref&#x2F;spec#Constant_declarations" rel="nofollow">https:&#x2F;&#x2F;go.dev&#x2F;ref&#x2F;spec#Constant_declarations</a>) to avoid having to repeat the <i>iota</i> expression.<p>For a powerful example see <a href="https:&#x2F;&#x2F;go.dev&#x2F;ref&#x2F;spec#Iota" rel="nofollow">https:&#x2F;&#x2F;go.dev&#x2F;ref&#x2F;spec#Iota</a>:<p><i>By definition, multiple uses of iota in the same ConstSpec all have the same value:</i><p><pre><code>  const (
    bit0, mask0 = 1 &lt;&lt; iota, 1&lt;&lt;iota - 1  &#x2F;&#x2F; bit0 == 1, mask0 == 0  (iota == 0)
    bit1, mask1                           &#x2F;&#x2F; bit1 == 2, mask1 == 1  (iota == 1)
    _, _                                  &#x2F;&#x2F; (iota == 2, unused)
    bit3, mask3                           &#x2F;&#x2F; bit3 == 8, mask3 == 7  (iota == 3)
  )
</code></pre>
I think that’s bordering on “too smart for it’s own good”, but it does prevent a very common copy-paste bug in C, where one would write something like<p><pre><code>  enum {
    bit0 = 1 &lt;&lt; 0,
    bit1 = 1 &lt;&lt; 1,
    bit3 = 1 &lt;&lt; 3,

    mask0 = bit0 - 1
    mask1 = bit1 - 1,
    mask3 = bit1 - 1 &#x2F;&#x2F; copy-paste error
  }
</code></pre>
(Happens fairly easily in real world code when the Enums are long, and extra Enums get added over time)</div><br/></div></div><div id="42363955" class="c"><input type="checkbox" id="c-42363955" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#42363091">parent</a><span>|</span><a href="#42363511">prev</a><span>|</span><a href="#42363186">next</a><span>|</span><label class="collapse" for="c-42363955">[-]</label><label class="expand" for="c-42363955">[1 more]</label></div><br/><div class="children"><div class="content">It is Go, apparently having plain old enums is too advanced.</div><br/></div></div><div id="42363186" class="c"><input type="checkbox" id="c-42363186" checked=""/><div class="controls bullet"><span class="by">iterance</span><span>|</span><a href="#42363091">parent</a><span>|</span><a href="#42363955">prev</a><span>|</span><a href="#42363103">next</a><span>|</span><label class="collapse" for="c-42363186">[-]</label><label class="expand" for="c-42363186">[1 more]</label></div><br/><div class="children"><div class="content">The answer is supposed to be &quot;iota itself is unusual,&quot; but imo iota is not really remarkable by itself. I mean it&#x27;s nice, it&#x27;s not pointless (though arguably it isn&#x27;t parsimonious), but you could just type in the numbers. It&#x27;s not saving you that much.<p>What I&#x27;d really want is something that clearly differentiates enums where the values do matter and the values don&#x27;t matter, which iota comes so close to being, but then you can do math with it. To use their example, it doesn&#x27;t really matter if &quot;electron&quot; is 4 or 8 or whatever, but I&#x27;m sure as hell not going to assign 5 to January.</div><br/></div></div><div id="42363103" class="c"><input type="checkbox" id="c-42363103" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#42363091">parent</a><span>|</span><a href="#42363186">prev</a><span>|</span><label class="collapse" for="c-42363103">[-]</label><label class="expand" for="c-42363103">[6 more]</label></div><br/><div class="children"><div class="content">&gt; This looks like plain old enum in plain c.<p>It very nearly is.<p>&gt; Did I miss something that makes it remarkable?<p>Yes.  The literal &#x27;iota&#x27; keyword.  There is no equivalent to this in C.</div><br/><div id="42363252" class="c"><input type="checkbox" id="c-42363252" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#42363091">root</a><span>|</span><a href="#42363103">parent</a><span>|</span><a href="#42363323">next</a><span>|</span><label class="collapse" for="c-42363252">[-]</label><label class="expand" for="c-42363252">[2 more]</label></div><br/><div class="children"><div class="content">How is that remarkable?<p>Does it have some other actual function and this article is only saying how btw it can also be used to make ersatz enums?</div><br/><div id="42363408" class="c"><input type="checkbox" id="c-42363408" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#42363091">root</a><span>|</span><a href="#42363252">parent</a><span>|</span><a href="#42363323">next</a><span>|</span><label class="collapse" for="c-42363408">[-]</label><label class="expand" for="c-42363408">[1 more]</label></div><br/><div class="children"><div class="content">&gt; make ersatz enums?<p>The author is describing &#x27;iota&#x27;.  You can easily combine this technique with a custom type wrapper which provides the &quot;full enum&quot; if that&#x27;s actually what you need.  In which case this provides a level of capability and convenience above that of C.<p>In practice,  it really is quite remarkable,  when you first use it to it&#x27;s fullest extent.</div><br/></div></div></div></div><div id="42363323" class="c"><input type="checkbox" id="c-42363323" checked=""/><div class="controls bullet"><span class="by">plorkyeran</span><span>|</span><a href="#42363091">root</a><span>|</span><a href="#42363103">parent</a><span>|</span><a href="#42363252">prev</a><span>|</span><label class="collapse" for="c-42363323">[-]</label><label class="expand" for="c-42363323">[3 more]</label></div><br/><div class="children"><div class="content">The basic use of iota is just what C enums do by default.</div><br/><div id="42363372" class="c"><input type="checkbox" id="c-42363372" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#42363091">root</a><span>|</span><a href="#42363323">parent</a><span>|</span><label class="collapse" for="c-42363372">[-]</label><label class="expand" for="c-42363372">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s one of potentially unlimited use cases.  iota composes with just about any static math expression to generate almost any kind of sequence.  The most common is obviously conveniently constructing bit vectors; which is possible in C, but not as an automatically composed sequence.  This really is a nice feature in practice and certainly not the only type of convenient sequence you can create.<p>A contrived example might be:<p><pre><code>    const (
        A rune = &#x27;A&#x27; + iota
        B
    )

    func main() {
        fmt.Printf(&quot;Hello %c&quot;, B)
    }
</code></pre>
You can,  of course,  just write it like a C enum if you were so inclined and that willing to go out of your way to show your disinterest in something.</div><br/><div id="42363597" class="c"><input type="checkbox" id="c-42363597" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#42363091">root</a><span>|</span><a href="#42363372">parent</a><span>|</span><label class="collapse" for="c-42363597">[-]</label><label class="expand" for="c-42363597">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>You can, of course, just write it like a C enum if you were so inclined and that willing to go out of your way to show your disinterest in something.</i><p>Oh c&#x27;mon, that&#x27;s a cheap shot.  Your example is odd, as it doesn&#x27;t really show off anything interesting; I can indeed write it as a C enum, and I can do it with less typing:<p><pre><code>    enum {
        A = &#x27;A&#x27;,
        B,
    };
</code></pre>
iota doesn&#x27;t really do anything interesting there.  Much more interesting, IMO, was the example in the article where it can be used to easily construct bitfields.  That shows off the &quot;just about any static math expression&quot; that you point out.<p>I think my problem with it overall is that it&#x27;s weird and unexpected.  Even when it can be genuinely useful, it doesn&#x27;t really fit in the language as a part of syntax.  Then again, I feel like that&#x27;s pretty common for Go.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>