<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1708765281071" as="style"/><link rel="stylesheet" href="styles.css?v=1708765281071"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://explainextended.com/2023/12/31/happy-new-year-15/">GPT in 500 Lines of SQL</a> <span class="domain">(<a href="https://explainextended.com">explainextended.com</a>)</span></div><div class="subtext"><span>thunderbong</span> | <span>25 comments</span></div><br/><div><div id="39488921" class="c"><input type="checkbox" id="c-39488921" checked=""/><div class="controls bullet"><span class="by">chrsig</span><span>|</span><a href="#39489307">next</a><span>|</span><label class="collapse" for="c-39488921">[-]</label><label class="expand" for="c-39488921">[1 more]</label></div><br/><div class="children"><div class="content">This is beautiful.  I&#x27;d actually been going down this same rabbit hole with sqlite,  I hadn&#x27;t gotten far enough to bring a neural net into it.<p>I&#x27;d been inspired by the makemore lecture series[0].  At the 1hr mark or so, he switches from counting to using a nn, which is about as far as I&#x27;ve gotten. Breaking it down into a relational model is actually a really great exercise.<p>[0] <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=PaCmpygFfXo" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=PaCmpygFfXo</a></div><br/></div></div><div id="39489307" class="c"><input type="checkbox" id="c-39489307" checked=""/><div class="controls bullet"><span class="by">ianand</span><span>|</span><a href="#39488921">prev</a><span>|</span><a href="#39490123">next</a><span>|</span><label class="collapse" for="c-39489307">[-]</label><label class="expand" for="c-39489307">[5 more]</label></div><br/><div class="children"><div class="content">This is great. In a similar vein, I implemented GPT entirely in spreadsheet functions with accompanying video tutorials<p><a href="https:&#x2F;&#x2F;spreadsheets-are-all-you-need.ai&#x2F;" rel="nofollow">https:&#x2F;&#x2F;spreadsheets-are-all-you-need.ai&#x2F;</a></div><br/><div id="39489400" class="c"><input type="checkbox" id="c-39489400" checked=""/><div class="controls bullet"><span class="by">danielmarkbruce</span><span>|</span><a href="#39489307">parent</a><span>|</span><a href="#39489417">next</a><span>|</span><label class="collapse" for="c-39489400">[-]</label><label class="expand" for="c-39489400">[2 more]</label></div><br/><div class="children"><div class="content">Nice job. Spreadsheets are a natural way to explain an LLM. I suspect that you can show training well too by calculating the derivatives for each parameter under each training example and showing it all explicitly mapped to the relevant parameter etc etc</div><br/><div id="39489796" class="c"><input type="checkbox" id="c-39489796" checked=""/><div class="controls bullet"><span class="by">ianand</span><span>|</span><a href="#39489307">root</a><span>|</span><a href="#39489400">parent</a><span>|</span><a href="#39489417">next</a><span>|</span><label class="collapse" for="c-39489796">[-]</label><label class="expand" for="c-39489796">[1 more]</label></div><br/><div class="children"><div class="content">Thank you. Validating to hear others feel spreadsheets are a natural and accessible way to explain LLMs. Someone asks “what’s do they mean by a parameter in a model” or “what is the attention matrix” and you can just pull it up graphically laid out. Then they can fiddle with it and get a visceral feel for things. It also becomes easier for non coders do things like logit lens which is just a few extra simple spreadsheet functions.<p>I actually plan to do what you describe after I do the embeddings video (but only for a “toy” neural net as a proof-of-concept introduction to gradient descent).</div><br/></div></div></div></div><div id="39489417" class="c"><input type="checkbox" id="c-39489417" checked=""/><div class="controls bullet"><span class="by">airstrike</span><span>|</span><a href="#39489307">parent</a><span>|</span><a href="#39489400">prev</a><span>|</span><a href="#39490123">next</a><span>|</span><label class="collapse" for="c-39489417">[-]</label><label class="expand" for="c-39489417">[2 more]</label></div><br/><div class="children"><div class="content">Not only is that amazing, your video was so well done. Superb crowd work! Color me double impressed.</div><br/><div id="39489830" class="c"><input type="checkbox" id="c-39489830" checked=""/><div class="controls bullet"><span class="by">ianand</span><span>|</span><a href="#39489307">root</a><span>|</span><a href="#39489417">parent</a><span>|</span><a href="#39490123">next</a><span>|</span><label class="collapse" for="c-39489830">[-]</label><label class="expand" for="c-39489830">[1 more]</label></div><br/><div class="children"><div class="content">Thanks! Each one takes a surprisingly long time to make. Even figuring out how make the explanation accessible and compelling yet still accurate takes awhile and then there’s still the actual video to do.</div><br/></div></div></div></div></div></div><div id="39490123" class="c"><input type="checkbox" id="c-39490123" checked=""/><div class="controls bullet"><span class="by">sigmoid10</span><span>|</span><a href="#39489307">prev</a><span>|</span><a href="#39489543">next</a><span>|</span><label class="collapse" for="c-39490123">[-]</label><label class="expand" for="c-39490123">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a nice demo. Unfortunately the article mixes up things in the explanation for causal masking, because it seems the author conflates aspects from training and inference. First, causal masking exists to prevent the model from &quot;peeking&quot; at future tokens during training, and second (at least for GPT-like architectures) for enforcing the autoregressive aspect during inference. During inference we only use the last token anyways, so it will attend the entire input sequence. So this token is definitely not decided only from the last token&#x27;s embedding.</div><br/></div></div><div id="39489543" class="c"><input type="checkbox" id="c-39489543" checked=""/><div class="controls bullet"><span class="by">wanderingmind</span><span>|</span><a href="#39490123">prev</a><span>|</span><a href="#39490024">next</a><span>|</span><label class="collapse" for="c-39489543">[-]</label><label class="expand" for="c-39489543">[3 more]</label></div><br/><div class="children"><div class="content">These marvels need to be preserved. Just posting the archive link here in case the blog is not maintained in future.<p><a href="https:&#x2F;&#x2F;archive.is&#x2F;VAGzF" rel="nofollow">https:&#x2F;&#x2F;archive.is&#x2F;VAGzF</a></div><br/><div id="39489689" class="c"><input type="checkbox" id="c-39489689" checked=""/><div class="controls bullet"><span class="by">zarkenfrood</span><span>|</span><a href="#39489543">parent</a><span>|</span><a href="#39489630">next</a><span>|</span><label class="collapse" for="c-39489689">[-]</label><label class="expand" for="c-39489689">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, this is a fantastic article and it would be a shame to be lost.</div><br/></div></div><div id="39489630" class="c"><input type="checkbox" id="c-39489630" checked=""/><div class="controls bullet"><span class="by">rawgabbit</span><span>|</span><a href="#39489543">parent</a><span>|</span><a href="#39489689">prev</a><span>|</span><a href="#39490024">next</a><span>|</span><label class="collapse" for="c-39489630">[-]</label><label class="expand" for="c-39489630">[1 more]</label></div><br/><div class="children"><div class="content">This is very cool</div><br/></div></div></div></div><div id="39490024" class="c"><input type="checkbox" id="c-39490024" checked=""/><div class="controls bullet"><span class="by">ksarw</span><span>|</span><a href="#39489543">prev</a><span>|</span><a href="#39488913">next</a><span>|</span><label class="collapse" for="c-39490024">[-]</label><label class="expand" for="c-39490024">[1 more]</label></div><br/><div class="children"><div class="content">Great write up, I enjoyed the reading the explanations for each piece and found them to be clear and quite thorough.<p>I did make the mistake though of clicking &quot;+ expand source&quot;, and after seeing the (remarkable) abomination I can sympathize with ChatGPT&#x27;s &quot;SQL is not suitable for implementing large language model...&quot; :)</div><br/></div></div><div id="39488913" class="c"><input type="checkbox" id="c-39488913" checked=""/><div class="controls bullet"><span class="by">jer0me</span><span>|</span><a href="#39490024">prev</a><span>|</span><a href="#39489235">next</a><span>|</span><label class="collapse" for="c-39488913">[-]</label><label class="expand" for="c-39488913">[1 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>A GPT in 60 Lines of NumPy</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=34726115">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=34726115</a> - February 2023 (146 comments)</div><br/></div></div><div id="39489235" class="c"><input type="checkbox" id="c-39489235" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#39488913">prev</a><span>|</span><a href="#39489708">next</a><span>|</span><label class="collapse" for="c-39489235">[-]</label><label class="expand" for="c-39489235">[3 more]</label></div><br/><div class="children"><div class="content">I’ve completely avoided GPT and LLMs. This looks like it would generate some level of fluidity in text output, but not be able to parse and answer a question.<p>Is there any simplistic blog posts &#x2F; training courses which go through how they work, or expose a toy engine in python or similar that? All the training I’ve seen so far seems oriented at how to use the platforms rather than how they actually work.</div><br/><div id="39489379" class="c"><input type="checkbox" id="c-39489379" checked=""/><div class="controls bullet"><span class="by">ford</span><span>|</span><a href="#39489235">parent</a><span>|</span><a href="#39489264">next</a><span>|</span><label class="collapse" for="c-39489379">[-]</label><label class="expand" for="c-39489379">[1 more]</label></div><br/><div class="children"><div class="content">Jay Alammar has my favorite sequence of tutorials from basic neural network math to GPT2.<p>Particularly [0], [1], and [2]<p>[0] <a href="http:&#x2F;&#x2F;jalammar.github.io&#x2F;illustrated-transformer&#x2F;" rel="nofollow">http:&#x2F;&#x2F;jalammar.github.io&#x2F;illustrated-transformer&#x2F;</a><p>[1] <a href="http:&#x2F;&#x2F;jalammar.github.io&#x2F;illustrated-gpt2&#x2F;" rel="nofollow">http:&#x2F;&#x2F;jalammar.github.io&#x2F;illustrated-gpt2&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;jalammar.github.io&#x2F;visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jalammar.github.io&#x2F;visualizing-neural-machine-transl...</a></div><br/></div></div><div id="39489264" class="c"><input type="checkbox" id="c-39489264" checked=""/><div class="controls bullet"><span class="by">zaptrem</span><span>|</span><a href="#39489235">parent</a><span>|</span><a href="#39489379">prev</a><span>|</span><a href="#39489708">next</a><span>|</span><label class="collapse" for="c-39489264">[-]</label><label class="expand" for="c-39489264">[1 more]</label></div><br/><div class="children"><div class="content">Strap in, this is by far the best resource: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=kCc8FmEb1nY" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=kCc8FmEb1nY</a></div><br/></div></div></div></div><div id="39489708" class="c"><input type="checkbox" id="c-39489708" checked=""/><div class="controls bullet"><span class="by">lagniappe</span><span>|</span><a href="#39489235">prev</a><span>|</span><a href="#39488874">next</a><span>|</span><label class="collapse" for="c-39489708">[-]</label><label class="expand" for="c-39489708">[1 more]</label></div><br/><div class="children"><div class="content">This is a great read, I didn&#x27;t expect to scroll right back to the top as soon as I finished it the first time.</div><br/></div></div><div id="39488874" class="c"><input type="checkbox" id="c-39488874" checked=""/><div class="controls bullet"><span class="by">seasonalnull</span><span>|</span><a href="#39489708">prev</a><span>|</span><a href="#39488907">next</a><span>|</span><label class="collapse" for="c-39488874">[-]</label><label class="expand" for="c-39488874">[1 more]</label></div><br/><div class="children"><div class="content">This should be illegal</div><br/></div></div><div id="39488907" class="c"><input type="checkbox" id="c-39488907" checked=""/><div class="controls bullet"><span class="by">behnamoh</span><span>|</span><a href="#39488874">prev</a><span>|</span><a href="#39489061">next</a><span>|</span><label class="collapse" for="c-39488907">[-]</label><label class="expand" for="c-39488907">[1 more]</label></div><br/><div class="children"><div class="content">What is this sorcery?</div><br/></div></div><div id="39489061" class="c"><input type="checkbox" id="c-39489061" checked=""/><div class="controls bullet"><span class="by">brainless</span><span>|</span><a href="#39488907">prev</a><span>|</span><a href="#39489182">next</a><span>|</span><label class="collapse" for="c-39489061">[-]</label><label class="expand" for="c-39489061">[3 more]</label></div><br/><div class="children"><div class="content">I think, I <i>think</i>, GPT creating GPT... creating GPT will be a thing soon. GPTception.</div><br/><div id="39489186" class="c"><input type="checkbox" id="c-39489186" checked=""/><div class="controls bullet"><span class="by">codetiger</span><span>|</span><a href="#39489061">parent</a><span>|</span><a href="#39489141">next</a><span>|</span><label class="collapse" for="c-39489186">[-]</label><label class="expand" for="c-39489186">[1 more]</label></div><br/><div class="children"><div class="content">GPT creating a better algo than itself is what’s even more interesting</div><br/></div></div><div id="39489141" class="c"><input type="checkbox" id="c-39489141" checked=""/><div class="controls bullet"><span class="by">incahoots</span><span>|</span><a href="#39489061">parent</a><span>|</span><a href="#39489186">prev</a><span>|</span><a href="#39489182">next</a><span>|</span><label class="collapse" for="c-39489141">[-]</label><label class="expand" for="c-39489141">[1 more]</label></div><br/><div class="children"><div class="content">Personally I like the AI dogman angle. AI trained to beat other AI (resumes tailored to beat ATS algorithms)</div><br/></div></div></div></div><div id="39489182" class="c"><input type="checkbox" id="c-39489182" checked=""/><div class="controls bullet"><span class="by">slt2021</span><span>|</span><a href="#39489061">prev</a><span>|</span><a href="#39489777">next</a><span>|</span><label class="collapse" for="c-39489182">[-]</label><label class="expand" for="c-39489182">[2 more]</label></div><br/><div class="children"><div class="content">I can feel the SQL-Force in this young jedi, Midichlorian level is on another level</div><br/><div id="39489204" class="c"><input type="checkbox" id="c-39489204" checked=""/><div class="controls bullet"><span class="by">swasheck</span><span>|</span><a href="#39489182">parent</a><span>|</span><a href="#39489777">next</a><span>|</span><label class="collapse" for="c-39489204">[-]</label><label class="expand" for="c-39489204">[1 more]</label></div><br/><div class="children"><div class="content">alex is a genius. he’s worth a follow.</div><br/></div></div></div></div><div id="39489777" class="c"><input type="checkbox" id="c-39489777" checked=""/><div class="controls bullet"><span class="by">namnhocq8</span><span>|</span><a href="#39489182">prev</a><span>|</span><label class="collapse" for="c-39489777">[-]</label><label class="expand" for="c-39489777">[1 more]</label></div><br/><div class="children"><div class="content">Tại xỉu</div><br/></div></div></div></div></div></div></div></body></html>