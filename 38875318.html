<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704445253794" as="style"/><link rel="stylesheet" href="styles.css?v=1704445253794"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/binkley/modern-java-practices">Modern Java/JVM Build Practices</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>djha-skin</span> | <span>29 comments</span></div><br/><div><div id="38875936" class="c"><input type="checkbox" id="c-38875936" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#38876170">next</a><span>|</span><label class="collapse" for="c-38875936">[-]</label><label class="expand" for="c-38875936">[11 more]</label></div><br/><div class="children"><div class="content">I formerly used gradle extensively, and ultimately concluded it&#x27;s chalk full of footguns. Since any step can do anything it wants, things easily become a mess.  Extremely flexible, and prone to slow or problematic stuff making it into build.gradle.  It&#x27;s too generic-generic and meta.<p>New major gradle releases tend to break a lot of stuff which is a lot of work for the full-time expert build engineer you&#x27;re going to need on hand to maintain the thing for medium or large sized projects.<p>Now I prefer to stick with Maven, it&#x27;s simpler, safer, super predictable, and gets the job done just fine.  Actually, the job is done better because it involves less headaches and time wasted on figuring out the damn build system.<p><i>Case in point:</i> The length of the README in this &quot;Modern gradle&quot; reference repo - that&#x27;s a lot of complexity just to get dependencies, compilation, tests, and packaging.  I prefer to copy-pasta some XML fragments and move on to solving the high ROI business-value issues.<p>Edit: @bcrosby95 sir, if it were Maven only, you could shrink the document by ~75%, because most of the bullet points are trying to explain the sharp edges of.. gradle.<p>All my love to all of you folks, goodnight!</div><br/><div id="38876310" class="c"><input type="checkbox" id="c-38876310" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876414">next</a><span>|</span><label class="collapse" for="c-38876310">[-]</label><label class="expand" for="c-38876310">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Now I prefer to stick with Maven<p>yep. This is the conclusion i end up with as well.<p>There&#x27;s three stages to maven (and generally, build systems too). First, you use a tool like maven, and find that it sucks, because it didn&#x27;t do exactly what you wanted. Then, second is you find a new tool to do _exactly_ what you wanted, which is usually something similar to make or ant (and gradle, in this case). It works, and you think you&#x27;ve reached nirvana. Then, third stage is you find out how much maintenance, headaches and gotchas you hit after using that tool. You curse and finally, having had enough, you switch back to maven (or use maven for a different&#x2F;next project).<p>Now every time i see a build too in java that&#x27;s not maven, i sigh. But only people who have reached stage three above truly understand, and accept maven, and the rest are always itching to move to something that &quot;works better&quot;.</div><br/></div></div><div id="38876414" class="c"><input type="checkbox" id="c-38876414" checked=""/><div class="controls bullet"><span class="by">bugbuddy</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876310">prev</a><span>|</span><a href="#38876848">next</a><span>|</span><label class="collapse" for="c-38876414">[-]</label><label class="expand" for="c-38876414">[1 more]</label></div><br/><div class="children"><div class="content">I have to agree. The moment I laid eyes on Gradle, I knew the Java ecosystem was going to continue its decline by the community’s adopting it as the new defacto standard. I have never adopted Gradle and have only used maven in all my projects.<p>There is a point I want to make about the excessive complexity of projects funded by Enterprise support&#x2F;training revenue models. However, I cannot do so because I have no good data to back up any claims I want make.<p>If someone has the data, please enlighten us.</div><br/></div></div><div id="38876848" class="c"><input type="checkbox" id="c-38876848" checked=""/><div class="controls bullet"><span class="by">xpressvideoz</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876414">prev</a><span>|</span><a href="#38876686">next</a><span>|</span><label class="collapse" for="c-38876848">[-]</label><label class="expand" for="c-38876848">[2 more]</label></div><br/><div class="children"><div class="content">I originally hated Gradle due to its sheer complexity, but there was an incident that I was put off by Maven. I realized that even with the simplest configuration possible, Maven tried to re-create a `.jar` file on `mvn package` every time even when I didn&#x27;t change any files. Maven is famous for not utilizing incremental builds well and this shows. The strange thing is that incremental builds in Maven <i>sometimes</i> work. I could not find the rules behind this. These unpredictable behaviors make me nervous when I use Maven. Gradle is extremely complex and its behavior changes between versions, which makes my life harder, but at least at a specific version, Gradle&#x27;s behavior has been stable. Just my two cents.</div><br/><div id="38877043" class="c"><input type="checkbox" id="c-38877043" checked=""/><div class="controls bullet"><span class="by">gbear605</span><span>|</span><a href="#38875936">root</a><span>|</span><a href="#38876848">parent</a><span>|</span><a href="#38876686">next</a><span>|</span><label class="collapse" for="c-38877043">[-]</label><label class="expand" for="c-38877043">[1 more]</label></div><br/><div class="children"><div class="content">Maven’s added incremental builds as a full feature in recent versions and it seems to work pretty well.</div><br/></div></div></div></div><div id="38876686" class="c"><input type="checkbox" id="c-38876686" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876848">prev</a><span>|</span><a href="#38876103">next</a><span>|</span><label class="collapse" for="c-38876686">[-]</label><label class="expand" for="c-38876686">[1 more]</label></div><br/><div class="children"><div class="content">There are only two reasons to use Gradle.<p>Android ecosystem, and those that failed to learn from Ant.</div><br/></div></div><div id="38876103" class="c"><input type="checkbox" id="c-38876103" checked=""/><div class="controls bullet"><span class="by">dhosek</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876686">prev</a><span>|</span><a href="#38876535">next</a><span>|</span><label class="collapse" for="c-38876103">[-]</label><label class="expand" for="c-38876103">[1 more]</label></div><br/><div class="children"><div class="content">I always felt that Gradle combined all the negatives of ant and maven in one convenient package.</div><br/></div></div><div id="38876535" class="c"><input type="checkbox" id="c-38876535" checked=""/><div class="controls bullet"><span class="by">cryptos</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876103">prev</a><span>|</span><a href="#38876197">next</a><span>|</span><label class="collapse" for="c-38876535">[-]</label><label class="expand" for="c-38876535">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m still with Gradle, but my feeling is the same. Gradle comes with some very good things, but the typical Gradle configuration is an insane mess!<p>However, not everything is magically better with Maven. It is slower (although the Maven daemon is an improvement), the XML config is a bit verbose and modules are not as straightforward as with Gradle. But the convention over configuration approach (without exceptions like in Gradle) makes maintenance way easier.</div><br/><div id="38876693" class="c"><input type="checkbox" id="c-38876693" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38875936">root</a><span>|</span><a href="#38876535">parent</a><span>|</span><a href="#38876197">next</a><span>|</span><label class="collapse" for="c-38876693">[-]</label><label class="expand" for="c-38876693">[1 more]</label></div><br/><div class="children"><div class="content">It is as if those pushing for Gradle never got the point of why Maven over Ant.</div><br/></div></div></div></div><div id="38876197" class="c"><input type="checkbox" id="c-38876197" checked=""/><div class="controls bullet"><span class="by">bcrosby95</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876535">prev</a><span>|</span><a href="#38876556">next</a><span>|</span><label class="collapse" for="c-38876197">[-]</label><label class="expand" for="c-38876197">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not just a gradle reference repo.  It&#x27;s also a maven reference repo.  Your &quot;case in point&quot; makes no sense.<p>Edit: most of the readme has nothing to do with either maven or gradle, but the tools and principles both of them are using.</div><br/></div></div><div id="38876556" class="c"><input type="checkbox" id="c-38876556" checked=""/><div class="controls bullet"><span class="by">kitd</span><span>|</span><a href="#38875936">parent</a><span>|</span><a href="#38876197">prev</a><span>|</span><a href="#38876170">next</a><span>|</span><label class="collapse" for="c-38876556">[-]</label><label class="expand" for="c-38876556">[1 more]</label></div><br/><div class="children"><div class="content">And with Polyglot Maven [1] you don&#x27;t even have to deal with all the XML markup either.<p>[1] - <a href="https:&#x2F;&#x2F;github.com&#x2F;takari&#x2F;polyglot-maven">https:&#x2F;&#x2F;github.com&#x2F;takari&#x2F;polyglot-maven</a></div><br/></div></div></div></div><div id="38876170" class="c"><input type="checkbox" id="c-38876170" checked=""/><div class="controls bullet"><span class="by">rockwotj</span><span>|</span><a href="#38875936">prev</a><span>|</span><a href="#38875832">next</a><span>|</span><label class="collapse" for="c-38876170">[-]</label><label class="expand" for="c-38876170">[5 more]</label></div><br/><div class="children"><div class="content">Honestly Bazel and Java is actually a really nice experience. Pull in third party stuff from <a href="https:&#x2F;&#x2F;github.com&#x2F;bazelbuild&#x2F;rules_jvm_external">https:&#x2F;&#x2F;github.com&#x2F;bazelbuild&#x2F;rules_jvm_external</a>. There is built in support for uber jar builds by adding a _deploy.jar suffix to binary jars. Protobuf and other codegen is super easy!</div><br/><div id="38876792" class="c"><input type="checkbox" id="c-38876792" checked=""/><div class="controls bullet"><span class="by">jpgvm</span><span>|</span><a href="#38876170">parent</a><span>|</span><a href="#38876257">next</a><span>|</span><label class="collapse" for="c-38876792">[-]</label><label class="expand" for="c-38876792">[1 more]</label></div><br/><div class="children"><div class="content">There is still a bit of work to be done to make it really nice and rules_kotlin tends to lag a bit behind if Kotlin is your poison.<p>One area that needs work that I haven&#x27;t had time to invest more in yet is a proper split layer OCI image build with rules_oci similar to what Jib does out of the box. Right now the example in the repo just dumps in the _deploy.jar which works but results in one fat layer that has to be pushed every time even if only app code changed.<p>Overall though I think Bazel is awesome.<p>I still end up using Gradle but try not to use it for projects other people need to work on, Gradle&#x27;s comprehensibility cliff is worse than Bazel IMO and the more constrained nature of Bazel keeps people from making too bad of a mess.</div><br/></div></div><div id="38876257" class="c"><input type="checkbox" id="c-38876257" checked=""/><div class="controls bullet"><span class="by">groodt</span><span>|</span><a href="#38876170">parent</a><span>|</span><a href="#38876792">prev</a><span>|</span><a href="#38876182">next</a><span>|</span><label class="collapse" for="c-38876257">[-]</label><label class="expand" for="c-38876257">[2 more]</label></div><br/><div class="children"><div class="content">+1<p>Bazel and monorepo are a bit exotic to most enterprise Java devs, but now that I&#x27;ve experienced it, I&#x27;ll never go back to Gradle or Maven or sbt.</div><br/><div id="38876279" class="c"><input type="checkbox" id="c-38876279" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#38876170">root</a><span>|</span><a href="#38876257">parent</a><span>|</span><a href="#38876182">next</a><span>|</span><label class="collapse" for="c-38876279">[-]</label><label class="expand" for="c-38876279">[1 more]</label></div><br/><div class="children"><div class="content">maven can do monorepos pretty easily i thought. The potential benefit of bazel is the better level of cache compiled artifacts that maven doesn&#x27;t seem to handle very well (and so you almost always end up recompiling everything just in case...)</div><br/></div></div></div></div><div id="38876182" class="c"><input type="checkbox" id="c-38876182" checked=""/><div class="controls bullet"><span class="by">rockwotj</span><span>|</span><a href="#38876170">parent</a><span>|</span><a href="#38876257">prev</a><span>|</span><a href="#38875832">next</a><span>|</span><label class="collapse" for="c-38876182">[-]</label><label class="expand" for="c-38876182">[1 more]</label></div><br/><div class="children"><div class="content">Here is an example project that even downloads the right JDK automatically for you: <a href="https:&#x2F;&#x2F;github.com&#x2F;rockwotj&#x2F;SyllabusDB">https:&#x2F;&#x2F;github.com&#x2F;rockwotj&#x2F;SyllabusDB</a></div><br/></div></div></div></div><div id="38875832" class="c"><input type="checkbox" id="c-38875832" checked=""/><div class="controls bullet"><span class="by">doctorpangloss</span><span>|</span><a href="#38876170">prev</a><span>|</span><a href="#38876902">next</a><span>|</span><label class="collapse" for="c-38875832">[-]</label><label class="expand" for="c-38875832">[1 more]</label></div><br/><div class="children"><div class="content">The build.gradle is great... can you add the Maven publishing code for Sonatype? That is truly cursed, but essential for libraries.</div><br/></div></div><div id="38876902" class="c"><input type="checkbox" id="c-38876902" checked=""/><div class="controls bullet"><span class="by">wiennat</span><span>|</span><a href="#38875832">prev</a><span>|</span><a href="#38876906">next</a><span>|</span><label class="collapse" for="c-38876902">[-]</label><label class="expand" for="c-38876902">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if we have a similar guide for JavaScript&#x2F;TypeScript project.</div><br/></div></div><div id="38876906" class="c"><input type="checkbox" id="c-38876906" checked=""/><div class="controls bullet"><span class="by">wiennat</span><span>|</span><a href="#38876902">prev</a><span>|</span><a href="#38876357">next</a><span>|</span><label class="collapse" for="c-38876906">[-]</label><label class="expand" for="c-38876906">[1 more]</label></div><br/><div class="children"><div class="content">I wonder about a similar guide for TypeScript&#x2F;JavaScript project.</div><br/></div></div><div id="38876357" class="c"><input type="checkbox" id="c-38876357" checked=""/><div class="controls bullet"><span class="by">marwis</span><span>|</span><a href="#38876906">prev</a><span>|</span><a href="#38876014">next</a><span>|</span><label class="collapse" for="c-38876357">[-]</label><label class="expand" for="c-38876357">[2 more]</label></div><br/><div class="children"><div class="content">Would be nice to show how to handle multimodule projects.
Maven does that out of the box but Gradle is rather complicated (too many ways).<p>Another idea: publish as inheritable POM for Maven and Gradle convention plugin so that people don&#x27;t need to copy all that boilerplate (with some refactoring to make it reusable)</div><br/><div id="38876381" class="c"><input type="checkbox" id="c-38876381" checked=""/><div class="controls bullet"><span class="by">sverhagen</span><span>|</span><a href="#38876357">parent</a><span>|</span><a href="#38876014">next</a><span>|</span><label class="collapse" for="c-38876381">[-]</label><label class="expand" for="c-38876381">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not trivial to get right. People easily misunderstand the purpose of multimodule projects and parent POMs. And before you know it, your team is maintaining versions of all dependencies in a released parent, and all modules need to be updated at the same time when there&#x27;s a new version of the parent. Yey, a distributed monolith. Or something like that. Perhaps make a simple parent POM that defines long-term truths for your organization (where your Maven repository is, maybe some very well-established build configuration, and zero to none dependencies).<p>(And if you want to manage dependencies a bit more strictly, like everywhere in oop: composition over inheritence.)</div><br/></div></div></div></div><div id="38876014" class="c"><input type="checkbox" id="c-38876014" checked=""/><div class="controls bullet"><span class="by">akoboldfrying</span><span>|</span><a href="#38876357">prev</a><span>|</span><label class="collapse" for="c-38876014">[-]</label><label class="expand" for="c-38876014">[7 more]</label></div><br/><div class="children"><div class="content">Looks to be a lot of useful experience summarised here. I&#x27;ve just skimmed parts so far, but will come back and read more as time allows.<p>&gt; <a href="https:&#x2F;&#x2F;github.com&#x2F;binkley&#x2F;modern-java-practices#keep-your-build-fast">https:&#x2F;&#x2F;github.com&#x2F;binkley&#x2F;modern-java-practices#keep-your-b...</a><p>It boggles my mind that in this day in age, Maven still recompiles <i>everything</i> if you touch <i>anything</i>. The problem of figuring out what files need to be built and building only them was solved for C in I think the late 70s (makedepend).<p>I don&#x27;t know if Gradle is better in this respect. (It certainly can&#x27;t be worse.)</div><br/><div id="38876776" class="c"><input type="checkbox" id="c-38876776" checked=""/><div class="controls bullet"><span class="by">iainmerrick</span><span>|</span><a href="#38876014">parent</a><span>|</span><a href="#38876070">next</a><span>|</span><label class="collapse" for="c-38876776">[-]</label><label class="expand" for="c-38876776">[2 more]</label></div><br/><div class="children"><div class="content"><i>I don&#x27;t know if Gradle is better in this respect. (It certainly can&#x27;t be worse.)</i><p>Every Gradle project I’ve worked on has had non-deterministic builds where you sometimes need to manually clean and rebuild to fix it, <i>and</i> still does unnecessary work every time. I think it’s worse.</div><br/><div id="38876872" class="c"><input type="checkbox" id="c-38876872" checked=""/><div class="controls bullet"><span class="by">zelos</span><span>|</span><a href="#38876014">root</a><span>|</span><a href="#38876776">parent</a><span>|</span><a href="#38876070">next</a><span>|</span><label class="collapse" for="c-38876872">[-]</label><label class="expand" for="c-38876872">[1 more]</label></div><br/><div class="children"><div class="content">This has got better with more recent Gradle versions, at the expense of stricter checks about task output directories.</div><br/></div></div></div></div><div id="38876070" class="c"><input type="checkbox" id="c-38876070" checked=""/><div class="controls bullet"><span class="by">bitcharmer</span><span>|</span><a href="#38876014">parent</a><span>|</span><a href="#38876776">prev</a><span>|</span><label class="collapse" for="c-38876070">[-]</label><label class="expand" for="c-38876070">[4 more]</label></div><br/><div class="children"><div class="content">Maven does not recompile everything each time. You have to do mvn clean to force it to. If you change a single class just that one class gets recompiled which is evident by Maven&#x27;s output.</div><br/><div id="38876690" class="c"><input type="checkbox" id="c-38876690" checked=""/><div class="controls bullet"><span class="by">Calzifer</span><span>|</span><a href="#38876014">root</a><span>|</span><a href="#38876070">parent</a><span>|</span><a href="#38876382">next</a><span>|</span><label class="collapse" for="c-38876690">[-]</label><label class="expand" for="c-38876690">[1 more]</label></div><br/><div class="children"><div class="content">Depends on how you interpret &#x27;everything&#x27; and &#x27;each time&#x27;.<p>The default compiler plugin configuration is quite eager to recompile allot if something changed.<p><a href="https:&#x2F;&#x2F;maven.apache.org&#x2F;plugins&#x2F;maven-compiler-plugin&#x2F;compile-mojo.html#useIncrementalCompilation" rel="nofollow">https:&#x2F;&#x2F;maven.apache.org&#x2F;plugins&#x2F;maven-compiler-plugin&#x2F;compi...</a><p>&quot;true (default) in this mode the compiler plugin determines whether [...] any source file was added, removed or changed since the last compilation. If this is the case, the compiler plugin recompiles _all_ sources.</div><br/></div></div><div id="38876382" class="c"><input type="checkbox" id="c-38876382" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#38876014">root</a><span>|</span><a href="#38876070">parent</a><span>|</span><a href="#38876690">prev</a><span>|</span><label class="collapse" for="c-38876382">[-]</label><label class="expand" for="c-38876382">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, although my experience is that people collect shell aliases and similar workflows that always do something like `mvn clean package` and then complain about build times.</div><br/><div id="38876440" class="c"><input type="checkbox" id="c-38876440" checked=""/><div class="controls bullet"><span class="by">sverhagen</span><span>|</span><a href="#38876014">root</a><span>|</span><a href="#38876382">parent</a><span>|</span><label class="collapse" for="c-38876440">[-]</label><label class="expand" for="c-38876440">[1 more]</label></div><br/><div class="children"><div class="content">Also, while I love Maven, I don&#x27;t run it very often (or at least not directly on the command line). Most work happens in IntelliJ, and then I&#x27;ll let the build server deal with it. Builds are short, so no harm if the build server fails and I have to fix something up...</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>