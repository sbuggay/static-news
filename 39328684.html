<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1707642064564" as="style"/><link rel="stylesheet" href="styles.css?v=1707642064564"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://gist.github.com/yoavg/8b98bbd70eb187cf1852b3485b8cda4f">Grand-Master Level Chess Without Search: Modeling Choices and Their Implications</a> <span class="domain">(<a href="https://gist.github.com">gist.github.com</a>)</span></div><div class="subtext"><span>georgehill</span> | <span>27 comments</span></div><br/><div><div id="39333276" class="c"><input type="checkbox" id="c-39333276" checked=""/><div class="controls bullet"><span class="by">thomasahle</span><span>|</span><a href="#39331900">next</a><span>|</span><label class="collapse" for="c-39333276">[-]</label><label class="expand" for="c-39333276">[4 more]</label></div><br/><div class="children"><div class="content">People misunderstand this paper. The point is not to create a strong chess engine. We already have those. It&#x27;s also not to train it in a smart way. It&#x27;s just supervised learning.<p>The whole paper is just an argument against people who still think of transformers as &quot;stochastic parrots&quot;.<p>Probably it&#x27;s even a mainly internal Deep Mind debate, since people outside have long ago accepted that transformers obviously learn algorthms and do something akind to planning.<p>You can see this undertone many places in the paper, like when they emphasize the systems plays strongly without _explicit_ search. Or if you read the conclusion.</div><br/><div id="39333588" class="c"><input type="checkbox" id="c-39333588" checked=""/><div class="controls bullet"><span class="by">suddenlybananas</span><span>|</span><a href="#39333276">parent</a><span>|</span><a href="#39333374">next</a><span>|</span><label class="collapse" for="c-39333588">[-]</label><label class="expand" for="c-39333588">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s much less impressive when its given an explicit internal model (stockfish move probabilities).</div><br/></div></div><div id="39333374" class="c"><input type="checkbox" id="c-39333374" checked=""/><div class="controls bullet"><span class="by">helloplanets</span><span>|</span><a href="#39333276">parent</a><span>|</span><a href="#39333588">prev</a><span>|</span><a href="#39333498">next</a><span>|</span><label class="collapse" for="c-39333374">[-]</label><label class="expand" for="c-39333374">[1 more]</label></div><br/><div class="children"><div class="content">Would be interesting to see how well it would fare in situations where you have to prove your knowledge of patterns regarding specific pieces outside the context of traditional chess. What I mean by this is playing Chess960 or solving a tactics problem that starts from a traditionally unreachable position, but otherwise adheres to the original rules.<p>Even doing these things at an average level would be pretty mind blowing.</div><br/></div></div><div id="39333498" class="c"><input type="checkbox" id="c-39333498" checked=""/><div class="controls bullet"><span class="by">Certhas</span><span>|</span><a href="#39333276">parent</a><span>|</span><a href="#39333374">prev</a><span>|</span><a href="#39331900">next</a><span>|</span><label class="collapse" for="c-39333498">[-]</label><label class="expand" for="c-39333498">[1 more]</label></div><br/><div class="children"><div class="content">Did you read the blog post? The whole point of the blog post is that the model does not demonstrate that it&#x27;s learning in interesting ways (as strongly as people make it out).</div><br/></div></div></div></div><div id="39331900" class="c"><input type="checkbox" id="c-39331900" checked=""/><div class="controls bullet"><span class="by">janalsncm</span><span>|</span><a href="#39333276">prev</a><span>|</span><a href="#39332394">next</a><span>|</span><label class="collapse" for="c-39331900">[-]</label><label class="expand" for="c-39331900">[2 more]</label></div><br/><div class="children"><div class="content">I agree with the author’s critique of maximalist interpretations of the paper.<p>I’ve built a chess engine in the past so I was less hung up on the “without search” component like a lot of the original thread seemed to be. I don’t care if I have to take an argmax over all possible moves in a position and whether that technically qualifies as a search, or if the model may be doing some implicit search within its weights. What matters to me is that it is several orders of magnitude lower search required than stockfish, and those operations cost much less because they’re being executed in parallel on a TPU (GPU also works).<p>Optimizing static evaluation for the hardware we have is still a super interesting topic. It’s arguably why deep learning took off: matrix multiplication happens to be really cheap on GPUs.</div><br/><div id="39332571" class="c"><input type="checkbox" id="c-39332571" checked=""/><div class="controls bullet"><span class="by">david-gpu</span><span>|</span><a href="#39331900">parent</a><span>|</span><a href="#39332394">next</a><span>|</span><label class="collapse" for="c-39332571">[-]</label><label class="expand" for="c-39332571">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt; It’s arguably why deep learning took off: matrix multiplication happens to be really cheap on GPUs</i><p>Multiplication of large matrices is intrinsically simple to parallelize, and in addition it has great data locality and a very regular structure. It&#x27;s just a great operation to perform efficiently on a parallel processor.</div><br/></div></div></div></div><div id="39332394" class="c"><input type="checkbox" id="c-39332394" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#39331900">prev</a><span>|</span><a href="#39333213">next</a><span>|</span><label class="collapse" for="c-39332394">[-]</label><label class="expand" for="c-39332394">[1 more]</label></div><br/><div class="children"><div class="content">This seems to be the most important point:<p>&gt;  it looked at a game position, then used a strong chess-engine to expand a tree of possible game continuations from this position spanning hundreds of thousands if not millions of moves into the future. The game engine then used its internal knowledge of chess to assess the percentage of winning board positions within the possible continuations, which is the &quot;probability of win&quot; for a position. Then, the learner tried to learn this number. This is not learning from observations, it is learning from a super-human expert.<p>Apparently it was able to summarize the knowledge of that expert pretty well, though.</div><br/></div></div><div id="39333213" class="c"><input type="checkbox" id="c-39333213" checked=""/><div class="controls bullet"><span class="by">matteoraso</span><span>|</span><a href="#39332394">prev</a><span>|</span><a href="#39333222">next</a><span>|</span><label class="collapse" for="c-39333213">[-]</label><label class="expand" for="c-39333213">[1 more]</label></div><br/><div class="children"><div class="content">The big problem with that paper is that grandmaster level chess is actually really bad for a chess bot. Its elo is a full 400 lower than Stockfish[0], which is the same distance between a grandmaster and a very strong untitled player. Oddly enough, I wrote a blog post a few months ago that&#x27;s tangentially related to this topic[1]. The gist of it is that the search tree for a chess engine is the most important part, since a perfect solution for chess would just be a brute-force search of the entire game tree. Trying to get around that by building a better evaluation function is just a waste of time and money.<p>[0] <a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2402.04494.pdf" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2402.04494.pdf</a><p>[1] <a href="https:&#x2F;&#x2F;matteoraso.github.io&#x2F;board-game-engines-are-about-trees-not-evaluation-functions.html#board-game-engines-are-about-trees-not-evaluation-functions" rel="nofollow">https:&#x2F;&#x2F;matteoraso.github.io&#x2F;board-game-engines-are-about-tr...</a></div><br/></div></div><div id="39333222" class="c"><input type="checkbox" id="c-39333222" checked=""/><div class="controls bullet"><span class="by">somenameforme</span><span>|</span><a href="#39333213">prev</a><span>|</span><a href="#39329742">next</a><span>|</span><label class="collapse" for="c-39333222">[-]</label><label class="expand" for="c-39333222">[1 more]</label></div><br/><div class="children"><div class="content">What is the bot&#x27;s username? I don&#x27;t see it referenced in the paper, and in searching the Lichess database using the games offered in the paper, nothing shows up.</div><br/></div></div><div id="39329742" class="c"><input type="checkbox" id="c-39329742" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#39333222">prev</a><span>|</span><a href="#39330222">next</a><span>|</span><label class="collapse" for="c-39329742">[-]</label><label class="expand" for="c-39329742">[1 more]</label></div><br/><div class="children"><div class="content">Recent and related:<p><i>Grandmaster-Level Chess Without Search</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39301944">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39301944</a> - Feb 2024 (128 comments)</div><br/></div></div><div id="39330222" class="c"><input type="checkbox" id="c-39330222" checked=""/><div class="controls bullet"><span class="by">tromp</span><span>|</span><a href="#39329742">prev</a><span>|</span><a href="#39331317">next</a><span>|</span><label class="collapse" for="c-39330222">[-]</label><label class="expand" for="c-39330222">[5 more]</label></div><br/><div class="children"><div class="content">This looks like a very solid critique of Deepmind&#x27;s recent paper, or how it mislead people into regarding its results as much stronger than they really are. However I think the autor goes a bit astray at<p>&gt; The paper mentions that the model could not follow the &quot;don&#x27;t repeat the same board position three times in a row&quot; rule (aka &quot;threefold repetition&quot;).<p>That is not the rule. It is not illegal to repeat a position for a third time.<p>The rule only says that a player can claim a draw in the case of a three fold repetition [1].<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Threefold_repetition" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Threefold_repetition</a></div><br/><div id="39330729" class="c"><input type="checkbox" id="c-39330729" checked=""/><div class="controls bullet"><span class="by">sf-wy</span><span>|</span><a href="#39330222">parent</a><span>|</span><a href="#39331317">next</a><span>|</span><label class="collapse" for="c-39330729">[-]</label><label class="expand" for="c-39330729">[4 more]</label></div><br/><div class="children"><div class="content">Fair point! Usually in online chess, it auto-draws the game. I guess there&#x27;s an assumption that that&#x27;s what the players want &#x2F; not running out of time in blitz games.</div><br/><div id="39331287" class="c"><input type="checkbox" id="c-39331287" checked=""/><div class="controls bullet"><span class="by">mtlmtlmtlmtl</span><span>|</span><a href="#39330222">root</a><span>|</span><a href="#39330729">parent</a><span>|</span><a href="#39331317">next</a><span>|</span><label class="collapse" for="c-39331287">[-]</label><label class="expand" for="c-39331287">[3 more]</label></div><br/><div class="children"><div class="content">Slight inaccuracy. I don&#x27;t think it autodraws on your behalf right away, but if you repeat it even more(there may also be a setting to automatically claim a draw on 3, not sure). Not sure what the different servers do exactly, but i think based on experience that&#x27;s what&#x27;s happening.<p>There is a little known rule in tournament chess that if a position is reached 5 times, an arbiter can step in and rule the game as a draw without a claim. Usually only comes up in scholastic tournaments and very rarely in blitz tournaments.</div><br/><div id="39332029" class="c"><input type="checkbox" id="c-39332029" checked=""/><div class="controls bullet"><span class="by">hugh-avherald</span><span>|</span><a href="#39330222">root</a><span>|</span><a href="#39331287">parent</a><span>|</span><a href="#39331317">next</a><span>|</span><label class="collapse" for="c-39332029">[-]</label><label class="expand" for="c-39332029">[2 more]</label></div><br/><div class="children"><div class="content">The fivefold repetition rule says that the game is drawn in the event of a fivefold repetition, regardless of actions by the arbiter or either player. (Indeed, regardless of whether an arbiter is present.) So if it&#x27;s later discovered to have occurred in a game which White apparently won by checkmate, then the win is void. The rule also places a duty on the arbiter to intervene, but a failure on the arbiter to intervene has no bearing on the outcome.</div><br/><div id="39332192" class="c"><input type="checkbox" id="c-39332192" checked=""/><div class="controls bullet"><span class="by">mtlmtlmtlmtl</span><span>|</span><a href="#39330222">root</a><span>|</span><a href="#39332029">parent</a><span>|</span><a href="#39331317">next</a><span>|</span><label class="collapse" for="c-39332192">[-]</label><label class="expand" for="c-39332192">[1 more]</label></div><br/><div class="children"><div class="content">My bad, I did not know those details. I don&#x27;t think I&#x27;ve ever heard of a case where it&#x27;s happened this way in tournament play. I bet it has though.<p>Do you happen to know if this can be applied even several rounds later, in a swiss format? In most tournaments, even if there are score sheets, the arbiters rarely look over the game if the players agree on the result. And sometimes I don&#x27;t look over my own games until a few days later if I&#x27;m disgusted enough with how I played...</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39331317" class="c"><input type="checkbox" id="c-39331317" checked=""/><div class="controls bullet"><span class="by">andrewljohnson</span><span>|</span><a href="#39330222">prev</a><span>|</span><a href="#39330294">next</a><span>|</span><label class="collapse" for="c-39331317">[-]</label><label class="expand" for="c-39331317">[1 more]</label></div><br/><div class="children"><div class="content">I wonder how well you can train a similar model on a finite number of outputs from a poker solver to output answers for any poker spot in general.</div><br/></div></div><div id="39330294" class="c"><input type="checkbox" id="c-39330294" checked=""/><div class="controls bullet"><span class="by">GaggiX</span><span>|</span><a href="#39331317">prev</a><span>|</span><a href="#39330165">next</a><span>|</span><label class="collapse" for="c-39330294">[-]</label><label class="expand" for="c-39330294">[6 more]</label></div><br/><div class="children"><div class="content">If anyone wants to tackle it, the challenge of creating a superhuman model that doesn&#x27;t use search during inference is still open. I think I have some ideas, not that I could do it without a lot of computing.</div><br/><div id="39331132" class="c"><input type="checkbox" id="c-39331132" checked=""/><div class="controls bullet"><span class="by">Q6T46nT668w6i3m</span><span>|</span><a href="#39330294">parent</a><span>|</span><a href="#39330165">next</a><span>|</span><label class="collapse" for="c-39331132">[-]</label><label class="expand" for="c-39331132">[5 more]</label></div><br/><div class="children"><div class="content">What are your ideas?</div><br/><div id="39331374" class="c"><input type="checkbox" id="c-39331374" checked=""/><div class="controls bullet"><span class="by">GaggiX</span><span>|</span><a href="#39330294">root</a><span>|</span><a href="#39331132">parent</a><span>|</span><a href="#39330165">next</a><span>|</span><label class="collapse" for="c-39331374">[-]</label><label class="expand" for="c-39331374">[4 more]</label></div><br/><div class="children"><div class="content">Autoencoder for piece placement, active color, castling  availability and en passant target square and halfmove clock for the fifty-move rule, to get a single vector to encode these informations, these encode everything you need except the threefold repetition, for that I was thinking of simply encoding the previous reversible halfmoves in the cross attention (the order shouldn&#x27;t matter), 50 halfmoves is the most you can have online because of the fifty-move rule or it&#x27;s a draw. This should fix the problem that the model developed by Deepmind has by being blind to threefold repetition, a better objective that consider the length of the checkmate sequence should make the model more decisive in the face of overwhelming victory and it&#x27;s knowledge of the threefold repetition should discourage the model to going back and forth on a winning position.</div><br/><div id="39332384" class="c"><input type="checkbox" id="c-39332384" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#39330294">root</a><span>|</span><a href="#39331374">parent</a><span>|</span><a href="#39331922">next</a><span>|</span><label class="collapse" for="c-39332384">[-]</label><label class="expand" for="c-39332384">[2 more]</label></div><br/><div class="children"><div class="content">Slight but perhaps significant correction, the 50 move rule only takes effect if no piece has been captured and no pawn moved. Online games can definitely be more than 50 moves.</div><br/><div id="39333162" class="c"><input type="checkbox" id="c-39333162" checked=""/><div class="controls bullet"><span class="by">GaggiX</span><span>|</span><a href="#39330294">root</a><span>|</span><a href="#39332384">parent</a><span>|</span><a href="#39331922">next</a><span>|</span><label class="collapse" for="c-39333162">[-]</label><label class="expand" for="c-39333162">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, of course it was in the context of reversible halfmoves.</div><br/></div></div></div></div><div id="39331922" class="c"><input type="checkbox" id="c-39331922" checked=""/><div class="controls bullet"><span class="by">janalsncm</span><span>|</span><a href="#39330294">root</a><span>|</span><a href="#39331374">parent</a><span>|</span><a href="#39332384">prev</a><span>|</span><a href="#39330165">next</a><span>|</span><label class="collapse" for="c-39331922">[-]</label><label class="expand" for="c-39331922">[1 more]</label></div><br/><div class="children"><div class="content">I think you could get pretty far just by learning embeddings for board positions and making moves from similar board positions during a game. Essentially a retriever-only system.</div><br/></div></div></div></div></div></div></div></div><div id="39331598" class="c"><input type="checkbox" id="c-39331598" checked=""/><div class="controls bullet"><span class="by">mtlmtlmtlmtl</span><span>|</span><a href="#39330165">prev</a><span>|</span><label class="collapse" for="c-39331598">[-]</label><label class="expand" for="c-39331598">[3 more]</label></div><br/><div class="children"><div class="content">This is an excellent summary of some of the myriad problems with the paper. Especially the highly dubious claims of grandmaster level play. And also of a lot of misconceptions about things the paper didn&#x27;t(and didn&#x27;t claim to afaik) do at all.<p>It&#x27;s a shame it&#x27;s not getting as much traction on here as the paper itself. Once again, Deepmind&#x27;s shameless embellishments of their research will become HN myths because most people will only have seen the paper and not this.<p>This is of course a general trend; critiques and even retractions rarely get as much attention as the hyperbolised form of the original research  and while the field itself moves on, the laypeople come out of it less informed than they were before.</div><br/><div id="39332481" class="c"><input type="checkbox" id="c-39332481" checked=""/><div class="controls bullet"><span class="by">danielmarkbruce</span><span>|</span><a href="#39331598">parent</a><span>|</span><a href="#39332777">next</a><span>|</span><label class="collapse" for="c-39332481">[-]</label><label class="expand" for="c-39332481">[1 more]</label></div><br/><div class="children"><div class="content">The paper doesn&#x27;t have myriad problems. It doesn&#x27;t shamelessly embellish. It&#x27;s pretty straightforward. It highlights the key shortcomings of the approach. It&#x27;s just a paper. Take it at face value.<p>It&#x27;s also understood by people who have ever looked at the area (which is the audience of academic papers). &#x27;Without search&#x27; is understood.</div><br/></div></div></div></div></div></div></div></div></div></body></html>