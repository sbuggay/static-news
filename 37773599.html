<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1696496489533" as="style"/><link rel="stylesheet" href="styles.css?v=1696496489533"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://nikolaivazquez.com/blog/divan/">Divan: Fast and Simple Benchmarking for Rust</a> <span class="domain">(<a href="https://nikolaivazquez.com">nikolaivazquez.com</a>)</span></div><div class="subtext"><span>nvzqz</span> | <span>10 comments</span></div><br/><div><div id="37774223" class="c"><input type="checkbox" id="c-37774223" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#37774273">next</a><span>|</span><label class="collapse" for="c-37774223">[-]</label><label class="expand" for="c-37774223">[4 more]</label></div><br/><div class="children"><div class="content">Holy crap. I was just writing a blog to complain about the state of Rust benchmarking and I think this might address most of my points. The biggest one is the ability to have benchmarks collocated within the library like tests which is the biggest annoyance.<p>It’s also nice to see that it can report multiple counters in parallel. I put up a similar feature[1] for criterion recently but I fear the project isn’t being maintained anymore…<p>Haven’t looked deeply into divan yet but the other requirements I have for criterion’s power is to run tests with statistical guarantees on the results, terminate quickly when statistical significance is reached (—quick), provide a comparison of the delta from a previous benchmark, and to run async code. Wonder how this stacks up.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;bheisler&#x2F;criterion.rs&#x2F;pull&#x2F;722">https:&#x2F;&#x2F;github.com&#x2F;bheisler&#x2F;criterion.rs&#x2F;pull&#x2F;722</a></div><br/><div id="37774372" class="c"><input type="checkbox" id="c-37774372" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#37774223">parent</a><span>|</span><a href="#37774273">next</a><span>|</span><label class="collapse" for="c-37774372">[-]</label><label class="expand" for="c-37774372">[3 more]</label></div><br/><div class="children"><div class="content">Reading the future ideas section:<p>* Async support not there yet<p>* statistical power is principled in terms of following a good paper about how to pick how many iterations, but the variance stuff isn’t implemented yet. By definition, if I’m reading the readme correctly, its execution mode is equivalent to —quick.<p>* baseline evaluation not there yet.<p>My overall gripe remains that this stuff isn’t available natively within the Rust&#x2F;cargo ecosystem. I should be able to swap out benchmarking frameworks without having to rewrite my entire codebase to try out a new one.</div><br/><div id="37774863" class="c"><input type="checkbox" id="c-37774863" checked=""/><div class="controls bullet"><span class="by">jeffparsons</span><span>|</span><a href="#37774223">root</a><span>|</span><a href="#37774372">parent</a><span>|</span><a href="#37774273">next</a><span>|</span><label class="collapse" for="c-37774863">[-]</label><label class="expand" for="c-37774863">[2 more]</label></div><br/><div class="children"><div class="content">The recently-formed testing subteam is looking to solve your exact complaint: <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;3455">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;3455</a></div><br/><div id="37775418" class="c"><input type="checkbox" id="c-37775418" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#37774223">root</a><span>|</span><a href="#37774863">parent</a><span>|</span><a href="#37774273">next</a><span>|</span><label class="collapse" for="c-37775418">[-]</label><label class="expand" for="c-37775418">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s positive news, but I&#x27;ll have to reserve my enthusiasm. I&#x27;ve been burned too many times with what seem like reasonable-looking RFCs that seem to have some initial momentum and then get closed out after a few years with no progress being made (&amp; how that&#x27;s communicated out &amp; tracked is another complaint).<p>For example &amp; relevant to this:
<a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;issues&#x2F;816">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;issues&#x2F;816</a> redirected to <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;2318">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;2318</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;2318">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rfcs&#x2F;pull&#x2F;2318</a> says merged but links to tracking issue <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;50297">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;50297</a> which was closed out without ever being implemented.<p>So 5 years with no progress &amp; a restarted effort. Don&#x27;t get me wrong. I appreciate all the people devoting energy to this &amp; other issues, &amp; it&#x27;s certainly easy to provide criticism from the sidelines, especially since actually solving the problem I&#x27;m sure can be hard &amp; I&#x27;m not putting my cycles toward this. All I&#x27;m trying to communicate is that I&#x27;m personally not going to get my hopes up but I really wish the team luck and hope progress can be made here finally!</div><br/></div></div></div></div></div></div></div></div><div id="37774273" class="c"><input type="checkbox" id="c-37774273" checked=""/><div class="controls bullet"><span class="by">super_scooper</span><span>|</span><a href="#37774223">prev</a><span>|</span><a href="#37775358">next</a><span>|</span><label class="collapse" for="c-37774273">[-]</label><label class="expand" for="c-37774273">[1 more]</label></div><br/><div class="children"><div class="content">Wow, this really looks fantastic from the examples, great work!<p>I am looking forward to machine-readable output getting implemented. I was using criterion recently and couldn&#x27;t for the life of me get CSV output to work correctly (and according to their docs it&#x27;s a feature they are looking to remove). Ended up writing a python script to scrape all the data out of the folders of JSON files it makes.</div><br/></div></div><div id="37775358" class="c"><input type="checkbox" id="c-37775358" checked=""/><div class="controls bullet"><span class="by">chaosprint</span><span>|</span><a href="#37774273">prev</a><span>|</span><a href="#37774271">next</a><span>|</span><label class="collapse" for="c-37775358">[-]</label><label class="expand" for="c-37775358">[1 more]</label></div><br/><div class="children"><div class="content">This is exactly what I need now for   new audio engine dev</div><br/></div></div><div id="37774271" class="c"><input type="checkbox" id="c-37774271" checked=""/><div class="controls bullet"><span class="by">forrestthewoods</span><span>|</span><a href="#37775358">prev</a><span>|</span><a href="#37775736">next</a><span>|</span><label class="collapse" for="c-37774271">[-]</label><label class="expand" for="c-37774271">[2 more]</label></div><br/><div class="children"><div class="content">Does it support functions that take seconds to execute? I bloody hate Criterion because it’s worthless for anything that takes even milliseconds.</div><br/><div id="37775427" class="c"><input type="checkbox" id="c-37775427" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#37774271">parent</a><span>|</span><a href="#37775736">next</a><span>|</span><label class="collapse" for="c-37775427">[-]</label><label class="expand" for="c-37775427">[1 more]</label></div><br/><div class="children"><div class="content">Are you saying in terms of how long the benchmark takes? Have you tried `--quick`? The duration of the test doesn&#x27;t matter so much for the time it takes Criterion to benchmark - what Criterion is trying to do is run the function enough times that it thinks it has a statistically defensible estimate of how expensive your code is.</div><br/></div></div></div></div><div id="37775736" class="c"><input type="checkbox" id="c-37775736" checked=""/><div class="controls bullet"><span class="by">malkia</span><span>|</span><a href="#37774271">prev</a><span>|</span><label class="collapse" for="c-37775736">[-]</label><label class="expand" for="c-37775736">[1 more]</label></div><br/><div class="children"><div class="content">sofa</div><br/></div></div></div></div></div></div></div></body></html>