<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1695459660752" as="style"/><link rel="stylesheet" href="styles.css?v=1695459660752"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/tidwall/tg">Show HN: TG – Fast geometry library for C</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>tidwall</span> | <span>16 comments</span></div><br/><div><div id="37619888" class="c"><input type="checkbox" id="c-37619888" checked=""/><div class="controls bullet"><span class="by">hgs3</span><span>|</span><a href="#37620565">next</a><span>|</span><label class="collapse" for="c-37619888">[-]</label><label class="expand" for="c-37619888">[1 more]</label></div><br/><div class="children"><div class="content">Nice library. +1 for the excellent visualizations [1]. Will you keep it focused on intersections or might you dabble with triangulation?<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;tg&#x2F;blob&#x2F;main&#x2F;docs&#x2F;POLYGON_INDEXING.md">https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;tg&#x2F;blob&#x2F;main&#x2F;docs&#x2F;POLYGON_INDEXIN...</a></div><br/></div></div><div id="37620565" class="c"><input type="checkbox" id="c-37620565" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#37619888">prev</a><span>|</span><a href="#37620615">next</a><span>|</span><label class="collapse" for="c-37620565">[-]</label><label class="expand" for="c-37620565">[1 more]</label></div><br/><div class="children"><div class="content">This looks really interesting. It implements pretty much the exact subset of geospatial stuff that I care about, in a single C file (an amalgamation that includes its dependencies).<p>This could make for a really neat SQLite extension, as a much lighter alternative to SpatiaLite.</div><br/></div></div><div id="37620615" class="c"><input type="checkbox" id="c-37620615" checked=""/><div class="controls bullet"><span class="by">unnah</span><span>|</span><a href="#37620565">prev</a><span>|</span><a href="#37620524">next</a><span>|</span><label class="collapse" for="c-37620615">[-]</label><label class="expand" for="c-37620615">[1 more]</label></div><br/><div class="children"><div class="content">It looks like the coordinates are 64-bit doubles. How accurate and repeatable are the implementations of geometry operations here?</div><br/></div></div><div id="37620524" class="c"><input type="checkbox" id="c-37620524" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#37620615">prev</a><span>|</span><a href="#37621033">next</a><span>|</span><label class="collapse" for="c-37620524">[-]</label><label class="expand" for="c-37620524">[1 more]</label></div><br/><div class="children"><div class="content">This is a really great README - clearly explained the benefits of the library and anticipated all of my questions about it.</div><br/></div></div><div id="37621033" class="c"><input type="checkbox" id="c-37621033" checked=""/><div class="controls bullet"><span class="by">aquarin</span><span>|</span><a href="#37620524">prev</a><span>|</span><a href="#37620133">next</a><span>|</span><label class="collapse" for="c-37621033">[-]</label><label class="expand" for="c-37621033">[4 more]</label></div><br/><div class="children"><div class="content">I am curious, what exactly &quot;feq&quot; is calculating?<p>&gt; return !((x &lt; y) | (x &gt; y));<p>Is it supposed to avoid  x == y. If yes, why?</div><br/><div id="37621082" class="c"><input type="checkbox" id="c-37621082" checked=""/><div class="controls bullet"><span class="by">aquarin</span><span>|</span><a href="#37621033">parent</a><span>|</span><a href="#37621106">next</a><span>|</span><label class="collapse" for="c-37621082">[-]</label><label class="expand" for="c-37621082">[1 more]</label></div><br/><div class="children"><div class="content">Also, &quot;length&quot; may have better be implemented using: <a href="https:&#x2F;&#x2F;en.cppreference.com&#x2F;w&#x2F;c&#x2F;numeric&#x2F;math&#x2F;hypot" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.cppreference.com&#x2F;w&#x2F;c&#x2F;numeric&#x2F;math&#x2F;hypot</a><p>It will be helpful, if you add comments discussing why certain functions are implemented in that way, and what algorithms (references) is used.
For example, there are some magic numbers without explanation:
if (cap &lt; 1000) {<p>Have you looked at: <a href="https:&#x2F;&#x2F;github.com&#x2F;davideberly&#x2F;GeometricTools">https:&#x2F;&#x2F;github.com&#x2F;davideberly&#x2F;GeometricTools</a>
Each algorithm is well documented and explained. There is even a short pdf papers for some of the algorithms explainimg why some decisions are taken and what numerical issues may be expected.</div><br/></div></div><div id="37621106" class="c"><input type="checkbox" id="c-37621106" checked=""/><div class="controls bullet"><span class="by">WithinReason</span><span>|</span><a href="#37621033">parent</a><span>|</span><a href="#37621082">prev</a><span>|</span><a href="#37620133">next</a><span>|</span><label class="collapse" for="c-37621106">[-]</label><label class="expand" for="c-37621106">[2 more]</label></div><br/><div class="children"><div class="content">It implements x==y, but it&#x27;s also true when one of them is a NaN</div><br/><div id="37621323" class="c"><input type="checkbox" id="c-37621323" checked=""/><div class="controls bullet"><span class="by">aquarin</span><span>|</span><a href="#37621033">root</a><span>|</span><a href="#37621106">parent</a><span>|</span><a href="#37620133">next</a><span>|</span><label class="collapse" for="c-37621323">[-]</label><label class="expand" for="c-37621323">[1 more]</label></div><br/><div class="children"><div class="content">I understand. You want to work with NaN-s for some reason.</div><br/></div></div></div></div></div></div><div id="37620133" class="c"><input type="checkbox" id="c-37620133" checked=""/><div class="controls bullet"><span class="by">Waterluvian</span><span>|</span><a href="#37621033">prev</a><span>|</span><label class="collapse" for="c-37620133">[-]</label><label class="expand" for="c-37620133">[7 more]</label></div><br/><div class="children"><div class="content">Very nice! I wonder if I can compile this to wasm. I’ve been badly needing spatial predicates in a web environment that are faster and less clunky than JSTS.<p>Does it assume a flat Cartesian world or does it handle ellipsoids or even map projections? (Or does it avoid the complexity altogether by not doing any work that cares about distances?)</div><br/><div id="37621213" class="c"><input type="checkbox" id="c-37621213" checked=""/><div class="controls bullet"><span class="by">crabmusket</span><span>|</span><a href="#37620133">parent</a><span>|</span><a href="#37620574">next</a><span>|</span><label class="collapse" for="c-37621213">[-]</label><label class="expand" for="c-37621213">[1 more]</label></div><br/><div class="children"><div class="content">Are there any other libraries in the browser space that implement polygon Boolean operations other than JSTS?<p>I&#x27;ve tried martinez-polygon-clipping, polygon-clipping, and polyclip-ts, all of which are based on the same algorithm, and all of which seem to throw exceptions frequently on geometry with overlapping edges.<p>I&#x27;m thinking I&#x27;ll need to dig into JSTS in the hope it&#x27;ll prove more stable... or learn how to write these kinds of algorithms myself.</div><br/></div></div><div id="37620574" class="c"><input type="checkbox" id="c-37620574" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#37620133">parent</a><span>|</span><a href="#37621213">prev</a><span>|</span><a href="#37620599">next</a><span>|</span><label class="collapse" for="c-37620574">[-]</label><label class="expand" for="c-37620574">[3 more]</label></div><br/><div class="children"><div class="content">Yeah a WASM build of this would be fantastic. It looks like it&#x27;s a very clean C codebase so I expect getting it working in WASM would be relatively straightforward.</div><br/><div id="37620617" class="c"><input type="checkbox" id="c-37620617" checked=""/><div class="controls bullet"><span class="by">tidwall</span><span>|</span><a href="#37620133">root</a><span>|</span><a href="#37620574">parent</a><span>|</span><a href="#37620599">next</a><span>|</span><label class="collapse" for="c-37620617">[-]</label><label class="expand" for="c-37620617">[2 more]</label></div><br/><div class="children"><div class="content">Yes, I used wasm as one of the targets during development.</div><br/><div id="37620628" class="c"><input type="checkbox" id="c-37620628" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#37620133">root</a><span>|</span><a href="#37620617">parent</a><span>|</span><a href="#37620599">next</a><span>|</span><label class="collapse" for="c-37620628">[-]</label><label class="expand" for="c-37620628">[1 more]</label></div><br/><div class="children"><div class="content">Awesome, you should add that to the readme!<p>I blogged about it here: <a href="https:&#x2F;&#x2F;simonwillison.net&#x2F;2023&#x2F;Sep&#x2F;23&#x2F;tg-polygon-indexing&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;simonwillison.net&#x2F;2023&#x2F;Sep&#x2F;23&#x2F;tg-polygon-indexing&#x2F;</a></div><br/></div></div></div></div></div></div><div id="37620599" class="c"><input type="checkbox" id="c-37620599" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#37620133">parent</a><span>|</span><a href="#37620574">prev</a><span>|</span><a href="#37620530">next</a><span>|</span><label class="collapse" for="c-37620599">[-]</label><label class="expand" for="c-37620599">[1 more]</label></div><br/><div class="children"><div class="content">Ellipsoids don&#x27;t <i>have</i> a well-defined answer to what is &quot;inside&quot; or &quot;outside&quot; the asylum.</div><br/></div></div></div></div></div></div></div></div></div></body></html>