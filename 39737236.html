<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710752451890" as="style"/><link rel="stylesheet" href="styles.css?v=1710752451890"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://rfc.zeromq.org/spec/32/">Z85: Format for representing binary data as printable text</a> <span class="domain">(<a href="https://rfc.zeromq.org">rfc.zeromq.org</a>)</span></div><div class="subtext"><span>ingve</span> | <span>34 comments</span></div><br/><div><div id="39738897" class="c"><input type="checkbox" id="c-39738897" checked=""/><div class="controls bullet"><span class="by">danbruc</span><span>|</span><a href="#39741585">next</a><span>|</span><label class="collapse" for="c-39738897">[-]</label><label class="expand" for="c-39738897">[19 more]</label></div><br/><div class="children"><div class="content">Given that interoperability is one of the explicitly mentioned design criteria, it seems a bit of an oversight that they forgot to specify how the encoding actually works. It says nothing about how you encode the 32 bit integer into the five characters and the description of the decoding operation is also pretty vague.<p><i>The five characters SHALL each be converted into a value 0 to 84, and accumulated by multiplication by 85, from most to least significant.</i><p>There is of course the example and the reference implementation and everyone knows how this kind of encoding works, so you can certainly figure out how you are supposed to implement it.</div><br/><div id="39739220" class="c"><input type="checkbox" id="c-39739220" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738897">parent</a><span>|</span><a href="#39739279">next</a><span>|</span><label class="collapse" for="c-39739220">[-]</label><label class="expand" for="c-39739220">[1 more]</label></div><br/><div class="children"><div class="content">The mapping seems fairly clear, even if an implementation is not provided. Just write the 32-bit integer in base 85, using the provided numerals. Most significant numeral first. Since 2^32 &lt; 85^5 you can do it in five characters, though some sequences cannot be achieved. Just like you would do with any other numeric base.</div><br/></div></div><div id="39739279" class="c"><input type="checkbox" id="c-39739279" checked=""/><div class="controls bullet"><span class="by">gary_0</span><span>|</span><a href="#39738897">parent</a><span>|</span><a href="#39739220">prev</a><span>|</span><a href="#39739101">next</a><span>|</span><label class="collapse" for="c-39739279">[-]</label><label class="expand" for="c-39739279">[6 more]</label></div><br/><div class="children"><div class="content">Given that 85^5 &gt; 2^32, it&#x27;s a little strange that they also didn&#x27;t specify what happens if the text encodes a number that doesn&#x27;t fit in 4 bytes.</div><br/><div id="39741181" class="c"><input type="checkbox" id="c-39741181" checked=""/><div class="controls bullet"><span class="by">Dwedit</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739279">parent</a><span>|</span><a href="#39739316">next</a><span>|</span><label class="collapse" for="c-39741181">[-]</label><label class="expand" for="c-39741181">[2 more]</label></div><br/><div class="children"><div class="content">You could theoretically put 1, 2, or 3 byte sequences into the space between 4294967296 and 4437053124.  That gap holds over 27 bits of information.<p>Example: 0 to 4294967295 = 4 bytes<p>4294967296 to 4311744511 = 3 bytes  (subtract 4294967296 first)<p>4311744512 to 4311810047 = 2 bytes  (subtract 4311744512 first)<p>4311810048 to 4311810303 = 1 byte  (subtract 4311810048 first)<p>Then you&#x27;re still left with 125242821 remaining numbers, over 26 bits.</div><br/><div id="39741646" class="c"><input type="checkbox" id="c-39741646" checked=""/><div class="controls bullet"><span class="by">tromp</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39741181">parent</a><span>|</span><a href="#39739316">next</a><span>|</span><label class="collapse" for="c-39741646">[-]</label><label class="expand" for="c-39741646">[1 more]</label></div><br/><div class="children"><div class="content">That is one way to extend the encoding from 4-byte chunks to arbitrary byte lengths.<p>Another is to encode 4k+i bytes as 5k+1+i ASCII characters. That way the encoding length immediately determines the input length.
And there&#x27;s again plenty of space since 85^{i+1} &gt; 256^i for i &lt; 4.</div><br/></div></div></div></div><div id="39739316" class="c"><input type="checkbox" id="c-39739316" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739279">parent</a><span>|</span><a href="#39741181">prev</a><span>|</span><a href="#39739101">next</a><span>|</span><label class="collapse" for="c-39739316">[-]</label><label class="expand" for="c-39739316">[3 more]</label></div><br/><div class="children"><div class="content">Then it’s invalid, same as if it includes unexpected characters or isn’t a multiple of five characters long.</div><br/><div id="39739619" class="c"><input type="checkbox" id="c-39739619" checked=""/><div class="controls bullet"><span class="by">gary_0</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739316">parent</a><span>|</span><a href="#39739101">next</a><span>|</span><label class="collapse" for="c-39739619">[-]</label><label class="expand" for="c-39739619">[2 more]</label></div><br/><div class="children"><div class="content">The &quot;reference implementation&quot; in C seems to just let the int wrap around. It also does an out of bounds array access if the string contains non-ASCII chars.</div><br/><div id="39739680" class="c"><input type="checkbox" id="c-39739680" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739619">parent</a><span>|</span><a href="#39739101">next</a><span>|</span><label class="collapse" for="c-39739680">[-]</label><label class="expand" for="c-39739680">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like the reference implementation only specifies what should be done with valid values then? I’d avoid using it in production without separate validation.</div><br/></div></div></div></div></div></div></div></div><div id="39739101" class="c"><input type="checkbox" id="c-39739101" checked=""/><div class="controls bullet"><span class="by">drpixie</span><span>|</span><a href="#39738897">parent</a><span>|</span><a href="#39739279">prev</a><span>|</span><a href="#39741585">next</a><span>|</span><label class="collapse" for="c-39739101">[-]</label><label class="expand" for="c-39739101">[11 more]</label></div><br/><div class="children"><div class="content">And the author specifies Z85 <i>only</i> for 4 byte chunks of data - not all data comes in 32 bit chunks. If the authors want Z85 to be widely used, specifying padding would be helpful.<p>Anyway, it all seems a bit <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;927&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;927&#x2F;</a></div><br/><div id="39741569" class="c"><input type="checkbox" id="c-39741569" checked=""/><div class="controls bullet"><span class="by">grodriguez100</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739101">parent</a><span>|</span><a href="#39739382">next</a><span>|</span><label class="collapse" for="c-39741569">[-]</label><label class="expand" for="c-39741569">[1 more]</label></div><br/><div class="children"><div class="content">That xkcd comic was the first thing that came to mind as well.<p>The article explains how Base64 is “problematic because it has more than a dozen variants”. So instead of picking one, let’s invent a new standard.</div><br/></div></div><div id="39739382" class="c"><input type="checkbox" id="c-39739382" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739101">parent</a><span>|</span><a href="#39741569">prev</a><span>|</span><a href="#39741585">next</a><span>|</span><label class="collapse" for="c-39739382">[-]</label><label class="expand" for="c-39739382">[9 more]</label></div><br/><div class="children"><div class="content">It looks like they’re counting on most data being padded to 32 bits. The simplicity due to lack of padding rules seems to be the only real advantage this encoding has over base 64. Otherwise you’re right, offering up a new standard because there are too many competing base 64 standards makes no sense.</div><br/><div id="39740091" class="c"><input type="checkbox" id="c-39740091" checked=""/><div class="controls bullet"><span class="by">karmakaze</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739382">parent</a><span>|</span><a href="#39739652">next</a><span>|</span><label class="collapse" for="c-39740091">[-]</label><label class="expand" for="c-39740091">[4 more]</label></div><br/><div class="children"><div class="content">All the issues mentioned in these comments is a good indication why this encoding isn&#x27;t more widely known&#x2F;used.<p>I myself typically binary compress then base64 encode.</div><br/><div id="39741167" class="c"><input type="checkbox" id="c-39741167" checked=""/><div class="controls bullet"><span class="by">Varriount</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39740091">parent</a><span>|</span><a href="#39740597">next</a><span>|</span><label class="collapse" for="c-39741167">[-]</label><label class="expand" for="c-39741167">[1 more]</label></div><br/><div class="children"><div class="content">Good to know I&#x27;m not the only one who has done this! I once wrote a template generation tool that embedded its input configuration into its output files as base64-encoded gzip&#x27;d JSON. Worked quite well at allowing template regeneration.</div><br/></div></div><div id="39740597" class="c"><input type="checkbox" id="c-39740597" checked=""/><div class="controls bullet"><span class="by">bcaxis</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39740091">parent</a><span>|</span><a href="#39741167">prev</a><span>|</span><a href="#39739652">next</a><span>|</span><label class="collapse" for="c-39740597">[-]</label><label class="expand" for="c-39740597">[2 more]</label></div><br/><div class="children"><div class="content">For your trouble, you save some extra bytes with 85 vs 64.</div><br/><div id="39741074" class="c"><input type="checkbox" id="c-39741074" checked=""/><div class="controls bullet"><span class="by">petre</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39740597">parent</a><span>|</span><a href="#39739652">next</a><span>|</span><label class="collapse" for="c-39741074">[-]</label><label class="expand" for="c-39741074">[1 more]</label></div><br/><div class="children"><div class="content">With the added bonus of funny characters which are a pain to encode in JSON, XML and URLs. I guess I&#x27;ll keep using using URL safe Base64, thank you.</div><br/></div></div></div></div></div></div><div id="39739652" class="c"><input type="checkbox" id="c-39739652" checked=""/><div class="controls bullet"><span class="by">nabla9</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739382">parent</a><span>|</span><a href="#39740091">prev</a><span>|</span><a href="#39741585">next</a><span>|</span><label class="collapse" for="c-39739652">[-]</label><label class="expand" for="c-39739652">[4 more]</label></div><br/><div class="children"><div class="content">&gt;The simplicity due to lack of padding rules seems to be the only real advantage<p>Because there is no padding rule given, it&#x27;s impossible to use the standard to encode most binary strings.<p>For example, how would you encode&#x2F;decode these?<p><pre><code>  0x0000000000000000  
  0x00000000000000
  0x000000000000
  0x0000000000
  0x00000000 
  0x000000</code></pre></div><br/><div id="39739748" class="c"><input type="checkbox" id="c-39739748" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739652">parent</a><span>|</span><a href="#39739750">next</a><span>|</span><label class="collapse" for="c-39739748">[-]</label><label class="expand" for="c-39739748">[2 more]</label></div><br/><div class="children"><div class="content">You could only encode the ones whose length was a multiple of 8. 0x00000000 would be 00000. 0x0000000000000000 would be 00000 00000. How would you encode binary 000000 in hex?</div><br/><div id="39741673" class="c"><input type="checkbox" id="c-39741673" checked=""/><div class="controls bullet"><span class="by">yau8edq12i</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739748">parent</a><span>|</span><a href="#39739750">next</a><span>|</span><label class="collapse" for="c-39741673">[-]</label><label class="expand" for="c-39741673">[1 more]</label></div><br/><div class="children"><div class="content">&quot;Hex(adecimal)&quot; is not an encoding scheme, it&#x27;s a number basis. &quot;Binary 00000&quot; as a number is just zero, which is written equivalently as &quot;0&quot;, &quot;00&quot;... in hexadecimal. This is different from a chunk of data consisting of six bits that all happen to be zero. And indeed, you need to decide on how to convey that, and simply saying &quot;hex&quot; - or &quot;binary&quot; for that matter - is not enough, that is correct.</div><br/></div></div></div></div><div id="39739750" class="c"><input type="checkbox" id="c-39739750" checked=""/><div class="controls bullet"><span class="by">fwip</span><span>|</span><a href="#39738897">root</a><span>|</span><a href="#39739652">parent</a><span>|</span><a href="#39739748">prev</a><span>|</span><a href="#39741585">next</a><span>|</span><label class="collapse" for="c-39739750">[-]</label><label class="expand" for="c-39739750">[1 more]</label></div><br/><div class="children"><div class="content">If the situation requires decoding strings of unknown length, you simply prefix the length.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39741585" class="c"><input type="checkbox" id="c-39741585" checked=""/><div class="controls bullet"><span class="by">firechickenbird</span><span>|</span><a href="#39738897">prev</a><span>|</span><a href="#39740735">next</a><span>|</span><label class="collapse" for="c-39741585">[-]</label><label class="expand" for="c-39741585">[1 more]</label></div><br/><div class="children"><div class="content">At first glance I thought SHALL standed for SHA-language model :|</div><br/></div></div><div id="39740735" class="c"><input type="checkbox" id="c-39740735" checked=""/><div class="controls bullet"><span class="by">azinman2</span><span>|</span><a href="#39741585">prev</a><span>|</span><a href="#39739646">next</a><span>|</span><label class="collapse" for="c-39740735">[-]</label><label class="expand" for="c-39740735">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The binary frame SHALL have a length that is divisible by 4 with no remainder. The string frame SHALL have a length that is divisible by 5 with no remainder. It is up to the application to ensure that frames and strings are padded if necessary.<p>Not including padding will seriously hinder this. You want that UX for people to be able to use it widely and just work. The post talks about wanting one compatible standard, but leaving out how to deal with padding means you know have incompatible ways of doing so. Plus many junior devs won’t even understand the need of padding, and will be extra confused when it doesn’t “just work.”<p>I do appreciate the many other bits it tries to solve, however.</div><br/></div></div><div id="39739646" class="c"><input type="checkbox" id="c-39739646" checked=""/><div class="controls bullet"><span class="by">reidacdc</span><span>|</span><a href="#39740735">prev</a><span>|</span><a href="#39738405">next</a><span>|</span><label class="collapse" for="c-39739646">[-]</label><label class="expand" for="c-39739646">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure if this is a fair question or not, but suppose I have a 6-byte blob I want to send. I can pad it out to 8 bytes, use this scheme to encode it, and send it.<p>Then I want the receiver to understand that only the first 6 bytes of their decoded results are part of the transmission -- how do I do that?<p>Base64 has a special character (&#x27;=&#x27;) that is used for encoding padding, but this method doesn&#x27;t seem to have that. The spec says &quot;it is up to the application to ensure that frames and strings are padded if necessary&quot;, which suggests they&#x27;ve scoped this problem out.<p>I suppose I can always build a little &quot;packet&quot; that starts with the payload length, so that the receiver can infer the existence of padding if there is additional data beyond the advertised payload length, but now the receiver and I need to agree on that protocol.</div><br/></div></div><div id="39738405" class="c"><input type="checkbox" id="c-39738405" checked=""/><div class="controls bullet"><span class="by">tyingq</span><span>|</span><a href="#39739646">prev</a><span>|</span><a href="#39739536">next</a><span>|</span><label class="collapse" for="c-39738405">[-]</label><label class="expand" for="c-39738405">[6 more]</label></div><br/><div class="children"><div class="content">Seems reasonable. Avoids single and double quotes and the backslash.  Though still not usable in some places, like urls.</div><br/><div id="39738804" class="c"><input type="checkbox" id="c-39738804" checked=""/><div class="controls bullet"><span class="by">kiicia</span><span>|</span><a href="#39738405">parent</a><span>|</span><a href="#39740804">next</a><span>|</span><label class="collapse" for="c-39738804">[-]</label><label class="expand" for="c-39738804">[1 more]</label></div><br/><div class="children"><div class="content">There are different versions of base85, it is in general perfect for dense passwords <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Ascii85" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Ascii85</a></div><br/></div></div><div id="39740804" class="c"><input type="checkbox" id="c-39740804" checked=""/><div class="controls bullet"><span class="by">Rygian</span><span>|</span><a href="#39738405">parent</a><span>|</span><a href="#39738804">prev</a><span>|</span><a href="#39738917">next</a><span>|</span><label class="collapse" for="c-39740804">[-]</label><label class="expand" for="c-39740804">[1 more]</label></div><br/><div class="children"><div class="content">Also allows &amp; so probably not safe to use in HTML (assuming browsers may helpfully add the omitted ; ).</div><br/></div></div><div id="39738917" class="c"><input type="checkbox" id="c-39738917" checked=""/><div class="controls bullet"><span class="by">karmakaze</span><span>|</span><a href="#39738405">parent</a><span>|</span><a href="#39740804">prev</a><span>|</span><a href="#39739536">next</a><span>|</span><label class="collapse" for="c-39738917">[-]</label><label class="expand" for="c-39738917">[3 more]</label></div><br/><div class="children"><div class="content">Why are ` ~ _ | ; excluded? I could maybe see backtick and pipe to be shell friendly.</div><br/><div id="39739975" class="c"><input type="checkbox" id="c-39739975" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#39738405">root</a><span>|</span><a href="#39738917">parent</a><span>|</span><a href="#39739956">next</a><span>|</span><label class="collapse" for="c-39739975">[-]</label><label class="expand" for="c-39739975">[1 more]</label></div><br/><div class="children"><div class="content">Probably because 85 symbols are enough to store 32 bits in 5 characters. You’d need 256 symbols to do better.</div><br/></div></div><div id="39739956" class="c"><input type="checkbox" id="c-39739956" checked=""/><div class="controls bullet"><span class="by">jameshart</span><span>|</span><a href="#39738405">root</a><span>|</span><a href="#39738917">parent</a><span>|</span><a href="#39739975">prev</a><span>|</span><a href="#39739536">next</a><span>|</span><label class="collapse" for="c-39739956">[-]</label><label class="expand" for="c-39739956">[1 more]</label></div><br/><div class="children"><div class="content">But it includes $, which is decidedly shell-<i>unfriendly</i>.</div><br/></div></div></div></div></div></div><div id="39739536" class="c"><input type="checkbox" id="c-39739536" checked=""/><div class="controls bullet"><span class="by">kayson</span><span>|</span><a href="#39738405">prev</a><span>|</span><label class="collapse" for="c-39739536">[-]</label><label class="expand" for="c-39739536">[5 more]</label></div><br/><div class="children"><div class="content">How can this have a copyright and also be GPL? Or maybe a better way of asking it is - what does a copyright even do if you give limitless permission to copy?</div><br/><div id="39739877" class="c"><input type="checkbox" id="c-39739877" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#39739536">parent</a><span>|</span><a href="#39740821">next</a><span>|</span><label class="collapse" for="c-39739877">[-]</label><label class="expand" for="c-39739877">[1 more]</label></div><br/><div class="children"><div class="content">Copyright just asserts who gets to set the terms.<p>GPL is just a particular set of terms.<p>GPL never meant no copyright or no terms. In fact it sets very strict terms, just not very many, not very complicated, and not the usual ones.<p>You never knew the basic premis or theory of how the gpl works?</div><br/></div></div><div id="39740821" class="c"><input type="checkbox" id="c-39740821" checked=""/><div class="controls bullet"><span class="by">teo_zero</span><span>|</span><a href="#39739536">parent</a><span>|</span><a href="#39739877">prev</a><span>|</span><a href="#39739567">next</a><span>|</span><label class="collapse" for="c-39740821">[-]</label><label class="expand" for="c-39740821">[2 more]</label></div><br/><div class="children"><div class="content">Limitless? The GPL 3 is quite specific about what you can and can&#x27;t do.<p>This opens up a new question: so this encoding will never be allowed in proprietary software?</div><br/><div id="39741684" class="c"><input type="checkbox" id="c-39741684" checked=""/><div class="controls bullet"><span class="by">yau8edq12i</span><span>|</span><a href="#39739536">root</a><span>|</span><a href="#39740821">parent</a><span>|</span><a href="#39739567">next</a><span>|</span><label class="collapse" for="c-39741684">[-]</label><label class="expand" for="c-39741684">[1 more]</label></div><br/><div class="children"><div class="content">You can&#x27;t copyright an idea. What&#x27;s copyrighted is the text of the specification. Anybody who&#x27;s made aware of the idea is free to implement it.</div><br/></div></div></div></div><div id="39739567" class="c"><input type="checkbox" id="c-39739567" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#39739536">parent</a><span>|</span><a href="#39740821">prev</a><span>|</span><label class="collapse" for="c-39739567">[-]</label><label class="expand" for="c-39739567">[1 more]</label></div><br/><div class="children"><div class="content">Without a copyright, there is no GPL, because there&#x27;s nothing to license.</div><br/></div></div></div></div></div></div></div></div></div></body></html>