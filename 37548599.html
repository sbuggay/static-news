<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1695027663760" as="style"/><link rel="stylesheet" href="styles.css?v=1695027663760"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.a1k0n.net/2011/07/20/donut-math.html">Donut math: how donut.c works</a> <span class="domain">(<a href="https://www.a1k0n.net">www.a1k0n.net</a>)</span></div><div class="subtext"><span>mr_o47</span> | <span>10 comments</span></div><br/><div><div id="37552690" class="c"><input type="checkbox" id="c-37552690" checked=""/><div class="controls bullet"><span class="by">Agingcoder</span><span>|</span><a href="#37552914">next</a><span>|</span><label class="collapse" for="c-37552690">[-]</label><label class="expand" for="c-37552690">[1 more]</label></div><br/><div class="children"><div class="content">That’s the kind of thing that had me learn coding many years ago ( watching demoscene productions).</div><br/></div></div><div id="37552914" class="c"><input type="checkbox" id="c-37552914" checked=""/><div class="controls bullet"><span class="by">supportengineer</span><span>|</span><a href="#37552690">prev</a><span>|</span><a href="#37552305">next</a><span>|</span><label class="collapse" for="c-37552914">[-]</label><label class="expand" for="c-37552914">[4 more]</label></div><br/><div class="children"><div class="content">What platform does this compile on?  Didn&#x27;t work for me on a recent model M1 MacBook Pro.</div><br/><div id="37553251" class="c"><input type="checkbox" id="c-37553251" checked=""/><div class="controls bullet"><span class="by">unwind</span><span>|</span><a href="#37552914">parent</a><span>|</span><a href="#37552991">next</a><span>|</span><label class="collapse" for="c-37553251">[-]</label><label class="expand" for="c-37553251">[2 more]</label></div><br/><div class="children"><div class="content">I got it to compile in Linux on x86-64, with the following tiny changes:<p>- Add #include &lt;stdio.h&gt; (for printf())<p>- Add #include &lt;string.h&gt; (for memset())<p>- Add &quot;int&quot; before the initial bare declaration of &quot;k&quot;<p>I compiled it with:<p><pre><code>    $ gcc -o donut -std=c89 donut.c -lm
</code></pre>
Which includes:<p>- Specifying an old language standard to get rid of the need to say &quot;int&quot; before main()<p>- Linking the math library (&quot;-lm&quot;) for the trig functions.<p>Update: minor grammar and clarification.</div><br/><div id="37553542" class="c"><input type="checkbox" id="c-37553542" checked=""/><div class="controls bullet"><span class="by">stabbles</span><span>|</span><a href="#37552914">root</a><span>|</span><a href="#37553251">parent</a><span>|</span><a href="#37552991">next</a><span>|</span><label class="collapse" for="c-37553542">[-]</label><label class="expand" for="c-37553542">[1 more]</label></div><br/><div class="children"><div class="content">With -std=c89 you shouldn&#x27;t need that `int k`, right?<p>Further, you can add includes on the command line<p><pre><code>    cc -std=c89 donut.c -include stdio.h -include string.h -include math.h -lm
</code></pre>
Then the source can be left as is.</div><br/></div></div></div></div><div id="37552991" class="c"><input type="checkbox" id="c-37552991" checked=""/><div class="controls bullet"><span class="by">physicsguy</span><span>|</span><a href="#37552914">parent</a><span>|</span><a href="#37553251">prev</a><span>|</span><a href="#37552305">next</a><span>|</span><label class="collapse" for="c-37552991">[-]</label><label class="expand" for="c-37552991">[1 more]</label></div><br/><div class="children"><div class="content">What were the errors?</div><br/></div></div></div></div><div id="37552305" class="c"><input type="checkbox" id="c-37552305" checked=""/><div class="controls bullet"><span class="by">munchler</span><span>|</span><a href="#37552914">prev</a><span>|</span><a href="#37553232">next</a><span>|</span><label class="collapse" for="c-37552305">[-]</label><label class="expand" for="c-37552305">[1 more]</label></div><br/><div class="children"><div class="content">(2011)</div><br/></div></div><div id="37553232" class="c"><input type="checkbox" id="c-37553232" checked=""/><div class="controls bullet"><span class="by">jheriko</span><span>|</span><a href="#37552305">prev</a><span>|</span><label class="collapse" for="c-37553232">[-]</label><label class="expand" for="c-37553232">[3 more]</label></div><br/><div class="children"><div class="content">reminds me of stuff i based in basic when i was a kid<p>made me laugh to see &quot;no raytracing&quot;, then immediate use of the perspective projection which is intersecting points and a plane along a ray lol...</div><br/><div id="37553751" class="c"><input type="checkbox" id="c-37553751" checked=""/><div class="controls bullet"><span class="by">ggambetta</span><span>|</span><a href="#37553232">parent</a><span>|</span><a href="#37553655">next</a><span>|</span><label class="collapse" for="c-37553751">[-]</label><label class="expand" for="c-37553751">[1 more]</label></div><br/><div class="children"><div class="content">Deriving the perspective projection equations involves intersecting a ray and the projection plane, but this doesn&#x27;t magically turn a rasterizer into a raytracer.</div><br/></div></div><div id="37553655" class="c"><input type="checkbox" id="c-37553655" checked=""/><div class="controls bullet"><span class="by">waveBidder</span><span>|</span><a href="#37553232">parent</a><span>|</span><a href="#37553751">prev</a><span>|</span><label class="collapse" for="c-37553655">[-]</label><label class="expand" for="c-37553655">[1 more]</label></div><br/><div class="children"><div class="content">it&#x27;s boutique hand-derived ray tracing! very different</div><br/></div></div></div></div></div></div></div></div></div></body></html>