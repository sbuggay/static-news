<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1731920460311" as="style"/><link rel="stylesheet" href="styles.css?v=1731920460311"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/joexbayer/c-web-modules">Hobby Project: A dynamic C (Hot reloading) module-based Web Framework</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>warothia</span> | <span>31 comments</span></div><br/><div><div id="42167039" class="c"><input type="checkbox" id="c-42167039" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#42170374">next</a><span>|</span><label class="collapse" for="c-42167039">[-]</label><label class="expand" for="c-42167039">[5 more]</label></div><br/><div class="children"><div class="content">Cool! Looks like is used dynamic loading. Which is certainly workable. One downside is that while dynamic loading is well-supported, dynamic unloading is generally not. Meaning if you are using dynamic loading and re-loading for hot updates the server process will start to accumulate memory. Not a huge issue of the server process is periodically restarted, but can potentially cause weird bugs.<p>You might be able to make something more robust by forking and loading the modules in a separate process. Then do something fancy with shared memory between the main process and the module processes. But I haven’t looked into this much</div><br/><div id="42169759" class="c"><input type="checkbox" id="c-42169759" checked=""/><div class="controls bullet"><span class="by">shakna</span><span>|</span><a href="#42167039">parent</a><span>|</span><a href="#42167890">next</a><span>|</span><label class="collapse" for="c-42169759">[-]</label><label class="expand" for="c-42169759">[2 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t dlclose unload things...?<p>&gt; If the reference count drops to zero and no other loaded libraries use symbols in it, then the dynamic library is unloaded.</div><br/></div></div><div id="42167890" class="c"><input type="checkbox" id="c-42167890" checked=""/><div class="controls bullet"><span class="by">delusional</span><span>|</span><a href="#42167039">parent</a><span>|</span><a href="#42169759">prev</a><span>|</span><a href="#42167215">next</a><span>|</span><label class="collapse" for="c-42167890">[-]</label><label class="expand" for="c-42167890">[1 more]</label></div><br/><div class="children"><div class="content">Once you start forking wouldn&#x27;t it make more sense to just exec? Woops, CGI.</div><br/></div></div><div id="42167215" class="c"><input type="checkbox" id="c-42167215" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42167039">parent</a><span>|</span><a href="#42167890">prev</a><span>|</span><a href="#42170374">next</a><span>|</span><label class="collapse" for="c-42167215">[-]</label><label class="expand" for="c-42167215">[1 more]</label></div><br/><div class="children"><div class="content">Oh really interesting, will look into it! Was afraid it would leak memory.</div><br/></div></div></div></div><div id="42170374" class="c"><input type="checkbox" id="c-42170374" checked=""/><div class="controls bullet"><span class="by">dakom</span><span>|</span><a href="#42167039">prev</a><span>|</span><a href="#42165760">next</a><span>|</span><label class="collapse" for="c-42170374">[-]</label><label class="expand" for="c-42170374">[4 more]</label></div><br/><div class="children"><div class="content">Love this :)<p>Small, related anecdote: back in the year 2001 or so, this is in the same family of how I built websites...<p>The difference is I wrote in in C as Apache Modules. So, like, most people were using other people&#x27;s C modules (like PHP or CGI), but once you dug deeper and you wrote your logic&#x2F;site _as_ a C module, it was so much more fun (and powerful too).<p>I didn&#x27;t have much of a templating language, so the answer to &quot;can we change the text on this page?&quot; was usually, &quot;sure, just give me a few minutes to recompile the whole Apache server&quot; :D<p>Fun times</div><br/><div id="42170455" class="c"><input type="checkbox" id="c-42170455" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42170374">parent</a><span>|</span><a href="#42165760">next</a><span>|</span><label class="collapse" for="c-42170455">[-]</label><label class="expand" for="c-42170455">[3 more]</label></div><br/><div class="children"><div class="content">Few others have brought up Apache Modules, and they are incredibly similar to my idea. :D Did not know about them while I was developing it. The main difference as far as I could see was the fact that you had to recompile &#x2F; restart the server. Which I try to avoid, so little changes require almost no recompiling.</div><br/><div id="42170474" class="c"><input type="checkbox" id="c-42170474" checked=""/><div class="controls bullet"><span class="by">incanus77</span><span>|</span><a href="#42170374">root</a><span>|</span><a href="#42170455">parent</a><span>|</span><a href="#42165760">next</a><span>|</span><label class="collapse" for="c-42170474">[-]</label><label class="expand" for="c-42170474">[2 more]</label></div><br/><div class="children"><div class="content">Nah, you could just send a SIGHUP and not have to fully restart.</div><br/><div id="42170507" class="c"><input type="checkbox" id="c-42170507" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42170374">root</a><span>|</span><a href="#42170474">parent</a><span>|</span><a href="#42165760">next</a><span>|</span><label class="collapse" for="c-42170507">[-]</label><label class="expand" for="c-42170507">[1 more]</label></div><br/><div class="children"><div class="content">Oh! Did not know that, interesting. I guess they are more alike then.</div><br/></div></div></div></div></div></div></div></div><div id="42165760" class="c"><input type="checkbox" id="c-42165760" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42170374">prev</a><span>|</span><a href="#42167079">next</a><span>|</span><label class="collapse" for="c-42165760">[-]</label><label class="expand" for="c-42165760">[1 more]</label></div><br/><div class="children"><div class="content">This hobby project is inspired by kernel modules and AWS Lambda. It lets you write raw C modules, upload them, and have the server compile and run only the module itself at runtime—no need to recompile the entire application or restart the server.<p>You can update routes and modules dynamically. Even WebSocket handlers can be updated without dropping existing connections.</div><br/></div></div><div id="42167079" class="c"><input type="checkbox" id="c-42167079" checked=""/><div class="controls bullet"><span class="by">revskill</span><span>|</span><a href="#42165760">prev</a><span>|</span><a href="#42166517">next</a><span>|</span><label class="collapse" for="c-42167079">[-]</label><label class="expand" for="c-42167079">[3 more]</label></div><br/><div class="children"><div class="content">How ti integrate with extermal library ?</div><br/><div id="42167235" class="c"><input type="checkbox" id="c-42167235" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42167079">parent</a><span>|</span><a href="#42169098">next</a><span>|</span><label class="collapse" for="c-42167235">[-]</label><label class="expand" for="c-42167235">[1 more]</label></div><br/><div class="children"><div class="content">If you would want to link with external libraries, you would need to modify to server and make sure it has access to them when compiling the modules.</div><br/></div></div><div id="42169098" class="c"><input type="checkbox" id="c-42169098" checked=""/><div class="controls bullet"><span class="by">nurettin</span><span>|</span><a href="#42167079">parent</a><span>|</span><a href="#42167235">prev</a><span>|</span><a href="#42166517">next</a><span>|</span><label class="collapse" for="c-42169098">[-]</label><label class="expand" for="c-42169098">[1 more]</label></div><br/><div class="children"><div class="content">You would need to change some code, or parameterize this:<p><pre><code>    #define LIBS &quot;-L.&#x2F;libs -lmodule -ljansson</code></pre></div><br/></div></div></div></div><div id="42166517" class="c"><input type="checkbox" id="c-42166517" checked=""/><div class="controls bullet"><span class="by">gwbas1c</span><span>|</span><a href="#42167079">prev</a><span>|</span><label class="collapse" for="c-42166517">[-]</label><label class="expand" for="c-42166517">[17 more]</label></div><br/><div class="children"><div class="content">Important question: <i>Why</i> would anyone develop a web application in C? Typically web applications lean heavily on garbage collection and memory safety, because their bottlenecks are very rarely CPU&#x2F;memory issues. The ROI on manually managing memory just isn&#x27;t there for a typical web application.</div><br/><div id="42167520" class="c"><input type="checkbox" id="c-42167520" checked=""/><div class="controls bullet"><span class="by">williamcotton</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42166611">next</a><span>|</span><label class="collapse" for="c-42167520">[-]</label><label class="expand" for="c-42167520">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt; The ROI on manually managing memory just isn&#x27;t there for a typical web application.</i><p>You can use a per-request memory arena built with a simple bump allocator and then free the entire block when the request has been handled.</div><br/></div></div><div id="42166611" class="c"><input type="checkbox" id="c-42166611" checked=""/><div class="controls bullet"><span class="by">warothia</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42167520">prev</a><span>|</span><a href="#42166628">next</a><span>|</span><label class="collapse" for="c-42166611">[-]</label><label class="expand" for="c-42166611">[1 more]</label></div><br/><div class="children"><div class="content">I could say speed, but the main reason for me is because it is fun. And I like to see what I can make C do. :D</div><br/></div></div><div id="42166628" class="c"><input type="checkbox" id="c-42166628" checked=""/><div class="controls bullet"><span class="by">SvenL</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42166611">prev</a><span>|</span><a href="#42167933">next</a><span>|</span><label class="collapse" for="c-42166628">[-]</label><label class="expand" for="c-42166628">[5 more]</label></div><br/><div class="children"><div class="content">On the other hand memory management in web applications is quite easy. 
Most of the stuff is only required for the lifetime of a request. Some stuff needs to be available the whole application life time.</div><br/><div id="42168057" class="c"><input type="checkbox" id="c-42168057" checked=""/><div class="controls bullet"><span class="by">smt88</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42166628">parent</a><span>|</span><a href="#42167933">next</a><span>|</span><label class="collapse" for="c-42168057">[-]</label><label class="expand" for="c-42168057">[4 more]</label></div><br/><div class="children"><div class="content">You can do this with other languages (C# for example) as well. Memory is so cheap, though, that most companies should spend their money on increasing memory rather than on paying programmers to optimize memory usage.</div><br/><div id="42168940" class="c"><input type="checkbox" id="c-42168940" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42168057">parent</a><span>|</span><a href="#42168203">next</a><span>|</span><label class="collapse" for="c-42168940">[-]</label><label class="expand" for="c-42168940">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think memory usage is the problem, but rather allocation costs and memory layout, i.e. performance.<p>Serving web traffic simply isn&#x27;t a very memory hungry task.</div><br/></div></div><div id="42168203" class="c"><input type="checkbox" id="c-42168203" checked=""/><div class="controls bullet"><span class="by">SvenL</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42168057">parent</a><span>|</span><a href="#42168940">prev</a><span>|</span><a href="#42168124">next</a><span>|</span><label class="collapse" for="c-42168203">[-]</label><label class="expand" for="c-42168203">[1 more]</label></div><br/><div class="children"><div class="content">Yes, for most use cases it doesn’t really matter which language is chosen.<p>Regarding just spending more money on memory - I agree that it’s definitely cheaper but it’s not only about wasting bytes of memory. If the garbage collector has a lot of work to do it may also impact response time&#x2F;throughput.<p>And yes, C# did a pretty good job with implementing mechanisms for reducing allocations on a language level. This definitely helps to reduce garbage collection.</div><br/></div></div><div id="42168124" class="c"><input type="checkbox" id="c-42168124" checked=""/><div class="controls bullet"><span class="by">HexDecOctBin</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42168057">parent</a><span>|</span><a href="#42168203">prev</a><span>|</span><a href="#42167933">next</a><span>|</span><label class="collapse" for="c-42168124">[-]</label><label class="expand" for="c-42168124">[1 more]</label></div><br/><div class="children"><div class="content">Cheap for whom? American programmers with FAANG salaries, or an under-funded third world NGO?</div><br/></div></div></div></div></div></div><div id="42167933" class="c"><input type="checkbox" id="c-42167933" checked=""/><div class="controls bullet"><span class="by">wwweston</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42166628">prev</a><span>|</span><a href="#42167123">next</a><span>|</span><label class="collapse" for="c-42167933">[-]</label><label class="expand" for="c-42167933">[4 more]</label></div><br/><div class="children"><div class="content">Speaking as someone who has done this back in the early wild days of the web:<p>* if what you&#x27;re vending is the software instead of the service (not what people usually do now, but there was a time), then this approach does provide for <i>some</i> obfuscation of IP and various secrets.<p>* for <i>some</i> demand&#x2F;resource profiles, CPU &amp; memory issues are a lot easier to run into. The one I experienced with this project was targeting a serious e-commerce product to the context of 20-30 year old shared hosting environments (again, not what people would do now), but there may be different situational niches today.<p>* familiarity. Sometimes you use what you know. And in the late 90s today&#x27;s most popular web languages were still <i>years</i> away from being the convenient platform they&#x27;d become. The other popular options were Perl, maybe Java, possibly ColdFusion&#x2F;VB&#x2F;PHP.<p>That said, you&#x27;re correct: memory management was a pain, and by 2005 or so it was pretty clear that programmer cycles were as or more valuable than CPU and respectable frameworks were starting to coalesce in languages much better suited for string manipulation, so the ROI was not great. And of course, today you have other systems languages available like Go and Rust...</div><br/><div id="42168033" class="c"><input type="checkbox" id="c-42168033" checked=""/><div class="controls bullet"><span class="by">smt88</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42167933">parent</a><span>|</span><a href="#42167123">next</a><span>|</span><label class="collapse" for="c-42168033">[-]</label><label class="expand" for="c-42168033">[3 more]</label></div><br/><div class="children"><div class="content">&gt; <i>if what you&#x27;re vending is the software instead of the service (not what people usually do now, but there was a time)</i><p>I&#x27;m very curious what this means. Can you give an example?</div><br/><div id="42170754" class="c"><input type="checkbox" id="c-42170754" checked=""/><div class="controls bullet"><span class="by">dsp_person</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42168033">parent</a><span>|</span><a href="#42168496">next</a><span>|</span><label class="collapse" for="c-42170754">[-]</label><label class="expand" for="c-42170754">[1 more]</label></div><br/><div class="children"><div class="content">You could also run a limited demo of your desktop application in a browser, where people have to pay to get access to the full thing.</div><br/></div></div><div id="42168496" class="c"><input type="checkbox" id="c-42168496" checked=""/><div class="controls bullet"><span class="by">Philpax</span><span>|</span><a href="#42166517">root</a><span>|</span><a href="#42168033">parent</a><span>|</span><a href="#42170754">prev</a><span>|</span><a href="#42167123">next</a><span>|</span><label class="collapse" for="c-42168496">[-]</label><label class="expand" for="c-42168496">[1 more]</label></div><br/><div class="children"><div class="content">Giving the client the executable to run, not running it for them. This means you can&#x27;t hide the artifact from the client; for an interpreted language, this means recovery of the source code would be much easier than with a compiled output.<p>That being said, it&#x27;s still possible to reverse engineer the code; it just makes it harder.</div><br/></div></div></div></div></div></div><div id="42167123" class="c"><input type="checkbox" id="c-42167123" checked=""/><div class="controls bullet"><span class="by">koito17</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42167933">prev</a><span>|</span><a href="#42168255">next</a><span>|</span><label class="collapse" for="c-42167123">[-]</label><label class="expand" for="c-42167123">[1 more]</label></div><br/><div class="children"><div class="content">Back then, C was one of a few viable choices. The original implementation of the 2ch BBS was written in C.[0] Later revisions used Perl. Between 1998 and 2001, the site was a widely-used BBS and written in C.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;nekoruri&#x2F;readcgi">https:&#x2F;&#x2F;github.com&#x2F;nekoruri&#x2F;readcgi</a></div><br/></div></div><div id="42168255" class="c"><input type="checkbox" id="c-42168255" checked=""/><div class="controls bullet"><span class="by">mariocesar</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42167123">prev</a><span>|</span><a href="#42167739">next</a><span>|</span><label class="collapse" for="c-42168255">[-]</label><label class="expand" for="c-42168255">[1 more]</label></div><br/><div class="children"><div class="content">The title &quot;Hobby Project&quot; makes the point right from the beginning</div><br/></div></div><div id="42167739" class="c"><input type="checkbox" id="c-42167739" checked=""/><div class="controls bullet"><span class="by">_gabe_</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42168255">prev</a><span>|</span><a href="#42169645">next</a><span>|</span><label class="collapse" for="c-42167739">[-]</label><label class="expand" for="c-42167739">[1 more]</label></div><br/><div class="children"><div class="content">I’m all for using C for native development (and because I find it fun to work in occasionally), but I agree with your sentiment here. Not only do you have to manage memory manually, but you also have to do a lot more work for basic string manipulation which is the vast majority of web work. I would much rather work with a language with built in support for string manipulation and well known 3rd party libraries with good ergonomics for working with JSON, which a lot of your APIs will most likely be using.</div><br/></div></div><div id="42169645" class="c"><input type="checkbox" id="c-42169645" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42167739">prev</a><span>|</span><a href="#42166883">next</a><span>|</span><label class="collapse" for="c-42169645">[-]</label><label class="expand" for="c-42169645">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  Typically web applications lean heavily on garbage collection and memory safety, because their bottlenecks are very rarely CPU&#x2F;memory issues.<p>I dunno about this assertion. Maybe it <i>seems</i> like the bottleneck is rarely CPU&#x2F;memory when you&#x27;re throwing 1GB RAM + dedicated instance at a webapp, but, for example Jenkins absolutely trashes any 1GB RAM instance because it runs out of RAM and&#x2F;or CPU.<p>My homegrown builder&#x2F;runner CI&#x2F;CD system, running the same `go build&#x2F;test` commands, the same `git checkout` commands etc, written in C, peaks at a mere 60MB of RAM usage.<p>I feel we are collectively underestimating just how much extra RAM is needed the popular languages that run a typical GC.<p>[EDIT: I no longer even use my simple C app - I find a `make` cronjob for every 2m uses even less RAM, because there is no web interface anymore, I ssh into that machine to add new projects to the makefile]</div><br/></div></div><div id="42166883" class="c"><input type="checkbox" id="c-42166883" checked=""/><div class="controls bullet"><span class="by">Aurornis</span><span>|</span><a href="#42166517">parent</a><span>|</span><a href="#42169645">prev</a><span>|</span><label class="collapse" for="c-42166883">[-]</label><label class="expand" for="c-42166883">[1 more]</label></div><br/><div class="children"><div class="content">Lightweight web frameworks are great for embedded applications.</div><br/></div></div></div></div></div></div></div></div></div></body></html>