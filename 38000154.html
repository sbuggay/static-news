<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1698224463499" as="style"/><link rel="stylesheet" href="styles.css?v=1698224463499"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://words.filippo.io/dispatches/parameters/">Why we don’t generate elliptic curves every day</a> <span class="domain">(<a href="https://words.filippo.io">words.filippo.io</a>)</span></div><div class="subtext"><span>mfrw</span> | <span>45 comments</span></div><br/><div><div id="38001782" class="c"><input type="checkbox" id="c-38001782" checked=""/><div class="controls bullet"><span class="by">phkahler</span><span>|</span><a href="#38003460">next</a><span>|</span><label class="collapse" for="c-38001782">[-]</label><label class="expand" for="c-38001782">[22 more]</label></div><br/><div class="children"><div class="content">The author never addresses the issue of trusting standard parameters. I agree with them on the rest, but standard parameters need evidence that they were not specially selected for reasons unknown to everyone else.</div><br/><div id="38002675" class="c"><input type="checkbox" id="c-38002675" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38001782">parent</a><span>|</span><a href="#38002119">next</a><span>|</span><label class="collapse" for="c-38002675">[-]</label><label class="expand" for="c-38002675">[15 more]</label></div><br/><div class="children"><div class="content">You&#x27;re never going to get a satisfactory answer. The world&#x27;s foremost proponent of not trusting standardized parameters wrote and repeatedly submitted a paper demonstrating a model attack that targeted curves built from mathematical constants; when you&#x27;ve &quot;backdoored pi&quot;, there&#x27;s really no place to go from there.<p>That author&#x27;s subtext, as I understood it, was that curves should be selected by functional optimization; pick the curve parameters that best solve the engineering problems. It was a useful argument given their preferred curve, 25519, which does indeed have a lot of attractive engineering features! But it&#x27;s not hard to see that engineering excellence is a selection principle with even more degrees of freedom than mathematical constants; moreover, you&#x27;re only ever considering optimality at a fixed point in time, but the optimums change over time --- cofactors might be less important when we lack complete additional formulae for a Weierstrass curves, which makes them hard to implement in constant time, but much more important once we do (as is the case now).<p>There&#x27;s really no way around just doing the computer science and cryptological work of working out curve attacks. That&#x27;s the Menezes and Koblitz argument from the &quot;Enigma&quot; paper: that the reason to trust the NIST P-curves is that we&#x27;d know by now if they were weak (not because NSA doesn&#x27;t have secret attacks, but because the mechanism by which they were generated would result in whole large classes of broken curves that academic cryptography and mathematics would have caught by now).<p>If you don&#x27;t find Alfred Menezes and Neil Koblitz persuasive surveyors of elliptic curve security, that&#x27;s fine, but my response would be that you can&#x27;t really trust any parameters at all at that point. Certainly, investing trust in the cryptographers best known to the generalist programmer audience seems like a bad alternative strategy.</div><br/><div id="38004569" class="c"><input type="checkbox" id="c-38004569" checked=""/><div class="controls bullet"><span class="by">nmadden</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002675">parent</a><span>|</span><a href="#38002990">next</a><span>|</span><label class="collapse" for="c-38004569">[-]</label><label class="expand" for="c-38004569">[2 more]</label></div><br/><div class="children"><div class="content">&gt; cofactors might be less important when we lack complete additional formulae for a Weierstrass curves, which makes them hard to implement in constant time, but much more important once we do (as is the case now).<p>If I remember correctly, part of the reason for the cofactor in 25519 is because Montgomery curves have to have a cofactor and only those curves have the nice x-only Montgomery Ladder, which basically rules out invalid curve attacks (so long as the curve is twist-secure — not all the NIST curves are IIRC). Do the complete addition formulas for short Weierstrass curves also fix this? Invalid curve attacks are a major danger for NIST curves.<p>I know you can use compressed point representation to get the same benefit, but that seems very rare in NIST curve implementations (because old now-expired patents). The landscape of NIST prime-order curve implementations is not great. If all those libraries were going to actually switch to complete addition formulas and compressed public keys then I might feel better about them enjoying a renaissance.</div><br/><div id="38005196" class="c"><input type="checkbox" id="c-38005196" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38004569">parent</a><span>|</span><a href="#38002990">next</a><span>|</span><label class="collapse" for="c-38005196">[-]</label><label class="expand" for="c-38005196">[1 more]</label></div><br/><div class="children"><div class="content">I agree with you, and am reassured by cryptosystems that use 25519 and put on edge by those that use the P-curves (not because of backdoor conspiracy theories, which are silly, but because the P-curves are easy to mess up). But cryptography engineers increasingly disagree with me.</div><br/></div></div></div></div><div id="38002990" class="c"><input type="checkbox" id="c-38002990" checked=""/><div class="controls bullet"><span class="by">throw0101c</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002675">parent</a><span>|</span><a href="#38004569">prev</a><span>|</span><a href="#38003057">next</a><span>|</span><label class="collapse" for="c-38002990">[-]</label><label class="expand" for="c-38002990">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>That&#x27;s the Menezes and Koblitz argument from the &quot;Enigma&quot; paper</i> […]<p>PDF:<p>&gt; <i>In August 2015 the U.S. National Security Agency (NSA) released a major policy statement on the need for post-quantum cryp- tography (PQC). This announcement will be a great stimulus to the development, standardization, and commercialization of new quantum- safe algorithms. However, certain peculiarities in the wording and tim- ing of the statement have puzzled many people and given rise to much speculation concerning the NSA, elliptic curve cryptography (ECC), and quantum-safe cryptography. Our purpose is to attempt to evaluate some of the theories that have been proposed.</i><p>* <a href="https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2015&#x2F;1018.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2015&#x2F;1018.pdf</a><p>Then-coverage:<p>* <a href="https:&#x2F;&#x2F;blog.cryptographyengineering.com&#x2F;2015&#x2F;10&#x2F;22&#x2F;a-riddle-wrapped-in-curve&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.cryptographyengineering.com&#x2F;2015&#x2F;10&#x2F;22&#x2F;a-riddle...</a></div><br/></div></div><div id="38003057" class="c"><input type="checkbox" id="c-38003057" checked=""/><div class="controls bullet"><span class="by">oh_sigh</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002675">parent</a><span>|</span><a href="#38002990">prev</a><span>|</span><a href="#38006746">next</a><span>|</span><label class="collapse" for="c-38003057">[-]</label><label class="expand" for="c-38003057">[6 more]</label></div><br/><div class="children"><div class="content">Hell, even picking seeds like &quot;the text of the NYT headline from [future date]&quot;, since the FBI or some other shadowy governmental organization could lean on the NYT editor to construct the headline in a manner that is useful to them</div><br/><div id="38003395" class="c"><input type="checkbox" id="c-38003395" checked=""/><div class="controls bullet"><span class="by">capitainenemo</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38003057">parent</a><span>|</span><a href="#38007870">next</a><span>|</span><label class="collapse" for="c-38003395">[-]</label><label class="expand" for="c-38003395">[4 more]</label></div><br/><div class="children"><div class="content">That seems solvable by picking things about the future that are a lot harder to influence, like the hashes of future bitcoin blocks, or the exact value of all stocks on the NYSE at a given moment in time.<p>... ok. stock one is probably easier to influence by suborning the exchange :) - all world exchanges?</div><br/><div id="38004623" class="c"><input type="checkbox" id="c-38004623" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38003395">parent</a><span>|</span><a href="#38006566">next</a><span>|</span><label class="collapse" for="c-38004623">[-]</label><label class="expand" for="c-38004623">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an interesting thought experiment, but it feels a little like trying to come up with the best defense against alien invaders.  We&#x27;re already talking about attackers able to craft cryptographic weaknesses decades of peer review can&#x27;t discover or explain.  Trying to figure out how to usefully constrain their algorithm design choices does not seem like a winning strategy.<p>The bitcoin block hash thing is interesting, but if you&#x27;re talking about an attacker with that kind of unknown but sophisticated capability, how do you know it actually thwarts their plans?  Maybe all they need is any large number with high entropy or maybe the leading zeros characteristic of bitcoin block hashes is actually key to their attack?  Once you imbue your adversary with unknown powers, it&#x27;s by definition difficult to know what helps or hurts them.</div><br/><div id="38006564" class="c"><input type="checkbox" id="c-38006564" checked=""/><div class="controls bullet"><span class="by">capitainenemo</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38004623">parent</a><span>|</span><a href="#38006566">next</a><span>|</span><label class="collapse" for="c-38006564">[-]</label><label class="expand" for="c-38006564">[1 more]</label></div><br/><div class="children"><div class="content">heh. well, could drop the leading zeros :)<p>But, yeah, magic powers, sure, anything goes. I was just thinking there must be something more reliable than NYT headlines.</div><br/></div></div></div></div><div id="38006566" class="c"><input type="checkbox" id="c-38006566" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38003395">parent</a><span>|</span><a href="#38004623">prev</a><span>|</span><a href="#38007870">next</a><span>|</span><label class="collapse" for="c-38006566">[-]</label><label class="expand" for="c-38006566">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s way harder to fake physical measurements (like weather, solar activity, etc) published by international bodies, You could maybeeee influence the least significant digit but even this would be hard without cooking up experimental data.<p>Maybe get physical measurements, stock exchange data, newspaper headlines, and bitcoin blocks, all in 6 months in the future, and XOR all of them.</div><br/></div></div></div></div><div id="38007870" class="c"><input type="checkbox" id="c-38007870" checked=""/><div class="controls bullet"><span class="by">quesera</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38003057">parent</a><span>|</span><a href="#38003395">prev</a><span>|</span><a href="#38006746">next</a><span>|</span><label class="collapse" for="c-38007870">[-]</label><label class="expand" for="c-38007870">[1 more]</label></div><br/><div class="children"><div class="content">Hmm. How about asking all members of the UN to produce 8 &quot;random&quot; bytes. Concatenate in ISO alpha order, hash the result.</div><br/></div></div></div></div><div id="38006746" class="c"><input type="checkbox" id="c-38006746" checked=""/><div class="controls bullet"><span class="by">flaghacker</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002675">parent</a><span>|</span><a href="#38003057">prev</a><span>|</span><a href="#38007748">next</a><span>|</span><label class="collapse" for="c-38006746">[-]</label><label class="expand" for="c-38006746">[2 more]</label></div><br/><div class="children"><div class="content">Could you share the paper(s) about &quot;backdoors&quot; in physical constants? That doesn&#x27;t make much sense at first sight.</div><br/><div id="38007364" class="c"><input type="checkbox" id="c-38007364" checked=""/><div class="controls bullet"><span class="by">UncleMeat</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38006746">parent</a><span>|</span><a href="#38007748">next</a><span>|</span><label class="collapse" for="c-38007364">[-]</label><label class="expand" for="c-38007364">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;bada55.cr.yp.to&#x2F;bada55-20150927.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;bada55.cr.yp.to&#x2F;bada55-20150927.pdf</a></div><br/></div></div></div></div><div id="38007748" class="c"><input type="checkbox" id="c-38007748" checked=""/><div class="controls bullet"><span class="by">bmulcahy</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002675">parent</a><span>|</span><a href="#38006746">prev</a><span>|</span><a href="#38002119">next</a><span>|</span><label class="collapse" for="c-38007748">[-]</label><label class="expand" for="c-38007748">[3 more]</label></div><br/><div class="children"><div class="content">&gt;but because the mechanism by which they were generated would result in whole large classes of broken curves that academic cryptography and mathematics would have caught by now<p>Might such discoveries by academics be forcibly suppressed by government agencies?</div><br/><div id="38007883" class="c"><input type="checkbox" id="c-38007883" checked=""/><div class="controls bullet"><span class="by">mattsan</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38007748">parent</a><span>|</span><a href="#38008933">next</a><span>|</span><label class="collapse" for="c-38007883">[-]</label><label class="expand" for="c-38007883">[1 more]</label></div><br/><div class="children"><div class="content">I would argue that suppression of public individuals would be much more difficult than say the NSA just scooping up the best mathematicians in that field</div><br/></div></div><div id="38008933" class="c"><input type="checkbox" id="c-38008933" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38007748">parent</a><span>|</span><a href="#38007883">prev</a><span>|</span><a href="#38002119">next</a><span>|</span><label class="collapse" for="c-38008933">[-]</label><label class="expand" for="c-38008933">[1 more]</label></div><br/><div class="children"><div class="content">No.</div><br/></div></div></div></div></div></div><div id="38002119" class="c"><input type="checkbox" id="c-38002119" checked=""/><div class="controls bullet"><span class="by">FiloSottile</span><span>|</span><a href="#38001782">parent</a><span>|</span><a href="#38002675">prev</a><span>|</span><a href="#38010505">next</a><span>|</span><label class="collapse" for="c-38002119">[-]</label><label class="expand" for="c-38002119">[3 more]</label></div><br/><div class="children"><div class="content">Footnote [1] is about different strategies to select trustworthy standard parameters. I believe they are all good enough to make it so that if someone can still &quot;backdoor&quot; the result, they are so far ahead of the outside world that they might as well have broken the whole scheme, without influencing the parameters.<p>[1] <a href="https:&#x2F;&#x2F;words.filippo.io&#x2F;dispatches&#x2F;parameters&#x2F;#fn1" rel="nofollow noreferrer">https:&#x2F;&#x2F;words.filippo.io&#x2F;dispatches&#x2F;parameters&#x2F;#fn1</a><p>(Yes, I hide too much stuff in the footnotes.)</div><br/><div id="38002498" class="c"><input type="checkbox" id="c-38002498" checked=""/><div class="controls bullet"><span class="by">comex</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002119">parent</a><span>|</span><a href="#38010505">next</a><span>|</span><label class="collapse" for="c-38002498">[-]</label><label class="expand" for="c-38002498">[2 more]</label></div><br/><div class="children"><div class="content">Out of curiosity, have people considered rigidly defining requirements, but rather than picking the simplest&#x2F;lowest value that satisfies the requirements, instead having a public “parameter choice ceremony” using a multiparty random number generation protocol to pick a random value that satisfies the requirements?  That seems like it would make it much harder to manipulate the value by changing the requirements.</div><br/><div id="38006782" class="c"><input type="checkbox" id="c-38006782" checked=""/><div class="controls bullet"><span class="by">woodruffw</span><span>|</span><a href="#38001782">root</a><span>|</span><a href="#38002498">parent</a><span>|</span><a href="#38010505">next</a><span>|</span><label class="collapse" for="c-38006782">[-]</label><label class="expand" for="c-38006782">[1 more]</label></div><br/><div class="children"><div class="content">This probably leads to regress (why trust the multiparty scheme?), and would only be convincing to a tiny fraction of skeptics (asymptotically, the ones who are least likely to be cranks and therefore the least noisy ones).<p>Meanwhile, a <i>big</i> part of current cryptographic design is recognizing that many of our current primitives have far larger margins than we really need, and that we can squeeze performance out of our schemes by taking a more evidence-based approach to parameter selection&#x2F;round counts&#x2F;etc.[1].<p>[1]: <a href="https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2019&#x2F;1492" rel="nofollow noreferrer">https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2019&#x2F;1492</a></div><br/></div></div></div></div></div></div><div id="38010505" class="c"><input type="checkbox" id="c-38010505" checked=""/><div class="controls bullet"><span class="by">teekert</span><span>|</span><a href="#38001782">parent</a><span>|</span><a href="#38002119">prev</a><span>|</span><a href="#38009332">next</a><span>|</span><label class="collapse" for="c-38010505">[-]</label><label class="expand" for="c-38010505">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like one has to prove &quot;a negative&quot; <a href="https:&#x2F;&#x2F;youtu.be&#x2F;n-kXok4tznU?t=26" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;n-kXok4tznU?t=26</a></div><br/></div></div><div id="38009332" class="c"><input type="checkbox" id="c-38009332" checked=""/><div class="controls bullet"><span class="by">uxp8u61q</span><span>|</span><a href="#38001782">parent</a><span>|</span><a href="#38010505">prev</a><span>|</span><a href="#38006618">next</a><span>|</span><label class="collapse" for="c-38009332">[-]</label><label class="expand" for="c-38009332">[1 more]</label></div><br/><div class="children"><div class="content">Whereas parameters generated on the fly don&#x27;t?</div><br/></div></div><div id="38006618" class="c"><input type="checkbox" id="c-38006618" checked=""/><div class="controls bullet"><span class="by">EGreg</span><span>|</span><a href="#38001782">parent</a><span>|</span><a href="#38009332">prev</a><span>|</span><a href="#38003460">next</a><span>|</span><label class="collapse" for="c-38006618">[-]</label><label class="expand" for="c-38006618">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why the Bitcoin and Ethereum crowd trust the Koblitz curves like secp256k1 instead of secp256r1 which is the only curve that is in widespread use in browsers, operating systems, secure enclaves etc.<p>The k1 curve has parameters like 15, whereas the &quot;standard&quot; one has curves with parameters chosen as an &quot;arbitrary&quot; number in the billions for some reason. People believe the NSA may have iterated through the previous ones until they found a vulnerable curve, and NIST recommended that. Take a look:<p><a href="https:&#x2F;&#x2F;cointelegraph.com&#x2F;news&#x2F;this-researcher-says-bitcoins-elliptic-curve-could-have-a-secret-backdoor" rel="nofollow noreferrer">https:&#x2F;&#x2F;cointelegraph.com&#x2F;news&#x2F;this-researcher-says-bitcoins...</a><p>“(1) The Koblitz curve is specially designed for faster scalar multiplications. Hence the (signing, verifying and key generation) operations on Secp256k1 are faster than those on Secp256r1. (2) Although the Secp256r1 curve was announced to be randomly selected, there could still exist some suspicion that some backdoor might be secretly set up in the curve parameters. In contrast, the Koblitz curve parameters are mathematically determined, and there is little possibility for setting such a backdoor.”<p>However, given the prevalence of the r1 curve, Ethereum devs might want to add a precompiled contract so that people can sign into the blockchain without trusting web sites and wallet software:<p><a href="https:&#x2F;&#x2F;ethereum-magicians.org&#x2F;t&#x2F;eip-7212-precompiled-for-secp256r1-curve-support&#x2F;14789" rel="nofollow noreferrer">https:&#x2F;&#x2F;ethereum-magicians.org&#x2F;t&#x2F;eip-7212-precompiled-for-se...</a><p><a href="https:&#x2F;&#x2F;security.stackexchange.com&#x2F;questions&#x2F;256088&#x2F;is-the-elliptic-curve-secp256r1-without-a-backdoor" rel="nofollow noreferrer">https:&#x2F;&#x2F;security.stackexchange.com&#x2F;questions&#x2F;256088&#x2F;is-the-e...</a></div><br/></div></div></div></div><div id="38003460" class="c"><input type="checkbox" id="c-38003460" checked=""/><div class="controls bullet"><span class="by">pilif</span><span>|</span><a href="#38001782">prev</a><span>|</span><a href="#38001241">next</a><span>|</span><label class="collapse" for="c-38003460">[-]</label><label class="expand" for="c-38003460">[3 more]</label></div><br/><div class="children"><div class="content">This is very timely for me. Only two weeks ago, I learned that the bouncycastle Java FTP client library refuses to talk to servers that run with custom dh_params and I was wondering why because my intuition told me that custom parameters should be better than parameters shared between everyone.<p>And now only two weeks later, I get a very good explanation as to why, like often in crypto, intuition was wrong</div><br/><div id="38006157" class="c"><input type="checkbox" id="c-38006157" checked=""/><div class="controls bullet"><span class="by">schoen</span><span>|</span><a href="#38003460">parent</a><span>|</span><a href="#38001241">next</a><span>|</span><label class="collapse" for="c-38006157">[-]</label><label class="expand" for="c-38006157">[2 more]</label></div><br/><div class="children"><div class="content">There can also sometimes be more specialized reasons than the general considerations given in this article. I forgot now whether it was DH or RSA or both, but there was a toy attack where interacting with a peer with super-bad maliciously-chosen parameters can also create an oracle for attacking the same party&#x27;s simultaneous interactions with a third party, if the same secrets are used in both conversations.<p>Sorry for the lack of details, I just totally forget them. I know I did something like this in a CTF, though.<p>A vaguely related example could be that nonce reuse in DSA&#x2F;ECDSA signatures can leak the signing key, so a DSA signer must not allow the other side to choose the nonce. That isn&#x27;t conventionally seen as a &quot;parameter&quot;, but it&#x27;s easy to imagine that an implementer wouldn&#x27;t automatically assume that it&#x27;s actively dangerous to let the other party choose it.</div><br/><div id="38006645" class="c"><input type="checkbox" id="c-38006645" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38003460">root</a><span>|</span><a href="#38006157">parent</a><span>|</span><a href="#38001241">next</a><span>|</span><label class="collapse" for="c-38006645">[-]</label><label class="expand" for="c-38006645">[1 more]</label></div><br/><div class="children"><div class="content">Famously, small subgroup attacks in DH; I can&#x27;t think of non-silly RSA parameter negotiation bugs (I mean, E=1 with SaltStack, but that doesn&#x27;t really count). Invalid point bugs in ECDH and zero-mod-p in PAKEs are similar in spirit, but don&#x27;t really derive from parameter negotiation.</div><br/></div></div></div></div></div></div><div id="38001241" class="c"><input type="checkbox" id="c-38001241" checked=""/><div class="controls bullet"><span class="by">ethbr1</span><span>|</span><a href="#38003460">prev</a><span>|</span><a href="#38008049">next</a><span>|</span><label class="collapse" for="c-38001241">[-]</label><label class="expand" for="c-38001241">[8 more]</label></div><br/><div class="children"><div class="content">Curious to hear someone with more expertise than me opine on the validity of brute forcing standardized parameters, which doesn&#x27;t seem to be discussed in article.<p>Are standardized elliptical curves still susceptible to being &quot;individually&quot; broken in ECDH in practice? Or are there other subsequent randomized mechanisms to accomplish forward secrecy &#x2F; per session resistance?<p>I understand the article&#x27;s point against diversity, but there seems a gap of the &quot;G20 nation states have orders of magnitude more resources than everyone else&quot; variety. Even if something is ridiculously computationally intensive for everyone, it can be feasible given Manhattan Project level resources, if the payoff is worth it.</div><br/><div id="38002592" class="c"><input type="checkbox" id="c-38002592" checked=""/><div class="controls bullet"><span class="by">thadt</span><span>|</span><a href="#38001241">parent</a><span>|</span><a href="#38001535">next</a><span>|</span><label class="collapse" for="c-38002592">[-]</label><label class="expand" for="c-38002592">[3 more]</label></div><br/><div class="children"><div class="content">Brute force? I don&#x27;t think so. Orders of magnitude in brute force are sometimes easier to look at as raw numbers. If we take the sibling comments estimate of the global BitCoin network&#x27;s total computation of 2^90, multiply it arbitrarily by three orders of magnitude we get:<p><pre><code>  2^90        =            1237940039285380000000000000
  2^90 * 1000 =         1237940039285380000000000000000
  2^128       = 340282366920938000000000000000000000000
</code></pre>
Even G20 nation states would still be many orders of magnitude short. Much (much, much, much) cheaper to spend your money and energy on an actual Manhattan Project. Then just show up with a nuclear warhead and ask politely for the key.</div><br/><div id="38004252" class="c"><input type="checkbox" id="c-38004252" checked=""/><div class="controls bullet"><span class="by">PartiallyTyped</span><span>|</span><a href="#38001241">root</a><span>|</span><a href="#38002592">parent</a><span>|</span><a href="#38001535">next</a><span>|</span><label class="collapse" for="c-38004252">[-]</label><label class="expand" for="c-38004252">[2 more]</label></div><br/><div class="children"><div class="content">… or another stuxnet even.</div><br/><div id="38007889" class="c"><input type="checkbox" id="c-38007889" checked=""/><div class="controls bullet"><span class="by">ZoomerCretin</span><span>|</span><a href="#38001241">root</a><span>|</span><a href="#38004252">parent</a><span>|</span><a href="#38001535">next</a><span>|</span><label class="collapse" for="c-38007889">[-]</label><label class="expand" for="c-38007889">[1 more]</label></div><br/><div class="children"><div class="content">Already exists: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Intel_Management_Engine#Security_vulnerabilities" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Intel_Management_Engine#Securi...</a></div><br/></div></div></div></div></div></div><div id="38001535" class="c"><input type="checkbox" id="c-38001535" checked=""/><div class="controls bullet"><span class="by">wolf550e</span><span>|</span><a href="#38001241">parent</a><span>|</span><a href="#38002592">prev</a><span>|</span><a href="#38001329">next</a><span>|</span><label class="collapse" for="c-38001535">[-]</label><label class="expand" for="c-38001535">[3 more]</label></div><br/><div class="children"><div class="content">Every P-256 or X25519 ECDH operation uses a new ephemeral single-use key breaking which is about as hard as brute forcing AES-128. Global bitcoin hash rate is something like 90 bits per year. People think NSA doesn&#x27;t have more hardware than all the bitcoin miners together. If they can break 128 bit security, they can&#x27;t break it for every roundtrip in a Signal chat. I don&#x27;t know what they would even use the capability to do. I don&#x27;t think they need brute force to forge a Microsoft or Apple signature - easier to steal it. But it would be something high value that would be broadly useful, not a single message.</div><br/><div id="38002488" class="c"><input type="checkbox" id="c-38002488" checked=""/><div class="controls bullet"><span class="by">adgjlsfhk1</span><span>|</span><a href="#38001241">root</a><span>|</span><a href="#38001535">parent</a><span>|</span><a href="#38001329">next</a><span>|</span><label class="collapse" for="c-38002488">[-]</label><label class="expand" for="c-38002488">[2 more]</label></div><br/><div class="children"><div class="content">and more importantly, any operation that needs that much compute power can be more efficiently solved by passing around a couple billion dollars of bribes</div><br/><div id="38002929" class="c"><input type="checkbox" id="c-38002929" checked=""/><div class="controls bullet"><span class="by">lazide</span><span>|</span><a href="#38001241">root</a><span>|</span><a href="#38002488">parent</a><span>|</span><a href="#38001329">next</a><span>|</span><label class="collapse" for="c-38002929">[-]</label><label class="expand" for="c-38002929">[1 more]</label></div><br/><div class="children"><div class="content">Or blackmailing the right person.</div><br/></div></div></div></div></div></div><div id="38001329" class="c"><input type="checkbox" id="c-38001329" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#38001241">parent</a><span>|</span><a href="#38001535">prev</a><span>|</span><a href="#38008049">next</a><span>|</span><label class="collapse" for="c-38001329">[-]</label><label class="expand" for="c-38001329">[1 more]</label></div><br/><div class="children"><div class="content">You could have one side generate new keys for every session.  That&#x27;s how WebPush encryption works, if you&#x27;re looking for an implementation.  Client has a static public key stored on the server, server generates a per message ECDH key and embeds the pub key in the message.</div><br/></div></div></div></div><div id="38008049" class="c"><input type="checkbox" id="c-38008049" checked=""/><div class="controls bullet"><span class="by">helpfulclippy</span><span>|</span><a href="#38001241">prev</a><span>|</span><a href="#38006661">next</a><span>|</span><label class="collapse" for="c-38008049">[-]</label><label class="expand" for="c-38008049">[4 more]</label></div><br/><div class="children"><div class="content">The author proposes a corollary to Kerckhoff&#x27;s principle:<p>&gt; A cryptosystem should be secure even if all the parameters, except the key, are shared across every user.<p>It seems that if the key counts as a parameter, then surely nonces also count, and we certainly do not want nonces to be reused. This may be why this principle is not best practice. I am quite confident that the author is well aware of this, and I agree with the general thrust of what they&#x27;re saying... Perhaps another way of saying it is that where parameters can be held constant, they should be. Or to quote Daniel J. Bernstein[1] quoting Mark Twain:<p>&gt; Behold, the fool saith, &quot;Put not all thine eggs in the one basket&quot;—which is but a manner of saying, &quot;Scatter your money and your attention;&quot; but the wise man saith, &quot;Put all your eggs in the one basket and—WATCH THAT BASKET.&quot;<p>[1]: <a href="https:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140205-entropy.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140205-entropy.html</a></div><br/><div id="38008214" class="c"><input type="checkbox" id="c-38008214" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38008049">parent</a><span>|</span><a href="#38006661">next</a><span>|</span><label class="collapse" for="c-38008214">[-]</label><label class="expand" for="c-38008214">[3 more]</label></div><br/><div class="children"><div class="content">[removed for irrelevance]</div><br/><div id="38008242" class="c"><input type="checkbox" id="c-38008242" checked=""/><div class="controls bullet"><span class="by">Vecr</span><span>|</span><a href="#38008049">root</a><span>|</span><a href="#38008214">parent</a><span>|</span><a href="#38006661">next</a><span>|</span><label class="collapse" for="c-38008242">[-]</label><label class="expand" for="c-38008242">[2 more]</label></div><br/><div class="children"><div class="content">I actually think he means everything is fixed except the key, salt, nonce, etc. Not just shared as in publicly known, shared as in the same value is used by everyone.</div><br/><div id="38008339" class="c"><input type="checkbox" id="c-38008339" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38008049">root</a><span>|</span><a href="#38008242">parent</a><span>|</span><a href="#38006661">next</a><span>|</span><label class="collapse" for="c-38008339">[-]</label><label class="expand" for="c-38008339">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re right of course, I read TFA too quickly.</div><br/></div></div></div></div></div></div></div></div><div id="38006661" class="c"><input type="checkbox" id="c-38006661" checked=""/><div class="controls bullet"><span class="by">euicnon</span><span>|</span><a href="#38008049">prev</a><span>|</span><a href="#38001449">next</a><span>|</span><label class="collapse" for="c-38006661">[-]</label><label class="expand" for="c-38006661">[2 more]</label></div><br/><div class="children"><div class="content">Are there cryptographers with dissenting opinions to this article, or is what the author writes about generally recognised best practice?<p>I ask because I remember an article a while back where this same author had very confidently got some details wrong about CloudFlare and I think the CEO or CTO or someone like that had to step in and correct him.</div><br/><div id="38007709" class="c"><input type="checkbox" id="c-38007709" checked=""/><div class="controls bullet"><span class="by">hyper_reality</span><span>|</span><a href="#38006661">parent</a><span>|</span><a href="#38001449">next</a><span>|</span><label class="collapse" for="c-38007709">[-]</label><label class="expand" for="c-38007709">[1 more]</label></div><br/><div class="children"><div class="content">Are you sure you&#x27;re thinking of the right author? Filippo used to work at Cloudflare so I can&#x27;t imagine he got the technical details about it too wrong.</div><br/></div></div></div></div><div id="38001449" class="c"><input type="checkbox" id="c-38001449" checked=""/><div class="controls bullet"><span class="by">cratermoon</span><span>|</span><a href="#38006661">prev</a><span>|</span><a href="#38003619">next</a><span>|</span><label class="collapse" for="c-38001449">[-]</label><label class="expand" for="c-38001449">[2 more]</label></div><br/><div class="children"><div class="content">TIL that there are known attacks on primality testing routines, where the test will accept as prime a composite number. Vulnerable libraries at the time of the paper (2018) included OpenSSL, GMP, Apple, JSBN, Cryptlib, LibTomMath, LibTomCrypt, WolfSSL, Bouncy Castle and Botan.</div><br/><div id="38005952" class="c"><input type="checkbox" id="c-38005952" checked=""/><div class="controls bullet"><span class="by">MzxgckZtNqX5i</span><span>|</span><a href="#38001449">parent</a><span>|</span><a href="#38003619">next</a><span>|</span><label class="collapse" for="c-38005952">[-]</label><label class="expand" for="c-38005952">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a very well made paper, absolutely suggested if you&#x27;re into cryptography and number theory.<p>Prime and Prejudice: Primality Testing Under Adversarial Conditions by Martin R. Albrecht, Jake Massimo, Kenneth G. Paterson, and Juraj Somorovsky.<p><a href="https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2018&#x2F;749" rel="nofollow noreferrer">https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2018&#x2F;749</a></div><br/></div></div></div></div><div id="38003619" class="c"><input type="checkbox" id="c-38003619" checked=""/><div class="controls bullet"><span class="by">fijiaarone</span><span>|</span><a href="#38001449">prev</a><span>|</span><a href="#38001464">next</a><span>|</span><label class="collapse" for="c-38003619">[-]</label><label class="expand" for="c-38003619">[1 more]</label></div><br/><div class="children"><div class="content">It’s easier to backdoor a known key. 
Tell people they have encryption, and they will trust you. Very few will be able to verify, even if they care too. 
When they do, the algorithm checks out, but it doesn’t try matter if you already have the answer.</div><br/></div></div><div id="38004250" class="c"><input type="checkbox" id="c-38004250" checked=""/><div class="controls bullet"><span class="by">pluto_modadic</span><span>|</span><a href="#38001464">prev</a><span>|</span><label class="collapse" for="c-38004250">[-]</label><label class="expand" for="c-38004250">[1 more]</label></div><br/><div class="children"><div class="content">yay! another filippo post! I always appreciate their writing &lt;3<p>now the silly part!<p>[wildly gesticulating at a particle board filled with photos and strings]<p>&quot;that&#x27;s just what the nice golang cryptographers want you to think!&quot;</div><br/></div></div></div></div></div></div></div></body></html>