<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1738659674228" as="style"/><link rel="stylesheet" href="styles.css?v=1738659674228"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/monasticacademy/httptap">Httptap: View HTTP/HTTPS requests made by any Linux program</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>alexflint</span> | <span>118 comments</span></div><br/><div><div id="42920518" class="c"><input type="checkbox" id="c-42920518" checked=""/><div class="controls bullet"><span class="by">yoavm</span><span>|</span><a href="#42922184">next</a><span>|</span><label class="collapse" for="c-42920518">[-]</label><label class="expand" for="c-42920518">[21 more]</label></div><br/><div class="children"><div class="content">The &quot;How it was made&quot; section of the README was not less interesting than the tool itself:<p>&gt; The way we have set things up is that we live and practice together on a bit over a hundred acres of land. In the mornings and evenings we chant and meditate together, and for about one week out of every month we run and participate in a meditation retreat. The rest of the time we work together on everything from caring for the land, maintaining the buildings, cooking, cleaning, planning, fundraising, and for the past few years developing software together.</div><br/><div id="42921301" class="c"><input type="checkbox" id="c-42921301" checked=""/><div class="controls bullet"><span class="by">abraae</span><span>|</span><a href="#42920518">parent</a><span>|</span><a href="#42928945">next</a><span>|</span><label class="collapse" for="c-42921301">[-]</label><label class="expand" for="c-42921301">[5 more]</label></div><br/><div class="children"><div class="content">Reminds me of a quote from &quot;Soul of a new machine&quot;:<p>&gt; During one period, when the microcode and logic were glitching at the nanosecond level, one of the overworked engineers departed the company, leaving behind a note on his terminal as his letter of resignation: &quot;I am going to a commune in Vermont and will deal with no unit of time shorter than a season.&quot;</div><br/><div id="42923243" class="c"><input type="checkbox" id="c-42923243" checked=""/><div class="controls bullet"><span class="by">why_at</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921301">parent</a><span>|</span><a href="#42921372">next</a><span>|</span><label class="collapse" for="c-42923243">[-]</label><label class="expand" for="c-42923243">[3 more]</label></div><br/><div class="children"><div class="content">Great quote, although the nitpicky part of my brain immediately thought &quot;They must have days though?&quot;</div><br/><div id="42928608" class="c"><input type="checkbox" id="c-42928608" checked=""/><div class="controls bullet"><span class="by">aitchnyu</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42923243">parent</a><span>|</span><a href="#42924747">next</a><span>|</span><label class="collapse" for="c-42928608">[-]</label><label class="expand" for="c-42928608">[1 more]</label></div><br/><div class="children"><div class="content">In The Inner Citadel, in the section of living in the present, the author says there is a  &quot;thin&quot; moment separating past and future and a thick moment by meaningfulness. If a thin&#x2F;technical moment is 1&#x2F;44.1kHz, a thick moment is a note of music. A current answer to the meaning of life. This person is not about the day to day tensions.</div><br/></div></div><div id="42924747" class="c"><input type="checkbox" id="c-42924747" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42923243">parent</a><span>|</span><a href="#42928608">prev</a><span>|</span><a href="#42921372">next</a><span>|</span><label class="collapse" for="c-42924747">[-]</label><label class="expand" for="c-42924747">[1 more]</label></div><br/><div class="children"><div class="content">The day washes over you, but this person only needs to &quot;deal with&quot; the harvest.</div><br/></div></div></div></div><div id="42921372" class="c"><input type="checkbox" id="c-42921372" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921301">parent</a><span>|</span><a href="#42923243">prev</a><span>|</span><a href="#42928945">next</a><span>|</span><label class="collapse" for="c-42921372">[-]</label><label class="expand" for="c-42921372">[1 more]</label></div><br/><div class="children"><div class="content">Wow that&#x27;s an incredible quote! It feels like that to me too.</div><br/></div></div></div></div><div id="42928945" class="c"><input type="checkbox" id="c-42928945" checked=""/><div class="controls bullet"><span class="by">xg15</span><span>|</span><a href="#42920518">parent</a><span>|</span><a href="#42921301">prev</a><span>|</span><a href="#42921236">next</a><span>|</span><label class="collapse" for="c-42928945">[-]</label><label class="expand" for="c-42928945">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>For the past few years we have been recording a lecture series called Buddhism for AI. It&#x27;s about our efforts to design a religion (yes, a religion) based on Buddhism for consumption directly by AI systems. We actually feel this is very important work given the world situation.</i><p>I think it&#x27;s an indicator of just how weird the times we&#x27;re currently living in really are, that this part actually makes perfect sense...<p>(whether or not it&#x27;s a good idea or will lead to the results they envision is another question)</div><br/></div></div><div id="42921236" class="c"><input type="checkbox" id="c-42921236" checked=""/><div class="controls bullet"><span class="by">erdii</span><span>|</span><a href="#42920518">parent</a><span>|</span><a href="#42928945">prev</a><span>|</span><a href="#42922554">next</a><span>|</span><label class="collapse" for="c-42921236">[-]</label><label class="expand" for="c-42921236">[12 more]</label></div><br/><div class="children"><div class="content">To be honest: This sounds like just another of the many many other yoga&#x2F;spiritual cults that currently exist all over the western world.<p>EDIT: typos and slight wording changes</div><br/><div id="42923687" class="c"><input type="checkbox" id="c-42923687" checked=""/><div class="controls bullet"><span class="by">yoavm</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921236">parent</a><span>|</span><a href="#42921648">next</a><span>|</span><label class="collapse" for="c-42923687">[-]</label><label class="expand" for="c-42923687">[4 more]</label></div><br/><div class="children"><div class="content">I believe I grew up in a cult myself, and one of the things I&#x27;ve concluded from that experience, and from leaving it, is that everywhere is a cult. Humans have a tendency towards cult-ish life, and if the cult is big enough we just refer to it as &quot;society&quot;. People were as afraid (more or less) to leave the cult I was at, as people are around me now when they consider doing anything that is out of the norm.<p>By no mean am I trying to hint towards some conspiracy, or to say that all cults are equally bad (or good); Just to say that sometimes the word cult simply means &quot;a less popular way of life than the one most people around me live by&quot;.</div><br/><div id="42926320" class="c"><input type="checkbox" id="c-42926320" checked=""/><div class="controls bullet"><span class="by">bityard</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42923687">parent</a><span>|</span><a href="#42927383">next</a><span>|</span><label class="collapse" for="c-42926320">[-]</label><label class="expand" for="c-42926320">[2 more]</label></div><br/><div class="children"><div class="content">A &quot;cult&quot; is a rather specific kind of organization. The typical hallmarks are non-mainstream spiritual beliefs, highly controlling and exploitative leadership, and rules against interacting with outsiders. Non-conformity generally results in outsized (sometimes violent) punishment and shame.<p>Under this definition, for example, Catholic nuns are decidedly not a cult. They know what they are in for when the join, and may leave the convent any time they wish. Most Amish communities are _probably_ not cults. I am undecided about Mormons but leaning towards maybe.<p>I don&#x27;t know what kind of cult you grew up in (and you have my empathy if it was painful) but &quot;society&quot; by definition cannot be a cult.</div><br/><div id="42928163" class="c"><input type="checkbox" id="c-42928163" checked=""/><div class="controls bullet"><span class="by">khimaros</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42926320">parent</a><span>|</span><a href="#42927383">next</a><span>|</span><label class="collapse" for="c-42928163">[-]</label><label class="expand" for="c-42928163">[1 more]</label></div><br/><div class="children"><div class="content">i think you just reaffirmed the parent&#x27;s point. if a cult can only be &quot;non-mainstream&quot;, i think you are just saying cults become societies once they&#x27;re large&#x2F;successful enough. i see plenty of examples of your other indicators in mainstream society.</div><br/></div></div></div></div><div id="42927383" class="c"><input type="checkbox" id="c-42927383" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42923687">parent</a><span>|</span><a href="#42926320">prev</a><span>|</span><a href="#42921648">next</a><span>|</span><label class="collapse" for="c-42927383">[-]</label><label class="expand" for="c-42927383">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t it funny how the very word &quot;culture&quot; is sort of related to &quot;cult&quot;.</div><br/></div></div></div></div><div id="42921648" class="c"><input type="checkbox" id="c-42921648" checked=""/><div class="controls bullet"><span class="by">quesera</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921236">parent</a><span>|</span><a href="#42923687">prev</a><span>|</span><a href="#42926876">next</a><span>|</span><label class="collapse" for="c-42921648">[-]</label><label class="expand" for="c-42921648">[5 more]</label></div><br/><div class="children"><div class="content">There is absolutely nothing in their README to suggest that you are using the word &quot;cult&quot; properly.</div><br/><div id="42928317" class="c"><input type="checkbox" id="c-42928317" checked=""/><div class="controls bullet"><span class="by">jonahx</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921648">parent</a><span>|</span><a href="#42922143">next</a><span>|</span><label class="collapse" for="c-42928317">[-]</label><label class="expand" for="c-42928317">[1 more]</label></div><br/><div class="children"><div class="content">Their video has a cultish vibe.  Not necessarily of the dangerous variety, but there seemed to be a lot of shared jargon and groupthink under the umbrella of &quot;freeing your mind.&quot;</div><br/></div></div><div id="42922143" class="c"><input type="checkbox" id="c-42922143" checked=""/><div class="controls bullet"><span class="by">MisterTea</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921648">parent</a><span>|</span><a href="#42928317">prev</a><span>|</span><a href="#42926876">next</a><span>|</span><label class="collapse" for="c-42922143">[-]</label><label class="expand" for="c-42922143">[3 more]</label></div><br/><div class="children"><div class="content">Did you visit their website? <a href="https:&#x2F;&#x2F;www.monasticacademy.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.monasticacademy.org&#x2F;</a><p>While I cannot judge them outright, their article &quot;Cyborgs Need a Trustworthy Religion&quot; can appear cultist as they try to intertwine technology and religion.</div><br/><div id="42922678" class="c"><input type="checkbox" id="c-42922678" checked=""/><div class="controls bullet"><span class="by">2030ai</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42922143">parent</a><span>|</span><a href="#42926876">next</a><span>|</span><label class="collapse" for="c-42922678">[-]</label><label class="expand" for="c-42922678">[2 more]</label></div><br/><div class="children"><div class="content">The fine line between futurism and cult.</div><br/><div id="42923076" class="c"><input type="checkbox" id="c-42923076" checked=""/><div class="controls bullet"><span class="by">MisterTea</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42922678">parent</a><span>|</span><a href="#42926876">next</a><span>|</span><label class="collapse" for="c-42923076">[-]</label><label class="expand" for="c-42923076">[1 more]</label></div><br/><div class="children"><div class="content">I feel that spirituality does not concern itself with the material world making it immune to societal progress. Whereas organized religion becomes mired by societal progress as it&#x27;s trapped in its own zeitgeist. I believe that trying to tie the two together is a misguided attempt at creating something when there is nothing that needs to be created.</div><br/></div></div></div></div></div></div></div></div><div id="42926876" class="c"><input type="checkbox" id="c-42926876" checked=""/><div class="controls bullet"><span class="by">maybehewasright</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921236">parent</a><span>|</span><a href="#42921648">prev</a><span>|</span><a href="#42928523">next</a><span>|</span><label class="collapse" for="c-42926876">[-]</label><label class="expand" for="c-42926876">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=5It1zarINv0&amp;pp=ygUOa2diIGFnZW50IHl1cmk%3D" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=5It1zarINv0&amp;pp=ygUOa2diIGFnZ...</a>
Former KGB Agent Yuri Bezmenov Explains How to Brainwash a Nation (Full Length)</div><br/></div></div><div id="42928523" class="c"><input type="checkbox" id="c-42928523" checked=""/><div class="controls bullet"><span class="by">antics9</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42921236">parent</a><span>|</span><a href="#42926876">prev</a><span>|</span><a href="#42922554">next</a><span>|</span><label class="collapse" for="c-42928523">[-]</label><label class="expand" for="c-42928523">[1 more]</label></div><br/><div class="children"><div class="content">It’s a Buddhist monastery.</div><br/></div></div></div></div><div id="42922554" class="c"><input type="checkbox" id="c-42922554" checked=""/><div class="controls bullet"><span class="by">2030ai</span><span>|</span><a href="#42920518">parent</a><span>|</span><a href="#42921236">prev</a><span>|</span><a href="#42922184">next</a><span>|</span><label class="collapse" for="c-42922554">[-]</label><label class="expand" for="c-42922554">[2 more]</label></div><br/><div class="children"><div class="content">I sadly assumed the first countryside photo was generated but I assume now it is real!<p>The mix of tech and meditation would appeal to me. Maybe the idea does (actually doing it is probably hard!).<p>It seems like a &quot;Buddhist Recurse&quot;</div><br/><div id="42923566" class="c"><input type="checkbox" id="c-42923566" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42920518">root</a><span>|</span><a href="#42922554">parent</a><span>|</span><a href="#42922184">next</a><span>|</span><label class="collapse" for="c-42923566">[-]</label><label class="expand" for="c-42923566">[1 more]</label></div><br/><div class="children"><div class="content">Yeah that photo is real! That&#x27;s where I live!<p>Yes, it&#x27;s true, actually doing it is hard, but to be honest not as hard as a lot of other stuff (getting a phd for example, or goodness gracious buying a house in San Francisco). I love getting up early. I love living out in nature. I love chanting and eating meals together and making a version of Buddhism for AI systems!<p>If you&#x27;re interested in what it&#x27;s like, we have written a bunch of very short few-paragraph stories about our time at MAPLE here: <a href="https:&#x2F;&#x2F;tales.monasticacademy.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;tales.monasticacademy.org&#x2F;</a></div><br/></div></div></div></div></div></div><div id="42922184" class="c"><input type="checkbox" id="c-42922184" checked=""/><div class="controls bullet"><span class="by">wzyboy</span><span>|</span><a href="#42920518">prev</a><span>|</span><a href="#42919910">next</a><span>|</span><label class="collapse" for="c-42922184">[-]</label><label class="expand" for="c-42922184">[6 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a genius idea to run the process in a isolated network namespace!<p>I&#x27;m more interested in the HTTPS part. I see that it sets some common environment variables [1] to instruct the program to use the CA bundle in the temporary directory. This seems to pose a similar issue like all the variants of `http_proxy`: the program may simply choose to ignore the variable.<p>I see it also mounts an overlay fs for `&#x2F;etc&#x2F;resolv.conf` [2]. Does it help if httptap mounts `&#x2F;etc&#x2F;ca-certificates` directory with the temporary CA bundle?<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;cb92ee3acfb2fc8890463c8071531b6cf8db6e9c&#x2F;httptap.go#L544-L549">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;cb92ee3acfb2...</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;cb92ee3acfb2fc8890463c8071531b6cf8db6e9c&#x2F;httptap.go#L402-L411">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;cb92ee3acfb2...</a></div><br/><div id="42923006" class="c"><input type="checkbox" id="c-42923006" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922184">parent</a><span>|</span><a href="#42923998">next</a><span>|</span><label class="collapse" for="c-42923006">[-]</label><label class="expand" for="c-42923006">[4 more]</label></div><br/><div class="children"><div class="content">Thanks! But yep I agree, you&#x27;re exactly right, it&#x27;s ultimately... frustrating that there isn&#x27;t really an agreed-upon or system-enforced way to specify CA roots to an arbitrary process.<p>It&#x27;s true that httptap mounts an overlay on &#x2F;etc&#x2F;resolv.conf. This is, as you&#x27;d expect, due to the also-sort-of-frustrating situation with respect to DNS resolution in which, like CA roots, there isn&#x27;t a truly reliable way to tell an arbitrary process what DNS server to use, but &#x2F;etc&#x2F;resolv.conf is a pretty good bet. As soon as you put a process into a network namespace you have to provide it with DNS resolution because it can no longer access localhost:53, which is the systemd resolver, which is the most common setup now on desktop linux systems.<p>I do think it might help to mount &#x2F;etc&#x2F;ca-certificates as an overlay. When I started looking into the structure of that directory I was kind of dismayed... it&#x27;s incredibly inconsistent from one distro to the next. Still, it&#x27;s doable. Interested in any knowledge you might be able to share about how to add a cert to that directory in a way that would be picked up by at least some TLS implementations.</div><br/><div id="42923752" class="c"><input type="checkbox" id="c-42923752" checked=""/><div class="controls bullet"><span class="by">xorcist</span><span>|</span><a href="#42922184">root</a><span>|</span><a href="#42923006">parent</a><span>|</span><a href="#42924985">next</a><span>|</span><label class="collapse" for="c-42923752">[-]</label><label class="expand" for="c-42923752">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a bit thin solution though, isn&#x27;t it? As you say, it&#x27;s dependent on both specific CA store and resolver behaviour. It&#x27;s probably going to be robust enough on the most common SSL libraries, such as OpenSSL. But if we&#x27;re going that route, why not just run the software against a patched SSL library which dumps the traffic?<p>That also doesn&#x27;t require any elevated privileges (as opposed to other methods of syscall interception) and is likely much easier to do. It has the added benefit of being robust against applications either pinning certificates outright or just being particular about serial numbers, client certificates, and anything like that.</div><br/><div id="42924962" class="c"><input type="checkbox" id="c-42924962" checked=""/><div class="controls bullet"><span class="by">0x696C6961</span><span>|</span><a href="#42922184">root</a><span>|</span><a href="#42923752">parent</a><span>|</span><a href="#42924985">next</a><span>|</span><label class="collapse" for="c-42924962">[-]</label><label class="expand" for="c-42924962">[1 more]</label></div><br/><div class="children"><div class="content">&gt; why not just run the software against a patched SSL library which dumps the traffic?<p>Why run strace when you can just patch libc?</div><br/></div></div></div></div><div id="42924985" class="c"><input type="checkbox" id="c-42924985" checked=""/><div class="controls bullet"><span class="by">arjvik</span><span>|</span><a href="#42922184">root</a><span>|</span><a href="#42923006">parent</a><span>|</span><a href="#42923752">prev</a><span>|</span><a href="#42923998">next</a><span>|</span><label class="collapse" for="c-42924985">[-]</label><label class="expand" for="c-42924985">[1 more]</label></div><br/><div class="children"><div class="content">What if instead you bound your own DNS server to localhost:53 inside the network namespace? I suppose you&#x27;d still have to mess with &#x2F;etc&#x2F;resolv.conf in case it points to hardcoded public resolvers instead like mine does.</div><br/></div></div></div></div><div id="42923998" class="c"><input type="checkbox" id="c-42923998" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#42922184">parent</a><span>|</span><a href="#42923006">prev</a><span>|</span><a href="#42919910">next</a><span>|</span><label class="collapse" for="c-42923998">[-]</label><label class="expand" for="c-42923998">[1 more]</label></div><br/><div class="children"><div class="content">IMO there&#x27;s no general solution to the HTTPS part that will work for all kinds of programs and the long tail of certificate pinning implementations.<p>As a proof by counterexample, imagine malware that uses TLS for communication and goes to great lengths to obfuscate its compiled code. It could be a program that bundles a fixed set of CA certificates into its binary and never open any files on the filesystem. It can still create valid, secure TLS connections (at least for ~10 years or so, until most root CA certificates expire). TLS is all userspace and there&#x27;s no guarantee that it uses OpenSSL (or any other common library), so you can&#x27;t rely on hooking into specific OpenSSL functions either. If the server uses a self-signed certificate and the client accepts it for whatever reason, it&#x27;s worse.<p>With that said, it&#x27;s definitely possible to handle 99% of the cases reliably with some work. That&#x27;s better than nothing.</div><br/></div></div></div></div><div id="42919910" class="c"><input type="checkbox" id="c-42919910" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922184">prev</a><span>|</span><a href="#42921654">next</a><span>|</span><label class="collapse" for="c-42919910">[-]</label><label class="expand" for="c-42919910">[19 more]</label></div><br/><div class="children"><div class="content">httptap is a process-scoped http tracer that you can run without root priveleges. You can run `httptap &lt;command&gt;` where &lt;command&gt; is a linux program and you get a trace of http&#x2F;https requests and responses in standard output:<p><pre><code>    httptap -- python -c &quot;import requests; requests.get(&#x27;https:&#x2F;&#x2F;monasticacademy.org&#x27;)&quot;
    ---&gt; GET https:&#x2F;&#x2F;monasticacademy.org&#x2F;
    &lt;--- 308 https:&#x2F;&#x2F;monasticacademy.org&#x2F; (15 bytes)
    ---&gt; GET https:&#x2F;&#x2F;www.monasticacademy.org&#x2F;
    &lt;--- 200 https:&#x2F;&#x2F;www.monasticacademy.org&#x2F; (5796 bytes)
</code></pre>
It works by running &lt;command&gt; in an isolated network namespace. It has its own TCP&#x2F;IP stack (for which it uses gVisor). It is not an HTTP proxy and so does not rely on &lt;command&gt; being configured to use an HTTP proxy. It decrypts TLS traffic by generating a CA on the fly. It won&#x27;t install any iptables rules or make other global system changes.</div><br/><div id="42921671" class="c"><input type="checkbox" id="c-42921671" checked=""/><div class="controls bullet"><span class="by">maxmcd</span><span>|</span><a href="#42919910">parent</a><span>|</span><a href="#42922996">next</a><span>|</span><label class="collapse" for="c-42921671">[-]</label><label class="expand" for="c-42921671">[5 more]</label></div><br/><div class="children"><div class="content">Do you know if it&#x27;s possible to get this working on macos? I believe Tailscale uses gvisor&#x27;s tcp&#x2F;ip lib (as their netstack lib) on macos for certain things.</div><br/><div id="42922112" class="c"><input type="checkbox" id="c-42922112" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42921671">parent</a><span>|</span><a href="#42922996">next</a><span>|</span><label class="collapse" for="c-42922112">[-]</label><label class="expand" for="c-42922112">[4 more]</label></div><br/><div class="children"><div class="content">Does Darwin have network namespaces like the Linux kernel does? I get the impression that&#x27;s an important component of this approach</div><br/><div id="42922214" class="c"><input type="checkbox" id="c-42922214" checked=""/><div class="controls bullet"><span class="by">maxmcd</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42922112">parent</a><span>|</span><a href="#42922996">next</a><span>|</span><label class="collapse" for="c-42922214">[-]</label><label class="expand" for="c-42922214">[3 more]</label></div><br/><div class="children"><div class="content">Yes, good point, maybe that is the blocker.</div><br/><div id="42923080" class="c"><input type="checkbox" id="c-42923080" checked=""/><div class="controls bullet"><span class="by">jshier</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42922214">parent</a><span>|</span><a href="#42922996">next</a><span>|</span><label class="collapse" for="c-42923080">[-]</label><label class="expand" for="c-42923080">[2 more]</label></div><br/><div class="children"><div class="content">No network namespaces, but the various Network Extension APIs might be able to do this, though it&#x27;s difficult. RocketSim (I&#x27;m unaffiliated, just an example) recently added a simulator-specific network throttle (to replace the system-wide Network Link Conditioner Apple ships) using a content filter extension. Even though this is a system-wide API, it seems you can limit its impact to a single app. And it seemed to properly compose with Proxyman and Cloudflare&#x27;s Warp VPN at the same time, so perhaps it could be a general solution.</div><br/><div id="42923373" class="c"><input type="checkbox" id="c-42923373" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42923080">parent</a><span>|</span><a href="#42922996">next</a><span>|</span><label class="collapse" for="c-42923373">[-]</label><label class="expand" for="c-42923373">[1 more]</label></div><br/><div class="children"><div class="content">Woah, this is super helpful info. Thanks. That sounds like a real possibility for a macOS port actually.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42922996" class="c"><input type="checkbox" id="c-42922996" checked=""/><div class="controls bullet"><span class="by">wutwutwat</span><span>|</span><a href="#42919910">parent</a><span>|</span><a href="#42921671">prev</a><span>|</span><a href="#42920666">next</a><span>|</span><label class="collapse" for="c-42922996">[-]</label><label class="expand" for="c-42922996">[5 more]</label></div><br/><div class="children"><div class="content">Did everyone forget about wireshark, which can totally be ran as non-root?<p><a href="https:&#x2F;&#x2F;blog.wireshark.org&#x2F;2010&#x2F;02&#x2F;running-wireshark-as-you&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.wireshark.org&#x2F;2010&#x2F;02&#x2F;running-wireshark-as-you&#x2F;</a></div><br/><div id="42923168" class="c"><input type="checkbox" id="c-42923168" checked=""/><div class="controls bullet"><span class="by">lights0123</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42922996">parent</a><span>|</span><a href="#42923185">next</a><span>|</span><label class="collapse" for="c-42923168">[-]</label><label class="expand" for="c-42923168">[1 more]</label></div><br/><div class="children"><div class="content">It certainly doesn&#x27;t provide automated, process-scoped HTTPS interception.</div><br/></div></div><div id="42923185" class="c"><input type="checkbox" id="c-42923185" checked=""/><div class="controls bullet"><span class="by">boobsbr</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42922996">parent</a><span>|</span><a href="#42923168">prev</a><span>|</span><a href="#42923396">next</a><span>|</span><label class="collapse" for="c-42923185">[-]</label><label class="expand" for="c-42923185">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s still more setup than just installing this tool.<p>Also, can Wireshark&#x2F;libpcap decrypt SSL&#x2F;TLS traffic this easily?</div><br/><div id="42925377" class="c"><input type="checkbox" id="c-42925377" checked=""/><div class="controls bullet"><span class="by">graerg</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42923185">parent</a><span>|</span><a href="#42923396">next</a><span>|</span><label class="collapse" for="c-42925377">[-]</label><label class="expand" for="c-42925377">[1 more]</label></div><br/><div class="children"><div class="content">Not in my experience; I think I gave up and opted for mitmproxy which works but is not this easy&#x2F;seamless.</div><br/></div></div></div></div><div id="42923396" class="c"><input type="checkbox" id="c-42923396" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42922996">parent</a><span>|</span><a href="#42923185">prev</a><span>|</span><a href="#42920666">next</a><span>|</span><label class="collapse" for="c-42923396">[-]</label><label class="expand" for="c-42923396">[1 more]</label></div><br/><div class="children"><div class="content">Wireshark is awesome but yeah as others mentioned it&#x27;s the TLS decryption piece that is difficult in that workflow</div><br/></div></div></div></div><div id="42920666" class="c"><input type="checkbox" id="c-42920666" checked=""/><div class="controls bullet"><span class="by">gear54rus</span><span>|</span><a href="#42919910">parent</a><span>|</span><a href="#42922996">prev</a><span>|</span><a href="#42921654">next</a><span>|</span><label class="collapse" for="c-42920666">[-]</label><label class="expand" for="c-42920666">[8 more]</label></div><br/><div class="children"><div class="content">can it modify requests or responses? with the current web getting increasingly user-hostile a need for tool like this was never more apparent<p>especially if it doesn&#x27;t require proxy configuration</div><br/><div id="42921354" class="c"><input type="checkbox" id="c-42921354" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42920666">parent</a><span>|</span><a href="#42922082">next</a><span>|</span><label class="collapse" for="c-42921354">[-]</label><label class="expand" for="c-42921354">[3 more]</label></div><br/><div class="children"><div class="content">Agreed! So there isn&#x27;t any interface for modifying requests&#x2F;responses at present, but it&#x27;s definitely possible given the underlying approach. If you consider [this line of code](<a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;main&#x2F;http.go#L227">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;blob&#x2F;main&#x2F;http.go...</a>) where you have an HTTP request parsed from the &lt;command&gt; that ran and are about to send it out to the public internet: you could modify the request (or the response that is received a few lines further) in just the way that you would modify a normal http.Request in Go.</div><br/><div id="42923714" class="c"><input type="checkbox" id="c-42923714" checked=""/><div class="controls bullet"><span class="by">_boffin_</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42921354">parent</a><span>|</span><a href="#42922082">next</a><span>|</span><label class="collapse" for="c-42923714">[-]</label><label class="expand" for="c-42923714">[2 more]</label></div><br/><div class="children"><div class="content">Injecting random data into telemetry requests to mess up someone’s pretty dashboard?</div><br/><div id="42924271" class="c"><input type="checkbox" id="c-42924271" checked=""/><div class="controls bullet"><span class="by">gear54rus</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42923714">parent</a><span>|</span><a href="#42922082">next</a><span>|</span><label class="collapse" for="c-42924271">[-]</label><label class="expand" for="c-42924271">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s at least <a href="https:&#x2F;&#x2F;adnauseam.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;adnauseam.io&#x2F;</a> for that already</div><br/></div></div></div></div></div></div><div id="42922082" class="c"><input type="checkbox" id="c-42922082" checked=""/><div class="controls bullet"><span class="by">knome</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42920666">parent</a><span>|</span><a href="#42921354">prev</a><span>|</span><a href="#42921863">next</a><span>|</span><label class="collapse" for="c-42922082">[-]</label><label class="expand" for="c-42922082">[1 more]</label></div><br/><div class="children"><div class="content">if the program doesn&#x27;t pin certificates, you should be able to intercept them by telling your machine to trust a certificate authority of your own creation and performing a mitm attack on the process&#x27;s traffic. if it does do certificate pinning, then it won&#x27;t trust your home issued cert, and will refuse to send data through your proxy.</div><br/></div></div><div id="42921863" class="c"><input type="checkbox" id="c-42921863" checked=""/><div class="controls bullet"><span class="by">pcpuser</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42920666">parent</a><span>|</span><a href="#42922082">prev</a><span>|</span><a href="#42921654">next</a><span>|</span><label class="collapse" for="c-42921863">[-]</label><label class="expand" for="c-42921863">[3 more]</label></div><br/><div class="children"><div class="content">You might find mitmproxy useful.</div><br/><div id="42923115" class="c"><input type="checkbox" id="c-42923115" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42921863">parent</a><span>|</span><a href="#42921654">next</a><span>|</span><label class="collapse" for="c-42923115">[-]</label><label class="expand" for="c-42923115">[2 more]</label></div><br/><div class="children"><div class="content">Yep, mitmproxy is fantastic IMO.</div><br/><div id="42924295" class="c"><input type="checkbox" id="c-42924295" checked=""/><div class="controls bullet"><span class="by">gear54rus</span><span>|</span><a href="#42919910">root</a><span>|</span><a href="#42923115">parent</a><span>|</span><a href="#42921654">next</a><span>|</span><label class="collapse" for="c-42924295">[-]</label><label class="expand" for="c-42924295">[1 more]</label></div><br/><div class="children"><div class="content">Apparently there&#x27;s JS interface for it too: <a href="https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;mitmproxy" rel="nofollow">https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;mitmproxy</a><p>But the problem with it is that you have to configure proxy in the app (they do got transparent and wireguard modes but there&#x27;s still quite a bit of configuration).</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42921654" class="c"><input type="checkbox" id="c-42921654" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#42919910">prev</a><span>|</span><a href="#42921785">next</a><span>|</span><label class="collapse" for="c-42921654">[-]</label><label class="expand" for="c-42921654">[5 more]</label></div><br/><div class="children"><div class="content">Using a TUN device for this is a really cool idea! And the &quot;How it was made&quot; section is one of the best things I&#x27;ve read in a Github README.<p>I&#x27;m building something called Subtrace [1] but it can intercept both incoming and outgoing requests automatically. Looks like we converged on the same interface for starting the program too lol [2]. Subtrace&#x27;s purpose is kinda different from httptap&#x27;s though (more observability &#x2F; monitoring for cloud backend services, hence the emphasis on both incoming <i>and</i> outgoing). Also, it uses a different approach -- using Seccomp BPF to intercept the socket, connect, listen, accept, and ~10 other syscalls, all TCP connections get proxied through Subtrace. We then parse the HTTP requests out of the TCP stream and then show it to the user in the Chrome DevTools Network tab, which we repurposed to work in the browser like a regular webapp.<p>Any fun stories there from running programs under httptap? Who phones home the most?<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;subtrace&#x2F;subtrace">https:&#x2F;&#x2F;github.com&#x2F;subtrace&#x2F;subtrace</a><p>[2] <a href="https:&#x2F;&#x2F;docs.subtrace.dev&#x2F;quickstart">https:&#x2F;&#x2F;docs.subtrace.dev&#x2F;quickstart</a></div><br/><div id="42921762" class="c"><input type="checkbox" id="c-42921762" checked=""/><div class="controls bullet"><span class="by">afarah1</span><span>|</span><a href="#42921654">parent</a><span>|</span><a href="#42921976">next</a><span>|</span><label class="collapse" for="c-42921762">[-]</label><label class="expand" for="c-42921762">[2 more]</label></div><br/><div class="children"><div class="content">Reminds me of NetGuard, which uses Android&#x27;s VPN service (instead of raw TUN) for packet filtering. <a href="https:&#x2F;&#x2F;github.com&#x2F;M66B&#x2F;NetGuard">https:&#x2F;&#x2F;github.com&#x2F;M66B&#x2F;NetGuard</a></div><br/><div id="42921990" class="c"><input type="checkbox" id="c-42921990" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921654">root</a><span>|</span><a href="#42921762">parent</a><span>|</span><a href="#42921976">next</a><span>|</span><label class="collapse" for="c-42921990">[-]</label><label class="expand" for="c-42921990">[1 more]</label></div><br/><div class="children"><div class="content">Wow, did not know about this!</div><br/></div></div></div></div><div id="42921976" class="c"><input type="checkbox" id="c-42921976" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921654">parent</a><span>|</span><a href="#42921762">prev</a><span>|</span><a href="#42921785">next</a><span>|</span><label class="collapse" for="c-42921976">[-]</label><label class="expand" for="c-42921976">[2 more]</label></div><br/><div class="children"><div class="content">Super cool! Connecting what you capture to Chrome DevTools is fascinating, as is using eBPF. Great work getting the devtools to run as a standalone web app. You won&#x27;t believe it but I have a half-finished attempt of the same thing for the firefox network tab - in the &quot;networktab&quot; dir of the repo!<p>Very cool project, would love to learn more and happy to chat more about it.</div><br/><div id="42923611" class="c"><input type="checkbox" id="c-42923611" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#42921654">root</a><span>|</span><a href="#42921976">parent</a><span>|</span><a href="#42921785">next</a><span>|</span><label class="collapse" for="c-42923611">[-]</label><label class="expand" for="c-42923611">[1 more]</label></div><br/><div class="children"><div class="content">Thanks! Subtrace uses BPF, not eBPF :) I think eBPF could be made to work with the same approach, but there&#x27;s a few differences:<p>- eBPF requires root privileges or at least CAP_BPF. Subtrace uses seccomp_unotify [1], so it works even in unprivileged environments.<p>- eBPF requires using eBPF maps as the data channel + weird restrictions in the code because of the eBPF verifier. IMO these two things make it way harder to work with for the kind of networking logic that both httptap and Subtrace have in userspace. Everything is perfectly possible, just harder to reason about and debug.<p>&gt;half-finished attempt of the same thing for the firefox network tab<p>Hahahah this is incredible. Something something great minds.<p>[1] <a href="https:&#x2F;&#x2F;man.archlinux.org&#x2F;man&#x2F;seccomp_unotify.2.en" rel="nofollow">https:&#x2F;&#x2F;man.archlinux.org&#x2F;man&#x2F;seccomp_unotify.2.en</a></div><br/></div></div></div></div></div></div><div id="42921785" class="c"><input type="checkbox" id="c-42921785" checked=""/><div class="controls bullet"><span class="by">eriksjolund</span><span>|</span><a href="#42921654">prev</a><span>|</span><a href="#42929794">next</a><span>|</span><label class="collapse" for="c-42921785">[-]</label><label class="expand" for="c-42921785">[5 more]</label></div><br/><div class="children"><div class="content">Another tool that can be used by an unprivileged user for analysing network traffic is rootless Podman with Pasta.<p>Just add the podman run option<p>--network=pasta:--pcap,myfile.pcap<p>Pasta then records the network traffic into a PCAP file that could later be analysed.<p>I wrote a simple example where I used tshark to analyse the recorded PCAP file <a href="https:&#x2F;&#x2F;github.com&#x2F;eriksjolund&#x2F;podman-networking-docs?tab=readme-ov-file#capture-network-traffic">https:&#x2F;&#x2F;github.com&#x2F;eriksjolund&#x2F;podman-networking-docs?tab=re...</a></div><br/><div id="42922003" class="c"><input type="checkbox" id="c-42922003" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921785">parent</a><span>|</span><a href="#42929794">next</a><span>|</span><label class="collapse" for="c-42922003">[-]</label><label class="expand" for="c-42922003">[4 more]</label></div><br/><div class="children"><div class="content">Very good to know about. But you still have the problem of decrypting TLS traffic.</div><br/><div id="42922209" class="c"><input type="checkbox" id="c-42922209" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#42921785">root</a><span>|</span><a href="#42922003">parent</a><span>|</span><a href="#42929794">next</a><span>|</span><label class="collapse" for="c-42922209">[-]</label><label class="expand" for="c-42922209">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know if it&#x27;s a <i>standard</i> but I believe a lot of tls libraries honor the SSLKEYLOGFILE env-var <a href="https:&#x2F;&#x2F;wiki.wireshark.org&#x2F;TLS#:~:text=and%20curl%20when-,the%20sslkeylogfile%20environment%20variable,-is%20set.%20To" rel="nofollow">https:&#x2F;&#x2F;wiki.wireshark.org&#x2F;TLS#:~:text=and%20curl%20when-,th...</a></div><br/><div id="42922704" class="c"><input type="checkbox" id="c-42922704" checked=""/><div class="controls bullet"><span class="by">2030ai</span><span>|</span><a href="#42921785">root</a><span>|</span><a href="#42922209">parent</a><span>|</span><a href="#42929794">next</a><span>|</span><label class="collapse" for="c-42922704">[-]</label><label class="expand" for="c-42922704">[2 more]</label></div><br/><div class="children"><div class="content">That seems like an unnecessary vulnerability waiting to happen.</div><br/><div id="42928262" class="c"><input type="checkbox" id="c-42928262" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#42921785">root</a><span>|</span><a href="#42922704">parent</a><span>|</span><a href="#42929794">next</a><span>|</span><label class="collapse" for="c-42928262">[-]</label><label class="expand" for="c-42928262">[1 more]</label></div><br/><div class="children"><div class="content">Can’t wait till they patch it away and we lose the ability to investigate our own https traffic.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42929794" class="c"><input type="checkbox" id="c-42929794" checked=""/><div class="controls bullet"><span class="by">Malidir</span><span>|</span><a href="#42921785">prev</a><span>|</span><a href="#42929119">next</a><span>|</span><label class="collapse" for="c-42929794">[-]</label><label class="expand" for="c-42929794">[1 more]</label></div><br/><div class="children"><div class="content">Linux gets wireshark???<p>2025 will now definately be the year of the Linux desktop :-)</div><br/></div></div><div id="42929119" class="c"><input type="checkbox" id="c-42929119" checked=""/><div class="controls bullet"><span class="by">iamthemalto</span><span>|</span><a href="#42929794">prev</a><span>|</span><a href="#42927012">next</a><span>|</span><label class="collapse" for="c-42929119">[-]</label><label class="expand" for="c-42929119">[1 more]</label></div><br/><div class="children"><div class="content">Really appreciate the &quot;How it works&quot; section in the README. In general I think it&#x27;s great when projects give a high-level overview of the architecture and techniques involved, it provides an easy way for a newcomer to quickly grasp the fundamental workings of the project.</div><br/></div></div><div id="42927012" class="c"><input type="checkbox" id="c-42927012" checked=""/><div class="controls bullet"><span class="by">henvic</span><span>|</span><a href="#42929119">prev</a><span>|</span><a href="#42928611">next</a><span>|</span><label class="collapse" for="c-42927012">[-]</label><label class="expand" for="c-42927012">[1 more]</label></div><br/><div class="children"><div class="content">Quite interesting! I&#x27;ve written a library that does something similar (&quot;tap&quot;) for a Go application: <a href="https:&#x2F;&#x2F;github.com&#x2F;henvic&#x2F;httpretty">https:&#x2F;&#x2F;github.com&#x2F;henvic&#x2F;httpretty</a>
<a href="https:&#x2F;&#x2F;asciinema.org&#x2F;a&#x2F;297429" rel="nofollow">https:&#x2F;&#x2F;asciinema.org&#x2F;a&#x2F;297429</a><p>I also thought about doing something like this for any program, but never really investigated how to do it. Nice to see someone out there created it :)</div><br/></div></div><div id="42928611" class="c"><input type="checkbox" id="c-42928611" checked=""/><div class="controls bullet"><span class="by">steren</span><span>|</span><a href="#42927012">prev</a><span>|</span><a href="#42922095">next</a><span>|</span><label class="collapse" for="c-42928611">[-]</label><label class="expand" for="c-42928611">[1 more]</label></div><br/><div class="children"><div class="content">Very nice.
The README section makes it appear as if it&#x27;s a group&#x27;s work. I&#x27;m just noting that the code of httptap is authored by a single person (@alexflint)
<a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;graphs&#x2F;contributors">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;graphs&#x2F;contributo...</a></div><br/></div></div><div id="42922095" class="c"><input type="checkbox" id="c-42922095" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#42928611">prev</a><span>|</span><a href="#42921026">next</a><span>|</span><label class="collapse" for="c-42922095">[-]</label><label class="expand" for="c-42922095">[2 more]</label></div><br/><div class="children"><div class="content">Neat!  This will immediately be used by me to debug nginx configs.  Currently I use curl -v and have to manually skim the output to figure out what&#x27;s wrong, but this would immediately make redirect loops and other things apparent.  Cool tool!</div><br/><div id="42923139" class="c"><input type="checkbox" id="c-42923139" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922095">parent</a><span>|</span><a href="#42921026">next</a><span>|</span><label class="collapse" for="c-42923139">[-]</label><label class="expand" for="c-42923139">[1 more]</label></div><br/><div class="children"><div class="content">Very cool! Would love to hear how it goes, especially any features that would be useful in the context of real-world usage.</div><br/></div></div></div></div><div id="42921026" class="c"><input type="checkbox" id="c-42921026" checked=""/><div class="controls bullet"><span class="by">notepad0x90</span><span>|</span><a href="#42922095">prev</a><span>|</span><a href="#42927863">next</a><span>|</span><label class="collapse" for="c-42921026">[-]</label><label class="expand" for="c-42921026">[1 more]</label></div><br/><div class="children"><div class="content">I really like their approach. other methods that might use something like LD_PRELOAD fail on statically linked ELF&#x27;s, like golang binaries.</div><br/></div></div><div id="42927863" class="c"><input type="checkbox" id="c-42927863" checked=""/><div class="controls bullet"><span class="by">jumploops</span><span>|</span><a href="#42921026">prev</a><span>|</span><a href="#42923987">next</a><span>|</span><label class="collapse" for="c-42927863">[-]</label><label class="expand" for="c-42927863">[1 more]</label></div><br/><div class="children"><div class="content">This is clever! I&#x27;ve been playing around with netns and TUN devices lately for a work project, and this idea is just so simple and clean.</div><br/></div></div><div id="42923987" class="c"><input type="checkbox" id="c-42923987" checked=""/><div class="controls bullet"><span class="by">mhils</span><span>|</span><a href="#42927863">prev</a><span>|</span><a href="#42922458">next</a><span>|</span><label class="collapse" for="c-42923987">[-]</label><label class="expand" for="c-42923987">[2 more]</label></div><br/><div class="children"><div class="content">This is really cool, thank you for sharing! We&#x27;ve built a similar feature for mitmproxy lately, but with different tradeoffs. Our approach does require root and we don&#x27;t have automated certificate install (yet), but we don&#x27;t require apps to run in a dedicated namespace (so you can capture already-running processes). Super awesome to see this now, excited to dive into the code and see how you do TCP reassembly etc. :)</div><br/><div id="42924573" class="c"><input type="checkbox" id="c-42924573" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42923987">parent</a><span>|</span><a href="#42922458">next</a><span>|</span><label class="collapse" for="c-42924573">[-]</label><label class="expand" for="c-42924573">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! mitmproxy is fantastic - thanks for all the work that&#x27;s gone into that project. Maybe we can get in touch and chat about all this stuff.</div><br/></div></div></div></div><div id="42922458" class="c"><input type="checkbox" id="c-42922458" checked=""/><div class="controls bullet"><span class="by">q2dg</span><span>|</span><a href="#42923987">prev</a><span>|</span><a href="#42921584">next</a><span>|</span><label class="collapse" for="c-42922458">[-]</label><label class="expand" for="c-42922458">[4 more]</label></div><br/><div class="children"><div class="content">Mitmproxy v11.1 can do a similar thing</div><br/><div id="42929904" class="c"><input type="checkbox" id="c-42929904" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42922458">parent</a><span>|</span><a href="#42923311">next</a><span>|</span><label class="collapse" for="c-42929904">[-]</label><label class="expand" for="c-42929904">[1 more]</label></div><br/><div class="children"><div class="content">The downside to using mitmproxy for this is that mitmproxy uses eBPF which requires (temporary) root privileges to set up. This tool works without root access on most distros (you do need TUN write access).</div><br/></div></div><div id="42923311" class="c"><input type="checkbox" id="c-42923311" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922458">parent</a><span>|</span><a href="#42929904">prev</a><span>|</span><a href="#42921584">next</a><span>|</span><label class="collapse" for="c-42923311">[-]</label><label class="expand" for="c-42923311">[2 more]</label></div><br/><div class="children"><div class="content">Yeah mitmproxy is great. The main difference with httptap is that it&#x27;s an HTTP proxy server, so you have to configure your program to use a proxy server. When I wrote httptap I wanted to be able to run `httptap &lt;command&gt;` and see the httptraces right there in standard output. There is an absolute ton of cool things that mitmproxy can do that httptap is not even close to, like interactively modifying HTTP requests and such. Very cool project.</div><br/><div id="42923884" class="c"><input type="checkbox" id="c-42923884" checked=""/><div class="controls bullet"><span class="by">mhils</span><span>|</span><a href="#42922458">root</a><span>|</span><a href="#42923311">parent</a><span>|</span><a href="#42921584">next</a><span>|</span><label class="collapse" for="c-42923884">[-]</label><label class="expand" for="c-42923884">[1 more]</label></div><br/><div class="children"><div class="content">&gt; so you have to configure your program to use a proxy server.<p>That&#x27;s not true for local capture mode: <a href="https:&#x2F;&#x2F;mitmproxy.org&#x2F;posts&#x2F;local-capture&#x2F;linux&#x2F;" rel="nofollow">https:&#x2F;&#x2F;mitmproxy.org&#x2F;posts&#x2F;local-capture&#x2F;linux&#x2F;</a>. :)</div><br/></div></div></div></div></div></div><div id="42921584" class="c"><input type="checkbox" id="c-42921584" checked=""/><div class="controls bullet"><span class="by">maxmcd</span><span>|</span><a href="#42922458">prev</a><span>|</span><a href="#42925694">next</a><span>|</span><label class="collapse" for="c-42921584">[-]</label><label class="expand" for="c-42921584">[3 more]</label></div><br/><div class="children"><div class="content">Amazing, such a great use of the gvisor userspace tcp&#x2F;ip stack!</div><br/><div id="42923089" class="c"><input type="checkbox" id="c-42923089" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921584">parent</a><span>|</span><a href="#42925694">next</a><span>|</span><label class="collapse" for="c-42923089">[-]</label><label class="expand" for="c-42923089">[2 more]</label></div><br/><div class="children"><div class="content">Yeah learning about gVisor was one of the most fun parts of this project. The gVisor devs are incredibly helpful. If you look through the gvisor-users mailing list you&#x27;ll see me asking them various questions about this and they really helped out a bunch with some incredibly thorough answers.</div><br/><div id="42925472" class="c"><input type="checkbox" id="c-42925472" checked=""/><div class="controls bullet"><span class="by">drio</span><span>|</span><a href="#42921584">root</a><span>|</span><a href="#42923089">parent</a><span>|</span><a href="#42925694">next</a><span>|</span><label class="collapse" for="c-42925472">[-]</label><label class="expand" for="c-42925472">[1 more]</label></div><br/><div class="children"><div class="content">Outstanding! Congratulations on writing such a wonderful project!<p>I have a suggestion regarding the &quot;How It Works&quot; section. When reading it, I initially thought you had implemented your TCP&#x2F;IP stack from scratch. Later, I discovered through the comments that you&#x27;re using gVisor. Perhaps you might consider mentioning this explicitly in the documentation?<p>As an interesting side note, gVisor&#x27;s netstack is also used in the Tailscale client, enabling features like connecting a machine to multiple tailnets without requiring special privileges.</div><br/></div></div></div></div></div></div><div id="42925694" class="c"><input type="checkbox" id="c-42925694" checked=""/><div class="controls bullet"><span class="by">whartung</span><span>|</span><a href="#42921584">prev</a><span>|</span><a href="#42920519">next</a><span>|</span><label class="collapse" for="c-42925694">[-]</label><label class="expand" for="c-42925694">[2 more]</label></div><br/><div class="children"><div class="content">So if I have a Java program using the AWS libraries and I run it under this thing, it can decode the HTTPS AWS payloads going to Amazon?<p>How does that work with the AWS certs? How does the program not reject whatever this tool is doing to pull it off?</div><br/><div id="42926792" class="c"><input type="checkbox" id="c-42926792" checked=""/><div class="controls bullet"><span class="by">js2</span><span>|</span><a href="#42925694">parent</a><span>|</span><a href="#42920519">next</a><span>|</span><label class="collapse" for="c-42926792">[-]</label><label class="expand" for="c-42926792">[1 more]</label></div><br/><div class="children"><div class="content">1. Yes. The following commit taught httptap how to configure Java processes to use its CA cert:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;commit&#x2F;4288a89504f75b7fec3846d524b08e8af0dfe169">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap&#x2F;commit&#x2F;4288a89504...</a><p>2. How it works is explained in the last two paragraphs of the &quot;How It Works&quot; section of the readme:<p>&gt; When a client makes an HTTPS request, it asks the server for evidence that it is who it says it is. If the server has a certificate signed by a certificate authority, it can use that certificate to prove that it is who it says it is. The client will only accept such a certificate if it trusts the certificate authority that signed the certificate. Operating systems, web browsers, and many other pieces of software come with a list of a few hundred certificate authorities that they trust. Many of these pieces of software have ways for users to add additional certificate authorities to this list. We make use of this.<p>&gt; When httptap starts, it creates a certificate authority (actually a private key plus a corresponding x509 certificate), writes it to a file on the filesystem visible only to the subprocess, and sets a few environment variables -- again only visible to the subprocess being run -- that add this certificate authority to the list of trusted certificate authorities. Since the subprocess trusts this certificate authority, and httptap holds the private key for the certificate authority, it can prove to the subprocess that it is the server which which the subprocess was trying to communicate. In this way we can read the plaintext HTTP requests.</div><br/></div></div></div></div><div id="42920519" class="c"><input type="checkbox" id="c-42920519" checked=""/><div class="controls bullet"><span class="by">sevg</span><span>|</span><a href="#42925694">prev</a><span>|</span><a href="#42920636">next</a><span>|</span><label class="collapse" for="c-42920519">[-]</label><label class="expand" for="c-42920519">[2 more]</label></div><br/><div class="children"><div class="content">This looks great!<p>The GitHub profile points to <a href="https:&#x2F;&#x2F;www.monasticacademy.org&#x2F;about" rel="nofollow">https:&#x2F;&#x2F;www.monasticacademy.org&#x2F;about</a> which I have no particular opinion on but it did leave me wondering what the connection is between their monastic training retreat and their projects on GitHub.<p>Edit: Oh, I didn’t go to the bottom of the readme <a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap?tab=readme-ov-file#how-it-was-made">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap?tab=readme-ov-fil...</a></div><br/><div id="42921306" class="c"><input type="checkbox" id="c-42921306" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42920519">parent</a><span>|</span><a href="#42920636">next</a><span>|</span><label class="collapse" for="c-42921306">[-]</label><label class="expand" for="c-42921306">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, for other readers who are looking at this thread, the connection is just that this (httptap) is a Monastic Academy project, and what that means is that there is a group of people living on 123 acres in Vermont according to a fairly traditional Buddhist monastic structure (though we are not ordained monks), and during the day we work on a number of technology and non-technology projects together. The link to the readme that sevg posted above is a good overview:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap?tab=readme-ov-file#how-it-was-made">https:&#x2F;&#x2F;github.com&#x2F;monasticacademy&#x2F;httptap?tab=readme-ov-fil...</a></div><br/></div></div></div></div><div id="42920636" class="c"><input type="checkbox" id="c-42920636" checked=""/><div class="controls bullet"><span class="by">tacone</span><span>|</span><a href="#42920519">prev</a><span>|</span><a href="#42922608">next</a><span>|</span><label class="collapse" for="c-42920636">[-]</label><label class="expand" for="c-42920636">[4 more]</label></div><br/><div class="children"><div class="content">Whoa, great!<p>Questions:<p>- What&#x27;s the performance impact?<p>- Does it allow payload&#x2F;headers inspection?</div><br/><div id="42921234" class="c"><input type="checkbox" id="c-42921234" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42920636">parent</a><span>|</span><a href="#42922608">next</a><span>|</span><label class="collapse" for="c-42921234">[-]</label><label class="expand" for="c-42921234">[3 more]</label></div><br/><div class="children"><div class="content">Thanks!<p>Haven&#x27;t measured performance at all. However when I decided on the approach I looked at the performance benchmarks from tun2socks, which uses the same gVisor code that httptap uses, and it seems that pretty great performance is possible with that code. Still need to do the work of actually achieving comparable performance.<p>Payloads and headers can be dumped with --body and --header respectively. There is an example in the readme of doing this (just search for --body) and I&#x27;ll work more on documenting this in the coming days.</div><br/><div id="42921252" class="c"><input type="checkbox" id="c-42921252" checked=""/><div class="controls bullet"><span class="by">abracadaniel</span><span>|</span><a href="#42920636">root</a><span>|</span><a href="#42921234">parent</a><span>|</span><a href="#42922608">next</a><span>|</span><label class="collapse" for="c-42921252">[-]</label><label class="expand" for="c-42921252">[2 more]</label></div><br/><div class="children"><div class="content">I see it supports .har, but .warc support would be amazing. It&#x27;s the iso standard for web archives, which would give you the ability to replay archived websites via multiple tools.</div><br/><div id="42924461" class="c"><input type="checkbox" id="c-42924461" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42920636">root</a><span>|</span><a href="#42921252">parent</a><span>|</span><a href="#42922608">next</a><span>|</span><label class="collapse" for="c-42924461">[-]</label><label class="expand" for="c-42924461">[1 more]</label></div><br/><div class="children"><div class="content">Fascinating, I hadn&#x27;t heard of WARC - thanks for the pointer and I&#x27;ll consider it.</div><br/></div></div></div></div></div></div></div></div><div id="42922608" class="c"><input type="checkbox" id="c-42922608" checked=""/><div class="controls bullet"><span class="by">extraduder_ire</span><span>|</span><a href="#42920636">prev</a><span>|</span><a href="#42921312">next</a><span>|</span><label class="collapse" for="c-42922608">[-]</label><label class="expand" for="c-42922608">[2 more]</label></div><br/><div class="children"><div class="content">Does this work with larger more complicated software like web browsers, skype, or discord?<p>I know I&#x27;d have to run firefox with --no-remote.<p>Very cool idea though, love tools with this sort of UX. I look forward to a V1 release in the future.</div><br/><div id="42923236" class="c"><input type="checkbox" id="c-42923236" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922608">parent</a><span>|</span><a href="#42921312">next</a><span>|</span><label class="collapse" for="c-42923236">[-]</label><label class="expand" for="c-42923236">[1 more]</label></div><br/><div class="children"><div class="content">Thanks!<p>I did try this with firefox but it doesn&#x27;t work right now due to (I think) the user namespace messing with user IDs. I think I should be able to fix this, though. I will have to try it with other desktop apps soon too...</div><br/></div></div></div></div><div id="42921312" class="c"><input type="checkbox" id="c-42921312" checked=""/><div class="controls bullet"><span class="by">quinnjh</span><span>|</span><a href="#42922608">prev</a><span>|</span><a href="#42921007">next</a><span>|</span><label class="collapse" for="c-42921312">[-]</label><label class="expand" for="c-42921312">[2 more]</label></div><br/><div class="children"><div class="content">This is something I’ve needed more than a handful of times - and each time slowly figured out a cobbled together solution with wireshark &#x2F; pcap<p>Fun reading about the authors too.<p>Thank you for sharing !</div><br/><div id="42923212" class="c"><input type="checkbox" id="c-42923212" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921312">parent</a><span>|</span><a href="#42921007">next</a><span>|</span><label class="collapse" for="c-42923212">[-]</label><label class="expand" for="c-42923212">[1 more]</label></div><br/><div class="children"><div class="content">Same here actually -- have wanted this from time to time for years. Finally sat down and worked it out.</div><br/></div></div></div></div><div id="42921007" class="c"><input type="checkbox" id="c-42921007" checked=""/><div class="controls bullet"><span class="by">emcell</span><span>|</span><a href="#42921312">prev</a><span>|</span><a href="#42921763">next</a><span>|</span><label class="collapse" for="c-42921007">[-]</label><label class="expand" for="c-42921007">[1 more]</label></div><br/><div class="children"><div class="content">This is gold! Thank you!</div><br/></div></div><div id="42921763" class="c"><input type="checkbox" id="c-42921763" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#42921007">prev</a><span>|</span><a href="#42923928">next</a><span>|</span><label class="collapse" for="c-42921763">[-]</label><label class="expand" for="c-42921763">[18 more]</label></div><br/><div class="children"><div class="content">Why not use eBPF instead? Then you could see all http requests from all processes at once, including ones that are already running. Plus you wouldn&#x27;t need to bother with TLS at all, just hook on e.g. write(2).</div><br/><div id="42923824" class="c"><input type="checkbox" id="c-42923824" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#42921763">parent</a><span>|</span><a href="#42924500">next</a><span>|</span><label class="collapse" for="c-42923824">[-]</label><label class="expand" for="c-42923824">[2 more]</label></div><br/><div class="children"><div class="content">How would hooking on write(2) solve TLS? You&#x27;ll be able to read and modify the ciphertext, but the process will never call write(2) with the plaintext bytes, so you can&#x27;t actually read the HTTP request. You&#x27;ll just see the encrypted bytes that go on the wire, but so does the NSA :)<p>You need the kind of CA certificate trick that httptap uses. It comes with its own set of caveats (e.g. certificate pinning), but it can be made to work reliably in most practical scenarios.<p>I&#x27;ve spent an unjustifiable amount of time thinking about this specific problem building Subtrace [1], so I&#x27;m genuinely very interested in a simpler &#x2F; more elegant approach.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;subtrace&#x2F;subtrace">https:&#x2F;&#x2F;github.com&#x2F;subtrace&#x2F;subtrace</a></div><br/><div id="42929856" class="c"><input type="checkbox" id="c-42929856" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42923824">parent</a><span>|</span><a href="#42924500">next</a><span>|</span><label class="collapse" for="c-42929856">[-]</label><label class="expand" for="c-42929856">[1 more]</label></div><br/><div class="children"><div class="content">I believe that&#x27;s how <a href="https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture">https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture</a> works. I don&#x27;t know the details, but it seems to work!</div><br/></div></div></div></div><div id="42924500" class="c"><input type="checkbox" id="c-42924500" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921763">parent</a><span>|</span><a href="#42923824">prev</a><span>|</span><a href="#42927428">next</a><span>|</span><label class="collapse" for="c-42924500">[-]</label><label class="expand" for="c-42924500">[3 more]</label></div><br/><div class="children"><div class="content">Unfortunately TLS happens inside the the application, not in the kernel, so using eBPF to hook syscalls to write won&#x27;t help with TLS decryption.</div><br/><div id="42924670" class="c"><input type="checkbox" id="c-42924670" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42924500">parent</a><span>|</span><a href="#42928250">next</a><span>|</span><label class="collapse" for="c-42924670">[-]</label><label class="expand" for="c-42924670">[1 more]</label></div><br/><div class="children"><div class="content">It is quite simple to use eBPF with uprobes to hook library calls, for example: <a href="https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsniff.py">https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsniff.py</a><p>The downside is this doesn&#x27;t work with anything not using OpenSSL, there are projects like <a href="https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture">https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture</a> which have interceptors for many common libraries, but the downside is that needs different code for each library.<p>I think providing a TLS certificate is fine for the use cases of the tool; most tools won&#x27;t be doing certificate pinning, but ecapture does support Android where this is more likely.</div><br/></div></div><div id="42928250" class="c"><input type="checkbox" id="c-42928250" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42924500">parent</a><span>|</span><a href="#42924670">prev</a><span>|</span><a href="#42927428">next</a><span>|</span><label class="collapse" for="c-42928250">[-]</label><label class="expand" for="c-42928250">[1 more]</label></div><br/><div class="children"><div class="content">But read and write syscalls are used by the application to do I&#x2F;O on the sockets before&#x2F;after the encryption, which can be intercepted. Or you can attach uprobes directly to the TLS library&#x27;s own functions.</div><br/></div></div></div></div><div id="42927428" class="c"><input type="checkbox" id="c-42927428" checked=""/><div class="controls bullet"><span class="by">ARob109</span><span>|</span><a href="#42921763">parent</a><span>|</span><a href="#42924500">prev</a><span>|</span><a href="#42921954">next</a><span>|</span><label class="collapse" for="c-42927428">[-]</label><label class="expand" for="c-42927428">[3 more]</label></div><br/><div class="children"><div class="content">Using uprobes to hook the SSL library, would it be possible to filter content by inspecting and modifying eg the decrypted HTTP response ?</div><br/><div id="42928234" class="c"><input type="checkbox" id="c-42928234" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42927428">parent</a><span>|</span><a href="#42921954">next</a><span>|</span><label class="collapse" for="c-42928234">[-]</label><label class="expand" for="c-42928234">[2 more]</label></div><br/><div class="children"><div class="content">absolutely</div><br/><div id="42929118" class="c"><input type="checkbox" id="c-42929118" checked=""/><div class="controls bullet"><span class="by">farnulfo</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42928234">parent</a><span>|</span><a href="#42921954">next</a><span>|</span><label class="collapse" for="c-42929118">[-]</label><label class="expand" for="c-42929118">[1 more]</label></div><br/><div class="children"><div class="content">eBPF TLS tracing: The Past, Present and Future 
<a href="https:&#x2F;&#x2F;blog.px.dev&#x2F;ebpf-tls-tracing-past-present-future&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.px.dev&#x2F;ebpf-tls-tracing-past-present-future&#x2F;</a></div><br/></div></div></div></div></div></div><div id="42921954" class="c"><input type="checkbox" id="c-42921954" checked=""/><div class="controls bullet"><span class="by">somanyphotons</span><span>|</span><a href="#42921763">parent</a><span>|</span><a href="#42927428">prev</a><span>|</span><a href="#42921870">next</a><span>|</span><label class="collapse" for="c-42921954">[-]</label><label class="expand" for="c-42921954">[8 more]</label></div><br/><div class="children"><div class="content">Presumably eBPF requires root privs?</div><br/><div id="42922030" class="c"><input type="checkbox" id="c-42922030" checked=""/><div class="controls bullet"><span class="by">trallnag</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42921954">parent</a><span>|</span><a href="#42922926">prev</a><span>|</span><a href="#42921870">next</a><span>|</span><label class="collapse" for="c-42922030">[-]</label><label class="expand" for="c-42922030">[6 more]</label></div><br/><div class="children"><div class="content">I&#x27;m having a hard time coming up with a use case where I want to use a tool like that but I&#x27;m also lacking root privileges</div><br/><div id="42922087" class="c"><input type="checkbox" id="c-42922087" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42922030">parent</a><span>|</span><a href="#42921870">next</a><span>|</span><label class="collapse" for="c-42922087">[-]</label><label class="expand" for="c-42922087">[5 more]</label></div><br/><div class="children"><div class="content">Inside most production environments.  I could use this today inside a Pod that isn&#x27;t allowed root privs.</div><br/><div id="42924734" class="c"><input type="checkbox" id="c-42924734" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42922087">parent</a><span>|</span><a href="#42922183">next</a><span>|</span><label class="collapse" for="c-42924734">[-]</label><label class="expand" for="c-42924734">[1 more]</label></div><br/><div class="children"><div class="content">This won&#x27;t work in most cases inside a Kubernetes pod, as the default seccomp policies don&#x27;t allow creating namespaces within them. You can obviously relax the seccomp policies, but at that point you can also just give yourself the capabilities.<p>There are eBPF tools which will work, for example <a href="https:&#x2F;&#x2F;inspektor-gadget.io&#x2F;docs&#x2F;latest&#x2F;gadgets&#x2F;trace_ssl" rel="nofollow">https:&#x2F;&#x2F;inspektor-gadget.io&#x2F;docs&#x2F;latest&#x2F;gadgets&#x2F;trace_ssl</a></div><br/></div></div><div id="42922183" class="c"><input type="checkbox" id="c-42922183" checked=""/><div class="controls bullet"><span class="by">zamubafoo</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42922087">parent</a><span>|</span><a href="#42924734">prev</a><span>|</span><a href="#42921870">next</a><span>|</span><label class="collapse" for="c-42922183">[-]</label><label class="expand" for="c-42922183">[3 more]</label></div><br/><div class="children"><div class="content">In production environments that won&#x27;t give you root access, you won&#x27;t be exec&#x27;ing inside of a pod if you aren&#x27;t an operator or sysadmin.</div><br/><div id="42924603" class="c"><input type="checkbox" id="c-42924603" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42922183">parent</a><span>|</span><a href="#42923186">next</a><span>|</span><label class="collapse" for="c-42924603">[-]</label><label class="expand" for="c-42924603">[1 more]</label></div><br/><div class="children"><div class="content">In my particular case, I am an operator and sys admin, but I don&#x27;t give myself root privileges without having to go through some serious hoops, which I only jump through if I really truly need it. If I want root, I have to actually change the kubernetes manifest yaml to allow elevation to root privileges. That&#x27;s not something that can be done without getting others involved for code reviews and what not.<p>However, even in the case of general developers, it isn&#x27;t true. Companies do restrict exec abilities, but we don&#x27;t. Many startups are the same, because developers are expected to also troubleshoot and debug production issues. If you don&#x27;t allow shells in pods, you are really binding the hands of your devs.<p>To be clear, I am not disagreeing with you. You are correct in many cases. But there are a number of exceptions in my experience.</div><br/></div></div><div id="42923186" class="c"><input type="checkbox" id="c-42923186" checked=""/><div class="controls bullet"><span class="by">imcritic</span><span>|</span><a href="#42921763">root</a><span>|</span><a href="#42922183">parent</a><span>|</span><a href="#42924603">prev</a><span>|</span><a href="#42921870">next</a><span>|</span><label class="collapse" for="c-42923186">[-]</label><label class="expand" for="c-42923186">[1 more]</label></div><br/><div class="children"><div class="content">No, you are wrong. I would. The pod would be mine though.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42921870" class="c"><input type="checkbox" id="c-42921870" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#42921763">parent</a><span>|</span><a href="#42921954">prev</a><span>|</span><a href="#42923928">next</a><span>|</span><label class="collapse" for="c-42921870">[-]</label><label class="expand" for="c-42921870">[1 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t this require root? A big &quot;selling point&quot; of httptap seems to be that precisely it doesn&#x27;t require root.<p>Anyway the more options we have, the better.</div><br/></div></div></div></div><div id="42923928" class="c"><input type="checkbox" id="c-42923928" checked=""/><div class="controls bullet"><span class="by">concerndc1tizen</span><span>|</span><a href="#42921763">prev</a><span>|</span><a href="#42920363">next</a><span>|</span><label class="collapse" for="c-42923928">[-]</label><label class="expand" for="c-42923928">[2 more]</label></div><br/><div class="children"><div class="content">Which privileges are required? CAP_NET_ADMIN? Or nothing at all?</div><br/><div id="42924528" class="c"><input type="checkbox" id="c-42924528" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42923928">parent</a><span>|</span><a href="#42920363">next</a><span>|</span><label class="collapse" for="c-42924528">[-]</label><label class="expand" for="c-42924528">[1 more]</label></div><br/><div class="children"><div class="content">Nothing at all!<p>You <i>do</i> need write access to &#x2F;dev&#x2F;net&#x2F;tun. This is standard for all users for the distros that I&#x27;ve looked into, but it is ultimately a distro-specific thing.</div><br/></div></div></div></div><div id="42920363" class="c"><input type="checkbox" id="c-42920363" checked=""/><div class="controls bullet"><span class="by">progforlyfe</span><span>|</span><a href="#42923928">prev</a><span>|</span><a href="#42923848">next</a><span>|</span><label class="collapse" for="c-42920363">[-]</label><label class="expand" for="c-42920363">[1 more]</label></div><br/><div class="children"><div class="content">very helpful for inspection and testing!</div><br/></div></div><div id="42922456" class="c"><input type="checkbox" id="c-42922456" checked=""/><div class="controls bullet"><span class="by">josephcsible</span><span>|</span><a href="#42923848">prev</a><span>|</span><a href="#42924171">next</a><span>|</span><label class="collapse" for="c-42922456">[-]</label><label class="expand" for="c-42922456">[3 more]</label></div><br/><div class="children"><div class="content">Is this implementing TCP in userspace?</div><br/><div id="42923195" class="c"><input type="checkbox" id="c-42923195" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42922456">parent</a><span>|</span><a href="#42922818">next</a><span>|</span><label class="collapse" for="c-42923195">[-]</label><label class="expand" for="c-42923195">[1 more]</label></div><br/><div class="children"><div class="content">Yep. This is the first time I&#x27;ve mentioned this but there are actually two implementations of this in the codebase -- one uses gVisor and one is an incredibly bare-bones TCP implementation that I wrote myself in 550 lines of Go code (tcp.go). The home-grown one isn&#x27;t used by default and it doesn&#x27;t support much of TCP proper, but it actually works pretty well. You can use it with `--stack=homegrown`.</div><br/></div></div><div id="42922818" class="c"><input type="checkbox" id="c-42922818" checked=""/><div class="controls bullet"><span class="by">aerzen</span><span>|</span><a href="#42922456">parent</a><span>|</span><a href="#42923195">prev</a><span>|</span><a href="#42924171">next</a><span>|</span><label class="collapse" for="c-42922818">[-]</label><label class="expand" for="c-42922818">[1 more]</label></div><br/><div class="children"><div class="content">Yes</div><br/></div></div></div></div><div id="42924171" class="c"><input type="checkbox" id="c-42924171" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#42922456">prev</a><span>|</span><a href="#42923257">next</a><span>|</span><label class="collapse" for="c-42924171">[-]</label><label class="expand" for="c-42924171">[1 more]</label></div><br/><div class="children"><div class="content">Very cool if you need a quick and dirty way to inspect the http&#x2F;s call stack of an app. Personally prefer eBPF to get _everything_ but using this utility can help drill down what is important in the eBPF trace</div><br/></div></div><div id="42923257" class="c"><input type="checkbox" id="c-42923257" checked=""/><div class="controls bullet"><span class="by">wslh</span><span>|</span><a href="#42924171">prev</a><span>|</span><a href="#42921897">next</a><span>|</span><label class="collapse" for="c-42923257">[-]</label><label class="expand" for="c-42923257">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a great DX! I wonder if an alternative way is to just hook functions like read, and write, and other functions linked to the SSL libs. It is true that you should be aware of the SSL libs in place but OpenSSL is the most popular.</div><br/><div id="42923350" class="c"><input type="checkbox" id="c-42923350" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42923257">parent</a><span>|</span><a href="#42921897">next</a><span>|</span><label class="collapse" for="c-42923350">[-]</label><label class="expand" for="c-42923350">[2 more]</label></div><br/><div class="children"><div class="content">This is a very interesting possibility actually. Not 100% sure what the implication would be but maybe there is something here.</div><br/><div id="42924050" class="c"><input type="checkbox" id="c-42924050" checked=""/><div class="controls bullet"><span class="by">wslh</span><span>|</span><a href="#42923257">root</a><span>|</span><a href="#42923350">parent</a><span>|</span><a href="#42921897">next</a><span>|</span><label class="collapse" for="c-42924050">[-]</label><label class="expand" for="c-42924050">[1 more]</label></div><br/><div class="children"><div class="content">You can use a hooking library like these [1].<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;frida&#x2F;frida&#x2F;wiki&#x2F;Comparison-of-function-hooking-libraries">https:&#x2F;&#x2F;github.com&#x2F;frida&#x2F;frida&#x2F;wiki&#x2F;Comparison-of-function-h...</a></div><br/></div></div></div></div></div></div><div id="42921897" class="c"><input type="checkbox" id="c-42921897" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#42923257">prev</a><span>|</span><label class="collapse" for="c-42921897">[-]</label><label class="expand" for="c-42921897">[2 more]</label></div><br/><div class="children"><div class="content">does not seem to support SOCKS proxies which I rely on</div><br/><div id="42923039" class="c"><input type="checkbox" id="c-42923039" checked=""/><div class="controls bullet"><span class="by">alexflint</span><span>|</span><a href="#42921897">parent</a><span>|</span><label class="collapse" for="c-42923039">[-]</label><label class="expand" for="c-42923039">[1 more]</label></div><br/><div class="children"><div class="content">Interesting. Care to share any info about your setup? Would it be a matter of httptap reading a certain environment variable and then forwarding traffic to a SOCKS proxy?<p>FWIW there is also the excellent tun2socks (<a href="https:&#x2F;&#x2F;github.com&#x2F;xjasonlyu&#x2F;tun2socks">https:&#x2F;&#x2F;github.com&#x2F;xjasonlyu&#x2F;tun2socks</a>), which was a significant inspiration for this project, and is specifically designed to forward traffic from a TUN device to a SOCKS proxy.</div><br/></div></div></div></div></div></div></div></div></div></body></html>