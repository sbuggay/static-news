<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1699002059995" as="style"/><link rel="stylesheet" href="styles.css?v=1699002059995"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://outflux.net/blog/archives/2023/10/26/enable-mte-on-pixel-8/">Enable ARMv9 Memory Tagging Extension (MTE) on Pixel 8</a> <span class="domain">(<a href="https://outflux.net">outflux.net</a>)</span></div><div class="subtext"><span>transpute</span> | <span>14 comments</span></div><br/><div><div id="38126069" class="c"><input type="checkbox" id="c-38126069" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38125887">next</a><span>|</span><label class="collapse" for="c-38126069">[-]</label><label class="expand" for="c-38126069">[1 more]</label></div><br/><div class="children"><div class="content">Arm memory tagging whitepaper (2019), <a href="https:&#x2F;&#x2F;developer.arm.com&#x2F;-&#x2F;media&#x2F;Arm%20Developer%20Community&#x2F;PDF&#x2F;Arm_Memory_Tagging_Extension_Whitepaper.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;developer.arm.com&#x2F;-&#x2F;media&#x2F;Arm%20Developer%20Communit...</a><p><i>&gt; MTE provides a mechanism to detect both [spatial, temporal] categories of memory safety violation. MTE assists the detection of potential vulnerabilities before deployment by increasing the  effectiveness of testing and fuzzing. MTE also assists detection of vulnerabilities at scale after deployment ... Memory locations are tagged by adding four bits of metadata to each 16 bytes of physical  memory. This is the Tag Granule. Tagging memory implements the lock. Pointers, and therefore virtual addresses, are modified to contain the key.</i></div><br/></div></div><div id="38125887" class="c"><input type="checkbox" id="c-38125887" checked=""/><div class="controls bullet"><span class="by">akyuu</span><span>|</span><a href="#38126069">prev</a><span>|</span><a href="#38125707">next</a><span>|</span><label class="collapse" for="c-38125887">[-]</label><label class="expand" for="c-38125887">[1 more]</label></div><br/><div class="children"><div class="content">Consider using GrapheneOS instead of stock Android for an improved version of MTE (and extra security and privacy as a bonus): <a href="https:&#x2F;&#x2F;discuss.grapheneos.org&#x2F;d&#x2F;8439-mte-support-status-for-grapheneos&#x2F;34" rel="nofollow noreferrer">https:&#x2F;&#x2F;discuss.grapheneos.org&#x2F;d&#x2F;8439-mte-support-status-for...</a><p>&gt; <i>Stock Pixel OS has it as a developer option which isn&#x27;t usable in practice since it breaks far too much. The implementation is also much less powerful than hardened_malloc.</i><p>&gt; <i>We integrated it into hardened_malloc where it&#x27;s able to provide stronger security properties than the experimental stock OS implementation.</i><p>&gt; <i>When fully integrated into the compiler and each heap allocator, MTE enforces a form of memory safety. It detects memory corruption as it happens. 4 bit tags limit it to probabilistic detection for the general case, but deterministic guarantees are possible via reserving tags. In hardened_malloc, we deterministically prevent sequential overflows by excluding adjacent tags.</i><p>Also, currently it&#x27;s not clear if it makes sense to enable kernel MTE:<p>&gt; <i>MTE support for protecting the Linux kernel isn&#x27;t enabled yet, but we can likely enable that by default too. However, it&#x27;s currently part of kasan and is more oriented towards debugging than hardening. It&#x27;s not entirely clear that enabling it in the current state is a good idea.</i></div><br/></div></div><div id="38125707" class="c"><input type="checkbox" id="c-38125707" checked=""/><div class="controls bullet"><span class="by">Moldoteck</span><span>|</span><a href="#38125887">prev</a><span>|</span><a href="#38125675">next</a><span>|</span><label class="collapse" for="c-38125707">[-]</label><label class="expand" for="c-38125707">[1 more]</label></div><br/><div class="children"><div class="content">Memory tagged extension, to prevent some memory access bugs
Here more info: <a href="https:&#x2F;&#x2F;brandulox.medium.com&#x2F;pixel-8-and-8-pro-the-first-smartphones-with-android-14s-advanced-feature-4fdf2b0a02b4" rel="nofollow noreferrer">https:&#x2F;&#x2F;brandulox.medium.com&#x2F;pixel-8-and-8-pro-the-first-sma...</a></div><br/></div></div><div id="38125675" class="c"><input type="checkbox" id="c-38125675" checked=""/><div class="controls bullet"><span class="by">maxloh</span><span>|</span><a href="#38125707">prev</a><span>|</span><a href="#38125843">next</a><span>|</span><label class="collapse" for="c-38125675">[-]</label><label class="expand" for="c-38125675">[2 more]</label></div><br/><div class="children"><div class="content">Why isn&#x27;t it enabled by default?</div><br/><div id="38125876" class="c"><input type="checkbox" id="c-38125876" checked=""/><div class="controls bullet"><span class="by">vesinisa</span><span>|</span><a href="#38125675">parent</a><span>|</span><a href="#38125843">next</a><span>|</span><label class="collapse" for="c-38125876">[-]</label><label class="expand" for="c-38125876">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s probably a very good reason for it.<p>I would definitely advice anyone against enabling &quot;Developer options&quot; on your phone without having a good understanding what those options do. They are hidden and hard to access for a reason.</div><br/></div></div></div></div><div id="38125843" class="c"><input type="checkbox" id="c-38125843" checked=""/><div class="controls bullet"><span class="by">cjnicholls</span><span>|</span><a href="#38125675">prev</a><span>|</span><a href="#38125689">next</a><span>|</span><label class="collapse" for="c-38125843">[-]</label><label class="expand" for="c-38125843">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;archive.is&#x2F;09uCE" rel="nofollow noreferrer">https:&#x2F;&#x2F;archive.is&#x2F;09uCE</a></div><br/></div></div><div id="38125689" class="c"><input type="checkbox" id="c-38125689" checked=""/><div class="controls bullet"><span class="by">shermozle</span><span>|</span><a href="#38125843">prev</a><span>|</span><label class="collapse" for="c-38125689">[-]</label><label class="expand" for="c-38125689">[7 more]</label></div><br/><div class="children"><div class="content">Multicultural Toronto English? Something else?<p>(site seems dead)</div><br/><div id="38125709" class="c"><input type="checkbox" id="c-38125709" checked=""/><div class="controls bullet"><span class="by">darkamaul</span><span>|</span><a href="#38125689">parent</a><span>|</span><a href="#38125717">next</a><span>|</span><label class="collapse" for="c-38125709">[-]</label><label class="expand" for="c-38125709">[1 more]</label></div><br/><div class="children"><div class="content">Memory Tagging Extension (MTE)<p>This allows to assign tag to each memory allocation. And subsequent accesses to the same memory area must be made with a pointer having a correct tag.</div><br/></div></div><div id="38125717" class="c"><input type="checkbox" id="c-38125717" checked=""/><div class="controls bullet"><span class="by">zerocrates</span><span>|</span><a href="#38125689">parent</a><span>|</span><a href="#38125709">prev</a><span>|</span><label class="collapse" for="c-38125717">[-]</label><label class="expand" for="c-38125717">[5 more]</label></div><br/><div class="children"><div class="content">Memory Tagging Extension, an arm v9 hardware feature for mitigating some memory safety bugs.</div><br/><div id="38125819" class="c"><input type="checkbox" id="c-38125819" checked=""/><div class="controls bullet"><span class="by">LoganDark</span><span>|</span><a href="#38125689">root</a><span>|</span><a href="#38125717">parent</a><span>|</span><label class="collapse" for="c-38125819">[-]</label><label class="expand" for="c-38125819">[4 more]</label></div><br/><div class="children"><div class="content">Is this the outcome of the Morello project? Honestly sounds nice.</div><br/><div id="38125994" class="c"><input type="checkbox" id="c-38125994" checked=""/><div class="controls bullet"><span class="by">obnauticus</span><span>|</span><a href="#38125689">root</a><span>|</span><a href="#38125819">parent</a><span>|</span><a href="#38125911">next</a><span>|</span><label class="collapse" for="c-38125994">[-]</label><label class="expand" for="c-38125994">[2 more]</label></div><br/><div class="children"><div class="content">CHERI vs MTE is a bit of a nuanced topic. At least one part of the limiting factor for MTE is that you get a finite number of tag “color codes” which opens the opportunity for some form of probabilistic attacks. Of course this helps with defense in depth as it’s yet another layer of security, but it isn’t as strong of a prevention as a CHERI capability for example.<p>This page explains it pretty well:
<a href="https:&#x2F;&#x2F;msrc.microsoft.com&#x2F;blog&#x2F;2022&#x2F;01&#x2F;an_armful_of_cheris&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;msrc.microsoft.com&#x2F;blog&#x2F;2022&#x2F;01&#x2F;an_armful_of_cheris&#x2F;</a></div><br/><div id="38126105" class="c"><input type="checkbox" id="c-38126105" checked=""/><div class="controls bullet"><span class="by">fuklief</span><span>|</span><a href="#38125689">root</a><span>|</span><a href="#38125994">parent</a><span>|</span><a href="#38125911">next</a><span>|</span><label class="collapse" for="c-38126105">[-]</label><label class="expand" for="c-38126105">[1 more]</label></div><br/><div class="children"><div class="content">This survey by the same author also provides a good comparison <a href="https:&#x2F;&#x2F;saaramar.github.io&#x2F;memory_safety_blogpost_2022&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;saaramar.github.io&#x2F;memory_safety_blogpost_2022&#x2F;</a></div><br/></div></div></div></div><div id="38125911" class="c"><input type="checkbox" id="c-38125911" checked=""/><div class="controls bullet"><span class="by">akyuu</span><span>|</span><a href="#38125689">root</a><span>|</span><a href="#38125819">parent</a><span>|</span><a href="#38125994">prev</a><span>|</span><label class="collapse" for="c-38125911">[-]</label><label class="expand" for="c-38125911">[1 more]</label></div><br/><div class="children"><div class="content">No, AFAIK Morello project is about designing an Arm CPU with CHERI, a hardware architecture with extra security capabilities that is still WIP: <a href="https:&#x2F;&#x2F;tratt.net&#x2F;laurie&#x2F;blog&#x2F;2023&#x2F;two_stories_for_what_is_cheri.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;tratt.net&#x2F;laurie&#x2F;blog&#x2F;2023&#x2F;two_stories_for_what_is_c...</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>