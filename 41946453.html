<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1729933251992" as="style"/><link rel="stylesheet" href="styles.css?v=1729933251992"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://klecko.github.io/posts/selinux-bypasses/">SELinux bypasses</a>Â <span class="domain">(<a href="https://klecko.github.io">klecko.github.io</a>)</span></div><div class="subtext"><span>voxadam</span> | <span>31 comments</span></div><br/><div><div id="41949034" class="c"><input type="checkbox" id="c-41949034" checked=""/><div class="controls bullet"><span class="by">wannacboatmovie</span><span>|</span><a href="#41949589">next</a><span>|</span><label class="collapse" for="c-41949034">[-]</label><label class="expand" for="c-41949034">[5 more]</label></div><br/><div class="children"><div class="content">The problem with SELinux is it&#x27;s very fragile and basically broken outside RedHat distros.<p>As an experiment I installed SELinux on Debian and while I was eventually able to get it stable and working after a lot of trial and error, a disk swap followed by an rsync broke it irreparably. Yes I rescanned the disk or whatever to have SEL relearn&#x2F;reindex the objects, didn&#x27;t work. The box was basically unbootable or it would boot and rejected all logins, including root directly to the console, something that should nearly never happen. Documentation is sparse or assumes you have RedHat and it &#x27;just works&#x27;. After hours of troubleshooting the only thing that worked was switching it off and saying good riddance.</div><br/><div id="41949091" class="c"><input type="checkbox" id="c-41949091" checked=""/><div class="controls bullet"><span class="by">totony</span><span>|</span><a href="#41949034">parent</a><span>|</span><a href="#41950204">next</a><span>|</span><label class="collapse" for="c-41949091">[-]</label><label class="expand" for="c-41949091">[3 more]</label></div><br/><div class="children"><div class="content">Most distros use <a href="https:&#x2F;&#x2F;github.com&#x2F;SELinuxProject&#x2F;refpolicy">https:&#x2F;&#x2F;github.com&#x2F;SELinuxProject&#x2F;refpolicy</a> while RHEL uses <a href="https:&#x2F;&#x2F;github.com&#x2F;fedora-selinux&#x2F;selinux-policy">https:&#x2F;&#x2F;github.com&#x2F;fedora-selinux&#x2F;selinux-policy</a><p>It&#x27;s also my experience that Fedora has better support for it, but Gentoo used to be good enough with hardened gentoo (they use <a href="https:&#x2F;&#x2F;gitweb.gentoo.org&#x2F;proj&#x2F;hardened-refpolicy.git&#x2F;" rel="nofollow">https:&#x2F;&#x2F;gitweb.gentoo.org&#x2F;proj&#x2F;hardened-refpolicy.git&#x2F;</a>). Redhat and Gentoo are the only ones that officially support it afaik. I think hardened gentoo might have lost popularity since the fall of grsec, but I&#x27;m not sure how popular it is currently.</div><br/><div id="41949298" class="c"><input type="checkbox" id="c-41949298" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#41949034">root</a><span>|</span><a href="#41949091">parent</a><span>|</span><a href="#41950204">next</a><span>|</span><label class="collapse" for="c-41949298">[-]</label><label class="expand" for="c-41949298">[2 more]</label></div><br/><div class="children"><div class="content">FWIW Android also uses SELinux &amp; I believe selinux-policy. Have no idea about the quality of the implementation.</div><br/><div id="41950415" class="c"><input type="checkbox" id="c-41950415" checked=""/><div class="controls bullet"><span class="by">BSDobelix</span><span>|</span><a href="#41949034">root</a><span>|</span><a href="#41949298">parent</a><span>|</span><a href="#41950204">next</a><span>|</span><label class="collapse" for="c-41950415">[-]</label><label class="expand" for="c-41950415">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Android also uses SELinux<p>Too bad you haven&#x27;t even read a part of the article.</div><br/></div></div></div></div></div></div><div id="41950204" class="c"><input type="checkbox" id="c-41950204" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#41949034">parent</a><span>|</span><a href="#41949091">prev</a><span>|</span><a href="#41949589">next</a><span>|</span><label class="collapse" for="c-41950204">[-]</label><label class="expand" for="c-41950204">[1 more]</label></div><br/><div class="children"><div class="content">Gentoo added some excellent and fairly distro-neutral documentation for SELinux a few years ago which makes it somewhat viable outside of Red Hat. It&#x27;s also helpful for debugging issues even on Red Hat.<p><a href="https:&#x2F;&#x2F;wiki.gentoo.org&#x2F;wiki&#x2F;SELinux" rel="nofollow">https:&#x2F;&#x2F;wiki.gentoo.org&#x2F;wiki&#x2F;SELinux</a></div><br/></div></div></div></div><div id="41949589" class="c"><input type="checkbox" id="c-41949589" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#41949034">prev</a><span>|</span><a href="#41948981">next</a><span>|</span><label class="collapse" for="c-41949589">[-]</label><label class="expand" for="c-41949589">[3 more]</label></div><br/><div class="children"><div class="content">SELinux for Linux was never intended to be highly secure. When NSA created it [1], the intent was to get user software modified to work in a mandatory access control environment. 
Then, more secure operating systems for DoD use would be able to run available software.<p>NSA used to do a lot of operating systems work, but no longer seems to do that.<p>[1] <a href="https:&#x2F;&#x2F;www.nsa.gov&#x2F;Research&#x2F;NSA-Mission-Oriented-Research&#x2F;LACR&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.nsa.gov&#x2F;Research&#x2F;NSA-Mission-Oriented-Research&#x2F;L...</a></div><br/><div id="41953426" class="c"><input type="checkbox" id="c-41953426" checked=""/><div class="controls bullet"><span class="by">ykonstant</span><span>|</span><a href="#41949589">parent</a><span>|</span><a href="#41949832">next</a><span>|</span><label class="collapse" for="c-41953426">[-]</label><label class="expand" for="c-41953426">[1 more]</label></div><br/><div class="children"><div class="content">I really wish they resume their (visible) work on Operating Systems; if nothing else, it signals the world that OS Security is &quot;serious business&quot; when the premier cyber-spy-security agency dedicates resources to it.  I cannot believe they are strapped for money!</div><br/></div></div><div id="41949832" class="c"><input type="checkbox" id="c-41949832" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#41949589">parent</a><span>|</span><a href="#41953426">prev</a><span>|</span><a href="#41948981">next</a><span>|</span><label class="collapse" for="c-41949832">[-]</label><label class="expand" for="c-41949832">[1 more]</label></div><br/><div class="children"><div class="content">MAC for Zephyr was presented at Linux Security Summit (2019), <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=AKWFbxbsU3o" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=AKWFbxbsU3o</a><p><pre><code>  .. a flexible MAC architecture was created and matured through a series of research systems. The work to bring this architecture to mainstream systems [and] experience with applying this architecture to mobile platforms is examined. The role of MAC in a larger system architecture is reviewed in the context of a secure virtualization system. The state of MAC in mainstream systems is compared before and after our work. 
</code></pre>
Review of non-public STM for constraining SMM, <a href="https:&#x2F;&#x2F;www.platformsecuritysummit.com&#x2F;2018&#x2F;speaker&#x2F;myers&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.platformsecuritysummit.com&#x2F;2018&#x2F;speaker&#x2F;myers&#x2F;</a><p><pre><code>  We describe our work to demonstrate an enhanced SMI transfer monitor (STM) to provide protected execution services on the x86 platform. An STM is a hypervisor that executes in x86 system management mode (SMM) and functions as a peer to the hypervisor or operating system. The STM constrains the SMI handler, by hosting the handler in a virtual machine (VM). Otherwise, the SMI handler holds unconstrained access to the platform, which could undermine the assurance provided by DRTM or TXT.
</code></pre>
OSS STM contributed to coreboot, <a href="https:&#x2F;&#x2F;cyberscoop.com&#x2F;nsa-firmware-open-source-coreboot-stm-pe-eugene-myers&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cyberscoop.com&#x2F;nsa-firmware-open-source-coreboot-stm...</a> &amp; <a href="https:&#x2F;&#x2F;www.osfc.io&#x2F;2019&#x2F;talks&#x2F;implementing-stm-support-for-coreboot&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.osfc.io&#x2F;2019&#x2F;talks&#x2F;implementing-stm-support-for-...</a><p><pre><code>  Implementation of SMI transfer monitor (STM) support for Coreboot.</code></pre></div><br/></div></div></div></div><div id="41948981" class="c"><input type="checkbox" id="c-41948981" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#41949589">prev</a><span>|</span><a href="#41949807">next</a><span>|</span><label class="collapse" for="c-41948981">[-]</label><label class="expand" for="c-41948981">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a bit confused by this article.  If you have a way to write arbitrarily into kernel structures can&#x27;t you pretty much do anything already?</div><br/><div id="41949229" class="c"><input type="checkbox" id="c-41949229" checked=""/><div class="controls bullet"><span class="by">DougMerritt</span><span>|</span><a href="#41948981">parent</a><span>|</span><a href="#41949807">next</a><span>|</span><label class="collapse" for="c-41949229">[-]</label><label class="expand" for="c-41949229">[1 more]</label></div><br/><div class="children"><div class="content">On raw hardware, yes, but they&#x27;re talking about running on a Samsung hypervisor.</div><br/></div></div></div></div><div id="41949807" class="c"><input type="checkbox" id="c-41949807" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#41948981">prev</a><span>|</span><a href="#41950765">next</a><span>|</span><label class="collapse" for="c-41949807">[-]</label><label class="expand" for="c-41949807">[9 more]</label></div><br/><div class="children"><div class="content">It seems to me that every new rhel release has more switches to throw to get my things installed and working.<p>It&#x27;s especially a bit extreme when systemd gets the syslog denial.<p>How do we dial this back?</div><br/><div id="41950172" class="c"><input type="checkbox" id="c-41950172" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#41949807">parent</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41950172">[-]</label><label class="expand" for="c-41950172">[7 more]</label></div><br/><div class="children"><div class="content">Learn RHEL properly or use a different distro. RHEL isn&#x27;t going to change its philosophy.</div><br/><div id="41950567" class="c"><input type="checkbox" id="c-41950567" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41950172">parent</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41950567">[-]</label><label class="expand" for="c-41950567">[6 more]</label></div><br/><div class="children"><div class="content">You are being downvoted but this answer is exactly right. It&#x27;s kind of like complaining about group policy in Windows.</div><br/><div id="41951065" class="c"><input type="checkbox" id="c-41951065" checked=""/><div class="controls bullet"><span class="by">orbisvicis</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41950567">parent</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41951065">[-]</label><label class="expand" for="c-41951065">[5 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly right - RH is windozifying Linux.</div><br/><div id="41951188" class="c"><input type="checkbox" id="c-41951188" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41951065">parent</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41951188">[-]</label><label class="expand" for="c-41951188">[4 more]</label></div><br/><div class="children"><div class="content">So is Ubuntu, so is any distro with systemd.<p>The point though, was if you don&#x27;t want to learn to use a complex system you shouldn&#x27;t complain when you use it and don&#x27;t understand it.</div><br/><div id="41951529" class="c"><input type="checkbox" id="c-41951529" checked=""/><div class="controls bullet"><span class="by">orbisvicis</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41951188">parent</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41951529">[-]</label><label class="expand" for="c-41951529">[3 more]</label></div><br/><div class="children"><div class="content">RH is doing a lot of good things like unifying the NetworkManager configuration for plugins. But some things give me pause, such as - and it&#x27;s been a while so I don&#x27;t quite remember - copying ssh key selection settings to a security policy file elsewhere such that those settings in the regular config would be ignored. These are ssh-specific settings that did not integrate into a global &quot;policy&quot;, and which were placed in a nonstandard location - not ssh.d, which now that I think about it is probably another RH invention.</div><br/><div id="41952568" class="c"><input type="checkbox" id="c-41952568" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41951529">parent</a><span>|</span><a href="#41952459">next</a><span>|</span><label class="collapse" for="c-41952568">[-]</label><label class="expand" for="c-41952568">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But some things give me pause, such as - and it&#x27;s been a while so I don&#x27;t quite remember - copying ssh key selection settings to a security policy file elsewhere such that those settings in the regular config would be ignored.<p>Yeah, I&#x27;ve always been against that type of crap.<p>It&#x27;s why Ubuntu, even Debian, and especially RedHat were never really viable distros for me when things like Slackware, Alpine and Void exist.<p>I don&#x27;t need a ton of abstraction between me and what I&#x27;m trying to accomplish.</div><br/></div></div><div id="41952459" class="c"><input type="checkbox" id="c-41952459" checked=""/><div class="controls bullet"><span class="by">worthless-trash</span><span>|</span><a href="#41949807">root</a><span>|</span><a href="#41951529">parent</a><span>|</span><a href="#41952568">prev</a><span>|</span><a href="#41951943">next</a><span>|</span><label class="collapse" for="c-41952459">[-]</label><label class="expand" for="c-41952459">[1 more]</label></div><br/><div class="children"><div class="content">I think that&#x27;s the crypto policy configuration which was required for some government certification iirc.  It&#x27;s been a while but I ran into this too.<p>There was a document on access.redhat.com that talked about it.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41951943" class="c"><input type="checkbox" id="c-41951943" checked=""/><div class="controls bullet"><span class="by">orev</span><span>|</span><a href="#41949807">parent</a><span>|</span><a href="#41950172">prev</a><span>|</span><a href="#41950765">next</a><span>|</span><label class="collapse" for="c-41951943">[-]</label><label class="expand" for="c-41951943">[1 more]</label></div><br/><div class="children"><div class="content">By default, packages you install from the OS have SELinux labels set for correct operation, and sometimes have booleans you need to enable to allow more advanced use. Anything you install yourself (e.g. tarballs) are completely unrestricted. It sounds like you need to get a better understanding of where the lines are.</div><br/></div></div></div></div><div id="41950765" class="c"><input type="checkbox" id="c-41950765" checked=""/><div class="controls bullet"><span class="by">iluvcommunism</span><span>|</span><a href="#41949807">prev</a><span>|</span><a href="#41951788">next</a><span>|</span><label class="collapse" for="c-41950765">[-]</label><label class="expand" for="c-41950765">[4 more]</label></div><br/><div class="children"><div class="content">Iâve had that POS SELinux block me from logging directly into the console with root (nothing wrong with the pwd). Thank VMware for snapshots. I hate SELinux. 
But the job requires it. 
As for people who seem to love it so much, they probably donât have to deal with it all the time.</div><br/><div id="41951176" class="c"><input type="checkbox" id="c-41951176" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41950765">parent</a><span>|</span><a href="#41951788">next</a><span>|</span><label class="collapse" for="c-41951176">[-]</label><label class="expand" for="c-41951176">[3 more]</label></div><br/><div class="children"><div class="content">&gt; As for people who seem to love it so much, they probably donât have to deal with it all the time.<p>Or they put in the time to learn it so they don&#x27;t get frustrated when they get blocked by something, because they know how to resolve it.</div><br/><div id="41951250" class="c"><input type="checkbox" id="c-41951250" checked=""/><div class="controls bullet"><span class="by">hooverd</span><span>|</span><a href="#41950765">root</a><span>|</span><a href="#41951176">parent</a><span>|</span><a href="#41951788">next</a><span>|</span><label class="collapse" for="c-41951250">[-]</label><label class="expand" for="c-41951250">[2 more]</label></div><br/><div class="children"><div class="content">I wish I had the hours to dedicate to every single technology I&#x27;m using, but alas...</div><br/><div id="41952924" class="c"><input type="checkbox" id="c-41952924" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41950765">root</a><span>|</span><a href="#41951250">parent</a><span>|</span><a href="#41951788">next</a><span>|</span><label class="collapse" for="c-41952924">[-]</label><label class="expand" for="c-41952924">[1 more]</label></div><br/><div class="children"><div class="content">This is one of those technologies that people shouldn&#x27;t be using if they didn&#x27;t take the time to learn it.<p>It&#x27;s not like say, nginx or a linux distro, where you don&#x27;t need to know the ins and outs to get it up and running.</div><br/></div></div></div></div></div></div></div></div><div id="41951788" class="c"><input type="checkbox" id="c-41951788" checked=""/><div class="controls bullet"><span class="by">AlienRobot</span><span>|</span><a href="#41950765">prev</a><span>|</span><a href="#41952197">next</a><span>|</span><label class="collapse" for="c-41951788">[-]</label><label class="expand" for="c-41951788">[4 more]</label></div><br/><div class="children"><div class="content">When I used Fedora for desktop, VS Code triggered warnings because of a SELinux configuration. Something about using writable memory as executable.<p>The discussion on the topic was disappointing. Chrome does this, all Electron apps do this, VS Code does it. It was insisted that the warnings were fine because this is insecure and the developers should just fix their applications.<p>I do not have the patience to waste two hours researching every single complicated solution that every single application uses to make things work just to personally decide whether it&#x27;s safe enough to whitelist it.<p>Long story short I&#x27;m using Mint now.</div><br/><div id="41952240" class="c"><input type="checkbox" id="c-41952240" checked=""/><div class="controls bullet"><span class="by">Vilian</span><span>|</span><a href="#41951788">parent</a><span>|</span><a href="#41952197">next</a><span>|</span><label class="collapse" for="c-41952240">[-]</label><label class="expand" for="c-41952240">[3 more]</label></div><br/><div class="children"><div class="content">All of that, because of some warnings? And now you&#x27;re happy because you don&#x27;t see the warnings so you have the false sensation of security</div><br/><div id="41953068" class="c"><input type="checkbox" id="c-41953068" checked=""/><div class="controls bullet"><span class="by">josefx</span><span>|</span><a href="#41951788">root</a><span>|</span><a href="#41952240">parent</a><span>|</span><a href="#41952466">next</a><span>|</span><label class="collapse" for="c-41953068">[-]</label><label class="expand" for="c-41953068">[1 more]</label></div><br/><div class="children"><div class="content">Pointless warning spam drowns out real issues in the logs all the time. You cannot expect an end user to fix chromium based applications or stop using them, so all you end up doing is making the system less usable and less secure.</div><br/></div></div><div id="41952466" class="c"><input type="checkbox" id="c-41952466" checked=""/><div class="controls bullet"><span class="by">worthless-trash</span><span>|</span><a href="#41951788">root</a><span>|</span><a href="#41952240">parent</a><span>|</span><a href="#41953068">prev</a><span>|</span><a href="#41952197">next</a><span>|</span><label class="collapse" for="c-41952466">[-]</label><label class="expand" for="c-41952466">[1 more]</label></div><br/><div class="children"><div class="content">This is the modern world we  live in.  Decisions like this drive life.</div><br/></div></div></div></div></div></div><div id="41952197" class="c"><input type="checkbox" id="c-41952197" checked=""/><div class="controls bullet"><span class="by">Whatarethese</span><span>|</span><a href="#41951788">prev</a><span>|</span><a href="#41950084">next</a><span>|</span><label class="collapse" for="c-41952197">[-]</label><label class="expand" for="c-41952197">[1 more]</label></div><br/><div class="children"><div class="content">The amount of times I&#x27;ve seen setenforce 1 is ridiculous, but not suprised.</div><br/></div></div><div id="41950084" class="c"><input type="checkbox" id="c-41950084" checked=""/><div class="controls bullet"><span class="by">gnuser</span><span>|</span><a href="#41952197">prev</a><span>|</span><label class="collapse" for="c-41950084">[-]</label><label class="expand" for="c-41950084">[2 more]</label></div><br/><div class="children"><div class="content">GRSec is better imho
but Iâve never convinced anybody to put it in prod so meh</div><br/><div id="41950122" class="c"><input type="checkbox" id="c-41950122" checked=""/><div class="controls bullet"><span class="by">voxadam</span><span>|</span><a href="#41950084">parent</a><span>|</span><label class="collapse" for="c-41950122">[-]</label><label class="expand" for="c-41950122">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve never used Grsecurity but I seem to remember that the devs didn&#x27;t play too well with mainline kernel devs.[0]<p>[0] <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;721848&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;721848&#x2F;</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>