<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730970052096" as="style"/><link rel="stylesheet" href="styles.css?v=1730970052096"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://xy2i.blogspot.com/2024/11/using-imhexs-pattern-language-to-parse.html">Visualizing binary files with ImHex&#x27;s DSL, the &quot;pattern language&quot;</a> <span class="domain">(<a href="https://xy2i.blogspot.com">xy2i.blogspot.com</a>)</span></div><div class="subtext"><span>xy2_</span> | <span>8 comments</span></div><br/><div><div id="42073529" class="c"><input type="checkbox" id="c-42073529" checked=""/><div class="controls bullet"><span class="by">genewitch</span><span>|</span><a href="#42073770">next</a><span>|</span><label class="collapse" for="c-42073529">[-]</label><label class="expand" for="c-42073529">[1 more]</label></div><br/><div class="children"><div class="content">I have a strong memory that AFL - american fuzzy lop the binary fuzzer had a feature similar to what this was doing based on the highlighted portions and screenshots. It wasn&#x27;t the AFL status screen, it was (may have been a) third party app, and it would color code parts of the input files based on the outputs or whatever from afl&#x27;s processing.<p>For example, there was a color key that explained that say, purple meant &quot;magic bytes&quot;, like &quot;0x4a46494600&quot; for JFIF0, and if any part of the input file caused errors it meant it was probably a checksum and needed to be &quot;fixed&quot; so afl could properly fuzz all the functions in the source code.<p>I&#x27;m not super in to fuzzing or that realm anymore, so i doubt i could describe it better than i did, here. I clicked through to see if someone have leveraged the AFL stuff for use in another tool, which would be cool.<p>edit: i think it was afl-analyze - i had a go at the source code for aflplusplus:<p>&gt;  A nifty utility that grabs an input file and takes a stab at explaining its structure by observing how changes to it affect the execution path.<p>&gt; Another tool in AFL++ is the afl-analyze tool. It takes an input file, attempts to sequentially flip bytes and observes the behavior of the tested program. It then color-codes the input based on which sections appear to be critical and which are not; while not bulletproof, it can often offer quick insights into complex file formats.</div><br/></div></div><div id="42073770" class="c"><input type="checkbox" id="c-42073770" checked=""/><div class="controls bullet"><span class="by">dloss</span><span>|</span><a href="#42073529">prev</a><span>|</span><a href="#42071808">next</a><span>|</span><label class="collapse" for="c-42073770">[-]</label><label class="expand" for="c-42073770">[1 more]</label></div><br/><div class="children"><div class="content">Other tools for parsing and analyzing binary data are listed here: <a href="https:&#x2F;&#x2F;github.com&#x2F;dloss&#x2F;binary-parsing">https:&#x2F;&#x2F;github.com&#x2F;dloss&#x2F;binary-parsing</a></div><br/></div></div><div id="42071808" class="c"><input type="checkbox" id="c-42071808" checked=""/><div class="controls bullet"><span class="by">jcul</span><span>|</span><a href="#42073770">prev</a><span>|</span><a href="#42073856">next</a><span>|</span><label class="collapse" for="c-42071808">[-]</label><label class="expand" for="c-42071808">[2 more]</label></div><br/><div class="children"><div class="content">Great write up!<p>I looked at ImHex a good while back and I think I had some runtime issues or maybe even compilation issues and didn&#x27;t dig deeper. Even though the definition language piqued my curiosity.<p>These days I tend to just use xxd, bless, ghex, or seldom wxHexEditor, depending on what I need. But ImHex looks really powerful, like it could replace all the GUI ones.
I&#x27;m looking forward to giving it another go tomorrow.<p>Though these days I spend most of my time in wireshark, which is kind of a hex viewer in a way.<p>How does it manage with huge files? Does it try to load the entire thing into memory.
I remember wxHexEditor being good for that, and even being able to open block devices directly and process memory IIRC. Might be getting mixed up with HxD.<p>The decompression and combining compressed with decompressed sections looks very cool. Is the decompression in memory or written to disk?<p>&#x2F;&#x2F; TagRecord Tags[while(!std::mem::eof())];<p>This loop based length stuff is very cool too, though for large files I&#x27;d imagine it could be slow as it will need to iterate through all records to determine the offset for records at the end of the file.<p>To be fair, wireshark &#x2F; pcap files have this problem too.</div><br/><div id="42072609" class="c"><input type="checkbox" id="c-42072609" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#42071808">parent</a><span>|</span><a href="#42073856">next</a><span>|</span><label class="collapse" for="c-42072609">[-]</label><label class="expand" for="c-42072609">[1 more]</label></div><br/><div class="children"><div class="content">&gt; though for large files I&#x27;d imagine it could be slow as it will need to iterate through all records to determine the offset for records at the end of the file.<p>Yeah, it&#x27;s not doing lazy evaluation, so you need to watch out. It&#x27;s probably not the solution you want for (for example) looking at 500GB disk images.</div><br/></div></div></div></div><div id="42073856" class="c"><input type="checkbox" id="c-42073856" checked=""/><div class="controls bullet"><span class="by">rixtox</span><span>|</span><a href="#42071808">prev</a><span>|</span><a href="#42071640">next</a><span>|</span><label class="collapse" for="c-42073856">[-]</label><label class="expand" for="c-42073856">[1 more]</label></div><br/><div class="children"><div class="content">Kind of related, a tool that allows you to hand write ASCII-art-annotated hex dump files, while also able to generate the original binary file from such text file: <a href="https:&#x2F;&#x2F;github.com&#x2F;netspooky&#x2F;xx&#x2F;blob&#x2F;main&#x2F;examples&#x2F;elf.xx">https:&#x2F;&#x2F;github.com&#x2F;netspooky&#x2F;xx&#x2F;blob&#x2F;main&#x2F;examples&#x2F;elf.xx</a></div><br/></div></div><div id="42071640" class="c"><input type="checkbox" id="c-42071640" checked=""/><div class="controls bullet"><span class="by">octagons</span><span>|</span><a href="#42073856">prev</a><span>|</span><a href="#42071921">next</a><span>|</span><label class="collapse" for="c-42071640">[-]</label><label class="expand" for="c-42071640">[1 more]</label></div><br/><div class="children"><div class="content">I wasn’t aware that ImHex had this feature - perhaps I’ll try it!<p>I’ve been singing the praises of 010 Editor for years specifically because of its template and scripting features, the former of which is nearly identical to this DSL.</div><br/></div></div><div id="42071921" class="c"><input type="checkbox" id="c-42071921" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#42071640">prev</a><span>|</span><label class="collapse" for="c-42071921">[-]</label><label class="expand" for="c-42071921">[1 more]</label></div><br/><div class="children"><div class="content">Looks slightly more expressive than Kaitai&#x27;s binary format DSL.</div><br/></div></div></div></div></div></div></div></body></html>