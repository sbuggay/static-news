<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1726045273281" as="style"/><link rel="stylesheet" href="styles.css?v=1726045273281"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://tmendez.dev/posts/rng-git-hash-bug/">Our Git Hash Bug</a>Â <span class="domain">(<a href="https://tmendez.dev">tmendez.dev</a>)</span></div><div class="subtext"><span>robin_reala</span> | <span>85 comments</span></div><br/><div><div id="41509141" class="c"><input type="checkbox" id="c-41509141" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#41500143">next</a><span>|</span><label class="collapse" for="c-41509141">[-]</label><label class="expand" for="c-41509141">[1 more]</label></div><br/><div class="children"><div class="content">Yaml should be used as a lesson learned, not sure why people still use it as a data format. You should stop even tolerating it, refuse on sight.</div><br/></div></div><div id="41500143" class="c"><input type="checkbox" id="c-41500143" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#41509141">prev</a><span>|</span><a href="#41508424">next</a><span>|</span><label class="collapse" for="c-41500143">[-]</label><label class="expand" for="c-41500143">[28 more]</label></div><br/><div class="children"><div class="content">YAML Norway problem strikes again!<p>I wish YAML wasn&#x27;t so common in Python ecosystem...</div><br/><div id="41501552" class="c"><input type="checkbox" id="c-41501552" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41500143">parent</a><span>|</span><a href="#41501593">next</a><span>|</span><label class="collapse" for="c-41501552">[-]</label><label class="expand" for="c-41501552">[17 more]</label></div><br/><div class="children"><div class="content">What&#x27;s a better alternative? This problem is annoying but to me not more annoying than having to read or write JSON, and TOML is terrible with nested configs. If there were an option with the structure of YAML minus the ridiculous string handling I&#x27;d switch to it for sure.</div><br/><div id="41504073" class="c"><input type="checkbox" id="c-41504073" checked=""/><div class="controls bullet"><span class="by">RadiozRadioz</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41501724">next</a><span>|</span><label class="collapse" for="c-41504073">[-]</label><label class="expand" for="c-41504073">[6 more]</label></div><br/><div class="children"><div class="content">Looked at the sibling comments. Has everybody collectively forgotten that XML exists? This stuff was solved decades ago, XSDs can check types.<p>TOML nesting is indeed a joke. YAML &amp; JSON &quot;look clean&quot;, but try to match up nesting in a large document without help from text editor highlights, then see how easy it is in XML.<p>XML has universal support everywhere, has first-class tooling for everything that&#x27;s being re-invented in these other languages, but it&#x27;s not &quot;cool&quot; any more.</div><br/><div id="41505879" class="c"><input type="checkbox" id="c-41505879" checked=""/><div class="controls bullet"><span class="by">steelbrain</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41504073">parent</a><span>|</span><a href="#41505883">next</a><span>|</span><label class="collapse" for="c-41505879">[-]</label><label class="expand" for="c-41505879">[2 more]</label></div><br/><div class="children"><div class="content">Maybe you have worked with a different XML than I but I have only terrible memories of working with XML. Starting from the parser inconsistencies (that even led to security vulnerabilities in Apple, see <a href="https:&#x2F;&#x2F;blog.siguza.net&#x2F;psychicpaper&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.siguza.net&#x2F;psychicpaper&#x2F;</a>).<p>On a higher level, the fact that so much different kind of information could exist at each level was nothing but headaches. In YAML, or in JSON, it&#x27;s pretty straight forward. You have an object, it has children, children have types&#x2F;values etc.<p>In XML, you have to keep in mind what the tag of the element, what its attributes are, and then what the child elements are, and then whatever the heck CDATA is.<p>I think my fellow posters are looking at the past through nostalgic rose tinted glasses. XML was terrible and I am glad it&#x27;s not used as widely anymore.</div><br/><div id="41508544" class="c"><input type="checkbox" id="c-41508544" checked=""/><div class="controls bullet"><span class="by">kdjdjsj</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41505879">parent</a><span>|</span><a href="#41505883">next</a><span>|</span><label class="collapse" for="c-41508544">[-]</label><label class="expand" for="c-41508544">[1 more]</label></div><br/><div class="children"><div class="content">I too really don&#x27;t get the hate for XML<p>Features like schema feel very natural in XML whereas JSON schema feels outer worldly; and is seldomly used<p>Being able to clearly distinguish between multiple semantically different types of strings is a blessing<p>And coming back to your example, how is the knowledge in JSON of which attribute is an array, which is an object, which is a string and when order of attributes as well as duplicates matter and when not any easier than XML?</div><br/></div></div></div></div><div id="41505883" class="c"><input type="checkbox" id="c-41505883" checked=""/><div class="controls bullet"><span class="by">indrora</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41504073">parent</a><span>|</span><a href="#41505879">prev</a><span>|</span><a href="#41506947">next</a><span>|</span><label class="collapse" for="c-41505883">[-]</label><label class="expand" for="c-41505883">[1 more]</label></div><br/><div class="children"><div class="content">As someone who previously worked in an XML-heavy environment, I would rather have an NFL linebacker dropkick me in the head than deal with XML again. Tim Bray himself has had doubts [1] at one point.<p>XML is too big of a hammer for the space it fills.<p>[1] <a href="https:&#x2F;&#x2F;www.tbray.org&#x2F;ongoing&#x2F;When&#x2F;200x&#x2F;2003&#x2F;03&#x2F;16&#x2F;XML-Prog" rel="nofollow">https:&#x2F;&#x2F;www.tbray.org&#x2F;ongoing&#x2F;When&#x2F;200x&#x2F;2003&#x2F;03&#x2F;16&#x2F;XML-Prog</a></div><br/></div></div><div id="41506947" class="c"><input type="checkbox" id="c-41506947" checked=""/><div class="controls bullet"><span class="by">some_random</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41504073">parent</a><span>|</span><a href="#41505883">prev</a><span>|</span><a href="#41501724">next</a><span>|</span><label class="collapse" for="c-41506947">[-]</label><label class="expand" for="c-41506947">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not &quot;cool&quot; anymore because it&#x27;s painful to work with despite all the tooling and support</div><br/><div id="41508438" class="c"><input type="checkbox" id="c-41508438" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41506947">parent</a><span>|</span><a href="#41501724">next</a><span>|</span><label class="collapse" for="c-41508438">[-]</label><label class="expand" for="c-41508438">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>It&#x27;s not &quot;cool&quot; anymore because it&#x27;s painful to work with</i><p>That&#x27;s kinda weird way to phrase it; being painful to work with has nothing to do with &quot;coolness&quot;... that&#x27;s a legitimate complaint.<p>Despite all the tooling and support, XML <i>is</i> painful to work with.</div><br/></div></div></div></div></div></div><div id="41501724" class="c"><input type="checkbox" id="c-41501724" checked=""/><div class="controls bullet"><span class="by">crdrost</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41504073">prev</a><span>|</span><a href="#41508097">next</a><span>|</span><label class="collapse" for="c-41501724">[-]</label><label class="expand" for="c-41501724">[3 more]</label></div><br/><div class="children"><div class="content">Pkl (from Apple land) and Dhall (from Haskell land) both solve some of these pain points as well as some others, especially being more seamless about integrating schema with config.<p>Jsonnet, I haven&#x27;t used personally but I know people who have raved about it.<p>Ones I know less about include KCL, CUE, and Nickel.</div><br/><div id="41502861" class="c"><input type="checkbox" id="c-41502861" checked=""/><div class="controls bullet"><span class="by">zamalek</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501724">parent</a><span>|</span><a href="#41501809">next</a><span>|</span><label class="collapse" for="c-41502861">[-]</label><label class="expand" for="c-41502861">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t believe that executable configuration languages are a good fit at a primary configuration source, I would prefer to have them spit out static config before use. From your list KCL fits that bill (and is a really nice config language).</div><br/></div></div><div id="41501809" class="c"><input type="checkbox" id="c-41501809" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501724">parent</a><span>|</span><a href="#41502861">prev</a><span>|</span><a href="#41508097">next</a><span>|</span><label class="collapse" for="c-41501809">[-]</label><label class="expand" for="c-41501809">[1 more]</label></div><br/><div class="children"><div class="content">I liked what I saw of Pkl, wanted to use it when it was released but it seemed the only parser was JVM-based and it was intended more to be transpiled into other config languages. If that&#x27;s changing definitely worth revisiting it. Dhall I had to look up, it seems nice as long as the formatting used on website examples is not enforced, because to me that looks like an absolute nightmare but my problems are with the whitespace and not the structure itself.</div><br/></div></div></div></div><div id="41508097" class="c"><input type="checkbox" id="c-41508097" checked=""/><div class="controls bullet"><span class="by">bobbylarrybobby</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41501724">prev</a><span>|</span><a href="#41508075">next</a><span>|</span><label class="collapse" for="c-41508097">[-]</label><label class="expand" for="c-41508097">[1 more]</label></div><br/><div class="children"><div class="content">Json5 is fine. Of the boring config options, it&#x27;s the best.</div><br/></div></div><div id="41508075" class="c"><input type="checkbox" id="c-41508075" checked=""/><div class="controls bullet"><span class="by">eitland</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41508097">prev</a><span>|</span><a href="#41503687">next</a><span>|</span><label class="collapse" for="c-41508075">[-]</label><label class="expand" for="c-41508075">[1 more]</label></div><br/><div class="children"><div class="content">The better alternative to yaml are json (particularly json with comments), properties files and xml files.<p>Basically any mainstream configuration syntax.<p>The really big problem with xml wasn&#x27;t actually the verbosity of xml itself but the fact that it was popular in a time before rails popularized &quot;convention over configuration&quot;&#x27;</div><br/></div></div><div id="41503687" class="c"><input type="checkbox" id="c-41503687" checked=""/><div class="controls bullet"><span class="by">steelbrain</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41508075">prev</a><span>|</span><a href="#41507923">next</a><span>|</span><label class="collapse" for="c-41503687">[-]</label><label class="expand" for="c-41503687">[2 more]</label></div><br/><div class="children"><div class="content">JSONC. <a href="https:&#x2F;&#x2F;onury.io&#x2F;jsonc&#x2F;" rel="nofollow">https:&#x2F;&#x2F;onury.io&#x2F;jsonc&#x2F;</a><p>It can be hard to find an implementation of this if you&#x27;re working in a not-so-popular language (looking at you Swift) but JSONC has had the best developer experience of anything I&#x27;ve tried so far.<p>It&#x27;s basically JSON with single and multi line comments and trailing commas.</div><br/><div id="41507551" class="c"><input type="checkbox" id="c-41507551" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41503687">parent</a><span>|</span><a href="#41507923">next</a><span>|</span><label class="collapse" for="c-41507551">[-]</label><label class="expand" for="c-41507551">[1 more]</label></div><br/><div class="children"><div class="content">JSON5 has a heck of a lot broader support AFAICT.  It&#x27;s basically JavaScript&#x27;s notation: <a href="https:&#x2F;&#x2F;json5.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;json5.org&#x2F;</a></div><br/></div></div></div></div><div id="41507923" class="c"><input type="checkbox" id="c-41507923" checked=""/><div class="controls bullet"><span class="by">ruuda</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41503687">prev</a><span>|</span><a href="#41508030">next</a><span>|</span><label class="collapse" for="c-41507923">[-]</label><label class="expand" for="c-41507923">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;rcl-lang.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;rcl-lang.org&#x2F;</a></div><br/><div id="41508016" class="c"><input type="checkbox" id="c-41508016" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41507923">parent</a><span>|</span><a href="#41508030">next</a><span>|</span><label class="collapse" for="c-41508016">[-]</label><label class="expand" for="c-41508016">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not a fan of that import function.</div><br/></div></div></div></div><div id="41508030" class="c"><input type="checkbox" id="c-41508030" checked=""/><div class="controls bullet"><span class="by">imajoredinecon</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501552">parent</a><span>|</span><a href="#41507923">prev</a><span>|</span><a href="#41501593">next</a><span>|</span><label class="collapse" for="c-41508030">[-]</label><label class="expand" for="c-41508030">[1 more]</label></div><br/><div class="children"><div class="content">Protobuf&#x2F;thrift?</div><br/></div></div></div></div><div id="41501593" class="c"><input type="checkbox" id="c-41501593" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#41500143">parent</a><span>|</span><a href="#41501552">prev</a><span>|</span><a href="#41501411">next</a><span>|</span><label class="collapse" for="c-41501593">[-]</label><label class="expand" for="c-41501593">[7 more]</label></div><br/><div class="children"><div class="content">Solution: quote values. Like in JSON.</div><br/><div id="41505522" class="c"><input type="checkbox" id="c-41505522" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501593">parent</a><span>|</span><a href="#41501411">next</a><span>|</span><label class="collapse" for="c-41505522">[-]</label><label class="expand" for="c-41505522">[6 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not really a solution though because you only notice you need to do it after it triggers a bug.<p>You need a format that doesn&#x27;t let you make this mistake in the first place, like [everything except YAML].</div><br/><div id="41508010" class="c"><input type="checkbox" id="c-41508010" checked=""/><div class="controls bullet"><span class="by">Too</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41505522">parent</a><span>|</span><a href="#41508557">next</a><span>|</span><label class="collapse" for="c-41508010">[-]</label><label class="expand" for="c-41508010">[3 more]</label></div><br/><div class="children"><div class="content">If the yaml is generated by code it should be quoted automatically, given that you have a sane yaml library.<p>try this:<p><pre><code>    yaml.dump({&quot;gameServerVersion&quot;: &quot;556474378&quot;}, sys.stdout)
</code></pre>
It will correctly print the quoted version<p><pre><code>    gameServerVersion: &#x27;556474378&#x27;
</code></pre>
At least with Python, strings are strings and there is a minimal risk you store a git hash coming from the output of a git subprocess command as a number. The only way this bug could have happened is if doing manual string templating. If you were doing that, equally or worse kind of bugs are waiting for you in any serialization format.</div><br/><div id="41508450" class="c"><input type="checkbox" id="c-41508450" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41508010">parent</a><span>|</span><a href="#41508557">next</a><span>|</span><label class="collapse" for="c-41508450">[-]</label><label class="expand" for="c-41508450">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The only way this bug could have happened is if doing manual string templating.<p>I agree you should not do that, but it is common in the YAML world - if you&#x27;re using YAML you&#x27;ve already decided you don&#x27;t care if things are reliable.<p>Given that they were using string templating, this would have been caught earlier using a different format.<p>Of course there are other string templating mistakes that other formats would not catch (e.g. forgetting to escape strings), but they are still better than YAML.</div><br/><div id="41508524" class="c"><input type="checkbox" id="c-41508524" checked=""/><div class="controls bullet"><span class="by">kdjdjsj</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41508450">parent</a><span>|</span><a href="#41508557">next</a><span>|</span><label class="collapse" for="c-41508524">[-]</label><label class="expand" for="c-41508524">[1 more]</label></div><br/><div class="children"><div class="content">The problem obviously is using string templating without proper escaping<p>Any format would fail if used like that, be it YAML, JSON, XML...</div><br/></div></div></div></div></div></div><div id="41508557" class="c"><input type="checkbox" id="c-41508557" checked=""/><div class="controls bullet"><span class="by">dijksterhuis</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41505522">parent</a><span>|</span><a href="#41508010">prev</a><span>|</span><a href="#41501411">next</a><span>|</span><label class="collapse" for="c-41508557">[-]</label><label class="expand" for="c-41508557">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s not really a solution though because you only notice you need to do it after it triggers a bug.<p>â¦ the first couple of times.<p>After causing the same bug multiple times its the user at fault, not the tool.<p>YAML does a <i>decent enough</i> job.<p>I think these are the relevant YAML spec sections from a quick glance. If someone wants to correct me, feel free.<p>YAML spec on double quotes<p>&gt; The double-quoted style is specified by surrounding â&quot;â indicators. This is the only style capable of expressing arbitrary strings, by using â\â escape sequences. This comes at the cost of having to escape the â\â and â&quot;â characters.<p>YAML spec on plain style<p>&gt; The plain (unquoted) style has no identifying indicators and provides no form of escaping. It is therefore the most readable, most limited and most context sensitive style. In addition to a restricted character set, a plain scalar must not be empty or contain leading or trailing white space characters.</div><br/><div id="41509164" class="c"><input type="checkbox" id="c-41509164" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41508557">parent</a><span>|</span><a href="#41501411">next</a><span>|</span><label class="collapse" for="c-41509164">[-]</label><label class="expand" for="c-41509164">[1 more]</label></div><br/><div class="children"><div class="content"><i>the first couple of times</i><p>Times every yaml user in the multiverse.</div><br/></div></div></div></div></div></div></div></div><div id="41501411" class="c"><input type="checkbox" id="c-41501411" checked=""/><div class="controls bullet"><span class="by">codesnik</span><span>|</span><a href="#41500143">parent</a><span>|</span><a href="#41501593">prev</a><span>|</span><a href="#41500534">next</a><span>|</span><label class="collapse" for="c-41501411">[-]</label><label class="expand" for="c-41501411">[2 more]</label></div><br/><div class="children"><div class="content">YAML is alright when you create it by hand. Problems start when YAML is templated, and frankly it&#x27;s just dumb, though common. Templating the source without proper escaping could bite even with JSON.</div><br/><div id="41502103" class="c"><input type="checkbox" id="c-41502103" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41500143">root</a><span>|</span><a href="#41501411">parent</a><span>|</span><a href="#41500534">next</a><span>|</span><label class="collapse" for="c-41502103">[-]</label><label class="expand" for="c-41502103">[1 more]</label></div><br/><div class="children"><div class="content">My last big enterprise job, we did a lot of YAML templating and of course ran into issues like this all the time, eventually though we solved it by requiring defined schemas for all configs and validating those schemas in our pipeline. More overhead but that validation also caught lots of issues aside from the YAML gotchas, it was a decent setup to work with in the end.</div><br/></div></div></div></div><div id="41500534" class="c"><input type="checkbox" id="c-41500534" checked=""/><div class="controls bullet"><span class="by">secondcoming</span><span>|</span><a href="#41500143">parent</a><span>|</span><a href="#41501411">prev</a><span>|</span><a href="#41508424">next</a><span>|</span><label class="collapse" for="c-41500534">[-]</label><label class="expand" for="c-41500534">[1 more]</label></div><br/><div class="children"><div class="content">or anywhere</div><br/></div></div></div></div><div id="41508424" class="c"><input type="checkbox" id="c-41508424" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#41500143">prev</a><span>|</span><a href="#41507276">next</a><span>|</span><label class="collapse" for="c-41508424">[-]</label><label class="expand" for="c-41508424">[1 more]</label></div><br/><div class="children"><div class="content">As soon as I saw the YAML one-line snippet I knew it was a quoting issue.<p>My first thought was that git hash started with a zero, and the parser stripped it off because it was parsing it as a number and not a string.<p>But then I saw &quot;infinity&quot; and was like &quot;wait is the git hash all numbers except there&#x27;s the letter &#x27;e&#x27; in there somewhere&quot;?<p>Ugh.<p>Always quote your YAML strings!<p>I just wrote a configuration format writer for an app I maintain,  The C libyaml library (ugh, yes, I have to write this in C) lets you specify the quoting style it will emit for strings... always choose some form of quoting.... always.<p>Also it seems kinda short-sighted for this company to use the short git hash.  The short hash is nice for display purposes, but there&#x27;s always the possibility of a collision (git is smart and will print out a revision that has no <i>current</i> collisions within your repo, but that doesn&#x27;t mean it won&#x27;t happen in the future).  But for a configuration setting like that, there&#x27;s really no reason not to use the full hash.</div><br/></div></div><div id="41507276" class="c"><input type="checkbox" id="c-41507276" checked=""/><div class="controls bullet"><span class="by">js2</span><span>|</span><a href="#41508424">prev</a><span>|</span><a href="#41501637">next</a><span>|</span><label class="collapse" for="c-41507276">[-]</label><label class="expand" for="c-41507276">[4 more]</label></div><br/><div class="children"><div class="content">So, yes, YAML&#x27;s implicit typing is a landmine.<p>However, this could&#x27;ve been caught by a validator. Whatever is loading this config file should know that `gameServerVersion` is a string and when it got a number, it should&#x27;ve thrown an error. It could also further validate that it gets a hex string lest something feed it &quot;Infinity&quot;.</div><br/><div id="41507788" class="c"><input type="checkbox" id="c-41507788" checked=""/><div class="controls bullet"><span class="by">henry700</span><span>|</span><a href="#41507276">parent</a><span>|</span><a href="#41507896">next</a><span>|</span><label class="collapse" for="c-41507788">[-]</label><label class="expand" for="c-41507788">[2 more]</label></div><br/><div class="children"><div class="content">A number is also a string. Crazy, right?</div><br/><div id="41508243" class="c"><input type="checkbox" id="c-41508243" checked=""/><div class="controls bullet"><span class="by">js2</span><span>|</span><a href="#41507276">root</a><span>|</span><a href="#41507788">parent</a><span>|</span><a href="#41507896">next</a><span>|</span><label class="collapse" for="c-41508243">[-]</label><label class="expand" for="c-41508243">[1 more]</label></div><br/><div class="children"><div class="content">The following code will only validate when gameServerVersion is a hex string between 9 and 32 characters:<p><pre><code>  #!&#x2F;usr&#x2F;bin&#x2F;env python
  import sys
  import re
  from typing import Annotated
  from pydantic import BaseModel, AfterValidator, validator
  from pydantic_yaml import parse_yaml_raw_as
  
  
  def validate_commit_id(s: str) -&gt; str:
    assert re.search(r&quot;^[0-9a-f]{9,32}$&quot;, s), f&quot;{s} is not a commit id&quot;
    return s
  
  
  CommitId = Annotated[str, AfterValidator(validate_commit_id)]
  
  
  class Model(BaseModel):
    gameServerVersion: CommitId
  
  
  def main():
    text = sys.stdin.read()
    conf = parse_yaml_raw_as(Model, text)
    print(conf)
  
  
  if __name__ == &quot;__main__&quot;:
    main()
    
</code></pre>
It would have prevented the Git Hash Bug originally described:<p><pre><code>  $ cat conf.yaml
  gameServerVersion: 556474e378
  $ python parse.py &lt; conf.yaml
  pydantic_core._pydantic_core.ValidationError: 1 validation error for Model
  gameServerVersion
    Input should be a valid string [type=string_type, input_value=inf, input_type=float]
  
  $ cat conf.yaml
  gameServerVersion: &quot;556474e378&quot;
  $ python parse.py &lt; conf.yaml
  gameServerVersion=&#x27;556474e378&#x27;
  
  $ cat conf.yaml
  gameServerVersion: &quot;Infinity&quot;
  $ python parse.py &lt; conf.yaml
  pydantic_core._pydantic_core.ValidationError: 1 validation error for Model
  gameServerVersion
    Assertion failed, Infinity is not a commit id [type=assertion_error, input_value=&#x27;Infinity&#x27;, input_type=str]

</code></pre>
It&#x27;s just good practice to validate things on the way in. Even if they were using JSON as their config file, they should still validate it.</div><br/></div></div></div></div><div id="41507896" class="c"><input type="checkbox" id="c-41507896" checked=""/><div class="controls bullet"><span class="by">cratermoon</span><span>|</span><a href="#41507276">parent</a><span>|</span><a href="#41507788">prev</a><span>|</span><a href="#41501637">next</a><span>|</span><label class="collapse" for="c-41507896">[-]</label><label class="expand" for="c-41507896">[1 more]</label></div><br/><div class="children"><div class="content">Good thing this wasn&#x27;t a kernel-mode driver for an anti-virus program.</div><br/></div></div></div></div><div id="41501637" class="c"><input type="checkbox" id="c-41501637" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#41507276">prev</a><span>|</span><a href="#41507695">next</a><span>|</span><label class="collapse" for="c-41501637">[-]</label><label class="expand" for="c-41501637">[1 more]</label></div><br/><div class="children"><div class="content">We had a similar problem in Python with float().<p>We have a logfile parser that tries to parse a value and fell back to float().<p>But if you passed it a hex value that happened to only have decimals and &#x27;e&#x27;, then Python interpreted it a an exponentiated number, which happened to be larger than what it could natively represent, so returned `Infinity` !<p>Obviously the bug was on our end with the naive `float()`, which after deliberation should not be used in this generic parser case, but it was interesting tracking down this bug from the DB values all the way up to the parser.</div><br/></div></div><div id="41507695" class="c"><input type="checkbox" id="c-41507695" checked=""/><div class="controls bullet"><span class="by">plasticeagle</span><span>|</span><a href="#41501637">prev</a><span>|</span><a href="#41501737">next</a><span>|</span><label class="collapse" for="c-41507695">[-]</label><label class="expand" for="c-41507695">[6 more]</label></div><br/><div class="children"><div class="content">Always use the full hash everywhere.<p>Never store the short hash anywhere. It&#x27;s good only for immediate commandline use, and nothing else.</div><br/><div id="41507758" class="c"><input type="checkbox" id="c-41507758" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#41507695">parent</a><span>|</span><a href="#41501737">next</a><span>|</span><label class="collapse" for="c-41507758">[-]</label><label class="expand" for="c-41507758">[5 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t really solve the underlying issue, though.</div><br/><div id="41507807" class="c"><input type="checkbox" id="c-41507807" checked=""/><div class="controls bullet"><span class="by">augusto-moura</span><span>|</span><a href="#41507695">root</a><span>|</span><a href="#41507758">parent</a><span>|</span><a href="#41507818">next</a><span>|</span><label class="collapse" for="c-41507807">[-]</label><label class="expand" for="c-41507807">[3 more]</label></div><br/><div class="children"><div class="content">Not technically, but pratically yes. The chance of having a single letter &quot;e&quot; and everything else a number would be very rare for a full SHA1 hash. I&#x27;m not interested in doing the calculations but if anyone wants to do it, it sounds like a cool math problem to solve</div><br/><div id="41508048" class="c"><input type="checkbox" id="c-41508048" checked=""/><div class="controls bullet"><span class="by">Sophira</span><span>|</span><a href="#41507695">root</a><span>|</span><a href="#41507807">parent</a><span>|</span><a href="#41508119">next</a><span>|</span><label class="collapse" for="c-41508048">[-]</label><label class="expand" for="c-41508048">[1 more]</label></div><br/><div class="children"><div class="content">While I haven&#x27;t done the math, you&#x27;re right that it would need to be an exponential of some kind (assuming this is JavaScript-based).<p>In JavaScript, Number.MAX_VALUE (the biggest number that can be represented without returning Infinity) is a 309-digit number, and Git SHA-1 hashes are only 40 characters long.<p>However, this <i>does</i> mean that the chance will be even smaller than you say. Assuming that all other conditions are met (sole &quot;e&quot;, every other character is a digit)<p>* if the sole &quot;e&quot; is in any place from the 2nd to the 37th, the resulting number is almost guaranteed to be returned as Infinity, unless the number happens to begin with &quot;0e&quot;. (Leading zeroes, either in the significand or the exponent, would be required for this to not be a guarantee. Any number beginning &quot;0e&quot;, on the other hand, will evaluate to 0 and not become Infinity.)<p>* if it&#x27;s in the 37th place, the resulting number (assuming no leading zeroes) has around a 27% chance to be representable without being returned as Infinity.<p>* if it&#x27;s in the 38th or 39th place, the resulting number is guaranteed to be small enough that it won&#x27;t be turned into Infinity.<p>* if it&#x27;s in the 1st or 40th place, it probably won&#x27;t be parsed as a number so will not return an error.<p>I&#x27;m also not interested in doing the full calculations, and in the end this isn&#x27;t going to make a significant difference to the chances IMO (except in the &quot;0e&quot; case mentioned above, which seems like it&#x27;d make a noticeable difference), but it&#x27;s interesting to think about the edge cases.</div><br/></div></div><div id="41508119" class="c"><input type="checkbox" id="c-41508119" checked=""/><div class="controls bullet"><span class="by">jenadine</span><span>|</span><a href="#41507695">root</a><span>|</span><a href="#41507807">parent</a><span>|</span><a href="#41508048">prev</a><span>|</span><a href="#41507818">next</a><span>|</span><label class="collapse" for="c-41508119">[-]</label><label class="expand" for="c-41508119">[1 more]</label></div><br/><div class="children"><div class="content">For a hash of N hex digit. The probably to have a single e and the rest decimal is N*10^(N-1)&#x2F;16^N<p>With 10 hex digit like on the blog, that&#x27;d be 0.9% so about once every 100 builds<p>With full 40 digit: 2.7e-8 so about once every 100M builds<p>Assuming my math is correct.</div><br/></div></div></div></div><div id="41507818" class="c"><input type="checkbox" id="c-41507818" checked=""/><div class="controls bullet"><span class="by">imron</span><span>|</span><a href="#41507695">root</a><span>|</span><a href="#41507758">parent</a><span>|</span><a href="#41507807">prev</a><span>|</span><a href="#41501737">next</a><span>|</span><label class="collapse" for="c-41507818">[-]</label><label class="expand" for="c-41507818">[1 more]</label></div><br/><div class="children"><div class="content">Technically no, but realistically yes.</div><br/></div></div></div></div></div></div><div id="41501737" class="c"><input type="checkbox" id="c-41501737" checked=""/><div class="controls bullet"><span class="by">notamy</span><span>|</span><a href="#41507695">prev</a><span>|</span><a href="#41506911">next</a><span>|</span><label class="collapse" for="c-41501737">[-]</label><label class="expand" for="c-41501737">[7 more]</label></div><br/><div class="children"><div class="content">Every time I read one of these types of stories, I keep telling myself that there needs to be a stricter subset of YAML with far fewer features and things like required string quoting. I feel like it has to exist, but I don&#x27;t know where it&#x27;d be found.</div><br/><div id="41507391" class="c"><input type="checkbox" id="c-41507391" checked=""/><div class="controls bullet"><span class="by">rlpb</span><span>|</span><a href="#41501737">parent</a><span>|</span><a href="#41506842">next</a><span>|</span><label class="collapse" for="c-41507391">[-]</label><label class="expand" for="c-41507391">[1 more]</label></div><br/><div class="children"><div class="content">Since such a subset would be valid YAML, it sounds like requiring string quoting would be a straightforward option to add to any YAML parser as a feature, without requiring much of a spec at all.<p>What else would be needed?</div><br/></div></div><div id="41506842" class="c"><input type="checkbox" id="c-41506842" checked=""/><div class="controls bullet"><span class="by">nixme</span><span>|</span><a href="#41501737">parent</a><span>|</span><a href="#41507391">prev</a><span>|</span><a href="#41501851">next</a><span>|</span><label class="collapse" for="c-41506842">[-]</label><label class="expand" for="c-41506842">[1 more]</label></div><br/><div class="children"><div class="content">StrictYAML <a href="https:&#x2F;&#x2F;hitchdev.com&#x2F;strictyaml&#x2F;" rel="nofollow">https:&#x2F;&#x2F;hitchdev.com&#x2F;strictyaml&#x2F;</a></div><br/></div></div><div id="41501851" class="c"><input type="checkbox" id="c-41501851" checked=""/><div class="controls bullet"><span class="by">darknavi</span><span>|</span><a href="#41501737">parent</a><span>|</span><a href="#41506842">prev</a><span>|</span><a href="#41506911">next</a><span>|</span><label class="collapse" for="c-41501851">[-]</label><label class="expand" for="c-41501851">[4 more]</label></div><br/><div class="children"><div class="content">JSON?</div><br/><div id="41501938" class="c"><input type="checkbox" id="c-41501938" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41501737">root</a><span>|</span><a href="#41501851">parent</a><span>|</span><a href="#41502033">next</a><span>|</span><label class="collapse" for="c-41501938">[-]</label><label class="expand" for="c-41501938">[1 more]</label></div><br/><div class="children"><div class="content">JSON but with the structure of YAML, would be nearly perfect to me. JSON was not designed for humans to read and write directly, it happens to be easy enough that it&#x27;s quite common but it&#x27;s not exactly a nice experience. Take that base and remove the need to quote key values, enforce indentation for clear structure and to remove the need for braces and commas (the no trailing commas rule in JSON kills me too), and support the markdown-like list syntax alternative and I think really that&#x27;s all most people want out of YAML anyways. I don&#x27;t understand or ever want to work with their references or variables or whatever the hell they add, any of that is much better off in code than in config as far as I&#x27;m concerned.</div><br/></div></div><div id="41502033" class="c"><input type="checkbox" id="c-41502033" checked=""/><div class="controls bullet"><span class="by">paulv</span><span>|</span><a href="#41501737">root</a><span>|</span><a href="#41501851">parent</a><span>|</span><a href="#41501938">prev</a><span>|</span><a href="#41506911">next</a><span>|</span><label class="collapse" for="c-41502033">[-]</label><label class="expand" for="c-41502033">[2 more]</label></div><br/><div class="children"><div class="content">The trailing comma thing gets me nearly every time I edit a json config file.<p>I don&#x27;t think json supports comments, which makes it a non-starter for a lot of folks.</div><br/><div id="41502175" class="c"><input type="checkbox" id="c-41502175" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41501737">root</a><span>|</span><a href="#41502033">parent</a><span>|</span><a href="#41506911">next</a><span>|</span><label class="collapse" for="c-41502175">[-]</label><label class="expand" for="c-41502175">[1 more]</label></div><br/><div class="children"><div class="content">Extra fun: there&#x27;s now JSONC which does support trailing commas and comments, and projects will use it with a .json extension still because Microsoft would hate for anything to ever be clear and make sense.</div><br/></div></div></div></div></div></div></div></div><div id="41506911" class="c"><input type="checkbox" id="c-41506911" checked=""/><div class="controls bullet"><span class="by">peterldowns</span><span>|</span><a href="#41501737">prev</a><span>|</span><a href="#41507856">next</a><span>|</span><label class="collapse" for="c-41506911">[-]</label><label class="expand" for="c-41506911">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve run into this exact YAML problem when trying to use the git hash as a label in a templated kubernetes config file. Same solution â wrap it in quotes â and exact same frustration.<p>Here&#x27;s to you, and to whoever else runs into this problem next.</div><br/></div></div><div id="41507856" class="c"><input type="checkbox" id="c-41507856" checked=""/><div class="controls bullet"><span class="by">erik_seaberg</span><span>|</span><a href="#41506911">prev</a><span>|</span><a href="#41507310">next</a><span>|</span><label class="collapse" for="c-41507856">[-]</label><label class="expand" for="c-41507856">[1 more]</label></div><br/><div class="children"><div class="content">I once half-assed a tool that summarized deployed builds, importing a CSV to Google Sheets as a team UI. Well, one day the import noticed one of those commit IDs must be a number because it doesn&#x27;t contain any letters, and then a formula used exponential notation to create a hyperlink that didn&#x27;t work.<p><i>Edit:</i> Now that I think about it, it might have been only digits with a leading zero that was dropped.</div><br/></div></div><div id="41507310" class="c"><input type="checkbox" id="c-41507310" checked=""/><div class="controls bullet"><span class="by">deepsun</span><span>|</span><a href="#41507856">prev</a><span>|</span><a href="#41501626">next</a><span>|</span><label class="collapse" for="c-41507310">[-]</label><label class="expand" for="c-41507310">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s because YAML is mainly intended for human interaction. Machine interaction is bungee-strapped later.<p>Same goes for CLI (shell), same for SQL. All the many bugs with them is because they are not for machines. Proper formats for machines don&#x27;t have those issues (MsgPack, Protobuf, hell even XML&#x2F;HTML is better).</div><br/></div></div><div id="41501626" class="c"><input type="checkbox" id="c-41501626" checked=""/><div class="controls bullet"><span class="by">aftbit</span><span>|</span><a href="#41507310">prev</a><span>|</span><a href="#41500911">next</a><span>|</span><label class="collapse" for="c-41501626">[-]</label><label class="expand" for="c-41501626">[1 more]</label></div><br/><div class="children"><div class="content">Nice one! I have hit something similar in the past around text input parsing. I bet that `e` notation for entering numbers has caused more bugs than it has actually been used as intended, at least in non-scientific code.</div><br/></div></div><div id="41500911" class="c"><input type="checkbox" id="c-41500911" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41501626">prev</a><span>|</span><a href="#41501060">next</a><span>|</span><label class="collapse" for="c-41500911">[-]</label><label class="expand" for="c-41500911">[7 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why I always put several quotes in YAML values, just to be safe:<p><pre><code>    log_config:
      file: &#x27;&quot;&#x2F;var&#x2F;log&#x2F;my_custom_service&#x2F;mcs.log&quot;&#x27;</code></pre></div><br/><div id="41501673" class="c"><input type="checkbox" id="c-41501673" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41500911">parent</a><span>|</span><a href="#41501643">next</a><span>|</span><label class="collapse" for="c-41501673">[-]</label><label class="expand" for="c-41501673">[1 more]</label></div><br/><div class="children"><div class="content">I do quote strings to try and avoid this problem, though usually I&#x27;ll leave single-word strictly alphabetical values bare--the only gotcha I&#x27;m aware of here is true&#x2F;false&#x2F;yes&#x2F;no which I never use as string values anyways. But what&#x27;s the point of two sets of quotes?</div><br/></div></div><div id="41501643" class="c"><input type="checkbox" id="c-41501643" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#41500911">parent</a><span>|</span><a href="#41501673">prev</a><span>|</span><a href="#41501060">next</a><span>|</span><label class="collapse" for="c-41501643">[-]</label><label class="expand" for="c-41501643">[5 more]</label></div><br/><div class="children"><div class="content">does several actually help or are you just being funny?</div><br/><div id="41503386" class="c"><input type="checkbox" id="c-41503386" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41500911">root</a><span>|</span><a href="#41501643">parent</a><span>|</span><a href="#41501717">next</a><span>|</span><label class="collapse" for="c-41503386">[-]</label><label class="expand" for="c-41503386">[1 more]</label></div><br/><div class="children"><div class="content">Actually, yes. We use yamerl parser for parsing YAML in Erlang and Erlang has both strings and atoms; yamerl generally turns unquoted YAML strings into atoms and double-quoted YAML strings into strings.<p>But nobody else cares about how yamerl parses YAML for Erlang and lots of tool try to re-normalize YAML as they process it; so if we put e.g.<p><pre><code>    config:
        option: &quot;this_must_be_a_string&quot;
</code></pre>
into a Helm chart, and then run it through helm, the resulting YAML will be<p><pre><code>    config:
        option: this_must_be_a_string
</code></pre>
and when fed to our Erlang application, the option&#x27;s value will end up being an atom, and it will blow up when we try to e.g. concatenate it with another string. But &#x27;&quot;this_must_be_a_string&quot;&#x27; resists all such normalization attempts, gets to be passed around as-is, and ends up being parsed as a string with embedded starting and ending quotes but those can be easily stripped away as a global post-pass on a parsed config, before consuming it any further.</div><br/></div></div><div id="41501717" class="c"><input type="checkbox" id="c-41501717" checked=""/><div class="controls bullet"><span class="by">xelamonster</span><span>|</span><a href="#41500911">root</a><span>|</span><a href="#41501643">parent</a><span>|</span><a href="#41503386">prev</a><span>|</span><a href="#41501060">next</a><span>|</span><label class="collapse" for="c-41501717">[-]</label><label class="expand" for="c-41501717">[3 more]</label></div><br/><div class="children"><div class="content">Heh, maybe I missed the joke too. Thing is all of the problems people generally think of with YAML strings are solved with just one set of quotes so I don&#x27;t quite get it either way. Maybe this would have some effect on strings that themselves contain quotes? But that&#x27;s a special case in every single language with quoted strings, not a YAML problem.</div><br/><div id="41503408" class="c"><input type="checkbox" id="c-41503408" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41500911">root</a><span>|</span><a href="#41501717">parent</a><span>|</span><a href="#41501060">next</a><span>|</span><label class="collapse" for="c-41503408">[-]</label><label class="expand" for="c-41503408">[2 more]</label></div><br/><div class="children"><div class="content">See the sibling comment. But it <i>is</i> a joke, in a sense that this is all very silly. Maybe we shouldn&#x27;t have been using such a fringe programming language in the first place but who knew 15 years ago that Go would exist?</div><br/><div id="41506186" class="c"><input type="checkbox" id="c-41506186" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#41500911">root</a><span>|</span><a href="#41503408">parent</a><span>|</span><a href="#41501060">next</a><span>|</span><label class="collapse" for="c-41506186">[-]</label><label class="expand" for="c-41506186">[1 more]</label></div><br/><div class="children"><div class="content">Or that Go would be so popular ;)<p>It&#x27;s always a gamble when using a programming language from with a small community. Will <i>this one</i> get big?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41501060" class="c"><input type="checkbox" id="c-41501060" checked=""/><div class="controls bullet"><span class="by">treyd</span><span>|</span><a href="#41500911">prev</a><span>|</span><a href="#41508206">next</a><span>|</span><label class="collapse" for="c-41501060">[-]</label><label class="expand" for="c-41501060">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if you could fix this specific case by keeping track of the last game version to be interpreted this way and using that when querying for `Infinity`.  That wouldn&#x27;t be a platonically correct solution but it should work no?</div><br/></div></div><div id="41508206" class="c"><input type="checkbox" id="c-41508206" checked=""/><div class="controls bullet"><span class="by">xlii</span><span>|</span><a href="#41501060">prev</a><span>|</span><a href="#41502635">next</a><span>|</span><label class="collapse" for="c-41508206">[-]</label><label class="expand" for="c-41508206">[1 more]</label></div><br/><div class="children"><div class="content">Itâs easy to point at YAML and shake oneâs head: âya did it again old chap!â. Yet, software engineering is full of foot guns like that.<p>I tend to joke that working in the industry made me lose all the trust I ever had in me. I donât believe any deployed code unless it can be confirmed by two independent sources and a runtime telemetry.<p>Here, I expected hash collision which is rare, but in my lifetime Iâve seen my share of âit really shouldnât happen but somehow it happenedâ. Couple weeks ago Iâve seen author at a random library implementing queue (with ACKs!) for UDP packet transmission.<p>Truly an amazing career for chaos keepers.</div><br/></div></div><div id="41502635" class="c"><input type="checkbox" id="c-41502635" checked=""/><div class="controls bullet"><span class="by">molticrystal</span><span>|</span><a href="#41508206">prev</a><span>|</span><a href="#41505981">next</a><span>|</span><label class="collapse" for="c-41502635">[-]</label><label class="expand" for="c-41502635">[1 more]</label></div><br/><div class="children"><div class="content">1. Anything that in YAML that is not explicitly a number, add 
quotes to ensure it is treated as a string.<p>2. Use monotonically increasing variables for versions of software.</div><br/></div></div><div id="41505981" class="c"><input type="checkbox" id="c-41505981" checked=""/><div class="controls bullet"><span class="by">frizlab</span><span>|</span><a href="#41502635">prev</a><span>|</span><a href="#41508439">next</a><span>|</span><label class="collapse" for="c-41505981">[-]</label><label class="expand" for="c-41505981">[1 more]</label></div><br/><div class="children"><div class="content">Now you wait for the short hash collision. Why?</div><br/></div></div><div id="41508439" class="c"><input type="checkbox" id="c-41508439" checked=""/><div class="controls bullet"><span class="by">jeffrallen</span><span>|</span><a href="#41505981">prev</a><span>|</span><a href="#41507098">next</a><span>|</span><label class="collapse" for="c-41508439">[-]</label><label class="expand" for="c-41508439">[1 more]</label></div><br/><div class="children"><div class="content">I definitely had &quot;string parsed as number&quot; on my Yaml bugs bingo card. Did not exactly have &quot;floats and hex have the same alphabet and overlapping grammars&quot; but I&#x27;ll put that on my bingo card for the next Yaml bugs game, which will be... tomorrow. :(</div><br/></div></div><div id="41507098" class="c"><input type="checkbox" id="c-41507098" checked=""/><div class="controls bullet"><span class="by">dreamcompiler</span><span>|</span><a href="#41508439">prev</a><span>|</span><a href="#41507288">next</a><span>|</span><label class="collapse" for="c-41507098">[-]</label><label class="expand" for="c-41507098">[1 more]</label></div><br/><div class="children"><div class="content">The solution to this nonsense is and has always been s-expressions. XML <i>reinvented</i> s-expressions but they made a bad job of it and made them much too verbose.<p>I always use s-exprs for problem-free config files but sadly everybody else takes one look and says &quot;but all those parentheses! I&#x27;d rather have my strings interpreted as very large numbers, thank you.&quot;</div><br/></div></div><div id="41507288" class="c"><input type="checkbox" id="c-41507288" checked=""/><div class="controls bullet"><span class="by">forrestthewoods</span><span>|</span><a href="#41507098">prev</a><span>|</span><a href="#41500601">next</a><span>|</span><label class="collapse" for="c-41507288">[-]</label><label class="expand" for="c-41507288">[1 more]</label></div><br/><div class="children"><div class="content">YAML is egregiously terrible. JSON is slightly better but still bad.<p>I want an interchange format that lets you declare the types on either side:<p><pre><code>    foo : f32 = bin : 0x42280000
</code></pre>
Just let me explicitly declare the types and a kajillion problems go away forever.</div><br/></div></div><div id="41500601" class="c"><input type="checkbox" id="c-41500601" checked=""/><div class="controls bullet"><span class="by">thanatropism</span><span>|</span><a href="#41507288">prev</a><span>|</span><a href="#41507038">next</a><span>|</span><label class="collapse" for="c-41500601">[-]</label><label class="expand" for="c-41500601">[1 more]</label></div><br/><div class="children"><div class="content">NestedText + Pydantic.</div><br/></div></div><div id="41507038" class="c"><input type="checkbox" id="c-41507038" checked=""/><div class="controls bullet"><span class="by">taspeotis</span><span>|</span><a href="#41500601">prev</a><span>|</span><a href="#41500490">next</a><span>|</span><label class="collapse" for="c-41507038">[-]</label><label class="expand" for="c-41507038">[1 more]</label></div><br/><div class="children"><div class="content">Yelling At My Laptop</div><br/></div></div><div id="41500490" class="c"><input type="checkbox" id="c-41500490" checked=""/><div class="controls bullet"><span class="by">unwind</span><span>|</span><a href="#41507038">prev</a><span>|</span><a href="#41508613">next</a><span>|</span><label class="collapse" for="c-41500490">[-]</label><label class="expand" for="c-41500490">[14 more]</label></div><br/><div class="children"><div class="content">Meta: I don&#x27;t understand &quot;RNG&quot; (random number generation, right?) in the title, since the article is about a quoting issue causing a value to be interpreted as a floating-point value in scientific notation, rather than a string. Is that the &quot;random number generation&quot; the title refers to, perhaps? A like puns, but maybe I&#x27;m just tired. :)</div><br/><div id="41502004" class="c"><input type="checkbox" id="c-41502004" checked=""/><div class="controls bullet"><span class="by">ironhaven</span><span>|</span><a href="#41500490">parent</a><span>|</span><a href="#41500515">next</a><span>|</span><label class="collapse" for="c-41502004">[-]</label><label class="expand" for="c-41502004">[5 more]</label></div><br/><div class="children"><div class="content">In video gamer parlance any non human predictable output or action gets called &quot;RNG&quot;. Anything from true random loot drops to deterministic but chaotic systems can be called &quot;RNG&quot;. This the blog title they describe the exact resulting git hash as having the quality of being RNG because you can&#x27;t really predict if your git rev hash will have a certain characters. They got unlucky and triggered a bug from the chaotic git hash.</div><br/><div id="41508167" class="c"><input type="checkbox" id="c-41508167" checked=""/><div class="controls bullet"><span class="by">aulin</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41502004">parent</a><span>|</span><a href="#41502159">next</a><span>|</span><label class="collapse" for="c-41508167">[-]</label><label class="expand" for="c-41508167">[1 more]</label></div><br/><div class="children"><div class="content">Not a gamer so first time I heard this. For some reason it bothers me so much. It&#x27;s not random, it&#x27;s perfectly reproducible and has a crystal clear explanation. They are using short hashes for version numbers which is looking for problems in the first place.</div><br/></div></div><div id="41502159" class="c"><input type="checkbox" id="c-41502159" checked=""/><div class="controls bullet"><span class="by">keybored</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41502004">parent</a><span>|</span><a href="#41508167">prev</a><span>|</span><a href="#41500515">next</a><span>|</span><label class="collapse" for="c-41502159">[-]</label><label class="expand" for="c-41502159">[3 more]</label></div><br/><div class="children"><div class="content">Sloppy technical writing.<p>Or clickbait since the title sounds more interesting than âoh YAML is dumbâ.</div><br/><div id="41503486" class="c"><input type="checkbox" id="c-41503486" checked=""/><div class="controls bullet"><span class="by">NobodyNada</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41502159">parent</a><span>|</span><a href="#41502920">next</a><span>|</span><label class="collapse" for="c-41503486">[-]</label><label class="expand" for="c-41503486">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it&#x27;s fair to characterize it as &quot;sloppy&quot; or &quot;clickbait&quot; at all. The author is a game developer, and they use terminology in a way that is common and accepted within their field -- sure, it&#x27;s nonstandard and &quot;wrong&quot; outside of the game industry...but I&#x27;d say it&#x27;s a little hypocritical for software developers to complain about jargon.<p>As a supporting example: the game Super Metroid alternates every frame between checking collisions from left-to-right or right-to-left. The direction of collision checks can make a difference for speedrunning tricks, and there&#x27;s no (practical) way to control for it, so it&#x27;s referred to as &quot;RNG&quot;. From a player&#x27;s perspective, the fact that it&#x27;s just a frame counter rather than an LCG or something is irrelevant -- it&#x27;s a luck-based factor that&#x27;s outside of the player&#x27;s control.<p>And the same frame counter is used as a source of entropy elsewhere in the game, so there&#x27;s an argument that it&#x27;s not even <i>wrong</i> to call it RNG. Similarly, a Git hash is a SHA-1 of the repo contents commit message, commit date, etc., and a cryptographic hash and pseudo-random generator are very similar constructions...so calling it RNG is a little cute but not exactly <i>inaccurate</i>.</div><br/></div></div><div id="41502920" class="c"><input type="checkbox" id="c-41502920" checked=""/><div class="controls bullet"><span class="by">tmendez</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41502159">parent</a><span>|</span><a href="#41503486">prev</a><span>|</span><a href="#41500515">next</a><span>|</span><label class="collapse" for="c-41502920">[-]</label><label class="expand" for="c-41502920">[1 more]</label></div><br/><div class="children"><div class="content">sorry, I work in game development so whenever we hit something that doesn&#x27;t happen every time we call it RNG for fun</div><br/></div></div></div></div></div></div><div id="41500515" class="c"><input type="checkbox" id="c-41500515" checked=""/><div class="controls bullet"><span class="by">Bromeo</span><span>|</span><a href="#41500490">parent</a><span>|</span><a href="#41502004">prev</a><span>|</span><a href="#41501176">next</a><span>|</span><label class="collapse" for="c-41500515">[-]</label><label class="expand" for="c-41500515">[1 more]</label></div><br/><div class="children"><div class="content">I suppose it&#x27;s &quot;RNG&quot; if the commit has exactly one &#x27;e&#x27; and otherwise only numbers, so that YAML interprets it as scientific notation. I assume otherwise it&#x27;s always interpreted as a String, as a fallback.</div><br/></div></div><div id="41501176" class="c"><input type="checkbox" id="c-41501176" checked=""/><div class="controls bullet"><span class="by">joshka</span><span>|</span><a href="#41500490">parent</a><span>|</span><a href="#41500515">prev</a><span>|</span><a href="#41506650">next</a><span>|</span><label class="collapse" for="c-41501176">[-]</label><label class="expand" for="c-41501176">[4 more]</label></div><br/><div class="children"><div class="content">I was also confused by this as a commit id is deterministic. I suspect that the OP may be confused about how git hashes are computed.<p>But thinking deeper, given that the hash is computed from a small amount of entropy (the commit time), plus a seed (the committed code changes), and the previous value (previous commit hash), this is actually fairly similar to the definition of a PRNG.<p>That is to say, it&#x27;s not an RNG, but for some approximations it&#x27;s indistinguishable from one.</div><br/><div id="41501277" class="c"><input type="checkbox" id="c-41501277" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41501176">parent</a><span>|</span><a href="#41506650">next</a><span>|</span><label class="collapse" for="c-41501277">[-]</label><label class="expand" for="c-41501277">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I suspect that the OP may be confused about how git hashes are computed.<p>I don&#x27;t think they are. The use of &quot;RNG&quot; is referring to how a &quot;random&quot; commit sha lead to this bug. Commit SHAs are, for all intents and purposes, random.<p>You could test this against thousands of SHAs and never encounter one that meets the criteria to trigger the bug.</div><br/><div id="41507593" class="c"><input type="checkbox" id="c-41507593" checked=""/><div class="controls bullet"><span class="by">bazzargh</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41501277">parent</a><span>|</span><a href="#41502944">next</a><span>|</span><label class="collapse" for="c-41507593">[-]</label><label class="expand" for="c-41507593">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s way less than thousands.<p>To get this specific bug - one &#x27;e&#x27; in the 7th digit and 9 digits less than &#x27;a&#x27; - is 1&#x2F;16*(10&#x2F;16)^9 = 0.009095. Just under 1 in 1000. But if the &#x27;e&#x27; is in the 2nd,3rd,4th,5th,6th you&#x27;d get the same bug, so actually about 6 in 1000.<p>But around 1% of the hashes will be all decimal digits and will parse as numbers ((10&#x2F;16)^10 = 0.009). That&#x27;s common enough that I&#x27;ve seen that one cause errors in our code too (somebody had code reading the hash then trying to append it to a string).</div><br/></div></div><div id="41502944" class="c"><input type="checkbox" id="c-41502944" checked=""/><div class="controls bullet"><span class="by">tmendez</span><span>|</span><a href="#41500490">root</a><span>|</span><a href="#41501277">parent</a><span>|</span><a href="#41507593">prev</a><span>|</span><a href="#41506650">next</a><span>|</span><label class="collapse" for="c-41502944">[-]</label><label class="expand" for="c-41502944">[1 more]</label></div><br/><div class="children"><div class="content">This was my thinking, yeah; been playing too much Hearthstone lately so I had RNG on my mind o_o</div><br/></div></div></div></div></div></div><div id="41506650" class="c"><input type="checkbox" id="c-41506650" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#41500490">parent</a><span>|</span><a href="#41501176">prev</a><span>|</span><a href="#41501380">next</a><span>|</span><label class="collapse" for="c-41506650">[-]</label><label class="expand" for="c-41506650">[1 more]</label></div><br/><div class="children"><div class="content">OK, we&#x27;ve de-RNG&#x27;d the title above.</div><br/></div></div><div id="41501380" class="c"><input type="checkbox" id="c-41501380" checked=""/><div class="controls bullet"><span class="by">EthanHeilman</span><span>|</span><a href="#41500490">parent</a><span>|</span><a href="#41506650">prev</a><span>|</span><a href="#41508613">next</a><span>|</span><label class="collapse" for="c-41501380">[-]</label><label class="expand" for="c-41501380">[2 more]</label></div><br/><div class="children"><div class="content">I agree it isn&#x27;t a bug in the RNG itself, but it a bug in randomness propagation which is part of randomness generation.<p>For instance consider this bug:<p>secretKey = Hexadecimal(Crypto.Rand())[0:16]<p>The person likely intended to generate a secret_key with 16 bytes of entropy. Instead they generated a secretKey which is 16 bytes long, but only contains 8 bytes of entropy. I would call this a RNG bug.</div><br/></div></div></div></div><div id="41508613" class="c"><input type="checkbox" id="c-41508613" checked=""/><div class="controls bullet"><span class="by">Jean-Papoulos</span><span>|</span><a href="#41500490">prev</a><span>|</span><label class="collapse" for="c-41508613">[-]</label><label class="expand" for="c-41508613">[2 more]</label></div><br/><div class="children"><div class="content">And this kids, is why dynamic typing is inherently bad for purposes other then quick scripting&#x2F;prototyping.</div><br/><div id="41508668" class="c"><input type="checkbox" id="c-41508668" checked=""/><div class="controls bullet"><span class="by">_ZeD_</span><span>|</span><a href="#41508613">parent</a><span>|</span><label class="collapse" for="c-41508668">[-]</label><label class="expand" for="c-41508668">[1 more]</label></div><br/><div class="children"><div class="content">infinite is a valid ieee float value.
this is a yaml issue, not a dynamic typing one</div><br/></div></div></div></div></div></div></div></div></div></body></html>