<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1687770058094" as="style"/><link rel="stylesheet" href="styles.css?v=1687770058094"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/mycelial/mycelite">Mycelite: SQLite extension to synchronize changes across SQLite instances</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>thunderbong</span> | <span>31 comments</span></div><br/><div><div id="36475214" class="c"><input type="checkbox" id="c-36475214" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36477307">next</a><span>|</span><label class="collapse" for="c-36475214">[-]</label><label class="expand" for="c-36475214">[6 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    db.commit()
    
    # Give Mycelite time to sync before script exits
    import time
    time.sleep(5)
</code></pre>
This really needs a way to wait for the sync to complete. Sleep won&#x27;t cut it.</div><br/><div id="36476438" class="c"><input type="checkbox" id="c-36476438" checked=""/><div class="controls bullet"><span class="by">baliex</span><span>|</span><a href="#36475214">parent</a><span>|</span><a href="#36475413">next</a><span>|</span><label class="collapse" for="c-36476438">[-]</label><label class="expand" for="c-36476438">[1 more]</label></div><br/><div class="children"><div class="content">Relevant HN post from _yesterday_, <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36465085">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36465085</a></div><br/></div></div><div id="36475413" class="c"><input type="checkbox" id="c-36475413" checked=""/><div class="controls bullet"><span class="by">gnulinux</span><span>|</span><a href="#36475214">parent</a><span>|</span><a href="#36476438">prev</a><span>|</span><a href="#36476800">next</a><span>|</span><label class="collapse" for="c-36475413">[-]</label><label class="expand" for="c-36475413">[1 more]</label></div><br/><div class="children"><div class="content">Fingers crossed there is no network issue. `time.sleep(5)` is ridiculous.</div><br/></div></div><div id="36476800" class="c"><input type="checkbox" id="c-36476800" checked=""/><div class="controls bullet"><span class="by">hahn-kev</span><span>|</span><a href="#36475214">parent</a><span>|</span><a href="#36475413">prev</a><span>|</span><a href="#36475742">next</a><span>|</span><label class="collapse" for="c-36476800">[-]</label><label class="expand" for="c-36476800">[1 more]</label></div><br/><div class="children"><div class="content">I see so this is a PoC hobby project and nothing to actually use. Thanks for the warning.</div><br/></div></div><div id="36475411" class="c"><input type="checkbox" id="c-36475411" checked=""/><div class="controls bullet"><span class="by">chaxor</span><span>|</span><a href="#36475214">parent</a><span>|</span><a href="#36475742">prev</a><span>|</span><a href="#36477307">next</a><span>|</span><label class="collapse" for="c-36475411">[-]</label><label class="expand" for="c-36475411">[1 more]</label></div><br/><div class="children"><div class="content">Oof</div><br/></div></div></div></div><div id="36477307" class="c"><input type="checkbox" id="c-36477307" checked=""/><div class="controls bullet"><span class="by">rpastuszak</span><span>|</span><a href="#36475214">prev</a><span>|</span><a href="#36475514">next</a><span>|</span><label class="collapse" for="c-36477307">[-]</label><label class="expand" for="c-36477307">[1 more]</label></div><br/><div class="children"><div class="content">I’m just messing with using SQLite with serverless on Vercel and really like the simplicity of having just a db file you can read locally instead of setting up and connecting to a db instance somewhere else.<p>This wouldn’t work ofc as fs access in Vercel is limited, plus syncing the db would (probably) delay the network response. But</div><br/></div></div><div id="36475514" class="c"><input type="checkbox" id="c-36475514" checked=""/><div class="controls bullet"><span class="by">sho</span><span>|</span><a href="#36477307">prev</a><span>|</span><a href="#36476174">next</a><span>|</span><label class="collapse" for="c-36475514">[-]</label><label class="expand" for="c-36475514">[4 more]</label></div><br/><div class="children"><div class="content">Be interested to hear a comparison between this lib and litestream&#x2F;litefs, which seem to be actively developed by fly.io for a similar use case<p><a href="https:&#x2F;&#x2F;litestream.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;litestream.io&#x2F;</a>
<a href="https:&#x2F;&#x2F;github.com&#x2F;superfly&#x2F;litefs">https:&#x2F;&#x2F;github.com&#x2F;superfly&#x2F;litefs</a></div><br/><div id="36475606" class="c"><input type="checkbox" id="c-36475606" checked=""/><div class="controls bullet"><span class="by">AlexErrant</span><span>|</span><a href="#36475514">parent</a><span>|</span><a href="#36475991">next</a><span>|</span><label class="collapse" for="c-36475606">[-]</label><label class="expand" for="c-36475606">[2 more]</label></div><br/><div class="children"><div class="content">cr-sqlite [0] is another option. It has the added benefit of being able to run in the browser (persisting to IndexedDB a la absurd-sql, though it uses a fork of wa-sqlite [1]). In theory it could also persist to the Origin Private Filesystem via SQLite&#x27;s official impl, though switching doesn&#x27;t seem to be strictly better [2]. A con is that it doesn&#x27;t enforce foreign key constraints (though of course you can still do joins). Cr-sqlite also has better documentation about what CRDTs it supports than Mycelite [3], which is something I brought up in a recent thread [4](which might have triggered this post). I&#x27;m personally using cr-sqlite in an Anki clone I&#x27;m building [5] and have only positive things to say about cr-sqlite and its maintainer.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;vlcn-io&#x2F;cr-sqlite&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;vlcn-io&#x2F;cr-sqlite&#x2F;</a><p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;63">https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;63</a><p>[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;vlcn-io&#x2F;cr-sqlite&#x2F;#how-does-it-work">https:&#x2F;&#x2F;github.com&#x2F;vlcn-io&#x2F;cr-sqlite&#x2F;#how-does-it-work</a><p>[4] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36473772">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36473772</a><p>[5] <a href="https:&#x2F;&#x2F;github.com&#x2F;AlexErrant&#x2F;Pentive">https:&#x2F;&#x2F;github.com&#x2F;AlexErrant&#x2F;Pentive</a></div><br/><div id="36475641" class="c"><input type="checkbox" id="c-36475641" checked=""/><div class="controls bullet"><span class="by">sho</span><span>|</span><a href="#36475514">root</a><span>|</span><a href="#36475606">parent</a><span>|</span><a href="#36475991">next</a><span>|</span><label class="collapse" for="c-36475641">[-]</label><label class="expand" for="c-36475641">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the link, very interesting. A lot of work going on in this space right now!</div><br/></div></div></div></div><div id="36475991" class="c"><input type="checkbox" id="c-36475991" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#36475514">parent</a><span>|</span><a href="#36475606">prev</a><span>|</span><a href="#36476174">next</a><span>|</span><label class="collapse" for="c-36475991">[-]</label><label class="expand" for="c-36475991">[1 more]</label></div><br/><div class="children"><div class="content">Litestream lets you pick which servers you replicate your data to.</div><br/></div></div></div></div><div id="36476174" class="c"><input type="checkbox" id="c-36476174" checked=""/><div class="controls bullet"><span class="by">Void_</span><span>|</span><a href="#36475514">prev</a><span>|</span><a href="#36477314">next</a><span>|</span><label class="collapse" for="c-36476174">[-]</label><label class="expand" for="c-36476174">[6 more]</label></div><br/><div class="children"><div class="content">We&#x27;ve been building iOS&#x2F;macOS apps in local-first fashion for years.<p>It works differently - there&#x27;s a persistence library called Core Data on each client (most recently SwiftData). You can choose which database to use - most likely SQLite, but you could use XML files to store your data.<p>And then Core Data simply makes sure everything is in sync. It&#x27;s an Apple system library, which means your data will automatically sync even if the app isn&#x27;t running.<p>This feels like better approach than OP&#x27;s Mycelite or better-known cr-sqlite.<p>Any reason why syncing on the database level would be better? It feels like something the library should do, not the database.</div><br/><div id="36477344" class="c"><input type="checkbox" id="c-36477344" checked=""/><div class="controls bullet"><span class="by">gregoriol</span><span>|</span><a href="#36476174">parent</a><span>|</span><a href="#36476945">next</a><span>|</span><label class="collapse" for="c-36477344">[-]</label><label class="expand" for="c-36477344">[1 more]</label></div><br/><div class="children"><div class="content">CoreData doesn&#x27;t work on any other platform, so you can only make Apple-apps. If you wanted to have a web version, an Android version or whatever else, you couldn&#x27;t. So it&#x27;s not a very good choice for most use-cases.</div><br/></div></div><div id="36476945" class="c"><input type="checkbox" id="c-36476945" checked=""/><div class="controls bullet"><span class="by">manmal</span><span>|</span><a href="#36476174">parent</a><span>|</span><a href="#36477344">prev</a><span>|</span><a href="#36476540">next</a><span>|</span><label class="collapse" for="c-36476945">[-]</label><label class="expand" for="c-36476945">[1 more]</label></div><br/><div class="children"><div class="content">CoreData is a footgun when it comes to threading, my approach is to use a wrapper lib (eg CoreStore) that takes off the sharp edges, or just use SQLite directly (or with a lib like GRDB).</div><br/></div></div><div id="36476540" class="c"><input type="checkbox" id="c-36476540" checked=""/><div class="controls bullet"><span class="by">jamil7</span><span>|</span><a href="#36476174">parent</a><span>|</span><a href="#36476945">prev</a><span>|</span><a href="#36476385">next</a><span>|</span><label class="collapse" for="c-36476540">[-]</label><label class="expand" for="c-36476540">[1 more]</label></div><br/><div class="children"><div class="content">To be slightly pedantic and clarify. It&#x27;s not actually anything to do with Core Data itself but CloudKit that is doing the syncing, more specifically, NSPersistentCloudKitContainer which came out a few years ago and makes adding CloudKit syncing to Core Data a one-liner basically.<p>This year at WWDC we got CKSyncEngine which gives you the primitives to add a CloudKit syncing to your own persistence layer.</div><br/></div></div><div id="36476385" class="c"><input type="checkbox" id="c-36476385" checked=""/><div class="controls bullet"><span class="by">anonzzzies</span><span>|</span><a href="#36476174">parent</a><span>|</span><a href="#36476540">prev</a><span>|</span><a href="#36476735">next</a><span>|</span><label class="collapse" for="c-36476385">[-]</label><label class="expand" for="c-36476385">[1 more]</label></div><br/><div class="children"><div class="content">Does something like that exist for other platforms? Web, Android, Linux?</div><br/></div></div><div id="36476735" class="c"><input type="checkbox" id="c-36476735" checked=""/><div class="controls bullet"><span class="by">ungamedplayer</span><span>|</span><a href="#36476174">parent</a><span>|</span><a href="#36476385">prev</a><span>|</span><a href="#36477314">next</a><span>|</span><label class="collapse" for="c-36476735">[-]</label><label class="expand" for="c-36476735">[1 more]</label></div><br/><div class="children"><div class="content">Simply</div><br/></div></div></div></div><div id="36477314" class="c"><input type="checkbox" id="c-36477314" checked=""/><div class="controls bullet"><span class="by">jdthedisciple</span><span>|</span><a href="#36476174">prev</a><span>|</span><a href="#36475825">next</a><span>|</span><label class="collapse" for="c-36477314">[-]</label><label class="expand" for="c-36477314">[1 more]</label></div><br/><div class="children"><div class="content">Does this work across networks?<p>E.g. for an sqlite db that lives on a Network Attached Storage (NAS)?</div><br/></div></div><div id="36475825" class="c"><input type="checkbox" id="c-36475825" checked=""/><div class="controls bullet"><span class="by">andrewmunsell</span><span>|</span><a href="#36477314">prev</a><span>|</span><a href="#36475984">next</a><span>|</span><label class="collapse" for="c-36475825">[-]</label><label class="expand" for="c-36475825">[3 more]</label></div><br/><div class="children"><div class="content">I’m unsure why this would be compared with Actual Budget or CRDTs in the README.<p>The issue that CRDTs are solving isn’t simply getting the bytes from one device to another, it’s ensuring that conflicts are merged in a sane way, which this project doesn’t clearly address. Simply syncing a DB across multiple devices won’t help if your app isn’t designed to handle data conflicts.</div><br/><div id="36476476" class="c"><input type="checkbox" id="c-36476476" checked=""/><div class="controls bullet"><span class="by">fauigerzigerk</span><span>|</span><a href="#36475825">parent</a><span>|</span><a href="#36475984">next</a><span>|</span><label class="collapse" for="c-36476476">[-]</label><label class="expand" for="c-36476476">[2 more]</label></div><br/><div class="children"><div class="content"><i>&gt;The issue that CRDTs are solving isn’t simply getting the bytes from one device to another, it’s ensuring that conflicts are merged in a sane way</i><p>CRDTs merge data in a predictable way but not necessarily in a consistent or correct way according to the requirements of any particular application.<p>I find CRDTs interesting and they are certainly useful for some types of applications with relatively lax consistency rules. But I don&#x27;t see how they help with the sort of consistency requirements that finance apps are bound to have.</div><br/><div id="36477148" class="c"><input type="checkbox" id="c-36477148" checked=""/><div class="controls bullet"><span class="by">robertlagrant</span><span>|</span><a href="#36475825">root</a><span>|</span><a href="#36476476">parent</a><span>|</span><a href="#36475984">next</a><span>|</span><label class="collapse" for="c-36477148">[-]</label><label class="expand" for="c-36477148">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t the point that you get to choose the merge strategy, and thus it is done according to your requirements?</div><br/></div></div></div></div></div></div><div id="36475984" class="c"><input type="checkbox" id="c-36475984" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#36475825">prev</a><span>|</span><a href="#36476769">next</a><span>|</span><label class="collapse" for="c-36475984">[-]</label><label class="expand" for="c-36475984">[1 more]</label></div><br/><div class="children"><div class="content">This appears to rely on a cloud service they&#x27;re running, but that&#x27;s not prominently mentioned.</div><br/></div></div><div id="36476769" class="c"><input type="checkbox" id="c-36476769" checked=""/><div class="controls bullet"><span class="by">valstu</span><span>|</span><a href="#36475984">prev</a><span>|</span><a href="#36475729">next</a><span>|</span><label class="collapse" for="c-36476769">[-]</label><label class="expand" for="c-36476769">[1 more]</label></div><br/><div class="children"><div class="content">I wonder how this compares to <a href="https:&#x2F;&#x2F;vlcn.io" rel="nofollow noreferrer">https:&#x2F;&#x2F;vlcn.io</a>?</div><br/></div></div><div id="36475729" class="c"><input type="checkbox" id="c-36475729" checked=""/><div class="controls bullet"><span class="by">nsonha</span><span>|</span><a href="#36476769">prev</a><span>|</span><label class="collapse" for="c-36475729">[-]</label><label class="expand" for="c-36475729">[7 more]</label></div><br/><div class="children"><div class="content">How is this that neither the document, nor the comments here address the issue with permission aka one user potentially corrupt other users data</div><br/><div id="36475770" class="c"><input type="checkbox" id="c-36475770" checked=""/><div class="controls bullet"><span class="by">TickleSteve</span><span>|</span><a href="#36475729">parent</a><span>|</span><label class="collapse" for="c-36475770">[-]</label><label class="expand" for="c-36475770">[6 more]</label></div><br/><div class="children"><div class="content">This is sqlite, not a db-server like mysql, its an in-process db that forgoes those sort of issues in the name of performance and lightness.</div><br/><div id="36477035" class="c"><input type="checkbox" id="c-36477035" checked=""/><div class="controls bullet"><span class="by">nsonha</span><span>|</span><a href="#36475729">root</a><span>|</span><a href="#36475770">parent</a><span>|</span><a href="#36476099">next</a><span>|</span><label class="collapse" for="c-36477035">[-]</label><label class="expand" for="c-36477035">[1 more]</label></div><br/><div class="children"><div class="content">yes it did that because sqlite is (was) an embeded db, the whole point of projects like this is to elevate sqlite from that status? NO?</div><br/></div></div><div id="36476099" class="c"><input type="checkbox" id="c-36476099" checked=""/><div class="controls bullet"><span class="by">eyegor</span><span>|</span><a href="#36475729">root</a><span>|</span><a href="#36475770">parent</a><span>|</span><a href="#36477035">prev</a><span>|</span><label class="collapse" for="c-36476099">[-]</label><label class="expand" for="c-36476099">[4 more]</label></div><br/><div class="children"><div class="content">I wish sqlite was performance focused. Perf is pretty much always worse than a db server, even after tuning the pragmas (the way it locks tends to limit single threaded perf and concurrency). Main benefit of sqlite is just its portability since you can easily embed it. It&#x27;s nice for slapping a db backend on a client installed app, where trying to spin up a db server would be problematic.<p>There&#x27;s probably an extension for permissions in sqlite but out of the box the db files are plaintext (you need an extension for that).<p>Good starting point for extensions: <a href="https:&#x2F;&#x2F;antonz.org&#x2F;sqlean&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;antonz.org&#x2F;sqlean&#x2F;</a></div><br/><div id="36476948" class="c"><input type="checkbox" id="c-36476948" checked=""/><div class="controls bullet"><span class="by">matharmin</span><span>|</span><a href="#36475729">root</a><span>|</span><a href="#36476099">parent</a><span>|</span><a href="#36476488">next</a><span>|</span><label class="collapse" for="c-36476948">[-]</label><label class="expand" for="c-36476948">[1 more]</label></div><br/><div class="children"><div class="content">In my experience, SQLite has excellent performance if you use it correctly. It can easily do 10k to 500k inserts&#x2F;second, depending on the workload.<p>SQLite only supports a single writer at a time, but does support concurrent reads. There is also an experimental branch that supports concurrent writes.</div><br/></div></div><div id="36476488" class="c"><input type="checkbox" id="c-36476488" checked=""/><div class="controls bullet"><span class="by">littlecranky67</span><span>|</span><a href="#36475729">root</a><span>|</span><a href="#36476099">parent</a><span>|</span><a href="#36476948">prev</a><span>|</span><a href="#36476396">next</a><span>|</span><label class="collapse" for="c-36476488">[-]</label><label class="expand" for="c-36476488">[1 more]</label></div><br/><div class="children"><div class="content">Any numbers to support that claim? SQLite performs pretty well when just reading. Only write-intensive workloads are usually slower than on pgsql and others.</div><br/></div></div><div id="36476396" class="c"><input type="checkbox" id="c-36476396" checked=""/><div class="controls bullet"><span class="by">fodkodrasz</span><span>|</span><a href="#36475729">root</a><span>|</span><a href="#36476099">parent</a><span>|</span><a href="#36476488">prev</a><span>|</span><label class="collapse" for="c-36476396">[-]</label><label class="expand" for="c-36476396">[1 more]</label></div><br/><div class="children"><div class="content">the SQLite db files are definitely not plain text. (only in a cryptographer&#x27;s jargon, but even that is not true, because they might be encrypted internally using an extension)</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>