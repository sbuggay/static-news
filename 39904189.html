<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712221254621" as="style"/><link rel="stylesheet" href="styles.css?v=1712221254621"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/tonaljs/tonal">Tonal.js: Functional music theory lib</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>brianzelip</span> | <span>35 comments</span></div><br/><div><div id="39928023" class="c"><input type="checkbox" id="c-39928023" checked=""/><div class="controls bullet"><span class="by">iamsaitam</span><span>|</span><a href="#39927765">next</a><span>|</span><label class="collapse" for="c-39928023">[-]</label><label class="expand" for="c-39928023">[1 more]</label></div><br/><div class="children"><div class="content">(shameless plug) If you&#x27;re interested in something more focused on creating music with tools for generating melodies, chord progressions, drum beats, etc., check out PLAYA at <a href="https:&#x2F;&#x2F;github.com&#x2F;ricardomatias&#x2F;playa">https:&#x2F;&#x2F;github.com&#x2F;ricardomatias&#x2F;playa</a></div><br/></div></div><div id="39927765" class="c"><input type="checkbox" id="c-39927765" checked=""/><div class="controls bullet"><span class="by">lodovic</span><span>|</span><a href="#39928023">prev</a><span>|</span><a href="#39923247">next</a><span>|</span><label class="collapse" for="c-39927765">[-]</label><label class="expand" for="c-39927765">[1 more]</label></div><br/><div class="children"><div class="content">This is really nice! I am writing a guitar neck explorer tool to learn the patterns on the guitar neck. As I progress, I need to implement a lot more music theory than I really want to, so I was already looking around for something to integrate. This library will come in very handy. Nice work!</div><br/></div></div><div id="39923247" class="c"><input type="checkbox" id="c-39923247" checked=""/><div class="controls bullet"><span class="by">jarmitage</span><span>|</span><a href="#39927765">prev</a><span>|</span><a href="#39927519">next</a><span>|</span><label class="collapse" for="c-39923247">[-]</label><label class="expand" for="c-39923247">[1 more]</label></div><br/><div class="children"><div class="content">Used in <a href="https:&#x2F;&#x2F;strudel.cc" rel="nofollow">https:&#x2F;&#x2F;strudel.cc</a> (TidalCycles&#x27; JavaScript version)<p>Specifically <a href="https:&#x2F;&#x2F;strudel.cc&#x2F;learn&#x2F;tonal&#x2F;" rel="nofollow">https:&#x2F;&#x2F;strudel.cc&#x2F;learn&#x2F;tonal&#x2F;</a></div><br/></div></div><div id="39927519" class="c"><input type="checkbox" id="c-39927519" checked=""/><div class="controls bullet"><span class="by">justAnotherHero</span><span>|</span><a href="#39923247">prev</a><span>|</span><a href="#39923991">next</a><span>|</span><label class="collapse" for="c-39927519">[-]</label><label class="expand" for="c-39927519">[1 more]</label></div><br/><div class="children"><div class="content">I am currently working on an app with React Native that helps users play along to songs and one of the features needed was displaying the various scales&#x2F;modes on the fretboard so I basically built a mini library of my own to construct the note arrays.<p>This will be a great example to see how the library has handled the same problem.</div><br/></div></div><div id="39923991" class="c"><input type="checkbox" id="c-39923991" checked=""/><div class="controls bullet"><span class="by">unikeko</span><span>|</span><a href="#39927519">prev</a><span>|</span><a href="#39926992">next</a><span>|</span><label class="collapse" for="c-39923991">[-]</label><label class="expand" for="c-39923991">[3 more]</label></div><br/><div class="children"><div class="content">this initially confused me; you might not be aware, but &quot;functional&quot; is a bit overloaded term with regard to music theory, see: functional harmony</div><br/><div id="39925560" class="c"><input type="checkbox" id="c-39925560" checked=""/><div class="controls bullet"><span class="by">eyelidlessness</span><span>|</span><a href="#39923991">parent</a><span>|</span><a href="#39926992">next</a><span>|</span><label class="collapse" for="c-39925560">[-]</label><label class="expand" for="c-39925560">[2 more]</label></div><br/><div class="children"><div class="content">I mean, if the README is representative, “functional” is <i>also</i> appropriate in terms of the programming paradigm.</div><br/><div id="39926087" class="c"><input type="checkbox" id="c-39926087" checked=""/><div class="controls bullet"><span class="by">systoll</span><span>|</span><a href="#39923991">root</a><span>|</span><a href="#39925560">parent</a><span>|</span><a href="#39926992">next</a><span>|</span><label class="collapse" for="c-39926087">[-]</label><label class="expand" for="c-39926087">[1 more]</label></div><br/><div class="children"><div class="content">It’s mostly about the programming paradigm.<p>@tonaljs&#x2F;key gives you some specifically functional info, but the vast bulk of it as useful for non-functional analysis – though it does assume 12-tone equal temperament.</div><br/></div></div></div></div></div></div><div id="39926992" class="c"><input type="checkbox" id="c-39926992" checked=""/><div class="controls bullet"><span class="by">BHSPitMonkey</span><span>|</span><a href="#39923991">prev</a><span>|</span><a href="#39924377">next</a><span>|</span><label class="collapse" for="c-39926992">[-]</label><label class="expand" for="c-39926992">[1 more]</label></div><br/><div class="children"><div class="content">Since we&#x27;re all sharing, I&#x27;ve been using this recently to replace Teoria in an old project of mine (a simple PWA for Duolingo-style sight reading and ear training practice, with MIDI support):<p><a href="https:&#x2F;&#x2F;www.getprelude.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.getprelude.net&#x2F;</a></div><br/></div></div><div id="39924377" class="c"><input type="checkbox" id="c-39924377" checked=""/><div class="controls bullet"><span class="by">grimmdude</span><span>|</span><a href="#39926992">prev</a><span>|</span><a href="#39923486">next</a><span>|</span><label class="collapse" for="c-39924377">[-]</label><label class="expand" for="c-39924377">[1 more]</label></div><br/><div class="children"><div class="content">I love Tonal.js, have used it for many personal projects including <a href="https:&#x2F;&#x2F;github.com&#x2F;grimmdude&#x2F;MidiWriterJS">https:&#x2F;&#x2F;github.com&#x2F;grimmdude&#x2F;MidiWriterJS</a></div><br/></div></div><div id="39923486" class="c"><input type="checkbox" id="c-39923486" checked=""/><div class="controls bullet"><span class="by">duranduran</span><span>|</span><a href="#39924377">prev</a><span>|</span><a href="#39927429">next</a><span>|</span><label class="collapse" for="c-39923486">[-]</label><label class="expand" for="c-39923486">[3 more]</label></div><br/><div class="children"><div class="content">Tonal is great! I use it extensively here: <a href="https:&#x2F;&#x2F;app.bars.ai" rel="nofollow">https:&#x2F;&#x2F;app.bars.ai</a><p>There are a few small areas where the library hiccups, like with bigger chords. I&#x27;ve been able to work around some of those things by reframing the chord as an inversion of N relative to the root of whatever scale I&#x27;m in. I haven&#x27;t bothered to debug why it does that, but my little work around has been sufficient.</div><br/><div id="39924785" class="c"><input type="checkbox" id="c-39924785" checked=""/><div class="controls bullet"><span class="by">CodeIsTheEnd</span><span>|</span><a href="#39923486">parent</a><span>|</span><a href="#39927429">next</a><span>|</span><label class="collapse" for="c-39924785">[-]</label><label class="expand" for="c-39924785">[2 more]</label></div><br/><div class="children"><div class="content">Unsolicited feedback because I clicked:
- Don&#x27;t require picking a composition name before getting started
- Whatever scroll settings you have broke swipe to go back, and then when I tapped the back button I got stuck in an infinite loop between the home page and the create composition page</div><br/><div id="39925027" class="c"><input type="checkbox" id="c-39925027" checked=""/><div class="controls bullet"><span class="by">duranduran</span><span>|</span><a href="#39923486">root</a><span>|</span><a href="#39924785">parent</a><span>|</span><a href="#39927429">next</a><span>|</span><label class="collapse" for="c-39925027">[-]</label><label class="expand" for="c-39925027">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for testing it out! You&#x27;re the third person to give me that feedback on the composition name on launch. I&#x27;ll delete that step.<p>On back navigation, that&#x27;s really bad bug! I&#x27;ll repro it and fix. Thanks for finding that!</div><br/></div></div></div></div></div></div><div id="39927429" class="c"><input type="checkbox" id="c-39927429" checked=""/><div class="controls bullet"><span class="by">kerneloops</span><span>|</span><a href="#39923486">prev</a><span>|</span><a href="#39923260">next</a><span>|</span><label class="collapse" for="c-39927429">[-]</label><label class="expand" for="c-39927429">[1 more]</label></div><br/><div class="children"><div class="content">See also: Well-typed music does not sound wrong (experience report), Haskell 2017<p><a href="https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3122955.3122964" rel="nofollow">https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3122955.3122964</a></div><br/></div></div><div id="39923260" class="c"><input type="checkbox" id="c-39923260" checked=""/><div class="controls bullet"><span class="by">hasty_pudding</span><span>|</span><a href="#39927429">prev</a><span>|</span><a href="#39924628">next</a><span>|</span><label class="collapse" for="c-39923260">[-]</label><label class="expand" for="c-39923260">[11 more]</label></div><br/><div class="children"><div class="content">&quot;all functions are pure, there is no data mutation, and entities are represented by data structures instead of objects.&quot;<p>God i love to see this</div><br/><div id="39923326" class="c"><input type="checkbox" id="c-39923326" checked=""/><div class="controls bullet"><span class="by">recursive</span><span>|</span><a href="#39923260">parent</a><span>|</span><a href="#39924628">next</a><span>|</span><label class="collapse" for="c-39923326">[-]</label><label class="expand" for="c-39923326">[10 more]</label></div><br/><div class="children"><div class="content">In javascript, what data structure can you implement without objects?  Pretty much nothing.  Even arrays are objects.</div><br/><div id="39923431" class="c"><input type="checkbox" id="c-39923431" checked=""/><div class="controls bullet"><span class="by">metaxy2</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39923326">parent</a><span>|</span><a href="#39924161">next</a><span>|</span><label class="collapse" for="c-39923431">[-]</label><label class="expand" for="c-39923431">[7 more]</label></div><br/><div class="children"><div class="content">They&#x27;re using objects, including arrays [1], so I think they would have been more precise to say that they&#x27;re using objects and arrays as simple data structures rather than using OO features like inheritance and mutation.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages&#x2F;chord&#x2F;index.ts">https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages&#x2F;chord&#x2F;in...</a></div><br/><div id="39924006" class="c"><input type="checkbox" id="c-39924006" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39923431">parent</a><span>|</span><a href="#39924161">next</a><span>|</span><label class="collapse" for="c-39924006">[-]</label><label class="expand" for="c-39924006">[6 more]</label></div><br/><div class="children"><div class="content">This is just semantics then. If you&#x27;re implementing a linked list or a tree without a class (or at the very least a function that behaves like a class), it&#x27;s going to be awkward and clumsy.<p>Data-structures beyond what the standard lib gives you (string and array) are the main reason the addition of classes to JS was so helpful.</div><br/><div id="39927481" class="c"><input type="checkbox" id="c-39927481" checked=""/><div class="controls bullet"><span class="by">kamov</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924006">parent</a><span>|</span><a href="#39924114">next</a><span>|</span><label class="collapse" for="c-39927481">[-]</label><label class="expand" for="c-39927481">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t quite right, linked lists and trees in functional languages can be represented extremely succintly, i.e.<p><pre><code>  data List a = Nil | Node a (List a)
  data Tree a = Leaf a | Node (Tree a) (Tree a)
</code></pre>
there is nothing stopping you from writing something like this in JS<p><pre><code>  const list = { kind: &#x27;node&#x27;, val: 3, next: { kind: &#x27;nil&#x27; } };
</code></pre>
And then using a switch case to navigate the list&#x2F;tree matching on the kind field.</div><br/></div></div><div id="39924114" class="c"><input type="checkbox" id="c-39924114" checked=""/><div class="controls bullet"><span class="by">eitacaraleo</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924006">parent</a><span>|</span><a href="#39927481">prev</a><span>|</span><a href="#39924161">next</a><span>|</span><label class="collapse" for="c-39924114">[-]</label><label class="expand" for="c-39924114">[4 more]</label></div><br/><div class="children"><div class="content">Uh… what? It’s quite the opposite; why would you need a class for linked lists and trees?</div><br/><div id="39924777" class="c"><input type="checkbox" id="c-39924777" checked=""/><div class="controls bullet"><span class="by">recursive</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924114">parent</a><span>|</span><a href="#39924281">next</a><span>|</span><label class="collapse" for="c-39924777">[-]</label><label class="expand" for="c-39924777">[1 more]</label></div><br/><div class="children"><div class="content">To provide an easy place to find the behaviors that are included with those data structures.</div><br/></div></div><div id="39924281" class="c"><input type="checkbox" id="c-39924281" checked=""/><div class="controls bullet"><span class="by">hasty_pudding</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924114">parent</a><span>|</span><a href="#39924777">prev</a><span>|</span><a href="#39924161">next</a><span>|</span><label class="collapse" for="c-39924281">[-]</label><label class="expand" for="c-39924281">[2 more]</label></div><br/><div class="children"><div class="content">You definitely need generic node objects to define the nodes.<p>You could have a completely stateless class&#x2F;object that would manipulate those nodes and add them and remove them from the data structure.</div><br/><div id="39925497" class="c"><input type="checkbox" id="c-39925497" checked=""/><div class="controls bullet"><span class="by">metaxy2</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924281">parent</a><span>|</span><a href="#39924161">next</a><span>|</span><label class="collapse" for="c-39925497">[-]</label><label class="expand" for="c-39925497">[1 more]</label></div><br/><div class="children"><div class="content">Well, in principle you could have the node objects be created with an object literal in an outside builder function, and the manipulation also be done by outside functions. That&#x27;s how it&#x27;s done in languages without OOP. The question is how far are you willing to go to avoid doing anything that looks like OOP.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39924161" class="c"><input type="checkbox" id="c-39924161" checked=""/><div class="controls bullet"><span class="by">hasty_pudding</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39923326">parent</a><span>|</span><a href="#39923431">prev</a><span>|</span><a href="#39924628">next</a><span>|</span><label class="collapse" for="c-39924161">[-]</label><label class="expand" for="c-39924161">[2 more]</label></div><br/><div class="children"><div class="content">What they mean is functions and data are separate, emulating a more functional paradigm and less mutable state.<p>The functions are kept pure and the data is kept pure.<p>As opposed to an object oriented programming style in which data and functions share the same object and create bug ridden state machines thats not as easy to reason about.<p>Some further explanation about this:<p><a href="https:&#x2F;&#x2F;www.goodreads.com&#x2F;quotes&#x2F;702062-immutable-objects-are-simple-they-can-only-be-in-one" rel="nofollow">https:&#x2F;&#x2F;www.goodreads.com&#x2F;quotes&#x2F;702062-immutable-objects-ar...</a><p>a semi-nuanced discussion:<p><a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;scala&#x2F;comments&#x2F;ejwsp1&#x2F;is_mutability_really_that_bad&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;scala&#x2F;comments&#x2F;ejwsp1&#x2F;is_mutability...</a><p>you can just Google mutable state to find more info.<p>separating your data structures and functions in many cases will make your code cleaner and more bug free.</div><br/><div id="39924751" class="c"><input type="checkbox" id="c-39924751" checked=""/><div class="controls bullet"><span class="by">recursive</span><span>|</span><a href="#39923260">root</a><span>|</span><a href="#39924161">parent</a><span>|</span><a href="#39924628">next</a><span>|</span><label class="collapse" for="c-39924751">[-]</label><label class="expand" for="c-39924751">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m well aware of the pros and cons of mutability.  I object (hah!) to this novel new use of the word &quot;object&quot;.  The concept is well defined by the ECMAScript spec.<p>Your first link&#x27;s first sentence&#x27;s first two words are &quot;Immutable objects&quot;.  No problem there.  It doesn&#x27;t conflate objects with mutability.</div><br/></div></div></div></div></div></div></div></div><div id="39924628" class="c"><input type="checkbox" id="c-39924628" checked=""/><div class="controls bullet"><span class="by">cushpush</span><span>|</span><a href="#39923260">prev</a><span>|</span><a href="#39924336">next</a><span>|</span><label class="collapse" for="c-39924628">[-]</label><label class="expand" for="c-39924628">[3 more]</label></div><br/><div class="children"><div class="content">Can I set the tuning to A=432Hz ?</div><br/><div id="39924961" class="c"><input type="checkbox" id="c-39924961" checked=""/><div class="controls bullet"><span class="by">ysofunny</span><span>|</span><a href="#39924628">parent</a><span>|</span><a href="#39924336">next</a><span>|</span><label class="collapse" for="c-39924961">[-]</label><label class="expand" for="c-39924961">[2 more]</label></div><br/><div class="children"><div class="content">yes, it doesn&#x27;t really matter at all for this kind of system<p>you can set it to zero, to negative one... possibly to the imaginary constant<p>because this library does not actually make any sound. it&#x27;s (to me) an implementation of 12tet, the standard western scale system which includes a bunch of scales and approximates the rest &#x27;well&#x27; enough</div><br/><div id="39926960" class="c"><input type="checkbox" id="c-39926960" checked=""/><div class="controls bullet"><span class="by">hunter2_</span><span>|</span><a href="#39924628">root</a><span>|</span><a href="#39924961">parent</a><span>|</span><a href="#39924336">next</a><span>|</span><label class="collapse" for="c-39926960">[-]</label><label class="expand" for="c-39926960">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t mean to lose my &#x27;temper&#x27; here, but I think gp is hoping Note.freq(), Note.fromFreq(), etc. aren&#x27;t locked into A440 as the examples imply. While &gt;99% of the library doesn&#x27;t deal with this at all, it would be handy nonetheless. Unfortunately, it&#x27;s currently hard coded:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages%2Fpitch-note%2Findex.ts#L126">https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages%2Fpitch-...</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages%2Fmidi%2Findex.ts#L47">https:&#x2F;&#x2F;github.com&#x2F;tonaljs&#x2F;tonal&#x2F;blob&#x2F;main&#x2F;packages%2Fmidi%2...</a></div><br/></div></div></div></div></div></div><div id="39924336" class="c"><input type="checkbox" id="c-39924336" checked=""/><div class="controls bullet"><span class="by">hannibalekta</span><span>|</span><a href="#39924628">prev</a><span>|</span><a href="#39925550">next</a><span>|</span><label class="collapse" for="c-39924336">[-]</label><label class="expand" for="c-39924336">[1 more]</label></div><br/><div class="children"><div class="content">Im working on a music learning app to study jazz licks and this is exactly what I needed. Thanks!</div><br/></div></div><div id="39925550" class="c"><input type="checkbox" id="c-39925550" checked=""/><div class="controls bullet"><span class="by">Freedom2</span><span>|</span><a href="#39924336">prev</a><span>|</span><a href="#39924407">next</a><span>|</span><label class="collapse" for="c-39925550">[-]</label><label class="expand" for="c-39925550">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for this! I&#x27;ve recently been exploring how to write a SATB four part harmony for a given melody &#x2F; bass line, this takes a decent chunk of the boilerplate out for me.</div><br/></div></div><div id="39924407" class="c"><input type="checkbox" id="c-39924407" checked=""/><div class="controls bullet"><span class="by">demondemidi</span><span>|</span><a href="#39925550">prev</a><span>|</span><a href="#39923429">next</a><span>|</span><label class="collapse" for="c-39924407">[-]</label><label class="expand" for="c-39924407">[3 more]</label></div><br/><div class="children"><div class="content">Surprised it doesn’t account for tempering given it is so comprehensive.</div><br/><div id="39925264" class="c"><input type="checkbox" id="c-39925264" checked=""/><div class="controls bullet"><span class="by">giraffe_lady</span><span>|</span><a href="#39924407">parent</a><span>|</span><a href="#39923429">next</a><span>|</span><label class="collapse" for="c-39925264">[-]</label><label class="expand" for="c-39925264">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it matters at this abstraction layer? You reason about intervals, scales, chords etc the same regardless of the tuning system. That only matters for sound production, which this doesn&#x27;t do.<p>It definitely assumes you&#x27;re on a 12-tone system so is really only useful within western european music theory. But that is usually what people mean when they say &quot;music theory&quot; anyway.</div><br/><div id="39926974" class="c"><input type="checkbox" id="c-39926974" checked=""/><div class="controls bullet"><span class="by">hunter2_</span><span>|</span><a href="#39924407">root</a><span>|</span><a href="#39925264">parent</a><span>|</span><a href="#39923429">next</a><span>|</span><label class="collapse" for="c-39926974">[-]</label><label class="expand" for="c-39926974">[1 more]</label></div><br/><div class="children"><div class="content">It matters for just one tiny aspect of the library: Note.freq(), Note.fromFreq(), etc.</div><br/></div></div></div></div></div></div><div id="39923429" class="c"><input type="checkbox" id="c-39923429" checked=""/><div class="controls bullet"><span class="by">smrtinsert</span><span>|</span><a href="#39924407">prev</a><span>|</span><label class="collapse" for="c-39923429">[-]</label><label class="expand" for="c-39923429">[2 more]</label></div><br/><div class="children"><div class="content">Wonderful.  Wanted something like this forever.   Glad it exists</div><br/></div></div></div></div></div></div></div></body></html>