<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725958871810" as="style"/><link rel="stylesheet" href="styles.css?v=1725958871810"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sqlc.dev/">Sqlc: Compile SQL to type-safe code</a> <span class="domain">(<a href="https://sqlc.dev">sqlc.dev</a>)</span></div><div class="subtext"><span>wsc981</span> | <span>67 comments</span></div><br/><div><div id="41497105" class="c"><input type="checkbox" id="c-41497105" checked=""/><div class="controls bullet"><span class="by">seer</span><span>|</span><a href="#41498689">next</a><span>|</span><label class="collapse" for="c-41497105">[-]</label><label class="expand" for="c-41497105">[13 more]</label></div><br/><div class="children"><div class="content">There was a saying that before learning postgres in depth, the db is just a dumb store of data for devs, once you spend time to learn the tools it provides though, most applications just look like a very thin layer on top of the sql.<p>There is so much more to rdbms (especially pg) than just joins - common table expressions, window functions, various views, let alone all the extensibility - extensions, custom types, even enums.<p>All of that can enable writing performant, type safe and very compact applications.<p>I am yet to see libs that embrace the elegance of it all - I’ve attempted this once - <a href="https:&#x2F;&#x2F;github.com&#x2F;ivank&#x2F;potygen">https:&#x2F;&#x2F;github.com&#x2F;ivank&#x2F;potygen</a> but didn’t get much traction. I’m now just waiting for someone more determined to pick up those ideas - a client lib that exposes the type safety and intellisence at compile time and allows you to easily compose those sql queries.<p>I think this project has some ways to go to reach that though, but thankfully it is a step in the right direction.</div><br/><div id="41497775" class="c"><input type="checkbox" id="c-41497775" checked=""/><div class="controls bullet"><span class="by">Nugget0</span><span>|</span><a href="#41497105">parent</a><span>|</span><a href="#41498309">next</a><span>|</span><label class="collapse" for="c-41497775">[-]</label><label class="expand" for="c-41497775">[6 more]</label></div><br/><div class="children"><div class="content">This is what jOOQ does. Best SQL library I&#x27;ve ever used. <a href="https:&#x2F;&#x2F;www.jooq.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.jooq.org&#x2F;</a></div><br/><div id="41498268" class="c"><input type="checkbox" id="c-41498268" checked=""/><div class="controls bullet"><span class="by">cies</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41497775">parent</a><span>|</span><a href="#41498135">next</a><span>|</span><label class="collapse" for="c-41498268">[-]</label><label class="expand" for="c-41498268">[4 more]</label></div><br/><div class="children"><div class="content">We use jOOQ, and love it. But sqlc also makes nice trade offs. I see it does Kotlin generation: if this lib was around when we picked jOOQ, I&#x27;s certainly had considered it.<p>Differences:<p>* jOOQ is an eDSL with an optional schema-to-classes generator<p>* you write jOOQ queries in Java (or Kotlin as we do)<p>* there&#x27;s quite a bit of type-safety added when using the generator: the schema needs to be match the queries you write or you get compile errors<p>* jOOQ queries are built are run time adding a little overhead that sqlc does not<p>* writing jOOQ is very close writing SQL (a very thin abstraction), sqlc is &quot;just SQL&quot; it seems</div><br/><div id="41498295" class="c"><input type="checkbox" id="c-41498295" checked=""/><div class="controls bullet"><span class="by">refset</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498268">parent</a><span>|</span><a href="#41498135">next</a><span>|</span><label class="collapse" for="c-41498295">[-]</label><label class="expand" for="c-41498295">[3 more]</label></div><br/><div class="children"><div class="content">Yep sqlc is more akin to Kotlin&#x27;s SQLDelight <a href="https:&#x2F;&#x2F;github.com&#x2F;cashapp&#x2F;sqldelight">https:&#x2F;&#x2F;github.com&#x2F;cashapp&#x2F;sqldelight</a></div><br/><div id="41498338" class="c"><input type="checkbox" id="c-41498338" checked=""/><div class="controls bullet"><span class="by">cies</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498295">parent</a><span>|</span><a href="#41498135">next</a><span>|</span><label class="collapse" for="c-41498338">[-]</label><label class="expand" for="c-41498338">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a really nice project indeed. We looked at it I remember, when we pciked jOOQ, but it was too new to bet the farm on back then. It progressed really nicely.</div><br/><div id="41498513" class="c"><input type="checkbox" id="c-41498513" checked=""/><div class="controls bullet"><span class="by">refset</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498338">parent</a><span>|</span><a href="#41498135">next</a><span>|</span><label class="collapse" for="c-41498513">[-]</label><label class="expand" for="c-41498513">[1 more]</label></div><br/><div class="children"><div class="content">Building on top of IntelliJ&#x27;s parser and &#x27;PSI&#x27; stack as a headless engine sounds slightly mad at first but seems to provide a lot of leverage, as demonstrated by the number of dialects the team is able to support via mixins. By contrast sqlc appears to require a lot of code to support each additional dialect.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41498309" class="c"><input type="checkbox" id="c-41498309" checked=""/><div class="controls bullet"><span class="by">whizzter</span><span>|</span><a href="#41497105">parent</a><span>|</span><a href="#41497775">prev</a><span>|</span><a href="#41498298">next</a><span>|</span><label class="collapse" for="c-41498309">[-]</label><label class="expand" for="c-41498309">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re into JS there was an query builder posted a few days back that was fairly closely mapped to SQL, it in turn was inspired by Linq (and EFCore behind it).<p>I didn&#x27;t look forward to working with C# initially but Linq has been a fresh air since your statements more or less map 1:1 to SQL and probably quite overlooked because of &quot;Microsoft&quot;(and that Linq with old EF could have nasty surprises).<p>What people don&#x27;t know&#x2F;realize is that because Linq expressions in C# are left &quot;uncompiled&quot; they can be passed to the SQL layers and converted to idiomatic SQL, so you have all the typesafety of C# and regular C# code but get SQL code that is executed on the server (there is some minor impedance mismatch but it&#x27;s minor enough and mainly with strings).<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41455719">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41455719</a></div><br/></div></div><div id="41498298" class="c"><input type="checkbox" id="c-41498298" checked=""/><div class="controls bullet"><span class="by">alabhyajindal</span><span>|</span><a href="#41497105">parent</a><span>|</span><a href="#41498309">prev</a><span>|</span><a href="#41498055">next</a><span>|</span><label class="collapse" for="c-41498298">[-]</label><label class="expand" for="c-41498298">[2 more]</label></div><br/><div class="children"><div class="content">I keep hearing about how powerful pg is. It would be great to see an example application that uses all it&#x27;s features.</div><br/><div id="41498563" class="c"><input type="checkbox" id="c-41498563" checked=""/><div class="controls bullet"><span class="by">refset</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498298">parent</a><span>|</span><a href="#41498055">next</a><span>|</span><label class="collapse" for="c-41498563">[-]</label><label class="expand" for="c-41498563">[1 more]</label></div><br/><div class="children"><div class="content">Possibly close enough: <a href="https:&#x2F;&#x2F;github.com&#x2F;omnigres&#x2F;omnigres">https:&#x2F;&#x2F;github.com&#x2F;omnigres&#x2F;omnigres</a></div><br/></div></div></div></div><div id="41498055" class="c"><input type="checkbox" id="c-41498055" checked=""/><div class="controls bullet"><span class="by">mewpmewp2</span><span>|</span><a href="#41497105">parent</a><span>|</span><a href="#41498298">prev</a><span>|</span><a href="#41498689">next</a><span>|</span><label class="collapse" for="c-41498055">[-]</label><label class="expand" for="c-41498055">[3 more]</label></div><br/><div class="children"><div class="content">It would be great to have some sort of sql string to type parsing as some sort of plugin to TypeScript.</div><br/><div id="41498164" class="c"><input type="checkbox" id="c-41498164" checked=""/><div class="controls bullet"><span class="by">user432678</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498055">parent</a><span>|</span><a href="#41498689">next</a><span>|</span><label class="collapse" for="c-41498164">[-]</label><label class="expand" for="c-41498164">[2 more]</label></div><br/><div class="children"><div class="content">Didn’t use myself, but AFAIK slonik library is doing what you’ve described: <a href="https:&#x2F;&#x2F;github.com&#x2F;gajus&#x2F;slonik">https:&#x2F;&#x2F;github.com&#x2F;gajus&#x2F;slonik</a></div><br/><div id="41498658" class="c"><input type="checkbox" id="c-41498658" checked=""/><div class="controls bullet"><span class="by">mewpmewp2</span><span>|</span><a href="#41497105">root</a><span>|</span><a href="#41498164">parent</a><span>|</span><a href="#41498689">next</a><span>|</span><label class="collapse" for="c-41498658">[-]</label><label class="expand" for="c-41498658">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t seem to be doing what I meant. I mean typing compile time and most importantly while using the IDE. Without having to generate types manually or importing them from a generated file.</div><br/></div></div></div></div></div></div></div></div><div id="41498689" class="c"><input type="checkbox" id="c-41498689" checked=""/><div class="controls bullet"><span class="by">sorenbs</span><span>|</span><a href="#41497105">prev</a><span>|</span><a href="#41498058">next</a><span>|</span><label class="collapse" for="c-41498689">[-]</label><label class="expand" for="c-41498689">[1 more]</label></div><br/><div class="children"><div class="content">[delayed]</div><br/></div></div><div id="41498058" class="c"><input type="checkbox" id="c-41498058" checked=""/><div class="controls bullet"><span class="by">tlonny</span><span>|</span><a href="#41498689">prev</a><span>|</span><a href="#41497799">next</a><span>|</span><label class="collapse" for="c-41498058">[-]</label><label class="expand" for="c-41498058">[4 more]</label></div><br/><div class="children"><div class="content">Surprised nobody has mentioned “Kysely” (<a href="https:&#x2F;&#x2F;kysely.dev" rel="nofollow">https:&#x2F;&#x2F;kysely.dev</a>).<p>It is a query builder (not an ORM), that (ab)-uses the Typescript type system to give you full type safety, intellisense, autocomplete etc.<p>Crucially it doesn’t require any build&#x2F;compile step for your queries which is fantastic.</div><br/><div id="41498288" class="c"><input type="checkbox" id="c-41498288" checked=""/><div class="controls bullet"><span class="by">cies</span><span>|</span><a href="#41498058">parent</a><span>|</span><a href="#41497799">next</a><span>|</span><label class="collapse" for="c-41498288">[-]</label><label class="expand" for="c-41498288">[3 more]</label></div><br/><div class="children"><div class="content">I had a look. It says it&#x27;s type safe but I see strings everywhere. It seems the IDE can autocomplete the strings, but does that count as type safety nowadays?<p>(How does the IDE do the autocomplete on strings? Will the compiler also catch &quot;bad strings&quot;?)<p>Otherwise it looks much like jOOQ but without the &quot;jOOQ generator&quot; (which adds most of the type safety).</div><br/><div id="41498581" class="c"><input type="checkbox" id="c-41498581" checked=""/><div class="controls bullet"><span class="by">moritzruth</span><span>|</span><a href="#41498058">root</a><span>|</span><a href="#41498288">parent</a><span>|</span><a href="#41498603">next</a><span>|</span><label class="collapse" for="c-41498581">[-]</label><label class="expand" for="c-41498581">[1 more]</label></div><br/><div class="children"><div class="content">TypeScript has literal types: <a href="https:&#x2F;&#x2F;www.typescriptlang.org&#x2F;docs&#x2F;handbook&#x2F;2&#x2F;everyday-types.html#literal-types" rel="nofollow">https:&#x2F;&#x2F;www.typescriptlang.org&#x2F;docs&#x2F;handbook&#x2F;2&#x2F;everyday-type...</a></div><br/></div></div><div id="41498603" class="c"><input type="checkbox" id="c-41498603" checked=""/><div class="controls bullet"><span class="by">xide</span><span>|</span><a href="#41498058">root</a><span>|</span><a href="#41498288">parent</a><span>|</span><a href="#41498581">prev</a><span>|</span><a href="#41497799">next</a><span>|</span><label class="collapse" for="c-41498603">[-]</label><label class="expand" for="c-41498603">[1 more]</label></div><br/><div class="children"><div class="content">Every string (literal type) passed to Kysely functions is strictly typed and the compiler will fail if something invalid is passed.</div><br/></div></div></div></div></div></div><div id="41497799" class="c"><input type="checkbox" id="c-41497799" checked=""/><div class="controls bullet"><span class="by">gzel</span><span>|</span><a href="#41498058">prev</a><span>|</span><a href="#41494876">next</a><span>|</span><label class="collapse" for="c-41497799">[-]</label><label class="expand" for="c-41497799">[1 more]</label></div><br/><div class="children"><div class="content">This is somewhat common when high performance is needed it seems: e.g., <a href="https:&#x2F;&#x2F;github.com&#x2F;feldera&#x2F;feldera">https:&#x2F;&#x2F;github.com&#x2F;feldera&#x2F;feldera</a> comes to mind which uses the same approach to compile SQL to type-safe incremental query plans in rust.</div><br/></div></div><div id="41494876" class="c"><input type="checkbox" id="c-41494876" checked=""/><div class="controls bullet"><span class="by">geoka9</span><span>|</span><a href="#41497799">prev</a><span>|</span><a href="#41497622">next</a><span>|</span><label class="collapse" for="c-41494876">[-]</label><label class="expand" for="c-41494876">[19 more]</label></div><br/><div class="children"><div class="content">Have been enjoying go-jet that takes a different approach: analyzes the tables in your DB and generates a set of Golang structs that lets you write 100% Golang code that looks like 99% SQL. Genius!<p><a href="https:&#x2F;&#x2F;github.com&#x2F;go-jet&#x2F;jet">https:&#x2F;&#x2F;github.com&#x2F;go-jet&#x2F;jet</a></div><br/><div id="41495200" class="c"><input type="checkbox" id="c-41495200" checked=""/><div class="controls bullet"><span class="by">sonu27</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41496293">next</a><span>|</span><label class="collapse" for="c-41495200">[-]</label><label class="expand" for="c-41495200">[1 more]</label></div><br/><div class="children"><div class="content">Sqlboiler takes a similar approach <a href="https:&#x2F;&#x2F;github.com&#x2F;volatiletech&#x2F;sqlboiler">https:&#x2F;&#x2F;github.com&#x2F;volatiletech&#x2F;sqlboiler</a></div><br/></div></div><div id="41496293" class="c"><input type="checkbox" id="c-41496293" checked=""/><div class="controls bullet"><span class="by">amw-zero</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41495200">prev</a><span>|</span><a href="#41496423">next</a><span>|</span><label class="collapse" for="c-41496293">[-]</label><label class="expand" for="c-41496293">[3 more]</label></div><br/><div class="children"><div class="content">There’s nothing unique about go-jet. Jooq does the same thing for example.</div><br/><div id="41496350" class="c"><input type="checkbox" id="c-41496350" checked=""/><div class="controls bullet"><span class="by">victor106</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41496293">parent</a><span>|</span><a href="#41496428">prev</a><span>|</span><a href="#41496423">next</a><span>|</span><label class="collapse" for="c-41496350">[-]</label><label class="expand" for="c-41496350">[1 more]</label></div><br/><div class="children"><div class="content">Jooq is amazing.</div><br/></div></div></div></div><div id="41496423" class="c"><input type="checkbox" id="c-41496423" checked=""/><div class="controls bullet"><span class="by">xarope</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41496293">prev</a><span>|</span><a href="#41495959">next</a><span>|</span><label class="collapse" for="c-41496423">[-]</label><label class="expand" for="c-41496423">[1 more]</label></div><br/><div class="children"><div class="content">+1 for go-jet. I came from python and sqlalchemy, where I used the declarative form to generate dynamic SQL (vs using the ORM, since I am fine with SQL) and go-jet allows me to do something similar in Go.<p>I wish go-jet would also start supporting duckdb, since I am exploring more local-first DB apps using sqlite, with duckdb as the query engine.</div><br/></div></div><div id="41495959" class="c"><input type="checkbox" id="c-41495959" checked=""/><div class="controls bullet"><span class="by">Cyph0n</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41496423">prev</a><span>|</span><a href="#41496790">next</a><span>|</span><label class="collapse" for="c-41495959">[-]</label><label class="expand" for="c-41495959">[5 more]</label></div><br/><div class="children"><div class="content">Interesting. What happens if your schema is rolled back (e.g., to remove a new column), but your binary isn’t? Or is the idea to always deploy schema rollbacks alongside your binary?<p>Edit: Also, curious about how this would work with a progressive schema rollout across environments - e.g., staging vs. prod DB. Do you need to “wait” for your new column to hit prod before you can use it in unit tests?</div><br/><div id="41496421" class="c"><input type="checkbox" id="c-41496421" checked=""/><div class="controls bullet"><span class="by">taberiand</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495959">parent</a><span>|</span><a href="#41496032">next</a><span>|</span><label class="collapse" for="c-41496421">[-]</label><label class="expand" for="c-41496421">[2 more]</label></div><br/><div class="children"><div class="content">At a basic level - database migrations must be backwards compatible at least with the previous version, and they go out before the service update is deployed.<p>Unit tests don&#x27;t run direct against prod usually, but regardless they would be run after migrations to a database of (production schema+migrations). Each environment - dev, test, staging, prod has its own db. Even spinning up an ephemeral db per test is possible, and easy with containers.<p>YMMV as system complexity increases, but by then there should be whole team(s) managing the issue</div><br/></div></div><div id="41496032" class="c"><input type="checkbox" id="c-41496032" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495959">parent</a><span>|</span><a href="#41496421">prev</a><span>|</span><a href="#41496790">next</a><span>|</span><label class="collapse" for="c-41496032">[-]</label><label class="expand" for="c-41496032">[2 more]</label></div><br/><div class="children"><div class="content">Or just don&#x27;t do schema rollbacks.<p>We allow customers to run old versions if our program against an upgraded database, and to do that we just don&#x27;t do destructive schema changes.</div><br/><div id="41496813" class="c"><input type="checkbox" id="c-41496813" checked=""/><div class="controls bullet"><span class="by">Cyph0n</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41496032">parent</a><span>|</span><a href="#41496790">next</a><span>|</span><label class="collapse" for="c-41496813">[-]</label><label class="expand" for="c-41496813">[1 more]</label></div><br/><div class="children"><div class="content">I suppose that’s one option. But sometimes you want the ability to rollback on bad or potentially destructive schema changes.</div><br/></div></div></div></div></div></div><div id="41496790" class="c"><input type="checkbox" id="c-41496790" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41495959">prev</a><span>|</span><a href="#41495932">next</a><span>|</span><label class="collapse" for="c-41496790">[-]</label><label class="expand" for="c-41496790">[1 more]</label></div><br/><div class="children"><div class="content">JET doesn&#x27;t support typesafe result mapping, or typesafe table joins, I believe. And it&#x27;s not possible to do that in Go without some heavy-handed code generation. A better comparison is probably Hibernate and QueryDSL in Java.</div><br/></div></div><div id="41495932" class="c"><input type="checkbox" id="c-41495932" checked=""/><div class="controls bullet"><span class="by">valzam</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41496790">prev</a><span>|</span><a href="#41495149">next</a><span>|</span><label class="collapse" for="c-41495932">[-]</label><label class="expand" for="c-41495932">[3 more]</label></div><br/><div class="children"><div class="content">SQLC has the same functionality, it does two things:<p>- Create structs for your custom queries
- Create structs for your DB tables if you point it at a DB</div><br/><div id="41496214" class="c"><input type="checkbox" id="c-41496214" checked=""/><div class="controls bullet"><span class="by">gregwebs</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495932">parent</a><span>|</span><a href="#41495149">next</a><span>|</span><label class="collapse" for="c-41496214">[-]</label><label class="expand" for="c-41496214">[2 more]</label></div><br/><div class="children"><div class="content">Jet was built for joins though- sqlc doesn’t seem able to do those.</div><br/><div id="41496234" class="c"><input type="checkbox" id="c-41496234" checked=""/><div class="controls bullet"><span class="by">mrastro</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41496214">parent</a><span>|</span><a href="#41495149">next</a><span>|</span><label class="collapse" for="c-41496234">[-]</label><label class="expand" for="c-41496234">[1 more]</label></div><br/><div class="children"><div class="content">It can do joins. By default it combines the query into a single flatten struct but you have the option to write the query to embed entities in the join.<p>Not perfect and doesn&#x27;t maintain the same type if you want a subset of columns but works for the majority of cases.</div><br/></div></div></div></div></div></div><div id="41495149" class="c"><input type="checkbox" id="c-41495149" checked=""/><div class="controls bullet"><span class="by">desiderantes</span><span>|</span><a href="#41494876">parent</a><span>|</span><a href="#41495932">prev</a><span>|</span><a href="#41497622">next</a><span>|</span><label class="collapse" for="c-41495149">[-]</label><label class="expand" for="c-41495149">[4 more]</label></div><br/><div class="children"><div class="content">Oh, so it&#x27;s jOOQ but for Go. Nice. Sadly it does not support most custom Postgres things.</div><br/><div id="41495722" class="c"><input type="checkbox" id="c-41495722" checked=""/><div class="controls bullet"><span class="by">renhanxue</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495149">parent</a><span>|</span><a href="#41495385">next</a><span>|</span><label class="collapse" for="c-41495722">[-]</label><label class="expand" for="c-41495722">[1 more]</label></div><br/><div class="children"><div class="content">I think the next release is gonna give you a lot of flexibility to write your own helpers that can generate the raw fragments you need. Not as good as having the features built in of course, but it&#x27;ll do in a pinch.<p>jOOQ and jOOQ-like API&#x27;s in other languages are the Right Thing in most cases, IMO. I&#x27;ve worked with very abstract ORM&#x27;s, I&#x27;ve worked with raw SQL, and I&#x27;ve worked with a lot of things somewhere in between and that&#x27;s my conclusion.</div><br/></div></div><div id="41495385" class="c"><input type="checkbox" id="c-41495385" checked=""/><div class="controls bullet"><span class="by">llimllib</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495149">parent</a><span>|</span><a href="#41495722">prev</a><span>|</span><a href="#41496360">next</a><span>|</span><label class="collapse" for="c-41495385">[-]</label><label class="expand" for="c-41495385">[1 more]</label></div><br/><div class="children"><div class="content">XO doesn’t have them built-in, but it uses easily customizable templates.<p>I added support for a bunch of postgres fancy stuff in a previous app, it wasn’t too difficult<p><a href="https:&#x2F;&#x2F;github.com&#x2F;xo&#x2F;xo">https:&#x2F;&#x2F;github.com&#x2F;xo&#x2F;xo</a></div><br/></div></div><div id="41496360" class="c"><input type="checkbox" id="c-41496360" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#41494876">root</a><span>|</span><a href="#41495149">parent</a><span>|</span><a href="#41495385">prev</a><span>|</span><a href="#41497622">next</a><span>|</span><label class="collapse" for="c-41496360">[-]</label><label class="expand" for="c-41496360">[1 more]</label></div><br/><div class="children"><div class="content">Supports COPY and pipelining, and all custom data types. I very rarely need to drop out of sqlc-generated code. What else could you want?</div><br/></div></div></div></div></div></div><div id="41497622" class="c"><input type="checkbox" id="c-41497622" checked=""/><div class="controls bullet"><span class="by">ruuda</span><span>|</span><a href="#41494876">prev</a><span>|</span><a href="#41498378">next</a><span>|</span><label class="collapse" for="c-41497622">[-]</label><label class="expand" for="c-41497622">[1 more]</label></div><br/><div class="children"><div class="content">To add one to the mix: <a href="https:&#x2F;&#x2F;docs.ruuda.nl&#x2F;squiller&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.ruuda.nl&#x2F;squiller&#x2F;</a></div><br/></div></div><div id="41498378" class="c"><input type="checkbox" id="c-41498378" checked=""/><div class="controls bullet"><span class="by">vegancap</span><span>|</span><a href="#41497622">prev</a><span>|</span><a href="#41494936">next</a><span>|</span><label class="collapse" for="c-41498378">[-]</label><label class="expand" for="c-41498378">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been using this a lot lately, including in a new project at work, and it&#x27;s such a joy to use</div><br/></div></div><div id="41494936" class="c"><input type="checkbox" id="c-41494936" checked=""/><div class="controls bullet"><span class="by">pier25</span><span>|</span><a href="#41498378">prev</a><span>|</span><a href="#41495053">next</a><span>|</span><label class="collapse" for="c-41494936">[-]</label><label class="expand" for="c-41494936">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been looking into sqlc lately for Go. Seems brilliant except for the lack of dynamic queries:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;sqlc-dev&#x2F;sqlc&#x2F;discussions&#x2F;364">https:&#x2F;&#x2F;github.com&#x2F;sqlc-dev&#x2F;sqlc&#x2F;discussions&#x2F;364</a></div><br/><div id="41497334" class="c"><input type="checkbox" id="c-41497334" checked=""/><div class="controls bullet"><span class="by">benhoyt</span><span>|</span><a href="#41494936">parent</a><span>|</span><a href="#41495664">next</a><span>|</span><label class="collapse" for="c-41497334">[-]</label><label class="expand" for="c-41497334">[1 more]</label></div><br/><div class="children"><div class="content">I missed this too. However, I&#x27;ve found you can work around it pretty easily with clauses like CASE WHEN @field != &quot;&quot; THEN column = @field ELSE true END.<p>Example from the sqlc creator (<a href="https:&#x2F;&#x2F;github.com&#x2F;sqlc-dev&#x2F;sqlc&#x2F;discussions&#x2F;364#discussioncomment-55082">https:&#x2F;&#x2F;github.com&#x2F;sqlc-dev&#x2F;sqlc&#x2F;discussions&#x2F;364#discussionc...</a>):<p><pre><code>  -- name: FilterFoo :many
  SELECT * FROM foo
  WHERE fk = @fk
    AND (CASE WHEN @is_bar::bool THEN bar = @bar ELSE TRUE END)
    AND (CASE WHEN @lk_bar::bool THEN bar LIKE @bar ELSE TRUE END)
    AND (CASE WHEN @is_baz::bool THEN baz = @baz ELSE TRUE END)
    AND (CASE WHEN @lk_baz::bool THEN baz LIKE @baz ELSE TRUE END)
  ORDER BY
    CASE WHEN @bar_asc::bool THEN bar END asc,
    CASE WHEN @bar_desc::bool THEN bar END desc,
    CASE WHEN @baz_asc::bool THEN baz END asc,
    CASE WHEN @baz_desc::bool THEN baz END desc;</code></pre></div><br/></div></div><div id="41495664" class="c"><input type="checkbox" id="c-41495664" checked=""/><div class="controls bullet"><span class="by">renhanxue</span><span>|</span><a href="#41494936">parent</a><span>|</span><a href="#41497334">prev</a><span>|</span><a href="#41495053">next</a><span>|</span><label class="collapse" for="c-41495664">[-]</label><label class="expand" for="c-41495664">[2 more]</label></div><br/><div class="children"><div class="content">You want Jet [0], as mentioned in another comment. I did an extensive survey of golang SQL interfacing libraries before settling on Jet for our team. It&#x27;s certainly not without warts, but it&#x27;s got the correct type of API (query builder that maps directly to SQL) and the struct mapping is pretty flexible.<p>sqlc lacking support for dynamic query generation is just absolutely baffling. Composition of query fragments is, like, one of the main reasons you use a query builder - it&#x27;s very hard to do in raw SQL! If you don&#x27;t need that feature, why are you even messing around with SQL code on the application side? Just write and call stored procedures in the database! People will think you&#x27;re a time traveler from the 1980&#x27;s but it works!<p>Golang&#x27;s SQL ecosystem is... pretty miserable, really. I mean, I look at what jOOQ can do and I weep at the state of things over in go. In golang everything goes through database&#x2F;sql because that&#x27;s the &quot;standard&quot; solution, but database&#x2F;sql is a huge mess with a long track record of disastrous bugs (like the possibility of accidentally running queries outside of the intended transaction) that makes it very hard to take advantage of feature-rich databases like postgres. pgx (postgres connection library) is actually quite good when you use its native API, but because everything has to go through the database&#x2F;sql interface it gets pretty crippled with a lot of annoyances (try mapping postgres arrays or jsonb documents into structs and you&#x27;ll see what I mean).<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;go-jet&#x2F;jet">https:&#x2F;&#x2F;github.com&#x2F;go-jet&#x2F;jet</a></div><br/><div id="41496804" class="c"><input type="checkbox" id="c-41496804" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#41494936">root</a><span>|</span><a href="#41495664">parent</a><span>|</span><a href="#41495053">next</a><span>|</span><label class="collapse" for="c-41496804">[-]</label><label class="expand" for="c-41496804">[1 more]</label></div><br/><div class="children"><div class="content">&gt; try mapping postgres arrays or jsonb documents into structs and you&#x27;ll see what I mean<p>I ended up adding custom value types to wrap our JSON (actually Protobuf) values: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;Cyberax&#x2F;07486a2264e29d95ed8c67e002f936d2" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;Cyberax&#x2F;07486a2264e29d95ed8c67e002f9...</a> - we codegenerate them from Protobuf descriptions.</div><br/></div></div></div></div></div></div><div id="41495053" class="c"><input type="checkbox" id="c-41495053" checked=""/><div class="controls bullet"><span class="by">MaxRS</span><span>|</span><a href="#41494936">prev</a><span>|</span><a href="#41495408">next</a><span>|</span><label class="collapse" for="c-41495053">[-]</label><label class="expand" for="c-41495053">[2 more]</label></div><br/><div class="children"><div class="content">Migrated from GORM to sqlc. We like the code generation approach with the simplistic abstractions.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;helpwave&#x2F;services&#x2F;tree&#x2F;main&#x2F;services&#x2F;tasks-svc">https:&#x2F;&#x2F;github.com&#x2F;helpwave&#x2F;services&#x2F;tree&#x2F;main&#x2F;services&#x2F;task...</a></div><br/><div id="41498310" class="c"><input type="checkbox" id="c-41498310" checked=""/><div class="controls bullet"><span class="by">cies</span><span>|</span><a href="#41495053">parent</a><span>|</span><a href="#41495408">next</a><span>|</span><label class="collapse" for="c-41498310">[-]</label><label class="expand" for="c-41498310">[1 more]</label></div><br/><div class="children"><div class="content">ORMs make the easy things slightly more easy and the complex things impossible, so you still need SQL-as-strings or other technology (like sqlc).<p>Imho ORMs are not worth it. Too much to learn (often through nasty surprises) for too little benefit.</div><br/></div></div></div></div><div id="41495408" class="c"><input type="checkbox" id="c-41495408" checked=""/><div class="controls bullet"><span class="by">dagss</span><span>|</span><a href="#41495053">prev</a><span>|</span><a href="#41495274">next</a><span>|</span><label class="collapse" for="c-41495408">[-]</label><label class="expand" for="c-41495408">[2 more]</label></div><br/><div class="children"><div class="content">Sort of related in this space I&#x27;d like to plug a related tool &quot;sqlcode&quot; that is a different approach to how to deploy stored procedures. Could be a nice partner to sqlc I think. Focused on mssql support so far though, and still a bit in beta&#x2F;inhouse stage.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;vippsas&#x2F;sqlcode">https:&#x2F;&#x2F;github.com&#x2F;vippsas&#x2F;sqlcode</a></div><br/><div id="41496449" class="c"><input type="checkbox" id="c-41496449" checked=""/><div class="controls bullet"><span class="by">evanelias</span><span>|</span><a href="#41495408">parent</a><span>|</span><a href="#41495274">next</a><span>|</span><label class="collapse" for="c-41496449">[-]</label><label class="expand" for="c-41496449">[1 more]</label></div><br/><div class="children"><div class="content">Looks nice! In case anyone is interested in a MySQL&#x2F;MariaDB alternative, my tool Skeema can give a similar Git-friendly deploy flow for stored procedures, with all definitions tested in a temporary schema automatically so that any syntax errors are caught early before touching prod. Skeema was originally designed for declarative management of tables, but it can optionally be configured to only operate on procs&#x2F;funcs if desired.<p>Approach-wise, I&#x27;ve always felt that traditional imperative migration tools are an especially bad fit for stored procedures. I wrote a post about this a little while back: <a href="https:&#x2F;&#x2F;www.skeema.io&#x2F;blog&#x2F;2023&#x2F;10&#x2F;24&#x2F;stored-proc-deployment&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.skeema.io&#x2F;blog&#x2F;2023&#x2F;10&#x2F;24&#x2F;stored-proc-deployment...</a></div><br/></div></div></div></div><div id="41495274" class="c"><input type="checkbox" id="c-41495274" checked=""/><div class="controls bullet"><span class="by">petcat</span><span>|</span><a href="#41495408">prev</a><span>|</span><a href="#41495552">next</a><span>|</span><label class="collapse" for="c-41495274">[-]</label><label class="expand" for="c-41495274">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t work with Go, but this seems like a dream.  I really like the SQLx query macros in Rust.  I would love for something like this</div><br/><div id="41497860" class="c"><input type="checkbox" id="c-41497860" checked=""/><div class="controls bullet"><span class="by">1ba9115454</span><span>|</span><a href="#41495274">parent</a><span>|</span><a href="#41495501">next</a><span>|</span><label class="collapse" for="c-41497860">[-]</label><label class="expand" for="c-41497860">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;cornucopia-rs&#x2F;cornucopia">https:&#x2F;&#x2F;github.com&#x2F;cornucopia-rs&#x2F;cornucopia</a><p>Cornucopia generates rust code.</div><br/></div></div><div id="41495501" class="c"><input type="checkbox" id="c-41495501" checked=""/><div class="controls bullet"><span class="by">vhodges</span><span>|</span><a href="#41495274">parent</a><span>|</span><a href="#41497860">prev</a><span>|</span><a href="#41495552">next</a><span>|</span><label class="collapse" for="c-41495501">[-]</label><label class="expand" for="c-41495501">[1 more]</label></div><br/><div class="children"><div class="content">They have code generators for a few other languages too:<p><a href="https:&#x2F;&#x2F;docs.sqlc.dev&#x2F;en&#x2F;latest&#x2F;reference&#x2F;language-support.html" rel="nofollow">https:&#x2F;&#x2F;docs.sqlc.dev&#x2F;en&#x2F;latest&#x2F;reference&#x2F;language-support.h...</a><p>Surprisingly not Java, but probably pretty easy to add support for more.</div><br/></div></div></div></div><div id="41495552" class="c"><input type="checkbox" id="c-41495552" checked=""/><div class="controls bullet"><span class="by">taeric</span><span>|</span><a href="#41495274">prev</a><span>|</span><a href="#41494972">next</a><span>|</span><label class="collapse" for="c-41495552">[-]</label><label class="expand" for="c-41495552">[5 more]</label></div><br/><div class="children"><div class="content">I remain baffled that standard SQL isn&#x27;t more supported by some of the newer tools coming out.  If you are targeting a standard SQL dialect, it is basically trivial to standup an local database to test against during every build.<p>I remember using <a href="https:&#x2F;&#x2F;sqlfairy.sourceforge.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;sqlfairy.sourceforge.net&#x2F;</a> back in the day to help test locally against mysql&#x2F;postgres, but deploy to oracle.  There were hiccups, but it felt like the world would mostly converge onto smaller differences between the offerings and that kicking off a test database on every build should be easier as time goes on.<p>Instead, it feels like we have done as much as we can to make all of this harder.  I loved AWS Athena when I was able to use it, but trying to figure out a local database for testing that supported the same dialect it used seemed basically impossible.  It was baffling.</div><br/><div id="41497020" class="c"><input type="checkbox" id="c-41497020" checked=""/><div class="controls bullet"><span class="by">koito17</span><span>|</span><a href="#41495552">parent</a><span>|</span><a href="#41495657">next</a><span>|</span><label class="collapse" for="c-41497020">[-]</label><label class="expand" for="c-41497020">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I remain baffled that standard SQL isn&#x27;t more supported by some of the newer tools coming out.<p>Because &quot;standard SQL&quot;, assuming it means ANSI SQL, is quite limited on its own. Every relational database has its own syntax for DDLs. It&#x27;s not an exaggeration to say each mainstream relational database has its own SQL dialect (e.g. MySQL and SQL Server have ISNULL but ANSI SQL has COALESCE). There is no way to portably write a query that e.g. constructs a table with a foreign key constraint. The best libraries can do is target the dialects they care about or the dialects they expect everybody to use (e.g. MySQL and PostgreSQL).</div><br/></div></div><div id="41495657" class="c"><input type="checkbox" id="c-41495657" checked=""/><div class="controls bullet"><span class="by">paperplatter</span><span>|</span><a href="#41495552">parent</a><span>|</span><a href="#41497020">prev</a><span>|</span><a href="#41495945">next</a><span>|</span><label class="collapse" for="c-41495657">[-]</label><label class="expand" for="c-41495657">[2 more]</label></div><br/><div class="children"><div class="content">Because RDBMSes are still an unsolved problem, and new features keep coming along that are actually very useful but not easy to standardize.</div><br/><div id="41496289" class="c"><input type="checkbox" id="c-41496289" checked=""/><div class="controls bullet"><span class="by">taeric</span><span>|</span><a href="#41495552">root</a><span>|</span><a href="#41495657">parent</a><span>|</span><a href="#41495945">next</a><span>|</span><label class="collapse" for="c-41496289">[-]</label><label class="expand" for="c-41496289">[1 more]</label></div><br/><div class="children"><div class="content">And if I&#x27;m doing advanced queries, I largely sympathize.  Basic group by and such, though?  I get why cube and roll-up aren&#x27;t always there, maybe.  The rest, though?<p>If I was demanding equivalent speed, it would be one thing.  I am fine needing an integration environment for that.  I only want a test environment to show queries return as expected.  Is also good documentation for reporting focused queries.</div><br/></div></div></div></div></div></div><div id="41494972" class="c"><input type="checkbox" id="c-41494972" checked=""/><div class="controls bullet"><span class="by">dangoodmanUT</span><span>|</span><a href="#41495552">prev</a><span>|</span><a href="#41495398">next</a><span>|</span><label class="collapse" for="c-41494972">[-]</label><label class="expand" for="c-41494972">[1 more]</label></div><br/><div class="children"><div class="content">this is great, until it breaks. For example it loses context on joins to allow columns that don&#x27;t exist, which immediately breaks when you go to use it.</div><br/></div></div><div id="41495398" class="c"><input type="checkbox" id="c-41495398" checked=""/><div class="controls bullet"><span class="by">RamiAwar</span><span>|</span><a href="#41494972">prev</a><span>|</span><a href="#41496794">next</a><span>|</span><label class="collapse" for="c-41495398">[-]</label><label class="expand" for="c-41495398">[6 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve always said that the best ORM is one that allows for type safe query building.<p>This kind of generates the type safe queries for you, which is the end goal. But then why don&#x27;t developers use the query builder instead? Why have an unnecessary generation step?<p>I feel like a good query builder ORM is more than enough and more straightforward than this. What am I missing?</div><br/><div id="41496010" class="c"><input type="checkbox" id="c-41496010" checked=""/><div class="controls bullet"><span class="by">bccdee</span><span>|</span><a href="#41495398">parent</a><span>|</span><a href="#41495421">next</a><span>|</span><label class="collapse" for="c-41496010">[-]</label><label class="expand" for="c-41496010">[1 more]</label></div><br/><div class="children"><div class="content">A query builder ORM is an abstraction I don&#x27;t want and don&#x27;t need. I know which SQL queries I want to run on my DB; please don&#x27;t make me learn a whole DSL in order to run them. All I get in exchange for that is the extra work of translating my SQL into your DSL, plus the headache of circumventing the inevitable leaks in your abstraction.<p>I just want type-safe SQL templates that return native data structures. Sqlc provides that, and I&#x27;ve quite enjoyed working with it.</div><br/></div></div><div id="41495421" class="c"><input type="checkbox" id="c-41495421" checked=""/><div class="controls bullet"><span class="by">paperplatter</span><span>|</span><a href="#41495398">parent</a><span>|</span><a href="#41496010">prev</a><span>|</span><a href="#41495904">next</a><span>|</span><label class="collapse" for="c-41495421">[-]</label><label class="expand" for="c-41495421">[1 more]</label></div><br/><div class="children"><div class="content">I prefer just using SQL without the query builder. If I&#x27;m ever concerned about type safety, I could wrap it in a function. Guess this tool does it for you, but separating your queries into .sql files seems like more effort.</div><br/></div></div><div id="41495904" class="c"><input type="checkbox" id="c-41495904" checked=""/><div class="controls bullet"><span class="by">stanleydrew</span><span>|</span><a href="#41495398">parent</a><span>|</span><a href="#41495421">prev</a><span>|</span><a href="#41495462">next</a><span>|</span><label class="collapse" for="c-41495904">[-]</label><label class="expand" for="c-41495904">[1 more]</label></div><br/><div class="children"><div class="content">One of the design principles of sqlc is that SQL queries should be static in application code so that you know exactly what SQL is running on your database. It turns out you can get pretty far operating under this constraint, although there are some annoyances.</div><br/></div></div><div id="41495462" class="c"><input type="checkbox" id="c-41495462" checked=""/><div class="controls bullet"><span class="by">dlisboa</span><span>|</span><a href="#41495398">parent</a><span>|</span><a href="#41495904">prev</a><span>|</span><a href="#41496794">next</a><span>|</span><label class="collapse" for="c-41495462">[-]</label><label class="expand" for="c-41495462">[2 more]</label></div><br/><div class="children"><div class="content">The query builder is yet another mini language that you have to learn and they change for each ORM so learning one is mostly wasted time.<p>Many times I’ve been stuck in a place where I knew exactly how to write the SQL for it but had to spend several minutes studying the ORM docs to learn how to express it.<p>SQLc also has the advantage of static checking your queries.<p>It has some other disadvantages so it’s not all rosy.</div><br/><div id="41495623" class="c"><input type="checkbox" id="c-41495623" checked=""/><div class="controls bullet"><span class="by">paperplatter</span><span>|</span><a href="#41495398">root</a><span>|</span><a href="#41495462">parent</a><span>|</span><a href="#41496794">next</a><span>|</span><label class="collapse" for="c-41495623">[-]</label><label class="expand" for="c-41495623">[1 more]</label></div><br/><div class="children"><div class="content">Last time I used a query builder, I accidentally used its orderBy in some invalid way that it didn&#x27;t complain about. Just silently didn&#x27;t ORDER BY the cols I wanted.</div><br/></div></div></div></div></div></div><div id="41496794" class="c"><input type="checkbox" id="c-41496794" checked=""/><div class="controls bullet"><span class="by">michaelmdresser</span><span>|</span><a href="#41495398">prev</a><span>|</span><a href="#41495310">next</a><span>|</span><label class="collapse" for="c-41496794">[-]</label><label class="expand" for="c-41496794">[1 more]</label></div><br/><div class="children"><div class="content">I’ve really enjoyed using sqlc for a small project. I’m comfortable in SQL and enjoy not having to go through an additional layer.</div><br/></div></div><div id="41495310" class="c"><input type="checkbox" id="c-41495310" checked=""/><div class="controls bullet"><span class="by">giovannibonetti</span><span>|</span><a href="#41496794">prev</a><span>|</span><a href="#41495597">next</a><span>|</span><label class="collapse" for="c-41495310">[-]</label><label class="expand" for="c-41495310">[1 more]</label></div><br/><div class="children"><div class="content">Recently, a similar project (type-safe code generation from SQL) was released to Gleam [1].<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;giacomocavalieri&#x2F;squirrel">https:&#x2F;&#x2F;github.com&#x2F;giacomocavalieri&#x2F;squirrel</a></div><br/></div></div><div id="41495597" class="c"><input type="checkbox" id="c-41495597" checked=""/><div class="controls bullet"><span class="by">Thaxll</span><span>|</span><a href="#41495310">prev</a><span>|</span><label class="collapse" for="c-41495597">[-]</label><label class="expand" for="c-41495597">[1 more]</label></div><br/><div class="children"><div class="content">sqlc is great until you need dynamic parameters in queries.</div><br/></div></div></div></div></div></div></div></body></html>