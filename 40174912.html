<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1714208455418" as="style"/><link rel="stylesheet" href="styles.css?v=1714208455418"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/facebookresearch/searchformer">Searchformer: Beyond A* – Better planning with transformers via search dynamics</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>yeldarb</span> | <span>17 comments</span></div><br/><div><div id="40176289" class="c"><input type="checkbox" id="c-40176289" checked=""/><div class="controls bullet"><span class="by">a_wild_dandan</span><span>|</span><a href="#40176945">next</a><span>|</span><label class="collapse" for="c-40176289">[-]</label><label class="expand" for="c-40176289">[7 more]</label></div><br/><div class="children"><div class="content">Ah, I remember reading this paper! Essentially, they created synthetic data by solving search problems using A*. Trained on this data, transformers unsurprisingly learned to solve these problems. They then improved their synthetic data by repeatedly solving a given problem many times with A*, and keeping only the shortest step solution. Transformers learned to be competitive with this improved search heuristic too!<p>Pretty remarkable stuff. Given the obsession over chat bots, folk often miss how revolutionary transformer sequence modeling is to...well, any sequence application that <i>isn&#x27;t</i> a chat bot. Looking solely at speeding up scientific simulations by ~10x, it&#x27;s a watershed moment for humanity. When you include the vast space of <i>other</i> applications, we&#x27;re in for one wild ride,  y&#x27;all.</div><br/><div id="40176665" class="c"><input type="checkbox" id="c-40176665" checked=""/><div class="controls bullet"><span class="by">jadbox</span><span>|</span><a href="#40176289">parent</a><span>|</span><a href="#40176669">next</a><span>|</span><label class="collapse" for="c-40176665">[-]</label><label class="expand" for="c-40176665">[4 more]</label></div><br/><div class="children"><div class="content">Remarkable indeed, I&#x27;ve been toying with many smaller, unorthodox use-cases for LLMs and continue to be surprised.</div><br/><div id="40177052" class="c"><input type="checkbox" id="c-40177052" checked=""/><div class="controls bullet"><span class="by">smcin</span><span>|</span><a href="#40176289">root</a><span>|</span><a href="#40176665">parent</a><span>|</span><a href="#40177502">next</a><span>|</span><label class="collapse" for="c-40177052">[-]</label><label class="expand" for="c-40177052">[1 more]</label></div><br/><div class="children"><div class="content">I want to see an optimal (2P) speedrun with Sonic the Hedgehog and Tails. As a fun proof. There are two players working together; also it has more degrees-of-freedom than a Sokoban.</div><br/></div></div><div id="40177502" class="c"><input type="checkbox" id="c-40177502" checked=""/><div class="controls bullet"><span class="by">jasonjmcghee</span><span>|</span><a href="#40176289">root</a><span>|</span><a href="#40176665">parent</a><span>|</span><a href="#40177052">prev</a><span>|</span><a href="#40176669">next</a><span>|</span><label class="collapse" for="c-40177502">[-]</label><label class="expand" for="c-40177502">[2 more]</label></div><br/><div class="children"><div class="content">Can you say more? Where can I read about some of these alternate use cases?</div><br/><div id="40178373" class="c"><input type="checkbox" id="c-40178373" checked=""/><div class="controls bullet"><span class="by">ebri</span><span>|</span><a href="#40176289">root</a><span>|</span><a href="#40177502">parent</a><span>|</span><a href="#40176669">next</a><span>|</span><label class="collapse" for="c-40178373">[-]</label><label class="expand" for="c-40178373">[1 more]</label></div><br/><div class="children"><div class="content">yes I want to learn about this too! Hadn&#x27;t thought about it like that.</div><br/></div></div></div></div></div></div><div id="40176669" class="c"><input type="checkbox" id="c-40176669" checked=""/><div class="controls bullet"><span class="by">unraveller</span><span>|</span><a href="#40176289">parent</a><span>|</span><a href="#40176665">prev</a><span>|</span><a href="#40176945">next</a><span>|</span><label class="collapse" for="c-40176669">[-]</label><label class="expand" for="c-40176669">[2 more]</label></div><br/><div class="children"><div class="content">what are those other applications? so now everyone has SoTA warehouse scheduling in their pockets no one can be expected to do anything or go anywhere inefficiently.</div><br/></div></div></div></div><div id="40176945" class="c"><input type="checkbox" id="c-40176945" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#40176289">prev</a><span>|</span><a href="#40174942">next</a><span>|</span><label class="collapse" for="c-40176945">[-]</label><label class="expand" for="c-40176945">[5 more]</label></div><br/><div class="children"><div class="content">Due to the no free lunch theorem [0], any search algorithm that makes some problems faster will necessarily make other problems slower. How does the worst case for an algorithm like this look like?<p>I think that part of the appeal of A* to me is that I can readily visualize why the algorithm failed at some pathological inputs.<p>[0] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;No_free_lunch_in_search_and_optimization" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;No_free_lunch_in_search_and_op...</a></div><br/><div id="40177030" class="c"><input type="checkbox" id="c-40177030" checked=""/><div class="controls bullet"><span class="by">kevindamm</span><span>|</span><a href="#40176945">parent</a><span>|</span><a href="#40178182">next</a><span>|</span><label class="collapse" for="c-40177030">[-]</label><label class="expand" for="c-40177030">[1 more]</label></div><br/><div class="children"><div class="content">Well, it&#x27;s still using A* and state exploration to validate the plans generated.  But, it&#x27;s generating plans nondeterministically so it is possible it could run in O(\inf).<p>Why didn&#x27;t they give more details about the Sokoban puzzles being solved?  The standard benchmark is the 90 puzzles in XSokoban and there&#x27;s a Large Test Suite that has a few thousand but many of them haven&#x27;t been solved by any search or planning system.  Even the 90 puzzles in XSokoban were only solved a few years ago (2020?) by Festival (using FESS, a feature-space search in addition to domain-space, state-space).  Before that it had been about 20 years of only 57 or so levels solved via search.<p>I see that they measure trace lengths but I would have really liked to see # of XSokoban levels and how many states were examined, to line up with existing research.</div><br/></div></div><div id="40178182" class="c"><input type="checkbox" id="c-40178182" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#40176945">parent</a><span>|</span><a href="#40177030">prev</a><span>|</span><a href="#40178250">next</a><span>|</span><label class="collapse" for="c-40178182">[-]</label><label class="expand" for="c-40178182">[1 more]</label></div><br/><div class="children"><div class="content">The &quot;No free lunch&quot; theorem does have some prequisites for it to actually apply.<p>&gt; There is no free lunch in search if and only if the distribution on objective functions is invariant under permutation of the space of candidate solutions.</div><br/></div></div><div id="40178250" class="c"><input type="checkbox" id="c-40178250" checked=""/><div class="controls bullet"><span class="by">IanCal</span><span>|</span><a href="#40176945">parent</a><span>|</span><a href="#40178182">prev</a><span>|</span><a href="#40174942">next</a><span>|</span><label class="collapse" for="c-40178250">[-]</label><label class="expand" for="c-40178250">[2 more]</label></div><br/><div class="children"><div class="content">NFL theorem is frankly silly.<p>It boils down to &quot;you can&#x27;t predict random numbers&quot;.<p>I&#x27;m sure it&#x27;s useful to have formalized but it has no real impact on real world situations because most problems we care about have some kind of structure we can exploit.</div><br/><div id="40178320" class="c"><input type="checkbox" id="c-40178320" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#40176945">root</a><span>|</span><a href="#40178250">parent</a><span>|</span><a href="#40174942">next</a><span>|</span><label class="collapse" for="c-40178320">[-]</label><label class="expand" for="c-40178320">[1 more]</label></div><br/><div class="children"><div class="content">Well when I asked &quot;How does the worst case for an algorithm like this look like?&quot; I fully expected the answer to be &quot;in practice this never happens&quot; (that is, there are bad cases but since we aren&#x27;t drawing inputs at random, in practice we never hit them)<p>But how likely is that?</div><br/></div></div></div></div></div></div><div id="40174942" class="c"><input type="checkbox" id="c-40174942" checked=""/><div class="controls bullet"><span class="by">yeldarb</span><span>|</span><a href="#40176945">prev</a><span>|</span><a href="#40177393">next</a><span>|</span><label class="collapse" for="c-40174942">[-]</label><label class="expand" for="c-40174942">[3 more]</label></div><br/><div class="children"><div class="content">&gt; 
While Transformers have enabled tremendous progress in various application settings, such architectures still lag behind traditional symbolic planners for solving complex decision making tasks. In this work, we demonstrate how to train Transformers to solve complex planning tasks and present Searchformer, a Transformer model that optimally solves previously unseen Sokoban puzzles 93.7% of the time, while using up to 26.8% fewer search steps than standard A∗ search. Searchformer is an encoder-decoder Transformer model trained to predict the search dynamics of A∗. This model is then fine-tuned via expert iterations to perform fewer search steps than A∗ search while still generating an optimal plan. In our training method, A∗&#x27;s search dynamics are expressed as a token sequence outlining when task states are added and removed into the search tree during symbolic planning. In our ablation studies on maze navigation, we find that Searchformer significantly outperforms baselines that predict the optimal plan directly with a 5-10× smaller model size and a 10× smaller training dataset. We also demonstrate how Searchformer scales to larger and more complex decision making tasks like Sokoban with improved percentage of solved tasks and shortened search dynamics.<p>Neat; TIL about Sokoban puzzles. I remember playing Chip&#x27;s Challenge on Windows 3.1 when I was a kid which had a lot of levels like that.</div><br/><div id="40177449" class="c"><input type="checkbox" id="c-40177449" checked=""/><div class="controls bullet"><span class="by">passion__desire</span><span>|</span><a href="#40174942">parent</a><span>|</span><a href="#40177089">next</a><span>|</span><label class="collapse" for="c-40177449">[-]</label><label class="expand" for="c-40177449">[1 more]</label></div><br/><div class="children"><div class="content">Jonathan Blow is working on &quot;Sokoban&quot;-Inspired Puzzle Game. I am looking forward to its release.</div><br/></div></div><div id="40177089" class="c"><input type="checkbox" id="c-40177089" checked=""/><div class="controls bullet"><span class="by">smcin</span><span>|</span><a href="#40174942">parent</a><span>|</span><a href="#40177449">prev</a><span>|</span><a href="#40177393">next</a><span>|</span><label class="collapse" for="c-40177089">[-]</label><label class="expand" for="c-40177089">[1 more]</label></div><br/><div class="children"><div class="content">Sokoban puzzles have a discrete set of actions, typically 8 (move U&#x2F;D&#x2F;L&#x2F;R ; drag U&#x2F;D&#x2F;L&#x2F;R), on a discrete grid.</div><br/></div></div></div></div><div id="40177393" class="c"><input type="checkbox" id="c-40177393" checked=""/><div class="controls bullet"><span class="by">teleforce</span><span>|</span><a href="#40174942">prev</a><span>|</span><label class="collapse" for="c-40177393">[-]</label><label class="expand" for="c-40177393">[1 more]</label></div><br/><div class="children"><div class="content">Previous post and discussions on HN:<p>Beyond A*: Better Planning with Transformers:<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39479478">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39479478</a></div><br/></div></div></div></div></div></div></div></body></html>