<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732093259552" as="style"/><link rel="stylesheet" href="styles.css?v=1732093259552"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/mkalioby/leopards">Query Your Python Lists</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>mkalioby</span> | <span>12 comments</span></div><br/><div><div id="42191163" class="c"><input type="checkbox" id="c-42191163" checked=""/><div class="controls bullet"><span class="by">dsp_person</span><span>|</span><a href="#42190570">next</a><span>|</span><label class="collapse" for="c-42191163">[-]</label><label class="expand" for="c-42191163">[2 more]</label></div><br/><div class="children"><div class="content">Interesting... I&#x27;ve been playing with the idea of embedding more python in my C, no cython or anything just using &lt;Python.h&gt; and &lt;numpy&#x2F;arrayobject.h&gt;. From one perspective it&#x27;s just &quot;free&quot; C-bindings to a lot of optimized packages. Trying some different C-libraries, the python code is often faster. Python almost becomes C&#x27;s package manager<p>E.g. sorting 2^23 random 64-bit integers: qsort: 850ms, custom radix sort: 250ms, ksort.h: 582ms, np.sort: 107ms (including PyArray_SimpleNewFromData, PyArray_Sort). Where numpy uses intel&#x27;s x86-simd-sort I believe.<p>E.g. inserting 8M entries into a hash table (random 64-bit keys and values): MSI-style hash table: ~100ns avg insert&#x2F;lookup, cc_map: ~95ns avg insert&#x2F;lookup, Python.h: 91ns insert, 60ns lookup<p>I&#x27;m curious if OPs tool might fit in similarly. I&#x27;ve found lmdb to be quite slow even in tmpfs with no sync, etc.</div><br/><div id="42191830" class="c"><input type="checkbox" id="c-42191830" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#42191163">parent</a><span>|</span><a href="#42190570">next</a><span>|</span><label class="collapse" for="c-42191830">[-]</label><label class="expand" for="c-42191830">[1 more]</label></div><br/><div class="children"><div class="content">You should look at embedding Wasmtime into your C.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;bytecodealliance&#x2F;wasmtime&#x2F;tree&#x2F;main&#x2F;examples">https:&#x2F;&#x2F;github.com&#x2F;bytecodealliance&#x2F;wasmtime&#x2F;tree&#x2F;main&#x2F;examp...</a></div><br/></div></div></div></div><div id="42190570" class="c"><input type="checkbox" id="c-42190570" checked=""/><div class="controls bullet"><span class="by">sevensor</span><span>|</span><a href="#42191163">prev</a><span>|</span><a href="#42191090">next</a><span>|</span><label class="collapse" for="c-42190570">[-]</label><label class="expand" for="c-42190570">[3 more]</label></div><br/><div class="children"><div class="content">Having seen a lot of work come to grief because of the decision to use pandas, anything that’s not pandas has my vote. Pandas: if you’re not using it interactively, don’t use it at all.  This advice goes double if your use case is “read a csv.” Standard library in Python has you covered there.</div><br/><div id="42190663" class="c"><input type="checkbox" id="c-42190663" checked=""/><div class="controls bullet"><span class="by">c0balt</span><span>|</span><a href="#42190570">parent</a><span>|</span><a href="#42190621">next</a><span>|</span><label class="collapse" for="c-42190663">[-]</label><label class="expand" for="c-42190663">[1 more]</label></div><br/><div class="children"><div class="content">Both duckdb and especially polars should also be mentioned here. Polars in particular is quite good Ime if you want a pandas-alike interface (it additionally also has a more sane interface).</div><br/></div></div><div id="42190621" class="c"><input type="checkbox" id="c-42190621" checked=""/><div class="controls bullet"><span class="by">ttyprintk</span><span>|</span><a href="#42190570">parent</a><span>|</span><a href="#42190663">prev</a><span>|</span><a href="#42191090">next</a><span>|</span><label class="collapse" for="c-42190621">[-]</label><label class="expand" for="c-42190621">[1 more]</label></div><br/><div class="children"><div class="content">Since DuckDB can read and write Pandas from memory, a team with varying Pandas fluency can benefit from learning DuckDB.</div><br/></div></div></div></div><div id="42191090" class="c"><input type="checkbox" id="c-42191090" checked=""/><div class="controls bullet"><span class="by">glial</span><span>|</span><a href="#42190570">prev</a><span>|</span><a href="#42191056">next</a><span>|</span><label class="collapse" for="c-42191090">[-]</label><label class="expand" for="c-42191090">[1 more]</label></div><br/><div class="children"><div class="content">Interesting work. I&#x27;d be curious to know the timing relative to list comprehensions for similar queries, since that&#x27;s the common standard library alternative for many of these examples.</div><br/></div></div><div id="42191056" class="c"><input type="checkbox" id="c-42191056" checked=""/><div class="controls bullet"><span class="by">tempcommenttt</span><span>|</span><a href="#42191090">prev</a><span>|</span><a href="#42190985">next</a><span>|</span><label class="collapse" for="c-42191056">[-]</label><label class="expand" for="c-42191056">[2 more]</label></div><br/><div class="children"><div class="content">It’s nice it’s fast at 10k dictionary entries, but how does it scale?</div><br/></div></div><div id="42190985" class="c"><input type="checkbox" id="c-42190985" checked=""/><div class="controls bullet"><span class="by">abdullahkhalids</span><span>|</span><a href="#42191056">prev</a><span>|</span><a href="#42144370">next</a><span>|</span><label class="collapse" for="c-42190985">[-]</label><label class="expand" for="c-42190985">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand why numeric filters are included. The library is written in python, so shouldn&#x27;t a lambda function based filter be roughly as fast but much easier&#x2F;clearer to write.</div><br/><div id="42191496" class="c"><input type="checkbox" id="c-42191496" checked=""/><div class="controls bullet"><span class="by">MathMonkeyMan</span><span>|</span><a href="#42190985">parent</a><span>|</span><a href="#42144370">next</a><span>|</span><label class="collapse" for="c-42191496">[-]</label><label class="expand" for="c-42191496">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not the author, but this implementation has the benefit of being a JSON compatible DSL that you can serialize. Maybe that&#x27;s intentional, maybe not.<p>It does look like Python&#x27;s comprehensions would be a better choice if you&#x27;re writing them by hand anyway.</div><br/></div></div></div></div></div></div></div></div></div></body></html>