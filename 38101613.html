<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1698915667480" as="style"/><link rel="stylesheet" href="styles.css?v=1698915667480"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://justine.lol/cosmo3/">Cosmopolitan Third Edition</a> <span class="domain">(<a href="https://justine.lol">justine.lol</a>)</span></div><div class="subtext"><span>jart</span> | <span>134 comments</span></div><br/><div><div id="38102509" class="c"><input type="checkbox" id="c-38102509" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38101995">next</a><span>|</span><label class="collapse" for="c-38102509">[-]</label><label class="expand" for="c-38102509">[15 more]</label></div><br/><div class="children"><div class="content">There&#x27;s so much cool stuff in this post.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;releases&#x2F;download&#x2F;3.0.1&#x2F;cosmos-3.0.1.zip">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;releases&#x2F;download&#x2F;3.0.1...</a> is 213MB file which contains &quot;fat binaries&quot; (single binaries that execute on a bewildering array of hardware platforms and operating systems) for dozens of programs, including zip, curl, git, wget, python, ctags and even my own Datasette Python application!<p>It&#x27;s absolutely wild that this works.<p>I just tried it out (on macOS). I downloaded and extracted that zip and did this:<p><pre><code>    cd ~&#x2F;Downloads&#x2F;cosmos-3.0.1&#x2F;bin
    .&#x2F;python -c &#x27;print(4 + 5)&#x27;
</code></pre>
It refused the first time because of macOS security settings. I had to open the security panel and click &quot;allow&quot;... and then it worked!<p>Likewise, this worked:<p><pre><code>    .&#x2F;datasette -m datasette -p 8000
</code></pre>
That started a <a href="https:&#x2F;&#x2F;datasette.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;datasette.io&#x2F;</a> server running on port 8000.<p>Git works too:<p><pre><code>    .&#x2F;git clone https:&#x2F;&#x2F;github.com&#x2F;simonw&#x2F;sqlite-utils
</code></pre>
That git binary is 6.3MB, and I believe that same exact file can be copied to a Linux or Windows machine and will work the same way.</div><br/><div id="38102629" class="c"><input type="checkbox" id="c-38102629" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38102509">parent</a><span>|</span><a href="#38107171">next</a><span>|</span><label class="collapse" for="c-38102629">[-]</label><label class="expand" for="c-38102629">[4 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s a bit of a clue to how it works:<p><pre><code>    .&#x2F;python 
    Python 3.11.4 (heads&#x2F;pypack1:65ac8ac, Oct 16 2023, 02:35:05) [GCC 11.2.0] on linux
    Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
    &gt;&gt;&gt; import sqlite3
    &gt;&gt;&gt; sqlite3
    &lt;module &#x27;sqlite3&#x27; from &#x27;&#x2F;zip&#x2F;Lib&#x2F;sqlite3&#x2F;__init__.pyc&#x27;&gt;
    &gt;&gt;&gt; import pathlib
    &gt;&gt;&gt; list(pathlib.Path(&quot;&#x2F;zip&quot;).glob(&quot;*&quot;))
    [PosixPath(&#x27;&#x2F;zip&#x2F;.symtab.amd64&#x27;), PosixPath(&#x27;&#x2F;zip&#x2F;.symtab.arm64&#x27;), PosixPath(&#x27;&#x2F;zip&#x2F;usr&#x27;), PosixPath(&#x27;&#x2F;zip&#x2F;.cosmo&#x27;), PosixPath(&#x27;&#x2F;zip&#x2F;Lib&#x27;), PosixPath(&#x27;&#x2F;zip&#x2F;build&#x27;)]

</code></pre>
From Python&#x27;s point of view there a &quot;&#x2F;zip&#x2F;&quot; folder with stuff in it, presumably stuff that&#x27;s hidden inside the fat binary.</div><br/><div id="38103004" class="c"><input type="checkbox" id="c-38103004" checked=""/><div class="controls bullet"><span class="by">mhink</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38102629">parent</a><span>|</span><a href="#38103471">next</a><span>|</span><label class="collapse" for="c-38103004">[-]</label><label class="expand" for="c-38103004">[2 more]</label></div><br/><div class="children"><div class="content">Yup, this is basically it. If you check out the &quot;Actually Portable Executable&quot; blogpost by the same author [1] and go to the &quot;PKZIP Executables Make Pretty Good Containers&quot; section there&#x27;s a note on the approach.<p>1: <a href="https:&#x2F;&#x2F;justine.lol&#x2F;ape.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;justine.lol&#x2F;ape.html</a></div><br/><div id="38106118" class="c"><input type="checkbox" id="c-38106118" checked=""/><div class="controls bullet"><span class="by">ForHackernews</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38103004">parent</a><span>|</span><a href="#38103471">next</a><span>|</span><label class="collapse" for="c-38106118">[-]</label><label class="expand" for="c-38106118">[1 more]</label></div><br/><div class="children"><div class="content">absolutely impressive</div><br/></div></div></div></div><div id="38103471" class="c"><input type="checkbox" id="c-38103471" checked=""/><div class="controls bullet"><span class="by">ahgamut</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38102629">parent</a><span>|</span><a href="#38103004">prev</a><span>|</span><a href="#38107171">next</a><span>|</span><label class="collapse" for="c-38103471">[-]</label><label class="expand" for="c-38103471">[1 more]</label></div><br/><div class="children"><div class="content">The &quot;&#x2F;zip&#x2F;&quot; folder refers to the ZIP store inside the actually portable executable -- you can run `unzip -vl .&#x2F;python` to see what&#x27;s inside.<p>Also, to add new pure-python packages, you just need to unzip them into a local folder &quot;.&#x2F;Lib&quot;, and add that folder to the APE.</div><br/></div></div></div></div><div id="38107171" class="c"><input type="checkbox" id="c-38107171" checked=""/><div class="controls bullet"><span class="by">JyB</span><span>|</span><a href="#38102509">parent</a><span>|</span><a href="#38102629">prev</a><span>|</span><a href="#38104420">next</a><span>|</span><label class="collapse" for="c-38107171">[-]</label><label class="expand" for="c-38107171">[3 more]</label></div><br/><div class="children"><div class="content">It’s so nice seeing portability over binary size winning all around these days. Such a breath of fresh air. There might be legit cases but for some reason so many people are still hang up on ´but binary size’ for no logical reason whatsoever.</div><br/><div id="38110082" class="c"><input type="checkbox" id="c-38110082" checked=""/><div class="controls bullet"><span class="by">guenthert</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38107171">parent</a><span>|</span><a href="#38109414">next</a><span>|</span><label class="collapse" for="c-38110082">[-]</label><label class="expand" for="c-38110082">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It’s so nice seeing portability over binary size winning all around these days.<p>It does?  I would rather argue that portability between desktop OS matters today less than twenty years ago as the niches are carved out, WSL 2 becomes actually usable and the desktop metaphor as a whole declines.</div><br/></div></div><div id="38109414" class="c"><input type="checkbox" id="c-38109414" checked=""/><div class="controls bullet"><span class="by">flakes</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38107171">parent</a><span>|</span><a href="#38110082">prev</a><span>|</span><a href="#38104420">next</a><span>|</span><label class="collapse" for="c-38109414">[-]</label><label class="expand" for="c-38109414">[1 more]</label></div><br/><div class="children"><div class="content">I think a lot of the &quot;logical reason&quot; is driven by more the ephemeral, sandboxed, execution tools. e.g. a `docker run` or `serverless` architectures, where full root filesystems are populated on demand. Less executable data size there can go a long way in reducing latency&#x2F;price.</div><br/></div></div></div></div><div id="38104420" class="c"><input type="checkbox" id="c-38104420" checked=""/><div class="controls bullet"><span class="by">summarity</span><span>|</span><a href="#38102509">parent</a><span>|</span><a href="#38107171">prev</a><span>|</span><a href="#38102942">next</a><span>|</span><label class="collapse" for="c-38104420">[-]</label><label class="expand" for="c-38104420">[1 more]</label></div><br/><div class="children"><div class="content">sudo xattr -rd com.apple.quarantine &#x2F;path&#x2F;to&#x2F;binary&#x2F;or&#x2F;app<p>should also allow anything to run without opening settings</div><br/></div></div><div id="38102942" class="c"><input type="checkbox" id="c-38102942" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#38102509">parent</a><span>|</span><a href="#38104420">prev</a><span>|</span><a href="#38102843">next</a><span>|</span><label class="collapse" for="c-38102942">[-]</label><label class="expand" for="c-38102942">[1 more]</label></div><br/><div class="children"><div class="content">Now imagine nuitka and gcc bundled as a standalone cross plateform binary so you can basically compile a cross plaform python exe from any script.</div><br/></div></div><div id="38102843" class="c"><input type="checkbox" id="c-38102843" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#38102509">parent</a><span>|</span><a href="#38102942">prev</a><span>|</span><a href="#38101995">next</a><span>|</span><label class="collapse" for="c-38102843">[-]</label><label class="expand" for="c-38102843">[5 more]</label></div><br/><div class="children"><div class="content">I wonder if llm would work?</div><br/><div id="38103253" class="c"><input type="checkbox" id="c-38103253" checked=""/><div class="controls bullet"><span class="by">AMICABoard</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38102843">parent</a><span>|</span><a href="#38103207">next</a><span>|</span><label class="collapse" for="c-38103253">[-]</label><label class="expand" for="c-38103253">[1 more]</label></div><br/><div class="children"><div class="content">Yes they do!<p><a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;tree&#x2F;master&#x2F;third_party&#x2F;ggml">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;tree&#x2F;master&#x2F;third_party...</a><p>and<p><a href="https:&#x2F;&#x2F;github.com&#x2F;trholding&#x2F;llama2.c">https:&#x2F;&#x2F;github.com&#x2F;trholding&#x2F;llama2.c</a></div><br/></div></div><div id="38103207" class="c"><input type="checkbox" id="c-38103207" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38102843">parent</a><span>|</span><a href="#38103253">prev</a><span>|</span><a href="#38101995">next</a><span>|</span><label class="collapse" for="c-38103207">[-]</label><label class="expand" for="c-38103207">[3 more]</label></div><br/><div class="children"><div class="content">Base <a href="https:&#x2F;&#x2F;llm.datasette.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;llm.datasette.io&#x2F;</a> should work just fine, but it&#x27;s basically a thin Python wrapper around the OpenAI Python library which then makes HTTP requests to their API.<p>The bigger challenge would be LLM with plugins. Those add all sorts of extra dependencies to help LLM run models directly - PyTorch, Transformers, llama-cpp-python etc.<p>I&#x27;d be surprised to see &quot;llm install llm-gpt4all&quot; work for example, since that pulls in compiled Python wheels and I&#x27;m not sure it would know which architecture to use.<p>pip install DOES work:<p><pre><code>    $ .&#x2F;python -m pip install httpx
    Defaulting to user installation because normal site-packages is not writeable
    Collecting httpx
      Downloading httpx-0.25.0-py3-none-any.whl (75 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 75.7&#x2F;75.7 kB 2.7 MB&#x2F;s eta 0:00:00
    ...
    Successfully installed anyio-4.0.0 h11-0.14.0 httpcore-0.18.0 httpx-0.25.0 sniffio-1.3.0

    $ .&#x2F;python                     
    Python 3.11.4 (heads&#x2F;pypack1:65ac8ac, Oct 16 2023, 02:35:05) [GCC 11.2.0] on linux
    Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
    &gt;&gt;&gt; import httpx
    &gt;&gt;&gt; httpx
    &lt;module &#x27;httpx&#x27; from &#x27;&#x2F;Users&#x2F;simon&#x2F;.local&#x2F;lib&#x2F;python3.11&#x2F;site-packages&#x2F;httpx&#x2F;__init__.py&#x27;&gt;

    $ ls ~&#x2F;.local&#x2F;lib&#x2F;python3.11&#x2F;site-packages
    anyio
    anyio-4.0.0.dist-info
    h11
    h11-0.14.0.dist-info
    httpcore
    httpcore-0.18.0.dist-info
    httpx
    httpx-0.25.0.dist-info
    sniffio
    sniffio-1.3.0.dist-info
</code></pre>
That ~&#x2F;.local&#x2F;lib&#x2F;python3.11&#x2F; directory didn&#x27;t exist until I ran the .&#x2F;python -m pip install command.<p>Unfortunately &quot;.&#x2F;python -m pip install llm&quot; didn&#x27;t quite work, I got this:<p><pre><code>    .&#x2F;python -m pip install llm                   
    Defaulting to user installation because normal site-packages is not writeable
    Collecting llm
      Downloading llm-0.11.1-py3-none-any.whl (36 kB)
    Requirement already satisfied: click in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from llm) (8.1.6)
    Collecting openai (from llm)
      Downloading openai-0.28.1-py3-none-any.whl (76 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 77.0&#x2F;77.0 kB 31.0 MB&#x2F;s eta 0:00:00
    Collecting click-default-group&gt;=1.2.3 (from llm)
      Downloading click_default_group-1.2.4-py2.py3-none-any.whl (4.1 kB)
    Collecting sqlite-utils&gt;=3.35.0 (from llm)
      Downloading sqlite_utils-3.35.1-py3-none-any.whl (67 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 67.2&#x2F;67.2 kB 4.9 MB&#x2F;s eta 0:00:00
    Collecting sqlite-migrate&gt;=0.1a2 (from llm)
      Downloading sqlite_migrate-0.1b0-py3-none-any.whl (10.0 kB)
    Requirement already satisfied: pydantic&gt;=1.10.2 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from llm) (1.10.12)
    Requirement already satisfied: PyYAML in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from llm) (6.0)
    Collecting pluggy (from llm)
      Downloading pluggy-1.3.0-py3-none-any.whl (18 kB)
    Collecting python-ulid (from llm)
      Downloading python_ulid-2.2.0-py3-none-any.whl (9.4 kB)
    Requirement already satisfied: setuptools in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from llm) (68.0.0)
    Requirement already satisfied: pip in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from llm) (23.1.2)
    Requirement already satisfied: typing-extensions&gt;=4.2.0 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from pydantic&gt;=1.10.2-&gt;llm) (4.7.1)
    Collecting sqlite-fts4 (from sqlite-utils&gt;=3.35.0-&gt;llm)
      Downloading sqlite_fts4-1.0.3-py3-none-any.whl (10.0 kB)
    Collecting tabulate (from sqlite-utils&gt;=3.35.0-&gt;llm)
      Downloading tabulate-0.9.0-py3-none-any.whl (35 kB)
    Requirement already satisfied: python-dateutil in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from sqlite-utils&gt;=3.35.0-&gt;llm) (2.8.2)
    Requirement already satisfied: requests&gt;=2.20 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from openai-&gt;llm) (2.31.0)
    Collecting tqdm (from openai-&gt;llm)
      Downloading tqdm-4.66.1-py3-none-any.whl (78 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.3&#x2F;78.3 kB 41.9 MB&#x2F;s eta 0:00:00
    Collecting aiohttp (from openai-&gt;llm)
      Downloading aiohttp-3.8.6-cp311-cp311-macosx_11_0_arm64.whl (343 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 343.5&#x2F;343.5 kB 3.5 MB&#x2F;s eta 0:00:00
    Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from requests&gt;=2.20-&gt;openai-&gt;llm) (3.2.0)
    Requirement already satisfied: idna&lt;4,&gt;=2.5 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from requests&gt;=2.20-&gt;openai-&gt;llm) (3.4)
    Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from requests&gt;=2.20-&gt;openai-&gt;llm) (2.0.4)
    Requirement already satisfied: certifi&gt;=2017.4.17 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from requests&gt;=2.20-&gt;openai-&gt;llm) (2023.7.22)
    Collecting attrs&gt;=17.3.0 (from aiohttp-&gt;openai-&gt;llm)
      Downloading attrs-23.1.0-py3-none-any.whl (61 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.2&#x2F;61.2 kB 41.9 MB&#x2F;s eta 0:00:00
    Collecting multidict&lt;7.0,&gt;=4.5 (from aiohttp-&gt;openai-&gt;llm)
      Downloading multidict-6.0.4-cp311-cp311-macosx_11_0_arm64.whl (29 kB)
    Collecting async-timeout&lt;5.0,&gt;=4.0.0a3 (from aiohttp-&gt;openai-&gt;llm)
      Downloading async_timeout-4.0.3-py3-none-any.whl (5.7 kB)
    Collecting yarl&lt;2.0,&gt;=1.0 (from aiohttp-&gt;openai-&gt;llm)
      Downloading yarl-1.9.2-cp311-cp311-macosx_11_0_arm64.whl (61 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.3&#x2F;61.3 kB 427.1 kB&#x2F;s eta 0:00:00
    Collecting frozenlist&gt;=1.1.1 (from aiohttp-&gt;openai-&gt;llm)
      Downloading frozenlist-1.4.0-cp311-cp311-macosx_11_0_arm64.whl (46 kB)
        ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.7&#x2F;46.7 kB 14.8 MB&#x2F;s eta 0:00:00
    Collecting aiosignal&gt;=1.1.2 (from aiohttp-&gt;openai-&gt;llm)
      Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)
    Requirement already satisfied: six&gt;=1.5 in &#x2F;zip&#x2F;Lib&#x2F;site-packages (from python-dateutil-&gt;sqlite-utils&gt;=3.35.0-&gt;llm) (1.16.0)
    Installing collected packages: sqlite-fts4, tqdm, tabulate, python-ulid, pluggy, multidict, frozenlist, click-default-group, attrs, async-timeout, yarl, sqlite-utils, aiosignal, sqlite-migrate, aiohttp, openai, llm
    ERROR: Could not install packages due to an OSError: [Errno 2] ENOENT&#x2F;2&#x2F;No such file or directory: &#x27;&#x2F;Users&#x2F;simon&#x2F;.local&#x2F;bin&#x2F;sqlite-utils&#x27;</code></pre></div><br/><div id="38103827" class="c"><input type="checkbox" id="c-38103827" checked=""/><div class="controls bullet"><span class="by">ahgamut</span><span>|</span><a href="#38102509">root</a><span>|</span><a href="#38103207">parent</a><span>|</span><a href="#38108057">next</a><span>|</span><label class="collapse" for="c-38103827">[-]</label><label class="expand" for="c-38103827">[1 more]</label></div><br/><div class="children"><div class="content">Yes, so pip works because the Python APE has OpenSSL built-in.<p>pip install requires modifying the APE, so I end up installing pure-Python libraries as follows:<p><pre><code>    mkdir Lib
    .&#x2F;python -m pip download httpx
    unzip .&#x2F;*.whl -d .&#x2F;Lib
    mv python python.com # in case the next step doesn&#x27;t work
    zip -r .&#x2F;python.com Lib
    mv python.com python
</code></pre>
Installing CPython extensions like this is an unsolved problem, but I think there might be some interesting workarounds possible.</div><br/></div></div></div></div></div></div></div></div><div id="38101995" class="c"><input type="checkbox" id="c-38101995" checked=""/><div class="controls bullet"><span class="by">eatonphil</span><span>|</span><a href="#38102509">prev</a><span>|</span><a href="#38105206">next</a><span>|</span><label class="collapse" for="c-38101995">[-]</label><label class="expand" for="c-38101995">[14 more]</label></div><br/><div class="children"><div class="content">&gt; The end result is that if you switch your Linux build process to use cosmocc instead of cc then the programs you build, e.g. Bash and Emacs, will just work on the command prompts of totally different platforms like Windows and MacOS, and when you run your programs there, it&#x27;ll feel like you&#x27;re on Linux. However portability isn&#x27;t the only selling point. Cosmo Libc will make your software faster and use less memory too. For example, when I build Emacs using the cosmocc toolchain, Emacs thinks it&#x27;s building for Linux. Then, when I run it on Windows:<p>&gt; It actually goes 2x faster than the native WIN32 port that the Emacs authors wrote on their own. Cosmo Emacs loads my dotfiles in 1.2 seconds whereas GNU Emacs on Windows loads them in 2.3 seconds.<p>Impressive stuff.</div><br/><div id="38104579" class="c"><input type="checkbox" id="c-38104579" checked=""/><div class="controls bullet"><span class="by">stephc_int13</span><span>|</span><a href="#38101995">parent</a><span>|</span><a href="#38102945">next</a><span>|</span><label class="collapse" for="c-38104579">[-]</label><label class="expand" for="c-38104579">[9 more]</label></div><br/><div class="children"><div class="content">This is all super impressive especially for such a small team.<p>But we should keep in mind that this project is what POSIX should have been, this is a big patch to make things right, as they should have been more than 20 years ago.<p>It seems magical because of the failure of numerous other teams and people who never managed to tackle the portability issue with the right mindset and skills.</div><br/><div id="38108974" class="c"><input type="checkbox" id="c-38108974" checked=""/><div class="controls bullet"><span class="by">resonious</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38104579">parent</a><span>|</span><a href="#38108343">next</a><span>|</span><label class="collapse" for="c-38108974">[-]</label><label class="expand" for="c-38108974">[2 more]</label></div><br/><div class="children"><div class="content">I think this could be said about pretty much any good invention. The physical world doesn&#x27;t change much, so the only barrier to invention is human. And I suspect most inventions have someone imagining it long before some other person actually builds it.</div><br/><div id="38110477" class="c"><input type="checkbox" id="c-38110477" checked=""/><div class="controls bullet"><span class="by">stephc_int13</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38108974">parent</a><span>|</span><a href="#38108343">next</a><span>|</span><label class="collapse" for="c-38110477">[-]</label><label class="expand" for="c-38110477">[1 more]</label></div><br/><div class="children"><div class="content">I disagree.<p>Most new development in tech, including software, have some dependencies on something that was not available before.</div><br/></div></div></div></div><div id="38108343" class="c"><input type="checkbox" id="c-38108343" checked=""/><div class="controls bullet"><span class="by">zik</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38104579">parent</a><span>|</span><a href="#38108974">prev</a><span>|</span><a href="#38102945">next</a><span>|</span><label class="collapse" for="c-38108343">[-]</label><label class="expand" for="c-38108343">[6 more]</label></div><br/><div class="children"><div class="content">Is it the job of linux OS people to provide multi-platform executable compatibility with every other OS? That seems like a stretch considering that no OS has ever done that.</div><br/><div id="38108809" class="c"><input type="checkbox" id="c-38108809" checked=""/><div class="controls bullet"><span class="by">uncomputation</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38108343">parent</a><span>|</span><a href="#38102945">next</a><span>|</span><label class="collapse" for="c-38108809">[-]</label><label class="expand" for="c-38108809">[5 more]</label></div><br/><div class="children"><div class="content">You have it backwards on two counts. First count is the point of POSIX is any OS vendor doesn’t need to worry about any other OS compatibility. Just implement POSIX interfaces. Second count is that is OP’s exact point: it never has been done before, because too many OS vendors give POSIX very little thought. This helps realize the original vision of POSIX.</div><br/><div id="38108858" class="c"><input type="checkbox" id="c-38108858" checked=""/><div class="controls bullet"><span class="by">CharlesW</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38108809">parent</a><span>|</span><a href="#38109142">next</a><span>|</span><label class="collapse" for="c-38108858">[-]</label><label class="expand" for="c-38108858">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>First count is the point of POSIX is any OS vendor doesn’t need to worry about any other OS compatibility. Just implement POSIX interfaces.</i><p>I must be missing something. How are you getting from &quot;just implement POSIX interfaces&quot; to &quot;compile once run everywhere&quot;?<p>Wouldn&#x27;t the former just promise that you could compile the same source on any POSIX-compliant OSs and get a binary that runs on that OS, on that architecture?</div><br/></div></div><div id="38109142" class="c"><input type="checkbox" id="c-38109142" checked=""/><div class="controls bullet"><span class="by">rhizome</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38108809">parent</a><span>|</span><a href="#38108858">prev</a><span>|</span><a href="#38102945">next</a><span>|</span><label class="collapse" for="c-38109142">[-]</label><label class="expand" for="c-38109142">[3 more]</label></div><br/><div class="children"><div class="content">POSIX was never about <i>binary</i> portability.</div><br/><div id="38110459" class="c"><input type="checkbox" id="c-38110459" checked=""/><div class="controls bullet"><span class="by">stephc_int13</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38109142">parent</a><span>|</span><a href="#38109243">next</a><span>|</span><label class="collapse" for="c-38110459">[-]</label><label class="expand" for="c-38110459">[1 more]</label></div><br/><div class="children"><div class="content">The binary portability is, in practice, not the most difficult feature, as long as the CPU arch is the same. It is also kind of a hack and IMO a nice-to-have feature but not as vital as true portability.<p>POSIX was not limited to the Unix world, the goal was for it to be implemented by all OS vendors, and it was partially done.</div><br/></div></div><div id="38109243" class="c"><input type="checkbox" id="c-38109243" checked=""/><div class="controls bullet"><span class="by">sheepscreek</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38109142">parent</a><span>|</span><a href="#38110459">prev</a><span>|</span><a href="#38102945">next</a><span>|</span><label class="collapse" for="c-38109243">[-]</label><label class="expand" for="c-38109243">[1 more]</label></div><br/><div class="children"><div class="content">Well said. In reality, it has been more about supporting common system level APIs (think read, write, fork, etc).</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38102945" class="c"><input type="checkbox" id="c-38102945" checked=""/><div class="controls bullet"><span class="by">AYoung010</span><span>|</span><a href="#38101995">parent</a><span>|</span><a href="#38104579">prev</a><span>|</span><a href="#38105206">next</a><span>|</span><label class="collapse" for="c-38102945">[-]</label><label class="expand" for="c-38102945">[4 more]</label></div><br/><div class="children"><div class="content">That was the most interesting part of the article for me. I don&#x27;t understand how it can be faster, given that there&#x27;s syscall translation going on. Is this more of a commentary on the quality of the `libc` available on Windows? Or on the quality of the GNU Emacs Windows port?</div><br/><div id="38104654" class="c"><input type="checkbox" id="c-38104654" checked=""/><div class="controls bullet"><span class="by">vitiral</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38102945">parent</a><span>|</span><a href="#38103479">next</a><span>|</span><label class="collapse" for="c-38104654">[-]</label><label class="expand" for="c-38104654">[2 more]</label></div><br/><div class="children"><div class="content">IIUC there is no syscall translation, it&#x27;s more like there are separate libc implementations and the correct one gets selected at program start based on the OS.</div><br/><div id="38107999" class="c"><input type="checkbox" id="c-38107999" checked=""/><div class="controls bullet"><span class="by">ReactiveJelly</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38104654">parent</a><span>|</span><a href="#38103479">next</a><span>|</span><label class="collapse" for="c-38107999">[-]</label><label class="expand" for="c-38107999">[1 more]</label></div><br/><div class="children"><div class="content">So like in-process WINE?</div><br/></div></div></div></div><div id="38103479" class="c"><input type="checkbox" id="c-38103479" checked=""/><div class="controls bullet"><span class="by">PrivateButts</span><span>|</span><a href="#38101995">root</a><span>|</span><a href="#38102945">parent</a><span>|</span><a href="#38104654">prev</a><span>|</span><a href="#38105206">next</a><span>|</span><label class="collapse" for="c-38103479">[-]</label><label class="expand" for="c-38103479">[1 more]</label></div><br/><div class="children"><div class="content">Could be like the improvements seen when running applications using DXVK. My understanding is that sometimes these translation layers can use newer and more efficient methods than the path that a native implement for the time would use. I&#x27;m not a subject matter expert though, and could be completely off base.</div><br/></div></div></div></div></div></div><div id="38105206" class="c"><input type="checkbox" id="c-38105206" checked=""/><div class="controls bullet"><span class="by">mprovost</span><span>|</span><a href="#38101995">prev</a><span>|</span><a href="#38105318">next</a><span>|</span><label class="collapse" for="c-38105206">[-]</label><label class="expand" for="c-38105206">[8 more]</label></div><br/><div class="children"><div class="content">Every time I see an update from Justine I get so excited. It&#x27;s like watching the future of computing unfold in real time. It makes me wish we could send them back in time - all of the pieces to make this work have been in place for a long long time but nobody connected all the dots. The funniest part of this post are the instructions to integrate it with autoconf. All of that autotools nonsense wouldn&#x27;t have had to exist if this had been around!</div><br/><div id="38107359" class="c"><input type="checkbox" id="c-38107359" checked=""/><div class="controls bullet"><span class="by">appleskeptic</span><span>|</span><a href="#38105206">parent</a><span>|</span><a href="#38105318">next</a><span>|</span><label class="collapse" for="c-38107359">[-]</label><label class="expand" for="c-38107359">[7 more]</label></div><br/><div class="children"><div class="content">This is great and all but it’s fundamentally a toy. There are a number of tradeoffs involved here, all so that the same binary runs on multiple operating systems, which isn’t  actually very useful. If your program isn’t vaguely portable  to begin with, it still won’t work.</div><br/><div id="38109519" class="c"><input type="checkbox" id="c-38109519" checked=""/><div class="controls bullet"><span class="by">tstack</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107359">parent</a><span>|</span><a href="#38107457">next</a><span>|</span><label class="collapse" for="c-38109519">[-]</label><label class="expand" for="c-38109519">[1 more]</label></div><br/><div class="children"><div class="content">&gt; all so that the same binary runs on multiple operating systems, which isn’t actually very useful.<p>I like to mention my use case when this comes up: my log file viewer (<a href="https:&#x2F;&#x2F;lnav.org" rel="nofollow noreferrer">https:&#x2F;&#x2F;lnav.org</a>) uploads an agent to remote hosts in order to tail log files on that host[1].  While lnav itself is not built using cosmo, the agent is.  So, it works on multiple OSs without having to compile and include multiple versions of the agent.<p>[1] - <a href="https:&#x2F;&#x2F;lnav.org&#x2F;2021&#x2F;05&#x2F;03&#x2F;tailing-remote-files.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;lnav.org&#x2F;2021&#x2F;05&#x2F;03&#x2F;tailing-remote-files.html</a></div><br/></div></div><div id="38107457" class="c"><input type="checkbox" id="c-38107457" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107359">parent</a><span>|</span><a href="#38109519">prev</a><span>|</span><a href="#38110191">next</a><span>|</span><label class="collapse" for="c-38107457">[-]</label><label class="expand" for="c-38107457">[4 more]</label></div><br/><div class="children"><div class="content">Can you elaborate? I’m not sure I follow your argument. A requirement to write portable C doesn’t seem so insurmountable to render the project a mere toy.<p>The suite of useful tools included in the post seems like a good counter example to the claim that this is inherently not useful for anything serious.<p>Fat multi-arch binaries are a thing on other platforms like darwin, where they are used extremely widely. What makes this approach so different?</div><br/><div id="38108625" class="c"><input type="checkbox" id="c-38108625" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107457">parent</a><span>|</span><a href="#38109975">next</a><span>|</span><label class="collapse" for="c-38108625">[-]</label><label class="expand" for="c-38108625">[1 more]</label></div><br/><div class="children"><div class="content">Multi-arch seems completely different than multi-platform. The former is obviously useful, the user isn&#x27;t necessarily going to understand why a program which ran on their MacBook  isn&#x27;t runnable on their older iMac because it&#x27;s ARM only. The two programs can also still use highly specific OS integrations, GPU acceleration APIs, and make assumptions about being a macOS system. The stretch to multi-platform comes at a much higher cost in limitations for a much more dubious level of gain, as badass as it is from a technical perspective. When I say &quot;cost&quot; e.g. on Windows I have to rename the executable to end in .exe be able to launch it, when I do simple text based programs like nano do run... but they are completely unusable. Bash runs but I can&#x27;t select, copy, or paste text with the mouse. It&#x27;s borderline unusable if the app does more than behind the scenes processing only.<p>With that in mind, &quot;plugins&quot; to cross platform applications instead of standalone apps could be an interesting use case though. That&#x27;s something which has typically went towards per platform, interpreted&#x2F;jited, or VM&#x27;d solutions - all of which have their downsides for a typical user, don&#x27;t really care about the rest of the system as much, and don&#x27;t need to be anything but &quot;behind the scenes processing&quot; in most cases.</div><br/></div></div><div id="38109975" class="c"><input type="checkbox" id="c-38109975" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107457">parent</a><span>|</span><a href="#38108625">prev</a><span>|</span><a href="#38108075">next</a><span>|</span><label class="collapse" for="c-38109975">[-]</label><label class="expand" for="c-38109975">[1 more]</label></div><br/><div class="children"><div class="content">ISO C and POSIX don&#x27;t provide support for anything beyond CLI applications and daemons.<p>Sure if one wants to live in the world of UNIX before X Windows, I guess it is ok.</div><br/></div></div><div id="38108075" class="c"><input type="checkbox" id="c-38108075" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107457">parent</a><span>|</span><a href="#38109975">prev</a><span>|</span><a href="#38110191">next</a><span>|</span><label class="collapse" for="c-38108075">[-]</label><label class="expand" for="c-38108075">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand what&#x27;s useful here either. It&#x27;s not inherently useful to have my `ls` on Mac be the same one as chromeOS, I&#x27;m happy with whatever is on either.<p>If this means I can FFI link against one ONNX library instead of one for linux64, Linux ARM, macOS arm, macOS Intel, android, iOS, win x64, win ARM, I&#x27;m all for it though.</div><br/></div></div></div></div><div id="38110191" class="c"><input type="checkbox" id="c-38110191" checked=""/><div class="controls bullet"><span class="by">bambax</span><span>|</span><a href="#38105206">root</a><span>|</span><a href="#38107359">parent</a><span>|</span><a href="#38107457">prev</a><span>|</span><a href="#38105318">next</a><span>|</span><label class="collapse" for="c-38110191">[-]</label><label class="expand" for="c-38110191">[1 more]</label></div><br/><div class="children"><div class="content">Not sure what you mean by that, but a lot of great things start as toys.<p>That even explains part of their success: nobody pays attention to toys, and once they become ubiquitous it&#x27;s too late to fight them.</div><br/></div></div></div></div></div></div><div id="38105318" class="c"><input type="checkbox" id="c-38105318" checked=""/><div class="controls bullet"><span class="by">haptic</span><span>|</span><a href="#38105206">prev</a><span>|</span><a href="#38103124">next</a><span>|</span><label class="collapse" for="c-38105318">[-]</label><label class="expand" for="c-38105318">[14 more]</label></div><br/><div class="children"><div class="content">This is a neat trick and clever technical work, but is it useful in practical terms?<p>Like, wouldn&#x27;t you just download the binary that&#x27;s been compiled specifically for the platform and architecture that you&#x27;re using? Rather than relying on a potentially quite fragile method of cross-platform execution.<p>In a way it kind of reminds me of Urbit. Very clever, very cool, but also very niche and more of a hobbyist showcase project than anything else. Not that there&#x27;s anything wrong with that of course.</div><br/><div id="38105673" class="c"><input type="checkbox" id="c-38105673" checked=""/><div class="controls bullet"><span class="by">piaste</span><span>|</span><a href="#38105318">parent</a><span>|</span><a href="#38105522">next</a><span>|</span><label class="collapse" for="c-38105673">[-]</label><label class="expand" for="c-38105673">[3 more]</label></div><br/><div class="children"><div class="content">For the consumer it&#x27;s a simple switch(arch) statement to download the right binary.<p>But for the <i>developer</i>, it means setting up 9 different build pipelines and artifacts (and realistically, most won&#x27;t bother with BSD builds and a lot still don&#x27;t bother with arm64 builds).<p>It&#x27;s not necessarily a huge hurdle or an unbearable expense with modern CI services, but it&#x27;s still a massive deal that this project can make it all unnecessary for every single C&#x2F;C++ developer out there. If this were a paid product, literally millions of companies would be happy to pay a small fee to save on CI costs, time and maintenance.</div><br/><div id="38108589" class="c"><input type="checkbox" id="c-38108589" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38105673">parent</a><span>|</span><a href="#38110130">next</a><span>|</span><label class="collapse" for="c-38108589">[-]</label><label class="expand" for="c-38108589">[1 more]</label></div><br/><div class="children"><div class="content">Does this really change if Cosmopolitan e.g. outputs 9 different artifacts instead of 1 artifact merging all 9? The advantage you&#x27;re describing seems to lie mostly in &quot;a C&#x2F;C++ build system which can actually cross compile without pulling your hair out&quot; not &quot;a C&#x2F;C++ build system which produces a binary I can take from BSD to Windows and execute unmodified&quot;.</div><br/></div></div><div id="38110130" class="c"><input type="checkbox" id="c-38110130" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38105673">parent</a><span>|</span><a href="#38108589">prev</a><span>|</span><a href="#38105522">next</a><span>|</span><label class="collapse" for="c-38110130">[-]</label><label class="expand" for="c-38110130">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;ll still need nine test pipelines.</div><br/></div></div></div></div><div id="38105522" class="c"><input type="checkbox" id="c-38105522" checked=""/><div class="controls bullet"><span class="by">pie_flavor</span><span>|</span><a href="#38105318">parent</a><span>|</span><a href="#38105673">prev</a><span>|</span><a href="#38107383">next</a><span>|</span><label class="collapse" for="c-38105522">[-]</label><label class="expand" for="c-38105522">[2 more]</label></div><br/><div class="children"><div class="content">Write once, run anywhere has been a slogan for coming up on thirty years. Except all implementations of it have acceded to reality in one or more important aspects, such as needing to install Java separately. And it&#x27;s not just platform-specific compilation, it&#x27;s everything that could <i>support</i> platform-specific compilation (if you&#x27;ve never tried to cross-compile from Linux to MSVC, you should), and also all sorts of platform-specific code (like console functions vs terminal sequences, or even stuff as banal as $HOME vs $USERPROFILE). Cosmopolitan still isn&#x27;t perfect, because it doesn&#x27;t emulate <i>all</i> of Linux, so you still need kernel32.dll here and there. But it is still the best of any attempts.</div><br/><div id="38105588" class="c"><input type="checkbox" id="c-38105588" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38105522">parent</a><span>|</span><a href="#38107383">next</a><span>|</span><label class="collapse" for="c-38105588">[-]</label><label class="expand" for="c-38105588">[1 more]</label></div><br/><div class="children"><div class="content">I agree. You sound like you&#x27;re speaking from experience. If so, I&#x27;d love to hear what sort of stuff you&#x27;re building with Cosmo, if you&#x27;re able to share! Feel free to reach out anytime (privately or discord) and let me know what the project can be doing to better serve your needs.</div><br/></div></div></div></div><div id="38107383" class="c"><input type="checkbox" id="c-38107383" checked=""/><div class="controls bullet"><span class="by">appleskeptic</span><span>|</span><a href="#38105318">parent</a><span>|</span><a href="#38105522">prev</a><span>|</span><a href="#38103124">next</a><span>|</span><label class="collapse" for="c-38107383">[-]</label><label class="expand" for="c-38107383">[8 more]</label></div><br/><div class="children"><div class="content">It’s a very cool toy and fun personal project, but it’s not much more even though the author really wants it to be. Your code has to be vaguely portable anyway for this to work. So why would you pay the tradeoffs for a binary that runs in multiple operating systems, which is not that useful.</div><br/><div id="38107938" class="c"><input type="checkbox" id="c-38107938" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38107383">parent</a><span>|</span><a href="#38108127">next</a><span>|</span><label class="collapse" for="c-38107938">[-]</label><label class="expand" for="c-38107938">[3 more]</label></div><br/><div class="children"><div class="content">I can only hope my own projects reach 10% the coolness of this &quot;toy&quot; one day.</div><br/><div id="38108083" class="c"><input type="checkbox" id="c-38108083" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38107938">parent</a><span>|</span><a href="#38108127">next</a><span>|</span><label class="collapse" for="c-38108083">[-]</label><label class="expand" for="c-38108083">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not a personal attack</div><br/><div id="38109357" class="c"><input type="checkbox" id="c-38109357" checked=""/><div class="controls bullet"><span class="by">rhizome</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38108083">parent</a><span>|</span><a href="#38108127">next</a><span>|</span><label class="collapse" for="c-38109357">[-]</label><label class="expand" for="c-38109357">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t have to be personal to be condescending and&#x2F;or dismissive.</div><br/></div></div></div></div></div></div><div id="38108127" class="c"><input type="checkbox" id="c-38108127" checked=""/><div class="controls bullet"><span class="by">legends2k</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38107383">parent</a><span>|</span><a href="#38107938">prev</a><span>|</span><a href="#38103124">next</a><span>|</span><label class="collapse" for="c-38108127">[-]</label><label class="expand" for="c-38108127">[4 more]</label></div><br/><div class="children"><div class="content">I noticed a similar comment from you in the same thread.  If you don&#x27;t write portable software, it doesn&#x27;t mean the world isn&#x27;t writing portable software in C, C++, Rust, etc.  To list a very few ones:<p>Blender, GIMP, Emacs, Vim, Pidgin, Evince, Firefox, gEdit, Inkscape, Krita, FFmpeg, Python, Perl, ... I could go on and on.</div><br/><div id="38109987" class="c"><input type="checkbox" id="c-38109987" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38108127">parent</a><span>|</span><a href="#38108555">next</a><span>|</span><label class="collapse" for="c-38109987">[-]</label><label class="expand" for="c-38109987">[1 more]</label></div><br/><div class="children"><div class="content">That &quot;portable&quot; software is full of conditional compilation flags and wrappers to OS specific APIs.</div><br/></div></div><div id="38108555" class="c"><input type="checkbox" id="c-38108555" checked=""/><div class="controls bullet"><span class="by">appleskeptic</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38108127">parent</a><span>|</span><a href="#38109987">prev</a><span>|</span><a href="#38103124">next</a><span>|</span><label class="collapse" for="c-38108555">[-]</label><label class="expand" for="c-38108555">[2 more]</label></div><br/><div class="children"><div class="content">You can write portable software… and then compile it for each platform to get the best performance and functionality.</div><br/><div id="38109885" class="c"><input type="checkbox" id="c-38109885" checked=""/><div class="controls bullet"><span class="by">joe-user</span><span>|</span><a href="#38105318">root</a><span>|</span><a href="#38108555">parent</a><span>|</span><a href="#38103124">next</a><span>|</span><label class="collapse" for="c-38109885">[-]</label><label class="expand" for="c-38109885">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You can write portable software… and then compile it for each platform to get the best performance and functionality.<p>Perhaps not what you intended, but I believe this is that exactly what Cosmopolitan is doing:
- They are writing portable software in that it can run on various architectures and operating systems
- They compile it for each platform, even if the output is a single binary
- For the best performance and functionality, they mention several examples of how Cosmopolitan outperforms the native alternatives<p>I&#x27;m sure there are plenty of rebuttals (&quot;Emacs on Windows is a port&quot;, &quot;Cygwin isn&#x27;t portable&quot;, &quot;they could make the native version of $WHATEVER more performant&quot;, &quot;Cosmopolitan isn&#x27;t always faster&quot;, etc.), all of which are well and good, but would be missing the bigger picture, which is that there are reasons for both approaches (among others!) to exist, an idea that far transcends software.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38103124" class="c"><input type="checkbox" id="c-38103124" checked=""/><div class="controls bullet"><span class="by">AMICABoard</span><span>|</span><a href="#38105318">prev</a><span>|</span><a href="#38108148">next</a><span>|</span><label class="collapse" for="c-38103124">[-]</label><label class="expand" for="c-38103124">[1 more]</label></div><br/><div class="children"><div class="content">I swear this is the coolest project ever!!! I am using cosmo for our stuff too. jart &amp; the team is super dedicated and responsive.<p>Kinda feels like they are super intelligent alien beings from another planet trying to save us from software bloat and fragmentation.<p>&gt; POSIX even changed their rules about binary in shell scripts specifically to let us do it.<p>I don&#x27;t know what to say.</div><br/></div></div><div id="38108148" class="c"><input type="checkbox" id="c-38108148" checked=""/><div class="controls bullet"><span class="by">smcameron</span><span>|</span><a href="#38103124">prev</a><span>|</span><a href="#38106066">next</a><span>|</span><label class="collapse" for="c-38108148">[-]</label><label class="expand" for="c-38108148">[4 more]</label></div><br/><div class="children"><div class="content">Cool.  Somebody still needs to teach sscanf how to parse floats though. <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;issues&#x2F;456">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;issues&#x2F;456</a><p>The code to do it would probably go in here: <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;master&#x2F;libc&#x2F;stdio&#x2F;vcscanf.c">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;master&#x2F;libc&#x2F;stdio&#x2F;...</a><p>I mean, I know why it&#x27;s not done (parsing floats correctly is a lot harder than it would at first seem to be) and I&#x27;m not complaining, more like hinting to some of the fine people that haunt this website who might find such a task interesting.</div><br/><div id="38108334" class="c"><input type="checkbox" id="c-38108334" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#38108148">parent</a><span>|</span><a href="#38106066">next</a><span>|</span><label class="collapse" for="c-38108334">[-]</label><label class="expand" for="c-38108334">[3 more]</label></div><br/><div class="children"><div class="content">Is anyone working on this? I&#x27;ll try it out. I&#x27;ve been reading all I can about floats the past few days in order to add support for them in my language. Perfect opportunity.</div><br/><div id="38108424" class="c"><input type="checkbox" id="c-38108424" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38108148">root</a><span>|</span><a href="#38108334">parent</a><span>|</span><a href="#38106066">next</a><span>|</span><label class="collapse" for="c-38108424">[-]</label><label class="expand" for="c-38108424">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m so happy to hear you&#x27;re interested in this problem. There&#x27;s two packages in the Cosmo repo you could depend on for doing this: third_party&#x2F;double-conversion&#x2F; and third_party&#x2F;gdtoa&#x2F;. Both libraries are pretty good, but I think double-conversion is the more impressive of the two. It&#x27;d be great to see scanf() parse floats with double-conversion if it&#x27;s possible. One last thing, if any of the non-standardized features of our scanf() implementation get in your way, then I&#x27;m not super attached to them and they can be deleted.</div><br/><div id="38108574" class="c"><input type="checkbox" id="c-38108574" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#38108148">root</a><span>|</span><a href="#38108424">parent</a><span>|</span><a href="#38106066">next</a><span>|</span><label class="collapse" for="c-38108574">[-]</label><label class="expand" for="c-38108574">[1 more]</label></div><br/><div class="children"><div class="content">I see. I&#x27;ll try those libraries out. Was about to try writing my own algorithm despite not having a math background. The libraries will definitely be easier. Cosmopolitan can actually link against those despite being the libc?<p>I&#x27;m building my copy of cosmopolitan right now. If I succeed, I&#x27;ll send you a pull request on GitHub.</div><br/></div></div></div></div></div></div></div></div><div id="38106066" class="c"><input type="checkbox" id="c-38106066" checked=""/><div class="controls bullet"><span class="by">vanderZwan</span><span>|</span><a href="#38108148">prev</a><span>|</span><a href="#38108154">next</a><span>|</span><label class="collapse" for="c-38106066">[-]</label><label class="expand" for="c-38106066">[4 more]</label></div><br/><div class="children"><div class="content">&gt; <i>However portability isn&#x27;t the only selling point. Cosmo Libc will make your software faster and use less memory too.</i><p>With that in mind, is there a &quot;slim binary&quot; mode that lets me only export the code to run the binaries on <i>my</i> system, so that I can reap these benefits for personal use without added &quot;bloat&quot; for a feature that I won&#x27;t need? (where &quot;bloat&quot; is contextual, with the current context being &quot;not actually planning to make use of portability&quot;)</div><br/><div id="38106371" class="c"><input type="checkbox" id="c-38106371" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38106066">parent</a><span>|</span><a href="#38106425">next</a><span>|</span><label class="collapse" for="c-38106371">[-]</label><label class="expand" for="c-38106371">[1 more]</label></div><br/><div class="children"><div class="content">Author here. We&#x27;ve got you covered. Search for `MODE=tinylinux` in the <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan#getting-started">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan#getting-started</a> section of the README. If you use that build mode, then hello world for x86 linux is only 8kb in size. It&#x27;s very similar to what you&#x27;d expect from Musl Libc. All the Windows &#x2F; BSD &#x2F; Mac &#x2F; BIOS stuff gets removed from the compilation.<p>That predefined mode is actually a friendly wrapper around a more generalized platform support system Cosmopolitan offers, which is called `-DSUPPORT_VECTOR` where you can define a bitset of specifically what platforms you want to be supported. Then dead code elimination takes care of the rest. The same concept also generally applies to microarchitecture support, where you can have as much or as little runtime dispatching as you want.</div><br/></div></div><div id="38106425" class="c"><input type="checkbox" id="c-38106425" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#38106066">parent</a><span>|</span><a href="#38106371">prev</a><span>|</span><a href="#38108154">next</a><span>|</span><label class="collapse" for="c-38106425">[-]</label><label class="expand" for="c-38106425">[2 more]</label></div><br/><div class="children"><div class="content">I think you can subset supported systems, like you could only compile for x86_64 ELF systems (aka Linux and *BSD) and have the shim be much smaller; presumably a subset of one is also acceptable. I don’t know how (or if) you can do this with the new build environment, though.</div><br/><div id="38107280" class="c"><input type="checkbox" id="c-38107280" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#38106066">root</a><span>|</span><a href="#38106425">parent</a><span>|</span><a href="#38108154">next</a><span>|</span><label class="collapse" for="c-38107280">[-]</label><label class="expand" for="c-38107280">[1 more]</label></div><br/><div class="children"><div class="content">HN doesn&#x27;t allow non-ASCII in usernames?</div><br/></div></div></div></div></div></div><div id="38108154" class="c"><input type="checkbox" id="c-38108154" checked=""/><div class="controls bullet"><span class="by">guidoism</span><span>|</span><a href="#38106066">prev</a><span>|</span><a href="#38108060">next</a><span>|</span><label class="collapse" for="c-38108154">[-]</label><label class="expand" for="c-38108154">[1 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t use wget from homebrew anymore on my computer because of some weird shared library crap but I can download this universal binary and it just works. Whaaaaat!?!<p>So so so awesome.</div><br/></div></div><div id="38108060" class="c"><input type="checkbox" id="c-38108060" checked=""/><div class="controls bullet"><span class="by">jacquesm</span><span>|</span><a href="#38108154">prev</a><span>|</span><a href="#38110373">next</a><span>|</span><label class="collapse" for="c-38108060">[-]</label><label class="expand" for="c-38108060">[1 more]</label></div><br/><div class="children"><div class="content">Usually when I see yet another variation on this theme my first response is &#x27;oh not, not again&#x27;, but this time it is more like &#x27;wow, that&#x27;s really cool&#x27; and I hope that it will be further established and that it will see much adoption.<p>Of course to get <i>fewer</i> distribution formats you had to make one more distribution format but in this one case it might actually work.</div><br/></div></div><div id="38110373" class="c"><input type="checkbox" id="c-38110373" checked=""/><div class="controls bullet"><span class="by">pvsukale3</span><span>|</span><a href="#38108060">prev</a><span>|</span><a href="#38105806">next</a><span>|</span><label class="collapse" for="c-38110373">[-]</label><label class="expand" for="c-38110373">[1 more]</label></div><br/><div class="children"><div class="content">How would one go about compiling Ruby to make a cross platform binary?<p>I have seen the Ruby build process and it also links to libraries like OpenSSL.<p>Reference: <a href="https:&#x2F;&#x2F;docs.ruby-lang.org&#x2F;en&#x2F;master&#x2F;contributing&#x2F;building_ruby_md.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.ruby-lang.org&#x2F;en&#x2F;master&#x2F;contributing&#x2F;building_r...</a></div><br/></div></div><div id="38105806" class="c"><input type="checkbox" id="c-38105806" checked=""/><div class="controls bullet"><span class="by">c-c-c-c-c</span><span>|</span><a href="#38110373">prev</a><span>|</span><a href="#38107520">next</a><span>|</span><label class="collapse" for="c-38105806">[-]</label><label class="expand" for="c-38105806">[6 more]</label></div><br/><div class="children"><div class="content">&gt; POSIX even changed their rules about binary in shell scripts specifically to let us do it.<p>What does this refer to?<p>The latest POSIX standard was released 2007. [1]<p>1: <a href="https:&#x2F;&#x2F;standards.ieee.org&#x2F;ieee&#x2F;1003.1&#x2F;7101&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;standards.ieee.org&#x2F;ieee&#x2F;1003.1&#x2F;7101&#x2F;</a></div><br/><div id="38106428" class="c"><input type="checkbox" id="c-38106428" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38105806">parent</a><span>|</span><a href="#38106353">next</a><span>|</span><label class="collapse" for="c-38106428">[-]</label><label class="expand" for="c-38106428">[1 more]</label></div><br/><div class="children"><div class="content">Author here. See <a href="https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250" rel="nofollow noreferrer">https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250</a> and <a href="https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1226" rel="nofollow noreferrer">https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1226</a> with a major shoutout to Jilles Tjoelker from the FreeBSD who helped make it possible back then!</div><br/></div></div><div id="38106353" class="c"><input type="checkbox" id="c-38106353" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#38105806">parent</a><span>|</span><a href="#38106428">prev</a><span>|</span><a href="#38106528">next</a><span>|</span><label class="collapse" for="c-38106353">[-]</label><label class="expand" for="c-38106353">[3 more]</label></div><br/><div class="children"><div class="content">POSIX &#x2F; SUS &#x2F; the Open Group Base Specifications have issues (pun not intended, but I’ll take it), and then those issues have editions. The last one of those is from 2018[1], being a revision of (indeed) the 2008 issue. (I remember Landley being more than a little acidic about this versioning scheme.)<p>I still have no idea what the quote is referring to, though, and given Justine’s slightly (deliberately?) unhinged manner of writing, I’d give even odds the change is in fact from 2001 or something like that.<p>[1] <a href="https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9699919799.2018edition&#x2F;mindex.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9699919799.2018edition...</a></div><br/><div id="38106533" class="c"><input type="checkbox" id="c-38106533" checked=""/><div class="controls bullet"><span class="by">csande17</span><span>|</span><a href="#38105806">root</a><span>|</span><a href="#38106353">parent</a><span>|</span><a href="#38106528">next</a><span>|</span><label class="collapse" for="c-38106533">[-]</label><label class="expand" for="c-38106533">[2 more]</label></div><br/><div class="children"><div class="content">The references to POSIX &quot;approval&quot;&#x2F;&quot;changes&quot; in Cosmopolitan docs are usually talking about bugs like this: <a href="https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250" rel="nofollow noreferrer">https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250</a><p>I&#x27;m not sure whether the proposed changes have actually made it into a published edition of the specification.</div><br/><div id="38106892" class="c"><input type="checkbox" id="c-38106892" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#38105806">root</a><span>|</span><a href="#38106533">parent</a><span>|</span><a href="#38106528">next</a><span>|</span><label class="collapse" for="c-38106892">[-]</label><label class="expand" for="c-38106892">[1 more]</label></div><br/><div class="children"><div class="content">This looks to be the one, thank you! Doesn’t look to have gotten into the current version [the sh(1) page in the version I linked still refers to text files]. (The bug is also tagged tc3-2008, when the last corrigendum released is TC2, and the change was marked applied in 2019. So it makes sense it hasn’t found its way into a release yet.)</div><br/></div></div></div></div></div></div><div id="38106528" class="c"><input type="checkbox" id="c-38106528" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#38105806">parent</a><span>|</span><a href="#38106353">prev</a><span>|</span><a href="#38107520">next</a><span>|</span><label class="collapse" for="c-38106528">[-]</label><label class="expand" for="c-38106528">[1 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t think this is the bug they refer to, but it&#x27;s one affecting sh input rules. There are others.<p><a href="https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250" rel="nofollow noreferrer">https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250</a></div><br/></div></div></div></div><div id="38107520" class="c"><input type="checkbox" id="c-38107520" checked=""/><div class="controls bullet"><span class="by">ccooffee</span><span>|</span><a href="#38105806">prev</a><span>|</span><a href="#38107064">next</a><span>|</span><label class="collapse" for="c-38107520">[-]</label><label class="expand" for="c-38107520">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m amazed by this. Platform-independence _with the same binary_ is such a neat solution that would really have helped me at a prior job.<p>Some corporate IT shops manage user machines with tooling that can&#x27;t deploy software specific to machine os&#x2F;version&#x2F;hardware&#x2F;etc. This often caused problems with 32-bit vs 64-bit windows machines or differing windows versions (XP&#x2F;Vista&#x2F;....). We also couldn&#x27;t easily make linux or osx executables available for the end-users due to corporate IT policies.</div><br/></div></div><div id="38107064" class="c"><input type="checkbox" id="c-38107064" checked=""/><div class="controls bullet"><span class="by">modeless</span><span>|</span><a href="#38107520">prev</a><span>|</span><a href="#38104887">next</a><span>|</span><label class="collapse" for="c-38107064">[-]</label><label class="expand" for="c-38107064">[10 more]</label></div><br/><div class="children"><div class="content">I&#x27;m using Pyinstaller to ship a zero-dependency Python app. It would be amazing if Cosmopolitan could make it portable too. Is anyone working on Pyinstaller+Cosmopolitan integration? I guess a key issue there would be that many Python dependencies ship C extensions which are typically distributed as prebuilt platform-specific binary &quot;wheel&quot; packages via pip. I guess pip would need to start hosting a Cosmopolitan flavor of wheel package in addition to the native ones?</div><br/><div id="38107185" class="c"><input type="checkbox" id="c-38107185" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38107064">parent</a><span>|</span><a href="#38107173">next</a><span>|</span><label class="collapse" for="c-38107185">[-]</label><label class="expand" for="c-38107185">[6 more]</label></div><br/><div class="children"><div class="content">What I would prefer to see happen in the Python community is for Python packages to embed APE binaries and launch them as subprocesses (ideally using posix_spawn) because then you can mostly just ship pure Python with a few APE programs for your native needs, and nothing about the Python packaging ecosystem needs to change.<p>That was my dream when I worked on the TensorFlow team. One of the questions I asked myself is, if a MatMul kernel takes milliseconds to perform an op, and it takes microseconds to launch a subprocess, then why do I need to dynamically link a 50mb TensorFlow DSO when I can just whip up a simple C program to perform the very small amount of native math, system calls, and data crunching that I need for TensorBoard?<p>Well, now with Cosmopolitan, it&#x27;s finally possible. Just whip up the ~100 or so lines of C&#x2F;C++ code that&#x27;s impossible to do with Python into a small fat static APE binary, and vendor that program like any other .txt or .dat file asset. Then launch it when you need to, while never caring or needing to worry about shipping multiple .whl files or setting up Jenkins build farms for BSDs, Windows, etc. Life stays easy.</div><br/><div id="38109658" class="c"><input type="checkbox" id="c-38109658" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38107185">parent</a><span>|</span><a href="#38107307">next</a><span>|</span><label class="collapse" for="c-38109658">[-]</label><label class="expand" for="c-38109658">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <i>and it takes microseconds to launch a subprocess</i><p>On my laptop (ASUS GA503QM, 5800HS), running &#x2F;usr&#x2F;bin&#x2F;true to completion takes around 400μs, demonstrated by these three different approaches to spawning a thousand processes:<p><pre><code>  $ python -m timeit -n 1000 --setup &#x27;import subprocess&#x27; &#x27;subprocess.run([&quot;&#x2F;usr&#x2F;bin&#x2F;true&quot;])&#x27;
  1000 loops, best of 5: 441 usec per loop

  $ rustc -o x - &lt;&lt;&lt;&#x27;fn main() {
      for _ in 0..1000 {
          let _ = std::process::Command::new(&quot;&#x2F;usr&#x2F;bin&#x2F;true&quot;).status();
      }
  }&#x27; &amp;&amp; time .&#x2F;x
  .&#x2F;x  0.33s user 0.07s system 99% cpu 0.402 total

  $ time (i=0; while [ $i -lt 1000 ]; do i=$(($i + 1)); &#x2F;usr&#x2F;bin&#x2F;true; done)
  [elided]  0.66s user 0.43s system 100% cpu 1.088 total
</code></pre>
Historically spawning processes was <i>vastly</i> slower on Windows; I’m not certain of the current state though I think it improved a few years ago, but I believe it’s still considerably more than one millisecond; 10–20ms is the vague number that’s lodged in my memory, but not supported, and I can’t test it now. (I invite anyone running Windows to provide figures. You may well already have a true.exe somewhere, or there’s <a href="https:&#x2F;&#x2F;github.com&#x2F;mlocati&#x2F;true-for-windows">https:&#x2F;&#x2F;github.com&#x2F;mlocati&#x2F;true-for-windows</a>, or just write your own stub executable.)<p>If you’re going to be using such calls often, spawning just one persistent process and using IPC for I&#x2F;O is likely to be <i>much</i> faster.</div><br/><div id="38109768" class="c"><input type="checkbox" id="c-38109768" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38109658">parent</a><span>|</span><a href="#38107307">next</a><span>|</span><label class="collapse" for="c-38109768">[-]</label><label class="expand" for="c-38109768">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Historically spawning processes was <i>vastly</i> slower on Windows<p>Indeed.<p>&gt; I’m not certain of the current state though I think it improved a few years ago<p>It did? I feel like it gets slower and slower every time.<p>&gt; I believe it’s still considerably more than one millisecond; 10–20ms is the vague number that’s lodged in my memory, but not supported, and I can’t test it now. (I invite anyone running Windows to provide figures.)<p>Yep. On the Windows 10 machine I have it&#x27;s around 4ms, though that&#x27;s antivirus and other similar sources of slowness disabled. You could probably get it closer to 2-3ms on a faster machine, but that&#x27;s the ballpark.</div><br/></div></div></div></div><div id="38107307" class="c"><input type="checkbox" id="c-38107307" checked=""/><div class="controls bullet"><span class="by">modeless</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38107185">parent</a><span>|</span><a href="#38109658">prev</a><span>|</span><a href="#38107173">next</a><span>|</span><label class="collapse" for="c-38107307">[-]</label><label class="expand" for="c-38107307">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure I understand fully. Are you saying that instead of e.g. writing a neural net in Python using PyTorch (which loads several native extensions into the Python interpreter) I should write the whole neural net in C using a C neural net library, and ship it as an executable that my Python code can launch as a subprocess whenever it wants to run a forward or backward pass? Or are you saying that I can use PyTorch in Python but instead of loading a native extension into the Python process it should ship an executable that it launches every time it wants to run a compute kernel? Or something else?</div><br/><div id="38107451" class="c"><input type="checkbox" id="c-38107451" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38107307">parent</a><span>|</span><a href="#38107173">next</a><span>|</span><label class="collapse" for="c-38107451">[-]</label><label class="expand" for="c-38107451">[2 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s what I&#x27;m saying. Let&#x27;s say you are a Python package author. You ship your app or library on PyPi to a lot of users. You have a problem that can be solved in 100 lines of C++, but it can&#x27;t be solved using Python code. Python would just go too slow. That&#x27;s a problem, because in order to introduce a single line of native code into your Python package, it would require assuming numerous burdens relating to compilation and distribution. Native code is hard. Native code being hard is the whole reason we use high-level languages like Python. It&#x27;s hard because you&#x27;d have to setup a devops process to build and test your C code on all these different operating systems. So what I&#x27;m proposing that you consider instead, is compile the ~100 lines of C&#x2F;C++ code you want as a ~100kb fat APE binary, on your one dev system of choice, using Cosmo. Then embed that APE executable inside your pure Python package, launch it as a subprocess, and never have to worry about devops and distribution toil.</div><br/><div id="38107594" class="c"><input type="checkbox" id="c-38107594" checked=""/><div class="controls bullet"><span class="by">modeless</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38107451">parent</a><span>|</span><a href="#38107173">next</a><span>|</span><label class="collapse" for="c-38107594">[-]</label><label class="expand" for="c-38107594">[1 more]</label></div><br/><div class="children"><div class="content">I like that idea for a lot of applications (I also like the python &quot;multiprocessing&quot; library, other languages could learn a thing or two from it, and it really takes the sting out of the GIL). But I don&#x27;t see it working well for something like numpy or PyTorch which are sharing arbitrary memory between Python and native and calling back and forth at a very high frequency.<p>PyTorch and the neural net implementations built on it are the whole reason I&#x27;m using Python at all. If the answer was &quot;build the native extensions you need for PyTorch&#x2F;etc into the Python binary&quot; that would be fine too, I have no love for dynamic library loading. But I don&#x27;t see the PyTorch team going out of their way to change anything about their build process or runtime to work with Cosmopolitan, as much as I wish they would, so my guess is I won&#x27;t be able to use Cosmopolitan Python for the foreseeable future.</div><br/></div></div></div></div></div></div></div></div><div id="38107173" class="c"><input type="checkbox" id="c-38107173" checked=""/><div class="controls bullet"><span class="by">paulclinger</span><span>|</span><a href="#38107064">parent</a><span>|</span><a href="#38107185">prev</a><span>|</span><a href="#38108140">next</a><span>|</span><label class="collapse" for="c-38107173">[-]</label><label class="expand" for="c-38107173">[1 more]</label></div><br/><div class="children"><div class="content">There is no support for dynamic libraries in Cosmopolitan right now, so the libraries would either need to be compiled in (statically) or included in the archive as Python-only libraries. With the later ones, it should be a matter of adding them to the zip archive within the cosmo python executable, which should make them available to your scripts. See the discussion elsewhere in this thread (<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38102629">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38102629</a>) for some additional details.</div><br/></div></div><div id="38108140" class="c"><input type="checkbox" id="c-38108140" checked=""/><div class="controls bullet"><span class="by">ahgamut</span><span>|</span><a href="#38107064">parent</a><span>|</span><a href="#38107173">prev</a><span>|</span><a href="#38104887">next</a><span>|</span><label class="collapse" for="c-38108140">[-]</label><label class="expand" for="c-38108140">[2 more]</label></div><br/><div class="children"><div class="content">What packages do you use in your app? If you&#x27;re not using too many C extensions, it may be possible to build your app with Cosmopolitan.</div><br/><div id="38108180" class="c"><input type="checkbox" id="c-38108180" checked=""/><div class="controls bullet"><span class="by">modeless</span><span>|</span><a href="#38107064">root</a><span>|</span><a href="#38108140">parent</a><span>|</span><a href="#38104887">next</a><span>|</span><label class="collapse" for="c-38108180">[-]</label><label class="expand" for="c-38108180">[1 more]</label></div><br/><div class="children"><div class="content">Lots of C extensions. Has anyone gotten PyTorch working with Cosmopolitan? With CUDA?</div><br/></div></div></div></div></div></div><div id="38104887" class="c"><input type="checkbox" id="c-38104887" checked=""/><div class="controls bullet"><span class="by">NotSammyHagar</span><span>|</span><a href="#38107064">prev</a><span>|</span><a href="#38110248">next</a><span>|</span><label class="collapse" for="c-38104887">[-]</label><label class="expand" for="c-38104887">[1 more]</label></div><br/><div class="children"><div class="content">It says arm64 linux support, I will have to try this on a raspberry pi. It’s kind of amazing and magical that this person pulled it off. We need a MacArther genius award for software. And this should be the first award.</div><br/></div></div><div id="38110248" class="c"><input type="checkbox" id="c-38110248" checked=""/><div class="controls bullet"><span class="by">BaculumMeumEst</span><span>|</span><a href="#38104887">prev</a><span>|</span><a href="#38107227">next</a><span>|</span><label class="collapse" for="c-38110248">[-]</label><label class="expand" for="c-38110248">[1 more]</label></div><br/><div class="children"><div class="content">one of the problems i&#x27;ve always had with emacs on windows is that random commands want to shell out to non-standard programs, so they fail unless you dig around and tweak your system. I hit this immediately in the APE version by trying to download use-package.<p><pre><code>  Packages to install: 1 (use-package-2.4.5).  Proceed? (y or 
  n) y
  Operation [ Install 1 ] started
  Contacting host: melpa.org:443
  Opening TLS connection to ‘melpa.org’...
  Opening TLS connection with ‘gnutls-cli --x509cafile nil -p 
  443 melpa.org’...failed
  Opening TLS connection with ‘gnutls-cli --x509cafile nil -p 
  443 melpa.org --protocols ssl3’...failed
  Opening TLS connection to ‘melpa.org’...failed</code></pre></div><br/></div></div><div id="38107227" class="c"><input type="checkbox" id="c-38107227" checked=""/><div class="controls bullet"><span class="by">hughes</span><span>|</span><a href="#38110248">prev</a><span>|</span><a href="#38107401">next</a><span>|</span><label class="collapse" for="c-38107227">[-]</label><label class="expand" for="c-38107227">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s almost as impressive as the project itself is the author&#x27;s responsiveness here. Specifically, they have already built a solution for almost everyone&#x27;s &quot;but what about my niche use case&quot; reply.<p>Seems to be a really well thought-out project.</div><br/></div></div><div id="38107401" class="c"><input type="checkbox" id="c-38107401" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#38107227">prev</a><span>|</span><a href="#38105994">next</a><span>|</span><label class="collapse" for="c-38107401">[-]</label><label class="expand" for="c-38107401">[5 more]</label></div><br/><div class="children"><div class="content">How about dynamic linking?  Yeah, ok, that&#x27;s hard.  You might have to write an RTLD to link into the executable to find and load cosmo DLLs.  Maybe not that hard...  You could borrow BSD ld.so.1 code, I suppose.<p>Ah, that brings me to something else that someone like jart might want to take on:<p># bringing static linking for C into the 21st century<p>What&#x27;s wrong with static linking in C?  Well, it&#x27;s still stuck with 1970s semantics, while dynamic linking has much nicer semantics.  Specifically:<p><pre><code>  - static linking flattens the dependency
    tree, which causes

  - symbol collision issues

  - also, there&#x27;s no RPATH equiv. for static
    linking
</code></pre>
My thinking is to:<p><pre><code>  - write dependency metadata (-lfoo, rpath,
    -L&#x2F;...) into a &quot;hidden&quot; .o that has just
    this metadata encoded in it

  - make the static linker look for that
    metadata in dependencies and resolve
    conflicts the same way as in dynamic
    linking

  - for each link-edit, including the final
    link-edit of the executable, require
    only that direct -lfoo dependencies be
    listed
</code></pre>
Well, anyways, it&#x27;s a lot to ask :(</div><br/><div id="38108712" class="c"><input type="checkbox" id="c-38108712" checked=""/><div class="controls bullet"><span class="by">athrun</span><span>|</span><a href="#38107401">parent</a><span>|</span><a href="#38107751">prev</a><span>|</span><a href="#38110143">next</a><span>|</span><label class="collapse" for="c-38108712">[-]</label><label class="expand" for="c-38108712">[2 more]</label></div><br/><div class="children"><div class="content">Not disagreeing with your overall point, but symbol collision is still very much an issue with dynamic linking on Linux right?<p>AFAIK, the gnu dynamic linker doesn&#x27;t do any namespacing (as opposed to Solaris&#x27;).</div><br/><div id="38109028" class="c"><input type="checkbox" id="c-38109028" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#38107401">root</a><span>|</span><a href="#38108712">parent</a><span>|</span><a href="#38110143">next</a><span>|</span><label class="collapse" for="c-38109028">[-]</label><label class="expand" for="c-38109028">[1 more]</label></div><br/><div class="children"><div class="content">Linux has versioned symbols, and Solaris&#x2F;Illumos has direct binding.  The two schemes achieve roughly the same result: that the bindings made at link-edit time are the bindings you get a run-time.<p>In the versioned symbols case this is done via decorating symbols in the dependent with the SONAME and version of the dependency that is expected to provide them.  In direct binding this is done by decorating symbols in the dependent with just the SONAME of the dependency that is expected to provide them.<p>The versioned symbol technique allows a shared object to provide multiple versions of a symbol with the same name, which can be useful for some things, but direct binding is just much easier to use than versioned symbols: just add `-B direct` to the link-edits and you&#x27;re done.<p>Even in the absence of symbol versioning and direct binding, the fact that each object records its dependencies means that symbol conflicts will be only among those dependencies, and this can be discovered at link-edit time.<p>LD_PRELOAD interposers, on the other hand, can cause symbol conflicts in spite of all the foregoing.  For this you can use `-B protected` or similar, but you may not want to.</div><br/></div></div></div></div><div id="38110143" class="c"><input type="checkbox" id="c-38110143" checked=""/><div class="controls bullet"><span class="by">forrestthewoods</span><span>|</span><a href="#38107401">parent</a><span>|</span><a href="#38108712">prev</a><span>|</span><a href="#38105994">next</a><span>|</span><label class="collapse" for="c-38110143">[-]</label><label class="expand" for="c-38110143">[1 more]</label></div><br/><div class="children"><div class="content">Linux and Windows have very different dynamic linking strategies. (I think Windows does it better…)</div><br/></div></div></div></div><div id="38105994" class="c"><input type="checkbox" id="c-38105994" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#38107401">prev</a><span>|</span><a href="#38106339">next</a><span>|</span><label class="collapse" for="c-38105994">[-]</label><label class="expand" for="c-38105994">[1 more]</label></div><br/><div class="children"><div class="content">Congratulations on your release and sponsorships!<p>&gt; In the Cosmos, every program is statically linked and contains a PKZIP central directory where its &#x2F;usr&#x2F;share dependencies are embedded.<p>Sounds really neat, even the data and configuration files are linked into the executable. Can&#x27;t wait to see what else you&#x27;ll come up with.</div><br/></div></div><div id="38106339" class="c"><input type="checkbox" id="c-38106339" checked=""/><div class="controls bullet"><span class="by">Fraterkes</span><span>|</span><a href="#38105994">prev</a><span>|</span><a href="#38102254">next</a><span>|</span><label class="collapse" for="c-38106339">[-]</label><label class="expand" for="c-38106339">[4 more]</label></div><br/><div class="children"><div class="content">Very cool! What would the &quot;gui-version&quot; of this look like? Would you write it once with linux bindings and the executable would succesfully create a window in every operating system?</div><br/><div id="38106480" class="c"><input type="checkbox" id="c-38106480" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38106339">parent</a><span>|</span><a href="#38102254">next</a><span>|</span><label class="collapse" for="c-38106480">[-]</label><label class="expand" for="c-38106480">[3 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;d be pretty sweet to have a basically an APE approach to having a blank GPU framebuffer canvas, and let high level libraries do the rest. Other folks on my team have been floating the idea of getting X to build as an APE binary. Who knows what the future holds? We don&#x27;t have any resources devoted however to the problem at the moment.</div><br/><div id="38110288" class="c"><input type="checkbox" id="c-38110288" checked=""/><div class="controls bullet"><span class="by">jamesgeck0</span><span>|</span><a href="#38106339">root</a><span>|</span><a href="#38106480">parent</a><span>|</span><a href="#38106934">next</a><span>|</span><label class="collapse" for="c-38110288">[-]</label><label class="expand" for="c-38110288">[1 more]</label></div><br/><div class="children"><div class="content">Oh man, something like that would be wonderful for indie games. Targeting multiple platforms is a lot of work for a hobbyist game developer, especially if you&#x27;re not using a full-on engine like Unity or Godot.</div><br/></div></div><div id="38106934" class="c"><input type="checkbox" id="c-38106934" checked=""/><div class="controls bullet"><span class="by">nightowl_games</span><span>|</span><a href="#38106339">root</a><span>|</span><a href="#38106480">parent</a><span>|</span><a href="#38110288">prev</a><span>|</span><a href="#38102254">next</a><span>|</span><label class="collapse" for="c-38106934">[-]</label><label class="expand" for="c-38106934">[1 more]</label></div><br/><div class="children"><div class="content">Maybe could APE the web GPU implementations: Google&#x27;s &quot;dawn&quot; or Mozilla&#x27;s &quot;wpgu&quot;.</div><br/></div></div></div></div></div></div><div id="38102254" class="c"><input type="checkbox" id="c-38102254" checked=""/><div class="controls bullet"><span class="by">smusamashah</span><span>|</span><a href="#38106339">prev</a><span>|</span><a href="#38106244">next</a><span>|</span><label class="collapse" for="c-38102254">[-]</label><label class="expand" for="c-38102254">[7 more]</label></div><br/><div class="children"><div class="content">Will it allow native like bash script support on Windows? I use windows as my main OS and use cmder for CLI things but really miss proper bash script support.<p>Other than bash itself, does it mean it can be used to make whole set of GNU tools cross platform?</div><br/><div id="38102394" class="c"><input type="checkbox" id="c-38102394" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38102254">parent</a><span>|</span><a href="#38102497">next</a><span>|</span><label class="collapse" for="c-38102394">[-]</label><label class="expand" for="c-38102394">[5 more]</label></div><br/><div class="children"><div class="content">Absolutely. cosmos-3.0.1.zip contains bash, GNU coreutils, Emacs, and a whole lot more. All of which run great on the Windows console. On our github release page, there&#x27;s also a cosmocc zip of a GNU&#x2F;Linux style GCC compiler. Cosmo provides a refreshing way to build Windows software, because we use the System V ABI (i.e. long is actually 64-bit) when we build Windows software. So there&#x27;s a much more consistent cross platform development experience.</div><br/><div id="38102837" class="c"><input type="checkbox" id="c-38102837" checked=""/><div class="controls bullet"><span class="by">smusamashah</span><span>|</span><a href="#38102254">root</a><span>|</span><a href="#38102394">parent</a><span>|</span><a href="#38102497">next</a><span>|</span><label class="collapse" for="c-38102837">[-]</label><label class="expand" for="c-38102837">[4 more]</label></div><br/><div class="children"><div class="content">Tried running bash by renaming it to bash.exe using both CMD and Powershell and both return &quot;Access denied.<p>Even though Windows 10 already has Terminal and I was getting<p><pre><code>     [error 2147942405 (0x80070005) when launching `C:\bin\bash -l&#x27;]
</code></pre>
I downloaded Terminal Preview which still throws the same error. Is Terminal or Terminal Preview the only way to run bash? There might be a way to configure cmder to use bash in a similar way you suggested for Terminal. Don&#x27;t know how yet.</div><br/><div id="38103197" class="c"><input type="checkbox" id="c-38103197" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38102254">root</a><span>|</span><a href="#38102837">parent</a><span>|</span><a href="#38103344">next</a><span>|</span><label class="collapse" for="c-38103197">[-]</label><label class="expand" for="c-38103197">[1 more]</label></div><br/><div class="children"><div class="content">Try whitelisting the folder with Windows Defender. Sometimes when I get EACCES style errors on Windows mysteriously, it&#x27;s because I need to recalibrate the security on the folder. Here&#x27;s an example of something I ran once which fixed it.<p><pre><code>    PS C:\WINDOWS\system32&gt; $ACL = Get-ACL -Path C:\Users\jtunn
    PS C:\WINDOWS\system32&gt; $ACL | Set-ACL -Path C:\bin
</code></pre>
I also just uploaded cosmos-3.0.1.zip to Microsoft Security Intelligence to make sure they get whitelisted with their cloud security.</div><br/></div></div><div id="38103344" class="c"><input type="checkbox" id="c-38103344" checked=""/><div class="controls bullet"><span class="by">AMICABoard</span><span>|</span><a href="#38102254">root</a><span>|</span><a href="#38102837">parent</a><span>|</span><a href="#38103197">prev</a><span>|</span><a href="#38109076">next</a><span>|</span><label class="collapse" for="c-38103344">[-]</label><label class="expand" for="c-38103344">[1 more]</label></div><br/><div class="children"><div class="content">Discuss here: <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;discussions">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;discussions</a>
Add issues here: <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;issues">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;issues</a></div><br/></div></div><div id="38109076" class="c"><input type="checkbox" id="c-38109076" checked=""/><div class="controls bullet"><span class="by">marwis</span><span>|</span><a href="#38102254">root</a><span>|</span><a href="#38102837">parent</a><span>|</span><a href="#38103344">prev</a><span>|</span><a href="#38102497">next</a><span>|</span><label class="collapse" for="c-38109076">[-]</label><label class="expand" for="c-38109076">[1 more]</label></div><br/><div class="children"><div class="content">I linked bash to bash.exe and was able to start it however everything from &#x2F;bin was failing with:<p><pre><code>  The application was unable to start correctly (0xc0000142).
</code></pre>
Turns out it doesn&#x27;t work when I start bash by double click bash.exe but it works if I start it from cmd.exe.</div><br/></div></div></div></div></div></div><div id="38102497" class="c"><input type="checkbox" id="c-38102497" checked=""/><div class="controls bullet"><span class="by">paulclinger</span><span>|</span><a href="#38102254">parent</a><span>|</span><a href="#38102394">prev</a><span>|</span><a href="#38106244">next</a><span>|</span><label class="collapse" for="c-38102497">[-]</label><label class="expand" for="c-38102497">[1 more]</label></div><br/><div class="children"><div class="content">Yes and yes.</div><br/></div></div></div></div><div id="38106244" class="c"><input type="checkbox" id="c-38106244" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#38102254">prev</a><span>|</span><a href="#38103777">next</a><span>|</span><label class="collapse" for="c-38106244">[-]</label><label class="expand" for="c-38106244">[5 more]</label></div><br/><div class="children"><div class="content">As awesome as these are, they&#x27;re not really portable <i>executables</i> if you can&#x27;t set their setuid bits and expect them to run as root like with normal executables, right?</div><br/><div id="38106290" class="c"><input type="checkbox" id="c-38106290" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38106244">parent</a><span>|</span><a href="#38103777">next</a><span>|</span><label class="collapse" for="c-38106290">[-]</label><label class="expand" for="c-38106290">[4 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a program that&#x27;s part of cosmos called `assimilate` which can turn any APE binary into a platform-specific binary.<p><pre><code>    jart@nightmare:~$ &#x2F;opt&#x2F;cosmos&#x2F;bin&#x2F;assimilate --help
    assimilate: illegal option -- -
    actually portable executable assimilate v1.6
    copyright 2023 justine alexandra roberts tunney
    usage: assimilate [-xapembfchv] [-o PATH] FILE...
    -h          show help
    -v          show version
    -f          ignore soft errors
    -b          don&#x27;t remove freebsd from elf os&#x2F;abi
    -c          clobber input path w&#x2F;o making backup
    -e          convert to elf regardless of host os
    -m          convert to macho regardless of host os
    -x          convert to amd64 regardless of host cpu
    -a          convert to arm64 regardless of host cpu
    -p          convert to ppc64 regardless of host cpu
    -o PATH     write modified binary to different file
</code></pre>
If you aren&#x27;t using binfmt_misc then you can also pass the `--assimilate` flag to your APE binary, to turn it into a native executable, without having to use the tool. It&#x27;s baked into the shell script. Just use the `less` command on any APE file and read the shell script.<p>Once assimilated, you&#x27;re free to turn it into a setuid binary.<p>We also have patches in flight for the Linux Kernel as well as BSDs, to make APE native. <a href="https:&#x2F;&#x2F;justine.lol&#x2F;ape.patch" rel="nofollow noreferrer">https:&#x2F;&#x2F;justine.lol&#x2F;ape.patch</a></div><br/><div id="38106398" class="c"><input type="checkbox" id="c-38106398" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#38106244">root</a><span>|</span><a href="#38106290">parent</a><span>|</span><a href="#38108597">next</a><span>|</span><label class="collapse" for="c-38106398">[-]</label><label class="expand" for="c-38106398">[1 more]</label></div><br/><div class="children"><div class="content">Oh wow, that&#x27;s very nice! Thanks for sharing!</div><br/></div></div><div id="38108597" class="c"><input type="checkbox" id="c-38108597" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#38106244">root</a><span>|</span><a href="#38106290">parent</a><span>|</span><a href="#38106398">prev</a><span>|</span><a href="#38103777">next</a><span>|</span><label class="collapse" for="c-38108597">[-]</label><label class="expand" for="c-38108597">[2 more]</label></div><br/><div class="children"><div class="content">Wow, that’s some combination of awesome and horrifying.<p>Is there an actual written spec somewhere describing how this works?  What happens if the APE embeds an ELF header and something else?  Or multiple ELF headers?</div><br/><div id="38108648" class="c"><input type="checkbox" id="c-38108648" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38106244">root</a><span>|</span><a href="#38108597">parent</a><span>|</span><a href="#38103777">next</a><span>|</span><label class="collapse" for="c-38108648">[-]</label><label class="expand" for="c-38108648">[1 more]</label></div><br/><div class="children"><div class="content">See the comments in <a href="https:&#x2F;&#x2F;justine.lol&#x2F;ape.patch" rel="nofollow noreferrer">https:&#x2F;&#x2F;justine.lol&#x2F;ape.patch</a> and at the bottom of <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;3.0&#x2F;tool&#x2F;build&#x2F;apelink.c">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;3.0&#x2F;tool&#x2F;build&#x2F;ape...</a> and also <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;3.0&#x2F;ape&#x2F;loader.c">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;3.0&#x2F;ape&#x2F;loader.c</a> has good information too. I&#x27;m planning to roll it all into a formal looking specification pdf sometime very soon. Feedback is welcome. As for your question, ELF headers are defined in the APE shell script as printf &#x27;octal&#x27; statements. The loader parses those out in order and looks to see if the e_machine matches the host architecture, and if so, uses that one.</div><br/></div></div></div></div></div></div></div></div><div id="38103777" class="c"><input type="checkbox" id="c-38103777" checked=""/><div class="controls bullet"><span class="by">gaucheries</span><span>|</span><a href="#38106244">prev</a><span>|</span><a href="#38105448">next</a><span>|</span><label class="collapse" for="c-38103777">[-]</label><label class="expand" for="c-38103777">[4 more]</label></div><br/><div class="children"><div class="content">The author might be interested to know that this page might be displaying in an undesired way on iPhone mini screens:<p><a href="https:&#x2F;&#x2F;i.ibb.co&#x2F;v4s0Xpj&#x2F;IMG-1221.png" rel="nofollow noreferrer">https:&#x2F;&#x2F;i.ibb.co&#x2F;v4s0Xpj&#x2F;IMG-1221.png</a></div><br/><div id="38103862" class="c"><input type="checkbox" id="c-38103862" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38103777">parent</a><span>|</span><a href="#38105448">next</a><span>|</span><label class="collapse" for="c-38103862">[-]</label><label class="expand" for="c-38103862">[3 more]</label></div><br/><div class="children"><div class="content">Eek. If anyone has a quick CSS fix for mobile I&#x27;ll happily add it. I&#x27;m talking to some of my people too. Thanks for bringing it to my attention.</div><br/><div id="38104263" class="c"><input type="checkbox" id="c-38104263" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#38103777">root</a><span>|</span><a href="#38103862">parent</a><span>|</span><a href="#38106076">next</a><span>|</span><label class="collapse" for="c-38104263">[-]</label><label class="expand" for="c-38104263">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m amused by the fact that even authors of the most technically brilliant projects in recent memory also struggle with CSS, just like us mere mortals. :)<p>Love your work! &lt;3</div><br/></div></div><div id="38106076" class="c"><input type="checkbox" id="c-38106076" checked=""/><div class="controls bullet"><span class="by">_jackdk_</span><span>|</span><a href="#38103777">root</a><span>|</span><a href="#38103862">parent</a><span>|</span><a href="#38104263">prev</a><span>|</span><a href="#38105448">next</a><span>|</span><label class="collapse" for="c-38106076">[-]</label><label class="expand" for="c-38106076">[1 more]</label></div><br/><div class="children"><div class="content">This is the only concession to mobile that I have on my website, and it seems to do okay:<p><pre><code>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</code></pre></div><br/></div></div></div></div></div></div><div id="38105448" class="c"><input type="checkbox" id="c-38105448" checked=""/><div class="controls bullet"><span class="by">gary_0</span><span>|</span><a href="#38103777">prev</a><span>|</span><a href="#38105912">next</a><span>|</span><label class="collapse" for="c-38105448">[-]</label><label class="expand" for="c-38105448">[1 more]</label></div><br/><div class="children"><div class="content">Christmas came early! Thanks, jart-Claus, it&#x27;s just what I wanted!</div><br/></div></div><div id="38105912" class="c"><input type="checkbox" id="c-38105912" checked=""/><div class="controls bullet"><span class="by">NKosmatos</span><span>|</span><a href="#38105448">prev</a><span>|</span><a href="#38107406">next</a><span>|</span><label class="collapse" for="c-38105912">[-]</label><label class="expand" for="c-38105912">[1 more]</label></div><br/><div class="children"><div class="content">What kind of sorcery is this???<p>Just kidding, I’ve played around with some of the stuff @jart and other contributors have created and it’s mind blowing. Well done and keep up the good work.</div><br/></div></div><div id="38107406" class="c"><input type="checkbox" id="c-38107406" checked=""/><div class="controls bullet"><span class="by">ativzzz</span><span>|</span><a href="#38105912">prev</a><span>|</span><a href="#38104472">next</a><span>|</span><label class="collapse" for="c-38107406">[-]</label><label class="expand" for="c-38107406">[9 more]</label></div><br/><div class="children"><div class="content">Maybe my imagination isn&#x27;t good enough or maybe I&#x27;ve spent too much time on web apps, but as a developer, why would I use this over just making a web app if my goal is cross compatibility?<p>Users don&#x27;t install software anymore, outside of mobile. Most things are now doable through the browser. The browser isn&#x27;t perfect, but from a user perspective, it&#x27;s a much better app delivery service than anything that&#x27;s existed before<p>The only things I find myself installing recently are text editors, programming  languages&#x2F;command line tools, and games. What else? WSL is pretty good so I can even run a lot of Linux things from within Windows now<p>If I need something that needs raw power that&#x27;s too much for a browser, like a database server or running an LLM model, I&#x27;m just gonna use Linux - why do I need cross compatibility?</div><br/><div id="38107847" class="c"><input type="checkbox" id="c-38107847" checked=""/><div class="controls bullet"><span class="by">mikewarot</span><span>|</span><a href="#38107406">parent</a><span>|</span><a href="#38107447">next</a><span>|</span><label class="collapse" for="c-38107847">[-]</label><label class="expand" for="c-38107847">[1 more]</label></div><br/><div class="children"><div class="content">Programs are tools, not services.<p>Web apps require servers, servers that need to be patched, updated, certificates, DDOS protection, and a number of other things. The apps themselves need management, and maintenance. So a &quot;web app&quot; is a service, no matter how you slice it.<p>An installed program can work for decades. My personal Wiki (WikidPad) that I run every day, is from an installer compiled in 2015. It just works.  I tried to run it under Linux, where it was installed from source, and it won&#x27;t work. The folks at WxWindows made a major breaking change, so none of the GUI forms&#x2F;dialogs work, it just <i>seems</i> to work, until you need to change a setting, then it dies.<p>In theory, you could now create an installer that would work for the next 20 years without issue across operating systems.</div><br/></div></div><div id="38107447" class="c"><input type="checkbox" id="c-38107447" checked=""/><div class="controls bullet"><span class="by">porcoda</span><span>|</span><a href="#38107406">parent</a><span>|</span><a href="#38107847">prev</a><span>|</span><a href="#38107932">next</a><span>|</span><label class="collapse" for="c-38107447">[-]</label><label class="expand" for="c-38107447">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Users don&#x27;t install software anymore, outside of mobile.<p>That’s a pretty strong statement without any evidence to back it up.  It sounds like the kind of statement I hear often from people who spend all of their time in the web-dev echo chambers.  Lots of us install software and don’t spend much time in browsers beyond browsing the web and the handful of Electron apps that we have no choice but to use.</div><br/><div id="38107541" class="c"><input type="checkbox" id="c-38107541" checked=""/><div class="controls bullet"><span class="by">zztop44</span><span>|</span><a href="#38107406">root</a><span>|</span><a href="#38107447">parent</a><span>|</span><a href="#38108183">next</a><span>|</span><label class="collapse" for="c-38107541">[-]</label><label class="expand" for="c-38107541">[1 more]</label></div><br/><div class="children"><div class="content">Much software remains outside the browser, yes. Especially games and professional tools.<p>But it’s not hyperbole to say the browser has become the dominant software delivery platform outside of mobile. Email, CRMs, CMSs, electronic dictionaries, word processors, online chat, filing tax returns are just a few examples of things that used to require installing native apps and now are largely browser-based.</div><br/></div></div><div id="38108183" class="c"><input type="checkbox" id="c-38108183" checked=""/><div class="controls bullet"><span class="by">legends2k</span><span>|</span><a href="#38107406">root</a><span>|</span><a href="#38107447">parent</a><span>|</span><a href="#38107541">prev</a><span>|</span><a href="#38107932">next</a><span>|</span><label class="collapse" for="c-38108183">[-]</label><label class="expand" for="c-38108183">[1 more]</label></div><br/><div class="children"><div class="content">Thank you.  My thoughts exactly.</div><br/></div></div></div></div><div id="38107932" class="c"><input type="checkbox" id="c-38107932" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38107406">parent</a><span>|</span><a href="#38107447">prev</a><span>|</span><a href="#38107431">next</a><span>|</span><label class="collapse" for="c-38107932">[-]</label><label class="expand" for="c-38107932">[1 more]</label></div><br/><div class="children"><div class="content">1. Cosmopolitan is great for building terminal apps like HTTP servers, but can&#x27;t do GUIs.<p>2. Browsers are great at GUI apps, but depend on HTTP servers and emulate terminals poorly.<p>So I view the two as being complementary. I imagine it&#x27;s one of the reasons why Mozilla supported the project. Both platforms solve the portability problem, except for fundamentally different areas. Put them together and you get something greater than the sum of your parts.</div><br/></div></div><div id="38107431" class="c"><input type="checkbox" id="c-38107431" checked=""/><div class="controls bullet"><span class="by">retrocryptid</span><span>|</span><a href="#38107406">parent</a><span>|</span><a href="#38107932">prev</a><span>|</span><a href="#38107439">next</a><span>|</span><label class="collapse" for="c-38107431">[-]</label><label class="expand" for="c-38107431">[1 more]</label></div><br/><div class="children"><div class="content">Because the world is not entirely a web browser.</div><br/></div></div><div id="38107439" class="c"><input type="checkbox" id="c-38107439" checked=""/><div class="controls bullet"><span class="by">arthurcolle</span><span>|</span><a href="#38107406">parent</a><span>|</span><a href="#38107431">prev</a><span>|</span><a href="#38104472">next</a><span>|</span><label class="collapse" for="c-38107439">[-]</label><label class="expand" for="c-38107439">[2 more]</label></div><br/><div class="children"><div class="content">could be useful for malware developers to be fair, no?</div><br/><div id="38108730" class="c"><input type="checkbox" id="c-38108730" checked=""/><div class="controls bullet"><span class="by">jerbear4328</span><span>|</span><a href="#38107406">root</a><span>|</span><a href="#38107439">parent</a><span>|</span><a href="#38104472">next</a><span>|</span><label class="collapse" for="c-38108730">[-]</label><label class="expand" for="c-38108730">[1 more]</label></div><br/><div class="children"><div class="content">well, couldn&#x27;t all advancements in this kind of technology be useful to malicious people?</div><br/></div></div></div></div></div></div><div id="38104472" class="c"><input type="checkbox" id="c-38104472" checked=""/><div class="controls bullet"><span class="by">mamcx</span><span>|</span><a href="#38107406">prev</a><span>|</span><a href="#38105879">next</a><span>|</span><label class="collapse" for="c-38104472">[-]</label><label class="expand" for="c-38104472">[6 more]</label></div><br/><div class="children"><div class="content">This could work with Rust? I have a great use case for it and could slash half of my CI if is true!</div><br/><div id="38105204" class="c"><input type="checkbox" id="c-38105204" checked=""/><div class="controls bullet"><span class="by">ahgamut</span><span>|</span><a href="#38104472">parent</a><span>|</span><a href="#38104702">next</a><span>|</span><label class="collapse" for="c-38105204">[-]</label><label class="expand" for="c-38105204">[4 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;ahgamut&#x2F;rust-ape-example">https:&#x2F;&#x2F;github.com&#x2F;ahgamut&#x2F;rust-ape-example</a><p>My above repo contains example with the Rust standard library that build as fat executables with Cosmopolitan Libc.<p>I also got ripgrep to build <a href="https:&#x2F;&#x2F;github.com&#x2F;ahgamut&#x2F;ripgrep&#x2F;tree&#x2F;cosmopolitan">https:&#x2F;&#x2F;github.com&#x2F;ahgamut&#x2F;ripgrep&#x2F;tree&#x2F;cosmopolitan</a>, but it wasn&#x27;t part of the cosmocc binaries because some crates that are part of the build require `#!feature(rustc_private)]` to be added to their source code. Same goes for bat and fd.<p>To summarize, Rust CLI tools can be built with Cosmopolitan Libc, but to build them like we can build gcc&#x2F;emacs&#x2F;git right now, we will need some support and Rust expertise.</div><br/><div id="38105785" class="c"><input type="checkbox" id="c-38105785" checked=""/><div class="controls bullet"><span class="by">Georgelemental</span><span>|</span><a href="#38104472">root</a><span>|</span><a href="#38105204">parent</a><span>|</span><a href="#38104702">next</a><span>|</span><label class="collapse" for="c-38105785">[-]</label><label class="expand" for="c-38105785">[3 more]</label></div><br/><div class="children"><div class="content">Last time I looked into Rust-on-Cosmopolitan, I couldn&#x27;t make it work as Cosmopolitan determined syscall numbers, signal numbers, and such at runtime, but Rust standard library assumes compile-time constants (basically the same issue that C switch-case has). How did you get around that? Have you tested these binaries on non-Linux platforms?</div><br/><div id="38106564" class="c"><input type="checkbox" id="c-38106564" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38104472">root</a><span>|</span><a href="#38105785">parent</a><span>|</span><a href="#38104702">next</a><span>|</span><label class="collapse" for="c-38106564">[-]</label><label class="expand" for="c-38106564">[2 more]</label></div><br/><div class="children"><div class="content">We have about ~700 test executables and two programs called runit&#x2F;runitd which remote execute them across our entire test fleet each time we run `make test`. Currently, the fleet consists of `freebsd rhel7 xnu win10 openbsd netbsd pi silicon`. We used to have rhel5 and win7 in there too, but I&#x27;ve been slacking off the past few months. You can watch a video of how running all the test executables on all the systems only takes about fifteen seconds. <a href="https:&#x2F;&#x2F;justine.lol&#x2F;sizetricks&#x2F;#why" rel="nofollow noreferrer">https:&#x2F;&#x2F;justine.lol&#x2F;sizetricks&#x2F;#why</a></div><br/><div id="38106673" class="c"><input type="checkbox" id="c-38106673" checked=""/><div class="controls bullet"><span class="by">Georgelemental</span><span>|</span><a href="#38104472">root</a><span>|</span><a href="#38106564">parent</a><span>|</span><a href="#38104702">next</a><span>|</span><label class="collapse" for="c-38106673">[-]</label><label class="expand" for="c-38106673">[1 more]</label></div><br/><div class="children"><div class="content">To clarify, are any of those ~700 executables written in Rust?</div><br/></div></div></div></div></div></div></div></div><div id="38104702" class="c"><input type="checkbox" id="c-38104702" checked=""/><div class="controls bullet"><span class="by">vitiral</span><span>|</span><a href="#38104472">parent</a><span>|</span><a href="#38105204">prev</a><span>|</span><a href="#38105879">next</a><span>|</span><label class="collapse" for="c-38104702">[-]</label><label class="expand" for="c-38104702">[1 more]</label></div><br/><div class="children"><div class="content">The trick could definitely work with rust since fundamentally it&#x27;s &quot;just&quot; a hack on how the various scripts work on different systems. Actually getting the rust compiler to produce cosmopolitan binaries would likely be a heavy lift though.<p>Also it says it supports WASM (wasi?) so some applications might work out of the box with that.</div><br/></div></div></div></div><div id="38105879" class="c"><input type="checkbox" id="c-38105879" checked=""/><div class="controls bullet"><span class="by">davikr</span><span>|</span><a href="#38104472">prev</a><span>|</span><a href="#38102465">next</a><span>|</span><label class="collapse" for="c-38105879">[-]</label><label class="expand" for="c-38105879">[2 more]</label></div><br/><div class="children"><div class="content">Trying to run Cosmos apps from the Windows Terminal opens a pop-up saying &quot;Select an app to open &#x27;&lt;app&gt;&#x27;&quot;. How can I execute them?<p>I ended up finding a solution:<p>&gt; If you want to run them on Windows, then you simply need to rename the file so that it has the .com suffix. Better yet, consider making that a symlink (a.k.a. reparse point).</div><br/><div id="38106518" class="c"><input type="checkbox" id="c-38106518" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38105879">parent</a><span>|</span><a href="#38102465">next</a><span>|</span><label class="collapse" for="c-38106518">[-]</label><label class="expand" for="c-38106518">[1 more]</label></div><br/><div class="children"><div class="content">What I like to do is configure Windows Terminal Preview so it launches `C:\bin\bash -l` as my command prompt. Once you&#x27;re inside bash, it doesn&#x27;t care about the .com or .exe suffix being there. Only CMD.EXE really cares about the suffix. So you have to simply rename the files if you want to run it there.</div><br/></div></div></div></div><div id="38102465" class="c"><input type="checkbox" id="c-38102465" checked=""/><div class="controls bullet"><span class="by">NeutralForest</span><span>|</span><a href="#38105879">prev</a><span>|</span><a href="#38109156">next</a><span>|</span><label class="collapse" for="c-38102465">[-]</label><label class="expand" for="c-38102465">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s some pretty amazing stuff considering how difficult C&#x2F;C++ portability is.</div><br/></div></div><div id="38109156" class="c"><input type="checkbox" id="c-38109156" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38102465">prev</a><span>|</span><a href="#38105756">next</a><span>|</span><label class="collapse" for="c-38109156">[-]</label><label class="expand" for="c-38109156">[1 more]</label></div><br/><div class="children"><div class="content">Using Cloudflare DNS, I can never load jart&#x27;s homepage. Does the .lol domain get blocked? Is there anyway to see &quot;naughty&quot; domains which might be getting intercepted?</div><br/></div></div><div id="38105756" class="c"><input type="checkbox" id="c-38105756" checked=""/><div class="controls bullet"><span class="by">DrNosferatu</span><span>|</span><a href="#38109156">prev</a><span>|</span><label class="collapse" for="c-38105756">[-]</label><label class="expand" for="c-38105756">[3 more]</label></div><br/><div class="children"><div class="content">What would be the best&#x2F;lightest GUI-via-the-browser framework to employ with a program compiled as a Cosmopolitan fat binary?<p>(say, Qt WebAssembly? ...something else?)<p>Or is there a even better route to run-anywhere Cosmopolitan apps with a GUI?</div><br/><div id="38108461" class="c"><input type="checkbox" id="c-38108461" checked=""/><div class="controls bullet"><span class="by">mscdex</span><span>|</span><a href="#38105756">parent</a><span>|</span><a href="#38106466">next</a><span>|</span><label class="collapse" for="c-38108461">[-]</label><label class="expand" for="c-38108461">[1 more]</label></div><br/><div class="children"><div class="content">Generally speaking (I&#x27;ve not tested this kind of setup with the cosmopolitan libc) what I&#x27;ve done in the past with C is use something like libmicrohttpd along with some web assets linked into the executable (`xxd -i` can help you with the assets). That gives you a single (small) binary where you can use HTML&#x2F;CSS&#x2F;JS for the main GUI and logic.<p>You can then integrate additional libraries as you please, such as sqlite3 to give yourself fast, local database access over an endpoint on the embedded HTTP&#x2F;S&#x2F;2 (or websocket) server.</div><br/></div></div><div id="38106466" class="c"><input type="checkbox" id="c-38106466" checked=""/><div class="controls bullet"><span class="by">radiator</span><span>|</span><a href="#38105756">parent</a><span>|</span><a href="#38108461">prev</a><span>|</span><label class="collapse" for="c-38106466">[-]</label><label class="expand" for="c-38106466">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps, by the same authors, redbean, which &quot;embeds Lua, SQLite, and MbedTLS into a fork() driven application server&quot; ... &quot; a great fit for when you want to build an app that&#x27;s vertically integrated into a single tiny file that runs on nearly all PCs and servers&quot;. It looks like as of now, greenbean exists as well.</div><br/></div></div></div></div></div></div></div></div></div></body></html>