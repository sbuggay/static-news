<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710579650748" as="style"/><link rel="stylesheet" href="styles.css?v=1710579650748"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://en.algorithmica.org/hpc/">Algorithms for Modern Hardware</a> <span class="domain">(<a href="https://en.algorithmica.org">en.algorithmica.org</a>)</span></div><div class="subtext"><span>throwaway2037</span> | <span>29 comments</span></div><br/><div><div id="39723261" class="c"><input type="checkbox" id="c-39723261" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#39723774">next</a><span>|</span><label class="collapse" for="c-39723261">[-]</label><label class="expand" for="c-39723261">[1 more]</label></div><br/><div class="children"><div class="content">Previous postings (including 30 days ago, but this one seems to be from &#x27;tosh 8 hours ago and then manipulated by mods for a &quot;second chance&quot; post getting merged with a different posting by &#x27;throwaway2037 from 2 days ago, and I&#x27;m happy for that):<p>March 7, 2022 - 62 comments - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30583808">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30583808</a><p>Feb 17, 2022 - 49 comments - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30376140">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30376140</a><p>Feb 12, 2022 - 44 comments - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30311112">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30311112</a><p>Nov 1, 2022 - 33 comments - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33427349">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33427349</a></div><br/></div></div><div id="39723774" class="c"><input type="checkbox" id="c-39723774" checked=""/><div class="controls bullet"><span class="by">srijansriv</span><span>|</span><a href="#39723261">prev</a><span>|</span><a href="#39723734">next</a><span>|</span><label class="collapse" for="c-39723774">[-]</label><label class="expand" for="c-39723774">[1 more]</label></div><br/><div class="children"><div class="content">obligatory mention of cp-alogs: <a href="https:&#x2F;&#x2F;cp-algorithms.com&#x2F;index.html" rel="nofollow">https:&#x2F;&#x2F;cp-algorithms.com&#x2F;index.html</a></div><br/></div></div><div id="39723734" class="c"><input type="checkbox" id="c-39723734" checked=""/><div class="controls bullet"><span class="by">nayemrahman</span><span>|</span><a href="#39723774">prev</a><span>|</span><a href="#39700810">next</a><span>|</span><label class="collapse" for="c-39723734">[-]</label><label class="expand" for="c-39723734">[1 more]</label></div><br/><div class="children"><div class="content">Nice!</div><br/></div></div><div id="39700810" class="c"><input type="checkbox" id="c-39700810" checked=""/><div class="controls bullet"><span class="by">throwaway2037</span><span>|</span><a href="#39723734">prev</a><span>|</span><a href="#39723221">next</a><span>|</span><label class="collapse" for="c-39700810">[-]</label><label class="expand" for="c-39700810">[22 more]</label></div><br/><div class="children"><div class="content">This is a wild quote:<p>&lt;&lt;
    Among the cool things that we will speed up:<p><pre><code>    2x faster GCD (compared to std::gcd)
    8-15x faster binary search (compared to std::lower_bound)
    5-10x faster segment trees (compared to Fenwick trees)
    5x faster hash tables (compared to std::unordered_map)
    2x faster popcount (compared to repeatedly calling popcnt)
    35x faster parsing series of integers (compared to scanf)
    ?x faster sorting (compared to std::sort)
    2x faster sum (compared to std::accumulate)
    2-3x faster prefix sum (compared to naive implementation)
    10x faster argmin (compared to naive implementation)
    10x faster array searching (compared to std::find)
    15x faster search tree (compared to std::set)
    100x faster matrix multiplication (compared to “for-for-for”)
    optimal word-size integer factorization (~0.4ms per 60-bit integer)
    optimal Karatsuba Algorithm
    optimal FFT</code></pre>
&gt;&gt;<p>If true, why haven&#x27;t these appeared in the C++ STL?<p>EDIT: Formatting only</div><br/><div id="39723163" class="c"><input type="checkbox" id="c-39723163" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39723558">next</a><span>|</span><label class="collapse" for="c-39723163">[-]</label><label class="expand" for="c-39723163">[6 more]</label></div><br/><div class="children"><div class="content">About a decade ago I wrote a fast rope library in C, with support for arbitrary inserts &amp; deletes at arbitrary locations in large strings. I benchmarked it, and I was shocked to discover that my library was ~20x faster than the SGI C++ rope library that shipped with my compiler.<p>I assumed I must be doing something wrong. Eventually took a look and found the SGI rope library constructs a tree where each heap allocated leaf node only contains a single character from the document. No wonder its so inefficient. I&#x27;m somewhat horrified by the idea that anyone is using that implementation in their software.<p>Sometimes I think about how much money people would pay to make their computer run 20x faster. Our society spends a truckload of money on computing hardware - but most of that hardware is wasted running wildly inefficient programs. Modern computers should do basically everything instantly. Its weird to me that we&#x27;ll pay thousands of dollars for faster CPUs then write new software in python, electron or a docker container running in a VM.</div><br/><div id="39723287" class="c"><input type="checkbox" id="c-39723287" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723163">parent</a><span>|</span><a href="#39723660">next</a><span>|</span><label class="collapse" for="c-39723287">[-]</label><label class="expand" for="c-39723287">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Sometimes I think about how much money people would pay to make their computer run 20x faster.<p>I think people who can reliably do this are paid $250-750k&#x2F;year at top paying companies.</div><br/><div id="39724069" class="c"><input type="checkbox" id="c-39724069" checked=""/><div class="controls bullet"><span class="by">anonymoushn</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723287">parent</a><span>|</span><a href="#39723660">next</a><span>|</span><label class="collapse" for="c-39724069">[-]</label><label class="expand" for="c-39724069">[3 more]</label></div><br/><div class="children"><div class="content">I think there are almost 0 positions in industry for this sort of thing.</div><br/><div id="39724112" class="c"><input type="checkbox" id="c-39724112" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39724069">parent</a><span>|</span><a href="#39723660">next</a><span>|</span><label class="collapse" for="c-39724112">[-]</label><label class="expand" for="c-39724112">[2 more]</label></div><br/><div class="children"><div class="content">There are plenty, actually. Source: did this professionally for a bit</div><br/><div id="39724294" class="c"><input type="checkbox" id="c-39724294" checked=""/><div class="controls bullet"><span class="by">noelwelsh</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39724112">parent</a><span>|</span><a href="#39723660">next</a><span>|</span><label class="collapse" for="c-39724294">[-]</label><label class="expand" for="c-39724294">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m interested to hear more. What kind of companies pay for this? Hardware companies like Intel and Nvidia? What are the roles called?</div><br/></div></div></div></div></div></div></div></div><div id="39723660" class="c"><input type="checkbox" id="c-39723660" checked=""/><div class="controls bullet"><span class="by">falsandtru</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723163">parent</a><span>|</span><a href="#39723287">prev</a><span>|</span><a href="#39723558">next</a><span>|</span><label class="collapse" for="c-39723660">[-]</label><label class="expand" for="c-39723660">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Sometimes I think about how much money people would pay to make their computer run 20x faster.<p>Bottlenecks that can make a computer 20x faster are very rare. First, pay $1m for a specialist to find the bottlenecks. However, it is even rarer that it is a bottleneck of the entire service. Rather, it is more likely to be an accidental drop in performance. Thus, basically performance monitoring is the best use of money.<p>&gt; Its weird to me that we&#x27;ll pay thousands of dollars for faster CPUs then write new software in python, electron or a docker container running in a VM.<p>There are more labor costs and lost commercial opportunities due to delays in development.</div><br/></div></div></div></div><div id="39723558" class="c"><input type="checkbox" id="c-39723558" checked=""/><div class="controls bullet"><span class="by">3836293648</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39723163">prev</a><span>|</span><a href="#39724130">next</a><span>|</span><label class="collapse" for="c-39723558">[-]</label><label class="expand" for="c-39723558">[3 more]</label></div><br/><div class="children"><div class="content">Because the STL makes a bunch of guarantees that can&#x27;t be broken. Like that an object won&#x27;t ever move within a hashmap, even on edits. Or that std::set has to use buckets and linked lists.<p>Basically they&#x27;ve overspecified their datastructures and we&#x27;re now paying the price</div><br/><div id="39723976" class="c"><input type="checkbox" id="c-39723976" checked=""/><div class="controls bullet"><span class="by">deadlypointer</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723558">parent</a><span>|</span><a href="#39724047">next</a><span>|</span><label class="collapse" for="c-39723976">[-]</label><label class="expand" for="c-39723976">[1 more]</label></div><br/><div class="children"><div class="content">Std::set is using red black trees, did you mean std unordered set?</div><br/></div></div></div></div><div id="39724130" class="c"><input type="checkbox" id="c-39724130" checked=""/><div class="controls bullet"><span class="by">ribit</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39723558">prev</a><span>|</span><a href="#39723200">next</a><span>|</span><label class="collapse" for="c-39724130">[-]</label><label class="expand" for="c-39724130">[3 more]</label></div><br/><div class="children"><div class="content">One also needs to look at the context of these quotes. For example, for the binary search they change the array layout to improve cache locality. This is not really helpful if you have to work with sorted arrays (as many binary search algorithms do). If instead you have the freedom to optimize the data structure itself (and you do the search often enough to amortize the construction), you might as well build some variant of a B-tree which is going to be much faster than binary search anyway.</div><br/><div id="39724166" class="c"><input type="checkbox" id="c-39724166" checked=""/><div class="controls bullet"><span class="by">adrianN</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39724130">parent</a><span>|</span><a href="#39723200">next</a><span>|</span><label class="collapse" for="c-39724166">[-]</label><label class="expand" for="c-39724166">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;d like to see a benchmark showing a B-tree beating an array with the correct layout. I think you only want a tree if you also want to update the array.</div><br/><div id="39724293" class="c"><input type="checkbox" id="c-39724293" checked=""/><div class="controls bullet"><span class="by">ribit</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39724166">parent</a><span>|</span><a href="#39723200">next</a><span>|</span><label class="collapse" for="c-39724293">[-]</label><label class="expand" for="c-39724293">[1 more]</label></div><br/><div class="children"><div class="content">You can implement your B-tree as an array if that&#x27;s what you like. The advantage of the B-tree-like-layouts is that you need fewer indirections. With binary search you do one node jump per comparison. With a B-tree you do one jump per N comparisons.<p>Of course, the detail is in trying it out, intuition does not always capture hardware behavior. I remember looking at this many years ago and B-trees were considerably faster. The code was far from being optimal though. Maybe if one pulls all tricks in the book the additional complexity of managing multiple comparisons will outweigh saving from reducing loads.</div><br/></div></div></div></div></div></div><div id="39723200" class="c"><input type="checkbox" id="c-39723200" checked=""/><div class="controls bullet"><span class="by">hughesjj</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39724130">prev</a><span>|</span><a href="#39713968">next</a><span>|</span><label class="collapse" for="c-39723200">[-]</label><label class="expand" for="c-39723200">[5 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t stl notoriously slow relative to most c++ implementations given equivalent functionality?<p>I&#x27;ve always understood stl to prefer rock solid safety+stability+compatibility (+ a bit of dogfooding) with the widest applicable domain (scale etc) over pure, unadulterated performance, but I haven&#x27;t coded in c++ since college so I know nothing</div><br/><div id="39723362" class="c"><input type="checkbox" id="c-39723362" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723200">parent</a><span>|</span><a href="#39713968">next</a><span>|</span><label class="collapse" for="c-39723362">[-]</label><label class="expand" for="c-39723362">[4 more]</label></div><br/><div class="children"><div class="content">The standard library has a bunch of requirements that a random third party library likely does not have. Like ABI compatibility (most people recompile from source often so it isn&#x27;t needed). Like exception safety (most people turn off exceptions anyways so they don&#x27;t need such safety).<p>Some parts of the standard library like std::vector is already good enough. Other parts like std::unordered_set are rarely used in industry unless low-dependency is a requirent.</div><br/><div id="39724212" class="c"><input type="checkbox" id="c-39724212" checked=""/><div class="controls bullet"><span class="by">menaerus</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723362">parent</a><span>|</span><a href="#39723995">next</a><span>|</span><label class="collapse" for="c-39724212">[-]</label><label class="expand" for="c-39724212">[1 more]</label></div><br/><div class="children"><div class="content">ABI compatibility is needed in 99% of the cases since you basically never compile your own STL. You dynamically (or statically if you will) link against the one you have on a system since most software does not have a control over the machines&#x2F;environment where it&#x27;s going to be deployed. Even in cases where you do have a control over your environment deployment, compiling your own libc++&#x2F;libstdc++ is a complication which you usually want to avoid.</div><br/></div></div><div id="39723995" class="c"><input type="checkbox" id="c-39723995" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723362">parent</a><span>|</span><a href="#39724212">prev</a><span>|</span><a href="#39713968">next</a><span>|</span><label class="collapse" for="c-39723995">[-]</label><label class="expand" for="c-39723995">[2 more]</label></div><br/><div class="children"><div class="content">I very much doubt <i>most</i> people coding in C++ would turn off exceptions. Virtually every new runtime construct being added is designed for exceptions.<p>There are some niches where exceptions are frowned upon, but those are small.</div><br/><div id="39724119" class="c"><input type="checkbox" id="c-39724119" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723995">parent</a><span>|</span><a href="#39713968">next</a><span>|</span><label class="collapse" for="c-39724119">[-]</label><label class="expand" for="c-39724119">[1 more]</label></div><br/><div class="children"><div class="content">Unfortunately a significant portion of feedback for the C++ standard library comes from Google LLC</div><br/></div></div></div></div></div></div></div></div><div id="39713968" class="c"><input type="checkbox" id="c-39713968" checked=""/><div class="controls bullet"><span class="by">janwas</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39723200">prev</a><span>|</span><a href="#39723086">next</a><span>|</span><label class="collapse" for="c-39713968">[-]</label><label class="expand" for="c-39713968">[1 more]</label></div><br/><div class="children"><div class="content">I am inclined to believe those numbers :)<p>That&#x27;s an interesting question. One partial answer is that the hash table speedup likely involves an interface change, replacing &quot;insert single item&quot; with batching. This is a generally helpful principle, but unfortunately does not match some existing abstractions.</div><br/></div></div><div id="39723086" class="c"><input type="checkbox" id="c-39723086" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#39700810">parent</a><span>|</span><a href="#39713968">prev</a><span>|</span><a href="#39722996">next</a><span>|</span><label class="collapse" for="c-39723086">[-]</label><label class="expand" for="c-39723086">[2 more]</label></div><br/><div class="children"><div class="content">C++ STL is generic and cross-platform, but I suspect they are doing specific optimisations (x86 Asm), and it&#x27;s very easy to beat a compiler that way.</div><br/><div id="39724280" class="c"><input type="checkbox" id="c-39724280" checked=""/><div class="controls bullet"><span class="by">adrianN</span><span>|</span><a href="#39700810">root</a><span>|</span><a href="#39723086">parent</a><span>|</span><a href="#39722996">next</a><span>|</span><label class="collapse" for="c-39724280">[-]</label><label class="expand" for="c-39724280">[1 more]</label></div><br/><div class="children"><div class="content">It’s not that easy to beat compilers, they know how to generate processor specific instructions too.</div><br/></div></div></div></div></div></div><div id="39723221" class="c"><input type="checkbox" id="c-39723221" checked=""/><div class="controls bullet"><span class="by">edward28</span><span>|</span><a href="#39700810">prev</a><span>|</span><label class="collapse" for="c-39723221">[-]</label><label class="expand" for="c-39723221">[3 more]</label></div><br/><div class="children"><div class="content">Step 1. Throw more compute at it.</div><br/><div id="39723447" class="c"><input type="checkbox" id="c-39723447" checked=""/><div class="controls bullet"><span class="by">signa11</span><span>|</span><a href="#39723221">parent</a><span>|</span><a href="#39723500">prev</a><span>|</span><label class="collapse" for="c-39723447">[-]</label><label class="expand" for="c-39723447">[1 more]</label></div><br/><div class="children"><div class="content">imho, probably preceded by<p><pre><code>   step-0 sit quietly in a room with paper and pencil, and ... T.H.I.N.K</code></pre></div><br/></div></div></div></div></div></div></div></div></div></body></html>