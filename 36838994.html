<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1690189249069" as="style"/><link rel="stylesheet" href="styles.css?v=1690189249069"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/plv8/pljs">PLJS – JavaScript Language Plugin for PostreSQL</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>alonp99</span> | <span>16 comments</span></div><br/><div><div id="36841381" class="c"><input type="checkbox" id="c-36841381" checked=""/><div class="controls bullet"><span class="by">jerrysievert</span><span>|</span><a href="#36842596">next</a><span>|</span><label class="collapse" for="c-36841381">[-]</label><label class="expand" for="c-36841381">[1 more]</label></div><br/><div class="children"><div class="content">Author here. Not what I expected to see on hn during a lazy Sunday afternoon.</div><br/></div></div><div id="36842596" class="c"><input type="checkbox" id="c-36842596" checked=""/><div class="controls bullet"><span class="by">laurencerowe</span><span>|</span><a href="#36841381">prev</a><span>|</span><a href="#36839832">next</a><span>|</span><label class="collapse" for="c-36842596">[-]</label><label class="expand" for="c-36842596">[2 more]</label></div><br/><div class="children"><div class="content">I don’t know if this is just be a weird artefact of running in Docket on an Arm Mac, but I was surprised to find it substantially faster to run my tree walking code on Node and call out to Postgres than run it all in Postgres with plv8. Perhaps it was using a fresh interpreter per transaction?</div><br/><div id="36842619" class="c"><input type="checkbox" id="c-36842619" checked=""/><div class="controls bullet"><span class="by">jerrysievert</span><span>|</span><a href="#36842596">parent</a><span>|</span><a href="#36839832">next</a><span>|</span><label class="collapse" for="c-36842619">[-]</label><label class="expand" for="c-36842619">[1 more]</label></div><br/><div class="children"><div class="content">it doesn&#x27;t use a fresh interpreter per transaction, but does per connection due to postgres using a process model.<p>also, there are a ton of different variables. if you&#x27;re interested in talking about it, there&#x27;s a discord: <a href="https:&#x2F;&#x2F;discord.gg&#x2F;5fJN52Se" rel="nofollow noreferrer">https:&#x2F;&#x2F;discord.gg&#x2F;5fJN52Se</a></div><br/></div></div></div></div><div id="36839832" class="c"><input type="checkbox" id="c-36839832" checked=""/><div class="controls bullet"><span class="by">cyanydeez</span><span>|</span><a href="#36842596">prev</a><span>|</span><a href="#36841400">next</a><span>|</span><label class="collapse" for="c-36839832">[-]</label><label class="expand" for="c-36839832">[2 more]</label></div><br/><div class="children"><div class="content">I hope this supplants the v8 standard since trying to build v8 breaks every release, which makes plv8 no longer packaged with typical releases.</div><br/><div id="36841363" class="c"><input type="checkbox" id="c-36841363" checked=""/><div class="controls bullet"><span class="by">jerrysievert</span><span>|</span><a href="#36839832">parent</a><span>|</span><a href="#36841400">next</a><span>|</span><label class="collapse" for="c-36841363">[-]</label><label class="expand" for="c-36841363">[1 more]</label></div><br/><div class="children"><div class="content">3.2alpha uses v8-cmake (who were great about accepting the needed patches) to build, and is a bit more stable.<p>Though v8 has become much slower every release when crossing the membrane that pljs is much faster under many use cases, even in early alpha.</div><br/></div></div></div></div><div id="36841400" class="c"><input type="checkbox" id="c-36841400" checked=""/><div class="controls bullet"><span class="by">samanator</span><span>|</span><a href="#36839832">prev</a><span>|</span><a href="#36840434">next</a><span>|</span><label class="collapse" for="c-36841400">[-]</label><label class="expand" for="c-36841400">[2 more]</label></div><br/><div class="children"><div class="content">I just tried building plv8 today. After 2 hours, I gave up and just copied the ready made artifact from a docker image.<p>Here is more context for the QuickJS engine experiment as the runtime for a pl language.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;plv8&#x2F;plv8&#x2F;issues&#x2F;364">https:&#x2F;&#x2F;github.com&#x2F;plv8&#x2F;plv8&#x2F;issues&#x2F;364</a></div><br/><div id="36841587" class="c"><input type="checkbox" id="c-36841587" checked=""/><div class="controls bullet"><span class="by">jerrysievert</span><span>|</span><a href="#36841400">parent</a><span>|</span><a href="#36840434">next</a><span>|</span><label class="collapse" for="c-36841587">[-]</label><label class="expand" for="c-36841587">[1 more]</label></div><br/><div class="children"><div class="content">a bit more than an experiment at this point.  pljs, even in its early state, has some very good results: <a href="https:&#x2F;&#x2F;github.com&#x2F;plv8&#x2F;plv8&#x2F;issues&#x2F;531#issuecomment-1627883921">https:&#x2F;&#x2F;github.com&#x2F;plv8&#x2F;plv8&#x2F;issues&#x2F;531#issuecomment-1627883...</a><p>passing through v8&#x27;s javascript&#x2F;c++ membrane has always been painful, and appears to be getting worse.</div><br/></div></div></div></div><div id="36840434" class="c"><input type="checkbox" id="c-36840434" checked=""/><div class="controls bullet"><span class="by">jsdwarf</span><span>|</span><a href="#36841400">prev</a><span>|</span><a href="#36840063">next</a><span>|</span><label class="collapse" for="c-36840434">[-]</label><label class="expand" for="c-36840434">[5 more]</label></div><br/><div class="children"><div class="content">Use cases? Examples?</div><br/><div id="36840719" class="c"><input type="checkbox" id="c-36840719" checked=""/><div class="controls bullet"><span class="by">ttfkam</span><span>|</span><a href="#36840434">parent</a><span>|</span><a href="#36842217">next</a><span>|</span><label class="collapse" for="c-36840719">[-]</label><label class="expand" for="c-36840719">[1 more]</label></div><br/><div class="children"><div class="content">Off the top of my head:<p>The ability to do advanced regexp replacements with a function parameter in JS far outstrips anything native in Postgres.<p>Array manipulation, reordering, and deduplication are worlds easier in JS than native Postgres.<p>Manipulating byte buffers in JS are much faster and more flexible than introspecting bytea columns in native Postgres.<p>JSON parsing and object transformation are much easier, faster, and clearer than native Postgres (even with the recent jsonb improvements).</div><br/></div></div><div id="36842217" class="c"><input type="checkbox" id="c-36842217" checked=""/><div class="controls bullet"><span class="by">jerrysievert</span><span>|</span><a href="#36840434">parent</a><span>|</span><a href="#36840719">prev</a><span>|</span><a href="#36840536">next</a><span>|</span><label class="collapse" for="c-36842217">[-]</label><label class="expand" for="c-36842217">[1 more]</label></div><br/><div class="children"><div class="content">my favorite (plv8, but relevant) was working at an esri r&amp;d center, and having corporate remind us that we needed to include esri&#x27;s json format in our product offering in addition to geojson (our supported format).<p>I was away at a conference (jsconf, amusingly), and simply added the arcgis to geojson converter that was already written in javascript as part of another open source project we had released, and voila, we could suddenly support it in the database.  one of the product engineers quickly added an additional database call to the backend, and we were all set.<p>simple problems, simple solutions, especially when dealing with json conversion.</div><br/></div></div><div id="36840536" class="c"><input type="checkbox" id="c-36840536" checked=""/><div class="controls bullet"><span class="by">nattaylor</span><span>|</span><a href="#36840434">parent</a><span>|</span><a href="#36842217">prev</a><span>|</span><a href="#36840063">next</a><span>|</span><label class="collapse" for="c-36840536">[-]</label><label class="expand" for="c-36840536">[2 more]</label></div><br/><div class="children"><div class="content">(I haven&#x27;t tried pljs but I think this is relevant) I&#x27;ve used JavaScript UDFs in Snowflake for array processing and also dumb POCs things like importing an entire library for useragent parsing</div><br/><div id="36842937" class="c"><input type="checkbox" id="c-36842937" checked=""/><div class="controls bullet"><span class="by">elyobo</span><span>|</span><a href="#36840434">root</a><span>|</span><a href="#36840536">parent</a><span>|</span><a href="#36840063">next</a><span>|</span><label class="collapse" for="c-36842937">[-]</label><label class="expand" for="c-36842937">[1 more]</label></div><br/><div class="children"><div class="content">Similar, we use JS UDFs in BigQuery for JSON parsing (ELT instead of ETL) and occasionally for other tasks that are just easier in JS than pure SQL.</div><br/></div></div></div></div></div></div><div id="36840063" class="c"><input type="checkbox" id="c-36840063" checked=""/><div class="controls bullet"><span class="by">tantalor</span><span>|</span><a href="#36840434">prev</a><span>|</span><label class="collapse" for="c-36840063">[-]</label><label class="expand" for="c-36840063">[3 more]</label></div><br/><div class="children"><div class="content">Typo in headline</div><br/><div id="36840093" class="c"><input type="checkbox" id="c-36840093" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#36840063">parent</a><span>|</span><label class="collapse" for="c-36840093">[-]</label><label class="expand" for="c-36840093">[2 more]</label></div><br/><div class="children"><div class="content">PostreSQL. People from Spainish speaking countries would love it!</div><br/><div id="36843783" class="c"><input type="checkbox" id="c-36843783" checked=""/><div class="controls bullet"><span class="by">acumenical</span><span>|</span><a href="#36840063">root</a><span>|</span><a href="#36840093">parent</a><span>|</span><label class="collapse" for="c-36843783">[-]</label><label class="expand" for="c-36843783">[1 more]</label></div><br/><div class="children"><div class="content">&quot;DessertSQL&quot; in English but I thought we were past quirky names.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>