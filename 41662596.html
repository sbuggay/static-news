<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1727427659444" as="style"/><link rel="stylesheet" href="styles.css?v=1727427659444"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/">Attacking UNIX Systems via CUPS</a> <span class="domain">(<a href="https://www.evilsocket.net">www.evilsocket.net</a>)</span></div><div class="subtext"><span>NetBender</span> | <span>238 comments</span></div><br/><div><div id="41662938" class="c"><input type="checkbox" id="c-41662938" checked=""/><div class="controls bullet"><span class="by">Tiberium</span><span>|</span><a href="#41666619">next</a><span>|</span><label class="collapse" for="c-41662938">[-]</label><label class="expand" for="c-41662938">[53 more]</label></div><br/><div class="children"><div class="content">Wait, this is a joke, right?<p>&gt; A remote unauthenticated attacker can silently replace existing printers’ (or install new ones) IPP urls with a malicious one, resulting in arbitrary command execution (on the computer) *when a print job is started (from that computer).*<p>(emphasis mine)<p>There&#x27;s no way this is 9.9 when Heartbleed was just 7.5...<p>EDIT: Wanted to add why I think he has overblown this way too much. His original tweet stated &quot;* Unauthenticated RCE vs all GNU&#x2F;Linux systems (plus others)&quot; but as we can see this isn&#x27;t nearly the case as on a lot of distros CUPS only listens on loopback or isn&#x27;t installed at all.<p>Another point:<p>&gt; Full disclosure, I’ve been scanning the entire public internet IPv4 ranges several times a day for weeks, sending the UDP packet and logging whatever connected back. And I’ve got back connections from hundreds of thousands of devices, with peaks of 200-300K concurrent devices<p>If I&#x27;m understanding this correctly, he only found 300 thousand open CUPS instances in the whole public IPv4. Remember - the CUPS server needs to receive a print job in order for the RCE to happen, which I doubt most of these instances will get.</div><br/><div id="41665841" class="c"><input type="checkbox" id="c-41665841" checked=""/><div class="controls bullet"><span class="by">crote</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41663550">next</a><span>|</span><label class="collapse" for="c-41665841">[-]</label><label class="expand" for="c-41665841">[2 more]</label></div><br/><div class="children"><div class="content">Reading through this writeup I&#x27;d argue it&#x27;s indeed quite bad, but more in the sense that the entire `cups-browsed` daemon should probably stop existing, and the Linux ecosystem should have a serious discussion about the future of CUPS in general.<p>These bugs look surprisingly trivial, and upstream response to what is in the end <i>still</i> a fairly serious security issue isn&#x27;t exactly what one would expect from an installed-by-default desktop Linux package.<p>But no, it&#x27;s definitely not worth the stop-the-world CVSS 9.9 panic.</div><br/><div id="41666641" class="c"><input type="checkbox" id="c-41666641" checked=""/><div class="controls bullet"><span class="by">sam_lowry_</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665841">parent</a><span>|</span><a href="#41663550">next</a><span>|</span><label class="collapse" for="c-41666641">[-]</label><label class="expand" for="c-41666641">[1 more]</label></div><br/><div class="children"><div class="content">CUPS 3 goes the other way, relying solely on IPP for discovery and autoconfiguration.</div><br/></div></div></div></div><div id="41663550" class="c"><input type="checkbox" id="c-41663550" checked=""/><div class="controls bullet"><span class="by">seanhunter</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41665841">prev</a><span>|</span><a href="#41663127">next</a><span>|</span><label class="collapse" for="c-41663550">[-]</label><label class="expand" for="c-41663550">[1 more]</label></div><br/><div class="children"><div class="content">To give the author full credit, they say<p>&gt; Impact wise I wouldn’t classify it as a 9.9, but then again, what the hell do I know?</div><br/></div></div><div id="41663127" class="c"><input type="checkbox" id="c-41663127" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41663550">prev</a><span>|</span><a href="#41663556">next</a><span>|</span><label class="collapse" for="c-41663127">[-]</label><label class="expand" for="c-41663127">[22 more]</label></div><br/><div class="children"><div class="content">There are also buffer overflows exploitable without any user action. The foomatic vector which requires print job was just one easiest to scan and exploit.</div><br/><div id="41663217" class="c"><input type="checkbox" id="c-41663217" checked=""/><div class="controls bullet"><span class="by">Tiberium</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663127">parent</a><span>|</span><a href="#41663535">next</a><span>|</span><label class="collapse" for="c-41663217">[-]</label><label class="expand" for="c-41663217">[18 more]</label></div><br/><div class="children"><div class="content">Thanks, I missed that. But that still leaves us with only 300 thousand exploitable instances in the whole public IPv4 address space. This is nowhere near a universal GNU&#x2F;Linux RCE. Of course it&#x27;s still a big deal to those affected servers, but it&#x27;s nowhere near even RegreSSHion.</div><br/><div id="41667021" class="c"><input type="checkbox" id="c-41667021" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663217">parent</a><span>|</span><a href="#41663691">next</a><span>|</span><label class="collapse" for="c-41667021">[-]</label><label class="expand" for="c-41667021">[4 more]</label></div><br/><div class="children"><div class="content">No, the author said that the peak concurrent connections was 300k. That tells us there are at least that many vulnerable hosts publicly exploitable, but there could be many more that are transiently exploitable.<p>Also, this attack is easily triggered from any LAN, such as an airport or university or corporate or coffee shop network. And it is persistent: the attacker persistently registers a &quot;printer&quot; on your system (potentially overwriting a real printer that you actually have), and later when you print, even disconnected from the internet, you can trigger the RCE.</div><br/><div id="41667231" class="c"><input type="checkbox" id="c-41667231" checked=""/><div class="controls bullet"><span class="by">nickphx</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41667021">parent</a><span>|</span><a href="#41663691">next</a><span>|</span><label class="collapse" for="c-41667231">[-]</label><label class="expand" for="c-41667231">[3 more]</label></div><br/><div class="children"><div class="content">Ehh most public wifi spots segment clients... You will be unable to send traffic to neighbors...</div><br/><div id="41667716" class="c"><input type="checkbox" id="c-41667716" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41667231">parent</a><span>|</span><a href="#41667618">next</a><span>|</span><label class="collapse" for="c-41667716">[-]</label><label class="expand" for="c-41667716">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s an open network, and there are still quite a few of those, it&#x27;s not hard to broadcast packets over the air and fool the receiver into thinking they&#x27;re coming from the connected AP.</div><br/></div></div><div id="41667618" class="c"><input type="checkbox" id="c-41667618" checked=""/><div class="controls bullet"><span class="by">mschuster91</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41667231">parent</a><span>|</span><a href="#41667716">prev</a><span>|</span><a href="#41663691">next</a><span>|</span><label class="collapse" for="c-41667618">[-]</label><label class="expand" for="c-41667618">[1 more]</label></div><br/><div class="children"><div class="content">Most run by <i>commercial enterprises</i> do, because they have teams running them that care about security.<p>Your average non-large-brand coffee shop or ho(s)tel? They stick some cheap ass router in and disable the wifi password to get a public wifi for their guests.</div><br/></div></div></div></div></div></div><div id="41663691" class="c"><input type="checkbox" id="c-41663691" checked=""/><div class="controls bullet"><span class="by">nullindividual</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663217">parent</a><span>|</span><a href="#41667021">prev</a><span>|</span><a href="#41663535">next</a><span>|</span><label class="collapse" for="c-41663691">[-]</label><label class="expand" for="c-41663691">[13 more]</label></div><br/><div class="children"><div class="content">That&#x27;s nearly as many as Code Red and roughly 100K more than SQL Slammer.</div><br/><div id="41665175" class="c"><input type="checkbox" id="c-41665175" checked=""/><div class="controls bullet"><span class="by">chupasaurus</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663691">parent</a><span>|</span><a href="#41663535">next</a><span>|</span><label class="collapse" for="c-41665175">[-]</label><label class="expand" for="c-41665175">[12 more]</label></div><br/><div class="children"><div class="content">Add every macOS-running device to the picture (who disables cupsd?)...</div><br/><div id="41665942" class="c"><input type="checkbox" id="c-41665942" checked=""/><div class="controls bullet"><span class="by">sitharus</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665175">parent</a><span>|</span><a href="#41665690">next</a><span>|</span><label class="collapse" for="c-41665942">[-]</label><label class="expand" for="c-41665942">[3 more]</label></div><br/><div class="children"><div class="content">My mac right now running Sonoma 14.6.1, with no system modifications or MDM:<p><pre><code>    ≻ ps aux | grep -i cups
    xxxxx    31407   0.0  0.0 410741456   1600 s000  S+    3:18pm   0:00.01 grep --color=auto -i cups
</code></pre>
cupsd is not running. If I go to print something cupsd will start up, and after a while of idle it&#x27;ll shut down again.</div><br/><div id="41667137" class="c"><input type="checkbox" id="c-41667137" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665942">parent</a><span>|</span><a href="#41666362">next</a><span>|</span><label class="collapse" for="c-41667137">[-]</label><label class="expand" for="c-41667137">[1 more]</label></div><br/><div class="children"><div class="content">The socket activation thing it has with systemd as well, but I don&#x27;t know if there are facilities for automatically shutting it down like that as well.<p>That&#x27;s a nice touch, and it&#x27;d be cool if Linux distros added that.</div><br/></div></div><div id="41666362" class="c"><input type="checkbox" id="c-41666362" checked=""/><div class="controls bullet"><span class="by">naming_the_user</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665942">parent</a><span>|</span><a href="#41667137">prev</a><span>|</span><a href="#41665690">next</a><span>|</span><label class="collapse" for="c-41666362">[-]</label><label class="expand" for="c-41666362">[1 more]</label></div><br/><div class="children"><div class="content">Same here. Also, using netstat for the PID you can see that it&#x27;s only listening on localhost ipv4&#x2F;ipv6.</div><br/></div></div></div></div><div id="41665690" class="c"><input type="checkbox" id="c-41665690" checked=""/><div class="controls bullet"><span class="by">cowsandmilk</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665175">parent</a><span>|</span><a href="#41665942">prev</a><span>|</span><a href="#41667123">next</a><span>|</span><label class="collapse" for="c-41665690">[-]</label><label class="expand" for="c-41665690">[3 more]</label></div><br/><div class="children"><div class="content">Generally, CUPS on a Mac is bound to localhost. It is highly atypical for a Mac to make it so any computer on the internet or even local network can make requests to its cups server.</div><br/><div id="41667068" class="c"><input type="checkbox" id="c-41667068" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665690">parent</a><span>|</span><a href="#41667032">next</a><span>|</span><label class="collapse" for="c-41667068">[-]</label><label class="expand" for="c-41667068">[1 more]</label></div><br/><div class="children"><div class="content">The problem isn&#x27;t CUPS itself, it&#x27;s the automatic printer discovery mechanism. That&#x27;s cups-browsed on Linux, not sure how it&#x27;s achieved on a Mac.<p>And the printer discovery service can&#x27;t be firewalled: by definition, it has to listen for outside connections to be in any way useful. This is where things like Windows&#x27; trusted VS untrusted networks make sense: it&#x27;s perfectly nice to allow printers to register to your system on your home network, it&#x27;s a horrible idea when you connect to an airport wifi.</div><br/></div></div></div></div><div id="41667123" class="c"><input type="checkbox" id="c-41667123" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665175">parent</a><span>|</span><a href="#41665690">prev</a><span>|</span><a href="#41665951">next</a><span>|</span><label class="collapse" for="c-41667123">[-]</label><label class="expand" for="c-41667123">[3 more]</label></div><br/><div class="children"><div class="content">CUPS is also part of iOS and iPadOS.</div><br/><div id="41667687" class="c"><input type="checkbox" id="c-41667687" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41667123">parent</a><span>|</span><a href="#41665951">next</a><span>|</span><label class="collapse" for="c-41667687">[-]</label><label class="expand" for="c-41667687">[2 more]</label></div><br/><div class="children"><div class="content">If those ship cups, why do they require special AirPrint-compatible printers?</div><br/><div id="41667782" class="c"><input type="checkbox" id="c-41667782" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41667687">parent</a><span>|</span><a href="#41665951">next</a><span>|</span><label class="collapse" for="c-41667782">[-]</label><label class="expand" for="c-41667782">[1 more]</label></div><br/><div class="children"><div class="content">I dunno. I assumed that<p>&gt; The standards-based, open source printing system developed by Apple for iOS®, iPadOS®¹<p>ships on iOS® and iPadOS®.<p>But maybe it doesn&#x27;t. 
¯\_(ツ)_&#x2F;¯<p>In seriousness, exposing only a very limited interface to a flexible, capable system seems to me very on-brand for Apple.<p>Maybe they don&#x27;t iOS and iPadOS to be of the kind of platform where one thinks about <i>drivers</i>, even if exposing CUPS features to users would let users accomplish more without much trouble.<p>Or maybe they see printer drivers as essentially a legacy feature in the face of a &#x27;driverless&#x27; future.<p>Not my cup of tea, but both seem like things leaders at Apple would do&#x2F;think.<p>--<p><a href="https:&#x2F;&#x2F;www.cups.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.cups.org&#x2F;</a></div><br/></div></div></div></div></div></div><div id="41665951" class="c"><input type="checkbox" id="c-41665951" checked=""/><div class="controls bullet"><span class="by">nullindividual</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665175">parent</a><span>|</span><a href="#41667123">prev</a><span>|</span><a href="#41663535">next</a><span>|</span><label class="collapse" for="c-41665951">[-]</label><label class="expand" for="c-41665951">[2 more]</label></div><br/><div class="children"><div class="content">macOS has a firewall on by default.</div><br/><div id="41667076" class="c"><input type="checkbox" id="c-41667076" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41665951">parent</a><span>|</span><a href="#41663535">next</a><span>|</span><label class="collapse" for="c-41667076">[-]</label><label class="expand" for="c-41667076">[1 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t help if the goal is to allow printers to register automatically to your system.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41663535" class="c"><input type="checkbox" id="c-41663535" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663127">parent</a><span>|</span><a href="#41663217">prev</a><span>|</span><a href="#41663556">next</a><span>|</span><label class="collapse" for="c-41663535">[-]</label><label class="expand" for="c-41663535">[3 more]</label></div><br/><div class="children"><div class="content">Are you sure? E.g. the blog post mentions a one-byte read overflow, which is unlikely to be directly exploitable.</div><br/><div id="41663912" class="c"><input type="checkbox" id="c-41663912" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663535">parent</a><span>|</span><a href="#41663556">next</a><span>|</span><label class="collapse" for="c-41663912">[-]</label><label class="expand" for="c-41663912">[2 more]</label></div><br/><div class="children"><div class="content">It also mentions:<p>&gt; I can tell you that there’re other, more easily exploitable code paths going on, not just in the discovery mechanism - also reported and ignored. To this day they have not been acknowledged or patched.</div><br/></div></div></div></div></div></div><div id="41663556" class="c"><input type="checkbox" id="c-41663556" checked=""/><div class="controls bullet"><span class="by">ezekg</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41663127">prev</a><span>|</span><a href="#41664886">next</a><span>|</span><label class="collapse" for="c-41663556">[-]</label><label class="expand" for="c-41663556">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Wait, this is a joke, right?<p>Not gonna lie, I died laughing at the &quot;Look at me, I&#x27;m the printer now&quot; meme.<p>So in a way, it did have a good joke regardless of how you rank severity.</div><br/></div></div><div id="41664886" class="c"><input type="checkbox" id="c-41664886" checked=""/><div class="controls bullet"><span class="by">Fnoord</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41663556">prev</a><span>|</span><a href="#41663068">next</a><span>|</span><label class="collapse" for="c-41664886">[-]</label><label class="expand" for="c-41664886">[5 more]</label></div><br/><div class="children"><div class="content">Apparently there are 300k people in the world who decided they need to have their printer available to the whole internet. It does not make sense, at all, but here we are. I suspect a lot of printers are going to be vulnerable with no patches in sight, but... these should only be available via LAN. Which is still an issue, but less so than it seems.</div><br/><div id="41667357" class="c"><input type="checkbox" id="c-41667357" checked=""/><div class="controls bullet"><span class="by">a96</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664886">parent</a><span>|</span><a href="#41666642">next</a><span>|</span><label class="collapse" for="c-41667357">[-]</label><label class="expand" for="c-41667357">[1 more]</label></div><br/><div class="children"><div class="content">Or, there are a whole lot of sites running honeypots. But it&#x27;s still probably a very large number.</div><br/></div></div><div id="41666642" class="c"><input type="checkbox" id="c-41666642" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664886">parent</a><span>|</span><a href="#41667357">prev</a><span>|</span><a href="#41665415">next</a><span>|</span><label class="collapse" for="c-41666642">[-]</label><label class="expand" for="c-41666642">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not that. Apparently, several major Linux distros, and the cups-browsed developers, have <i>decided for people</i> that any device on the internet should be able to connect to their system as a printer.</div><br/></div></div><div id="41665415" class="c"><input type="checkbox" id="c-41665415" checked=""/><div class="controls bullet"><span class="by">gmuslera</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664886">parent</a><span>|</span><a href="#41666642">prev</a><span>|</span><a href="#41665873">next</a><span>|</span><label class="collapse" for="c-41665415">[-]</label><label class="expand" for="c-41665415">[1 more]</label></div><br/><div class="children"><div class="content">Maybe some may fall into the IOT&#x2F;Embedded category. Wouldn&#x27;t be very surprise if i.e. a cheap wifi camera have cups installed just because and jumps out in this scan.</div><br/></div></div><div id="41665873" class="c"><input type="checkbox" id="c-41665873" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664886">parent</a><span>|</span><a href="#41665415">prev</a><span>|</span><a href="#41663068">next</a><span>|</span><label class="collapse" for="c-41665873">[-]</label><label class="expand" for="c-41665873">[1 more]</label></div><br/><div class="children"><div class="content">The I in IPP stands for &#x27;Internet&#x27;. I guess some people really mean it.</div><br/></div></div></div></div><div id="41663068" class="c"><input type="checkbox" id="c-41663068" checked=""/><div class="controls bullet"><span class="by">voytec</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41664886">prev</a><span>|</span><a href="#41664446">next</a><span>|</span><label class="collapse" for="c-41663068">[-]</label><label class="expand" for="c-41663068">[4 more]</label></div><br/><div class="children"><div class="content">From the last image in the article:<p>&gt; 3. Command execution (cups-browsed, cups-filters): 9.9<p>&gt; CVSS:3.1&#x2F;AV:N&#x2F;AC:L&#x2F;PR:N&#x2F;UI:N&#x2F;S:C&#x2F;C:L&#x2F;I:H&#x2F;A:L - CWE-94</div><br/><div id="41663411" class="c"><input type="checkbox" id="c-41663411" checked=""/><div class="controls bullet"><span class="by">dfc</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663068">parent</a><span>|</span><a href="#41663092">next</a><span>|</span><label class="collapse" for="c-41663411">[-]</label><label class="expand" for="c-41663411">[2 more]</label></div><br/><div class="children"><div class="content">But it seems like User Interaction is required.</div><br/><div id="41667082" class="c"><input type="checkbox" id="c-41667082" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663411">parent</a><span>|</span><a href="#41663092">next</a><span>|</span><label class="collapse" for="c-41667082">[-]</label><label class="expand" for="c-41667082">[1 more]</label></div><br/><div class="children"><div class="content">Printing something at some point arbitrarily later on the system is almost certainly not classed as User Interaction in this sense.</div><br/></div></div></div></div><div id="41663092" class="c"><input type="checkbox" id="c-41663092" checked=""/><div class="controls bullet"><span class="by">Tiberium</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663068">parent</a><span>|</span><a href="#41663411">prev</a><span>|</span><a href="#41664446">next</a><span>|</span><label class="collapse" for="c-41663092">[-]</label><label class="expand" for="c-41663092">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, I guess you&#x27;re right, for CUPS it might be 9.9. My other added points about it being a vastly overblown exploit still stand.</div><br/></div></div></div></div><div id="41664446" class="c"><input type="checkbox" id="c-41664446" checked=""/><div class="controls bullet"><span class="by">that_guy_iain</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41663068">prev</a><span>|</span><a href="#41666490">next</a><span>|</span><label class="collapse" for="c-41664446">[-]</label><label class="expand" for="c-41664446">[1 more]</label></div><br/><div class="children"><div class="content">&gt; There&#x27;s no way this is 9.9 when Heartbleed was just 7.5...<p>There are tons of 10s and for, what are IMO, really silly things.</div><br/></div></div><div id="41666490" class="c"><input type="checkbox" id="c-41666490" checked=""/><div class="controls bullet"><span class="by">worthless-trash</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41664446">prev</a><span>|</span><a href="#41663563">next</a><span>|</span><label class="collapse" for="c-41666490">[-]</label><label class="expand" for="c-41666490">[1 more]</label></div><br/><div class="children"><div class="content">Heartbleed was a different CVSS version.</div><br/></div></div><div id="41663563" class="c"><input type="checkbox" id="c-41663563" checked=""/><div class="controls bullet"><span class="by">znpy</span><span>|</span><a href="#41662938">parent</a><span>|</span><a href="#41666490">prev</a><span>|</span><a href="#41666619">next</a><span>|</span><label class="collapse" for="c-41663563">[-]</label><label class="expand" for="c-41663563">[15 more]</label></div><br/><div class="children"><div class="content">The whole thing looks severely overstated. If i was in bad faith i&#x27;d say the guy is looking for fame.<p>I wonder, has the guy tried reproducing the exploit on RHEL&#x2F;Fedora or some other SELinux-protected system? Because this looks like the kind of issue that SELinux would protect you from:<p><pre><code>    1. cups likely does not have permissions to go and write executable binary files around
    2. cups likely does not have permissions to go and exec binaries without the appropriate labels
</code></pre>
If that&#x27;s the case, this would really be a testament to SELinux and the final blow to AppArmor or whatever Canonical is shipping nowadays (clearly useless).<p>I still think that maybe you could steal printing document, but i haven&#x27;t tried. Anyway, i see there&#x27;s plenty of CUPS-related selinux work documented via manpages. Example: <a href="https:&#x2F;&#x2F;www.systutorials.com&#x2F;docs&#x2F;linux&#x2F;man&#x2F;8-cupsd_selinux&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.systutorials.com&#x2F;docs&#x2F;linux&#x2F;man&#x2F;8-cupsd_selinux&#x2F;</a></div><br/><div id="41667222" class="c"><input type="checkbox" id="c-41667222" checked=""/><div class="controls bullet"><span class="by">mort96</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663563">parent</a><span>|</span><a href="#41664901">next</a><span>|</span><label class="collapse" for="c-41667222">[-]</label><label class="expand" for="c-41667222">[1 more]</label></div><br/><div class="children"><div class="content">Red Hat is the company which first assigned a score of 9.9 fwiw, I think they would&#x27;ve mentioned if it didn&#x27;t affect RHEL&#x2F;Fedora?</div><br/></div></div><div id="41664901" class="c"><input type="checkbox" id="c-41664901" checked=""/><div class="controls bullet"><span class="by">Fnoord</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663563">parent</a><span>|</span><a href="#41667222">prev</a><span>|</span><a href="#41664725">next</a><span>|</span><label class="collapse" for="c-41664901">[-]</label><label class="expand" for="c-41664901">[2 more]</label></div><br/><div class="children"><div class="content">Evilsocket is a known hacker. They made for example Bettercap (Pwnagotchi), Opensnitch, and a myriad of other tools. They don&#x27;t need fame.</div><br/><div id="41666470" class="c"><input type="checkbox" id="c-41666470" checked=""/><div class="controls bullet"><span class="by">jsiepkes</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664901">parent</a><span>|</span><a href="#41664725">next</a><span>|</span><label class="collapse" for="c-41666470">[-]</label><label class="expand" for="c-41666470">[1 more]</label></div><br/><div class="children"><div class="content">People who already have some level of fame often feel pressure to keep meeting &quot;expectations&quot;.</div><br/></div></div></div></div><div id="41664725" class="c"><input type="checkbox" id="c-41664725" checked=""/><div class="controls bullet"><span class="by">shrubble</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663563">parent</a><span>|</span><a href="#41664901">prev</a><span>|</span><a href="#41664244">next</a><span>|</span><label class="collapse" for="c-41664725">[-]</label><label class="expand" for="c-41664725">[4 more]</label></div><br/><div class="children"><div class="content">The first thing many do in the real world, after installing RHEL or the free derivatives is ... turn off SELinux.</div><br/><div id="41666544" class="c"><input type="checkbox" id="c-41666544" checked=""/><div class="controls bullet"><span class="by">worthless-trash</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664725">parent</a><span>|</span><a href="#41664244">next</a><span>|</span><label class="collapse" for="c-41666544">[-]</label><label class="expand" for="c-41666544">[3 more]</label></div><br/><div class="children"><div class="content">It is a great way to show which people care about security.<p>I equate (and I am likely not alone) that this would be a modern equivalent of chmod -R 777 &#x2F; in early Unix computing.<p>Use of AppArmour&#x2F;SElinux is probably a good filter during an interview to determine if a person is a good fit for a security conscious position.</div><br/><div id="41666941" class="c"><input type="checkbox" id="c-41666941" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41666544">parent</a><span>|</span><a href="#41664244">next</a><span>|</span><label class="collapse" for="c-41666941">[-]</label><label class="expand" for="c-41666941">[2 more]</label></div><br/><div class="children"><div class="content">Hard disagree. FS permissions take like 5 minutes to explain and then you maybe need another 30 minutes in total to try around and get a hang of it. I&#x27;ve given up on selinux every time I&#x27;ve tried to make sense of it. Open 3 different tutorials, have 3 totally different approaches to it.<p>I guess if you only install core packages on redhat and never touch a single config file it might work OK even for the average Joe.</div><br/><div id="41667255" class="c"><input type="checkbox" id="c-41667255" checked=""/><div class="controls bullet"><span class="by">TheNewsIsHere</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41666941">parent</a><span>|</span><a href="#41664244">next</a><span>|</span><label class="collapse" for="c-41667255">[-]</label><label class="expand" for="c-41667255">[1 more]</label></div><br/><div class="children"><div class="content">I found that for me, SELinux is best mastered by reading the documentation. Most tutorials I read when trying to make custom policies and monitor how policies were working, were hot garbage written by people who were just reading other people’s tutorials. SELinux solves problems orthogonal to FS permissions, and use cases that FS permissions alone don’t address.<p>It was a bit tough at first but writing your first SELinux profile is a fantastic way to make it approachable. YMMV, of course.</div><br/></div></div></div></div></div></div></div></div><div id="41665436" class="c"><input type="checkbox" id="c-41665436" checked=""/><div class="controls bullet"><span class="by">anthk</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663563">parent</a><span>|</span><a href="#41664244">prev</a><span>|</span><a href="#41664052">next</a><span>|</span><label class="collapse" for="c-41665436">[-]</label><label class="expand" for="c-41665436">[1 more]</label></div><br/><div class="children"><div class="content">Cups needs permissions for Foomatic and some printing filters.</div><br/></div></div><div id="41664052" class="c"><input type="checkbox" id="c-41664052" checked=""/><div class="controls bullet"><span class="by">dumpsterdiver</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41663563">parent</a><span>|</span><a href="#41665436">prev</a><span>|</span><a href="#41666619">next</a><span>|</span><label class="collapse" for="c-41664052">[-]</label><label class="expand" for="c-41664052">[5 more]</label></div><br/><div class="children"><div class="content">Are you suggesting that people should not report remote command execution vulnerabilities when such vulnerabilities are successfully stopped by SELinux?<p>Also, why do you think that seeking recognition for your efforts a bad thing?</div><br/><div id="41664118" class="c"><input type="checkbox" id="c-41664118" checked=""/><div class="controls bullet"><span class="by">znpy</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664052">parent</a><span>|</span><a href="#41666619">next</a><span>|</span><label class="collapse" for="c-41664118">[-]</label><label class="expand" for="c-41664118">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Are you suggesting that people should not report remote command execution vulnerabilities when such vulnerabilities are successfully stopped by SELinux?<p>No, I&#x27;m suggesting that only testing on system shipping weak protection systems and  poor defaults is misleading.<p>&gt; Also, why do you think that seeking recognition for your efforts a bad thing?<p>It isn&#x27;t by default, but it can become a bad thing when you overstate the importance of your finding: see my previous line in this comment and add the fact that this guy picked a cve score of 9.9 where heartbleed had &quot;only&quot; a 7.5 score -- but heartbleed affected pretty much <i>everybody</i> in the industry.</div><br/><div id="41664355" class="c"><input type="checkbox" id="c-41664355" checked=""/><div class="controls bullet"><span class="by">outworlder</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664118">parent</a><span>|</span><a href="#41664600">next</a><span>|</span><label class="collapse" for="c-41664355">[-]</label><label class="expand" for="c-41664355">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But here’s a screenshot from the VINCE report of the initial CVSS scores, including the 9.9, being estimated by a RedHat engineer (and also reviewed by another one)<p>&gt; As I said, I’m not an expert, and I think that the initial 9.9 was mostly due to the fact that the RCE is trivial to exploit and the package presence so widespread. Impact wise I wouldn’t classify it as a 9.9, but then again, what the hell do I know?<p>He did _not_ pick the score.</div><br/></div></div><div id="41664600" class="c"><input type="checkbox" id="c-41664600" checked=""/><div class="controls bullet"><span class="by">dumpsterdiver</span><span>|</span><a href="#41662938">root</a><span>|</span><a href="#41664118">parent</a><span>|</span><a href="#41664355">prev</a><span>|</span><a href="#41664369">next</a><span>|</span><label class="collapse" for="c-41664600">[-]</label><label class="expand" for="c-41664600">[1 more]</label></div><br/><div class="children"><div class="content">&gt; No, I&#x27;m suggesting that only testing on system shipping weak protection systems and poor defaults is misleading.<p>But then he would not have found and reported the vulnerability, yet it would still exist and affect people.<p>Once the vulnerability was discovered it doesn’t matter if one operating system or the other has protections in place that will stop it. What matters is that the code is vulnerable and that there are people who are not protected. Proving that it is not exploitable on systems configured a certain way does not invalidate the original finding.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41666619" class="c"><input type="checkbox" id="c-41666619" checked=""/><div class="controls bullet"><span class="by">jesprenj</span><span>|</span><a href="#41662938">prev</a><span>|</span><a href="#41662656">next</a><span>|</span><label class="collapse" for="c-41666619">[-]</label><label class="expand" for="c-41666619">[2 more]</label></div><br/><div class="children"><div class="content">I panicked a little when I heard the news as I run a cupsd open on the Internet. But as it turns out, the issue is misrepresented in headlines, just like here. This is not an issue in the core cupsd, but in a separate package&#x2F;component, called cups-browsed. My distribution of choice for servers, Gentoo Linux, ships cups-browsed in a separate package which I had not installed, meaning I, as well as most other cups users that did not install this additional package, am not affected by this bug.<p>Saying that all systems running cups can be hacked is a misrepresentation of the scale of the issue.</div><br/><div id="41666885" class="c"><input type="checkbox" id="c-41666885" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#41666619">parent</a><span>|</span><a href="#41662656">next</a><span>|</span><label class="collapse" for="c-41666885">[-]</label><label class="expand" for="c-41666885">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve always disliked how on Debian, usually being rather conservative, cups-browsed gets pulled in by default if you install cups. I think &quot;no install recommends&quot; fixes that, but iirc some add-ons like that hplip driver pull it in again. In my home setup I just disabled the service, but it&#x27;s rather annoying how more and more software spirals out of scope and makes components that could be optional a requirement. Very related is avahi-daemon. Take a desktop Debian&#x2F;Ubuntu and try to uninstall it; there&#x27;s a good chance it&#x27;s going to remove a couple other software where you wonder why avahi would be a hard dependency.</div><br/></div></div></div></div><div id="41662656" class="c"><input type="checkbox" id="c-41662656" checked=""/><div class="controls bullet"><span class="by">RGBCube</span><span>|</span><a href="#41666619">prev</a><span>|</span><a href="#41663134">next</a><span>|</span><label class="collapse" for="c-41662656">[-]</label><label class="expand" for="c-41662656">[65 more]</label></div><br/><div class="children"><div class="content">Anyone exposing CUPS to the internet is living a level of not giving a fuck that CVEs cannot reach.</div><br/><div id="41662800" class="c"><input type="checkbox" id="c-41662800" checked=""/><div class="controls bullet"><span class="by">DanMcInerney</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41665646">next</a><span>|</span><label class="collapse" for="c-41662800">[-]</label><label class="expand" for="c-41662800">[30 more]</label></div><br/><div class="children"><div class="content">It appears that the vulnerable service in question listens on 0.0.0.0 which is concerning, it means attacks from the LAN are vulnerable by default and you have to explicitly block port 631 if the server is exposed to internet. Granted, requires user to print something to trigger which, I mean, I don&#x27;t think I&#x27;ve printed anything from Linux in my life, but he does claim getting callbacks from 100&#x27;s of thousands of linux machines which is believable.</div><br/><div id="41663142" class="c"><input type="checkbox" id="c-41663142" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662800">parent</a><span>|</span><a href="#41662843">next</a><span>|</span><label class="collapse" for="c-41663142">[-]</label><label class="expand" for="c-41663142">[3 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re vulnerable to attacks from the LAN, you&#x27;re vulnerable to your wi-fi router (or your coffee shop&#x2F;workplace&#x27;s router) being compromised, which is quite common; see e.g. <a href="https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;mirai-botnet-targets-22-flaws-in-d-link-zyxel-netgear-devices&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;mirai-botnet-...</a> and <a href="https:&#x2F;&#x2F;blog.lumen.com&#x2F;the-pumpkin-eclipse&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.lumen.com&#x2F;the-pumpkin-eclipse&#x2F;</a><p>Assuming that most routers are silently compromised, with their command-and-control operators just waiting for an exploit like this one, is almost par for the course these days!</div><br/><div id="41663532" class="c"><input type="checkbox" id="c-41663532" checked=""/><div class="controls bullet"><span class="by">runjake</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663142">parent</a><span>|</span><a href="#41662843">next</a><span>|</span><label class="collapse" for="c-41663532">[-]</label><label class="expand" for="c-41663532">[2 more]</label></div><br/><div class="children"><div class="content">The problem: you&#x27;re thinking in terms of home&#x2F;small business networks.<p>The rest of us are thinking in terms of larger networks (in my case with hundreds of subnets and tens of thousands of nodes) where &quot;631 is blocked at the firewall&quot; isn&#x27;t of much relief. The firewall is merely one, rather easy to get past, barrier. We&#x27;re also concerned with east&#x2F;west traffic.</div><br/><div id="41664232" class="c"><input type="checkbox" id="c-41664232" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663532">parent</a><span>|</span><a href="#41662843">next</a><span>|</span><label class="collapse" for="c-41664232">[-]</label><label class="expand" for="c-41664232">[1 more]</label></div><br/><div class="children"><div class="content">For sure, and sending hug-ops to teams like yours that have to deploy &amp; enforce mass patches! But I&#x27;m also thinking of environments that don&#x27;t even have the benefit of a team like yours. <a href="https:&#x2F;&#x2F;issuetracker.google.com&#x2F;issues&#x2F;172222838?pli=1" rel="nofollow">https:&#x2F;&#x2F;issuetracker.google.com&#x2F;issues&#x2F;172222838?pli=1</a> is (or seems to be?) a saving grace, without which every school using Chromebooks could see worms propagating rapidly if even one student connected to a compromised router at home.</div><br/></div></div></div></div></div></div><div id="41662843" class="c"><input type="checkbox" id="c-41662843" checked=""/><div class="controls bullet"><span class="by">gordonfish</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662800">parent</a><span>|</span><a href="#41663142">prev</a><span>|</span><a href="#41662911">next</a><span>|</span><label class="collapse" for="c-41662843">[-]</label><label class="expand" for="c-41662843">[1 more]</label></div><br/><div class="children"><div class="content">This is why on public servers I block everything inbound and only allow specific needed services through.</div><br/></div></div><div id="41662911" class="c"><input type="checkbox" id="c-41662911" checked=""/><div class="controls bullet"><span class="by">eikenberry</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662800">parent</a><span>|</span><a href="#41662843">prev</a><span>|</span><a href="#41662870">next</a><span>|</span><label class="collapse" for="c-41662911">[-]</label><label class="expand" for="c-41662911">[13 more]</label></div><br/><div class="children"><div class="content">Which distro do you see Cups listening on 0.0.0.0? 
On Debian (at least, only one I have handy) it only listens on localhost.<p>[edit: I was wrong, it listens on 0.0.0.0 for UDP. I was only checking TCP. ]</div><br/><div id="41663024" class="c"><input type="checkbox" id="c-41663024" checked=""/><div class="controls bullet"><span class="by">mikepavone</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662911">parent</a><span>|</span><a href="#41662999">next</a><span>|</span><label class="collapse" for="c-41663024">[-]</label><label class="expand" for="c-41663024">[5 more]</label></div><br/><div class="children"><div class="content">On my Ubuntu 22.04 machine, cupsd itself is only listening on localhost, but cups-browsed (which is what has the vulnerability here) is listening on 0.0.0.0</div><br/><div id="41663056" class="c"><input type="checkbox" id="c-41663056" checked=""/><div class="controls bullet"><span class="by">raverbashing</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663024">parent</a><span>|</span><a href="#41662999">next</a><span>|</span><label class="collapse" for="c-41663056">[-]</label><label class="expand" for="c-41663056">[4 more]</label></div><br/><div class="children"><div class="content">Why does it even listens in UDP at this day and age?!</div><br/><div id="41663175" class="c"><input type="checkbox" id="c-41663175" checked=""/><div class="controls bullet"><span class="by">mikepavone</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663056">parent</a><span>|</span><a href="#41664090">next</a><span>|</span><label class="collapse" for="c-41663175">[-]</label><label class="expand" for="c-41663175">[2 more]</label></div><br/><div class="children"><div class="content">I believe it&#x27;s implementing DNS-SD for network printer auto-discovery. I&#x27;m not terribly familiar with DNS-SD, but given that normal DNS is UDP based it would be unsurprising for DNS-SD to also use UDP.</div><br/><div id="41664110" class="c"><input type="checkbox" id="c-41664110" checked=""/><div class="controls bullet"><span class="by">ahoka</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663175">parent</a><span>|</span><a href="#41664090">next</a><span>|</span><label class="collapse" for="c-41664110">[-]</label><label class="expand" for="c-41664110">[1 more]</label></div><br/><div class="children"><div class="content">DNS is actually UDP&#x2F;TCP. It’s probably required for receiving unicast messages, if it’s using DNS-SD</div><br/></div></div></div></div><div id="41664090" class="c"><input type="checkbox" id="c-41664090" checked=""/><div class="controls bullet"><span class="by">ahoka</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663056">parent</a><span>|</span><a href="#41663175">prev</a><span>|</span><a href="#41662999">next</a><span>|</span><label class="collapse" for="c-41664090">[-]</label><label class="expand" for="c-41664090">[1 more]</label></div><br/><div class="children"><div class="content">To receive multicast messages, probably.</div><br/></div></div></div></div></div></div><div id="41662999" class="c"><input type="checkbox" id="c-41662999" checked=""/><div class="controls bullet"><span class="by">bonzini</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662911">parent</a><span>|</span><a href="#41663024">prev</a><span>|</span><a href="#41662933">next</a><span>|</span><label class="collapse" for="c-41662999">[-]</label><label class="expand" for="c-41662999">[2 more]</label></div><br/><div class="children"><div class="content">OpenSUSE<p>But it looks like cups-browsed is only needed on the Internet; locally you only need mDNS.</div><br/><div id="41667091" class="c"><input type="checkbox" id="c-41667091" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662999">parent</a><span>|</span><a href="#41662933">next</a><span>|</span><label class="collapse" for="c-41667091">[-]</label><label class="expand" for="c-41667091">[1 more]</label></div><br/><div class="children"><div class="content">mDNS doesn&#x27;t allow the printer to register itself to your system, which is the (highly dubious!) purpose of cups-browsed.</div><br/></div></div></div></div><div id="41662933" class="c"><input type="checkbox" id="c-41662933" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662911">parent</a><span>|</span><a href="#41662999">prev</a><span>|</span><a href="#41662947">next</a><span>|</span><label class="collapse" for="c-41662933">[-]</label><label class="expand" for="c-41662933">[1 more]</label></div><br/><div class="children"><div class="content">MX Linux</div><br/></div></div><div id="41662947" class="c"><input type="checkbox" id="c-41662947" checked=""/><div class="controls bullet"><span class="by">cp9</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662911">parent</a><span>|</span><a href="#41662933">prev</a><span>|</span><a href="#41662870">next</a><span>|</span><label class="collapse" for="c-41662947">[-]</label><label class="expand" for="c-41662947">[4 more]</label></div><br/><div class="children"><div class="content">on popOS I see 0.0.0.0:*<p>I&#x27;m not sure why it deviates from Debian and Ubuntu which its based on though</div><br/><div id="41662986" class="c"><input type="checkbox" id="c-41662986" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662947">parent</a><span>|</span><a href="#41662997">prev</a><span>|</span><a href="#41662870">next</a><span>|</span><label class="collapse" for="c-41662986">[-]</label><label class="expand" for="c-41662986">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the wrong column of netstat output, I think. &quot;0.0.0.0:*&quot; stands in for the (non-existent) peer address of a listening port.</div><br/><div id="41663177" class="c"><input type="checkbox" id="c-41663177" checked=""/><div class="controls bullet"><span class="by">cp9</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662986">parent</a><span>|</span><a href="#41662870">next</a><span>|</span><label class="collapse" for="c-41663177">[-]</label><label class="expand" for="c-41663177">[1 more]</label></div><br/><div class="children"><div class="content">oh sorry yeah I copied the wrong column. the correct column is `0.0.0.0:631`</div><br/></div></div></div></div></div></div></div></div><div id="41662870" class="c"><input type="checkbox" id="c-41662870" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662800">parent</a><span>|</span><a href="#41662911">prev</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41662870">[-]</label><label class="expand" for="c-41662870">[7 more]</label></div><br/><div class="children"><div class="content">Who doesn&#x27;t block all unneeded ports on an internet facing server or have it behind a firewall of some sort?</div><br/><div id="41662950" class="c"><input type="checkbox" id="c-41662950" checked=""/><div class="controls bullet"><span class="by">bshipp</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662870">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41662950">[-]</label><label class="expand" for="c-41662950">[6 more]</label></div><br/><div class="children"><div class="content">I guess the important question is whether or not these things are blocked by default or require user intervention to disable cups? Sure, many of us block all ports by default and either route everything behind a reverse proxy or punch very specific holes in the firewall that we know are there and can monitor, but someone firing up an ubuntu distribution for their first foray into linux is probably not thinking that way.</div><br/><div id="41663034" class="c"><input type="checkbox" id="c-41663034" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662950">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41663034">[-]</label><label class="expand" for="c-41663034">[5 more]</label></div><br/><div class="children"><div class="content">Well lots of people crash 600HP cars right after they buy them. If you haven&#x27;t done your homework, you&#x27;ll learn quickly.</div><br/><div id="41663091" class="c"><input type="checkbox" id="c-41663091" checked=""/><div class="controls bullet"><span class="by">bshipp</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663034">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41663091">[-]</label><label class="expand" for="c-41663091">[4 more]</label></div><br/><div class="children"><div class="content">The people who are crashing their 600HP Linux systems are, unfortunately, not the ones who are reading CVE listings in their spare time. Canonical and other distros are probably going to have to patch that default setting.</div><br/><div id="41663499" class="c"><input type="checkbox" id="c-41663499" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663091">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41663499">[-]</label><label class="expand" for="c-41663499">[3 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need to read CVEs to turn on your fucking firewall. It&#x27;s in every single how to set up a server for dummies tutorial I&#x27;ve ever seen.</div><br/><div id="41664730" class="c"><input type="checkbox" id="c-41664730" checked=""/><div class="controls bullet"><span class="by">sgc</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663499">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41664730">[-]</label><label class="expand" for="c-41664730">[2 more]</label></div><br/><div class="children"><div class="content">There are a lot of comments on here that assume Linux is only for servers. But just recently there was a post on HN indicating Linux will likely hit 5% desktop share for the first time this year. That&#x27;s a lot of people on Linux - and a far higher percentage of people using Linux on the desktop will not know anything about this. Sane defaults should not be a luxury. Of course people should know to wear their seatbelts, but seatbelt alarms are still a very good thing.<p>Sent from my Ubuntu laptop.</div><br/><div id="41666731" class="c"><input type="checkbox" id="c-41666731" checked=""/><div class="controls bullet"><span class="by">Ekaros</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41664730">parent</a><span>|</span><a href="#41662916">next</a><span>|</span><label class="collapse" for="c-41666731">[-]</label><label class="expand" for="c-41666731">[1 more]</label></div><br/><div class="children"><div class="content">And this is why Microsoft force pushes updates. I think when Linux desktops become really popular there is quite a worry if the users simply do not update them regularly enough. Or if they are not secured in most ways by default.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="41662916" class="c"><input type="checkbox" id="c-41662916" checked=""/><div class="controls bullet"><span class="by">RGBCube</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662800">parent</a><span>|</span><a href="#41662870">prev</a><span>|</span><a href="#41665646">next</a><span>|</span><label class="collapse" for="c-41662916">[-]</label><label class="expand" for="c-41662916">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;m pretty sure all major distros configure it to listen locally instead.</div><br/><div id="41663591" class="c"><input type="checkbox" id="c-41663591" checked=""/><div class="controls bullet"><span class="by">mikepavone</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662916">parent</a><span>|</span><a href="#41665646">next</a><span>|</span><label class="collapse" for="c-41663591">[-]</label><label class="expand" for="c-41663591">[4 more]</label></div><br/><div class="children"><div class="content">cupsd is configured to listen locally, but cups-browsed has to listen on the network to do its job (network printer auto-discovery)</div><br/><div id="41664392" class="c"><input type="checkbox" id="c-41664392" checked=""/><div class="controls bullet"><span class="by">gordonfish</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663591">parent</a><span>|</span><a href="#41665646">next</a><span>|</span><label class="collapse" for="c-41664392">[-]</label><label class="expand" for="c-41664392">[3 more]</label></div><br/><div class="children"><div class="content">&gt; but cups-browsed has to listen on the network to do its job (network printer auto-discovery)<p>Isn&#x27;t listening on 0.0.0.0 instead of localhost only needed if the machine itself is hosting a printer that needs to be accessible to other hosts?</div><br/><div id="41665073" class="c"><input type="checkbox" id="c-41665073" checked=""/><div class="controls bullet"><span class="by">mikepavone</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41664392">parent</a><span>|</span><a href="#41666675">next</a><span>|</span><label class="collapse" for="c-41665073">[-]</label><label class="expand" for="c-41665073">[1 more]</label></div><br/><div class="children"><div class="content">I am very unfamiliar with the protocol, but my impression from a little reading is that the sharing computer broadcasts and the receiver listens. This appears to be for some CUPS specific browsing&#x2F;discovery protocol rather than mDNS&#x2F;DNS-SD (cups-browsed supports adding printers discovered that way but depends on avahi to handle the mDNS part).<p>EDIT: Here&#x27;s a description of the protocol in question: <a href="https:&#x2F;&#x2F;opensource.apple.com&#x2F;source&#x2F;cups&#x2F;cups-327&#x2F;cups&#x2F;doc&#x2F;help&#x2F;spec-browsing.html" rel="nofollow">https:&#x2F;&#x2F;opensource.apple.com&#x2F;source&#x2F;cups&#x2F;cups-327&#x2F;cups&#x2F;doc&#x2F;h...</a></div><br/></div></div><div id="41666675" class="c"><input type="checkbox" id="c-41666675" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41664392">parent</a><span>|</span><a href="#41665073">prev</a><span>|</span><a href="#41665646">next</a><span>|</span><label class="collapse" for="c-41666675">[-]</label><label class="expand" for="c-41666675">[1 more]</label></div><br/><div class="children"><div class="content">No, per the article, cups-browsed is used so that a printer can register itself to your system. The printer is the one that initiates a connection to tell your system that it is available at some URL.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41665646" class="c"><input type="checkbox" id="c-41665646" checked=""/><div class="controls bullet"><span class="by">eadmund</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41662800">prev</a><span>|</span><a href="#41664321">next</a><span>|</span><label class="collapse" for="c-41665646">[-]</label><label class="expand" for="c-41665646">[1 more]</label></div><br/><div class="children"><div class="content">It sounds like in this case “exposing CUPS to the Internet” means “running a Linux desktop on the Internet” which while not something I would do doesn’t seem crazy.  I would hope that a default Debian desktop installation would be secure enough to set up without a firewall.<p>I certainly expect that a Linux laptop shouldn’t be highly vulnerable to every other device on, say, an æroport’s WiFi.</div><br/></div></div><div id="41664321" class="c"><input type="checkbox" id="c-41664321" checked=""/><div class="controls bullet"><span class="by">johnklos</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41665646">prev</a><span>|</span><a href="#41662904">next</a><span>|</span><label class="collapse" for="c-41664321">[-]</label><label class="expand" for="c-41664321">[4 more]</label></div><br/><div class="children"><div class="content">Anyone going to a coffee shoppe and using a public wifi is exposing CUPS and can be exploited. Simple minded dismissal doesn&#x27;t help anyone.</div><br/><div id="41665413" class="c"><input type="checkbox" id="c-41665413" checked=""/><div class="controls bullet"><span class="by">gordonfish</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41664321">parent</a><span>|</span><a href="#41662904">next</a><span>|</span><label class="collapse" for="c-41665413">[-]</label><label class="expand" for="c-41665413">[3 more]</label></div><br/><div class="children"><div class="content">Honestly, this is why firewalls exist. This really isn&#x27;t problem for anyone with basic computer hygiene.</div><br/><div id="41666224" class="c"><input type="checkbox" id="c-41666224" checked=""/><div class="controls bullet"><span class="by">zanecodes</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41665413">parent</a><span>|</span><a href="#41666285">next</a><span>|</span><label class="collapse" for="c-41666224">[-]</label><label class="expand" for="c-41666224">[1 more]</label></div><br/><div class="children"><div class="content">The prevalence of attitudes like this in the Linux community is why the year of the Linux desktop will never come.<p>Imagine if your brand new refrigerator, by default, would leak toxic refrigerant into your kitchen unless you adjusted a valve just so.
This fact is not called out prominently in the manual, but if you read the fine print in the manufacturer&#x27;s assembly instructions and have a working knowledge of how a refrigerator operates, you can maybe infer that this valve must be adjusted after purchase to prevent leakage.
You go on their support forum to try to figure out why your brand new refrigerator is emitting toxic refrigerant, and you&#x27;re essentially called an idiot and told you don&#x27;t have &quot;basic refrigerator hygiene.&quot;<p>People don&#x27;t want to become refrigerator mechanics. They want cold food.</div><br/></div></div><div id="41666285" class="c"><input type="checkbox" id="c-41666285" checked=""/><div class="controls bullet"><span class="by">abhinavk</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41665413">parent</a><span>|</span><a href="#41666224">prev</a><span>|</span><a href="#41662904">next</a><span>|</span><label class="collapse" for="c-41666285">[-]</label><label class="expand" for="c-41666285">[1 more]</label></div><br/><div class="children"><div class="content">Why isn&#x27;t the firewall on by default on desktop systems?</div><br/></div></div></div></div></div></div><div id="41662904" class="c"><input type="checkbox" id="c-41662904" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41664321">prev</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41662904">[-]</label><label class="expand" for="c-41662904">[15 more]</label></div><br/><div class="children"><div class="content">And, for some utterly and completely absurd reason, CUPS runs as a system daemon instead of a highly sandboxed user program.</div><br/><div id="41663390" class="c"><input type="checkbox" id="c-41663390" checked=""/><div class="controls bullet"><span class="by">edelbitter</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662904">parent</a><span>|</span><a href="#41663011">next</a><span>|</span><label class="collapse" for="c-41663390">[-]</label><label class="expand" for="c-41663390">[1 more]</label></div><br/><div class="children"><div class="content">On Ubuntu, both.
A system daemon with interesting interactions with avahi-daemon and colord, and a somewhat sandboxed user program, just so Chrome is not overly inconvenienced by its snap sandboxing.
But wait, there is more: The login &amp; lock screen also runs the whole glory of GNOME.. to query printer settings. So you can have those sweet, sweet &quot;new printer&quot; notifications overlaid while inputting your password. Or whatever else &quot;your&quot; printer needs to add there.</div><br/></div></div><div id="41663011" class="c"><input type="checkbox" id="c-41663011" checked=""/><div class="controls bullet"><span class="by">throwanem</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662904">parent</a><span>|</span><a href="#41663390">prev</a><span>|</span><a href="#41662979">next</a><span>|</span><label class="collapse" for="c-41663011">[-]</label><label class="expand" for="c-41663011">[8 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a spooler for a printing system that supports concurrent job submission, potentially among multiple users. It&#x27;s going to have to achieve serialization <i>some</i> kind of way.</div><br/><div id="41666138" class="c"><input type="checkbox" id="c-41666138" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663011">parent</a><span>|</span><a href="#41663143">next</a><span>|</span><label class="collapse" for="c-41666138">[-]</label><label class="expand" for="c-41666138">[1 more]</label></div><br/><div class="children"><div class="content">I have <i>never</i>, in the entire history of my usage of desktop systems, wanted my system to spool out a print job on behalf of a non-current user. Nor have I wanted my system to continue servicing my print queue after I log out. To the contrary: it’s incredibly annoying when the queue glitches out and then my print jobs show up in the printer tray after I’ve left.<p>On multi-user systems (accessed simultaneously by multiple interactive accounts), sure, I’ve <i>once</i> worked in a lab where multiplexing a printer would make sense. Make this a non-default option, please.  And have a printer multiplexing daemon, not an entire shared monstrosity like CUPS.<p>On terminal-server style systems, the print system should be per user, because the <i>printers</i> are per user. I don’t want to print to a printer wherever the terminal server lives — I want to print to the printer <i>near me</i>.<p>I once ran an actual print server for a couple years. It did accounting, correctly, by wiring CUPS to a little program I wrote that actually spoke PJL correctly. CUPS, of course, can’t actually do this.</div><br/></div></div><div id="41663143" class="c"><input type="checkbox" id="c-41663143" checked=""/><div class="controls bullet"><span class="by">aftbit</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663011">parent</a><span>|</span><a href="#41666138">prev</a><span>|</span><a href="#41662979">next</a><span>|</span><label class="collapse" for="c-41663143">[-]</label><label class="expand" for="c-41663143">[6 more]</label></div><br/><div class="children"><div class="content">Why does it need to run as `root` user and not `cups`?</div><br/><div id="41663234" class="c"><input type="checkbox" id="c-41663234" checked=""/><div class="controls bullet"><span class="by">throwanem</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663143">parent</a><span>|</span><a href="#41665733">next</a><span>|</span><label class="collapse" for="c-41663234">[-]</label><label class="expand" for="c-41663234">[1 more]</label></div><br/><div class="children"><div class="content">As long as that user can talk to the printers&#x27; device nodes (and&#x2F;or the network), it needn&#x27;t so far as I know.<p>The original &quot;system daemon vs. user program&quot; dichotomy offers a much broader range of interpretations than this, though, and it was more the implication of &quot;this can and should be an evanescent program invoked by individual users, implicitly persisting little or no state between invocations&quot; to which I sought to object.<p>(That said, I take another nearby commenter&#x27;s point regarding the need, and existence, of a more evanescent and safer option on systems that will never see more printing than one user does two or three times a year.)</div><br/></div></div><div id="41665733" class="c"><input type="checkbox" id="c-41665733" checked=""/><div class="controls bullet"><span class="by">stevekemp</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663143">parent</a><span>|</span><a href="#41663234">prev</a><span>|</span><a href="#41662979">next</a><span>|</span><label class="collapse" for="c-41665733">[-]</label><label class="expand" for="c-41665733">[4 more]</label></div><br/><div class="children"><div class="content">Binding to ports under 1024 traditionally requires root privileges.  (These days of course that isn&#x27;t quite as true as it used to be.)</div><br/><div id="41666497" class="c"><input type="checkbox" id="c-41666497" checked=""/><div class="controls bullet"><span class="by">ronjakoi</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41665733">parent</a><span>|</span><a href="#41666142">next</a><span>|</span><label class="collapse" for="c-41666497">[-]</label><label class="expand" for="c-41666497">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s common practice to open the socket to start listening on the &lt;1024 port, then drop the root privileges and continue as a different user.</div><br/></div></div><div id="41666142" class="c"><input type="checkbox" id="c-41666142" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41665733">parent</a><span>|</span><a href="#41666497">prev</a><span>|</span><a href="#41662979">next</a><span>|</span><label class="collapse" for="c-41666142">[-]</label><label class="expand" for="c-41666142">[2 more]</label></div><br/><div class="children"><div class="content">Why on Earth do ordinary systems need CUPS binding to a port at all?</div><br/><div id="41667402" class="c"><input type="checkbox" id="c-41667402" checked=""/><div class="controls bullet"><span class="by">a96</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41666142">parent</a><span>|</span><a href="#41662979">next</a><span>|</span><label class="collapse" for="c-41667402">[-]</label><label class="expand" for="c-41667402">[1 more]</label></div><br/><div class="children"><div class="content">They don&#x27;t need. Want, for listening to network printers announcing themselves. It&#x27;s a very bad system, even then.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41662979" class="c"><input type="checkbox" id="c-41662979" checked=""/><div class="controls bullet"><span class="by">bshipp</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662904">parent</a><span>|</span><a href="#41663011">prev</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41662979">[-]</label><label class="expand" for="c-41662979">[5 more]</label></div><br/><div class="children"><div class="content">This is the worry. It seems like a really unnecessary privilege escalation.</div><br/><div id="41663023" class="c"><input type="checkbox" id="c-41663023" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662979">parent</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41663023">[-]</label><label class="expand" for="c-41663023">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s because of the frankly idiotic idea of persistent print queues. If you want to have this artifact that survives a user session, then the print subsystem needs super-user abilities.<p>ChromeOS does away with the whole idea. There are no persistent printer queues or jobs. Artifacts of the printing subsystem have lifetime tied to the user session.</div><br/><div id="41663080" class="c"><input type="checkbox" id="c-41663080" checked=""/><div class="controls bullet"><span class="by">funcDropShadow</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663023">parent</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41663080">[-]</label><label class="expand" for="c-41663080">[3 more]</label></div><br/><div class="children"><div class="content">No, persistent print queues can be implemented without cups running as super-user.</div><br/><div id="41665401" class="c"><input type="checkbox" id="c-41665401" checked=""/><div class="controls bullet"><span class="by">gordonfish</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663080">parent</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41665401">[-]</label><label class="expand" for="c-41665401">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a little confused why this is even an issue. Persistent queues have been an option since the days of Windows 9x.<p>Maybe it&#x27;s a Gnome problem. KDE let&#x27;s me see what I had previously printed if I want to see it, or reprint something.<p>I also know many people in pre-press who make good use of that.</div><br/><div id="41666145" class="c"><input type="checkbox" id="c-41666145" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41665401">parent</a><span>|</span><a href="#41664902">next</a><span>|</span><label class="collapse" for="c-41666145">[-]</label><label class="expand" for="c-41666145">[1 more]</label></div><br/><div class="children"><div class="content">Windows 9x printing was every bit as bad as CUPS.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41664902" class="c"><input type="checkbox" id="c-41664902" checked=""/><div class="controls bullet"><span class="by">ImpostorKeanu</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41662904">prev</a><span>|</span><a href="#41662689">next</a><span>|</span><label class="collapse" for="c-41664902">[-]</label><label class="expand" for="c-41664902">[1 more]</label></div><br/><div class="children"><div class="content">Lateral movement and privilege escalation are total wins, tho.</div><br/></div></div><div id="41662689" class="c"><input type="checkbox" id="c-41662689" checked=""/><div class="controls bullet"><span class="by">RGBCube</span><span>|</span><a href="#41662656">parent</a><span>|</span><a href="#41664902">prev</a><span>|</span><a href="#41663134">next</a><span>|</span><label class="collapse" for="c-41662689">[-]</label><label class="expand" for="c-41662689">[13 more]</label></div><br/><div class="children"><div class="content">I also cannot believe that <i>this</i> is the 9.9 rated CVE.  For comparison, heartbleed was a 7.5.  I was awaiting a Total Linux Meltdown at best and a collapse of the world economy at worst with the amount of hyping up and fearmongering that the author did on social media.</div><br/><div id="41662753" class="c"><input type="checkbox" id="c-41662753" checked=""/><div class="controls bullet"><span class="by">bogantech</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662689">parent</a><span>|</span><a href="#41662789">next</a><span>|</span><label class="collapse" for="c-41662753">[-]</label><label class="expand" for="c-41662753">[6 more]</label></div><br/><div class="children"><div class="content">Link to the OP for those that haven&#x27;t seen it: <a href="https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1838169889330135132" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1838169889330135132</a><p>Hyped it up to be some massive thing but it turned out to be a massive nothingbuger for me at least</div><br/><div id="41662958" class="c"><input type="checkbox" id="c-41662958" checked=""/><div class="controls bullet"><span class="by">maeln</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662753">parent</a><span>|</span><a href="#41662804">next</a><span>|</span><label class="collapse" for="c-41662958">[-]</label><label class="expand" for="c-41662958">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s always funny to me how cybersecurity always seem to attract people with a ... certain sense of ego.</div><br/><div id="41663916" class="c"><input type="checkbox" id="c-41663916" checked=""/><div class="controls bullet"><span class="by">ChocolateGod</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662958">parent</a><span>|</span><a href="#41666402">next</a><span>|</span><label class="collapse" for="c-41663916">[-]</label><label class="expand" for="c-41663916">[2 more]</label></div><br/><div class="children"><div class="content">&gt; pretty much only got patronized because the devs just can&#x27;t accept that their code is crap - responsible disclosure: no more.<p>I can think of another reason they got patronised.</div><br/></div></div><div id="41666402" class="c"><input type="checkbox" id="c-41666402" checked=""/><div class="controls bullet"><span class="by">evilos</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662958">parent</a><span>|</span><a href="#41663916">prev</a><span>|</span><a href="#41662804">next</a><span>|</span><label class="collapse" for="c-41666402">[-]</label><label class="expand" for="c-41666402">[1 more]</label></div><br/><div class="children"><div class="content">They claim to not be a cybersecurity pro</div><br/></div></div></div></div><div id="41662804" class="c"><input type="checkbox" id="c-41662804" checked=""/><div class="controls bullet"><span class="by">RGBCube</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662753">parent</a><span>|</span><a href="#41662958">prev</a><span>|</span><a href="#41662789">next</a><span>|</span><label class="collapse" for="c-41662804">[-]</label><label class="expand" for="c-41662804">[1 more]</label></div><br/><div class="children"><div class="content">Non-loginwalled link: <a href="https:&#x2F;&#x2F;threadreaderapp.com&#x2F;thread&#x2F;1838169889330135132.html" rel="nofollow">https:&#x2F;&#x2F;threadreaderapp.com&#x2F;thread&#x2F;1838169889330135132.html</a></div><br/></div></div></div></div><div id="41662789" class="c"><input type="checkbox" id="c-41662789" checked=""/><div class="controls bullet"><span class="by">NavinF</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662689">parent</a><span>|</span><a href="#41662753">prev</a><span>|</span><a href="#41663134">next</a><span>|</span><label class="collapse" for="c-41662789">[-]</label><label class="expand" for="c-41662789">[6 more]</label></div><br/><div class="children"><div class="content">Yeah tbh it&#x27;s not as bad as he claimed. I doubt this is actually rated 9.9:<p>&gt;A remote unauthenticated attacker can silently replace existing printers’ (or install new ones) IPP urls with a malicious one, resulting in arbitrary command execution (on the computer) when a print job is started (from that computer).<p>&gt;WAN &#x2F; public internet: a remote attacker sends an UDP packet to port 631. No authentication whatsoever.<p>&gt;LAN: a local attacker can spoof zeroconf &#x2F; mDNS &#x2F; DNS-SD advertisements (we will talk more about this in the next writeup ) and achieve the same code path leading to RCE.<p>Still, sucks for linux desktop users. Looks like any random device on your wifi&#x2F;vpn can screw you over</div><br/><div id="41662808" class="c"><input type="checkbox" id="c-41662808" checked=""/><div class="controls bullet"><span class="by">floren</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662789">parent</a><span>|</span><a href="#41662839">next</a><span>|</span><label class="collapse" for="c-41662808">[-]</label><label class="expand" for="c-41662808">[3 more]</label></div><br/><div class="children"><div class="content">Or any malicious user on the airport wifi. The compromise will linger until however many weeks later when you decide to print something...</div><br/><div id="41663050" class="c"><input type="checkbox" id="c-41663050" checked=""/><div class="controls bullet"><span class="by">bremac</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662808">parent</a><span>|</span><a href="#41662839">next</a><span>|</span><label class="collapse" for="c-41663050">[-]</label><label class="expand" for="c-41663050">[2 more]</label></div><br/><div class="children"><div class="content">Keep in mind that you still need send a print job to the fake printer to trigger the exploit. If you send the job to your real printer, nothing happens.</div><br/><div id="41665702" class="c"><input type="checkbox" id="c-41665702" checked=""/><div class="controls bullet"><span class="by">crote</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41663050">parent</a><span>|</span><a href="#41662839">next</a><span>|</span><label class="collapse" for="c-41665702">[-]</label><label class="expand" for="c-41665702">[1 more]</label></div><br/><div class="children"><div class="content">The exploit allows an attacker to overwrite your real printer with their fake printer.</div><br/></div></div></div></div></div></div><div id="41662839" class="c"><input type="checkbox" id="c-41662839" checked=""/><div class="controls bullet"><span class="by">rolph</span><span>|</span><a href="#41662656">root</a><span>|</span><a href="#41662789">parent</a><span>|</span><a href="#41662808">prev</a><span>|</span><a href="#41662860">next</a><span>|</span><label class="collapse" for="c-41662839">[-]</label><label class="expand" for="c-41662839">[1 more]</label></div><br/><div class="children"><div class="content">i knew there was a reason i blacklist unsolicited&#x2F;unauthenticated UDP inbound.</div><br/></div></div></div></div></div></div></div></div><div id="41663062" class="c"><input type="checkbox" id="c-41663062" checked=""/><div class="controls bullet"><span class="by">DanMcInerney</span><span>|</span><a href="#41663134">prev</a><span>|</span><a href="#41663147">next</a><span>|</span><label class="collapse" for="c-41663062">[-]</label><label class="expand" for="c-41663062">[9 more]</label></div><br/><div class="children"><div class="content">Depending on your interpretation of the Scope metric in CVSSv3, this is either an 8.8 or a 9.6 CVSS to be more accurate.<p>In summary, there&#x27;s a service (CUPS) that is exposed to the LAN (0.0.0.0) on at least some desktop flavors of Linux and runs as root that is vulnerable to unauth RCE. CUPS is not a default service on most of the server-oriented linux machines like Ubuntu Server or CentOS, but does appear to start by default on most desktop flavors of linux. To trigger the RCE the user on the vulnerable linux machine must print a document after being exploited.<p>Evilsocket claims to have had 100&#x27;s of thousands of callbacks showing that despite the fact most of us have probably never printed anything from Linux, the impact is enough to create a large botnet regardless.</div><br/><div id="41663116" class="c"><input type="checkbox" id="c-41663116" checked=""/><div class="controls bullet"><span class="by">funcDropShadow</span><span>|</span><a href="#41663062">parent</a><span>|</span><a href="#41667316">next</a><span>|</span><label class="collapse" for="c-41663116">[-]</label><label class="expand" for="c-41663116">[7 more]</label></div><br/><div class="children"><div class="content">Universities are full of people with Linux desktops with public IPs and that are printing all the time: papers, their own and other&#x27;s.</div><br/><div id="41663212" class="c"><input type="checkbox" id="c-41663212" checked=""/><div class="controls bullet"><span class="by">DanMcInerney</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41663116">parent</a><span>|</span><a href="#41664288">next</a><span>|</span><label class="collapse" for="c-41663212">[-]</label><label class="expand" for="c-41663212">[2 more]</label></div><br/><div class="children"><div class="content">Yes, good point, university networks are particularly vulnerable.</div><br/><div id="41667194" class="c"><input type="checkbox" id="c-41667194" checked=""/><div class="controls bullet"><span class="by">creatonez</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41663212">parent</a><span>|</span><a href="#41664288">next</a><span>|</span><label class="collapse" for="c-41667194">[-]</label><label class="expand" for="c-41667194">[1 more]</label></div><br/><div class="children"><div class="content">Great opportunity to expand the Sci-Hub effort &#x2F;s</div><br/></div></div></div></div><div id="41664288" class="c"><input type="checkbox" id="c-41664288" checked=""/><div class="controls bullet"><span class="by">znpy</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41663116">parent</a><span>|</span><a href="#41663212">prev</a><span>|</span><a href="#41667316">next</a><span>|</span><label class="collapse" for="c-41664288">[-]</label><label class="expand" for="c-41664288">[4 more]</label></div><br/><div class="children"><div class="content">Having a public ip address doesn&#x27;t always mean there&#x27;s no firewall in between a pc and the public internet, ideally with sensible default rules. It&#x27;s not 1996.<p>And sorry if I&#x27;m being a bit harsh on this, but this point comes up every time when ipv6 is mentioned, by people that clearly don&#x27;t understand the above point.</div><br/><div id="41666659" class="c"><input type="checkbox" id="c-41666659" checked=""/><div class="controls bullet"><span class="by">lights0123</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41664288">parent</a><span>|</span><a href="#41666695">next</a><span>|</span><label class="collapse" for="c-41666659">[-]</label><label class="expand" for="c-41666659">[1 more]</label></div><br/><div class="children"><div class="content">Just to add a datapoint to the previous comment, my large public US university hands out public IPs to every device on WiFi. If there is a firewall, it doesn&#x27;t block 8080 or 22.</div><br/></div></div><div id="41666695" class="c"><input type="checkbox" id="c-41666695" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41664288">parent</a><span>|</span><a href="#41666659">prev</a><span>|</span><a href="#41667264">next</a><span>|</span><label class="collapse" for="c-41666695">[-]</label><label class="expand" for="c-41666695">[1 more]</label></div><br/><div class="children"><div class="content">The point is that, if printing works for those people, then we know they have this port open, at least on the university network. So even if it&#x27;s not exploitable over the internet, it&#x27;s definitely exploitable from the whole university network, which is almost as good as from the internet.</div><br/></div></div><div id="41667264" class="c"><input type="checkbox" id="c-41667264" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#41663062">root</a><span>|</span><a href="#41664288">parent</a><span>|</span><a href="#41666695">prev</a><span>|</span><a href="#41667316">next</a><span>|</span><label class="collapse" for="c-41667264">[-]</label><label class="expand" for="c-41667264">[1 more]</label></div><br/><div class="children"><div class="content">Yes. It&#x27;s rather sad that so many people equate NAT with a firewall. Two totally different things. A firewall is good, NAT is annoying. We need to push IPv6 harder.</div><br/></div></div></div></div></div></div><div id="41667316" class="c"><input type="checkbox" id="c-41667316" checked=""/><div class="controls bullet"><span class="by">mort96</span><span>|</span><a href="#41663062">parent</a><span>|</span><a href="#41663116">prev</a><span>|</span><a href="#41663147">next</a><span>|</span><label class="collapse" for="c-41667316">[-]</label><label class="expand" for="c-41667316">[1 more]</label></div><br/><div class="children"><div class="content">How can this be a 9.6 when heartbleed was a 7.5, how can it be just 0.4 below the xz thing</div><br/></div></div></div></div><div id="41663147" class="c"><input type="checkbox" id="c-41663147" checked=""/><div class="controls bullet"><span class="by">marcodiego</span><span>|</span><a href="#41663062">prev</a><span>|</span><a href="#41663109">next</a><span>|</span><label class="collapse" for="c-41663147">[-]</label><label class="expand" for="c-41663147">[4 more]</label></div><br/><div class="children"><div class="content">Resuming:<p><pre><code>  1 - cups-browsed is able to install printers automatically (without the requirement of user confirmation) by listening to UDP packets on port 631.
  2 - Attacker uses this &quot;feature&quot; to install a fake printer with a custom driver (which is also installed without user confirmation and can be downloaded from an arbitrary host) which specifies the &quot;command to run&quot; when a print job is sent.
  3 - User prints something in the fake printer and the &quot;command to run&quot; is executed.</code></pre></div><br/><div id="41663746" class="c"><input type="checkbox" id="c-41663746" checked=""/><div class="controls bullet"><span class="by">hypeatei</span><span>|</span><a href="#41663147">parent</a><span>|</span><a href="#41663109">next</a><span>|</span><label class="collapse" for="c-41663746">[-]</label><label class="expand" for="c-41663746">[3 more]</label></div><br/><div class="children"><div class="content">&gt; without the requirement of user confirmation<p>I suppose CUPS was introduced in 1999 so it probably made sense then. But why is it still a thing today?</div><br/><div id="41664202" class="c"><input type="checkbox" id="c-41664202" checked=""/><div class="controls bullet"><span class="by">znpy</span><span>|</span><a href="#41663147">root</a><span>|</span><a href="#41663746">parent</a><span>|</span><a href="#41663109">next</a><span>|</span><label class="collapse" for="c-41664202">[-]</label><label class="expand" for="c-41664202">[2 more]</label></div><br/><div class="children"><div class="content">I would rather expect this kind of change came later, when there has been a huge push to make the &quot;linux desktop&quot; more user-friendly.<p>1999 sounds like the time when people were a bit more expected to mess with config file and somehow always had a root terminal around. If anything, keep in mind that in 1999 it was still a rite of passage to have to learn how to write the X11 configuration file (what used to be xorg.conf)</div><br/><div id="41667468" class="c"><input type="checkbox" id="c-41667468" checked=""/><div class="controls bullet"><span class="by">a96</span><span>|</span><a href="#41663147">root</a><span>|</span><a href="#41664202">parent</a><span>|</span><a href="#41663109">next</a><span>|</span><label class="collapse" for="c-41667468">[-]</label><label class="expand" for="c-41667468">[1 more]</label></div><br/><div class="children"><div class="content">Used to be XF86Config (even on non-*86). Xorg came in something like 2005. These things are really pretty young still.</div><br/></div></div></div></div></div></div></div></div><div id="41663109" class="c"><input type="checkbox" id="c-41663109" checked=""/><div class="controls bullet"><span class="by">ruuda</span><span>|</span><a href="#41663147">prev</a><span>|</span><a href="#41667680">next</a><span>|</span><label class="collapse" for="c-41663109">[-]</label><label class="expand" for="c-41663109">[2 more]</label></div><br/><div class="children"><div class="content">&gt; That a lot is expected and taken for granted from the security researchers by triagers that behave like you have to “prove to be worth listening to” while in reality they barely care to process and understand what you are saying<p>The unfortunate reality is that for every well-researched report like this one, you get 57 low-effort spam reports that hope to extract a bug bounty reward, or get a CVE discovery listed on their resume. Especially with the rise of LLMs that kind of spam can easily trick you. It&#x27;s a sad situation, but I don&#x27;t entirely blame developers for being skeptic.</div><br/><div id="41663911" class="c"><input type="checkbox" id="c-41663911" checked=""/><div class="controls bullet"><span class="by">hypeatei</span><span>|</span><a href="#41663109">parent</a><span>|</span><a href="#41667680">next</a><span>|</span><label class="collapse" for="c-41663911">[-]</label><label class="expand" for="c-41663911">[1 more]</label></div><br/><div class="children"><div class="content">curl developers deal with this exact thing[0] (AI generated security reports)<p>0: <a href="https:&#x2F;&#x2F;daniel.haxx.se&#x2F;blog&#x2F;2024&#x2F;01&#x2F;02&#x2F;the-i-in-llm-stands-for-intelligence&#x2F;" rel="nofollow">https:&#x2F;&#x2F;daniel.haxx.se&#x2F;blog&#x2F;2024&#x2F;01&#x2F;02&#x2F;the-i-in-llm-stands-f...</a></div><br/></div></div></div></div><div id="41667680" class="c"><input type="checkbox" id="c-41667680" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#41663109">prev</a><span>|</span><a href="#41664791">next</a><span>|</span><label class="collapse" for="c-41667680">[-]</label><label class="expand" for="c-41667680">[2 more]</label></div><br/><div class="children"><div class="content">There used to be a timeframe (before like 2020) where you could use network printers without any extra software: Open your Document in Firefox, print to postscript, and then netcat that postscript to your network printer port 9100. This is the &quot;AppSocket&quot; protocol.<p>Unfortunately, Firefox removed that feature, and port 9100 is now clobbered by the Prometheus node exporter. If you accidentally add a AppSocket capable printer to Prometheus it will print out HTTP headers every other minute.<p>The good times are over, but on the other side, having to print something has gotten quite rare.</div><br/><div id="41667872" class="c"><input type="checkbox" id="c-41667872" checked=""/><div class="controls bullet"><span class="by">akvadrako</span><span>|</span><a href="#41667680">parent</a><span>|</span><a href="#41664791">next</a><span>|</span><label class="collapse" for="c-41667872">[-]</label><label class="expand" for="c-41667872">[1 more]</label></div><br/><div class="children"><div class="content">Now we have something better, IPP everywhere. The protocol isn&#x27;t as simple as netcating a postscript, but is simple enough, standardized and does everything expected for printing.</div><br/></div></div></div></div><div id="41664791" class="c"><input type="checkbox" id="c-41664791" checked=""/><div class="controls bullet"><span class="by">farhanhubble</span><span>|</span><a href="#41667680">prev</a><span>|</span><a href="#41663014">next</a><span>|</span><label class="collapse" for="c-41664791">[-]</label><label class="expand" for="c-41664791">[1 more]</label></div><br/><div class="children"><div class="content">Irrespective of the severity assigned it&#x27;s a good and simple case study for any programmer, engineer or not, building drivers and low-level stuff or not. Alongside it, and the iconic &quot;Smashing the Stack for Fun and Profit&quot;, reading &quot;The Bugs We Need to Kill&quot;[1], makes a programmer much more aware that every program is prone to manipulation via its inputs.<p>[1]: <a href="https:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;files&#x2F;login&#x2F;articles&#x2F;login_aug15_02_bratus_0.pdf" rel="nofollow">https:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;files&#x2F;login&#x2F;articles&#x2F;login_aug...</a></div><br/></div></div><div id="41663014" class="c"><input type="checkbox" id="c-41663014" checked=""/><div class="controls bullet"><span class="by">dfc</span><span>|</span><a href="#41664791">prev</a><span>|</span><a href="#41662748">next</a><span>|</span><label class="collapse" for="c-41663014">[-]</label><label class="expand" for="c-41663014">[11 more]</label></div><br/><div class="children"><div class="content">The original CVSS score on Twitter indicated that user interaction was not required. However reading the RCE chain on the page says:<p><i>Wait for a print job to be sent to our fake printer for the PPD directives, and therefore the command, to be executed.</i><p>If Alice never hits print it seems like a print job will never be triggered. Am I missing something? I&#x27;m not questioning evilsocket, I&#x27;m trying to check my understanding.</div><br/><div id="41663164" class="c"><input type="checkbox" id="c-41663164" checked=""/><div class="controls bullet"><span class="by">rini17</span><span>|</span><a href="#41663014">parent</a><span>|</span><a href="#41663180">next</a><span>|</span><label class="collapse" for="c-41663164">[-]</label><label class="expand" for="c-41663164">[2 more]</label></div><br/><div class="children"><div class="content">There are also buffer overflows which they detected with fuzzer, which can be turned into RCE without requiring user interaction. But author did not have enough expertise in this area to create actual exploit for these.</div><br/><div id="41663549" class="c"><input type="checkbox" id="c-41663549" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663164">parent</a><span>|</span><a href="#41663180">next</a><span>|</span><label class="collapse" for="c-41663549">[-]</label><label class="expand" for="c-41663549">[1 more]</label></div><br/><div class="children"><div class="content">It is untrue that every buffer overflow can be exploited. We won&#x27;t know whether these can be until someone tries.</div><br/></div></div></div></div><div id="41663180" class="c"><input type="checkbox" id="c-41663180" checked=""/><div class="controls bullet"><span class="by">playingalong</span><span>|</span><a href="#41663014">parent</a><span>|</span><a href="#41663164">prev</a><span>|</span><a href="#41662748">next</a><span>|</span><label class="collapse" for="c-41663180">[-]</label><label class="expand" for="c-41663180">[8 more]</label></div><br/><div class="children"><div class="content">It depends on the definition of &quot;interaction&quot;. AFAIU Alice doesn&#x27;t need to print anything supplied by the attacker. It&#x27;s enough if she prints anything.</div><br/><div id="41663405" class="c"><input type="checkbox" id="c-41663405" checked=""/><div class="controls bullet"><span class="by">dfc</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663180">parent</a><span>|</span><a href="#41663520">next</a><span>|</span><label class="collapse" for="c-41663405">[-]</label><label class="expand" for="c-41663405">[2 more]</label></div><br/><div class="children"><div class="content">I agree that Alice just needs to print anything but that seems like user interaction required. Its also not clear if Alice has multiple printers defined does it matter which printer she selects?</div><br/><div id="41666729" class="c"><input type="checkbox" id="c-41666729" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663405">parent</a><span>|</span><a href="#41663520">next</a><span>|</span><label class="collapse" for="c-41666729">[-]</label><label class="expand" for="c-41666729">[1 more]</label></div><br/><div class="children"><div class="content">The attacker can replace any and all printers, so not entirely. I&#x27;m not sure how the UI part of CVSS is specifically defined, but I think it&#x27;s at least somewhat fair to call something the user is expected to do unrelated to the attack in any way &quot;no interaction&quot;. Otherwise, it&#x27;s like saying &quot;the user has to power on their device and turn on their Wi-Fi for the attack to work, so it requires user interaction&quot;.</div><br/></div></div></div></div><div id="41663520" class="c"><input type="checkbox" id="c-41663520" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663180">parent</a><span>|</span><a href="#41663405">prev</a><span>|</span><a href="#41662748">next</a><span>|</span><label class="collapse" for="c-41663520">[-]</label><label class="expand" for="c-41663520">[5 more]</label></div><br/><div class="children"><div class="content">She needs to print something using the fake printer. Nothing happens, IIUC, if Alice chooses to print a document with a real printer.</div><br/><div id="41663558" class="c"><input type="checkbox" id="c-41663558" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663520">parent</a><span>|</span><a href="#41663909">next</a><span>|</span><label class="collapse" for="c-41663558">[-]</label><label class="expand" for="c-41663558">[3 more]</label></div><br/><div class="children"><div class="content">The attack can overwrite the real printer with a fake one.</div><br/><div id="41663804" class="c"><input type="checkbox" id="c-41663804" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663558">parent</a><span>|</span><a href="#41663909">next</a><span>|</span><label class="collapse" for="c-41663804">[-]</label><label class="expand" for="c-41663804">[2 more]</label></div><br/><div class="children"><div class="content">Where did you see that?</div><br/><div id="41664305" class="c"><input type="checkbox" id="c-41664305" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663804">parent</a><span>|</span><a href="#41663909">next</a><span>|</span><label class="collapse" for="c-41664305">[-]</label><label class="expand" for="c-41664305">[1 more]</label></div><br/><div class="children"><div class="content">Ctrl+F &quot;replace&quot;</div><br/></div></div></div></div></div></div><div id="41663909" class="c"><input type="checkbox" id="c-41663909" checked=""/><div class="controls bullet"><span class="by">djordanzachvsd</span><span>|</span><a href="#41663014">root</a><span>|</span><a href="#41663520">parent</a><span>|</span><a href="#41663558">prev</a><span>|</span><a href="#41662748">next</a><span>|</span><label class="collapse" for="c-41663909">[-]</label><label class="expand" for="c-41663909">[1 more]</label></div><br/><div class="children"><div class="content">in the middle of the alley</div><br/></div></div></div></div></div></div></div></div><div id="41662748" class="c"><input type="checkbox" id="c-41662748" checked=""/><div class="controls bullet"><span class="by">bborud</span><span>|</span><a href="#41663014">prev</a><span>|</span><a href="#41665158">next</a><span>|</span><label class="collapse" for="c-41662748">[-]</label><label class="expand" for="c-41662748">[17 more]</label></div><br/><div class="children"><div class="content">Every time I need to print something on MacOS I am reminded of how much I hate printers and any printer related software.  I&#x27;ve been messing around with computers for 40 years now and goddamnit, every decade printers become more of a pain in the neck.</div><br/><div id="41662900" class="c"><input type="checkbox" id="c-41662900" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41662805">next</a><span>|</span><label class="collapse" for="c-41662900">[-]</label><label class="expand" for="c-41662900">[2 more]</label></div><br/><div class="children"><div class="content">Funny how the whole FSF movement started in no small part because Stallman was irritated with the low quality of printer drivers... and how that movement for some (?) reason failed, in 40 years, to noticeably improve the quality of printer-related software.</div><br/><div id="41663198" class="c"><input type="checkbox" id="c-41663198" checked=""/><div class="controls bullet"><span class="by">playingalong</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662900">parent</a><span>|</span><a href="#41662805">next</a><span>|</span><label class="collapse" for="c-41663198">[-]</label><label class="expand" for="c-41663198">[1 more]</label></div><br/><div class="children"><div class="content">But at least we got all the byproducts.</div><br/></div></div></div></div><div id="41662805" class="c"><input type="checkbox" id="c-41662805" checked=""/><div class="controls bullet"><span class="by">linuxlizard</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41662900">prev</a><span>|</span><a href="#41665504">next</a><span>|</span><label class="collapse" for="c-41662805">[-]</label><label class="expand" for="c-41662805">[7 more]</label></div><br/><div class="children"><div class="content">I wrote printer code for 10+ years. I appreciate how hard the technical problems are but vendors make it so much worse. I loathe printers. Printers peaked with the LaserJet III.</div><br/><div id="41665495" class="c"><input type="checkbox" id="c-41665495" checked=""/><div class="controls bullet"><span class="by">sliken</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662805">parent</a><span>|</span><a href="#41663375">next</a><span>|</span><label class="collapse" for="c-41665495">[-]</label><label class="expand" for="c-41665495">[1 more]</label></div><br/><div class="children"><div class="content">Agreed, I ran several busy printers for a large department.  The ljet IIIs were work houses and ran nearly forever if you used the recommended part replacement schedule.<p>We had a ljet III that outlasted ljet 4, ljet 5, and ljet 4000.  Ljet 3 was the last with the HP print engine, afterwards they used Canon print engines.<p>The network interface was brittle, even a nmap would hang the printer.  So we firewalled it off and used CUPS to handle postscript -&gt; PCL.  Sending only PCL to the printer (postscript memory and CPU is unbounded) made them faster and <i>MUCH</i> more reliable.</div><br/></div></div><div id="41663375" class="c"><input type="checkbox" id="c-41663375" checked=""/><div class="controls bullet"><span class="by">gruturo</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662805">parent</a><span>|</span><a href="#41665495">prev</a><span>|</span><a href="#41667549">next</a><span>|</span><label class="collapse" for="c-41663375">[-]</label><label class="expand" for="c-41663375">[1 more]</label></div><br/><div class="children"><div class="content">IIRC the Laserjet 4 had a much better warm-up time (and lower power consumption) by switching to a thin ceramic heating element rather than heating half the printer. But yeah anything after that is downhill.</div><br/></div></div><div id="41667549" class="c"><input type="checkbox" id="c-41667549" checked=""/><div class="controls bullet"><span class="by">bborud</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662805">parent</a><span>|</span><a href="#41663375">prev</a><span>|</span><a href="#41663392">next</a><span>|</span><label class="collapse" for="c-41667549">[-]</label><label class="expand" for="c-41667549">[1 more]</label></div><br/><div class="children"><div class="content">It would be helpful to understand exactly which layers in the stack you think of as technically difficult.</div><br/></div></div><div id="41663392" class="c"><input type="checkbox" id="c-41663392" checked=""/><div class="controls bullet"><span class="by">niwtsol</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662805">parent</a><span>|</span><a href="#41667549">prev</a><span>|</span><a href="#41665504">next</a><span>|</span><label class="collapse" for="c-41663392">[-]</label><label class="expand" for="c-41663392">[3 more]</label></div><br/><div class="children"><div class="content">do you mind lightly summarizing what technical problems make it more difficult? I&#x27;m assuming there are all sorts of things web-devs never even think about from that world.</div><br/><div id="41665515" class="c"><input type="checkbox" id="c-41665515" checked=""/><div class="controls bullet"><span class="by">sliken</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41663392">parent</a><span>|</span><a href="#41663910">next</a><span>|</span><label class="collapse" for="c-41665515">[-]</label><label class="expand" for="c-41665515">[1 more]</label></div><br/><div class="children"><div class="content">Poor status, often a 1 line LCD says &quot;processing...&quot; and hangs infinitely.<p>Different handling of duplex, monitoring ink levels, file formats (PS? EPS?  PNG? PCL?  Which versions? Etc).<p>Issues with ink that expire by date, reduced functionality with 3rd party inks, not being able to print black even when only yellow is out of ink.<p>Different postscript versions and the nature of a language where CPU and memory use is unbounded means you get a nightmare of which files can print to which printers.<p>Most of our printer nightmares, at least the software issues, ended when we handled postscript -&gt; PCL (a raster based format) on the server side.</div><br/></div></div><div id="41663910" class="c"><input type="checkbox" id="c-41663910" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41663392">parent</a><span>|</span><a href="#41665515">prev</a><span>|</span><a href="#41665504">next</a><span>|</span><label class="collapse" for="c-41663910">[-]</label><label class="expand" for="c-41663910">[1 more]</label></div><br/><div class="children"><div class="content">Every printer vendor does things differently, every printer has different constraints and options?  Too many standards?</div><br/></div></div></div></div></div></div><div id="41665504" class="c"><input type="checkbox" id="c-41665504" checked=""/><div class="controls bullet"><span class="by">pushupentry1219</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41662805">prev</a><span>|</span><a href="#41662899">next</a><span>|</span><label class="collapse" for="c-41665504">[-]</label><label class="expand" for="c-41665504">[1 more]</label></div><br/><div class="children"><div class="content">You lose job control, but I&#x27;ve just done a netcat to a port on my printer with my document converted to PostScript and it works fine<p>pdf2ps &lt;doc&gt; - | nc &lt;printer&gt; 9001</div><br/></div></div><div id="41662899" class="c"><input type="checkbox" id="c-41662899" checked=""/><div class="controls bullet"><span class="by">op00to</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41665504">prev</a><span>|</span><a href="#41666440">next</a><span>|</span><label class="collapse" for="c-41662899">[-]</label><label class="expand" for="c-41662899">[3 more]</label></div><br/><div class="children"><div class="content">I feel like printers are far better now than they were 10 years ago. At least on MacOS and iOS, I have no problems finding a printer and printing. 10 years ago it was a pain, but now - smooth sailing for me. Heck, no driver installs either!</div><br/><div id="41662925" class="c"><input type="checkbox" id="c-41662925" checked=""/><div class="controls bullet"><span class="by">cp9</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662899">parent</a><span>|</span><a href="#41666440">next</a><span>|</span><label class="collapse" for="c-41662925">[-]</label><label class="expand" for="c-41662925">[2 more]</label></div><br/><div class="children"><div class="content">printing even works on linux now, thanks to stuff like Airprint and the support for it in CUPS</div><br/><div id="41663662" class="c"><input type="checkbox" id="c-41663662" checked=""/><div class="controls bullet"><span class="by">Jach</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41662925">parent</a><span>|</span><a href="#41666440">next</a><span>|</span><label class="collapse" for="c-41663662">[-]</label><label class="expand" for="c-41663662">[1 more]</label></div><br/><div class="children"><div class="content">Yeah something like 10-15 years ago I thought for just the simple action of printing a file, it was way easier in Ubuntu than Windows, simply because they included a lot of drivers in the distro by default, while in Windows land I still had to visit the printer manufacturer&#x27;s website for drivers -- or use the included CD! I try to avoid needing to do anything more complex than that. (Scanning I&#x27;ve always done with a USB stick plugged directly into the printer.) Things kind of got worse again in recent years with the removal of the standalone GUI for administration in favor of a web interface, and various ongoing modularization efforts, in theory cups3 will work even better and only support IPP&#x2F;AirPrint: <a href="https:&#x2F;&#x2F;openprinting.github.io&#x2F;current&#x2F;#the-new-architecture-for-printing-and-scanning" rel="nofollow">https:&#x2F;&#x2F;openprinting.github.io&#x2F;current&#x2F;#the-new-architecture...</a></div><br/></div></div></div></div></div></div><div id="41666440" class="c"><input type="checkbox" id="c-41666440" checked=""/><div class="controls bullet"><span class="by">trickstra</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41662899">prev</a><span>|</span><a href="#41663890">next</a><span>|</span><label class="collapse" for="c-41666440">[-]</label><label class="expand" for="c-41666440">[1 more]</label></div><br/><div class="children"><div class="content">Just in: HP is adding AI into printer drivers (no joke: <a href="https:&#x2F;&#x2F;hardware.slashdot.org&#x2F;story&#x2F;24&#x2F;09&#x2F;27&#x2F;0030239&#x2F;hp-is-adding-ai-to-its-printers" rel="nofollow">https:&#x2F;&#x2F;hardware.slashdot.org&#x2F;story&#x2F;24&#x2F;09&#x2F;27&#x2F;0030239&#x2F;hp-is-a...</a>)</div><br/></div></div><div id="41663890" class="c"><input type="checkbox" id="c-41663890" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#41662748">parent</a><span>|</span><a href="#41666440">prev</a><span>|</span><a href="#41665158">next</a><span>|</span><label class="collapse" for="c-41663890">[-]</label><label class="expand" for="c-41663890">[2 more]</label></div><br/><div class="children"><div class="content">Do you remember those portable sh-coded HP JetAdmin printer drivers?  Are you saying things today are worse than that?</div><br/><div id="41665524" class="c"><input type="checkbox" id="c-41665524" checked=""/><div class="controls bullet"><span class="by">sliken</span><span>|</span><a href="#41662748">root</a><span>|</span><a href="#41663890">parent</a><span>|</span><a href="#41665158">next</a><span>|</span><label class="collapse" for="c-41665524">[-]</label><label class="expand" for="c-41665524">[1 more]</label></div><br/><div class="children"><div class="content">Heh, I&#x27;ve heard complaints about multi GB driver installs on windows, sounds worse to me.</div><br/></div></div></div></div></div></div><div id="41665158" class="c"><input type="checkbox" id="c-41665158" checked=""/><div class="controls bullet"><span class="by">ruthmarx</span><span>|</span><a href="#41662748">prev</a><span>|</span><a href="#41662760">next</a><span>|</span><label class="collapse" for="c-41665158">[-]</label><label class="expand" for="c-41665158">[4 more]</label></div><br/><div class="children"><div class="content">This is a ridiculously over hyped vulnerability, the most over-hyped I&#x27;ve seen in a <i>long</i> time.<p>Still, kudos to the author who found it, it&#x27;s going to definitely be a career boost with all the world is ending headlines.</div><br/><div id="41667126" class="c"><input type="checkbox" id="c-41667126" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41665158">parent</a><span>|</span><a href="#41667115">next</a><span>|</span><label class="collapse" for="c-41667126">[-]</label><label class="expand" for="c-41667126">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s probably somewhat overhyped, but it&#x27;s still a really really bad vulnerability for virtually all Linux desktops, even as presented. It&#x27;s a persistent compromise of your printing system that can happen to your default Linux installation by just connecting to the same wifi&#x2F;LAN as an attacker, and triggered at any point later when you print something.<p>And it&#x27;s very likely that someone will find a way to exploit it with a buffer overflow without even having to wait for the user to print something.</div><br/></div></div><div id="41667115" class="c"><input type="checkbox" id="c-41667115" checked=""/><div class="controls bullet"><span class="by">dottedmag</span><span>|</span><a href="#41665158">parent</a><span>|</span><a href="#41667126">prev</a><span>|</span><a href="#41662760">next</a><span>|</span><label class="collapse" for="c-41667115">[-]</label><label class="expand" for="c-41667115">[2 more]</label></div><br/><div class="children"><div class="content">Will it? The author goes to my «do not hire &#x2F; hype-eater» list for sure.</div><br/><div id="41667670" class="c"><input type="checkbox" id="c-41667670" checked=""/><div class="controls bullet"><span class="by">bbarnett</span><span>|</span><a href="#41665158">root</a><span>|</span><a href="#41667115">parent</a><span>|</span><a href="#41662760">next</a><span>|</span><label class="collapse" for="c-41667670">[-]</label><label class="expand" for="c-41667670">[1 more]</label></div><br/><div class="children"><div class="content">Same here.  I don&#x27;t need people overstating issues working for me.  I&#x27;d never be able to trust anything this person says, in terms of priority.<p>Literally making things up, screaming his head off, crying wolf, &quot;all linux systems&quot; my ass.  A horrible person.<p>You know some people actually take security seriously?  Not this guy.  It&#x27;s all a personal hype vector.</div><br/></div></div></div></div></div></div><div id="41662760" class="c"><input type="checkbox" id="c-41662760" checked=""/><div class="controls bullet"><span class="by">spookie</span><span>|</span><a href="#41665158">prev</a><span>|</span><a href="#41662787">next</a><span>|</span><label class="collapse" for="c-41662760">[-]</label><label class="expand" for="c-41662760">[14 more]</label></div><br/><div class="children"><div class="content">Of course its CUPS.<p>Saying it affects all &quot;Linux&quot; systems is just wild.<p>Imagine even having that thing on your system to begin with.</div><br/><div id="41663507" class="c"><input type="checkbox" id="c-41663507" checked=""/><div class="controls bullet"><span class="by">Jach</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41663009">next</a><span>|</span><label class="collapse" for="c-41663507">[-]</label><label class="expand" for="c-41663507">[1 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t imagine it on a normal server expected to serve public internet requests. The way you phrased that though makes me wonder for desktop use, is there a non-cups alternative to printing on linux these days that&#x27;s gone under my radar? (Please don&#x27;t say there&#x27;s a systemd-print...) If nothing else, probably another overdue candidate for the energetic rewrite-it-in-Rust people.</div><br/></div></div><div id="41663009" class="c"><input type="checkbox" id="c-41663009" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41663507">prev</a><span>|</span><a href="#41667280">next</a><span>|</span><label class="collapse" for="c-41663009">[-]</label><label class="expand" for="c-41663009">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m more interested in whether some&#x2F;all of these work on macOS, which is probably a bigger target.</div><br/><div id="41664645" class="c"><input type="checkbox" id="c-41664645" checked=""/><div class="controls bullet"><span class="by">jkaplowitz</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41663009">parent</a><span>|</span><a href="#41663339">next</a><span>|</span><label class="collapse" for="c-41664645">[-]</label><label class="expand" for="c-41664645">[1 more]</label></div><br/><div class="children"><div class="content">OP has promised to discuss macOS in part 2 of this blog post series. So sounds like the answer is yes.</div><br/></div></div><div id="41663339" class="c"><input type="checkbox" id="c-41663339" checked=""/><div class="controls bullet"><span class="by">Tiberium</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41663009">parent</a><span>|</span><a href="#41664645">prev</a><span>|</span><a href="#41667280">next</a><span>|</span><label class="collapse" for="c-41663339">[-]</label><label class="expand" for="c-41663339">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;OpenPrinting&#x2F;cups-browsed&#x2F;issues&#x2F;36#issuecomment-2377599545">https:&#x2F;&#x2F;github.com&#x2F;OpenPrinting&#x2F;cups-browsed&#x2F;issues&#x2F;36#issue...</a> makes it sounds like most of them don&#x27;t, and even if they do, it&#x27;s sandboxed.</div><br/><div id="41664416" class="c"><input type="checkbox" id="c-41664416" checked=""/><div class="controls bullet"><span class="by">outworlder</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41663339">parent</a><span>|</span><a href="#41667280">next</a><span>|</span><label class="collapse" for="c-41664416">[-]</label><label class="expand" for="c-41664416">[1 more]</label></div><br/><div class="children"><div class="content">There may be something else for that.<p>&gt; In part II of this series (date TBD since there’s another disclosure in process), we’ll see how to use these new bettercap modules (not yet released) to attack Apple macOS.</div><br/></div></div></div></div></div></div><div id="41667280" class="c"><input type="checkbox" id="c-41667280" checked=""/><div class="controls bullet"><span class="by">EasyMark</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41663009">prev</a><span>|</span><a href="#41665536">next</a><span>|</span><label class="collapse" for="c-41667280">[-]</label><label class="expand" for="c-41667280">[2 more]</label></div><br/><div class="children"><div class="content">What’s wrong with having CUPS on your system if you actually use a printer? I’m kind of lost as the source of the “imagine”?</div><br/><div id="41667878" class="c"><input type="checkbox" id="c-41667878" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41667280">parent</a><span>|</span><a href="#41665536">next</a><span>|</span><label class="collapse" for="c-41667878">[-]</label><label class="expand" for="c-41667878">[1 more]</label></div><br/><div class="children"><div class="content">[delayed]</div><br/></div></div></div></div><div id="41665536" class="c"><input type="checkbox" id="c-41665536" checked=""/><div class="controls bullet"><span class="by">wannacboatmovie</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41667280">prev</a><span>|</span><a href="#41666281">next</a><span>|</span><label class="collapse" for="c-41665536">[-]</label><label class="expand" for="c-41665536">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Imagine even having that thing on your system to begin with<p>Well it is the <i>Common</i> UNIX printing system...<p>If it was the Not-oft-used Printing System I could understand.</div><br/></div></div><div id="41666281" class="c"><input type="checkbox" id="c-41666281" checked=""/><div class="controls bullet"><span class="by">wakawaka28</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41665536">prev</a><span>|</span><a href="#41662867">next</a><span>|</span><label class="collapse" for="c-41666281">[-]</label><label class="expand" for="c-41666281">[1 more]</label></div><br/><div class="children"><div class="content">What would you use instead?</div><br/></div></div><div id="41662867" class="c"><input type="checkbox" id="c-41662867" checked=""/><div class="controls bullet"><span class="by">doubled112</span><span>|</span><a href="#41662760">parent</a><span>|</span><a href="#41666281">prev</a><span>|</span><a href="#41662787">next</a><span>|</span><label class="collapse" for="c-41662867">[-]</label><label class="expand" for="c-41662867">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m certainly not regretting disabling avahi and cups-browsed on all of my systems long ago.<p>Do people have printers that move around all the time?<p>Also, firewalls on desktops and laptops for the win, yet again.</div><br/><div id="41663407" class="c"><input type="checkbox" id="c-41663407" checked=""/><div class="controls bullet"><span class="by">robinsonb5</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41662867">parent</a><span>|</span><a href="#41662787">next</a><span>|</span><label class="collapse" for="c-41663407">[-]</label><label class="expand" for="c-41663407">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Do people have printers that move around all the time?<p>I suspect it&#x27;s not the printers that are moving, but the laptops.</div><br/><div id="41664084" class="c"><input type="checkbox" id="c-41664084" checked=""/><div class="controls bullet"><span class="by">doubled112</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41663407">parent</a><span>|</span><a href="#41662787">next</a><span>|</span><label class="collapse" for="c-41664084">[-]</label><label class="expand" for="c-41664084">[2 more]</label></div><br/><div class="children"><div class="content">Fair, but do people print away from home very often?  I’ve never printed anything outside of home since high school, but maybe I’m an outlier.<p>Maybe a better question, would intentionally adding a printer at home and a printer at the office be that large a barrier?<p>Maybe we wouldn&#x27;t even need to drop auto discovery. Maybe it could work more like Bluetooth and only broadcast or accept connections while it was actively searching.</div><br/><div id="41665057" class="c"><input type="checkbox" id="c-41665057" checked=""/><div class="controls bullet"><span class="by">kayodelycaon</span><span>|</span><a href="#41662760">root</a><span>|</span><a href="#41664084">parent</a><span>|</span><a href="#41662787">next</a><span>|</span><label class="collapse" for="c-41665057">[-]</label><label class="expand" for="c-41665057">[1 more]</label></div><br/><div class="children"><div class="content">If you mean use someone else’s printer, I do it occasionally. Usually TTRPG character sheets. I am so happy AirPrint is common now. Makes my life easier.<p>If you mean send something from outside of my house to my house, I’ve done using a vpn.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41662787" class="c"><input type="checkbox" id="c-41662787" checked=""/><div class="controls bullet"><span class="by">sprayk</span><span>|</span><a href="#41662760">prev</a><span>|</span><a href="#41663670">next</a><span>|</span><label class="collapse" for="c-41662787">[-]</label><label class="expand" for="c-41662787">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I had no idea Linux just added anything found on a network before the user can even accept or be notified. The more you know!<p>Windows does this too, I believe. At least it did it with a Xerox laser printer I bought and the Brother printer at my friend&#x27;s place.</div><br/><div id="41667153" class="c"><input type="checkbox" id="c-41667153" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662787">parent</a><span>|</span><a href="#41663670">next</a><span>|</span><label class="collapse" for="c-41667153">[-]</label><label class="expand" for="c-41667153">[1 more]</label></div><br/><div class="children"><div class="content">Windows does have a significant mitigation: whenever you connect to a new network, such as a coffee shop Wi-Fi, it defaults to considering this network Public (untrusted) and firewalls any such services from accessing it&#x2F;being accessed from it. You have to explicitly set it as a &quot;Private&quot; network for file sharing and printer discovery and similar to work.</div><br/></div></div></div></div><div id="41663670" class="c"><input type="checkbox" id="c-41663670" checked=""/><div class="controls bullet"><span class="by">cvhc</span><span>|</span><a href="#41662787">prev</a><span>|</span><a href="#41664405">next</a><span>|</span><label class="collapse" for="c-41663670">[-]</label><label class="expand" for="c-41663670">[1 more]</label></div><br/><div class="children"><div class="content">While in this case distros include cups-browsed maybe as a feature, I always feel it&#x27;s a bad thing Ubuntu&#x2F;Debian (and maybe all deb-based distros?) automatically bring up almost all services upon installation. This means you can install a package and accidentially open another network service that&#x27;s installed as a dependency.<p>You probably already know exim4 (to be fair it listens to only localhost by default, so maybe not a big deal). I just tried to install cups-browsed on one of my Debian machine, and it brought up two services that listens to 0.0.0.0 (cups-browsed and avahi).<p>This is not the case for Arch&#x2F;Gentoo and CentOS-like distros.</div><br/></div></div><div id="41664405" class="c"><input type="checkbox" id="c-41664405" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#41663670">prev</a><span>|</span><a href="#41662735">next</a><span>|</span><label class="collapse" for="c-41664405">[-]</label><label class="expand" for="c-41664405">[1 more]</label></div><br/><div class="children"><div class="content">Tried it out, looks like at least on Debian the filter gets invoked with limited user privileges, so not world-ending, but still bad. And it does require user interaction, but my gut feeling is that this can be bypassed with some cleverness.<p>However, this is only for this particular exploit. The behaviour where cups-browsed automatically downloads and installs printers from random untrusted places on the internet is insane, especially as it does it for all printers it discovers on the local network by default. At minimum anyone on a LAN can cause a DoS type attack against all Linux workstations on the same LAN by just advertising a few million printers via zeroconf.</div><br/></div></div><div id="41662735" class="c"><input type="checkbox" id="c-41662735" checked=""/><div class="controls bullet"><span class="by">whywhywhywhy</span><span>|</span><a href="#41664405">prev</a><span>|</span><a href="#41662678">next</a><span>|</span><label class="collapse" for="c-41662735">[-]</label><label class="expand" for="c-41662735">[3 more]</label></div><br/><div class="children"><div class="content">From DEFCON 1 to “it’s absolutely nothing” in 5 hours</div><br/><div id="41665686" class="c"><input type="checkbox" id="c-41665686" checked=""/><div class="controls bullet"><span class="by">ugjka</span><span>|</span><a href="#41662735">parent</a><span>|</span><a href="#41662914">prev</a><span>|</span><a href="#41662678">next</a><span>|</span><label class="collapse" for="c-41665686">[-]</label><label class="expand" for="c-41665686">[1 more]</label></div><br/><div class="children"><div class="content">yeah i thought it was going to be something in tcp stack</div><br/></div></div></div></div><div id="41662678" class="c"><input type="checkbox" id="c-41662678" checked=""/><div class="controls bullet"><span class="by">scblock</span><span>|</span><a href="#41662735">prev</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41662678">[-]</label><label class="expand" for="c-41662678">[11 more]</label></div><br/><div class="children"><div class="content">This is a lot less &quot;exciting&quot; than the LOOK AT ME MOM I MADE AN EXPLOIT social media posts implied.</div><br/><div id="41667172" class="c"><input type="checkbox" id="c-41667172" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662678">parent</a><span>|</span><a href="#41662890">next</a><span>|</span><label class="collapse" for="c-41667172">[-]</label><label class="expand" for="c-41667172">[2 more]</label></div><br/><div class="children"><div class="content">Maybe less exciting, but still terrible for almost anyone running a Linux desktop&#x2F;laptop, especially those that expect it&#x27;s safer than a Windows desktop. And it&#x27;s a really bad look both for the developers of CUPS, and for most Linux distros, including RHEL, that just enabled this printer discovery backdoor by default without any mitigations in place.</div><br/><div id="41667482" class="c"><input type="checkbox" id="c-41667482" checked=""/><div class="controls bullet"><span class="by">gquere</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41667172">parent</a><span>|</span><a href="#41662890">next</a><span>|</span><label class="collapse" for="c-41667482">[-]</label><label class="expand" for="c-41667482">[1 more]</label></div><br/><div class="children"><div class="content">On RHEL it&#x27;s installed but it&#x27;s not enabled by default.</div><br/></div></div></div></div><div id="41662890" class="c"><input type="checkbox" id="c-41662890" checked=""/><div class="controls bullet"><span class="by">thinkingemote</span><span>|</span><a href="#41662678">parent</a><span>|</span><a href="#41667172">prev</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41662890">[-]</label><label class="expand" for="c-41662890">[8 more]</label></div><br/><div class="children"><div class="content">Possibly because the devs reduced the numbers he says: &quot;because the devs just can&#x27;t accept that their code is crap - responsible disclosure: no more&quot;<p>Always kind of worrying to see vulnerability researchers justifying bad behaviour because they find a vulnerability in code. Maybe it was because his pride was hurt that he threw away any ethical behaviour?</div><br/><div id="41664391" class="c"><input type="checkbox" id="c-41664391" checked=""/><div class="controls bullet"><span class="by">oskarkk</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41662890">parent</a><span>|</span><a href="#41663427">next</a><span>|</span><label class="collapse" for="c-41664391">[-]</label><label class="expand" for="c-41664391">[2 more]</label></div><br/><div class="children"><div class="content">Is that an exact quote? He says that he disclosed it now because there was a leak and &quot;all vendors that bothered participating agreed on today at 20:00 UTC&quot;.<p><a href="https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1839433162168181051" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1839433162168181051</a><p>Anyway, I don&#x27;t like his tone and he&#x27;s overreacting imo.</div><br/><div id="41664443" class="c"><input type="checkbox" id="c-41664443" checked=""/><div class="controls bullet"><span class="by">0x_rs</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41664391">parent</a><span>|</span><a href="#41663427">next</a><span>|</span><label class="collapse" for="c-41664443">[-]</label><label class="expand" for="c-41664443">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Is that an exact quote?<p>It is.<p><a href="https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1838169889330135132" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;evilsocket&#x2F;status&#x2F;1838169889330135132</a></div><br/></div></div></div></div><div id="41663427" class="c"><input type="checkbox" id="c-41663427" checked=""/><div class="controls bullet"><span class="by">Sohcahtoa82</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41662890">parent</a><span>|</span><a href="#41664391">prev</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41663427">[-]</label><label class="expand" for="c-41663427">[5 more]</label></div><br/><div class="children"><div class="content">&gt; vulnerability researchers justifying bad behaviour because they find a vulnerability in code<p>This is an extremely bad faith take that makes me irrationally angry to read.<p>He&#x27;s not using bad code as a reason to engage in bad behavior, he&#x27;s using <i>bad responses to responsible disclosure</i>.  Read the section under &quot;Personal Considerations&quot;.  It only took him two days to find the problem, but <i>22 days</i> to get developers to admit there&#x27;s a vulnerability, even when shown PoCs.<p>Imagine finding a vulnerability, responsibly disclosing it, being told &quot;meh, not an issue&quot;, responding with a PoC showing full code execution, and still being told &quot;meh, not an issue&quot;.</div><br/><div id="41663583" class="c"><input type="checkbox" id="c-41663583" checked=""/><div class="controls bullet"><span class="by">thinkingemote</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41663427">parent</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41663583">[-]</label><label class="expand" for="c-41663583">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Imagine finding a vulnerability, responsibly disclosing it, being told &quot;meh, not an issue&quot;, responding with a PoC showing full code execution, and still being told &quot;meh, not an issue&quot;.<p>I would still want to be responsible. I shouldn&#x27;t get to choose to be irresponsible when I have a bad experience. Then, naturally when the time is up and the disclosure happens according to the timetable, I would be the side looking much the better from it. As such behaving as he did and justifying it in that way is illogical.<p>I speculate that maybe the reasons he gave may not be entirely the whole story because he would have looked better responsibly disclosing, but its important to note that he doesn&#x27;t blame poor code, thank you for the correction. And I am speculating for the reasons. Maybe in the future I shouldn&#x27;t.</div><br/><div id="41663728" class="c"><input type="checkbox" id="c-41663728" checked=""/><div class="controls bullet"><span class="by">Sohcahtoa82</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41663583">parent</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41663728">[-]</label><label class="expand" for="c-41663728">[3 more]</label></div><br/><div class="children"><div class="content">Disagreeing with someone&#x27;s decisions is not a valid justification for misrepresenting their motives.<p>I agree with you, it&#x27;s kinda shitty, but I get where he&#x27;s coming from.  It&#x27;s incredibly frustrating to want to improve the security of the world, but when developers have too much ego and push back against claims of vulnerabilities in the face of <i>proof</i>, well...every hero either dies or lives long enough to become the villain.<p>I&#x27;ve experienced it first-hand at a previous job.  I found a buffer overflow in some firmware, and engineering just said &quot;Meh, at worst you&#x27;ll just segfault the device, and the user can just reboot&quot;.  The fix would have literally just been a two-line buffer length test that throws a 400 Bad Request (It was an embedded web server written in C, with the vuln being in an XML parsing library), but I had to go through the effort of taking that bug and learning ARM assembly and return-oriented programming in order to create a PoC before engineering decided to fix it.<p>I suppose I should be happy, though, as that learning experience was the cannon that shot me from just being a test engineer into getting into AppSec.</div><br/><div id="41665141" class="c"><input type="checkbox" id="c-41665141" checked=""/><div class="controls bullet"><span class="by">whydoyoucare</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41663728">parent</a><span>|</span><a href="#41663842">next</a><span>|</span><label class="collapse" for="c-41665141">[-]</label><label class="expand" for="c-41665141">[1 more]</label></div><br/><div class="children"><div class="content">I genuinely liked your opening statement (disagreeing...)<p>I am sorry to hear you had such a raw experience. Maybe you were dealing with pretty clueless engineers, since most do realize a buffer overflow should be treated exploitable unless proven otherwise. I&#x27;ve had better experience trying to argue the cost of fix -- it being pretty low was incentive enough for engineering to fix it.<p>That said, I am worried evilsocket may not be taken seriously next time he finds a vulnerability with CVSS 9.9. To some extent I am surprised by his argument on not knowing CVSS scoring rubrik. There may have been language barrier at play as well, leading to some of his sentences coming across as more abrasive than they should have been.</div><br/></div></div><div id="41663842" class="c"><input type="checkbox" id="c-41663842" checked=""/><div class="controls bullet"><span class="by">thinkingemote</span><span>|</span><a href="#41662678">root</a><span>|</span><a href="#41663728">parent</a><span>|</span><a href="#41665141">prev</a><span>|</span><a href="#41663577">next</a><span>|</span><label class="collapse" for="c-41663842">[-]</label><label class="expand" for="c-41663842">[1 more]</label></div><br/><div class="children"><div class="content">Yes, I can totally empathise with him too. I&#x27;ve behaved in emotional ways in with frustration because of code (but thankfully not in a public way with certain standards of behaviour).  Let&#x27;s hope he can learn from it. It&#x27;s hard to act professional when acting alone and outside and against the so-called &quot;real professionals&quot;.<p>Ultimately it&#x27;s about trust. Perhaps these organisations have become too large and uncaring or maybe we have become too impatient and frustrated. I don&#x27;t think anyone wants to see researchers not responsibly disclosing as well as companies irresponsibly interacting with external researchers who <i>just want to help</i>. It&#x27;s easy to this as a path from white to black hat.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41663577" class="c"><input type="checkbox" id="c-41663577" checked=""/><div class="controls bullet"><span class="by">computer23</span><span>|</span><a href="#41662678">prev</a><span>|</span><a href="#41663453">next</a><span>|</span><label class="collapse" for="c-41663577">[-]</label><label class="expand" for="c-41663577">[7 more]</label></div><br/><div class="children"><div class="content">Is there a recommended (best practice) way to nmap scan your network for vulnerable machines, just to be safe?<p>From Red Hat&#x27;s statement:
&gt; Red Hat rates these issues with a severity impact of Important. While all versions of RHEL are affected, it is important to note that affected packages are not vulnerable in their default configuration.<p>Basically, Red Hat machines aren&#x27;t vulnerable unless &quot;the cups-browsed service has manually been enabled or started.&quot;<p><a href="https:&#x2F;&#x2F;www.redhat.com&#x2F;en&#x2F;blog&#x2F;red-hat-response-openprinting-cups-vulnerabilities" rel="nofollow">https:&#x2F;&#x2F;www.redhat.com&#x2F;en&#x2F;blog&#x2F;red-hat-response-openprinting...</a></div><br/><div id="41665520" class="c"><input type="checkbox" id="c-41665520" checked=""/><div class="controls bullet"><span class="by">pushupentry1219</span><span>|</span><a href="#41663577">parent</a><span>|</span><a href="#41663831">next</a><span>|</span><label class="collapse" for="c-41665520">[-]</label><label class="expand" for="c-41665520">[1 more]</label></div><br/><div class="children"><div class="content">Corporate organisations make use of platforms like Nessus&#x2F;Tenable to provide this continuous vuln scanning for compliance reasons.<p>Under the hood its basically running an nmap scan and spitting out a PDF report.</div><br/></div></div><div id="41663831" class="c"><input type="checkbox" id="c-41663831" checked=""/><div class="controls bullet"><span class="by">nobody9999</span><span>|</span><a href="#41663577">parent</a><span>|</span><a href="#41665520">prev</a><span>|</span><a href="#41663453">next</a><span>|</span><label class="collapse" for="c-41663831">[-]</label><label class="expand" for="c-41663831">[5 more]</label></div><br/><div class="children"><div class="content">&gt;Is there a recommended (best practice) way to nmap scan your network for vulnerable machines, just to be safe?<p>Perhaps something like this?<p><pre><code>   nmap -sU -p 631 -P0 [network]&#x2F;[mask]

</code></pre>
Edit:  Added [network]&#x2F;[mask] for completeness.</div><br/><div id="41664826" class="c"><input type="checkbox" id="c-41664826" checked=""/><div class="controls bullet"><span class="by">moyix</span><span>|</span><a href="#41663577">root</a><span>|</span><a href="#41663831">parent</a><span>|</span><a href="#41663453">next</a><span>|</span><label class="collapse" for="c-41664826">[-]</label><label class="expand" for="c-41664826">[4 more]</label></div><br/><div class="children"><div class="content">nmap can&#x27;t really tell the difference between an open or a firewalled UDP port. For this specific vuln you can send it a packet like:<p>echo &quot;0 3 <a href="http:&#x2F;&#x2F;myserver:PORT&#x2F;printers&#x2F;foo" rel="nofollow">http:&#x2F;&#x2F;myserver:PORT&#x2F;printers&#x2F;foo</a>&quot; | nc -u target 631<p>And if the target is running CUPS on that port it will reach out to `myserver:PORT` and POST some data. The downside is you need to have a server running that can accept inbound requests to see if it connects back.</div><br/><div id="41665042" class="c"><input type="checkbox" id="c-41665042" checked=""/><div class="controls bullet"><span class="by">folmar</span><span>|</span><a href="#41663577">root</a><span>|</span><a href="#41664826">parent</a><span>|</span><a href="#41664996">next</a><span>|</span><label class="collapse" for="c-41665042">[-]</label><label class="expand" for="c-41665042">[1 more]</label></div><br/><div class="children"><div class="content">You can use --data in nmap to  send it easily to the range of hosts (but the server is still needed).</div><br/></div></div><div id="41664996" class="c"><input type="checkbox" id="c-41664996" checked=""/><div class="controls bullet"><span class="by">nobody9999</span><span>|</span><a href="#41663577">root</a><span>|</span><a href="#41664826">parent</a><span>|</span><a href="#41665042">prev</a><span>|</span><a href="#41663453">next</a><span>|</span><label class="collapse" for="c-41664996">[-]</label><label class="expand" for="c-41664996">[2 more]</label></div><br/><div class="children"><div class="content">A fair point, although nmap does list  results as &quot;closed&quot;, &quot;open&quot; or &quot;open&#x2F;filtered&quot;.<p>Which can be ambiguous if the port is open or firewalled.<p>However, if the nmap reports that port is &quot;closed,&quot; it most likely is:<p><pre><code>   Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2024-09-26 20:02 EDT
   Nmap scan report for [host] (localip)
   Host is up (0.00084s latency).

   PORT    STATE  SERVICE
   631&#x2F;udp closed ipp

</code></pre>
I&#x27;d add that GP specifically requested an <i>nmap</i> command.<p>All that said, you&#x27;re absolutely correct and if nmap returns something like this:<p><pre><code>   Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2024-09-26 20:04 EDT
   Nmap scan report for [host] (localip)
   Host is up (0.00058s latency).

   PORT    STATE         SERVICE
   631&#x2F;udp open|filtered ipp
</code></pre>
then further poking could be required, as you suggest.<p>I would point out that cups-browsed isn&#x27;t really necessary unless you desire to have printers <i>automatically</i> added without any user interaction.  Which is poor opsec in any situation.<p>If we&#x27;re talking about a corporate environment, adding printers can be automated without cups-browsed, and at home or in the wild (cafes, public wifi, etc.) that&#x27;s an unacceptable (at least from my perspective) risk and printers (if needed in such an unsecured environment) should be explicitly added by the user, with manual checks to ensure it&#x27;s the correct device.<p>As such, rather than checking to see if cups-browsed is running unsecured, simply check to see if it&#x27;s installed:<p>Debian and variants:<p><pre><code>   &#x27;sudo apt list --installed | grep cups-browsed&#x27;
</code></pre>
RedHat&#x2F;Fedora and variants:<p><pre><code>   &#x27;sudo rpm -a -q | grep cups-browsed&#x27;
</code></pre>
And if it is, remove it.<p>Edit: fixed typo.</div><br/><div id="41667590" class="c"><input type="checkbox" id="c-41667590" checked=""/><div class="controls bullet"><span class="by">a96</span><span>|</span><a href="#41663577">root</a><span>|</span><a href="#41664996">parent</a><span>|</span><a href="#41663453">next</a><span>|</span><label class="collapse" for="c-41667590">[-]</label><label class="expand" for="c-41667590">[1 more]</label></div><br/><div class="children"><div class="content">Surely you don&#x27;t need sudo for listing with either apt or rpm.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41663453" class="c"><input type="checkbox" id="c-41663453" checked=""/><div class="controls bullet"><span class="by">LZ2DMV</span><span>|</span><a href="#41663577">prev</a><span>|</span><a href="#41663228">next</a><span>|</span><label class="collapse" for="c-41663453">[-]</label><label class="expand" for="c-41663453">[1 more]</label></div><br/><div class="children"><div class="content">Everyone, please go to your respective data centers, locate your rack and unplug the printer from the server.</div><br/></div></div><div id="41663228" class="c"><input type="checkbox" id="c-41663228" checked=""/><div class="controls bullet"><span class="by">smokel</span><span>|</span><a href="#41663453">prev</a><span>|</span><a href="#41662983">next</a><span>|</span><label class="collapse" for="c-41663228">[-]</label><label class="expand" for="c-41663228">[4 more]</label></div><br/><div class="children"><div class="content">This vulnerability seems to be pretty hard to actually exploit, but for those of you who are running Ubuntu on their desktops, consider enabling a firewall, which is as easy as:<p><pre><code>  sudo ufw enable
</code></pre>
Beats me why this is not the default.</div><br/><div id="41666878" class="c"><input type="checkbox" id="c-41666878" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41663228">parent</a><span>|</span><a href="#41663946">next</a><span>|</span><label class="collapse" for="c-41666878">[-]</label><label class="expand" for="c-41666878">[1 more]</label></div><br/><div class="children"><div class="content">Just enabling the firewall is not enough. The Ubuntu distros explicitly wanted to allow the vector for this vulnerability: the whole purpose of having cups-browsed installed is to allow LAN printers to advertise themselves to your system.</div><br/></div></div><div id="41663946" class="c"><input type="checkbox" id="c-41663946" checked=""/><div class="controls bullet"><span class="by">hypeatei</span><span>|</span><a href="#41663228">parent</a><span>|</span><a href="#41666878">prev</a><span>|</span><a href="#41662983">next</a><span>|</span><label class="collapse" for="c-41663946">[-]</label><label class="expand" for="c-41663946">[2 more]</label></div><br/><div class="children"><div class="content">Also this:<p><pre><code>  &gt; sudo ufw deny 631
  &gt; sudo ufw reload</code></pre></div><br/><div id="41664332" class="c"><input type="checkbox" id="c-41664332" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#41663228">root</a><span>|</span><a href="#41663946">parent</a><span>|</span><a href="#41662983">next</a><span>|</span><label class="collapse" for="c-41664332">[-]</label><label class="expand" for="c-41664332">[1 more]</label></div><br/><div class="children"><div class="content">reload is unnecessary if you make changes via the command line.</div><br/></div></div></div></div></div></div><div id="41662983" class="c"><input type="checkbox" id="c-41662983" checked=""/><div class="controls bullet"><span class="by">jonjojojon</span><span>|</span><a href="#41663228">prev</a><span>|</span><a href="#41662813">next</a><span>|</span><label class="collapse" for="c-41662983">[-]</label><label class="expand" for="c-41662983">[8 more]</label></div><br/><div class="children"><div class="content">I am slightly confused. If I am using a linux laptop with cups do I need to do anything besides update? Is there a sane way to print from the linux desktop. I unfortunately need to regularly print, and often from public wifi.</div><br/><div id="41663379" class="c"><input type="checkbox" id="c-41663379" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#41662983">parent</a><span>|</span><a href="#41666912">next</a><span>|</span><label class="collapse" for="c-41663379">[-]</label><label class="expand" for="c-41663379">[2 more]</label></div><br/><div class="children"><div class="content">Unless you are exposing CUPS to other people on purpose so that you act as a print server then block inbound access using a local firewall.  Your local print jobs should be able to use the loopback just fine.  Your print spooler would then be talking to the IP on your printer and that should also be confined to your local network <i>and may have optional features to further secure access.</i><p>On a very loosely related note, some enterprise printers have optional features to lock down remote access to people that are authenticated.  Authentication capabilities vary by vendor.  This is somewhat unrelated to CUPS but probably a good time for people to research what their printers can do as printers are a great way to steal company secrets.<p>[Edit] What smokel said.  They beat me to it before I refreshed the page.</div><br/><div id="41666898" class="c"><input type="checkbox" id="c-41666898" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662983">root</a><span>|</span><a href="#41663379">parent</a><span>|</span><a href="#41666912">next</a><span>|</span><label class="collapse" for="c-41666898">[-]</label><label class="expand" for="c-41666898">[1 more]</label></div><br/><div class="children"><div class="content">This is a misunderstanding of the vulnerability. The problem isn&#x27;t with the print server. It is with the printer discovery mechanism, cups-browsed. That is the service that listens on the entire network, because it&#x27;s designed so that LAN printers can advertise themselves to your system.</div><br/></div></div></div></div><div id="41666912" class="c"><input type="checkbox" id="c-41666912" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41662983">parent</a><span>|</span><a href="#41663379">prev</a><span>|</span><a href="#41663314">next</a><span>|</span><label class="collapse" for="c-41666912">[-]</label><label class="expand" for="c-41666912">[1 more]</label></div><br/><div class="children"><div class="content">Unless you need printer discovery, you should probably shut down and remove cups-browsed entirely. Its whole purpose is to listen on the LAN to discover printers (or attackers) that advertise themselves to it.</div><br/></div></div><div id="41663314" class="c"><input type="checkbox" id="c-41663314" checked=""/><div class="controls bullet"><span class="by">smokel</span><span>|</span><a href="#41662983">parent</a><span>|</span><a href="#41666912">prev</a><span>|</span><a href="#41663627">next</a><span>|</span><label class="collapse" for="c-41663314">[-]</label><label class="expand" for="c-41663314">[2 more]</label></div><br/><div class="children"><div class="content">Not an expert, but I guess that simply enabling the firewall should avoid most problems related to this vulnerability.  In Ubuntu, this can be accomplished with:<p><pre><code>  sudo ufw enable</code></pre></div><br/><div id="41663616" class="c"><input type="checkbox" id="c-41663616" checked=""/><div class="controls bullet"><span class="by">jonjojojon</span><span>|</span><a href="#41662983">root</a><span>|</span><a href="#41663314">parent</a><span>|</span><a href="#41663627">next</a><span>|</span><label class="collapse" for="c-41663616">[-]</label><label class="expand" for="c-41663616">[1 more]</label></div><br/><div class="children"><div class="content">Thank you. I was also able to check that 631 is blocked by searching for it in output of sudo ufw show raw.</div><br/></div></div></div></div></div></div><div id="41663284" class="c"><input type="checkbox" id="c-41663284" checked=""/><div class="controls bullet"><span class="by">0x_rs</span><span>|</span><a href="#41662813">prev</a><span>|</span><a href="#41666251">next</a><span>|</span><label class="collapse" for="c-41663284">[-]</label><label class="expand" for="c-41663284">[5 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t believe this warranted all the fearmongering even if the intention was to get more attention to it and a faster resolution process, it&#x27;s not far from cry wolf. Initial CVE scores are very arbitrary. CUPS is a <i>well-known liability</i> when exposed to unsafe networks. CVSS scores seem far from perfect. The WebP zero-day, a zero-click vulnerability that was being exploited in the wild and affecting nearly every user device made in the past decade, most of which will never be properly patched from it, received an initial 10.0, and decreased to a meager 8.8 (CVSS:3.1, and would be higher using 4.0).</div><br/><div id="41663602" class="c"><input type="checkbox" id="c-41663602" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#41663284">parent</a><span>|</span><a href="#41663447">next</a><span>|</span><label class="collapse" for="c-41663602">[-]</label><label class="expand" for="c-41663602">[3 more]</label></div><br/><div class="children"><div class="content">Why are distros allowing CUPS to listen on all interfaces, then?</div><br/><div id="41666934" class="c"><input type="checkbox" id="c-41666934" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#41663284">root</a><span>|</span><a href="#41663602">parent</a><span>|</span><a href="#41666653">next</a><span>|</span><label class="collapse" for="c-41666934">[-]</label><label class="expand" for="c-41666934">[1 more]</label></div><br/><div class="children"><div class="content">The problem isn&#x27;t CUPS itself, which is not made to listen on all interfaces by default. The problem is the printer discovery service, cups-browsed, which listens for any printer on the LAN (or any attacker anywhere) that advertises itself to it and automatically registers that printer in your system.<p>Whether it&#x27;s a good idea to have a service like this is highly debatable, but if it is added, it has to listen to all requests from anywhere (and the firewall port for it has to be open), otherwise it&#x27;s entirely useless.</div><br/></div></div><div id="41666653" class="c"><input type="checkbox" id="c-41666653" checked=""/><div class="controls bullet"><span class="by">stop50</span><span>|</span><a href="#41663284">root</a><span>|</span><a href="#41663602">parent</a><span>|</span><a href="#41666934">prev</a><span>|</span><a href="#41663447">next</a><span>|</span><label class="collapse" for="c-41666653">[-]</label><label class="expand" for="c-41666653">[1 more]</label></div><br/><div class="children"><div class="content">many distros change this to unix sockets or 127.0.0.1</div><br/></div></div></div></div></div></div><div id="41662844" class="c"><input type="checkbox" id="c-41662844" checked=""/><div class="controls bullet"><span class="by">cp9</span><span>|</span><a href="#41666251">prev</a><span>|</span><a href="#41662977">next</a><span>|</span><label class="collapse" for="c-41662844">[-]</label><label class="expand" for="c-41662844">[1 more]</label></div><br/><div class="children"><div class="content">we should fix this, CUPS is used in a bunch of consumer hardware<p>it&#x27;s not a complete disaster like it was implied to be though</div><br/></div></div><div id="41662977" class="c"><input type="checkbox" id="c-41662977" checked=""/><div class="controls bullet"><span class="by">ajdude</span><span>|</span><a href="#41662844">prev</a><span>|</span><a href="#41662953">next</a><span>|</span><label class="collapse" for="c-41662977">[-]</label><label class="expand" for="c-41662977">[3 more]</label></div><br/><div class="children"><div class="content">Do networked printers themselves run CUPS?  E.g. a Brother or HP laserjet plugged into a LAN.</div><br/><div id="41666646" class="c"><input type="checkbox" id="c-41666646" checked=""/><div class="controls bullet"><span class="by">stop50</span><span>|</span><a href="#41662977">parent</a><span>|</span><a href="#41663468">next</a><span>|</span><label class="collapse" for="c-41666646">[-]</label><label class="expand" for="c-41666646">[1 more]</label></div><br/><div class="children"><div class="content">The last time i checked: no<p>They run their own software, not cups.
the one i had was using their own software, if they had used cups it would have much less problems with printing.</div><br/></div></div><div id="41663468" class="c"><input type="checkbox" id="c-41663468" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#41662977">parent</a><span>|</span><a href="#41666646">prev</a><span>|</span><a href="#41662953">next</a><span>|</span><label class="collapse" for="c-41663468">[-]</label><label class="expand" for="c-41663468">[1 more]</label></div><br/><div class="children"><div class="content">vulnerabilities are (mostly?) in cups-browserd rather than cups.</div><br/></div></div></div></div><div id="41662953" class="c"><input type="checkbox" id="c-41662953" checked=""/><div class="controls bullet"><span class="by">chrononaut</span><span>|</span><a href="#41662977">prev</a><span>|</span><a href="#41662815">next</a><span>|</span><label class="collapse" for="c-41662953">[-]</label><label class="expand" for="c-41662953">[1 more]</label></div><br/><div class="children"><div class="content">Queue everyone going to Shodan and investigating how many systems have port 631 on UDP open..</div><br/></div></div><div id="41662815" class="c"><input type="checkbox" id="c-41662815" checked=""/><div class="controls bullet"><span class="by">beginnings</span><span>|</span><a href="#41662953">prev</a><span>|</span><a href="#41662912">next</a><span>|</span><label class="collapse" for="c-41662815">[-]</label><label class="expand" for="c-41662815">[1 more]</label></div><br/><div class="children"><div class="content">my grandparents who are still printing things like its the 90s might be at risk, if they have installed CUPS that is<p>has the president been briefed yet?</div><br/></div></div><div id="41662912" class="c"><input type="checkbox" id="c-41662912" checked=""/><div class="controls bullet"><span class="by">hacker_homie</span><span>|</span><a href="#41662815">prev</a><span>|</span><label class="collapse" for="c-41662912">[-]</label><label class="expand" for="c-41662912">[1 more]</label></div><br/><div class="children"><div class="content">I though this was going to be NetworkManager the way they were hyping it up.</div><br/></div></div></div></div></div></div></div></body></html>