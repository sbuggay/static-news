<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719824481844" as="style"/><link rel="stylesheet" href="styles.css?v=1719824481844"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/poundifdef/SmoothMQ">Show HN: Drop-in SQS replacement based on SQLite</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>memset</span> | <span>99 comments</span></div><br/><div><div id="40838606" class="c"><input type="checkbox" id="c-40838606" checked=""/><div class="controls bullet"><span class="by">davidthewatson</span><span>|</span><a href="#40841750">next</a><span>|</span><label class="collapse" for="c-40838606">[-]</label><label class="expand" for="c-40838606">[8 more]</label></div><br/><div class="children"><div class="content">The whole idea here is superlative.<p>+1 for k8s, kubernetes, cloud native, self-hosted, edge-enabled at low cost, no cost.<p>I ran rq and minio for years on k8s, but been watching sqlite as a drop-in-replacement since most of my work has been early stage at or near the edge.<p>Private cloud matters. This is an enabler. We&#x27;ve done too much already in public cloud where many things don&#x27;t belong.<p>BTLE sensors are perfectly happy talking to my Apple Watch directly with enough debugging.<p>I&#x27;d argue the trip through cloud was not a win and should be corrected in the next generation of tools like this, where mobile is already well-primed for SQLite.</div><br/><div id="40838793" class="c"><input type="checkbox" id="c-40838793" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838606">parent</a><span>|</span><a href="#40842456">next</a><span>|</span><label class="collapse" for="c-40838793">[-]</label><label class="expand" for="c-40838793">[3 more]</label></div><br/><div class="children"><div class="content">Really interesting. Question: when it comes to running these software on k8s, do you prefer to manage and host yourself, or do you use managed solutions on top of your own infra? (Do you pay for minio support?)<p>Asking from a business perspective - I of course intend to keep developing this, but am also really trying to think through the business case as well.</div><br/><div id="40839163" class="c"><input type="checkbox" id="c-40839163" checked=""/><div class="controls bullet"><span class="by">davidthewatson</span><span>|</span><a href="#40838606">root</a><span>|</span><a href="#40838793">parent</a><span>|</span><a href="#40839183">next</a><span>|</span><label class="collapse" for="c-40839163">[-]</label><label class="expand" for="c-40839163">[1 more]</label></div><br/><div class="children"><div class="content">Good question!<p>The answer depends on funding, i.e. in my own never-leaves-my-house case it is always self-host, much like SOC work.<p>In the case of startup or research lab work (day-job, for lack of a better descriptor). It&#x27;s frequently a slice of AWS, GCP, or Azure, i.e. 6 figure&#x2F;mo cloud bills.<p>I think those two broad cases are worth considering.</div><br/></div></div><div id="40839183" class="c"><input type="checkbox" id="c-40839183" checked=""/><div class="controls bullet"><span class="by">cpill</span><span>|</span><a href="#40838606">root</a><span>|</span><a href="#40838793">parent</a><span>|</span><a href="#40839163">prev</a><span>|</span><a href="#40842456">next</a><span>|</span><label class="collapse" for="c-40839183">[-]</label><label class="expand" for="c-40839183">[1 more]</label></div><br/><div class="children"><div class="content">k3s for on premises deployments. I&#x27;m also using it for local self hosting side projects.</div><br/></div></div></div></div><div id="40842456" class="c"><input type="checkbox" id="c-40842456" checked=""/><div class="controls bullet"><span class="by">raihansaputra</span><span>|</span><a href="#40838606">parent</a><span>|</span><a href="#40838793">prev</a><span>|</span><a href="#40839276">next</a><span>|</span><label class="collapse" for="c-40842456">[-]</label><label class="expand" for="c-40842456">[1 more]</label></div><br/><div class="children"><div class="content">can you share more about the BTLE sensors talking with Apple Watch? I&#x27;m aware that BLE heartrate sensors are detected as &#x27;Health Devices&#x27; if I want to connect to it, but what other sensors are you working with?</div><br/></div></div><div id="40839276" class="c"><input type="checkbox" id="c-40839276" checked=""/><div class="controls bullet"><span class="by">pfix</span><span>|</span><a href="#40838606">parent</a><span>|</span><a href="#40842456">prev</a><span>|</span><a href="#40841750">next</a><span>|</span><label class="collapse" for="c-40839276">[-]</label><label class="expand" for="c-40839276">[3 more]</label></div><br/><div class="children"><div class="content">rq as in Redis Queue?</div><br/><div id="40841879" class="c"><input type="checkbox" id="c-40841879" checked=""/><div class="controls bullet"><span class="by">philsnow</span><span>|</span><a href="#40838606">root</a><span>|</span><a href="#40839276">parent</a><span>|</span><a href="#40840813">next</a><span>|</span><label class="collapse" for="c-40841879">[-]</label><label class="expand" for="c-40841879">[1 more]</label></div><br/><div class="children"><div class="content">I had assumed <a href="https:&#x2F;&#x2F;github.com&#x2F;rqlite&#x2F;rqlite">https:&#x2F;&#x2F;github.com&#x2F;rqlite&#x2F;rqlite</a></div><br/></div></div></div></div></div></div><div id="40841750" class="c"><input type="checkbox" id="c-40841750" checked=""/><div class="controls bullet"><span class="by">dav43</span><span>|</span><a href="#40838606">prev</a><span>|</span><a href="#40841227">next</a><span>|</span><label class="collapse" for="c-40841750">[-]</label><label class="expand" for="c-40841750">[7 more]</label></div><br/><div class="children"><div class="content">Tangential but I looked at the codebase - because I like to imagine I can code (I can’t) - and for a laymen, I could follow the code.<p>Makes me think quite positively of go lang and of the dev for designing in such a way. Can understand why teams like it because of easier maintenance<p>Quite elegant from my uneducated pov.</div><br/><div id="40842674" class="c"><input type="checkbox" id="c-40842674" checked=""/><div class="controls bullet"><span class="by">silisili</span><span>|</span><a href="#40841750">parent</a><span>|</span><a href="#40841809">next</a><span>|</span><label class="collapse" for="c-40842674">[-]</label><label class="expand" for="c-40842674">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the beauty of Go, generally, and why I immediately became attracted to it.  The code is supremely readable because it enforces a style guide, and doesn&#x27;t allow much magic.<p>A number of people don&#x27;t like it for limiting their expression and abilities, which I understand that feeling too.  But as a middle aged programmer I realized that readability trumps conciseness and cleverness in the long run.</div><br/><div id="40842906" class="c"><input type="checkbox" id="c-40842906" checked=""/><div class="controls bullet"><span class="by">bilekas</span><span>|</span><a href="#40841750">root</a><span>|</span><a href="#40842674">parent</a><span>|</span><a href="#40841809">next</a><span>|</span><label class="collapse" for="c-40842906">[-]</label><label class="expand" for="c-40842906">[2 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t remember who said it but I remember hearing that a good go Dev and a new go Dev should be able to produce generally similar code in order for maintainability. I do like playing with go, it&#x27;s sits in a nice little playground in my head, mostly thanks to the compile times I think.</div><br/><div id="40843454" class="c"><input type="checkbox" id="c-40843454" checked=""/><div class="controls bullet"><span class="by">ayuhito</span><span>|</span><a href="#40841750">root</a><span>|</span><a href="#40842906">parent</a><span>|</span><a href="#40841809">next</a><span>|</span><label class="collapse" for="c-40843454">[-]</label><label class="expand" for="c-40843454">[1 more]</label></div><br/><div class="children"><div class="content">Two experienced Go devs tackle the same task, and their code will look almost identical.<p>Two experienced Rust devs tackle the same task, and their solutions will be worlds apart.<p>(I write both, but I do love Go for its simpleness)</div><br/></div></div></div></div></div></div><div id="40841809" class="c"><input type="checkbox" id="c-40841809" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40841750">parent</a><span>|</span><a href="#40842674">prev</a><span>|</span><a href="#40841852">next</a><span>|</span><label class="collapse" for="c-40841809">[-]</label><label class="expand" for="c-40841809">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the kind words! I&#x27;ll be sure to work on making it as complicated as I can :)</div><br/></div></div><div id="40842106" class="c"><input type="checkbox" id="c-40842106" checked=""/><div class="controls bullet"><span class="by">x-complexity</span><span>|</span><a href="#40841750">parent</a><span>|</span><a href="#40841852">prev</a><span>|</span><a href="#40841227">next</a><span>|</span><label class="collapse" for="c-40842106">[-]</label><label class="expand" for="c-40842106">[1 more]</label></div><br/><div class="children"><div class="content">Honestly shows the capabilities of both:<p>- The dev for making it both fast &amp; simple to understand<p>- Golang for making the codebase easy to follow</div><br/></div></div></div></div><div id="40841227" class="c"><input type="checkbox" id="c-40841227" checked=""/><div class="controls bullet"><span class="by">ahachete</span><span>|</span><a href="#40841750">prev</a><span>|</span><a href="#40838082">next</a><span>|</span><label class="collapse" for="c-40841227">[-]</label><label class="expand" for="c-40841227">[4 more]</label></div><br/><div class="children"><div class="content">Congratulations!<p>I also love writing AWS API-compatible services. That&#x27;s why I did Dyna53 [1] ;P<p>(I know, unrelated, but hopefully funny)<p>[1] <a href="https:&#x2F;&#x2F;dyna53.io" rel="nofollow">https:&#x2F;&#x2F;dyna53.io</a></div><br/><div id="40841784" class="c"><input type="checkbox" id="c-40841784" checked=""/><div class="controls bullet"><span class="by">selcuka</span><span>|</span><a href="#40841227">parent</a><span>|</span><a href="#40842460">next</a><span>|</span><label class="collapse" for="c-40841784">[-]</label><label class="expand" for="c-40841784">[1 more]</label></div><br/><div class="children"><div class="content">It is fun, indeed. Could be a candidate for the best technology abuse of the year.</div><br/></div></div><div id="40842460" class="c"><input type="checkbox" id="c-40842460" checked=""/><div class="controls bullet"><span class="by">bensmoif</span><span>|</span><a href="#40841227">parent</a><span>|</span><a href="#40841784">prev</a><span>|</span><a href="#40841541">next</a><span>|</span><label class="collapse" for="c-40842460">[-]</label><label class="expand" for="c-40842460">[1 more]</label></div><br/><div class="children"><div class="content">This is an absolutely unhinged project idea. Great work</div><br/></div></div><div id="40841541" class="c"><input type="checkbox" id="c-40841541" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40841227">parent</a><span>|</span><a href="#40842460">prev</a><span>|</span><a href="#40838082">next</a><span>|</span><label class="collapse" for="c-40841541">[-]</label><label class="expand" for="c-40841541">[1 more]</label></div><br/><div class="children"><div class="content">This is really fun!</div><br/></div></div></div></div><div id="40838082" class="c"><input type="checkbox" id="c-40838082" checked=""/><div class="controls bullet"><span class="by">hrisen</span><span>|</span><a href="#40841227">prev</a><span>|</span><a href="#40838372">next</a><span>|</span><label class="collapse" for="c-40838082">[-]</label><label class="expand" for="c-40838082">[3 more]</label></div><br/><div class="children"><div class="content">Keeping questions from scale &amp; benchmarks aside, this is a cool thing for functional&#x2F;unit testing module that uses SQS, instead of dumb mocks.</div><br/><div id="40838218" class="c"><input type="checkbox" id="c-40838218" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838082">parent</a><span>|</span><a href="#40838372">next</a><span>|</span><label class="collapse" for="c-40838218">[-]</label><label class="expand" for="c-40838218">[2 more]</label></div><br/><div class="children"><div class="content">Thank you! Yes, you should definitely use this instead of localstack :)</div><br/><div id="40839353" class="c"><input type="checkbox" id="c-40839353" checked=""/><div class="controls bullet"><span class="by">thrauat</span><span>|</span><a href="#40838082">root</a><span>|</span><a href="#40838218">parent</a><span>|</span><a href="#40838372">next</a><span>|</span><label class="collapse" for="c-40839353">[-]</label><label class="expand" for="c-40839353">[1 more]</label></div><br/><div class="children"><div class="content">Although I wouldn&#x27;t recommend using LocalStack&#x27;s SQS implementation for production workloads, calling it a dumb mock is a bit outdated. It emulates pretty much every SQS behvaior including long polling, delayed messages, visibility timeouts, DLQ redrive, batch send&#x2F;receive, ...</div><br/></div></div></div></div></div></div><div id="40838372" class="c"><input type="checkbox" id="c-40838372" checked=""/><div class="controls bullet"><span class="by">4RealFreedom</span><span>|</span><a href="#40838082">prev</a><span>|</span><a href="#40838032">next</a><span>|</span><label class="collapse" for="c-40838372">[-]</label><label class="expand" for="c-40838372">[4 more]</label></div><br/><div class="children"><div class="content">The goals are a little different but I think it&#x27;s worth pointing out ElasticMQ. I use it simulate sqs in a docker environment. 
<a href="https:&#x2F;&#x2F;github.com&#x2F;softwaremill&#x2F;elasticmq">https:&#x2F;&#x2F;github.com&#x2F;softwaremill&#x2F;elasticmq</a></div><br/><div id="40843843" class="c"><input type="checkbox" id="c-40843843" checked=""/><div class="controls bullet"><span class="by">cies</span><span>|</span><a href="#40838372">parent</a><span>|</span><a href="#40838450">next</a><span>|</span><label class="collapse" for="c-40843843">[-]</label><label class="expand" for="c-40843843">[1 more]</label></div><br/><div class="children"><div class="content">We use ElasticMQ to have an SQS compatible service for local development. We use it with docker-compose locally. In our remote envs we use SQS.<p>So far I had not problems with ElasticMQ.<p>I&#x27;m much intrigued by the small LOC count of SmoothMQ. When I compare it to ElasticMQ it&#x27;s much smaller (probably by using sqlite&#x27;s features).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;softwaremill&#x2F;elasticmq">https:&#x2F;&#x2F;github.com&#x2F;softwaremill&#x2F;elasticmq</a></div><br/></div></div><div id="40838450" class="c"><input type="checkbox" id="c-40838450" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838372">parent</a><span>|</span><a href="#40843843">prev</a><span>|</span><a href="#40838032">next</a><span>|</span><label class="collapse" for="c-40838450">[-]</label><label class="expand" for="c-40838450">[2 more]</label></div><br/><div class="children"><div class="content">I have looked at elasticmq but not played with it myself. You might also be interested in their benchmarks of all of the existing queues out there: <a href="https:&#x2F;&#x2F;softwaremill.com&#x2F;mqperf&#x2F;" rel="nofollow">https:&#x2F;&#x2F;softwaremill.com&#x2F;mqperf&#x2F;</a></div><br/><div id="40839015" class="c"><input type="checkbox" id="c-40839015" checked=""/><div class="controls bullet"><span class="by">julius</span><span>|</span><a href="#40838372">root</a><span>|</span><a href="#40838450">parent</a><span>|</span><a href="#40838032">next</a><span>|</span><label class="collapse" for="c-40839015">[-]</label><label class="expand" for="c-40839015">[1 more]</label></div><br/><div class="children"><div class="content">I also just used ElasticMQ in a docker environment. Did you see any specific downsides, when you looked at it? In which scenarios should I consider replacing it with your solution?</div><br/></div></div></div></div></div></div><div id="40838032" class="c"><input type="checkbox" id="c-40838032" checked=""/><div class="controls bullet"><span class="by">jerrygenser</span><span>|</span><a href="#40838372">prev</a><span>|</span><a href="#40840916">next</a><span>|</span><label class="collapse" for="c-40838032">[-]</label><label class="expand" for="c-40838032">[13 more]</label></div><br/><div class="children"><div class="content">&gt; In terms of monetization, the goal is to just have a hosted queue system. I believe this can be cheaper than SQS without sacrificing performance. Just as Backblaze and Minio have had success competing in the S3 space, I wanted to take a crack at queues.<p>are you monetizing this as a separate business from: <a href="https:&#x2F;&#x2F;www.ycombinator.com&#x2F;companies&#x2F;scratch-data">https:&#x2F;&#x2F;www.ycombinator.com&#x2F;companies&#x2F;scratch-data</a></div><br/><div id="40838104" class="c"><input type="checkbox" id="c-40838104" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838032">parent</a><span>|</span><a href="#40838475">next</a><span>|</span><label class="collapse" for="c-40838104">[-]</label><label class="expand" for="c-40838104">[2 more]</label></div><br/><div class="children"><div class="content">Truthfully, I don&#x27;t know yet - I haven&#x27;t even built a paid&#x2F;hosted version at all. It is related to my existing business in the sense that it deals with realtime data.<p>But I started working this as something I wish existed as opposed to having some big VC strategy and pitch deck behind it.<p>(Also, I appreciate all of your feedback on this a month ago! It was really helpful to encourage me to keep looking into this and also figuring out the &quot;first&quot; things to launch with!)</div><br/><div id="40842845" class="c"><input type="checkbox" id="c-40842845" checked=""/><div class="controls bullet"><span class="by">Kwpolska</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40838104">parent</a><span>|</span><a href="#40838475">next</a><span>|</span><label class="collapse" for="c-40842845">[-]</label><label class="expand" for="c-40842845">[1 more]</label></div><br/><div class="children"><div class="content">Not every open source project needs to be monetized. Projects that were created to &quot;scratch one&#x27;s itch&quot; tend to fare better than those built to make money. Devs put more love and less stress into them than into things they want to build a business out of.<p>The monetization paragraph reads really weird, as if you believe HN is a community of VC-adjacent people looking for new ways to make money (it isn&#x27;t), and talking about how you plan to exploit your new project is mandatory (it isn&#x27;t either).</div><br/></div></div></div></div><div id="40838475" class="c"><input type="checkbox" id="c-40838475" checked=""/><div class="controls bullet"><span class="by">Onavo</span><span>|</span><a href="#40838032">parent</a><span>|</span><a href="#40838104">prev</a><span>|</span><a href="#40840916">next</a><span>|</span><label class="collapse" for="c-40838475">[-]</label><label class="expand" for="c-40838475">[10 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the point of AGPL though? The enterprises with the budget for self hosting this sort of software usually have requirements and scale beyond what SQLite can offer out of the box.</div><br/><div id="40840531" class="c"><input type="checkbox" id="c-40840531" checked=""/><div class="controls bullet"><span class="by">jerrygenser</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40838475">parent</a><span>|</span><a href="#40840869">next</a><span>|</span><label class="collapse" for="c-40840531">[-]</label><label class="expand" for="c-40840531">[2 more]</label></div><br/><div class="children"><div class="content">He&#x27;s going to make backends pluggable. So other more scalable backends than sqlite could work</div><br/><div id="40840559" class="c"><input type="checkbox" id="c-40840559" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40840531">parent</a><span>|</span><a href="#40840869">next</a><span>|</span><label class="collapse" for="c-40840559">[-]</label><label class="expand" for="c-40840559">[1 more]</label></div><br/><div class="children"><div class="content">In practice, I don’t plan on adding an entire proprietary layer - that is just way too much work, and it defeats the purpose. If the open source code has bad performance, why would someone even bother with a hosted version? Like, I <i>want</i> people to be so impressed by the open source code that they’d trust a cloud version to be even better. Clickhouse and duckdb do this very well.<p>The main difference I expect with a hosted solution are things like multiple tenants or billing integrations. These aren’t core to the product and only necessary when you need to host someone else’s data.</div><br/></div></div></div></div><div id="40840869" class="c"><input type="checkbox" id="c-40840869" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40838475">parent</a><span>|</span><a href="#40840531">prev</a><span>|</span><a href="#40840916">next</a><span>|</span><label class="collapse" for="c-40840869">[-]</label><label class="expand" for="c-40840869">[7 more]</label></div><br/><div class="children"><div class="content">Ugh I didn&#x27;t see that.<p>My enthusiasm has instantly waned.<p>Why is AGPL needed?  Just be MIT and make it easy for people, espefcially if you&#x27;re not planning on monetising it.<p>I won&#x27;t use AGPL code just on principle.</div><br/><div id="40842387" class="c"><input type="checkbox" id="c-40842387" checked=""/><div class="controls bullet"><span class="by">bigstrat2003</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40840869">parent</a><span>|</span><a href="#40841431">next</a><span>|</span><label class="collapse" for="c-40842387">[-]</label><label class="expand" for="c-40842387">[1 more]</label></div><br/><div class="children"><div class="content">Not gonna lie, man - this is just as obnoxious as when GPL zealots shit on someone&#x27;s permissively licensed project because they think it should be GPL. The man has a right to use whatever license he wants.</div><br/></div></div><div id="40841431" class="c"><input type="checkbox" id="c-40841431" checked=""/><div class="controls bullet"><span class="by">ctippett</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40840869">parent</a><span>|</span><a href="#40842387">prev</a><span>|</span><a href="#40843675">next</a><span>|</span><label class="collapse" for="c-40841431">[-]</label><label class="expand" for="c-40841431">[4 more]</label></div><br/><div class="children"><div class="content">Why? Does AGPL really matter if <i>you&#x27;re</i> not planning on monetising whatever it is you&#x27;re using it for?<p>Not trying to be snarky, I&#x27;m genuinely curious why you&#x27;d be so vehemently opposed to it.</div><br/><div id="40841632" class="c"><input type="checkbox" id="c-40841632" checked=""/><div class="controls bullet"><span class="by">Aeolun</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40841431">parent</a><span>|</span><a href="#40843675">next</a><span>|</span><label class="collapse" for="c-40841632">[-]</label><label class="expand" for="c-40841632">[3 more]</label></div><br/><div class="children"><div class="content">I think the crux of the argument is that if you are not planning to monetize it, why stop other people from doing so?</div><br/><div id="40841815" class="c"><input type="checkbox" id="c-40841815" checked=""/><div class="controls bullet"><span class="by">meiraleal</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40841632">parent</a><span>|</span><a href="#40841813">next</a><span>|</span><label class="collapse" for="c-40841815">[-]</label><label class="expand" for="c-40841815">[1 more]</label></div><br/><div class="children"><div class="content">AGPL don&#x27;t stop nobody from monetizing anything, they just gotta make their modifications public.</div><br/></div></div><div id="40841813" class="c"><input type="checkbox" id="c-40841813" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40841632">parent</a><span>|</span><a href="#40841815">prev</a><span>|</span><a href="#40843675">next</a><span>|</span><label class="collapse" for="c-40841813">[-]</label><label class="expand" for="c-40841813">[1 more]</label></div><br/><div class="children"><div class="content">Also, is there really any money left in message queues?<p>Every man and his dog has made a message queue with Postgres. Message queues are everywhere on github and often posted on HN.</div><br/></div></div></div></div></div></div><div id="40843675" class="c"><input type="checkbox" id="c-40843675" checked=""/><div class="controls bullet"><span class="by">lupusreal</span><span>|</span><a href="#40838032">root</a><span>|</span><a href="#40840869">parent</a><span>|</span><a href="#40841431">prev</a><span>|</span><a href="#40840916">next</a><span>|</span><label class="collapse" for="c-40843675">[-]</label><label class="expand" for="c-40843675">[1 more]</label></div><br/><div class="children"><div class="content">Provoking this sort of response is the best feature of the AGPL.  I love it.</div><br/></div></div></div></div></div></div></div></div><div id="40840916" class="c"><input type="checkbox" id="c-40840916" checked=""/><div class="controls bullet"><span class="by">PanMan</span><span>|</span><a href="#40838032">prev</a><span>|</span><a href="#40838269">next</a><span>|</span><label class="collapse" for="c-40840916">[-]</label><label class="expand" for="c-40840916">[4 more]</label></div><br/><div class="children"><div class="content">Correct me if I’m wrong but: SQLite sounds like: runs on one server. While that will work most of the time, it won’t work 100% of the time. I don’t know the specifics, but I’m fairly sure if a queue server crashes, SQS will keep working, as stuff is redundant. 
So while it can work in a best case, this (probably) won’t have the same reliability as SQS has..</div><br/><div id="40840947" class="c"><input type="checkbox" id="c-40840947" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40840916">parent</a><span>|</span><a href="#40841867">next</a><span>|</span><label class="collapse" for="c-40840947">[-]</label><label class="expand" for="c-40840947">[2 more]</label></div><br/><div class="children"><div class="content">I break it down two ways.<p>First, the project does not yet have a distributed implementation, you’re correct. Stay tuned!<p>Second, SQLite is incidental. Data is still stored on disk, just as SQS must be, but I’ve chosen SQLite as the file format for now.</div><br/><div id="40841637" class="c"><input type="checkbox" id="c-40841637" checked=""/><div class="controls bullet"><span class="by">22c</span><span>|</span><a href="#40840916">root</a><span>|</span><a href="#40840947">parent</a><span>|</span><a href="#40841867">next</a><span>|</span><label class="collapse" for="c-40841637">[-]</label><label class="expand" for="c-40841637">[1 more]</label></div><br/><div class="children"><div class="content">Strictly speaking, SQS does not necessarily store data on disk and being highly available and fault tolerant does not exclude one from operating a completely volatile data store. Indeed, SQLite itself has an in-memory option which, when appropriately architected, could be used as the primary data store for a highly available and fault tolerant queue.<p>Having said that, I think it is safe to assume that SQS probably stores information to non-volatile storage.<p>Nice work on the project!</div><br/></div></div></div></div><div id="40841867" class="c"><input type="checkbox" id="c-40841867" checked=""/><div class="controls bullet"><span class="by">parhamn</span><span>|</span><a href="#40840916">parent</a><span>|</span><a href="#40840947">prev</a><span>|</span><a href="#40838269">next</a><span>|</span><label class="collapse" for="c-40841867">[-]</label><label class="expand" for="c-40841867">[1 more]</label></div><br/><div class="children"><div class="content">The choice of SQLite is a great one as the distributed sqlite space is also growing. You have things like rqlite (raft+sqlite), and you have cloudservices like CloudFlare D1 which is basically distributed&#x2F;HA sqlite. Plus you can swap it for basically any other sql database.</div><br/></div></div></div></div><div id="40838269" class="c"><input type="checkbox" id="c-40838269" checked=""/><div class="controls bullet"><span class="by">yimpolo</span><span>|</span><a href="#40840916">prev</a><span>|</span><a href="#40838725">next</a><span>|</span><label class="collapse" for="c-40838269">[-]</label><label class="expand" for="c-40838269">[2 more]</label></div><br/><div class="children"><div class="content">This is super cool! I love projects that aim to create simple self-hostable alternatives to popular services.<p>I assume this would work without much issue with Litestream, though I&#x27;m curious if you&#x27;ve already tried it. This would make a great ephemeral queue system without having to worry about coordinating backend storage.</div><br/><div id="40838294" class="c"><input type="checkbox" id="c-40838294" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838269">parent</a><span>|</span><a href="#40838725">next</a><span>|</span><label class="collapse" for="c-40838294">[-]</label><label class="expand" for="c-40838294">[1 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t tried this with litestream! It will be worth exploring that as a replication strategy.<p>The nice thing about queues is that backend storage doesn&#x27;t really need to be coordinated. Like, you could have two servers, with two sets of messages, and the client can just pull from them round robin. They (mostly) don&#x27;t need to coordinate at all for this to work.<p>However, this is different for replication where we have multiple nodes as backups.</div><br/></div></div></div></div><div id="40838725" class="c"><input type="checkbox" id="c-40838725" checked=""/><div class="controls bullet"><span class="by">philippta</span><span>|</span><a href="#40838269">prev</a><span>|</span><a href="#40840183">next</a><span>|</span><label class="collapse" for="c-40838725">[-]</label><label class="expand" for="c-40838725">[4 more]</label></div><br/><div class="children"><div class="content">One quick suggestion on project structure:<p>Move all the structs from models&#x2F; into the root directory.<p>This allow users of this package to have nice and short names like: q.Message and q.Queue, and avoids import naming conflicts if the user has its own „models“ package.</div><br/><div id="40840503" class="c"><input type="checkbox" id="c-40840503" checked=""/><div class="controls bullet"><span class="by">pqb</span><span>|</span><a href="#40838725">parent</a><span>|</span><a href="#40838771">next</a><span>|</span><label class="collapse" for="c-40840503">[-]</label><label class="expand" for="c-40840503">[1 more]</label></div><br/><div class="children"><div class="content">Actually, the &quot;model&#x2F;&quot; (note: singular form) directory (package model) would be preferred in the golang world.</div><br/></div></div><div id="40838771" class="c"><input type="checkbox" id="c-40838771" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838725">parent</a><span>|</span><a href="#40840503">prev</a><span>|</span><a href="#40840183">next</a><span>|</span><label class="collapse" for="c-40838771">[-]</label><label class="expand" for="c-40838771">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for the tip - and for even looking at the code! I always struggle to figure out how to organize things.</div><br/><div id="40838805" class="c"><input type="checkbox" id="c-40838805" checked=""/><div class="controls bullet"><span class="by">philippta</span><span>|</span><a href="#40838725">root</a><span>|</span><a href="#40838771">parent</a><span>|</span><a href="#40840183">next</a><span>|</span><label class="collapse" for="c-40838805">[-]</label><label class="expand" for="c-40838805">[1 more]</label></div><br/><div class="children"><div class="content">Just noticed that your root directory is already „package main“ so you can either move that to &#x2F;cmd&#x2F;something&#x2F; or simply rename models&#x2F; to q&#x2F;. That would have the same effect and is also idiomatic.</div><br/></div></div></div></div></div></div><div id="40840183" class="c"><input type="checkbox" id="c-40840183" checked=""/><div class="controls bullet"><span class="by">john-tells-all</span><span>|</span><a href="#40838725">prev</a><span>|</span><a href="#40838206">next</a><span>|</span><label class="collapse" for="c-40840183">[-]</label><label class="expand" for="c-40840183">[6 more]</label></div><br/><div class="children"><div class="content">Why not use LocalStack? It has SQS and a <i>lot</i> of AWS services for testing&#x2F;development. Well documented, open source.<p><a href="https:&#x2F;&#x2F;docs.localstack.cloud&#x2F;overview&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.localstack.cloud&#x2F;overview&#x2F;</a></div><br/><div id="40840258" class="c"><input type="checkbox" id="c-40840258" checked=""/><div class="controls bullet"><span class="by">crazysim</span><span>|</span><a href="#40840183">parent</a><span>|</span><a href="#40840363">next</a><span>|</span><label class="collapse" for="c-40840258">[-]</label><label class="expand" for="c-40840258">[3 more]</label></div><br/><div class="children"><div class="content">I think the vibe might be that this is something someone could use for production.</div><br/><div id="40842262" class="c"><input type="checkbox" id="c-40842262" checked=""/><div class="controls bullet"><span class="by">mtndew4brkfst</span><span>|</span><a href="#40840183">root</a><span>|</span><a href="#40840258">parent</a><span>|</span><a href="#40840363">next</a><span>|</span><label class="collapse" for="c-40842262">[-]</label><label class="expand" for="c-40842262">[2 more]</label></div><br/><div class="children"><div class="content">With no distribution model and built on SQLite, it certainly doesn&#x27;t scream &quot;production candidate&quot; to me.</div><br/><div id="40843517" class="c"><input type="checkbox" id="c-40843517" checked=""/><div class="controls bullet"><span class="by">ku1ik</span><span>|</span><a href="#40840183">root</a><span>|</span><a href="#40842262">parent</a><span>|</span><a href="#40840363">next</a><span>|</span><label class="collapse" for="c-40843517">[-]</label><label class="expand" for="c-40843517">[1 more]</label></div><br/><div class="children"><div class="content">There’s more production systems on this planet running on a single node than ones running in a distributed setup. And SQLite is a rock solid database, deployed in more places than Postgres. The only thing here that could be taken when weighing production readiness would be the maturity and stability of this project itself.</div><br/></div></div></div></div></div></div><div id="40840363" class="c"><input type="checkbox" id="c-40840363" checked=""/><div class="controls bullet"><span class="by">mihaitodor</span><span>|</span><a href="#40840183">parent</a><span>|</span><a href="#40840258">prev</a><span>|</span><a href="#40840855">next</a><span>|</span><label class="collapse" for="c-40840363">[-]</label><label class="expand" for="c-40840363">[1 more]</label></div><br/><div class="children"><div class="content">At the very least, I&#x27;m guessing this performs better since it&#x27;s written in Golang.</div><br/></div></div><div id="40840855" class="c"><input type="checkbox" id="c-40840855" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#40840183">parent</a><span>|</span><a href="#40840363">prev</a><span>|</span><a href="#40838206">next</a><span>|</span><label class="collapse" for="c-40840855">[-]</label><label class="expand" for="c-40840855">[1 more]</label></div><br/><div class="children"><div class="content">Because SIMPLE.<p>single exectuable binary<p>golang with sqlite so fast<p>minimal config so no ridiculous hours or days of config and operations<p>This blitzes other ideas for use cases that do not require distributed queues - and that is likely many use cases.</div><br/></div></div></div></div><div id="40838206" class="c"><input type="checkbox" id="c-40838206" checked=""/><div class="controls bullet"><span class="by">stuaxo</span><span>|</span><a href="#40840183">prev</a><span>|</span><a href="#40840044">next</a><span>|</span><label class="collapse" for="c-40838206">[-]</label><label class="expand" for="c-40838206">[11 more]</label></div><br/><div class="children"><div class="content">Good, we need open implementations of all the AWS stuff.<p>I swear they reimplement stuff we have just so there are more places to bill us.</div><br/><div id="40838223" class="c"><input type="checkbox" id="c-40838223" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838206">parent</a><span>|</span><a href="#40839874">next</a><span>|</span><label class="collapse" for="c-40838223">[-]</label><label class="expand" for="c-40838223">[5 more]</label></div><br/><div class="children"><div class="content">Curious: if you were going to switch, how would you want to run this? Would you want to deploy it to your own EC2 instances, or would you want a hosted solution (just as SQS itself is?)</div><br/><div id="40838376" class="c"><input type="checkbox" id="c-40838376" checked=""/><div class="controls bullet"><span class="by">stackskipton</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40838223">parent</a><span>|</span><a href="#40838493">next</a><span>|</span><label class="collapse" for="c-40838376">[-]</label><label class="expand" for="c-40838376">[3 more]</label></div><br/><div class="children"><div class="content">Self hosted probably. Why buy knock off SQS in the cloud when real thing is right there?<p>If you are greenfield and scared of hitching yourself to Amazon, why not go something like RabbitMQ? There is also RabbitMQ cloud providers as well.</div><br/><div id="40838959" class="c"><input type="checkbox" id="c-40838959" checked=""/><div class="controls bullet"><span class="by">jpalomaki</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40838376">parent</a><span>|</span><a href="#40838493">next</a><span>|</span><label class="collapse" for="c-40838959">[-]</label><label class="expand" for="c-40838959">[2 more]</label></div><br/><div class="children"><div class="content">Unless you need the features, I would steer away from the &quot;real message queues&quot;. Running these adds complexity, especially if you want higher availability and they are not always cheap.<p>HTTP based solution is easy to understand and implemented (if basic functionality is enough for your use case). Real MQs obviously have more complex protocols and not all client libraries are perfect.</div><br/><div id="40839090" class="c"><input type="checkbox" id="c-40839090" checked=""/><div class="controls bullet"><span class="by">stackskipton</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40838959">parent</a><span>|</span><a href="#40838493">next</a><span>|</span><label class="collapse" for="c-40839090">[-]</label><label class="expand" for="c-40839090">[1 more]</label></div><br/><div class="children"><div class="content">I find basics of most AMQP systems to be extremely reliable. Message on, one time delivery with message hiding until expiration of TTL. Sure, you can get into some insane setups with RabbitMQ&#x2F;Kafka and that&#x27;s where libraries features don&#x27;t always match up. But SQS probably wouldn&#x27;t work for you either in those cases.</div><br/></div></div></div></div></div></div><div id="40838493" class="c"><input type="checkbox" id="c-40838493" checked=""/><div class="controls bullet"><span class="by">nilamo</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40838223">parent</a><span>|</span><a href="#40838376">prev</a><span>|</span><a href="#40839874">next</a><span>|</span><label class="collapse" for="c-40838493">[-]</label><label class="expand" for="c-40838493">[1 more]</label></div><br/><div class="children"><div class="content">Ideally this would be run within a k8s cluster, to easily fit with the other services.</div><br/></div></div></div></div><div id="40839874" class="c"><input type="checkbox" id="c-40839874" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#40838206">parent</a><span>|</span><a href="#40838223">prev</a><span>|</span><a href="#40840044">next</a><span>|</span><label class="collapse" for="c-40839874">[-]</label><label class="expand" for="c-40839874">[5 more]</label></div><br/><div class="children"><div class="content">SQS is cheap.<p>10m requests for $4.<p>You will need hundreds of millions of requests per month for it to be noticable.<p>And can an implementation like this even help you at that point?</div><br/><div id="40840732" class="c"><input type="checkbox" id="c-40840732" checked=""/><div class="controls bullet"><span class="by">mlhpdx</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40839874">parent</a><span>|</span><a href="#40839980">next</a><span>|</span><label class="collapse" for="c-40840732">[-]</label><label class="expand" for="c-40840732">[1 more]</label></div><br/><div class="children"><div class="content">Not just cheap per message, but queues themselves are free so there is zero “reserved” cost - it’s pay per message.<p>Add to that, it’s enormously scalable in terms of throughput and retained messages.<p>And it’s globally available.<p>A single file app is no comparison, really. The value of SQS is in the engineering.</div><br/></div></div><div id="40839980" class="c"><input type="checkbox" id="c-40839980" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40839874">parent</a><span>|</span><a href="#40840732">prev</a><span>|</span><a href="#40840044">next</a><span>|</span><label class="collapse" for="c-40839980">[-]</label><label class="expand" for="c-40839980">[3 more]</label></div><br/><div class="children"><div class="content">Question: is there any feature set (in contrast to pricing) that would make it worthwhile for someone to switch?</div><br/><div id="40840736" class="c"><input type="checkbox" id="c-40840736" checked=""/><div class="controls bullet"><span class="by">threecheese</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40839980">parent</a><span>|</span><a href="#40840044">next</a><span>|</span><label class="collapse" for="c-40840736">[-]</label><label class="expand" for="c-40840736">[2 more]</label></div><br/><div class="children"><div class="content">Operations. At my $bigCo we are always rolling our own ops tooling for queues, as it’s more than just “reprocess message”; there is always some business logic that separates different types of consumers&#x2F;destinations, and so q management is never straightforward. Might be a differentiable feature.</div><br/><div id="40840778" class="c"><input type="checkbox" id="c-40840778" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838206">root</a><span>|</span><a href="#40840736">parent</a><span>|</span><a href="#40840044">next</a><span>|</span><label class="collapse" for="c-40840778">[-]</label><label class="expand" for="c-40840778">[1 more]</label></div><br/><div class="children"><div class="content">Can you tell me more about the types of queue things you need to implement? (Feel free to email me too - I’d be grateful for the feedback!)</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40840044" class="c"><input type="checkbox" id="c-40840044" checked=""/><div class="controls bullet"><span class="by">koito17</span><span>|</span><a href="#40838206">prev</a><span>|</span><a href="#40842654">next</a><span>|</span><label class="collapse" for="c-40840044">[-]</label><label class="expand" for="c-40840044">[3 more]</label></div><br/><div class="children"><div class="content">I may be asking a naive question, but what is the rationale behind disabling foreign key support and using them anyway in the database schema? See <a href="https:&#x2F;&#x2F;github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;blob&#x2F;46f8b22&#x2F;queue&#x2F;sqlite&#x2F;sqlite.go#L56-L88">https:&#x2F;&#x2F;github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;blob&#x2F;46f8b22&#x2F;queue&#x2F;sq...</a><p>The &quot;TODO: check for errors&quot; comment, combined with what seems like disabling foreign key constraint checks, makes me a bit hesitant to try this out.</div><br/><div id="40840114" class="c"><input type="checkbox" id="c-40840114" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40840044">parent</a><span>|</span><a href="#40842654">next</a><span>|</span><label class="collapse" for="c-40840114">[-]</label><label class="expand" for="c-40840114">[2 more]</label></div><br/><div class="children"><div class="content">Good question. It was an evolution. Originally I enforced foreign keys, but inserts&#x2F;updates were unbearably slow. So I updated the connection string to disable them (but, as you point out, I haven&#x27;t updated the CREATE TABLE statements.)<p>In practice, I did not find they were necessary - I was only using foreign keys to automatically CASCADE deletes when messages were removed. But instead of relying on sqlite to do that, I do it myself and wrap the delete statements in transactions.<p>There are many TODOs and error checkings that I will, over time, clean up and remove. I&#x27;m glad you&#x27;ve pointed them out - that&#x27;s the great thing about open source, you at least <i>know</i> what you&#x27;re getting into and can help shine a light on things to improve!</div><br/><div id="40840385" class="c"><input type="checkbox" id="c-40840385" checked=""/><div class="controls bullet"><span class="by">plasma</span><span>|</span><a href="#40840044">root</a><span>|</span><a href="#40840114">parent</a><span>|</span><a href="#40842654">next</a><span>|</span><label class="collapse" for="c-40840385">[-]</label><label class="expand" for="c-40840385">[1 more]</label></div><br/><div class="children"><div class="content">Some of the slowdown will come from not indexing the FK columns themselves, as they need to be searched during updates &#x2F; deletes to check the constraints.</div><br/></div></div></div></div></div></div><div id="40842654" class="c"><input type="checkbox" id="c-40842654" checked=""/><div class="controls bullet"><span class="by">dracarys18</span><span>|</span><a href="#40840044">prev</a><span>|</span><a href="#40838384">next</a><span>|</span><label class="collapse" for="c-40842654">[-]</label><label class="expand" for="c-40842654">[1 more]</label></div><br/><div class="children"><div class="content">The only reason I use SQS is because how it&#x27;s compatible with other AWS Services, I can have an S3 bucket whenever there&#x27;s an upload I can send an SQS Message and I can have it trigger a lambda.</div><br/></div></div><div id="40838384" class="c"><input type="checkbox" id="c-40838384" checked=""/><div class="controls bullet"><span class="by">chromanoid</span><span>|</span><a href="#40842654">prev</a><span>|</span><a href="#40843354">next</a><span>|</span><label class="collapse" for="c-40838384">[-]</label><label class="expand" for="c-40838384">[2 more]</label></div><br/><div class="children"><div class="content">Could you elaborate why you didn&#x27;t choose e.g. RabbitMQ? I mean you talk about AMQP and such, it seems to me, that a client-side abstraction would be much more efficient in providing an exit strategy for SQS than creating an SQS &quot;compatible&quot; broker. For example in the Java ecosystem there is <a href="https:&#x2F;&#x2F;smallrye.io&#x2F;smallrye-reactive-messaging&#x2F;latest&#x2F;" rel="nofollow">https:&#x2F;&#x2F;smallrye.io&#x2F;smallrye-reactive-messaging&#x2F;latest&#x2F;</a> that serves a similar purpose.</div><br/><div id="40842365" class="c"><input type="checkbox" id="c-40842365" checked=""/><div class="controls bullet"><span class="by">westurner</span><span>|</span><a href="#40838384">parent</a><span>|</span><a href="#40843354">next</a><span>|</span><label class="collapse" for="c-40842365">[-]</label><label class="expand" for="c-40842365">[1 more]</label></div><br/><div class="children"><div class="content">Where AWS is the likely migration path for an app if it needs to be scaled beyond dev containers, already having tested with an SQS workalike prevents rework.<p>The celery Backends and Brokers docs compare SQS and RabbitMQ AMQP: 
<a href="https:&#x2F;&#x2F;docs.celeryq.dev&#x2F;en&#x2F;stable&#x2F;getting-started&#x2F;backends-and-brokers&#x2F;index.html#broker-overview" rel="nofollow">https:&#x2F;&#x2F;docs.celeryq.dev&#x2F;en&#x2F;stable&#x2F;getting-started&#x2F;backends-...</a><p>Celery&#x27;s flower utility doesn&#x27;t work with SQS or GCP&#x27;s {Cloud Tasks, Cloud Pub&#x2F;Sub, Firebase Cloud Messaging FWIU} but does work with AMQP, which is a reliable messaging protocol.<p>RabbitMQ is backed by mnesia, an Erlang&#x2F;OTP library for distributed Durable data storage. Mnesia: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mnesia" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mnesia</a><p>SQLite is written in C and has lots of tests because aerospace IIUC.<p>There are many extensions of SQLite; rqlite, cr-sqlite, postlite, electricsql, sqledge, and also WASM: sqlite-wasm, sqlite-wasm-http<p>celery&#x2F;kombu &gt; Transport brokers support &#x2F; comparison table: <a href="https:&#x2F;&#x2F;github.com&#x2F;celery&#x2F;kombu?tab=readme-ov-file#transport-comparison">https:&#x2F;&#x2F;github.com&#x2F;celery&#x2F;kombu?tab=readme-ov-file#transport...</a><p>Kombu has supported Apache Kafka since 2022, but celery doesn&#x27;t yet support Kafka: <a href="https:&#x2F;&#x2F;github.com&#x2F;celery&#x2F;celery&#x2F;issues&#x2F;7674#issuecomment-1204053595">https:&#x2F;&#x2F;github.com&#x2F;celery&#x2F;celery&#x2F;issues&#x2F;7674#issuecomment-12...</a></div><br/></div></div></div></div><div id="40843354" class="c"><input type="checkbox" id="c-40843354" checked=""/><div class="controls bullet"><span class="by">TheAnkurTyagi</span><span>|</span><a href="#40838384">prev</a><span>|</span><a href="#40838832">next</a><span>|</span><label class="collapse" for="c-40843354">[-]</label><label class="expand" for="c-40843354">[1 more]</label></div><br/><div class="children"><div class="content">sounds like a great project. How do you handle performance with large message sizes?</div><br/></div></div><div id="40838832" class="c"><input type="checkbox" id="c-40838832" checked=""/><div class="controls bullet"><span class="by">mannyv</span><span>|</span><a href="#40843354">prev</a><span>|</span><a href="#40838862">next</a><span>|</span><label class="collapse" for="c-40838832">[-]</label><label class="expand" for="c-40838832">[2 more]</label></div><br/><div class="children"><div class="content">So I assume it does the back-end as well?<p>I never cared to figure out what parts of SQS are clients-side and server side, but - does SmoothMQ support long polling, batch delivery, visibility timeouts, error handling, and - triggers? Or are triggers left to whatever is implementing the queue? Both FiFo and simple queues? Do you have throughput numbers?<p>As an SQS user, a table of SQS features vs SmoothMQ would be handy. If it&#x27;s just an API-compatible front-end then that would be good to know. But if it does more that would also be good to know.<p>The reason you&#x27;d use this is because there are lots of clients who still want on-prem solutions (go figure). Being able to switch targets this way would be handy.</div><br/><div id="40838956" class="c"><input type="checkbox" id="c-40838956" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838832">parent</a><span>|</span><a href="#40838862">next</a><span>|</span><label class="collapse" for="c-40838956">[-]</label><label class="expand" for="c-40838956">[1 more]</label></div><br/><div class="children"><div class="content">Everything here is on the backend. The client does very little except make api calls.<p>It implements many of these features so far (ie, visibility timeouts) and there are some that are still in progress (long polling.) a compatibility table is a good idea.</div><br/></div></div></div></div><div id="40838862" class="c"><input type="checkbox" id="c-40838862" checked=""/><div class="controls bullet"><span class="by">deskr</span><span>|</span><a href="#40838832">prev</a><span>|</span><a href="#40840683">next</a><span>|</span><label class="collapse" for="c-40838862">[-]</label><label class="expand" for="c-40838862">[2 more]</label></div><br/><div class="children"><div class="content">Perhaps do a small example application.<p><pre><code>  go  get github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;models
  go: github.com&#x2F;poundifdef&#x2F;SmoothMQ@v0.0.0-20240630162953-46f8b2266d60 requires go &gt;= 1.22.2; switching to go1.22.4
  go: github.com&#x2F;poundifdef&#x2F;SmoothMQ@v0.0.0-20240630162953-46f8b2266d60 (matching github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;models@upgrade) requires github.com&#x2F;poundifdef&#x2F;SmoothMQ@v0.0.0-20240630162953-46f8b2266d60: parsing go.mod:
          module declares its path as: q
                  but was required as: github.com&#x2F;poundifdef&#x2F;SmoothMQ</code></pre></div><br/><div id="40838974" class="c"><input type="checkbox" id="c-40838974" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838862">parent</a><span>|</span><a href="#40840683">next</a><span>|</span><label class="collapse" for="c-40838974">[-]</label><label class="expand" for="c-40838974">[1 more]</label></div><br/><div class="children"><div class="content">Good idea! fyi this is not meant to be used as a library. It runs as a standalone server, and then your application connects to it using an existing AWS sdk.</div><br/></div></div></div></div><div id="40840683" class="c"><input type="checkbox" id="c-40840683" checked=""/><div class="controls bullet"><span class="by">threecheese</span><span>|</span><a href="#40838862">prev</a><span>|</span><a href="#40838150">next</a><span>|</span><label class="collapse" for="c-40840683">[-]</label><label class="expand" for="c-40840683">[1 more]</label></div><br/><div class="children"><div class="content">There is a lot of new ecosystem being built around SQLite in the browser using wasm, as a primary data store or as a local replica for every client, and there are some interesting interactions with crdt and peer to peer applications; does this fit into your business case? Would be interesting to see a massively distributed - via browser embedding - queue, that even uses standard sqs bindings.</div><br/></div></div><div id="40838150" class="c"><input type="checkbox" id="c-40838150" checked=""/><div class="controls bullet"><span class="by">systemz</span><span>|</span><a href="#40840683">prev</a><span>|</span><a href="#40838385">next</a><span>|</span><label class="collapse" for="c-40838150">[-]</label><label class="expand" for="c-40838150">[2 more]</label></div><br/><div class="children"><div class="content">Very cool. I needed something like this.
Looking at short video in readme - I suspect adding live stats similar to sidekiq would make UI look more dynamic and allow quick diagnostics.
Docs for current features are more important though.</div><br/><div id="40838199" class="c"><input type="checkbox" id="c-40838199" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838150">parent</a><span>|</span><a href="#40838385">next</a><span>|</span><label class="collapse" for="c-40838199">[-]</label><label class="expand" for="c-40838199">[1 more]</label></div><br/><div class="children"><div class="content">Can you tell me more about why you needed this (and what you ended up using?)<p>Totally agree on adding more metrics and information to the UI - but how much of that should be on the dashboard vs exposed as a prometheus metric for someone to use their dashboard tool of choice?<p>I am not very good at visual design and have chosen the simplest possible tech to build it (static rendering + fomanticUI). I sometimes wonder if the lack of react or tailwind or truly beautiful elements will hold the project back.</div><br/></div></div></div></div><div id="40838385" class="c"><input type="checkbox" id="c-40838385" checked=""/><div class="controls bullet"><span class="by">rmbyrro</span><span>|</span><a href="#40838150">prev</a><span>|</span><a href="#40838079">next</a><span>|</span><label class="collapse" for="c-40838385">[-]</label><label class="expand" for="c-40838385">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d have named it MQLite. Congrats on finishing and delivering a project, this is quite a challenge in itself. I think SQLite can be a great alternative for many kinds of projects.</div><br/></div></div><div id="40838079" class="c"><input type="checkbox" id="c-40838079" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#40838385">prev</a><span>|</span><a href="#40840223">next</a><span>|</span><label class="collapse" for="c-40838079">[-]</label><label class="expand" for="c-40838079">[4 more]</label></div><br/><div class="children"><div class="content">This looks great! How were you planning on tackling distributed?</div><br/><div id="40838171" class="c"><input type="checkbox" id="c-40838171" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838079">parent</a><span>|</span><a href="#40840223">next</a><span>|</span><label class="collapse" for="c-40838171">[-]</label><label class="expand" for="c-40838171">[3 more]</label></div><br/><div class="children"><div class="content">This is a great question and something I&#x27;ve been thinking about a lot. Big picture:<p>Each queue node can operate (mostly) independently, and this is good. As a consumer, I don&#x27;t really care where my next message comes from, so I can minimize the amount of data that needs to have a &quot;leader&quot;.<p>The only data that needs to be synced is the list of queues, which doesn&#x27;t change often. If one server is full, it should be able to route a request to another server.<p>When we downscale, we can use S3&#x2F;Dynamo (GCS&#x2F;firestore) to store items and redistribute.<p>There&#x27;s more nitty gritty here (what about FIFO queues? What about replication?) but the fact that the main actions, &quot;enqueue&quot; and &quot;dequeue&quot;, don&#x27;t require lots of coordination makes this easier to reason about comapred to a full RDBMS.</div><br/><div id="40839253" class="c"><input type="checkbox" id="c-40839253" checked=""/><div class="controls bullet"><span class="by">flaminHotSpeedo</span><span>|</span><a href="#40838079">root</a><span>|</span><a href="#40838171">parent</a><span>|</span><a href="#40838497">next</a><span>|</span><label class="collapse" for="c-40839253">[-]</label><label class="expand" for="c-40839253">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re hand-waving away all the complexity in the &quot;nitty gritty.&quot;<p>Enqueue absolutely requires coordination, if not via leader then at least amongst multiple nodes, if you want to guarantee at least once delivery<p>If you don&#x27;t guarantee that, cool, but you&#x27;re not competing with sqs</div><br/></div></div><div id="40838497" class="c"><input type="checkbox" id="c-40838497" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#40838079">root</a><span>|</span><a href="#40838171">parent</a><span>|</span><a href="#40839253">prev</a><span>|</span><a href="#40840223">next</a><span>|</span><label class="collapse" for="c-40838497">[-]</label><label class="expand" for="c-40838497">[1 more]</label></div><br/><div class="children"><div class="content">This would increase the complexity, but you could always run something like rqlite [0], even if only for the items that require distribution and synchronization.<p>Or if you truly only need to store simple values in a distributed fashion, you could probably use etcd for that part.<p>[0]: <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;</a></div><br/></div></div></div></div></div></div><div id="40840223" class="c"><input type="checkbox" id="c-40840223" checked=""/><div class="controls bullet"><span class="by">neuroscisoft</span><span>|</span><a href="#40838079">prev</a><span>|</span><a href="#40841872">next</a><span>|</span><label class="collapse" for="c-40840223">[-]</label><label class="expand" for="c-40840223">[1 more]</label></div><br/><div class="children"><div class="content">This is very interesting! The self-hosted aspect is something I&#x27;ll have to consider for certain purposes.<p>My lab also developed an SQS-esque system based on the filesystem, so no dependencies whatsoever and no need for any operational system other than the OS. It doesn&#x27;t support all SQS commands (because we haven&#x27;t needed them), but it also supports commands that SQS doesn&#x27;t have (like release all messages to visible status).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;seung-lab&#x2F;python-task-queue">https:&#x2F;&#x2F;github.com&#x2F;seung-lab&#x2F;python-task-queue</a></div><br/></div></div><div id="40841872" class="c"><input type="checkbox" id="c-40841872" checked=""/><div class="controls bullet"><span class="by">leetrout</span><span>|</span><a href="#40840223">prev</a><span>|</span><a href="#40840024">next</a><span>|</span><label class="collapse" for="c-40841872">[-]</label><label class="expand" for="c-40841872">[1 more]</label></div><br/><div class="children"><div class="content">Glad to find out what you&#x27;ve been up to! Very cool and I am excited to see where you take this.</div><br/></div></div><div id="40840024" class="c"><input type="checkbox" id="c-40840024" checked=""/><div class="controls bullet"><span class="by">pqdbr</span><span>|</span><a href="#40841872">prev</a><span>|</span><a href="#40839342">next</a><span>|</span><label class="collapse" for="c-40840024">[-]</label><label class="expand" for="c-40840024">[1 more]</label></div><br/><div class="children"><div class="content">How would one use this to replace Sidekiq for instance?<p>Rate limiting is something I miss on Sidekiq (only available on the premium plan that I can&#x27;t afford) and the gems that extend it break compatibility often.</div><br/></div></div><div id="40839342" class="c"><input type="checkbox" id="c-40839342" checked=""/><div class="controls bullet"><span class="by">encoderer</span><span>|</span><a href="#40840024">prev</a><span>|</span><a href="#40838115">next</a><span>|</span><label class="collapse" for="c-40839342">[-]</label><label class="expand" for="c-40839342">[1 more]</label></div><br/><div class="children"><div class="content">I think it’s better to say it’s sqs compatible versus an sqs replacement.</div><br/></div></div><div id="40838115" class="c"><input type="checkbox" id="c-40838115" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#40839342">prev</a><span>|</span><a href="#40838096">next</a><span>|</span><label class="collapse" for="c-40838115">[-]</label><label class="expand" for="c-40838115">[2 more]</label></div><br/><div class="children"><div class="content">Minor thing - the gif browser demo should have been maximized. The video zooming into the action on what would have fit onto a single screen was distracting.<p>Are there maintenance actions that the admin needs to perform on the database? How are those done?</div><br/><div id="40838147" class="c"><input type="checkbox" id="c-40838147" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838115">parent</a><span>|</span><a href="#40838096">next</a><span>|</span><label class="collapse" for="c-40838147">[-]</label><label class="expand" for="c-40838147">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the feedback - agree on the gif. Also it should probably show real messages an an example instead of rand().<p>re: maintenance - I have tried to build this to be hands-off. The only storage this uses is SQLite, and I have the code set to automatically vacuum as space increases.<p>It also has a &#x2F;metrics endpoint which has disk size. This is going to be used for two things in the future: first, as a metric for autoscaling (scale when disk is full) and second so that a server can stop serving requests when its disk is full (to prevent catastrophic failure.)</div><br/></div></div></div></div><div id="40838096" class="c"><input type="checkbox" id="c-40838096" checked=""/><div class="controls bullet"><span class="by">okr</span><span>|</span><a href="#40838115">prev</a><span>|</span><a href="#40838257">next</a><span>|</span><label class="collapse" for="c-40838096">[-]</label><label class="expand" for="c-40838096">[2 more]</label></div><br/><div class="children"><div class="content">A testcontainer could be useful. I use always this adobe-mock from s3 for my test. Hmm.</div><br/><div id="40838119" class="c"><input type="checkbox" id="c-40838119" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838096">parent</a><span>|</span><a href="#40838257">next</a><span>|</span><label class="collapse" for="c-40838119">[-]</label><label class="expand" for="c-40838119">[1 more]</label></div><br/><div class="children"><div class="content">I was not aware of testcontainer until you just mentioned it! I have a very basic Dockerfile for deploying to fly.io. What&#x2F;how would I get started?<p>It looks like localstack is a supported testcontainer and they do support SQS (but I haven&#x27;t tried it myself.)</div><br/></div></div></div></div><div id="40838357" class="c"><input type="checkbox" id="c-40838357" checked=""/><div class="controls bullet"><span class="by">12_throw_away</span><span>|</span><a href="#40838257">prev</a><span>|</span><a href="#40840839">next</a><span>|</span><label class="collapse" for="c-40838357">[-]</label><label class="expand" for="c-40838357">[3 more]</label></div><br/><div class="children"><div class="content">Actually pretty excited to try this, there are so many cases where I need a bare-bones (aka &quot;simple&quot;), local, persistent queue, but all the usual suspects (amqp, apache whatever, cloud nonsense, etc.) are way too heavy.<p>I&#x27;ll probably try poking at it directly through the HTTP API rather than an SDK ... does it need AWS V4 auth signatures or anything?</div><br/><div id="40838383" class="c"><input type="checkbox" id="c-40838383" checked=""/><div class="controls bullet"><span class="by">memset</span><span>|</span><a href="#40838357">parent</a><span>|</span><a href="#40838393">next</a><span>|</span><label class="collapse" for="c-40838383">[-]</label><label class="expand" for="c-40838383">[1 more]</label></div><br/><div class="children"><div class="content">The only HTTP API that is exposed is actually the SQS one. (I&#x27;m not opposed to a &quot;regular&quot; HTTP API but the goal was to make it easy for people to use existing libraries.)<p>If you do use your language&#x27;s AWS SDK, the code handles [1] all of the V4 auth stuff. <a href="https:&#x2F;&#x2F;github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;blob&#x2F;main&#x2F;protocols&#x2F;sqs&#x2F;sigv4.go">https:&#x2F;&#x2F;github.com&#x2F;poundifdef&#x2F;SmoothMQ&#x2F;blob&#x2F;main&#x2F;protocols&#x2F;s...</a><p>I&#x27;d love your feedback! Particularly the difficulties you find in running it, of which I&#x27;m sure there are many, so I can fix them or update docs.</div><br/></div></div><div id="40838393" class="c"><input type="checkbox" id="c-40838393" checked=""/><div class="controls bullet"><span class="by">stackskipton</span><span>|</span><a href="#40838357">parent</a><span>|</span><a href="#40838383">prev</a><span>|</span><a href="#40840839">next</a><span>|</span><label class="collapse" for="c-40838393">[-]</label><label class="expand" for="c-40838393">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d also give a shout out to beanstalkd. I use it to teach message systems and it&#x27;s great.</div><br/></div></div></div></div><div id="40840839" class="c"><input type="checkbox" id="c-40840839" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#40838357">prev</a><span>|</span><label class="collapse" for="c-40840839">[-]</label><label class="expand" for="c-40840839">[1 more]</label></div><br/><div class="children"><div class="content">I wrote sasquatch which is similar.  sasquatch is more simple than SQS and queues are virtual (i.e the queue exists because you put a message in it, and is gone when there&#x27;s no messages in it).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;crowdwave&#x2F;sasquatch">https:&#x2F;&#x2F;github.com&#x2F;crowdwave&#x2F;sasquatch</a><p>sasquatch is also a message queue, also written in Golang and also based on sqlite.<p>sasquatch implements behaviour very similar to SQS but does not attempt to be a dropin replacement.<p>sqsquatch is not a complete project though, nor even really a prototype, just early code.  Likely it does not compile.<p>HOWEVER - sasquatch is MIT license (versus this project which is AGPL) so you are free to do with it as you choose.<p>sasquatch is a single file of 700 lines so easy to get your head around: 
<a href="https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;crowdwave&#x2F;sasquatch&#x2F;main&#x2F;sasquatch.go" rel="nofollow">https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;crowdwave&#x2F;sasquatch&#x2F;main&#x2F;s...</a><p>Just remember as I say it&#x27;s early code, won&#x27;t even compile yet but functionally should be complete.</div><br/></div></div></div></div></div></div></div></body></html>