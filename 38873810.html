<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704445253794" as="style"/><link rel="stylesheet" href="styles.css?v=1704445253794"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://smallstep.com/blog/home-network-eap-tls-wifi/">WPA3 Enterprise 192-bit mode at home</a> <span class="domain">(<a href="https://smallstep.com">smallstep.com</a>)</span></div><div class="subtext"><span>tashian</span> | <span>146 comments</span></div><br/><div><div id="38874653" class="c"><input type="checkbox" id="c-38874653" checked=""/><div class="controls bullet"><span class="by">xoa</span><span>|</span><a href="#38874047">next</a><span>|</span><label class="collapse" for="c-38874653">[-]</label><label class="expand" for="c-38874653">[16 more]</label></div><br/><div class="children"><div class="content">Personally I&#x27;ve  essentially given up on depending on WiFi auth for anything important. For general access, segmenting various users, IOT etc for performance, monitoring and light privacy WPA-EAP and PPSKs with VLANs does some work as an initial first layer fine and in a simple reliable way that works with everything. It&#x27;s a low pass filter.<p>But for all sensitive access I use internal Wireguard now. WiFi auth gets a client onto a restricted VLAN in the first place, but from there only a VPN will get to management webguis, sensitive services, or unrestricted internet access. Regrettably the design process for WPA3 was the same old mediocre industry affair. It&#x27;s not worth trying to put many bandaids on vs just moving things to a higher level. As a practical matter WiFi also just isn&#x27;t that fast vs high performance clients, it&#x27;s not like WG has to handle tens of gigabits, so there isn&#x27;t even any downside in performance.<p>WiFi auth at this point kinda feels like a polite lock on the screen door. Not useless at all, but anything really important should have other layers in front that are more secure by design from the ground up.</div><br/><div id="38875588" class="c"><input type="checkbox" id="c-38875588" checked=""/><div class="controls bullet"><span class="by">callalex</span><span>|</span><a href="#38874653">parent</a><span>|</span><a href="#38874701">next</a><span>|</span><label class="collapse" for="c-38875588">[-]</label><label class="expand" for="c-38875588">[7 more]</label></div><br/><div class="children"><div class="content">What is your threat model to warrant this effort at home? Are your work-related machines not networking through an encrypted tunnel in some other way (that would be a serious oversight!)? What government are you living under that is routinely compromising WPA3 from mobile vans? Are friends&#x2F;guests so untrustworthy that you can allow them into your home but can’t trust the VLAN implementation of your network equipment to protect you from them accessing your network admin plane?<p>I’m asking incredulous and probing questions because I used to live life the way you are currently, and it’s frankly unhealthy for the human brain. If “home” feels like such an unsafe place to warrant your current measures, you need to either make serious changes to where home is, or your mental state. Neither is easy but at least one is necessary.</div><br/><div id="38877016" class="c"><input type="checkbox" id="c-38877016" checked=""/><div class="controls bullet"><span class="by">soraminazuki</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875588">parent</a><span>|</span><a href="#38875702">next</a><span>|</span><label class="collapse" for="c-38877016">[-]</label><label class="expand" for="c-38877016">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the wrong question to ask. Instead, we should be asking ourselves, why is it after all these years that we still don&#x27;t have secure and easy to use multi-account WiFi networks with per-account configurable security policies in our homes? It&#x27;s the current state of things that&#x27;s unhealthy, not the people demanding better.<p>Security measures should be evaluated based on their own merits, not by appealing to friendship or any other relationships. We can lock our front doors and have a healthy relationship with our neighbors! These two things aren&#x27;t mutually exclusive. Though I will add that trusting government authorities not to routinely abuse their powers is a hard ask given their track record all across the globe, even in democratic countries.<p>WiFi is ubiquitous and is used to exchange sensitive information 24&#x2F;7. Its compromise can result in financial, reputational, or even physical risk. Considering that raw signals can be intercepted outside of our homes, devices on the network should at the very least be mutually authenticated and their connections encrypted.<p>Also, let&#x27;s not forget about the devices too. Say you trust the people you let into your home. Can you also trust their devices and the software that runs on it? Do you trust your work laptop and its &quot;security&quot; software to respect your privacy? Do you even fully trust your own devices? Do you have faith in current commercial hardware and software to respect boundaries, or even comprehend the concept of user ownership? Because the answer to all these questions increasingly sounds like a &quot;no.&quot;</div><br/></div></div><div id="38875702" class="c"><input type="checkbox" id="c-38875702" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875588">parent</a><span>|</span><a href="#38877016">prev</a><span>|</span><a href="#38875662">next</a><span>|</span><label class="collapse" for="c-38875702">[-]</label><label class="expand" for="c-38875702">[2 more]</label></div><br/><div class="children"><div class="content"><i>&gt; unhealthy for the human brain</i><p>Fortunately, wired networking continues to work reliably, unlike frequently &quot;New and Improved&quot; wireless increments.</div><br/><div id="38876509" class="c"><input type="checkbox" id="c-38876509" checked=""/><div class="controls bullet"><span class="by">solatic</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875702">parent</a><span>|</span><a href="#38875662">next</a><span>|</span><label class="collapse" for="c-38876509">[-]</label><label class="expand" for="c-38876509">[1 more]</label></div><br/><div class="children"><div class="content">Honestly, wired networking can be less secure, depending on your threat model. Not everyone lives in some kind of a physical fortress; breaking into someone&#x27;s house is usually a simple matter of some lock picks that you can buy off the Internet, then compromising the wired network just requires installing an interceptor, not to mention stuff like hardware keyloggers. The truly paranoid user needs to check all their wired connections before each and every use, which few people do. They will need to seal the cases of each of their machines with some kind of tamper-evident seal, with transparent cases to ensure that nothing has been added internally with countermeasures taken against the tamper-evident seal, including the cases on the video cameras that they have set up to try and catch would-be intruders.<p>The point remains, people either generally feel safe in their homes, or they don&#x27;t. If you do, then honestly a lot of these security measures are just overkill. If you don&#x27;t, then you should deal with the root cause instead of its symptoms.</div><br/></div></div></div></div><div id="38875662" class="c"><input type="checkbox" id="c-38875662" checked=""/><div class="controls bullet"><span class="by">staplers</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875588">parent</a><span>|</span><a href="#38875702">prev</a><span>|</span><a href="#38875871">next</a><span>|</span><label class="collapse" for="c-38875662">[-]</label><label class="expand" for="c-38875662">[2 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  What government are you living under that is routinely compromising WPA3 from mobile vans?
</code></pre>
I imagine living in any decent sized downtown area would have your network being scanned by thousands of machines daily. Especially if near important infrastructure, law enforcement, etc.</div><br/><div id="38875803" class="c"><input type="checkbox" id="c-38875803" checked=""/><div class="controls bullet"><span class="by">callalex</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875662">parent</a><span>|</span><a href="#38875871">next</a><span>|</span><label class="collapse" for="c-38875803">[-]</label><label class="expand" for="c-38875803">[1 more]</label></div><br/><div class="children"><div class="content">That is not enough for a threat actor to modify the network control plane with WPA3. There are tight timings involved. It is only enough to be able to passively capture packets that can be retroactively decrypted and even then if there isn’t TLS working on those packets you already screwed up worse anyways.</div><br/></div></div></div></div><div id="38875871" class="c"><input type="checkbox" id="c-38875871" checked=""/><div class="controls bullet"><span class="by">unethical_ban</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38875588">parent</a><span>|</span><a href="#38875662">prev</a><span>|</span><a href="#38874701">next</a><span>|</span><label class="collapse" for="c-38875871">[-]</label><label class="expand" for="c-38875871">[1 more]</label></div><br/><div class="children"><div class="content">You might be right, but this person might just be really intuitively good at network config and this is their hobby.</div><br/></div></div></div></div><div id="38874701" class="c"><input type="checkbox" id="c-38874701" checked=""/><div class="controls bullet"><span class="by">ghostpepper</span><span>|</span><a href="#38874653">parent</a><span>|</span><a href="#38875588">prev</a><span>|</span><a href="#38874992">next</a><span>|</span><label class="collapse" for="c-38874701">[-]</label><label class="expand" for="c-38874701">[5 more]</label></div><br/><div class="children"><div class="content">Would love to hear more about how you provision wireguard. I have a simple VLAN setup where I can open a tunnel from my &quot;guest&#x2F;home&quot; network to my &quot;lab&quot; network (ie. docker hosts, desktop PCs that I use for development, etc) and a second tunnel from the lab network to the network that can access mgmt interfaces, however it&#x27;s all mostly manual (ie. sudo wg-quick up in a terminal)</div><br/><div id="38874787" class="c"><input type="checkbox" id="c-38874787" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38874701">parent</a><span>|</span><a href="#38876097">next</a><span>|</span><label class="collapse" for="c-38874787">[-]</label><label class="expand" for="c-38874787">[1 more]</label></div><br/><div class="children"><div class="content">Somewhat related -- with the project I work on, <a href="https:&#x2F;&#x2F;github.com&#x2F;spr-networks&#x2F;super">https:&#x2F;&#x2F;github.com&#x2F;spr-networks&#x2F;super</a>, we do support wireguard peers (and also support combining that wireguard identity with a wifi peer identity as well).<p>Devices are provisioned by assigning or generating a wireguard keypair in the API.<p>Next the peers are routed together by policy and by default can&#x27;t access one another. There&#x27;s support for bidirectional network groups or one-way firewall rules with NAT.<p>One area of improvement is multicast support with wireguard, it&#x27;s doable, just not ready yet.</div><br/></div></div><div id="38876097" class="c"><input type="checkbox" id="c-38876097" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38874701">parent</a><span>|</span><a href="#38874787">prev</a><span>|</span><a href="#38875394">next</a><span>|</span><label class="collapse" for="c-38876097">[-]</label><label class="expand" for="c-38876097">[2 more]</label></div><br/><div class="children"><div class="content">Tailscale. It&#x27;s Wireguard under the hood but with a company doing got UX on top.</div><br/><div id="38876622" class="c"><input type="checkbox" id="c-38876622" checked=""/><div class="controls bullet"><span class="by">whatindaheck</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38876097">parent</a><span>|</span><a href="#38875394">next</a><span>|</span><label class="collapse" for="c-38876622">[-]</label><label class="expand" for="c-38876622">[1 more]</label></div><br/><div class="children"><div class="content">I’m familiar with Tailscale but could you provide more detail on how to use it as an authentication method?<p>The two ways I see:<p>On my home server, only allow incoming connections from the Tailnet. However, this seems lockout prone.<p>Or I could create a VLAN and put all hardwired devices in it. All running Tailscale. But this wouldn’t cover securing my laptop (has to be on WiFi in my situation). This still seems lockout prone?<p>Additionally, the router is still exposed “normally” and can be compromised without requiring VPN access<p>Sorry if this post is a bit of
 A mess. Thanks.</div><br/></div></div></div></div><div id="38875394" class="c"><input type="checkbox" id="c-38875394" checked=""/><div class="controls bullet"><span class="by">xoa</span><span>|</span><a href="#38874653">root</a><span>|</span><a href="#38874701">parent</a><span>|</span><a href="#38876097">prev</a><span>|</span><a href="#38874992">next</a><span>|</span><label class="collapse" for="c-38875394">[-]</label><label class="expand" for="c-38875394">[1 more]</label></div><br/><div class="children"><div class="content">For most stuff I&#x27;ve been comfortable with having my OPNsense gateways be trusted points, which has struck a reasonable balance for me between convenience, security, and compatibility. So I Wireguard into that, and from there it&#x27;s normal firewall and routing in one place, with the ability to lean on hardwired subnets or VLANs so that the universe of old sensitive appliance things (like UPS interfaces) can still be reached. I have site to site wg tunnels between gateways as well. For LAN usage going through a central point has generally not been a significant performance burden, the only thing I have personally that is both very demanding and secure is iSCSI and there I&#x27;ve gone to the trouble of just physically isolating it. Going through a point also means there isn&#x27;t much in the way of provisioning to do, each client just needs the single WG to the gateway for all (or most) traffic and that&#x27;s it. Most stuff can be provisioned with ansible, a few mobile clients though I just use QR codes for manually. I should really try to figure out if Wireguard can be provisioned on iOS&#x2F;Android with MDM but that&#x27;s been a backburner so far.<p>I&#x27;ve started to play around with having some things go exclusively into a Nebula mesh with OPNsense only running a lighthouse, but it&#x27;s more work and rougher. And unlike WG to the gateway and leaning on VLANs for some older kit, really putting everything behind a virtual network they don&#x27;t natively support requires sticking a translator between them and the rest of the network. Fun to play with a little and the potential is cool, but I don&#x27;t think there are any prebaked options as smooth and cheap as would be ideal for that, and I suspect the ROI there at my level is getting pretty dang low. IPMI access is the main place I think might be worth it since that&#x27;s just so sensitive yet simultaneously so useful in resolving issues all while having extremely mediocre security on its own.<p>Whereas WG to the gateway does leave the gateway as a point of failure, but I&#x27;m depending on that to a significant degree for now anyway. And it is fast, simple, reliable, easy to manage&#x2F;reason about, and eliminates layer 2 auth from the picture entirely. Don&#x27;t have to worry about someone plugging into some open ethernet port either for example and any necessary effort to secure those, not just WiFi. Threats may evolve but hopefully the options we have to combat them evolve in concert to some degree. Lots of other HNers are vastly more experienced in this then me, and I&#x27;m not unaware of some of the potential failure points, but it&#x27;s hard sometimes to figure out how to balance risk vs resources we have to spend on them (not just money but time).<p>Also there are other good gateway&#x2F;firewall options like VyOS, or just working directly off your favorite flavor of Linux or OpenBSD or whatever, that might fit your needs&#x2F;preferences&#x2F;tooling better than OPNsense. I don&#x27;t mean to suggest that it is the best choice, it&#x27;s just what I&#x27;ve settled in on as a good balance of other values.</div><br/></div></div></div></div><div id="38874992" class="c"><input type="checkbox" id="c-38874992" checked=""/><div class="controls bullet"><span class="by">doubleg72</span><span>|</span><a href="#38874653">parent</a><span>|</span><a href="#38874701">prev</a><span>|</span><a href="#38876424">next</a><span>|</span><label class="collapse" for="c-38874992">[-]</label><label class="expand" for="c-38874992">[1 more]</label></div><br/><div class="children"><div class="content">And here I just deployed 802.1X wireless and wired across our four hospitals.  Maybe you’re not doing something right.</div><br/></div></div><div id="38876424" class="c"><input type="checkbox" id="c-38876424" checked=""/><div class="controls bullet"><span class="by">bogantech</span><span>|</span><a href="#38874653">parent</a><span>|</span><a href="#38874992">prev</a><span>|</span><a href="#38875400">next</a><span>|</span><label class="collapse" for="c-38876424">[-]</label><label class="expand" for="c-38876424">[1 more]</label></div><br/><div class="children"><div class="content">We already have .1x which supports various auth methods such as certificate auth and can use policies to assign clients to VLANs</div><br/></div></div></div></div><div id="38874047" class="c"><input type="checkbox" id="c-38874047" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38874653">prev</a><span>|</span><a href="#38873895">next</a><span>|</span><label class="collapse" for="c-38874047">[-]</label><label class="expand" for="c-38874047">[25 more]</label></div><br/><div class="children"><div class="content">I want to know why WPA3 doesn&#x27;t have a mode where a password is used <i>for the initial connection</i>, but then the client and AP generate a keypair and each store their half and use that for all future connections.<p>For all future connections, the AP can validate every client, and the client can validate that it is connecting to the same AP.<p>The AP could have an interface to &#x27;revoke&#x27; access to any single client if necessary, and single use passwords could be used too.<p>That would give all the same benefits as WPA Enterprise (after the initial pairing), and all the ease of use of a preshared key.</div><br/><div id="38874091" class="c"><input type="checkbox" id="c-38874091" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38877056">prev</a><span>|</span><a href="#38874427">next</a><span>|</span><label class="collapse" for="c-38874091">[-]</label><label class="expand" for="c-38874091">[12 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not unusual to run multiple APs on a single SSID. Your scheme doesn&#x27;t work for that without coordination between the APs.<p>Also, it means replacing an AP would require reconfiguring all the clients.</div><br/><div id="38874397" class="c"><input type="checkbox" id="c-38874397" checked=""/><div class="controls bullet"><span class="by">dathery</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874091">parent</a><span>|</span><a href="#38874123">next</a><span>|</span><label class="collapse" for="c-38874397">[-]</label><label class="expand" for="c-38874397">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need active coordination for this. APs serving the same SSID could verify client certificates issued from any other AP by verifying that the certificate is signed by a trusted certificate authority. You&#x27;d just need each AP to use the same CA to issue signatures from.<p>You could give each AP its own intermediate CA tracing back to the same root CA to avoid sharing private keys and allow easily revoking certificates signed by a compromised AP.<p>You would only need coordination for revoking client certificates (but you can&#x27;t really avoid that regardless of model).</div><br/></div></div><div id="38874123" class="c"><input type="checkbox" id="c-38874123" checked=""/><div class="controls bullet"><span class="by">nighthawk454</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874091">parent</a><span>|</span><a href="#38874397">prev</a><span>|</span><a href="#38874587">next</a><span>|</span><label class="collapse" for="c-38874123">[-]</label><label class="expand" for="c-38874123">[7 more]</label></div><br/><div class="children"><div class="content">Couldn&#x27;t it just fall back to the password version like it does every time now? Like optionally use the keys if present if not renegotiate</div><br/><div id="38874342" class="c"><input type="checkbox" id="c-38874342" checked=""/><div class="controls bullet"><span class="by">DougN7</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874123">parent</a><span>|</span><a href="#38874225">next</a><span>|</span><label class="collapse" for="c-38874342">[-]</label><label class="expand" for="c-38874342">[1 more]</label></div><br/><div class="children"><div class="content">Is that any stronger than using a password if an attacker could force a connection to fall back to the password?</div><br/></div></div><div id="38874225" class="c"><input type="checkbox" id="c-38874225" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874123">parent</a><span>|</span><a href="#38874342">prev</a><span>|</span><a href="#38874587">next</a><span>|</span><label class="collapse" for="c-38874225">[-]</label><label class="expand" for="c-38874225">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing that&#x27;s going to be an issue for handoffs between APs. Think walking around a multi-story office on a Wi-Fi call. Now picture 30 APs and 100 people on wifi calls&#x2F;VoIP etc. with DHCP recycling addresses, randomized MACs and so forth.</div><br/><div id="38874356" class="c"><input type="checkbox" id="c-38874356" checked=""/><div class="controls bullet"><span class="by">klyrs</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874225">parent</a><span>|</span><a href="#38874587">next</a><span>|</span><label class="collapse" for="c-38874356">[-]</label><label class="expand" for="c-38874356">[4 more]</label></div><br/><div class="children"><div class="content">Is there any obstacle to having a centralized server these APs talk to, which manages authentication?  I&#x27;m not seeing a hard obstacle, just another piece of network kit and it&#x27;s cheaper to keep a clunky UX</div><br/><div id="38874401" class="c"><input type="checkbox" id="c-38874401" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874356">parent</a><span>|</span><a href="#38874381">next</a><span>|</span><label class="collapse" for="c-38874401">[-]</label><label class="expand" for="c-38874401">[2 more]</label></div><br/><div class="children"><div class="content">In theory I suppose. But you have to take into account that these APs can potentially be on different subnets, physical networks, talking across ipsec tunnels, dealing with multiple VLANs etc. There&#x27;s just more overhead. It&#x27;s easier to push out the info to the APs than to pull from who knows where.<p>Edit: For example:
Say you have two buildings connected via an ipsec tunnel&#x2F;static route. You have 4 wifi networks on 4 separate VLANs, 2 per building, guest and internal. Generally you&#x27;ll have an internal wifi controller on an infra VLAN as well.<p>The wifi VLANs are not allowed to route to the infra VLAN, but infra can route to wifi. Rather than punching holes back allowing the the APs to talk to infra, you push out from infra to the APs.</div><br/></div></div><div id="38874381" class="c"><input type="checkbox" id="c-38874381" checked=""/><div class="controls bullet"><span class="by">blibble</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874356">parent</a><span>|</span><a href="#38874401">prev</a><span>|</span><a href="#38874587">next</a><span>|</span><label class="collapse" for="c-38874381">[-]</label><label class="expand" for="c-38874381">[1 more]</label></div><br/><div class="children"><div class="content">you just described RADIUS</div><br/></div></div></div></div></div></div></div></div><div id="38874587" class="c"><input type="checkbox" id="c-38874587" checked=""/><div class="controls bullet"><span class="by">mcv</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874091">parent</a><span>|</span><a href="#38874123">prev</a><span>|</span><a href="#38874346">next</a><span>|</span><label class="collapse" for="c-38874587">[-]</label><label class="expand" for="c-38874587">[2 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t coordination between APs something that Ubiquiti APs already do?</div><br/><div id="38876883" class="c"><input type="checkbox" id="c-38876883" checked=""/><div class="controls bullet"><span class="by">callalex</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874587">parent</a><span>|</span><a href="#38874346">next</a><span>|</span><label class="collapse" for="c-38876883">[-]</label><label class="expand" for="c-38876883">[1 more]</label></div><br/><div class="children"><div class="content">They have a rather clean implementation of standards called RADIUS and 802.11r, if that’s what you are talking about. It’s not unique to one manufacturer, that’s the whole point of Wi-Fi Alliance standards.</div><br/></div></div></div></div><div id="38874346" class="c"><input type="checkbox" id="c-38874346" checked=""/><div class="controls bullet"><span class="by">jauntywundrkind</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874091">parent</a><span>|</span><a href="#38874587">prev</a><span>|</span><a href="#38874427">next</a><span>|</span><label class="collapse" for="c-38874346">[-]</label><label class="expand" for="c-38874346">[1 more]</label></div><br/><div class="children"><div class="content">This is nonsense. If you are using WPA3 Enterprise across multiple AP, you need coordination, period. This comment raises zero significant concerns.<p>The parent suggestion is perfectly sound. More user-friendly means to mint certs would be grand. The caveat is that, if you can mint a cert from a low security password, what&#x27;s to keep an attacker from attacking the password directly, rather than the cert? It might not let them snoop traffic, but it&#x27;d still let them on with the password.</div><br/></div></div></div></div><div id="38874427" class="c"><input type="checkbox" id="c-38874427" checked=""/><div class="controls bullet"><span class="by">dfc</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874091">prev</a><span>|</span><a href="#38874642">next</a><span>|</span><label class="collapse" for="c-38874427">[-]</label><label class="expand" for="c-38874427">[2 more]</label></div><br/><div class="children"><div class="content">Saying that it is like WPA3 Enterprise after the initial pairing is somewhat unfair. The trust in the initial pairing is a large part of the draw. The trust on first use model you describe is similar to using a self signed certificate on a website. Sure, after you connect and trust the self signed certificate your connection to the server can use the same algorithms that it would have used with a trusted CA. But for large deployment there is something to be said for being able to trust that you are connecting to the right infrastructure.</div><br/><div id="38875497" class="c"><input type="checkbox" id="c-38875497" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874427">parent</a><span>|</span><a href="#38874642">next</a><span>|</span><label class="collapse" for="c-38875497">[-]</label><label class="expand" for="c-38875497">[1 more]</label></div><br/><div class="children"><div class="content">SSH does mostly fine with trust-on-first-use.</div><br/></div></div></div></div><div id="38874642" class="c"><input type="checkbox" id="c-38874642" checked=""/><div class="controls bullet"><span class="by">mattbee</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874427">prev</a><span>|</span><a href="#38874146">next</a><span>|</span><label class="collapse" for="c-38874642">[-]</label><label class="expand" for="c-38874642">[2 more]</label></div><br/><div class="children"><div class="content">You can already do this with hostapd under WPA3 or WPA2 - The password alone can identify each client, and activate different configs for each one.<p>Some commercial APs support this under different names but it&#x27;s hard to make it work with RADIUS, which is usually necessary on larger installations.<p>But without preloaded certificates, the clients don&#x27;t know that they&#x27;re not connecting to a rogue access point.<p>Hotspot 2.0 was going to solve that part, but kind of died last year as the WiFi Alliance let their last KPI partnership die off.</div><br/><div id="38875581" class="c"><input type="checkbox" id="c-38875581" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874642">parent</a><span>|</span><a href="#38874146">next</a><span>|</span><label class="collapse" for="c-38875581">[-]</label><label class="expand" for="c-38875581">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The password alone can identify each client, and activate different configs for each one.<p>That&#x27;s interesting, first time I hear this. How would that be represented in the hostapd config file? Would it be WPA enterprise using a radius server, or would it actually use WPA-PSK?</div><br/></div></div></div></div><div id="38874146" class="c"><input type="checkbox" id="c-38874146" checked=""/><div class="controls bullet"><span class="by">benmmurphy</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874642">prev</a><span>|</span><a href="#38874237">next</a><span>|</span><label class="collapse" for="c-38874146">[-]</label><label class="expand" for="c-38874146">[1 more]</label></div><br/><div class="children"><div class="content">I guess the problem is it&#x27;s the same until after the initial connection. And it not even clear that it is strictly better. It probably is, but now you are relying on two schemes instead of one so if the second scheme is broken you are worse off.</div><br/></div></div><div id="38874237" class="c"><input type="checkbox" id="c-38874237" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874146">prev</a><span>|</span><a href="#38874696">next</a><span>|</span><label class="collapse" for="c-38874237">[-]</label><label class="expand" for="c-38874237">[1 more]</label></div><br/><div class="children"><div class="content">shameless plug: <a href="https:&#x2F;&#x2F;github.com&#x2F;spr-networks&#x2F;super">https:&#x2F;&#x2F;github.com&#x2F;spr-networks&#x2F;super</a> is a project I work on that makes it easier to handle per-device wifi passwords on a single SSID, and it supports WPA3</div><br/></div></div><div id="38874696" class="c"><input type="checkbox" id="c-38874696" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874237">prev</a><span>|</span><a href="#38874370">next</a><span>|</span><label class="collapse" for="c-38874696">[-]</label><label class="expand" for="c-38874696">[3 more]</label></div><br/><div class="children"><div class="content">&gt; why WPA3 doesn&#x27;t have a mode where a password is used for the initial connection, but then the client and AP generate a keypair and each store their half and use that for all future connections.<p>Because it would regress security back to inferior bearer authentication.</div><br/><div id="38874757" class="c"><input type="checkbox" id="c-38874757" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874696">parent</a><span>|</span><a href="#38874370">next</a><span>|</span><label class="collapse" for="c-38874757">[-]</label><label class="expand" for="c-38874757">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s only equivalent if &quot;the password&quot; is fixed and can be used for an indefinite series of &quot;first&quot; connections.<p>In contrast, imagine that the thing the guest enters into their laptop is a freshly-generated random code which expires within X minutes and can only be used once.</div><br/><div id="38874974" class="c"><input type="checkbox" id="c-38874974" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874047">root</a><span>|</span><a href="#38874757">parent</a><span>|</span><a href="#38874370">next</a><span>|</span><label class="collapse" for="c-38874974">[-]</label><label class="expand" for="c-38874974">[1 more]</label></div><br/><div class="children"><div class="content">That would be an improvement, but authentication would still be based on a phishable credential vs a cryptographic assertion, and ultimately exploited in the enterprise environment it was designed for.</div><br/></div></div></div></div></div></div><div id="38874370" class="c"><input type="checkbox" id="c-38874370" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874696">prev</a><span>|</span><a href="#38874533">next</a><span>|</span><label class="collapse" for="c-38874370">[-]</label><label class="expand" for="c-38874370">[1 more]</label></div><br/><div class="children"><div class="content">What would happen if you tried to reconnect to the network and the AP didn&#x27;t have the pre-shared key? Presumably, you&#x27;d prompt the user and ask them if they want to connect. This is the same pattern as trust-on-first-use (TOFU) for SSH, except for non-expert users. It&#x27;s a good thought but I think it&#x27;d fall apart in practice. You&#x27;d still be vulnerable to phishing &#x2F; evil twin APs.</div><br/></div></div><div id="38874533" class="c"><input type="checkbox" id="c-38874533" checked=""/><div class="controls bullet"><span class="by">rokkitmensch</span><span>|</span><a href="#38874047">parent</a><span>|</span><a href="#38874370">prev</a><span>|</span><a href="#38873895">next</a><span>|</span><label class="collapse" for="c-38874533">[-]</label><label class="expand" for="c-38874533">[1 more]</label></div><br/><div class="children"><div class="content">Because industrial grade encryption isn&#x27;t for us plebs, comrade, but for the various ~government bureaus~ megacorps who deserve security.<p>But not you.</div><br/></div></div></div></div><div id="38873895" class="c"><input type="checkbox" id="c-38873895" checked=""/><div class="controls bullet"><span class="by">JohnFen</span><span>|</span><a href="#38874047">prev</a><span>|</span><a href="#38874928">next</a><span>|</span><label class="collapse" for="c-38873895">[-]</label><label class="expand" for="c-38873895">[16 more]</label></div><br/><div class="children"><div class="content">&gt; However, if you want a home network that’s simple to configure, easy for your guests to borrow, hassle-free, and that all of your Smart Home gadgets can connect to, then you should close this tab now<p>Or do what I do: run multiple APs. I have my primary one, which is very tightly secured and monitored, and only gives access to my local VPN. I have a guest one, which is only as secure as any average AP and gets you internet access, but no access to my LAN. If I used &quot;smart&quot; gadgets that I couldn&#x27;t really control and trust, I&#x27;d set up a subnet just for them alone.</div><br/><div id="38873971" class="c"><input type="checkbox" id="c-38873971" checked=""/><div class="controls bullet"><span class="by">jmole</span><span>|</span><a href="#38873895">parent</a><span>|</span><a href="#38873925">next</a><span>|</span><label class="collapse" for="c-38873971">[-]</label><label class="expand" for="c-38873971">[11 more]</label></div><br/><div class="children"><div class="content">You can run multiple SSIDs on the same AP and segment your networks with VLANs. No need to buy multiple APs unless you need the coverage.</div><br/><div id="38874016" class="c"><input type="checkbox" id="c-38874016" checked=""/><div class="controls bullet"><span class="by">outworlder</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38873971">parent</a><span>|</span><a href="#38874192">next</a><span>|</span><label class="collapse" for="c-38874016">[-]</label><label class="expand" for="c-38874016">[9 more]</label></div><br/><div class="children"><div class="content">And in this case the coverage would be even worse unless they duplicated all APs for both networks.<p>It&#x27;s probably much more cost effective to do what you suggest, and that&#x27;s exactly what I do. Multiple SSIDs (one for the household, another for IOT stuff, another for work and another for guests) and control access via VLANs.</div><br/><div id="38874158" class="c"><input type="checkbox" id="c-38874158" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874016">parent</a><span>|</span><a href="#38874192">next</a><span>|</span><label class="collapse" for="c-38874158">[-]</label><label class="expand" for="c-38874158">[8 more]</label></div><br/><div class="children"><div class="content">Is there a reason you split IoT stuff off of the guest network?<p>On my network we just have a guest network which denies LAN access to anything connected to it, but I&#x27;m wondering if there&#x27;s a good reason to split IoT off entirely.</div><br/><div id="38874198" class="c"><input type="checkbox" id="c-38874198" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874158">parent</a><span>|</span><a href="#38874243">next</a><span>|</span><label class="collapse" for="c-38874198">[-]</label><label class="expand" for="c-38874198">[2 more]</label></div><br/><div class="children"><div class="content">I guess it depends on what kind of friends you have, but assuming iot devices are insecure rubbish, I wouldn&#x27;t want them on the same network as guests. But then again you might want to turn on client isolation for the guest network, so that wouldn&#x27;t really be an issue.</div><br/><div id="38875494" class="c"><input type="checkbox" id="c-38875494" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874198">parent</a><span>|</span><a href="#38874243">next</a><span>|</span><label class="collapse" for="c-38875494">[-]</label><label class="expand" for="c-38875494">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, I have guests all isolated from the LAN already.</div><br/></div></div></div></div><div id="38874243" class="c"><input type="checkbox" id="c-38874243" checked=""/><div class="controls bullet"><span class="by">Gh0stRAT</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874158">parent</a><span>|</span><a href="#38874198">prev</a><span>|</span><a href="#38876638">next</a><span>|</span><label class="collapse" for="c-38874243">[-]</label><label class="expand" for="c-38874243">[2 more]</label></div><br/><div class="children"><div class="content">I want my guests to be able to cast to my TV, add songs to the Spotify queue, etc. As far as I can tell, these sorts of features work via broadcast frames and thus require the relevant devices to be on the same subnet.<p>Things like my printer and wifi-connected grill live on a much more restrictive VLAN. (with some firewall rules to allow devices on the trusted network to still print to my printer&#x27;s hard-coded IP address)</div><br/><div id="38876697" class="c"><input type="checkbox" id="c-38876697" checked=""/><div class="controls bullet"><span class="by">privacyking</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874243">parent</a><span>|</span><a href="#38876638">next</a><span>|</span><label class="collapse" for="c-38876697">[-]</label><label class="expand" for="c-38876697">[1 more]</label></div><br/><div class="children"><div class="content">You can do it some routers (e.g. opnsense) that let you retransmit that (e.g. with UDP broadcast relay). The main downside is that you have to set it up for each type, and open ports, troubleshoot a lot, waste many hours, etc.<p>I used to do this but it became too much of a hassle.</div><br/></div></div></div></div><div id="38876638" class="c"><input type="checkbox" id="c-38876638" checked=""/><div class="controls bullet"><span class="by">philsnow</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874158">parent</a><span>|</span><a href="#38874243">prev</a><span>|</span><a href="#38874846">next</a><span>|</span><label class="collapse" for="c-38876638">[-]</label><label class="expand" for="c-38876638">[1 more]</label></div><br/><div class="children"><div class="content">I have a separate VLAN for things like security cameras with perhaps-dodgy firmware, and a firewall rule that drops connections that devices on that VLAN try to establish.  They have no business connecting anywhere, when I want to see what they see I&#x27;ll ask them.</div><br/></div></div><div id="38874846" class="c"><input type="checkbox" id="c-38874846" checked=""/><div class="controls bullet"><span class="by">31337Logic</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874158">parent</a><span>|</span><a href="#38876638">prev</a><span>|</span><a href="#38874259">next</a><span>|</span><label class="collapse" for="c-38874846">[-]</label><label class="expand" for="c-38874846">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a simple reason (among many) that I segment IoT from Guest: I guess my Guest SSID password regularly but don&#x27;t wish to do the same for my IoT segments (plural, because one has WAN access and the other doesn&#x27;t.) 
For anyone wondering, the frequent changes to guest wifi password are offset by the fact that I make the password easily available to guests in the form of an NFC tap.</div><br/></div></div><div id="38874259" class="c"><input type="checkbox" id="c-38874259" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874158">parent</a><span>|</span><a href="#38874846">prev</a><span>|</span><a href="#38874192">next</a><span>|</span><label class="collapse" for="c-38874259">[-]</label><label class="expand" for="c-38874259">[1 more]</label></div><br/><div class="children"><div class="content">I split it off and give it zero access to the Internet, it&#x27;s strictly internal. Everything can talk to the IoT VLAN, but not the other way around.</div><br/></div></div></div></div></div></div><div id="38874192" class="c"><input type="checkbox" id="c-38874192" checked=""/><div class="controls bullet"><span class="by">willis936</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38873971">parent</a><span>|</span><a href="#38874016">prev</a><span>|</span><a href="#38873925">next</a><span>|</span><label class="collapse" for="c-38874192">[-]</label><label class="expand" for="c-38874192">[1 more]</label></div><br/><div class="children"><div class="content">Yeah this is what I do.  Both guests and naughty cloud devices get put on the same LAN as everyone else but can only talk to the gateway and the internet.</div><br/></div></div></div></div><div id="38873925" class="c"><input type="checkbox" id="c-38873925" checked=""/><div class="controls bullet"><span class="by">tylerflick</span><span>|</span><a href="#38873895">parent</a><span>|</span><a href="#38873971">prev</a><span>|</span><a href="#38875630">next</a><span>|</span><label class="collapse" for="c-38873925">[-]</label><label class="expand" for="c-38873925">[3 more]</label></div><br/><div class="children"><div class="content">This is exactly what I do. IoT stuff sits on its own AP attached to a jailed LAN.</div><br/><div id="38874676" class="c"><input type="checkbox" id="c-38874676" checked=""/><div class="controls bullet"><span class="by">scottyah</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38873925">parent</a><span>|</span><a href="#38875630">next</a><span>|</span><label class="collapse" for="c-38874676">[-]</label><label class="expand" for="c-38874676">[2 more]</label></div><br/><div class="children"><div class="content">So do you have to switch the wifi on your phone to access the IoT stuff?</div><br/><div id="38875406" class="c"><input type="checkbox" id="c-38875406" checked=""/><div class="controls bullet"><span class="by">umeshunni</span><span>|</span><a href="#38873895">root</a><span>|</span><a href="#38874676">parent</a><span>|</span><a href="#38875630">next</a><span>|</span><label class="collapse" for="c-38875406">[-]</label><label class="expand" for="c-38875406">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing it&#x27;s the same wifi network, just on a different vlan</div><br/></div></div></div></div></div></div><div id="38875630" class="c"><input type="checkbox" id="c-38875630" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#38873895">parent</a><span>|</span><a href="#38873925">prev</a><span>|</span><a href="#38874928">next</a><span>|</span><label class="collapse" for="c-38875630">[-]</label><label class="expand" for="c-38875630">[1 more]</label></div><br/><div class="children"><div class="content">Anyone can have access to my LAN.  It’s not a security boundary, and pretending like it is means you can never safely connect to airport or hotel wifi.</div><br/></div></div></div></div><div id="38874928" class="c"><input type="checkbox" id="c-38874928" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#38873895">prev</a><span>|</span><a href="#38874215">next</a><span>|</span><label class="collapse" for="c-38874928">[-]</label><label class="expand" for="c-38874928">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Because you need certificates, your Smart Home devices won’t support WPA3 Enterprise. Home printers won’t support it. A lot of things won&#x27;t support it. In fact, it’s a miracle that some consumer-grade routers and access points support it at all.<p>It&#x27;s not really a miracle. It&#x27;s just much easier to do from the access point side because the whole authentication process is basically offloaded to the radius server. It doesn&#x27;t add a lot of complexity to the actual access point or router. The radius server itself is usually not included with these solutions, they&#x27;re just capable of talking to one. It&#x27;s just an easy to achieve bullet point for a feature list.<p>On client devices however it&#x27;s a huge pita building a mechanism to manage client certificates, the verification chain and related requirements. It also has to be able to verify the radius server&#x27;s identity so it needs a full list of fully up to date root CAs (including private PKIs and a way to add them too) and be able to check their revocation. And you need accurate time while not actually having internet access yet. And then there&#x27;s automatic issuing. Most businesses don&#x27;t just hand you a certificate, it&#x27;s issued on the fly by a company HSM after the client device first generates its private key and then installed automatically by MDM <i>after</i> it determines your device is trusted enough. Like obeying security settings like encryption, having the required Antimalware installed and updated etc. It&#x27;s also automatically revoked if that is no longer the case.<p>If you just hand it to a user and let them use it wherever they want it&#x27;s not a lot better than a password really. So nobody actually does this in the real world. So the endpoint needs to be able to talk to various MDMs which is certainly feasible on a phone or computer but not on a simple printer, IP cam or smart device.</div><br/></div></div><div id="38874215" class="c"><input type="checkbox" id="c-38874215" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874928">prev</a><span>|</span><a href="#38873931">next</a><span>|</span><label class="collapse" for="c-38874215">[-]</label><label class="expand" for="c-38874215">[7 more]</label></div><br/><div class="children"><div class="content">EAP-TLS is generally a great practice, as EAP-PEAP is vulnerable to MITM issues (fix proposed in <a href="https:&#x2F;&#x2F;www.ietf.org&#x2F;archive&#x2F;id&#x2F;draft-josefsson-pppext-eap-tls-eap-10.txt" rel="nofollow">https:&#x2F;&#x2F;www.ietf.org&#x2F;archive&#x2F;id&#x2F;draft-josefsson-pppext-eap-t...</a> but never adopted).<p>For the use case cited -- blocking MAC spoofing, EAP-TLS doesn&#x27;t quite solve it, it mainly only solves authentication. The outer layer is not wrapped with TLS and is instead based on an ephemeral session key. Additional work is needed to stop the spoofing. The RFC states explicitly that channel binding, which would help stop the MAC spoofing, is not implemented <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc5216" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc5216</a>. What it does prevent is a client from being man-in-the-middled.<p>What&#x27;s even wilder is that on some access points, when set to bridge mode, with an upstream Radius Authentication Server, as described, they may be vulnerable to ARP spoofing of the upstream radius server IP. This is something we&#x27;ve reported to vendors and were told &quot;won&#x27;t fix&quot;. Names include Netgear and TP-Link, though we don&#x27;t suspect all routers from them are affected by this. We have not tested with the unifi access point referenced in the article.<p>So to restate the attack, cause it&#x27;s so ridiculous, you should know about it: an anonymous, unauthenticated wireless station associates without a password. Next it would begin the EAPOL negotiation but it instead then proceeds to perform ARP spoofing to claim the IP address of the upstream Radius that is supposed to only be routed over the uplink interfaces. Even without knowing the shared secret, it&#x27;s possible for the client to pretend to be the radius server to the AP, and authenticate itself onto the network.
One thing you want to be very sure of when setting up 802.1X Radius Auth, is that your access point is not going to be misconfigured to allow clients to do this.</div><br/><div id="38874436" class="c"><input type="checkbox" id="c-38874436" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874215">parent</a><span>|</span><a href="#38874410">next</a><span>|</span><label class="collapse" for="c-38874436">[-]</label><label class="expand" for="c-38874436">[3 more]</label></div><br/><div class="children"><div class="content">&gt; For the use case cited -- blocking MAC spoofing, EAP-TLS doesn&#x27;t quite solve it<p>The idea would be to rely on the client certificate authentication and not use MAC filtering at all. For example, you could have an EAP-TLS network that&#x27;s unrestricted and not let Mallory on it. Or you could use RADIUS reply attributes to put Mallory on a restricted vlan.</div><br/><div id="38874568" class="c"><input type="checkbox" id="c-38874568" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#38874215">root</a><span>|</span><a href="#38874436">parent</a><span>|</span><a href="#38874704">next</a><span>|</span><label class="collapse" for="c-38874568">[-]</label><label class="expand" for="c-38874568">[1 more]</label></div><br/><div class="children"><div class="content">Why not just set up multiple SSIDs then? The devices connected to different SSIDs belong to different VLANs. Then you don&#x27;t have to consider MAC spoofing or even deploy EAP-TLS: just give different devices a different password.<p>I&#x27;m sure there are simpler ways to deal with the use case in mind, but I think this article just wants to have fun with NSA-grade WiFi.</div><br/></div></div><div id="38874704" class="c"><input type="checkbox" id="c-38874704" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874215">root</a><span>|</span><a href="#38874436">parent</a><span>|</span><a href="#38874568">prev</a><span>|</span><a href="#38874410">next</a><span>|</span><label class="collapse" for="c-38874704">[-]</label><label class="expand" for="c-38874704">[1 more]</label></div><br/><div class="children"><div class="content">Right, although the article did not mention how to stop the spoofing. I started this thread to raise awareness and point out that the details around RADIUS can really matter here when not using a secure AP because some of the security assumptions about radius clients do lead to hilarious security failure</div><br/></div></div></div></div><div id="38874410" class="c"><input type="checkbox" id="c-38874410" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874215">parent</a><span>|</span><a href="#38874436">prev</a><span>|</span><a href="#38874689">next</a><span>|</span><label class="collapse" for="c-38874410">[-]</label><label class="expand" for="c-38874410">[2 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re doing EAP-TLS wouldn&#x27;t the ARP attack you&#x27;re describing fail at the client when it&#x27;s unable to verify the RADIUS server&#x27;s certificate?</div><br/><div id="38874631" class="c"><input type="checkbox" id="c-38874631" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874215">root</a><span>|</span><a href="#38874410">parent</a><span>|</span><a href="#38874689">next</a><span>|</span><label class="collapse" for="c-38874631">[-]</label><label class="expand" for="c-38874631">[1 more]</label></div><br/><div class="children"><div class="content">Correct, a wifi station client would not be attacked this way.  As for the radius client -- the answer is it depends.<p>For many radius clients used by a common consumer AP, it&#x27;s been possible for the spoofed radius to just say &quot;okay, authenticated&quot; to authorize itself -- and the shared secret is never used.  It&#x27;s worth noting that RADIUS may use MD5 with that shared secret, which is vulnerable to cracking attacks as well but I have not had to go down the rabbithole that far.<p>It would be interesting to try this against the Unifi AP brand named in the article and see how it handles it. My understanding is they run a custom Openwrt image so maybe they provide source code.</div><br/></div></div></div></div><div id="38874689" class="c"><input type="checkbox" id="c-38874689" checked=""/><div class="controls bullet"><span class="by">g-b-r</span><span>|</span><a href="#38874215">parent</a><span>|</span><a href="#38874410">prev</a><span>|</span><a href="#38873931">next</a><span>|</span><label class="collapse" for="c-38874689">[-]</label><label class="expand" for="c-38874689">[1 more]</label></div><br/><div class="children"><div class="content">Companies should be able to be sued for things like this (deliberately leaving such a big vulnerability there without even warning the customers).<p>It&#x27;s actually maybe already possible to consider it a fraud</div><br/></div></div></div></div><div id="38873931" class="c"><input type="checkbox" id="c-38873931" checked=""/><div class="controls bullet"><span class="by">transpute</span><span>|</span><a href="#38874215">prev</a><span>|</span><a href="#38874929">next</a><span>|</span><label class="collapse" for="c-38873931">[-]</label><label class="expand" for="c-38873931">[9 more]</label></div><br/><div class="children"><div class="content">A middle ground in complexity is WPA3 with a unique passphrase per VLAN, which allows grouping of devices by risk, or even giving each device a unique identity for access control and traffic management.<p>OSS golang reference code is available, <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38402289">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38402289</a><p><pre><code>  VLAN tagging per SSID is a valid approach as well if a router supports it. Thats a lot stronger than how many routers implement their guest isolation.

  As for Multi-PSK -- the use case is creating micro-segmentation in a network with zero-trust, where the identity on the network is rooted in that password.

  Without Multi-PSK, if it&#x27;s not clear, every device that has the WiFi password can sniff encrypted traffic with WPA2, make a Rogue AP to attack WPA3 in case its in use, and can perform ARP spoofing on the network to interfere with other devices.</code></pre></div><br/><div id="38874043" class="c"><input type="checkbox" id="c-38874043" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#38873931">parent</a><span>|</span><a href="#38874188">next</a><span>|</span><label class="collapse" for="c-38874043">[-]</label><label class="expand" for="c-38874043">[6 more]</label></div><br/><div class="children"><div class="content">I wish more consumer devices supported multiple PSKs on the same SSID. It&#x27;s a handy feature much better for airtime than creating multiple separate SSIDs and much better for sanity than 802.1x user or cert auth.</div><br/><div id="38874431" class="c"><input type="checkbox" id="c-38874431" checked=""/><div class="controls bullet"><span class="by">bscphil</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874043">parent</a><span>|</span><a href="#38875738">next</a><span>|</span><label class="collapse" for="c-38874431">[-]</label><label class="expand" for="c-38874431">[4 more]</label></div><br/><div class="children"><div class="content">&gt; I wish more consumer devices supported multiple PSKs on the same SSID<p>Could you name any enterprise APs that do this, short of running your own custom AP software? As far as I know (would love to be corrected on this), Unifi APs can&#x27;t do this, and they&#x27;re at the very least &quot;prosumer&quot;.</div><br/><div id="38874722" class="c"><input type="checkbox" id="c-38874722" checked=""/><div class="controls bullet"><span class="by">soraminazuki</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874431">parent</a><span>|</span><a href="#38874629">next</a><span>|</span><label class="collapse" for="c-38874722">[-]</label><label class="expand" for="c-38874722">[2 more]</label></div><br/><div class="children"><div class="content">It seems that feature has been added in a recent update.<p><a href="https:&#x2F;&#x2F;community.ui.com&#x2F;releases&#x2F;UniFi-Network-Application-7-5-187&#x2F;408b64c5-a485-4a37-843c-31e87140be64" rel="nofollow">https:&#x2F;&#x2F;community.ui.com&#x2F;releases&#x2F;UniFi-Network-Application-...</a></div><br/><div id="38875325" class="c"><input type="checkbox" id="c-38875325" checked=""/><div class="controls bullet"><span class="by">andrewmunsell</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874722">parent</a><span>|</span><a href="#38874629">next</a><span>|</span><label class="collapse" for="c-38875325">[-]</label><label class="expand" for="c-38875325">[1 more]</label></div><br/><div class="children"><div class="content">I was very excited by this, but I found that some of my dumber IoT devices would refuse to connect to the network if it used PPSK. If I connect them to a separate SSID I use for IoT devices with a basic WPA2 PSK, they work totally fine, but I didn&#x27;t dig too much so it could also be user error</div><br/></div></div></div></div><div id="38874629" class="c"><input type="checkbox" id="c-38874629" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874431">parent</a><span>|</span><a href="#38874722">prev</a><span>|</span><a href="#38875738">next</a><span>|</span><label class="collapse" for="c-38874629">[-]</label><label class="expand" for="c-38874629">[1 more]</label></div><br/><div class="children"><div class="content">Ruckus: <a href="https:&#x2F;&#x2F;docs.ruckuswireless.com&#x2F;unleashed&#x2F;200.3&#x2F;c-ZeroITandDPSK.html" rel="nofollow">https:&#x2F;&#x2F;docs.ruckuswireless.com&#x2F;unleashed&#x2F;200.3&#x2F;c-ZeroITandD...</a></div><br/></div></div></div></div><div id="38875738" class="c"><input type="checkbox" id="c-38875738" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874043">parent</a><span>|</span><a href="#38874431">prev</a><span>|</span><a href="#38874188">next</a><span>|</span><label class="collapse" for="c-38875738">[-]</label><label class="expand" for="c-38875738">[1 more]</label></div><br/><div class="children"><div class="content">Doing multiple PSK &#x2F; PPSK is not compatible with WPA3 (at least as supported by most APs today*, as WPA3 requires management frame encryption), so you limit to WPA2 only, therefore you&#x27;re better off just having multiple SSIDs with WPA3 support. (Also that way you can have a &quot;secure&quot; network which is WPA3 Personal only, much easier than using WPA Enterprise and gives a reasonable level of security for home use.)<p>*: In theory password identifiers (<a href="https:&#x2F;&#x2F;www.gabriel.urdhr.fr&#x2F;2022&#x2F;06&#x2F;07&#x2F;impact-of-the-different-wifi-security-modes&#x2F;#password-identifiers" rel="nofollow">https:&#x2F;&#x2F;www.gabriel.urdhr.fr&#x2F;2022&#x2F;06&#x2F;07&#x2F;impact-of-the-differ...</a>) could be used with WPA3-SAE, but I don&#x27;t know how good the support is currently...</div><br/></div></div></div></div><div id="38874188" class="c"><input type="checkbox" id="c-38874188" checked=""/><div class="controls bullet"><span class="by">cmpxchg8b</span><span>|</span><a href="#38873931">parent</a><span>|</span><a href="#38874043">prev</a><span>|</span><a href="#38874929">next</a><span>|</span><label class="collapse" for="c-38874188">[-]</label><label class="expand" for="c-38874188">[2 more]</label></div><br/><div class="children"><div class="content">My home network is so small I just use MAC VLAN policies on my managed switch.  Same SSID and PSK for all devices makes it easy and they all go off onto the untrusted VLAN by default.</div><br/><div id="38874369" class="c"><input type="checkbox" id="c-38874369" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#38873931">root</a><span>|</span><a href="#38874188">parent</a><span>|</span><a href="#38874929">next</a><span>|</span><label class="collapse" for="c-38874369">[-]</label><label class="expand" for="c-38874369">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s an interesting idea, but it seems (without having played around with it or knowing you specific setup) like it comes with some security tradeoffs.  In particular, MAC spoofing would be an effective way to VLAN hop, if not necessarily a threat you&#x27;re worried about.  It also seems like there is a possibility that devices connected to the same AP could talk to each other without having to go through the switch, bypassing the VLAN tagging entirely.<p>I&#x27;m honestly not sure if the second attack would work or if it would be AP specific, but I imagine most Wifi to wifi traffic through the same AP does not make a round trip through the Ethernet port.  This wouldn&#x27;t be an issue if the AP itself was applying and enforcing VLAN tags, but the MAC spoofing problem would still be an issue.</div><br/></div></div></div></div></div></div><div id="38874929" class="c"><input type="checkbox" id="c-38874929" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#38873931">prev</a><span>|</span><a href="#38875383">next</a><span>|</span><label class="collapse" for="c-38874929">[-]</label><label class="expand" for="c-38874929">[5 more]</label></div><br/><div class="children"><div class="content">It makes me sad that even WPA3 doesn’t have a native provisioning mechanism.  In a better world, a device would present its MAC address, some description of itself, a public key, and optional extra data (e.g. an attestation of the hardware security backing its keypair, and the network operator could, at its leisure, accept this device. Then printers, smart devices, etc could join without needing to each support an MDM or other proprietary provisioning system.<p>Also, if you care about availability, don’t use a cloud RADIUS server — if the server or your ISP or your route or the relevant part of your network goes down, there goes your WiFi. If you’re using 802.1x, your wired network is toast, too.</div><br/><div id="38874975" class="c"><input type="checkbox" id="c-38874975" checked=""/><div class="controls bullet"><span class="by">pierat</span><span>|</span><a href="#38874929">parent</a><span>|</span><a href="#38875383">next</a><span>|</span><label class="collapse" for="c-38874975">[-]</label><label class="expand" for="c-38874975">[4 more]</label></div><br/><div class="children"><div class="content">&gt; It makes me sad that even WPA3 doesn’t have a native provisioning mechanism.<p>And that&#x27;s how you get spoofing management frames, deauthing, and all sorts of fun attacks.<p>Cause the moment you talk to unauthenticated and unencrypted machines, well, yeah. Payday.<p>So you cant do that, even if you really want to.</div><br/><div id="38875609" class="c"><input type="checkbox" id="c-38875609" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#38874929">root</a><span>|</span><a href="#38874975">parent</a><span>|</span><a href="#38875383">next</a><span>|</span><label class="collapse" for="c-38875609">[-]</label><label class="expand" for="c-38875609">[3 more]</label></div><br/><div class="children"><div class="content">Huh?  Almost every cryptographic session protocol starts out with the parties sending unauthenticated data of some sort to each other.  Having a way for a party to send a blob as part of its request to be let in is straightforward.<p>Plus we’re taking about WPA, which, AFAIK, still uses a horrible hack for EAP even in WPA3, and as you can see mentioned elsewhere in the comments, EAP makes a pretty strong showing in its quest to be the worst widely-used example of giving an unauthenticated party <i>actual access to the network</i> as part of the authentication flow.<p>Doing this right is not that complicated.</div><br/><div id="38875755" class="c"><input type="checkbox" id="c-38875755" checked=""/><div class="controls bullet"><span class="by">tonetegeatinst</span><span>|</span><a href="#38874929">root</a><span>|</span><a href="#38875609">parent</a><span>|</span><a href="#38875383">next</a><span>|</span><label class="collapse" for="c-38875755">[-]</label><label class="expand" for="c-38875755">[2 more]</label></div><br/><div class="children"><div class="content">Their was a defcon or a blackhat talk on this issue.  Even though the data might be encrypted....developers can leak so much metadata via the handshake that you can build profiles and track devices</div><br/><div id="38875952" class="c"><input type="checkbox" id="c-38875952" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#38874929">root</a><span>|</span><a href="#38875755">parent</a><span>|</span><a href="#38875383">next</a><span>|</span><label class="collapse" for="c-38875952">[-]</label><label class="expand" for="c-38875952">[1 more]</label></div><br/><div class="children"><div class="content">The <i>entire point</i> of what I’m suggesting is to have a device identify itself.<p>If you set your phone to randomize its MAC address, then it should not send anything that specifically identifies it. If you ask your printer to connect to your corporate wireless network and you tell it to use WPA4-self-provisioning or whatever it’s called, then it should fully identify itself. Also, it’s a printer, and anyone in WiFi range is presumably privy to its existence.<p>Sure, if someone else spoofs the network, then they might collect the printer’s provisioning info, but one way or another the printer needs to decide to trust whatever network it ends up connecting to.  And with a sufficiently well designed protocol, if the printer connects to the wrong network, then the owner of that network can’t actually impersonate the printer to the real network, because the derived keys won’t match.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38875383" class="c"><input type="checkbox" id="c-38875383" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#38874929">prev</a><span>|</span><a href="#38874105">next</a><span>|</span><label class="collapse" for="c-38875383">[-]</label><label class="expand" for="c-38875383">[8 more]</label></div><br/><div class="children"><div class="content">I would like to see something like this for “home” setups but it would have a much better user experience:<p>1) user attempts to connect to “home-wifi”<p>2) owner of “home-wifi” gets notification to confirm or deny access request<p>3) owner can optionally verify further<p>4) if approved, then between AP and client device it will create the client certificates with short expiration dates<p>5) if denied, then no access granted.<p>6) if user tries to connect multiple times and gets denied for all of them, then their device is blacklisted. No notification.<p>No more passwords. Minimal friction to adoption.</div><br/><div id="38875429" class="c"><input type="checkbox" id="c-38875429" checked=""/><div class="controls bullet"><span class="by">hunter2_</span><span>|</span><a href="#38875383">parent</a><span>|</span><a href="#38875540">next</a><span>|</span><label class="collapse" for="c-38875429">[-]</label><label class="expand" for="c-38875429">[4 more]</label></div><br/><div class="children"><div class="content">Wardrivers with sufficient randomization to avoid any denylist you implement will get very annoying if you let those notifications interrupt you. Maybe only receive such requests while you expect guests.</div><br/><div id="38875493" class="c"><input type="checkbox" id="c-38875493" checked=""/><div class="controls bullet"><span class="by">Klathmon</span><span>|</span><a href="#38875383">root</a><span>|</span><a href="#38875429">parent</a><span>|</span><a href="#38875512">next</a><span>|</span><label class="collapse" for="c-38875493">[-]</label><label class="expand" for="c-38875493">[1 more]</label></div><br/><div class="children"><div class="content">You could just not have notifications.<p>I&#x27;d be fine with a system where when someone tries to connect to my network, I need to open an app or go to a web page and pick from the list of attempts to allow.<p>It&#x27;s not perfect, and it still leaves open a DoS by filling the DB with spam, but at that point you know something is wrong.</div><br/></div></div><div id="38875512" class="c"><input type="checkbox" id="c-38875512" checked=""/><div class="controls bullet"><span class="by">eli</span><span>|</span><a href="#38875383">root</a><span>|</span><a href="#38875429">parent</a><span>|</span><a href="#38875493">prev</a><span>|</span><a href="#38875502">next</a><span>|</span><label class="collapse" for="c-38875512">[-]</label><label class="expand" for="c-38875512">[1 more]</label></div><br/><div class="children"><div class="content">That seems unlikely to be something I&#x27;d ever encounter and solved by muting requests after too many in a row. Yes, a local attacker could DoS the convenience features for my guest wifi. That&#x27;s fine.</div><br/></div></div><div id="38875502" class="c"><input type="checkbox" id="c-38875502" checked=""/><div class="controls bullet"><span class="by">wishfish</span><span>|</span><a href="#38875383">root</a><span>|</span><a href="#38875429">parent</a><span>|</span><a href="#38875512">prev</a><span>|</span><a href="#38875540">next</a><span>|</span><label class="collapse" for="c-38875502">[-]</label><label class="expand" for="c-38875502">[1 more]</label></div><br/><div class="children"><div class="content">That would be the best way. Turn on notifications when you&#x27;re expecting a new device. Turn off notifications and auto-deny the rest of the time.</div><br/></div></div></div></div><div id="38875540" class="c"><input type="checkbox" id="c-38875540" checked=""/><div class="controls bullet"><span class="by">callalex</span><span>|</span><a href="#38875383">parent</a><span>|</span><a href="#38875429">prev</a><span>|</span><a href="#38875454">next</a><span>|</span><label class="collapse" for="c-38875540">[-]</label><label class="expand" for="c-38875540">[1 more]</label></div><br/><div class="children"><div class="content">It’s a crying shame that WPS was fumbled so hard. It was a consumer friendly idea.</div><br/></div></div><div id="38875454" class="c"><input type="checkbox" id="c-38875454" checked=""/><div class="controls bullet"><span class="by">kortilla</span><span>|</span><a href="#38875383">parent</a><span>|</span><a href="#38875540">prev</a><span>|</span><a href="#38875878">next</a><span>|</span><label class="collapse" for="c-38875454">[-]</label><label class="expand" for="c-38875454">[1 more]</label></div><br/><div class="children"><div class="content">How do you think that blacklist would work that can’t be trivially rotated around by changing client identities?</div><br/></div></div><div id="38875878" class="c"><input type="checkbox" id="c-38875878" checked=""/><div class="controls bullet"><span class="by">tamimio</span><span>|</span><a href="#38875383">parent</a><span>|</span><a href="#38875454">prev</a><span>|</span><a href="#38874105">next</a><span>|</span><label class="collapse" for="c-38875878">[-]</label><label class="expand" for="c-38875878">[1 more]</label></div><br/><div class="children"><div class="content">&gt; if user tries to connect multiple times and gets denied for all of them, then their device is blacklisted. No notification.<p>Blackhat 2026: WPA free(not three) Enterprise, how to flood and bypass WPA3 with certificate forgery and dual pair attack in 5min!</div><br/></div></div></div></div><div id="38874105" class="c"><input type="checkbox" id="c-38874105" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#38875383">prev</a><span>|</span><a href="#38874095">next</a><span>|</span><label class="collapse" for="c-38874105">[-]</label><label class="expand" for="c-38874105">[13 more]</label></div><br/><div class="children"><div class="content">&gt; Toggle the switch on the Smallstep RADIUS Root CA to enable Full Trust. The Smallstep RADIUS Root CA is now trusted.<p>What could possibly go wrong?<p>How do you do this without trusting some external CA?</div><br/><div id="38874354" class="c"><input type="checkbox" id="c-38874354" checked=""/><div class="controls bullet"><span class="by">e12e</span><span>|</span><a href="#38874105">parent</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38874354">[-]</label><label class="expand" for="c-38874354">[7 more]</label></div><br/><div class="children"><div class="content">Yeah, this isn&#x27;t really &quot;running at home&quot; - which is a bit disappointing as smallstep does good work on the foss&#x2F;self-host side of things (I guess this shows their seller side).<p>FreeRadius can help:<p><a href="https:&#x2F;&#x2F;wiki.alpinelinux.org&#x2F;wiki&#x2F;FreeRadius_EAP-TLS_configuration" rel="nofollow">https:&#x2F;&#x2F;wiki.alpinelinux.org&#x2F;wiki&#x2F;FreeRadius_EAP-TLS_configu...</a></div><br/><div id="38874619" class="c"><input type="checkbox" id="c-38874619" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38874354">parent</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38874619">[-]</label><label class="expand" for="c-38874619">[6 more]</label></div><br/><div class="children"><div class="content">I work at smallstep. Yes. This also works with FreeRadius! We decided to integrate RADIUS into our product since setting up FreeRadius is complicated and, if you&#x27;re just doing EAP-TLS for Wifi, you don&#x27;t need all of the features. You don&#x27;t need to use our hosted RADIUS though.</div><br/><div id="38874725" class="c"><input type="checkbox" id="c-38874725" checked=""/><div class="controls bullet"><span class="by">e12e</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38874619">parent</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38874725">[-]</label><label class="expand" for="c-38874725">[5 more]</label></div><br/><div class="children"><div class="content">Right. I think it makes a lot of sense to integrate Radius in your product. But the only way giving full trust to a third party ca could be dubbed &quot;NSA-grade&quot; - would be that it puts you within the reach of the NSA by way of an NSL to that third party?<p>(I&#x27;m not generally aiming to mitigate state level actors, but you put &quot;NSA-grade&quot; in the headline...).</div><br/><div id="38875191" class="c"><input type="checkbox" id="c-38875191" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38874725">parent</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38875191">[-]</label><label class="expand" for="c-38875191">[4 more]</label></div><br/><div class="children"><div class="content">Well... the title is hyperbolic (as titles are wont to be), but the goal was to configure Wifi that aligns with the CNSA Suite[1] &#x2F; CNSSP 15[2], which I think is fair to call &quot;NSA-grade&quot; since they wrote the standard.<p>If the NSA wants to get a certificate that your system trusts there are already dozens of organizations with root certs in your system trust store that they can strongarm. Most organizations can&#x27;t afford to have the NSA in their threat model. You better not be using public clouds, GSuite, Okta, Azure AD&#x2F;Entra, etc. This is a difficult security posture to maintain, especially at scale.<p>For most organizations, delegating the operation of sensitive security infrastructure to a third party results in better security, not worse. Yes, you&#x27;re trusting a third party. But you&#x27;re also outsourcing sensitive security operations to experts.<p>And, we also have on-prem and open source if you really need something air-gapped ;)<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Commercial_National_Security_Algorithm_Suite" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Commercial_National_Security_A...</a>
[2] <a href="https:&#x2F;&#x2F;www.cnss.gov&#x2F;CNSS&#x2F;issuances&#x2F;Policies.cfm" rel="nofollow">https:&#x2F;&#x2F;www.cnss.gov&#x2F;CNSS&#x2F;issuances&#x2F;Policies.cfm</a></div><br/><div id="38876636" class="c"><input type="checkbox" id="c-38876636" checked=""/><div class="controls bullet"><span class="by">e12e</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38875191">parent</a><span>|</span><a href="#38875410">next</a><span>|</span><label class="collapse" for="c-38876636">[-]</label><label class="expand" for="c-38876636">[1 more]</label></div><br/><div class="children"><div class="content">&gt; And, we also have on-prem and open source if you really need something air-gapped ;)<p>You support a self-hosted foss solution that enables on-prem wpa3 eap tls?</div><br/></div></div><div id="38875410" class="c"><input type="checkbox" id="c-38875410" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38875191">parent</a><span>|</span><a href="#38876636">prev</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38875410">[-]</label><label class="expand" for="c-38875410">[2 more]</label></div><br/><div class="children"><div class="content">Historically, cryptosystems are broken through weaknesses in key distribution, not by cracking the encryption outright.</div><br/><div id="38876105" class="c"><input type="checkbox" id="c-38876105" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38875410">parent</a><span>|</span><a href="#38874415">next</a><span>|</span><label class="collapse" for="c-38876105">[-]</label><label class="expand" for="c-38876105">[1 more]</label></div><br/><div class="children"><div class="content">Correct.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38874415" class="c"><input type="checkbox" id="c-38874415" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874105">parent</a><span>|</span><a href="#38874354">prev</a><span>|</span><a href="#38874679">next</a><span>|</span><label class="collapse" for="c-38874415">[-]</label><label class="expand" for="c-38874415">[2 more]</label></div><br/><div class="children"><div class="content">The article borders on irresponsible by not explaining the full implications and risk of trusting a root CA, even if you&#x27;re its sole private key custodian.</div><br/><div id="38874595" class="c"><input type="checkbox" id="c-38874595" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38874415">parent</a><span>|</span><a href="#38874679">next</a><span>|</span><label class="collapse" for="c-38874595">[-]</label><label class="expand" for="c-38874595">[1 more]</label></div><br/><div class="children"><div class="content">I work at Smallstep.<p>In this case you&#x27;re getting an industrial-grade CA with a properly managed private key, etc. Still, fair. We usually include warnings about this, but looks like we forgot this time. Curse of knowledge. I&#x27;ll see about getting a warning on there asap.</div><br/></div></div></div></div><div id="38874679" class="c"><input type="checkbox" id="c-38874679" checked=""/><div class="controls bullet"><span class="by">spr-alex</span><span>|</span><a href="#38874105">parent</a><span>|</span><a href="#38874415">prev</a><span>|</span><a href="#38875587">next</a><span>|</span><label class="collapse" for="c-38874679">[-]</label><label class="expand" for="c-38874679">[1 more]</label></div><br/><div class="children"><div class="content">it&#x27;s worth noting that hostapd has a built-in EAP server as well for running Radius.
check the config sample for &quot;EAP server&quot;
<a href="https:&#x2F;&#x2F;w1.fi&#x2F;cgit&#x2F;hostap&#x2F;plain&#x2F;hostapd&#x2F;hostapd.conf" rel="nofollow">https:&#x2F;&#x2F;w1.fi&#x2F;cgit&#x2F;hostap&#x2F;plain&#x2F;hostapd&#x2F;hostapd.conf</a><p>As for securing them, there&#x27;s several labs security researchers provide for breaking into &quot;enterprise wifi&quot;<p><a href="https:&#x2F;&#x2F;github.com&#x2F;sensepost&#x2F;shinai-fi">https:&#x2F;&#x2F;github.com&#x2F;sensepost&#x2F;shinai-fi</a>
<a href="https:&#x2F;&#x2F;github.com&#x2F;r4ulcl&#x2F;WiFiChallengeLab-docker">https:&#x2F;&#x2F;github.com&#x2F;r4ulcl&#x2F;WiFiChallengeLab-docker</a></div><br/></div></div><div id="38875587" class="c"><input type="checkbox" id="c-38875587" checked=""/><div class="controls bullet"><span class="by">testernews</span><span>|</span><a href="#38874105">parent</a><span>|</span><a href="#38874679">prev</a><span>|</span><a href="#38874095">next</a><span>|</span><label class="collapse" for="c-38875587">[-]</label><label class="expand" for="c-38875587">[2 more]</label></div><br/><div class="children"><div class="content">right!? i was hoping this would be a guide with something like freeradius and letsencrypt&#x2F;acme to handle certs instead of yet another rando “free until we go under&#x2F;get bought” saas service</div><br/><div id="38876137" class="c"><input type="checkbox" id="c-38876137" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874105">root</a><span>|</span><a href="#38875587">parent</a><span>|</span><a href="#38874095">next</a><span>|</span><label class="collapse" for="c-38876137">[-]</label><label class="expand" for="c-38876137">[1 more]</label></div><br/><div class="children"><div class="content">You can roll your own with <a href="https:&#x2F;&#x2F;github.com&#x2F;smallstep&#x2F;certificates">https:&#x2F;&#x2F;github.com&#x2F;smallstep&#x2F;certificates</a>. We maintain major open source projects and contribute a lot to other projects. I don’t think that means everything we do has to be open source. Sorry this one wasn’t. Doing this in pure open source would be a book, not a blog post.<p>Love Let’s Encrypt — we’re sponsors — but using them for WiFi is a terrible idea. You need internal PKI for WiFi.</div><br/></div></div></div></div></div></div><div id="38874095" class="c"><input type="checkbox" id="c-38874095" checked=""/><div class="controls bullet"><span class="by">sandworm101</span><span>|</span><a href="#38874105">prev</a><span>|</span><a href="#38875744">next</a><span>|</span><label class="collapse" for="c-38874095">[-]</label><label class="expand" for="c-38874095">[12 more]</label></div><br/><div class="children"><div class="content">TS information over wifi? Ok. Have fun with that. Im sure it is legally possible somehow, but it just creates a ridiculously large attack surface.  And the internal hassles, making sure connected machines are inside defined perimeters ... just run some wires.  It isnt like people need to be reading classified stuff on the treadmill.</div><br/><div id="38874271" class="c"><input type="checkbox" id="c-38874271" checked=""/><div class="controls bullet"><span class="by">moandcompany</span><span>|</span><a href="#38874095">parent</a><span>|</span><a href="#38874445">next</a><span>|</span><label class="collapse" for="c-38874271">[-]</label><label class="expand" for="c-38874271">[1 more]</label></div><br/><div class="children"><div class="content">The &quot;NSA-Grade&quot; part mostly comes from the application of AES-256 as a cipher, where specific configurations of AES were approved as &quot;Suite B&quot; (i.e. published algorithm) ciphers suitable for up to Top Secret information.<p>From <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NSA_Suite_B_Cryptography" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NSA_Suite_B_Cryptography</a><p>The Suite B algorithms have been replaced by Commercial National Security Algorithm (CNSA) Suite algorithms:<p>- Advanced Encryption Standard (AES), per FIPS 197, using 256 bit keys to protect up to TOP SECRET<p>- Elliptic Curve Diffie-Hellman (ECDH) Key Exchange, per FIPS SP 800-56A, using Curve P-384 to protect up to TOP SECRET.<p>- Elliptic Curve Digital Signature Algorithm (ECDSA), per FIPS 186-4
Secure Hash Algorithm (SHA), per FIPS 180-4, using SHA-384 to protect up to TOP SECRET.<p>- Diffie-Hellman (DH) Key Exchange, per RFC 3526, minimum 3072-bit modulus to protect up to TOP SECRET<p>- RSA for key establishment (NIST SP 800-56B rev 1) and digital signatures (FIPS 186-4), minimum 3072-bit modulus to protect up to TOP SECRET</div><br/></div></div><div id="38874445" class="c"><input type="checkbox" id="c-38874445" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874095">parent</a><span>|</span><a href="#38874271">prev</a><span>|</span><a href="#38874313">next</a><span>|</span><label class="collapse" for="c-38874445">[-]</label><label class="expand" for="c-38874445">[1 more]</label></div><br/><div class="children"><div class="content">The title should be <i>enterprise-grade Wi-Fi</i> because the idea of closed-source, foreign-made COTS APs trafficking classified data is hyperbole only.</div><br/></div></div><div id="38874313" class="c"><input type="checkbox" id="c-38874313" checked=""/><div class="controls bullet"><span class="by">bryancoxwell</span><span>|</span><a href="#38874095">parent</a><span>|</span><a href="#38874445">prev</a><span>|</span><a href="#38874178">next</a><span>|</span><label class="collapse" for="c-38874313">[-]</label><label class="expand" for="c-38874313">[1 more]</label></div><br/><div class="children"><div class="content">The CSfC program defines a WLAN “capability package”[0] for just this purpose.<p>[0]: <a href="https:&#x2F;&#x2F;www.nsa.gov&#x2F;Resources&#x2F;Commercial-Solutions-for-Classified-Program&#x2F;Capability-Packages&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.nsa.gov&#x2F;Resources&#x2F;Commercial-Solutions-for-Class...</a></div><br/></div></div><div id="38874178" class="c"><input type="checkbox" id="c-38874178" checked=""/><div class="controls bullet"><span class="by">radicaldreamer</span><span>|</span><a href="#38874095">parent</a><span>|</span><a href="#38874313">prev</a><span>|</span><a href="#38875187">next</a><span>|</span><label class="collapse" for="c-38874178">[-]</label><label class="expand" for="c-38874178">[7 more]</label></div><br/><div class="children"><div class="content">Does the NSA use WiFi at all other than for clandestine collection systems in the field?</div><br/><div id="38874249" class="c"><input type="checkbox" id="c-38874249" checked=""/><div class="controls bullet"><span class="by">Rebelgecko</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38874178">parent</a><span>|</span><a href="#38874613">next</a><span>|</span><label class="collapse" for="c-38874249">[-]</label><label class="expand" for="c-38874249">[5 more]</label></div><br/><div class="children"><div class="content">Yeah, they put out an article a few years ago talking about how a limited number of SCIFs have WiFi now</div><br/><div id="38875005" class="c"><input type="checkbox" id="c-38875005" checked=""/><div class="controls bullet"><span class="by">sandworm101</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38874249">parent</a><span>|</span><a href="#38874613">next</a><span>|</span><label class="collapse" for="c-38875005">[-]</label><label class="expand" for="c-38875005">[4 more]</label></div><br/><div class="children"><div class="content">Do they broadcast an SSID?  They can&#x27;t have &quot;NotYourSCIF&quot;.  That&#x27;s my home network.  Someone else is the building is using &quot;FSB_BugsNet&quot;.  Another local one i see is &quot;CEyeA&quot;.</div><br/><div id="38875894" class="c"><input type="checkbox" id="c-38875894" checked=""/><div class="controls bullet"><span class="by">Rebelgecko</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38875005">parent</a><span>|</span><a href="#38875858">next</a><span>|</span><label class="collapse" for="c-38875894">[-]</label><label class="expand" for="c-38875894">[1 more]</label></div><br/><div class="children"><div class="content">To be compliant with NSA TEMPEST regulations, the SSID has to be set to FBI_SURVEILLANCE_VAN_69</div><br/></div></div><div id="38875858" class="c"><input type="checkbox" id="c-38875858" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38875005">parent</a><span>|</span><a href="#38875894">prev</a><span>|</span><a href="#38875694">next</a><span>|</span><label class="collapse" for="c-38875858">[-]</label><label class="expand" for="c-38875858">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not official until you change the MAC OID to 00:20:91 as well.</div><br/></div></div><div id="38875694" class="c"><input type="checkbox" id="c-38875694" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38875005">parent</a><span>|</span><a href="#38875858">prev</a><span>|</span><a href="#38874613">next</a><span>|</span><label class="collapse" for="c-38875694">[-]</label><label class="expand" for="c-38875694">[1 more]</label></div><br/><div class="children"><div class="content">SCIFs are already shielded for EM, so any Wi-Fi inside of them shouldn’t make it outside of them anyway.</div><br/></div></div></div></div></div></div><div id="38874613" class="c"><input type="checkbox" id="c-38874613" checked=""/><div class="controls bullet"><span class="by">NoZebra120vClip</span><span>|</span><a href="#38874095">root</a><span>|</span><a href="#38874178">parent</a><span>|</span><a href="#38874249">prev</a><span>|</span><a href="#38875187">next</a><span>|</span><label class="collapse" for="c-38874613">[-]</label><label class="expand" for="c-38874613">[1 more]</label></div><br/><div class="children"><div class="content">WiFi and other wireless protocols seem like an elaborate, yet wildly successful, plot to make consumer comms as insecure as possible.</div><br/></div></div></div></div><div id="38875187" class="c"><input type="checkbox" id="c-38875187" checked=""/><div class="controls bullet"><span class="by">wannacboatmovie</span><span>|</span><a href="#38874095">parent</a><span>|</span><a href="#38874178">prev</a><span>|</span><a href="#38875744">next</a><span>|</span><label class="collapse" for="c-38875187">[-]</label><label class="expand" for="c-38875187">[1 more]</label></div><br/><div class="children"><div class="content">Erroneous assumptions, half-truths, and a clickbait headline have historically never been a barrier to getting to the top of &quot;Hacker&quot; &quot;News&quot;.</div><br/></div></div></div></div><div id="38875744" class="c"><input type="checkbox" id="c-38875744" checked=""/><div class="controls bullet"><span class="by">tonetegeatinst</span><span>|</span><a href="#38874095">prev</a><span>|</span><a href="#38876116">next</a><span>|</span><label class="collapse" for="c-38875744">[-]</label><label class="expand" for="c-38875744">[1 more]</label></div><br/><div class="children"><div class="content">TLS 1.2 and not 1.3?<p>Could a swore we moved to 1.3 a while ago<p>Also many I&#x27;m just not familiar enough with cryptography but that key size seems kinda small.....am I wrong?<p>Ik RSA uses a different algorithm but RSA it isn&#x27;t uncommon to see keys 1024 or larger in size.  I generated a key of 65,536 and 131,072 bits a few times to see if it would work or break any applications I was using.  Also just to I can say &quot;yeah back in my day we generated keys way bigger&quot; cuz I know at least 1 other person in the world did it.<p>Is their any standard for securing a network both wired and WiFi using a post quantum algorithm?<p>Also where can I easily find switches that support these standards? AFAIK wpa3 enterprise dosnt always mean this standard is supported....or that some other standard is supported. Is their some database that lists every router&#x2F;AP and the supported features?</div><br/></div></div><div id="38876116" class="c"><input type="checkbox" id="c-38876116" checked=""/><div class="controls bullet"><span class="by">WirelessGigabit</span><span>|</span><a href="#38875744">prev</a><span>|</span><a href="#38875572">next</a><span>|</span><label class="collapse" for="c-38876116">[-]</label><label class="expand" for="c-38876116">[1 more]</label></div><br/><div class="children"><div class="content">Well, that means I couldn&#x27;t use my iPhone from work at home as it blocks installing certificates.<p>But, while not NSA approved, WPA3 itself has support for per-device passwords with WPA-SAE [0] (which isn&#x27;t called WPA-METRIC outside of the USA...).<p>[0] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Simultaneous_Authentication_of_Equals#WPA3" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Simultaneous_Authentication_of...</a></div><br/></div></div><div id="38875572" class="c"><input type="checkbox" id="c-38875572" checked=""/><div class="controls bullet"><span class="by">stephen_g</span><span>|</span><a href="#38876116">prev</a><span>|</span><a href="#38874300">next</a><span>|</span><label class="collapse" for="c-38875572">[-]</label><label class="expand" for="c-38875572">[1 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t gone quite this crazy, but I do have three SSIDs broadcast from my UniFi APs - my main network (WPA3 PSK), a guest one, and a devices network for IoT devices. All these are on different subnets&#x2F;VLANs and firewalled off from each other.<p>A lot of the IoT stuff doesn&#x27;t work with WPA3 or 5GHz, so it&#x27;s useful even for that reason, but the main thing is screening them off from everything else.<p>I am setting up a NUC as a little home Proxmox server (for some other stuff mainly) but for &quot;fun&quot; I can actually see myself setting up a Samba 4 Active Directory domain controller and hooking FreeRADIUS up to that to do Enterprise for my main SSID, but we&#x27;ll see!</div><br/></div></div><div id="38874300" class="c"><input type="checkbox" id="c-38874300" checked=""/><div class="controls bullet"><span class="by">WatchDog</span><span>|</span><a href="#38875572">prev</a><span>|</span><a href="#38875900">next</a><span>|</span><label class="collapse" for="c-38874300">[-]</label><label class="expand" for="c-38874300">[4 more]</label></div><br/><div class="children"><div class="content">&gt; In the “When using this certificate” dropdown, select “Always Trust.”<p>Shouldn&#x27;t it be possible to only enable “Always Trust.” in the &quot;X.509 Basic Policy&quot; setting, instead of allowing the certificate to be used for everything(including SSL)?</div><br/><div id="38874827" class="c"><input type="checkbox" id="c-38874827" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#38874300">parent</a><span>|</span><a href="#38874537">next</a><span>|</span><label class="collapse" for="c-38874827">[-]</label><label class="expand" for="c-38874827">[2 more]</label></div><br/><div class="children"><div class="content">On Mac (which the author appears to be talking about), I believe agreeing to Always Trust when connecting to a WPA3 network only enables it for the &quot;X.509 Basic Policy&quot; setting. I don&#x27;t know much about how the different trust policies on OSX work though, and it makes me very uncomfortable that trusting self-signed root certificates may become more common for connecting to wifi networks.<p>If you do trust the root cert for everything, couldn&#x27;t the access point MITM all your traffic?</div><br/><div id="38875880" class="c"><input type="checkbox" id="c-38875880" checked=""/><div class="controls bullet"><span class="by">forward1</span><span>|</span><a href="#38874300">root</a><span>|</span><a href="#38874827">parent</a><span>|</span><a href="#38874537">next</a><span>|</span><label class="collapse" for="c-38875880">[-]</label><label class="expand" for="c-38875880">[1 more]</label></div><br/><div class="children"><div class="content">Not only MITM traffic, but also run arbitrary software since it could also govern code signing.</div><br/></div></div></div></div><div id="38874537" class="c"><input type="checkbox" id="c-38874537" checked=""/><div class="controls bullet"><span class="by">mmalone</span><span>|</span><a href="#38874300">parent</a><span>|</span><a href="#38874827">prev</a><span>|</span><a href="#38875900">next</a><span>|</span><label class="collapse" for="c-38874537">[-]</label><label class="expand" for="c-38874537">[1 more]</label></div><br/><div class="children"><div class="content">I work at smallstep.<p>Not sure about the RADIUS server, but connections to the CA use TLS for SCEP and&#x2F;or ACME DA so the CA root cert needs to be trusted for TLS. There may be some way to configure more narrow trust for <i>just</i> this one interaction, but I&#x27;m not aware of any such mechanism in the current releases of macOS&#x2F;iOS&#x2F;iPadOS&#x2F;tvOS.</div><br/></div></div></div></div><div id="38875900" class="c"><input type="checkbox" id="c-38875900" checked=""/><div class="controls bullet"><span class="by">tamimio</span><span>|</span><a href="#38874300">prev</a><span>|</span><a href="#38876501">next</a><span>|</span><label class="collapse" for="c-38875900">[-]</label><label class="expand" for="c-38875900">[1 more]</label></div><br/><div class="children"><div class="content">I try not to use wifi as much as possible, but when I do, I connect through it to my home VPN or similar and take it from there, so even if the wifi is compromised, there’s an extra layer of protection there.</div><br/></div></div><div id="38876501" class="c"><input type="checkbox" id="c-38876501" checked=""/><div class="controls bullet"><span class="by">teunispeters</span><span>|</span><a href="#38875900">prev</a><span>|</span><a href="#38874295">next</a><span>|</span><label class="collapse" for="c-38876501">[-]</label><label class="expand" for="c-38876501">[1 more]</label></div><br/><div class="children"><div class="content">Instructions ...  yeah, not bad.   It&#x27;s essentially WPA3-Enterprise with possibly 192 bit set up.   I like WPA3-Enterprise, it&#x27;s really sufficient for most people when one moves to discontinuous permissions on a network.
That said, after developing WPA3&#x2F;Enterprise&#x2F;192 for a platform out there, it&#x27;s really very very restricted - and there were very few clients at the time that supported the combinations of security authentications required.  Oh, also roaming clients is somewhat restricted (by no fast roaming protocols, at least as of the last time I went through the specs).<p>Here&#x27;s specifics, using hostap&#x2F;wpa_supplicant style configuration:
key management WPA-EAP-SUITE-B-192. (but then they talk about that); pairwise=GCMP-256, group_mgmt=BIP-GMAC-256; EAP=TTLS;<p>I mean RADIUS support isn&#x27;t that hard - freeradius will do.  TLS - well, need valid certs that work for EAP.  (it&#x27;s not as specialized as Passpoint&#x2F;Hotspot-2, which requires custom certs that must be validated by a specific CA, but it still takes some steps).   My own experiments across a number of clients showed that GCMP-256 support for pairwise and group management weren&#x27;t that common before Wifi-6 took off.  Suite-B 192 though isn&#x27;t so hard to reach.<p>Hostly, I prefer WPA3-Enterprise with Fast Roaming.  Sadly, typical household devices didn&#x27;t work well with it (mixed with android devices, generally no for printers and other IOT), so I went back to two networks - WPA2&#x2F;Personal with PMF=optional for those annoying devices that don&#x27;t have working PMF, and WPA3&#x2F;Personal for most devices - at least for household operations.</div><br/></div></div><div id="38874295" class="c"><input type="checkbox" id="c-38874295" checked=""/><div class="controls bullet"><span class="by">mysteria</span><span>|</span><a href="#38876501">prev</a><span>|</span><a href="#38874373">next</a><span>|</span><label class="collapse" for="c-38874295">[-]</label><label class="expand" for="c-38874295">[1 more]</label></div><br/><div class="children"><div class="content">If you want do do this 100% locally it&#x27;s pretty easy with Pfsense&#x2F;Opnsense combined with the Freeradius plugin. You can create your CA, hook it up to Freeradius, and create accounts and certificates all from the GUI (if you know what you&#x27;re doing). As a bonus you can use the same certs with say the built-in OpenVPN system, and revocation of certificates is handled seamlessly in the UI as well. Personally I found it much simpler than doing it by hand with OpenSSL commands, which I used in the past when I had a smaller deployment.<p>The great thing with WPA Enterprise is that you can assign VLANs based on the client&#x27;s login, just like a 802.1X switch. For instance my phone is sent to one VLAN, my company laptop to another, and my personal laptop to another. I can use a single SSID and get all the benefits of a multi-VLAN setup. For guests I provide a username and password for MSCHAPv2 authentication, while family devices are issued full certs.<p>What about IOT devices? I generally only use commercial wired gear (IP phones, cams, etc.) anyways with no internet access, and I&#x27;m of the belief that if it doesn&#x27;t support WPA-Enterprise it shouldn&#x27;t be on the network in the first place :). So that rules out all those data-mining smart speakers and so forth.</div><br/></div></div><div id="38874373" class="c"><input type="checkbox" id="c-38874373" checked=""/><div class="controls bullet"><span class="by">WatchDog</span><span>|</span><a href="#38874295">prev</a><span>|</span><a href="#38874238">next</a><span>|</span><label class="collapse" for="c-38874373">[-]</label><label class="expand" for="c-38874373">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why is NSA-grade Wi-Fi called &quot;192-bit mode&quot;?<p>I believe this is due to the use of SHA-384, which is described as having 192 bits of &quot;security strength&quot;[0] against collision.<p>[0]: <a href="https:&#x2F;&#x2F;csrc.nist.rip&#x2F;library&#x2F;NIST%20SP%20800-107%20Recommendation%20for%20Applications%20Using%20Approved%20Hash%20Algorithms,%202009-02%20(2).pdf" rel="nofollow">https:&#x2F;&#x2F;csrc.nist.rip&#x2F;library&#x2F;NIST%20SP%20800-107%20Recommen...</a></div><br/></div></div><div id="38874238" class="c"><input type="checkbox" id="c-38874238" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#38874373">prev</a><span>|</span><a href="#38874293">next</a><span>|</span><label class="collapse" for="c-38874238">[-]</label><label class="expand" for="c-38874238">[3 more]</label></div><br/><div class="children"><div class="content">On the topic of WPA3, I recently found that the old iPad 2 or 3 doesn&#x27;t connect to wifi if it&#x27;s set to WPA3+2, it only works in pure WPA2 mode. Tried on two different AP vendors, though I have no idea if they might use the same chip or driver or something. It&#x27;s the only device that didn&#x27;t work in this mode, everything else was fine, including some whacky iot devices like picture frames and an inverter.</div><br/><div id="38874266" class="c"><input type="checkbox" id="c-38874266" checked=""/><div class="controls bullet"><span class="by">postpawl</span><span>|</span><a href="#38874238">parent</a><span>|</span><a href="#38874293">next</a><span>|</span><label class="collapse" for="c-38874266">[-]</label><label class="expand" for="c-38874266">[2 more]</label></div><br/><div class="children"><div class="content">You’re sure it’s not actually the PMF setting causing that? More details here: <a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;Ubiquiti&#x2F;comments&#x2F;rq6jtr&#x2F;psa_if_your_24ghzonly_devices_cant_connect_after&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;Ubiquiti&#x2F;comments&#x2F;rq6jtr&#x2F;psa_if_you...</a></div><br/><div id="38876984" class="c"><input type="checkbox" id="c-38876984" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#38874238">root</a><span>|</span><a href="#38874266">parent</a><span>|</span><a href="#38874293">next</a><span>|</span><label class="collapse" for="c-38876984">[-]</label><label class="expand" for="c-38876984">[1 more]</label></div><br/><div class="children"><div class="content">Hm, in that post they say all of the 2.4ghz devices had the problem, while in my case it was just the iPad, and it was broken on both bands. But maybe it still was this (or a similar) issue. I only have access to one of the two APs right now, and there is pretty much nothing configurable regarding WiFi security apart from selecting from WPA1+2, WPA2 only, WPA2+3.</div><br/></div></div></div></div></div></div><div id="38874293" class="c"><input type="checkbox" id="c-38874293" checked=""/><div class="controls bullet"><span class="by">BWStearns</span><span>|</span><a href="#38874238">prev</a><span>|</span><a href="#38874196">next</a><span>|</span><label class="collapse" for="c-38874293">[-]</label><label class="expand" for="c-38874293">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;m just amazed that there&#x27;s SCIF approved wifi. I assumed I&#x27;d be dead of old age before that happened.</div><br/><div id="38874776" class="c"><input type="checkbox" id="c-38874776" checked=""/><div class="controls bullet"><span class="by">jacoblambda</span><span>|</span><a href="#38874293">parent</a><span>|</span><a href="#38874196">next</a><span>|</span><label class="collapse" for="c-38874776">[-]</label><label class="expand" for="c-38874776">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll believe it when I see it. They don&#x27;t cite where it suggests in any capacity that Wi-Fi is ever acceptable for Secret or TS data transmission. If this was approved for anything it&#x27;d probably be CUI information at most (ignoring the many issues with their actual implementation).</div><br/><div id="38875628" class="c"><input type="checkbox" id="c-38875628" checked=""/><div class="controls bullet"><span class="by">brendank310</span><span>|</span><a href="#38874293">root</a><span>|</span><a href="#38874776">parent</a><span>|</span><a href="#38874196">next</a><span>|</span><label class="collapse" for="c-38875628">[-]</label><label class="expand" for="c-38875628">[3 more]</label></div><br/><div class="children"><div class="content">As someone noted above the Commercial Solutions for Classified program has been in existence for a long while (probably over a decade). This package is newer but not wildly newer. Installs of the various &#x27;packages&#x27; do exist.</div><br/><div id="38875651" class="c"><input type="checkbox" id="c-38875651" checked=""/><div class="controls bullet"><span class="by">jacoblambda</span><span>|</span><a href="#38874293">root</a><span>|</span><a href="#38875628">parent</a><span>|</span><a href="#38874196">next</a><span>|</span><label class="collapse" for="c-38875651">[-]</label><label class="expand" for="c-38875651">[2 more]</label></div><br/><div class="children"><div class="content">Huh interesting. I can&#x27;t imagine where people would willingly use it.</div><br/></div></div></div></div></div></div></div></div><div id="38874196" class="c"><input type="checkbox" id="c-38874196" checked=""/><div class="controls bullet"><span class="by">slicktux</span><span>|</span><a href="#38874293">prev</a><span>|</span><a href="#38874311">next</a><span>|</span><label class="collapse" for="c-38874196">[-]</label><label class="expand" for="c-38874196">[1 more]</label></div><br/><div class="children"><div class="content">Yea I wish I could run my router with PMF enabled and WPA2…so many devices do BOT support such options…specially WPA3</div><br/></div></div><div id="38874311" class="c"><input type="checkbox" id="c-38874311" checked=""/><div class="controls bullet"><span class="by">cynix</span><span>|</span><a href="#38874196">prev</a><span>|</span><a href="#38875115">next</a><span>|</span><label class="collapse" for="c-38874311">[-]</label><label class="expand" for="c-38874311">[2 more]</label></div><br/><div class="children"><div class="content">Unfortunately the article doesn&#x27;t explain how to setup a RADIUS server for EAP-TLS.</div><br/><div id="38874376" class="c"><input type="checkbox" id="c-38874376" checked=""/><div class="controls bullet"><span class="by">e12e</span><span>|</span><a href="#38874311">parent</a><span>|</span><a href="#38875115">next</a><span>|</span><label class="collapse" for="c-38874376">[-]</label><label class="expand" for="c-38874376">[1 more]</label></div><br/><div class="children"><div class="content">But there&#x27;s a link so you can lease one in the cloud...<p>If you want to self-host, see eg:<p><a href="https:&#x2F;&#x2F;wiki.alpinelinux.org&#x2F;wiki&#x2F;FreeRadius_EAP-TLS_configuration" rel="nofollow">https:&#x2F;&#x2F;wiki.alpinelinux.org&#x2F;wiki&#x2F;FreeRadius_EAP-TLS_configu...</a></div><br/></div></div></div></div><div id="38875115" class="c"><input type="checkbox" id="c-38875115" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#38874311">prev</a><span>|</span><a href="#38874739">next</a><span>|</span><label class="collapse" for="c-38875115">[-]</label><label class="expand" for="c-38875115">[3 more]</label></div><br/><div class="children"><div class="content">Do these enterprise modes have any advantages when it comes to connection reliability?</div><br/><div id="38875128" class="c"><input type="checkbox" id="c-38875128" checked=""/><div class="controls bullet"><span class="by">parl_match</span><span>|</span><a href="#38875115">parent</a><span>|</span><a href="#38874739">next</a><span>|</span><label class="collapse" for="c-38875128">[-]</label><label class="expand" for="c-38875128">[2 more]</label></div><br/><div class="children"><div class="content">You&#x27;re not going to increase connection reliability&#x2F;extend your wifi range by enabling radius. If you have any understanding of what&#x27;s happening here, you wouldn&#x27;t even ask this question.</div><br/><div id="38875990" class="c"><input type="checkbox" id="c-38875990" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#38875115">root</a><span>|</span><a href="#38875128">parent</a><span>|</span><a href="#38874739">next</a><span>|</span><label class="collapse" for="c-38875990">[-]</label><label class="expand" for="c-38875990">[1 more]</label></div><br/><div class="children"><div class="content">What I’m wondering has nothing to do with signal strength. I’m wondering if the protocol differences have any effect on reliability in situations where the wireless connection is less reliable. Because, for example, there’s less negotiation on reconnecting to the network or something.<p>After all, reliability is a cross-cutting concern :)</div><br/></div></div></div></div></div></div><div id="38874739" class="c"><input type="checkbox" id="c-38874739" checked=""/><div class="controls bullet"><span class="by">slowhadoken</span><span>|</span><a href="#38875115">prev</a><span>|</span><a href="#38875621">next</a><span>|</span><label class="collapse" for="c-38874739">[-]</label><label class="expand" for="c-38874739">[1 more]</label></div><br/><div class="children"><div class="content">A do it yourself guide to stuff you shouldn’t do.</div><br/></div></div><div id="38875621" class="c"><input type="checkbox" id="c-38875621" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#38874739">prev</a><span>|</span><a href="#38875495">next</a><span>|</span><label class="collapse" for="c-38875621">[-]</label><label class="expand" for="c-38875621">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Once you’ve installed the profile, we once again need to manually tweak trust settings. This time to explicitly enable Full Trust for the Smallstep RADIUS server’s root CA. Again, this is not true for a full MDM enrollment.</i><p>Do not download and install and fully trust root CAs from anyone on your iPhone.</div><br/></div></div><div id="38875495" class="c"><input type="checkbox" id="c-38875495" checked=""/><div class="controls bullet"><span class="by">boringuser2</span><span>|</span><a href="#38875621">prev</a><span>|</span><a href="#38875421">next</a><span>|</span><label class="collapse" for="c-38875495">[-]</label><label class="expand" for="c-38875495">[2 more]</label></div><br/><div class="children"><div class="content">I think this is generally barking up the wrong tree and addressing the wrong attack vectors for home wifi.<p>An actual over-engineered home wifi looks like this:<p>1. Use, at the very least, prosumer grade router access points. I use *sense and Aruba access points, but you don&#x27;t need to get this serious.<p>2. Use heavy DNS filters. This will block a lot of malware by itself. Quad9 DNS is a good starting point.<p>3. Use a secure wifi password.<p>4. Don&#x27;t enable upnp, etc.<p>5. Don&#x27;t enable ssh or any kind of remote access.<p>6. Don&#x27;t open any ports to the outside. This is the default ruleset for pretty much any firewall.<p>7. If you ever have guests who require wifi, segment these users on a guest wifi or vlan.<p>8. Reduce your reliance on wifi-powered devices. Favor zigbee smart home devices over wifi devices.<p>9. (Optional) segment your IoT devices on a vlan.<p>10. (Optional) use some kind of security package that includes layer 7 monitoring on your LAN.<p>11. (Optional) use some kind of security package that includes IPS&#x2F;IDS.</div><br/><div id="38875703" class="c"><input type="checkbox" id="c-38875703" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#38875495">parent</a><span>|</span><a href="#38875421">next</a><span>|</span><label class="collapse" for="c-38875703">[-]</label><label class="expand" for="c-38875703">[1 more]</label></div><br/><div class="children"><div class="content">Items 4-9 accomplish nothing.  Your LAN is not a security perimeter.  This ain’t token ring.</div><br/></div></div></div></div><div id="38875421" class="c"><input type="checkbox" id="c-38875421" checked=""/><div class="controls bullet"><span class="by">dontupvoteme</span><span>|</span><a href="#38875495">prev</a><span>|</span><a href="#38875263">next</a><span>|</span><label class="collapse" for="c-38875421">[-]</label><label class="expand" for="c-38875421">[1 more]</label></div><br/><div class="children"><div class="content">&gt;NSA<p>&gt;Wi-Fi<p>No.</div><br/></div></div><div id="38875263" class="c"><input type="checkbox" id="c-38875263" checked=""/><div class="controls bullet"><span class="by">wwarner</span><span>|</span><a href="#38875421">prev</a><span>|</span><a href="#38875021">next</a><span>|</span><label class="collapse" for="c-38875263">[-]</label><label class="expand" for="c-38875263">[1 more]</label></div><br/><div class="children"><div class="content">this guy is a good writer</div><br/></div></div><div id="38875021" class="c"><input type="checkbox" id="c-38875021" checked=""/><div class="controls bullet"><span class="by">cvalka</span><span>|</span><a href="#38875263">prev</a><span>|</span><a href="#38874707">next</a><span>|</span><label class="collapse" for="c-38875021">[-]</label><label class="expand" for="c-38875021">[1 more]</label></div><br/><div class="children"><div class="content">Use EAP-TTLS</div><br/></div></div><div id="38874707" class="c"><input type="checkbox" id="c-38874707" checked=""/><div class="controls bullet"><span class="by">demondemidi</span><span>|</span><a href="#38875021">prev</a><span>|</span><label class="collapse" for="c-38874707">[-]</label><label class="expand" for="c-38874707">[1 more]</label></div><br/><div class="children"><div class="content">This is how DefCon provides WiFi.</div><br/></div></div></div></div></div></div></div></body></html>