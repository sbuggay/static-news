<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1715590866519" as="style"/><link rel="stylesheet" href="styles.css?v=1715590866519"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://win-vector.com/2024/05/09/solving-recurrence-relations/">Solving Recurrence Relations</a> <span class="domain">(<a href="https://win-vector.com">win-vector.com</a>)</span></div><div class="subtext"><span>jmount</span> | <span>9 comments</span></div><br/><div><div id="40337365" class="c"><input type="checkbox" id="c-40337365" checked=""/><div class="controls bullet"><span class="by">matheist</span><span>|</span><a href="#40339897">next</a><span>|</span><label class="collapse" for="c-40337365">[-]</label><label class="expand" for="c-40337365">[5 more]</label></div><br/><div class="children"><div class="content">To my taste this is not very illuminating, it feels like the answer is produced via a magic trick.<p>My personal preference for understanding linear recurrence relations (and understanding where&#x2F;why sqrt(5) shows up for the Fibonacci sequence) is via eigenvalues and eigenvectors of a corresponding linear transformation. For example:<p><pre><code>  [F_n  ] = [1 1] [F_n-1]
  [F_n-1]   [1 0] [F_n-2]
</code></pre>
and therefore<p><pre><code>  [F_n  ] = [1 1]^n-2 [F_2] = [1 1]^n-2 [1]
  [F_n-1]   [1 0]     [F_1]   [1 0]     [1]
</code></pre>
and therefore the nth Fibonacci number can be computed by computing the (n-2)th power of the matrix [[1, 1], [1, 0]], and then multiplying that matrix by the column vector [1, 1] (or any other desired first terms of the sequence). The matrix power can be computed by diagonalizing, and that&#x27;s where the powers of the golden ratio will come up (as eigenvalues of that matrix).<p>This is completely equivalent to the method in TFA, but to my mind is better motivated.</div><br/><div id="40337852" class="c"><input type="checkbox" id="c-40337852" checked=""/><div class="controls bullet"><span class="by">fernmyth</span><span>|</span><a href="#40337365">parent</a><span>|</span><a href="#40339784">next</a><span>|</span><label class="collapse" for="c-40337852">[-]</label><label class="expand" for="c-40337852">[2 more]</label></div><br/><div class="children"><div class="content">Solving recurrence relations has always felt just out of reach for me. But rewriting it in matrix form makes so much sense! Thanks!</div><br/></div></div><div id="40339784" class="c"><input type="checkbox" id="c-40339784" checked=""/><div class="controls bullet"><span class="by">civilized</span><span>|</span><a href="#40337365">parent</a><span>|</span><a href="#40337852">prev</a><span>|</span><a href="#40339709">next</a><span>|</span><label class="collapse" for="c-40339784">[-]</label><label class="expand" for="c-40339784">[1 more]</label></div><br/><div class="children"><div class="content">Note: it may not be immediately apparent, but all constant-coefficient linear recurrence relations of any complexity can be straightforwardly solved with this technique.</div><br/></div></div><div id="40339709" class="c"><input type="checkbox" id="c-40339709" checked=""/><div class="controls bullet"><span class="by">fennecs</span><span>|</span><a href="#40337365">parent</a><span>|</span><a href="#40339784">prev</a><span>|</span><a href="#40339897">next</a><span>|</span><label class="collapse" for="c-40339709">[-]</label><label class="expand" for="c-40339709">[1 more]</label></div><br/><div class="children"><div class="content">What’s more, if you need to compute F_n, you can do the matrix power by  exponentiation by squaring. It can speed up the calculation quite a bit.</div><br/></div></div></div></div><div id="40339897" class="c"><input type="checkbox" id="c-40339897" checked=""/><div class="controls bullet"><span class="by">andrewp123</span><span>|</span><a href="#40337365">prev</a><span>|</span><a href="#40337274">next</a><span>|</span><label class="collapse" for="c-40339897">[-]</label><label class="expand" for="c-40339897">[1 more]</label></div><br/><div class="children"><div class="content">A powerful method in math is to assume the thing you&#x27;re looking for is continuous, in which case you can write it F(n) = a0 + a1 n + a2 n^2 + ... .<p>You can solve Fibonacci by writing it as<p>a0 + a1 n + a2 n^2 + ...<p>= a0 + a1 (n-1) + a2 (n-1)^2 + ...<p>+ a0 + a1 (n-2) + a2 (n-2)^2 + ...<p>Expand terms, then match the n, n^2, n^3 etc terms and solve for a0, a1, a2, etc. This works in solving differential equations too - it&#x27;s called &quot;Method of Frobenius&quot; (easier in diffeq because you don&#x27;t have to do annoying binomial coefficient math).</div><br/></div></div><div id="40337274" class="c"><input type="checkbox" id="c-40337274" checked=""/><div class="controls bullet"><span class="by">jcla1</span><span>|</span><a href="#40339897">prev</a><span>|</span><a href="#40337859">next</a><span>|</span><label class="collapse" for="c-40337274">[-]</label><label class="expand" for="c-40337274">[1 more]</label></div><br/><div class="children"><div class="content">Unfortunately the presented method only works for the most simple linear recurrence relations.<p>Tangentially: look up the master theorem if you&#x27;re interested in at least estimating growth rates for recurrence relations that crop up in computer science.</div><br/></div></div><div id="40337859" class="c"><input type="checkbox" id="c-40337859" checked=""/><div class="controls bullet"><span class="by">gballan</span><span>|</span><a href="#40337274">prev</a><span>|</span><label class="collapse" for="c-40337859">[-]</label><label class="expand" for="c-40337859">[1 more]</label></div><br/><div class="children"><div class="content">Siebert [1] is great for this stuff (z-transform). The Fibonacci sequence appears in problem 7.2.<p>[1] Siebert, William McC.. Circuits, Signals, and Systems., McGraw-Hill, 1986.</div><br/></div></div></div></div></div></div></div></body></html>