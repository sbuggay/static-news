<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1696582867262" as="style"/><link rel="stylesheet" href="styles.css?v=1696582867262"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/laech/java-stacksrc">Show HN: Decorate Java stack traces with source code snippets</a>Â <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>laech</span> | <span>12 comments</span></div><br/><div><div id="37788412" class="c"><input type="checkbox" id="c-37788412" checked=""/><div class="controls bullet"><span class="by">sakopov</span><span>|</span><a href="#37788475">next</a><span>|</span><label class="collapse" for="c-37788412">[-]</label><label class="expand" for="c-37788412">[1 more]</label></div><br/><div class="children"><div class="content">This is pretty awesome! This got me curious if I can do this in C# so I took a quick stab at it. It&#x27;s not actually updating the original stack trace but it&#x27;s kind of cool. Might be worth exploring further :)<p><pre><code>    static void Main()
    {
        try
        {
            throw new DivideByZeroException(&quot;Boom!&quot;);
        }
        catch (Exception ex)
        {
            var trace = new StackTrace(ex, true);
            var frame = trace.GetFrame(0);

            var targetFilename = frame.GetFileName();
            var targetLineNumber = frame.GetFileLineNumber();

            Console.WriteLine($&quot;Exception occurred at {targetFilename}, line {targetLineNumber}&quot;);

            if (File.Exists(targetFilename))
            {
                var source = File.ReadAllLines(targetFilename);
                var startIndex = Math.Max(0, targetLineNumber - 3);
                var endIndex = Math.Min(source.Length - 1, targetLineNumber + 1);

                for (var i = startIndex; i &lt;= endIndex; i++)
                {
                    var lineNumber = i + 1;
                    Console.WriteLine($&quot;{(lineNumber == targetLineNumber ? $&quot;&gt;&gt; {lineNumber}&quot; : $&quot;   {lineNumber}&quot;)}{source[i]}&quot;);
                }
            }
        }
    }</code></pre></div><br/></div></div><div id="37788475" class="c"><input type="checkbox" id="c-37788475" checked=""/><div class="controls bullet"><span class="by">theanonymousone</span><span>|</span><a href="#37788412">prev</a><span>|</span><a href="#37788232">next</a><span>|</span><label class="collapse" for="c-37788475">[-]</label><label class="expand" for="c-37788475">[1 more]</label></div><br/><div class="children"><div class="content">One big &quot;off-label&quot; use of stack traces for me is to determine the caller method of the current method. I use it in a lightly customised lig function to also log the name of the method thst has emitted a log string.</div><br/></div></div><div id="37788232" class="c"><input type="checkbox" id="c-37788232" checked=""/><div class="controls bullet"><span class="by">zmmmmm</span><span>|</span><a href="#37788475">prev</a><span>|</span><a href="#37787931">next</a><span>|</span><label class="collapse" for="c-37788232">[-]</label><label class="expand" for="c-37788232">[2 more]</label></div><br/><div class="children"><div class="content">Reminds me of power assertions in Groovy - one of my favorite features!</div><br/><div id="37788328" class="c"><input type="checkbox" id="c-37788328" checked=""/><div class="controls bullet"><span class="by">PhilipRoman</span><span>|</span><a href="#37788232">parent</a><span>|</span><a href="#37787931">next</a><span>|</span><label class="collapse" for="c-37788328">[-]</label><label class="expand" for="c-37788328">[1 more]</label></div><br/><div class="children"><div class="content">Yep they are amazing. Never been a fan of alternative JVM languages, but wrote most tests in Groovy just for this feature.</div><br/></div></div></div></div><div id="37787931" class="c"><input type="checkbox" id="c-37787931" checked=""/><div class="controls bullet"><span class="by">nunobrito</span><span>|</span><a href="#37788232">prev</a><span>|</span><a href="#37787892">next</a><span>|</span><label class="collapse" for="c-37787931">[-]</label><label class="expand" for="c-37787931">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for publishing. From the title was expecting that we&#x27;d get the code snippet related to the code itself, rather than the junit where the code failed.<p>But I guess for such feature to be possible you&#x27;d have to pack the source code inside the jar itself.</div><br/><div id="37788097" class="c"><input type="checkbox" id="c-37788097" checked=""/><div class="controls bullet"><span class="by">tomverelst</span><span>|</span><a href="#37787931">parent</a><span>|</span><a href="#37787892">next</a><span>|</span><label class="collapse" for="c-37788097">[-]</label><label class="expand" for="c-37788097">[1 more]</label></div><br/><div class="children"><div class="content">Just tested it, and it does print code snippets of the related code of the source code of my project, and not just of the test itself.</div><br/></div></div></div></div><div id="37787892" class="c"><input type="checkbox" id="c-37787892" checked=""/><div class="controls bullet"><span class="by">gunnarmorling</span><span>|</span><a href="#37787931">prev</a><span>|</span><a href="#37787870">next</a><span>|</span><label class="collapse" for="c-37787892">[-]</label><label class="expand" for="c-37787892">[1 more]</label></div><br/><div class="children"><div class="content">Loving it! Building a Maven Surefire plug-in to do this was on my list of potential side projects for quite a while, so cool that someone finally did this. Even better as a JUnit extension. Congrats on the release, can&#x27;t wait to give it a try!.</div><br/></div></div><div id="37787870" class="c"><input type="checkbox" id="c-37787870" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#37787892">prev</a><span>|</span><a href="#37788079">next</a><span>|</span><label class="collapse" for="c-37787870">[-]</label><label class="expand" for="c-37787870">[1 more]</label></div><br/><div class="children"><div class="content">Very cool work!<p>Some unsolicited opinion: One potential code pet peeve i always have is that the overloads being used in java serves no purpose, but makes the code super confusing to read without using an IDE.<p>For example, <a href="https:&#x2F;&#x2F;github.com&#x2F;laech&#x2F;java-stacksrc&#x2F;blob&#x2F;main&#x2F;core&#x2F;src&#x2F;main&#x2F;java&#x2F;nz&#x2F;lae&#x2F;stacksrc&#x2F;StackTraceDecorator.java#L82">https:&#x2F;&#x2F;github.com&#x2F;laech&#x2F;java-stacksrc&#x2F;blob&#x2F;main&#x2F;core&#x2F;src&#x2F;ma...</a> , which is code to decorate the stacktrace element, calls the function `decorate`. However, there&#x27;s several overloads, all named decorate! It is certainly a better naming convention to call it `decorateElement` imho.</div><br/></div></div><div id="37788079" class="c"><input type="checkbox" id="c-37788079" checked=""/><div class="controls bullet"><span class="by">CrimsonChapulin</span><span>|</span><a href="#37787870">prev</a><span>|</span><a href="#37787760">next</a><span>|</span><label class="collapse" for="c-37788079">[-]</label><label class="expand" for="c-37788079">[1 more]</label></div><br/><div class="children"><div class="content">FYI: for the gradle dependencies section on the read me, both junit4 and junit5 say junit5.</div><br/></div></div><div id="37787760" class="c"><input type="checkbox" id="c-37787760" checked=""/><div class="controls bullet"><span class="by">rickette</span><span>|</span><a href="#37788079">prev</a><span>|</span><a href="#37787072">next</a><span>|</span><label class="collapse" for="c-37787760">[-]</label><label class="expand" for="c-37787760">[1 more]</label></div><br/><div class="children"><div class="content">This look pretty useful, thanks.</div><br/></div></div><div id="37787072" class="c"><input type="checkbox" id="c-37787072" checked=""/><div class="controls bullet"><span class="by">treebeard5440</span><span>|</span><a href="#37787760">prev</a><span>|</span><label class="collapse" for="c-37787072">[-]</label><label class="expand" for="c-37787072">[1 more]</label></div><br/><div class="children"><div class="content">Great work - I like this a lot</div><br/></div></div></div></div></div></div></div></body></html>