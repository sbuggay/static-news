<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1713258059254" as="style"/><link rel="stylesheet" href="styles.css?v=1713258059254"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-p521-bias.html">PuTTY vulnerability vuln-p521-bias</a> <span class="domain">(<a href="https://www.chiark.greenend.org.uk">www.chiark.greenend.org.uk</a>)</span></div><div class="subtext"><span>aardvark179</span> | <span>167 comments</span></div><br/><div><div id="40045377" class="c"><input type="checkbox" id="c-40045377" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40046382">next</a><span>|</span><label class="collapse" for="c-40045377">[-]</label><label class="expand" for="c-40045377">[21 more]</label></div><br/><div class="children"><div class="content">This is one of the all-time cryptography footguns, an absolutely perfect example of how systems development intuition fails in cryptography engineering.<p>The problem here is the distinction between an n-bit random number and n-bit modulus. In DSA, if you&#x27;re working with a 521-bit modulus, and you need a random k value for it, k needs to be random across all 521-bits.<p>Systems programming intuition tells you that a 512-bit random number is, to within mind-boggling tolerances, as unguessable as a 521-bit random number. But that&#x27;s not the point. A 512 bit modulus leaves 9 zero bits, which are legible to cryptanalysis as bias. In the DSA&#x2F;ECDSA equation, this reduces through linear algebra to the Hidden Number Problem, solvable over some number of sample signatures for the private key using CVP.<p><i>Later</i><p>Here you go, from Sean Devlin&#x27;s Cryptopals Set 8:<p><a href="https:&#x2F;&#x2F;cryptopals.com&#x2F;sets&#x2F;8&#x2F;challenges&#x2F;62.txt" rel="nofollow">https:&#x2F;&#x2F;cryptopals.com&#x2F;sets&#x2F;8&#x2F;challenges&#x2F;62.txt</a></div><br/><div id="40045950" class="c"><input type="checkbox" id="c-40045950" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40046132">next</a><span>|</span><label class="collapse" for="c-40045950">[-]</label><label class="expand" for="c-40045950">[9 more]</label></div><br/><div class="children"><div class="content">What&#x27;s really interesting to me is that there was a known solution to the DSA&#x2F;ECDSA nonce generation problem, RFC 6979, which was published 4 years before the vulnerability was introduced into PuTTY.  And it sounds like the developer knew about this RFC at the time but didn&#x27;t implement it because the much earlier version of deterministic nonce generation that PuTTY already had seemed similar enough and the differences were assessed to not be security critical.<p>So I think the other lesson here is that deviating from a cryptographic right answer is a major footgun unless you understand <i>exactly</i> why the recommendation works the way it does and <i>exactly</i> what the implications are of you doing it differently.</div><br/><div id="40046192" class="c"><input type="checkbox" id="c-40046192" checked=""/><div class="controls bullet"><span class="by">akerl_</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40045950">parent</a><span>|</span><a href="#40046012">next</a><span>|</span><label class="collapse" for="c-40046192">[-]</label><label class="expand" for="c-40046192">[2 more]</label></div><br/><div class="children"><div class="content">The article addresses this: they wrote this code path in 2001. RFC 6979 was authored in 2013.</div><br/><div id="40046270" class="c"><input type="checkbox" id="c-40046270" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046192">parent</a><span>|</span><a href="#40046012">next</a><span>|</span><label class="collapse" for="c-40046270">[-]</label><label class="expand" for="c-40046270">[1 more]</label></div><br/><div class="children"><div class="content">But elliptic curve support and this vulnerability weren&#x27;t introduced until 2017, and the commit log (<a href="https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c193fe9848f50a88a4089aac647fecc31ae96d27" rel="nofollow">https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c...</a>) makes it clear the developer was aware of the RFC but chose not to upgrade the 2001 code.  Doing so prior to the elliptic curve support being added would have completely avoided this vulnerability.</div><br/></div></div></div></div><div id="40046012" class="c"><input type="checkbox" id="c-40046012" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40045950">parent</a><span>|</span><a href="#40046192">prev</a><span>|</span><a href="#40046132">next</a><span>|</span><label class="collapse" for="c-40046012">[-]</label><label class="expand" for="c-40046012">[6 more]</label></div><br/><div class="children"><div class="content">I think 6979 is a bit of a red herring here. 6979 is about deterministic nonce generation, which is what you do to dodge the problem of having an insecure RNG. But the problem here isn&#x27;t that the RNG is secure; it&#x27;s more fundamentally a problem of not understanding what the rules of the nonce are.<p>But I may be hair-splitting. Like, yeah, they freelanced their own <i>deterministic</i> nonce generation. Either way, I think this code long predates 6979.</div><br/><div id="40046235" class="c"><input type="checkbox" id="c-40046235" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046012">parent</a><span>|</span><a href="#40046132">next</a><span>|</span><label class="collapse" for="c-40046235">[-]</label><label class="expand" for="c-40046235">[5 more]</label></div><br/><div class="children"><div class="content">I was going based off the commit link posted further down the thread (<a href="https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c193fe9848f50a88a4089aac647fecc31ae96d27" rel="nofollow">https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c...</a>).  You&#x27;re right that the PuTTY deterministic nonce generating code does appear to significantly predate the RFC, but it sounds like the developer made a conscious decision when 6979 came out not to switch from what PuTTY already had because they looked similar enough.  The PuTTY release that introduced support for elliptic curve cryptography (and introduced this vulnerability) was 0.68, which came out in 2017, 4 years after the RFC.<p>You&#x27;re right that this was not an RNG security problem and instead was a problem with not understanding ECDSA nonce rules.  However the notable fact for me was that the developer was apparently aware of the recommended way to deterministically generate nonces prior to the vulnerability being introduced and made a choice not to implement the RFC because what PuTTY was already doing seemed close enough, without fully understanding the implications of doing so.  To put it another way, understanding ECDSA nonce rules would have avoided this vulnerability, but so too would implementing the RFC recommended way even if the developer did not fully understand why it was better than the existing implementation.</div><br/><div id="40046289" class="c"><input type="checkbox" id="c-40046289" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046235">parent</a><span>|</span><a href="#40046132">next</a><span>|</span><label class="collapse" for="c-40046289">[-]</label><label class="expand" for="c-40046289">[4 more]</label></div><br/><div class="children"><div class="content">Right, the reason I&#x27;m splitting hairs is that in my intuition, the whole rationale for 6979 is to eliminate the possibility of <i>fully repeated nonces</i>, for instance because your RNG is &quot;unseeded&quot;. You can still end up with a biased nonce even if you&#x27;re using a perfectly seeded random bit generator (as you can see here). But yeah I think we understand each other.<p>As you can probably see, I just love this bug class, is all.</div><br/><div id="40046453" class="c"><input type="checkbox" id="c-40046453" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046289">parent</a><span>|</span><a href="#40046434">next</a><span>|</span><label class="collapse" for="c-40046453">[-]</label><label class="expand" for="c-40046453">[2 more]</label></div><br/><div class="children"><div class="content">&gt; As you can probably see, I just love this bug class, is all.<p>I agree!  DSA nonce issues are a great class of cryptographic bug in that they&#x27;re sort of weirdly unexpected failure properties when you first hear about it.</div><br/><div id="40049079" class="c"><input type="checkbox" id="c-40049079" checked=""/><div class="controls bullet"><span class="by">nmadden</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046453">parent</a><span>|</span><a href="#40046434">next</a><span>|</span><label class="collapse" for="c-40049079">[-]</label><label class="expand" for="c-40049079">[1 more]</label></div><br/><div class="children"><div class="content">And then you find out about special soundness and that this is not only expected behaviour, but crucial to the security definitions and you realise that signatures are absolutely cursed.</div><br/></div></div></div></div><div id="40046434" class="c"><input type="checkbox" id="c-40046434" checked=""/><div class="controls bullet"><span class="by">kwantam</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046289">parent</a><span>|</span><a href="#40046453">prev</a><span>|</span><a href="#40046132">next</a><span>|</span><label class="collapse" for="c-40046434">[-]</label><label class="expand" for="c-40046434">[1 more]</label></div><br/><div class="children"><div class="content">RFC6979 attempts to guarantee that the nonce is unbiased (under the assumption that HMAC&#x27;s output is indistinguishable from random). It&#x27;s definitely attempting to give a stronger property than simply preventing a repeated nonce.<p>See step (h) in Section 3.2. The nonce is selected by rejection sampling. Thus, under the above assumption about HMAC, the result is indistinguishable from uniformly random in the [1, q-1] range.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40046132" class="c"><input type="checkbox" id="c-40046132" checked=""/><div class="controls bullet"><span class="by">garaetjjte</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40045950">prev</a><span>|</span><a href="#40048650">next</a><span>|</span><label class="collapse" for="c-40046132">[-]</label><label class="expand" for="c-40046132">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think anybody consciously looked at 9 zero bits and thought <i>this is fine</i>, but it rather looks like unfortunate effect of plugging old code into new algorithms without proper verification.</div><br/><div id="40046377" class="c"><input type="checkbox" id="c-40046377" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40046132">parent</a><span>|</span><a href="#40048650">next</a><span>|</span><label class="collapse" for="c-40046377">[-]</label><label class="expand" for="c-40046377">[2 more]</label></div><br/><div class="children"><div class="content">You could be right.  If you look at the old code, dsa_gen_k(), that was removed during the commit (<a href="https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c193fe9848f50a88a4089aac647fecc31ae96d27" rel="nofollow">https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c...</a>), it does basically no bounds checking, presumably because at the time it was written it was assumed that all modulus values would be many fewer bits than the size of a SHA-512 output.<p>So it would have been pretty easy to just reuse the function for a modulus value that was too big without encountering any errors.  And the old code was written 15+ years before it was used for P-521, so it&#x27;s entirely possible the developer forgot the limitations of the dsa_gen_k() function.  So maybe there&#x27;s another lesson here about bounds checking inputs and outputs even if they don&#x27;t apply to anything you&#x27;re currently doing.</div><br/></div></div></div></div><div id="40048650" class="c"><input type="checkbox" id="c-40048650" checked=""/><div class="controls bullet"><span class="by">acer4666</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40046132">prev</a><span>|</span><a href="#40048841">next</a><span>|</span><label class="collapse" for="c-40048650">[-]</label><label class="expand" for="c-40048650">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not the difference between an n-bit random number and an n-bit modulus. It&#x27;s the difference between a 512-bit random number and a 521-bit random number. It&#x27;s very simple, but wording it as number vs. modulus is needlessly confusing, just adding to the problem you are bemoaning.</div><br/></div></div><div id="40048841" class="c"><input type="checkbox" id="c-40048841" checked=""/><div class="controls bullet"><span class="by">kijin</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40048650">prev</a><span>|</span><a href="#40047476">next</a><span>|</span><label class="collapse" for="c-40048841">[-]</label><label class="expand" for="c-40048841">[1 more]</label></div><br/><div class="children"><div class="content">The very existence of 521-bit ECDSA is a footgun just waiting to go off.<p>To any programmer who is accustomed to thinking in binary but hasn&#x27;t heard the full story about why it ended up being such an odd number, 521 is virtually indistinguishable at a glance from the nice round number that is 512. Heck, when I first read about it, I thought it was a typo!</div><br/></div></div><div id="40047476" class="c"><input type="checkbox" id="c-40047476" checked=""/><div class="controls bullet"><span class="by">gpm</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40048841">prev</a><span>|</span><a href="#40047287">next</a><span>|</span><label class="collapse" for="c-40047476">[-]</label><label class="expand" for="c-40047476">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Systems programming intuition tells you that a 512-bit random number is, to within mind-boggling tolerances, as unguessable as a 521-bit random number.<p>Sure, but the other half of systems programming intuition tells you &quot;the end user is going to truncate this value to 8 bits and still expect it to be random&quot;.</div><br/></div></div><div id="40047287" class="c"><input type="checkbox" id="c-40047287" checked=""/><div class="controls bullet"><span class="by">darby_eight</span><span>|</span><a href="#40045377">parent</a><span>|</span><a href="#40047476">prev</a><span>|</span><a href="#40046382">next</a><span>|</span><label class="collapse" for="c-40047287">[-]</label><label class="expand" for="c-40047287">[5 more]</label></div><br/><div class="children"><div class="content">Tf is a zero bit and how is it distinct from a zero bit?</div><br/><div id="40047343" class="c"><input type="checkbox" id="c-40047343" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40047287">parent</a><span>|</span><a href="#40049039">next</a><span>|</span><label class="collapse" for="c-40047343">[-]</label><label class="expand" for="c-40047343">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not quite sure what you&#x27;re asking here but note that 521 != 512, and the former is not a typo.</div><br/><div id="40048607" class="c"><input type="checkbox" id="c-40048607" checked=""/><div class="controls bullet"><span class="by">cozzyd</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40047343">parent</a><span>|</span><a href="#40049039">next</a><span>|</span><label class="collapse" for="c-40048607">[-]</label><label class="expand" for="c-40048607">[2 more]</label></div><br/><div class="children"><div class="content">Plot twist: The choice of 521 is adversarial specifically to exploit PuTTY without being easily noticed. (Ok I get that 2^521-1 is a mersenne prime).</div><br/><div id="40049721" class="c"><input type="checkbox" id="c-40049721" checked=""/><div class="controls bullet"><span class="by">asddubs</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40048607">parent</a><span>|</span><a href="#40049039">next</a><span>|</span><label class="collapse" for="c-40049721">[-]</label><label class="expand" for="c-40049721">[1 more]</label></div><br/><div class="children"><div class="content">maybe 2^521-1 being a mersenne prime is adversarial</div><br/></div></div></div></div></div></div><div id="40049039" class="c"><input type="checkbox" id="c-40049039" checked=""/><div class="controls bullet"><span class="by">gpvos</span><span>|</span><a href="#40045377">root</a><span>|</span><a href="#40047287">parent</a><span>|</span><a href="#40047343">prev</a><span>|</span><a href="#40046382">next</a><span>|</span><label class="collapse" for="c-40049039">[-]</label><label class="expand" for="c-40049039">[1 more]</label></div><br/><div class="children"><div class="content">A zero bit is not a cryptographically random bit.</div><br/></div></div></div></div></div></div><div id="40046382" class="c"><input type="checkbox" id="c-40046382" checked=""/><div class="controls bullet"><span class="by">MaxBarraclough</span><span>|</span><a href="#40045377">prev</a><span>|</span><a href="#40045090">next</a><span>|</span><label class="collapse" for="c-40046382">[-]</label><label class="expand" for="c-40046382">[7 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t have a substantive comment to offer, but good on Simon Tatham for the clear and forthcoming write-up. No damage-control lawyerly BS, no &#x27;ego&#x27;, just the facts about the issue.<p>It&#x27;s reassuring to see a solid disclosure after a security issue, and we too often see half-truths and deceptive downplaying, e.g. LastPass.</div><br/><div id="40048966" class="c"><input type="checkbox" id="c-40048966" checked=""/><div class="controls bullet"><span class="by">pertymcpert</span><span>|</span><a href="#40046382">parent</a><span>|</span><a href="#40046787">next</a><span>|</span><label class="collapse" for="c-40048966">[-]</label><label class="expand" for="c-40048966">[1 more]</label></div><br/><div class="children"><div class="content">Yes, Simon is a brilliant person (hi Simon!) and would be the last person on earth to do any spin. He also doesn&#x27;t owe anyone anything, PuTTY was a gift from him to the world when there was no good alternative on Windows, a gift that has had an incalculably large benefit to so many people that no one should forget.</div><br/></div></div><div id="40046787" class="c"><input type="checkbox" id="c-40046787" checked=""/><div class="controls bullet"><span class="by">loop22</span><span>|</span><a href="#40046382">parent</a><span>|</span><a href="#40048966">prev</a><span>|</span><a href="#40045090">next</a><span>|</span><label class="collapse" for="c-40046787">[-]</label><label class="expand" for="c-40046787">[5 more]</label></div><br/><div class="children"><div class="content">&gt; No damage-control lawyerly BS, no &#x27;ego&#x27;<p>And no cutesy name for the vulnerability</div><br/><div id="40048149" class="c"><input type="checkbox" id="c-40048149" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#40046382">root</a><span>|</span><a href="#40046787">parent</a><span>|</span><a href="#40047112">next</a><span>|</span><label class="collapse" for="c-40048149">[-]</label><label class="expand" for="c-40048149">[3 more]</label></div><br/><div class="children"><div class="content">SillyPutty</div><br/><div id="40048732" class="c"><input type="checkbox" id="c-40048732" checked=""/><div class="controls bullet"><span class="by">SV_BubbleTime</span><span>|</span><a href="#40046382">root</a><span>|</span><a href="#40048149">parent</a><span>|</span><a href="#40047112">next</a><span>|</span><label class="collapse" for="c-40048732">[-]</label><label class="expand" for="c-40048732">[2 more]</label></div><br/><div class="children"><div class="content">Canon now.</div><br/><div id="40049644" class="c"><input type="checkbox" id="c-40049644" checked=""/><div class="controls bullet"><span class="by">rustcleaner</span><span>|</span><a href="#40046382">root</a><span>|</span><a href="#40048732">parent</a><span>|</span><a href="#40047112">next</a><span>|</span><label class="collapse" for="c-40049644">[-]</label><label class="expand" for="c-40049644">[1 more]</label></div><br/><div class="children"><div class="content">Seconded.</div><br/></div></div></div></div></div></div><div id="40047112" class="c"><input type="checkbox" id="c-40047112" checked=""/><div class="controls bullet"><span class="by">xwolfi</span><span>|</span><a href="#40046382">root</a><span>|</span><a href="#40046787">parent</a><span>|</span><a href="#40048149">prev</a><span>|</span><a href="#40045090">next</a><span>|</span><label class="collapse" for="c-40047112">[-]</label><label class="expand" for="c-40047112">[1 more]</label></div><br/><div class="children"><div class="content">The &quot;Dragon Eater Vulnerability&quot;, that all managers will agitate about mitigating for the next 4 weeks...</div><br/></div></div></div></div></div></div><div id="40045090" class="c"><input type="checkbox" id="c-40045090" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#40046382">prev</a><span>|</span><a href="#40045170">next</a><span>|</span><label class="collapse" for="c-40045090">[-]</label><label class="expand" for="c-40045090">[24 more]</label></div><br/><div class="children"><div class="content">I wish this announcement included the backstory of how someone discovered this vulnerability.<p>Public keys are enough of a pain in the ass with PuTTY &#x2F; KiTTY that I stick with password auth for my windows SSH&#x27;ing needs.<p>KiTTY even let&#x27;s you save the passwords so you don&#x27;t have to type it in, a horrible security practice no doubt, but so convenient... Perhaps more secure than the putty-gen&#x27;d ECDSA P521 keys?  A tad bit ironic.</div><br/><div id="40045192" class="c"><input type="checkbox" id="c-40045192" checked=""/><div class="controls bullet"><span class="by">lambdafu</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40045129">next</a><span>|</span><label class="collapse" for="c-40045192">[-]</label><label class="expand" for="c-40045192">[3 more]</label></div><br/><div class="children"><div class="content">We found it by investigating the security of SSH as part of a larger research program focussing on SSH, which also resulted in our publication of the Terrapin vulnerability.<p>This particular bug basically fell into our hands while staring at the source code during our investigation of the security of SSH client signatures.</div><br/><div id="40049430" class="c"><input type="checkbox" id="c-40049430" checked=""/><div class="controls bullet"><span class="by">protomolecule</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045192">parent</a><span>|</span><a href="#40049375">next</a><span>|</span><label class="collapse" for="c-40049430">[-]</label><label class="expand" for="c-40049430">[1 more]</label></div><br/><div class="children"><div class="content">Thank you, we all need more of that.</div><br/></div></div><div id="40049375" class="c"><input type="checkbox" id="c-40049375" checked=""/><div class="controls bullet"><span class="by">wiz21c</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045192">parent</a><span>|</span><a href="#40049430">prev</a><span>|</span><a href="#40045129">next</a><span>|</span><label class="collapse" for="c-40049375">[-]</label><label class="expand" for="c-40049375">[1 more]</label></div><br/><div class="children"><div class="content">Public money very well spent...</div><br/></div></div></div></div><div id="40045129" class="c"><input type="checkbox" id="c-40045129" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40045192">prev</a><span>|</span><a href="#40045392">next</a><span>|</span><label class="collapse" for="c-40045129">[-]</label><label class="expand" for="c-40045129">[8 more]</label></div><br/><div class="children"><div class="content">Ironically, DJB considers the 521 curve to be the only NIST standard that uses reasonable primes.<p>&quot;To be fair I should mention that there&#x27;s one standard NIST curve using a nice prime, namely 2^521 - 1; but the sheer size of this prime makes it much slower than NIST P-256.&quot;<p><a href="http:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140323-ecdsa.html" rel="nofollow">http:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140323-ecdsa.html</a><p><a href="http:&#x2F;&#x2F;safecurves.cr.yp.to&#x2F;rigid.html" rel="nofollow">http:&#x2F;&#x2F;safecurves.cr.yp.to&#x2F;rigid.html</a></div><br/><div id="40045320" class="c"><input type="checkbox" id="c-40045320" checked=""/><div class="controls bullet"><span class="by">pclmulqdq</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045129">parent</a><span>|</span><a href="#40046277">next</a><span>|</span><label class="collapse" for="c-40045320">[-]</label><label class="expand" for="c-40045320">[1 more]</label></div><br/><div class="children"><div class="content">The 521 curve is the only one using a Mersenne prime, which has significant advantages when you do calculations, but also feels less arbitrary.</div><br/></div></div><div id="40046277" class="c"><input type="checkbox" id="c-40046277" checked=""/><div class="controls bullet"><span class="by">kwantam</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045129">parent</a><span>|</span><a href="#40045320">prev</a><span>|</span><a href="#40045392">next</a><span>|</span><label class="collapse" for="c-40046277">[-]</label><label class="expand" for="c-40046277">[6 more]</label></div><br/><div class="children"><div class="content">This vulnerability has very little to do with P-521 per se. The issue is with ECDSA: <i>any</i> use of ECDSA with biased nonce generation, regardless of the elliptic curve it&#x27;s implemented over, immediately causes secret key leakage.<p>(Rant: All these years later, we&#x27;re all still doing penance for the fact that Schnorr signatures were patented and so everyone used ECDSA instead. It&#x27;s an absolute garbage fire of a signature scheme and should be abandoned yesterday for many reasons, e.g., no real proof of security, terrible footguns like this.)</div><br/><div id="40047887" class="c"><input type="checkbox" id="c-40047887" checked=""/><div class="controls bullet"><span class="by">djao</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40046277">parent</a><span>|</span><a href="#40049680">next</a><span>|</span><label class="collapse" for="c-40047887">[-]</label><label class="expand" for="c-40047887">[2 more]</label></div><br/><div class="children"><div class="content">Schnorr wouldn&#x27;t have helped in this specific case, since Schnorr is equally vulnerable to biased nonces (<a href="https:&#x2F;&#x2F;ecc2017.cs.ru.nl&#x2F;slides&#x2F;ecc2017-tibouchi.pdf" rel="nofollow">https:&#x2F;&#x2F;ecc2017.cs.ru.nl&#x2F;slides&#x2F;ecc2017-tibouchi.pdf</a>).<p>EdDSA, which is essentially deterministic Schnorr, does solve the problem.<p>Also, the use of P-521 didn&#x27;t specifically cause the vulnerability, but the bad interaction between SHA512 and P-521 did play a role. It is unfortunate that nature conspired against us to make 2^511 - 1 a composite number. The fact that you have to go up to 521 bits to get a Mersenne prime whereas the natural target length for a hash output is 512 bits is the fatal interaction here.</div><br/><div id="40048301" class="c"><input type="checkbox" id="c-40048301" checked=""/><div class="controls bullet"><span class="by">kwantam</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40047887">parent</a><span>|</span><a href="#40049680">next</a><span>|</span><label class="collapse" for="c-40048301">[-]</label><label class="expand" for="c-40048301">[1 more]</label></div><br/><div class="children"><div class="content">Excellent points all around, and thank you for the pointer to the ECC slides :)<p>(And indeed, nature could have been kinder to us and given us a Mersenne between 127 and 521...)</div><br/></div></div></div></div><div id="40049680" class="c"><input type="checkbox" id="c-40049680" checked=""/><div class="controls bullet"><span class="by">CRConrad</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40046277">parent</a><span>|</span><a href="#40047887">prev</a><span>|</span><a href="#40048758">next</a><span>|</span><label class="collapse" for="c-40049680">[-]</label><label class="expand" for="c-40049680">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Schnorr signatures<p>Never heard of (which probably demonstrates that I know pretty much nothing about cryptography?), so seeing a name spelled like &quot;Schn...r&quot; in this context makes at least me think of an entirely different luminary in the area. Thought it was a typo at first.</div><br/></div></div><div id="40048758" class="c"><input type="checkbox" id="c-40048758" checked=""/><div class="controls bullet"><span class="by">SV_BubbleTime</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40046277">parent</a><span>|</span><a href="#40049680">prev</a><span>|</span><a href="#40045392">next</a><span>|</span><label class="collapse" for="c-40048758">[-]</label><label class="expand" for="c-40048758">[2 more]</label></div><br/><div class="children"><div class="content">I’m over here wondering why someone would want deterministic nonces.<p>Isn’t it kind of the point to just roll random numbers? When would you calculate?</div><br/><div id="40049329" class="c"><input type="checkbox" id="c-40049329" checked=""/><div class="controls bullet"><span class="by">ajb</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40048758">parent</a><span>|</span><a href="#40045392">next</a><span>|</span><label class="collapse" for="c-40049329">[-]</label><label class="expand" for="c-40049329">[1 more]</label></div><br/><div class="children"><div class="content">It says in the OP. Windows at the time did not provide a cryptographic quality random number source.</div><br/></div></div></div></div></div></div></div></div><div id="40045392" class="c"><input type="checkbox" id="c-40045392" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40045129">prev</a><span>|</span><a href="#40045134">next</a><span>|</span><label class="collapse" for="c-40045392">[-]</label><label class="expand" for="c-40045392">[3 more]</label></div><br/><div class="children"><div class="content">Assuming I&#x27;m reading it right, this is an absolutely classic vulnerability, something people who study cryptographic vulnerability research would instinctually check for, so what&#x27;s taken so long is probably for anyone to bother evaluating the P-521 implementation in PuTTY.</div><br/><div id="40046103" class="c"><input type="checkbox" id="c-40046103" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045392">parent</a><span>|</span><a href="#40045134">next</a><span>|</span><label class="collapse" for="c-40046103">[-]</label><label class="expand" for="c-40046103">[2 more]</label></div><br/><div class="children"><div class="content">Correct. Every time I&#x27;ve seen P-521 in a professional setting, it is the <i>very first</i> thing I check for.</div><br/><div id="40049253" class="c"><input type="checkbox" id="c-40049253" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40046103">parent</a><span>|</span><a href="#40045134">next</a><span>|</span><label class="collapse" for="c-40049253">[-]</label><label class="expand" for="c-40049253">[1 more]</label></div><br/><div class="children"><div class="content">How often do people get it wrong? It doesn&#x27;t seem particularly difficult to generate 521 random bits.</div><br/></div></div></div></div></div></div><div id="40045134" class="c"><input type="checkbox" id="c-40045134" checked=""/><div class="controls bullet"><span class="by">orev</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40045392">prev</a><span>|</span><a href="#40046798">next</a><span>|</span><label class="collapse" for="c-40045134">[-]</label><label class="expand" for="c-40045134">[6 more]</label></div><br/><div class="children"><div class="content">You should be using pageant to store the secret ssh keys, and you only need to unlock the key on reboot&#x2F;first use.</div><br/><div id="40046315" class="c"><input type="checkbox" id="c-40046315" checked=""/><div class="controls bullet"><span class="by">spacemanspiff01</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045134">parent</a><span>|</span><a href="#40045907">next</a><span>|</span><label class="collapse" for="c-40046315">[-]</label><label class="expand" for="c-40046315">[1 more]</label></div><br/><div class="children"><div class="content">Windows has a built in ssh-agent included with openssh, no need for pagent anymore.<p>Ssh agent will manage your ssh keys through windows registry windows login process.<p>Also if you use wsl, you can access your ssh keys in wsl from the windows ssh-agent via npiperelay</div><br/></div></div><div id="40045907" class="c"><input type="checkbox" id="c-40045907" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045134">parent</a><span>|</span><a href="#40046315">prev</a><span>|</span><a href="#40045172">next</a><span>|</span><label class="collapse" for="c-40045907">[-]</label><label class="expand" for="c-40045907">[1 more]</label></div><br/><div class="children"><div class="content">Or just use a hardware key and enable touch to sign so you have to touch it for every action even when it&#x27;s unlocked</div><br/></div></div><div id="40045172" class="c"><input type="checkbox" id="c-40045172" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045134">parent</a><span>|</span><a href="#40045907">prev</a><span>|</span><a href="#40046798">next</a><span>|</span><label class="collapse" for="c-40045172">[-]</label><label class="expand" for="c-40045172">[3 more]</label></div><br/><div class="children"><div class="content">100% agreed.<p>For me, the stakes are very low.  It&#x27;s my windows &quot;gaming&quot; machine, and has access to a few low-value hosts.<p>Otherwise I&#x27;d invest the time to learn wtf is pageant ;D</div><br/><div id="40045222" class="c"><input type="checkbox" id="c-40045222" checked=""/><div class="controls bullet"><span class="by">lambdafu</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045172">parent</a><span>|</span><a href="#40045241">next</a><span>|</span><label class="collapse" for="c-40045222">[-]</label><label class="expand" for="c-40045222">[1 more]</label></div><br/><div class="children"><div class="content">If the hosts are under your control, and never connect to untrusted hosts, then you are ok. The user authentication is encrypted, so the signatures are not visible to a man in the middle.</div><br/></div></div><div id="40045241" class="c"><input type="checkbox" id="c-40045241" checked=""/><div class="controls bullet"><span class="by">adw</span><span>|</span><a href="#40045090">root</a><span>|</span><a href="#40045172">parent</a><span>|</span><a href="#40045222">prev</a><span>|</span><a href="#40046798">next</a><span>|</span><label class="collapse" for="c-40045241">[-]</label><label class="expand" for="c-40045241">[1 more]</label></div><br/><div class="children"><div class="content">Pageant is `ssh-agent`.</div><br/></div></div></div></div></div></div><div id="40046798" class="c"><input type="checkbox" id="c-40046798" checked=""/><div class="controls bullet"><span class="by">squigz</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40045134">prev</a><span>|</span><a href="#40046325">next</a><span>|</span><label class="collapse" for="c-40046798">[-]</label><label class="expand" for="c-40046798">[1 more]</label></div><br/><div class="children"><div class="content">This entire comment thread hurts my soul.</div><br/></div></div><div id="40046325" class="c"><input type="checkbox" id="c-40046325" checked=""/><div class="controls bullet"><span class="by">delfinom</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40046798">prev</a><span>|</span><a href="#40047077">next</a><span>|</span><label class="collapse" for="c-40046325">[-]</label><label class="expand" for="c-40046325">[1 more]</label></div><br/><div class="children"><div class="content">Windows 10+ now have openssh proper by Microsoft. No need to use putty with it&#x27;s own custom key format among other nonsense.</div><br/></div></div><div id="40047077" class="c"><input type="checkbox" id="c-40047077" checked=""/><div class="controls bullet"><span class="by">biccboii</span><span>|</span><a href="#40045090">parent</a><span>|</span><a href="#40046325">prev</a><span>|</span><a href="#40045170">next</a><span>|</span><label class="collapse" for="c-40047077">[-]</label><label class="expand" for="c-40047077">[1 more]</label></div><br/><div class="children"><div class="content">How are public keys a pain in the ass?</div><br/></div></div></div></div><div id="40045170" class="c"><input type="checkbox" id="c-40045170" checked=""/><div class="controls bullet"><span class="by">WorldMaker</span><span>|</span><a href="#40045090">prev</a><span>|</span><a href="#40045403">next</a><span>|</span><label class="collapse" for="c-40045170">[-]</label><label class="expand" for="c-40045170">[20 more]</label></div><br/><div class="children"><div class="content">Sometimes useful reminder: you may not need PuTTY today. On the one side Windows Terminal does a lot of the classic VT* terminal emulation that old ConHost did not. On the other side Windows ships &quot;real&quot; OpenSSH now as a feature that turns on automatically with Windows &quot;Dev Mode&quot;. No built in GUI for the SSH agent, but at this point if you are familiar with SSH then using a CLI SSH agent shouldn&#x27;t be scary. If you are &quot;upgrading&quot; from PuTTY you just need to export your keys to a different format, but that&#x27;s about the only big change.<p>PuTTY was a great tool for many years and a lot of people have good reasons to not want to let it go. As with most software it accretes habits and processes built on top of it that are hard to leave. But also useful to sometimes remind about the new options because you never know who wants to be in the Lucky 10K to learn that Windows Terminal now has deeper, &quot;true&quot; terminal emulation or that Windows has ssh &quot;built-in&quot;.</div><br/><div id="40045207" class="c"><input type="checkbox" id="c-40045207" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045170">parent</a><span>|</span><a href="#40046201">next</a><span>|</span><label class="collapse" for="c-40045207">[-]</label><label class="expand" for="c-40045207">[14 more]</label></div><br/><div class="children"><div class="content">I am on a corporate desktop, so I cannot use the Microsoft variant of the ssh-agent:<p><pre><code>  C:\Users\luser&gt;ssh-agent
  unable to start ssh-agent service, error :1058
</code></pre>
Obviously, getting that changed globally (or even for myself) is impossible.<p>PuTTY has a workaround, allowing PAGENT.EXE to be used in place of the forbidden&#x2F;inaccessible Microsoft agent:<p><a href="https:&#x2F;&#x2F;tartarus.org&#x2F;~simon&#x2F;putty-snapshots&#x2F;htmldoc&#x2F;Chapter9.html#pageant-cmdline-openssh" rel="nofollow">https:&#x2F;&#x2F;tartarus.org&#x2F;~simon&#x2F;putty-snapshots&#x2F;htmldoc&#x2F;Chapter9...</a><p>So PuTTY remains quite relevant because of the mechanisms that Microsoft has chosen.</div><br/><div id="40045502" class="c"><input type="checkbox" id="c-40045502" checked=""/><div class="controls bullet"><span class="by">WorldMaker</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045207">parent</a><span>|</span><a href="#40046389">next</a><span>|</span><label class="collapse" for="c-40045502">[-]</label><label class="expand" for="c-40045502">[8 more]</label></div><br/><div class="children"><div class="content">I&#x27;m sorry that you need to work around the inability to run a simple Windows service because of some mistakenly bad corporate policy trying to micro-manage which Windows services are allowed to run. I don&#x27;t think the long term solution should be &quot;shadow IT install an older app just because it pretends to be a GUI rather than a Windows service&quot;, but I&#x27;m glad it is working for you in the short term.<p>If you need ammunition to encourage your corporate IT to allow you to run the proper ssh-agent service to do your job instead of increasing your attack surface by installing PuTTY&#x2F;Pageant, you could collect a list of vulnerabilities such as the one posted here (look at the huge count of affected versions on just this one!). There should be plenty of vulnerability maintenance evidence on the Microsoft-shipped version of an open source tool with a lot of eyeballs because it is &quot;the standard&quot; for almost all platforms <i>over</i> the &quot;single developer&quot; tool that took at least a decade off from active development (and it shows).</div><br/><div id="40046712" class="c"><input type="checkbox" id="c-40046712" checked=""/><div class="controls bullet"><span class="by">gred</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045502">parent</a><span>|</span><a href="#40047091">next</a><span>|</span><label class="collapse" for="c-40046712">[-]</label><label class="expand" for="c-40046712">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If you need ammunition to encourage your corporate IT to allow you to run the proper ssh-agent service to do your job instead of increasing your attack surface by installing PuTTY&#x2F;Pageant, you could collect a list of vulnerabilities such as the one posted here...<p>This made me laugh :-) Grandparent is probably happy to just fly under the radar. The suggested conversation would probably play out thusly:<p>&gt; IT! You idiots! Your dumb policies are forcing me to use this insecure software! Look how many vulnerabilities it has had over the years!<p>&gt;&gt; Hold up. Rewind. What&#x27;s this software that you&#x27;ve installed?<p>&gt; It&#x27;s called PuTTY. And if you just change this policy I could...<p>&gt;&gt; And how insecure is it?<p>&gt; Just check out all these vulnerabilities! It&#x27;s probably not worse than the average, but it&#x27;s unnecessary extra attack surface area that...<p>&gt;&gt; I&#x27;m going to need you to uninstall that. Now. And I&#x27;ll need confirmation via email that you have done so by EOB, with your boss and the CISO on CC.<p>&gt; But if you just change this boneheaded policy...<p>&gt;&gt; Now, please. We have a security incident on our hands. We can discuss policy another time. Is there anything else installed on your laptop that I should be aware of?</div><br/><div id="40047109" class="c"><input type="checkbox" id="c-40047109" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40046712">parent</a><span>|</span><a href="#40047091">next</a><span>|</span><label class="collapse" for="c-40047109">[-]</label><label class="expand" for="c-40047109">[1 more]</label></div><br/><div class="children"><div class="content">Actually, the corporate software repository is still pushing 0.67 or so.<p>I need newer PuTTY to have a capable agent.</div><br/></div></div></div></div><div id="40047091" class="c"><input type="checkbox" id="c-40047091" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045502">parent</a><span>|</span><a href="#40046712">prev</a><span>|</span><a href="#40046456">next</a><span>|</span><label class="collapse" for="c-40047091">[-]</label><label class="expand" for="c-40047091">[1 more]</label></div><br/><div class="children"><div class="content">Let me just explain my situation.<p>We were directed to use our new corporate SFTP instead of direct communication with our vendors and customers.<p>I tried direct ssh on the second account they gave us, got a shell, pulled &#x2F;etc&#x2F;passed, and my manager mailed it to corporate security.<p>We had a long talk about configuring ssh. I don&#x27;t know if it helped.</div><br/></div></div><div id="40046456" class="c"><input type="checkbox" id="c-40046456" checked=""/><div class="controls bullet"><span class="by">DEADMINCE</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045502">parent</a><span>|</span><a href="#40047091">prev</a><span>|</span><a href="#40046356">next</a><span>|</span><label class="collapse" for="c-40046456">[-]</label><label class="expand" for="c-40046456">[3 more]</label></div><br/><div class="children"><div class="content">&gt; some mistakenly bad corporate policy trying to micro-manage which Windows services are allowed to run.<p>Actually, I&#x27;d say that&#x27;s a <i>good</i> corporate policy.</div><br/><div id="40047116" class="c"><input type="checkbox" id="c-40047116" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40046456">parent</a><span>|</span><a href="#40046356">next</a><span>|</span><label class="collapse" for="c-40047116">[-]</label><label class="expand" for="c-40047116">[2 more]</label></div><br/><div class="children"><div class="content">...and this is why PAGEANT.EXE is required for Microsoft OpenSSH.</div><br/><div id="40049011" class="c"><input type="checkbox" id="c-40049011" checked=""/><div class="controls bullet"><span class="by">chgs</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40047116">parent</a><span>|</span><a href="#40046356">next</a><span>|</span><label class="collapse" for="c-40049011">[-]</label><label class="expand" for="c-40049011">[1 more]</label></div><br/><div class="children"><div class="content">And it’s why shadow IT exists and shadow IT is why companies don’t fall apart.<p>It’s also why web apps are so popular and why the blackberry failed.</div><br/></div></div></div></div></div></div></div></div><div id="40046389" class="c"><input type="checkbox" id="c-40046389" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045207">parent</a><span>|</span><a href="#40045502">prev</a><span>|</span><a href="#40046406">next</a><span>|</span><label class="collapse" for="c-40046389">[-]</label><label class="expand" for="c-40046389">[1 more]</label></div><br/><div class="children"><div class="content">Really helpful. I found challenge in getting a Windows system (no admin) into a state where i can use it productively, and having a functional ssh-agent was one of the remaining pain points.</div><br/></div></div><div id="40046406" class="c"><input type="checkbox" id="c-40046406" checked=""/><div class="controls bullet"><span class="by">naikrovek</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045207">parent</a><span>|</span><a href="#40046389">prev</a><span>|</span><a href="#40046875">next</a><span>|</span><label class="collapse" for="c-40046406">[-]</label><label class="expand" for="c-40046406">[3 more]</label></div><br/><div class="children"><div class="content">ALWAYS GOOGLE THE ERROR MESSAGE, with context about what you’re doing!<p>I encountered this, too, but the fix is quite simple.<p>That service is set to “manual” by default, (or maybe “disabled”) and setting it to “automatic” then starting it will get you running.<p>It is unlikely that this is a corporate lockdown measure.</div><br/><div id="40046751" class="c"><input type="checkbox" id="c-40046751" checked=""/><div class="controls bullet"><span class="by">rzzzt</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40046406">parent</a><span>|</span><a href="#40046875">next</a><span>|</span><label class="collapse" for="c-40046751">[-]</label><label class="expand" for="c-40046751">[2 more]</label></div><br/><div class="children"><div class="content">What about using AppLocker to restrict allowed executables to a subset of all available pieces of software on the machine?</div><br/><div id="40047089" class="c"><input type="checkbox" id="c-40047089" checked=""/><div class="controls bullet"><span class="by">naikrovek</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40046751">parent</a><span>|</span><a href="#40046875">next</a><span>|</span><label class="collapse" for="c-40047089">[-]</label><label class="expand" for="c-40047089">[1 more]</label></div><br/><div class="children"><div class="content">It’s possible to lock this down, don’t misunderstand me.  I’m saying it’s unlikely for a security team to make this decision on a system where pageant.exe is allowed to run.</div><br/></div></div></div></div></div></div><div id="40046875" class="c"><input type="checkbox" id="c-40046875" checked=""/><div class="controls bullet"><span class="by">nick__m</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40045207">parent</a><span>|</span><a href="#40046406">prev</a><span>|</span><a href="#40046201">next</a><span>|</span><label class="collapse" for="c-40046875">[-]</label><label class="expand" for="c-40046875">[1 more]</label></div><br/><div class="children"><div class="content">WinCryptSSHAgent is a alternative</div><br/></div></div></div></div><div id="40046201" class="c"><input type="checkbox" id="c-40046201" checked=""/><div class="controls bullet"><span class="by">smackeyacky</span><span>|</span><a href="#40045170">parent</a><span>|</span><a href="#40045207">prev</a><span>|</span><a href="#40047726">next</a><span>|</span><label class="collapse" for="c-40046201">[-]</label><label class="expand" for="c-40046201">[1 more]</label></div><br/><div class="children"><div class="content">There are a few different options in Windows that are all measurably superior to PuTTY:<p>Install WSL2 - you get the Linux SSH of your choice.<p>As mentioned above, Windows now ships with OpenSSH and windows terminal is good.<p>My favourite, but now probably obsolete solution was to install MobaXTerm which shipped with an SSH client.  It&#x27;s still great and there is a usable &quot;free&quot; version of it, but WSL2 does everything for me now when I&#x27;m forced to use windows.</div><br/></div></div><div id="40047726" class="c"><input type="checkbox" id="c-40047726" checked=""/><div class="controls bullet"><span class="by">pdntspa</span><span>|</span><a href="#40045170">parent</a><span>|</span><a href="#40046201">prev</a><span>|</span><a href="#40047075">next</a><span>|</span><label class="collapse" for="c-40047726">[-]</label><label class="expand" for="c-40047726">[2 more]</label></div><br/><div class="children"><div class="content">I may not need PuTTY, but I like me a nice GUI that I can point and click with<p>ssh command is absolutely fine, but I much prefer a list of saved presets versus ~&#x2F;.ssh&#x2F;config file fuckery</div><br/><div id="40047771" class="c"><input type="checkbox" id="c-40047771" checked=""/><div class="controls bullet"><span class="by">2cynykyl</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40047726">parent</a><span>|</span><a href="#40047075">next</a><span>|</span><label class="collapse" for="c-40047771">[-]</label><label class="expand" for="c-40047771">[1 more]</label></div><br/><div class="children"><div class="content">Too few nerds are willing to admit this.  I use git all-day-long, but need to check stackoverflow to use the command line for anything more complicated than switching branches...and I&#x27;m ok with that.  I save my brain space for more useful things.</div><br/></div></div></div></div><div id="40047075" class="c"><input type="checkbox" id="c-40047075" checked=""/><div class="controls bullet"><span class="by">Havoc</span><span>|</span><a href="#40045170">parent</a><span>|</span><a href="#40047726">prev</a><span>|</span><a href="#40045403">next</a><span>|</span><label class="collapse" for="c-40047075">[-]</label><label class="expand" for="c-40047075">[2 more]</label></div><br/><div class="children"><div class="content">Can the built in install of openssh generate keys? That’s why I have putty installed</div><br/><div id="40048448" class="c"><input type="checkbox" id="c-40048448" checked=""/><div class="controls bullet"><span class="by">GrantMoyer</span><span>|</span><a href="#40045170">root</a><span>|</span><a href="#40047075">parent</a><span>|</span><a href="#40045403">next</a><span>|</span><label class="collapse" for="c-40048448">[-]</label><label class="expand" for="c-40048448">[1 more]</label></div><br/><div class="children"><div class="content">Yes, the client includes ssh-keygen.</div><br/></div></div></div></div></div></div><div id="40045403" class="c"><input type="checkbox" id="c-40045403" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#40045170">prev</a><span>|</span><a href="#40048881">next</a><span>|</span><label class="collapse" for="c-40045403">[-]</label><label class="expand" for="c-40045403">[8 more]</label></div><br/><div class="children"><div class="content">So this signing method requires a 521 bit random number, and this flaw caused the top 9 bits of that number to be zero instead, and somehow after 60 signatures this leaks the private key?<p>Anyone care to explain how exactly?    How it it any different to the top 9 bits being zero by chance (which happens in 1 out of ~500 attempts anyway)</div><br/><div id="40045875" class="c"><input type="checkbox" id="c-40045875" checked=""/><div class="controls bullet"><span class="by">lambdafu</span><span>|</span><a href="#40045403">parent</a><span>|</span><a href="#40047766">next</a><span>|</span><label class="collapse" for="c-40045875">[-]</label><label class="expand" for="c-40045875">[1 more]</label></div><br/><div class="children"><div class="content">For the attack all 60 signatures need a nonce that is special in this way. If for example only one out of the 60 is short, the attack fails in the lattice reduction step.
The reason is that in the attack, all 60 short nonces &quot;collude&quot; to make up a very special short vector in the lattice, which is much shorter than usual because it is short in all 60 dimensions, not just one out of 500 dimensions. The approximate shortest vector is then obtainable in polynomial time, and this happens to contain the secret key by construction.
As an analogy: Imagine you had a treasure map with 60 steps &quot;go left, go right, go up, go down, go down again&quot; etc. If only one out of 60 instructions where correct, you wouldn&#x27;t know where the treasure is. All of the instructions need to be correct to get there.</div><br/></div></div><div id="40047766" class="c"><input type="checkbox" id="c-40047766" checked=""/><div class="controls bullet"><span class="by">janmo</span><span>|</span><a href="#40045403">parent</a><span>|</span><a href="#40045875">prev</a><span>|</span><a href="#40045879">next</a><span>|</span><label class="collapse" for="c-40047766">[-]</label><label class="expand" for="c-40047766">[5 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t make sense to me as well, even when fully random after 30,000 signatures you would get around 60 signatures where the nonce starts with nine zero bits.<p>I suspect there must be something else at play here.<p>EDIT: the nonce is PRIVATE, so the scenario I described would not work because we wouldn&#x27;t know for which of the 30k signatures the nonce starts with 9 zero bits. Makes sense now.</div><br/><div id="40047899" class="c"><input type="checkbox" id="c-40047899" checked=""/><div class="controls bullet"><span class="by">gs17</span><span>|</span><a href="#40045403">root</a><span>|</span><a href="#40047766">parent</a><span>|</span><a href="#40045879">next</a><span>|</span><label class="collapse" for="c-40047899">[-]</label><label class="expand" for="c-40047899">[4 more]</label></div><br/><div class="children"><div class="content">If I&#x27;m understanding correctly, the difference is between knowing you have 60 and having to try (30000!&#x2F;(60! * (30000 - 60)!) combinations and seeing if they worked, which is quite a few.</div><br/><div id="40048129" class="c"><input type="checkbox" id="c-40048129" checked=""/><div class="controls bullet"><span class="by">cchance</span><span>|</span><a href="#40045403">root</a><span>|</span><a href="#40047899">parent</a><span>|</span><a href="#40045879">next</a><span>|</span><label class="collapse" for="c-40048129">[-]</label><label class="expand" for="c-40048129">[3 more]</label></div><br/><div class="children"><div class="content">I mean the write up indicates you&#x27;d need access to the server side, or the pageant with the private key loaded, which both seem to be like... umm... at that point don&#x27;t we have bigger issues?</div><br/><div id="40048529" class="c"><input type="checkbox" id="c-40048529" checked=""/><div class="controls bullet"><span class="by">Khoth</span><span>|</span><a href="#40045403">root</a><span>|</span><a href="#40048129">parent</a><span>|</span><a href="#40045879">next</a><span>|</span><label class="collapse" for="c-40048529">[-]</label><label class="expand" for="c-40048529">[2 more]</label></div><br/><div class="children"><div class="content">Not sure about the pageant part, but it&#x27;s a major problem when connecting to a compromised server leaks the client&#x27;s private key.<p>(For example, if an attacker has compromised server A and you connect to it, they can now use your key to connect to server B which you also use)</div><br/><div id="40049143" class="c"><input type="checkbox" id="c-40049143" checked=""/><div class="controls bullet"><span class="by">leni536</span><span>|</span><a href="#40045403">root</a><span>|</span><a href="#40048529">parent</a><span>|</span><a href="#40045879">next</a><span>|</span><label class="collapse" for="c-40049143">[-]</label><label class="expand" for="c-40049143">[1 more]</label></div><br/><div class="children"><div class="content">Now I feel better for never using the same key for different servers.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40045879" class="c"><input type="checkbox" id="c-40045879" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#40045403">parent</a><span>|</span><a href="#40047766">prev</a><span>|</span><a href="#40048881">next</a><span>|</span><label class="collapse" for="c-40045879">[-]</label><label class="expand" for="c-40045879">[1 more]</label></div><br/><div class="children"><div class="content">Sure, it happens by chance, but the attacker doesn&#x27;t know when it happens.</div><br/></div></div></div></div><div id="40048881" class="c"><input type="checkbox" id="c-40048881" checked=""/><div class="controls bullet"><span class="by">Helmut10001</span><span>|</span><a href="#40045403">prev</a><span>|</span><a href="#40044961">next</a><span>|</span><label class="collapse" for="c-40048881">[-]</label><label class="expand" for="c-40048881">[6 more]</label></div><br/><div class="children"><div class="content">Is there any way to check for how an SSH key was generated and with what type?<p><pre><code>    ssh-keygen -l -f &lt;file&gt;
</code></pre>
Can be used to show the key&#x27;s bit-size and fingerprint, but I am not sure whether I used Putty or ssh-keygen on Ubuntu&#x2F;Debian for some of my SSH keys.
Also, it would be nice if I would know the command to list key-types directly for keys unlocked in my ssh agent; not through a file (I use KeeAgent from KeyPass on Windows, linked through npiperelay into WSL1&#x2F;WSL2).</div><br/><div id="40048908" class="c"><input type="checkbox" id="c-40048908" checked=""/><div class="controls bullet"><span class="by">Symbiote</span><span>|</span><a href="#40048881">parent</a><span>|</span><a href="#40044961">next</a><span>|</span><label class="collapse" for="c-40048908">[-]</label><label class="expand" for="c-40048908">[5 more]</label></div><br/><div class="children"><div class="content">It says the key may have been lost if it had ever been <i>used</i> with Putty. If you have keys of this type and have ever used Putty you should revoke them.</div><br/><div id="40049032" class="c"><input type="checkbox" id="c-40049032" checked=""/><div class="controls bullet"><span class="by">Helmut10001</span><span>|</span><a href="#40048881">root</a><span>|</span><a href="#40048908">parent</a><span>|</span><a href="#40044961">next</a><span>|</span><label class="collapse" for="c-40049032">[-]</label><label class="expand" for="c-40049032">[4 more]</label></div><br/><div class="children"><div class="content">I use pageant as my SSH Agent and WSL to access it through ssh-agent. I only used to generate Keys with Putty, (Puttygen), but reverted to standard Linux `ssh-keygen` in the last 2-3 years.<p>I am still wondering what the exact steps are to show the key type.</div><br/><div id="40049318" class="c"><input type="checkbox" id="c-40049318" checked=""/><div class="controls bullet"><span class="by">Brybry</span><span>|</span><a href="#40048881">root</a><span>|</span><a href="#40049032">parent</a><span>|</span><a href="#40049292">next</a><span>|</span><label class="collapse" for="c-40049318">[-]</label><label class="expand" for="c-40049318">[1 more]</label></div><br/><div class="children"><div class="content">I believe <i>ssh-keygen -t ecdsa -b 521</i> pub keys will have <i>ecdsa-sha2-nistp521</i> in plaintext at the start. I don&#x27;t know how to tell from the priv key.<p>And I think converted key pairs in Putty format (.ppk) will have 
  PuTTY-User-Key-File-2: ecdsa-sha2-nistp521  
in plaintext.<p>For Pageant you should be able to select view keys from the system tray icon context menu and it should show the key type in the list.<p>For ssh-agent I think <i>ssh-add -L</i> should list the public keys (with key type) in the same format as the <i>authorized_keys</i> file<p>I&#x27;m not an expert, so if anyone is please correct me where I&#x27;m wrong!</div><br/></div></div><div id="40049292" class="c"><input type="checkbox" id="c-40049292" checked=""/><div class="controls bullet"><span class="by">ajb</span><span>|</span><a href="#40048881">root</a><span>|</span><a href="#40049032">parent</a><span>|</span><a href="#40049318">prev</a><span>|</span><a href="#40044961">next</a><span>|</span><label class="collapse" for="c-40049292">[-]</label><label class="expand" for="c-40049292">[2 more]</label></div><br/><div class="children"><div class="content">You can look in the key file. From the OP:<p>&quot;has an id starting ecdsa-sha2-nistp521 in [...] the key file&quot; 
He also mentions some other places the information shows up.</div><br/><div id="40049464" class="c"><input type="checkbox" id="c-40049464" checked=""/><div class="controls bullet"><span class="by">Helmut10001</span><span>|</span><a href="#40048881">root</a><span>|</span><a href="#40049292">parent</a><span>|</span><a href="#40044961">next</a><span>|</span><label class="collapse" for="c-40049464">[-]</label><label class="expand" for="c-40049464">[1 more]</label></div><br/><div class="children"><div class="content">Ah, yes - there it is (in KeePass&#x2F;KeeAgent, under `Advanced`, click on the private key file (*.ppk) and then on Open &gt; Internal Viewer).<p>&gt; PuTTY-User-Key-File-2: ssh-rsa..Encryption: aes256-cbc<p>Indeed I seem to have used Puttygen in the past.<p>For keys from Linux ssh-keygen, the private key starts with:<p>&gt; -----BEGIN OPENSSH PRIVATE KEY-----<p>and the public key starts with<p>&gt; ssh-ed25519</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40044961" class="c"><input type="checkbox" id="c-40044961" checked=""/><div class="controls bullet"><span class="by">axus</span><span>|</span><a href="#40048881">prev</a><span>|</span><a href="#40048145">next</a><span>|</span><label class="collapse" for="c-40044961">[-]</label><label class="expand" for="c-40044961">[1 more]</label></div><br/><div class="children"><div class="content">Good thing everyone uses the defaults and never picks that type of key!</div><br/></div></div><div id="40048145" class="c"><input type="checkbox" id="c-40048145" checked=""/><div class="controls bullet"><span class="by">e79</span><span>|</span><a href="#40044961">prev</a><span>|</span><a href="#40046381">next</a><span>|</span><label class="collapse" for="c-40048145">[-]</label><label class="expand" for="c-40048145">[4 more]</label></div><br/><div class="children"><div class="content">I did a bit of a deep dive into this, in case anyone is interested. I think reading the code is a great way to understand _why_ this vulnerability happened:<p><a href="https:&#x2F;&#x2F;ericrafaloff.com&#x2F;your-putty-generated-nist-p-521-keys-are-compromised&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ericrafaloff.com&#x2F;your-putty-generated-nist-p-521-key...</a></div><br/><div id="40048883" class="c"><input type="checkbox" id="c-40048883" checked=""/><div class="controls bullet"><span class="by">Elucalidavah</span><span>|</span><a href="#40048145">parent</a><span>|</span><a href="#40048976">next</a><span>|</span><label class="collapse" for="c-40048883">[-]</label><label class="expand" for="c-40048883">[1 more]</label></div><br/><div class="children"><div class="content">Your title says &quot;PuTTY-Generated&quot; but the OP article says &quot;The problem is not with how the key was originally generated; it doesn&#x27;t matter whether it came from PuTTYgen or somewhere else. What matters is whether it was ever used with PuTTY or Pageant&quot;.</div><br/></div></div><div id="40048976" class="c"><input type="checkbox" id="c-40048976" checked=""/><div class="controls bullet"><span class="by">Aachen</span><span>|</span><a href="#40048145">parent</a><span>|</span><a href="#40048883">prev</a><span>|</span><a href="#40048494">next</a><span>|</span><label class="collapse" for="c-40048976">[-]</label><label class="expand" for="c-40048976">[1 more]</label></div><br/><div class="children"><div class="content">The answer being, per that post: author was worried about low quality randomness on Windows and ran it through a sha512 hash function which outputs fewer than 521 bits so the remaining ones will be left zero</div><br/></div></div><div id="40048494" class="c"><input type="checkbox" id="c-40048494" checked=""/><div class="controls bullet"><span class="by">ki85squared</span><span>|</span><a href="#40048145">parent</a><span>|</span><a href="#40048976">prev</a><span>|</span><a href="#40046381">next</a><span>|</span><label class="collapse" for="c-40048494">[-]</label><label class="expand" for="c-40048494">[1 more]</label></div><br/><div class="children"><div class="content">Thank you. Your writeup helped make it click!</div><br/></div></div></div></div><div id="40046381" class="c"><input type="checkbox" id="c-40046381" checked=""/><div class="controls bullet"><span class="by">gorgoiler</span><span>|</span><a href="#40048145">prev</a><span>|</span><a href="#40044946">next</a><span>|</span><label class="collapse" for="c-40046381">[-]</label><label class="expand" for="c-40046381">[2 more]</label></div><br/><div class="children"><div class="content">A complete aside, but I just realised that putty is named after the old fashioned adhesive clay used to cement window panes into the frames of windows.<p>PuTTY… Windows… gosh I feel dumb.  I’ve used putty for almost <i>25 years</i> but didn’t put two and two together until I just remembered how the pheasants in my garden would peck out the window putty to get at the ladybirds hibernating underneath.</div><br/><div id="40049283" class="c"><input type="checkbox" id="c-40049283" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#40046381">parent</a><span>|</span><a href="#40044946">next</a><span>|</span><label class="collapse" for="c-40049283">[-]</label><label class="expand" for="c-40049283">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.chiark.greenend.org.uk&#x2F;~sgtatham&#x2F;putty&#x2F;faq.html#faq-meaning" rel="nofollow">https:&#x2F;&#x2F;www.chiark.greenend.org.uk&#x2F;~sgtatham&#x2F;putty&#x2F;faq.html#...</a><p>&gt; <i>What does ‘PuTTY’ mean?</i><p>&gt; <i>It&#x27;s the name of a popular SSH and Telnet client. Any other meaning is in the eye of the beholder. It&#x27;s been rumoured that ‘PuTTY’ is the antonym of ‘getty’, or that it&#x27;s the stuff that makes your Windows useful, or that it&#x27;s a kind of plutonium Teletype. We couldn&#x27;t possibly comment on such allegations.</i></div><br/></div></div></div></div><div id="40044946" class="c"><input type="checkbox" id="c-40044946" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40046381">prev</a><span>|</span><a href="#40046420">next</a><span>|</span><label class="collapse" for="c-40044946">[-]</label><label class="expand" for="c-40044946">[6 more]</label></div><br/><div class="children"><div class="content">I use P521 for all my server host keys. Do these need to be rotated after my users upgrade their PuTTY clients?</div><br/><div id="40044969" class="c"><input type="checkbox" id="c-40044969" checked=""/><div class="controls bullet"><span class="by">germinator</span><span>|</span><a href="#40044946">parent</a><span>|</span><a href="#40044994">next</a><span>|</span><label class="collapse" for="c-40044969">[-]</label><label class="expand" for="c-40044969">[1 more]</label></div><br/><div class="children"><div class="content">This exposed client keys, not server keys. The client keys are at risk only in a handful of specific scenarios - e.g., if used to connect to rogue or compromised servers, or used for signing outside SSH.<p>This is <i>not</i> exploitable by simply passively watching traffic, so even for client keys, if you&#x27;re certain that they were used in a constrained way, you should be fine. The difficulty is knowing that for sure, so it&#x27;s still prudent to rotate.</div><br/></div></div><div id="40044994" class="c"><input type="checkbox" id="c-40044994" checked=""/><div class="controls bullet"><span class="by">Skrillor</span><span>|</span><a href="#40044946">parent</a><span>|</span><a href="#40044969">prev</a><span>|</span><a href="#40044968">next</a><span>|</span><label class="collapse" for="c-40044994">[-]</label><label class="expand" for="c-40044994">[1 more]</label></div><br/><div class="children"><div class="content">No, only NIST P-521 client keys used with PuTTY are affected. The server host key signature is computed by the server (most likely OpenSSH) which is unaffected.</div><br/></div></div><div id="40044968" class="c"><input type="checkbox" id="c-40044968" checked=""/><div class="controls bullet"><span class="by">strbean</span><span>|</span><a href="#40044946">parent</a><span>|</span><a href="#40044994">prev</a><span>|</span><a href="#40045071">next</a><span>|</span><label class="collapse" for="c-40044968">[-]</label><label class="expand" for="c-40044968">[2 more]</label></div><br/><div class="children"><div class="content">&gt; (The problem is not with how the key was originally generated; it doesn&#x27;t matter whether it came from PuTTYgen or somewhere else. What matters is whether it was ever used with PuTTY or Pageant.)<p>Sounds like your server keys are safe.</div><br/><div id="40048134" class="c"><input type="checkbox" id="c-40048134" checked=""/><div class="controls bullet"><span class="by">cchance</span><span>|</span><a href="#40044946">root</a><span>|</span><a href="#40044968">parent</a><span>|</span><a href="#40045071">next</a><span>|</span><label class="collapse" for="c-40048134">[-]</label><label class="expand" for="c-40048134">[1 more]</label></div><br/><div class="children"><div class="content">I mean it also sounds like you&#x27;d need to be using a exploited server, or give the hacker access to your pageant...</div><br/></div></div></div></div></div></div><div id="40046420" class="c"><input type="checkbox" id="c-40046420" checked=""/><div class="controls bullet"><span class="by">Kikawala</span><span>|</span><a href="#40044946">prev</a><span>|</span><a href="#40048579">next</a><span>|</span><label class="collapse" for="c-40046420">[-]</label><label class="expand" for="c-40046420">[4 more]</label></div><br/><div class="children"><div class="content">If you haven&#x27;t already, this is probably a good time to switch to EdDSA keys. EdDSA signatures don&#x27;t require RNG nor modular math unlike ECSDA signatures.</div><br/><div id="40046491" class="c"><input type="checkbox" id="c-40046491" checked=""/><div class="controls bullet"><span class="by">kwantam</span><span>|</span><a href="#40046420">parent</a><span>|</span><a href="#40046454">next</a><span>|</span><label class="collapse" for="c-40046491">[-]</label><label class="expand" for="c-40046491">[1 more]</label></div><br/><div class="children"><div class="content">EdDSA signatures are specified to use deterministic nonce generation, so you&#x27;re correct that they do not require randomness. But they certainly do require modular arithmetic in order to implement the elliptic curve operations!</div><br/></div></div><div id="40046454" class="c"><input type="checkbox" id="c-40046454" checked=""/><div class="controls bullet"><span class="by">eyegor</span><span>|</span><a href="#40046420">parent</a><span>|</span><a href="#40046491">prev</a><span>|</span><a href="#40048579">next</a><span>|</span><label class="collapse" for="c-40046454">[-]</label><label class="expand" for="c-40046454">[2 more]</label></div><br/><div class="children"><div class="content">Despite being fairly old, many systems still don&#x27;t support eddsa. As an example, the reference browser&#x2F;ca spec doesn&#x27;t allow it: <a href="https:&#x2F;&#x2F;cabforum.org&#x2F;working-groups&#x2F;server&#x2F;baseline-requirements&#x2F;documents&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cabforum.org&#x2F;working-groups&#x2F;server&#x2F;baseline-requirem...</a>. Last I tried, even let&#x27;s encrypt won&#x27;t grant an ed25519 cert despite it being in tls 1.3 (2018?).</div><br/><div id="40046548" class="c"><input type="checkbox" id="c-40046548" checked=""/><div class="controls bullet"><span class="by">throw0101c</span><span>|</span><a href="#40046420">root</a><span>|</span><a href="#40046454">parent</a><span>|</span><a href="#40048579">next</a><span>|</span><label class="collapse" for="c-40046548">[-]</label><label class="expand" for="c-40046548">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Last I tried, even let&#x27;s encrypt won&#x27;t grant an ed25519 cert despite it being in tls 1.3 (2018?).</i><p>Talk to the CA&#x2F;Browser Forum. §6.1.5 Keys Sizes:<p>&gt; <i>For RSA key pairs the CA SHALL:</i><p>&gt; <i>* Ensure that the modulus size, when encoded, is at least 2048 bits, and;</i><p>&gt; <i>* Ensure that the modulus size, in bits, is evenly divisible by 8.</i><p>&gt; <i>For ECDSA key pairs, the CA SHALL:</i><p>&gt; <i>* Ensure that the key represents a valid point on the NIST P-256, NIST P-384 or NIST P-521 elliptic curve.</i><p>&gt; <i>No other algorithms or key sizes are permitted.</i><p>* <a href="https:&#x2F;&#x2F;cabforum.org&#x2F;uploads&#x2F;CA-Browser-Forum-TLS-BRs-v2.0.2.pdf" rel="nofollow">https:&#x2F;&#x2F;cabforum.org&#x2F;uploads&#x2F;CA-Browser-Forum-TLS-BRs-v2.0.2...</a><p>* <a href="https:&#x2F;&#x2F;cabforum.org&#x2F;working-groups&#x2F;server&#x2F;baseline-requirements&#x2F;documents&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cabforum.org&#x2F;working-groups&#x2F;server&#x2F;baseline-requirem...</a><p>Ed25519 (and Ed448) was only &#x27;recently&#x27; approved by NIST FIPS 186-5 in February 2023.</div><br/></div></div></div></div></div></div><div id="40048579" class="c"><input type="checkbox" id="c-40048579" checked=""/><div class="controls bullet"><span class="by">cyberpunk</span><span>|</span><a href="#40046420">prev</a><span>|</span><a href="#40047328">next</a><span>|</span><label class="collapse" for="c-40048579">[-]</label><label class="expand" for="c-40048579">[3 more]</label></div><br/><div class="children"><div class="content">One time putty took down our prod rac cluster on Xmas eve, and I spent three days fixing it..<p>One of the on call engineers had copied some documentation to his clipboard which had like:<p>Dbfile 1 location &gt; &#x2F;u01&#x2F;ora&#x2F;whatever<p>And accidentally right clicked…<p>I absolutely blame that software for ruining my Christmas one year, and I can’t really forgive it.<p>Please use OpenSSH.</div><br/><div id="40049035" class="c"><input type="checkbox" id="c-40049035" checked=""/><div class="controls bullet"><span class="by">lmz</span><span>|</span><a href="#40048579">parent</a><span>|</span><a href="#40049028">next</a><span>|</span><label class="collapse" for="c-40049035">[-]</label><label class="expand" for="c-40049035">[1 more]</label></div><br/><div class="children"><div class="content">You say that like an accidental middle click from e.g. xterm would be any better.</div><br/></div></div><div id="40049028" class="c"><input type="checkbox" id="c-40049028" checked=""/><div class="controls bullet"><span class="by">chgs</span><span>|</span><a href="#40048579">parent</a><span>|</span><a href="#40049035">prev</a><span>|</span><a href="#40047328">next</a><span>|</span><label class="collapse" for="c-40049028">[-]</label><label class="expand" for="c-40049028">[1 more]</label></div><br/><div class="children"><div class="content">Because pasting in OpenSSH doesn’t work?</div><br/></div></div></div></div><div id="40047328" class="c"><input type="checkbox" id="c-40047328" checked=""/><div class="controls bullet"><span class="by">bdd8f1df777b</span><span>|</span><a href="#40048579">prev</a><span>|</span><a href="#40047880">next</a><span>|</span><label class="collapse" for="c-40047328">[-]</label><label class="expand" for="c-40047328">[5 more]</label></div><br/><div class="children"><div class="content">I knew requiring public key authentication *followed by* password authentication on my SSH server was not paranoid!</div><br/><div id="40047710" class="c"><input type="checkbox" id="c-40047710" checked=""/><div class="controls bullet"><span class="by">f3d46600-b66e</span><span>|</span><a href="#40047328">parent</a><span>|</span><a href="#40047462">next</a><span>|</span><label class="collapse" for="c-40047710">[-]</label><label class="expand" for="c-40047710">[2 more]</label></div><br/><div class="children"><div class="content">I suspect it won&#x27;t help. If your key is compromised, the previous sessions are compromised as well. I.e. the attacker now knows the password.</div><br/><div id="40047958" class="c"><input type="checkbox" id="c-40047958" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#40047328">root</a><span>|</span><a href="#40047710">parent</a><span>|</span><a href="#40047462">next</a><span>|</span><label class="collapse" for="c-40047958">[-]</label><label class="expand" for="c-40047958">[1 more]</label></div><br/><div class="children"><div class="content">There is no indication or mention that key exchange was compromised. SSH has forward secrecy, so compromising the authentication keys does not compromise the encryption keys.</div><br/></div></div></div></div><div id="40047462" class="c"><input type="checkbox" id="c-40047462" checked=""/><div class="controls bullet"><span class="by">pcdoodle</span><span>|</span><a href="#40047328">parent</a><span>|</span><a href="#40047710">prev</a><span>|</span><a href="#40047880">next</a><span>|</span><label class="collapse" for="c-40047462">[-]</label><label class="expand" for="c-40047462">[2 more]</label></div><br/><div class="children"><div class="content">Are people using password only at risk?</div><br/><div id="40047667" class="c"><input type="checkbox" id="c-40047667" checked=""/><div class="controls bullet"><span class="by">bdd8f1df777b</span><span>|</span><a href="#40047328">root</a><span>|</span><a href="#40047462">parent</a><span>|</span><a href="#40047880">next</a><span>|</span><label class="collapse" for="c-40047667">[-]</label><label class="expand" for="c-40047667">[1 more]</label></div><br/><div class="children"><div class="content">Not at this risk, but possibly others. Requiring both is always better.</div><br/></div></div></div></div></div></div><div id="40047880" class="c"><input type="checkbox" id="c-40047880" checked=""/><div class="controls bullet"><span class="by">EVa5I7bHFq9mnYK</span><span>|</span><a href="#40047328">prev</a><span>|</span><a href="#40048916">next</a><span>|</span><label class="collapse" for="c-40047880">[-]</label><label class="expand" for="c-40047880">[3 more]</label></div><br/><div class="children"><div class="content">I have keys that start with ssh-ed25519, made by puttygen. Are those safe?</div><br/><div id="40048060" class="c"><input type="checkbox" id="c-40048060" checked=""/><div class="controls bullet"><span class="by">pigbearpig</span><span>|</span><a href="#40047880">parent</a><span>|</span><a href="#40048916">next</a><span>|</span><label class="collapse" for="c-40048060">[-]</label><label class="expand" for="c-40048060">[2 more]</label></div><br/><div class="children"><div class="content">The answer is in the link. Sixth paragraph, right above the horizontal rule. Couldn&#x27;t be clearer.</div><br/><div id="40049517" class="c"><input type="checkbox" id="c-40049517" checked=""/><div class="controls bullet"><span class="by">beng-nl</span><span>|</span><a href="#40047880">root</a><span>|</span><a href="#40048060">parent</a><span>|</span><a href="#40048916">next</a><span>|</span><label class="collapse" for="c-40049517">[-]</label><label class="expand" for="c-40049517">[1 more]</label></div><br/><div class="children"><div class="content">To those wondering:<p><pre><code>  (Incidentally, none of this affects Ed25519. The spec for that system includes its own idea of how you should do deterministic nonce generation - completely different again, naturally - and we did it that way rather than our way, so that we could use the existing test vectors.)</code></pre></div><br/></div></div></div></div></div></div><div id="40048916" class="c"><input type="checkbox" id="c-40048916" checked=""/><div class="controls bullet"><span class="by">britmap</span><span>|</span><a href="#40047880">prev</a><span>|</span><a href="#40045233">next</a><span>|</span><label class="collapse" for="c-40048916">[-]</label><label class="expand" for="c-40048916">[1 more]</label></div><br/><div class="children"><div class="content">CVE-2024-31497</div><br/></div></div><div id="40045233" class="c"><input type="checkbox" id="c-40045233" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#40048916">prev</a><span>|</span><a href="#40045167">next</a><span>|</span><label class="collapse" for="c-40045233">[-]</label><label class="expand" for="c-40045233">[26 more]</label></div><br/><div class="children"><div class="content">edit: ignore below, I misinterpreted what q meant in this context and thought it was the private key.<p>&gt;The clever trick is to compute a secure hash whose input includes the message to be signed and also the private key [...]<p>&gt; PuTTY&#x27;s technique worked by making a SHA-512 hash, and then reducing it mod q, where q is the order of the group used in the DSA system. For integer DSA (for which PuTTY&#x27;s technique was originally developed), q is about 160 bits; for elliptic-curve DSA (which came later) it has about the same number of bits as the curve modulus, so 256 or 384 or 521 bits for the NIST curves.<p>I know hindsight is 20&#x2F;20, but why did PuTTY implement it this way to begin with? Given the description in the first paragraph, I&#x27;d naively implemented it as<p><pre><code>    SHA-512(message || private_key)[:number_of_bits_required]
</code></pre>
or if I was being paranoid I would have done<p><pre><code>    SHA-512(SHA-512(message) || SHA-512(private_key))[:number_of_bits_required]
</code></pre>
Moduloing it by q makes no sense unless you&#x27;re trying to save a few cycles.</div><br/><div id="40045461" class="c"><input type="checkbox" id="c-40045461" checked=""/><div class="controls bullet"><span class="by">smarx007</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045273">next</a><span>|</span><label class="collapse" for="c-40045461">[-]</label><label class="expand" for="c-40045461">[1 more]</label></div><br/><div class="children"><div class="content">SHA-512(...)[:521] would still produce the same vulnerability, there would be 9 unchanging bits (assuming the [:521] would pad the 512 bits to 521). Those 9 guessable bits are enough to recover the key from 60 signatures, as the post explained in detail.<p>A more interesting question (while we are on the 20&#x2F;20 hindsight express) is why the dsa_gen_k() function did not include an assert(digest_len &lt;= 512).</div><br/></div></div><div id="40045273" class="c"><input type="checkbox" id="c-40045273" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045461">prev</a><span>|</span><a href="#40045322">next</a><span>|</span><label class="collapse" for="c-40045273">[-]</label><label class="expand" for="c-40045273">[4 more]</label></div><br/><div class="children"><div class="content">It appears that some of this was designed in the late 90s&#x2F;early aughts, when Windows didn&#x27;t have a cryptographically-secure random number generator.<p>PuTTY carries its own formats from this time.</div><br/><div id="40045371" class="c"><input type="checkbox" id="c-40045371" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045273">parent</a><span>|</span><a href="#40045322">next</a><span>|</span><label class="collapse" for="c-40045371">[-]</label><label class="expand" for="c-40045371">[3 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need a CSPRNG to do SHA512, which their solution already incorporates.</div><br/><div id="40045451" class="c"><input type="checkbox" id="c-40045451" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045371">parent</a><span>|</span><a href="#40045322">next</a><span>|</span><label class="collapse" for="c-40045451">[-]</label><label class="expand" for="c-40045451">[2 more]</label></div><br/><div class="children"><div class="content">This is the text from the original article.<p>&quot;For this reason, since PuTTY was developed on Windows before it had any cryptographic random number generator at all, PuTTY has always generated its k using a deterministic method, avoiding the need for random numbers at all.&quot;</div><br/><div id="40045477" class="c"><input type="checkbox" id="c-40045477" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045451">parent</a><span>|</span><a href="#40045322">next</a><span>|</span><label class="collapse" for="c-40045477">[-]</label><label class="expand" for="c-40045477">[1 more]</label></div><br/><div class="children"><div class="content">Both my proposed naive method and the PuTTY implementation are deterministic. The only difference is how the primitives (eg. SHA-512) are combined.</div><br/></div></div></div></div></div></div></div></div><div id="40045322" class="c"><input type="checkbox" id="c-40045322" checked=""/><div class="controls bullet"><span class="by">yorwba</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045273">prev</a><span>|</span><a href="#40045407">next</a><span>|</span><label class="collapse" for="c-40045322">[-]</label><label class="expand" for="c-40045322">[3 more]</label></div><br/><div class="children"><div class="content">The problem is that 521 &gt; 512, not that they used modulo. To get a sufficiently large nonce out of the hash, you need to think in terms of expanding the number of bits, not reducing it.</div><br/><div id="40045456" class="c"><input type="checkbox" id="c-40045456" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045322">parent</a><span>|</span><a href="#40045399">next</a><span>|</span><label class="collapse" for="c-40045456">[-]</label><label class="expand" for="c-40045456">[1 more]</label></div><br/><div class="children"><div class="content">Ah okay, after re-reading the message it looks like using the SHA-512 result directly (without modulo) would still have the issue. I originally thought the problem was moduloing by the key, which was approximately 521 bits<p>&gt; In all of those cases except P521, the bias introduced by reducing a 512-bit number mod q is negligible. But in the case of P521, where q has 521 bits (i.e. more than 512), reducing a 512-bit number mod q has no effect at all – you get a value of k whose top 9 bits are always zero.</div><br/></div></div></div></div><div id="40045407" class="c"><input type="checkbox" id="c-40045407" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045322">prev</a><span>|</span><a href="#40045475">next</a><span>|</span><label class="collapse" for="c-40045407">[-]</label><label class="expand" for="c-40045407">[5 more]</label></div><br/><div class="children"><div class="content">Presumably because 512 of bits (a) seemed &quot;random enough&quot; and (b) was the nicest block size that fit comfortably in 521 bits of modulus. This is a common mistake.</div><br/><div id="40046072" class="c"><input type="checkbox" id="c-40046072" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045407">parent</a><span>|</span><a href="#40045475">next</a><span>|</span><label class="collapse" for="c-40046072">[-]</label><label class="expand" for="c-40046072">[4 more]</label></div><br/><div class="children"><div class="content">From TFA it seems more like they already had the SHA512-based implementation for DSA (where it was fine), and reused it when implementing ECDSA without realizing that it wasn&#x27;t suitable in situations with moduli larger than 512 bits.</div><br/><div id="40046096" class="c"><input type="checkbox" id="c-40046096" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046072">parent</a><span>|</span><a href="#40045475">next</a><span>|</span><label class="collapse" for="c-40046096">[-]</label><label class="expand" for="c-40046096">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;d have to look at the code, but a DSA modulus is much larger than a P-521 modulus. Maybe it just happened to line up nicely?</div><br/><div id="40046359" class="c"><input type="checkbox" id="c-40046359" checked=""/><div class="controls bullet"><span class="by">kwantam</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046096">parent</a><span>|</span><a href="#40045475">next</a><span>|</span><label class="collapse" for="c-40046359">[-]</label><label class="expand" for="c-40046359">[2 more]</label></div><br/><div class="children"><div class="content">The nonce is taken modulo the order of the prime-order subgroup. For DSA that&#x27;s generally a 256ish-bit prime (e.g.: choose a 1024-bit prime p such that a 256-bit prime q divides p-1; then there exists an order-q subgroup of Zp).<p>For P-521, the base field is 2^521 - 1, but the modulus used when computing the nonce is not that value, it&#x27;s the <i>order</i> of the P-521 curve. By Hasse&#x27;s theorem, that&#x27;s roughly p +- sqrt(p), which is essentially p for such large numbers (the cofactor of P-521 is 1, so the order of the group is prime).<p>So: both are 521-bit numbers, but the group order is less than 2^521-1. Its hex representation is 0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409.</div><br/><div id="40046542" class="c"><input type="checkbox" id="c-40046542" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046359">parent</a><span>|</span><a href="#40045475">next</a><span>|</span><label class="collapse" for="c-40046542">[-]</label><label class="expand" for="c-40046542">[1 more]</label></div><br/><div class="children"><div class="content">Ahh. Thanks! (I don&#x27;t think about FFDLP much, as you can see).</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40045475" class="c"><input type="checkbox" id="c-40045475" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045407">prev</a><span>|</span><a href="#40046131">next</a><span>|</span><label class="collapse" for="c-40045475">[-]</label><label class="expand" for="c-40045475">[11 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t modulo the same as truncation when dealing with powers of two?</div><br/><div id="40045809" class="c"><input type="checkbox" id="c-40045809" checked=""/><div class="controls bullet"><span class="by">lambdafu</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045475">parent</a><span>|</span><a href="#40045541">next</a><span>|</span><label class="collapse" for="c-40045809">[-]</label><label class="expand" for="c-40045809">[9 more]</label></div><br/><div class="children"><div class="content">Caution here. If your modulus is too close to the maximum truncated value, there can be a bias in the upper bits, too. For example, if you reduce a number between 0 and 15 by the modulus 13, the values 0, 1 and 2 will be twice as likely as the values 3-12. This means that the highest bit will be 0 in 11 out of 16 cases. Even such a small bias might be exploitable (for example, sub 1 bit bias up to 160-bit ECDSA here: Gao, Wang, Hu, He <a href="https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2024&#x2F;296.pdf" rel="nofollow">https:&#x2F;&#x2F;eprint.iacr.org&#x2F;2024&#x2F;296.pdf</a>)</div><br/><div id="40045964" class="c"><input type="checkbox" id="c-40045964" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045809">parent</a><span>|</span><a href="#40045541">next</a><span>|</span><label class="collapse" for="c-40045964">[-]</label><label class="expand" for="c-40045964">[8 more]</label></div><br/><div class="children"><div class="content">Neither 15 nor 13 are powers of two.</div><br/><div id="40046232" class="c"><input type="checkbox" id="c-40046232" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045964">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046232">[-]</label><label class="expand" for="c-40046232">[6 more]</label></div><br/><div class="children"><div class="content">The interval [0, 15] represent 16 possible values, which is a power of 2.<p>The correct way to get an unbiased distribution from a sample of 2^x to a modulo that is not an even power of 2 is to use rejection sampling.<p>This is what RFC 6979 says to do <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc6979#section-3.2" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc6979#section-3.2</a><p>But you can also see this technique in CSPRNG code; i.e. <a href="https:&#x2F;&#x2F;github.com&#x2F;php&#x2F;php-src&#x2F;blob&#x2F;d40726670fd2915dcd8076738c56596e7c877b58&#x2F;ext&#x2F;random&#x2F;csprng.c#L243-L248">https:&#x2F;&#x2F;github.com&#x2F;php&#x2F;php-src&#x2F;blob&#x2F;d40726670fd2915dcd807673...</a></div><br/><div id="40046281" class="c"><input type="checkbox" id="c-40046281" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046232">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046281">[-]</label><label class="expand" for="c-40046281">[5 more]</label></div><br/><div class="children"><div class="content">I missed it was [0,15]<p>This doesn&#x27;t make 13 a power of two.  I&#x27;m aware of rejection sampling; my point was if you have a N bit value X and want M bits, truncating X to M bits and X MOD 2*M is the same.  Neither solve the problem where M &gt; N, which is what TFA is about.</div><br/><div id="40046316" class="c"><input type="checkbox" id="c-40046316" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046281">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046316">[-]</label><label class="expand" for="c-40046316">[4 more]</label></div><br/><div class="children"><div class="content">&gt; This doesn&#x27;t make 13 a power of two.<p>Where did I imply that it is?<p>&gt; I&#x27;m aware of rejection sampling; my point was if you have a N bit value X and want M bits, truncating X to M bits and X MOD 2*M is the same.<p>Sure.<p>&gt; Neither solve the problem where M &gt; N, which is what TFA is about.<p>If you observe my other comments, you&#x27;ll see I&#x27;m well aware of what the article is about.</div><br/><div id="40046391" class="c"><input type="checkbox" id="c-40046391" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046316">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046391">[-]</label><label class="expand" for="c-40046391">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Where did I imply that it is?<p>You used 13 as an example in a response to my comment that was:<p><i>Isn&#x27;t modulo the same as truncation when dealing with powers of two?</i></div><br/><div id="40046623" class="c"><input type="checkbox" id="c-40046623" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046391">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046623">[-]</label><label class="expand" for="c-40046623">[2 more]</label></div><br/><div class="children"><div class="content">&gt; You used 13 as an example<p>I don&#x27;t see the number 13 in any of my comments on this thread (except this one, or where I quoted you). Perhaps you are confusing me with someone else?</div><br/><div id="40046836" class="c"><input type="checkbox" id="c-40046836" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40046623">parent</a><span>|</span><a href="#40046195">next</a><span>|</span><label class="collapse" for="c-40046836">[-]</label><label class="expand" for="c-40046836">[1 more]</label></div><br/><div class="children"><div class="content">Ah yes, that was lambdafu</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40046195" class="c"><input type="checkbox" id="c-40046195" checked=""/><div class="controls bullet"><span class="by">wbl</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045964">parent</a><span>|</span><a href="#40046232">prev</a><span>|</span><a href="#40045541">next</a><span>|</span><label class="collapse" for="c-40046195">[-]</label><label class="expand" for="c-40046195">[1 more]</label></div><br/><div class="children"><div class="content">But 16 is.</div><br/></div></div></div></div></div></div><div id="40045541" class="c"><input type="checkbox" id="c-40045541" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#40045233">root</a><span>|</span><a href="#40045475">parent</a><span>|</span><a href="#40045809">prev</a><span>|</span><a href="#40046131">next</a><span>|</span><label class="collapse" for="c-40045541">[-]</label><label class="expand" for="c-40045541">[1 more]</label></div><br/><div class="children"><div class="content">Good point. I misread the OP and thought q was the key, but really it just corresponded to the key length (eg. 521 for p521)</div><br/></div></div></div></div><div id="40046131" class="c"><input type="checkbox" id="c-40046131" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40045233">parent</a><span>|</span><a href="#40045475">prev</a><span>|</span><a href="#40045167">next</a><span>|</span><label class="collapse" for="c-40046131">[-]</label><label class="expand" for="c-40046131">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;d want something like this:<p><pre><code>  Truncate(
    SHA-512(0x01 || message || private_key)
      || SHA-512(0x02 || message || private_key),
    bitsNeeded
  )
</code></pre>
Two separate hashes, with domain separation, that produce an output of at least n+64 bits (if it is to be reduced mod 2^n - k, for some small integer k). In this case, 1024 bits reduced mod 2^521-1 is safe.<p>Even better, though, is to just use RFC 6979 and not implement it yourself.</div><br/></div></div></div></div><div id="40045082" class="c"><input type="checkbox" id="c-40045082" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#40044947">prev</a><span>|</span><a href="#40047114">next</a><span>|</span><label class="collapse" for="c-40045082">[-]</label><label class="expand" for="c-40045082">[3 more]</label></div><br/><div class="children"><div class="content">ECDSA strikes again. Bad nonce generation (here: generating a 521 bit nonce by calculating a 512 bit number and then taking that modulo 2^521, which means the top bits of the nonce are always zero) leading to private key compromise. Classic.</div><br/><div id="40045141" class="c"><input type="checkbox" id="c-40045141" checked=""/><div class="controls bullet"><span class="by">JamesCoyne</span><span>|</span><a href="#40045082">parent</a><span>|</span><a href="#40045687">next</a><span>|</span><label class="collapse" for="c-40045141">[-]</label><label class="expand" for="c-40045141">[1 more]</label></div><br/><div class="children"><div class="content">Details in the excellent commit message <a href="https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c193fe9848f50a88a4089aac647fecc31ae96d27" rel="nofollow">https:&#x2F;&#x2F;git.tartarus.org&#x2F;?p=simon&#x2F;putty.git;a=commitdiff;h=c...</a></div><br/></div></div><div id="40045687" class="c"><input type="checkbox" id="c-40045687" checked=""/><div class="controls bullet"><span class="by">rainsford</span><span>|</span><a href="#40045082">parent</a><span>|</span><a href="#40045141">prev</a><span>|</span><a href="#40047114">next</a><span>|</span><label class="collapse" for="c-40045687">[-]</label><label class="expand" for="c-40045687">[1 more]</label></div><br/><div class="children"><div class="content">Yes, although this is the rare ECDSA private key recovery issue where deterministic nonce generation was the cause of rather than the solution to the problem.</div><br/></div></div></div></div><div id="40045239" class="c"><input type="checkbox" id="c-40045239" checked=""/><div class="controls bullet"><span class="by">AtNightWeCode</span><span>|</span><a href="#40045176">prev</a><span>|</span><a href="#40045753">next</a><span>|</span><label class="collapse" for="c-40045239">[-]</label><label class="expand" for="c-40045239">[2 more]</label></div><br/><div class="children"><div class="content">We recommend against ECDSA for internal accounts. I know several of our partners use it though. Hard to not be cynical about this even though this issue seems mostly harmless.</div><br/><div id="40046505" class="c"><input type="checkbox" id="c-40046505" checked=""/><div class="controls bullet"><span class="by">AtNightWeCode</span><span>|</span><a href="#40045239">parent</a><span>|</span><a href="#40045753">next</a><span>|</span><label class="collapse" for="c-40046505">[-]</label><label class="expand" for="c-40046505">[1 more]</label></div><br/><div class="children"><div class="content">NSA disagrees...</div><br/></div></div></div></div><div id="40045753" class="c"><input type="checkbox" id="c-40045753" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40045239">prev</a><span>|</span><a href="#40045231">next</a><span>|</span><label class="collapse" for="c-40045753">[-]</label><label class="expand" for="c-40045753">[7 more]</label></div><br/><div class="children"><div class="content">Cool, I never use keys generated by putty, so I&#x27;m good. I only use keys generated by and stored on hardware tokens like yubikeys and openpgp smartcards.<p>Edit: To clarify further, the key in that case is not even handled by putty. All crypto ops are done on the token and the private key never leaves it. It can&#x27;t be exported even because that defeats the purpose of using a hardware token. So putty will just tell the token or smartcard what to sign and the token returns the output.<p>That&#x27;s why it&#x27;s safe against this attack. Putty never handles the private key material in this scenario. So I never imported the private key in putty or pageant and I couldn&#x27;t even if I wanted to. The agent just declares the public keys on the token.<p>I see all the downvotes but I didn&#x27;t explain it properly. I&#x27;ve been using smart cards so long that these things are kinda a given for me.<p>I can really recommend doing it this way or doing the more modern fido2 auth. Hardware authentication is amazing and it even works on Android over nfc these days.<p>The biggest vulnerability I see is the issue of malware connecting to the unlocked token via the SSH agent, but I&#x27;m only using tokens that have touch to sign for this reason. They require a touch on the token for every operation.</div><br/><div id="40045818" class="c"><input type="checkbox" id="c-40045818" checked=""/><div class="controls bullet"><span class="by">Bootvis</span><span>|</span><a href="#40045753">parent</a><span>|</span><a href="#40045854">next</a><span>|</span><label class="collapse" for="c-40045818">[-]</label><label class="expand" for="c-40045818">[3 more]</label></div><br/><div class="children"><div class="content">From the article:<p>&gt; (The problem is not with how the key was originally generated; it doesn&#x27;t matter whether it came from PuTTYgen or somewhere else. What matters is whether it was ever used with PuTTY or Pageant.)</div><br/><div id="40046197" class="c"><input type="checkbox" id="c-40046197" checked=""/><div class="controls bullet"><span class="by">garaetjjte</span><span>|</span><a href="#40045753">root</a><span>|</span><a href="#40045818">parent</a><span>|</span><a href="#40045854">next</a><span>|</span><label class="collapse" for="c-40046197">[-]</label><label class="expand" for="c-40046197">[2 more]</label></div><br/><div class="children"><div class="content">Smartcards do signing operations on the card itself, so it doesn&#x27;t apply in this case.</div><br/><div id="40046740" class="c"><input type="checkbox" id="c-40046740" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40045753">root</a><span>|</span><a href="#40046197">parent</a><span>|</span><a href="#40045854">next</a><span>|</span><label class="collapse" for="c-40046740">[-]</label><label class="expand" for="c-40046740">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for pointing this out. I know this but I didn&#x27;t clarify it in my post.</div><br/></div></div></div></div></div></div><div id="40045854" class="c"><input type="checkbox" id="c-40045854" checked=""/><div class="controls bullet"><span class="by">ZekeSulastin</span><span>|</span><a href="#40045753">parent</a><span>|</span><a href="#40045818">prev</a><span>|</span><a href="#40045861">next</a><span>|</span><label class="collapse" for="c-40045854">[-]</label><label class="expand" for="c-40045854">[2 more]</label></div><br/><div class="children"><div class="content">Edit: beat to it, whoops! Never underestimate the Internet’s drive to post easy corrections &gt;.&gt;<p>——<p>Unfortunately, about that:<p>“(The problem is not with how the key was originally generated; it doesn&#x27;t matter whether it came from PuTTYgen or somewhere else. What matters is whether it was ever <i>used</i> with PuTTY or Pageant.)”</div><br/><div id="40046684" class="c"><input type="checkbox" id="c-40046684" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40045753">root</a><span>|</span><a href="#40045854">parent</a><span>|</span><a href="#40045861">next</a><span>|</span><label class="collapse" for="c-40046684">[-]</label><label class="expand" for="c-40046684">[1 more]</label></div><br/><div class="children"><div class="content">Yes but the key is not handled by putty. It never leaves the token, the token carries out all crypto ops on the key itself. I&#x27;ve updated my comment to clarify.</div><br/></div></div></div></div></div></div><div id="40045231" class="c"><input type="checkbox" id="c-40045231" checked=""/><div class="controls bullet"><span class="by">kelsey98765431</span><span>|</span><a href="#40045753">prev</a><span>|</span><label class="collapse" for="c-40045231">[-]</label><label class="expand" for="c-40045231">[4 more]</label></div><br/><div class="children"><div class="content">Friendly reminder you can entirely disable elliptic curve algorithms in your sshd_config and generate rsa keys larger than 4096 bits, 8192 or however large you like work just fine.<p>I have never trusted EC crypto because of all the magic involved with it, a sufficient reason to move from RSA has never been presented with compelling evidence as far as I am concerned. I do not care that it is faster, i prefer slow and secure to fast and complicated. It&#x27;s a lot easier to explain RSA and why it&#x27;s secure than the mile long justifications on curve crypto. The issue doesn&#x27;t need to be in the algorithm, if the implementation is sufficiently difficult that works just as well as an intentionally misdesigned algorithm.</div><br/><div id="40047973" class="c"><input type="checkbox" id="c-40047973" checked=""/><div class="controls bullet"><span class="by">kbolino</span><span>|</span><a href="#40045231">parent</a><span>|</span><a href="#40045850">next</a><span>|</span><label class="collapse" for="c-40047973">[-]</label><label class="expand" for="c-40047973">[1 more]</label></div><br/><div class="children"><div class="content">The benefit of EC is not speed, it is <i>much</i> smaller key sizes.<p>Roughly speaking, an RSA key has to be 8 times as large as an EC key for the same security level.</div><br/></div></div><div id="40045850" class="c"><input type="checkbox" id="c-40045850" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40045231">parent</a><span>|</span><a href="#40047973">prev</a><span>|</span><label class="collapse" for="c-40045850">[-]</label><label class="expand" for="c-40045850">[2 more]</label></div><br/><div class="children"><div class="content">Yeah I never bought into the EC thing much either.<p>It&#x27;s supposed to be safer against quantum but it&#x27;s also a lot less proven.</div><br/><div id="40045976" class="c"><input type="checkbox" id="c-40045976" checked=""/><div class="controls bullet"><span class="by">lambdafu</span><span>|</span><a href="#40045231">root</a><span>|</span><a href="#40045850">parent</a><span>|</span><label class="collapse" for="c-40045976">[-]</label><label class="expand" for="c-40045976">[1 more]</label></div><br/><div class="children"><div class="content">Actually, with currently common key sizes, ECC up to 384 bits will fall to QC before RSA with 1024 bits, because fewer bits means fewer qubits needed.<p>The main disadvantage of RSA is the structure of finite fields, which allows specialized solutions to factoring (number field sieve). We do not know similar structures for elliptic curves, so for those we only have general attacks, thus allowing shorter key lengths.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>