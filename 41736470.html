<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728032476197" as="style"/><link rel="stylesheet" href="styles.css?v=1728032476197"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.aquasec.com/blog/perfctl-a-stealthy-malware-targeting-millions-of-linux-servers/">Perfctl: A Stealthy Malware Targeting Linux Servers</a> <span class="domain">(<a href="https://www.aquasec.com">www.aquasec.com</a>)</span></div><div class="subtext"><span>johnfernow</span> | <span>11 comments</span></div><br/><div><div id="41738666" class="c"><input type="checkbox" id="c-41738666" checked=""/><div class="controls bullet"><span class="by">PhilipRoman</span><span>|</span><a href="#41736471">next</a><span>|</span><label class="collapse" for="c-41738666">[-]</label><label class="expand" for="c-41738666">[2 more]</label></div><br/><div class="children"><div class="content">A lot of focus on the malware itself, but not so much on the misconfigurations and vulnerabilities which enable it. Would love to see that list. Other than that, the evasion techniques look pretty traditional.<p>And of course the privilege escalation is done by a polkit vulnerability...</div><br/><div id="41739056" class="c"><input type="checkbox" id="c-41739056" checked=""/><div class="controls bullet"><span class="by">allkindsof</span><span>|</span><a href="#41738666">parent</a><span>|</span><a href="#41736471">next</a><span>|</span><label class="collapse" for="c-41739056">[-]</label><label class="expand" for="c-41739056">[1 more]</label></div><br/><div class="children"><div class="content">Also more interested in what the misconfigs are.</div><br/></div></div></div></div><div id="41736471" class="c"><input type="checkbox" id="c-41736471" checked=""/><div class="controls bullet"><span class="by">johnfernow</span><span>|</span><a href="#41738666">prev</a><span>|</span><a href="#41736847">next</a><span>|</span><label class="collapse" for="c-41736471">[-]</label><label class="expand" for="c-41736471">[2 more]</label></div><br/><div class="children"><div class="content">From the article:<p>&gt; &quot;Aqua Nautilus researchers aim to shed light on a Linux malware that, over the past 3-4 years, has actively sought more than 20,000 types of misconfigurations in order to target and exploit Linux servers. If you have a Linux server connected to the internet, you could be at risk. In fact, given the scale, we strongly believe the attackers targeted millions worldwide with a potential number of victims of thousands, it appears that with this malware any Linux server could be at risk.<p>...<p>- It utilizes rootkits to hide its presence.<p>- When a new user logs into the server, it immediately stops all “noisy” activities, lying dormant until the server is idle again.<p>- It utilizes Unix socket for internal communication and TOR for external communication.<p>- After execution, it deletes its binary and continues to run quietly in the background as a service.<p>- It copies itself from memory to various locations on the disk, using deceptive names.<p>- It opens a backdoor on the server and listens for TOR communications.<p>- It attempts to exploit the Polkit vulnerability (CVE-2021-4043) to escalate privileges.<p>In all the attacks observed, the malware was used to run a cryptominer, and in some cases, we also detected the execution of proxy-jacking software. During one of our sandbox tests, the threat actor utilized one of the malware’s backdoors to access the honeypot and started deploying some new utilities to better understand the nature of our server, trying to understand what exactly we are doing to its malware.&quot;<p>The article goes into more depth of the attack flow, what the malware does, and how they detected it.</div><br/><div id="41738188" class="c"><input type="checkbox" id="c-41738188" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#41736471">parent</a><span>|</span><a href="#41736847">next</a><span>|</span><label class="collapse" for="c-41738188">[-]</label><label class="expand" for="c-41738188">[1 more]</label></div><br/><div class="children"><div class="content">The CVE has a typo; the actual is CVE-2021-4034. <a href="https:&#x2F;&#x2F;nvd.nist.gov&#x2F;vuln&#x2F;detail&#x2F;CVE-2021-4034" rel="nofollow">https:&#x2F;&#x2F;nvd.nist.gov&#x2F;vuln&#x2F;detail&#x2F;CVE-2021-4034</a></div><br/></div></div></div></div><div id="41736847" class="c"><input type="checkbox" id="c-41736847" checked=""/><div class="controls bullet"><span class="by">pm2222</span><span>|</span><a href="#41736471">prev</a><span>|</span><a href="#41738735">next</a><span>|</span><label class="collapse" for="c-41736847">[-]</label><label class="expand" for="c-41736847">[4 more]</label></div><br/><div class="children"><div class="content">Does uefi secureboot help or not at all?</div><br/><div id="41737366" class="c"><input type="checkbox" id="c-41737366" checked=""/><div class="controls bullet"><span class="by">johnfernow</span><span>|</span><a href="#41736847">parent</a><span>|</span><a href="#41738517">next</a><span>|</span><label class="collapse" for="c-41737366">[-]</label><label class="expand" for="c-41737366">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure, outside of my expertise, but I think it might not help.<p>The attack takes place after boot, so maybe at best UEFI secureboot could prevent persistence of the malware, but I don&#x27;t think it&#x27;d even achieve that, as the malware adds popular Linux utilities that were modified to serve as user land rootkits, and runs them by modifying the ~&#x2F;.profile script. That script is ran when the user logs in (it starts the malware first, and then everything that&#x27;s supposed to run on the server after), and I don&#x27;t believe UEFI secureboot has any protections against ~&#x2F;.profile script modifications or rootkits ran after boot.</div><br/></div></div><div id="41738517" class="c"><input type="checkbox" id="c-41738517" checked=""/><div class="controls bullet"><span class="by">vaylian</span><span>|</span><a href="#41736847">parent</a><span>|</span><a href="#41737366">prev</a><span>|</span><a href="#41738735">next</a><span>|</span><label class="collapse" for="c-41738517">[-]</label><label class="expand" for="c-41738517">[2 more]</label></div><br/><div class="children"><div class="content">See the mitigation section in the article: <a href="https:&#x2F;&#x2F;www.aquasec.com&#x2F;blog&#x2F;perfctl-a-stealthy-malware-targeting-millions-of-linux-servers&#x2F;#section-7" rel="nofollow">https:&#x2F;&#x2F;www.aquasec.com&#x2F;blog&#x2F;perfctl-a-stealthy-malware-targ...</a><p>UEFI won&#x27;t help here. But keeping your system up to date and limiting the system to the necessary functionality will help you.</div><br/><div id="41738759" class="c"><input type="checkbox" id="c-41738759" checked=""/><div class="controls bullet"><span class="by">opengears</span><span>|</span><a href="#41736847">root</a><span>|</span><a href="#41738517">parent</a><span>|</span><a href="#41738735">next</a><span>|</span><label class="collapse" for="c-41738759">[-]</label><label class="expand" for="c-41738759">[1 more]</label></div><br/><div class="children"><div class="content">In the mitigation section there is written &#x27;Deploy Runtime Protection: Use advanced anti-malware and behavioral detection tools that can detect rootkits, cryptominers, and fileless malware like perfctl.&#x27; -- which tools can we currently use to detect perfctl?</div><br/></div></div></div></div></div></div><div id="41738735" class="c"><input type="checkbox" id="c-41738735" checked=""/><div class="controls bullet"><span class="by">opengears</span><span>|</span><a href="#41736847">prev</a><span>|</span><label class="collapse" for="c-41738735">[-]</label><label class="expand" for="c-41738735">[2 more]</label></div><br/><div class="children"><div class="content">are there any scripts or steps to 100% detect perfectl yet?</div><br/><div id="41738784" class="c"><input type="checkbox" id="c-41738784" checked=""/><div class="controls bullet"><span class="by">Gys</span><span>|</span><a href="#41738735">parent</a><span>|</span><label class="collapse" for="c-41738784">[-]</label><label class="expand" for="c-41738784">[1 more]</label></div><br/><div class="children"><div class="content">&gt; In all the attacks observed, the malware was used to run a cryptominer<p>I assume it starts by detecting a continuous 100% utilization of the cpu’s.</div><br/></div></div></div></div></div></div></div></div></div></body></html>