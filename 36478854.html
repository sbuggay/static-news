<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1687856459805" as="style"/><link rel="stylesheet" href="styles.css?v=1687856459805"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://spin.atomicobject.com/2023/06/26/dexec-docker/">Working with Docker Containers Made Easy with the Dexec Bash Script</a> <span class="domain">(<a href="https://spin.atomicobject.com">spin.atomicobject.com</a>)</span></div><div class="subtext"><span>ingve</span> | <span>15 comments</span></div><br/><div><div id="36490457" class="c"><input type="checkbox" id="c-36490457" checked=""/><div class="controls bullet"><span class="by">m000</span><span>|</span><a href="#36490357">next</a><span>|</span><label class="collapse" for="c-36490457">[-]</label><label class="expand" for="c-36490457">[1 more]</label></div><br/><div class="children"><div class="content">Am I missing anything here? This is just a shell wrapper for running a couple of basic docker commands in sequence. It&#x27;s not even zsh, so you can have some semi-decent argument parsing with zparseopts.<p>For similar docker automation I just use a Makefile with pattern rule (e.g. `docker-sh-%`). This is much more flexible than shell scripts because recipes can be easily remixed to provide higher-level functionality.</div><br/></div></div><div id="36490357" class="c"><input type="checkbox" id="c-36490357" checked=""/><div class="controls bullet"><span class="by">noir_lord</span><span>|</span><a href="#36490457">prev</a><span>|</span><a href="#36490427">next</a><span>|</span><label class="collapse" for="c-36490357">[-]</label><label class="expand" for="c-36490357">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    #!&#x2F;bin&#x2F;bash

    # Grab the container name and use fzf to let us pick it
    result=$(docker container ls --format &quot;{{.Names}}&quot; | fzf)

    # No command - try bash
    if [ $# -eq 0 ]
      then
        echo &quot;docker exec -it $result &#x2F;bin&#x2F;bash&quot;
        docker exec -it &quot;$result&quot; &#x2F;bin&#x2F;bash
    fi

    # Command was given so use that 
    if [ $# -eq 1 ]
      then
        echo &quot;docker exec -it $result $1&quot;
        docker exec -it &quot;$result&quot; &quot;$1&quot;
    fi
</code></pre>
Requires fzf but other wise `ec, select container, it&#x27;ll try bash or whatever shell&#x2F;command you supplied.</div><br/></div></div><div id="36490427" class="c"><input type="checkbox" id="c-36490427" checked=""/><div class="controls bullet"><span class="by">mgaunard</span><span>|</span><a href="#36490357">prev</a><span>|</span><a href="#36490319">next</a><span>|</span><label class="collapse" for="c-36490427">[-]</label><label class="expand" for="c-36490427">[1 more]</label></div><br/><div class="children"><div class="content">Whenever you use docker it seems you&#x27;ll want to write custom wrappers for it.<p>In particular what I&#x27;ve found useful:<p><pre><code>  - automatically create a user with the same uid as yourself and run the command as that user. Pretty much required whenever you mount some directories for writing.
  - automatically login and pull if necessary</code></pre></div><br/></div></div><div id="36490319" class="c"><input type="checkbox" id="c-36490319" checked=""/><div class="controls bullet"><span class="by">thevagrant</span><span>|</span><a href="#36490427">prev</a><span>|</span><a href="#36490185">next</a><span>|</span><label class="collapse" for="c-36490319">[-]</label><label class="expand" for="c-36490319">[1 more]</label></div><br/><div class="children"><div class="content">DDEV has a similar feature called container commands which is very useful<p>[1] <a href="https:&#x2F;&#x2F;ddev.readthedocs.io&#x2F;en&#x2F;stable&#x2F;users&#x2F;extend&#x2F;custom-commands&#x2F;#container-commands" rel="nofollow noreferrer">https:&#x2F;&#x2F;ddev.readthedocs.io&#x2F;en&#x2F;stable&#x2F;users&#x2F;extend&#x2F;custom-co...</a><p>[2] <a href="https:&#x2F;&#x2F;ddev.com" rel="nofollow noreferrer">https:&#x2F;&#x2F;ddev.com</a></div><br/></div></div><div id="36490185" class="c"><input type="checkbox" id="c-36490185" checked=""/><div class="controls bullet"><span class="by">moondev</span><span>|</span><a href="#36490319">prev</a><span>|</span><a href="#36488810">next</a><span>|</span><label class="collapse" for="c-36490185">[-]</label><label class="expand" for="c-36490185">[3 more]</label></div><br/><div class="children"><div class="content">docker exec -it &lt;tab tab&gt; sh</div><br/><div id="36490336" class="c"><input type="checkbox" id="c-36490336" checked=""/><div class="controls bullet"><span class="by">z33k</span><span>|</span><a href="#36490185">parent</a><span>|</span><a href="#36488810">next</a><span>|</span><label class="collapse" for="c-36490336">[-]</label><label class="expand" for="c-36490336">[2 more]</label></div><br/><div class="children"><div class="content">Indeed, wrapping basic docker commands in a script feels like wrapping git commands in a script. You’re probably better off learning the commands for this ubiquitous tool.</div><br/><div id="36490342" class="c"><input type="checkbox" id="c-36490342" checked=""/><div class="controls bullet"><span class="by">noir_lord</span><span>|</span><a href="#36490185">root</a><span>|</span><a href="#36490336">parent</a><span>|</span><a href="#36488810">next</a><span>|</span><label class="collapse" for="c-36490342">[-]</label><label class="expand" for="c-36490342">[1 more]</label></div><br/><div class="children"><div class="content">Or learn the commands and <i>then</i> wrap them, best of both worlds, developer affordance is a useful characteristic as long as it doesn&#x27;t reduce understanding.</div><br/></div></div></div></div></div></div><div id="36488810" class="c"><input type="checkbox" id="c-36488810" checked=""/><div class="controls bullet"><span class="by">jmholla</span><span>|</span><a href="#36490185">prev</a><span>|</span><a href="#36489628">next</a><span>|</span><label class="collapse" for="c-36488810">[-]</label><label class="expand" for="c-36488810">[1 more]</label></div><br/><div class="children"><div class="content">I think something that would make me consider using this, is auto-completion support. I&#x27;ve added it to a lot of my own commands and it is awesome. I think compared to this tool, raw docker commands using tab completion would still be faster for me.</div><br/></div></div><div id="36489628" class="c"><input type="checkbox" id="c-36489628" checked=""/><div class="controls bullet"><span class="by">jamespo</span><span>|</span><a href="#36488810">prev</a><span>|</span><a href="#36489208">next</a><span>|</span><label class="collapse" for="c-36489628">[-]</label><label class="expand" for="c-36489628">[1 more]</label></div><br/><div class="children"><div class="content">I like <a href="https:&#x2F;&#x2F;github.com&#x2F;jesseduffield&#x2F;lazydocker">https:&#x2F;&#x2F;github.com&#x2F;jesseduffield&#x2F;lazydocker</a></div><br/></div></div><div id="36489208" class="c"><input type="checkbox" id="c-36489208" checked=""/><div class="controls bullet"><span class="by">MrOxiMoron</span><span>|</span><a href="#36489628">prev</a><span>|</span><a href="#36489705">next</a><span>|</span><label class="collapse" for="c-36489208">[-]</label><label class="expand" for="c-36489208">[1 more]</label></div><br/><div class="children"><div class="content">In don&#x27;t see it, it helps you with the easy part that is the same across projects, but you still need to know the project specifics to use it.<p>I use &quot;just&quot; these days, per project, autocompletion with explanation what each command does.</div><br/></div></div><div id="36489705" class="c"><input type="checkbox" id="c-36489705" checked=""/><div class="controls bullet"><span class="by">xiekomb</span><span>|</span><a href="#36489208">prev</a><span>|</span><a href="#36488797">next</a><span>|</span><label class="collapse" for="c-36489705">[-]</label><label class="expand" for="c-36489705">[1 more]</label></div><br/><div class="children"><div class="content">That looks like using docker-compose ? My problem now that we switched to docker swarm is that docker compose commands are not available anymore. Need to use « docker service » or docker on the hosts and again deal with the complexity of some commands.</div><br/></div></div><div id="36488797" class="c"><input type="checkbox" id="c-36488797" checked=""/><div class="controls bullet"><span class="by">seaal</span><span>|</span><a href="#36489705">prev</a><span>|</span><label class="collapse" for="c-36488797">[-]</label><label class="expand" for="c-36488797">[3 more]</label></div><br/><div class="children"><div class="content">As a Docker novice this is fantastic. Every time I need to execute commands inside of a container I end of on Google.</div><br/><div id="36489024" class="c"><input type="checkbox" id="c-36489024" checked=""/><div class="controls bullet"><span class="by">djbusby</span><span>|</span><a href="#36488797">parent</a><span>|</span><label class="collapse" for="c-36489024">[-]</label><label class="expand" for="c-36489024">[2 more]</label></div><br/><div class="children"><div class="content">When I&#x27;m learning a new toolset I have a habit of writing a cheat-sheet. The frequent command incantations, where params go, common &quot;gotcha&quot;&#x2F;footgun.</div><br/><div id="36489193" class="c"><input type="checkbox" id="c-36489193" checked=""/><div class="controls bullet"><span class="by">ehnto</span><span>|</span><a href="#36488797">root</a><span>|</span><a href="#36489024">parent</a><span>|</span><label class="collapse" for="c-36489193">[-]</label><label class="expand" for="c-36489193">[1 more]</label></div><br/><div class="children"><div class="content">I do this in all projects I work on too, there is always lots of arbitrary knowledge in long running projects.<p>I formalized it into a .notes folder inside every project and I have a command with useful note related tasks, that works out of the present directory .notes folder.<p>I have the same for project tasks, so common bash tasks go into a script inside .tasks and I have a command runner that works similar to npm run.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>