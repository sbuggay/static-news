<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1737709274090" as="style"/><link rel="stylesheet" href="styles.css?v=1737709274090"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://bart.degoe.de/building-a-full-text-search-engine-150-lines-of-code/">Building a full-text search engine in 150 lines of Python code (2021)</a> <span class="domain">(<a href="https://bart.degoe.de">bart.degoe.de</a>)</span></div><div class="subtext"><span>matt_daemon</span> | <span>10 comments</span></div><br/><div><div id="42811420" class="c"><input type="checkbox" id="c-42811420" checked=""/><div class="controls bullet"><span class="by">jankovicsandras</span><span>|</span><a href="#42811002">next</a><span>|</span><label class="collapse" for="c-42811420">[-]</label><label class="expand" for="c-42811420">[1 more]</label></div><br/><div class="children"><div class="content">This is a good intro to text search.
Shameless plug: 
If you throw in a bit more, ca. 250 SLOC, you can have BM25 search:
<a href="https:&#x2F;&#x2F;github.com&#x2F;jankovicsandras&#x2F;bm25opt">https:&#x2F;&#x2F;github.com&#x2F;jankovicsandras&#x2F;bm25opt</a></div><br/></div></div><div id="42811002" class="c"><input type="checkbox" id="c-42811002" checked=""/><div class="controls bullet"><span class="by">cocodill</span><span>|</span><a href="#42811420">prev</a><span>|</span><label class="collapse" for="c-42811002">[-]</label><label class="expand" for="c-42811002">[8 more]</label></div><br/><div class="children"><div class="content">&gt; return [token for token in tokens if token]<p>I love that kind of bullshit poetry.</div><br/><div id="42811383" class="c"><input type="checkbox" id="c-42811383" checked=""/><div class="controls bullet"><span class="by">ks2048</span><span>|</span><a href="#42811002">parent</a><span>|</span><a href="#42811294">next</a><span>|</span><label class="collapse" for="c-42811383">[-]</label><label class="expand" for="c-42811383">[3 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re used to this, it&#x27;s nice and readable.<p>Or you can do,<p><pre><code>    return filter(None,tokens)
</code></pre>
Not obvious, but giving None is like giving &quot;lambda x : x&quot; to filter().</div><br/><div id="42811468" class="c"><input type="checkbox" id="c-42811468" checked=""/><div class="controls bullet"><span class="by">chaos_emergent</span><span>|</span><a href="#42811002">root</a><span>|</span><a href="#42811383">parent</a><span>|</span><a href="#42811294">next</a><span>|</span><label class="collapse" for="c-42811468">[-]</label><label class="expand" for="c-42811468">[2 more]</label></div><br/><div class="children"><div class="content">Holy shit, I’ve been writing python for 15 years and it’s the first time I’ve seen None used as an identity function. That’s nuts! How does it work under the hood? Does filter have a special case for evaluating None?</div><br/><div id="42811480" class="c"><input type="checkbox" id="c-42811480" checked=""/><div class="controls bullet"><span class="by">echoangle</span><span>|</span><a href="#42811002">root</a><span>|</span><a href="#42811468">parent</a><span>|</span><a href="#42811294">next</a><span>|</span><label class="collapse" for="c-42811480">[-]</label><label class="expand" for="c-42811480">[1 more]</label></div><br/><div class="children"><div class="content">Yes, that’s just a special case. You can’t call None as a function.<p><a href="https:&#x2F;&#x2F;docs.python.org&#x2F;3&#x2F;library&#x2F;functions.html#filter" rel="nofollow">https:&#x2F;&#x2F;docs.python.org&#x2F;3&#x2F;library&#x2F;functions.html#filter</a><p>&gt; If function is None, the identity function is assumed, that is, all elements of iterable that are false are removed.</div><br/></div></div></div></div></div></div><div id="42811294" class="c"><input type="checkbox" id="c-42811294" checked=""/><div class="controls bullet"><span class="by">dkga</span><span>|</span><a href="#42811002">parent</a><span>|</span><a href="#42811383">prev</a><span>|</span><a href="#42811210">next</a><span>|</span><label class="collapse" for="c-42811294">[-]</label><label class="expand" for="c-42811294">[2 more]</label></div><br/><div class="children"><div class="content">It grew on me, too. Originally I frowned upon this kind of python shenanigans but now I must confess it makes me a bit happier inside whenever I have to type a similar thing.</div><br/><div id="42811344" class="c"><input type="checkbox" id="c-42811344" checked=""/><div class="controls bullet"><span class="by">graemep</span><span>|</span><a href="#42811002">root</a><span>|</span><a href="#42811294">parent</a><span>|</span><a href="#42811210">next</a><span>|</span><label class="collapse" for="c-42811344">[-]</label><label class="expand" for="c-42811344">[1 more]</label></div><br/><div class="children"><div class="content">I think its lovely if its reasonably readable (which this is) but they can be convoluted. I have written Python list comprehensions that I could not read myself the next day and so I am more careful now.</div><br/></div></div></div></div><div id="42811210" class="c"><input type="checkbox" id="c-42811210" checked=""/><div class="controls bullet"><span class="by">pastage</span><span>|</span><a href="#42811002">parent</a><span>|</span><a href="#42811294">prev</a><span>|</span><label class="collapse" for="c-42811210">[-]</label><label class="expand" for="c-42811210">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, but what is worst? I tried to understand the Haskell way in an article last week[0]<p><pre><code>  pure (n, guard (factor &#x2F;= n) $&gt; factor)
</code></pre>
Which I think is more or less the same as this python line.<p><pre><code>  return [factor for factor in factors if factor and not factor == n]
</code></pre>
The article does fancy stuff with memory caches which I believe is easy to do in python but I need to understand the Haskell code better.<p>[0] Haskell: A Great Procedural Language
<a href="https:&#x2F;&#x2F;entropicthoughts.com&#x2F;haskell-procedural-programming#leaning-into-the-first-classiness-of-effects" rel="nofollow">https:&#x2F;&#x2F;entropicthoughts.com&#x2F;haskell-procedural-programming#...</a>
<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42754098">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42754098</a></div><br/><div id="42811366" class="c"><input type="checkbox" id="c-42811366" checked=""/><div class="controls bullet"><span class="by">mrkeen</span><span>|</span><a href="#42811002">root</a><span>|</span><a href="#42811210">parent</a><span>|</span><label class="collapse" for="c-42811366">[-]</label><label class="expand" for="c-42811366">[1 more]</label></div><br/><div class="children"><div class="content">&gt; pure (n, guard (factor &#x2F;= n) $&gt; factor)<p>Returns a tuple:  Left side is n, right side is (Just factor) if factor is not n, or Nothing if it is.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>