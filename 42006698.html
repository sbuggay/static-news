<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730451665107" as="style"/><link rel="stylesheet" href="styles.css?v=1730451665107"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.trailofbits.com/2024/10/31/fuzzing-between-the-lines-in-popular-barcode-software/">Fuzzing between the lines in popular barcode software</a> <span class="domain">(<a href="https://blog.trailofbits.com">blog.trailofbits.com</a>)</span></div><div class="subtext"><span>ingve</span> | <span>51 comments</span></div><br/><div><div id="42007389" class="c"><input type="checkbox" id="c-42007389" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><a href="#42007922">next</a><span>|</span><label class="collapse" for="c-42007389">[-]</label><label class="expand" for="c-42007389">[17 more]</label></div><br/><div class="children"><div class="content"><i>&gt; You might ask: how do you know whether or not software has been fuzzed?</i><p>zbar has great barcode reading performance! I&#x27;ve seen far newer software that&#x27;s nowhere near as good in terms of real-world performance.<p>But it seems the original developer hasn&#x27;t updated it since 2009 [1] - and fuzz testing only rose to prominence in ~2012 with the rise of tools like afl-fuzz.<p>I would be absolutely astonished if it had ever been fuzzed.<p><i>&gt; Cut out any unnecessary features to limit attack vectors. ZBar by default scans all code types, which means that an attacker can trigger a bug in any of the scanners. If you only need to scan QR codes for instance, then ZBar can be configured to do so in the code</i><p>Absolutely sensible, yes.<p>Not just for security, but also because packages sometimes have extra barcodes. If you&#x27;re scanning an EAN-13 on a pack of pasta, decoding a QR code for a pasta recipe website is just going to confuse things :)<p>[1] <a href="https:&#x2F;&#x2F;sourceforge.net&#x2F;projects&#x2F;zbar&#x2F;files&#x2F;zbar&#x2F;" rel="nofollow">https:&#x2F;&#x2F;sourceforge.net&#x2F;projects&#x2F;zbar&#x2F;files&#x2F;zbar&#x2F;</a></div><br/><div id="42007522" class="c"><input type="checkbox" id="c-42007522" checked=""/><div class="controls bullet"><span class="by">zootboy</span><span>|</span><a href="#42007389">parent</a><span>|</span><a href="#42007546">next</a><span>|</span><label class="collapse" for="c-42007522">[-]</label><label class="expand" for="c-42007522">[14 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve seen the &quot;overzealous barcode scanner&quot; issue happen with some gas station POS systems, to the point where the seasoned cashiers know to cover the QR codes with their fingers before attempting to scan an item.</div><br/><div id="42008567" class="c"><input type="checkbox" id="c-42008567" checked=""/><div class="controls bullet"><span class="by">neilv</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007522">parent</a><span>|</span><a href="#42009017">next</a><span>|</span><label class="collapse" for="c-42008567">[-]</label><label class="expand" for="c-42008567">[2 more]</label></div><br/><div class="children"><div class="content">Sounds like the POS software isn&#x27;t controlling the reader well, maybe because it wasn&#x27;t adjusted for this model of reader.  Or the reader&#x27;s firmware could have been misconfigured, from what it&#x27;s supposed to be for that POS setup.<p>The modern reader firmware tend to have multiple modes and many options.  Some modes are as simple as &quot;scan whatever you see out of the many formats you support, and spit out the decoded value of something as USB Serial&quot;.  Or, worse, &quot;...as USB Keyboard&quot;.<p>You can imagine how easy those modes are to integrate with POS software, without implementing the proprietary protocol for that device, and you can also imagine how poorly that can work out.<p>If you owned a store with a POS setup with flaky reader behavior like this, and were stuck with it, you could try reconfiguring the reader (to, say, disable QR support).  This reprogramming can sometimes be done via documented protocol, via sketchy Windows software, or via... barcode...  Careful you don&#x27;t make it worse.<p>(Our startup used modern readers (multiple 1D formats, QR, NFC) for a factory station, and had to do a lot of experimenting with different brands and models, to get the behavior and speed we needed.  We even managed to brick a reader, just with configuration changes, not flashing firmware.)</div><br/><div id="42013330" class="c"><input type="checkbox" id="c-42013330" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42008567">parent</a><span>|</span><a href="#42009017">next</a><span>|</span><label class="collapse" for="c-42013330">[-]</label><label class="expand" for="c-42013330">[1 more]</label></div><br/><div class="children"><div class="content">The shop may use QR codes for coupons or loyalty programs even if the merchandise doesn&#x27;t use it. So being able to scan these items without switching mode is often an important feature.</div><br/></div></div></div></div><div id="42009017" class="c"><input type="checkbox" id="c-42009017" checked=""/><div class="controls bullet"><span class="by">masfuerte</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007522">parent</a><span>|</span><a href="#42008567">prev</a><span>|</span><a href="#42007611">next</a><span>|</span><label class="collapse" for="c-42009017">[-]</label><label class="expand" for="c-42009017">[2 more]</label></div><br/><div class="children"><div class="content">I went to a meeting the other day in a building with a touch screen registration system.  The woman in front of me was struggling with it.  Every time she tapped the register button the system decided that some part of her was a badly formed barcode, printed an error message and exited back to the menu.  She eventually got it working by moving to the side until it wanted to take her picture.</div><br/></div></div><div id="42007611" class="c"><input type="checkbox" id="c-42007611" checked=""/><div class="controls bullet"><span class="by">EvanAnderson</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007522">parent</a><span>|</span><a href="#42009017">prev</a><span>|</span><a href="#42008478">next</a><span>|</span><label class="collapse" for="c-42007611">[-]</label><label class="expand" for="c-42007611">[8 more]</label></div><br/><div class="children"><div class="content">Absolutely. I helped with a physical inventory count project using smartphones as the &quot;terminals&quot;. The barcode app we didn&#x27;t allow us to selectively turn off symbologies. We ended up with a ton of links to recipes, websites, etc in the data.</div><br/><div id="42008023" class="c"><input type="checkbox" id="c-42008023" checked=""/><div class="controls bullet"><span class="by">01HNNWZ0MV43FF</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007611">parent</a><span>|</span><a href="#42008478">next</a><span>|</span><label class="collapse" for="c-42008023">[-]</label><label class="expand" for="c-42008023">[7 more]</label></div><br/><div class="children"><div class="content">Reminds me of the Jurassic Park novel where they ask the computer to find 10 velociraptors on the island and it finds 10. And they actually have 20.</div><br/><div id="42013656" class="c"><input type="checkbox" id="c-42013656" checked=""/><div class="controls bullet"><span class="by">ipdashc</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42008023">parent</a><span>|</span><a href="#42011433">next</a><span>|</span><label class="collapse" for="c-42013656">[-]</label><label class="expand" for="c-42013656">[1 more]</label></div><br/><div class="children"><div class="content">The Jurassic Park novel had some of the best depictions of technical failures like that, IMO. The scene where they realize they&#x27;ve been running on backup power and everything goes down is another good one. I won&#x27;t call them realistic per se, but they just <i>felt</i> right. Andromeda Strain, another Crichton work, was also pretty good at this.</div><br/></div></div><div id="42011433" class="c"><input type="checkbox" id="c-42011433" checked=""/><div class="controls bullet"><span class="by">bluedino</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42008023">parent</a><span>|</span><a href="#42013656">prev</a><span>|</span><a href="#42009983">next</a><span>|</span><label class="collapse" for="c-42011433">[-]</label><label class="expand" for="c-42011433">[2 more]</label></div><br/><div class="children"><div class="content">They can run the whole park with minimal staff for up to 3 days. You think that kind of automation is easy? Or cheap?</div><br/><div id="42014215" class="c"><input type="checkbox" id="c-42014215" checked=""/><div class="controls bullet"><span class="by">lazide</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42011433">parent</a><span>|</span><a href="#42009983">next</a><span>|</span><label class="collapse" for="c-42014215">[-]</label><label class="expand" for="c-42014215">[1 more]</label></div><br/><div class="children"><div class="content">It is when you outsource to one Nedry and his coke habit!</div><br/></div></div></div></div><div id="42009983" class="c"><input type="checkbox" id="c-42009983" checked=""/><div class="controls bullet"><span class="by">af3d</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42008023">parent</a><span>|</span><a href="#42011433">prev</a><span>|</span><a href="#42008478">next</a><span>|</span><label class="collapse" for="c-42009983">[-]</label><label class="expand" for="c-42009983">[3 more]</label></div><br/><div class="children"><div class="content">Can you really blame the computer tho? That sounds more like a case a PEBCAC, if you ask me...</div><br/><div id="42010715" class="c"><input type="checkbox" id="c-42010715" checked=""/><div class="controls bullet"><span class="by">wongarsu</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42009983">parent</a><span>|</span><a href="#42008478">next</a><span>|</span><label class="collapse" for="c-42010715">[-]</label><label class="expand" for="c-42010715">[2 more]</label></div><br/><div class="children"><div class="content">More like bad requirements. The system knew how many dinosaurs of each species had been released into the park, and the inventory system was only supposed to figure out if any were missing. No sense in looking further than that, after all where should the additional dinosaurs come from.<p>That was the main theme of the book. Everything was well designed with failsafes, but too many of the design assumptions turned out to be wrong. Expecting only the expected lead to many small mistakes that were harmless individually but together snowball into a disaster.</div><br/><div id="42014223" class="c"><input type="checkbox" id="c-42014223" checked=""/><div class="controls bullet"><span class="by">lazide</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42010715">parent</a><span>|</span><a href="#42008478">next</a><span>|</span><label class="collapse" for="c-42014223">[-]</label><label class="expand" for="c-42014223">[1 more]</label></div><br/><div class="children"><div class="content">Crichton novels are excellent at that kind of technical dystopian&#x2F;disaster.<p>(Well, not obviously dystopian, more ‘oh shit, that is how we’d be fucked isn’t it). Alien and Aliens also had a similar feel in their writing, except in real life there is rarely a Ripley there when you need one.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42008478" class="c"><input type="checkbox" id="c-42008478" checked=""/><div class="controls bullet"><span class="by">devmor</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007522">parent</a><span>|</span><a href="#42007611">prev</a><span>|</span><a href="#42007546">next</a><span>|</span><label class="collapse" for="c-42008478">[-]</label><label class="expand" for="c-42008478">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s also a common annoyance in grocery store apps.<p>Kroger, for example, has an app that allows you to scan items to add them to a virtual cart as you shop and avoid scanning them at the register... however the same app is used to read QR codes on in-store coupons, which are &quot;helpfully&quot; placed very close to the price tags with UPC barcodes on them.<p>If I want to scan one of those coupon QR codes, I need to either start with the camera very close to the QR code or cover the barcode with my finger.</div><br/></div></div></div></div><div id="42007546" class="c"><input type="checkbox" id="c-42007546" checked=""/><div class="controls bullet"><span class="by">bragr</span><span>|</span><a href="#42007389">parent</a><span>|</span><a href="#42007522">prev</a><span>|</span><a href="#42007922">next</a><span>|</span><label class="collapse" for="c-42007546">[-]</label><label class="expand" for="c-42007546">[2 more]</label></div><br/><div class="children"><div class="content">It appears to have been forked: <a href="https:&#x2F;&#x2F;github.com&#x2F;mchehab&#x2F;zbar">https:&#x2F;&#x2F;github.com&#x2F;mchehab&#x2F;zbar</a></div><br/><div id="42011385" class="c"><input type="checkbox" id="c-42011385" checked=""/><div class="controls bullet"><span class="by">DylanSp</span><span>|</span><a href="#42007389">root</a><span>|</span><a href="#42007546">parent</a><span>|</span><a href="#42007922">next</a><span>|</span><label class="collapse" for="c-42011385">[-]</label><label class="expand" for="c-42011385">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the repo Trail of Bits was working with; the PR they ended up submitting is at <a href="https:&#x2F;&#x2F;github.com&#x2F;mchehab&#x2F;zbar&#x2F;pull&#x2F;294">https:&#x2F;&#x2F;github.com&#x2F;mchehab&#x2F;zbar&#x2F;pull&#x2F;294</a>.</div><br/></div></div></div></div></div></div><div id="42007922" class="c"><input type="checkbox" id="c-42007922" checked=""/><div class="controls bullet"><span class="by">billpg</span><span>|</span><a href="#42007389">prev</a><span>|</span><a href="#42015017">next</a><span>|</span><label class="collapse" for="c-42007922">[-]</label><label class="expand" for="c-42007922">[10 more]</label></div><br/><div class="children"><div class="content">I once reported a bug to a barcode decoding library, reporting that it crashed when the barcode contained a zero byte. They responded that they wouldn&#x27;t fix it because barcodes aren&#x27;t supposed to contain zero bytes.<p>&quot;But it crashed. That&#x27;s bad. I can&#x27;t stop people scanning bad barcodes.&quot;</div><br/><div id="42009200" class="c"><input type="checkbox" id="c-42009200" checked=""/><div class="controls bullet"><span class="by">unnouinceput</span><span>|</span><a href="#42007922">parent</a><span>|</span><a href="#42010281">next</a><span>|</span><label class="collapse" for="c-42009200">[-]</label><label class="expand" for="c-42009200">[2 more]</label></div><br/><div class="children"><div class="content">&quot;Programming today is a race between software engineers striving to build bigger and better idiot-proof programs, and the Universe trying to produce bigger and better idiots. So far, the Universe is winning.&quot; - Rick Cook</div><br/><div id="42014229" class="c"><input type="checkbox" id="c-42014229" checked=""/><div class="controls bullet"><span class="by">lazide</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42009200">parent</a><span>|</span><a href="#42010281">next</a><span>|</span><label class="collapse" for="c-42014229">[-]</label><label class="expand" for="c-42014229">[1 more]</label></div><br/><div class="children"><div class="content">Combined with the all to human reflex of engineers to insist that it isn’t their <i>implementation&#x2F;design</i> that is wrong, it is <i>reality</i> which is wrong. Clearly.<p>Because if we just didn’t do that, then it would all work.<p>In particular, see folks talking about Self Driving hah.</div><br/></div></div></div></div><div id="42010281" class="c"><input type="checkbox" id="c-42010281" checked=""/><div class="controls bullet"><span class="by">alex_suzuki</span><span>|</span><a href="#42007922">parent</a><span>|</span><a href="#42009200">prev</a><span>|</span><a href="#42008322">next</a><span>|</span><label class="collapse" for="c-42010281">[-]</label><label class="expand" for="c-42010281">[2 more]</label></div><br/><div class="children"><div class="content">Do you by chance remember which library, and which barcode symbology? (barcode library developer here :-)</div><br/><div id="42015090" class="c"><input type="checkbox" id="c-42015090" checked=""/><div class="controls bullet"><span class="by">billpg</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42010281">parent</a><span>|</span><a href="#42008322">next</a><span>|</span><label class="collapse" for="c-42015090">[-]</label><label class="expand" for="c-42015090">[1 more]</label></div><br/><div class="children"><div class="content">I do remember it was a large 2D barcode. Like QR but with a square in the middle. (AZTEC?)<p>I was trying random barcodes I had lying around to test my own component. The one with the zero byte happened to be a large one they had added to my passport when I visited the USA. It had &quot;US-VISIT&quot; printed next to it in big letters.<p>The device was a rugged industrial handheld device with a screen and a camera, designed for mailrooms and warehouses. This was around 20 years ago and I remember the OS (including the barcode component) was completely bespoke and it ran without any process protections. This meant that the barcode would crash the whole device and you had to perform a hard reset.</div><br/></div></div></div></div><div id="42008322" class="c"><input type="checkbox" id="c-42008322" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#42007922">parent</a><span>|</span><a href="#42010281">prev</a><span>|</span><a href="#42015017">next</a><span>|</span><label class="collapse" for="c-42008322">[-]</label><label class="expand" for="c-42008322">[5 more]</label></div><br/><div class="children"><div class="content">&gt; They responded that they wouldn&#x27;t fix it because barcodes aren&#x27;t supposed to contain zero bytes.<p>Sad. What a poor understanding of our field.<p>The number one rule of them all is: <i>&quot;Never trust (user) input&quot;</i>.<p>A slightly more powerful variation being: <i>&quot;assume all input is malicious until proven otherwise&quot;</i>.<p>I mean: on one hand there are people who fuzz, who test, who think about edge cases, who think about security, who think about uptime, etc. And OTOH you have people saying <i>&quot;such input shouldn&#x27;t happen&quot;</i>. It&#x27;s just really pathetic.</div><br/><div id="42009192" class="c"><input type="checkbox" id="c-42009192" checked=""/><div class="controls bullet"><span class="by">adolph</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42008322">parent</a><span>|</span><a href="#42015017">next</a><span>|</span><label class="collapse" for="c-42009192">[-]</label><label class="expand" for="c-42009192">[4 more]</label></div><br/><div class="children"><div class="content">I think a difference between an application and a library (or module, etc) is that it is ok for the latter to expect sanitized input and be wrapped in try&#x2F;catch blocks. The world is less finite than code and a module might be deployed in a variety of contexts which might make some checks undesirable.<p><i>In computing, the robustness principle is a design guideline for software that states: &quot;be conservative in what you do, be liberal in what you accept from others&quot;. It is often reworded as: &quot;be conservative in what you send, be liberal in what you accept&quot;. The principle is also known as Postel&#x27;s law, after Jon Postel, who used the wording in an early specification of TCP.</i><p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Robustness_principle" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Robustness_principle</a></div><br/><div id="42010182" class="c"><input type="checkbox" id="c-42010182" checked=""/><div class="controls bullet"><span class="by">david422</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42009192">parent</a><span>|</span><a href="#42009780">next</a><span>|</span><label class="collapse" for="c-42010182">[-]</label><label class="expand" for="c-42010182">[1 more]</label></div><br/><div class="children"><div class="content">If that&#x27;s the case, the library should also have another function or method that can validate the barcode if the application should so choose. The library is the barcode expert, the app is the business logic expert. Expecting every app to now become barcode experts doesn&#x27;t make sense.<p>Also, that law gets quoted, and IMO is a rather large design mistake.</div><br/></div></div><div id="42009780" class="c"><input type="checkbox" id="c-42009780" checked=""/><div class="controls bullet"><span class="by">bitexploder</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42009192">parent</a><span>|</span><a href="#42010182">prev</a><span>|</span><a href="#42009773">next</a><span>|</span><label class="collapse" for="c-42009780">[-]</label><label class="expand" for="c-42009780">[1 more]</label></div><br/><div class="children"><div class="content">The library also has the best chance to fix and prevent security issues systemically. I have played this game for a while now. Library engineers often want to pass the buck onto users of their tools. That is not good developer or user experience. Also crashing is the opposite of robust.</div><br/></div></div><div id="42009773" class="c"><input type="checkbox" id="c-42009773" checked=""/><div class="controls bullet"><span class="by">0cf8612b2e1e</span><span>|</span><a href="#42007922">root</a><span>|</span><a href="#42009192">parent</a><span>|</span><a href="#42009780">prev</a><span>|</span><a href="#42015017">next</a><span>|</span><label class="collapse" for="c-42009773">[-]</label><label class="expand" for="c-42009773">[1 more]</label></div><br/><div class="children"><div class="content">Malformed data is a fact of life. A parser should gracefully fail when this eventuality happens.</div><br/></div></div></div></div></div></div></div></div><div id="42015017" class="c"><input type="checkbox" id="c-42015017" checked=""/><div class="controls bullet"><span class="by">bspammer</span><span>|</span><a href="#42007922">prev</a><span>|</span><a href="#42008084">next</a><span>|</span><label class="collapse" for="c-42015017">[-]</label><label class="expand" for="c-42015017">[1 more]</label></div><br/><div class="children"><div class="content">I think this really demonstrates how valuable nixpkgs is. It’s the Wikipedia of building packages, and 10 years ago I wouldn’t believe it could exist, or be this good.</div><br/></div></div><div id="42008084" class="c"><input type="checkbox" id="c-42008084" checked=""/><div class="controls bullet"><span class="by">mmsc</span><span>|</span><a href="#42015017">prev</a><span>|</span><a href="#42007746">next</a><span>|</span><label class="collapse" for="c-42008084">[-]</label><label class="expand" for="c-42008084">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Surprisingly, libFuzzer struggled to figure out that input should be of size 1024 and couldn’t start fuzzing.<p>Is this surprising? Does libFuzzer support Redqueen or laf-intel like AFL++ [0][1] which will pick up on any comparisons (like a comparison to size=1024) and fuzz with the intention of changing that comparison to become true or false (to put it overly simple)?<p>0: <a href="https:&#x2F;&#x2F;github.com&#x2F;AFLplusplus&#x2F;AFLplusplus&#x2F;blob&#x2F;stable&#x2F;instrumentation&#x2F;README.cmplog.md">https:&#x2F;&#x2F;github.com&#x2F;AFLplusplus&#x2F;AFLplusplus&#x2F;blob&#x2F;stable&#x2F;instr...</a><p>1: <a href="https:&#x2F;&#x2F;github.com&#x2F;AFLplusplus&#x2F;AFLplusplus&#x2F;blob&#x2F;stable&#x2F;instrumentation&#x2F;README.laf-intel.md">https:&#x2F;&#x2F;github.com&#x2F;AFLplusplus&#x2F;AFLplusplus&#x2F;blob&#x2F;stable&#x2F;instr...</a></div><br/><div id="42013267" class="c"><input type="checkbox" id="c-42013267" checked=""/><div class="controls bullet"><span class="by">circus1540</span><span>|</span><a href="#42008084">parent</a><span>|</span><a href="#42007746">next</a><span>|</span><label class="collapse" for="c-42013267">[-]</label><label class="expand" for="c-42013267">[1 more]</label></div><br/><div class="children"><div class="content">libfuzzer has features to solve comparisons including a comparison table and value profile. in either case, it should be pretty easy to find that a 1024 size input unlocks new coverage without any of those fancy features. i doubt that was the problem here.</div><br/></div></div></div></div><div id="42007746" class="c"><input type="checkbox" id="c-42007746" checked=""/><div class="controls bullet"><span class="by">firefax</span><span>|</span><a href="#42008084">prev</a><span>|</span><a href="#42007506">next</a><span>|</span><label class="collapse" for="c-42007746">[-]</label><label class="expand" for="c-42007746">[8 more]</label></div><br/><div class="children"><div class="content">If I wanted to learn more about fuzzing, does anyone have suggestions?<p>I&#x27;d love to get to a point I could fuzz a program but the gulf of execution is vast -- I enjoyed attempting OSCP, but I can&#x27;t keep paying for lab extensions.<p>(I also have a gut feeling there&#x27;s a lot of unfuzzed apps which people don&#x27;t look at because they&#x27;re utilitarian and don&#x27;t use the network much. So if I can phish you, then leverage some innocuous tool for RCE or whatever... useful.)<p>But I&#x27;ve struggled to find resources on this topic -- anyone know of a book, course, or wiki?</div><br/><div id="42014924" class="c"><input type="checkbox" id="c-42014924" checked=""/><div class="controls bullet"><span class="by">JonChesterfield</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42008439">next</a><span>|</span><label class="collapse" for="c-42014924">[-]</label><label class="expand" for="c-42014924">[1 more]</label></div><br/><div class="children"><div class="content">LLVM ships with a fuzzing library, docs at <a href="https:&#x2F;&#x2F;llvm.org&#x2F;docs&#x2F;LibFuzzer.html" rel="nofollow">https:&#x2F;&#x2F;llvm.org&#x2F;docs&#x2F;LibFuzzer.html</a>. I get the impression that AFL is considered better. The authors of llvm fuzz stopped working on it in favour of some other thing, which they then stopped working on in favour of <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;fuzztest">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;fuzztest</a>, which seems to be broadly useless as a fuzzer implementation. But whatever, the llvm fuzzer lives on and has uses in tree and occasional updates. I found it much easier to get started with than AFL.<p>I wrote a program that takes a byte array as input and drives the library under test with it, attached that to llvm&#x27;s fuzzer and left it running. You end up with a lot of files containing some bytes that did something vaguely interesting with the program. Good experience overall.<p>You might get some meaning out of <a href="https:&#x2F;&#x2F;github.com&#x2F;JonChesterfield&#x2F;bigint&#x2F;tree&#x2F;trunk&#x2F;fuzz_bigint">https:&#x2F;&#x2F;github.com&#x2F;JonChesterfield&#x2F;bigint&#x2F;tree&#x2F;trunk&#x2F;fuzz_bi...</a> but ymmv, I got sidetracked by interesting stuff at work ~3 months back and don&#x27;t currently remember what state that repo was in when I paused work on it.</div><br/></div></div><div id="42008439" class="c"><input type="checkbox" id="c-42008439" checked=""/><div class="controls bullet"><span class="by">woodruffw</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42014924">prev</a><span>|</span><a href="#42007791">next</a><span>|</span><label class="collapse" for="c-42008439">[-]</label><label class="expand" for="c-42008439">[2 more]</label></div><br/><div class="children"><div class="content">The authors of this blog (FD: my company) have a testing handbook[1], which has a full chapter dedicated to fuzzing[2]. We&#x27;re always open to feedback on it!<p>[1]: <a href="https:&#x2F;&#x2F;appsec.guide&#x2F;" rel="nofollow">https:&#x2F;&#x2F;appsec.guide&#x2F;</a><p>[2]: <a href="https:&#x2F;&#x2F;appsec.guide&#x2F;docs&#x2F;fuzzing&#x2F;" rel="nofollow">https:&#x2F;&#x2F;appsec.guide&#x2F;docs&#x2F;fuzzing&#x2F;</a></div><br/><div id="42010541" class="c"><input type="checkbox" id="c-42010541" checked=""/><div class="controls bullet"><span class="by">djoel</span><span>|</span><a href="#42007746">root</a><span>|</span><a href="#42008439">parent</a><span>|</span><a href="#42007791">next</a><span>|</span><label class="collapse" for="c-42010541">[-]</label><label class="expand" for="c-42010541">[1 more]</label></div><br/><div class="children"><div class="content">This is great - thanks for posting!</div><br/></div></div></div></div><div id="42007791" class="c"><input type="checkbox" id="c-42007791" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42008439">prev</a><span>|</span><a href="#42008384">next</a><span>|</span><label class="collapse" for="c-42007791">[-]</label><label class="expand" for="c-42007791">[1 more]</label></div><br/><div class="children"><div class="content">I would start with the AFL++ documentation (<a href="https:&#x2F;&#x2F;aflplus.plus&#x2F;features&#x2F;" rel="nofollow">https:&#x2F;&#x2F;aflplus.plus&#x2F;features&#x2F;</a>), and an open source program that you want to fuzz.  The easiest programs to fuzz with AFL are ones that parse a file format from the command line, the smaller the better and written in C or C++ (just for ease of recompiling with instrumentation).<p>Parsing network protocols and ABIs is possible, but usually requires a fair amount of coding.</div><br/></div></div><div id="42008384" class="c"><input type="checkbox" id="c-42008384" checked=""/><div class="controls bullet"><span class="by">r9295</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42007791">prev</a><span>|</span><a href="#42010150">next</a><span>|</span><label class="collapse" for="c-42008384">[-]</label><label class="expand" for="c-42008384">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;antonio-morales&#x2F;Fuzzing101">https:&#x2F;&#x2F;github.com&#x2F;antonio-morales&#x2F;Fuzzing101</a><p>Is a good course</div><br/></div></div><div id="42010150" class="c"><input type="checkbox" id="c-42010150" checked=""/><div class="controls bullet"><span class="by">mtlynch</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42008384">prev</a><span>|</span><a href="#42013655">next</a><span>|</span><label class="collapse" for="c-42010150">[-]</label><label class="expand" for="c-42010150">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m learning about fuzzing too, and I just wrote a tutorial about what I learned so far.[0]<p>The issue I found with a lot of fuzzing tutorials is that they&#x27;re difficult to reproduce because there&#x27;s a lot of work in setting up the environment and toolchain. In my tutorial, you can kick off fuzzing with one command, but I also walk through how I created the workflow step by step.<p>[0] <a href="https:&#x2F;&#x2F;mtlynch.io&#x2F;nix-fuzz-testing-1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;mtlynch.io&#x2F;nix-fuzz-testing-1&#x2F;</a></div><br/></div></div><div id="42013655" class="c"><input type="checkbox" id="c-42013655" checked=""/><div class="controls bullet"><span class="by">mobscenez</span><span>|</span><a href="#42007746">parent</a><span>|</span><a href="#42010150">prev</a><span>|</span><a href="#42007506">next</a><span>|</span><label class="collapse" for="c-42013655">[-]</label><label class="expand" for="c-42013655">[1 more]</label></div><br/><div class="children"><div class="content">Andreas Zeller has written a great online fuzzing book covering different SOTA fuzzing techniques: <a href="https:&#x2F;&#x2F;www.fuzzingbook.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.fuzzingbook.org&#x2F;</a></div><br/></div></div></div></div><div id="42007506" class="c"><input type="checkbox" id="c-42007506" checked=""/><div class="controls bullet"><span class="by">grumbelbart2</span><span>|</span><a href="#42007746">prev</a><span>|</span><a href="#42009485">next</a><span>|</span><label class="collapse" for="c-42007506">[-]</label><label class="expand" for="c-42007506">[4 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t quite follow the input - does this mean they created Barcodes or Data Codes that crashed the library? I.e. something that I can print out and that might break a few devices if printed on, for example, my luggage before checking it in?</div><br/><div id="42007594" class="c"><input type="checkbox" id="c-42007594" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><a href="#42007506">parent</a><span>|</span><a href="#42007544">next</a><span>|</span><label class="collapse" for="c-42007594">[-]</label><label class="expand" for="c-42007594">[1 more]</label></div><br/><div class="children"><div class="content">Crashing the library - and potential arbitrary code execution!<p>However, zbar isn&#x27;t used all that widely in industry. The airport&#x27;s baggage handling system is much more likely to have a self-contained scanner from Cognex or Omron or Zebra running propriety, closed-source software.</div><br/></div></div><div id="42007544" class="c"><input type="checkbox" id="c-42007544" checked=""/><div class="controls bullet"><span class="by">EvanAnderson</span><span>|</span><a href="#42007506">parent</a><span>|</span><a href="#42007594">prev</a><span>|</span><a href="#42009485">next</a><span>|</span><label class="collapse" for="c-42007544">[-]</label><label class="expand" for="c-42007544">[2 more]</label></div><br/><div class="children"><div class="content">You got it. Crashing the device where the barcode is being interpreted (and possible getting arbitrary code execution).<p>Secondarily, there&#x27;s probably also a rich vein to be mined scanning barcodes like &quot;&#x27;); DROP TABLE Item&quot; that would exploit systems further up the chain. That&#x27;s not what this article is covering (since they&#x27;re just looking at the barcode scanning library).<p>There would be some fun in carrying around a bunch of &quot;edge case&quot; barcodes (&quot;programming&quot; barcodes for various kinds of scanners, SQL injection attacks, etc) and feeding them to unsupervised barcode scanners &quot;in the wild&quot; to see what happens.</div><br/><div id="42008848" class="c"><input type="checkbox" id="c-42008848" checked=""/><div class="controls bullet"><span class="by">OkGoDoIt</span><span>|</span><a href="#42007506">root</a><span>|</span><a href="#42007544">parent</a><span>|</span><a href="#42009485">next</a><span>|</span><label class="collapse" for="c-42008848">[-]</label><label class="expand" for="c-42008848">[1 more]</label></div><br/><div class="children"><div class="content">My interpretation of the original article is they use the fuzzer to find an arbitrary very small bitmap input which when passed to the library causes it to crash. It’s unclear if the input image is even a valid bitmap image format that would correctly open in an image viewer.<p>This is definitely still a problem because there might be situations where you’re allowing an end user to pass an image file in and are then passing it unmodified to this library to interpret the barcode in it, but it’s not the same as some special barcode that encodes data that crashes the library.<p>So for example this blog entry does not describe a situation where you can just print out a barcode and when you scan the barcode then the library crashes or has the opportunity for arbitrary code execution. That would be a very exciting exploit. They don’t actually rule out the possibility, but they didn’t get anywhere near fuzzing at that level in this blog post.</div><br/></div></div></div></div></div></div><div id="42009485" class="c"><input type="checkbox" id="c-42009485" checked=""/><div class="controls bullet"><span class="by">azeirah</span><span>|</span><a href="#42007506">prev</a><span>|</span><a href="#42007808">next</a><span>|</span><label class="collapse" for="c-42009485">[-]</label><label class="expand" for="c-42009485">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m working with barcode scanners and difficulties handling a variety of inputs.<p>My boss keeps telling me &quot;it&#x27;s not that difficult&quot;. I keep telling him &quot;it&#x27;s more difficult than you believe&quot;.</div><br/></div></div><div id="42007808" class="c"><input type="checkbox" id="c-42007808" checked=""/><div class="controls bullet"><span class="by">orng</span><span>|</span><a href="#42009485">prev</a><span>|</span><a href="#42010111">next</a><span>|</span><label class="collapse" for="c-42007808">[-]</label><label class="expand" for="c-42007808">[1 more]</label></div><br/><div class="children"><div class="content">Only slightly related but on the topic of barcodes and security I&#x27;d like to recommend this excellent talk by Felix Lindner, it is quite a few years old but I&#x27;d guess stuff like barcode scanners are not the most frequently updated things:<p>Toying with barcodes - <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=QCtdEYnlykA" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=QCtdEYnlykA</a></div><br/></div></div><div id="42010111" class="c"><input type="checkbox" id="c-42010111" checked=""/><div class="controls bullet"><span class="by">af3d</span><span>|</span><a href="#42007808">prev</a><span>|</span><a href="#42007851">next</a><span>|</span><label class="collapse" for="c-42010111">[-]</label><label class="expand" for="c-42010111">[2 more]</label></div><br/><div class="children"><div class="content">Kind of sad to see that the library &quot;custodian&quot; as it were seemingly uninterested in fixing the software in question. This may not effect most commercial scanners but the fact that it is even out there in wild is a bit disconcerting to say the least. Just another &quot;brick in the wall&quot; insofar as supply-chain (in)security goes....</div><br/><div id="42010201" class="c"><input type="checkbox" id="c-42010201" checked=""/><div class="controls bullet"><span class="by">alex_suzuki</span><span>|</span><a href="#42010111">parent</a><span>|</span><a href="#42007851">next</a><span>|</span><label class="collapse" for="c-42010201">[-]</label><label class="expand" for="c-42010201">[1 more]</label></div><br/><div class="children"><div class="content">There could be any number of reasons for that apart from negligence. AFAIK it’s a single person, so „bus factor“ comes to mind.</div><br/></div></div></div></div><div id="42010010" class="c"><input type="checkbox" id="c-42010010" checked=""/><div class="controls bullet"><span class="by">Aloha</span><span>|</span><a href="#42007851">prev</a><span>|</span><label class="collapse" for="c-42010010">[-]</label><label class="expand" for="c-42010010">[2 more]</label></div><br/><div class="children"><div class="content">See, I&#x27;ve never tried to do barcode decoding in software via images - I&#x27;ve always used an imager with internal decoding.</div><br/><div id="42013540" class="c"><input type="checkbox" id="c-42013540" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#42010010">parent</a><span>|</span><label class="collapse" for="c-42013540">[-]</label><label class="expand" for="c-42013540">[1 more]</label></div><br/><div class="children"><div class="content">That just punts to software in the device. That... <i>could</i> be better if it&#x27;s contained to the device, but that&#x27;s a big if, and even then the problem can still occur, it&#x27;s just that you hope the damage is limited to needing to restart the device or so.</div><br/></div></div></div></div></div></div></div></div></div></body></html>