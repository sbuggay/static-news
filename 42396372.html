<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1733994055633" as="style"/><link rel="stylesheet" href="styles.css?v=1733994055633"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://nicholas.carlini.com/writing/2023/chat-gpt-2-in-c.html">A ChatGPT clone, in 3000 bytes of C, backed by GPT-2 (2023)</a> <span class="domain">(<a href="https://nicholas.carlini.com">nicholas.carlini.com</a>)</span></div><div class="subtext"><span>chubot</span> | <span>39 comments</span></div><br/><div><div id="42396828" class="c"><input type="checkbox" id="c-42396828" checked=""/><div class="controls bullet"><span class="by">ethan-j</span><span>|</span><a href="#42396912">next</a><span>|</span><label class="collapse" for="c-42396828">[-]</label><label class="expand" for="c-42396828">[4 more]</label></div><br/><div class="children"><div class="content">At least it&#x27;s kind of a conversation.<p>bash .&#x2F;run.sh<p>AI: How can I help you?
Human: who are you
AI: I am alice.
Human: what can you do for me?
AI: I can help you.
Human: how to say bird in Chinese?
AI: bird in Chinese.
Human: 2+2=?
AI: 2+2= bird.</div><br/><div id="42397389" class="c"><input type="checkbox" id="c-42397389" checked=""/><div class="controls bullet"><span class="by">yard2010</span><span>|</span><a href="#42396828">parent</a><span>|</span><a href="#42397362">next</a><span>|</span><label class="collapse" for="c-42397389">[-]</label><label class="expand" for="c-42397389">[2 more]</label></div><br/><div class="children"><div class="content">How long would it take for people to accept this as the ground truth fighting and dying for this, starting the next cult&#x2F;religion?</div><br/><div id="42397420" class="c"><input type="checkbox" id="c-42397420" checked=""/><div class="controls bullet"><span class="by">kandros</span><span>|</span><a href="#42396828">root</a><span>|</span><a href="#42397389">parent</a><span>|</span><a href="#42397362">next</a><span>|</span><label class="collapse" for="c-42397420">[-]</label><label class="expand" for="c-42397420">[1 more]</label></div><br/><div class="children"><div class="content">All hail the 4 bird</div><br/></div></div></div></div><div id="42397362" class="c"><input type="checkbox" id="c-42397362" checked=""/><div class="controls bullet"><span class="by">dogboat</span><span>|</span><a href="#42396828">parent</a><span>|</span><a href="#42397389">prev</a><span>|</span><a href="#42396912">next</a><span>|</span><label class="collapse" for="c-42397362">[-]</label><label class="expand" for="c-42397362">[1 more]</label></div><br/><div class="children"><div class="content">This is what it was like to live in 2019</div><br/></div></div></div></div><div id="42396912" class="c"><input type="checkbox" id="c-42396912" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#42396828">prev</a><span>|</span><a href="#42397265">next</a><span>|</span><label class="collapse" for="c-42396912">[-]</label><label class="expand" for="c-42396912">[7 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the point of minifying code that is anyways going to be compiled?</div><br/><div id="42397295" class="c"><input type="checkbox" id="c-42397295" checked=""/><div class="controls bullet"><span class="by">kgwgk</span><span>|</span><a href="#42396912">parent</a><span>|</span><a href="#42396965">next</a><span>|</span><label class="collapse" for="c-42397295">[-]</label><label class="expand" for="c-42397295">[1 more]</label></div><br/><div class="children"><div class="content">People ask me, &#x27;What is the use of climbing Mount Everest?&#x27; and my answer must at once be, &#x27;It is of no use.&#x27; There is not the slightest prospect of any gain whatsoever. Oh, we may learn a little about the behavior of the human body at high altitudes, and possibly medical men may turn our observation to some account for the purposes of aviation. But otherwise nothing will come of it. We shall not bring back a single bit of gold or silver, not a gem, nor any coal or iron.<p>If you cannot understand that there is something in man which responds to the challenge of this mountain and goes out to meet it, that the struggle is the struggle of life itself upward and forever upward, then you won&#x27;t see why we go. What we get from this adventure is just sheer joy. And joy is, after all, the end of life. We do not live to eat and make money. We eat and make money to be able to live. That is what life means and what life is for.<p>--<p>George Mallory</div><br/></div></div><div id="42396965" class="c"><input type="checkbox" id="c-42396965" checked=""/><div class="controls bullet"><span class="by">byzantinegene</span><span>|</span><a href="#42396912">parent</a><span>|</span><a href="#42397295">prev</a><span>|</span><a href="#42397143">next</a><span>|</span><label class="collapse" for="c-42396965">[-]</label><label class="expand" for="c-42396965">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m assuming 3000 bytes refers to the uncompiled minified code</div><br/><div id="42396980" class="c"><input type="checkbox" id="c-42396980" checked=""/><div class="controls bullet"><span class="by">exac</span><span>|</span><a href="#42396912">root</a><span>|</span><a href="#42396965">parent</a><span>|</span><a href="#42397143">next</a><span>|</span><label class="collapse" for="c-42396980">[-]</label><label class="expand" for="c-42396980">[3 more]</label></div><br/><div class="children"><div class="content">Indeed, and the question is why do that? We can count LOCs just fine already.</div><br/><div id="42397038" class="c"><input type="checkbox" id="c-42397038" checked=""/><div class="controls bullet"><span class="by">thrw42A8N</span><span>|</span><a href="#42396912">root</a><span>|</span><a href="#42396980">parent</a><span>|</span><a href="#42397143">next</a><span>|</span><label class="collapse" for="c-42397038">[-]</label><label class="expand" for="c-42397038">[2 more]</label></div><br/><div class="children"><div class="content">Because it&#x27;d be very hard to compare short program length otherwise? 5 LoC says nothing.</div><br/><div id="42397398" class="c"><input type="checkbox" id="c-42397398" checked=""/><div class="controls bullet"><span class="by">ffsm8</span><span>|</span><a href="#42396912">root</a><span>|</span><a href="#42397038">parent</a><span>|</span><a href="#42397143">next</a><span>|</span><label class="collapse" for="c-42397398">[-]</label><label class="expand" for="c-42397398">[1 more]</label></div><br/><div class="children"><div class="content">Technically, it depends on the language. I.e. python doesn&#x27;t have anything like a semicolon to combine multiple statements and assignments per line<p>But yeah, for C the LOC metric can be gamed to a silly degree</div><br/></div></div></div></div></div></div></div></div><div id="42397143" class="c"><input type="checkbox" id="c-42397143" checked=""/><div class="controls bullet"><span class="by">heinrichhartman</span><span>|</span><a href="#42396912">parent</a><span>|</span><a href="#42396965">prev</a><span>|</span><a href="#42397265">next</a><span>|</span><label class="collapse" for="c-42397143">[-]</label><label class="expand" for="c-42397143">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the point of art?</div><br/></div></div></div></div><div id="42397265" class="c"><input type="checkbox" id="c-42397265" checked=""/><div class="controls bullet"><span class="by">ljouhet</span><span>|</span><a href="#42396912">prev</a><span>|</span><a href="#42396568">next</a><span>|</span><label class="collapse" for="c-42397265">[-]</label><label class="expand" for="c-42397265">[1 more]</label></div><br/><div class="children"><div class="content">I love the way it&#x27;s written: see this ChatGPT-like code that fits in your screen? Let&#x27;s break it down!</div><br/></div></div><div id="42396568" class="c"><input type="checkbox" id="c-42396568" checked=""/><div class="controls bullet"><span class="by">hmottestad</span><span>|</span><a href="#42397265">prev</a><span>|</span><a href="#42396595">next</a><span>|</span><label class="collapse" for="c-42396568">[-]</label><label class="expand" for="c-42396568">[4 more]</label></div><br/><div class="children"><div class="content">Is GPT-2 instruction tuned so that it can actually be used for chat? Otherwise I feel it’s more than just a stretch to call this a ChatGPT clone.</div><br/><div id="42396822" class="c"><input type="checkbox" id="c-42396822" checked=""/><div class="controls bullet"><span class="by">motorest</span><span>|</span><a href="#42396568">parent</a><span>|</span><a href="#42396595">next</a><span>|</span><label class="collapse" for="c-42396822">[-]</label><label class="expand" for="c-42396822">[3 more]</label></div><br/><div class="children"><div class="content">From the article:<p>&gt; You can then use this to create something like Chat GPT---just so long as you don&#x27;t care about the quality of the output. (It&#x27;s actually pretty terrible output, objectively speaking... But it does run.)<p>It&#x27;s unusable and bears no relationship other than the name-dropping. But it&#x27;s a program that compiles and runs.<p>By the looks of those in this discussion who are giving high praises about the capabilities of a project whose author admittedly states it doesn&#x27;t really work, I guess the point is using buzzwords to bait the bandwagon types.</div><br/><div id="42397228" class="c"><input type="checkbox" id="c-42397228" checked=""/><div class="controls bullet"><span class="by">zanderwohl</span><span>|</span><a href="#42396568">root</a><span>|</span><a href="#42396822">parent</a><span>|</span><a href="#42396909">next</a><span>|</span><label class="collapse" for="c-42397228">[-]</label><label class="expand" for="c-42397228">[1 more]</label></div><br/><div class="children"><div class="content">People &quot;demake&quot; games all the time. Nobody complains if those games are missing most of the features of the original because the core gameplay loop (the essence) is the same. That&#x27;s the point here -- you can make a small-scale, low-resolution version of a major program in a very small space.<p>&gt; By the looks of those in this discussion who are giving high praises about the capabilities of a project whose author admittedly states it doesn&#x27;t really work, I guess the point is using buzzwords to bait the bandwagon types.<p>Instead of assuming everyone else is naive, perhaps consider another perspective?</div><br/></div></div><div id="42396909" class="c"><input type="checkbox" id="c-42396909" checked=""/><div class="controls bullet"><span class="by">bippihippi1</span><span>|</span><a href="#42396568">root</a><span>|</span><a href="#42396822">parent</a><span>|</span><a href="#42397228">prev</a><span>|</span><a href="#42396595">next</a><span>|</span><label class="collapse" for="c-42396909">[-]</label><label class="expand" for="c-42396909">[1 more]</label></div><br/><div class="children"><div class="content">the point seems to be making a small binary to run language model.
How useful is that?
From a functional perspective, I guess not very but the model can be improved.
From a performance &#x2F; cost perspective, also not very because most of the cost is in training the model and small binary isn&#x27;t necessarily indicative of quick.
I guess it&#x27;s just kind of interesting that it doesn&#x27;t take that much code to run the model.</div><br/></div></div></div></div></div></div><div id="42396595" class="c"><input type="checkbox" id="c-42396595" checked=""/><div class="controls bullet"><span class="by">hilti</span><span>|</span><a href="#42396568">prev</a><span>|</span><a href="#42396809">next</a><span>|</span><label class="collapse" for="c-42396595">[-]</label><label class="expand" for="c-42396595">[4 more]</label></div><br/><div class="children"><div class="content">I haven‘t run the code, but I‘m impressed by the small size. The first ELISA programs have been larger. And within the past 4 years we can fit this into bytes.<p>If someone has a hint where the magic lies in, please explain it to me.
Is it the GELU function or the model that‘s
downloaded through the bash script?</div><br/><div id="42396954" class="c"><input type="checkbox" id="c-42396954" checked=""/><div class="controls bullet"><span class="by">01HNNWZ0MV43FF</span><span>|</span><a href="#42396595">parent</a><span>|</span><a href="#42397444">next</a><span>|</span><label class="collapse" for="c-42396954">[-]</label><label class="expand" for="c-42396954">[2 more]</label></div><br/><div class="children"><div class="content">Most of the magic is in the 475 MB model file downloaded through the Bash script.</div><br/><div id="42397370" class="c"><input type="checkbox" id="c-42397370" checked=""/><div class="controls bullet"><span class="by">dogboat</span><span>|</span><a href="#42396595">root</a><span>|</span><a href="#42396954">parent</a><span>|</span><a href="#42397444">next</a><span>|</span><label class="collapse" for="c-42397370">[-]</label><label class="expand" for="c-42397370">[1 more]</label></div><br/><div class="children"><div class="content">And probably like 100Gb of training data or whatever :). HN had a heady debate at least once about if that training data is source or not.</div><br/></div></div></div></div><div id="42397444" class="c"><input type="checkbox" id="c-42397444" checked=""/><div class="controls bullet"><span class="by">hilti</span><span>|</span><a href="#42396595">parent</a><span>|</span><a href="#42396954">prev</a><span>|</span><a href="#42396809">next</a><span>|</span><label class="collapse" for="c-42397444">[-]</label><label class="expand" for="c-42397444">[1 more]</label></div><br/><div class="children"><div class="content">Not really impressed after running it.<p>AI: How can I help you?
Human: Who are you?
AI: I am Alice.
Human: Tell me something about a computer.
AI: I am a computer model trained by OpenAI. How can I help you?
Human: What is a computer?
AI: I am a computer model trained by OpenAI. How can I help you?
Human: Explain mathematical addition.
AI: Explain mathematical multiplication.
Human: 2+2
AI: 2+2
Human: Sum 2+2
AI: Sum 2+2
Human: What are your capabilities?
AI: I am a computer model trained by OpenAI. How can I help you.</div><br/></div></div></div></div><div id="42396809" class="c"><input type="checkbox" id="c-42396809" checked=""/><div class="controls bullet"><span class="by">go_prodev</span><span>|</span><a href="#42396595">prev</a><span>|</span><a href="#42396760">next</a><span>|</span><label class="collapse" for="c-42396809">[-]</label><label class="expand" for="c-42396809">[3 more]</label></div><br/><div class="children"><div class="content">GELU really is like magic:<p>UNARY(GELU, b &#x2F; 2 * (1 + tanh(.7978845 * (b + .044715 * b * b * b))))</div><br/><div id="42397421" class="c"><input type="checkbox" id="c-42397421" checked=""/><div class="controls bullet"><span class="by">jey</span><span>|</span><a href="#42396809">parent</a><span>|</span><a href="#42397379">next</a><span>|</span><label class="collapse" for="c-42397421">[-]</label><label class="expand" for="c-42397421">[1 more]</label></div><br/><div class="children"><div class="content">This is just a practical approximation to the actual mathematical definition of GELU, which is `GELU(x) := x * Φ(x)` where Φ(x) is the CDF of the Gaussian distribution.</div><br/></div></div><div id="42397379" class="c"><input type="checkbox" id="c-42397379" checked=""/><div class="controls bullet"><span class="by">dogboat</span><span>|</span><a href="#42396809">parent</a><span>|</span><a href="#42397421">prev</a><span>|</span><a href="#42396760">next</a><span>|</span><label class="collapse" for="c-42397379">[-]</label><label class="expand" for="c-42397379">[1 more]</label></div><br/><div class="children"><div class="content">Fast inverse square root lookalike.</div><br/></div></div></div></div><div id="42396760" class="c"><input type="checkbox" id="c-42396760" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#42396809">prev</a><span>|</span><a href="#42396648">next</a><span>|</span><label class="collapse" for="c-42396760">[-]</label><label class="expand" for="c-42396760">[1 more]</label></div><br/><div class="children"><div class="content">&gt; (TAKE THAT LANGUAGES WITH PROPER MACROS. LISP ISN&#x27;T ALWAYS BETTER THAN C!)<p>Ok, allowed this time as punching up.<p>--<p>If you missed the code link (it&#x27;s buried in the text): <a href="https:&#x2F;&#x2F;github.com&#x2F;carlini&#x2F;c-chat-gpt-2" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;carlini&#x2F;c-chat-gpt-2</a></div><br/></div></div><div id="42396648" class="c"><input type="checkbox" id="c-42396648" checked=""/><div class="controls bullet"><span class="by">boiler_up800</span><span>|</span><a href="#42396760">prev</a><span>|</span><a href="#42396503">next</a><span>|</span><label class="collapse" for="c-42396648">[-]</label><label class="expand" for="c-42396648">[1 more]</label></div><br/><div class="children"><div class="content">Intelligence as a new fundamental layer! These small programs that do so much really inspire me.</div><br/></div></div><div id="42396503" class="c"><input type="checkbox" id="c-42396503" checked=""/><div class="controls bullet"><span class="by">ab_testing</span><span>|</span><a href="#42396648">prev</a><span>|</span><a href="#42396734">next</a><span>|</span><label class="collapse" for="c-42396503">[-]</label><label class="expand" for="c-42396503">[5 more]</label></div><br/><div class="children"><div class="content">Did anybody run it locally to see what kind Of output is generated by this GP2 running locally.</div><br/><div id="42396737" class="c"><input type="checkbox" id="c-42396737" checked=""/><div class="controls bullet"><span class="by">dailykoder</span><span>|</span><a href="#42396503">parent</a><span>|</span><a href="#42396655">next</a><span>|</span><label class="collapse" for="c-42396737">[-]</label><label class="expand" for="c-42396737">[1 more]</label></div><br/><div class="children"><div class="content">Kind of always gives me the same output over and over again. It&#x27;s kinda neat though. Have to look into it and tweak it myself. Wanted to play around with gpt2 locally for quite some time.<p>Thanks for the post!</div><br/></div></div><div id="42396655" class="c"><input type="checkbox" id="c-42396655" checked=""/><div class="controls bullet"><span class="by">genewitch</span><span>|</span><a href="#42396503">parent</a><span>|</span><a href="#42396737">prev</a><span>|</span><a href="#42396734">next</a><span>|</span><label class="collapse" for="c-42396655">[-]</label><label class="expand" for="c-42396655">[3 more]</label></div><br/><div class="children"><div class="content">after reading it, this should output the exact same output as whatever gpt2 model you load normally and in this program, given the same temperature and seed i didn&#x27;t see those myself in the code, but i was mostly trying to figure out why it was obfuscated; i think the unobfuscated code isn&#x27;t too terribly much longer (10,000 chars?) and would still be impressive to behold on a screen.</div><br/><div id="42396798" class="c"><input type="checkbox" id="c-42396798" checked=""/><div class="controls bullet"><span class="by">vunderba</span><span>|</span><a href="#42396503">root</a><span>|</span><a href="#42396655">parent</a><span>|</span><a href="#42396734">next</a><span>|</span><label class="collapse" for="c-42396798">[-]</label><label class="expand" for="c-42396798">[2 more]</label></div><br/><div class="children"><div class="content">The regular code is linked in the article:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;carlini&#x2F;c-chat-gpt-2&#x2F;blob&#x2F;main&#x2F;c_chat_gpt_2.c" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;carlini&#x2F;c-chat-gpt-2&#x2F;blob&#x2F;main&#x2F;c_chat_gpt...</a></div><br/></div></div></div></div></div></div><div id="42396523" class="c"><input type="checkbox" id="c-42396523" checked=""/><div class="controls bullet"><span class="by">tomcam</span><span>|</span><a href="#42396734">prev</a><span>|</span><a href="#42396605">next</a><span>|</span><label class="collapse" for="c-42396523">[-]</label><label class="expand" for="c-42396523">[3 more]</label></div><br/><div class="children"><div class="content">Jart is already hard at work on a version that’s only 2070 bytes but includes a full lisp interpreter for the prompt parser</div><br/><div id="42397424" class="c"><input type="checkbox" id="c-42397424" checked=""/><div class="controls bullet"><span class="by">hilti</span><span>|</span><a href="#42396523">parent</a><span>|</span><a href="#42396600">next</a><span>|</span><label class="collapse" for="c-42397424">[-]</label><label class="expand" for="c-42397424">[1 more]</label></div><br/><div class="children"><div class="content">Never heard of Jart - who or what is it?</div><br/></div></div><div id="42396600" class="c"><input type="checkbox" id="c-42396600" checked=""/><div class="controls bullet"><span class="by">cowsaymoo</span><span>|</span><a href="#42396523">parent</a><span>|</span><a href="#42397424">prev</a><span>|</span><a href="#42396605">next</a><span>|</span><label class="collapse" for="c-42396600">[-]</label><label class="expand" for="c-42396600">[1 more]</label></div><br/><div class="children"><div class="content">That fits inside a QR code. Artificial brain scan.</div><br/></div></div></div></div><div id="42396605" class="c"><input type="checkbox" id="c-42396605" checked=""/><div class="controls bullet"><span class="by">tgma</span><span>|</span><a href="#42396523">prev</a><span>|</span><label class="collapse" for="c-42396605">[-]</label><label class="expand" for="c-42396605">[4 more]</label></div><br/><div class="children"><div class="content">TL;DR: code-golf style C program to do inference on an existing TensorFlow model data for GPT2, not full ChatGPT, nor training or anything.</div><br/><div id="42396795" class="c"><input type="checkbox" id="c-42396795" checked=""/><div class="controls bullet"><span class="by">jnwatson</span><span>|</span><a href="#42396605">parent</a><span>|</span><a href="#42396806">next</a><span>|</span><label class="collapse" for="c-42396795">[-]</label><label class="expand" for="c-42396795">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t code golf. This is just white space removed.</div><br/></div></div><div id="42396806" class="c"><input type="checkbox" id="c-42396806" checked=""/><div class="controls bullet"><span class="by">slt2021</span><span>|</span><a href="#42396605">parent</a><span>|</span><a href="#42396795">prev</a><span>|</span><label class="collapse" for="c-42396806">[-]</label><label class="expand" for="c-42396806">[2 more]</label></div><br/><div class="children"><div class="content">more like IOCCC+codegolf style implementation of GPT2<p><a href="http:&#x2F;&#x2F;www.ioccc.org" rel="nofollow">http:&#x2F;&#x2F;www.ioccc.org</a></div><br/><div id="42397149" class="c"><input type="checkbox" id="c-42397149" checked=""/><div class="controls bullet"><span class="by">hnfong</span><span>|</span><a href="#42396605">root</a><span>|</span><a href="#42396806">parent</a><span>|</span><label class="collapse" for="c-42397149">[-]</label><label class="expand" for="c-42397149">[1 more]</label></div><br/><div class="children"><div class="content">There is actually an IOCCC entry in 2019 that does almost exactly this except it’s LSTM instead of transformers: <a href="https:&#x2F;&#x2F;www.ioccc.org&#x2F;2019&#x2F;mills&#x2F;prog.c" rel="nofollow">https:&#x2F;&#x2F;www.ioccc.org&#x2F;2019&#x2F;mills&#x2F;prog.c</a><p><a href="https:&#x2F;&#x2F;www.ioccc.org&#x2F;2019&#x2F;mills&#x2F;hint.html" rel="nofollow">https:&#x2F;&#x2F;www.ioccc.org&#x2F;2019&#x2F;mills&#x2F;hint.html</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>