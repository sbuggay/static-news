<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1726304449836" as="style"/><link rel="stylesheet" href="styles.css?v=1726304449836"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.synacktiv.com/en/publications/defend-against-vampires-with-10-gbps-network-encryption">Defend against vampires with 10 gbps network encryption</a> <span class="domain">(<a href="https://www.synacktiv.com">www.synacktiv.com</a>)</span></div><div class="subtext"><span>alxjsn</span> | <span>56 comments</span></div><br/><div><div id="41533647" class="c"><input type="checkbox" id="c-41533647" checked=""/><div class="controls bullet"><span class="by">andrewla</span><span>|</span><a href="#41538140">next</a><span>|</span><label class="collapse" for="c-41533647">[-]</label><label class="expand" for="c-41533647">[28 more]</label></div><br/><div class="children"><div class="content">I had a friend who worked in federal law enforcement who once described a vampire device that they used. It would clamp around a power cable and inject a UPS in the mix so that an electronic device could be removed without turning it off. Seemed like a useful little trick.</div><br/><div id="41533921" class="c"><input type="checkbox" id="c-41533921" checked=""/><div class="controls bullet"><span class="by">0cf8612b2e1e</span><span>|</span><a href="#41533647">parent</a><span>|</span><a href="#41537769">next</a><span>|</span><label class="collapse" for="c-41533921">[-]</label><label class="expand" for="c-41533921">[15 more]</label></div><br/><div class="children"><div class="content">If nothing else, would let you move a Frogger machine.<p>More seriously, I have wondered if you can detect these kinds of external interference. Auto lock the machine if power&#x2F;network&#x2F;wifi&#x2F;Bluetooth&#x2F;USB conditions change.<p>Nabbing an unlocked laptop was how they got the Silk Road guy (though they probably already had sufficient evidence elsewhere).<p><a href="https:&#x2F;&#x2F;arstechnica.com&#x2F;tech-policy&#x2F;2015&#x2F;05&#x2F;sunk-how-ross-ulbricht-ended-up-in-prison-for-life&#x2F;" rel="nofollow">https:&#x2F;&#x2F;arstechnica.com&#x2F;tech-policy&#x2F;2015&#x2F;05&#x2F;sunk-how-ross-ul...</a></div><br/><div id="41534698" class="c"><input type="checkbox" id="c-41534698" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41533921">parent</a><span>|</span><a href="#41534471">next</a><span>|</span><label class="collapse" for="c-41534698">[-]</label><label class="expand" for="c-41534698">[4 more]</label></div><br/><div class="children"><div class="content">One trick you could use is to abuse the fact that law enforcement often plugs in a mouse wiggler on an unlocked desktop and kill your server the moment you see a new HID device (make sure to run some kind of desktop on your server so they think they can keep the session open, best to do it in a VM).<p>You could also monitor the ethernet link. They can move your server but they can&#x27;t move the entire network, set up an encrypted tunnel between two distant physical servers and self destruct the moment that tunnel gets disrupted.<p>Some computers come with gyros&#x2F;accelerometers built in. My old HP laptop had some kind of head crash prevention that used that hardware. I know this, because Gnome thought it was a tablet style sensor and turned my screen upside down if I didn&#x27;t disable the sensor. Maybe getting a HP server can already get you a whole bunch of movement sensors.<p>You could probably figure out if the server is being moved by measuring capacitance of the case, measuring accelerometers, maybe add a GPS dongle. Or you could add an LTE connector and measure any signals you may receive that you shouldn&#x27;t from inside a server room. You can probably measure _something_ in the server room, though, so to make sure your LTE dongle doesn&#x27;t get interrupted, also measure whatever reliable signal you can find to detect Faraday cages.<p>Lastly, you could put a video camera in the case on all sides and measure changes. Detecting law enforcement badges probably isn&#x27;t that hard with opencv if you&#x27;re dedicated enough.<p>You have to hide your security measures and never tell anyone, though, or they&#x27;ll just leave the server as-is and use the classic rubber hose exploit to make you give up the key material.</div><br/><div id="41535766" class="c"><input type="checkbox" id="c-41535766" checked=""/><div class="controls bullet"><span class="by">tbrownaw</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534698">parent</a><span>|</span><a href="#41536920">next</a><span>|</span><label class="collapse" for="c-41535766">[-]</label><label class="expand" for="c-41535766">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Or you could add an LTE connector and measure any signals you may receive that you shouldn&#x27;t from inside a server room.</i><p>Incoming Bluetooth Low Energy announcements should have a receive power level associated with them. Stick a beacon (like say a standard ble temperature&#x2F;humidity sensor) somewhere, and you should be able to tell if the distance to it changes.</div><br/></div></div><div id="41536920" class="c"><input type="checkbox" id="c-41536920" checked=""/><div class="controls bullet"><span class="by">gosub100</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534698">parent</a><span>|</span><a href="#41535766">prev</a><span>|</span><a href="#41536607">next</a><span>|</span><label class="collapse" for="c-41536920">[-]</label><label class="expand" for="c-41536920">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;defuse&#x2F;swatd">https:&#x2F;&#x2F;github.com&#x2F;defuse&#x2F;swatd</a></div><br/></div></div><div id="41536607" class="c"><input type="checkbox" id="c-41536607" checked=""/><div class="controls bullet"><span class="by">Onavo</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534698">parent</a><span>|</span><a href="#41536920">prev</a><span>|</span><a href="#41534471">next</a><span>|</span><label class="collapse" for="c-41536607">[-]</label><label class="expand" for="c-41536607">[1 more]</label></div><br/><div class="children"><div class="content">All these suggestions are so unreliable. What happened to HN? This is 2024, have some creativity. Feed all the surrounding cameras and mics into a massive neural network and you have a more robust solution than anything else. Just make sure you don&#x27;t cosplay (or roleplay too much during sex) as a hobby.<p><pre><code>   P(cop in the house | cameras and mic and sensor data)
</code></pre>
It&#x27;s not like America lacks finetuning data for cop shows and swatting videos.</div><br/></div></div></div></div><div id="41534471" class="c"><input type="checkbox" id="c-41534471" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41533921">parent</a><span>|</span><a href="#41534698">prev</a><span>|</span><a href="#41536952">next</a><span>|</span><label class="collapse" for="c-41534471">[-]</label><label class="expand" for="c-41534471">[7 more]</label></div><br/><div class="children"><div class="content">Maybe attack the problem from a different angle: use an accelerometer.  Or spend a little bit more money to add a gyro and make a real, if very low accuracy, IMU.</div><br/><div id="41534588" class="c"><input type="checkbox" id="c-41534588" checked=""/><div class="controls bullet"><span class="by">0cf8612b2e1e</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534471">parent</a><span>|</span><a href="#41537472">next</a><span>|</span><label class="collapse" for="c-41534588">[-]</label><label class="expand" for="c-41534588">[1 more]</label></div><br/><div class="children"><div class="content">That is a great suggestion. I think Android just implemented a “snatch detection” system for phones. Although, I like the idea of not requiring additional hardware. I guess when I start running a drug empire I will have to pony up for the extra dongle.</div><br/></div></div><div id="41537472" class="c"><input type="checkbox" id="c-41537472" checked=""/><div class="controls bullet"><span class="by">mcpherrinm</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534471">parent</a><span>|</span><a href="#41534588">prev</a><span>|</span><a href="#41535204">next</a><span>|</span><label class="collapse" for="c-41537472">[-]</label><label class="expand" for="c-41537472">[1 more]</label></div><br/><div class="children"><div class="content">Some HSMs I&#x27;ve used (payshields) have tamper sensors that can detect motion for this reason.<p>&gt; The ADXL362 accelerometer in the PayShield 10K acts as a &quot;Motion Sensor&quot; detecting tilt movements. An alarm triggers an alert if the HSM is moved (for example, slid out of the rack)</div><br/></div></div><div id="41535204" class="c"><input type="checkbox" id="c-41535204" checked=""/><div class="controls bullet"><span class="by">TimeBearingDown</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534471">parent</a><span>|</span><a href="#41537472">prev</a><span>|</span><a href="#41534502">next</a><span>|</span><label class="collapse" for="c-41535204">[-]</label><label class="expand" for="c-41535204">[1 more]</label></div><br/><div class="children"><div class="content">BusKill was created for this, USB with a magnetic attachment to a keyring that can be configured to take action on disconnect.</div><br/></div></div><div id="41534502" class="c"><input type="checkbox" id="c-41534502" checked=""/><div class="controls bullet"><span class="by">adgjlsfhk1</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534471">parent</a><span>|</span><a href="#41535204">prev</a><span>|</span><a href="#41535021">next</a><span>|</span><label class="collapse" for="c-41534502">[-]</label><label class="expand" for="c-41534502">[2 more]</label></div><br/><div class="children"><div class="content">Seems like an mems accelerometer would be all you need. Rotation isn&#x27;t really a threat...</div><br/><div id="41534629" class="c"><input type="checkbox" id="c-41534629" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534502">parent</a><span>|</span><a href="#41535021">next</a><span>|</span><label class="collapse" for="c-41534629">[-]</label><label class="expand" for="c-41534629">[1 more]</label></div><br/><div class="children"><div class="content">Rotation itself isn’t a threat, but if you want to directly estimate displacement to distinguish between earthquakes and someone stealing the machine, without relying on heuristics, actual inertial measurement would do the trick. And inertial measurement involves tracking the direction of acceleration, which involves tracking rotation.</div><br/></div></div></div></div><div id="41535021" class="c"><input type="checkbox" id="c-41535021" checked=""/><div class="controls bullet"><span class="by">TeeMassive</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534471">parent</a><span>|</span><a href="#41534502">prev</a><span>|</span><a href="#41536952">next</a><span>|</span><label class="collapse" for="c-41535021">[-]</label><label class="expand" for="c-41535021">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a great idea. Authorizing any kind of physical change should be a default security measures.</div><br/></div></div></div></div><div id="41536952" class="c"><input type="checkbox" id="c-41536952" checked=""/><div class="controls bullet"><span class="by">dullcrisp</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41533921">parent</a><span>|</span><a href="#41534471">prev</a><span>|</span><a href="#41533976">next</a><span>|</span><label class="collapse" for="c-41536952">[-]</label><label class="expand" for="c-41536952">[1 more]</label></div><br/><div class="children"><div class="content">If they’re seizing your laptop and your laptop will only work inside your house, wouldn’t they just seize your whole house?</div><br/></div></div><div id="41533976" class="c"><input type="checkbox" id="c-41533976" checked=""/><div class="controls bullet"><span class="by">MertsA</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41533921">parent</a><span>|</span><a href="#41536952">prev</a><span>|</span><a href="#41537769">next</a><span>|</span><label class="collapse" for="c-41533976">[-]</label><label class="expand" for="c-41533976">[2 more]</label></div><br/><div class="children"><div class="content">Wifi would probably be the easiest. Either hide a dummy AP in the house or use a combination of multiple neighbors APs. If you don&#x27;t see any beacon frames from the dummy SSID for a 30 second period then lock&#x2F;shred the computer.</div><br/><div id="41534134" class="c"><input type="checkbox" id="c-41534134" checked=""/><div class="controls bullet"><span class="by">justsomehnguy</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41533976">parent</a><span>|</span><a href="#41537769">next</a><span>|</span><label class="collapse" for="c-41534134">[-]</label><label class="expand" for="c-41534134">[1 more]</label></div><br/><div class="children"><div class="content">Wifi 5&#x2F;6 sometimes rake up to a couple of minutes to get online (DFS and whatever) so 30 seconds is like smoking near an open can of gasoline: mostly fine but when it&#x27;s not...</div><br/></div></div></div></div></div></div><div id="41537769" class="c"><input type="checkbox" id="c-41537769" checked=""/><div class="controls bullet"><span class="by">sschueller</span><span>|</span><a href="#41533647">parent</a><span>|</span><a href="#41533921">prev</a><span>|</span><a href="#41534496">next</a><span>|</span><label class="collapse" for="c-41537769">[-]</label><label class="expand" for="c-41537769">[1 more]</label></div><br/><div class="children"><div class="content">That is why you put in special outlets that communicate with the PC over the power line encrypted.<p>You would need to drill holes in the concrete wall to get to the power lines in the wall in order to take the outlet along and hope that there isn&#x27;t an additional device in the breaker panel.</div><br/></div></div><div id="41534496" class="c"><input type="checkbox" id="c-41534496" checked=""/><div class="controls bullet"><span class="by">cruffle_duffle</span><span>|</span><a href="#41533647">parent</a><span>|</span><a href="#41537769">prev</a><span>|</span><a href="#41536113">next</a><span>|</span><label class="collapse" for="c-41534496">[-]</label><label class="expand" for="c-41534496">[3 more]</label></div><br/><div class="children"><div class="content">Isn’t that kinda what they used for Ross Ulbright’s computer? I know it was a laptop but they probably didn’t want to take chances given if that thing shut down the entire thing would be encrypted?</div><br/><div id="41534511" class="c"><input type="checkbox" id="c-41534511" checked=""/><div class="controls bullet"><span class="by">andrewla</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534496">parent</a><span>|</span><a href="#41536113">next</a><span>|</span><label class="collapse" for="c-41534511">[-]</label><label class="expand" for="c-41534511">[2 more]</label></div><br/><div class="children"><div class="content">I thought they had an attractive agent distract him for a moment while another agent grabbed his still-unlocked-and-open laptop to prevent him from locking it or closing it up. At least I think that was the cloak-and-dagger story I heard.</div><br/><div id="41536915" class="c"><input type="checkbox" id="c-41536915" checked=""/><div class="controls bullet"><span class="by">gosub100</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534511">parent</a><span>|</span><a href="#41536113">next</a><span>|</span><label class="collapse" for="c-41536915">[-]</label><label class="expand" for="c-41536915">[1 more]</label></div><br/><div class="children"><div class="content">two agents posing as a couple feigned a raucous quarrel that distracted him, while a third agent sitting across the table yanked the laptop at the precise moment he was distracted</div><br/></div></div></div></div></div></div><div id="41536113" class="c"><input type="checkbox" id="c-41536113" checked=""/><div class="controls bullet"><span class="by">immibis</span><span>|</span><a href="#41533647">parent</a><span>|</span><a href="#41534496">prev</a><span>|</span><a href="#41534283">next</a><span>|</span><label class="collapse" for="c-41536113">[-]</label><label class="expand" for="c-41536113">[1 more]</label></div><br/><div class="children"><div class="content">Someone successfully did this for copper gigabit ethernet and presented at one of the security conferences - but with a few milliseconds interruption in signal.</div><br/></div></div><div id="41534283" class="c"><input type="checkbox" id="c-41534283" checked=""/><div class="controls bullet"><span class="by">the_real_cher</span><span>|</span><a href="#41533647">parent</a><span>|</span><a href="#41536113">prev</a><span>|</span><a href="#41538140">next</a><span>|</span><label class="collapse" for="c-41534283">[-]</label><label class="expand" for="c-41534283">[7 more]</label></div><br/><div class="children"><div class="content">So it would emulate a UPS?<p>So they could just remove the existing UPS?<p>what is inject a UPS?</div><br/><div id="41534371" class="c"><input type="checkbox" id="c-41534371" checked=""/><div class="controls bullet"><span class="by">amiga-workbench</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534283">parent</a><span>|</span><a href="#41538140">next</a><span>|</span><label class="collapse" for="c-41534371">[-]</label><label class="expand" for="c-41534371">[6 more]</label></div><br/><div class="children"><div class="content">Its a parasitic tap that connects to the mains power cable going into the device.
It then phase locks an inverter with said mains power, allowing the mains power cable to be unplugged and the whole lot transported elsewhere on battery power.</div><br/><div id="41534436" class="c"><input type="checkbox" id="c-41534436" checked=""/><div class="controls bullet"><span class="by">amelius</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534371">parent</a><span>|</span><a href="#41538140">next</a><span>|</span><label class="collapse" for="c-41534436">[-]</label><label class="expand" for="c-41534436">[5 more]</label></div><br/><div class="children"><div class="content">How do you reliably get to the copper without shorting it?</div><br/><div id="41534602" class="c"><input type="checkbox" id="c-41534602" checked=""/><div class="controls bullet"><span class="by">madars</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534436">parent</a><span>|</span><a href="#41534531">next</a><span>|</span><label class="collapse" for="c-41534602">[-]</label><label class="expand" for="c-41534602">[1 more]</label></div><br/><div class="children"><div class="content">With special equipment and by half-pulling&#x2F;disassembling the power outlet. See <a href="https:&#x2F;&#x2F;wiebetech.com&#x2F;products&#x2F;hotplug-field-kit&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wiebetech.com&#x2F;products&#x2F;hotplug-field-kit&#x2F;</a> and <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=-G8sEYCOv-o" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=-G8sEYCOv-o</a></div><br/></div></div><div id="41534531" class="c"><input type="checkbox" id="c-41534531" checked=""/><div class="controls bullet"><span class="by">aaronmdjones</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534436">parent</a><span>|</span><a href="#41534602">prev</a><span>|</span><a href="#41536053">next</a><span>|</span><label class="collapse" for="c-41534531">[-]</label><label class="expand" for="c-41534531">[2 more]</label></div><br/><div class="children"><div class="content">Careful application of a box cutter for the outer sheath followed by something resembling a scotchlok connector for line and neutral.<p>Edit: If the machine is plugged into a power bar &#x2F; power strip &#x2F; whatever you want to call it, this is much easier still: Plug the vampire UPS into the power bar as well, wait for it to sync up to the grid, and disconnect the bar from the outlet. The UPS continues to feed power into the bar and thus keeps the machine powered.</div><br/><div id="41537941" class="c"><input type="checkbox" id="c-41537941" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534531">parent</a><span>|</span><a href="#41536053">next</a><span>|</span><label class="collapse" for="c-41537941">[-]</label><label class="expand" for="c-41537941">[1 more]</label></div><br/><div class="children"><div class="content">Power strips make this easier of course, but every outlet usually has two plugs and most* of the time they are wired together. You just need to plug into the other plug.<p>* In case they are split for whatever reason (switched plug, different circuit) whatever, just take off the faceplate, pull out the outlet, and now you have direct access to the screw terminals and copper wiring on the outlet. You could wire into the plug using the second set of terminals or via the other connection method (one being the screw terminals, the other being the &quot;insert into the hole&quot; depending on which is used) and take the whole outlet with you.</div><br/></div></div></div></div><div id="41536053" class="c"><input type="checkbox" id="c-41536053" checked=""/><div class="controls bullet"><span class="by">giobox</span><span>|</span><a href="#41533647">root</a><span>|</span><a href="#41534436">parent</a><span>|</span><a href="#41534531">prev</a><span>|</span><a href="#41538140">next</a><span>|</span><label class="collapse" for="c-41536053">[-]</label><label class="expand" for="c-41536053">[1 more]</label></div><br/><div class="children"><div class="content">As far as i&#x27;m aware, often times they just plug into an open socket on an existing powerstrip that are so often used for PCs, no vampire-ing required. You can then unplug the powerstrip from the wall, it stays powered, inputing electricity through one of the sockets instead of drawing.<p>I guess a more elaborate version of the same idea can be done if the computer plugged directly to an outlet with two sockets too, removing the socket from the wall.<p>The only time I can forsee vampiring the cable being a thing would be if computer is directly plugged into a single socket outlet on the wall?<p>&gt; <a href="https:&#x2F;&#x2F;youtu.be&#x2F;erq4TO_a3z8?si=jzOqrzyu7LZLfJIm&amp;t=135" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;erq4TO_a3z8?si=jzOqrzyu7LZLfJIm&amp;t=135</a><p>&gt; <a href="https:&#x2F;&#x2F;wiebetech.com&#x2F;products&#x2F;hotplug-field-kit&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wiebetech.com&#x2F;products&#x2F;hotplug-field-kit&#x2F;</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="41538140" class="c"><input type="checkbox" id="c-41538140" checked=""/><div class="controls bullet"><span class="by">c0l0</span><span>|</span><a href="#41533647">prev</a><span>|</span><a href="#41534481">next</a><span>|</span><label class="collapse" for="c-41538140">[-]</label><label class="expand" for="c-41538140">[1 more]</label></div><br/><div class="children"><div class="content">As I had posted a few weeks ago (<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41085314">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41085314</a>), I recently implemented a very similar thing myself.<p>My solution ended up using tc&#x27;s mirred[0] action for implementing a fully L2-transparent frame relay. I wonder if their setup achieves the same degree of transparency, because afaiui, that&#x27;s just not possible involving a 802.1Q-compliant (Linux) bridge.<p>I spent close to a week optimizing my setup looking at kernel flame graphs and perf results, reading adapter-specific tuning guides and driver source, and can say that the <i>only</i> really meaningful performance optimizations (in both the Broadwell- and Zen3&#x2F;Vermeer-based implementations I tried) were disabling mitigations in the kernel (esp. on Zen3, that boosted performance by more than 20%), and getting CPU frequency scaling&#x2F;idle states sorted out correctly (which yielded much higher wins on the older Broadwell uarch, because power state transition appears to happen much quicker on Zen3).<p>As for the solution presented in the (on the whole really great; I love it!) article, I have my doubts about the effectiveness of the cargo-culted  &quot;sysctl tuning&quot; mentioned - TCP, for example, is simply not involved at all in the described setup, so &quot;tuning&quot; its buffer allocations cannot have any effect on the workload.<p>Kudos to the writers for solving their problem in a creative, cost-effective and maintainable way! :)<p>[0]: <a href="https:&#x2F;&#x2F;www.man7.org&#x2F;linux&#x2F;man-pages&#x2F;man8&#x2F;tc-mirred.8.html" rel="nofollow">https:&#x2F;&#x2F;www.man7.org&#x2F;linux&#x2F;man-pages&#x2F;man8&#x2F;tc-mirred.8.html</a></div><br/></div></div><div id="41534481" class="c"><input type="checkbox" id="c-41534481" checked=""/><div class="controls bullet"><span class="by">theideaofcoffee</span><span>|</span><a href="#41538140">prev</a><span>|</span><a href="#41538165">next</a><span>|</span><label class="collapse" for="c-41534481">[-]</label><label class="expand" for="c-41534481">[1 more]</label></div><br/><div class="children"><div class="content">This is a great writeup! Especially for those that may want to DIY it, the how and the why and all of that, and not have to shell out for carrier-quality Layer 1 encryption devices. Nice to see that even off-the-shelf components can do it with relative ease at those rates. Also nice to see sane sysctl tunes as well. Anything to make an adversary&#x27;s day a bit harder. I low key love the explanation of old 10B5 taps, something that so well and truly dead, but the legacy carries on into everything new today.<p>This is actually a well-trodden area of datacenter interconnect (DCI) devices that do line-rate encryption (to crazy levels like 400G+) to protect those links that may have easily accessible fibers strung along poles, for instance, to prevent just the vampirism described in the post. Packetlight, Ciena, Infinera and others.</div><br/></div></div><div id="41538165" class="c"><input type="checkbox" id="c-41538165" checked=""/><div class="controls bullet"><span class="by">qhwudbebd</span><span>|</span><a href="#41534481">prev</a><span>|</span><a href="#41533955">next</a><span>|</span><label class="collapse" for="c-41538165">[-]</label><label class="expand" for="c-41538165">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m interested in their last step, in which they set<p><pre><code>  vm.dirty_ratio = 40
  vm.dirty_background_ratio = 10
  vm.swappiness=10

  governor=performance
  energy_perf_bias=performance
  min_perf_pct=100
</code></pre>
to raise a surprisingly low performance ceiling.<p>I can&#x27;t believe they were under any memory pressure, so the first three presumably made no difference, but it&#x27;s also quite surprising to me that the default ondemand cpu governor was responsible for such a dramatic performance hit. Not throttling up quickly enough leading to higher latency maybe? Very interesting anyway.</div><br/></div></div><div id="41533955" class="c"><input type="checkbox" id="c-41533955" checked=""/><div class="controls bullet"><span class="by">dathery</span><span>|</span><a href="#41538165">prev</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41533955">[-]</label><label class="expand" for="c-41533955">[10 more]</label></div><br/><div class="children"><div class="content">Really cool article, I enjoy reading through all the details behind the decision making.<p>Just spit-balling a little, but I wonder if Wireguard is the best tool here given that the author is only using it for a single point-to-point link and they control the devices on both ends. That CPU supports AES-NI and probably does it a lot faster than Wireguard&#x27;s ChaCha20 (hard to get numbers for their server CPU, but the tiny little x86 mini PC I use as my router does AES XTS at 43Gbps according to `cryptsetup benchmark`).<p>You might see better performance by tunneling the vxlan connection using a different technology which can use AES-NI? Then again, Wireguard is definitely still a good tool for stuff like this, and maybe the performance penalty isn&#x27;t a big deal here.</div><br/><div id="41536469" class="c"><input type="checkbox" id="c-41536469" checked=""/><div class="controls bullet"><span class="by">alphager</span><span>|</span><a href="#41533955">parent</a><span>|</span><a href="#41534504">next</a><span>|</span><label class="collapse" for="c-41536469">[-]</label><label class="expand" for="c-41536469">[2 more]</label></div><br/><div class="children"><div class="content">AES can only encrypt up to 64TB; after that you need to re-key. So you need a mechanism for rekeying anyway. Definitely a good idea to use a battle-tested tool like wireguard instead of rolling your own.</div><br/><div id="41536819" class="c"><input type="checkbox" id="c-41536819" checked=""/><div class="controls bullet"><span class="by">EE84M3i</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41536469">parent</a><span>|</span><a href="#41534504">next</a><span>|</span><label class="collapse" for="c-41536819">[-]</label><label class="expand" for="c-41536819">[1 more]</label></div><br/><div class="children"><div class="content">&gt;AES can only encrypt up to 64TB<p>I&#x27;ve never heard that before. Are you referring to a specific mode of operation?</div><br/></div></div></div></div><div id="41534504" class="c"><input type="checkbox" id="c-41534504" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#41533955">parent</a><span>|</span><a href="#41536469">prev</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41534504">[-]</label><label class="expand" for="c-41534504">[7 more]</label></div><br/><div class="children"><div class="content">Because Wireguard is cool and AES is uncool.</div><br/><div id="41535505" class="c"><input type="checkbox" id="c-41535505" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41534504">parent</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41535505">[-]</label><label class="expand" for="c-41535505">[6 more]</label></div><br/><div class="children"><div class="content">I guess it depends on whether you&#x27;re more concerned about transport security or cipher cycles&#x2F;byte.</div><br/><div id="41535704" class="c"><input type="checkbox" id="c-41535704" checked=""/><div class="controls bullet"><span class="by">dathery</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41535505">parent</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41535704">[-]</label><label class="expand" for="c-41535704">[5 more]</label></div><br/><div class="children"><div class="content">Is there reason to think AES used appropriately would be any less secure here? Not trying to be argumentative, genuinely curious.<p>My understanding is that AES has some design warts that make it not ideal (basically, it&#x27;s easy to both implement and use in ways that leak information if you&#x27;re not careful) but that it&#x27;s still essentially perfect symmetric encryption if you&#x27;re using it as recommended. Is that wrong?<p>FWIW, the reason I brought up performance was because the OP spends a large chunk of the post talking about it, so I assume it&#x27;s an important requirement for them.</div><br/><div id="41535822" class="c"><input type="checkbox" id="c-41535822" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41535704">parent</a><span>|</span><a href="#41535779">next</a><span>|</span><label class="collapse" for="c-41535822">[-]</label><label class="expand" for="c-41535822">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not about AES, it&#x27;s about the WireGuard protocol. AES is fine. It&#x27;s possible that, if Jason had the decisions to do over again today, he might use XAES instead of ChaPoly (he didn&#x27;t have an especially good AES construction to use at the time). The big thing with WireGuard is not doing ciphersuite negotiation, which is an extremely good decision that is definitely worth paying some cycles&#x2F;byte for (if you must).</div><br/></div></div><div id="41535779" class="c"><input type="checkbox" id="c-41535779" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41535704">parent</a><span>|</span><a href="#41535822">prev</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41535779">[-]</label><label class="expand" for="c-41535779">[3 more]</label></div><br/><div class="children"><div class="content">AES is probably fine as a cipher but the VPN protocols that aren&#x27;t Wireguard tend to have various footguns available. In theory someone could create NoisyESP but I&#x27;m not aware of it.</div><br/><div id="41535851" class="c"><input type="checkbox" id="c-41535851" checked=""/><div class="controls bullet"><span class="by">dathery</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41535779">parent</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41535851">[-]</label><label class="expand" for="c-41535851">[2 more]</label></div><br/><div class="children"><div class="content">That makes sense. I was thinking they could use something like DTLS [1] and tunnel just the one UDP port needed for their VXLAN connections, rather than use full-blown VPN software. I have never actually tried this myself though.<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Datagram_Transport_Layer_Security" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Datagram_Transport_Layer_Secur...</a></div><br/><div id="41535919" class="c"><input type="checkbox" id="c-41535919" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41533955">root</a><span>|</span><a href="#41535851">parent</a><span>|</span><a href="#41534427">next</a><span>|</span><label class="collapse" for="c-41535919">[-]</label><label class="expand" for="c-41535919">[1 more]</label></div><br/><div class="children"><div class="content">It genuinely might not matter, and it might make sense to use a weaker protocol, if the only threat model you&#x27;re trying to deal with is someone physically tapping a campus-area network. You&#x27;d run the &quot;real&quot; secure transports on top of that, the same way you do on internal networks today. In which case, yeah, it might make sense to select your protocol&#x2F;constructions purely based on encryption efficiency.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="41534427" class="c"><input type="checkbox" id="c-41534427" checked=""/><div class="controls bullet"><span class="by">nsteel</span><span>|</span><a href="#41533955">prev</a><span>|</span><a href="#41538088">next</a><span>|</span><label class="collapse" for="c-41534427">[-]</label><label class="expand" for="c-41534427">[2 more]</label></div><br/><div class="children"><div class="content">Did Cisco really invent MACSec?! I thought it was cooked up by the IEEE and supported in hardware from many vendors. I imagine they all have their own bugs though, it&#x27;s quite a complicated spec. I know some switch&#x2F;router vendors also now offer hardware-accelerated end-to-end encryption, similar to IPsec, Nokia call their&#x27;s anysec but I&#x27;m sure the other players have their own. The benefit of those is you&#x27;d get full bandwidth (e.g. Tbps).</div><br/><div id="41534466" class="c"><input type="checkbox" id="c-41534466" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#41534427">parent</a><span>|</span><a href="#41538088">next</a><span>|</span><label class="collapse" for="c-41534466">[-]</label><label class="expand" for="c-41534466">[1 more]</label></div><br/><div class="children"><div class="content">Usually one vendor prototypes a feature then they take it to IEEE&#x2F;IETF for standardization. Probably half of all network protocols were invented by Cisco.</div><br/></div></div></div></div><div id="41538088" class="c"><input type="checkbox" id="c-41538088" checked=""/><div class="controls bullet"><span class="by">ggernov</span><span>|</span><a href="#41534427">prev</a><span>|</span><a href="#41533997">next</a><span>|</span><label class="collapse" for="c-41538088">[-]</label><label class="expand" for="c-41538088">[1 more]</label></div><br/><div class="children"><div class="content">I prefer to just run fiber inside of a copper gas line.</div><br/></div></div><div id="41533997" class="c"><input type="checkbox" id="c-41533997" checked=""/><div class="controls bullet"><span class="by">exabrial</span><span>|</span><a href="#41538088">prev</a><span>|</span><a href="#41536289">next</a><span>|</span><label class="collapse" for="c-41533997">[-]</label><label class="expand" for="c-41533997">[3 more]</label></div><br/><div class="children"><div class="content">Why MACSEC isn&#x27;t the default is pretty crazy! given that is is extremely stateless (encrypting at the frame level) and counters should be pretty reliable (only go up, since there&#x27;s two parties) you could take advantages of some AES and GCM modes that would pretty quickly spot injection, replay, and other attacks.<p>But getting back to the main topic of the paper: why not just S2S IPSec the link?</div><br/><div id="41534111" class="c"><input type="checkbox" id="c-41534111" checked=""/><div class="controls bullet"><span class="by">justsomehnguy</span><span>|</span><a href="#41533997">parent</a><span>|</span><a href="#41536289">next</a><span>|</span><label class="collapse" for="c-41534111">[-]</label><label class="expand" for="c-41534111">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Why MACSEC isn&#x27;t the default<p>TFA explains it pretty well. Also every encryption is adding the load and latency, so defaulting to it when it wasn&#x27;t asked for isn&#x27;t the best way<p>&gt; why not just S2S IPSec the link?<p>Because IPSec is still PITA and also sucks bad performance wise against WG.</div><br/><div id="41536987" class="c"><input type="checkbox" id="c-41536987" checked=""/><div class="controls bullet"><span class="by">nullc</span><span>|</span><a href="#41533997">root</a><span>|</span><a href="#41534111">parent</a><span>|</span><a href="#41536289">next</a><span>|</span><label class="collapse" for="c-41536987">[-]</label><label class="expand" for="c-41536987">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t recall the specifics of macsec but it&#x27;s possible to build a link encryptor that adds essentially zero latency. (like... no more latency than the gate delay of a single xor gate... plus some once-an-hour packet-length delay of some rekeying traffic).</div><br/></div></div></div></div></div></div><div id="41536289" class="c"><input type="checkbox" id="c-41536289" checked=""/><div class="controls bullet"><span class="by">dietr1ch</span><span>|</span><a href="#41533997">prev</a><span>|</span><a href="#41534519">next</a><span>|</span><label class="collapse" for="c-41536289">[-]</label><label class="expand" for="c-41536289">[1 more]</label></div><br/><div class="children"><div class="content">Missing attack: Cause a disruption that obviously breaks the connection while further away you get time to tap it properly.<p>&quot;Oh, no, a truck run into the pole carrying the copper&#x2F;fiber, it must be an accident and no intervention is going on undetected because of the outage.&quot;<p>What we really need is promiscuous connectivity , but fully untrusted connections. It&#x27;s maddening why it&#x27;s hard to communicate 2 wireless devices while they are literally sharing the same radio spectrum and multiple radios could be used to talk to each other.</div><br/></div></div><div id="41534519" class="c"><input type="checkbox" id="c-41534519" checked=""/><div class="controls bullet"><span class="by">aaronmdjones</span><span>|</span><a href="#41536289">prev</a><span>|</span><a href="#41535226">next</a><span>|</span><label class="collapse" for="c-41534519">[-]</label><label class="expand" for="c-41534519">[3 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    # setup a 8020 MTU on wg0 interface to account for the 80 bytes wireguard headers overhead
    # 20-byte IPv4 header or 40 byte IPv6 header, 8-byte UDP header  4-byte type, 4-byte key index, 8-byte nonce, 16-byte authentication tag)
    &#x2F;sbin&#x2F;ip li set dev wg0 mtu 8020
</code></pre>
Shouldn&#x27;t that be 8920? To go with the 9000 byte MTU on the outer interface above it.</div><br/><div id="41535931" class="c"><input type="checkbox" id="c-41535931" checked=""/><div class="controls bullet"><span class="by">bb88</span><span>|</span><a href="#41534519">parent</a><span>|</span><a href="#41535226">next</a><span>|</span><label class="collapse" for="c-41535931">[-]</label><label class="expand" for="c-41535931">[2 more]</label></div><br/><div class="children"><div class="content">That would probably add only a smidge more performance.</div><br/><div id="41535946" class="c"><input type="checkbox" id="c-41535946" checked=""/><div class="controls bullet"><span class="by">aaronmdjones</span><span>|</span><a href="#41534519">root</a><span>|</span><a href="#41535931">parent</a><span>|</span><a href="#41535226">next</a><span>|</span><label class="collapse" for="c-41535946">[-]</label><label class="expand" for="c-41535946">[1 more]</label></div><br/><div class="children"><div class="content">Sure, but the comment block says that they arrived at 8020 by subtracting 80 from 9000, which is just wrong.</div><br/></div></div></div></div></div></div><div id="41535226" class="c"><input type="checkbox" id="c-41535226" checked=""/><div class="controls bullet"><span class="by">icehawk</span><span>|</span><a href="#41534519">prev</a><span>|</span><a href="#41537101">next</a><span>|</span><label class="collapse" for="c-41535226">[-]</label><label class="expand" for="c-41535226">[1 more]</label></div><br/><div class="children"><div class="content">I did something like this to stretch L2 as I was moving into a new home. Worked great after I realized t-mobile does not like passing IP fragments.<p>Got to use it again to set up a remote telescope for the eclipse.</div><br/></div></div><div id="41536978" class="c"><input type="checkbox" id="c-41536978" checked=""/><div class="controls bullet"><span class="by">nullc</span><span>|</span><a href="#41537101">prev</a><span>|</span><a href="#41535374">next</a><span>|</span><label class="collapse" for="c-41536978">[-]</label><label class="expand" for="c-41536978">[1 more]</label></div><br/><div class="children"><div class="content">Tapping is even easier if you have access to the cable end in a patch panel.<p>I have a computer setup with a one-way gige connection for reviewing potentially malicious content in an air-gapped manner.  The transmit side transceiver needs to see an incoming signal, so I just use one of these to feed its own output back into it:<p><a href="https:&#x2F;&#x2F;www.amazon.com&#x2F;dp&#x2F;B0B8ZHBK26" rel="nofollow">https:&#x2F;&#x2F;www.amazon.com&#x2F;dp&#x2F;B0B8ZHBK26</a></div><br/></div></div><div id="41535374" class="c"><input type="checkbox" id="c-41535374" checked=""/><div class="controls bullet"><span class="by">westurner</span><span>|</span><a href="#41536978">prev</a><span>|</span><label class="collapse" for="c-41535374">[-]</label><label class="expand" for="c-41535374">[1 more]</label></div><br/><div class="children"><div class="content">A notebook with pandas would have had a df.plot().<p>9.71 Gbps <i>with wg</i> on a 10GBps link with sysctl tunings, custom MTUs,.<p>I had heard of token ring, but not 10BASE5: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;10BASE5" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;10BASE5</a></div><br/></div></div></div></div></div></div></div></body></html>