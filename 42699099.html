<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1736931675383" as="style"/><link rel="stylesheet" href="styles.css?v=1736931675383"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://trufflesecurity.com/blog/millions-at-risk-due-to-google-s-oauth-flaw">Google’s OAuth login doesn’t protect against purchasing a failed startup domain</a> <span class="domain">(<a href="https://trufflesecurity.com">trufflesecurity.com</a>)</span></div><div class="subtext"><span>simiones</span> | <span>225 comments</span></div><br/><div><div id="42700255" class="c"><input type="checkbox" id="c-42700255" checked=""/><div class="controls bullet"><span class="by">stackghost</span><span>|</span><a href="#42700760">next</a><span>|</span><label class="collapse" for="c-42700255">[-]</label><label class="expand" for="c-42700255">[126 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not 100% clear to me, from reading TFA, what the actual vuln is.<p>Suppose DankStartup folds and I, being a morally-dubious sort of fellow, purchase dankstartup.net which I then use to sign into DankStartup&#x27;s O365, or DankStartup&#x27;s ChatGPT as a DankStartup employee.<p>Isn&#x27;t that a failure on DankStartup&#x27;s part, to not shut down their business accounts?  And isn&#x27;t it also a failure on e.g. Microsoft or OpenAI&#x27;s parts, since they&#x27;re providing service to a defunct business entity who can&#x27;t pay its bills?<p>To describe this as a vuln in oauth doesn&#x27;t really make sense to me.</div><br/><div id="42701095" class="c"><input type="checkbox" id="c-42701095" checked=""/><div class="controls bullet"><span class="by">danudey</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42701095">[-]</label><label class="expand" for="c-42701095">[46 more]</label></div><br/><div class="children"><div class="content">Well, think about it this way:<p>1. I create DankStartup and my company uses Google workspaces and Google auth for a bunch of stuff, like payroll.<p>2. DankStartup goes under and we close our Google accounts&#x2F;let our domain lapse.<p>3. Someone else buys DankStartup.com, sets up a Google workspace, and attempts Google auth to log into stuff, and it works.<p>The problem is that the original DankStartup has a Google account that they create in #1, and Google goes around telling other sites (via Auth) &quot;this is user X from company Y&quot;.<p>Then, the impostors in step #3 create a <i>different</i> google account with the same domain, and Google says &quot;yeah, these are definitely the same guys as before&quot;, even though Google is fully capable of discerning that that is not the case; these are different people with a different workspace account, different names, different payment information, and so on, but Google is saying that if you&#x27;re holding the domain you are therefore the same people as far as they&#x27;re concerned <i>and is asserting that to other companies</i>. They are (or were) refusing to provide any indication to those other companies that these are not, in fact, the same people, so those other companies aren&#x27;t even capable of doing their due diligence of extra validation if they want to.<p>It&#x27;s similar to looking at a driver&#x27;s license and just matching the name rather than the actual ID number; it&#x27;s possible for someone else to have the same name as you, and identity documents have unique identifiers for specifically that reason.</div><br/><div id="42701725" class="c"><input type="checkbox" id="c-42701725" checked=""/><div class="controls bullet"><span class="by">stackghost</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42701701">next</a><span>|</span><label class="collapse" for="c-42701725">[-]</label><label class="expand" for="c-42701725">[5 more]</label></div><br/><div class="children"><div class="content">&gt;Then, the impostors in step #3 create a different google account with the same domain, and Google says &quot;yeah, these are definitely the same guys as before&quot;, even though Google is fully capable of discerning that that is not the case; these are different people with a different workspace account, different names, different payment information, and so on, but Google is saying that if you&#x27;re holding the domain you are therefore the same people as far as they&#x27;re concerned and is asserting that to other companies.<p>Yep I understand the mechanism by which this gets abused; I think we just disagree on the implications.  I don&#x27;t work for Google but it seems from the outside that they&#x27;re treating the OIDC subject claim as referencing the domain attached to the workspace account, or something similar.  I&#x27;ve seen implementations where the `sub` claim is more granular, so to me that indicates the field is underspecified.<p>Given all that, I suppose TFAuthor&#x27;s proposed solution is a good way forward.<p>I still think classifying this as an OAuth vulnerability isn&#x27;t correct.</div><br/><div id="42701912" class="c"><input type="checkbox" id="c-42701912" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701725">parent</a><span>|</span><a href="#42701701">next</a><span>|</span><label class="collapse" for="c-42701912">[-]</label><label class="expand" for="c-42701912">[4 more]</label></div><br/><div class="children"><div class="content">Traditionally, SAML &#x2F; OIDC trust is established using public&#x2F;private keypairs. Each IdP&#x2F;SP pair gets a unique combination. In this case, a domain changing hands would not allow the new owner to gain access to the old owner&#x27;s accounts.<p>In the case of Google OAuth, it&#x27;s possible to forego this in order to allow any Google user from any Google workspace to login to your application. See the distinction between &quot;public and internal applications&quot; here: <a href="https:&#x2F;&#x2F;support.google.com&#x2F;cloud&#x2F;answer&#x2F;6158849?hl=en#zippy=%2Cpublic-and-internal-applications" rel="nofollow">https:&#x2F;&#x2F;support.google.com&#x2F;cloud&#x2F;answer&#x2F;6158849?hl=en#zippy=...</a><p>Some applications (e.g. Tailscale) take advantage of the public Google OAuth API to provide private internal corporate accounts. A common misconfiguration here is to use the domain portion of the &quot;email&quot; attribute - this can be spoofed by Google Workspace admins. That&#x27;s not what&#x27;s happening here.<p>Instead, Google instructs you to look at the &quot;hd&quot; parameter, specific to Google, to determine the Google Workspace a given user belongs to for security purposes. This field cannot be overridden by Google Workspace admins. The trust breaks down when the domain changes hands, a new Google Workspace account is opened, but the old &quot;hd&quot; value is reused.<p>You can read more about &quot;hd&quot; here: <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;openid-connect&#x2F;openid-connect" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;openid-connect&#x2F;openid...</a> (find the table and read the descriptions for both &quot;email&quot; and &quot;hd&quot;.)<p>You can avoid this issue by using a custom Google OIDC IdP configured for internal access only in your applications, rather than using a pre-configured public Google OIDC IdP (be very careful you mark it internal!) A new domain owner would not be able to retrieve the secret key you previously generated.</div><br/><div id="42704292" class="c"><input type="checkbox" id="c-42704292" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701912">parent</a><span>|</span><a href="#42705013">next</a><span>|</span><label class="collapse" for="c-42704292">[-]</label><label class="expand" for="c-42704292">[1 more]</label></div><br/><div class="children"><div class="content">To clarify, any multi-tenant app that has a Google login button that &quot;just works&quot; without you having to set up your own OAuth client creds is using the &quot;public&quot; app option. Effectively the OAuth client side doesn&#x27;t care whether you use a public Gmail account or enterprise Workspaces account to login.<p>However, on the Workspace Admin side you can set policies as to whether the org accounts can login to arbitrary public apps by default, or set up an app allowlist, etc. It&#x27;s definitely a best practice not to let your users login to arbitrary apps, even if it&#x27;s only for the profile data and not other API scopes.<p>If you do login to a public app with an org account, how that app decides to group&#x2F;authorize users from (what it perceived as) the same org&#x2F;domain could be a sensitive procedure with opportunity for exploit, and it seems like maybe Google should offer a more reliable unique org id claim.<p>If you are making your own internal app then client is going to be internal only by default. Note this is managed in a GCP project. If you&#x27;re using Workspace and GCP then you may want to use GCP services with built-in Google auth like Cloud Functions, App Engine, Identity Aware Proxy, etc.</div><br/></div></div><div id="42706179" class="c"><input type="checkbox" id="c-42706179" checked=""/><div class="controls bullet"><span class="by">delfinom</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701912">parent</a><span>|</span><a href="#42705013">prev</a><span>|</span><a href="#42701701">next</a><span>|</span><label class="collapse" for="c-42706179">[-]</label><label class="expand" for="c-42706179">[1 more]</label></div><br/><div class="children"><div class="content">Yea &quot;hd&quot; doesn&#x27;t work here.<p>Users can make google accounts with corporate domains but without gsuite hosting attached. The same concern applies to just @gmail.com addys. Google has gotten big on nuking inactive accounts now, what stops similar openings where a person&#x27;s inactive account gets recreated by an attacker and waltz his way into SSO systems? There&#x27;s some corporate systems (usually benefits) that allow personal emails attached to the same account as work emails for example.<p>I imagine the fact the author is writing that Google reopened the bug and is issuing a bounty means there are Google engineers more than aware of the issue rather than trying to argue what Google does and does not intend.</div><br/></div></div></div></div></div></div><div id="42701701" class="c"><input type="checkbox" id="c-42701701" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42701725">prev</a><span>|</span><a href="#42702586">next</a><span>|</span><label class="collapse" for="c-42701701">[-]</label><label class="expand" for="c-42701701">[3 more]</label></div><br/><div class="children"><div class="content">It seems there are two possible problems.<p>The first is whether taking over a lapsed domain allows you to takeover an existing Google Workspace (or Cloud Identity) organization. This it what houses the corporate email accounts and OAuth client registrations. If Google allows this scenario then the linked account takeover is simply one symptom &#x2F; side effect among many. TFA is not clear on whether this step actually happened... I assume not, since if it were the case we&#x27;d be talking about direct access to the Google account data rather than only linked SP accounts.<p>The second is when an SP doesn&#x27;t properly use the `sub` claim as a unique identifier. It sounds like some products don&#x27;t understand this requirement and why it &quot;seems to change 0.04%&quot; of the time. I do agree that a unique identifier for the org itself would be a good addition to the token.<p>That said, I&#x27;m still not clear how the second problem manifests if the old OAuth client creds (housed in the old Workspace org id) are invalid. Presumably attacker can login to the SP admin account using just email based password recovery, then reconfigure the OAuth integration with new secrets. In that case the SP is failing to do MFA on the email login.<p>Would love to hear if I&#x27;m missing something.</div><br/><div id="42704014" class="c"><input type="checkbox" id="c-42704014" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701701">parent</a><span>|</span><a href="#42702586">next</a><span>|</span><label class="collapse" for="c-42704014">[-]</label><label class="expand" for="c-42704014">[2 more]</label></div><br/><div class="children"><div class="content">&gt; That said, I&#x27;m still not clear how the second problem manifests if the old OAuth client creds (housed in the old Workspace org id) are invalid.<p>As far as I understand, this is not a necessary step. The SP is configured to trust Google&#x27;s public OAuth IdP, not a specific Google Workspace account. So there are no special secrets shared between the old Google Workspace account and, say, Slack. The Slack org trusts any user that Google&#x27;s public OAuth IdP says is a valid user in the example.com domain. Slack doesn&#x27;t have to do any MFA for these accounts, they trust Google did that already.<p>Now, you may not be able to access the Slack org admin account in this way, say to add&#x2F;remove users or delete the org. But you can access all of the other information that any random employee in the org could access back when it was setup, including a list of all other users in the org.</div><br/><div id="42704534" class="c"><input type="checkbox" id="c-42704534" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42704014">parent</a><span>|</span><a href="#42702586">next</a><span>|</span><label class="collapse" for="c-42704534">[-]</label><label class="expand" for="c-42704534">[1 more]</label></div><br/><div class="children"><div class="content">Ah, right, Slack can have their own public oath client which is used for the code grant.<p>So what happens is:
1. New Workspace org created with same (old) domain name
2. Same domain name is sent in `hd` property, existing email address sent in the `email` property, new uuid in the `sub` property.<p>If the app is only matching on email instead of sub, then it will grant access to previous user data. Additionally, even if it makes a new user based on the new sub, it may still grant access to other SP resources associated with the existing domain based on the email address or hd value.<p>Instead there needs to be something like `hd` but uniquely identifying the Workspace org entity itself, not just the domain.</div><br/></div></div></div></div></div></div><div id="42702586" class="c"><input type="checkbox" id="c-42702586" checked=""/><div class="controls bullet"><span class="by">patmcc</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42701701">prev</a><span>|</span><a href="#42707500">next</a><span>|</span><label class="collapse" for="c-42702586">[-]</label><label class="expand" for="c-42702586">[15 more]</label></div><br/><div class="children"><div class="content">&gt;&gt;&gt;The problem is that the original DankStartup has a Google account that they create in #1, and Google goes around telling other sites (via Auth) &quot;this is user X from company Y&quot;.<p>Google is telling other sites that it&#x27;s bob@DankStartup.com - isn&#x27;t that true? Isn&#x27;t this on DankStartup to close down operations cleanly?</div><br/><div id="42704058" class="c"><input type="checkbox" id="c-42704058" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702586">parent</a><span>|</span><a href="#42707527">next</a><span>|</span><label class="collapse" for="c-42704058">[-]</label><label class="expand" for="c-42704058">[5 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a different bob@DankStartup.com, and in fact a completely different DankStartup.com. Google shouldn&#x27;t conflate the two.<p>There are exactly 0 situations where the current behavior is useful. There is no reason whatsoever to have the exact same auth info for two Google accounts that happen to have the same domain.</div><br/><div id="42705162" class="c"><input type="checkbox" id="c-42705162" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42704058">parent</a><span>|</span><a href="#42707447">next</a><span>|</span><label class="collapse" for="c-42705162">[-]</label><label class="expand" for="c-42705162">[2 more]</label></div><br/><div class="children"><div class="content">Whoever has access to the inbox and account for bob@DankStartup.com is bob@DankStartup.com.  If Google was being asked if the SSN for bob is 123-45-6789 and they were saying yes, then I would agree that&#x27;s an issue, but all Google is saying is &quot;this person can authenticate to our services as bob@DankStartup.com&quot; and that is true.</div><br/><div id="42708163" class="c"><input type="checkbox" id="c-42708163" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42705162">parent</a><span>|</span><a href="#42707447">next</a><span>|</span><label class="collapse" for="c-42708163">[-]</label><label class="expand" for="c-42708163">[1 more]</label></div><br/><div class="children"><div class="content">But the new owner does not have access to the inbox or any other account info of the old bob@DankStartup.com. They&#x27;re completely separate accounts, with the same email address. Plus, Google already recognizes that fact, by setting a different value in the &quot;sub&quot; field of the claim it returns (though per the article, it seems that may not work properly).<p>And legal relations just don&#x27;t work this way. A person is who they are, and it is that person who has legal access to whatever data was stored in their Slack. Another person who happens to have the same email some time later doesn&#x27;t have any right whatsoever to that same data. OAuth exists to help secure this type of legal relation, not to establish a completely fictitious identity.</div><br/></div></div></div></div><div id="42707447" class="c"><input type="checkbox" id="c-42707447" checked=""/><div class="controls bullet"><span class="by">patmcc</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42704058">parent</a><span>|</span><a href="#42705162">prev</a><span>|</span><a href="#42707527">next</a><span>|</span><label class="collapse" for="c-42707447">[-]</label><label class="expand" for="c-42707447">[2 more]</label></div><br/><div class="children"><div class="content">&gt;&gt;&gt;It&#x27;s a different bob@DankStartup.com, and in fact a completely different DankStartup.com. Google shouldn&#x27;t conflate the two.<p>Does Google have any reliable way of knowing that?<p>&gt;&gt;&gt;There are exactly 0 situations where the current behavior is useful. There is no reason whatsoever to have the exact same auth info for two Google accounts that happen to have the same domain.<p>I have a personal google workspace account with a few domains. At some point I might want to spin one off to be its own (maybe I start a company). But I&#x27;d still expect pat@mydomain.com to keep working throughout. So that&#x27;s 1 situation.</div><br/><div id="42708198" class="c"><input type="checkbox" id="c-42708198" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42707447">parent</a><span>|</span><a href="#42707527">next</a><span>|</span><label class="collapse" for="c-42708198">[-]</label><label class="expand" for="c-42708198">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Does Google have any reliable way of knowing that?<p>Yes, Google knows this is a new Google Workspace account using the same domain as the old one.<p>&gt; I have a personal google workspace account with a few domains. At some point I might want to spin one off to be its own (maybe I start a company). But I&#x27;d still expect pat@mydomain.com to keep working throughout. So that&#x27;s 1 situation.<p>That should be a separate feature of Google Workspace, where you can transfer an identity, it shouldn&#x27;t be automatic. And it shouldn&#x27;t even be tied to the domain name. If you decided that you prefer the domain to be pat@mybetterdomain.com, you&#x27;d still want to have access to the old Slack conversations or whatever. Conversely, if you lost access to the mydomain.com domain (say you forgot to renew it, or some legal entity sued for it because it was their trademark or whatever), I&#x27;m certain you wouldn&#x27;t want the new owners to then have access to your Slack or any other data, just because they have the same domain name.</div><br/></div></div></div></div></div></div><div id="42707527" class="c"><input type="checkbox" id="c-42707527" checked=""/><div class="controls bullet"><span class="by">Salgat</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702586">parent</a><span>|</span><a href="#42704058">prev</a><span>|</span><a href="#42703099">next</a><span>|</span><label class="collapse" for="c-42707527">[-]</label><label class="expand" for="c-42707527">[1 more]</label></div><br/><div class="children"><div class="content">Login credentials are more than just the email used, and should not be conflated with identity. To be honest I&#x27;m surprised google isn&#x27;t using a uuid tied to the account for the identity given to others, especially since internally google knows and treats it as a separate account that just happens to have the same e-mail. The e-mail should only be used as metadata for contact info.</div><br/></div></div><div id="42703099" class="c"><input type="checkbox" id="c-42703099" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702586">parent</a><span>|</span><a href="#42707527">prev</a><span>|</span><a href="#42703273">next</a><span>|</span><label class="collapse" for="c-42703099">[-]</label><label class="expand" for="c-42703099">[5 more]</label></div><br/><div class="children"><div class="content">Part of my company dissolution process is to renew the domain name for 10 years to prevent exactly this</div><br/><div id="42703893" class="c"><input type="checkbox" id="c-42703893" checked=""/><div class="controls bullet"><span class="by">jedberg</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703099">parent</a><span>|</span><a href="#42704989">next</a><span>|</span><label class="collapse" for="c-42703893">[-]</label><label class="expand" for="c-42703893">[3 more]</label></div><br/><div class="children"><div class="content">Is the hope that this sort of attack is just less useful in 10 years?  What happens after 10 years?</div><br/><div id="42704381" class="c"><input type="checkbox" id="c-42704381" checked=""/><div class="controls bullet"><span class="by">stackghost</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703893">parent</a><span>|</span><a href="#42704925">next</a><span>|</span><label class="collapse" for="c-42704381">[-]</label><label class="expand" for="c-42704381">[1 more]</label></div><br/><div class="children"><div class="content">Presumably after 10 years of failing to collect on their invoices, Microsoft would have killed your O365 account, so there&#x27;s one fewer SaaS account left to log into.</div><br/></div></div><div id="42704925" class="c"><input type="checkbox" id="c-42704925" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703893">parent</a><span>|</span><a href="#42704381">prev</a><span>|</span><a href="#42704989">next</a><span>|</span><label class="collapse" for="c-42704925">[-]</label><label class="expand" for="c-42704925">[1 more]</label></div><br/><div class="children"><div class="content">Yes</div><br/></div></div></div></div><div id="42704989" class="c"><input type="checkbox" id="c-42704989" checked=""/><div class="controls bullet"><span class="by">mansilladev</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703099">parent</a><span>|</span><a href="#42703893">prev</a><span>|</span><a href="#42703273">next</a><span>|</span><label class="collapse" for="c-42704989">[-]</label><label class="expand" for="c-42704989">[1 more]</label></div><br/><div class="children"><div class="content">Yes, this. I also use a service to capture all emails (catch all) so that I can detect any loose ends that might have been overlooked. Services like ForwardMX or Cloudflare can do this for you at relatively low (or no) cost.</div><br/></div></div></div></div><div id="42703273" class="c"><input type="checkbox" id="c-42703273" checked=""/><div class="controls bullet"><span class="by">cortesoft</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702586">parent</a><span>|</span><a href="#42703099">prev</a><span>|</span><a href="#42707500">next</a><span>|</span><label class="collapse" for="c-42703273">[-]</label><label class="expand" for="c-42703273">[3 more]</label></div><br/><div class="children"><div class="content">Sure, but DankStartup failed and doesn’t exist anymore. If I am just a lowly employee, I can’t force the failed startup owners to properly shutdown, and now my payroll information is available to hackers.<p>What is my remedy?</div><br/><div id="42707482" class="c"><input type="checkbox" id="c-42707482" checked=""/><div class="controls bullet"><span class="by">patmcc</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703273">parent</a><span>|</span><a href="#42703719">next</a><span>|</span><label class="collapse" for="c-42707482">[-]</label><label class="expand" for="c-42707482">[1 more]</label></div><br/><div class="children"><div class="content">Probably sue the failed startup owners for negligence?<p>If DankStartup left all your HR files lying around in their office and the guy who bought it five years later found them, well, DankStartup should have shredded them. It&#x27;d sure be nice if the cleaners shredded them for you, but I wouldn&#x27;t count on it (nor make them liable).</div><br/></div></div><div id="42703719" class="c"><input type="checkbox" id="c-42703719" checked=""/><div class="controls bullet"><span class="by">DrillShopper</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703273">parent</a><span>|</span><a href="#42707482">prev</a><span>|</span><a href="#42707500">next</a><span>|</span><label class="collapse" for="c-42703719">[-]</label><label class="expand" for="c-42703719">[1 more]</label></div><br/><div class="children"><div class="content">In a rational world the remedy would be to sue Google for exposing your payroll information.</div><br/></div></div></div></div></div></div><div id="42707500" class="c"><input type="checkbox" id="c-42707500" checked=""/><div class="controls bullet"><span class="by">otabdeveloper4</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42702586">prev</a><span>|</span><a href="#42701611">next</a><span>|</span><label class="collapse" for="c-42707500">[-]</label><label class="expand" for="c-42707500">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t see the problem here.<p>We&#x27;ve already settled on DNS being the auhoritative authentication key for everything. If you bought the domain then you&#x27;ve bought the corporate identity. It&#x27;s working as designed.</div><br/></div></div><div id="42701611" class="c"><input type="checkbox" id="c-42701611" checked=""/><div class="controls bullet"><span class="by">arnarbi</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42707500">prev</a><span>|</span><a href="#42701300">next</a><span>|</span><label class="collapse" for="c-42701611">[-]</label><label class="expand" for="c-42701611">[6 more]</label></div><br/><div class="children"><div class="content">&gt; They are (or were) refusing to provide any indication to those other companies that these are not, in fact, the same people<p>That is not quite true, the sub field will be different.</div><br/><div id="42701695" class="c"><input type="checkbox" id="c-42701695" checked=""/><div class="controls bullet"><span class="by">Ninn</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701611">parent</a><span>|</span><a href="#42704098">next</a><span>|</span><label class="collapse" for="c-42701695">[-]</label><label class="expand" for="c-42701695">[3 more]</label></div><br/><div class="children"><div class="content">But authors does imply that sub will also change in place for users in step #1, without the workspace beeing recreated. And as such the sub is not usable as a general identifier for the user resource differentiation.</div><br/><div id="42701754" class="c"><input type="checkbox" id="c-42701754" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701695">parent</a><span>|</span><a href="#42704098">next</a><span>|</span><label class="collapse" for="c-42701754">[-]</label><label class="expand" for="c-42701754">[2 more]</label></div><br/><div class="children"><div class="content">The sub property appearing to change for the same email address is a valid scenario. SPs failing to respect that scenario because they don&#x27;t understand it, or because it&#x27;s not what some of their users want, is not a valid excuse.<p><a href="https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;33314?hl=en&amp;co=DASHER._Family%3DDomain-verified&amp;oco=0#restore&amp;zippy=%2Creuse-the-email-address" rel="nofollow">https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;33314?hl=en&amp;co=DASHER._F...</a><p>To me it is reasonable that orgs may want to eventually reuse an email address on a different user account. That&#x27;s a feature decision made by the IdP so SPs need to respect it. I believe other IdPs like Okta and Entra have equivalent features too.</div><br/><div id="42702418" class="c"><input type="checkbox" id="c-42702418" checked=""/><div class="controls bullet"><span class="by">Ninn</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701754">parent</a><span>|</span><a href="#42704098">next</a><span>|</span><label class="collapse" for="c-42702418">[-]</label><label class="expand" for="c-42702418">[1 more]</label></div><br/><div class="children"><div class="content">&gt; To me it is reasonable that orgs may want to eventually reuse an email address on a different user account. That&#x27;s a feature decision made by the IdP so SPs need to respect it<p>I think everyone, including the authors hopefully agrees with that logic and sentiment. And that would be the literal point of the sub claim after all!<p>But the implication in the article is still, as i read it, that it changes in place in practice, and not in the case of re-creating the user under the same workspace. But i obviously do not have the background to clarify!</div><br/></div></div></div></div></div></div><div id="42704098" class="c"><input type="checkbox" id="c-42704098" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701611">parent</a><span>|</span><a href="#42701695">prev</a><span>|</span><a href="#42705088">next</a><span>|</span><label class="collapse" for="c-42704098">[-]</label><label class="expand" for="c-42704098">[1 more]</label></div><br/><div class="children"><div class="content">This is not necessarily useful. The sub field only indicates that this is a different user, which maybe protects the private info of the old user. However, a big part of OIDC integration is to automatically allow any valid user registered with the IdP to automatically have access to the corporate account, and to any company-wide resources, which can still include very sensitive information.</div><br/></div></div><div id="42705088" class="c"><input type="checkbox" id="c-42705088" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701611">parent</a><span>|</span><a href="#42704098">prev</a><span>|</span><a href="#42701300">next</a><span>|</span><label class="collapse" for="c-42705088">[-]</label><label class="expand" for="c-42705088">[1 more]</label></div><br/><div class="children"><div class="content">If by &quot;same people&quot; you mean recognizing a specific user, yes the sub field changes.<p>If by &quot;same people&quot; you mean being able to tell whether a new user is part of the same organization, the sub field is useless and no other field has this information either.</div><br/></div></div></div></div><div id="42701300" class="c"><input type="checkbox" id="c-42701300" checked=""/><div class="controls bullet"><span class="by">rahkiin</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42701611">prev</a><span>|</span><a href="#42701204">next</a><span>|</span><label class="collapse" for="c-42701300">[-]</label><label class="expand" for="c-42701300">[8 more]</label></div><br/><div class="children"><div class="content">Any domain takeover allows email takeover which allows you to send password reset emails for former employees.
Does not matter if it is with oauth or not</div><br/><div id="42701663" class="c"><input type="checkbox" id="c-42701663" checked=""/><div class="controls bullet"><span class="by">mtkd</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701300">parent</a><span>|</span><a href="#42701877">next</a><span>|</span><label class="collapse" for="c-42701663">[-]</label><label class="expand" for="c-42701663">[3 more]</label></div><br/><div class="children"><div class="content">And many vendors will send &quot;restart your service today for $x&quot; for months afterwards so data not deleted<p>Some SaaS ecommerce platforms and email marketing services will likely give a restarted domain entire customer databases ...</div><br/><div id="42701872" class="c"><input type="checkbox" id="c-42701872" checked=""/><div class="controls bullet"><span class="by">rahkiin</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701663">parent</a><span>|</span><a href="#42701877">next</a><span>|</span><label class="collapse" for="c-42701872">[-]</label><label class="expand" for="c-42701872">[2 more]</label></div><br/><div class="children"><div class="content">There should be some service for permanently destroying a domain with a single prepaid cost. Somehow preventing bankruptcy laws from getting the domain.<p>Pay X$ up front, then Y$ per month to keep active. Once you cannot pay, it gets blocked forever (paid for by the up front cost). Owned by your service provider so not part of your firesale</div><br/><div id="42706432" class="c"><input type="checkbox" id="c-42706432" checked=""/><div class="controls bullet"><span class="by">ocdtrekkie</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701872">parent</a><span>|</span><a href="#42701877">next</a><span>|</span><label class="collapse" for="c-42706432">[-]</label><label class="expand" for="c-42706432">[1 more]</label></div><br/><div class="children"><div class="content">What happens when your service provider that owns your domain collapses?</div><br/></div></div></div></div></div></div><div id="42701877" class="c"><input type="checkbox" id="c-42701877" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701300">parent</a><span>|</span><a href="#42701663">prev</a><span>|</span><a href="#42701204">next</a><span>|</span><label class="collapse" for="c-42701877">[-]</label><label class="expand" for="c-42701877">[4 more]</label></div><br/><div class="children"><div class="content">Those password resets should have some sort of MFA step.</div><br/><div id="42703544" class="c"><input type="checkbox" id="c-42703544" checked=""/><div class="controls bullet"><span class="by">jpc0</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701877">parent</a><span>|</span><a href="#42701204">next</a><span>|</span><label class="collapse" for="c-42703544">[-]</label><label class="expand" for="c-42703544">[3 more]</label></div><br/><div class="children"><div class="content">Sue lost hee phone, she used KeePass for everything and didn&#x27;t back it up. She get some support from IT, what do they do to solve Sue&#x27;s problem?<p>They reset her password and 2FA and have her redo them. She probably gets a lecture about backups or she spurns a brand new company policy that &quot;Everyone should now use LastPass and nothing else is supported&quot;.<p>If they as administrators cannot do that, Sue has now lost significant business data, there will be a dexent amount of work stopped to get Sue onboarded again and this is a significant issue.<p>An auditable log that X reset Sue&#x27;s password ane 2FA codes at x time while at x location with biometric authentication is pretty secure. If X also ca nnot touch those logs the next strawman falls apart.</div><br/><div id="42706229" class="c"><input type="checkbox" id="c-42706229" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703544">parent</a><span>|</span><a href="#42701204">next</a><span>|</span><label class="collapse" for="c-42706229">[-]</label><label class="expand" for="c-42706229">[2 more]</label></div><br/><div class="children"><div class="content">What does this have to do with the scenario above? Of course you can reset the corporate SSO account as many times as you want. The point is that federated apps with a password reset flow should have some sort of MFA.</div><br/><div id="42706912" class="c"><input type="checkbox" id="c-42706912" checked=""/><div class="controls bullet"><span class="by">necovek</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42706229">parent</a><span>|</span><a href="#42701204">next</a><span>|</span><label class="collapse" for="c-42706912">[-]</label><label class="expand" for="c-42706912">[1 more]</label></div><br/><div class="children"><div class="content">It defeats the purpose of the first S in &quot;SSO&quot;: it&#x27;s not a Single Sign-On, and for Sue in GP&#x27;s example, after losing access to her MFA, she can&#x27;t access federated service data, nor can the domain operators restore her access.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42701204" class="c"><input type="checkbox" id="c-42701204" checked=""/><div class="controls bullet"><span class="by">PKop</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701095">parent</a><span>|</span><a href="#42701300">prev</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42701204">[-]</label><label class="expand" for="c-42701204">[7 more]</label></div><br/><div class="children"><div class="content">Yes but he&#x27;s saying the data on 3rd-party websites should be deleted by the failed startup when they shutdown not just left to sit there.</div><br/><div id="42701374" class="c"><input type="checkbox" id="c-42701374" checked=""/><div class="controls bullet"><span class="by">PeterFBell</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701204">parent</a><span>|</span><a href="#42703948">next</a><span>|</span><label class="collapse" for="c-42701374">[-]</label><label class="expand" for="c-42701374">[1 more]</label></div><br/><div class="children"><div class="content">He&#x27;s right, but having failed a number of times, after you&#x27;ve put all your savings into the business, fired all your team, notified and disappointed all of your investors and customers, helped your team find new gigs, filed all the dissolution paperwork, handled all the taxes, disposed responsibly of all of the assets and you now find yourself out of work and often out of cash, occasionally you&#x27;ll forget to jump through all the hoops to close down all of the SaaS accounts before you stop paying the bill personally to host the email accounts.<p>Of course perfect world you shut down earlier and in a more orderly fashion, but there are so many cases of companies almost failing and then not, it&#x27;s hard to shutter a company when there is a <i>chance</i> you may go out of business - especially when you feel you&#x27;re getting close to another raise or becoming default alive :(</div><br/></div></div><div id="42703948" class="c"><input type="checkbox" id="c-42703948" checked=""/><div class="controls bullet"><span class="by">mikeryan</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701204">parent</a><span>|</span><a href="#42701374">prev</a><span>|</span><a href="#42701466">next</a><span>|</span><label class="collapse" for="c-42703948">[-]</label><label class="expand" for="c-42703948">[1 more]</label></div><br/><div class="children"><div class="content">There’s an interesting question on service providers responsiblity who use Oauth for primary auth.<p>Should they reset all access to a company account if a domain transfers or becomes publicly available?</div><br/></div></div><div id="42701466" class="c"><input type="checkbox" id="c-42701466" checked=""/><div class="controls bullet"><span class="by">scarface_74</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701204">parent</a><span>|</span><a href="#42703948">prev</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42701466">[-]</label><label class="expand" for="c-42701466">[4 more]</label></div><br/><div class="children"><div class="content">There are some 3rd party accounts that can be accessed via your SSO or via your personal credentials once you leave.  The main ones I can think of is your brokerage account containing your 401K and vested RSUs and your payroll provider like ADP and Paylocity.  You still need to have access to past paystubs and end of year tax documents.</div><br/><div id="42701866" class="c"><input type="checkbox" id="c-42701866" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701466">parent</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42701866">[-]</label><label class="expand" for="c-42701866">[3 more]</label></div><br/><div class="children"><div class="content">SSO should stop working when the IdP org is disabled&#x2F;deleted. IdPs should not allow the org to be resurrected based solely on domain ownership alone. And if a new org is created with the same domain, the SP will need to be reconfigured with new OAuth client creds, and should be relying only on the `sub` claim anyway.<p>Any accounts you need after leaving a company should be tied to your personal email.</div><br/><div id="42701921" class="c"><input type="checkbox" id="c-42701921" checked=""/><div class="controls bullet"><span class="by">scarface_74</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701866">parent</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42701921">[-]</label><label class="expand" for="c-42701921">[2 more]</label></div><br/><div class="children"><div class="content">My brokerage account could be accessed by both.  I agree that is how it should work.  But my brokerage account provider is never told to disable access via my IdP.  It’s up to my former  IdP to not do something stupid like giving someone else my old email address.</div><br/><div id="42706934" class="c"><input type="checkbox" id="c-42706934" checked=""/><div class="controls bullet"><span class="by">necovek</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701921">parent</a><span>|</span><a href="#42702556">next</a><span>|</span><label class="collapse" for="c-42706934">[-]</label><label class="expand" for="c-42706934">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not IdP&#x27;s responsibility to &quot;fix&quot; the internet.<p>Just like someone can buy a home and will get mail targeting a previous owner, the same happens with domain names and emails.<p>Domains are, however, much cheaper and more abundant, so it happens more often.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42702556" class="c"><input type="checkbox" id="c-42702556" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42701095">prev</a><span>|</span><a href="#42700450">next</a><span>|</span><label class="collapse" for="c-42702556">[-]</label><label class="expand" for="c-42702556">[24 more]</label></div><br/><div class="children"><div class="content">I agree, I don&#x27;t think this is a problem with Google&#x27;s Oauth implementation, it&#x27;s a problem with the service providers who authenticate users via the mere existence of an email address ending in @company.com without checking if the email address actually belongs to an active employee.<p>If, when you logged into Slack via Google Oauth with the email address user@company.com, Slack checked with company.com whether user@company.com was a valid user that should be allowed to login, then this problem would be avoided entirely because the defunct company would no longer report any valid users.<p>This would also avoid further problems with attackers being able to login with unattended email addresses like support@company.com, as was discussed here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41818459">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41818459</a> (There&#x27;s a lot of discussion below about whether the &quot;sub&quot; claim is stable or not but it&#x27;s a red herring because of this IMO, also the proposed fix in the article wouldn&#x27;t address it either.)</div><br/><div id="42702852" class="c"><input type="checkbox" id="c-42702852" checked=""/><div class="controls bullet"><span class="by">rahimnathwani</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702556">parent</a><span>|</span><a href="#42702843">next</a><span>|</span><label class="collapse" for="c-42702852">[-]</label><label class="expand" for="c-42702852">[6 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  If, when you logged into Slack via Google Oauth with the email address user@company.com, Slack checked with company.com
</code></pre>
How would they check that?</div><br/><div id="42703216" class="c"><input type="checkbox" id="c-42703216" checked=""/><div class="controls bullet"><span class="by">nevir</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702852">parent</a><span>|</span><a href="#42703260">next</a><span>|</span><label class="collapse" for="c-42703216">[-]</label><label class="expand" for="c-42703216">[3 more]</label></div><br/><div class="children"><div class="content">By looking the account up with Google&#x27;s People API - <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;people" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;people</a><p>They would have to verify the account is active, AND the id hasn&#x27;t changed</div><br/><div id="42703293" class="c"><input type="checkbox" id="c-42703293" checked=""/><div class="controls bullet"><span class="by">rahimnathwani</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703216">parent</a><span>|</span><a href="#42703260">next</a><span>|</span><label class="collapse" for="c-42703293">[-]</label><label class="expand" for="c-42703293">[2 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  By looking the account up with Google&#x27;s People API - https:&#x2F;&#x2F;developers.google.com&#x2F;people
  They would have to verify the account is active
</code></pre>
If I log in using Google oauth, you <i>already</i> know the Google account is active.<p><pre><code>  AND the id hasn&#x27;t changed
</code></pre>
Yes, but that&#x27;s an additional check, separate from the one you suggested would eliminate the issue:<p><pre><code>  If, when you logged into Slack via Google Oauth with the email address user@company.com, Slack checked with company.com whether user@company.com was a valid user that should be allowed to login, then this problem would be avoided entirely because the defunct company would no longer report any valid users.</code></pre></div><br/><div id="42703583" class="c"><input type="checkbox" id="c-42703583" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703293">parent</a><span>|</span><a href="#42703260">next</a><span>|</span><label class="collapse" for="c-42703583">[-]</label><label class="expand" for="c-42703583">[1 more]</label></div><br/><div class="children"><div class="content">Right, this additional check should not be necessary in a typical OAuth or OIDC flow. This workaround is only necessary in this case because the API Google offers to services has a hole in it.</div><br/></div></div></div></div></div></div><div id="42703260" class="c"><input type="checkbox" id="c-42703260" checked=""/><div class="controls bullet"><span class="by">okdood64</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702852">parent</a><span>|</span><a href="#42703216">prev</a><span>|</span><a href="#42702843">next</a><span>|</span><label class="collapse" for="c-42703260">[-]</label><label class="expand" for="c-42703260">[2 more]</label></div><br/><div class="children"><div class="content">Either slack or some other third party provider could have a whitelist maintained by IT?<p>Just spitballing.</div><br/><div id="42703597" class="c"><input type="checkbox" id="c-42703597" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703260">parent</a><span>|</span><a href="#42702843">next</a><span>|</span><label class="collapse" for="c-42703597">[-]</label><label class="expand" for="c-42703597">[1 more]</label></div><br/><div class="children"><div class="content">It is certainly an option to pre-provision accounts in your application (e.g. Slack) and then have any users authenticating from the SSO product compared against the list of authorized users. And for some products which sell licenses by seat, this is exactly what they do.<p>But for many products which are meant to be available to an entire organization, this is a big part of what SSO was supposed to solve in the first place: IT no longer has to provision (and de-provision) user accounts in every single application. Maintaining an allowlist in each application makes this pointless.</div><br/></div></div></div></div></div></div><div id="42702843" class="c"><input type="checkbox" id="c-42702843" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702556">parent</a><span>|</span><a href="#42702852">prev</a><span>|</span><a href="#42704199">next</a><span>|</span><label class="collapse" for="c-42702843">[-]</label><label class="expand" for="c-42702843">[5 more]</label></div><br/><div class="children"><div class="content">This is a misunderstanding of the problem. See my comment downthread: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42701912">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42701912</a><p>&quot;hd&quot; is Google&#x27;s solution to this problem, and &quot;hd&quot; is also the source of this vulnerability.</div><br/><div id="42703399" class="c"><input type="checkbox" id="c-42703399" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702843">parent</a><span>|</span><a href="#42704199">next</a><span>|</span><label class="collapse" for="c-42703399">[-]</label><label class="expand" for="c-42703399">[4 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think so, but please go ahead and clarify if that is the case.</div><br/><div id="42703536" class="c"><input type="checkbox" id="c-42703536" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703399">parent</a><span>|</span><a href="#42704199">next</a><span>|</span><label class="collapse" for="c-42703536">[-]</label><label class="expand" for="c-42703536">[3 more]</label></div><br/><div class="children"><div class="content">Maybe you can clarify what part of the linked comment didn&#x27;t make sense? It&#x27;s a bit hard to make out where the confusion is if the above comment didn&#x27;t help clarify.</div><br/><div id="42708442" class="c"><input type="checkbox" id="c-42708442" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703536">parent</a><span>|</span><a href="#42704634">next</a><span>|</span><label class="collapse" for="c-42708442">[-]</label><label class="expand" for="c-42708442">[1 more]</label></div><br/><div class="children"><div class="content">If I&#x27;m understanding your comment correctly there are three different ways to connect Google SSO to your application:<p>1. SAML. This avoids the issue because certificates need to be exchanged between Google and your application, but an attacker that recreates a duplicate workspace using your domain won&#x27;t have access to those certificates. Only users from your workspace will be allowed to login.<p>2. A custom Google OIDC IdP configured for internal access only. This also avoids the issue because a secret key is required to set this up and the attacker won&#x27;t have access to that key. Again, only users from your workspace will be allowed to login.<p>3. The public Google OAuth API which will allow any Google user from any workspace (or non-workspace users) to login to your application.<p>Is this correct?</div><br/></div></div></div></div></div></div></div></div><div id="42704199" class="c"><input type="checkbox" id="c-42704199" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702556">parent</a><span>|</span><a href="#42702843">prev</a><span>|</span><a href="#42702905">next</a><span>|</span><label class="collapse" for="c-42704199">[-]</label><label class="expand" for="c-42704199">[1 more]</label></div><br/><div class="children"><div class="content">First of all, the whole point of SSO is that the only and final source on who are the valid active users is the IdP, in this case Google&#x27;s public OAuth instance. If the IdP says that the current request is coming from the real user1@example.com, you give them access. And Google&#x27;s public OAuth instance will confirm this even if the current Google Workspace associated with example.com is a different one than a few months ago (though the &quot;sub&quot; field of the attestation will be different than before, which the service provider is supposed to check).<p>Second of all, even if it was recognized that this is a different user1@example.com, they&#x27;d still have access to all sorts of company internal resources, that may still contain sensitive data, especially for small companies which inherently trust all employees.</div><br/></div></div><div id="42702905" class="c"><input type="checkbox" id="c-42702905" checked=""/><div class="controls bullet"><span class="by">red_trumpet</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702556">parent</a><span>|</span><a href="#42704199">prev</a><span>|</span><a href="#42700450">next</a><span>|</span><label class="collapse" for="c-42702905">[-]</label><label class="expand" for="c-42702905">[11 more]</label></div><br/><div class="children"><div class="content">If the attacker is in control of company.com, checking against this domain would not help.</div><br/><div id="42703037" class="c"><input type="checkbox" id="c-42703037" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702905">parent</a><span>|</span><a href="#42700450">next</a><span>|</span><label class="collapse" for="c-42703037">[-]</label><label class="expand" for="c-42703037">[10 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not talking about checking against the domain, but checking against a directory of active users.</div><br/><div id="42703220" class="c"><input type="checkbox" id="c-42703220" checked=""/><div class="controls bullet"><span class="by">cortesoft</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703037">parent</a><span>|</span><a href="#42703150">next</a><span>|</span><label class="collapse" for="c-42703220">[-]</label><label class="expand" for="c-42703220">[2 more]</label></div><br/><div class="children"><div class="content">Where does this “directory of active users” exist? If it is controlled by slack, then you are relying on a failed startup to properly notify ALL the 3rd parties when they shut down. Failed startups don’t always shut down cleanly like that.</div><br/><div id="42703440" class="c"><input type="checkbox" id="c-42703440" checked=""/><div class="controls bullet"><span class="by">chavesn</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703220">parent</a><span>|</span><a href="#42703150">next</a><span>|</span><label class="collapse" for="c-42703440">[-]</label><label class="expand" for="c-42703440">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Failed startups don’t always shut down cleanly like that.<p>Agreed, and with the number of services and the &quot;ease&quot; of oauth it&#x27;s likely impossible to even track. You could make a list of the major ones, but there could be hundreds per user, ultimately thousands of unique services used depending on the breadth of the startup&#x27;s activities.</div><br/></div></div></div></div><div id="42703150" class="c"><input type="checkbox" id="c-42703150" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703037">parent</a><span>|</span><a href="#42703220">prev</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42703150">[-]</label><label class="expand" for="c-42703150">[6 more]</label></div><br/><div class="children"><div class="content">That&#x27;s what an identity provider (e.g. AD, OneLogin, Okta, Duo SSO, Google OAuth, etc.) is supposed to be, ostensibly.</div><br/><div id="42703259" class="c"><input type="checkbox" id="c-42703259" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703150">parent</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42703259">[-]</label><label class="expand" for="c-42703259">[5 more]</label></div><br/><div class="children"><div class="content">Yes. If you&#x27;ve set up your Slack so each login checks against the identity provider to ensure an active user is logging in, that would resolve the issue, no?<p>Even if you take over company.com&#x27;s domain you can&#x27;t reconfigure company.com&#x27;s Slack to point to a new identity provider?</div><br/><div id="42703523" class="c"><input type="checkbox" id="c-42703523" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703259">parent</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42703523">[-]</label><label class="expand" for="c-42703523">[4 more]</label></div><br/><div class="children"><div class="content">I think you may be a bit confused about the players here. When you use Google OAuth to login, it _is_ your identity provider, and it is reporting to Slack that the user exists. Google is reporting the user exists because it exists in the Google Workspace directory. You use this as your source of truth for provisioning users, and they automatically get access to all of your company&#x27;s apps.<p>The problem is that even though the user has the same email (joe@example.com), and the same Google Workspace domain (&quot;hd&quot;: example.com), this is actually a _new_ Google Workspace account. But nothing Google provides to Slack allows them to detect this.<p>Slack, et al can fix this by _not_ using the public Google OAuth integration, and forcing every use to configure an individual internal Google OAuth integration. But they use the public one because Google has said it is a safe and secure way to operate their service.</div><br/><div id="42703695" class="c"><input type="checkbox" id="c-42703695" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703523">parent</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42703695">[-]</label><label class="expand" for="c-42703695">[3 more]</label></div><br/><div class="children"><div class="content">What I&#x27;m suggesting is if you were able to pre-configure Slack to only allow logins for valid users from Google Workspace X, then even if someone creates a new workspace Y with the same domain, Slack would still be checking against workspace X. (And similar for non-Google based identity providers.)</div><br/><div id="42703925" class="c"><input type="checkbox" id="c-42703925" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703695">parent</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42703925">[-]</label><label class="expand" for="c-42703925">[2 more]</label></div><br/><div class="children"><div class="content">And people are telling you that this is not possible with the Google public OAuth API. When Slack asks Google&#x27;s public OAuth instance if user abc@example.com is valid, Google checks with the Google Workspace associated to example.com, and returns to Slack a response saying &quot;yes, that user is valid, here is more information from example.com&quot;. This can be the same Workspace or another one, Google isn&#x27;t really telling Slack apparently.<p>Now, there is another field called &quot;sub&quot;, that <i>should</i> be a unique ID for the Google Workspace or the specific account, but it seems that this is not always stable, per the article, so people integrating with Google OAuth don&#x27;t trust it.</div><br/><div id="42708336" class="c"><input type="checkbox" id="c-42708336" checked=""/><div class="controls bullet"><span class="by">nodamage</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703925">parent</a><span>|</span><a href="#42703135">next</a><span>|</span><label class="collapse" for="c-42708336">[-]</label><label class="expand" for="c-42708336">[1 more]</label></div><br/><div class="children"><div class="content">&gt; And people are telling you that this is not possible with the Google public OAuth API.<p>Yes I understand, however it is possible to integrate Slack and Google SSO in such a way that it checks that the user belongs to the correct workspace, correct? Either via the SAML integration (<a href="https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;6357481" rel="nofollow">https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;6357481</a>) or an internal Google OAuth integration? The purpose of the public Google OAuth API as opposed to the previous two options is to allow logins from non-workspace or cross-workspace Google accounts, correct?</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42703135" class="c"><input type="checkbox" id="c-42703135" checked=""/><div class="controls bullet"><span class="by">batch12</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703037">parent</a><span>|</span><a href="#42703150">prev</a><span>|</span><a href="#42700450">next</a><span>|</span><label class="collapse" for="c-42703135">[-]</label><label class="expand" for="c-42703135">[1 more]</label></div><br/><div class="children"><div class="content">Where would this directory be stored?</div><br/></div></div></div></div></div></div></div></div><div id="42700450" class="c"><input type="checkbox" id="c-42700450" checked=""/><div class="controls bullet"><span class="by">simiones</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42702556">prev</a><span>|</span><a href="#42700590">next</a><span>|</span><label class="collapse" for="c-42700450">[-]</label><label class="expand" for="c-42700450">[2 more]</label></div><br/><div class="children"><div class="content">Yes, why the Slack or HR or interview etc. data would still exist while being inaccessible to the original owner is very strange. The article seems to take it as a foregone conclusion that those accounts should all be expected to still exist with all the business data, and I don&#x27;t know if this is based on the author&#x27;s experience, or it&#x27;s just a way to make the vuln sound far more serious than it really is.<p>On the other hand, I don&#x27;t think people normally expect that OAuth depends strictly on domain ownership like this. I think most would expect that it depends on some kind of secret being stored on the IdP account side, uniquely identifying the IdP account holder beyond the email addresses presented. With regular password-based authentication, with MFA, you would at least get an MFA prompt if someone had gotten access to your email address and was being sent a password reset code. But with this type of SSO, any MFA verification is done on the IdP side, so if the IdP recognizes anyone who controls example.com as the rightful owner of any claims, then there is nothing you can do as the former owner of example.com.</div><br/><div id="42702584" class="c"><input type="checkbox" id="c-42702584" checked=""/><div class="controls bullet"><span class="by">OtherShrezzing</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700450">parent</a><span>|</span><a href="#42700590">next</a><span>|</span><label class="collapse" for="c-42702584">[-]</label><label class="expand" for="c-42702584">[1 more]</label></div><br/><div class="children"><div class="content">&gt;why the Slack or HR or interview etc. data would still exist while being inaccessible to the original owner is very strange<p>Ever been in a company that&#x27;s collapsed before? Nobody hangs around to shut down the WorkDay account when they&#x27;ve been told they&#x27;re not getting paid for the last 29 days work.</div><br/></div></div></div></div><div id="42700590" class="c"><input type="checkbox" id="c-42700590" checked=""/><div class="controls bullet"><span class="by">chasemiller</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700450">prev</a><span>|</span><a href="#42700602">next</a><span>|</span><label class="collapse" for="c-42700590">[-]</label><label class="expand" for="c-42700590">[2 more]</label></div><br/><div class="children"><div class="content">Yes, it&#x27;s a failure on DankStartup&#x27;s part.<p>Not really much different than a user buying dankstartup.net, setting up a catch-all email, observing what comes in, and performing password resets for those accounts, allowing for account takeovers.<p>Calling it a vuln in oauth may be a bit hyperbolic, but Google could help prevent it.</div><br/><div id="42700837" class="c"><input type="checkbox" id="c-42700837" checked=""/><div class="controls bullet"><span class="by">OkGoDoIt</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700590">parent</a><span>|</span><a href="#42700602">next</a><span>|</span><label class="collapse" for="c-42700837">[-]</label><label class="expand" for="c-42700837">[1 more]</label></div><br/><div class="children"><div class="content">I have catchall email accounts in every domain name I own (mostly so I can do differentiated emails for every service to track&#x2F;combat leakage), and you would not believe the amount of emails I get that are intended for previous domain owners (and typos too). I haven’t actually done any reset password flows, but there are a bunch of social media and SaaS accounts I could easily take over if I wanted. I used to try to track down whoever the emails were intended to go to and forward it to them and let them know to change it, but that got to be too tedious so nowadays I just ignore them.<p>Still, I wouldn’t call this a vulnerability on the service provider’s part, it’s just user negligence.</div><br/></div></div></div></div><div id="42700602" class="c"><input type="checkbox" id="c-42700602" checked=""/><div class="controls bullet"><span class="by">placardloop</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700590">prev</a><span>|</span><a href="#42705817">next</a><span>|</span><label class="collapse" for="c-42700602">[-]</label><label class="expand" for="c-42700602">[12 more]</label></div><br/><div class="children"><div class="content">&gt; Suppose DankStartup folds … Isn&#x27;t that a failure on DankStartup&#x27;s part, to not shut down their business accounts?<p>Expecting an entity that has already failed* to not fail again isn’t an effective security control, unfortunately.<p>* - not every startup that folds has “failed”, but the point still stands</div><br/><div id="42700862" class="c"><input type="checkbox" id="c-42700862" checked=""/><div class="controls bullet"><span class="by">stackghost</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700602">parent</a><span>|</span><a href="#42705817">next</a><span>|</span><label class="collapse" for="c-42700862">[-]</label><label class="expand" for="c-42700862">[11 more]</label></div><br/><div class="children"><div class="content">&gt;Expecting an entity that has already failed* to not fail again isn’t an effective security control, unfortunately.<p>Sure, I&#x27;m sympathetic to that, but again I don&#x27;t see how that&#x27;s within the scope of oauth.</div><br/><div id="42701213" class="c"><input type="checkbox" id="c-42701213" checked=""/><div class="controls bullet"><span class="by">danudey</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700862">parent</a><span>|</span><a href="#42700946">next</a><span>|</span><label class="collapse" for="c-42701213">[-]</label><label class="expand" for="c-42701213">[7 more]</label></div><br/><div class="children"><div class="content">I register a Google Workspace and add CorpDomain.com to it. I then use that to OAuth to other companies (e.g. Slack, payroll companies, etc.). Then my company goes under or closes up and the domain lapses.<p>Someone else comes along, registers a completely different Google Workspace but attaches that same domain to it. The e-mail address is the same, but it&#x27;s obviously a new Google Workspace with new people, new payment info, new users, etc.<p>Google knows that these are two different workspaces and that there is effectively no connection between the two other than the domain, but they are not presenting that information through OAuth (which is possible) so other companies are not able to do any sort of diligence in ensuring that the correct people are accessing that data.<p>OAuth provides the capability to make this distinction, but Google is (or was?) refusing to provide data to other companies to allow them to make that distinction.<p>This sounds hyperbolic, but Google is effectively lying to these other services that that someone else is in fact the original person that service expects, even though Google knows full well (or is capable of knowing) that that is almost definitely not the case.</div><br/><div id="42701618" class="c"><input type="checkbox" id="c-42701618" checked=""/><div class="controls bullet"><span class="by">horsawlarway</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701213">parent</a><span>|</span><a href="#42701734">next</a><span>|</span><label class="collapse" for="c-42701618">[-]</label><label class="expand" for="c-42701618">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not entirely clear on what you expect in this case?<p>You&#x27;re registering with those 3rd parties using a property (the email address under corpdomain.com) that is now owned by the new party.<p>This feels a lot like complaining that you hired a lawn service and told them to mow at your address, and then didn&#x27;t update the address or cancel service after you moved.<p>You&#x27;ve sold the domain.  Assets associated with the domain are under the control of a new party.  For all Google knows, you did this entirely above board and in a coordinated fashion.<p>That new party controls the property.  Email resets will also dump right into their hands (They control the MX records for corpdomain.com now...).<p>Legally speaking, it&#x27;s not even clear you&#x27;re right - the new person might well be the person actually entitled and expressly supposed to be accessing that service <i>as that account</i> (if the domain was sold as part of an acquisition or sale).</div><br/><div id="42704263" class="c"><input type="checkbox" id="c-42704263" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701618">parent</a><span>|</span><a href="#42703221">next</a><span>|</span><label class="collapse" for="c-42704263">[-]</label><label class="expand" for="c-42704263">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Legally speaking, it&#x27;s not even clear you&#x27;re right - the new person might well be the person actually entitled and expressly supposed to be accessing that service as that account (if the domain was sold as part of an acquisition or sale).<p>No, this is absolutely not the case. If you were selling the identity, you would transfer access to the Google Workspace account. There is no reason whatsoever that a new Google Workspace account should have access to the same services as a completely different Google Workspace account just because they happen to use the same DNS domain.</div><br/></div></div><div id="42703221" class="c"><input type="checkbox" id="c-42703221" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701618">parent</a><span>|</span><a href="#42704263">prev</a><span>|</span><a href="#42703757">next</a><span>|</span><label class="collapse" for="c-42703221">[-]</label><label class="expand" for="c-42703221">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;m not entirely clear on what you expect in this case?<p>Not parent-poster, but from what I can piece together it sounds like the distinction between Google attesting that:<p>1. This is the person who currently controls the same e-mail address.<p>2. The is the person who currently controls a sub-account of the same Google Workspace which was in the past <i>identified by</i> this e-mail address.<p>&gt; You&#x27;ve sold the domain. Assets associated with the domain are under the control of a new party.<p>True, but that &quot;control&quot; does not (and should not) automatically mean <i>legal ownership</i> of every kind of internet account that was ever made with that e-mail address.<p>While the prior-controller has a degree of responsibility, so does Google when it <i>knows</i> that ownership of those other facets were not transferred.<p>&gt; This feels a lot like complaining that you hired a lawn service and told them to mow at your address, and then didn&#x27;t update the address or cancel service after you moved.<p>I feel the analogy need at least three kinds of party: The old&#x2F;new home owners, the lawn-cutting service, and a marketplace or middleman which is failing to pass along the change in ownership.</div><br/></div></div><div id="42703757" class="c"><input type="checkbox" id="c-42703757" checked=""/><div class="controls bullet"><span class="by">danudey</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701618">parent</a><span>|</span><a href="#42703221">prev</a><span>|</span><a href="#42701734">next</a><span>|</span><label class="collapse" for="c-42703757">[-]</label><label class="expand" for="c-42703757">[1 more]</label></div><br/><div class="children"><div class="content">The other reply to this comment kind of nailed it, but in short:<p>Right now Google, via OAuth, attests that someone&#x27;s identity is &quot;user@domain&quot; as a unique global key, even if they know that that user@domain is controlled by a new Google workspace (i.e. it is not the same people&#x2F;organization&#x2F;legal entity).<p>All Google has to do is attest that someone&#x27;s identity is (&quot;user@domain&quot;, &quot;unique workspace ID&quot;) as a unique global key and all of this will go away.<p>&gt; This feels a lot like complaining that you hired a lawn service and told them to mow at your address, and then didn&#x27;t update the address or cancel service after you moved.<p>I think it&#x27;s more like hiring a lawn service through a third party, and then, after you move, a second person moves into your house and calls the lawn service asking for a copy of all of the credit card receipts from your payments and they give it to the person because the third party assures them it&#x27;s the same person, even though it&#x27;s not, just because the address is the same.<p>&gt;  Email resets will also dump right into their hands (They control the MX records for corpdomain.com now...).<p>Well yes, and people shouldn&#x27;t use e-mail&#x2F;password authentication for that and many other reasons (unless 2FA is involved).<p>The difference is that, in this case, we are outsourcing authentication to Google under the assumption that Google will handle authentication <i>better</i> than just a username&#x2F;password combination; I&#x27;m relying on Google to say &quot;yes, this is who that person claims to be and we have verified that&quot;. The problem is that Google knows that they is <i>not</i> who they claim to be, that they just have the same e-mail address but <i>a different workspace</i>, but they&#x27;re still telling the other site that yep, it&#x27;s him for sure, absolutely, and the other site has no way of validating that any of that is true so they have to go with it.<p>&gt; Legally speaking, it&#x27;s not even clear you&#x27;re right - the new person might well be the person actually entitled and expressly supposed to be accessing that service as that account (if the domain was sold as part of an acquisition or sale).<p>Potentially yes, but if that were the case then they would have transferred ownership&#x2F;control of the workspace itself, including all of the accounts, email, google drive data, and so on, and not deleted the entire workspace and created a new one from scratch. In a case where they did want to do that (e.g. to migrate off of Google workspaces or consolidate) that seems like something they should do via customer support to ensure continuity.</div><br/></div></div></div></div><div id="42701734" class="c"><input type="checkbox" id="c-42701734" checked=""/><div class="controls bullet"><span class="by">adamc</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701213">parent</a><span>|</span><a href="#42701618">prev</a><span>|</span><a href="#42700946">next</a><span>|</span><label class="collapse" for="c-42701734">[-]</label><label class="expand" for="c-42701734">[2 more]</label></div><br/><div class="children"><div class="content">Seems like relying on domain alone is a design flaw of OAuth?</div><br/><div id="42703616" class="c"><input type="checkbox" id="c-42703616" checked=""/><div class="controls bullet"><span class="by">danudey</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701734">parent</a><span>|</span><a href="#42700946">next</a><span>|</span><label class="collapse" for="c-42703616">[-]</label><label class="expand" for="c-42703616">[1 more]</label></div><br/><div class="children"><div class="content">OAuth allows you to provide information above and beyond just the domain, and the article describes examples of how this could be done. This is just a flaw in how Google presents an identity to OAuth clients.<p>In other words, right now it&#x27;s basically &quot;user@domain&quot;, but it could be (&quot;user@domain&quot;, &quot;unique workspace ID&quot;) which would prevent these sorts of attacks as well as make logical sense.</div><br/></div></div></div></div></div></div><div id="42700946" class="c"><input type="checkbox" id="c-42700946" checked=""/><div class="controls bullet"><span class="by">placardloop</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700862">parent</a><span>|</span><a href="#42701213">prev</a><span>|</span><a href="#42705817">next</a><span>|</span><label class="collapse" for="c-42700946">[-]</label><label class="expand" for="c-42700946">[3 more]</label></div><br/><div class="children"><div class="content">If a security mechanism doesn’t account for failure cases, it’s a failure of the security mechanism.<p>It’s a hard problem to solve and I don’t have a solution, but it’s a core goal of every security tool to account for edge cases and failure cases like this. If you tell me that OAuth is completely insecure due to a security issue, it’s not going to make me feel any better if you say “but it’s totally not OAuths fault” - I don’t care who’s fault or scope it is, the end result of a security issue is the same, and to avoid it I’m just not going to use OAuth.</div><br/><div id="42701652" class="c"><input type="checkbox" id="c-42701652" checked=""/><div class="controls bullet"><span class="by">horsawlarway</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700946">parent</a><span>|</span><a href="#42705817">next</a><span>|</span><label class="collapse" for="c-42701652">[-]</label><label class="expand" for="c-42701652">[2 more]</label></div><br/><div class="children"><div class="content">So you use email&#x2F;pass and the reset password email dumps right to the new party as well, because they control the MX records for the domain?</div><br/><div id="42701927" class="c"><input type="checkbox" id="c-42701927" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701652">parent</a><span>|</span><a href="#42705817">next</a><span>|</span><label class="collapse" for="c-42701927">[-]</label><label class="expand" for="c-42701927">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why allowing account recovery using (exclusively) email is indeed a security problem.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42705817" class="c"><input type="checkbox" id="c-42705817" checked=""/><div class="controls bullet"><span class="by">sowbug</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700602">prev</a><span>|</span><a href="#42701720">next</a><span>|</span><label class="collapse" for="c-42705817">[-]</label><label class="expand" for="c-42705817">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s similar to Gmail or Hotmail or Yahoo Mail hypothetically allowing a new user to adopt an abandoned email address. Most email services don&#x27;t allow this for this very reason.</div><br/></div></div><div id="42701720" class="c"><input type="checkbox" id="c-42701720" checked=""/><div class="controls bullet"><span class="by">LocalPCGuy</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42705817">prev</a><span>|</span><a href="#42703206">next</a><span>|</span><label class="collapse" for="c-42701720">[-]</label><label class="expand" for="c-42701720">[1 more]</label></div><br/><div class="children"><div class="content">The scenario I was envisioning was a simple as a developer that worked at that startup added DankStartup email to their Github account, committed a bunch of code. Company shut down, but dev doesn&#x27;t think to disassociate that domain&#x2F;email. Malicious actor uses this technique to then sign into the Github account, gaining access to that developer&#x27;s account, not just the DankStartup repos which were probably disabled after non-payment.<p>Now, obviously some fault in that scenario lay with the person who 1) used the same account, and 2) didn&#x27;t remove the old email once the startup failed. But I&#x27;m just using that as a kind of example - there may be other accounts as others have said that need to be accessible years down the line, like financial records and the like, regardless of whether the company is still around.</div><br/></div></div><div id="42703206" class="c"><input type="checkbox" id="c-42703206" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42701720">prev</a><span>|</span><a href="#42704563">next</a><span>|</span><label class="collapse" for="c-42703206">[-]</label><label class="expand" for="c-42703206">[1 more]</label></div><br/><div class="children"><div class="content">&gt; DankStartup&#x27;s O365,<p>If you wanted to try to re-take over a pre-registered domain in Azure&#x2F;M365, you would need to involve Microsoft Support who would require you to prove via government documentation that you were the same entity for the now-abandoned Azure&#x2F;M365 account.<p>Creating a new tenant using the same public domain won&#x27;t get you access to the Azure&#x2F;M365 tenant of a previous customer, you would have a different internal domain name (dankstartup2.onmicrosoft.com).<p>At best you could register your domain post-expiration of the previous tenant and impersonate them &gt;90 days out.</div><br/></div></div><div id="42704563" class="c"><input type="checkbox" id="c-42704563" checked=""/><div class="controls bullet"><span class="by">Rebelgecko</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42703206">prev</a><span>|</span><a href="#42702131">next</a><span>|</span><label class="collapse" for="c-42704563">[-]</label><label class="expand" for="c-42704563">[1 more]</label></div><br/><div class="children"><div class="content">Is this basically equivalent to registering a domain, setting up email, and getting services to send you password reset emails to recycled addresses?</div><br/></div></div><div id="42702131" class="c"><input type="checkbox" id="c-42702131" checked=""/><div class="controls bullet"><span class="by">redleader55</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42704563">prev</a><span>|</span><a href="#42700456">next</a><span>|</span><label class="collapse" for="c-42702131">[-]</label><label class="expand" for="c-42702131">[1 more]</label></div><br/><div class="children"><div class="content">Besides the github account with a legitimate name, but impostor ownership, I can imagine another case which is problematic. HR SaaS companies might be required by law to maintain the account for a period of time - let&#x27;s say until the end of the next fiscal year. The account still existing is not a failure on either Google, the SaaS company or DankStartup. The problem, as other posters mentioned is the fact the new account has the same ID in OIDC as the previous one, which is what the author of TFA proposes.</div><br/></div></div><div id="42700456" class="c"><input type="checkbox" id="c-42700456" checked=""/><div class="controls bullet"><span class="by">cosmotic</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42702131">prev</a><span>|</span><a href="#42702033">next</a><span>|</span><label class="collapse" for="c-42700456">[-]</label><label class="expand" for="c-42700456">[4 more]</label></div><br/><div class="children"><div class="content">Third parties is google as single sign on. If such an org&#x2F;domain is abandoned, a malicious person could &#x27;resurrect&#x27; the accounts on those third party sites. It&#x27;s kind of like a similar situation where a user deletes an email account and then someone else creates an new one in its place, and now they have access to all the third party password reset links. Except in the case linked above, the user never had the ability to delete their accounts before off boarding, and the abstraction isn&#x27;t just an email, but the account itself.</div><br/><div id="42700723" class="c"><input type="checkbox" id="c-42700723" checked=""/><div class="controls bullet"><span class="by">reginald78</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700456">parent</a><span>|</span><a href="#42700722">next</a><span>|</span><label class="collapse" for="c-42700723">[-]</label><label class="expand" for="c-42700723">[2 more]</label></div><br/><div class="children"><div class="content">In emails case all the larger providers I&#x27;m aware of retire addresses to prevent this sort of abuse, probably learned the hard way. Could Google OAuth do something similar here?<p>It now occurs to me that large businesses might have the same issue with emails and former employees (easy to imagine John Smith departing and at a later date John Smith being hired) so I wonder how they typically handle this.</div><br/><div id="42701543" class="c"><input type="checkbox" id="c-42701543" checked=""/><div class="controls bullet"><span class="by">scarface_74</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700723">parent</a><span>|</span><a href="#42700722">next</a><span>|</span><label class="collapse" for="c-42701543">[-]</label><label class="expand" for="c-42701543">[1 more]</label></div><br/><div class="children"><div class="content">Companies generally don’t reuse emails.  If you come back, you can sometimes get your old email and access to your old enabled services.<p>I know when interns were at Amazon and left, their accounts were disabled.  But when they came back, they got their old accounts back and the related Slack users</div><br/></div></div></div></div></div></div><div id="42702033" class="c"><input type="checkbox" id="c-42702033" checked=""/><div class="controls bullet"><span class="by">stonemetal12</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700456">prev</a><span>|</span><a href="#42702136">next</a><span>|</span><label class="collapse" for="c-42702033">[-]</label><label class="expand" for="c-42702033">[1 more]</label></div><br/><div class="children"><div class="content">What if DankStartup doesn&#x27;t fold and just forgot to renew their domain, or lost control of their domain for some reason. OAuth shouldn&#x27;t let you Auth someone else&#x27;s account just because you can hijack their domain.</div><br/></div></div><div id="42702136" class="c"><input type="checkbox" id="c-42702136" checked=""/><div class="controls bullet"><span class="by">hk1337</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42702033">prev</a><span>|</span><a href="#42703812">next</a><span>|</span><label class="collapse" for="c-42702136">[-]</label><label class="expand" for="c-42702136">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it would be 100% on the failed startup considering most of, if not all, of the applications mentioned likely do not actually delete accounts even when you say to delete them. There probably could be <i>some</i> allowance made for the situation but also you&#x27;re repurposing the domain of a failed startup.<p>I don&#x27;t think the problem was necessarily with Google though as I believe they create a unique ID for the domain. The problem with be with the other services like ChatGPT, Slack, etc that associate with the domain and create accounts for each user in the domain.</div><br/></div></div><div id="42703812" class="c"><input type="checkbox" id="c-42703812" checked=""/><div class="controls bullet"><span class="by">tart-lemonade</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42702136">prev</a><span>|</span><a href="#42700748">next</a><span>|</span><label class="collapse" for="c-42703812">[-]</label><label class="expand" for="c-42703812">[4 more]</label></div><br/><div class="children"><div class="content">My father changed careers and dissolved his business over a decade ago, at which point he let his old domain lapse.<p>A couple years ago, I began to wonder if anyone was still trying to reach him, so I bought the domain (domain squatters weren&#x27;t even interested in it anymore) and setup an inbox for his old email address. In less than a week, the unread count was in the triple digits. It was basically all marketing and spam so I closed the inbox within the month, but multiple years with a 100% bounce rate is apparently not enough to deter LexisNexis &amp; friends from trying to win him back.<p>This is a corporate planning&#x2F;governance problem, not a vulnerability in Oauth, and I bet the problem is even bigger than TFA describes since any previous domains of a company that were almost-but-not-completely migrated away from could easily be taken advantage of, possibly to even greater effect since the company likely has a bunch of systems still up which have the domains whitelisted. (Which makes me wonder if there are hacking groups who use domain squatting as a front or side-gig while they take advantage of lapsed corporate domains.)</div><br/><div id="42704334" class="c"><input type="checkbox" id="c-42704334" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42703812">parent</a><span>|</span><a href="#42700748">next</a><span>|</span><label class="collapse" for="c-42704334">[-]</label><label class="expand" for="c-42704334">[3 more]</label></div><br/><div class="children"><div class="content">This is very much a critical flaw in systems which rely entirely on email or domain names as the sole security factor. OAuth itself is flawed in that it allows this terrible practice, though to be fair it does discourage it. Google&#x27;s specific OAuth solution encourages this compromised practice even more, because the only identifier it provides for a user group is the domain name associated with the account (in the &quot;hd&quot; field). For individual users they at least provide a &quot;sub&quot; field with a unique user ID (though per the article, it seems this is possibly flaky, or at least misunderstood) - this could be used to make sure that a new user@example.com doesn&#x27;t get access to the old user@example.com account. But to check if a new user should have access to the organization account, there is nothing that Google provides that can be used securely: all they tell the service provider is that this is a new valid user for the example.com org, not that this is a completely different example.com org.</div><br/><div id="42704476" class="c"><input type="checkbox" id="c-42704476" checked=""/><div class="controls bullet"><span class="by">tart-lemonade</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42704334">parent</a><span>|</span><a href="#42700748">next</a><span>|</span><label class="collapse" for="c-42704476">[-]</label><label class="expand" for="c-42704476">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a really good point. Perhaps the protocol should be expanded with an explicit identifier unique to an extant legal entity (or string of identifiers, to account for ownership changes like acquisitions), so it would be easy for SSO-enabled applications to keep previous tenants&#x27; data safe from someone who just buys the domain later on.<p>Of course, this would still rely on the provider: it might be a great solution for large providers like Google which can implement ironclad formal verification procedures, but if you and the previous company self-hosted SSO, you control the response and can impersonate them completely.</div><br/><div id="42708228" class="c"><input type="checkbox" id="c-42708228" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42704476">parent</a><span>|</span><a href="#42700748">next</a><span>|</span><label class="collapse" for="c-42708228">[-]</label><label class="expand" for="c-42708228">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it would need to go that far. Simply tying it to a Google Workspace account and not to the domain should be plenty good enough. Google knows if example.com changes between being associated with Google Workspace A to Google Workspace B. But it&#x27;s not including that info in the OAuth claims.</div><br/></div></div></div></div></div></div></div></div><div id="42700748" class="c"><input type="checkbox" id="c-42700748" checked=""/><div class="controls bullet"><span class="by">YetAnotherNick</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42703812">prev</a><span>|</span><a href="#42700355">next</a><span>|</span><label class="collapse" for="c-42700748">[-]</label><label class="expand" for="c-42700748">[6 more]</label></div><br/><div class="children"><div class="content">And not only that, almost every form of auth has the same vulnerability not just log in with Google. If you own the domain, you own the email IDs as well and you can very likely reset password.</div><br/><div id="42701848" class="c"><input type="checkbox" id="c-42701848" checked=""/><div class="controls bullet"><span class="by">horsawlarway</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700748">parent</a><span>|</span><a href="#42700355">next</a><span>|</span><label class="collapse" for="c-42701848">[-]</label><label class="expand" for="c-42701848">[5 more]</label></div><br/><div class="children"><div class="content">Yeah, this is the part I&#x27;m struggling with.  This is absolutely not unique to google oauth, it genuinely seems like a misunderstanding of how the web manages trust.<p>If you own the domain, you own all the property associated with the domain, including all the old email addresses.  Magic links and password resets are all going to give the new owner access.<p>Your best bet as a solution is to be using strict 2fa (ex - a yubikey might help here) but even that is likely just &quot;a conversation with support&quot; away from being circumvented.<p>This is why winding down a company is supposed to have specific stages and policies associated with the dissolution.  You don&#x27;t just abandon the offices and leave all the filing cabinets behind either, for similar reasons...</div><br/><div id="42704711" class="c"><input type="checkbox" id="c-42704711" checked=""/><div class="controls bullet"><span class="by">brookst</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701848">parent</a><span>|</span><a href="#42705579">next</a><span>|</span><label class="collapse" for="c-42704711">[-]</label><label class="expand" for="c-42704711">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think the claim is that Google has introduced a totally novel vuln, just that they are a stable, trusted middleman who is failing to mitigate a common vuln where they can.<p>You don&#x27;t abandon filing cabinets, but given that some percentage of startup failures are sudden and surprising and the people who could do something are unmotivated &#x2F; unable to, it&#x27;s not a best practice for a commercial landlord to put abandoned files on the street with a sign &quot;free&quot;, files and all. Maybe they have a legal right to, but it&#x27;s not how I would operate in that situation.</div><br/></div></div><div id="42705579" class="c"><input type="checkbox" id="c-42705579" checked=""/><div class="controls bullet"><span class="by">pbhjpbhj</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701848">parent</a><span>|</span><a href="#42704711">prev</a><span>|</span><a href="#42701939">next</a><span>|</span><label class="collapse" for="c-42705579">[-]</label><label class="expand" for="c-42705579">[1 more]</label></div><br/><div class="children"><div class="content">It seems to be at the registry level. But registries do show changes in owner [implicitly at least].<p>Maybe there needs to be a way to do some signalling&#x2F;lookup when domains changes hands.<p>Sounds like a job for a blockchain, lol.</div><br/></div></div><div id="42701939" class="c"><input type="checkbox" id="c-42701939" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701848">parent</a><span>|</span><a href="#42705579">prev</a><span>|</span><a href="#42700355">next</a><span>|</span><label class="collapse" for="c-42701939">[-]</label><label class="expand" for="c-42701939">[2 more]</label></div><br/><div class="children"><div class="content">&gt;  Magic links and password resets are all going to give the new owner access.<p>Which is why you should never exclusively rely on either for sensitive services.</div><br/><div id="42706745" class="c"><input type="checkbox" id="c-42706745" checked=""/><div class="controls bullet"><span class="by">YetAnotherNick</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701939">parent</a><span>|</span><a href="#42700355">next</a><span>|</span><label class="collapse" for="c-42706745">[-]</label><label class="expand" for="c-42706745">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s better than SMS based password recovery or &quot;call support to reset your password&quot;. What do you suggest is the best approach.</div><br/></div></div></div></div></div></div></div></div><div id="42700355" class="c"><input type="checkbox" id="c-42700355" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700748">prev</a><span>|</span><a href="#42704857">next</a><span>|</span><label class="collapse" for="c-42700355">[-]</label><label class="expand" for="c-42700355">[7 more]</label></div><br/><div class="children"><div class="content">The contention isn&#x27;t that you can impersonate DankStartup, that&#x27;s obviously not a vulnerability since you are indeed the domain owner.  It&#x27;s that former entities with DankStartup accounts might have used OAuth to create relationships of their own.  And when the startup folds, they don&#x27;t magically disappear.<p>Basically if Sally, the CTO of DankStartup, signed up for Taskrabbit or whatnot, it&#x27;s possible for you as the owner of the domain to impersonate Sally in the context of that relationship.<p>Obviously the root cause here is that someone misused an account to do something not related to the business.  And the actual impact is <i>probably</i> low since high value services tend strongly not to take tiny email domains as identity roots (i.e. sally@dankstartup.com clearly doesn&#x27;t have a Vanguard account to steal).<p>So... like most security announcements it&#x27;s oversold and spun.  But it&#x27;s real enough as I read it.</div><br/><div id="42700896" class="c"><input type="checkbox" id="c-42700896" checked=""/><div class="controls bullet"><span class="by">OkGoDoIt</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700355">parent</a><span>|</span><a href="#42700519">next</a><span>|</span><label class="collapse" for="c-42700896">[-]</label><label class="expand" for="c-42700896">[2 more]</label></div><br/><div class="children"><div class="content">Why do you assume sally@dankstartup.com doesn’t have a vanguard account? I’ve absolutely had similar retirement account logins that became difficult to access once I left that employer. Had to contact HR and get them to help me log into my account. If the company had folded during that timeframe I would’ve been screwed. Of course for financial institutions you can probably recover your account through some identity proving process, and generally money transfers require a second factor sms auth, but a domain takeover would probably have been sufficient to at least get someone logged in and able to see my account balance.</div><br/><div id="42701298" class="c"><input type="checkbox" id="c-42701298" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700896">parent</a><span>|</span><a href="#42700519">next</a><span>|</span><label class="collapse" for="c-42701298">[-]</label><label class="expand" for="c-42701298">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I’ve absolutely had similar retirement account logins that became difficult to access once I left that employer.<p>Yes, but your employer&#x27;s email domain wasn&#x27;t repurposed.  It&#x27;s still an operating business, and the account is still there, and still yours.  And for accounting reasons they still remember who you are and can recover your important information for creditors, etc...  The fact that it&#x27;s difficult for you to access that account is a <i>feature</i> and  not a bug, because it means it&#x27;s difficult for others too.  But you can, and people do all the time.<p>The case here is <i>failed</i> businesses who have abandoned their domains and employee account history.  Almost by definition that&#x27;s a violation of financial regulation already.  And this, btw, is the reason why DankStartup employees couldn&#x27;t use their work emails to open Vanguard accounts.</div><br/></div></div></div></div><div id="42700519" class="c"><input type="checkbox" id="c-42700519" checked=""/><div class="controls bullet"><span class="by">simiones</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700355">parent</a><span>|</span><a href="#42700896">prev</a><span>|</span><a href="#42701088">next</a><span>|</span><label class="collapse" for="c-42700519">[-]</label><label class="expand" for="c-42700519">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Basically if Sally, the CTO of DankStartup, signed up for Taskrabbit or whatnot, it&#x27;s possible for you as the owner of the domain to impersonate Sally in the context of that relationship.<p>I don&#x27;t think this is the issue, unless someone went to some pretty extreme lengths. Configuring OAuth such that the company Google Workspaces account is recognized by Taskrabbit as a valid SSO option is not as simple as signing up to Taskrabbit with your company email instead of personal email.</div><br/><div id="42700942" class="c"><input type="checkbox" id="c-42700942" checked=""/><div class="controls bullet"><span class="by">nijave</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700519">parent</a><span>|</span><a href="#42701088">next</a><span>|</span><label class="collapse" for="c-42700942">[-]</label><label class="expand" for="c-42700942">[2 more]</label></div><br/><div class="children"><div class="content">Even then (in my experience) it&#x27;s pretty common to setup an email based account and it will auto link to an oauth one that already exists. Even if Google revoked oauth, many platforms let you use the email directly to login</div><br/><div id="42701799" class="c"><input type="checkbox" id="c-42701799" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700942">parent</a><span>|</span><a href="#42701088">next</a><span>|</span><label class="collapse" for="c-42701799">[-]</label><label class="expand" for="c-42701799">[1 more]</label></div><br/><div class="children"><div class="content">Yes, but that&#x27;s not a bug with Google OAuth.  If Taskrabbit (in the example) decides to trust dankstartup.com emails as a root of trust for identity even though the business failed, that&#x27;s on them[1], and certainly nothing Google can have prevented.<p>The contention in the article is that dankstartup.com&#x27;s new owners can leverage their control of the domain to get access to existing OAuth-based sessions that will look to the service providers as if Google has authenticated the account holder.<p>[1] And just to repeat: that risk is <i>precisely</i> why serious businesses (Vanguard in the example) don&#x27;t allow obscure email domains as authentication anymore.</div><br/></div></div></div></div></div></div><div id="42701088" class="c"><input type="checkbox" id="c-42701088" checked=""/><div class="controls bullet"><span class="by">ensignavenger</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42700355">parent</a><span>|</span><a href="#42700519">prev</a><span>|</span><a href="#42704857">next</a><span>|</span><label class="collapse" for="c-42701088">[-]</label><label class="expand" for="c-42701088">[1 more]</label></div><br/><div class="children"><div class="content">That sounds like a TaskRabbit vulnerability (in your example), not a Google vuln?  It is also a vulnerability in any email based sign in, which relies on email alone without a password to demonstrate account ownership.  (Including password resets that rely on email).</div><br/></div></div></div></div><div id="42704857" class="c"><input type="checkbox" id="c-42704857" checked=""/><div class="controls bullet"><span class="by">deepsun</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42700355">prev</a><span>|</span><a href="#42701179">next</a><span>|</span><label class="collapse" for="c-42704857">[-]</label><label class="expand" for="c-42704857">[1 more]</label></div><br/><div class="children"><div class="content">&gt; a failure on DankStartup&#x27;s part, to not shut down their business accounts<p>They seized operations, why should they be responsible for any other assets?<p>I mean ethically yes of course. But there&#x27;s no law&#x2F;obligations to make sure domains are closed.</div><br/></div></div><div id="42701179" class="c"><input type="checkbox" id="c-42701179" checked=""/><div class="controls bullet"><span class="by">riffic</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42704857">prev</a><span>|</span><a href="#42701144">next</a><span>|</span><label class="collapse" for="c-42701179">[-]</label><label class="expand" for="c-42701179">[1 more]</label></div><br/><div class="children"><div class="content">it&#x27;s vital to have extremely skilled and nuanced people managing bug and security report triage because it seems many can overlook the complexities being given.</div><br/></div></div><div id="42701144" class="c"><input type="checkbox" id="c-42701144" checked=""/><div class="controls bullet"><span class="by">VILINBR</span><span>|</span><a href="#42700255">parent</a><span>|</span><a href="#42701179">prev</a><span>|</span><a href="#42700760">next</a><span>|</span><label class="collapse" for="c-42701144">[-]</label><label class="expand" for="c-42701144">[9 more]</label></div><br/><div class="children"><div class="content">whats is TFA ?</div><br/><div id="42701246" class="c"><input type="checkbox" id="c-42701246" checked=""/><div class="controls bullet"><span class="by">0xffff2</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701144">parent</a><span>|</span><a href="#42701223">next</a><span>|</span><label class="collapse" for="c-42701246">[-]</label><label class="expand" for="c-42701246">[2 more]</label></div><br/><div class="children"><div class="content">&quot;The F-ing article&quot; (derived from old internet slang &quot;RTFM&quot;, for &quot;Read the F-ing manual&quot;, a thing that new users were prone not to do before getting online and asking questions easily answered by RTFM.)</div><br/><div id="42701312" class="c"><input type="checkbox" id="c-42701312" checked=""/><div class="controls bullet"><span class="by">VILINBR</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701246">parent</a><span>|</span><a href="#42701223">next</a><span>|</span><label class="collapse" for="c-42701312">[-]</label><label class="expand" for="c-42701312">[1 more]</label></div><br/><div class="children"><div class="content">thanks</div><br/></div></div></div></div><div id="42701235" class="c"><input type="checkbox" id="c-42701235" checked=""/><div class="controls bullet"><span class="by">danudey</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701144">parent</a><span>|</span><a href="#42701223">prev</a><span>|</span><a href="#42700760">next</a><span>|</span><label class="collapse" for="c-42701235">[-]</label><label class="expand" for="c-42701235">[5 more]</label></div><br/><div class="children"><div class="content">&quot;The f___ing article&quot;</div><br/><div id="42701376" class="c"><input type="checkbox" id="c-42701376" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701235">parent</a><span>|</span><a href="#42701261">next</a><span>|</span><label class="collapse" for="c-42701376">[-]</label><label class="expand" for="c-42701376">[3 more]</label></div><br/><div class="children"><div class="content">In polite terms it can also mean “the featured article”. And IMO it makes more sense to read it that way in a top-level comment.<p>Whereas reading it as the f’ing article makes more sense when the word “TFA” is used in a response to another comment like “well, you say that but TFA said such and such”.</div><br/><div id="42702886" class="c"><input type="checkbox" id="c-42702886" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701376">parent</a><span>|</span><a href="#42701261">next</a><span>|</span><label class="collapse" for="c-42702886">[-]</label><label class="expand" for="c-42702886">[2 more]</label></div><br/><div class="children"><div class="content">Agreed.  I&#x27;ve also seen &quot;The Fine Article&quot;</div><br/><div id="42705152" class="c"><input type="checkbox" id="c-42705152" checked=""/><div class="controls bullet"><span class="by">pimlottc</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42702886">parent</a><span>|</span><a href="#42701261">next</a><span>|</span><label class="collapse" for="c-42705152">[-]</label><label class="expand" for="c-42705152">[1 more]</label></div><br/><div class="children"><div class="content">This is the old school “polite” version, as in, “read the fine manual”</div><br/></div></div></div></div></div></div><div id="42701261" class="c"><input type="checkbox" id="c-42701261" checked=""/><div class="controls bullet"><span class="by">VILINBR</span><span>|</span><a href="#42700255">root</a><span>|</span><a href="#42701235">parent</a><span>|</span><a href="#42701376">prev</a><span>|</span><a href="#42700760">next</a><span>|</span><label class="collapse" for="c-42701261">[-]</label><label class="expand" for="c-42701261">[1 more]</label></div><br/><div class="children"><div class="content">thanks</div><br/></div></div></div></div></div></div></div></div><div id="42700760" class="c"><input type="checkbox" id="c-42700760" checked=""/><div class="controls bullet"><span class="by">loginatnine</span><span>|</span><a href="#42700255">prev</a><span>|</span><a href="#42700386">next</a><span>|</span><label class="collapse" for="c-42700760">[-]</label><label class="expand" for="c-42700760">[20 more]</label></div><br/><div class="children"><div class="content">I really don&#x27;t understand here, the proper way to use Google&#x27;s OpenID implementation to authenticate someone is to use the `sub` claim. Don&#x27;t use the email, don&#x27;t verify it yourself, use the `sub` claim. It&#x27;s a known fact and is properly documented[1].<p>If the `sub` changes, it&#x27;s because it&#x27;s not necessarily the same person so have a flow ready for that. It could be an employee left and came back, a domain change, an IT error that lead to a reprovisioning of the user, etc.<p>I also fail to see how the proposed solution of having a &#x27;A unique user ID that doesn’t change over time&#x27; is different from the `sub` claim. However, the new ID associated to the domain could make sense to enforce a strong &#x27;Everyone from the @domain.com has access&#x27; statement.<p>[1] <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;gsi&#x2F;web&#x2F;reference&#x2F;js-reference#credential" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;gsi&#x2F;web&#x2F;reference&#x2F;js-...</a></div><br/><div id="42707082" class="c"><input type="checkbox" id="c-42707082" checked=""/><div class="controls bullet"><span class="by">jbmsf</span><span>|</span><a href="#42700760">parent</a><span>|</span><a href="#42700840">next</a><span>|</span><label class="collapse" for="c-42707082">[-]</label><label class="expand" for="c-42707082">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a reason this happen though. Whether you like it or not and regardless what the standards say, people want a technology that matches with the identifiers they want to use (eg email) and not whatever opaque value happens to be in the sub claim.<p>I don&#x27;t like blaming users for wanting something sensible.</div><br/></div></div><div id="42700840" class="c"><input type="checkbox" id="c-42700840" checked=""/><div class="controls bullet"><span class="by">Timshel</span><span>|</span><a href="#42700760">parent</a><span>|</span><a href="#42707082">prev</a><span>|</span><a href="#42700877">next</a><span>|</span><label class="collapse" for="c-42700840">[-]</label><label class="expand" for="c-42700840">[12 more]</label></div><br/><div class="children"><div class="content">It all depends on how true this statement is:<p>&gt; “The sub claim changes in about 0.04% of logins from Log in with Google. For us, that&#x27;s hundreds of users last week”.</div><br/><div id="42700967" class="c"><input type="checkbox" id="c-42700967" checked=""/><div class="controls bullet"><span class="by">loginatnine</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700840">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42700967">[-]</label><label class="expand" for="c-42700967">[6 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been working with an app that uses Google to login for the past 10 years, and I&#x27;ve had problems with sub changing when these situations happened : 
- Domain change
- Company being bought by another one and being integrated in their Google Workspace
- Employee leaving and coming back<p>To us, it&#x27;s very very far from the quoted 0.04% which is to me very high. I had to deal with it 5-6 times in the past 10 years but of course that number will vary depending on the usage of your app and I&#x27;m not gonna venture and put a percentage on it.</div><br/><div id="42701271" class="c"><input type="checkbox" id="c-42701271" checked=""/><div class="controls bullet"><span class="by">herczegzsolt</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700967">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42701271">[-]</label><label class="expand" for="c-42701271">[5 more]</label></div><br/><div class="children"><div class="content">In my opponion, all of those cases very well justify a manual check, or some sort of extended identification before the user is let in.<p>It indicates a deeper cultural issue of &quot;convenience&#x2F;profit over security&quot; if those are sufficient reasons to not check the sub
parameter.</div><br/><div id="42703512" class="c"><input type="checkbox" id="c-42703512" checked=""/><div class="controls bullet"><span class="by">chavesn</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42701271">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42703512">[-]</label><label class="expand" for="c-42703512">[4 more]</label></div><br/><div class="children"><div class="content">&gt;  all of those cases very well justify a manual check, or some sort of extended identification before the user is let in.<p>Just curious, what would that check look like that&#x27;s not open to the same vuln?</div><br/><div id="42703863" class="c"><input type="checkbox" id="c-42703863" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42703512">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42703863">[-]</label><label class="expand" for="c-42703863">[3 more]</label></div><br/><div class="children"><div class="content">&quot;Your account seems to have changed hands and is locked for your security.<p>The person paying for your subscription must contact us to verify your account is still legit.&quot;</div><br/><div id="42704031" class="c"><input type="checkbox" id="c-42704031" checked=""/><div class="controls bullet"><span class="by">chavesn</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42703863">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42704031">[-]</label><label class="expand" for="c-42704031">[2 more]</label></div><br/><div class="children"><div class="content">Right, and how would you further verify “the person paying for your subscription”?</div><br/><div id="42704109" class="c"><input type="checkbox" id="c-42704109" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42704031">parent</a><span>|</span><a href="#42703896">next</a><span>|</span><label class="collapse" for="c-42704109">[-]</label><label class="expand" for="c-42704109">[1 more]</label></div><br/><div class="children"><div class="content">Payment info</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42703896" class="c"><input type="checkbox" id="c-42703896" checked=""/><div class="controls bullet"><span class="by">nixosbestos</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700840">parent</a><span>|</span><a href="#42700967">prev</a><span>|</span><a href="#42703690">next</a><span>|</span><label class="collapse" for="c-42703896">[-]</label><label class="expand" for="c-42703896">[3 more]</label></div><br/><div class="children"><div class="content">Exactly. How is there an entire alarmist article and 165 comments on this thread. This comment, and it&#x27;s legitimacy&#x2F;factualness, is the <i>only thing worth discussing</i>.<p>`sub` _IS_ the immutable reliable identifier. If it&#x27;s not, (1) I want to see actual proof, not an anonymous rando (sorry, but this thread re-inforces how little I trust context-less comments like that), and (2) I&#x27;d want to hear a convincing argument that ... `sub2` would actually be less mutable.<p>Threads like this make me really question other peoples&#x27; general comprehension skills.</div><br/><div id="42707937" class="c"><input type="checkbox" id="c-42707937" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42703896">parent</a><span>|</span><a href="#42704492">next</a><span>|</span><label class="collapse" for="c-42707937">[-]</label><label class="expand" for="c-42707937">[1 more]</label></div><br/><div class="children"><div class="content">agreed. the real story is that people are ignoring `sub` out of convenience and creating a security hole.</div><br/></div></div><div id="42704492" class="c"><input type="checkbox" id="c-42704492" checked=""/><div class="controls bullet"><span class="by">pl4nty</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42703896">parent</a><span>|</span><a href="#42707937">prev</a><span>|</span><a href="#42703690">next</a><span>|</span><label class="collapse" for="c-42704492">[-]</label><label class="expand" for="c-42704492">[1 more]</label></div><br/><div class="children"><div class="content">every trufflehog post I&#x27;ve seen on hn has been alarmist clickbait. could&#x27;ve been an opportunity to discuss security tradeoffs of `sub` vs `email` and how to handle `sub` changes, but nope their take is &quot;sub doesn&#x27;t fix the problem we found&quot;</div><br/></div></div></div></div><div id="42703690" class="c"><input type="checkbox" id="c-42703690" checked=""/><div class="controls bullet"><span class="by">jorams</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700840">parent</a><span>|</span><a href="#42703896">prev</a><span>|</span><a href="#42704103">next</a><span>|</span><label class="collapse" for="c-42703690">[-]</label><label class="expand" for="c-42703690">[1 more]</label></div><br/><div class="children"><div class="content">0.04% is a few times higher than I&#x27;d expect it to be, but if it were actually that bad I&#x27;d expect <i>some</i> form of previous report about it to be findable on the internet. I did some searching but couldn&#x27;t find anything. It would be a significant bug on Google&#x27;s part, but stranger things <i>have</i> happened.<p>What&#x27;s astonishing to me is that apparently all these big service providers <i>did</i> notice, and then they decided to disregard the one identifier Google tells them to use? Fundamentally that&#x27;s the security bug being reported here, it&#x27;s just being reported to Google instead of those service providers.<p>A stable alternative for the hd claim would of course be a good idea. It would provide a more complete way to deal with the inherent security issue of allowing domain-based signup without further authorization steps. But given the above I&#x27;m not convinced these service providers wouldn&#x27;t start ignoring it after the first time somebody re-registers a domain with Google Workspace.</div><br/></div></div><div id="42704103" class="c"><input type="checkbox" id="c-42704103" checked=""/><div class="controls bullet"><span class="by">confuseddeputy</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700840">parent</a><span>|</span><a href="#42703690">prev</a><span>|</span><a href="#42700877">next</a><span>|</span><label class="collapse" for="c-42704103">[-]</label><label class="expand" for="c-42704103">[1 more]</label></div><br/><div class="children"><div class="content">I am pretty confident that the statement is false.<p>The `sub` claim value is equivalent to the user ID that&#x27;s exposed in the Directory API, it&#x27;s derived from the underlying user account&#x27;s unique user ID, and it won&#x27;t change unless the user account is recreated.</div><br/></div></div></div></div><div id="42700877" class="c"><input type="checkbox" id="c-42700877" checked=""/><div class="controls bullet"><span class="by">JohnMakin</span><span>|</span><a href="#42700760">parent</a><span>|</span><a href="#42700840">prev</a><span>|</span><a href="#42701030">next</a><span>|</span><label class="collapse" for="c-42700877">[-]</label><label class="expand" for="c-42700877">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve implemented OAuth flow glue logic a bunch in my career and I agree that the logic doesn&#x27;t seem to follow from what the documentation says. What&#x27;s not clear to me though while reading this is, if I delete&#x2F;lose a domain, and someone re-makes the domain and account with the same email address, does the sub value then change? The docs would seem to suggest yes, but then I am not clear what google actually ended up &quot;fixing&quot; in its bug bounty. Was that maybe the bug, and this is just not clearly explained in this post?</div><br/><div id="42705145" class="c"><input type="checkbox" id="c-42705145" checked=""/><div class="controls bullet"><span class="by">agf</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42700877">parent</a><span>|</span><a href="#42701030">next</a><span>|</span><label class="collapse" for="c-42705145">[-]</label><label class="expand" for="c-42705145">[1 more]</label></div><br/><div class="children"><div class="content">The reason this is an issue is that the sub value changes often enough that intergrations ignore it rather than bother users with having to re-OAuth.<p>As far as what Google is doing in the bug bounty, that&#x27;s a good question -- we don&#x27;t know. The author is proposing two new values, for the domain and user, that wouldn&#x27;t change in the cases that sub changes now, but would change in this case.</div><br/></div></div></div></div><div id="42701030" class="c"><input type="checkbox" id="c-42701030" checked=""/><div class="controls bullet"><span class="by">saguntum</span><span>|</span><a href="#42700760">parent</a><span>|</span><a href="#42700877">prev</a><span>|</span><a href="#42703519">next</a><span>|</span><label class="collapse" for="c-42701030">[-]</label><label class="expand" for="c-42701030">[3 more]</label></div><br/><div class="children"><div class="content">Yeah, I&#x27;m not really clear on the vuln. It sounds like clients don&#x27;t validate sub claims because they are unstable? Google&#x27;s docs say they should.<p>When I first read the post, I thought that maybe Google was reusing sub claims when they shouldn&#x27;t, but on a closer read, maybe it&#x27;s the opposite problem - that the sub claim is changing when it should not change?<p>From the article -<p>“The sub claim changes in about 0.04% of logins from Log in with Google. For us, that&#x27;s hundreds of users last week ...
Because the sub claim is inconsistent, it cannot be used to uniquely identify users - leaving services reliant on the email and hd claims.&quot;<p>So maybe clients aren&#x27;t using the sub claim because validating &quot;email matches &amp;&amp; sub matches&quot; breaks real users who are not actually changing accounts? AKA, Google is changing Google Account IDs unpredictably? That would be a bug on Google&#x27;s part IMO.<p>If those account IDs in the sub claim are changing, at the very least that&#x27;s a bug in the doc you linked IMO.<p>I&#x27;d have to read the full OIDC spec [0] to see if the sub <i>must</i> remain constant for the same end user, and if clients are required to validate the sub claim before processing a login. If so, and it&#x27;s changing without the end user&#x27;s identity changing, that is a bug in Google&#x27;s implementation and client implementations for anyone using Google as an IDP.<p>If it&#x27;s allowed to change, though, and validating sub claim is not required in the spec, maybe clients are correct in not relying on it.<p>[0] <a href="https:&#x2F;&#x2F;openid.net&#x2F;specs&#x2F;openid-connect-core-1_0.html#rfc.section.2" rel="nofollow">https:&#x2F;&#x2F;openid.net&#x2F;specs&#x2F;openid-connect-core-1_0.html#rfc.se...</a><p>Edit: from reading the sign in with google overview, it&#x27;s unclear if they claim to be OIDC compliant: <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;gsi&#x2F;web&#x2F;guides&#x2F;overview" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;identity&#x2F;gsi&#x2F;web&#x2F;guides&#x2F;overvi...</a><p>it says it&#x27;s &quot;based on OAuth&quot; rather than &quot;implements OAuth+OIDC&quot; so I guess not being fully spec compliant wouldn&#x27;t necessarily be a &quot;bug.&quot;</div><br/><div id="42705255" class="c"><input type="checkbox" id="c-42705255" checked=""/><div class="controls bullet"><span class="by">russelg</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42701030">parent</a><span>|</span><a href="#42703519">next</a><span>|</span><label class="collapse" for="c-42705255">[-]</label><label class="expand" for="c-42705255">[2 more]</label></div><br/><div class="children"><div class="content">I ran into this when implementing OIDC at work. One of my teammates wasn&#x27;t able to login even though he just linked his google account. Turns out based on which browser session he was using, the same google login was giving a different sub. Super weird behaviour.</div><br/><div id="42707338" class="c"><input type="checkbox" id="c-42707338" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#42700760">root</a><span>|</span><a href="#42705255">parent</a><span>|</span><a href="#42703519">next</a><span>|</span><label class="collapse" for="c-42707338">[-]</label><label class="expand" for="c-42707338">[1 more]</label></div><br/><div class="children"><div class="content">very skeptical about this - I believe they are two accounts.<p>It is possible to create two google account linked with same email address.<p>I think I need more proof they are actually same account.  For example, changing the profile pic in one session is reflected in another session.</div><br/></div></div></div></div></div></div><div id="42703519" class="c"><input type="checkbox" id="c-42703519" checked=""/><div class="controls bullet"><span class="by">chavesn</span><span>|</span><a href="#42700760">parent</a><span>|</span><a href="#42701030">prev</a><span>|</span><a href="#42700386">next</a><span>|</span><label class="collapse" for="c-42703519">[-]</label><label class="expand" for="c-42703519">[1 more]</label></div><br/><div class="children"><div class="content">Genuine question, what would that flow look like?</div><br/></div></div></div></div><div id="42700386" class="c"><input type="checkbox" id="c-42700386" checked=""/><div class="controls bullet"><span class="by">andrewstuart2</span><span>|</span><a href="#42700760">prev</a><span>|</span><a href="#42701998">next</a><span>|</span><label class="collapse" for="c-42700386">[-]</label><label class="expand" for="c-42700386">[10 more]</label></div><br/><div class="children"><div class="content">This is more of a fundamental issue with the way we rely on DNS to secure *gestures wildly* all the things. The fact that domains can expire and be registered by someone new allows the new owner to do almost anything the old owner could have done when it comes to anything trusting email addresses, or anything else relying on DNS (ACME certs) for authentication.<p>It&#x27;s great for &quot;do they own this right now&quot; validation and that&#x27;s what we use it for, but beyond that links will be saved, email addresses will be added to databases and address books alike, and that&#x27;s more or less a reality of most systems. For example, my snail mail (and occasionally packages) is still mistakenly delivered to my former addresses from time to time just because it&#x27;s hard to track who has that address, and update it everywhere. The same goes for internet infrastructure.</div><br/><div id="42700526" class="c"><input type="checkbox" id="c-42700526" checked=""/><div class="controls bullet"><span class="by">simondanerd</span><span>|</span><a href="#42700386">parent</a><span>|</span><a href="#42700598">next</a><span>|</span><label class="collapse" for="c-42700526">[-]</label><label class="expand" for="c-42700526">[1 more]</label></div><br/><div class="children"><div class="content">I was able to take over an Instagram account because I received a password reset email to a domain catch all address that I&#x27;d set up years ago. Turns out it was a whole brand, but they refuse to change the email address and don&#x27;t understand that I&#x27;m going to shut it all down. It totally makes my site look bad (it was an adultish brand and I was working on a community project) and I now have the power (and ability to do whatever with the account and any other that I happen upon with an email at that domain.</div><br/></div></div><div id="42700598" class="c"><input type="checkbox" id="c-42700598" checked=""/><div class="controls bullet"><span class="by">gmuslera</span><span>|</span><a href="#42700386">parent</a><span>|</span><a href="#42700526">prev</a><span>|</span><a href="#42701727">next</a><span>|</span><label class="collapse" for="c-42700598">[-]</label><label class="expand" for="c-42700598">[1 more]</label></div><br/><div class="children"><div class="content">At least it counts as a new category on the &quot;It&#x27;s DNS fault&quot; list.</div><br/></div></div><div id="42701727" class="c"><input type="checkbox" id="c-42701727" checked=""/><div class="controls bullet"><span class="by">Pxtl</span><span>|</span><a href="#42700386">parent</a><span>|</span><a href="#42700598">prev</a><span>|</span><a href="#42701998">next</a><span>|</span><label class="collapse" for="c-42701727">[-]</label><label class="expand" for="c-42701727">[7 more]</label></div><br/><div class="children"><div class="content">I disagree. DNS stores enough information in WHOIS to see if ownership has changed, it&#x27;s not DNS&#x27; fault that nobody looks.<p>Probably the least-wrong thing to do with current DNS is to have authentication servers keep track of the WHOIS UpdatedDate of email domains. If a WHOIS UpdatedDate is newer than the corresponding user&#x27;s linked email address verification, that user&#x27;s email address is no longer trusted. Next time they log in ask them to update or re-confirm their email address, and if they try to password reset they can&#x27;t use an unconfirmed email address.<p>Yes that&#x27;s more tricky work.  Authentication is hard.  Nobody should be DIYing authentication anymore in this day and age, it&#x27;s just too much.</div><br/><div id="42701757" class="c"><input type="checkbox" id="c-42701757" checked=""/><div class="controls bullet"><span class="by">niij</span><span>|</span><a href="#42700386">root</a><span>|</span><a href="#42701727">parent</a><span>|</span><a href="#42704356">next</a><span>|</span><label class="collapse" for="c-42701757">[-]</label><label class="expand" for="c-42701757">[3 more]</label></div><br/><div class="children"><div class="content">What does this protect against? If the WHOIS changes because someone new buys the domain then they could simply receive this reset emails, no?</div><br/><div id="42702563" class="c"><input type="checkbox" id="c-42702563" checked=""/><div class="controls bullet"><span class="by">Pxtl</span><span>|</span><a href="#42700386">root</a><span>|</span><a href="#42701757">parent</a><span>|</span><a href="#42704356">next</a><span>|</span><label class="collapse" for="c-42702563">[-]</label><label class="expand" for="c-42702563">[2 more]</label></div><br/><div class="children"><div class="content">Yes, but the user had to go through the process of &quot;wait do I still have that email address?  Did I receive it?&quot;<p>Like, let&#x27;s say I have an email address pxtl@example.net, and I used that to register an account on service.com, and example.net goes under.<p>In theory I know that this event has occurred, I no longer have access to my email address at pxtl@example.net.<p>So I log into my service.com account and get told &quot;hey your email was pxtl@example.net - example.net has changed ownership. Is that still your email?&quot; and I&#x27;ll say &quot;no&quot; and put in a new email.<p>Or maybe I don&#x27;t realize that example.net is gone.  So I try to verify the account, find that I&#x27;m not receiving the email, and realize my mistake and set up a new email account, and click the button that says &quot;I did not receive the email&quot;. The authentication server can prevent this window of time being an attack vector by forcing a delay between email validation and password reset, and by de-validating the email address (and treating it as a red flag on the whole domain) if the user clicks &quot;I did not receive the email&quot; a few minutes <i>after</i> the email address has been verified.<p>And if I forget my password and try to reset password on service.com using my unverified pxtl@example.net?  &quot;example.net had an ownership change since this email address was registered, please use another means to reset your password like SMS&quot;. Which is the main benefit of this process.  Which I know doesn&#x27;t require full verification.<p>Now, obviously the WHOIS updateddate is a noisy signal. Ideally the DNS system would expose a more granular ownership-change date - for example, gmail.com lists a WHOIS updateddate of July 11th 2024. UpdatedDate isn&#x27;t <i>supposed</i> to change with every renewal but lots of things aren&#x27;t supposed to happen.</div><br/><div id="42704371" class="c"><input type="checkbox" id="c-42704371" checked=""/><div class="controls bullet"><span class="by">Pxtl</span><span>|</span><a href="#42700386">root</a><span>|</span><a href="#42702563">parent</a><span>|</span><a href="#42704356">next</a><span>|</span><label class="collapse" for="c-42704371">[-]</label><label class="expand" for="c-42704371">[1 more]</label></div><br/><div class="children"><div class="content">Following up on this: Apparently my knowledge is out-of-date.<p>WHOIS has been superceded by RDAP, and RDAP provides event data for registration and re-registration.  So even better!<p>edit: it doesn&#x27;t seem like registrars actually do re-registration, and many cctlds don&#x27;t even use RDAP yet.</div><br/></div></div></div></div></div></div><div id="42704356" class="c"><input type="checkbox" id="c-42704356" checked=""/><div class="controls bullet"><span class="by">mixdup</span><span>|</span><a href="#42700386">root</a><span>|</span><a href="#42701727">parent</a><span>|</span><a href="#42701757">prev</a><span>|</span><a href="#42702882">next</a><span>|</span><label class="collapse" for="c-42704356">[-]</label><label class="expand" for="c-42704356">[2 more]</label></div><br/><div class="children"><div class="content">You can put whatever you want in WHOIS, including just replicating the information that was there previously. What if the WHOIS email is an email on the domain in question?<p><i>Maybe</i> registrars could set a unique ID per registrant, and if a domain expires and is purchased by a different entity&#x2F;account than the previous one the registrant GUID is refreshed. That could then be a signal that all previous reliance on the DNS of the domain name should be null and void</div><br/><div id="42704870" class="c"><input type="checkbox" id="c-42704870" checked=""/><div class="controls bullet"><span class="by">Pxtl</span><span>|</span><a href="#42700386">root</a><span>|</span><a href="#42704356">parent</a><span>|</span><a href="#42702882">next</a><span>|</span><label class="collapse" for="c-42704870">[-]</label><label class="expand" for="c-42704870">[1 more]</label></div><br/><div class="children"><div class="content">This led me to go do a deeper dive.<p>1) WHOIS has been partially replaced by RDAP although many ccTLDs don&#x27;t support it yet (notably .au and .us for example).  Spec for RDAP query results:<p><a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;rfc8977&#x2F;" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;rfc8977&#x2F;</a><p>2) RDAP does specify that the registration date should be of the last time registered - if a domain has lapsed and picked up by somebody else it&#x27;s supposed to use the verb &quot;reregistered&quot;.  But of course, you&#x27;re depending on the registrar to do that.  It does look like &quot;registered&quot; is properly followed - I looked into some known cases of poached lapsed domains and checked their RDAPS and the registration date corresponds to the date the domain drop-caught but no past expiry or re-registration is listed (example[1]).<p>3) Either way, don&#x27;t use the content of the WHOIS&#x2F;RDAP, just the dates.<p>[1]<a href="https:&#x2F;&#x2F;www.adrforum.com&#x2F;domaindecisions&#x2F;1967817.htm" rel="nofollow">https:&#x2F;&#x2F;www.adrforum.com&#x2F;domaindecisions&#x2F;1967817.htm</a></div><br/></div></div></div></div></div></div></div></div><div id="42701998" class="c"><input type="checkbox" id="c-42701998" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#42700386">prev</a><span>|</span><a href="#42702076">next</a><span>|</span><label class="collapse" for="c-42701998">[-]</label><label class="expand" for="c-42701998">[8 more]</label></div><br/><div class="children"><div class="content">It&#x27;s crazy just how little effort it takes to get a &quot;Google = bad&quot; article to the top of HN.<p>There is no vulnerability in Google OAuth. This is exactly how every OAuth server is supposed to work. If you take over a domain, you automatically own every email address in that domain, and thus whatever external account relies on that email for login. Heck the result would be the same even if that service didn&#x27;t use Google OAuth, or any OAuth at all.<p>Nothing in that write-up makes sense.</div><br/><div id="42703707" class="c"><input type="checkbox" id="c-42703707" checked=""/><div class="controls bullet"><span class="by">chis</span><span>|</span><a href="#42701998">parent</a><span>|</span><a href="#42703270">next</a><span>|</span><label class="collapse" for="c-42703707">[-]</label><label class="expand" for="c-42703707">[2 more]</label></div><br/><div class="children"><div class="content">Is this really just google=bad, though?  I work at a startup and this seems like a legit security risk that I&#x27;m happy to learn about.<p>It seems like the only mitigation would be to let your HR SAAS know when your company shutters and ask them to delete the records.  Or just squat the domain yourself as an ex-employee.</div><br/><div id="42704152" class="c"><input type="checkbox" id="c-42704152" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#42701998">root</a><span>|</span><a href="#42703707">parent</a><span>|</span><a href="#42703270">next</a><span>|</span><label class="collapse" for="c-42704152">[-]</label><label class="expand" for="c-42704152">[1 more]</label></div><br/><div class="children"><div class="content">Yes it is, otherwise the title would be &quot;don&#x27;t use your email address to log in to any application&quot; and it wouldn&#x27;t be ragebait enough. The whole issue has nothing to do with OAuth and nothing to do with Google.</div><br/></div></div></div></div><div id="42703270" class="c"><input type="checkbox" id="c-42703270" checked=""/><div class="controls bullet"><span class="by">bitpush</span><span>|</span><a href="#42701998">parent</a><span>|</span><a href="#42703707">prev</a><span>|</span><a href="#42703387">next</a><span>|</span><label class="collapse" for="c-42703270">[-]</label><label class="expand" for="c-42703270">[2 more]</label></div><br/><div class="children"><div class="content">The staying power of a Google = bad article on HN top page is insane.</div><br/><div id="42703561" class="c"><input type="checkbox" id="c-42703561" checked=""/><div class="controls bullet"><span class="by">lysace</span><span>|</span><a href="#42701998">root</a><span>|</span><a href="#42703270">parent</a><span>|</span><a href="#42703387">next</a><span>|</span><label class="collapse" for="c-42703561">[-]</label><label class="expand" for="c-42703561">[1 more]</label></div><br/><div class="children"><div class="content">And the opposite: The half-life of an Apple = bad article on HN is insane in the other direction.</div><br/></div></div></div></div><div id="42703387" class="c"><input type="checkbox" id="c-42703387" checked=""/><div class="controls bullet"><span class="by">okdood64</span><span>|</span><a href="#42701998">parent</a><span>|</span><a href="#42703270">prev</a><span>|</span><a href="#42703083">next</a><span>|</span><label class="collapse" for="c-42703387">[-]</label><label class="expand" for="c-42703387">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s crazy that they do that only because &quot;Google search bad now&quot; or &quot;Youtube bad now&quot;.</div><br/></div></div><div id="42703083" class="c"><input type="checkbox" id="c-42703083" checked=""/><div class="controls bullet"><span class="by">dml2135</span><span>|</span><a href="#42701998">parent</a><span>|</span><a href="#42703387">prev</a><span>|</span><a href="#42703333">next</a><span>|</span><label class="collapse" for="c-42703083">[-]</label><label class="expand" for="c-42703083">[1 more]</label></div><br/><div class="children"><div class="content">I think part of the issue is that this is where the abstraction that we call &quot;account ownership&quot; starts to leak.<p>You may correctly have access to an account through this scenario, but that does not make it <i>your</i> account. This becomes obviously when we consider an account at a bank, for example.</div><br/></div></div><div id="42703333" class="c"><input type="checkbox" id="c-42703333" checked=""/><div class="controls bullet"><span class="by">walrus01</span><span>|</span><a href="#42701998">parent</a><span>|</span><a href="#42703083">prev</a><span>|</span><a href="#42702076">next</a><span>|</span><label class="collapse" for="c-42703333">[-]</label><label class="expand" for="c-42703333">[1 more]</label></div><br/><div class="children"><div class="content">Yes, this about sums it up. If you take over a domain, you control its registrar records for what its authoritative nameservers are, so of course you can set it to your own custom nameservers and then define whatever MX you want to receive incoming mail flow. You don&#x27;t even have to go to any effort of configuring working <i>outbound</i> mail. You just need to put up a very minimal zonefile with the MX defined, basic postfix email server with a catchall configuration and then receive any incoming emails for *@domain.com.</div><br/></div></div></div></div><div id="42702076" class="c"><input type="checkbox" id="c-42702076" checked=""/><div class="controls bullet"><span class="by">ds</span><span>|</span><a href="#42701998">prev</a><span>|</span><a href="#42700479">next</a><span>|</span><label class="collapse" for="c-42702076">[-]</label><label class="expand" for="c-42702076">[2 more]</label></div><br/><div class="children"><div class="content">Nearly a decade ago, there was a website called thehunt.com that basically ran out of money and some employees were acqui-hired by pinterest.<p>All of the assets were left to rot and at the time the company was a good match for another startup of mine. So I reached out to the investors I found on crunchbase and asked if I could acquire everything. We worked out a deal and I did. The issue was the complete lack of people from the old company willing to assist and the complete lack of data for alot of things. There was 1 or 2 people who we could ping from the old company to ping who were super helpful, but the big thing was many things were just lost to time- passwords, history, code repos, etc..<p>Simply creating a new google apps account allowed us to get full access back to <i>everything</i> - We could even read old slack messages (even DMs!) by resetting each accounts password. The whole thing was shocking to say the least, but with that access we got back into literally every service they used and managed to get it up and running again within a week, which was a good thing because nearly every service it was using was threatening to shut it down every day for lack of payment.<p>I think the solution here is actually way simpler than most make it out to be and could easily be a startup for someone:<p>Create a startup that lets customers simply enter in domains. If the domain EVER goes into the &quot;pendingDelete&quot; status, inform the customer. The customer would be random SAAS&#x27;s that want to protect against this type of attack and could simply choose to disallow access to any account that has had their domain go into that status.</div><br/><div id="42703025" class="c"><input type="checkbox" id="c-42703025" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#42702076">parent</a><span>|</span><a href="#42700479">next</a><span>|</span><label class="collapse" for="c-42703025">[-]</label><label class="expand" for="c-42703025">[1 more]</label></div><br/><div class="children"><div class="content">Huh - it&#x27;s almost like the mere <i>existence</i> of a pendingDelete in the history of a domain should make every email existing on that domain at that time eligible for <a href="https:&#x2F;&#x2F;haveibeenpwned.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;haveibeenpwned.com&#x2F;</a> .</div><br/></div></div></div></div><div id="42700479" class="c"><input type="checkbox" id="c-42700479" checked=""/><div class="controls bullet"><span class="by">erincandescent</span><span>|</span><a href="#42702076">prev</a><span>|</span><a href="#42701843">next</a><span>|</span><label class="collapse" for="c-42700479">[-]</label><label class="expand" for="c-42700479">[3 more]</label></div><br/><div class="children"><div class="content">&gt; To resolve this issue, Google could implement two immutable identifiers within &gt; its OpenID Connect (OIDC) claims:
&gt; 1. A unique user ID that doesn’t change over time.
&gt; 2. A unique workspace ID tied to the domain.<p>1. is the OIDC `sub` claim! I strongly suspect that in those 0.04% of accounts where the anonymous quoted engineer reports that the `sub` claim changed, what actually happened was some provisioning&#x2F;onboarding&#x2F;offboarding system resulted in the account being deleted and recreated.<p>2. is sensible, and is just a versioned version of the `hd` claim.</div><br/><div id="42701397" class="c"><input type="checkbox" id="c-42701397" checked=""/><div class="controls bullet"><span class="by">anon84873628</span><span>|</span><a href="#42700479">parent</a><span>|</span><a href="#42701843">next</a><span>|</span><label class="collapse" for="c-42701397">[-]</label><label class="expand" for="c-42701397">[2 more]</label></div><br/><div class="children"><div class="content">1. Yep, your hypothesis seems likely. Consumer gmail addresses can&#x27;t be used again after they are deleted, but it seems in Workspace orgs they can be reused&#x2F;reassigned after 20 days:
 <a href="https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;33314?hl=en&amp;co=DASHER._Family%3DDomain-verified&amp;oco=0#restore&amp;zippy=%2Creuse-the-email-address" rel="nofollow">https:&#x2F;&#x2F;support.google.com&#x2F;a&#x2F;answer&#x2F;33314?hl=en&amp;co=DASHER._F...</a><p>If services are not respecting the `sub` claim in this case, then they are giving the new Google account access to the old account&#x27;s data. Companies probably wouldn&#x27;t complain about this because they think it is the expected&#x2F;reasonable behavior. Also it&#x27;s likely that in many scenarios it is the same human behind the different accounts, e.g. if they leave a company then return.</div><br/><div id="42703950" class="c"><input type="checkbox" id="c-42703950" checked=""/><div class="controls bullet"><span class="by">nixosbestos</span><span>|</span><a href="#42700479">root</a><span>|</span><a href="#42701397">parent</a><span>|</span><a href="#42701843">next</a><span>|</span><label class="collapse" for="c-42703950">[-]</label><label class="expand" for="c-42703950">[1 more]</label></div><br/><div class="children"><div class="content">Reinforcing the face-palm at the heart of this, which is that anyone deciding to you know, just use email instead of asking why an immutable ID changed... just probably enabled information leakage. Seriously, I&#x27;m so thankful that my colleagues would be principaled about this and ask questions instead of just doing something to make it &quot;work&quot;. Where &quot;work&quot; means some GSuite user probably logged into some other defunct GSuite user&#x27;s RP-account.</div><br/></div></div></div></div></div></div><div id="42701843" class="c"><input type="checkbox" id="c-42701843" checked=""/><div class="controls bullet"><span class="by">Ronnie76er</span><span>|</span><a href="#42700479">prev</a><span>|</span><a href="#42700440">next</a><span>|</span><label class="collapse" for="c-42701843">[-]</label><label class="expand" for="c-42701843">[1 more]</label></div><br/><div class="children"><div class="content">As others have noted, this feels like an issue in the relying parties not relying on the `sub` field to validate the user. It feels the exact same as this  issue here: <a href="https:&#x2F;&#x2F;bhavukjain.com&#x2F;blog&#x2F;2020&#x2F;05&#x2F;30&#x2F;zeroday-signin-with-apple" rel="nofollow">https:&#x2F;&#x2F;bhavukjain.com&#x2F;blog&#x2F;2020&#x2F;05&#x2F;30&#x2F;zeroday-signin-with-a...</a>.<p>In both, the details around the `sub` field, the field that should actually be used to identify the user, is poorly described. I would say that both of these feel a bit sensationalist, but then again, if relying parties are NOT using the sub field to validate users, they should be called out.<p>It seems to be that a good way to make some money is find every such situation where RPs are not using sub, and submit vuln bugs.</div><br/></div></div><div id="42700440" class="c"><input type="checkbox" id="c-42700440" checked=""/><div class="controls bullet"><span class="by">tom1337</span><span>|</span><a href="#42701843">prev</a><span>|</span><a href="#42700176">next</a><span>|</span><label class="collapse" for="c-42700440">[-]</label><label class="expand" for="c-42700440">[2 more]</label></div><br/><div class="children"><div class="content">Is this really an issue? Back when I implemented Google OAuth I used the &quot;sub&quot; that Google gave me as well as the email. I&#x27;d wager that Google does not re-use a sub for the same E-Mail so if the account is deleted and then somebody grabs the domain and re-created the account they&#x27;d have the same E-Mail but a different sub which would make the login fail. Seems to not be an issue in Google&#x27;s OAuth Flow but rather the implementation on services like ChatGPT and so on?!<p>EDIT: Just read that they claim that “The sub claim changes in about 0.04% of logins from Log in with Google” - never had this happen in the past years but if this is true then I guess thats a bad thing.</div><br/><div id="42706010" class="c"><input type="checkbox" id="c-42706010" checked=""/><div class="controls bullet"><span class="by">efrowning</span><span>|</span><a href="#42700440">parent</a><span>|</span><a href="#42700176">next</a><span>|</span><label class="collapse" for="c-42706010">[-]</label><label class="expand" for="c-42706010">[1 more]</label></div><br/><div class="children"><div class="content">Are your users primarily using gmail accounts or are they using accounts from custom domains? TFA does&#x27;t say exactly, but I wonder if this stat only applies to users with custom domains rather than @gmail accounts.</div><br/></div></div></div></div><div id="42700176" class="c"><input type="checkbox" id="c-42700176" checked=""/><div class="controls bullet"><span class="by">robertlagrant</span><span>|</span><a href="#42700440">prev</a><span>|</span><a href="#42701541">next</a><span>|</span><label class="collapse" for="c-42700176">[-]</label><label class="expand" for="c-42700176">[7 more]</label></div><br/><div class="children"><div class="content">The &quot;millions of accounts&quot; is highly speculative, is it not? It relies on the idea that failed startups keep their SAAS accounts enabled, rather than offboarding correctly.</div><br/><div id="42700625" class="c"><input type="checkbox" id="c-42700625" checked=""/><div class="controls bullet"><span class="by">hangonhn</span><span>|</span><a href="#42700176">parent</a><span>|</span><a href="#42700367">next</a><span>|</span><label class="collapse" for="c-42700625">[-]</label><label class="expand" for="c-42700625">[2 more]</label></div><br/><div class="children"><div class="content">You would think that because you&#x27;re a reasonable person. However at my previous startup, which no longer exists, the new CEO failed to save the company and parachuted out so fast that the company who later acquired the startup couldn&#x27;t get the domain name transferred to them because the CEO and CTO were both gone. They had to bring back the predecessor CEO because he was still able to log into the registrar to transfer the domain.<p>In the case of a fire, some less than conscientious people will fend for themselves first and don&#x27;t give a second thought to anyone else.</div><br/><div id="42701048" class="c"><input type="checkbox" id="c-42701048" checked=""/><div class="controls bullet"><span class="by">robertlagrant</span><span>|</span><a href="#42700176">root</a><span>|</span><a href="#42700625">parent</a><span>|</span><a href="#42700367">next</a><span>|</span><label class="collapse" for="c-42701048">[-]</label><label class="expand" for="c-42701048">[1 more]</label></div><br/><div class="children"><div class="content">I agree there will some number of companies doing this, between 1 and $number_of_companies. I&#x27;m just saying it&#x27;s pretty unlikely it&#x27;s <i>all</i> candidate companies, which the article seems to be saying.</div><br/></div></div></div></div><div id="42700367" class="c"><input type="checkbox" id="c-42700367" checked=""/><div class="controls bullet"><span class="by">toss1</span><span>|</span><a href="#42700176">parent</a><span>|</span><a href="#42700625">prev</a><span>|</span><a href="#42701541">next</a><span>|</span><label class="collapse" for="c-42700367">[-]</label><label class="expand" for="c-42700367">[4 more]</label></div><br/><div class="children"><div class="content">&gt;&gt; is highly speculative, is it not?<p>I&#x27;d say NOT.<p>Shutdown of a small company running out of funds is rarely fully orderly. Critical things may get taken care of, but everything is unlikely, as people have already left. Plus, with things like already-paid-in accounts, there&#x27;s even an incentive to keep them open until the term expires, e.g., why not keep the prepaid ChatGPT API account live for execs and techs to use between jobs?<p>Just like wiping hard drives on EOL computers — everyone <i>should</i> do it every time, but people are always finding full HDDs and SSDs on eBay and Craigslist...</div><br/><div id="42700452" class="c"><input type="checkbox" id="c-42700452" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42700176">root</a><span>|</span><a href="#42700367">parent</a><span>|</span><a href="#42700434">next</a><span>|</span><label class="collapse" for="c-42700452">[-]</label><label class="expand" for="c-42700452">[1 more]</label></div><br/><div class="children"><div class="content">also, there are lots of non-technical people running small businesses that use G services because that&#x27;s all they know. They can barely operate them let alone be cognizant of things like this &quot;exploit&quot;.</div><br/></div></div><div id="42700434" class="c"><input type="checkbox" id="c-42700434" checked=""/><div class="controls bullet"><span class="by">bpodgursky</span><span>|</span><a href="#42700176">root</a><span>|</span><a href="#42700367">parent</a><span>|</span><a href="#42700452">prev</a><span>|</span><a href="#42701541">next</a><span>|</span><label class="collapse" for="c-42700434">[-]</label><label class="expand" for="c-42700434">[2 more]</label></div><br/><div class="children"><div class="content">Not just this, but execs and employees like to keep websites live for a while while they job-hunt (otherwise their resume has dead links).  And ideally keep their name@startup.com email working.  But to keep those running requires a long tail of &quot;live&quot; DNS and finance stuff you can&#x27;t quite close out.</div><br/><div id="42700478" class="c"><input type="checkbox" id="c-42700478" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42700176">root</a><span>|</span><a href="#42700434">parent</a><span>|</span><a href="#42701541">next</a><span>|</span><label class="collapse" for="c-42700478">[-]</label><label class="expand" for="c-42700478">[1 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t it be cheaper just to pay for the domain registration for an extended time like 10 years vs the 1 or 2 year options?</div><br/></div></div></div></div></div></div></div></div><div id="42701541" class="c"><input type="checkbox" id="c-42701541" checked=""/><div class="controls bullet"><span class="by">dvydra2</span><span>|</span><a href="#42700176">prev</a><span>|</span><a href="#42706819">next</a><span>|</span><label class="collapse" for="c-42701541">[-]</label><label class="expand" for="c-42701541">[1 more]</label></div><br/><div class="children"><div class="content">This actually happened to me a few years ago when I closed my consulting company. My bad, I know. My domain was taken over by someone in Vietnam. Back then, he was actually able to see my old emails via the Google Apps. Grandfathered free Apps accounts was a big part of the value proposition. He demanded $500 to delete my emails and docs. I offered $50 for his trouble since I recognized that I was at least partially at fault but he refused. To his bad luck, one of my main clients was Google itself. I reported him via my internal connections and the next day got the following email: &quot;Oh my G-d, all forty of the domains I bought got Google Apps cancelled&quot;.</div><br/></div></div><div id="42706819" class="c"><input type="checkbox" id="c-42706819" checked=""/><div class="controls bullet"><span class="by">deathanatos</span><span>|</span><a href="#42701541">prev</a><span>|</span><a href="#42700129">next</a><span>|</span><label class="collapse" for="c-42706819">[-]</label><label class="expand" for="c-42706819">[3 more]</label></div><br/><div class="children"><div class="content">&gt; <i>According to a staff engineer at a major tech company:</i><p>&gt; <i>“The sub claim changes in about 0.04% of logins from Log in with Google.</i><p>I&#x27;ve had a staff SWE also claim to me that they generated colliding UUIDv4s, and a separate staff SWE <i>who worked in GIS</i> claim that circles only exist in map projections and they&#x27;re always distorted, and that you cannot have a circle IRL, nor project it onto a projection.<p><i>Neither&#x27;s</i> attention to quality, or rather, lack thereof, could cash those outlandish claims.<p>There is a simple explanation here: Your staff SWE is wrong. `sub` is the claim you&#x27;re looking for.<p>Extraordinary claims require at least a trifling of proof. Or, what can be asserted without evidence can also be dismissed without evidence.<p>And this alleges to be a security blog. As a writer with that target audience, you should <i>know</i> this is going to be <i>the objection</i> to the thesis that your reader will have, and you attempt to just handwave it away…?</div><br/><div id="42707459" class="c"><input type="checkbox" id="c-42707459" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#42706819">parent</a><span>|</span><a href="#42707389">next</a><span>|</span><label class="collapse" for="c-42707459">[-]</label><label class="expand" for="c-42707459">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;ve had a staff SWE also claim to me that they generated colliding UUIDv4s, and a separate staff SWE who worked in GIS claim that circles only exist in map projections and they&#x27;re always distorted, and that you cannot have a circle IRL, nor project it onto a projection.<p>The claim about circles I don&#x27;t know. It depends on what exist means, and I don&#x27;t know what it means to have a circle in real life, and likely don&#x27;t care. I can only draw a rough approximation of a circle, and that&#x27;s been fine for me.<p>Generating a colliding UUIDv4 seems pretty simple though; if you have a broken enough random generator setup and manage to run it without seeding, especially if it was in the times where it was pretty easy to run a virtual machine with totally broken random (virtio-random was developed for a reason), and spawned a bunch of virtual machines in very similar conditions. You can no true scotsman your way out of this by declaring that a broken system, but from inspection, I don&#x27;t know how you can determine if a given UUIDv4 was generated with proper or broken random techniques. See also Debian Security Advisory 1571-1 [1], and similar issues where random values that were intended to be secure turn out to be predictable. It&#x27;s a plausible claim. But that doesn&#x27;t mean a claim by a &#x27;staff engineer&#x27; is default plausible. It&#x27;s just an appeal to authority of a title that doesn&#x27;t mean a lot.<p>[1] <a href="https:&#x2F;&#x2F;lists.debian.org&#x2F;debian-security-announce&#x2F;2008&#x2F;msg00152.html" rel="nofollow">https:&#x2F;&#x2F;lists.debian.org&#x2F;debian-security-announce&#x2F;2008&#x2F;msg00...</a></div><br/></div></div><div id="42707389" class="c"><input type="checkbox" id="c-42707389" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#42706819">parent</a><span>|</span><a href="#42707459">prev</a><span>|</span><a href="#42700129">next</a><span>|</span><label class="collapse" for="c-42707389">[-]</label><label class="expand" for="c-42707389">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;ve had a staff SWE also claim to me that they generated colliding UUIDv4s,<p>UUIDv4 is random. Could be a bad PRNG, or just very very very bad luck.<p>&gt; and a separate staff SWE who worked in GIS claim that circles only exist in map projections and they&#x27;re always distorted, and that you cannot have a circle IRL, nor project it onto a projection.<p>It is insanely difficult to project circles. Most of time we just pretend it never exist.</div><br/></div></div></div></div><div id="42700129" class="c"><input type="checkbox" id="c-42700129" checked=""/><div class="controls bullet"><span class="by">mcflubbins</span><span>|</span><a href="#42706819">prev</a><span>|</span><a href="#42700570">next</a><span>|</span><label class="collapse" for="c-42700129">[-]</label><label class="expand" for="c-42700129">[8 more]</label></div><br/><div class="children"><div class="content">&gt; They also classified the issue as a “Fraud and abuse” issue, rather than an Oauth&#x2F;login issue.<p>I can _kinda_ see that, I agree they should mitigate it as best as possible too though, especially since they&#x27;re Google after all.<p>&gt; I thought this would be the end of the story, but 3 months later, they re-opened my ticket (after my Shmoocon talk was accepted), paid a $1337 bounty, and said they were working on a fix.<p>Sad how the only way to get Google&#x27;s attention to make enough noise about something...</div><br/><div id="42700383" class="c"><input type="checkbox" id="c-42700383" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42700129">parent</a><span>|</span><a href="#42700570">next</a><span>|</span><label class="collapse" for="c-42700383">[-]</label><label class="expand" for="c-42700383">[7 more]</label></div><br/><div class="children"><div class="content">$1337 is a very curious amount. Surely, someone was being clever???</div><br/><div id="42700634" class="c"><input type="checkbox" id="c-42700634" checked=""/><div class="controls bullet"><span class="by">chasemiller</span><span>|</span><a href="#42700129">root</a><span>|</span><a href="#42700383">parent</a><span>|</span><a href="#42700700">next</a><span>|</span><label class="collapse" for="c-42700634">[-]</label><label class="expand" for="c-42700634">[2 more]</label></div><br/><div class="children"><div class="content">yeah, google likes to have fun with the Bug Bounty program. See: <a href="https:&#x2F;&#x2F;bughunters.google.com&#x2F;about&#x2F;rules&#x2F;google-friends&#x2F;6625378258649088&#x2F;google-and-alphabet-vulnerability-reward-program-vrp-rules#reward-amounts-for-security-vulnerabilities" rel="nofollow">https:&#x2F;&#x2F;bughunters.google.com&#x2F;about&#x2F;rules&#x2F;google-friends&#x2F;662...</a></div><br/><div id="42701788" class="c"><input type="checkbox" id="c-42701788" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42700129">root</a><span>|</span><a href="#42700634">parent</a><span>|</span><a href="#42700700">next</a><span>|</span><label class="collapse" for="c-42701788">[-]</label><label class="expand" for="c-42701788">[1 more]</label></div><br/><div class="children"><div class="content">it&#x27;s funny that all of the soul has not been sucked out of the entire company</div><br/></div></div></div></div><div id="42700700" class="c"><input type="checkbox" id="c-42700700" checked=""/><div class="controls bullet"><span class="by">mega_dingus</span><span>|</span><a href="#42700129">root</a><span>|</span><a href="#42700383">parent</a><span>|</span><a href="#42700634">prev</a><span>|</span><a href="#42700570">next</a><span>|</span><label class="collapse" for="c-42700700">[-]</label><label class="expand" for="c-42700700">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s leetspeak<p>It spells &quot;leet&quot; - see <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Leet" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Leet</a><p>You&#x27;re too young to have used BBSes :)</div><br/><div id="42700808" class="c"><input type="checkbox" id="c-42700808" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42700129">root</a><span>|</span><a href="#42700700">parent</a><span>|</span><a href="#42700570">next</a><span>|</span><label class="collapse" for="c-42700808">[-]</label><label class="expand" for="c-42700808">[3 more]</label></div><br/><div class="children"><div class="content">What are you on about? You clearly missed the sarcasm.</div><br/><div id="42701161" class="c"><input type="checkbox" id="c-42701161" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#42700129">root</a><span>|</span><a href="#42700808">parent</a><span>|</span><a href="#42701021">next</a><span>|</span><label class="collapse" for="c-42701161">[-]</label><label class="expand" for="c-42701161">[1 more]</label></div><br/><div class="children"><div class="content">Your comment didn&#x27;t seem obviously sarcastic. Intent is hard to convey over text.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42700570" class="c"><input type="checkbox" id="c-42700570" checked=""/><div class="controls bullet"><span class="by">banger180</span><span>|</span><a href="#42700129">prev</a><span>|</span><a href="#42704855">next</a><span>|</span><label class="collapse" for="c-42700570">[-]</label><label class="expand" for="c-42700570">[6 more]</label></div><br/><div class="children"><div class="content">&gt; “The sub claim changes in about 0.04% of logins from Log in with Google. For us, that&#x27;s hundreds of users last week”.<p>What I don&#x27;t understand is why the `sub` claim is not consistent for those users at Google. To my understanding of the OIDC protocol the `sub` should be unique for a specific user.<p>Additionally as far as I understand if you take over a defunct domain and create a new google workspace with new users those new user account should get assigned a new `sub`.</div><br/><div id="42700746" class="c"><input type="checkbox" id="c-42700746" checked=""/><div class="controls bullet"><span class="by">caleblloyd</span><span>|</span><a href="#42700570">parent</a><span>|</span><a href="#42701278">next</a><span>|</span><label class="collapse" for="c-42700746">[-]</label><label class="expand" for="c-42700746">[3 more]</label></div><br/><div class="children"><div class="content">I agree, in my limited experience the sub remains consistent even when changing the Google Workspace domain. So the email changes but sub remains the same. The issue seems to be clients matching on email&#x2F;hd claim instead.<p>I wonder what action is causing the sub to change like the author suggests is happening.</div><br/><div id="42700830" class="c"><input type="checkbox" id="c-42700830" checked=""/><div class="controls bullet"><span class="by">loginatnine</span><span>|</span><a href="#42700570">root</a><span>|</span><a href="#42700746">parent</a><span>|</span><a href="#42701127">next</a><span>|</span><label class="collapse" for="c-42700830">[-]</label><label class="expand" for="c-42700830">[1 more]</label></div><br/><div class="children"><div class="content">At my current company, if an employee leave and come back, they&#x27;ll keep the same OID in Entra but they&#x27;ll get a new `sub` in Google workspace. We had to put in place a process to be able to use an internal tool that used the login with Google.<p>That&#x27;s most likely dependant on how the IT department handled the deprovisioning&#x2F;provisioning of users in our Google Workspace, I unfortunately don&#x27;t have the details for that.</div><br/></div></div><div id="42701127" class="c"><input type="checkbox" id="c-42701127" checked=""/><div class="controls bullet"><span class="by">banger180</span><span>|</span><a href="#42700570">root</a><span>|</span><a href="#42700746">parent</a><span>|</span><a href="#42700830">prev</a><span>|</span><a href="#42701278">next</a><span>|</span><label class="collapse" for="c-42701127">[-]</label><label class="expand" for="c-42701127">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I wonder what action is causing the sub to change like the author suggests is happening.<p>Indeed this would be very interesting.<p>This issue is also very similar to CVE-2024-25618.<p>What we did to mitigate this is the following:
- Federated login with OIDC
- Look for a user based on the sub claim
- If they are found: authenticate that user and optionally update their profile (email, name, ...) based on then new id claims.
- Else look for a user matching on the `email` claim and link the `sub` to that user
- If no user is found create a new one</div><br/></div></div></div></div><div id="42701278" class="c"><input type="checkbox" id="c-42701278" checked=""/><div class="controls bullet"><span class="by">saguntum</span><span>|</span><a href="#42700570">parent</a><span>|</span><a href="#42700746">prev</a><span>|</span><a href="#42704855">next</a><span>|</span><label class="collapse" for="c-42701278">[-]</label><label class="expand" for="c-42701278">[2 more]</label></div><br/><div class="children"><div class="content">That sub identifier changing without the underlying user changing may be the core of the bug. It&#x27;s not fully clear from the post IMO. I posted a little breakdown here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42701030">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42701030</a><p>I don&#x27;t think the article clearly states one way or another whether those 0.04% of sub claims changing are legitimate end user changes or not. If those sub changes are legitimately the Google Account changing, I don&#x27;t think that&#x27;s a bug on Google&#x27;s part, but rather is a problem on the clients&#x27; side for not validating the sub claim.<p>If the sub is changing without the Google Account user actually changing, maybe something internally at Google is swapping out those IDs when it shouldn&#x27;t be. It doesn&#x27;t look like a UUID from the example I saw, so maybe there&#x27;s some code somewhere to just change the user&#x27;s ID if there&#x27;s a collision or something?<p>Interestingly, I don&#x27;t think Google claims that Sign in with Google is fully OIDC-compliant. At least in the overview I linked in my comment, they compare the implementation to OAuth+OIDC, but I&#x27;m not sure they claim to be 100% spec compliant.</div><br/><div id="42705986" class="c"><input type="checkbox" id="c-42705986" checked=""/><div class="controls bullet"><span class="by">efrowning</span><span>|</span><a href="#42700570">root</a><span>|</span><a href="#42701278">parent</a><span>|</span><a href="#42704855">next</a><span>|</span><label class="collapse" for="c-42705986">[-]</label><label class="expand" for="c-42705986">[1 more]</label></div><br/><div class="children"><div class="content">How would the clients tell if the account has a valid sub change or not if the only piece of information provided is that the sub claim changes? For this particular attack, without having some kind of Google Workspace account identifier for the domain, the sub claim doesn&#x27;t sound sufficient to validate that it&#x27;s the same Google account from the client&#x27;s side. I&#x27;m guessing the engineer at the major tech company didn&#x27;t provide that stat without checking if those users were valid, active accounts.</div><br/></div></div></div></div></div></div><div id="42704855" class="c"><input type="checkbox" id="c-42704855" checked=""/><div class="controls bullet"><span class="by">dankwizard</span><span>|</span><a href="#42700570">prev</a><span>|</span><a href="#42701784">next</a><span>|</span><label class="collapse" for="c-42704855">[-]</label><label class="expand" for="c-42704855">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t anything new, or exclusive to Google, or exclusive to OAuth.<p>My workmate hadn&#x27;t used Facebook for many years and it was associated to an email on a custom domain. Said domain expired and somehow hackers&#x2F;script kiddies&#x2F;bots must have an email list, run a whois, buy the domain if expired, setup email, and do password resets across social media and common websites. His Facebook was stolen.</div><br/></div></div><div id="42701784" class="c"><input type="checkbox" id="c-42701784" checked=""/><div class="controls bullet"><span class="by">throw0101c</span><span>|</span><a href="#42704855">prev</a><span>|</span><a href="#42704668">next</a><span>|</span><label class="collapse" for="c-42701784">[-]</label><label class="expand" for="c-42701784">[1 more]</label></div><br/><div class="children"><div class="content">In iSCSI, there are a few options for addressing the block storage devices, with one being the iSCSI Qualified Name (IQN) that uses the domain name. But it includes a timestamp:<p><pre><code>      -  A date code, in yyyy-mm format.  This date MUST be a date
         during which the naming authority owned the domain name used in
         this format, and SHOULD be the first month in which the domain
         name was owned by this naming authority at 00:01 GMT of the
         first day of the month.  This date code uses the Gregorian
         calendar.  All four digits in the year must be present.  Both
         digits of the month must be present, with January == &quot;01&quot; and
         December == &quot;12&quot;.  The dash must be included.
</code></pre>
* <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3720#section-3.2.6.3.1" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3720#section-3.2.6....</a><p>* <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ISCSI#Addressing" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ISCSI#Addressing</a><p><pre><code>       iqn.2001-04.com.example.storage:tape.sys1.xyz

       iqn.2000-02.edu.example.cs:users.oaks:proto.target4
</code></pre>
* <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3721" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3721</a><p>Clever idea to note change of ownership situations.</div><br/></div></div><div id="42704668" class="c"><input type="checkbox" id="c-42704668" checked=""/><div class="controls bullet"><span class="by">kbtombul</span><span>|</span><a href="#42701784">prev</a><span>|</span><a href="#42701275">next</a><span>|</span><label class="collapse" for="c-42704668">[-]</label><label class="expand" for="c-42704668">[1 more]</label></div><br/><div class="children"><div class="content">How&#x27;s this any different than buying an expired domain and doing a password reset .. anywhere?<p>-- Probably someone else already mentioned this in the comments here, I just couldn&#x27;t see.</div><br/></div></div><div id="42701275" class="c"><input type="checkbox" id="c-42701275" checked=""/><div class="controls bullet"><span class="by">maerF0x0</span><span>|</span><a href="#42704668">prev</a><span>|</span><a href="#42706995">next</a><span>|</span><label class="collapse" for="c-42701275">[-]</label><label class="expand" for="c-42701275">[7 more]</label></div><br/><div class="children"><div class="content">Seems like we need a chain of custody for domains, not just current ownership. Kinda like real estate. And then accounts are tied not just to the ownership state, but also the ownership instance ID.<p>Just don&#x27;t tell the web 3.0 folks cause I don&#x27;t necessarily mean a blockchain.</div><br/><div id="42701349" class="c"><input type="checkbox" id="c-42701349" checked=""/><div class="controls bullet"><span class="by">verdverm</span><span>|</span><a href="#42701275">parent</a><span>|</span><a href="#42705277">next</a><span>|</span><label class="collapse" for="c-42701349">[-]</label><label class="expand" for="c-42701349">[4 more]</label></div><br/><div class="children"><div class="content">Web 3 already tried this, it was called Handshake. I think their downfall is they wanted to replace ICANN &#x2F; DNS rather than work with and alongside the current system.</div><br/><div id="42703989" class="c"><input type="checkbox" id="c-42703989" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42701275">root</a><span>|</span><a href="#42701349">parent</a><span>|</span><a href="#42705277">next</a><span>|</span><label class="collapse" for="c-42703989">[-]</label><label class="expand" for="c-42703989">[3 more]</label></div><br/><div class="children"><div class="content">shame, ICANN sucks</div><br/><div id="42706735" class="c"><input type="checkbox" id="c-42706735" checked=""/><div class="controls bullet"><span class="by">verdverm</span><span>|</span><a href="#42701275">root</a><span>|</span><a href="#42703989">parent</a><span>|</span><a href="#42705277">next</a><span>|</span><label class="collapse" for="c-42706735">[-]</label><label class="expand" for="c-42706735">[2 more]</label></div><br/><div class="children"><div class="content">I would argue the crypto bros are worse</div><br/><div id="42707918" class="c"><input type="checkbox" id="c-42707918" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42701275">root</a><span>|</span><a href="#42706735">parent</a><span>|</span><a href="#42705277">next</a><span>|</span><label class="collapse" for="c-42707918">[-]</label><label class="expand" for="c-42707918">[1 more]</label></div><br/><div class="children"><div class="content">crypto bros are annoying but at least they&#x27;re doing their own thing. ICANN is actively screwing us.</div><br/></div></div></div></div></div></div></div></div><div id="42705277" class="c"><input type="checkbox" id="c-42705277" checked=""/><div class="controls bullet"><span class="by">spankalee</span><span>|</span><a href="#42701275">parent</a><span>|</span><a href="#42701349">prev</a><span>|</span><a href="#42702141">next</a><span>|</span><label class="collapse" for="c-42705277">[-]</label><label class="expand" for="c-42705277">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need a whole chain of custody, you just need to know that the current owner is the one you care about. TXT DNS records or magic URLs can do the trick.</div><br/></div></div><div id="42702141" class="c"><input type="checkbox" id="c-42702141" checked=""/><div class="controls bullet"><span class="by">TeMPOraL</span><span>|</span><a href="#42701275">parent</a><span>|</span><a href="#42705277">prev</a><span>|</span><a href="#42706995">next</a><span>|</span><label class="collapse" for="c-42702141">[-]</label><label class="expand" for="c-42702141">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Just don&#x27;t tell the web 3.0 folks cause I don&#x27;t necessarily mean a blockchain.</i><p>Isn&#x27;t this literally what certificate chains are for? Establishing a chain or custody - or rather, a chain of <i>liability</i>?</div><br/></div></div></div></div><div id="42706995" class="c"><input type="checkbox" id="c-42706995" checked=""/><div class="controls bullet"><span class="by">necovek</span><span>|</span><a href="#42701275">prev</a><span>|</span><a href="#42702819">next</a><span>|</span><label class="collapse" for="c-42706995">[-]</label><label class="expand" for="c-42706995">[1 more]</label></div><br/><div class="children"><div class="content">Assuming most of the problem is that federated services only rely on email address from OidC login, I wonder if Google could start offering user+unique-workspace-id@company.domain as <i>the</i> email address for any new workspace&#x2F;user&#x2F;federated login? Obviously, Google needs to control &quot;unique-workspace-id&quot;.<p>Does not solve it for existing customers and any federated service they logged into, though if included alongside the simple email, federated services could gradually move to it and announce once they are &quot;ready&quot; so workspace admins can configure them to start accepting only new, safe email addresses.</div><br/></div></div><div id="42702819" class="c"><input type="checkbox" id="c-42702819" checked=""/><div class="controls bullet"><span class="by">citizenpaul</span><span>|</span><a href="#42706995">prev</a><span>|</span><a href="#42701077">next</a><span>|</span><label class="collapse" for="c-42702819">[-]</label><label class="expand" for="c-42702819">[1 more]</label></div><br/><div class="children"><div class="content">It seems like there have been a number of security stories lately that essentially amount to.  &quot;no tech companies ever does cleanup&quot;  Which everyone on HN with a couple years or more experience should know is the norm.  I expect a lot more of this to keep happening since companies will never really care about security without consequences ie a $10 fine for making $100 literally incentivies lack of security.</div><br/></div></div><div id="42701077" class="c"><input type="checkbox" id="c-42701077" checked=""/><div class="controls bullet"><span class="by">swframe2</span><span>|</span><a href="#42702819">prev</a><span>|</span><a href="#42706063">next</a><span>|</span><label class="collapse" for="c-42701077">[-]</label><label class="expand" for="c-42701077">[1 more]</label></div><br/><div class="children"><div class="content">Related maybe, I got a new phone number and I was able to use it to sign into the previous owner&#x27;s account at a site that uses 2FA. I noticed it when I tried to setup a new account for myself. The website wouldn&#x27;t allow it but it happily allowed to me access the previous owner&#x27;s account. It was inconsistent, removing the phone from their account required their password but changing many other important fields didn&#x27;t.</div><br/></div></div><div id="42706063" class="c"><input type="checkbox" id="c-42706063" checked=""/><div class="controls bullet"><span class="by">fastest963</span><span>|</span><a href="#42701077">prev</a><span>|</span><a href="#42703958">next</a><span>|</span><label class="collapse" for="c-42706063">[-]</label><label class="expand" for="c-42706063">[1 more]</label></div><br/><div class="children"><div class="content">We take the OAuth2 token and make a call to the People API [0] to get the Person resourceName. Not sure if this is more stable than &quot;sub&quot; but we completely ignore that.<p>[0] <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;people&#x2F;api&#x2F;rest&#x2F;v1&#x2F;people&#x2F;get" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;people&#x2F;api&#x2F;rest&#x2F;v1&#x2F;people&#x2F;get</a></div><br/></div></div><div id="42703958" class="c"><input type="checkbox" id="c-42703958" checked=""/><div class="controls bullet"><span class="by">hansvm</span><span>|</span><a href="#42706063">prev</a><span>|</span><a href="#42705494">next</a><span>|</span><label class="collapse" for="c-42703958">[-]</label><label class="expand" for="c-42703958">[1 more]</label></div><br/><div class="children"><div class="content">This feels similar in spirit to some service providers (*cough* Atlassian -- especially bad when they acquire other companies and push that bullshit on previously functional authentication systems) using ownership of a domain to assert ownership of an account using that domain.<p>E.g.:<p>1. You create an account using an email associated with a domain.<p>2. The domain owner coughs up their protection money to Atlassian and proves ownership of the domain.<p>3. Your password-protected account is assigned to the domain owner. Your password and 2FA invalid. The domain owner can access your private data without your password and 2FA.<p>Both TFA and the thing I described rely on broken, simplistic views of &quot;domain ownership == account ownership&quot;.</div><br/></div></div><div id="42705494" class="c"><input type="checkbox" id="c-42705494" checked=""/><div class="controls bullet"><span class="by">bhartzer</span><span>|</span><a href="#42703958">prev</a><span>|</span><a href="#42700698">next</a><span>|</span><label class="collapse" for="c-42705494">[-]</label><label class="expand" for="c-42705494">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think this has anything to do with Google&#x27;s OAuth. This issue is literally with every single expired domain name out there. All one has to do is register the expired domain and look at all the emails sent to that domain.<p>Granted, Google &quot;could&quot; do something, but I don&#x27;t think it&#x27;s Google&#x27;s responsibility to police expired domain names. What am I missing here?</div><br/></div></div><div id="42700738" class="c"><input type="checkbox" id="c-42700738" checked=""/><div class="controls bullet"><span class="by">_pete_</span><span>|</span><a href="#42700698">prev</a><span>|</span><a href="#42703493">next</a><span>|</span><label class="collapse" for="c-42700738">[-]</label><label class="expand" for="c-42700738">[2 more]</label></div><br/><div class="children"><div class="content">Thankfully, apparently this only affects Americans.</div><br/><div id="42700878" class="c"><input type="checkbox" id="c-42700878" checked=""/><div class="controls bullet"><span class="by">lysace</span><span>|</span><a href="#42700738">parent</a><span>|</span><a href="#42703493">next</a><span>|</span><label class="collapse" for="c-42700878">[-]</label><label class="expand" for="c-42700878">[1 more]</label></div><br/><div class="children"><div class="content">:-)</div><br/></div></div></div></div><div id="42703493" class="c"><input type="checkbox" id="c-42703493" checked=""/><div class="controls bullet"><span class="by">chavesn</span><span>|</span><a href="#42700738">prev</a><span>|</span><a href="#42701285">next</a><span>|</span><label class="collapse" for="c-42703493">[-]</label><label class="expand" for="c-42703493">[1 more]</label></div><br/><div class="children"><div class="content">If oauth makes an authenticity claim, it should be true. Saying it&#x27;s the same user when it&#x27;s not is bad, clearly.<p>in other words: Google could make a more accurate authenticity claim than they currently do.<p>This problem would be worse without oauth, though, right? With plain email login, all they would need to do is &quot;forgot password&quot; and there wouldn&#x27;t even be a way to tell.<p>in other words: Email login would never be able to make a more accurate authenticity claim.</div><br/></div></div><div id="42701285" class="c"><input type="checkbox" id="c-42701285" checked=""/><div class="controls bullet"><span class="by">seeknotfind</span><span>|</span><a href="#42703493">prev</a><span>|</span><a href="#42699432">next</a><span>|</span><label class="collapse" for="c-42701285">[-]</label><label class="expand" for="c-42701285">[2 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t let domains you use lapse. Never get rid of a phone number.</div><br/><div id="42704046" class="c"><input type="checkbox" id="c-42704046" checked=""/><div class="controls bullet"><span class="by">ycombinatrix</span><span>|</span><a href="#42701285">parent</a><span>|</span><a href="#42699432">next</a><span>|</span><label class="collapse" for="c-42704046">[-]</label><label class="expand" for="c-42704046">[1 more]</label></div><br/><div class="children"><div class="content">A lot of these new TLDs have variable registration fees. They&#x27;re going to price a lot of people out of renewals.</div><br/></div></div></div></div><div id="42699432" class="c"><input type="checkbox" id="c-42699432" checked=""/><div class="controls bullet"><span class="by">simiones</span><span>|</span><a href="#42701285">prev</a><span>|</span><a href="#42703740">next</a><span>|</span><label class="collapse" for="c-42699432">[-]</label><label class="expand" for="c-42699432">[3 more]</label></div><br/><div class="children"><div class="content">I would be curious if any other Identity Providers that implement OAuth have mitigations for this issue. If you used sign in with Microsoft or Okta or PingFederate, would those provide different claims to the service?</div><br/><div id="42700276" class="c"><input type="checkbox" id="c-42700276" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42699432">parent</a><span>|</span><a href="#42700227">next</a><span>|</span><label class="collapse" for="c-42700276">[-]</label><label class="expand" for="c-42700276">[1 more]</label></div><br/><div class="children"><div class="content">Ideally the trust with the SP would be using a cert. This requires the SP to implement this portion of the standard and the IT department to follow through with implementing a cert. The cert can be self-generated, so there isn&#x27;t a cost for the cert itself.</div><br/></div></div><div id="42700227" class="c"><input type="checkbox" id="c-42700227" checked=""/><div class="controls bullet"><span class="by">ratg13</span><span>|</span><a href="#42699432">parent</a><span>|</span><a href="#42700276">prev</a><span>|</span><a href="#42703740">next</a><span>|</span><label class="collapse" for="c-42700227">[-]</label><label class="expand" for="c-42700227">[1 more]</label></div><br/><div class="children"><div class="content">Every provider has their own set of flaws.<p>Microsoft had a flaw for awhile where you could just change a user’s email to anything with no verification.. and if the SSO implementer was only checking the email field, you could impersonate anyone.</div><br/></div></div></div></div><div id="42703740" class="c"><input type="checkbox" id="c-42703740" checked=""/><div class="controls bullet"><span class="by">zahlman</span><span>|</span><a href="#42699432">prev</a><span>|</span><a href="#42701571">next</a><span>|</span><label class="collapse" for="c-42703740">[-]</label><label class="expand" for="c-42703740">[1 more]</label></div><br/><div class="children"><div class="content">One of the unintended side effects of Noscript is this sort of unintended hilarity:<p>&gt; These claims usually include:<p>&gt; hd (hosted domain): Specifies the domain, e.g., example.com.<p>&gt; email: The user&#x27;s email address, e.g., [email protected].<p>The <i>placeholder, hypothetical</i> email address is being &quot;protected&quot; from web scraping.<p>In the context of an article on a security website about identities being spoofed through email accounts.</div><br/></div></div><div id="42701571" class="c"><input type="checkbox" id="c-42701571" checked=""/><div class="controls bullet"><span class="by">pfooti</span><span>|</span><a href="#42703740">prev</a><span>|</span><label class="collapse" for="c-42701571">[-]</label><label class="expand" for="c-42701571">[1 more]</label></div><br/><div class="children"><div class="content">I think the problem is here in the doc:<p>I have worked with a few of these downstream providers to look for a solution. There is a documented unique user identifier (the sub claim) that could theoretically prevent this issue, but in practice, it&#x27;s unreliable ... According to a staff engineer at a major tech company: “The sub claim changes in about 0.04% of logins from Log in with Google. For us, that&#x27;s hundreds of users last week”.<p>The real solution is to use the sub claim, and not hd&#x2F;email. If sub is unreliable, let&#x27;s fix that. That said, I&#x27;m surprised sub is documented as unreliable here; I wonder if there is perhaps something else going on. I&#x27;ve done a lot of work with oauth and I haven&#x27;t found sub to be so mutable, but then again, who knows maybe I just missed it?<p>And yeah, lapsed domains =&gt; domain takeover =&gt; email takeover and impersonation will always be a baseline problem, independent of oauth.</div><br/></div></div></div></div></div></div></div></body></html>