<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732266086309" as="style"/><link rel="stylesheet" href="styles.css?v=1732266086309"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.welivesecurity.com/en/eset-research/unveiling-wolfsbane-gelsemiums-linux-counterpart-to-gelsevirine/">Security researchers identify new malware targeting Linux</a> <span class="domain">(<a href="https://www.welivesecurity.com">www.welivesecurity.com</a>)</span></div><div class="subtext"><span>heresie-dabord</span> | <span>32 comments</span></div><br/><div><div id="42211483" class="c"><input type="checkbox" id="c-42211483" checked=""/><div class="controls bullet"><span class="by">cookiengineer</span><span>|</span><a href="#42209844">next</a><span>|</span><label class="collapse" for="c-42211483">[-]</label><label class="expand" for="c-42211483">[8 more]</label></div><br/><div class="children"><div class="content">Seems like their malware relies on a couple of things:<p>- intended target is KDE and GNOME<p>- privilege escalation through LD_PRELOAD hooking from userland via open, stat, readdir access (of any other program that the user executes, see down below)<p>- persistence through display manager config for KDE<p>- persistence through desktop autostart files for GNOME<p>- fallback persistence through .bashrc,  profile or profile.sh in &#x2F;etc<p>- installs trojanized ssh client version<p>- installs a JSP webshell<p>- sideloads kernel module as libselinux.so and .ko module. Probably the rootkit helpers to access them from userland<p>Despite the snarky comments in here, this malware is actually quite sophisticated.<p>If you don&#x27;t agree, I challenge you now to measure the time it takes for you to find all .so files on your system that are loaded right now, and have been modified since your package manager installed them.<p>My point being that there is no EDR on Linux that catches this (apart from ours that&#x27;s WIP), because all existing tools are just checking for windows malware hashes (not even symbols) as they&#x27;re intended for linux fileservers.</div><br/><div id="42212200" class="c"><input type="checkbox" id="c-42212200" checked=""/><div class="controls bullet"><span class="by">taneliv</span><span>|</span><a href="#42211483">parent</a><span>|</span><a href="#42212079">next</a><span>|</span><label class="collapse" for="c-42212200">[-]</label><label class="expand" for="c-42212200">[1 more]</label></div><br/><div class="children"><div class="content">Less than a second to concatenate &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info&#x2F;<i>.md5sums, currently about six seconds to concatenate and filter &#x2F;var&#x2F;</i>&#x2F;maps. Actual checking time then depends on how much is currently mapped to memory and how performant the computer is, and how well one filters out mappings to files which were only in non-executable regions, but possibly a minute or three.<p>Perhaps more interestingly than how long it takes, some of the files mapped to memory are already deleted. They should have been checked at the time of loading, not hours or days later, when it&#x27;s not longer possible.</div><br/></div></div><div id="42212079" class="c"><input type="checkbox" id="c-42212079" checked=""/><div class="controls bullet"><span class="by">xorcist</span><span>|</span><a href="#42211483">parent</a><span>|</span><a href="#42212200">prev</a><span>|</span><a href="#42211911">next</a><span>|</span><label class="collapse" for="c-42212079">[-]</label><label class="expand" for="c-42212079">[2 more]</label></div><br/><div class="children"><div class="content">Challenge accepted. &quot;All files loaded&quot; is probably not what you want to do however. It is much easier to just ask rpm directly which files under your library directory has been modified, and treat any files outside known library directories as suspicious.<p>Anyway, this is how you check which open files match &quot;.so&quot; and see if they are modified since installation:<p><pre><code>  lsof | grep -o &quot;&#x2F;[^ ]*\.so[^ ]*&quot; | while read path ; do
    pkg=$(rpm -qf &quot;$path&quot; 2&gt;&#x2F;dev&#x2F;null)
    if [ $? != 0 ] ; then
      echo &quot;$path does not belong to a package&quot;
    else
      rpm -V $pkg | grep -F &quot;$path&quot;
    fi
  done</code></pre></div><br/><div id="42212174" class="c"><input type="checkbox" id="c-42212174" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#42211483">root</a><span>|</span><a href="#42212079">parent</a><span>|</span><a href="#42211911">next</a><span>|</span><label class="collapse" for="c-42212174">[-]</label><label class="expand" for="c-42212174">[1 more]</label></div><br/><div class="children"><div class="content">Didn&#x27;t check the code, but lsof seems a good approach.<p>How does that work with the various namespaces? From root namespace you should see everything. But in a mount namespace you could bind mount under a different name. How would that confuse things? With a SELinux module even root cannot do everything. If &#x2F;proc is mounted privately does it change anything?<p>Not sure, just starting to think. Linux has become incredibly complex since the old days...<p>Edit: orc routinely loads executable sections not belonging to any package.</div><br/></div></div></div></div><div id="42211911" class="c"><input type="checkbox" id="c-42211911" checked=""/><div class="controls bullet"><span class="by">jchw</span><span>|</span><a href="#42211483">parent</a><span>|</span><a href="#42212079">prev</a><span>|</span><a href="#42211807">next</a><span>|</span><label class="collapse" for="c-42211911">[-]</label><label class="expand" for="c-42211911">[1 more]</label></div><br/><div class="children"><div class="content">Securing Linux should probably not be approached the exact same way as securing Windows. Case in point, it is true that I can&#x27;t find all of the .so files that have been modified since my package manager installed them: this is because it didn&#x27;t install them, because I am using NixOS. They just exist in the Nix store, which is mounted read-only, and almost all modules are loaded from an absolute runpath.<p>NixOS with impermanence isn&#x27;t exactly a security solution, but it does have some nice properties as a base for a secure system. It&#x27;s also far from the only or even most notable of the immutable Linux systems, with abroot and RPM-ostree seeing more usage. It&#x27;s probable there will still be some use in endpoint security but I suspect it will be greatly diminished if immutable image-based deployments with a secure boot chain is perfected on the Linux desktop system, for similar reasons to why it isn&#x27;t really as important on ChromeOS either.<p>I also understand that this is not a silver bullet, as it&#x27;s still possible on desktop Linux to persist malware through the bashrc&#x2F;etc. like this does. Personally I blank out my home directory shell profile files and keep them root-owned to try to prevent them from being used for anything. It seems like more work is needed in the Linux ecosystem to figure out what to do about attack vectors like these, though I think a proactive approach would be preferred. (Scanning for infected files is always going to be useful, but obviously it&#x27;s better if you stop it from happening in the first place.) In some ways the Linux desktop has gotten a bit more secure but many things are still not sandboxed sufficiently, which is a shame considering all of the great sandboxing technology available on Linux.</div><br/></div></div><div id="42211807" class="c"><input type="checkbox" id="c-42211807" checked=""/><div class="controls bullet"><span class="by">b3lvedere</span><span>|</span><a href="#42211483">parent</a><span>|</span><a href="#42211911">prev</a><span>|</span><a href="#42211906">next</a><span>|</span><label class="collapse" for="c-42211807">[-]</label><label class="expand" for="c-42211807">[1 more]</label></div><br/><div class="children"><div class="content">&gt;intended target is KDE and GNOME<p>Apologies for the dumb question, but does this mean my PiHole running on a small Debian server that has no KDE or Gnome installed, is safe from this?</div><br/></div></div><div id="42211906" class="c"><input type="checkbox" id="c-42211906" checked=""/><div class="controls bullet"><span class="by">vaylian</span><span>|</span><a href="#42211483">parent</a><span>|</span><a href="#42211807">prev</a><span>|</span><a href="#42209844">next</a><span>|</span><label class="collapse" for="c-42211906">[-]</label><label class="expand" for="c-42211906">[2 more]</label></div><br/><div class="children"><div class="content">This is interesting. Most Linux malware is targeting servers which usually don&#x27;t have Gnome or KDE installed.</div><br/><div id="42212121" class="c"><input type="checkbox" id="c-42212121" checked=""/><div class="controls bullet"><span class="by">GoblinSlayer</span><span>|</span><a href="#42211483">root</a><span>|</span><a href="#42211906">parent</a><span>|</span><a href="#42209844">next</a><span>|</span><label class="collapse" for="c-42212121">[-]</label><label class="expand" for="c-42212121">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t target KDE, it&#x27;s just the developer of backdoor runs KDE, so a running process named kde looks innocent on his machine. Similar reason for .Xl1 folder: if rootkit hid .X11 folder, it would break xorg on the developer&#x27;s machine. And some server distros allow to install with KDE interface.</div><br/></div></div></div></div></div></div><div id="42209844" class="c"><input type="checkbox" id="c-42209844" checked=""/><div class="controls bullet"><span class="by">linsomniac</span><span>|</span><a href="#42211483">prev</a><span>|</span><a href="#42212188">next</a><span>|</span><label class="collapse" for="c-42209844">[-]</label><label class="expand" for="c-42209844">[5 more]</label></div><br/><div class="children"><div class="content">If I am skimming this correctly, this is a C&amp;C client allowing remote control over the network, and uses &quot;a rootkit&quot; for further compromise once it somehow gets installed?<p>I understand the value of in-depth security reports, but the 5th time they told me &quot;WolfsBane is the Linux counterpart of Gelsevirine, while FireWood is connected to Project Wood.&quot; I was wondering when I&#x27;d get to the meat and potatoes.</div><br/><div id="42210177" class="c"><input type="checkbox" id="c-42210177" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#42209844">parent</a><span>|</span><a href="#42210807">next</a><span>|</span><label class="collapse" for="c-42210177">[-]</label><label class="expand" for="c-42210177">[3 more]</label></div><br/><div class="children"><div class="content">&quot;once it somehow gets installed?&quot;<p>The report mentions: &quot;we conclude ... exploited an unknown web application vulnerability ... .&quot;<p>The chain of events, post initial exploit, is all very well but what was the initial point of entry?  The IoCs etc are welcome - thanks.</div><br/><div id="42211090" class="c"><input type="checkbox" id="c-42211090" checked=""/><div class="controls bullet"><span class="by">aorloff</span><span>|</span><a href="#42209844">root</a><span>|</span><a href="#42210177">parent</a><span>|</span><a href="#42210807">next</a><span>|</span><label class="collapse" for="c-42211090">[-]</label><label class="expand" for="c-42211090">[2 more]</label></div><br/><div class="children"><div class="content">I thought SQL injection but actually Tomcat ?  Might be just an old unpatched server allowing PUTs</div><br/></div></div></div></div><div id="42210807" class="c"><input type="checkbox" id="c-42210807" checked=""/><div class="controls bullet"><span class="by">PcChip</span><span>|</span><a href="#42209844">parent</a><span>|</span><a href="#42210177">prev</a><span>|</span><a href="#42212188">next</a><span>|</span><label class="collapse" for="c-42210807">[-]</label><label class="expand" for="c-42210807">[1 more]</label></div><br/><div class="children"><div class="content">I agree it was very wordy</div><br/></div></div></div></div><div id="42212188" class="c"><input type="checkbox" id="c-42212188" checked=""/><div class="controls bullet"><span class="by">c16</span><span>|</span><a href="#42209844">prev</a><span>|</span><a href="#42209633">next</a><span>|</span><label class="collapse" for="c-42212188">[-]</label><label class="expand" for="c-42212188">[1 more]</label></div><br/><div class="children"><div class="content">What AV (if any?) would people recommend for linux? I feel that clamav is more for incoming files than something which would or could catch this?</div><br/></div></div><div id="42209897" class="c"><input type="checkbox" id="c-42209897" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#42209633">prev</a><span>|</span><a href="#42210446">next</a><span>|</span><label class="collapse" for="c-42209897">[-]</label><label class="expand" for="c-42209897">[1 more]</label></div><br/><div class="children"><div class="content">For signs of the analyzed version, there&#x27;s this file:<p>&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;display-managerd.service<p>And a process called &quot;kde&quot;.</div><br/></div></div><div id="42210446" class="c"><input type="checkbox" id="c-42210446" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#42209897">prev</a><span>|</span><a href="#42210778">next</a><span>|</span><label class="collapse" for="c-42210446">[-]</label><label class="expand" for="c-42210446">[9 more]</label></div><br/><div class="children"><div class="content">&gt; The FireWood backdoor, in a file named dbus, is the Linux OS continuation of the Project Wood malware...
&gt; The analyzed code suggests that the file usbdev.ko is a kernel driver module working as a rootkit to hide processes.<p>Where is the backdoor coming from? If there&#x27;s a backdoor, something is backdoored. An unknown exploit installing a rootkit and using a modified file, like usbdev.ko, is not a backdoor.<p>Which pakage &#x2F; OS ships with the backdoor?<p>Or doesn&#x27;t the author of TFA know the definition of a backdoor? Or is it me? I mean, to me the XZ utils exploit attempt was a backdoor (for example). But I see nothing here indicating the exploit they&#x27;re talking about is a backdoor.<p>It reads like they classify anything opening ports and trying to evade detection as &quot;backdoors&quot;.<p>Am I going nuts?</div><br/><div id="42211822" class="c"><input type="checkbox" id="c-42211822" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42210446">parent</a><span>|</span><a href="#42211824">next</a><span>|</span><label class="collapse" for="c-42211822">[-]</label><label class="expand" for="c-42211822">[2 more]</label></div><br/><div class="children"><div class="content">I believe any software that, once installed on a system, gives someone else remote access to control that system is &quot;a backdoor&quot;. So the malware itself is &quot;the backdoor&quot;, it&#x27;s not a case of &quot;package X has a backdoor that was exploited&quot;.<p>Not all malware acts like a backdoor: some malware exfiltrates data, some seeks to destroy the system, some encrypts data to hold it hostage, some performs attacks on other systems using your CPU&#x2F;IP&#x2F;memory, etc. The malware they are describing here does act like a backdoor though, and doesn&#x27;t seem to have other malicious behavior.</div><br/><div id="42212142" class="c"><input type="checkbox" id="c-42212142" checked=""/><div class="controls bullet"><span class="by">Out_of_Characte</span><span>|</span><a href="#42210446">root</a><span>|</span><a href="#42211822">parent</a><span>|</span><a href="#42211824">next</a><span>|</span><label class="collapse" for="c-42212142">[-]</label><label class="expand" for="c-42212142">[1 more]</label></div><br/><div class="children"><div class="content">A backdoor is a literal door that the building was designed with. Whatever purpose it served, criminals could sometimes use it to gain covert access.</div><br/></div></div></div></div><div id="42211824" class="c"><input type="checkbox" id="c-42211824" checked=""/><div class="controls bullet"><span class="by">wood_spirit</span><span>|</span><a href="#42210446">parent</a><span>|</span><a href="#42211822">prev</a><span>|</span><a href="#42211063">next</a><span>|</span><label class="collapse" for="c-42211824">[-]</label><label class="expand" for="c-42211824">[2 more]</label></div><br/><div class="children"><div class="content">firewood is a back door, ie a program installed to provide access bypassing the systems normal authentication etc.<p>The article says they don’t know how the attacker gets access to install this back door in the first place.</div><br/><div id="42211881" class="c"><input type="checkbox" id="c-42211881" checked=""/><div class="controls bullet"><span class="by">shiroiushi</span><span>|</span><a href="#42210446">root</a><span>|</span><a href="#42211824">parent</a><span>|</span><a href="#42211063">next</a><span>|</span><label class="collapse" for="c-42211881">[-]</label><label class="expand" for="c-42211881">[1 more]</label></div><br/><div class="children"><div class="content">&gt;The article says they don’t know how the attacker gets access to install this back door in the first place.<p>It doesn&#x27;t really matter, because it&#x27;s orthogonal.  Malware like this can be installed on a system through any exploit that provides sufficient access.<p>So there&#x27;s two parts to defending against it: 1) finding and fixing any vulnerability that allows the installation of malware like this, and 2) since #1 is a never-ending task, knowing about this malware so you can look specifically for it and delete it when you find it.</div><br/></div></div></div></div><div id="42211063" class="c"><input type="checkbox" id="c-42211063" checked=""/><div class="controls bullet"><span class="by">NegativeK</span><span>|</span><a href="#42210446">parent</a><span>|</span><a href="#42211824">prev</a><span>|</span><a href="#42210920">next</a><span>|</span><label class="collapse" for="c-42211063">[-]</label><label class="expand" for="c-42211063">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think you&#x27;re going nuts, but I do think your definition of backdoor is a specific subset.</div><br/></div></div><div id="42210920" class="c"><input type="checkbox" id="c-42210920" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#42210446">parent</a><span>|</span><a href="#42211063">prev</a><span>|</span><a href="#42210778">next</a><span>|</span><label class="collapse" for="c-42210920">[-]</label><label class="expand" for="c-42210920">[3 more]</label></div><br/><div class="children"><div class="content">Fits the usual definition, e.g. from Wikipedia:<p>&gt; A backdoor is a typically covert method of bypassing normal authentication or encryption</div><br/><div id="42211729" class="c"><input type="checkbox" id="c-42211729" checked=""/><div class="controls bullet"><span class="by">aulin</span><span>|</span><a href="#42210446">root</a><span>|</span><a href="#42210920">parent</a><span>|</span><a href="#42210778">next</a><span>|</span><label class="collapse" for="c-42211729">[-]</label><label class="expand" for="c-42211729">[2 more]</label></div><br/><div class="children"><div class="content">Agree with OP, wikipedia is also wrong. A backdoor is something intentional. That definition fits any exploitable bug.</div><br/><div id="42211792" class="c"><input type="checkbox" id="c-42211792" checked=""/><div class="controls bullet"><span class="by">wood_spirit</span><span>|</span><a href="#42210446">root</a><span>|</span><a href="#42211729">parent</a><span>|</span><a href="#42210778">next</a><span>|</span><label class="collapse" for="c-42211792">[-]</label><label class="expand" for="c-42211792">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps we use the term back door in computer security because it comes from the general English expression to get someone or something in by the back door, which more generally is any exploit?</div><br/></div></div></div></div></div></div></div></div><div id="42210778" class="c"><input type="checkbox" id="c-42210778" checked=""/><div class="controls bullet"><span class="by">ajsnigrutin</span><span>|</span><a href="#42210446">prev</a><span>|</span><a href="#42210366">next</a><span>|</span><label class="collapse" for="c-42210778">[-]</label><label class="expand" for="c-42210778">[1 more]</label></div><br/><div class="children"><div class="content">So, an aplication started as root it does a lot, if started as a normal user, does less.  Sure, any first year CS student can write something like that. Or you can.. well.. install an ssh server or a vnc server or whatever.<p>How it gets onto the system in the first place is the interesting (and dangerous) part, that sadly gets skimmed over here.</div><br/></div></div><div id="42210366" class="c"><input type="checkbox" id="c-42210366" checked=""/><div class="controls bullet"><span class="by">stepupmakeup</span><span>|</span><a href="#42210778">prev</a><span>|</span><label class="collapse" for="c-42210366">[-]</label><label class="expand" for="c-42210366">[5 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the point of these kinds of articles? Most Linux malware (including this one) are not sophisticated at all, built off of pre-existing rootkit code samples off Github and quite sloppy with leaving files and traces (&quot;.Xl1&quot;, modifying bashrc, really?). And there&#x27;s a weird fixation on China here, is it just more anti-China propaganda?</div><br/><div id="42210706" class="c"><input type="checkbox" id="c-42210706" checked=""/><div class="controls bullet"><span class="by">jamesmotherway</span><span>|</span><a href="#42210366">parent</a><span>|</span><label class="collapse" for="c-42210706">[-]</label><label class="expand" for="c-42210706">[4 more]</label></div><br/><div class="children"><div class="content">Threat actors don&#x27;t create malware to impress people; they do it to accomplish their goals. Apparently, this sample was sufficient for them.<p>Security companies attribute activity based on their observations. ESET- a Slovakian company- is no exception.</div><br/><div id="42210780" class="c"><input type="checkbox" id="c-42210780" checked=""/><div class="controls bullet"><span class="by">stepupmakeup</span><span>|</span><a href="#42210366">root</a><span>|</span><a href="#42210706">parent</a><span>|</span><label class="collapse" for="c-42210780">[-]</label><label class="expand" for="c-42210780">[3 more]</label></div><br/><div class="children"><div class="content">I was under the impression that persistent, but SILENT access was China&#x27;s goal. Dropping files in home and &#x2F;tmp&#x2F; seems like the total opposite of that and any competent sysadmin would detect these anomalies manually real quick with a simple &quot;ls -a&quot;, even possibly by accident.</div><br/><div id="42211278" class="c"><input type="checkbox" id="c-42211278" checked=""/><div class="controls bullet"><span class="by">jchmbrln</span><span>|</span><a href="#42210366">root</a><span>|</span><a href="#42210780">parent</a><span>|</span><a href="#42211053">next</a><span>|</span><label class="collapse" for="c-42211278">[-]</label><label class="expand" for="c-42211278">[1 more]</label></div><br/><div class="children"><div class="content">From the article:<p>&gt; The WolfsBane Hider rootkit hooks many basic standard C library functions such as open, stat, readdir, and access. While these hooked functions invoke the original ones, they filter out any results related to the WolfsBane malware.<p>I took this to mean some things like a simple “ls -a” might now leave out those suspicious results.</div><br/></div></div><div id="42211053" class="c"><input type="checkbox" id="c-42211053" checked=""/><div class="controls bullet"><span class="by">NegativeK</span><span>|</span><a href="#42210366">root</a><span>|</span><a href="#42210780">parent</a><span>|</span><a href="#42211278">prev</a><span>|</span><label class="collapse" for="c-42211053">[-]</label><label class="expand" for="c-42211053">[1 more]</label></div><br/><div class="children"><div class="content">Chinese threat actors are not one homogeneous group. Just like every other country out there.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>