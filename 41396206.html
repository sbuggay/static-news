<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725008476993" as="style"/><link rel="stylesheet" href="styles.css?v=1725008476993"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.haskellforall.com/2024/08/firewall-rules-not-as-secure-as-you.html">Firewall rules: not as secure as you think</a> <span class="domain">(<a href="https://www.haskellforall.com">www.haskellforall.com</a>)</span></div><div class="subtext"><span>jnord</span> | <span>39 comments</span></div><br/><div><div id="41397915" class="c"><input type="checkbox" id="c-41397915" checked=""/><div class="controls bullet"><span class="by">CraigJPerry</span><span>|</span><a href="#41396233">next</a><span>|</span><label class="collapse" for="c-41397915">[-]</label><label class="expand" for="c-41397915">[1 more]</label></div><br/><div class="children"><div class="content">Corkscrew, ohh that takes me back to the time I nearly got sacked. The GitHub repo is 8 years old but corkscrew is much older.<p>I was working at a big place at the time. I had a fairly extensive home lab. I used to practice data migrations on synthetic data at home, provoke failures in my safe home lab env then write scripts to automate the migration while catching all the gotchas I could think of (think disk space filling up mid-migration, that kinda thing).<p>Anyway, I was using ssh pre commands and netcat (corkscrew makes this way simpler to do, I didn’t learn about corkscrew until afterwards) to punch through from my desk at work to my lab at home so I could copy in my scripts. Big no-no but at the time that was not clear to me at all. I didn’t even consider I might be violating a rule.<p>They flew a couple of “security officers” to the office I worked at  to give me the full shake down… ooops!<p>A frustrating thing was that the people they flew (at great expense, international flight) were not that technical, one was an ex-cop as I recall. Trying to explain what I was doing and how it worked was pretty tough! Actually the most frustrating thing from my point of view was in my mind I was showing initiative and doing all this free work outside of work and here I was getting threatened with dismissal…</div><br/></div></div><div id="41396233" class="c"><input type="checkbox" id="c-41396233" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#41397915">prev</a><span>|</span><a href="#41397575">next</a><span>|</span><label class="collapse" for="c-41396233">[-]</label><label class="expand" for="c-41396233">[16 more]</label></div><br/><div class="children"><div class="content">This methods discussed in the article are how I have seen some hardware appliance vendors SSH into their devices despite the customer only allowing outbound connections to a cloud provider.  I would call these out in security reviews and it would get political really fast as the team buying the device wanted this feature but the compliance team wanted the flows documented that would conflict with security policies and ultimately would cause an audit failure.  It got even more interesting when one of the vendors was also a B2B customer.  A firewall vendor claimed they could block anything inside that outbound HTTPS connection that was not HTTP but they could not.  I will not be permitted to add specific details such as the appliance vendor or firewall vendor.<p>I would wager some companies don&#x27;t even know that a vendor can SSH into the customer datacenter <i>not just the device</i> despite only allowing outbound HTTPS flows to a cloud provider.</div><br/><div id="41396925" class="c"><input type="checkbox" id="c-41396925" checked=""/><div class="controls bullet"><span class="by">smashed</span><span>|</span><a href="#41396233">parent</a><span>|</span><a href="#41396839">next</a><span>|</span><label class="collapse" for="c-41396925">[-]</label><label class="expand" for="c-41396925">[10 more]</label></div><br/><div class="children"><div class="content">I understand the technical issue but on a broader sense, the instant that a vendor supplied black box is installed behind your firewall and allowed to make any sort of communication towards a vendor controlled endpoint, doesn&#x27;t it immediately technically allows full remote control?<p>Lots of talk about tunneling and wrapping&#x2F;disguising ssh but a vendor does not need any of that to control its machine.<p>For example you could have the on-prem host poll a &quot;licensing&quot; or &quot;software update&quot; server that also happens to reply with ad-hoc commands to execute on demand. Could be straight up shell commands and the result can be sent back. No need for ssh, long lived connections, reverse tunnels or anything.<p>The only way to mitigate this is to fully trust the vendor, have a strong legal framework to protect against wrongdoings or fully block all internet access to endpoints you don&#x27;t fully control.</div><br/><div id="41396979" class="c"><input type="checkbox" id="c-41396979" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396925">parent</a><span>|</span><a href="#41397455">next</a><span>|</span><label class="collapse" for="c-41396979">[-]</label><label class="expand" for="c-41396979">[6 more]</label></div><br/><div class="children"><div class="content">I understand where you are coming from and that it should be assumed a vendor box can do anything even without SSH.  Other teams don&#x27;t think this way however.  <i>&quot;Oh its just outbound HTTPS, no inbound connections, totally fine&quot;</i> is the school of thought I was up against.   Adding to this the box was expected to send hundreds of GB of logs to do <i>&quot;big-data&quot;</i> against daily to monitor it&#x27;s health, thus training firewalls, IDS and humans to expect this outbound data volume, which could with the flip of a bit start exfiltrating customer data.  If I told you what this box was for you would know how insane it would be to send more than 500KB per day for that purpose.  It seems I share something in common with Boeing <i>&quot;line stoppers&quot;</i>.   There are details I wish I could share as they would drive home how insane this entire debacle was.  I expect to read about it in the news some day.</div><br/><div id="41397646" class="c"><input type="checkbox" id="c-41397646" checked=""/><div class="controls bullet"><span class="by">Bluecobra</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396979">parent</a><span>|</span><a href="#41397172">next</a><span>|</span><label class="collapse" for="c-41397646">[-]</label><label class="expand" for="c-41397646">[2 more]</label></div><br/><div class="children"><div class="content">This is a good point.  I would expect that a device like a SAN is just sending telemetry&#x2F;logs&#x2F;diagnostics back to the mothership for support purposes.  Having a a persistent tunnel kinda of sucks and I much prefer something like shell access being done over a remote support&#x2F;screen sharing app so I can see what they are doing.  Previous security fiascos like the Solarwinds hack come to mind and an attacker could have a foothold inside a trusted&#x2F;internal network.</div><br/><div id="41398585" class="c"><input type="checkbox" id="c-41398585" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41397646">parent</a><span>|</span><a href="#41397172">next</a><span>|</span><label class="collapse" for="c-41398585">[-]</label><label class="expand" for="c-41398585">[1 more]</label></div><br/><div class="children"><div class="content">To be properly paranoid, I would allow the device to send telemetry and diagnostics, but only <i>through my proxy</i>. The outbound stream can be as encrypted as they want, but I will demand the ability <i>to decode the answer</i>, and decide whether I let it come back to the box.<p>I wonder how many vendors would agree to offer this, and how much more would t then cost.<p>(If you update software from the vendor&#x27;s resource, all bets are off, because you just run their software which can do anything your security measures would not prevent it from doing. You have to very  seriously trust the vendor of your OS, if you may be a high-value target.)</div><br/></div></div></div></div><div id="41397172" class="c"><input type="checkbox" id="c-41397172" checked=""/><div class="controls bullet"><span class="by">j-bos</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396979">parent</a><span>|</span><a href="#41397646">prev</a><span>|</span><a href="#41397039">next</a><span>|</span><label class="collapse" for="c-41397172">[-]</label><label class="expand" for="c-41397172">[2 more]</label></div><br/><div class="children"><div class="content">Sounds like a situation needing a whistleblower.</div><br/><div id="41397524" class="c"><input type="checkbox" id="c-41397524" checked=""/><div class="controls bullet"><span class="by">BonoboIO</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41397172">parent</a><span>|</span><a href="#41397039">next</a><span>|</span><label class="collapse" for="c-41397524">[-]</label><label class="expand" for="c-41397524">[1 more]</label></div><br/><div class="children"><div class="content">Hopefully not ending like the Boeing whistleblowers</div><br/></div></div></div></div><div id="41397039" class="c"><input type="checkbox" id="c-41397039" checked=""/><div class="controls bullet"><span class="by">Silhouette</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396979">parent</a><span>|</span><a href="#41397172">prev</a><span>|</span><a href="#41397455">next</a><span>|</span><label class="collapse" for="c-41397039">[-]</label><label class="expand" for="c-41397039">[1 more]</label></div><br/><div class="children"><div class="content">This is always the problem with firewalls. If your adversary controls both ends of the connection then it&#x27;s not outbound HTTPS traffic you&#x27;re letting through. It&#x27;s <i>totally arbitrary</i> two-way traffic that happens to be transmitted over a connection first established to port 443 on the remote host.<p>The only useful technical defence against this kind of deception today is deep packet inspection and a policy of blocking everything by default and only permitting through packets you can actively approve. But that becomes very expensive very quickly and there are practical limits on how far you can go. Ultimately if your adversary is willing to engage covertly in the kind of hacks mentioned in the article then they&#x27;re probably also willing to engage in steganography to get past whatever DPI rules you can afford to run. Then you&#x27;re back to square one and either you trust their device or you sandbox it.<p>In reality a more effective defence is probably the one involving contracts with severe penalties for this kind of behaviour and liability for any consequential losses.</div><br/></div></div></div></div><div id="41397455" class="c"><input type="checkbox" id="c-41397455" checked=""/><div class="controls bullet"><span class="by">gz5</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396925">parent</a><span>|</span><a href="#41396979">prev</a><span>|</span><a href="#41397063">next</a><span>|</span><label class="collapse" for="c-41397455">[-]</label><label class="expand" for="c-41397455">[1 more]</label></div><br/><div class="children"><div class="content">&gt;fully block all internet access to endpoints you don&#x27;t fully control.<p>Not that all risk can be eliminated, but this simplifies management while  reducing the attack surface area by orders of magnitude.<p>The good news is companies are increasingly doing it now that technology has finally caught up - now that implementing a private* network with each vendor (or a private extranet across all vendors) is actually viable and sensible.<p>* Usually a software-only, zero implicit trust overlay network</div><br/></div></div><div id="41397063" class="c"><input type="checkbox" id="c-41397063" checked=""/><div class="controls bullet"><span class="by">siamese_puff</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396925">parent</a><span>|</span><a href="#41397455">prev</a><span>|</span><a href="#41397548">next</a><span>|</span><label class="collapse" for="c-41397063">[-]</label><label class="expand" for="c-41397063">[1 more]</label></div><br/><div class="children"><div class="content">I mean, couldn’t any semi popular, transitive dependency installed with &lt;insert package manager here&gt; do the same thing with a reverse tunnel? Imagine a simple go module that kicks off a background routine that just keeps a tunnel open with a direct call to os.exec. Seems like an easy way to cat env and pipe back secrets to the attacker</div><br/></div></div><div id="41397548" class="c"><input type="checkbox" id="c-41397548" checked=""/><div class="controls bullet"><span class="by">KennyBlanken</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396925">parent</a><span>|</span><a href="#41397063">prev</a><span>|</span><a href="#41396839">next</a><span>|</span><label class="collapse" for="c-41397548">[-]</label><label class="expand" for="c-41397548">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I understand the technical issue but on a broader sense, the instant that a vendor supplied black box is installed behind your firewall and allowed to make any sort of communication towards a vendor controlled endpoint, doesn&#x27;t it immediately technically allows full remote control?<p>In the sense of &quot;isn&#x27;t it now possible on technical level?&quot;, yes.<p>On a legal level? You&#x27;re breaking into their network. At least in the US, but almost certainly in many other jurisdictions), there&#x27;s a very non-zero chance you&#x27;re engaged in illegal activity. <a href="https:&#x2F;&#x2F;www.justice.gov&#x2F;jm&#x2F;jm-9-48000-computer-fraud" rel="nofollow">https:&#x2F;&#x2F;www.justice.gov&#x2F;jm&#x2F;jm-9-48000-computer-fraud</a><p>On a PR level? <i>Definitely</i> not. The customer will be <i>furious</i> when they find out, and everyone who knows about it will tell <i>everyone</i> they know what you did, post about it on reddit&#x2F;twitter&#x2F;linkedin, not to mention discords and slacks. Even the helpdesk guys are gonna be telling their buddies over beers &quot;you wouldn&#x27;t believe what our netsec team caught our appliance from DumbassCo doing...&quot;<p>That doesn&#x27;t even get into the liabilities involved if the client has to meet security requirements from the government (as a contractor), PCI compliance, HIPPA compliance, SEC rules, etc. Imagine a client who needs compliance as a core part of their business because of your network appliance...<p>And then there&#x27;s the liability if the remote access capability turns out to be a security vulnerability that can be exploited by outside parties, is abused by an employee, or hackers break into your company and jump off from there to your clients.<p>There is nothing difficult about respecting &quot;no, you may not have remote access to our network or this system&quot; with no reason or justification provided. <i>They don&#x27;t need to justify or explain it to you</i>. It&#x27;s their network. Change the support contract terms if necessary, but don&#x27;t do anything the author idiotically suggests.<p>I see people claiming that &quot;it should be assumed the vendor can access your network&quot; - legally speaking, no, it sure shouldn&#x27;t. That&#x27;s like saying &quot;if you buy a laptop with a camera and microphone you should assume the laptop manufacturer can spy on you.&quot;<p>If you work at a company that does this sort of nonsense, now would be an excellent time to deactivate any &quot;hack our way into customer-owned equipment or networks&quot; functionality and urgently schedule a meeting with some lawyers.</div><br/></div></div></div></div><div id="41396839" class="c"><input type="checkbox" id="c-41396839" checked=""/><div class="controls bullet"><span class="by">Hizonner</span><span>|</span><a href="#41396233">parent</a><span>|</span><a href="#41396925">prev</a><span>|</span><a href="#41397102">next</a><span>|</span><label class="collapse" for="c-41396839">[-]</label><label class="expand" for="c-41396839">[3 more]</label></div><br/><div class="children"><div class="content">Seriously, there were fights over that?<p>In any remotely reasonable organization, that should be an instant, permanent blacklisting for the vendor, and termination of the &quot;we will escort you to clean out your desk right now&quot; variety for any internal employee who knew about it or enabled it. Probably with a line dropped to law enforcement.</div><br/><div id="41396951" class="c"><input type="checkbox" id="c-41396951" checked=""/><div class="controls bullet"><span class="by">ElevenLathe</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396839">parent</a><span>|</span><a href="#41397779">next</a><span>|</span><label class="collapse" for="c-41396951">[-]</label><label class="expand" for="c-41396951">[1 more]</label></div><br/><div class="children"><div class="content">That strikes me an example of how extremely unreasonable organization would behave, regardless of what it was in response to.</div><br/></div></div><div id="41397779" class="c"><input type="checkbox" id="c-41397779" checked=""/><div class="controls bullet"><span class="by">droopyEyelids</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41396839">parent</a><span>|</span><a href="#41396951">prev</a><span>|</span><a href="#41397102">next</a><span>|</span><label class="collapse" for="c-41397779">[-]</label><label class="expand" for="c-41397779">[1 more]</label></div><br/><div class="children"><div class="content">What reasonable company have you worked for before that had such an approach. The only place I could imagine it happening is at a boutique trading firm</div><br/></div></div></div></div><div id="41397102" class="c"><input type="checkbox" id="c-41397102" checked=""/><div class="controls bullet"><span class="by">BeefySwain</span><span>|</span><a href="#41396233">parent</a><span>|</span><a href="#41396839">prev</a><span>|</span><a href="#41397575">next</a><span>|</span><label class="collapse" for="c-41397102">[-]</label><label class="expand" for="c-41397102">[2 more]</label></div><br/><div class="children"><div class="content">You mention a couple times that you can&#x27;t give more details. Can you say why? NDA?</div><br/><div id="41397249" class="c"><input type="checkbox" id="c-41397249" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#41396233">root</a><span>|</span><a href="#41397102">parent</a><span>|</span><a href="#41397575">next</a><span>|</span><label class="collapse" for="c-41397249">[-]</label><label class="expand" for="c-41397249">[1 more]</label></div><br/><div class="children"><div class="content">Multiple NDA&#x27;s among other things.</div><br/></div></div></div></div></div></div><div id="41397575" class="c"><input type="checkbox" id="c-41397575" checked=""/><div class="controls bullet"><span class="by">nirui</span><span>|</span><a href="#41396233">prev</a><span>|</span><a href="#41397675">next</a><span>|</span><label class="collapse" for="c-41397575">[-]</label><label class="expand" for="c-41397575">[1 more]</label></div><br/><div class="children"><div class="content">For the SSH case mentioned in the article, `ssh -R` trick should already resolve some one-time contingencies (assuming SSH connection is not blocked).<p>But if you find yourself requesting `ssh -R` too often, maybe just ask those datacenter people to setup a proper SSH Bastion for you. There are opensource solutions and enterprise-level ones (Teleport for example: <a href="https:&#x2F;&#x2F;github.com&#x2F;gravitational&#x2F;teleport">https:&#x2F;&#x2F;github.com&#x2F;gravitational&#x2F;teleport</a>), some also allows you to do audit and access control, which maybe important if you work for a enterprise client.<p>The DIY solution described in the article literally punched a hole in the firewall. The firewall people might not like it.</div><br/></div></div><div id="41397675" class="c"><input type="checkbox" id="c-41397675" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#41397575">prev</a><span>|</span><a href="#41397180">next</a><span>|</span><label class="collapse" for="c-41397675">[-]</label><label class="expand" for="c-41397675">[1 more]</label></div><br/><div class="children"><div class="content">This is billed as a means of selling customers on-prem stuff that you can remote-manage into with SSH despite firewall rules blocking SSH. You can do this. You can get a lot more sophisticated than the tricks outlined in this article to make it happen. It is very difficult for customers to prevent you from doing it. And, if you do it, you&#x27;re going to get famous for doing it, when a customer that actually cares about your network security notices that you built a remote tunnel into their network.<p>I strongly advise anyone making product decisions to assume that none of these tricks work, and that there are no tricks you can use to build discreet remote management tunnels to devices (including hosts running your software) that have customer internal addresses assigned.</div><br/></div></div><div id="41397180" class="c"><input type="checkbox" id="c-41397180" checked=""/><div class="controls bullet"><span class="by">nunez</span><span>|</span><a href="#41397675">prev</a><span>|</span><a href="#41396996">next</a><span>|</span><label class="collapse" for="c-41397180">[-]</label><label class="expand" for="c-41397180">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You (the vendor) can ask the customer to open their firewall for your software to communicate with the outside world (e.g. your own datacenter or third party services), but customers will usually be reluctant to open their firewall more than necessary.<p>Vendors that try tricks like this to work around the firewall team, as backlogged and inefficient as they are, will lose deals and credibility, 100% guaranteed. And I love ssh -R and stunnel, for what it&#x27;s worth.<p>The easier way to get what you want is to get someone technical with political capital (they exist) to buy into what you&#x27;re selling so that they can tell the firewall team to make exceptions during a trial period.</div><br/></div></div><div id="41396996" class="c"><input type="checkbox" id="c-41396996" checked=""/><div class="controls bullet"><span class="by">taeric</span><span>|</span><a href="#41397180">prev</a><span>|</span><a href="#41397201">next</a><span>|</span><label class="collapse" for="c-41396996">[-]</label><label class="expand" for="c-41396996">[2 more]</label></div><br/><div class="children"><div class="content">This is basically a ridiculous arms race between the people making rules and people that feel they are an exception to the rule.  Can really suck when the reasoning on both ends is valid</div><br/><div id="41398637" class="c"><input type="checkbox" id="c-41398637" checked=""/><div class="controls bullet"><span class="by">scrapheap</span><span>|</span><a href="#41396996">parent</a><span>|</span><a href="#41397201">next</a><span>|</span><label class="collapse" for="c-41398637">[-]</label><label class="expand" for="c-41398637">[1 more]</label></div><br/><div class="children"><div class="content">The worst bit is where it&#x27;s happening because neither side wants to just sit down discuss what&#x27;s actually required and how to provide it securely.</div><br/></div></div></div></div><div id="41397201" class="c"><input type="checkbox" id="c-41397201" checked=""/><div class="controls bullet"><span class="by">evulhotdog</span><span>|</span><a href="#41396996">prev</a><span>|</span><a href="#41397112">next</a><span>|</span><label class="collapse" for="c-41397201">[-]</label><label class="expand" for="c-41397201">[1 more]</label></div><br/><div class="children"><div class="content">I’ve had these types of conversations hundreds of times due to some architecture of various systems that I’ve worked on over the years. Mostly from the vendor side.<p>The only real way to combat this is to do Deep Packet Inspection (DPI) and then to look at all the data that’s being passed within that encrypted connection. The problem with this, is that at this point, the vendor has to trust that the customer is doing their due diligence to protect anything that they find within that associated connection with the same diligence that the vendor would be.<p>As a vendor specifically in the healthcare space, I can tell you that there is no way in hell that I am going to trust any of our customers to secure our data, more than ourselves. They will never know or understand all of the components and know where the risks lie better than the vendor.<p>For example, in the infancy of one of the companies that I worked at, I agreed with one of our customers to allow certificate pinning, and we would install their certificate on our servers which would allow them to inspect the traffic. Wouldn’t you know it, there was an issue where they were blocking some of our traffic that needed to go outbound, because of their deep packet inspection triggered some rule that they had enabled. Conveniently while they were pilfering through the data to troubleshoot the issue, they sent a bunch of the payloads that contained various API keys, tokens, etc. which were now just out there in the wild, that under our watch would never see the light of day.<p>Who knows where else those things are logged or what other places besides the 30 or so recipients that were on that email thread. As soon as we found out that they were not handling it appropriately, we took corrective actions, not only to replace the keys, but also to disallow that going forward. And this for context, is one of the biggest healthcare institutions in the United States.<p>I can confidently say that I have a strong security mindset and anything that gets built has security at the forefront of every release. You can’t trust people who aren’t liable for your systems, with your data, or even to protect their own data.<p>Maybe I am jaded, but the lesson I learned is that you shouldn’t trust anybody, and that chances are other people will not treat sensitive information with the same sensitivity that you will.</div><br/></div></div><div id="41397112" class="c"><input type="checkbox" id="c-41397112" checked=""/><div class="controls bullet"><span class="by">pid-1</span><span>|</span><a href="#41397201">prev</a><span>|</span><a href="#41396617">next</a><span>|</span><label class="collapse" for="c-41397112">[-]</label><label class="expand" for="c-41397112">[1 more]</label></div><br/><div class="children"><div class="content">Most security controls used in your average business can be bypassed by knowledgeable users with enough time.<p>The aim is to make things as hard as reasonably possible so you can tell your boss and regulators that you did your part.</div><br/></div></div><div id="41396617" class="c"><input type="checkbox" id="c-41396617" checked=""/><div class="controls bullet"><span class="by">colemannugent</span><span>|</span><a href="#41397112">prev</a><span>|</span><label class="collapse" for="c-41396617">[-]</label><label class="expand" for="c-41396617">[14 more]</label></div><br/><div class="children"><div class="content">Which is why you need a modern firewall that MitMs both TLS and SSH. Not hard to do these days.</div><br/><div id="41396770" class="c"><input type="checkbox" id="c-41396770" checked=""/><div class="controls bullet"><span class="by">brian_cunnie</span><span>|</span><a href="#41396617">parent</a><span>|</span><a href="#41396653">next</a><span>|</span><label class="collapse" for="c-41396770">[-]</label><label class="expand" for="c-41396770">[10 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think a modern firewall can MiTM HTTPS TLS without triggering a &quot;Warning: Potential Security Risk Ahead&quot; (Firefox) or &quot;Your connection is not private&quot; (Chrome).<p>Edit: typo</div><br/><div id="41396852" class="c"><input type="checkbox" id="c-41396852" checked=""/><div class="controls bullet"><span class="by">alexjplant</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396770">parent</a><span>|</span><a href="#41397203">next</a><span>|</span><label class="collapse" for="c-41396852">[-]</label><label class="expand" for="c-41396852">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think _any_ firewall can MITM traffic without this happening unless you install the appropriate certificate in each client machine&#x27;s trust store. I bet that with the advent of such all-in-one solutions as Fortinet or Cisco VPNs that this would be handled automatically. If not I&#x27;m sure an endpoint management solution could be coaxed into doing this via some glue scripts. I haven&#x27;t been an &quot;IT guy&quot; in a decade-plus but I&#x27;d be surprised if this wasn&#x27;t within reach fairly easily these days.</div><br/><div id="41397034" class="c"><input type="checkbox" id="c-41397034" checked=""/><div class="controls bullet"><span class="by">zten</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396852">parent</a><span>|</span><a href="#41397082">prev</a><span>|</span><a href="#41397203">next</a><span>|</span><label class="collapse" for="c-41397034">[-]</label><label class="expand" for="c-41397034">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that&#x27;s what the IT at my company did. Installed Zscaler, rolled out a new root cert to Chrome, and then told people to configure the remaining apps they use to use the organization&#x27;s root cert.</div><br/></div></div></div></div><div id="41397203" class="c"><input type="checkbox" id="c-41397203" checked=""/><div class="controls bullet"><span class="by">nunez</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396770">parent</a><span>|</span><a href="#41396852">prev</a><span>|</span><a href="#41396841">next</a><span>|</span><label class="collapse" for="c-41397203">[-]</label><label class="expand" for="c-41397203">[1 more]</label></div><br/><div class="children"><div class="content">Which is why corporates who do this also use MDM to ensure that certs for the firewall&#x2F;reverse proxy are installed on endpoints, RADIUS at network access points to authenticate devices by certificates and endpoint protection software to send nasty-grams if you fuck around.</div><br/></div></div><div id="41396841" class="c"><input type="checkbox" id="c-41396841" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396770">parent</a><span>|</span><a href="#41397203">prev</a><span>|</span><a href="#41396849">next</a><span>|</span><label class="collapse" for="c-41396841">[-]</label><label class="expand" for="c-41396841">[3 more]</label></div><br/><div class="children"><div class="content">Pretty sure you still can, it just requires that the client system trusts the CA being used to sign the MITM certs. That obviously limits the cases where it works, but not to zero.</div><br/><div id="41397085" class="c"><input type="checkbox" id="c-41397085" checked=""/><div class="controls bullet"><span class="by">ronsor</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396841">parent</a><span>|</span><a href="#41396849">next</a><span>|</span><label class="collapse" for="c-41397085">[-]</label><label class="expand" for="c-41397085">[2 more]</label></div><br/><div class="children"><div class="content">Because this has been abused, a lot of (mobile) apps use certificate pinning and will not accept MITM, even with a custom CA installed.</div><br/><div id="41398121" class="c"><input type="checkbox" id="c-41398121" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41397085">parent</a><span>|</span><a href="#41396849">next</a><span>|</span><label class="collapse" for="c-41398121">[-]</label><label class="expand" for="c-41398121">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t for a moment believe that that&#x27;s the reason (more likely, it&#x27;s the apps trying to prevent reverse engineering), but yes, there&#x27;s a bit of a cat&#x2F;mouse game where you can read traffic but HTTPS prevents that but you can add a custom CA but apps can pin certs but you can modify the app to fix that. But I suspect that for the appliance case, a business can just require that the vendor allow a custom CA and block any traffic they can&#x27;t decrypt.</div><br/></div></div></div></div></div></div><div id="41396849" class="c"><input type="checkbox" id="c-41396849" checked=""/><div class="controls bullet"><span class="by">halfcat</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396770">parent</a><span>|</span><a href="#41396841">prev</a><span>|</span><a href="#41398171">next</a><span>|</span><label class="collapse" for="c-41396849">[-]</label><label class="expand" for="c-41396849">[1 more]</label></div><br/><div class="children"><div class="content">That’s been my experience. The difference being in a corporate environment they can push policies to all employee endpoints that make this happen with no scary warning (trust the internal CA, etc).</div><br/></div></div><div id="41398171" class="c"><input type="checkbox" id="c-41398171" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396770">parent</a><span>|</span><a href="#41396849">prev</a><span>|</span><a href="#41396653">next</a><span>|</span><label class="collapse" for="c-41398171">[-]</label><label class="expand" for="c-41398171">[1 more]</label></div><br/><div class="children"><div class="content">Correct. Companies that implement such a firewall must also install their own trust stores on the machines on the network. This can be a problem when you try to use some software that uses its own trust store from a public source like Mozilla (e.g. Python libraries).<p>It really makes you think how much your security hinges on that trust store yet it&#x27;s something most people aren&#x27;t even aware exists, let alone inspected themselves.</div><br/></div></div></div></div><div id="41396653" class="c"><input type="checkbox" id="c-41396653" checked=""/><div class="controls bullet"><span class="by">m463</span><span>|</span><a href="#41396617">parent</a><span>|</span><a href="#41396770">prev</a><span>|</span><a href="#41397129">next</a><span>|</span><label class="collapse" for="c-41396653">[-]</label><label class="expand" for="c-41396653">[2 more]</label></div><br/><div class="children"><div class="content">Do they always work?  Can&#x27;t they pin certs?</div><br/><div id="41396664" class="c"><input type="checkbox" id="c-41396664" checked=""/><div class="controls bullet"><span class="by">colemannugent</span><span>|</span><a href="#41396617">root</a><span>|</span><a href="#41396653">parent</a><span>|</span><a href="#41397129">next</a><span>|</span><label class="collapse" for="c-41396664">[-]</label><label class="expand" for="c-41396664">[1 more]</label></div><br/><div class="children"><div class="content">They can pin certs, but at least you know that you can&#x27;t see that traffic and make a policy decision about allowing it anyways or trying to force the vendor to drop it.</div><br/></div></div></div></div><div id="41397129" class="c"><input type="checkbox" id="c-41397129" checked=""/><div class="controls bullet"><span class="by">pid-1</span><span>|</span><a href="#41396617">parent</a><span>|</span><a href="#41396653">prev</a><span>|</span><label class="collapse" for="c-41397129">[-]</label><label class="expand" for="c-41397129">[1 more]</label></div><br/><div class="children"><div class="content">Just to be pendantic, a malicious user could write a script &#x2F; program that implements tunneling but doesn&#x27;t use the OS provided certificates.<p>But yeah that&#x27;s definitely a best practice.</div><br/></div></div></div></div></div></div></div></div></div></body></html>