<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1702976459616" as="style"/><link rel="stylesheet" href="styles.css?v=1702976459616"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://gokrazy.org/">Gokrazy – Go Appliances</a> <span class="domain">(<a href="https://gokrazy.org">gokrazy.org</a>)</span></div><div class="subtext"><span>lagniappe</span> | <span>23 comments</span></div><br/><div><div id="38693317" class="c"><input type="checkbox" id="c-38693317" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#38693041">next</a><span>|</span><label class="collapse" for="c-38693317">[-]</label><label class="expand" for="c-38693317">[2 more]</label></div><br/><div class="children"><div class="content">Go simply can&#x27;t really do well unless it has globs of memory or properly set kernel parameters (that affect the whole global machine). To get it to run reliably in low-memory conditions also requires careful tuning of GOGC + GOMEMLIMIT + MADV_DONTNEED. Go is geared more towards servers with tons of available memory, not IoT devices. Further, it&#x27;s networking stack does really well on low-latency connections (ie, a datacenter) and starts to do poorly if you throw a link with lots of data loss.<p>I love that they basically reimplemented libc to get more performance, but they also threw away decades of edge cases that it doesn&#x27;t (yet) handle very well. I&#x27;m confident they&#x27;ll get there, eventually, especially when people do things like this and report issues.</div><br/><div id="38693326" class="c"><input type="checkbox" id="c-38693326" checked=""/><div class="controls bullet"><span class="by">denysvitali</span><span>|</span><a href="#38693317">parent</a><span>|</span><a href="#38693041">next</a><span>|</span><label class="collapse" for="c-38693326">[-]</label><label class="expand" for="c-38693326">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why you have TinyGo: <a href="https:&#x2F;&#x2F;tinygo.org&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;tinygo.org&#x2F;</a></div><br/></div></div></div></div><div id="38693041" class="c"><input type="checkbox" id="c-38693041" checked=""/><div class="controls bullet"><span class="by">cedws</span><span>|</span><a href="#38693317">prev</a><span>|</span><a href="#38692933">next</a><span>|</span><label class="collapse" for="c-38693041">[-]</label><label class="expand" for="c-38693041">[4 more]</label></div><br/><div class="children"><div class="content">I am very fond of the idea of a from-scratch userspace written entirely in Go. I&#x27;ve been dreaming of building something like gokrazy for servers. Or possibly something like Bottlerocket OS in Go.<p>I experimented a few weeks ago with packaging a custom kernel and minimal Go init binary into a disk image bootable on GCE. No bootloader needed, just EFI loading the kernel directly.</div><br/><div id="38693148" class="c"><input type="checkbox" id="c-38693148" checked=""/><div class="controls bullet"><span class="by">marcus_holmes</span><span>|</span><a href="#38693041">parent</a><span>|</span><a href="#38693099">next</a><span>|</span><label class="collapse" for="c-38693148">[-]</label><label class="expand" for="c-38693148">[1 more]</label></div><br/><div class="children"><div class="content">Same - I&#x27;ve been playing around with Unikernels for the same reason. Running my web server as the only process on the machine really appeals. Attack surface is tiny, basically non-existent. If the web server falls over, reboot the machine (which should be fast because it only has to load the kernel &amp; the Go program).<p>It&#x27;s basically the opposite of containers, which I like hehe.</div><br/></div></div><div id="38693099" class="c"><input type="checkbox" id="c-38693099" checked=""/><div class="controls bullet"><span class="by">hyperthesis</span><span>|</span><a href="#38693041">parent</a><span>|</span><a href="#38693148">prev</a><span>|</span><a href="#38692933">next</a><span>|</span><label class="collapse" for="c-38693099">[-]</label><label class="expand" for="c-38693099">[2 more]</label></div><br/><div class="children"><div class="content">To some extent, android is this with java.<p>For a low-powered device, would a Go usespace bring particular benefits? (Though, even the cheapest phones today aren&#x27;t really &quot;low-powered&quot; anymore)</div><br/><div id="38693154" class="c"><input type="checkbox" id="c-38693154" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38693041">root</a><span>|</span><a href="#38693099">parent</a><span>|</span><a href="#38692933">next</a><span>|</span><label class="collapse" for="c-38693154">[-]</label><label class="expand" for="c-38693154">[1 more]</label></div><br/><div class="children"><div class="content">Go has memory safety (via GC rather than fancy ownership, but if it works it works); that&#x27;s an asset anywhere that can afford the overhead.<p>Edit: In order to preempt the argument others are having: Safer than C, anyways, while being <i>much</i> easier than rust.</div><br/></div></div></div></div></div></div><div id="38692933" class="c"><input type="checkbox" id="c-38692933" checked=""/><div class="controls bullet"><span class="by">lyxell</span><span>|</span><a href="#38693041">prev</a><span>|</span><a href="#38693229">next</a><span>|</span><label class="collapse" for="c-38692933">[-]</label><label class="expand" for="c-38692933">[1 more]</label></div><br/><div class="children"><div class="content">The showcase of projects is (a bit unintuitively) listed under Available packages and is helpful if you want to get a picture of what you can build on top of gokrazy: <a href="https:&#x2F;&#x2F;gokrazy.org&#x2F;packages&#x2F;showcase&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;gokrazy.org&#x2F;packages&#x2F;showcase&#x2F;</a></div><br/></div></div><div id="38693229" class="c"><input type="checkbox" id="c-38693229" checked=""/><div class="controls bullet"><span class="by">espe</span><span>|</span><a href="#38692933">prev</a><span>|</span><a href="#38692914">next</a><span>|</span><label class="collapse" for="c-38693229">[-]</label><label class="expand" for="c-38693229">[1 more]</label></div><br/><div class="children"><div class="content">this looks really cool. might be perfect for an old odroid. hope that doesn&#x27;t stray too far from the happy paths.</div><br/></div></div><div id="38692914" class="c"><input type="checkbox" id="c-38692914" checked=""/><div class="controls bullet"><span class="by">denysvitali</span><span>|</span><a href="#38693229">prev</a><span>|</span><a href="#38692850">next</a><span>|</span><label class="collapse" for="c-38692914">[-]</label><label class="expand" for="c-38692914">[1 more]</label></div><br/><div class="children"><div class="content">Presentation by Michael: <a href="https:&#x2F;&#x2F;youtu.be&#x2F;mv_THRgLRHY" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;mv_THRgLRHY</a></div><br/></div></div><div id="38692850" class="c"><input type="checkbox" id="c-38692850" checked=""/><div class="controls bullet"><span class="by">triyambakam</span><span>|</span><a href="#38692914">prev</a><span>|</span><label class="collapse" for="c-38692850">[-]</label><label class="expand" for="c-38692850">[13 more]</label></div><br/><div class="children"><div class="content">&gt; Go, a memory safe programming language<p>Hard disagree</div><br/><div id="38692867" class="c"><input type="checkbox" id="c-38692867" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#38692850">parent</a><span>|</span><label class="collapse" for="c-38692867">[-]</label><label class="expand" for="c-38692867">[12 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a defragmenting stack, garbage collected programming language, and even mentioned as a memory-safe programming language in NSA&#x27;s &quot;Memory Safe Programming Languages Recommendations&quot;.<p>Why disagree? That&#x27;s true.</div><br/><div id="38693129" class="c"><input type="checkbox" id="c-38693129" checked=""/><div class="controls bullet"><span class="by">throwaway858</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38692867">parent</a><span>|</span><a href="#38692924">next</a><span>|</span><label class="collapse" for="c-38693129">[-]</label><label class="expand" for="c-38693129">[1 more]</label></div><br/><div class="children"><div class="content">The current implementation is not memory safe. Go uses 128 bit structs for interfaces and slices and assumes that they are updated atomically (when they are not).<p>It&#x27;s possible to exploit this to read&#x2F;write arbitrary memory and to execute arbitrary code. It appears that in practice this is very difficult so the issue is ignored.<p><a href="https:&#x2F;&#x2F;blog.stalkr.net&#x2F;2015&#x2F;04&#x2F;golang-data-races-to-break-memory-safety.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.stalkr.net&#x2F;2015&#x2F;04&#x2F;golang-data-races-to-break-m...</a></div><br/></div></div><div id="38692924" class="c"><input type="checkbox" id="c-38692924" checked=""/><div class="controls bullet"><span class="by">PurelyApplied</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38692867">parent</a><span>|</span><a href="#38693129">prev</a><span>|</span><label class="collapse" for="c-38692924">[-]</label><label class="expand" for="c-38692924">[10 more]</label></div><br/><div class="children"><div class="content">Not the glib root-commenter, but the two big caveats is that Go is memory-safe provided you import neither `unsafe` nor `c`.<p>That can end up being a pretty restrictive constraint, if it&#x27;s not something your dependencies cared about. If it is a concern of yours, it&#x27;s pretty easy to check for at build time.</div><br/><div id="38692986" class="c"><input type="checkbox" id="c-38692986" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38692924">parent</a><span>|</span><a href="#38692970">next</a><span>|</span><label class="collapse" for="c-38692986">[-]</label><label class="expand" for="c-38692986">[1 more]</label></div><br/><div class="children"><div class="content">Well, unsafe says it all. It&#x27;s &quot;unsafe&quot;. On the other hand, I never had to import &quot;C&quot; in any of my projects, yet.<p>However, if I&#x27;m going to wander into CGo realm, I can always pivot to C++, if speed or things implemented in C is <i>that</i> important for me.<p>No programming language, incl. a particular one which has an orange mascot, is perfect. I also find trying to solve social problems with technology (i.e. let&#x27;s make programming languages foolproof to enable lazier-er programmers), pointless, to put it mildly.<p>Honestly, in my eyes Go is a very nice, little language, and I like how it handles.</div><br/></div></div><div id="38692970" class="c"><input type="checkbox" id="c-38692970" checked=""/><div class="controls bullet"><span class="by">randomdata</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38692924">parent</a><span>|</span><a href="#38692986">prev</a><span>|</span><a href="#38693019">next</a><span>|</span><label class="collapse" for="c-38692970">[-]</label><label class="expand" for="c-38692970">[1 more]</label></div><br/><div class="children"><div class="content">Importing `C` declares that you intend to use Cgo instead of Go. Cgo is not Go[1].<p>[1] <a href="https:&#x2F;&#x2F;go-proverbs.github.io" rel="nofollow noreferrer">https:&#x2F;&#x2F;go-proverbs.github.io</a></div><br/></div></div><div id="38693019" class="c"><input type="checkbox" id="c-38693019" checked=""/><div class="controls bullet"><span class="by">morelisp</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38692924">parent</a><span>|</span><a href="#38692970">prev</a><span>|</span><label class="collapse" for="c-38693019">[-]</label><label class="expand" for="c-38693019">[7 more]</label></div><br/><div class="children"><div class="content">What language is memory-safe even if you use unsafe and&#x2F;or arbitrary C linkage?<p>(I rather suspect triyambakam was referring to undefined behavior on data races.)</div><br/><div id="38693144" class="c"><input type="checkbox" id="c-38693144" checked=""/><div class="controls bullet"><span class="by">pa7ch</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693019">parent</a><span>|</span><a href="#38693055">next</a><span>|</span><label class="collapse" for="c-38693144">[-]</label><label class="expand" for="c-38693144">[2 more]</label></div><br/><div class="children"><div class="content">Data races can lead to logic bugs that are potentially security sensitive, but memory safety generally refers to getting rid of all control flow hijacking security vulnerabilities which, in many large C&#x2F;C++ projects, seem to be never-ending. Avoiding data races is more in the category of preventing bugs&#x2F;crashes while memory safety is about avoiding an entire class of security vulnerabilities.</div><br/><div id="38693249" class="c"><input type="checkbox" id="c-38693249" checked=""/><div class="controls bullet"><span class="by">morelisp</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693144">parent</a><span>|</span><a href="#38693055">next</a><span>|</span><label class="collapse" for="c-38693249">[-]</label><label class="expand" for="c-38693249">[1 more]</label></div><br/><div class="children"><div class="content">If I can use a data race to corrupt a jump target, I&#x27;ve done most of the work I need to for any classic memory-safety security vuln.<p>Go makes this <i>much</i> harder to do than C&#x2F;C++, especially as it relates to e.g. mishandling user input, but not impossible, even without CGo or unsafe.</div><br/></div></div></div></div><div id="38693055" class="c"><input type="checkbox" id="c-38693055" checked=""/><div class="controls bullet"><span class="by">slimsag</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693019">parent</a><span>|</span><a href="#38693144">prev</a><span>|</span><a href="#38693059">next</a><span>|</span><label class="collapse" for="c-38693055">[-]</label><label class="expand" for="c-38693055">[2 more]</label></div><br/><div class="children"><div class="content">Formally verified C code, or WASM[0]<p>[0] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38613031">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38613031</a></div><br/><div id="38693123" class="c"><input type="checkbox" id="c-38693123" checked=""/><div class="controls bullet"><span class="by">morelisp</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693055">parent</a><span>|</span><a href="#38693059">next</a><span>|</span><label class="collapse" for="c-38693123">[-]</label><label class="expand" for="c-38693123">[1 more]</label></div><br/><div class="children"><div class="content">WASM is a funny case and I don&#x27;t agree that it&#x27;s safe.<p>When people say WASM is &quot;safe&quot; in this sense what they mean is that it won&#x27;t corrupt your browser process (or other wasm runtime). That&#x27;s a useful guarantee! But that&#x27;s sandboxing, not memory-safety as a language property. You can sandbox C too, that doesn&#x27;t make C a memory-safe language.<p>As far as I know you can still trigger unsafe access to the WASM heap, and therefore many kinds of of attacks still work. They don&#x27;t &quot;break out&quot; but also, lots of valuable data or controllable user behavior is in-heap anyway.</div><br/></div></div></div></div><div id="38693059" class="c"><input type="checkbox" id="c-38693059" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693019">parent</a><span>|</span><a href="#38693055">prev</a><span>|</span><label class="collapse" for="c-38693059">[-]</label><label class="expand" for="c-38693059">[2 more]</label></div><br/><div class="children"><div class="content">IIRC, Go has support for atomics, which are handled at the processor directly and effectively eliminates data races.<p>So, I don&#x27;t see a problem here.</div><br/><div id="38693104" class="c"><input type="checkbox" id="c-38693104" checked=""/><div class="controls bullet"><span class="by">morelisp</span><span>|</span><a href="#38692850">root</a><span>|</span><a href="#38693059">parent</a><span>|</span><label class="collapse" for="c-38693104">[-]</label><label class="expand" for="c-38693104">[1 more]</label></div><br/><div class="children"><div class="content">Having tools to avoid data races don&#x27;t make it a memory-safe language, unless you strip that phrase of all meaning.<p>The more interesting question is, would it be worth it to be memory-safe? Rust says yes, and puts a lot of work into statically preventing data races at the cost of (at least) some language ergonomics. Java also says yes, but put a lot of work into making data race impacts well-defined, and on this tends to incur cost (runtime and language development time) with unclear benefits towards actually reasoning about the programs with such races.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>