<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1683277251026" as="style"/><link rel="stylesheet" href="styles.css?v=1683277251026"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://deno.com/blog/roll-your-own-javascript-runtime-pt3">Roll your own JavaScript runtime, pt. 3</a> <span class="domain">(<a href="https://deno.com">deno.com</a>)</span></div><div class="subtext"><span>danielskogly</span> | <span>43 comments</span></div><br/><div><div id="35823370" class="c"><input type="checkbox" id="c-35823370" checked=""/><div class="controls bullet"><span class="by">tbillington</span><span>|</span><a href="#35820964">next</a><span>|</span><label class="collapse" for="c-35823370">[-]</label><label class="expand" for="c-35823370">[1 more]</label></div><br/><div class="children"><div class="content">I made a demo integrating deno and sqlite into a quasi-&quot;lambda&quot; runtime in 200 lines for a rust meetup talk, if anyone is interested <a href="https:&#x2F;&#x2F;github.com&#x2F;tbillington&#x2F;rust_serverless_runtime">https:&#x2F;&#x2F;github.com&#x2F;tbillington&#x2F;rust_serverless_runtime</a>.</div><br/></div></div><div id="35820964" class="c"><input type="checkbox" id="c-35820964" checked=""/><div class="controls bullet"><span class="by">olliej</span><span>|</span><a href="#35823370">prev</a><span>|</span><a href="#35821694">next</a><span>|</span><label class="collapse" for="c-35820964">[-]</label><label class="expand" for="c-35820964">[17 more]</label></div><br/><div class="children"><div class="content">This is not any kind of &quot;rolling your own JS runtime&quot;. This is &quot;use our framework to use v8 from rust&quot;. What an obnoxious title.<p>v8 is a JS runtime. JSC is a JS runtime. SpiderMonkey is a JS runtime.<p>All of these are embeddable and have usable APIs. If all you are doing, is linking to a JS runtime, and then using it, you aren&#x27;t &quot;rolling your own runtime&quot;.<p>If you want to roll your own JS runtime go look at how the LibJS folk in serenity did it - they did it without corporate backing and despite that I believe LibJS is fairly complete even with the new draft language features, albeit lacking a decade or so of performance optimizations.</div><br/><div id="35821086" class="c"><input type="checkbox" id="c-35821086" checked=""/><div class="controls bullet"><span class="by">jchw</span><span>|</span><a href="#35820964">parent</a><span>|</span><a href="#35823169">next</a><span>|</span><label class="collapse" for="c-35821086">[-]</label><label class="expand" for="c-35821086">[2 more]</label></div><br/><div class="children"><div class="content">Yeah unfortunately as pessimistic as it seems I must agree, this title is disappointing to me. I&#x27;d love to see a series discussing the ins and outs of even just tiny segments of implementing ECMA262, as there&#x27;s quite a lot of interesting nuance that has come up over the years.<p>I guess the difference is runtime vs perhaps interpreter, but it&#x27;s definitely ambiguous.</div><br/><div id="35823889" class="c"><input type="checkbox" id="c-35823889" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35821086">parent</a><span>|</span><a href="#35823169">next</a><span>|</span><label class="collapse" for="c-35823889">[-]</label><label class="expand" for="c-35823889">[1 more]</label></div><br/><div class="children"><div class="content">You might find this interesting: <a href="https:&#x2F;&#x2F;github.com&#x2F;svaarala&#x2F;duktape&#x2F;blob&#x2F;master&#x2F;doc&#x2F;compiler.rst">https:&#x2F;&#x2F;github.com&#x2F;svaarala&#x2F;duktape&#x2F;blob&#x2F;master&#x2F;doc&#x2F;compiler...</a></div><br/></div></div></div></div><div id="35823169" class="c"><input type="checkbox" id="c-35823169" checked=""/><div class="controls bullet"><span class="by">lucacasonato</span><span>|</span><a href="#35820964">parent</a><span>|</span><a href="#35821086">prev</a><span>|</span><a href="#35821815">next</a><span>|</span><label class="collapse" for="c-35823169">[-]</label><label class="expand" for="c-35823169">[9 more]</label></div><br/><div class="children"><div class="content">JS runtime != JS engine<p>Runtime:
- Chrome
- Deno
- Node
- Bun<p>Engine:
- V8
- JSC
- SpiderMonkey
- LibJS</div><br/><div id="35823487" class="c"><input type="checkbox" id="c-35823487" checked=""/><div class="controls bullet"><span class="by">cobbal</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823169">parent</a><span>|</span><a href="#35823284">next</a><span>|</span><label class="collapse" for="c-35823487">[-]</label><label class="expand" for="c-35823487">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a weird usage of the word &quot;runtime&quot; then. To me, the definition is closer to Wikipedia&#x27;s definition of &quot;runtime system&quot; [0] and includes any interpreters, JITs, and any other language elements present while a program is running.<p><pre><code>  [0]: https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Runtime_system</code></pre></div><br/><div id="35824352" class="c"><input type="checkbox" id="c-35824352" checked=""/><div class="controls bullet"><span class="by">omneity</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823487">parent</a><span>|</span><a href="#35824098">next</a><span>|</span><label class="collapse" for="c-35824352">[-]</label><label class="expand" for="c-35824352">[1 more]</label></div><br/><div class="children"><div class="content">The runtime includes the engine (interpreter for example) and an environment, which could also include a standard library, bindings to the outside world and more.<p>For example, in the case of node, it&#x27;s a runtime built around the v8 engine, using libuv for bindings.</div><br/></div></div><div id="35824098" class="c"><input type="checkbox" id="c-35824098" checked=""/><div class="controls bullet"><span class="by">akiselev</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823487">parent</a><span>|</span><a href="#35824352">prev</a><span>|</span><a href="#35823284">next</a><span>|</span><label class="collapse" for="c-35824098">[-]</label><label class="expand" for="c-35824098">[2 more]</label></div><br/><div class="children"><div class="content">It’s Javascript. Everything is weird - from the equality coercion to the package management to left padding text.</div><br/><div id="35826574" class="c"><input type="checkbox" id="c-35826574" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35824098">parent</a><span>|</span><a href="#35823284">next</a><span>|</span><label class="collapse" for="c-35826574">[-]</label><label class="expand" for="c-35826574">[1 more]</label></div><br/><div class="children"><div class="content">Left pad is built into the language now the community has shown we can’t be trusted with anything else.<p><a href="https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;JavaScript&#x2F;Reference&#x2F;Global_Objects&#x2F;String&#x2F;padStart" rel="nofollow">https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;JavaScript&#x2F;Refe...</a></div><br/></div></div></div></div></div></div><div id="35823284" class="c"><input type="checkbox" id="c-35823284" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823169">parent</a><span>|</span><a href="#35823487">prev</a><span>|</span><a href="#35823340">next</a><span>|</span><label class="collapse" for="c-35823284">[-]</label><label class="expand" for="c-35823284">[2 more]</label></div><br/><div class="children"><div class="content">Specifically, a runtime (IMO) is the set of variables and their associated functionality that exist in the global scope, or are expected to be importable in a predictable and standardized way.<p>Part 2 of this series, for instance, shows the instantiator of the V8 engine (via deno_core, a runtime-less wrapper as explained in Part 1) implementing a simplified fetch API with some trivial JS and the bulk of the logic in Rust: <a href="https:&#x2F;&#x2F;deno.com&#x2F;blog&#x2F;roll-your-own-javascript-runtime-pt2#implementing-fetch" rel="nofollow">https:&#x2F;&#x2F;deno.com&#x2F;blog&#x2F;roll-your-own-javascript-runtime-pt2#i...</a> - this would then be available to any code executing in their custom JS environment.<p>This is useful even outside of creating a full Node-style implementation; for instance, Cloudflare created a locked-down runtime (a reasonable subset of the browser runtime) for v8 isolates for their workers: <a href="https:&#x2F;&#x2F;developers.cloudflare.com&#x2F;workers&#x2F;runtime-apis&#x2F;" rel="nofollow">https:&#x2F;&#x2F;developers.cloudflare.com&#x2F;workers&#x2F;runtime-apis&#x2F;</a><p>It&#x27;s super cool to know this stuff as it lets you consider (when appropriate!) using JS as a way to accept Turing-complete user-submitted logic rather than just accepting, say, JSON configs, while limiting the surface with which it can interact with your system.</div><br/><div id="35824327" class="c"><input type="checkbox" id="c-35824327" checked=""/><div class="controls bullet"><span class="by">olliej</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823284">parent</a><span>|</span><a href="#35823340">next</a><span>|</span><label class="collapse" for="c-35824327">[-]</label><label class="expand" for="c-35824327">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Specifically, a runtime (IMO) is the set of variables and their associated functionality that exist in the global scope, or are expected to be importable in a predictable and standardized way.<p>All of which is provided by V8 in this example. The global object, math object, &quot;Object&quot; in general, Arrays, etc are all the runtime. All this tutorial series on embedding V8 is doing is instantiating an existing runtime environment and adding using the APIs to insert a few new APIs.<p>All together you might say you&#x27;ve got a custom runtime as you have the baseline &quot;JS runtime&quot; + some new APIs and that&#x27;s clearly a new runtime environment that is distinct from the JS environment on a web page, vs. the one in a worker, vs. in node, etc. But that is at best &quot;extending a runtime&quot;, not &quot;rolling your own&quot;.<p>Using the embedding APIs provided by a JS runtime as documented and intended, is not &quot;rolling your own&quot;. By that definition I could make an app, embed a WebView, and claim I rolled my own browser runtime, which I would hope is more clearly absurd. Or I could &quot;roll my own Command-line&quot; by reading a string from a user, prepending some commands, and then passing it to system().</div><br/></div></div></div></div><div id="35823340" class="c"><input type="checkbox" id="c-35823340" checked=""/><div class="controls bullet"><span class="by">trackflak</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823169">parent</a><span>|</span><a href="#35823284">prev</a><span>|</span><a href="#35824298">next</a><span>|</span><label class="collapse" for="c-35823340">[-]</label><label class="expand" for="c-35823340">[1 more]</label></div><br/><div class="children"><div class="content">Not to forget the engine Charka: <a href="https:&#x2F;&#x2F;github.com&#x2F;chakra-core&#x2F;ChakraCore">https:&#x2F;&#x2F;github.com&#x2F;chakra-core&#x2F;ChakraCore</a><p>The only bit of the old Edge that had its source emancipated. It was&#x2F;is? quite performant.</div><br/></div></div><div id="35824298" class="c"><input type="checkbox" id="c-35824298" checked=""/><div class="controls bullet"><span class="by">olliej</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35823169">parent</a><span>|</span><a href="#35823340">prev</a><span>|</span><a href="#35821815">next</a><span>|</span><label class="collapse" for="c-35824298">[-]</label><label class="expand" for="c-35824298">[1 more]</label></div><br/><div class="children"><div class="content">No.<p>The runtime is the combination of the execution engine, the garbage collector, and the environment.<p>V8, JSC, SpiderMonkey, LibJS, etc all provide all of those.<p>They all have APIs that let you (the embedder) a few new objects and functions, as it would be a useless embedding API otherwise. But that&#x27;s all you&#x27;re doing: adding some glorified callbacks to an existing runtime. You are in no way &quot;rolling your own JS runtime&quot;.<p>To break it down:<p>Execution Engine: the part of the runtime that evaluates JS, an interpreter, jit, or some combination. That would be &quot;Ignition&quot; and &quot;TurboFan&quot; in V8, &quot;LLInt&quot; and &quot;FTL&quot; in JSC, &quot;WarpMonkey&quot; in SpiderMonkey.<p>Garbage Collector: the part of the runtime that supports object allocation and reclamation. &quot;Orinoco&quot; in V8, but not sure if given a separate marketing name in other runtimes.<p>The environment: this is all the builtin objects and functionality, things like the global object, the regex engine (note it&#x27;s not a regex runtime because all it does find the start and stop sections of matches, the embedding environment is responsible for everything else), all those core things like the Object, Array, Math, Number, etc types, and all of their implementations and runtime functions. The Execution engine does not need any of those to be implemented, as to the engine there is essentially no distinction between those builtin things and anything else written in JS.<p>When you embed V8, JSC, LibJS, etc you are getting a full runtime, that can do a huge amount. You _might_ choose to use there APIs to add some new objects or or functions, but what you are doing is negligible, and certainly not &quot;a runtime&quot;.</div><br/></div></div></div></div><div id="35821815" class="c"><input type="checkbox" id="c-35821815" checked=""/><div class="controls bullet"><span class="by">intelVISA</span><span>|</span><a href="#35820964">parent</a><span>|</span><a href="#35823169">prev</a><span>|</span><a href="#35821925">next</a><span>|</span><label class="collapse" for="c-35821815">[-]</label><label class="expand" for="c-35821815">[1 more]</label></div><br/><div class="children"><div class="content">I expected some interesting content and left with a &quot;import v8: Cargo edition&quot; &#x27;tutorial&#x27; is this really a good look for the ailing Deno?</div><br/></div></div><div id="35821925" class="c"><input type="checkbox" id="c-35821925" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#35820964">parent</a><span>|</span><a href="#35821815">prev</a><span>|</span><a href="#35821090">next</a><span>|</span><label class="collapse" for="c-35821925">[-]</label><label class="expand" for="c-35821925">[1 more]</label></div><br/><div class="children"><div class="content">Yes, this is more like &quot;Roll your own JavaScript environment&quot;</div><br/></div></div><div id="35824652" class="c"><input type="checkbox" id="c-35824652" checked=""/><div class="controls bullet"><span class="by">pier25</span><span>|</span><a href="#35820964">parent</a><span>|</span><a href="#35821090">prev</a><span>|</span><a href="#35821694">next</a><span>|</span><label class="collapse" for="c-35824652">[-]</label><label class="expand" for="c-35824652">[2 more]</label></div><br/><div class="children"><div class="content">So Node is not a JS runtime?</div><br/><div id="35826747" class="c"><input type="checkbox" id="c-35826747" checked=""/><div class="controls bullet"><span class="by">quikoa</span><span>|</span><a href="#35820964">root</a><span>|</span><a href="#35824652">parent</a><span>|</span><a href="#35821694">next</a><span>|</span><label class="collapse" for="c-35826747">[-]</label><label class="expand" for="c-35826747">[1 more]</label></div><br/><div class="children"><div class="content">It is but the Node developers developers didn&#x27;t roll their own JavaScript runtime.</div><br/></div></div></div></div></div></div><div id="35821694" class="c"><input type="checkbox" id="c-35821694" checked=""/><div class="controls bullet"><span class="by">obpe</span><span>|</span><a href="#35820964">prev</a><span>|</span><a href="#35820703">next</a><span>|</span><label class="collapse" for="c-35821694">[-]</label><label class="expand" for="c-35821694">[16 more]</label></div><br/><div class="children"><div class="content">JS has improved a lot over the years but I am not sure I would want it as the default scripting language for applications. JS is really only useful because it&#x27;s the language you access the browser&#x27;s API with. If you are creating a different kind of application and therefore don&#x27;t need the DOM or other browser things then why JS at all? Having worked with Lua for some game mods, it seems like a better choice for an integrated language. Maybe a Rust inspired language would make a better fit for a modern DSL... insert XKCD comic about standards proliferation.</div><br/><div id="35821996" class="c"><input type="checkbox" id="c-35821996" checked=""/><div class="controls bullet"><span class="by">slmjkdbtl</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35822161">next</a><span>|</span><label class="collapse" for="c-35821996">[-]</label><label class="expand" for="c-35821996">[5 more]</label></div><br/><div class="children"><div class="content">I love Lua but tbh I accept JS as the default scripting language, simply because it&#x27;s ubiquitous, most runtimes are faster than or on par with Lua, and not harder to embed than Lua with stuff like quickjs. Also I don&#x27;t think from language design perspective there&#x27;s fundamental difference beyond syntax, metatable is pretty similar to prototype chain, JS has much more stuff you can argue it&#x27;s bloated compare to Lua but you don&#x27;t really pay for what you don&#x27;t use.</div><br/><div id="35823747" class="c"><input type="checkbox" id="c-35823747" checked=""/><div class="controls bullet"><span class="by">rektide</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35821996">parent</a><span>|</span><a href="#35822161">next</a><span>|</span><label class="collapse" for="c-35823747">[-]</label><label class="expand" for="c-35823747">[4 more]</label></div><br/><div class="children"><div class="content">Does Lua have the ability to launch very low cost sandboxed instances?<p>With Deno I know I can quickly spawn lots of isolated instances at very low overhead.<p>If I really want to push it far, there&#x27;s tools for loading frozen snapshots that have lots of code loaded.<p>I&#x27;ve never seen similar from Lua &amp; I&#x27;m not sure it exists. Seems like a huge advantage.</div><br/><div id="35826791" class="c"><input type="checkbox" id="c-35826791" checked=""/><div class="controls bullet"><span class="by">lenkite</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35823747">parent</a><span>|</span><a href="#35823807">next</a><span>|</span><label class="collapse" for="c-35826791">[-]</label><label class="expand" for="c-35826791">[1 more]</label></div><br/><div class="children"><div class="content">&gt;With Deno I know I can quickly spawn lots of isolated instances at very low overhead.<p>Err..new to Deno - how does one do this ?</div><br/></div></div><div id="35823807" class="c"><input type="checkbox" id="c-35823807" checked=""/><div class="controls bullet"><span class="by">slmjkdbtl</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35823747">parent</a><span>|</span><a href="#35826791">prev</a><span>|</span><a href="#35822161">next</a><span>|</span><label class="collapse" for="c-35823807">[-]</label><label class="expand" for="c-35823807">[2 more]</label></div><br/><div class="children"><div class="content">Creating a new lua context is pretty cheap, but I don&#x27;t know how it compares to Deno &#x2F; v8. It should be much lighter weight, but not sure if Deno &#x2F; v8 does some special thing to speed up the use case you talked about.</div><br/><div id="35824248" class="c"><input type="checkbox" id="c-35824248" checked=""/><div class="controls bullet"><span class="by">rektide</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35823807">parent</a><span>|</span><a href="#35822161">next</a><span>|</span><label class="collapse" for="c-35824248">[-]</label><label class="expand" for="c-35824248">[1 more]</label></div><br/><div class="children"><div class="content">The submission itself talks about creating &amp; loading snapshots, which is sort of a Checkpoint Restore In Userspace (CRIU), allowing one to create a new context with a lot of existing libraries already loaded very very quickly.</div><br/></div></div></div></div></div></div></div></div><div id="35822161" class="c"><input type="checkbox" id="c-35822161" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35821996">prev</a><span>|</span><a href="#35821887">next</a><span>|</span><label class="collapse" for="c-35822161">[-]</label><label class="expand" for="c-35822161">[1 more]</label></div><br/><div class="children"><div class="content">I think you might be underestimating browser compatibility.<p>There are a lot of browser API&#x27;s. They&#x27;re portable, designed with security in mind (at least somewhat), usually well documented, reasonably easy to understand, and people already know them. So, even if it&#x27;s not a browser, you may prefer JavaScript so you don&#x27;t reinvent the relevant API&#x27;s and there&#x27;s less to learn.<p>Deno itself is a good example of this.</div><br/></div></div><div id="35821887" class="c"><input type="checkbox" id="c-35821887" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35822161">prev</a><span>|</span><a href="#35823888">next</a><span>|</span><label class="collapse" for="c-35821887">[-]</label><label class="expand" for="c-35821887">[5 more]</label></div><br/><div class="children"><div class="content">Because Worse is Better [1]<p>Lua is technically superior, but JavaScript is practically superior due to its ubiquitous platform the web browser.<p>Similar but different to C &quot;beating&quot; Lisp.<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Worse_is_better" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Worse_is_better</a></div><br/><div id="35823025" class="c"><input type="checkbox" id="c-35823025" checked=""/><div class="controls bullet"><span class="by">tmountain</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35821887">parent</a><span>|</span><a href="#35826802">next</a><span>|</span><label class="collapse" for="c-35823025">[-]</label><label class="expand" for="c-35823025">[3 more]</label></div><br/><div class="children"><div class="content">I strongly disagree. Lua somehow maintains a positive reputation, but it’s extremely quirky and weird in many ways. It has some Perl-esque rough edges (#array for length), and some “let’s be different” design decisions that are counterintuitive and unnecessary (arrays starting at the 1 index instead of 0).<p>JavaScript as it is today is a vastly more ergonomic and fluid experience, and I am saying this as someone that has written tons of both.<p>The embedding experience with Lua is likely much more form fit than JavaScript (sandboxing, etc). I’m strictly speaking about syntax and language features.</div><br/><div id="35823478" class="c"><input type="checkbox" id="c-35823478" checked=""/><div class="controls bullet"><span class="by">suavesito</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35823025">parent</a><span>|</span><a href="#35826802">next</a><span>|</span><label class="collapse" for="c-35823478">[-]</label><label class="expand" for="c-35823478">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t want to start a 0-index war, but there is a great argument I read once and wave to share. Indexing can be tough as two different things, selecting or offsetting. When selecting you start from the first (1) option. When offsetting you move zero (0) from the first option.<p>0-index arrays express offsets, 1-index arrays express index selection. In C (and family) arrays start at zero because they offset, `a[i]` literally means `* (a+i)` (you actually can write `i[a]`, it will work and be <i>valid</i>). For other language selecting 1 base indexing is not a weird option, I&#x27;d argue.</div><br/><div id="35823738" class="c"><input type="checkbox" id="c-35823738" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35823478">parent</a><span>|</span><a href="#35826802">next</a><span>|</span><label class="collapse" for="c-35823738">[-]</label><label class="expand" for="c-35823738">[1 more]</label></div><br/><div class="children"><div class="content">If you ever need an ally for 1-indexed, you can point people to PostgreSQL.</div><br/></div></div></div></div></div></div><div id="35826802" class="c"><input type="checkbox" id="c-35826802" checked=""/><div class="controls bullet"><span class="by">lenkite</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35821887">parent</a><span>|</span><a href="#35823025">prev</a><span>|</span><a href="#35823888">next</a><span>|</span><label class="collapse" for="c-35826802">[-]</label><label class="expand" for="c-35826802">[1 more]</label></div><br/><div class="children"><div class="content">JS is also ergonomically superior compared to Lua.</div><br/></div></div></div></div><div id="35823888" class="c"><input type="checkbox" id="c-35823888" checked=""/><div class="controls bullet"><span class="by">eropple</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35821887">prev</a><span>|</span><a href="#35822252">next</a><span>|</span><label class="collapse" for="c-35823888">[-]</label><label class="expand" for="c-35823888">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt; If you are creating a different kind of application and therefore don&#x27;t need the DOM or other browser things then why JS at all?</i><p>Because I like TypeScript and don&#x27;t like Lua.<p>JavaScript, I don&#x27;t like. It&#x27;s in the same bucket to me as Python, Ruby, and Lua - things I might have to use sometimes but I&#x27;m holding my nose. But TypeScript? I <i>like</i> TypeScript and want to use it more.</div><br/></div></div><div id="35822252" class="c"><input type="checkbox" id="c-35822252" checked=""/><div class="controls bullet"><span class="by">keb_</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35823888">prev</a><span>|</span><a href="#35821849">next</a><span>|</span><label class="collapse" for="c-35822252">[-]</label><label class="expand" for="c-35822252">[2 more]</label></div><br/><div class="children"><div class="content">Speaking of Lua, does anyone know of a Lua implementation with filesystem access that is smaller than (or as small as) QuickJS (~800KB)?</div><br/><div id="35823813" class="c"><input type="checkbox" id="c-35823813" checked=""/><div class="controls bullet"><span class="by">jabbequbs</span><span>|</span><a href="#35821694">root</a><span>|</span><a href="#35822252">parent</a><span>|</span><a href="#35821849">next</a><span>|</span><label class="collapse" for="c-35823813">[-]</label><label class="expand" for="c-35823813">[1 more]</label></div><br/><div class="children"><div class="content">Last time I compiled standard Lua I think it was only 300-400KB.  It has all the cross platform file manipulation capabilities that C does.  I was using TCC though, and it does seem to generate small (unoptimized) binaries.</div><br/></div></div></div></div><div id="35821849" class="c"><input type="checkbox" id="c-35821849" checked=""/><div class="controls bullet"><span class="by">giraffe_lady</span><span>|</span><a href="#35821694">parent</a><span>|</span><a href="#35822252">prev</a><span>|</span><a href="#35820703">next</a><span>|</span><label class="collapse" for="c-35821849">[-]</label><label class="expand" for="c-35821849">[1 more]</label></div><br/><div class="children"><div class="content">Lua is a better integrated language simply because that path is intended by its developers and directly documented, and its runtime is designed to be easy to couple to C. But nothing about its semantics make it better for that task than javascript. They are extremely similar except lua doesn&#x27;t have stuff you would almost always want like basic string manipulation tools, regex, any array operations more sophisticated than loop.<p>You can argue you don&#x27;t <i>need</i> those things, but their lack isn&#x27;t a feature either. If you&#x27;re not coupling to C&#x27;s memory model or if for some reason someone has already done the work of building and debugging the integration... you gain nothing by using lua over js.<p>I&#x27;ve done professional work in lua and it&#x27;s highly overrated imo. For integrated languages Tcl or janet is a better choice, unless your use case is extremely extremely simple and then forth is a better choice. The only time I would choose lua is if I&#x27;m integrating with C, the integration language tasks are very simple but <i>also</i> requires coroutines. Lua&#x27;s coroutines are genuinely good.</div><br/></div></div></div></div><div id="35820703" class="c"><input type="checkbox" id="c-35820703" checked=""/><div class="controls bullet"><span class="by">FascistDonut</span><span>|</span><a href="#35821694">prev</a><span>|</span><a href="#35820507">next</a><span>|</span><label class="collapse" for="c-35820703">[-]</label><label class="expand" for="c-35820703">[5 more]</label></div><br/><div class="children"><div class="content">When&#x2F;why would you want to do this? I went to pt. 1 but it didn&#x27;t seem clear.</div><br/><div id="35821114" class="c"><input type="checkbox" id="c-35821114" checked=""/><div class="controls bullet"><span class="by">NTARelix</span><span>|</span><a href="#35820703">parent</a><span>|</span><a href="#35821162">next</a><span>|</span><label class="collapse" for="c-35821114">[-]</label><label class="expand" for="c-35821114">[1 more]</label></div><br/><div class="children"><div class="content">The content of the series describes creating something like the beginnings of a Deno alternative, upon which the reader could fully recreate Deno or Node.js. It seems to me that the core idea presented is &quot;a JavaScript&#x2F;TypeScript interface to Rust&quot;. The thing that most interests me about something like this is not making yet another alternative to Deno or Node.js, but the potential for adding a scripting language to an application or framework written in Rust. I&#x27;m thinking like Python scripting of Blender, Lua as a scripting&#x2F;modding layer for a game engine, scripting of Tiled with JS, an Electron alternative using GTK, your own browser.</div><br/></div></div><div id="35821162" class="c"><input type="checkbox" id="c-35821162" checked=""/><div class="controls bullet"><span class="by">TechBro8615</span><span>|</span><a href="#35820703">parent</a><span>|</span><a href="#35821114">prev</a><span>|</span><a href="#35823700">next</a><span>|</span><label class="collapse" for="c-35821162">[-]</label><label class="expand" for="c-35821162">[1 more]</label></div><br/><div class="children"><div class="content">When you want to add a sandboxed scripting language to any system, you might implement something like this. For example, a multi-tenant web proxy that lets users script functions for transforming requests, or a game that lets users script the user interface elements, would be two valid use cases.</div><br/></div></div><div id="35823700" class="c"><input type="checkbox" id="c-35823700" checked=""/><div class="controls bullet"><span class="by">rektide</span><span>|</span><a href="#35820703">parent</a><span>|</span><a href="#35821162">prev</a><span>|</span><a href="#35822226">next</a><span>|</span><label class="collapse" for="c-35823700">[-]</label><label class="expand" for="c-35823700">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s hundreds of programs that can be scripted with embedded Lua. For example, nginx web server, or neovim editor or awesomewm window manager. Having an embedded scripting language gives these systems enormous flexibility &amp; utility.<p>This series is effectively about doing the same, but embedded Deno instead of Lua. It&#x27;s showing how to launch Deno runtime, and how to seed those runtime with various hooks to access &amp; manipulate the program it&#x27;s embedded in.</div><br/></div></div><div id="35822226" class="c"><input type="checkbox" id="c-35822226" checked=""/><div class="controls bullet"><span class="by">emmanueloga_</span><span>|</span><a href="#35820703">parent</a><span>|</span><a href="#35823700">prev</a><span>|</span><a href="#35820507">next</a><span>|</span><label class="collapse" for="c-35822226">[-]</label><label class="expand" for="c-35822226">[1 more]</label></div><br/><div class="children"><div class="content">sounds useful for sandboxing</div><br/></div></div></div></div><div id="35820507" class="c"><input type="checkbox" id="c-35820507" checked=""/><div class="controls bullet"><span class="by">rickbutton</span><span>|</span><a href="#35820703">prev</a><span>|</span><label class="collapse" for="c-35820507">[-]</label><label class="expand" for="c-35820507">[3 more]</label></div><br/><div class="children"><div class="content">roll your own runtime does not imply to me `import runtime from &quot;runtime&quot;;` but this seems to just be &quot;include deno and use deno&quot;?</div><br/><div id="35820823" class="c"><input type="checkbox" id="c-35820823" checked=""/><div class="controls bullet"><span class="by">notamy</span><span>|</span><a href="#35820507">parent</a><span>|</span><a href="#35820859">prev</a><span>|</span><label class="collapse" for="c-35820823">[-]</label><label class="expand" for="c-35820823">[1 more]</label></div><br/><div class="children"><div class="content">This is using Deno as the glue between Rust and V8; it leaves many things to the end-user, such as stdlib implementation. This isn&#x27;t quite the same as building it from scratch, but it&#x27;s still building a good chunk of the runtime I think.</div><br/></div></div></div></div></div></div></div></div></div></body></html>