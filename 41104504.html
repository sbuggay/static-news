<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1722330064774" as="style"/><link rel="stylesheet" href="styles.css?v=1722330064774"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.digicert.com/support/certificate-revocation-incident">DigiCert Revocation Incident (CNAME Domain Validation)</a>Â <span class="domain">(<a href="https://www.digicert.com">www.digicert.com</a>)</span></div><div class="subtext"><span>vitaliyf</span> | <span>7 comments</span></div><br/><div><div id="41105476" class="c"><input type="checkbox" id="c-41105476" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#41104711">next</a><span>|</span><label class="collapse" for="c-41105476">[-]</label><label class="expand" for="c-41105476">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>The underscore prefix ensures that the random value cannot collide with an actual domain name that uses the same random value. While the odds of that happening are practically negligible, the validation is still deemed as non-compliant if it does not include the underscore prefix.</i><p>That&#x27;s not the rationale for mandating the underscore prefix. The actual reason is so services that allow users to create DNS records at subdomains (e.g. dynamic DNS services) can block users from registering subdomains starting with an underscore.  It serves the same purpose that &#x2F;.well-known does.<p>For example, if an attacker requests a certificate for dyndns.example and DigiCert gives them a record without an underscore prefix like da39a3ee5e6b4b0d3255bfef95601890afd80709.dyndns.example, they can register that subdomain with the dynamic DNS provider, publish the required record, and get the certificate for dyndns.example.  It doesn&#x27;t matter how much entropy DigiCert put in the record name.<p>I definitely commend DigiCert for pledging to revoke the certificates within 24 hours and not having a delayed revocation or trying to language lawyer their way to a 5 day revocation as other CAs have tried.  Nevertheless, this post severely minimizes the security impact of their mistake, and provides an excellent example of why CAs should always be required to strictly adhere to the rules and not be permitted to excuse noncompliance based on their own security analysis.</div><br/></div></div><div id="41104711" class="c"><input type="checkbox" id="c-41104711" checked=""/><div class="controls bullet"><span class="by">kevinday</span><span>|</span><a href="#41105476">prev</a><span>|</span><a href="#41104505">next</a><span>|</span><label class="collapse" for="c-41104711">[-]</label><label class="expand" for="c-41104711">[4 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;bugzilla.mozilla.org&#x2F;show_bug.cgi?id=1910322" rel="nofollow">https:&#x2F;&#x2F;bugzilla.mozilla.org&#x2F;show_bug.cgi?id=1910322</a><p>for more background. The short story is that when doing CNAME based validation, they were supposed to put an underscore at the start of the random string for you to add to your DNS records. They still generated sufficiently random strings but didn&#x27;t include a _ before it which is in violation of the RFC. The rationale is that some sites might do something like give you control of yourusername.example.com and they don&#x27;t want to make it possible for random users to register the random string and be able to manipulate it. If you don&#x27;t allow users to generate anything that causes a hostname to appear with a leading underscore, they can&#x27;t pass the domain validation.</div><br/><div id="41105286" class="c"><input type="checkbox" id="c-41105286" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#41104711">parent</a><span>|</span><a href="#41104505">next</a><span>|</span><label class="collapse" for="c-41105286">[-]</label><label class="expand" for="c-41105286">[3 more]</label></div><br/><div class="children"><div class="content">Also, while a DNS name can have an underscore a <i>host</i> name, even in DNS, cannot have this character. So if you have a user named &quot;haha_funny&quot; you already aren&#x27;t allowed to give them the hostname &quot;haha_funny.somesite.example&quot; - and on some system it will just silently not work because it&#x27;s invalid.<p>So even if you are completely oblivious to this work, and don&#x27;t care about security at all, your &quot;Give everybody a hostname&quot; code should already avoid underscore characters as desired because otherwise stuff breaks.<p>Several current systems use DNS names (but not hostnames) which feature underscores but it&#x27;s pretty unlikely that you&#x27;ve got (for example) a service where users can pick their own TCP&#x2F;IP service name and port and issued appropriate records for it in DNS. If you <i>have</i> done this weird thing you probably want to use the existing mechanism (in DNS of course, the CAA record) to tell most CAs that they should not issue for your names even if they think they&#x27;ve received permission. You can then cut a suitable deal with a for-profit CA to do whatever crazy extra checks you want (e.g. Meta&#x27;s CA has to contact actual people in the appropriate security team at Meta, so that &quot;mistakes&quot; which give somebody a certificate for facebook.com never happen without some pretty drastic real world errors).</div><br/><div id="41105721" class="c"><input type="checkbox" id="c-41105721" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#41104711">root</a><span>|</span><a href="#41105286">parent</a><span>|</span><a href="#41104505">next</a><span>|</span><label class="collapse" for="c-41105721">[-]</label><label class="expand" for="c-41105721">[2 more]</label></div><br/><div class="children"><div class="content"><i>So if you have a user named &quot;haha_funny&quot; you already aren&#x27;t allowed to give them the hostname &quot;haha_funny.somesite.example&quot; - and on some system it will just silently not work because it&#x27;s invalid.</i><p>Not long ago I actually did come across a site that had an underscore in its domain name, and it worked both for me and apparently Google, because it indexed and showed a (relevant) page from that site. I only remembered it was on a *.tripod.com subdomain, and can&#x27;t find that exact site now since I don&#x27;t remember what I was searching for (it was a highly obscure and technical topic), but there do appear to be others there with underscores, e.g.:<p><a href="http:&#x2F;&#x2F;computer_collector.tripod.com&#x2F;" rel="nofollow">http:&#x2F;&#x2F;computer_collector.tripod.com&#x2F;</a><p><a href="http:&#x2F;&#x2F;hattori_striker.tripod.com&#x2F;" rel="nofollow">http:&#x2F;&#x2F;hattori_striker.tripod.com&#x2F;</a><p><a href="http:&#x2F;&#x2F;forgotten_dark_angel.tripod.com&#x2F;" rel="nofollow">http:&#x2F;&#x2F;forgotten_dark_angel.tripod.com&#x2F;</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>