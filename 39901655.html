<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712048452241" as="style"/><link rel="stylesheet" href="styles.css?v=1712048452241"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.openwall.com/lists/oss-security/2024/04/01/1">From xz to ibus: more questionable tarballs</a>Â <span class="domain">(<a href="https://www.openwall.com">www.openwall.com</a>)</span></div><div class="subtext"><span>nateb2022</span> | <span>24 comments</span></div><br/><div><div id="39903647" class="c"><input type="checkbox" id="c-39903647" checked=""/><div class="controls bullet"><span class="by">kzrdude</span><span>|</span><a href="#39903320">next</a><span>|</span><label class="collapse" for="c-39903647">[-]</label><label class="expand" for="c-39903647">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve enabled &quot;trusted publishing&quot; as it is called for python packages (publishing to cheeseshop&#x2F;PyPI).<p>However, what they call trusted publishing is just a configuration where PyPI tells github that publishing from a particular workflow name on a particular repository is ok, without further tokens. So PyPI &quot;trusts&quot; github actions and the maintainer is out of the loop.<p>All good? Well, if you trust Github!<p>It would be a lot better to me if both the maintainer and github were involved, something like - the maintainer signs off on some artifacts, and the github action verifies they are reproducible exactly by a workflow, and &#x2F;then&#x2F; it&#x27;s published.</div><br/></div></div><div id="39903320" class="c"><input type="checkbox" id="c-39903320" checked=""/><div class="controls bullet"><span class="by">andersa</span><span>|</span><a href="#39903647">prev</a><span>|</span><a href="#39902006">next</a><span>|</span><label class="collapse" for="c-39903320">[-]</label><label class="expand" for="c-39903320">[5 more]</label></div><br/><div class="children"><div class="content">Why is this a thing? Can&#x27;t packages use specific tags from the git repo? It seems so incredibly stupid to allow this, throwing out all of the &quot;oh but it&#x27;s open source you can review it&quot; arguments in one go if the source displayed on GitHub is not what ends up used...</div><br/><div id="39903504" class="c"><input type="checkbox" id="c-39903504" checked=""/><div class="controls bullet"><span class="by">atlasduo</span><span>|</span><a href="#39903320">parent</a><span>|</span><a href="#39903586">next</a><span>|</span><label class="collapse" for="c-39903504">[-]</label><label class="expand" for="c-39903504">[3 more]</label></div><br/><div class="children"><div class="content">Tags can be changed. To actually pin the source code revision, they should pin to a specific commit hash.</div><br/><div id="39903535" class="c"><input type="checkbox" id="c-39903535" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39903320">root</a><span>|</span><a href="#39903504">parent</a><span>|</span><a href="#39903550">next</a><span>|</span><label class="collapse" for="c-39903535">[-]</label><label class="expand" for="c-39903535">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes they get changed for a silly reason (someone just didn&#x27;t think of the consequences). Sometimes they get changed because they have to - if I remember correctly it was Asterisk that needed to drop some copyrighted music samples and retagged old versions.</div><br/></div></div><div id="39903550" class="c"><input type="checkbox" id="c-39903550" checked=""/><div class="controls bullet"><span class="by">andersa</span><span>|</span><a href="#39903320">root</a><span>|</span><a href="#39903504">parent</a><span>|</span><a href="#39903535">prev</a><span>|</span><a href="#39903586">next</a><span>|</span><label class="collapse" for="c-39903550">[-]</label><label class="expand" for="c-39903550">[1 more]</label></div><br/><div class="children"><div class="content">Good point, that would make sense. But same difference. Why is that not how it works?</div><br/></div></div></div></div><div id="39903586" class="c"><input type="checkbox" id="c-39903586" checked=""/><div class="controls bullet"><span class="by">senectus1</span><span>|</span><a href="#39903320">parent</a><span>|</span><a href="#39903504">prev</a><span>|</span><a href="#39902006">next</a><span>|</span><label class="collapse" for="c-39903586">[-]</label><label class="expand" for="c-39903586">[1 more]</label></div><br/><div class="children"><div class="content">my understanding is for speed reasons most distro&#x27;s dont build from the source they build from tarballs.<p>If they built from the source there wouldn&#x27;t be this issue.</div><br/></div></div></div></div><div id="39902006" class="c"><input type="checkbox" id="c-39902006" checked=""/><div class="controls bullet"><span class="by">dhx</span><span>|</span><a href="#39903320">prev</a><span>|</span><a href="#39903615">next</a><span>|</span><label class="collapse" for="c-39902006">[-]</label><label class="expand" for="c-39902006">[10 more]</label></div><br/><div class="children"><div class="content">1.5.29-rc2 was tagged on 9 Nov 2023 [1] and, as an example, did not contain &quot;N_(&quot;CJK Unified Ideographs Extension I&quot;),&quot; in src&#x2F;ibusunicodegen.h [2].<p>Commit 228f0a77b2047ade54e132bab69c0c03f0f41aae from 28 Feb 2023 introduced this change instead. It&#x27;s the same person who tagged 1.5.29-rc2 and committed 228f0a77b2047ade54e132bab69c0c03f0f41aae which is typically an indication the maintainer tar&#x27;d their checked out git folder and accidentally included changes not get committed.<p>The question raised is whether anyone is auditing these differences before the checksummed tarballs are added to package repositories.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;releases&#x2F;tag&#x2F;1.5.29-rc2">https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;releases&#x2F;tag&#x2F;1.5.29-rc2</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;blob&#x2F;0ad8e77bd36545974ad8acd0a5283cf72bc7c8ad&#x2F;src&#x2F;ibusunicodegen.h">https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;blob&#x2F;0ad8e77bd36545974ad8acd0a5...</a><p>[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;commit&#x2F;228f0a77b2047ade54e132bab69c0c03f0f41aae">https:&#x2F;&#x2F;github.com&#x2F;ibus&#x2F;ibus&#x2F;commit&#x2F;228f0a77b2047ade54e132ba...</a></div><br/><div id="39902626" class="c"><input type="checkbox" id="c-39902626" checked=""/><div class="controls bullet"><span class="by">dhx</span><span>|</span><a href="#39902006">parent</a><span>|</span><a href="#39903298">next</a><span>|</span><label class="collapse" for="c-39902626">[-]</label><label class="expand" for="c-39902626">[1 more]</label></div><br/><div class="children"><div class="content">^ typo: 28 Feb 2023 is meant to be 28 Feb 2024, or almost 4 months later.</div><br/></div></div><div id="39903298" class="c"><input type="checkbox" id="c-39903298" checked=""/><div class="controls bullet"><span class="by">juitpykyk</span><span>|</span><a href="#39902006">parent</a><span>|</span><a href="#39902626">prev</a><span>|</span><a href="#39903615">next</a><span>|</span><label class="collapse" for="c-39903298">[-]</label><label class="expand" for="c-39903298">[8 more]</label></div><br/><div class="children"><div class="content">GitHub has the feature of downloading the tree as a zip, why is this not used?</div><br/><div id="39903357" class="c"><input type="checkbox" id="c-39903357" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903298">parent</a><span>|</span><a href="#39903509">next</a><span>|</span><label class="collapse" for="c-39903357">[-]</label><label class="expand" for="c-39903357">[2 more]</label></div><br/><div class="children"><div class="content">There are two main reasons, one bad, one good(-ish):<p>(1) Traditional autoconf assumed you only had a shell and cc and make, and so the .&#x2F;configure script which is a huge ball of obscure shell commands is shipped.  I think most distros will now delete and recreate these files, which probably should have happened a lot earlier.  (Debian has been mostly doing this right for a long time already.)<p>(2) Some programs generate a lot of code (eg. in libnbd we generate thousands of lines of boilerplate C from API descriptions*).  To avoid people needing to install the specific tools that we use to generate that code, we distribute the generated files in the tarball, but it&#x27;s not present in git.  You <i>can</i> still build from git directly, and you can also verify the generated code exactly matches the tarball, but both cases mean extra build dependencies for end users and packagers.<p>* Generating boilerplate code is a good thing in general as it reduces systematic errors, which are a vastly more common source of bugs compared to highly targeted supply chain attacks.</div><br/><div id="39903544" class="c"><input type="checkbox" id="c-39903544" checked=""/><div class="controls bullet"><span class="by">efrecon</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903357">parent</a><span>|</span><a href="#39903509">next</a><span>|</span><label class="collapse" for="c-39903544">[-]</label><label class="expand" for="c-39903544">[1 more]</label></div><br/><div class="children"><div class="content">Downloading the tarball&#x2F;zip with just a shell and regular utils is possible. See <a href="https:&#x2F;&#x2F;github.com&#x2F;efrecon&#x2F;ungit">https:&#x2F;&#x2F;github.com&#x2F;efrecon&#x2F;ungit</a></div><br/></div></div></div></div><div id="39903509" class="c"><input type="checkbox" id="c-39903509" checked=""/><div class="controls bullet"><span class="by">Lockal</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903298">parent</a><span>|</span><a href="#39903357">prev</a><span>|</span><a href="#39903327">next</a><span>|</span><label class="collapse" for="c-39903509">[-]</label><label class="expand" for="c-39903509">[1 more]</label></div><br/><div class="children"><div class="content">There is a minor note that technically there is a weak guarantee that checksums won&#x27;t break after server update and recompression with different version &#x2F; alternative implementation of gzip.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;orgs&#x2F;community&#x2F;discussions&#x2F;45830">https:&#x2F;&#x2F;github.com&#x2F;orgs&#x2F;community&#x2F;discussions&#x2F;45830</a></div><br/></div></div><div id="39903327" class="c"><input type="checkbox" id="c-39903327" checked=""/><div class="controls bullet"><span class="by">dhx</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903298">parent</a><span>|</span><a href="#39903509">prev</a><span>|</span><a href="#39903615">next</a><span>|</span><label class="collapse" for="c-39903327">[-]</label><label class="expand" for="c-39903327">[4 more]</label></div><br/><div class="children"><div class="content">For many projects, the release tarballs only contain the files necessary to build the software, and not the following items that may be present in the same repository:<p>- scripts used by project developers to import translations from another system and commit those translation changes to the repository<p>- scripts to build release tarballs and sign them<p>- continuous integration scripts<p>- configuration and scripts used to setup a developer IDE environment</div><br/><div id="39903456" class="c"><input type="checkbox" id="c-39903456" checked=""/><div class="controls bullet"><span class="by">roywashere</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903327">parent</a><span>|</span><a href="#39903347">next</a><span>|</span><label class="collapse" for="c-39903456">[-]</label><label class="expand" for="c-39903456">[2 more]</label></div><br/><div class="children"><div class="content">You can use .gitattributes export-ignore to influence what gets into the tarballs and what stays into the repository! It&#x27;s super powerful but not often used</div><br/><div id="39903465" class="c"><input type="checkbox" id="c-39903465" checked=""/><div class="controls bullet"><span class="by">kzrdude</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903456">parent</a><span>|</span><a href="#39903347">next</a><span>|</span><label class="collapse" for="c-39903465">[-]</label><label class="expand" for="c-39903465">[1 more]</label></div><br/><div class="children"><div class="content">And export-subst to insert the current tag or git revision into the archive too.<p>In fact export-subst is powerful enough that there is probably some way to create an exploit triggered by a particular payload inside a commit or tag message? :)<p>Maybe not triggered, but it could be part of the chain.</div><br/></div></div></div></div><div id="39903347" class="c"><input type="checkbox" id="c-39903347" checked=""/><div class="controls bullet"><span class="by">juitpykyk</span><span>|</span><a href="#39902006">root</a><span>|</span><a href="#39903327">parent</a><span>|</span><a href="#39903456">prev</a><span>|</span><a href="#39903615">next</a><span>|</span><label class="collapse" for="c-39903347">[-]</label><label class="expand" for="c-39903347">[1 more]</label></div><br/><div class="children"><div class="content">What would be the problem of downloading a few MB more, aren&#x27;t these source tarballs just used to build the distro binary and then they are deleted?</div><br/></div></div></div></div></div></div></div></div><div id="39903615" class="c"><input type="checkbox" id="c-39903615" checked=""/><div class="controls bullet"><span class="by">sam_goody</span><span>|</span><a href="#39902006">prev</a><span>|</span><a href="#39903336">next</a><span>|</span><label class="collapse" for="c-39903615">[-]</label><label class="expand" for="c-39903615">[1 more]</label></div><br/><div class="children"><div class="content">This has <i>really</i> been bugging me about npm.<p>Anyone can publish a open source repo and add it to npmjs. Users going to the page on npmjs will see that the repo with the code is github.com&#x2F;myrepo.<p>But when I do `npm i myrepo` there is no guarantee that what is being pulled is in any way similar to what is in the linked repo. Creating a false feeling that the code <i>could</i> be reviewed.<p>At the very least, Github should not allow this for code on their platform (ie, if npmjs has it listed as the repo of a project they should scan that the project actually builds to the content or notify npm who should have it flagged). Or npmjs should regularly scan the same - checking that the code you would get by compiling matches the code being offered<p>Bear in mind that if a bad actor can get in at the level of the NPM user, even if the user is not running as a superuser (which it often is since port 80 needs to be a superuser to be used, and PM2 is way above the ability of many devs, sigh), they can scan for vulnerabilities, and perhaps open themselves a very big hole.</div><br/></div></div><div id="39903336" class="c"><input type="checkbox" id="c-39903336" checked=""/><div class="controls bullet"><span class="by">kijin</span><span>|</span><a href="#39903615">prev</a><span>|</span><label class="collapse" for="c-39903336">[-]</label><label class="expand" for="c-39903336">[6 more]</label></div><br/><div class="children"><div class="content">What makes maintainers of major distros still rely on questionable tarballs to build packages? It&#x27;s not as if these essential programs don&#x27;t have a public, authoritative git repository.<p>Is it because of inertia, because we&#x27;ve been using tarballs since before VCS was a thing? Is it to reduce the burden of package maintainership, by letting upstream do most of the transpiling and autotools plumbing work? Is it because some assets and test data are only included in the tarballs? Why are they not committed, either to the same repo or (if upstream wishes to keep the main repo small) some other repo?<p>People have been calling for reproducible builds for years now, but reproducible builds don&#x27;t mean anything if they are not built from authoritative sources with immutable commit IDs.</div><br/><div id="39903370" class="c"><input type="checkbox" id="c-39903370" checked=""/><div class="controls bullet"><span class="by">Kluggy</span><span>|</span><a href="#39903336">parent</a><span>|</span><a href="#39903537">next</a><span>|</span><label class="collapse" for="c-39903370">[-]</label><label class="expand" for="c-39903370">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s absolutely because of inertia. Cutting a tarball is a very public indicator that the software is ready to be used. A git tag or branch doesn&#x27;t have the clarity of &quot;use this&quot; as a release tarball does.<p>That said, this is absolutely going to be changing now. We obviously can&#x27;t keep relying on tarballs anymore. We&#x27;ll find a new normal that will work for a very long time until some other critical issue arises and the cycle repeats.</div><br/><div id="39903404" class="c"><input type="checkbox" id="c-39903404" checked=""/><div class="controls bullet"><span class="by">kzrdude</span><span>|</span><a href="#39903336">root</a><span>|</span><a href="#39903370">parent</a><span>|</span><a href="#39903537">next</a><span>|</span><label class="collapse" for="c-39903404">[-]</label><label class="expand" for="c-39903404">[1 more]</label></div><br/><div class="children"><div class="content">We can use tarballs - they are useful as signed artifacts, but only if we verify that they are reproducible.</div><br/></div></div></div></div><div id="39903537" class="c"><input type="checkbox" id="c-39903537" checked=""/><div class="controls bullet"><span class="by">badsectoracula</span><span>|</span><a href="#39903336">parent</a><span>|</span><a href="#39903370">prev</a><span>|</span><label class="collapse" for="c-39903537">[-]</label><label class="expand" for="c-39903537">[3 more]</label></div><br/><div class="children"><div class="content">Why are tarballs any less authoritative than a Git repository? Both come from the same authors. If you can&#x27;t trust the tarball released by some author why would you trust what the repository contains?</div><br/><div id="39903609" class="c"><input type="checkbox" id="c-39903609" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#39903336">root</a><span>|</span><a href="#39903537">parent</a><span>|</span><a href="#39903600">next</a><span>|</span><label class="collapse" for="c-39903609">[-]</label><label class="expand" for="c-39903609">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why are tarballs any less authoritative than a Git repository? Both come from the same authors.<p>The difference is in traceability and how easily someone upstream can insert nefarious code without it being noticed or undergoing traditional process checks like code reviews.</div><br/></div></div><div id="39903600" class="c"><input type="checkbox" id="c-39903600" checked=""/><div class="controls bullet"><span class="by">senectus1</span><span>|</span><a href="#39903336">root</a><span>|</span><a href="#39903537">parent</a><span>|</span><a href="#39903609">prev</a><span>|</span><label class="collapse" for="c-39903600">[-]</label><label class="expand" for="c-39903600">[1 more]</label></div><br/><div class="children"><div class="content">as i understand it, the tooling would &quot;see&quot; some of the questionable configs that were in the tarballs.<p>Because they&#x27;re packaged into tarballs they cant be checked. or or to the point they use the tarballs because its much faster...</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>