<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1720774863287" as="style"/><link rel="stylesheet" href="styles.css?v=1720774863287"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/gojue/ecapture">Capturing Linux SSL/TLS plaintext without a CA certificate using eBPF</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>walterbell</span> | <span>57 comments</span></div><br/><div><div id="40943798" class="c"><input type="checkbox" id="c-40943798" checked=""/><div class="controls bullet"><span class="by">1vuio0pswjnm7</span><span>|</span><a href="#40940073">next</a><span>|</span><label class="collapse" for="c-40943798">[-]</label><label class="expand" for="c-40943798">[1 more]</label></div><br/><div class="children"><div class="content">This requires Linux and an uncommon kernel config&#x2F;module.  Further, it does not seem to offer a facility for modifying traffic.<p>I use a localhost-bound TLS forward proxy.  Works on both BSD and Linux, kernel config is irrelevant.  Allows me to easily redirect and modify traffic.<p>ECH is still lagging in server adoption.  After Cloudflare discontinued their ESNI trial I have avoided sites that require SNI, e.g., ones using Cloudflare.  What I have found is that most websites on the internet still do not require it.  The sites that use a handful of large, popular CDNs are the exceptions.  There are numerous workarounds for those, e.g., archive.org needs no SNI.  Allows me to access Cloudflare sites without sending SNI.<p>As for certificate pinning, I do not use closed source &quot;apps&quot;.<p>If corporations MITM their TLS traffic then individuals should do the same.</div><br/></div></div><div id="40940073" class="c"><input type="checkbox" id="c-40940073" checked=""/><div class="controls bullet"><span class="by">evanjrowley</span><span>|</span><a href="#40943798">prev</a><span>|</span><a href="#40943322">next</a><span>|</span><label class="collapse" for="c-40940073">[-]</label><label class="expand" for="c-40940073">[2 more]</label></div><br/><div class="children"><div class="content">Gigamon offers a capability they call <i>Precryption</i> which functions the same under the hood, but also with a centralized interface: <a href="https:&#x2F;&#x2F;www.gigamon.com&#x2F;campaigns&#x2F;precryption.html" rel="nofollow">https:&#x2F;&#x2F;www.gigamon.com&#x2F;campaigns&#x2F;precryption.html</a></div><br/><div id="40943108" class="c"><input type="checkbox" id="c-40943108" checked=""/><div class="controls bullet"><span class="by">bnjms</span><span>|</span><a href="#40940073">parent</a><span>|</span><a href="#40943322">next</a><span>|</span><label class="collapse" for="c-40943108">[-]</label><label class="expand" for="c-40943108">[1 more]</label></div><br/><div class="children"><div class="content">Gigamon products consistently creep me out. Pretty sure they’re mostly good to great, but they always make me think panopticon.</div><br/></div></div></div></div><div id="40943322" class="c"><input type="checkbox" id="c-40943322" checked=""/><div class="controls bullet"><span class="by">k__</span><span>|</span><a href="#40940073">prev</a><span>|</span><a href="#40940444">next</a><span>|</span><label class="collapse" for="c-40943322">[-]</label><label class="expand" for="c-40943322">[1 more]</label></div><br/><div class="children"><div class="content">Half-OT<p>Is there any way to account a response of a TLS enabled server to it&#x27;s public key?<p>Something like reverse fingerprinting?</div><br/></div></div><div id="40940444" class="c"><input type="checkbox" id="c-40940444" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#40943322">prev</a><span>|</span><a href="#40942791">next</a><span>|</span><label class="collapse" for="c-40940444">[-]</label><label class="expand" for="c-40940444">[16 more]</label></div><br/><div class="children"><div class="content">What is the use case for this? Learning more about how Android apps communicate with their home server?</div><br/><div id="40940553" class="c"><input type="checkbox" id="c-40940553" checked=""/><div class="controls bullet"><span class="by">jcrawfordor</span><span>|</span><a href="#40940444">parent</a><span>|</span><a href="#40940583">next</a><span>|</span><label class="collapse" for="c-40940553">[-]</label><label class="expand" for="c-40940553">[7 more]</label></div><br/><div class="children"><div class="content">Very useful for reverse engineering and security auditing of internal APIs. Particularly on Android a lot of apps pin CA certs or use their own trust store, so you have to do a little RE on them to insert your own cert... Or do it this way.</div><br/><div id="40941400" class="c"><input type="checkbox" id="c-40941400" checked=""/><div class="controls bullet"><span class="by">mschuster91</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40940553">parent</a><span>|</span><a href="#40940583">next</a><span>|</span><label class="collapse" for="c-40941400">[-]</label><label class="expand" for="c-40941400">[6 more]</label></div><br/><div class="children"><div class="content">Unfortunately that requires root, and SDKs have gotten incredibly good at detecting root - not to mention SafetyNet Attestation.<p>For a full bypass of that crap, you nowadays need <i>a lot</i> of resources including a Secure Enclave exploit - for now they&#x27;re (relatively) cheap but eventually they&#x27;ll be the kind of stuff traded for seven figures a pop.<p>Eternal shame on Google for not insisting that Android would follow the &quot;PC model&quot; of the user being root on their own machine and DRM and whatnot can go and screw themselves. They had the chance of <i>actually</i> delivering something that would not require jailbreaking and cat-and-mouse games like iOS, but they blew it (and blew the MAFIAA instead).</div><br/><div id="40943799" class="c"><input type="checkbox" id="c-40943799" checked=""/><div class="controls bullet"><span class="by">PlutoIsAPlanet</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40941400">parent</a><span>|</span><a href="#40941443">next</a><span>|</span><label class="collapse" for="c-40943799">[-]</label><label class="expand" for="c-40943799">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Eternal shame on Google for not insisting that Android would follow the &quot;PC model&quot; of the user being root on their own machine and DRM ..<p>To be fair to Google, banks don&#x27;t usually allow you to download and generate EMV tokens to perform card transactions on your PC, which places a different set of security requirements (legal requirements too) on Android phones for things like Google Pay to exist.</div><br/></div></div><div id="40941443" class="c"><input type="checkbox" id="c-40941443" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40941400">parent</a><span>|</span><a href="#40943799">prev</a><span>|</span><a href="#40940583">next</a><span>|</span><label class="collapse" for="c-40941443">[-]</label><label class="expand" for="c-40941443">[4 more]</label></div><br/><div class="children"><div class="content">&gt; <i>and DRM and whatnot can go and screw themselves</i><p>The funny thing is that they wouldn&#x27;t have even needed to take this position.  DRM works well enough on (e.g.) Windows to make the various studios more or less happy, and users have &quot;root&quot; on Windows as usual.  Ditto for macOS.  Hell, DRM works just fine on my Linux desktop install, as much as I despite its existence.</div><br/><div id="40941484" class="c"><input type="checkbox" id="c-40941484" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40941443">parent</a><span>|</span><a href="#40940583">next</a><span>|</span><label class="collapse" for="c-40941484">[-]</label><label class="expand" for="c-40941484">[3 more]</label></div><br/><div class="children"><div class="content">My favorite benefit of DRM support has been that Firefox will prompt me &quot;do you want to allow DRM content?&quot; when I visit a news website. Ignoring that or clicking no auto-blocks all the autoplaying videos.</div><br/><div id="40941715" class="c"><input type="checkbox" id="c-40941715" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40941484">parent</a><span>|</span><a href="#40942734">next</a><span>|</span><label class="collapse" for="c-40941715">[-]</label><label class="expand" for="c-40941715">[1 more]</label></div><br/><div class="children"><div class="content">Indeed, I love this feature of Firefox.  There&#x27;s something that feels so damn good about saying &quot;No&quot; to DRM content.  If only there was a way to tell the website that the content was blocked due to DRM...</div><br/></div></div><div id="40942734" class="c"><input type="checkbox" id="c-40942734" checked=""/><div class="controls bullet"><span class="by">lmm</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40941484">parent</a><span>|</span><a href="#40941715">prev</a><span>|</span><a href="#40940583">next</a><span>|</span><label class="collapse" for="c-40942734">[-]</label><label class="expand" for="c-40942734">[1 more]</label></div><br/><div class="children"><div class="content">The web is finally catching up with where it was in the Flash days.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40940583" class="c"><input type="checkbox" id="c-40940583" checked=""/><div class="controls bullet"><span class="by">justahuman74</span><span>|</span><a href="#40940444">parent</a><span>|</span><a href="#40940553">prev</a><span>|</span><a href="#40942983">next</a><span>|</span><label class="collapse" for="c-40940583">[-]</label><label class="expand" for="c-40940583">[1 more]</label></div><br/><div class="children"><div class="content">Inspecting what apps are sending out when they don&#x27;t want you to see</div><br/></div></div><div id="40942983" class="c"><input type="checkbox" id="c-40942983" checked=""/><div class="controls bullet"><span class="by">rocqua</span><span>|</span><a href="#40940444">parent</a><span>|</span><a href="#40940583">prev</a><span>|</span><a href="#40940675">next</a><span>|</span><label class="collapse" for="c-40942983">[-]</label><label class="expand" for="c-40942983">[4 more]</label></div><br/><div class="children"><div class="content">Interception for regulated companies. Banks have to keep a log of all communication between their employees.<p>That requires HTTPS interception. Before TLS1.3 they would install root CAs on all company devices, have an edge proxy, and use SNI to determine whether an HTTPS session should be man in the middled. Because it would take way to much compute to MitM all trafic (like YouTube video).<p>After TLS1.3 encrypted SNI blocks this. But they still need (and other companies want) to selectively intercept HTTPS. With a tool like this you can achieve that clientside, rather than at the network edge.</div><br/><div id="40943350" class="c"><input type="checkbox" id="c-40943350" checked=""/><div class="controls bullet"><span class="by">new23d</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40942983">parent</a><span>|</span><a href="#40943560">next</a><span>|</span><label class="collapse" for="c-40943350">[-]</label><label class="expand" for="c-40943350">[1 more]</label></div><br/><div class="children"><div class="content">TLS 1.3 and ESNI (now called Encrypted Client Hello - ECH) are separate standards, although you&#x27;ll see ECH only enabled in bleeding edge stacks. In fact, ECH is still in IETF draft phase [1].<p>It can be disabled if an organisation wishes to. I wrote about how to do this in Chrome [2,3], and will write about Firefox when I get a chance.<p>[1] <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;draft-ietf-tls-esni&#x2F;" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;draft-ietf-tls-esni&#x2F;</a>
[2] <a href="https:&#x2F;&#x2F;chasersystems.com&#x2F;blog&#x2F;disabling-encrypted-clienthello-in-google-chrome-and-why&#x2F;" rel="nofollow">https:&#x2F;&#x2F;chasersystems.com&#x2F;blog&#x2F;disabling-encrypted-clienthel...</a>
[3] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37823262">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37823262</a></div><br/></div></div><div id="40943560" class="c"><input type="checkbox" id="c-40943560" checked=""/><div class="controls bullet"><span class="by">jcelerier</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40942983">parent</a><span>|</span><a href="#40943350">prev</a><span>|</span><a href="#40940675">next</a><span>|</span><label class="collapse" for="c-40943560">[-]</label><label class="expand" for="c-40943560">[2 more]</label></div><br/><div class="children"><div class="content">In which country is this ? In France the law is pretty clear :<p>&gt; L’employeur ne peut pas mettre en place un dispositif d’écoute ou d’enregistrement permanent ou systématique, sauf texte légal (par exemple pour les services d’urgence).<p>And there&#x27;s afaik no such legal text for banks.<p>Employees also have the right to privacy on their work-provided computer (e.g. to check their personal mails) so all those packet inspection and decryption things would be flat-out illegal there, thankfully</div><br/><div id="40943639" class="c"><input type="checkbox" id="c-40943639" checked=""/><div class="controls bullet"><span class="by">andylynch</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40943560">parent</a><span>|</span><a href="#40940675">next</a><span>|</span><label class="collapse" for="c-40943639">[-]</label><label class="expand" for="c-40943639">[1 more]</label></div><br/><div class="children"><div class="content">For regulated firms like the French one I’m at, checking personal email on work devices and the like is simply blocked.<p>If you want to check your private email, you can just use your personal device.</div><br/></div></div></div></div></div></div><div id="40940675" class="c"><input type="checkbox" id="c-40940675" checked=""/><div class="controls bullet"><span class="by">hawski</span><span>|</span><a href="#40940444">parent</a><span>|</span><a href="#40942983">prev</a><span>|</span><a href="#40940807">next</a><span>|</span><label class="collapse" for="c-40940675">[-]</label><label class="expand" for="c-40940675">[2 more]</label></div><br/><div class="children"><div class="content">Just today I thought about a hypothetical strace analog for web requests. Something that could trace all the HTTPS requests a program makes without playing around with certificates.</div><br/><div id="40942041" class="c"><input type="checkbox" id="c-40942041" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><a href="#40940444">root</a><span>|</span><a href="#40940675">parent</a><span>|</span><a href="#40940807">next</a><span>|</span><label class="collapse" for="c-40942041">[-]</label><label class="expand" for="c-40942041">[1 more]</label></div><br/><div class="children"><div class="content">You can already do this with eBPF.</div><br/></div></div></div></div></div></div><div id="40942791" class="c"><input type="checkbox" id="c-40942791" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#40940444">prev</a><span>|</span><a href="#40941591">next</a><span>|</span><label class="collapse" for="c-40942791">[-]</label><label class="expand" for="c-40942791">[3 more]</label></div><br/><div class="children"><div class="content">Similar tools already available in many distros:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;bpftrace&#x2F;bpftrace&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsnoop.bt">https:&#x2F;&#x2F;github.com&#x2F;bpftrace&#x2F;bpftrace&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsn...</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsniff.py">https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;sslsniff.py</a><p><a href="https:&#x2F;&#x2F;embracethered.com&#x2F;blog&#x2F;posts&#x2F;2021&#x2F;offensive-bpf-sniffing-traffic-bpftrace&#x2F;" rel="nofollow">https:&#x2F;&#x2F;embracethered.com&#x2F;blog&#x2F;posts&#x2F;2021&#x2F;offensive-bpf-snif...</a><p>On Ubuntu for example I can just &quot;sudo apt install bpfcc-tools&quot;, then run &quot;sudo sslsniff-bpfcc&quot; and see curl TLS traffic right away.</div><br/><div id="40942921" class="c"><input type="checkbox" id="c-40942921" checked=""/><div class="controls bullet"><span class="by">_3u10</span><span>|</span><a href="#40942791">parent</a><span>|</span><a href="#40941591">next</a><span>|</span><label class="collapse" for="c-40942921">[-]</label><label class="expand" for="c-40942921">[2 more]</label></div><br/><div class="children"><div class="content">Yes, but most of them don&#x27;t output pcap. Its just sort of every bit of decrypted data. Sure it works well for curl, but for nginx, or multiple connections, not so much.</div><br/><div id="40943344" class="c"><input type="checkbox" id="c-40943344" checked=""/><div class="controls bullet"><span class="by">danobi</span><span>|</span><a href="#40942791">root</a><span>|</span><a href="#40942921">parent</a><span>|</span><a href="#40941591">next</a><span>|</span><label class="collapse" for="c-40943344">[-]</label><label class="expand" for="c-40943344">[1 more]</label></div><br/><div class="children"><div class="content">bpftrace has support for outputting pcap files now.</div><br/></div></div></div></div></div></div><div id="40942911" class="c"><input type="checkbox" id="c-40942911" checked=""/><div class="controls bullet"><span class="by">_3u10</span><span>|</span><a href="#40941591">prev</a><span>|</span><a href="#40942630">next</a><span>|</span><label class="collapse" for="c-40942911">[-]</label><label class="expand" for="c-40942911">[1 more]</label></div><br/><div class="children"><div class="content">Not sure if this supports TLS3 &#x2F; perfect forward secrecy. If not lmk, I&#x27;ve written similar code to decrypt PFS in a pcap compatible way.<p>If you need k8s support I can also help with that, if you get CAP_SYS_ADMIN you can break out of the container and then back into every other container ;)</div><br/></div></div><div id="40942630" class="c"><input type="checkbox" id="c-40942630" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#40942911">prev</a><span>|</span><a href="#40941502">next</a><span>|</span><label class="collapse" for="c-40942630">[-]</label><label class="expand" for="c-40942630">[5 more]</label></div><br/><div class="children"><div class="content">Not sure why it mentions or needs eBPF or anything kernel-side; this is already possible with just OpenSSL&#x2F;etc. shim libraries.</div><br/><div id="40942816" class="c"><input type="checkbox" id="c-40942816" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#40942630">parent</a><span>|</span><a href="#40942724">next</a><span>|</span><label class="collapse" for="c-40942816">[-]</label><label class="expand" for="c-40942816">[1 more]</label></div><br/><div class="children"><div class="content">They mention golang, which uses static binaries, meaning you can&#x27;t LD_PRELOAD it.</div><br/></div></div><div id="40942724" class="c"><input type="checkbox" id="c-40942724" checked=""/><div class="controls bullet"><span class="by">Brybry</span><span>|</span><a href="#40942630">parent</a><span>|</span><a href="#40942816">prev</a><span>|</span><a href="#40942738">next</a><span>|</span><label class="collapse" for="c-40942724">[-]</label><label class="expand" for="c-40942724">[1 more]</label></div><br/><div class="children"><div class="content">Aren&#x27;t there cases where shim libraries&#x2F;LD_PRELOAD won&#x27;t work, like statically linked binaries?<p>So if this works there it might be useful in, for example, analyzing encrypted video traffic for some video games.</div><br/></div></div><div id="40942738" class="c"><input type="checkbox" id="c-40942738" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#40942630">parent</a><span>|</span><a href="#40942724">prev</a><span>|</span><a href="#40942742">next</a><span>|</span><label class="collapse" for="c-40942738">[-]</label><label class="expand" for="c-40942738">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t have to modify or restart any applications, it works globally and at runtime without interrupting existing processes.</div><br/></div></div></div></div><div id="40941502" class="c"><input type="checkbox" id="c-40941502" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#40942630">prev</a><span>|</span><a href="#40941493">next</a><span>|</span><label class="collapse" for="c-40941502">[-]</label><label class="expand" for="c-40941502">[2 more]</label></div><br/><div class="children"><div class="content">This is one of those things I think should be wrapped up and made more capable for the typical Linux user (so, more like a typical HN user I suppose).<p>Because IMO, what my PC is doing and sending over the network at all times <i>should</i> be inspectable <i>by me, on that computer</i>.</div><br/><div id="40941723" class="c"><input type="checkbox" id="c-40941723" checked=""/><div class="controls bullet"><span class="by">bigiain</span><span>|</span><a href="#40941502">parent</a><span>|</span><a href="#40941493">next</a><span>|</span><label class="collapse" for="c-40941723">[-]</label><label class="expand" for="c-40941723">[1 more]</label></div><br/><div class="children"><div class="content">Have you seen OpenSnitch? <a href="https:&#x2F;&#x2F;github.com&#x2F;evilsocket&#x2F;opensnitch">https:&#x2F;&#x2F;github.com&#x2F;evilsocket&#x2F;opensnitch</a><p>It&#x27;s a Linux project that&#x27;s replication what Little Snitch does on macOS - it doesn&#x27;t decrypt TLS secured data but it does show and allow blocking of network connections (even if it can&#x27;t see exactly what&#x27;s going on inside this connections).<p>Combining eCapture features with OpenSnitch would be awesome. It&#x27;d be great if as well as tracking all network connection, you could flag connections sending specific data (like your name, email address, or phone number) to unexpected servers.</div><br/></div></div></div></div><div id="40941493" class="c"><input type="checkbox" id="c-40941493" checked=""/><div class="controls bullet"><span class="by">the_clarence</span><span>|</span><a href="#40941502">prev</a><span>|</span><a href="#40939603">next</a><span>|</span><label class="collapse" for="c-40941493">[-]</label><label class="expand" for="c-40941493">[8 more]</label></div><br/><div class="children"><div class="content">What is the point of eBPF? It seems like it can really do anything</div><br/><div id="40941528" class="c"><input type="checkbox" id="c-40941528" checked=""/><div class="controls bullet"><span class="by">jfoutz</span><span>|</span><a href="#40941493">parent</a><span>|</span><a href="#40941961">next</a><span>|</span><label class="collapse" for="c-40941528">[-]</label><label class="expand" for="c-40941528">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve not used it in anger, so take it with a grain of salt.<p>it sorta gives you a kernel space VM. you can inspect the state of things, make decisions about that state, and react to those things.<p>for example, you could look at uri requests coming into your web server. if it&#x27;s not a known good path, reply back with a canned 400 - without ever hitting the web server. you can do this in the kernel.<p>_edit_ I think this particular trick would only work with http. the web server still has all the glue to decrypt the incoming request - but you could probably hook into ebpf at that point.</div><br/><div id="40941795" class="c"><input type="checkbox" id="c-40941795" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#40941493">root</a><span>|</span><a href="#40941528">parent</a><span>|</span><a href="#40941961">next</a><span>|</span><label class="collapse" for="c-40941795">[-]</label><label class="expand" for="c-40941795">[3 more]</label></div><br/><div class="children"><div class="content">Maybe you could do this with HTTPS if you’re using Kernel TLS offloading?</div><br/><div id="40943854" class="c"><input type="checkbox" id="c-40943854" checked=""/><div class="controls bullet"><span class="by">Arnavion</span><span>|</span><a href="#40941493">root</a><span>|</span><a href="#40941795">parent</a><span>|</span><a href="#40942024">next</a><span>|</span><label class="collapse" for="c-40943854">[-]</label><label class="expand" for="c-40943854">[1 more]</label></div><br/><div class="children"><div class="content">Yes, if the server uses kTLS, it&#x27;ll be easy for such a probe to get the plaintext, because the syscalls themselves will contain the plaintext. It won&#x27;t have to do TLS library-specific shenanigans to extract the key material like this submission does.</div><br/></div></div><div id="40942024" class="c"><input type="checkbox" id="c-40942024" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40941493">root</a><span>|</span><a href="#40941795">parent</a><span>|</span><a href="#40943854">prev</a><span>|</span><a href="#40941961">next</a><span>|</span><label class="collapse" for="c-40942024">[-]</label><label class="expand" for="c-40942024">[1 more]</label></div><br/><div class="children"><div class="content">You can instrument userland binaries with eBPF, so as long as you have probes built for the TLS library your target is using, you&#x27;re fine.</div><br/></div></div></div></div></div></div><div id="40941961" class="c"><input type="checkbox" id="c-40941961" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#40941493">parent</a><span>|</span><a href="#40941528">prev</a><span>|</span><a href="#40942994">next</a><span>|</span><label class="collapse" for="c-40941961">[-]</label><label class="expand" for="c-40941961">[2 more]</label></div><br/><div class="children"><div class="content">Deep instrumentation of running binaries, especially the kernel, and packet manipulation.</div><br/><div id="40942286" class="c"><input type="checkbox" id="c-40942286" checked=""/><div class="controls bullet"><span class="by">SEJeff</span><span>|</span><a href="#40941493">root</a><span>|</span><a href="#40941961">parent</a><span>|</span><a href="#40942994">next</a><span>|</span><label class="collapse" for="c-40942286">[-]</label><label class="expand" for="c-40942286">[1 more]</label></div><br/><div class="children"><div class="content">Let’s not forget syscall filtering. Using custom eBPF for what is in effect a syscall firewall is something my coworkers did for one of our clients and it’s really slick. It’s like super seccomp.</div><br/></div></div></div></div><div id="40942994" class="c"><input type="checkbox" id="c-40942994" checked=""/><div class="controls bullet"><span class="by">rocqua</span><span>|</span><a href="#40941493">parent</a><span>|</span><a href="#40941961">prev</a><span>|</span><a href="#40939603">next</a><span>|</span><label class="collapse" for="c-40942994">[-]</label><label class="expand" for="c-40942994">[1 more]</label></div><br/><div class="children"><div class="content">It is guaranteed to terminate execution, making it 
Possible to run in the Kernel without threat of an indefinite hang.</div><br/></div></div></div></div><div id="40940361" class="c"><input type="checkbox" id="c-40940361" checked=""/><div class="controls bullet"><span class="by">p1mrx</span><span>|</span><a href="#40939603">prev</a><span>|</span><a href="#40939712">next</a><span>|</span><label class="collapse" for="c-40940361">[-]</label><label class="expand" for="c-40940361">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Note: Need ROOT permission.</div><br/></div></div><div id="40939712" class="c"><input type="checkbox" id="c-40939712" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#40940361">prev</a><span>|</span><a href="#40940778">next</a><span>|</span><label class="collapse" for="c-40939712">[-]</label><label class="expand" for="c-40939712">[6 more]</label></div><br/><div class="children"><div class="content">2022 <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33826131">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33826131</a></div><br/><div id="40939786" class="c"><input type="checkbox" id="c-40939786" checked=""/><div class="controls bullet"><span class="by">walterbell</span><span>|</span><a href="#40939712">parent</a><span>|</span><a href="#40940175">next</a><span>|</span><label class="collapse" for="c-40939786">[-]</label><label class="expand" for="c-40939786">[1 more]</label></div><br/><div class="children"><div class="content">Latest release: 2024-07-09<p>changelog: <a href="https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture&#x2F;blob&#x2F;master&#x2F;CHANGELOG.md">https:&#x2F;&#x2F;github.com&#x2F;gojue&#x2F;ecapture&#x2F;blob&#x2F;master&#x2F;CHANGELOG.md</a></div><br/></div></div><div id="40940175" class="c"><input type="checkbox" id="c-40940175" checked=""/><div class="controls bullet"><span class="by">gtirloni</span><span>|</span><a href="#40939712">parent</a><span>|</span><a href="#40939786">prev</a><span>|</span><a href="#40940778">next</a><span>|</span><label class="collapse" for="c-40940175">[-]</label><label class="expand" for="c-40940175">[4 more]</label></div><br/><div class="children"><div class="content">nice one comment thread.</div><br/><div id="40940976" class="c"><input type="checkbox" id="c-40940976" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#40939712">root</a><span>|</span><a href="#40940175">parent</a><span>|</span><a href="#40940778">next</a><span>|</span><label class="collapse" for="c-40940976">[-]</label><label class="expand" for="c-40940976">[3 more]</label></div><br/><div class="children"><div class="content">Zero comment thread, since the only comment was the submitter.
That was my point.<p>I figured the reason it wasn&#x27;t interesting the first time was something like &quot;Are you telling me that a kernel, and anyone with root access to that kernel, can ultimately know everything a kernel does? Shocking!&quot;</div><br/><div id="40941722" class="c"><input type="checkbox" id="c-40941722" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#40939712">root</a><span>|</span><a href="#40940976">parent</a><span>|</span><a href="#40942124">next</a><span>|</span><label class="collapse" for="c-40941722">[-]</label><label class="expand" for="c-40941722">[1 more]</label></div><br/><div class="children"><div class="content">More likely I think, the reason it got no comments was that even great stuff only has about a 20% chance (or worse) of getting traction before it falls off.  I love HN, but I see a lot of great posts that never get their signal through the noise.</div><br/></div></div><div id="40942124" class="c"><input type="checkbox" id="c-40942124" checked=""/><div class="controls bullet"><span class="by">gtirloni</span><span>|</span><a href="#40939712">root</a><span>|</span><a href="#40940976">parent</a><span>|</span><a href="#40941722">prev</a><span>|</span><a href="#40940778">next</a><span>|</span><label class="collapse" for="c-40942124">[-]</label><label class="expand" for="c-40942124">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t look like they phrased it as being a vulnerability. It&#x27;s just a useful tool.</div><br/></div></div></div></div></div></div></div></div><div id="40940778" class="c"><input type="checkbox" id="c-40940778" checked=""/><div class="controls bullet"><span class="by">egberts1</span><span>|</span><a href="#40939712">prev</a><span>|</span><label class="collapse" for="c-40940778">[-]</label><label class="expand" for="c-40940778">[7 more]</label></div><br/><div class="children"><div class="content">Note to Linus: We have to be able to compile out this eBPF kernel config option, like completely.</div><br/><div id="40941024" class="c"><input type="checkbox" id="c-40941024" checked=""/><div class="controls bullet"><span class="by">A1kmm</span><span>|</span><a href="#40940778">parent</a><span>|</span><a href="#40940798">next</a><span>|</span><label class="collapse" for="c-40941024">[-]</label><label class="expand" for="c-40941024">[3 more]</label></div><br/><div class="children"><div class="content">Note that despite the headline, the feature actually used here is kprobe and uprobe (which use eBPF to collect data using eBPF every time an event, such as passing a certain point in code, is executed - allowing for hooking of functions and extraction of data). You can turn them off with CONFIG_KPROBE_EVENTS=n and CONFIG_UPROBE_EVENTS=n.<p>That said, there are other ways to do similar probing:
- Loading kernel modules.
- Using ptrace.
- Using LD_PRELOAD against a dynamic binary.</div><br/><div id="40941631" class="c"><input type="checkbox" id="c-40941631" checked=""/><div class="controls bullet"><span class="by">brendangregg</span><span>|</span><a href="#40940778">root</a><span>|</span><a href="#40941024">parent</a><span>|</span><a href="#40940798">next</a><span>|</span><label class="collapse" for="c-40941631">[-]</label><label class="expand" for="c-40941631">[2 more]</label></div><br/><div class="children"><div class="content">Right; disabling eBPF doesn&#x27;t solve this. And the bigger point is that this kind of eBPF is still super-user only.<p>Apart from the more exotic facilities, the critical facilities that would be hard to disable include LD_PRELOAD for interposers&#x2F;shims (as you mentioned), and gdb for just setting breakpoints on crypto functions. And if neither of those existed, then I may have to edit openssl code and recompile my own edited version. And if that wasn&#x27;t allowed (signed libraries) then maybe I&#x27;d edit the application code or binaries.</div><br/><div id="40941924" class="c"><input type="checkbox" id="c-40941924" checked=""/><div class="controls bullet"><span class="by">egberts1</span><span>|</span><a href="#40940778">root</a><span>|</span><a href="#40941631">parent</a><span>|</span><a href="#40940798">next</a><span>|</span><label class="collapse" for="c-40941924">[-]</label><label class="expand" for="c-40941924">[1 more]</label></div><br/><div class="children"><div class="content">Libmusl will drop your LD_PRELOAD nicely.<p>And modules can be compiled directly into a module-less kernel.</div><br/></div></div></div></div></div></div><div id="40940798" class="c"><input type="checkbox" id="c-40940798" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40940778">parent</a><span>|</span><a href="#40941024">prev</a><span>|</span><a href="#40940801">next</a><span>|</span><label class="collapse" for="c-40940798">[-]</label><label class="expand" for="c-40940798">[2 more]</label></div><br/><div class="children"><div class="content">I believe that&#x27;s CONFIG_BPF</div><br/><div id="40941917" class="c"><input type="checkbox" id="c-40941917" checked=""/><div class="controls bullet"><span class="by">egberts1</span><span>|</span><a href="#40940778">root</a><span>|</span><a href="#40940798">parent</a><span>|</span><a href="#40940801">next</a><span>|</span><label class="collapse" for="c-40941917">[-]</label><label class="expand" for="c-40941917">[1 more]</label></div><br/><div class="children"><div class="content">It gets flipped on under most settings if you try to disable it, notably by nftables.</div><br/></div></div></div></div><div id="40940801" class="c"><input type="checkbox" id="c-40940801" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#40940778">parent</a><span>|</span><a href="#40940798">prev</a><span>|</span><label class="collapse" for="c-40940801">[-]</label><label class="expand" for="c-40940801">[1 more]</label></div><br/><div class="children"><div class="content">If eBPF is disabled you can use other debugging facilities.</div><br/></div></div></div></div></div></div></div></div></div></body></html>