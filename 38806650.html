<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704013264123" as="style"/><link rel="stylesheet" href="styles.css?v=1704013264123"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.bleepingcomputer.com/news/security/malware-abuses-google-oauth-endpoint-to-revive-cookies-hijack-accounts/">Malware abuses Google OAuth endpoint to &#x27;revive&#x27; cookies, hijack accounts</a> <span class="domain">(<a href="https://www.bleepingcomputer.com">www.bleepingcomputer.com</a>)</span></div><div class="subtext"><span>schalkneethling</span> | <span>73 comments</span></div><br/><div><div id="38818627" class="c"><input type="checkbox" id="c-38818627" checked=""/><div class="controls bullet"><span class="by">elric</span><span>|</span><a href="#38818410">next</a><span>|</span><label class="collapse" for="c-38818627">[-]</label><label class="expand" for="c-38818627">[29 more]</label></div><br/><div class="children"><div class="content">Given how many times I&#x27;ve heard of people being locked out of their Google accounts, and are only able to regain access because they&#x27;re still logged in on some rarely used device, I imagine that Google would lose a bunch of users if they suddenly started to expire those cookies.</div><br/><div id="38818691" class="c"><input type="checkbox" id="c-38818691" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38818627">parent</a><span>|</span><a href="#38818682">next</a><span>|</span><label class="collapse" for="c-38818691">[-]</label><label class="expand" for="c-38818691">[13 more]</label></div><br/><div class="children"><div class="content">I deliberately keep around an old Android phone in the event disaster strikes there is a teeny chance that logged in device might save me.<p>If the Google machine decides to cull me, probably nothing I can do, but it costs me nothing to keep it sitting in a drawer.</div><br/><div id="38819925" class="c"><input type="checkbox" id="c-38819925" checked=""/><div class="controls bullet"><span class="by">Erratic6576</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38818691">parent</a><span>|</span><a href="#38820032">next</a><span>|</span><label class="collapse" for="c-38819925">[-]</label><label class="expand" for="c-38819925">[5 more]</label></div><br/><div class="children"><div class="content">Back in the 2000’s, we were dreaming of what would come next from Google. Then, in the 2010’s, we started to wonder what would be discontinued. Now, in 2020’s, we dread being locked out of Google accounts. I closed mine during the lockdown. My school cancelled my huge Cryptomator backup on Google. Now, work provides me with one but I can no longer rely on Google for anything crucial.</div><br/><div id="38821178" class="c"><input type="checkbox" id="c-38821178" checked=""/><div class="controls bullet"><span class="by">sircastor</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819925">parent</a><span>|</span><a href="#38820245">next</a><span>|</span><label class="collapse" for="c-38821178">[-]</label><label class="expand" for="c-38821178">[1 more]</label></div><br/><div class="children"><div class="content">I have been slowly migrating&#x2F;backing up everything related to my Google account. I’m just not confident that the ghost in the machine won’t decide randomly one day I’m not worthy of continued access.<p>In another light, it’s a reminder that Google doesn’t really think of these accounts as ours, but theirs.</div><br/></div></div><div id="38820245" class="c"><input type="checkbox" id="c-38820245" checked=""/><div class="controls bullet"><span class="by">ThatMedicIsASpy</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819925">parent</a><span>|</span><a href="#38821178">prev</a><span>|</span><a href="#38821965">next</a><span>|</span><label class="collapse" for="c-38820245">[-]</label><label class="expand" for="c-38820245">[1 more]</label></div><br/><div class="children"><div class="content">I moved away a while ago. The only thing I still use would be youtube playlists. But even those are trash since they just say we&#x27;ve removed some because of whatever. Thanks I guess I would like to know which song you threw away!<p>Now I pay 1€ a month for mail.</div><br/></div></div><div id="38821965" class="c"><input type="checkbox" id="c-38821965" checked=""/><div class="controls bullet"><span class="by">never_inline</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819925">parent</a><span>|</span><a href="#38820245">prev</a><span>|</span><a href="#38821613">next</a><span>|</span><label class="collapse" for="c-38821965">[-]</label><label class="expand" for="c-38821965">[1 more]</label></div><br/><div class="children"><div class="content">I am just following the High Availability principle and using both Microsoft and Google equivalents, with most data having a local copy anyway.</div><br/></div></div><div id="38821613" class="c"><input type="checkbox" id="c-38821613" checked=""/><div class="controls bullet"><span class="by">taneq</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819925">parent</a><span>|</span><a href="#38821965">prev</a><span>|</span><a href="#38820032">next</a><span>|</span><label class="collapse" for="c-38821613">[-]</label><label class="expand" for="c-38821613">[1 more]</label></div><br/><div class="children"><div class="content">A few years ago I started getting increasingly worried about my Gmail account being a single point of failure for basically my entire life. Along with Google’s evolution into an evil empire this prompted me to completely excise them from my life. It took a couple of years to transition all my less-used accounts to my new email but the peace of mind is worth it.</div><br/></div></div></div></div><div id="38820032" class="c"><input type="checkbox" id="c-38820032" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38818691">parent</a><span>|</span><a href="#38819925">prev</a><span>|</span><a href="#38821779">next</a><span>|</span><label class="collapse" for="c-38820032">[-]</label><label class="expand" for="c-38820032">[6 more]</label></div><br/><div class="children"><div class="content">Printing out backup codes [1] and keeping them with your important papers is probably a good idea too.<p>[1] <a href="https:&#x2F;&#x2F;support.google.com&#x2F;accounts&#x2F;answer&#x2F;1187538" rel="nofollow">https:&#x2F;&#x2F;support.google.com&#x2F;accounts&#x2F;answer&#x2F;1187538</a></div><br/><div id="38820226" class="c"><input type="checkbox" id="c-38820226" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820032">parent</a><span>|</span><a href="#38821779">next</a><span>|</span><label class="collapse" for="c-38820226">[-]</label><label class="expand" for="c-38820226">[5 more]</label></div><br/><div class="children"><div class="content">I do have the backup codes, though I read an anecdote from someone where Google refused to accept the backup code. Because of course they can do that.<p>Email is just so sticky, it is really hard to make the switch, but I know that it just takes some butterfly wings to upset the blackbox.</div><br/><div id="38820959" class="c"><input type="checkbox" id="c-38820959" checked=""/><div class="controls bullet"><span class="by">maccard</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820226">parent</a><span>|</span><a href="#38821779">next</a><span>|</span><label class="collapse" for="c-38820959">[-]</label><label class="expand" for="c-38820959">[4 more]</label></div><br/><div class="children"><div class="content">Can you share that anecdote? That seems absolutely wild to me and I&#x27;ve never even heard it suggested before your post</div><br/><div id="38821064" class="c"><input type="checkbox" id="c-38821064" checked=""/><div class="controls bullet"><span class="by">TheNewsIsHere</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820959">parent</a><span>|</span><a href="#38822475">next</a><span>|</span><label class="collapse" for="c-38821064">[-]</label><label class="expand" for="c-38821064">[2 more]</label></div><br/><div class="children"><div class="content">I am not the poster you replied to, but I’ve dealt with this in various forms.<p>For a number of close family members Google has variously refused to accept valid recovery emails, valid recovery codes, and valid backup phone numbers in order to regain account access.<p>Despite how ridiculous it is from a consistency and security perspective, your MFA- or backup contact- enrolled phone number with SMS is still essentially Google’s gold standard for determining rightful access to an account.<p>Their auth and password reset processes are constantly changing and they have several steps that are automatically adaptive.<p>The only foolproof ways I’m aware of to always retain access to your Google account is to enroll in Advanced Protection, and&#x2F;or to use a paid Google Workspace account.</div><br/><div id="38822111" class="c"><input type="checkbox" id="c-38822111" checked=""/><div class="controls bullet"><span class="by">throwaway290</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38821064">parent</a><span>|</span><a href="#38822475">next</a><span>|</span><label class="collapse" for="c-38822111">[-]</label><label class="expand" for="c-38822111">[1 more]</label></div><br/><div class="children"><div class="content">Recovery codes saved my ass a few times though.<p>Advanced protection is a good pointer. Seems like losing the hardware token device can be a disaster?<p>On the other hand giving a service money is dangerous. They would be making money from you which means stricter checks. I&#x27;m still semi banned on Github because they had my card with Russian billing address (for sponsoring) when Putler attacked Ukraine. Good I didn&#x27;t pay for anything Google.</div><br/></div></div></div></div><div id="38822475" class="c"><input type="checkbox" id="c-38822475" checked=""/><div class="controls bullet"><span class="by">numpad0</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820959">parent</a><span>|</span><a href="#38821064">prev</a><span>|</span><a href="#38821779">next</a><span>|</span><label class="collapse" for="c-38822475">[-]</label><label class="expand" for="c-38822475">[1 more]</label></div><br/><div class="children"><div class="content">ref: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=34441697">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=34441697</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="38818682" class="c"><input type="checkbox" id="c-38818682" checked=""/><div class="controls bullet"><span class="by">kevin_b_er</span><span>|</span><a href="#38818627">parent</a><span>|</span><a href="#38818691">prev</a><span>|</span><a href="#38822236">next</a><span>|</span><label class="collapse" for="c-38818682">[-]</label><label class="expand" for="c-38818682">[1 more]</label></div><br/><div class="children"><div class="content">They are already expired. That&#x27;s the problem.</div><br/></div></div><div id="38822236" class="c"><input type="checkbox" id="c-38822236" checked=""/><div class="controls bullet"><span class="by">JeffSnazz</span><span>|</span><a href="#38818627">parent</a><span>|</span><a href="#38818682">prev</a><span>|</span><a href="#38819434">next</a><span>|</span><label class="collapse" for="c-38822236">[-]</label><label class="expand" for="c-38822236">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  I imagine that Google would lose a bunch of users if they suddenly started to expire those cookies<p>lol</div><br/></div></div><div id="38819434" class="c"><input type="checkbox" id="c-38819434" checked=""/><div class="controls bullet"><span class="by">franga2000</span><span>|</span><a href="#38818627">parent</a><span>|</span><a href="#38822236">prev</a><span>|</span><a href="#38818410">next</a><span>|</span><label class="collapse" for="c-38819434">[-]</label><label class="expand" for="c-38819434">[13 more]</label></div><br/><div class="children"><div class="content">Could they just...stop locking us out of our accounts? For some reason, even knowing the password, being on a device+network combination I&#x27;ve used a dozen times before and entering a login code generated on an already-logged-in device still isn&#x27;t enough to prove my right to use the account these days...</div><br/><div id="38820371" class="c"><input type="checkbox" id="c-38820371" checked=""/><div class="controls bullet"><span class="by">akkartik</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819434">parent</a><span>|</span><a href="#38819637">next</a><span>|</span><label class="collapse" for="c-38820371">[-]</label><label class="expand" for="c-38820371">[7 more]</label></div><br/><div class="children"><div class="content">Just turn off MFA for Google. I did this during 2023 and started sleeping so much better at night.<p>(Curious how easy it was for me to forget that it&#x27;s something I can turn off, once I turned it on.)</div><br/><div id="38820406" class="c"><input type="checkbox" id="c-38820406" checked=""/><div class="controls bullet"><span class="by">franga2000</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820371">parent</a><span>|</span><a href="#38820522">next</a><span>|</span><label class="collapse" for="c-38820406">[-]</label><label class="expand" for="c-38820406">[5 more]</label></div><br/><div class="children"><div class="content">2FA wasn&#x27;t turned on for that particular account, Google just decided to &quot;double check&quot; one day.</div><br/><div id="38820938" class="c"><input type="checkbox" id="c-38820938" checked=""/><div class="controls bullet"><span class="by">firecall</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820406">parent</a><span>|</span><a href="#38820753">next</a><span>|</span><label class="collapse" for="c-38820938">[-]</label><label class="expand" for="c-38820938">[3 more]</label></div><br/><div class="children"><div class="content">Yep - even with 2FA off they still like to check.<p>I have a client who tries to share one Google &#x2F; Gmail Inbox account between users internationally and Google does not like that at all!<p>Google constantly requires verification for logins!</div><br/><div id="38821490" class="c"><input type="checkbox" id="c-38821490" checked=""/><div class="controls bullet"><span class="by">toomuchtodo</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820938">parent</a><span>|</span><a href="#38821150">next</a><span>|</span><label class="collapse" for="c-38821490">[-]</label><label class="expand" for="c-38821490">[1 more]</label></div><br/><div class="children"><div class="content">What happens if passkeys are created for the account on everyone’s workstation?</div><br/></div></div><div id="38821150" class="c"><input type="checkbox" id="c-38821150" checked=""/><div class="controls bullet"><span class="by">a_dabbler</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820938">parent</a><span>|</span><a href="#38821490">prev</a><span>|</span><a href="#38820753">next</a><span>|</span><label class="collapse" for="c-38821150">[-]</label><label class="expand" for="c-38821150">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like they should be doing automatic email forwarding or something instead</div><br/></div></div></div></div><div id="38820753" class="c"><input type="checkbox" id="c-38820753" checked=""/><div class="controls bullet"><span class="by">akkartik</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820406">parent</a><span>|</span><a href="#38820938">prev</a><span>|</span><a href="#38820522">next</a><span>|</span><label class="collapse" for="c-38820753">[-]</label><label class="expand" for="c-38820753">[1 more]</label></div><br/><div class="children"><div class="content">Oh interesting. I think I haven&#x27;t noticed this because I&#x27;m trying to disconnect from Google lately. These days I login on an incognito tab and log out when I&#x27;m done. But just with a password.</div><br/></div></div></div></div><div id="38820522" class="c"><input type="checkbox" id="c-38820522" checked=""/><div class="controls bullet"><span class="by">firebot</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820371">parent</a><span>|</span><a href="#38820406">prev</a><span>|</span><a href="#38819637">next</a><span>|</span><label class="collapse" for="c-38820522">[-]</label><label class="expand" for="c-38820522">[1 more]</label></div><br/><div class="children"><div class="content">Uhm. You can&#x27;t disable this shit.<p>It&#x27;s a weird problem. Can&#x27;t log in to my account from unknown mobile but works just fine on an unknown PC.<p>So frustrating.</div><br/></div></div></div></div><div id="38819637" class="c"><input type="checkbox" id="c-38819637" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819434">parent</a><span>|</span><a href="#38820371">prev</a><span>|</span><a href="#38821212">next</a><span>|</span><label class="collapse" for="c-38819637">[-]</label><label class="expand" for="c-38819637">[4 more]</label></div><br/><div class="children"><div class="content">I think there’s a functional bug with very early (2006) accounts due to MFA or something.<p>Good thing google has a high quality help desk to report bugs &#x2F;s</div><br/><div id="38820207" class="c"><input type="checkbox" id="c-38820207" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38819637">parent</a><span>|</span><a href="#38821212">next</a><span>|</span><label class="collapse" for="c-38820207">[-]</label><label class="expand" for="c-38820207">[3 more]</label></div><br/><div class="children"><div class="content">I think if they have ever seen your account password in any password dump&#x2F;leak (ie. if you reused the password elsewhere), then they effectively prevent password login.   You have to have another already-active session.<p>Makes sense really.</div><br/><div id="38820278" class="c"><input type="checkbox" id="c-38820278" checked=""/><div class="controls bullet"><span class="by">sodality2</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820207">parent</a><span>|</span><a href="#38822107">next</a><span>|</span><label class="collapse" for="c-38820278">[-]</label><label class="expand" for="c-38820278">[1 more]</label></div><br/><div class="children"><div class="content">It would make more sense to inform the user this, then enforce these checks until the user changes it.<p>Anecdotally, my Google account&#x27;s password has never been in any dump (password manager, very long random alphanumeric, changes every 6 months) and I too deal with these annoying prompts.</div><br/></div></div><div id="38822107" class="c"><input type="checkbox" id="c-38822107" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#38818627">root</a><span>|</span><a href="#38820207">parent</a><span>|</span><a href="#38820278">prev</a><span>|</span><a href="#38821212">next</a><span>|</span><label class="collapse" for="c-38822107">[-]</label><label class="expand" for="c-38822107">[1 more]</label></div><br/><div class="children"><div class="content">In my case, the workflow requires a recovery token which was sent to an email account I have access to, authenticating with the token results in a security error.<p>Despite having access to the password, the recovery email account <i>and</i> an active session, I could not activate a new session.<p>It didn’t make sense, not that it matters when google refused to have a help desk or meaningful way to report bugs.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38818410" class="c"><input type="checkbox" id="c-38818410" checked=""/><div class="controls bullet"><span class="by">tyoma</span><span>|</span><a href="#38818627">prev</a><span>|</span><a href="#38820120">next</a><span>|</span><label class="collapse" for="c-38818410">[-]</label><label class="expand" for="c-38818410">[25 more]</label></div><br/><div class="children"><div class="content">Seems bad that the cookies are still valid after password rotation.<p>Relatedly, is this another instance of HN serving as de-facto Google tech support&#x2F;customer service?</div><br/><div id="38819858" class="c"><input type="checkbox" id="c-38819858" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#38818410">parent</a><span>|</span><a href="#38818554">next</a><span>|</span><label class="collapse" for="c-38819858">[-]</label><label class="expand" for="c-38819858">[5 more]</label></div><br/><div class="children"><div class="content">Why?<p>Im all for terminating sessions if the user wants it, but there are valid reasons to change passwords without knowledge of a breach.<p>Fwiw, terminating old sessions can be pretty hard in SSO systems and similar, though.</div><br/><div id="38820052" class="c"><input type="checkbox" id="c-38820052" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819858">parent</a><span>|</span><a href="#38818554">next</a><span>|</span><label class="collapse" for="c-38820052">[-]</label><label class="expand" for="c-38820052">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s bad because when someone suspects unauthorized access to their account, the first thing anyone recommends is to change your password. If the old cookies keep working, changing your password doesn&#x27;t help.</div><br/><div id="38822177" class="c"><input type="checkbox" id="c-38822177" checked=""/><div class="controls bullet"><span class="by">Zamicol</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38820052">parent</a><span>|</span><a href="#38822100">next</a><span>|</span><label class="collapse" for="c-38822177">[-]</label><label class="expand" for="c-38822177">[1 more]</label></div><br/><div class="children"><div class="content">So that&#x27;s how they address the state issue.  They just ignore the problem!<p>I always wondered how they addressed the state problem of cookie bearer tokens.</div><br/></div></div><div id="38822100" class="c"><input type="checkbox" id="c-38822100" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38820052">parent</a><span>|</span><a href="#38822177">prev</a><span>|</span><a href="#38822228">next</a><span>|</span><label class="collapse" for="c-38822100">[-]</label><label class="expand" for="c-38822100">[1 more]</label></div><br/><div class="children"><div class="content">I agree - but it should be an option, rather than permanent.</div><br/></div></div><div id="38822228" class="c"><input type="checkbox" id="c-38822228" checked=""/><div class="controls bullet"><span class="by">uxp8u61q</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38820052">parent</a><span>|</span><a href="#38822100">prev</a><span>|</span><a href="#38818554">next</a><span>|</span><label class="collapse" for="c-38822228">[-]</label><label class="expand" for="c-38822228">[1 more]</label></div><br/><div class="children"><div class="content">The easy and widespread solution to this issue is simply to <i>ask</i> the user if they would like to log out their other devices when they change their password.</div><br/></div></div></div></div></div></div><div id="38818554" class="c"><input type="checkbox" id="c-38818554" checked=""/><div class="controls bullet"><span class="by">throwaway892238</span><span>|</span><a href="#38818410">parent</a><span>|</span><a href="#38819858">prev</a><span>|</span><a href="#38818628">next</a><span>|</span><label class="collapse" for="c-38818554">[-]</label><label class="expand" for="c-38818554">[15 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not just bad, it&#x27;s a fundamental failure of security. The effect is the same as a password that can&#x27;t be changed. It might still be possible for users to manually delete active sessions in some Google account management page, but nobody in the world would expect they&#x27;d need to do that after changing their password.</div><br/><div id="38819007" class="c"><input type="checkbox" id="c-38819007" checked=""/><div class="controls bullet"><span class="by">kevin_nisbet</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38818554">parent</a><span>|</span><a href="#38819652">next</a><span>|</span><label class="collapse" for="c-38819007">[-]</label><label class="expand" for="c-38819007">[13 more]</label></div><br/><div class="children"><div class="content">Yea, I equate it to part of security theater.<p>I worked on a product that rotated the TLS certificate frequently. And it actually showed up a number of times in questions from customers or vendor security questionnaires about whether we rotated the certificates and how that happened.<p>But what we were never asked was whether old certificates were cancelled... which in that system they were not. So it didn&#x27;t matter how many times we rotated our secrets, any old or leaked secret in a backup or elsewhere was still completely valid. But we had met the security theater that those rotations happened.<p>So I expect what you do, is that changing a password would cancel all sessions using that credential. But that&#x27;s kind of hard to do, so we&#x27;ll just leave that side buggy and untested, because we did the important part of the theater that said we can change passwords.</div><br/><div id="38819180" class="c"><input type="checkbox" id="c-38819180" checked=""/><div class="controls bullet"><span class="by">groestl</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819007">parent</a><span>|</span><a href="#38819481">next</a><span>|</span><label class="collapse" for="c-38819180">[-]</label><label class="expand" for="c-38819180">[11 more]</label></div><br/><div class="children"><div class="content">&gt; So it didn&#x27;t matter how many times we rotated our secrets<p>I&#x27;m confused, did you rotate your certs or your secrets?</div><br/><div id="38822191" class="c"><input type="checkbox" id="c-38822191" checked=""/><div class="controls bullet"><span class="by">kevin_nisbet</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819180">parent</a><span>|</span><a href="#38819506">next</a><span>|</span><label class="collapse" for="c-38822191">[-]</label><label class="expand" for="c-38822191">[1 more]</label></div><br/><div class="children"><div class="content">Sorry about the imprecise language, this system rotated both together.</div><br/></div></div><div id="38819506" class="c"><input type="checkbox" id="c-38819506" checked=""/><div class="controls bullet"><span class="by">franga2000</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819180">parent</a><span>|</span><a href="#38822191">prev</a><span>|</span><a href="#38819462">next</a><span>|</span><label class="collapse" for="c-38819506">[-]</label><label class="expand" for="c-38819506">[4 more]</label></div><br/><div class="children"><div class="content">Can you do one without the other? The public key is derived from the secret&#x2F;private key, so changing one means also changing the other...</div><br/><div id="38819572" class="c"><input type="checkbox" id="c-38819572" checked=""/><div class="controls bullet"><span class="by">groestl</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819506">parent</a><span>|</span><a href="#38819462">next</a><span>|</span><label class="collapse" for="c-38819572">[-]</label><label class="expand" for="c-38819572">[3 more]</label></div><br/><div class="children"><div class="content">But a (public key) certificate is not a public key. A cert is a public key A (to private key a), signed by another key b, of which public key B is known. To rotate a cert means resigning the public key A (which is still derived from the same private key a).<p>Edit: relevant, especially flow2k&#x27;s answer, which explains why this is _not_ just security theater <a href="https:&#x2F;&#x2F;security.stackexchange.com&#x2F;questions&#x2F;85963&#x2F;what-is-the-purpose-of-frequently-rotating-tls-certificates-without-changing-und" rel="nofollow">https:&#x2F;&#x2F;security.stackexchange.com&#x2F;questions&#x2F;85963&#x2F;what-is-t...</a></div><br/><div id="38819899" class="c"><input type="checkbox" id="c-38819899" checked=""/><div class="controls bullet"><span class="by">franga2000</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819572">parent</a><span>|</span><a href="#38819462">next</a><span>|</span><label class="collapse" for="c-38819899">[-]</label><label class="expand" for="c-38819899">[2 more]</label></div><br/><div class="children"><div class="content">Ah, so basically just renewing before it&#x27;s due, that makes sense. For some reason it didn&#x27;t occur to me that rotate could mean that too.<p>This does still leave the problem of the old certs being valid though. This only makes sense as a security practice if the certs are short-lived, which theirs apparently weren&#x27;t. If the certs live much longer than the rotation window, this really is just security theatre.<p>I do think thaumasiotes has a point and GP&#x27;s company probably misinterpreted the rotation requirements and short lifespans were implied in the requirement.</div><br/><div id="38819979" class="c"><input type="checkbox" id="c-38819979" checked=""/><div class="controls bullet"><span class="by">groestl</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819899">parent</a><span>|</span><a href="#38819462">next</a><span>|</span><label class="collapse" for="c-38819979">[-]</label><label class="expand" for="c-38819979">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If the certs live much longer than the rotation window, this really is just security theatre.<p>That&#x27;s very true.<p>&gt; and GP&#x27;s company probably misinterpreted the rotation requirements and short lifespans were implied in the requirement.<p>Or GP didn&#x27;t know that the company was indeed using short expiration times, and somehow confused it with certificate revocation (called &quot;cancelled&quot; in the post).</div><br/></div></div></div></div></div></div></div></div><div id="38819462" class="c"><input type="checkbox" id="c-38819462" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819180">parent</a><span>|</span><a href="#38819506">prev</a><span>|</span><a href="#38819481">next</a><span>|</span><label class="collapse" for="c-38819462">[-]</label><label class="expand" for="c-38819462">[5 more]</label></div><br/><div class="children"><div class="content">The private key of a cert is a secret that is not reused between certs.</div><br/><div id="38819740" class="c"><input type="checkbox" id="c-38819740" checked=""/><div class="controls bullet"><span class="by">comprambler</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819462">parent</a><span>|</span><a href="#38819534">next</a><span>|</span><label class="collapse" for="c-38819740">[-]</label><label class="expand" for="c-38819740">[3 more]</label></div><br/><div class="children"><div class="content">The private key is definitely reused between certs unless you go through a process of rekeying which requires a new CSR.</div><br/><div id="38820138" class="c"><input type="checkbox" id="c-38820138" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819740">parent</a><span>|</span><a href="#38819534">next</a><span>|</span><label class="collapse" for="c-38820138">[-]</label><label class="expand" for="c-38820138">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s technically possible to reuse it, but letsencrypt &#x2F; certbot do not reuse it by default. You have to go out of your way and do extra work to reuse a CSR when renewing a cert.</div><br/><div id="38820771" class="c"><input type="checkbox" id="c-38820771" checked=""/><div class="controls bullet"><span class="by">woodruffw</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38820138">parent</a><span>|</span><a href="#38819534">next</a><span>|</span><label class="collapse" for="c-38820771">[-]</label><label class="expand" for="c-38820771">[1 more]</label></div><br/><div class="children"><div class="content">The original poster didn&#x27;t mention LE or anything else that uses ACME. It&#x27;s pretty easy to reuse a key in a bespoke PKI setup; the X.509 builder APIs that I&#x27;ve used make it trivial. Which doesn&#x27;t make it a good idea, of course.</div><br/></div></div></div></div></div></div><div id="38819534" class="c"><input type="checkbox" id="c-38819534" checked=""/><div class="controls bullet"><span class="by">groestl</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819462">parent</a><span>|</span><a href="#38819740">prev</a><span>|</span><a href="#38819481">next</a><span>|</span><label class="collapse" for="c-38819534">[-]</label><label class="expand" for="c-38819534">[1 more]</label></div><br/><div class="children"><div class="content">Says who?</div><br/></div></div></div></div></div></div><div id="38819481" class="c"><input type="checkbox" id="c-38819481" checked=""/><div class="controls bullet"><span class="by">thaumasiotes</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38819007">parent</a><span>|</span><a href="#38819180">prev</a><span>|</span><a href="#38819652">next</a><span>|</span><label class="collapse" for="c-38819481">[-]</label><label class="expand" for="c-38819481">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But what we were never asked was whether old certificates were cancelled... which in that system they were not. So it didn&#x27;t matter how many times we rotated our secrets, any old or leaked secret in a backup or elsewhere was still completely valid. But we had met the security theater that those rotations happened.<p>Huh? You haven&#x27;t &quot;rotated&quot; your credentials until the old ones are invalidated. Adding new credentials isn&#x27;t a rotation.</div><br/></div></div></div></div><div id="38819652" class="c"><input type="checkbox" id="c-38819652" checked=""/><div class="controls bullet"><span class="by">hanniabu</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38818554">parent</a><span>|</span><a href="#38819007">prev</a><span>|</span><a href="#38818628">next</a><span>|</span><label class="collapse" for="c-38819652">[-]</label><label class="expand" for="c-38819652">[1 more]</label></div><br/><div class="children"><div class="content">After you change your password I think there&#x27;s a setting you can use to kick off existing connections</div><br/></div></div></div></div><div id="38818628" class="c"><input type="checkbox" id="c-38818628" checked=""/><div class="controls bullet"><span class="by">wannacboatmovie</span><span>|</span><a href="#38818410">parent</a><span>|</span><a href="#38818554">prev</a><span>|</span><a href="#38820120">next</a><span>|</span><label class="collapse" for="c-38818628">[-]</label><label class="expand" for="c-38818628">[4 more]</label></div><br/><div class="children"><div class="content">You act as if it&#x27;s a bug, not an intentional feature - so Google can continue to track you in perpetuity.</div><br/><div id="38818903" class="c"><input type="checkbox" id="c-38818903" checked=""/><div class="controls bullet"><span class="by">kevin_nisbet</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38818628">parent</a><span>|</span><a href="#38820120">next</a><span>|</span><label class="collapse" for="c-38818903">[-]</label><label class="expand" for="c-38818903">[3 more]</label></div><br/><div class="children"><div class="content">I doubt google needs to use this as a feature for tracking.<p>Even if we argued that this was for tracking purposes, google could keep the cookie for tracking and just deny access to the services until a login flow was completed.</div><br/><div id="38820035" class="c"><input type="checkbox" id="c-38820035" checked=""/><div class="controls bullet"><span class="by">ksjskskskkk</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38818903">parent</a><span>|</span><a href="#38820120">next</a><span>|</span><label class="collapse" for="c-38820035">[-]</label><label class="expand" for="c-38820035">[2 more]</label></div><br/><div class="children"><div class="content">loging in serves as giving them authorization to track you under jurisdiction where they cannot just track you by any means available</div><br/><div id="38820178" class="c"><input type="checkbox" id="c-38820178" checked=""/><div class="controls bullet"><span class="by">tekla</span><span>|</span><a href="#38818410">root</a><span>|</span><a href="#38820035">parent</a><span>|</span><a href="#38820120">next</a><span>|</span><label class="collapse" for="c-38820178">[-]</label><label class="expand" for="c-38820178">[1 more]</label></div><br/><div class="children"><div class="content">Give evidence.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38820120" class="c"><input type="checkbox" id="c-38820120" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#38818410">prev</a><span>|</span><a href="#38820553">next</a><span>|</span><label class="collapse" for="c-38820120">[-]</label><label class="expand" for="c-38820120">[1 more]</label></div><br/><div class="children"><div class="content">This is doubly bad for Google Cloud, as you can&#x27;t use it without Google accounts.  I&#x27;m not sure if it makes sense to remove Sign in with Google yet, though I&#x27;m not sure how much I can trust Google for delegating user auth now...</div><br/></div></div><div id="38820553" class="c"><input type="checkbox" id="c-38820553" checked=""/><div class="controls bullet"><span class="by">motohagiography</span><span>|</span><a href="#38820120">prev</a><span>|</span><a href="#38818356">next</a><span>|</span><label class="collapse" for="c-38820553">[-]</label><label class="expand" for="c-38820553">[3 more]</label></div><br/><div class="children"><div class="content">Interpreting that the basic problem is limited to a propriatary OAuth2 extension feature of Chrome designed by google to support google services.<p>It sounds related to an OAuth2 footgun around applying the expiry to refresh_tokens in addition to the access_token, which has an explicit expiry. Whereas the refresh_token expiry is only implied as something less than the access_token - if any.</div><br/><div id="38821287" class="c"><input type="checkbox" id="c-38821287" checked=""/><div class="controls bullet"><span class="by">samarthr1</span><span>|</span><a href="#38820553">parent</a><span>|</span><a href="#38818356">next</a><span>|</span><label class="collapse" for="c-38821287">[-]</label><label class="expand" for="c-38821287">[2 more]</label></div><br/><div class="children"><div class="content">Is it not the inverse? (With a refresh token lasting longer than the access token?</div><br/><div id="38821420" class="c"><input type="checkbox" id="c-38821420" checked=""/><div class="controls bullet"><span class="by">motohagiography</span><span>|</span><a href="#38820553">root</a><span>|</span><a href="#38821287">parent</a><span>|</span><a href="#38818356">next</a><span>|</span><label class="collapse" for="c-38821420">[-]</label><label class="expand" for="c-38821420">[1 more]</label></div><br/><div class="children"><div class="content">A possible problem would be the refresh lasting longer than the access and remaining unexpired, instead of expiring at the same time - but tbh it&#x27;s unclear to me whether it is <i>the</i> problem as described.</div><br/></div></div></div></div></div></div><div id="38818356" class="c"><input type="checkbox" id="c-38818356" checked=""/><div class="controls bullet"><span class="by">rolph</span><span>|</span><a href="#38820553">prev</a><span>|</span><a href="#38821228">next</a><span>|</span><label class="collapse" for="c-38818356">[-]</label><label class="expand" for="c-38818356">[2 more]</label></div><br/><div class="children"><div class="content">zombie session cookies<p><a href="https:&#x2F;&#x2F;www.infostealers.com&#x2F;article&#x2F;lumma-malware-can-allegedly-restore-expired-google-auth-cookies&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.infostealers.com&#x2F;article&#x2F;lumma-malware-can-alleg...</a></div><br/><div id="38819438" class="c"><input type="checkbox" id="c-38819438" checked=""/><div class="controls bullet"><span class="by">ThePowerOfFuet</span><span>|</span><a href="#38818356">parent</a><span>|</span><a href="#38821228">next</a><span>|</span><label class="collapse" for="c-38819438">[-]</label><label class="expand" for="c-38819438">[1 more]</label></div><br/><div class="children"><div class="content">Straight to the source:<p><a href="https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;malware-dev-says-they-can-revive-expired-google-auth-cookies&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;malware-dev-s...</a></div><br/></div></div></div></div><div id="38821228" class="c"><input type="checkbox" id="c-38821228" checked=""/><div class="controls bullet"><span class="by">shadowgovt</span><span>|</span><a href="#38818356">prev</a><span>|</span><a href="#38818681">next</a><span>|</span><label class="collapse" for="c-38821228">[-]</label><label class="expand" for="c-38821228">[1 more]</label></div><br/><div class="children"><div class="content">Multilogin continues to be the gift that keeps on giving for Google.<p>Google engineers weren&#x27;t keen to implement the feature in the first place, and it&#x27;s been kind of an unlimited well of headaches, confusion, and user issues ever since.</div><br/></div></div><div id="38818681" class="c"><input type="checkbox" id="c-38818681" checked=""/><div class="controls bullet"><span class="by">rezonant</span><span>|</span><a href="#38821228">prev</a><span>|</span><a href="#38818468">next</a><span>|</span><label class="collapse" for="c-38818681">[-]</label><label class="expand" for="c-38818681">[8 more]</label></div><br/><div class="children"><div class="content">X for Doubt. There&#x27;s almost no details that are useful in this article, and in this case, the authors indicating Google isn&#x27;t doing anything about it is likely because this isn&#x27;t actually true.<p>Of course maybe I&#x27;m wrong but short of some more compelling technical details (reply a link if there&#x27;s a better source), I&#x27;m inclined to doubt the characterization of this article.<p>EDIT: Sibling linked <a href="https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;malware-abuses-google-oauth-endpoint-to-revive-cookies-hijack-accounts&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.bleepingcomputer.com&#x2F;news&#x2F;security&#x2F;malware-abuse...</a> which is more technical.</div><br/><div id="38819508" class="c"><input type="checkbox" id="c-38819508" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#38818681">parent</a><span>|</span><a href="#38818697">next</a><span>|</span><label class="collapse" for="c-38819508">[-]</label><label class="expand" for="c-38819508">[6 more]</label></div><br/><div class="children"><div class="content">I generally believe it. Google&#x27;s security team has been lax on cookie security. I reported an issue earlier this year about non-expiring session cookies; they said it was previously reported in 2019. The bug remains [1]. Sadly other Google projects use this code...<p>Historically they&#x27;ve been quick to patch things I&#x27;ve reported, so it feels like a decline.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;googleapis&#x2F;nodejs-firestore-session&#x2F;issues&#x2F;63#issuecomment-1684098874">https:&#x2F;&#x2F;github.com&#x2F;googleapis&#x2F;nodejs-firestore-session&#x2F;issue...</a></div><br/><div id="38820132" class="c"><input type="checkbox" id="c-38820132" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#38818681">root</a><span>|</span><a href="#38819508">parent</a><span>|</span><a href="#38818697">next</a><span>|</span><label class="collapse" for="c-38820132">[-]</label><label class="expand" for="c-38820132">[5 more]</label></div><br/><div class="children"><div class="content">Am I the only one who <i>wants</i> non-expiring sessions.<p>My browser cookie store ought to be a good place to store secrets.  On Linux it is protected by the user keyring.  I believe on windows it is protected by the system secret store which is eventually secured by the user logon password and the TPM.<p>So why not just let my cookies survive until I explicitly invalidate them by clearing my cookie store, hitting logout, or by changing my account password?<p>From a security perspective, someone who breaks into my cookie store has access to pretty much any website I use, whether the validity is 1 week or 1 century.   Any prepared attacker can take full control of the account in a matter of minutes, so the validity doesn&#x27;t make much of a difference.</div><br/><div id="38820366" class="c"><input type="checkbox" id="c-38820366" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#38818681">root</a><span>|</span><a href="#38820132">parent</a><span>|</span><a href="#38821060">next</a><span>|</span><label class="collapse" for="c-38820366">[-]</label><label class="expand" for="c-38820366">[1 more]</label></div><br/><div class="children"><div class="content">I worry about a couple things. Many apps don&#x27;t end <i>other</i> sessions when you log out or change passwords. My example above doesn&#x27;t handle that.<p>Poorly written backends only check if a user is active during login. So a lingering session remains usable. Imagine an employee is fired, they are angry, their accounts is disabled, but they still have access. In some rare cases sessions for deleted users still work.<p>You&#x27;ll see this most often with apps that rely on client side cookie expiration as sessions appear to expire, but they don&#x27;t.<p>Personally, I want short sessions on things like my bank account. For stuff like HN, long is great.</div><br/></div></div><div id="38821060" class="c"><input type="checkbox" id="c-38821060" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#38818681">root</a><span>|</span><a href="#38820132">parent</a><span>|</span><a href="#38820366">prev</a><span>|</span><a href="#38820679">next</a><span>|</span><label class="collapse" for="c-38821060">[-]</label><label class="expand" for="c-38821060">[1 more]</label></div><br/><div class="children"><div class="content">Keeping sessions alive is useful, but there are lots of ways to improve security without losing much convenience.<p>Sessions shouldn&#x27;t live longer on the server than on the client, that&#x27;s just silly.<p>The cookie associated with a session should be updated with moderate frequency, and old cookies should be invalidated.<p>If a particular client doesn&#x27;t connect for long enough, it should probably have its session revoked.</div><br/></div></div><div id="38820679" class="c"><input type="checkbox" id="c-38820679" checked=""/><div class="controls bullet"><span class="by">SpaghettiCthulu</span><span>|</span><a href="#38818681">root</a><span>|</span><a href="#38820132">parent</a><span>|</span><a href="#38821060">prev</a><span>|</span><a href="#38820188">next</a><span>|</span><label class="collapse" for="c-38820679">[-]</label><label class="expand" for="c-38820679">[1 more]</label></div><br/><div class="children"><div class="content">The problem here is that the cookies don&#x27;t expire even after changing the account password. The account owner must manually end each session from the accounts.google.com page.</div><br/></div></div><div id="38820188" class="c"><input type="checkbox" id="c-38820188" checked=""/><div class="controls bullet"><span class="by">lightedman</span><span>|</span><a href="#38818681">root</a><span>|</span><a href="#38820132">parent</a><span>|</span><a href="#38820679">prev</a><span>|</span><a href="#38818697">next</a><span>|</span><label class="collapse" for="c-38820188">[-]</label><label class="expand" for="c-38820188">[1 more]</label></div><br/><div class="children"><div class="content">Are you checking every token and cookie yourself to make sure they haven&#x27;t been hijacked?</div><br/></div></div></div></div></div></div></div></div><div id="38820794" class="c"><input type="checkbox" id="c-38820794" checked=""/><div class="controls bullet"><span class="by">Sparkyte</span><span>|</span><a href="#38818468">prev</a><span>|</span><label class="collapse" for="c-38820794">[-]</label><label class="expand" for="c-38820794">[1 more]</label></div><br/><div class="children"><div class="content">Yikes!<p>My life has always told me nothing is secure.</div><br/></div></div></div></div></div></div></div></body></html>