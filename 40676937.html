<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1718355654680" as="style"/><link rel="stylesheet" href="styles.css?v=1718355654680"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://discourse.nixos.org/t/brew-nix-a-flake-automatically-packaging-all-homebrew-casks/44880">Brew-Nix: a flake automatically packaging all homebrew casks</a> <span class="domain">(<a href="https://discourse.nixos.org">discourse.nixos.org</a>)</span></div><div class="subtext"><span>KolenCh</span> | <span>18 comments</span></div><br/><div><div id="40677085" class="c"><input type="checkbox" id="c-40677085" checked=""/><div class="controls bullet"><span class="by">madmax96</span><span>|</span><a href="#40677221">next</a><span>|</span><label class="collapse" for="c-40677085">[-]</label><label class="expand" for="c-40677085">[2 more]</label></div><br/><div class="children"><div class="content">I love nix on macOS. But one word of caution: nix uses a very outdated, EOL’d, macOS SDK (<a href="https:&#x2F;&#x2F;github.com&#x2F;NixOS&#x2F;nixpkgs&#x2F;issues&#x2F;101229">https:&#x2F;&#x2F;github.com&#x2F;NixOS&#x2F;nixpkgs&#x2F;issues&#x2F;101229</a>).</div><br/><div id="40677376" class="c"><input type="checkbox" id="c-40677376" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#40677085">parent</a><span>|</span><a href="#40677221">next</a><span>|</span><label class="collapse" for="c-40677376">[-]</label><label class="expand" for="c-40677376">[1 more]</label></div><br/><div class="children"><div class="content">In practice, it&#x27;s not that restricting. It&#x27;s pretty rare to find something actually requiring a more recent version. (And there&#x27;s slow progress in updating it)</div><br/></div></div></div></div><div id="40677221" class="c"><input type="checkbox" id="c-40677221" checked=""/><div class="controls bullet"><span class="by">aliasxneo</span><span>|</span><a href="#40677085">prev</a><span>|</span><a href="#40677025">next</a><span>|</span><label class="collapse" for="c-40677221">[-]</label><label class="expand" for="c-40677221">[1 more]</label></div><br/><div class="children"><div class="content">I always have brew available because I inevitably run into issues with Nix packages (primarily managed by home-manager) on a pretty regular basis. Feels like I would be going in the opposite direction by wrapping them in Nix.</div><br/></div></div><div id="40677025" class="c"><input type="checkbox" id="c-40677025" checked=""/><div class="controls bullet"><span class="by">loveparade</span><span>|</span><a href="#40677221">prev</a><span>|</span><a href="#40677726">next</a><span>|</span><label class="collapse" for="c-40677025">[-]</label><label class="expand" for="c-40677025">[11 more]</label></div><br/><div class="children"><div class="content">This looks interesting. Personally I have been moving away from homebrew and use nix-darwin (<a href="https:&#x2F;&#x2F;github.com&#x2F;LnL7&#x2F;nix-darwin">https:&#x2F;&#x2F;github.com&#x2F;LnL7&#x2F;nix-darwin</a>) with home-manager for my local software. It has been working great, but there are still a few packages that require Homebrew due to their complex build process. Maybe this helps.</div><br/><div id="40677042" class="c"><input type="checkbox" id="c-40677042" checked=""/><div class="controls bullet"><span class="by">conradev</span><span>|</span><a href="#40677025">parent</a><span>|</span><a href="#40677142">next</a><span>|</span><label class="collapse" for="c-40677042">[-]</label><label class="expand" for="c-40677042">[5 more]</label></div><br/><div class="children"><div class="content">Same. The story with app bundles in Nix is a little rough, currently, though:<p>- Located in the nix store, so not indexed by Spotlight<p>- Not signed so I have to grant permissions all over again when an app gets rebuilt</div><br/><div id="40677126" class="c"><input type="checkbox" id="c-40677126" checked=""/><div class="controls bullet"><span class="by">nothrabannosir</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677042">parent</a><span>|</span><a href="#40677076">next</a><span>|</span><label class="collapse" for="c-40677126">[-]</label><label class="expand" for="c-40677126">[1 more]</label></div><br/><div class="children"><div class="content">I actually wrote a script which creates a trampoline launcher for this. It has its flaws but it solves the spotlight issue, and supports pinning to Dock across updates.<p>Available as a plug-and-play module for nix-darwin and home-manager: <a href="https:&#x2F;&#x2F;github.com&#x2F;hraban&#x2F;mac-app-util">https:&#x2F;&#x2F;github.com&#x2F;hraban&#x2F;mac-app-util</a></div><br/></div></div><div id="40677076" class="c"><input type="checkbox" id="c-40677076" checked=""/><div class="controls bullet"><span class="by">mbrumlow</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677042">parent</a><span>|</span><a href="#40677126">prev</a><span>|</span><a href="#40677088">next</a><span>|</span><label class="collapse" for="c-40677076">[-]</label><label class="expand" for="c-40677076">[1 more]</label></div><br/><div class="children"><div class="content">I have a post hook that renders a Automator app to Applications to call the next one for me.  Seems to work well for the few apps I use like that.</div><br/></div></div><div id="40677088" class="c"><input type="checkbox" id="c-40677088" checked=""/><div class="controls bullet"><span class="by">loveparade</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677042">parent</a><span>|</span><a href="#40677076">prev</a><span>|</span><a href="#40677142">next</a><span>|</span><label class="collapse" for="c-40677088">[-]</label><label class="expand" for="c-40677088">[2 more]</label></div><br/><div class="children"><div class="content">Instead of Spotlight I use Raycast. It has been working great for me.</div><br/><div id="40677522" class="c"><input type="checkbox" id="c-40677522" checked=""/><div class="controls bullet"><span class="by">tymscar</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677088">parent</a><span>|</span><a href="#40677142">next</a><span>|</span><label class="collapse" for="c-40677522">[-]</label><label class="expand" for="c-40677522">[1 more]</label></div><br/><div class="children"><div class="content">I also do that, but when I search for emacs for example I get like 2-3 different ones and they are named as the full path in the nix store. That sometimes goes away after some time with indexing, but sometimes it does not.
And another annoying issue is that sometimes even when theres only one, its called by the path, and Im not a wizard so I don’t know if that path is the latest, so I am still using outdated software because its not launching the newest version.<p>Did you have any of these issues?</div><br/></div></div></div></div></div></div><div id="40677142" class="c"><input type="checkbox" id="c-40677142" checked=""/><div class="controls bullet"><span class="by">parhamn</span><span>|</span><a href="#40677025">parent</a><span>|</span><a href="#40677042">prev</a><span>|</span><a href="#40677726">next</a><span>|</span><label class="collapse" for="c-40677142">[-]</label><label class="expand" for="c-40677142">[5 more]</label></div><br/><div class="children"><div class="content">Mind sharing some reasons to switch? Been meaning to check out nix.</div><br/><div id="40677279" class="c"><input type="checkbox" id="c-40677279" checked=""/><div class="controls bullet"><span class="by">loveparade</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677142">parent</a><span>|</span><a href="#40678110">next</a><span>|</span><label class="collapse" for="c-40677279">[-]</label><label class="expand" for="c-40677279">[2 more]</label></div><br/><div class="children"><div class="content">Here are a couple:<p>- Learn Nix<p>- Homebrew can be a pain. I&#x27;ve had several occasions where it broke something on my system with its magic. The main reason for this is its imperative (as opposed to declarative) nature. You can easily install things that clash with other software installed on your system.<p>- You can easily install different versions of the same software without having to worry about clashes<p>- Fully declarative configuration. You know exactly what is installed on your system at any time.<p>- Portable reproducible configuration. Imagine you get a new laptop. Because you have have your system configuration declared with nix and home-manager you can copy the configuration file, run install, and your system is set up, exactly the way the old one was.<p>- To add to the above, you can also do the same with non-MacOS systems if you make your config conditional on MacOS. I sometimes want to work on a remote Linux machine. I can set up a full dev environment with all the tools I use locally with a single command now.</div><br/><div id="40678105" class="c"><input type="checkbox" id="c-40678105" checked=""/><div class="controls bullet"><span class="by">mikemcquaid</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677279">parent</a><span>|</span><a href="#40678110">next</a><span>|</span><label class="collapse" for="c-40678105">[-]</label><label class="expand" for="c-40678105">[1 more]</label></div><br/><div class="children"><div class="content">If you want a more declarative approach to Homebrew: ‘brew bundle’ uses ‘Brewfile’s for this. You can share these on macOS and Linux and add similar conditionals.<p>Not nearly as reproducible but: this is something I’m working on. Stay tuned…</div><br/></div></div></div></div><div id="40678110" class="c"><input type="checkbox" id="c-40678110" checked=""/><div class="controls bullet"><span class="by">tripdout</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677142">parent</a><span>|</span><a href="#40677279">prev</a><span>|</span><a href="#40677205">next</a><span>|</span><label class="collapse" for="c-40678110">[-]</label><label class="expand" for="c-40678110">[1 more]</label></div><br/><div class="children"><div class="content">I use Linux at home but when I got my work MacBook I was able to get an identical setup (shell aliases, git config, shell plugins, nvim, etc etc) with very minimal effort and not needing to understand a macOS way of installing all these programs like with e.g. homebrew.<p>Declarative, reproducible, and no fiddling with macOS specific stuff.<p>Plus, we had instructions in our wiki for dealing with homebrew package installation failures and conflicts with macOS-installed versions of required software, needing to install other programs like Ruby version manager, etc to fix these issues. but with Nix I just setup a devshell and got the exact version we needed installed with no issues.<p>And this can be pinned and reproduced for every developer using Nix, eliminating the hassle for everyone.</div><br/></div></div><div id="40677205" class="c"><input type="checkbox" id="c-40677205" checked=""/><div class="controls bullet"><span class="by">colordrops</span><span>|</span><a href="#40677025">root</a><span>|</span><a href="#40677142">parent</a><span>|</span><a href="#40678110">prev</a><span>|</span><a href="#40677726">next</a><span>|</span><label class="collapse" for="c-40677205">[-]</label><label class="expand" for="c-40677205">[1 more]</label></div><br/><div class="children"><div class="content">Package installation and personal config in a single declarative language, reproducible with a single command, and shareable across platforms. But that&#x27;s just scratching the surface of Nix&#x27;s capabilities.</div><br/></div></div></div></div></div></div><div id="40677726" class="c"><input type="checkbox" id="c-40677726" checked=""/><div class="controls bullet"><span class="by">ThrowawayTestr</span><span>|</span><a href="#40677025">prev</a><span>|</span><a href="#40677988">next</a><span>|</span><label class="collapse" for="c-40677726">[-]</label><label class="expand" for="c-40677726">[2 more]</label></div><br/><div class="children"><div class="content">I love how this title is incomprehensible to 99% of people</div><br/><div id="40678156" class="c"><input type="checkbox" id="c-40678156" checked=""/><div class="controls bullet"><span class="by">muixoozie</span><span>|</span><a href="#40677726">parent</a><span>|</span><a href="#40677988">next</a><span>|</span><label class="collapse" for="c-40678156">[-]</label><label class="expand" for="c-40678156">[1 more]</label></div><br/><div class="children"><div class="content">Yea, I have no idea what a homebrew cask is. (Joking.. I am the 1%)</div><br/></div></div></div></div></div></div></div></div></div></body></html>