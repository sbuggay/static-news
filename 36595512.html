<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1688547651855" as="style"/><link rel="stylesheet" href="styles.css?v=1688547651855"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/ronami/meta-typing">Functions and algorithms implemented purely with TypeScript&#x27;s type system</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>behnamoh</span> | <span>26 comments</span></div><br/><div><div id="36596041" class="c"><input type="checkbox" id="c-36596041" checked=""/><div class="controls bullet"><span class="by">mpoteat</span><span>|</span><a href="#36597564">next</a><span>|</span><label class="collapse" for="c-36596041">[-]</label><label class="expand" for="c-36596041">[6 more]</label></div><br/><div class="children"><div class="content">At the risk of too much self promotion, I have a much deeper and more feature complete treatment of many of these type-level computations, represented with higher kinded types (which are thus composable) here:<p><a href="http:&#x2F;&#x2F;hkt.code.lol&#x2F;" rel="nofollow noreferrer">http:&#x2F;&#x2F;hkt.code.lol&#x2F;</a><p>This is my &quot;lodash for types&quot; project. It supports integer division for up to 2^64, for example. It has over 200 composable utility types.</div><br/><div id="36596396" class="c"><input type="checkbox" id="c-36596396" checked=""/><div class="controls bullet"><span class="by">tchaffee</span><span>|</span><a href="#36596041">parent</a><span>|</span><a href="#36596192">next</a><span>|</span><label class="collapse" for="c-36596396">[-]</label><label class="expand" for="c-36596396">[4 more]</label></div><br/><div class="children"><div class="content">I know I&#x27;ll likely get a biased answer here but what do you think the cons are of using types in this way? My current thinking is that types should should optimize for an easy learning curve so folks can just get on with writing code. This seems like it would require a deep knowledge of TS.<p>lodash does come to mind in fact. The last few shops where I&#x27;ve worked use a very small subset of lodash utilities and ignore most of the library. Their documentation is terse so it&#x27;s often easier to just write your own code that is longer but more readable to the average engineer.</div><br/><div id="36597555" class="c"><input type="checkbox" id="c-36597555" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#36596041">root</a><span>|</span><a href="#36596396">parent</a><span>|</span><a href="#36596475">next</a><span>|</span><label class="collapse" for="c-36597555">[-]</label><label class="expand" for="c-36597555">[1 more]</label></div><br/><div class="children"><div class="content">Conversely, and I don&#x27;t mean to sound flippant, but are there any pros of (ab)using types in this way?<p>These projects are interesting in an amusing &quot;oh look, another Turing complete type system&quot; way, for the author to gain expertise, and as something to highlight in CVs and to chat about during interviews. But other than that, I would never actually choose to use any of this in a real-world project. Depending on the stability of this API (TPI?), and subjecting colleagues to esoteric libraries would be a nightmare to maintain and support.</div><br/></div></div><div id="36596475" class="c"><input type="checkbox" id="c-36596475" checked=""/><div class="controls bullet"><span class="by">mpoteat</span><span>|</span><a href="#36596041">root</a><span>|</span><a href="#36596396">parent</a><span>|</span><a href="#36597555">prev</a><span>|</span><a href="#36596192">next</a><span>|</span><label class="collapse" for="c-36596475">[-]</label><label class="expand" for="c-36596475">[2 more]</label></div><br/><div class="children"><div class="content">Well, slower compile times, and additional complexity are the biggest cons.<p>There is a project I&#x27;m working on to eliminate the latter bit - ideally, a way to represent these complex types with &quot;zero type-level code&quot;</div><br/><div id="36597683" class="c"><input type="checkbox" id="c-36597683" checked=""/><div class="controls bullet"><span class="by">Byamarro</span><span>|</span><a href="#36596041">root</a><span>|</span><a href="#36596475">parent</a><span>|</span><a href="#36596192">next</a><span>|</span><label class="collapse" for="c-36597683">[-]</label><label class="expand" for="c-36597683">[1 more]</label></div><br/><div class="children"><div class="content">Could you elaborate on the project? I&#x27;m curious</div><br/></div></div></div></div></div></div><div id="36596192" class="c"><input type="checkbox" id="c-36596192" checked=""/><div class="controls bullet"><span class="by">primitivesuave</span><span>|</span><a href="#36596041">parent</a><span>|</span><a href="#36596396">prev</a><span>|</span><a href="#36597564">next</a><span>|</span><label class="collapse" for="c-36596192">[-]</label><label class="expand" for="c-36596192">[1 more]</label></div><br/><div class="children"><div class="content">I love this. I&#x27;m frequently experimenting with the &quot;syntactic sugar&quot; possibilities of the TypeScript type inference system, and am truly in awe of your implementation (as well as the excellent and thorough commenting).</div><br/></div></div></div></div><div id="36597564" class="c"><input type="checkbox" id="c-36597564" checked=""/><div class="controls bullet"><span class="by">Hirrolot</span><span>|</span><a href="#36596041">prev</a><span>|</span><a href="#36595992">next</a><span>|</span><label class="collapse" for="c-36597564">[-]</label><label class="expand" for="c-36597564">[1 more]</label></div><br/><div class="children"><div class="content">For those who are wondering whether types can be computed in the same way as values -- yes, they can, with a proper type system. Idris [1] is a prominent example of a programming language with first-class types, meaning that if you can perform (finite) computation on values, you can do so on types. The difference between Idris and TypeScript (Rust, C++, etc.) is that the former treats types as values, and therefore has no traditional separation of values and types; everything is done with the same syntax.<p>Zig strives to use the same syntax for metacomputation, although its approach is not tightly integrated into the type system, which is why you&#x27;d see compilation errors at expansion, not function definition.<p>[1] <a href="https:&#x2F;&#x2F;www.idris-lang.org&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.idris-lang.org&#x2F;</a></div><br/></div></div><div id="36595992" class="c"><input type="checkbox" id="c-36595992" checked=""/><div class="controls bullet"><span class="by">TuringTest</span><span>|</span><a href="#36597564">prev</a><span>|</span><a href="#36596126">next</a><span>|</span><label class="collapse" for="c-36595992">[-]</label><label class="expand" for="c-36595992">[8 more]</label></div><br/><div class="children"><div class="content">Proof that type systems are nothing else that domain-specific languages that run at compile time. When seen like that, it should be no surprise that they can be coerced to do general computation.</div><br/><div id="36596149" class="c"><input type="checkbox" id="c-36596149" checked=""/><div class="controls bullet"><span class="by">vore</span><span>|</span><a href="#36595992">parent</a><span>|</span><a href="#36596997">next</a><span>|</span><label class="collapse" for="c-36596149">[-]</label><label class="expand" for="c-36596149">[2 more]</label></div><br/><div class="children"><div class="content">That’s not universally true, and indeed some languages (e.g. Haskell without extensions) have explicitly designed decidable type systems.</div><br/><div id="36597580" class="c"><input type="checkbox" id="c-36597580" checked=""/><div class="controls bullet"><span class="by">slaymaker1907</span><span>|</span><a href="#36595992">root</a><span>|</span><a href="#36596149">parent</a><span>|</span><a href="#36596997">next</a><span>|</span><label class="collapse" for="c-36597580">[-]</label><label class="expand" for="c-36597580">[1 more]</label></div><br/><div class="children"><div class="content">That just means that it isn’t Turing complete which is true of many DSLs.</div><br/></div></div></div></div><div id="36596997" class="c"><input type="checkbox" id="c-36596997" checked=""/><div class="controls bullet"><span class="by">3cats-in-a-coat</span><span>|</span><a href="#36595992">parent</a><span>|</span><a href="#36596149">prev</a><span>|</span><a href="#36597244">next</a><span>|</span><label class="collapse" for="c-36596997">[-]</label><label class="expand" for="c-36596997">[1 more]</label></div><br/><div class="children"><div class="content">We do a lot of this in computing and engineering. Reinventing the same thing under different names. A JIT is nothing but &quot;compiler at runtime&quot;. And a compiler, parser, tokenizer are all converting one representation into another. Compile-time and run-time are completely nominal, there&#x27;s no reason why we should not start reducing terms as we type, with the &quot;run-time&quot; engine (of course the runtime should know what causes side-effects and stop there).<p>Eventually we need to make type systems just metaprogramming using the primary language that they&#x27;re intended for. There&#x27;s no reason for those to be two languages.</div><br/></div></div><div id="36597244" class="c"><input type="checkbox" id="c-36597244" checked=""/><div class="controls bullet"><span class="by">weinzierl</span><span>|</span><a href="#36595992">parent</a><span>|</span><a href="#36596997">prev</a><span>|</span><a href="#36596673">next</a><span>|</span><label class="collapse" for="c-36597244">[-]</label><label class="expand" for="c-36597244">[1 more]</label></div><br/><div class="children"><div class="content">Some languages have type systems like that, either deliberately as in the case of Idris and Agda or accidentally as in C++ or Typescript.<p>It doesn&#x27;t have to be that way and in my opinion for general purpose languages it shouldn&#x27;t. The type system should be about constraints that facilitate reasoning about your code - reasoning by machine and human.<p>Compile time computation should be a separate facility.</div><br/></div></div><div id="36596673" class="c"><input type="checkbox" id="c-36596673" checked=""/><div class="controls bullet"><span class="by">marton78</span><span>|</span><a href="#36595992">parent</a><span>|</span><a href="#36597244">prev</a><span>|</span><a href="#36596757">next</a><span>|</span><label class="collapse" for="c-36596673">[-]</label><label class="expand" for="c-36596673">[1 more]</label></div><br/><div class="children"><div class="content">Yes. We have known this since C++ template metaprogramming.</div><br/></div></div><div id="36596757" class="c"><input type="checkbox" id="c-36596757" checked=""/><div class="controls bullet"><span class="by">paganel</span><span>|</span><a href="#36595992">parent</a><span>|</span><a href="#36596673">prev</a><span>|</span><a href="#36596126">next</a><span>|</span><label class="collapse" for="c-36596757">[-]</label><label class="expand" for="c-36596757">[2 more]</label></div><br/><div class="children"><div class="content">&gt; else that domain-specific languages that run at compile time.<p>Probably stupid question, but that probably means that one could, theoretically, implement a type system for any one of those DSL(-like) type systems, isn&#x27;t that correct? And so on and so forth, we could have, theoretically, DSL-like type systems all the way down.</div><br/><div id="36596914" class="c"><input type="checkbox" id="c-36596914" checked=""/><div class="controls bullet"><span class="by">mejutoco</span><span>|</span><a href="#36595992">root</a><span>|</span><a href="#36596757">parent</a><span>|</span><a href="#36596126">next</a><span>|</span><label class="collapse" for="c-36596914">[-]</label><label class="expand" for="c-36596914">[1 more]</label></div><br/><div class="children"><div class="content">The difference between regular languages and &quot;type system languages&quot; (at least well designed ones) is that the latter are decidable. In that sense another typesystem lang for the typesystem lang would still be a decidable one.<p>The most generic one I know of is Idris. It uses some heuristics to make some functions decidable that in theory should not be.</div><br/></div></div></div></div></div></div><div id="36596126" class="c"><input type="checkbox" id="c-36596126" checked=""/><div class="controls bullet"><span class="by">jumploops</span><span>|</span><a href="#36595992">prev</a><span>|</span><a href="#36595541">next</a><span>|</span><label class="collapse" for="c-36596126">[-]</label><label class="expand" for="c-36596126">[1 more]</label></div><br/><div class="children"><div class="content">I recently learned about Typescript transformers[0] and wish they were better supported in a first-class manner. Working with ttypescript or ts-patch[1] is easy enough, but it still feels like you&#x27;re doing something you shouldn&#x27;t be doing.<p>My goal was to pass the Typescript types to the JS runtime, maybe there&#x27;s a better way and GPT-4 just led me astray...<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;itsdouges&#x2F;typescript-transformer-handbook">https:&#x2F;&#x2F;github.com&#x2F;itsdouges&#x2F;typescript-transformer-handbook</a><p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;nonara&#x2F;ts-patch">https:&#x2F;&#x2F;github.com&#x2F;nonara&#x2F;ts-patch</a></div><br/></div></div><div id="36595541" class="c"><input type="checkbox" id="c-36595541" checked=""/><div class="controls bullet"><span class="by">spencerchubb</span><span>|</span><a href="#36596126">prev</a><span>|</span><a href="#36595663">next</a><span>|</span><label class="collapse" for="c-36595541">[-]</label><label class="expand" for="c-36595541">[6 more]</label></div><br/><div class="children"><div class="content">Looks like the arithmetic only supports integers 0 through 10<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ronami&#x2F;meta-typing&#x2F;blob&#x2F;master&#x2F;src&#x2F;utils&#x2F;math.d.ts">https:&#x2F;&#x2F;github.com&#x2F;ronami&#x2F;meta-typing&#x2F;blob&#x2F;master&#x2F;src&#x2F;utils&#x2F;...</a></div><br/><div id="36596047" class="c"><input type="checkbox" id="c-36596047" checked=""/><div class="controls bullet"><span class="by">n_e</span><span>|</span><a href="#36595541">parent</a><span>|</span><a href="#36595580">next</a><span>|</span><label class="collapse" for="c-36596047">[-]</label><label class="expand" for="c-36596047">[2 more]</label></div><br/><div class="children"><div class="content">You can count to an arbitrary number (until the recursion limit) by using tuples of length N (and go back and forth to number literals by using the type of tuple[&#x27;length&#x27;])<p>e.g. :<p><pre><code>  type zero = []

  type Inc&lt;N extends string[]&gt; = [...N,&#x27;&#x27;]
  type Dec&lt;N extends string[]&gt; = N extends [...infer T,&#x27;&#x27;] ? T : never
  
  type one = Inc&lt;zero&gt;
  type two = Inc&lt;one&gt;
  type oneb = Dec&lt;two&gt;</code></pre></div><br/><div id="36596614" class="c"><input type="checkbox" id="c-36596614" checked=""/><div class="controls bullet"><span class="by">dqbd</span><span>|</span><a href="#36595541">root</a><span>|</span><a href="#36596047">parent</a><span>|</span><a href="#36595580">next</a><span>|</span><label class="collapse" for="c-36596614">[-]</label><label class="expand" for="c-36596614">[1 more]</label></div><br/><div class="children"><div class="content">A tuple does have a upper limit of 10 000 elements, which means that with this approach we can count to 10 000 at most.<p>Another approach which I tried is to do arithmetics on digits directly, storing digits in a tuple instead, but the code is not as elegant as the tuple one<p><a href="https:&#x2F;&#x2F;github.com&#x2F;dqbd&#x2F;ts-math-evaluate&#x2F;blob&#x2F;main&#x2F;src&#x2F;math&#x2F;add.ts">https:&#x2F;&#x2F;github.com&#x2F;dqbd&#x2F;ts-math-evaluate&#x2F;blob&#x2F;main&#x2F;src&#x2F;math&#x2F;...</a></div><br/></div></div></div></div><div id="36595580" class="c"><input type="checkbox" id="c-36595580" checked=""/><div class="controls bullet"><span class="by">mozey</span><span>|</span><a href="#36595541">parent</a><span>|</span><a href="#36596047">prev</a><span>|</span><a href="#36596058">next</a><span>|</span><label class="collapse" for="c-36595580">[-]</label><label class="expand" for="c-36595580">[2 more]</label></div><br/><div class="children"><div class="content">&quot;This project attempts to push TypeScript&#x27;s type system to its limits by actually implementing various functions and algorithms, purely on top of the type system... Please note that this project is meant to be used for fun and learning purposes and not for practical use&quot;</div><br/><div id="36595594" class="c"><input type="checkbox" id="c-36595594" checked=""/><div class="controls bullet"><span class="by">spencerchubb</span><span>|</span><a href="#36595541">root</a><span>|</span><a href="#36595580">parent</a><span>|</span><a href="#36596058">next</a><span>|</span><label class="collapse" for="c-36595594">[-]</label><label class="expand" for="c-36595594">[1 more]</label></div><br/><div class="children"><div class="content">It is indeed interesting! I was just trying to analyze it a bit deeper</div><br/></div></div></div></div><div id="36596058" class="c"><input type="checkbox" id="c-36596058" checked=""/><div class="controls bullet"><span class="by">vesinisa</span><span>|</span><a href="#36595541">parent</a><span>|</span><a href="#36595580">prev</a><span>|</span><a href="#36595663">next</a><span>|</span><label class="collapse" for="c-36596058">[-]</label><label class="expand" for="c-36596058">[1 more]</label></div><br/><div class="children"><div class="content">Noticed the same. Not a very practical computer, although you could say the host CPU does the same except for int&#x27;s in 0 through 2^64-1.</div><br/></div></div></div></div><div id="36595663" class="c"><input type="checkbox" id="c-36595663" checked=""/><div class="controls bullet"><span class="by">behnamoh</span><span>|</span><a href="#36595541">prev</a><span>|</span><a href="#36596200">next</a><span>|</span><label class="collapse" for="c-36595663">[-]</label><label class="expand" for="c-36595663">[2 more]</label></div><br/><div class="children"><div class="content">Related: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36568183">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36568183</a></div><br/><div id="36595721" class="c"><input type="checkbox" id="c-36595721" checked=""/><div class="controls bullet"><span class="by">Kerrick</span><span>|</span><a href="#36595663">parent</a><span>|</span><a href="#36596200">next</a><span>|</span><label class="collapse" for="c-36595721">[-]</label><label class="expand" for="c-36595721">[1 more]</label></div><br/><div class="children"><div class="content">Also related: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35120084">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35120084</a></div><br/></div></div></div></div><div id="36596200" class="c"><input type="checkbox" id="c-36596200" checked=""/><div class="controls bullet"><span class="by">asicsp</span><span>|</span><a href="#36595663">prev</a><span>|</span><label class="collapse" for="c-36596200">[-]</label><label class="expand" for="c-36596200">[1 more]</label></div><br/><div class="children"><div class="content">See also: <a href="https:&#x2F;&#x2F;github.com&#x2F;tayllan&#x2F;awesome-algorithms">https:&#x2F;&#x2F;github.com&#x2F;tayllan&#x2F;awesome-algorithms</a></div><br/></div></div></div></div></div></div></div></body></html>