<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1699261260895" as="style"/><link rel="stylesheet" href="styles.css?v=1699261260895"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/ekzhang/sshx">Show HN: Sshx, a web-based collaborative terminal</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>ekzhang</span> | <span>41 comments</span></div><br/><div><div id="38160086" class="c"><input type="checkbox" id="c-38160086" checked=""/><div class="controls bullet"><span class="by">ciberado</span><span>|</span><a href="#38159248">next</a><span>|</span><label class="collapse" for="c-38160086">[-]</label><label class="expand" for="c-38160086">[1 more]</label></div><br/><div class="children"><div class="content">Super cool. Our students are using ttdy[0] and tmux for providing shared access to a configured environment, but your solution seems much more flexible :) I&#x27;m going to start experimenting with it for our next courses, thanks!<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;tsl0922&#x2F;ttyd">https:&#x2F;&#x2F;github.com&#x2F;tsl0922&#x2F;ttyd</a></div><br/></div></div><div id="38159248" class="c"><input type="checkbox" id="c-38159248" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#38160086">prev</a><span>|</span><a href="#38158483">next</a><span>|</span><label class="collapse" for="c-38159248">[-]</label><label class="expand" for="c-38159248">[4 more]</label></div><br/><div class="children"><div class="content">Why does the sshx.io&#x2F;get URL detect a browser using the Accept-Encoding header and return 404?<p>Generally I don’t have much to say about curl | bash, but going out of your way to hide the script is a bit suspicious.</div><br/><div id="38159548" class="c"><input type="checkbox" id="c-38159548" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38159248">parent</a><span>|</span><a href="#38158483">next</a><span>|</span><label class="collapse" for="c-38159548">[-]</label><label class="expand" for="c-38159548">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it&#x27;s anything nefarious.  Can&#x27;t pipe a brotli&#x27;d response into bash.  My browser wasn&#x27;t accepting the &#x27;identity&#x27; encoding.  If you alter your browser to accept &#x27;identity&#x27;, it will return the script.</div><br/><div id="38159624" class="c"><input type="checkbox" id="c-38159624" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#38159248">root</a><span>|</span><a href="#38159548">parent</a><span>|</span><a href="#38158483">next</a><span>|</span><label class="collapse" for="c-38159624">[-]</label><label class="expand" for="c-38159624">[2 more]</label></div><br/><div class="children"><div class="content">curl --compressed is very much a thing, and some people may have that set as the default.</div><br/><div id="38159719" class="c"><input type="checkbox" id="c-38159719" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38159248">root</a><span>|</span><a href="#38159624">parent</a><span>|</span><a href="#38158483">next</a><span>|</span><label class="collapse" for="c-38159719">[-]</label><label class="expand" for="c-38159719">[1 more]</label></div><br/><div class="children"><div class="content">ha, learn something new everyday.  Hadn&#x27;t run across the --compressed option before.</div><br/></div></div></div></div></div></div></div></div><div id="38158483" class="c"><input type="checkbox" id="c-38158483" checked=""/><div class="controls bullet"><span class="by">throwaway81733</span><span>|</span><a href="#38159248">prev</a><span>|</span><a href="#38155278">next</a><span>|</span><label class="collapse" for="c-38158483">[-]</label><label class="expand" for="c-38158483">[4 more]</label></div><br/><div class="children"><div class="content">I suspect the encryption here is broken due to CTR mode AES with IV reuse. Try printing out the IV in the segment function. It&#x27;s the same value across sessions.<p>Another thing I see is that AES-CTR is being used alone, so there is no integrity guarantee for the messages.<p>I didn&#x27;t have time to look into it any more deeply. The user interface and concept look really nice, but I would strongly recommend a cryptographic audit. In general, you shouldn&#x27;t have to reach for the subtle constructs in a cryptographic library to build product features.</div><br/><div id="38158913" class="c"><input type="checkbox" id="c-38158913" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38158483">parent</a><span>|</span><a href="#38159196">next</a><span>|</span><label class="collapse" for="c-38158913">[-]</label><label class="expand" for="c-38158913">[2 more]</label></div><br/><div class="children"><div class="content">Hey, this is a serious accusation. I would be very careful about raising false suspicions like this publicly. The application does not reuse IVs.<p>For your second point, I am aware of authenticated encryption and the possibility of bit-level tampering with commands. The point of the encryption is to make sure to preserve confidentiality here.<p>Tampering with commands is not really part of the threat model. The server needs to be trusted in some regard. If the server were compromised and actually modified commands, and it could send arbitrary network messages, then it could just change the HTML payload to the website and show the end user something different.<p>The point of the encryption is only to preserve confidentiality with a properly running server, so CTR mode was chosen.<p>I appreciate your dedication to security, but I would strongly advise you do more research before making comments like this — I take security very seriously as well, and making vague, unfounded accusations without actually reading the code only serves to confuse people.</div><br/><div id="38159295" class="c"><input type="checkbox" id="c-38159295" checked=""/><div class="controls bullet"><span class="by">jchook</span><span>|</span><a href="#38158483">root</a><span>|</span><a href="#38158913">parent</a><span>|</span><a href="#38159196">next</a><span>|</span><label class="collapse" for="c-38159295">[-]</label><label class="expand" for="c-38159295">[1 more]</label></div><br/><div class="children"><div class="content">Maybe you can provide intuition about how the IVs are not predictable? They seem to be formulaic.
<a href="https:&#x2F;&#x2F;github.com&#x2F;ekzhang&#x2F;sshx&#x2F;blob&#x2F;91c82d46cde4d1ffa0ae34e2a9a49911e2e53baa&#x2F;src&#x2F;lib&#x2F;encrypt.ts#L55">https:&#x2F;&#x2F;github.com&#x2F;ekzhang&#x2F;sshx&#x2F;blob&#x2F;91c82d46cde4d1ffa0ae34e...</a></div><br/></div></div></div></div><div id="38159196" class="c"><input type="checkbox" id="c-38159196" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38158483">parent</a><span>|</span><a href="#38158913">prev</a><span>|</span><a href="#38155278">next</a><span>|</span><label class="collapse" for="c-38159196">[-]</label><label class="expand" for="c-38159196">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I suspect the encryption here is broken due to CTR mode AES with IV reuse. Try printing out the IV in the segment function. It&#x27;s the same value across sessions.<p>I think it&#x27;s a little more subtle.  IVs are being generated deterministically, but keys are generated randomly per session.  The nonce uniqueness requirement in CTR is per key.  That said,  there doesn&#x27;t seem like there&#x27;s any guard against replays of messages, or dropping of messages, or altering of messages.<p>&gt; Another thing I see is that AES-CTR is being used alone, so there is no integrity guarantee for the messages.<p>Indeed.  They seem to try and do some integrity checking at the start of a session by sending an encrypted all-zero block, as a way of verifying that the client has the correct key (stored in the url hash).  From what I can tell, there&#x27;s no integrity checking on any subsequent messages.<p>Also the KDF parameters for Argon2id seem way underpowered (19MB RAM, 1 lane, should probably be using at least 2GB RAM in a KDF setting)</div><br/></div></div></div></div><div id="38155278" class="c"><input type="checkbox" id="c-38155278" checked=""/><div class="controls bullet"><span class="by">skimdesk</span><span>|</span><a href="#38158483">prev</a><span>|</span><a href="#38157176">next</a><span>|</span><label class="collapse" for="c-38155278">[-]</label><label class="expand" for="c-38155278">[3 more]</label></div><br/><div class="children"><div class="content">Really fun!<p>I have been experimenting with similar idea myself. I was curious on how you handle instantiating the terminal state for new clients. Seems like you&#x27;re storing a buffer [0] of past output, and replaying that?<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;ekzhang&#x2F;sshx&#x2F;blob&#x2F;91c82d46cde4d1ffa0ae34e2a9a49911e2e53baa&#x2F;crates&#x2F;sshx-server&#x2F;src&#x2F;session.rs#L26">https:&#x2F;&#x2F;github.com&#x2F;ekzhang&#x2F;sshx&#x2F;blob&#x2F;91c82d46cde4d1ffa0ae34e...</a></div><br/><div id="38155776" class="c"><input type="checkbox" id="c-38155776" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38155278">parent</a><span>|</span><a href="#38157176">next</a><span>|</span><label class="collapse" for="c-38155776">[-]</label><label class="expand" for="c-38155776">[2 more]</label></div><br/><div class="children"><div class="content">Yep, it’s a rolling 2 MiB buffer in RAM. Also do some snapshotting for persistence &#x2F; server fault-tolerance, and that size is much smaller.</div><br/><div id="38157832" class="c"><input type="checkbox" id="c-38157832" checked=""/><div class="controls bullet"><span class="by">mkj</span><span>|</span><a href="#38155278">root</a><span>|</span><a href="#38155776">parent</a><span>|</span><a href="#38157176">next</a><span>|</span><label class="collapse" for="c-38157832">[-]</label><label class="expand" for="c-38157832">[1 more]</label></div><br/><div class="children"><div class="content">Does that mean it can avoid having to interpret terminal control codes (ie be a full terminal emulator)? That&#x27;s a clever way.</div><br/></div></div></div></div></div></div><div id="38157176" class="c"><input type="checkbox" id="c-38157176" checked=""/><div class="controls bullet"><span class="by">arjvik</span><span>|</span><a href="#38155278">prev</a><span>|</span><a href="#38158963">next</a><span>|</span><label class="collapse" for="c-38157176">[-]</label><label class="expand" for="c-38157176">[2 more]</label></div><br/><div class="children"><div class="content">I’ve been using GoTTY (<a href="https:&#x2F;&#x2F;github.com&#x2F;yudai&#x2F;gotty">https:&#x2F;&#x2F;github.com&#x2F;yudai&#x2F;gotty</a>) to do the same thing, combined with ngrok or Cloudflare tunnels to get a publically accessible URL. To enable multiplayer mode, just need screen&#x2F;tmux.</div><br/><div id="38157990" class="c"><input type="checkbox" id="c-38157990" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38157176">parent</a><span>|</span><a href="#38158963">next</a><span>|</span><label class="collapse" for="c-38157990">[-]</label><label class="expand" for="c-38157990">[1 more]</label></div><br/><div class="children"><div class="content">Nice trick! Many people have mentioned that tmux lets you share terminals, though worth noting that it takes a bit of setup, doesn’t render correctly when you have different screen sizes, and requires stitching together a lot of other tools to work over a browser.<p>Personally I think being able to arrange and resize terminals adds a lot to the collaboration feeling, as well as seeing people’s cursors. I encourage you to give it a try! (it takes less than a second to install, and then you just run “sshx”)</div><br/></div></div></div></div><div id="38158963" class="c"><input type="checkbox" id="c-38158963" checked=""/><div class="controls bullet"><span class="by">jpeeler</span><span>|</span><a href="#38157176">prev</a><span>|</span><a href="#38158960">next</a><span>|</span><label class="collapse" for="c-38158963">[-]</label><label class="expand" for="c-38158963">[1 more]</label></div><br/><div class="children"><div class="content">Very cool! Would love to see the ability to restrict remote parties, both for read-only viewing and from opening additional terminals.</div><br/></div></div><div id="38158591" class="c"><input type="checkbox" id="c-38158591" checked=""/><div class="controls bullet"><span class="by">alchemist1e9</span><span>|</span><a href="#38158960">prev</a><span>|</span><a href="#38159207">next</a><span>|</span><label class="collapse" for="c-38158591">[-]</label><label class="expand" for="c-38158591">[1 more]</label></div><br/><div class="children"><div class="content">Extremely cool. Do the terminal emulators support sixel?</div><br/></div></div><div id="38159207" class="c"><input type="checkbox" id="c-38159207" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#38158591">prev</a><span>|</span><a href="#38154984">next</a><span>|</span><label class="collapse" for="c-38159207">[-]</label><label class="expand" for="c-38159207">[1 more]</label></div><br/><div class="children"><div class="content">why don’t those risky “curl | sh” commands at least do some checksum or sig verification?</div><br/></div></div><div id="38154984" class="c"><input type="checkbox" id="c-38154984" checked=""/><div class="controls bullet"><span class="by">teaearlgraycold</span><span>|</span><a href="#38159207">prev</a><span>|</span><a href="#38156200">next</a><span>|</span><label class="collapse" for="c-38154984">[-]</label><label class="expand" for="c-38154984">[2 more]</label></div><br/><div class="children"><div class="content">Web developers live in the web, but we still need to interface with VMs over SSH. Bridging that gap in favor of the developer is genius. The multiplayer aspect, the shell one-liner to bootstrap the whole process, everything about this is great.</div><br/><div id="38155935" class="c"><input type="checkbox" id="c-38155935" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38154984">parent</a><span>|</span><a href="#38156200">next</a><span>|</span><label class="collapse" for="c-38155935">[-]</label><label class="expand" for="c-38155935">[1 more]</label></div><br/><div class="children"><div class="content">Thanks! Yeah you can use it anywhere with outbound HTTP network access, whether that’s a local VM, cloud instance, laptop, k8s pod, random managed SaaS, serverless function, Raspberry Pi, …</div><br/></div></div></div></div><div id="38156200" class="c"><input type="checkbox" id="c-38156200" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#38154984">prev</a><span>|</span><a href="#38154219">next</a><span>|</span><label class="collapse" for="c-38156200">[-]</label><label class="expand" for="c-38156200">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for writing and sharing this!</div><br/></div></div><div id="38154219" class="c"><input type="checkbox" id="c-38154219" checked=""/><div class="controls bullet"><span class="by">nolist_policy</span><span>|</span><a href="#38156200">prev</a><span>|</span><a href="#38157167">next</a><span>|</span><label class="collapse" for="c-38154219">[-]</label><label class="expand" for="c-38154219">[14 more]</label></div><br/><div class="children"><div class="content">You can share the same terminal session to multiple ssh connections with gnu screen btw.</div><br/><div id="38155487" class="c"><input type="checkbox" id="c-38155487" checked=""/><div class="controls bullet"><span class="by">gooseyard</span><span>|</span><a href="#38154219">parent</a><span>|</span><a href="#38154521">next</a><span>|</span><label class="collapse" for="c-38155487">[-]</label><label class="expand" for="c-38155487">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll plug <a href="https:&#x2F;&#x2F;tmate.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;tmate.io&#x2F;</a> as well, its incredibly handy</div><br/><div id="38155969" class="c"><input type="checkbox" id="c-38155969" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38155487">parent</a><span>|</span><a href="#38156963">next</a><span>|</span><label class="collapse" for="c-38155969">[-]</label><label class="expand" for="c-38155969">[3 more]</label></div><br/><div class="children"><div class="content">tmate is an incredible piece of software! The terminal multiplexing is surprisingly similar to the problem of collaboratively sharing terminals, and forking tmux is a really elegant way to handle that. I took a lot of inspiration from other terminal software out there</div><br/><div id="38156956" class="c"><input type="checkbox" id="c-38156956" checked=""/><div class="controls bullet"><span class="by">minerva23</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38155969">parent</a><span>|</span><a href="#38156963">next</a><span>|</span><label class="collapse" for="c-38156956">[-]</label><label class="expand" for="c-38156956">[2 more]</label></div><br/><div class="children"><div class="content">Have you considered adding a section to the readme comparing Sshx to these well-known alternatives?</div><br/><div id="38157122" class="c"><input type="checkbox" id="c-38157122" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38156956">parent</a><span>|</span><a href="#38156963">next</a><span>|</span><label class="collapse" for="c-38157122">[-]</label><label class="expand" for="c-38157122">[1 more]</label></div><br/><div class="children"><div class="content">I could do it!! It’s on the list<p>(note that sshx is pretty different from all the suggested alternatives though)</div><br/></div></div></div></div></div></div><div id="38156963" class="c"><input type="checkbox" id="c-38156963" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38155487">parent</a><span>|</span><a href="#38155969">prev</a><span>|</span><a href="#38154521">next</a><span>|</span><label class="collapse" for="c-38156963">[-]</label><label class="expand" for="c-38156963">[1 more]</label></div><br/><div class="children"><div class="content">Tmate is amazing, highly recommended. It&#x27;s my favorite way to do pair programming.</div><br/></div></div></div></div><div id="38154521" class="c"><input type="checkbox" id="c-38154521" checked=""/><div class="controls bullet"><span class="by">vulcan01</span><span>|</span><a href="#38154219">parent</a><span>|</span><a href="#38155487">prev</a><span>|</span><a href="#38154438">next</a><span>|</span><label class="collapse" for="c-38154521">[-]</label><label class="expand" for="c-38154521">[3 more]</label></div><br/><div class="children"><div class="content">Or tmux.
I guess neither are as intuitive as clickable buttons though.</div><br/><div id="38155947" class="c"><input type="checkbox" id="c-38155947" checked=""/><div class="controls bullet"><span class="by">ekzhang</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38154521">parent</a><span>|</span><a href="#38154438">next</a><span>|</span><label class="collapse" for="c-38155947">[-]</label><label class="expand" for="c-38155947">[2 more]</label></div><br/><div class="children"><div class="content">Yep, it was a big inspiration for this. tmux won’t sync window sizes properly between viewers though</div><br/><div id="38156706" class="c"><input type="checkbox" id="c-38156706" checked=""/><div class="controls bullet"><span class="by">somat</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38155947">parent</a><span>|</span><a href="#38154438">next</a><span>|</span><label class="collapse" for="c-38156706">[-]</label><label class="expand" for="c-38156706">[1 more]</label></div><br/><div class="children"><div class="content">multiple connections to the same tmux session right?<p>I never had a problem with it, tmux picks the largest space that can fit all terminals. should it be doing something different?</div><br/></div></div></div></div></div></div><div id="38154438" class="c"><input type="checkbox" id="c-38154438" checked=""/><div class="controls bullet"><span class="by">mike503</span><span>|</span><a href="#38154219">parent</a><span>|</span><a href="#38154521">prev</a><span>|</span><a href="#38154941">next</a><span>|</span><label class="collapse" for="c-38154438">[-]</label><label class="expand" for="c-38154438">[4 more]</label></div><br/><div class="children"><div class="content">screen -x<p>However the unique prop here is that it&#x27;s web-based.</div><br/><div id="38154651" class="c"><input type="checkbox" id="c-38154651" checked=""/><div class="controls bullet"><span class="by">bitwize</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38154438">parent</a><span>|</span><a href="#38154941">next</a><span>|</span><label class="collapse" for="c-38154651">[-]</label><label class="expand" for="c-38154651">[3 more]</label></div><br/><div class="children"><div class="content">If it isn&#x27;t web-based, or you can&#x27;t &#x27;npm i&#x27; it, it may as well not exist.</div><br/><div id="38154950" class="c"><input type="checkbox" id="c-38154950" checked=""/><div class="controls bullet"><span class="by">wiseowise</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38154651">parent</a><span>|</span><a href="#38159216">next</a><span>|</span><label class="collapse" for="c-38154950">[-]</label><label class="expand" for="c-38154950">[1 more]</label></div><br/><div class="children"><div class="content">This, but unironically.</div><br/></div></div><div id="38159216" class="c"><input type="checkbox" id="c-38159216" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#38154219">root</a><span>|</span><a href="#38154651">parent</a><span>|</span><a href="#38154950">prev</a><span>|</span><a href="#38154941">next</a><span>|</span><label class="collapse" for="c-38159216">[-]</label><label class="expand" for="c-38159216">[1 more]</label></div><br/><div class="children"><div class="content">npx it these days</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>