<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1695200461593" as="style"/><link rel="stylesheet" href="styles.css?v=1695200461593"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/crossbowerbt/awk-webserver">A simple web server written in Awk</a>Â <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>keepamovin</span> | <span>39 comments</span></div><br/><div><div id="37580367" class="c"><input type="checkbox" id="c-37580367" checked=""/><div class="controls bullet"><span class="by">dmux</span><span>|</span><a href="#37581921">next</a><span>|</span><label class="collapse" for="c-37580367">[-]</label><label class="expand" for="c-37580367">[2 more]</label></div><br/><div class="children"><div class="content">If you enjoy stretching what you can get done with limited environments, I recently discovered BusyBox includes not only an AWK implementation but an HTTP server[0] that supports CGI as well. I spent a weekend setting up a really simple web-app using recutils [1] as the database and BusyBox AWK as the programming language.<p>If you enjoy bricolage and you feel like wasting a weekend, I would recommend giving it a try!<p>[0] <a href="https:&#x2F;&#x2F;openwrt.org&#x2F;docs&#x2F;guide-user&#x2F;services&#x2F;webserver&#x2F;http.httpd" rel="nofollow noreferrer">https:&#x2F;&#x2F;openwrt.org&#x2F;docs&#x2F;guide-user&#x2F;services&#x2F;webserver&#x2F;http....</a><p>[1] <a href="https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;recutils&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;recutils&#x2F;</a></div><br/></div></div><div id="37581921" class="c"><input type="checkbox" id="c-37581921" checked=""/><div class="controls bullet"><span class="by">tyingq</span><span>|</span><a href="#37580367">prev</a><span>|</span><a href="#37581337">next</a><span>|</span><label class="collapse" for="c-37581921">[-]</label><label class="expand" for="c-37581921">[1 more]</label></div><br/><div class="children"><div class="content">Ah, I had posted a golfed silly gawk webserver here some time ago:<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=22085459">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=22085459</a><p>Pretty printed: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;tyingq&#x2F;4e568425e2e68e6390f3105e588787c6" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;tyingq&#x2F;4e568425e2e68e6390f3105e58878...</a></div><br/></div></div><div id="37581337" class="c"><input type="checkbox" id="c-37581337" checked=""/><div class="controls bullet"><span class="by">hackideiomat</span><span>|</span><a href="#37581921">prev</a><span>|</span><a href="#37581134">next</a><span>|</span><label class="collapse" for="c-37581337">[-]</label><label class="expand" for="c-37581337">[3 more]</label></div><br/><div class="children"><div class="content">&gt; gsub(&#x2F;\&#x2F;\.\.&#x2F;, &quot;&#x2F;&quot;, request_filename) # avoid directory trasversal<p>Hmmmm<p><a href="http:&#x2F;&#x2F;localhost:8888&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;...&#x2F;....&#x2F;etc&#x2F;passwd" rel="nofollow noreferrer">http:&#x2F;&#x2F;localhost:8888&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;...&#x2F;.......</a></div><br/><div id="37581364" class="c"><input type="checkbox" id="c-37581364" checked=""/><div class="controls bullet"><span class="by">tmsbrg</span><span>|</span><a href="#37581337">parent</a><span>|</span><a href="#37581134">next</a><span>|</span><label class="collapse" for="c-37581364">[-]</label><label class="expand" for="c-37581364">[2 more]</label></div><br/><div class="children"><div class="content">damn, you beat me to it.<p>Was gonna write:<p><a href="http:&#x2F;&#x2F;localhost:8888&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;etc&#x2F;hostname" rel="nofollow noreferrer">http:&#x2F;&#x2F;localhost:8888&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;etc&#x2F;host...</a><p>mypc<p>These regex substitutions are so easy to bypass :)</div><br/><div id="37581376" class="c"><input type="checkbox" id="c-37581376" checked=""/><div class="controls bullet"><span class="by">hackideiomat</span><span>|</span><a href="#37581337">root</a><span>|</span><a href="#37581364">parent</a><span>|</span><a href="#37581134">next</a><span>|</span><label class="collapse" for="c-37581376">[-]</label><label class="expand" for="c-37581376">[1 more]</label></div><br/><div class="children"><div class="content">Always fun :D</div><br/></div></div></div></div></div></div><div id="37581134" class="c"><input type="checkbox" id="c-37581134" checked=""/><div class="controls bullet"><span class="by">Yannik_Sc</span><span>|</span><a href="#37581337">prev</a><span>|</span><a href="#37579849">next</a><span>|</span><label class="collapse" for="c-37581134">[-]</label><label class="expand" for="c-37581134">[1 more]</label></div><br/><div class="children"><div class="content">If I got this term correctly, these days it would rather be a &quot;Serverless webserver in awk&quot;. 
Also sounds more catchy.</div><br/></div></div><div id="37579849" class="c"><input type="checkbox" id="c-37579849" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#37581134">prev</a><span>|</span><a href="#37580038">next</a><span>|</span><label class="collapse" for="c-37579849">[-]</label><label class="expand" for="c-37579849">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s funny how closely this resembles nginx.conf.</div><br/><div id="37580156" class="c"><input type="checkbox" id="c-37580156" checked=""/><div class="controls bullet"><span class="by">dosk</span><span>|</span><a href="#37579849">parent</a><span>|</span><a href="#37580038">next</a><span>|</span><label class="collapse" for="c-37580156">[-]</label><label class="expand" for="c-37580156">[3 more]</label></div><br/><div class="children"><div class="content">23 years earlier <a href="https:&#x2F;&#x2F;marek.terminus.sk&#x2F;prog&#x2F;hawkh.tgz" rel="nofollow noreferrer">https:&#x2F;&#x2F;marek.terminus.sk&#x2F;prog&#x2F;hawkh.tgz</a><p>homepage 
 <a href="https:&#x2F;&#x2F;marek.terminus.sk&#x2F;prog&#x2F;hawkh.shtml" rel="nofollow noreferrer">https:&#x2F;&#x2F;marek.terminus.sk&#x2F;prog&#x2F;hawkh.shtml</a></div><br/><div id="37580317" class="c"><input type="checkbox" id="c-37580317" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#37579849">root</a><span>|</span><a href="#37580156">parent</a><span>|</span><a href="#37580038">next</a><span>|</span><label class="collapse" for="c-37580317">[-]</label><label class="expand" for="c-37580317">[2 more]</label></div><br/><div class="children"><div class="content">Marek&#x27;s achieves it without socat, using only cat and sh built-ins.  Badass OG.</div><br/><div id="37580662" class="c"><input type="checkbox" id="c-37580662" checked=""/><div class="controls bullet"><span class="by">arpa</span><span>|</span><a href="#37579849">root</a><span>|</span><a href="#37580317">parent</a><span>|</span><a href="#37580038">next</a><span>|</span><label class="collapse" for="c-37580662">[-]</label><label class="expand" for="c-37580662">[1 more]</label></div><br/><div class="children"><div class="content">a small nitpick - it uses inetd, which actually handles the network stuff allowing you to work on stdin&#x2F;stdout. At least that&#x27;s what i remember from 2003(?) when i wrote an identd for conntracked  connections in bash.</div><br/></div></div></div></div></div></div></div></div><div id="37580038" class="c"><input type="checkbox" id="c-37580038" checked=""/><div class="controls bullet"><span class="by">mdale</span><span>|</span><a href="#37579849">prev</a><span>|</span><a href="#37580754">next</a><span>|</span><label class="collapse" for="c-37580038">[-]</label><label class="expand" for="c-37580038">[1 more]</label></div><br/><div class="children"><div class="content">Awwwwk such a cute web server :)</div><br/></div></div><div id="37580754" class="c"><input type="checkbox" id="c-37580754" checked=""/><div class="controls bullet"><span class="by">notorandit</span><span>|</span><a href="#37580038">prev</a><span>|</span><a href="#37580786">next</a><span>|</span><label class="collapse" for="c-37580754">[-]</label><label class="expand" for="c-37580754">[1 more]</label></div><br/><div class="children"><div class="content">You can achieve the same in bash. With no so at.</div><br/></div></div><div id="37580786" class="c"><input type="checkbox" id="c-37580786" checked=""/><div class="controls bullet"><span class="by">LispSporks22</span><span>|</span><a href="#37580754">prev</a><span>|</span><a href="#37580154">next</a><span>|</span><label class="collapse" for="c-37580786">[-]</label><label class="expand" for="c-37580786">[2 more]</label></div><br/><div class="children"><div class="content">I thought you could listen() accept() in modern awks.</div><br/><div id="37582001" class="c"><input type="checkbox" id="c-37582001" checked=""/><div class="controls bullet"><span class="by">tyingq</span><span>|</span><a href="#37580786">parent</a><span>|</span><a href="#37580154">next</a><span>|</span><label class="collapse" for="c-37582001">[-]</label><label class="expand" for="c-37582001">[1 more]</label></div><br/><div class="children"><div class="content">Sort of.  Gawk supports magic file names like &quot;&#x2F;inet&#x2F;tcp&#x2F;8080&#x2F;0&#x2F;0&quot;, but you don&#x27;t get control of accept()...it&#x27;s all mooshed together.  So you can make a slow, single threaded webserver with it.  Which is too bad, because the usually shipped gawk extensions also give you fork.  If they had separated listen() and accept(), you could actually make a reasonable webserver.  See my other comment for an example of what you&#x27;re limited to.</div><br/></div></div></div></div><div id="37580154" class="c"><input type="checkbox" id="c-37580154" checked=""/><div class="controls bullet"><span class="by">iamcreasy</span><span>|</span><a href="#37580786">prev</a><span>|</span><a href="#37579968">next</a><span>|</span><label class="collapse" for="c-37580154">[-]</label><label class="expand" for="c-37580154">[3 more]</label></div><br/><div class="children"><div class="content">Interesting, but what is a TCP wrapper?</div><br/><div id="37580185" class="c"><input type="checkbox" id="c-37580185" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37580154">parent</a><span>|</span><a href="#37579968">next</a><span>|</span><label class="collapse" for="c-37580185">[-]</label><label class="expand" for="c-37580185">[2 more]</label></div><br/><div class="children"><div class="content">Something that handles the TCP connections and passes them to the wrapped programâs stdin and stdout. Back in the day, lots of network daemons were written as command line tools and executed via inetd.</div><br/></div></div></div></div><div id="37579968" class="c"><input type="checkbox" id="c-37579968" checked=""/><div class="controls bullet"><span class="by">calvinmorrison</span><span>|</span><a href="#37580154">prev</a><span>|</span><a href="#37579623">next</a><span>|</span><label class="collapse" for="c-37579968">[-]</label><label class="expand" for="c-37579968">[2 more]</label></div><br/><div class="children"><div class="content">then on top of that you can run werc a web framework written entirely in rc, save for a few of the filters which i think are awk files (like the markdown2html converter)</div><br/></div></div><div id="37579623" class="c"><input type="checkbox" id="c-37579623" checked=""/><div class="controls bullet"><span class="by">NonEUCitizen</span><span>|</span><a href="#37579968">prev</a><span>|</span><a href="#37579781">next</a><span>|</span><label class="collapse" for="c-37579623">[-]</label><label class="expand" for="c-37579623">[17 more]</label></div><br/><div class="children"><div class="content">&quot;requires socat&quot;</div><br/><div id="37579871" class="c"><input type="checkbox" id="c-37579871" checked=""/><div class="controls bullet"><span class="by">keepamovin</span><span>|</span><a href="#37579623">parent</a><span>|</span><a href="#37580079">next</a><span>|</span><label class="collapse" for="c-37579871">[-]</label><label class="expand" for="c-37579871">[2 more]</label></div><br/><div class="children"><div class="content">For tcp. There&#x27;s another one which uses GAwk&#x27;s internal tcp stack, but I wasn&#x27;t sure if that would work in normal awk, and I&#x27;m a purist like that so you got this one.</div><br/><div id="37580521" class="c"><input type="checkbox" id="c-37580521" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579871">parent</a><span>|</span><a href="#37580079">next</a><span>|</span><label class="collapse" for="c-37580521">[-]</label><label class="expand" for="c-37580521">[1 more]</label></div><br/><div class="children"><div class="content">Iâd like to see both, please</div><br/></div></div></div></div><div id="37580079" class="c"><input type="checkbox" id="c-37580079" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#37579623">parent</a><span>|</span><a href="#37579871">prev</a><span>|</span><a href="#37579756">next</a><span>|</span><label class="collapse" for="c-37580079">[-]</label><label class="expand" for="c-37580079">[5 more]</label></div><br/><div class="children"><div class="content">Socat is a trivial stream converter, like a pipe fitting with different thread sizes on two ends.<p>The interesting part is the logic and the actual.string processing.</div><br/><div id="37580789" class="c"><input type="checkbox" id="c-37580789" checked=""/><div class="controls bullet"><span class="by">eichin</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580079">parent</a><span>|</span><a href="#37580153">next</a><span>|</span><label class="collapse" for="c-37580789">[-]</label><label class="expand" for="c-37580789">[2 more]</label></div><br/><div class="children"><div class="content">True, but you can go the other way and do it with only socat: socat -v tcp-listen:8888,reuseaddr,fork exec:&#x27;cat RESPONSE&#x27; is a (Very Static) entire web server, if RESPONSE has 2 header lines, a blank, and an html body.  (A little too late in the morning for me to do the golfing needed to eliminate the &quot;cat&quot; and do the cr-nl from whatever shell you&#x27;re already running, though.)</div><br/><div id="37580812" class="c"><input type="checkbox" id="c-37580812" checked=""/><div class="controls bullet"><span class="by">eichin</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580789">parent</a><span>|</span><a href="#37580153">next</a><span>|</span><label class="collapse" for="c-37580812">[-]</label><label class="expand" for="c-37580812">[1 more]</label></div><br/><div class="children"><div class="content">(scrolls down further in the socat manpage) Ohhh, under &quot;EXAMPLES&quot;: you can combine a crlf option to TCP-LISTEN, SYSTEM instead of EXEC, and &quot;echo -e&quot;, and there&#x27;s actually a slightly <i>useful</i> http server already done :-)</div><br/></div></div></div></div><div id="37580153" class="c"><input type="checkbox" id="c-37580153" checked=""/><div class="controls bullet"><span class="by">ISL</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580079">parent</a><span>|</span><a href="#37580789">prev</a><span>|</span><a href="#37579756">next</a><span>|</span><label class="collapse" for="c-37580153">[-]</label><label class="expand" for="c-37580153">[2 more]</label></div><br/><div class="children"><div class="content">My first interesting question was, &quot;How do I open a port in awk?!&quot;</div><br/><div id="37580473" class="c"><input type="checkbox" id="c-37580473" checked=""/><div class="controls bullet"><span class="by">bewuethr</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580153">parent</a><span>|</span><a href="#37579756">next</a><span>|</span><label class="collapse" for="c-37580473">[-]</label><label class="expand" for="c-37580473">[1 more]</label></div><br/><div class="children"><div class="content">GNU Awk has an entire separate manual for TCP&#x2F;IP internetworking: <a href="https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;gawk&#x2F;manual&#x2F;gawkinet&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;gawk&#x2F;manual&#x2F;gawkinet&#x2F;</a></div><br/></div></div></div></div></div></div><div id="37579756" class="c"><input type="checkbox" id="c-37579756" checked=""/><div class="controls bullet"><span class="by">cf100clunk</span><span>|</span><a href="#37579623">parent</a><span>|</span><a href="#37580079">prev</a><span>|</span><a href="#37579785">next</a><span>|</span><label class="collapse" for="c-37579756">[-]</label><label class="expand" for="c-37579756">[8 more]</label></div><br/><div class="children"><div class="content">Or cd to the html directory and run this:<p><pre><code>  python -m http.server 8080
</code></pre>
which does not require anything else like socat.</div><br/><div id="37579773" class="c"><input type="checkbox" id="c-37579773" checked=""/><div class="controls bullet"><span class="by">prokopton</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579756">parent</a><span>|</span><a href="#37579954">next</a><span>|</span><label class="collapse" for="c-37579773">[-]</label><label class="expand" for="c-37579773">[2 more]</label></div><br/><div class="children"><div class="content">I think this is more of a âainât this interesting?â sort of thing.</div><br/><div id="37579784" class="c"><input type="checkbox" id="c-37579784" checked=""/><div class="controls bullet"><span class="by">cf100clunk</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579773">parent</a><span>|</span><a href="#37579954">next</a><span>|</span><label class="collapse" for="c-37579784">[-]</label><label class="expand" for="c-37579784">[1 more]</label></div><br/><div class="children"><div class="content">Not a nawk on awk (pun intended) or socat, just a reply to the parent&#x27;s comment.</div><br/></div></div></div></div><div id="37579954" class="c"><input type="checkbox" id="c-37579954" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579756">parent</a><span>|</span><a href="#37579773">prev</a><span>|</span><a href="#37580086">next</a><span>|</span><label class="collapse" for="c-37579954">[-]</label><label class="expand" for="c-37579954">[1 more]</label></div><br/><div class="children"><div class="content">This is functional and uninteresting.</div><br/></div></div><div id="37580086" class="c"><input type="checkbox" id="c-37580086" checked=""/><div class="controls bullet"><span class="by">sodapopcan</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579756">parent</a><span>|</span><a href="#37579954">prev</a><span>|</span><a href="#37580518">next</a><span>|</span><label class="collapse" for="c-37580086">[-]</label><label class="expand" for="c-37580086">[3 more]</label></div><br/><div class="children"><div class="content">&quot;requires python&quot;</div><br/><div id="37580110" class="c"><input type="checkbox" id="c-37580110" checked=""/><div class="controls bullet"><span class="by">CSSer</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580086">parent</a><span>|</span><a href="#37580518">next</a><span>|</span><label class="collapse" for="c-37580110">[-]</label><label class="expand" for="c-37580110">[2 more]</label></div><br/><div class="children"><div class="content">Which in a way is somehow worse :P</div><br/><div id="37581457" class="c"><input type="checkbox" id="c-37581457" checked=""/><div class="controls bullet"><span class="by">hackideiomat</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37580110">parent</a><span>|</span><a href="#37580518">next</a><span>|</span><label class="collapse" for="c-37581457">[-]</label><label class="expand" for="c-37581457">[1 more]</label></div><br/><div class="children"><div class="content">in many ways</div><br/></div></div></div></div></div></div><div id="37580518" class="c"><input type="checkbox" id="c-37580518" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#37579623">root</a><span>|</span><a href="#37579756">parent</a><span>|</span><a href="#37580086">prev</a><span>|</span><a href="#37579785">next</a><span>|</span><label class="collapse" for="c-37580518">[-]</label><label class="expand" for="c-37580518">[1 more]</label></div><br/><div class="children"><div class="content">Nothing is interesting about overrated Python though</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>