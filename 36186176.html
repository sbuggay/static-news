<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1685955681113" as="style"/><link rel="stylesheet" href="styles.css?v=1685955681113"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://xeiaso.net/blog/anything-message-queue">Anything can be a message queue if you use it wrongly enough</a> <span class="domain">(<a href="https://xeiaso.net">xeiaso.net</a>)</span></div><div class="subtext"><span>cendyne</span> | <span>175 comments</span></div><br/><div><div id="36187779" class="c"><input type="checkbox" id="c-36187779" checked=""/><div class="controls bullet"><span class="by">jamest</span><span>|</span><a href="#36186904">next</a><span>|</span><label class="collapse" for="c-36187779">[-]</label><label class="expand" for="c-36187779">[23 more]</label></div><br/><div class="children"><div class="content">The satire in the title is reminiscent of how Firebase was born.<p>We were previously working on a chat system called Envolve (<a href="https:&#x2F;&#x2F;www.envolve.com" rel="nofollow">https:&#x2F;&#x2F;www.envolve.com</a>), that was &#x27;Facebook Chat for any website&#x27;. A game that was using us for in-game chat created channels, used display: none on them, and passed game state through the chat.<p>We scratched our head, asked them why, and learned they wanted to focus on the frontend, not to deal with realtime message passing.<p>This led us to create a &#x27;headless version&#x27; of our chat infra (re-written in Scala) that became the Firebase Realtime Database.</div><br/><div id="36187909" class="c"><input type="checkbox" id="c-36187909" checked=""/><div class="controls bullet"><span class="by">bombcar</span><span>|</span><a href="#36187779">parent</a><span>|</span><a href="#36188295">next</a><span>|</span><label class="collapse" for="c-36187909">[-]</label><label class="expand" for="c-36187909">[20 more]</label></div><br/><div class="children"><div class="content">This is an important lesson - if someone is using your tool in unexpected ways don’t just shut them down; there’s likely a business case that could be identified and specialized in.</div><br/><div id="36188841" class="c"><input type="checkbox" id="c-36188841" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36187909">parent</a><span>|</span><a href="#36188043">next</a><span>|</span><label class="collapse" for="c-36188841">[-]</label><label class="expand" for="c-36188841">[17 more]</label></div><br/><div class="children"><div class="content">Nobody wants the product you want to make. They all want you to make the product they need, and will do things the devs of your product could never imagine with your product.</div><br/><div id="36190481" class="c"><input type="checkbox" id="c-36190481" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36188841">parent</a><span>|</span><a href="#36189490">next</a><span>|</span><label class="collapse" for="c-36190481">[-]</label><label class="expand" for="c-36190481">[6 more]</label></div><br/><div class="children"><div class="content">We make a CRUD desktop app, with a lot of integrations to customer systems. We got a standard set of XMLs, but we&#x27;ll deal with whatever the customer has if we need to.<p>We recently got a support call from an upset client. A recent change had broken their integration, halting production.<p>This lead to some head scratching on our side, as we couldn&#x27;t figure out what integration they were talking about.<p>Turned out they had paid some consultant quite a lot to script some tool similar to AutoHotkey to transfer data from their order system to our system. It would emulate copy pasting fields, tabbing along.<p>Our recent update had introduced a new field, thus screwing it all up.<p>As an aside, the &quot;integration&quot; used half an hour to transfer a single order due to how it did its work. An XML would have taken seconds tops.</div><br/><div id="36190781" class="c"><input type="checkbox" id="c-36190781" checked=""/><div class="controls bullet"><span class="by">dano</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190481">parent</a><span>|</span><a href="#36193630">next</a><span>|</span><label class="collapse" for="c-36190781">[-]</label><label class="expand" for="c-36190781">[4 more]</label></div><br/><div class="children"><div class="content">I had a client who wanted to build his business on top of our business via scripting our administrative back end - basically he wanted to be a value added reseller. He&#x27;d get angry when we modified our admin console. We offered him API access for a fee, but any fee was too much for his business model. It was quite frustrating and eventually we had to ignore his pleas for UI stability over years of time. All the while he could have had access to the API for less than he was paying the person to script our admin console. This was circa 2007, so perhaps API programmers just weren&#x27;t the thing back in the day.</div><br/><div id="36190898" class="c"><input type="checkbox" id="c-36190898" checked=""/><div class="controls bullet"><span class="by">bombcar</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190781">parent</a><span>|</span><a href="#36192200">next</a><span>|</span><label class="collapse" for="c-36190898">[-]</label><label class="expand" for="c-36190898">[2 more]</label></div><br/><div class="children"><div class="content">When you have a hammer every problem is a nail.<p>It happens quite a bit - people solve the problem they have with what they know.</div><br/><div id="36191595" class="c"><input type="checkbox" id="c-36191595" checked=""/><div class="controls bullet"><span class="by">cyanydeez</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190898">parent</a><span>|</span><a href="#36192200">next</a><span>|</span><label class="collapse" for="c-36191595">[-]</label><label class="expand" for="c-36191595">[1 more]</label></div><br/><div class="children"><div class="content">Wlitlhl the way the internet is headed, I&#x27;m expecting an auto API generator to plug the API holes twitter and reddit are planning.<p>Webscraping will rise again.</div><br/></div></div></div></div><div id="36192200" class="c"><input type="checkbox" id="c-36192200" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190781">parent</a><span>|</span><a href="#36190898">prev</a><span>|</span><a href="#36193630">next</a><span>|</span><label class="collapse" for="c-36192200">[-]</label><label class="expand" for="c-36192200">[1 more]</label></div><br/><div class="children"><div class="content">&gt; We offered him API access for a fee, but any fee was too much for his business model.<p>At this point, wasn&#x27;t banning him in the cards?</div><br/></div></div></div></div><div id="36193630" class="c"><input type="checkbox" id="c-36193630" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190481">parent</a><span>|</span><a href="#36190781">prev</a><span>|</span><a href="#36189490">next</a><span>|</span><label class="collapse" for="c-36193630">[-]</label><label class="expand" for="c-36193630">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;xkcd.com&#x2F;1172&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;1172&#x2F;</a></div><br/></div></div></div></div><div id="36189490" class="c"><input type="checkbox" id="c-36189490" checked=""/><div class="controls bullet"><span class="by">b33j0r</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36188841">parent</a><span>|</span><a href="#36190481">prev</a><span>|</span><a href="#36192865">next</a><span>|</span><label class="collapse" for="c-36189490">[-]</label><label class="expand" for="c-36189490">[9 more]</label></div><br/><div class="children"><div class="content">Indeed. Tangentially, there is another side to the coin.<p>The antithesis of this is the contract model, when a client comes to you and asks you to make something specific, rather than describing what they need. In this case they are almost always wrong. They’ll rarely admit it unless you show them some amazing alternative, though.<p>Requirements = a set of problems to be solved. More often you get handed a diagram of a 12” tall Stonehenge sketched on a napkin with exceeding confidence that it will be 12 feet tall.<p>Then they yell at you for doing what they said.</div><br/><div id="36190541" class="c"><input type="checkbox" id="c-36190541" checked=""/><div class="controls bullet"><span class="by">jaredhallen</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36189490">parent</a><span>|</span><a href="#36190088">next</a><span>|</span><label class="collapse" for="c-36190541">[-]</label><label class="expand" for="c-36190541">[1 more]</label></div><br/><div class="children"><div class="content">This happens outside development, too. More often than not in IT, when the business has a need, they start with a solution and approach IT asking them to implement it. I&#x27;ve gotten better over the years (although always room to improve) at steering the conversation around to &quot;what exactly are you trying to accomplish?&quot; Let&#x27;s start there.</div><br/></div></div><div id="36190088" class="c"><input type="checkbox" id="c-36190088" checked=""/><div class="controls bullet"><span class="by">tshaddox</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36189490">parent</a><span>|</span><a href="#36190541">prev</a><span>|</span><a href="#36192486">next</a><span>|</span><label class="collapse" for="c-36190088">[-]</label><label class="expand" for="c-36190088">[6 more]</label></div><br/><div class="children"><div class="content">I.e. “If I had asked people what they wanted, they would have said faster horses.”<p>(Probably not a real quote, and probably not even accurate.)</div><br/><div id="36192351" class="c"><input type="checkbox" id="c-36192351" checked=""/><div class="controls bullet"><span class="by">theK</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190088">parent</a><span>|</span><a href="#36192355">next</a><span>|</span><label class="collapse" for="c-36192351">[-]</label><label class="expand" for="c-36192351">[1 more]</label></div><br/><div class="children"><div class="content">Regardless of the provenance of that quote, it is quite apt wrt IT clients. They always come asking for a faster horse, ie: something they know that is just better in a specific way.<p>A lot of the times this might be wrong but I think the interesting part is how that request gets handled.</div><br/></div></div><div id="36192355" class="c"><input type="checkbox" id="c-36192355" checked=""/><div class="controls bullet"><span class="by">fallous</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190088">parent</a><span>|</span><a href="#36192351">prev</a><span>|</span><a href="#36192036">next</a><span>|</span><label class="collapse" for="c-36192355">[-]</label><label class="expand" for="c-36192355">[1 more]</label></div><br/><div class="children"><div class="content">The quote is alleged to be Henry Ford, and I&#x27;ve always encountered it as &quot;better horse.&quot;<p>In either case, the customers aren&#x27;t stupid but instead are using the language and paradigm they are familiar with to describe their needs.  Ford did indeed provide a faster&#x2F;better horse, because the horse was the main means of non-human motive force in the US.<p>The technologist&#x27;s job is to understand the universal of possible solutions and to understand the customer&#x27;s needs and goals, which often includes interrogating and parsing the customer&#x27;s language&#x2F;worldview, and craft a product that achieves those needs&#x2F;goals (and doesn&#x27;t introduce negatives that overwhelm the benefits).</div><br/></div></div><div id="36192036" class="c"><input type="checkbox" id="c-36192036" checked=""/><div class="controls bullet"><span class="by">geophph</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190088">parent</a><span>|</span><a href="#36192355">prev</a><span>|</span><a href="#36190265">next</a><span>|</span><label class="collapse" for="c-36192036">[-]</label><label class="expand" for="c-36192036">[2 more]</label></div><br/><div class="children"><div class="content">And if I had told them I’d give them something that leads to excess deaths, climate change and urban sprawl they might have stuck to their horses.<p>&#x2F;s but maybe only half</div><br/><div id="36193845" class="c"><input type="checkbox" id="c-36193845" checked=""/><div class="controls bullet"><span class="by">bobthepanda</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36192036">parent</a><span>|</span><a href="#36190265">next</a><span>|</span><label class="collapse" for="c-36193845">[-]</label><label class="expand" for="c-36193845">[1 more]</label></div><br/><div class="children"><div class="content">The horses were themselves a more immediate sanitation problem; in New York alone there was a million pounds of horse manure every day, plus thousands of horses that dropped dead from overwork. Disposing of all the feces and corpses was a challenge.</div><br/></div></div></div></div><div id="36190265" class="c"><input type="checkbox" id="c-36190265" checked=""/><div class="controls bullet"><span class="by">quintes</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36190088">parent</a><span>|</span><a href="#36192036">prev</a><span>|</span><a href="#36192486">next</a><span>|</span><label class="collapse" for="c-36190265">[-]</label><label class="expand" for="c-36190265">[1 more]</label></div><br/><div class="children"><div class="content">It was Ford as I recall</div><br/></div></div></div></div><div id="36192486" class="c"><input type="checkbox" id="c-36192486" checked=""/><div class="controls bullet"><span class="by">moring</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36189490">parent</a><span>|</span><a href="#36190088">prev</a><span>|</span><a href="#36192865">next</a><span>|</span><label class="collapse" for="c-36192486">[-]</label><label class="expand" for="c-36192486">[1 more]</label></div><br/><div class="children"><div class="content">There is another side to this coin, too. It is clients that describe their needs, not some specific and wrong solution, and then either get told they did not do their homework, or their needs getting ignored by a dev who thinks he is smarter than the client in the client&#x27;s own field.<p>It is correct that &quot;Requirements = a set of problems&quot;, and therefore it does not make sense at all to repeatedly ask the client for a technical solution instead of asking for the problems to solve, and then be surprised that the client does not talk about problems anymore.</div><br/></div></div></div></div><div id="36192865" class="c"><input type="checkbox" id="c-36192865" checked=""/><div class="controls bullet"><span class="by">dumpsterdiver</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36188841">parent</a><span>|</span><a href="#36189490">prev</a><span>|</span><a href="#36188043">next</a><span>|</span><label class="collapse" for="c-36192865">[-]</label><label class="expand" for="c-36192865">[1 more]</label></div><br/><div class="children"><div class="content">Case in point, if you design an aircraft intended to safely transport people between destinations, they will create Kamikazes.</div><br/></div></div></div></div><div id="36188043" class="c"><input type="checkbox" id="c-36188043" checked=""/><div class="controls bullet"><span class="by">agumonkey</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36187909">parent</a><span>|</span><a href="#36188841">prev</a><span>|</span><a href="#36188295">next</a><span>|</span><label class="collapse" for="c-36188043">[-]</label><label class="expand" for="c-36188043">[2 more]</label></div><br/><div class="children"><div class="content">I saw the opposite happen so often and every time it&#x27;s very painful to see people have knee jerk reaction instead of thinking outside the box.</div><br/><div id="36194000" class="c"><input type="checkbox" id="c-36194000" checked=""/><div class="controls bullet"><span class="by">Shorel</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36188043">parent</a><span>|</span><a href="#36188295">next</a><span>|</span><label class="collapse" for="c-36194000">[-]</label><label class="expand" for="c-36194000">[1 more]</label></div><br/><div class="children"><div class="content">They don&#x27;t even need to think.<p>Just avoid the &quot;not invented here&quot; syndrome.</div><br/></div></div></div></div></div></div><div id="36188295" class="c"><input type="checkbox" id="c-36188295" checked=""/><div class="controls bullet"><span class="by">james-revisoai</span><span>|</span><a href="#36187779">parent</a><span>|</span><a href="#36187909">prev</a><span>|</span><a href="#36186904">next</a><span>|</span><label class="collapse" for="c-36188295">[-]</label><label class="expand" for="c-36188295">[2 more]</label></div><br/><div class="children"><div class="content">Did you detect this MixPanel or something?</div><br/><div id="36191248" class="c"><input type="checkbox" id="c-36191248" checked=""/><div class="controls bullet"><span class="by">jamest</span><span>|</span><a href="#36187779">root</a><span>|</span><a href="#36188295">parent</a><span>|</span><a href="#36186904">next</a><span>|</span><label class="collapse" for="c-36191248">[-]</label><label class="expand" for="c-36191248">[1 more]</label></div><br/><div class="children"><div class="content">We were talking to (and using the sites) of all our customers of any reasonable size. This was one of them.</div><br/></div></div></div></div></div></div><div id="36186904" class="c"><input type="checkbox" id="c-36186904" checked=""/><div class="controls bullet"><span class="by">Veserv</span><span>|</span><a href="#36187779">prev</a><span>|</span><a href="#36187106">next</a><span>|</span><label class="collapse" for="c-36186904">[-]</label><label class="expand" for="c-36186904">[6 more]</label></div><br/><div class="children"><div class="content">Very funny.<p>Also, you can actually make it cost competitive if the object you store is the last n milliseconds of packets instead of one packet each. So, instead of incurring two API calls per packet, you incur two API calls per minimum buffering time. If S3 is zero-rated for any ingress&#x2F;egress then you get “infinite” bandwidth for 4.22$ * 3 (for the active case) = 12.66$ a day if you are willing to accept 500 ms minimum latency, or ~600$ a day at a more reasonable 10 ms. If you are saturating even just a 1 Gb link for a whole day that is ~10,000 GB which would be ~700$ via the blessed channel, so you could very well come out ahead.<p>You could do even better if you out-of-band signal the readiness so you do not need to poll while idle. Then you only incur a cost while actively transmitting so as long as you average 1 Gb&#x2F;s on the channel you should be coming out even or ahead with minimal latency impact.</div><br/><div id="36187400" class="c"><input type="checkbox" id="c-36187400" checked=""/><div class="controls bullet"><span class="by">derefr</span><span>|</span><a href="#36186904">parent</a><span>|</span><a href="#36193342">next</a><span>|</span><label class="collapse" for="c-36187400">[-]</label><label class="expand" for="c-36187400">[4 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t theoretical; many companies do PostgreSQL async 1:N physical replication, by using e.g. <a href="https:&#x2F;&#x2F;pgbackrest.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;pgbackrest.org&#x2F;</a> to have the primary push WAL segment files (a.k.a. &quot;the last n milliseconds of packets&quot; in the write-ahead log) as objects to S3. All the read-replicas then independently discover the new objects in S3 as they become available; fetch them; and replay them.<p>&gt; You could do even better if you out-of-band signal the readiness so you do not need to poll while idle.<p>S3 and its clones have &quot;object lifecycle notifications&quot;, where you can be informed by a push-based mechanism whenever a new object is put into the bucket.<p>But — what do you have to do, to get these notifications?<p>Subscribe to a real message queue, that S3 puts these notifications into.<p>So using it here would be somewhat cheating ;)</div><br/><div id="36192402" class="c"><input type="checkbox" id="c-36192402" checked=""/><div class="controls bullet"><span class="by">Karrot_Kream</span><span>|</span><a href="#36186904">root</a><span>|</span><a href="#36187400">parent</a><span>|</span><a href="#36191136">next</a><span>|</span><label class="collapse" for="c-36192402">[-]</label><label class="expand" for="c-36192402">[1 more]</label></div><br/><div class="children"><div class="content">Yup we do something very similar for MySQL replication ourselves.</div><br/></div></div><div id="36191136" class="c"><input type="checkbox" id="c-36191136" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#36186904">root</a><span>|</span><a href="#36187400">parent</a><span>|</span><a href="#36192402">prev</a><span>|</span><a href="#36193342">next</a><span>|</span><label class="collapse" for="c-36191136">[-]</label><label class="expand" for="c-36191136">[2 more]</label></div><br/><div class="children"><div class="content">Can you failover&#x2F;promote using pgbackrest?</div><br/><div id="36192409" class="c"><input type="checkbox" id="c-36192409" checked=""/><div class="controls bullet"><span class="by">dikei</span><span>|</span><a href="#36186904">root</a><span>|</span><a href="#36191136">parent</a><span>|</span><a href="#36193342">next</a><span>|</span><label class="collapse" for="c-36192409">[-]</label><label class="expand" for="c-36192409">[1 more]</label></div><br/><div class="children"><div class="content">Not really, but you can use Patroni for that, which automatically promote one of your replica to master, it can also create the replica from WAL archive in S3 using wal-g&#x2F;pgbackrest.</div><br/></div></div></div></div></div></div><div id="36193342" class="c"><input type="checkbox" id="c-36193342" checked=""/><div class="controls bullet"><span class="by">KRAKRISMOTT</span><span>|</span><a href="#36186904">parent</a><span>|</span><a href="#36187400">prev</a><span>|</span><a href="#36187106">next</a><span>|</span><label class="collapse" for="c-36193342">[-]</label><label class="expand" for="c-36193342">[1 more]</label></div><br/><div class="children"><div class="content">Try it with CloudFlare&#x27;s S3 equivalent offering</div><br/></div></div></div></div><div id="36187106" class="c"><input type="checkbox" id="c-36187106" checked=""/><div class="controls bullet"><span class="by">tschumacher</span><span>|</span><a href="#36186904">prev</a><span>|</span><a href="#36186771">next</a><span>|</span><label class="collapse" for="c-36187106">[-]</label><label class="expand" for="c-36187106">[55 more]</label></div><br/><div class="children"><div class="content">I once used a MySQL database as a replacement for a message queue. This was the easiest solution to implement since all the servers were already connected to the database anyways. A server would write a new row to the table and all the servers would remember the last row they had already seen. Occasionally the table is cleared. I&#x27;m sure there are some race conditions in the system but its only purpose is to send Discord notifications when someone breaks a highscore in a video game, so its not really critical. It&#x27;s still working that way today.</div><br/><div id="36187506" class="c"><input type="checkbox" id="c-36187506" checked=""/><div class="controls bullet"><span class="by">hardwaresofton</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36187506">[-]</label><label class="expand" for="c-36187506">[26 more]</label></div><br/><div class="children"><div class="content">See also: postgres with SKIP LOCKED.<p>Great talk on it from Citus Con 2022:<p>Queues in PostgreSQL | Citus Con: An Event for Postgres 2022 -- <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=WIRy1Ws47ic&amp;list=PLlrxD0HtieHjSzUZYCMvqffEU5jykfPTd&amp;index=20">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=WIRy1Ws47ic&amp;list=PLlrxD0Htie...</a>)<p>Citus is a horizontal scale out extension for postgres -- imagine the power of those two things together!<p>JK you don&#x27;t have to imagine:<p><a href="https:&#x2F;&#x2F;www.citusdata.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;24&#x2F;citus-and-pg-partman-creating-a-scalable-time-series-database-on-postgresql&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.citusdata.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;24&#x2F;citus-and-pg-partm...</a></div><br/><div id="36193341" class="c"><input type="checkbox" id="c-36193341" checked=""/><div class="controls bullet"><span class="by">xvinci</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187506">parent</a><span>|</span><a href="#36187535">next</a><span>|</span><label class="collapse" for="c-36193341">[-]</label><label class="expand" for="c-36193341">[2 more]</label></div><br/><div class="children"><div class="content">Since you seem to be from citusdata: I used cstore_fdw 2 - 3 years back and at least when paired with TPC-H it was horrendously broken for both small (10 gig) and large (100 gig) datasets. It has been integrated into some other product by the time being, I hope you managed to improve it.</div><br/><div id="36193483" class="c"><input type="checkbox" id="c-36193483" checked=""/><div class="controls bullet"><span class="by">hardwaresofton</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36193341">parent</a><span>|</span><a href="#36187535">next</a><span>|</span><label class="collapse" for="c-36193483">[-]</label><label class="expand" for="c-36193483">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m <i>definitely</i> not from Citus data -- just a pg zealot fighting the culture war.<p>If you want to reach people who can actually help, you probably want to check this link:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;citusdata&#x2F;cstore_fdw&#x2F;issues">https:&#x2F;&#x2F;github.com&#x2F;citusdata&#x2F;cstore_fdw&#x2F;issues</a></div><br/></div></div></div></div><div id="36187535" class="c"><input type="checkbox" id="c-36187535" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187506">parent</a><span>|</span><a href="#36193341">prev</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36187535">[-]</label><label class="expand" for="c-36187535">[23 more]</label></div><br/><div class="children"><div class="content">I wrote an implementation in Python.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;starqueue&#x2F;starqueue">https:&#x2F;&#x2F;github.com&#x2F;starqueue&#x2F;starqueue</a><p>The code is in there for  Postgres, MS SQL and MySQL (which all support SKIP LOCKED) though at some point I abandoned all but Postgres.<p>If I was to write another message queue then I wouldn’t use a database, I’d use the file system based around Linux file moves, which are atomic. What I really want is a message queue that is fast and requires zero config, file based message queues are both…. better than a database.</div><br/><div id="36190475" class="c"><input type="checkbox" id="c-36190475" checked=""/><div class="controls bullet"><span class="by">don-code</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187535">parent</a><span>|</span><a href="#36187740">next</a><span>|</span><label class="collapse" for="c-36190475">[-]</label><label class="expand" for="c-36190475">[1 more]</label></div><br/><div class="children"><div class="content">I actually did this once (over SMB on Windows, though) - and unintentionally crippled our corporate SAN with all of its polling and locking activity. I had a cluster of 20 workers which would poll every five seconds for messages, and I believe we had an EMC VNX storage appliance. I never did figure out why that was enough to bring the whole thing to its knees, but IT was very quick to track the problem back to me.</div><br/></div></div><div id="36187740" class="c"><input type="checkbox" id="c-36187740" checked=""/><div class="controls bullet"><span class="by">gchq-7703</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187535">parent</a><span>|</span><a href="#36190475">prev</a><span>|</span><a href="#36188591">next</a><span>|</span><label class="collapse" for="c-36187740">[-]</label><label class="expand" for="c-36187740">[7 more]</label></div><br/><div class="children"><div class="content">Interesting.  What makes you want to switch to the file system?  I wrote one for a project[0] a while back (for MongoDB) and it didn&#x27;t seem like the database introduced too much complexity.  I didn&#x27;t write the implementation from scratch, but the couple hundred lines of code were easy to reason about.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;gchq&#x2F;Bailo&#x2F;tree&#x2F;main&#x2F;lib&#x2F;p-mongo-queue">https:&#x2F;&#x2F;github.com&#x2F;gchq&#x2F;Bailo&#x2F;tree&#x2F;main&#x2F;lib&#x2F;p-mongo-queue</a></div><br/><div id="36187810" class="c"><input type="checkbox" id="c-36187810" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187740">parent</a><span>|</span><a href="#36187944">next</a><span>|</span><label class="collapse" for="c-36187810">[-]</label><label class="expand" for="c-36187810">[5 more]</label></div><br/><div class="children"><div class="content">The filesystem means zero configuration.<p>I found almost all message queues to be horribly complex to configure, debug and run. Even database queues require a lot of config, relative to using the file system.<p>I did actually write a file system based message queue in Rust and it instantly maxed out the disk at about 30,000 messages a second. It did about 7 million messages a second when run as a purely RAM message queue but that didn’t use file system at all.<p>It depends what you’re doing of course… running a bank on a file system queue wouldn’t make sense.<p>A fast message queue should be a tiny executable that you run and you’re in business in seconds, no faffing around with even a minute of config.<p>I just hate configuration in general.</div><br/><div id="36193618" class="c"><input type="checkbox" id="c-36193618" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187810">parent</a><span>|</span><a href="#36190348">next</a><span>|</span><label class="collapse" for="c-36193618">[-]</label><label class="expand" for="c-36193618">[1 more]</label></div><br/><div class="children"><div class="content">Database config should be two connection strings, 1 for the admin user that creates the tables and anther for the queue user. Everything else should be stored in the database itself. Each queue should be in its own set of tables. Large blobs may or may not be referenced to an external file.<p>Shouldn&#x27;t a message send be worst case a CAS. It really seems like all the work around garbage collection would have some use for in-memory high speed queues.<p>Are you familiar with the LMAX Disruptor? Is is a Java based cross thread messaging library used for day trading applications.<p><a href="https:&#x2F;&#x2F;lmax-exchange.github.io&#x2F;disruptor&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lmax-exchange.github.io&#x2F;disruptor&#x2F;</a></div><br/></div></div><div id="36190348" class="c"><input type="checkbox" id="c-36190348" checked=""/><div class="controls bullet"><span class="by">orangepurple</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187810">parent</a><span>|</span><a href="#36193618">prev</a><span>|</span><a href="#36188152">next</a><span>|</span><label class="collapse" for="c-36190348">[-]</label><label class="expand" for="c-36190348">[2 more]</label></div><br/><div class="children"><div class="content">&gt; running a bank on a file system queue wouldn’t make sense<p>Bank transfers are done by a text file sent over FTP (file transfer protocol; circa 1971)<p><a href="https:&#x2F;&#x2F;orientalbank.com&#x2F;assets&#x2F;Pdfs&#x2F;ach&#x2F;ACH_ORIGINATION_AGREEMENT_JULY_2018.pdf" rel="nofollow">https:&#x2F;&#x2F;orientalbank.com&#x2F;assets&#x2F;Pdfs&#x2F;ach&#x2F;ACH_ORIGINATION_AGR...</a></div><br/><div id="36191633" class="c"><input type="checkbox" id="c-36191633" checked=""/><div class="controls bullet"><span class="by">lmz</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36190348">parent</a><span>|</span><a href="#36188152">next</a><span>|</span><label class="collapse" for="c-36191633">[-]</label><label class="expand" for="c-36191633">[1 more]</label></div><br/><div class="children"><div class="content">Some of them are more advanced and use SFTP (circa 1997).</div><br/></div></div></div></div><div id="36188152" class="c"><input type="checkbox" id="c-36188152" checked=""/><div class="controls bullet"><span class="by">Izkata</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187810">parent</a><span>|</span><a href="#36190348">prev</a><span>|</span><a href="#36187944">next</a><span>|</span><label class="collapse" for="c-36188152">[-]</label><label class="expand" for="c-36188152">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I did actually write a file system based message queue in Rust and it instantly maxed out the disk at about 30,000 messages a second. It did about 7 million messages a second when run as a purely RAM message queue but that didn’t use file system at all.<p>Did you try an in-memory filesystem through tmpfs?</div><br/></div></div></div></div></div></div><div id="36188591" class="c"><input type="checkbox" id="c-36188591" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187535">parent</a><span>|</span><a href="#36187740">prev</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36188591">[-]</label><label class="expand" for="c-36188591">[14 more]</label></div><br/><div class="children"><div class="content">I really feel like file systems aren&#x27;t used for enough things. File systems come with so much useful metadata.<p>I&#x27;ve experimented with using the file system for storing configuration data where each config value is a single file. Nested structures just use directories. The name of the file is the field name. The file extension is a hint about the data type contained within (.txt is obvious, but I also liked .bool). Parsing data is trivial. I don&#x27;t need any special viewing or editing tools, just a file manager and text editor. You can see when a specific config value was changed by checking the file update time. You don&#x27;t have to load the whole configuration just to access one field. And you could conceivably TAR up the whole thing if you wanted to transmit it somewhere.<p>I use it to configure little sub-projects in my personal website. I really like it, but I shudder to think of the complaining I&#x27;d hear from other developers if I ever used it in a work project, just because it&#x27;s not whatever they&#x27;ve ever seen before and would require a moment of two of thinking on their behalf to get over ingrained habits.</div><br/><div id="36189160" class="c"><input type="checkbox" id="c-36189160" checked=""/><div class="controls bullet"><span class="by">binwiederhier</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188591">parent</a><span>|</span><a href="#36192956">next</a><span>|</span><label class="collapse" for="c-36189160">[-]</label><label class="expand" for="c-36189160">[3 more]</label></div><br/><div class="children"><div class="content">A company I used to work for extensively used this method. It&#x27;s incredibly useful to be able to read a config or state value from any language and even bash scripts quickly.<p>However, and this is a big drawback, once you have too many config files and you start reading and writing from different processes, you get into bottleneck situations quickly.</div><br/><div id="36190882" class="c"><input type="checkbox" id="c-36190882" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189160">parent</a><span>|</span><a href="#36192956">next</a><span>|</span><label class="collapse" for="c-36190882">[-]</label><label class="expand" for="c-36190882">[2 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t used this system extensively yet. But I don&#x27;t really see how that situation gets improved by having a single-file configuration system.<p>First of all, if you have multiple processes trying to read&#x2F;write the same config, that&#x27;s kind of suspect, and if file I&#x2F;O is a bottleneck for your config system, that&#x27;s a different suspicious situation. Why are your processes writing to the config so... often?<p>But regardless, I can&#x27;t see how those problems get immediately better by storing that config in a single file. If anything, having it split across multiple files would improve the situation, as different processes that might only be concerned with different sections of the config won&#x27;t need to wait on file locks from process unrelated to their concerns.</div><br/><div id="36191015" class="c"><input type="checkbox" id="c-36191015" checked=""/><div class="controls bullet"><span class="by">binwiederhier</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36190882">parent</a><span>|</span><a href="#36192956">next</a><span>|</span><label class="collapse" for="c-36191015">[-]</label><label class="expand" for="c-36191015">[1 more]</label></div><br/><div class="children"><div class="content">I realize it may have sounded like I was suggesting the approach. Quite the contrary: I would never do that again or suggest it. I was merely pointing out that it was quite useful at times :-) We had lots of problems similar to what you were describing. Luckily that&#x27;s all in the past now.</div><br/></div></div></div></div></div></div><div id="36192956" class="c"><input type="checkbox" id="c-36192956" checked=""/><div class="controls bullet"><span class="by">avereveard</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188591">parent</a><span>|</span><a href="#36189160">prev</a><span>|</span><a href="#36189158">next</a><span>|</span><label class="collapse" for="c-36192956">[-]</label><label class="expand" for="c-36192956">[1 more]</label></div><br/><div class="children"><div class="content">Sprinkle git on top of it and you also get your config versioned and distributed centrally in lock step with your software releases</div><br/></div></div><div id="36189158" class="c"><input type="checkbox" id="c-36189158" checked=""/><div class="controls bullet"><span class="by">bboygravity</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188591">parent</a><span>|</span><a href="#36192956">prev</a><span>|</span><a href="#36191885">next</a><span>|</span><label class="collapse" for="c-36189158">[-]</label><label class="expand" for="c-36189158">[3 more]</label></div><br/><div class="children"><div class="content">Sounds very much like how .ini files work and&#x2F;or how regedit works on windows? :p<p>Not a bad idea at all, but perhaps re-inventing a very old wheel?</div><br/><div id="36190148" class="c"><input type="checkbox" id="c-36190148" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189158">parent</a><span>|</span><a href="#36191885">next</a><span>|</span><label class="collapse" for="c-36190148">[-]</label><label class="expand" for="c-36190148">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not at all like INI files. INI files have field names and section delimiters in them. An INI files might be:<p><pre><code>  [UI]
  DarkMode=1
  Theme=solarized
  [Options]
  Indent=4
  InventMode=tabs
</code></pre>
Whereas this file system config would have individual files per value.<p><pre><code>  &lt;user-home&gt;&#x2F;.config&#x2F;&lt;app-name&gt;&#x2F;UI&#x2F;DarkMode.bool --&gt; 1
</code></pre>
It&#x27;s a single byte file. You read the entire file contents and if it&#x27;s not zero, it&#x27;s true. The existence of the file tells you whether or not to use a default value. An INI file would have to be fully parsed before we know whether it contains a value for that config value.<p><pre><code>  &lt;user-home&gt;&#x2F;.config&#x2F;&lt;app-name&gt;&#x2F;UI&#x2F;Theme.txt --&gt; solarized
</code></pre>
You read the entire file contents, trim leading and trailing whitespace and toLower for good measure if you want, then validate against your list of installed themes. Done. No goofy JSON or YAML parser in site.<p>And what reinvention is there? If you&#x27;re just using a system that already exists, you&#x27;re not reinventing anything.</div><br/><div id="36191910" class="c"><input type="checkbox" id="c-36191910" checked=""/><div class="controls bullet"><span class="by">x-shadowban</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36190148">parent</a><span>|</span><a href="#36191885">next</a><span>|</span><label class="collapse" for="c-36191910">[-]</label><label class="expand" for="c-36191910">[1 more]</label></div><br/><div class="children"><div class="content">Sort of an homage to the windows registry, but it&#x27;s not a &quot;secret 3rd thing&quot; it&#x27;s just another folder.</div><br/></div></div></div></div></div></div><div id="36188760" class="c"><input type="checkbox" id="c-36188760" checked=""/><div class="controls bullet"><span class="by">djbusby</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188591">parent</a><span>|</span><a href="#36191885">prev</a><span>|</span><a href="#36190840">next</a><span>|</span><label class="collapse" for="c-36188760">[-]</label><label class="expand" for="c-36188760">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve done and do this too. Its worked awesome for 20+ years.</div><br/><div id="36188893" class="c"><input type="checkbox" id="c-36188893" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188760">parent</a><span>|</span><a href="#36190840">next</a><span>|</span><label class="collapse" for="c-36188893">[-]</label><label class="expand" for="c-36188893">[1 more]</label></div><br/><div class="children"><div class="content">Oh man, symlinks to share common configuration.</div><br/></div></div></div></div><div id="36190840" class="c"><input type="checkbox" id="c-36190840" checked=""/><div class="controls bullet"><span class="by">mixmastamyk</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188591">parent</a><span>|</span><a href="#36188760">prev</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36190840">[-]</label><label class="expand" for="c-36190840">[3 more]</label></div><br/><div class="children"><div class="content">This was tried and called Elektra I think around Y2K.  Don’t believe the idea was even new then, but there was also research into tiny file performance at the time, resulting in things like reiserfs.  I think it packed tiny files into the directory itself resulting in blistering speed.<p>Anyway it’s an elegant idea.  Silly to have dozens of config file formats when the fs already has everything it needs.  We have xattr too.<p>The flaw on the OS level is that it is hard to get everyone to change.  For new apps not a problem, and any performance concerns are no longer an issue for config.</div><br/><div id="36190991" class="c"><input type="checkbox" id="c-36190991" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36190840">parent</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36190991">[-]</label><label class="expand" for="c-36190991">[2 more]</label></div><br/><div class="children"><div class="content">Oh man, reiserfs. Seeing that name reminds me that the original developer, Hans Reiser, is currently spending time in prison for murdering his wife. She was the interpreter during his first meeting with a Russian &quot;mail-order bride&quot;.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hans_Reiser" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hans_Reiser</a></div><br/><div id="36191468" class="c"><input type="checkbox" id="c-36191468" checked=""/><div class="controls bullet"><span class="by">wombatpm</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36190991">parent</a><span>|</span><a href="#36187408">next</a><span>|</span><label class="collapse" for="c-36191468">[-]</label><label class="expand" for="c-36191468">[1 more]</label></div><br/><div class="children"><div class="content">That was an ugly situation. PSA: Murdering your wife&#x2F;exwife&#x2F;girlfriend&#x2F;baby mama is never the answer. Just let it go and move on.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="36187408" class="c"><input type="checkbox" id="c-36187408" checked=""/><div class="controls bullet"><span class="by">Ozzie_osman</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187506">prev</a><span>|</span><a href="#36191914">next</a><span>|</span><label class="collapse" for="c-36187408">[-]</label><label class="expand" for="c-36187408">[3 more]</label></div><br/><div class="children"><div class="content">This is actually pretty common, and usually a &quot;good enough&quot; solution. You can also add things like scheduling (add a run_at column), at least once execution (mark a row when it is being processed, delete it only when successful), topics, etc with minor modifications to your table.<p>If you want something that works &quot;well enough&quot; I&#x27;d say it&#x27;s a reasonable choice.</div><br/><div id="36187580" class="c"><input type="checkbox" id="c-36187580" checked=""/><div class="controls bullet"><span class="by">larperdoodle</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187408">parent</a><span>|</span><a href="#36191914">next</a><span>|</span><label class="collapse" for="c-36187580">[-]</label><label class="expand" for="c-36187580">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, I&#x27;m using it as a transactional outbox to ensure at least once delivery to SNS.<p>Can&#x27;t really think of a better way to ensure that a message is always sent if the DB transactions succeeds and is never sent if the DB transaction fails</div><br/><div id="36187728" class="c"><input type="checkbox" id="c-36187728" checked=""/><div class="controls bullet"><span class="by">Ozzie_osman</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187580">parent</a><span>|</span><a href="#36191914">next</a><span>|</span><label class="collapse" for="c-36187728">[-]</label><label class="expand" for="c-36187728">[1 more]</label></div><br/><div class="children"><div class="content">You can get so far by ensuring at least once and making everything idempotent (will get you as close to &quot;exactly once&quot; as you can). With a database, the most common pattern is: insert the row for the job, when a worker starts working on it, mark it as in progress so it doesn&#x27;t get started again, if the task fails, or after some reasonable time-out period, another worker can pick up the task again, ultimately the row for the task is only ever deleted when a worker successfully completes it.</div><br/></div></div></div></div></div></div><div id="36191914" class="c"><input type="checkbox" id="c-36191914" checked=""/><div class="controls bullet"><span class="by">waplot</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187408">prev</a><span>|</span><a href="#36187356">next</a><span>|</span><label class="collapse" for="c-36191914">[-]</label><label class="expand" for="c-36191914">[1 more]</label></div><br/><div class="children"><div class="content">Nothing wrong with using the DB as a mq, especially if the load is small enough. 
Plenty of tools are built on that, these two come to mind<p><a href="https:&#x2F;&#x2F;github.com&#x2F;procrastinate-org&#x2F;procrastinate">https:&#x2F;&#x2F;github.com&#x2F;procrastinate-org&#x2F;procrastinate</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;bensheldon&#x2F;good_job">https:&#x2F;&#x2F;github.com&#x2F;bensheldon&#x2F;good_job</a></div><br/></div></div><div id="36187356" class="c"><input type="checkbox" id="c-36187356" checked=""/><div class="controls bullet"><span class="by">bob1029</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36191914">prev</a><span>|</span><a href="#36187232">next</a><span>|</span><label class="collapse" for="c-36187356">[-]</label><label class="expand" for="c-36187356">[5 more]</label></div><br/><div class="children"><div class="content">I am doing the same with SQL Server. The messages table is more of a bus than a queue in our case (columns like ReplyToId, etc). Using it for RPC communication between cloud bits. Much cheaper than Azure Service Bus and friends.</div><br/><div id="36188860" class="c"><input type="checkbox" id="c-36188860" checked=""/><div class="controls bullet"><span class="by">Digit-Al</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187356">parent</a><span>|</span><a href="#36187468">next</a><span>|</span><label class="collapse" for="c-36188860">[-]</label><label class="expand" for="c-36188860">[3 more]</label></div><br/><div class="children"><div class="content">Just out of interest: any reason you&#x27;re not using the SQL server service broker?</div><br/><div id="36189417" class="c"><input type="checkbox" id="c-36189417" checked=""/><div class="controls bullet"><span class="by">nickpeterson</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188860">parent</a><span>|</span><a href="#36189362">next</a><span>|</span><label class="collapse" for="c-36189417">[-]</label><label class="expand" for="c-36189417">[1 more]</label></div><br/><div class="children"><div class="content">I don’t know the OPs answer, but I’d hazard to guess because ssmb is a completely neglected feature with very little in the way of community or UI. In theory it would be great, but MS basically never invested in it after its release and now it’s just a random, “who knows when we’ll drop support for this” sql server feature.</div><br/></div></div><div id="36189362" class="c"><input type="checkbox" id="c-36189362" checked=""/><div class="controls bullet"><span class="by">bob1029</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188860">parent</a><span>|</span><a href="#36189417">prev</a><span>|</span><a href="#36187468">next</a><span>|</span><label class="collapse" for="c-36189362">[-]</label><label class="expand" for="c-36189362">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s only available in managed instances or on-prem. We are trying to use the &quot;serverless&quot; flavor of Azure SQL throughout:<p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;azure-sql&#x2F;database&#x2F;features-comparison?view=azuresql" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;azure-sql&#x2F;database&#x2F;f...</a></div><br/></div></div></div></div></div></div><div id="36187232" class="c"><input type="checkbox" id="c-36187232" checked=""/><div class="controls bullet"><span class="by">UniverseHacker</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187356">prev</a><span>|</span><a href="#36192938">next</a><span>|</span><label class="collapse" for="c-36187232">[-]</label><label class="expand" for="c-36187232">[1 more]</label></div><br/><div class="children"><div class="content">Why not sqlite with a lockfile? &#x2F;s</div><br/></div></div><div id="36192938" class="c"><input type="checkbox" id="c-36192938" checked=""/><div class="controls bullet"><span class="by">avereveard</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187232">prev</a><span>|</span><a href="#36189893">next</a><span>|</span><label class="collapse" for="c-36192938">[-]</label><label class="expand" for="c-36192938">[1 more]</label></div><br/><div class="children"><div class="content">Nuxeo unironically used a db table as a pub sub system between the cluster nodes for cache invalidations.</div><br/></div></div><div id="36189893" class="c"><input type="checkbox" id="c-36189893" checked=""/><div class="controls bullet"><span class="by">rollcat</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36192938">prev</a><span>|</span><a href="#36187471">next</a><span>|</span><label class="collapse" for="c-36189893">[-]</label><label class="expand" for="c-36189893">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve built a hybrid task queue&#x2F;process supervisor on top of SQL. Classical task queues like Celery didn&#x27;t exactly fit our use case: a single process could run for hours or days, but in case of a node failing, it must be resurrected elsewhere as soon as possible (within seconds). I didn&#x27;t have the time to re-architect everything for Kubernetes, or rewrite half the product in Erlang; so I built that weird thing. It&#x27;s been super stable, running mission critical code, and making us money - for several years now.</div><br/><div id="36191483" class="c"><input type="checkbox" id="c-36191483" checked=""/><div class="controls bullet"><span class="by">wombatpm</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189893">parent</a><span>|</span><a href="#36187471">next</a><span>|</span><label class="collapse" for="c-36191483">[-]</label><label class="expand" for="c-36191483">[1 more]</label></div><br/><div class="children"><div class="content">I’ve yet to find the project where Celery is the best solution, despite using it on several</div><br/></div></div></div></div><div id="36187328" class="c"><input type="checkbox" id="c-36187328" checked=""/><div class="controls bullet"><span class="by">renewiltord</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187471">prev</a><span>|</span><a href="#36188439">next</a><span>|</span><label class="collapse" for="c-36187328">[-]</label><label class="expand" for="c-36187328">[3 more]</label></div><br/><div class="children"><div class="content">Segment did so quite successfully <a href="https:&#x2F;&#x2F;segment.com&#x2F;blog&#x2F;introducing-centrifuge&#x2F;" rel="nofollow">https:&#x2F;&#x2F;segment.com&#x2F;blog&#x2F;introducing-centrifuge&#x2F;</a></div><br/><div id="36190005" class="c"><input type="checkbox" id="c-36190005" checked=""/><div class="controls bullet"><span class="by">hu3</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187328">parent</a><span>|</span><a href="#36187765">next</a><span>|</span><label class="collapse" for="c-36190005">[-]</label><label class="expand" for="c-36190005">[1 more]</label></div><br/><div class="children"><div class="content">&gt; We decided to store Centrifuge data inside Amazon’s RDS instances running on MySQL. RDS gives us managed datastores, and MySQL provides us with the ability to re-order our jobs.<p>Interesting. Thanks for sharing</div><br/></div></div><div id="36187765" class="c"><input type="checkbox" id="c-36187765" checked=""/><div class="controls bullet"><span class="by">pinkcan</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36187328">parent</a><span>|</span><a href="#36190005">prev</a><span>|</span><a href="#36188439">next</a><span>|</span><label class="collapse" for="c-36187765">[-]</label><label class="expand" for="c-36187765">[1 more]</label></div><br/><div class="children"><div class="content">every half year or so I remember centrifuge, and get a little sad they didn&#x27;t write more about it</div><br/></div></div></div></div><div id="36188439" class="c"><input type="checkbox" id="c-36188439" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36187328">prev</a><span>|</span><a href="#36189830">next</a><span>|</span><label class="collapse" for="c-36188439">[-]</label><label class="expand" for="c-36188439">[3 more]</label></div><br/><div class="children"><div class="content">I briefly worked for a major corporation 15 years ago that did this with SQL Server to create distributed worker processes to handle all the AI-generated used car listings and photo recolorings [0] for almost all of the used car lots in the country.<p>[0] Why take hundreds of photos of Honda Civics in red, green, blue, and black when you already have a dozen in white?</div><br/><div id="36188913" class="c"><input type="checkbox" id="c-36188913" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188439">parent</a><span>|</span><a href="#36189830">next</a><span>|</span><label class="collapse" for="c-36188913">[-]</label><label class="expand" for="c-36188913">[2 more]</label></div><br/><div class="children"><div class="content">Why even take the dozen in white when they have a model you can render in any manner? Most car commercials do not have real cars in them. Maybe the shots of a car actually in motion, but most of the static shots are 3D models placed onto backgrounds. I don&#x27;t know why, but I was surprised by this when I worked in a post house that did a lot of car commercials. One of the roles for a coworker was to get flown around to locations to take the images for the background plates using photogrammetry. &quot;Can&#x27;t fly an Alexa through the back glass to zoom in on the dash now can we&quot; was one comment.</div><br/><div id="36189047" class="c"><input type="checkbox" id="c-36189047" checked=""/><div class="controls bullet"><span class="by">moron4hire</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188913">parent</a><span>|</span><a href="#36189830">next</a><span>|</span><label class="collapse" for="c-36189047">[-]</label><label class="expand" for="c-36189047">[1 more]</label></div><br/><div class="children"><div class="content">Again, 15 years ago, this was a web app company, and Honda ain&#x27;t giving any models to no used care sales anything.</div><br/></div></div></div></div></div></div><div id="36189830" class="c"><input type="checkbox" id="c-36189830" checked=""/><div class="controls bullet"><span class="by">aa-jv</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36188439">prev</a><span>|</span><a href="#36188691">next</a><span>|</span><label class="collapse" for="c-36189830">[-]</label><label class="expand" for="c-36189830">[1 more]</label></div><br/><div class="children"><div class="content">This has been a thing since before databases were relational.  4G languages (Progress, etc.) were especially nice for their ability to wrap a queue table around a series of reversible transactions, if you coded things right .. meaning a lot of modules written for app infrastructure were based on an &#x27;inbox table&#x27; methodology ..</div><br/></div></div><div id="36188691" class="c"><input type="checkbox" id="c-36188691" checked=""/><div class="controls bullet"><span class="by">scarface74</span><span>|</span><a href="#36187106">parent</a><span>|</span><a href="#36189830">prev</a><span>|</span><a href="#36186771">next</a><span>|</span><label class="collapse" for="c-36188691">[-]</label><label class="expand" for="c-36188691">[7 more]</label></div><br/><div class="children"><div class="content">I’ve run into all sorts of database locking issues and concurrency issues when using a database as a queue.  I saw that mistake made a long time ago and I would never do it myself.</div><br/><div id="36189090" class="c"><input type="checkbox" id="c-36189090" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36188691">parent</a><span>|</span><a href="#36186771">next</a><span>|</span><label class="collapse" for="c-36189090">[-]</label><label class="expand" for="c-36189090">[6 more]</label></div><br/><div class="children"><div class="content">Database engines are getting features like SELECT FOR UPDATE SKIP LOCKED, so what were once serious blockers on this idea may no longer be as much of a problem.</div><br/><div id="36191524" class="c"><input type="checkbox" id="c-36191524" checked=""/><div class="controls bullet"><span class="by">wombatpm</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189090">parent</a><span>|</span><a href="#36189184">next</a><span>|</span><label class="collapse" for="c-36191524">[-]</label><label class="expand" for="c-36191524">[2 more]</label></div><br/><div class="children"><div class="content">Is that necessary if you can just have your processes handle locking themselves?</div><br/><div id="36192118" class="c"><input type="checkbox" id="c-36192118" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36191524">parent</a><span>|</span><a href="#36189184">next</a><span>|</span><label class="collapse" for="c-36192118">[-]</label><label class="expand" for="c-36192118">[1 more]</label></div><br/><div class="children"><div class="content">It’s not <i>necessary,</i> but it is a lot less fiddly: you automatically look at only the tasks that someone else isn’t currently working on, and because the lock is held by the database connection you get automatic retries if your worker crashes and drops the connection. You could figure out all of the interactions needed to make this work yourself, but if the database already has support built in you may as well use it (and there’s a straightforward path to migrate if you need more sophistication later).</div><br/></div></div></div></div><div id="36189161" class="c"><input type="checkbox" id="c-36189161" checked=""/><div class="controls bullet"><span class="by">scarface74</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189090">parent</a><span>|</span><a href="#36189184">prev</a><span>|</span><a href="#36186771">next</a><span>|</span><label class="collapse" for="c-36189161">[-]</label><label class="expand" for="c-36189161">[2 more]</label></div><br/><div class="children"><div class="content">And if you skip records that you are depending on for your poor man’s queue, aren’t you just hiding bugs?</div><br/><div id="36189365" class="c"><input type="checkbox" id="c-36189365" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#36187106">root</a><span>|</span><a href="#36189161">parent</a><span>|</span><a href="#36186771">next</a><span>|</span><label class="collapse" for="c-36189365">[-]</label><label class="expand" for="c-36189365">[1 more]</label></div><br/><div class="children"><div class="content">No? Unless there&#x27;s some edge case with that statement I don&#x27;t know about. That statement is basically tailor made for queues so you can select jobs that aren&#x27;t currently being worked on by other workers.<p>Inasmuch as you trust your db&#x27;s locking correctness it eliminates the concurrency issues. You can very naively have n workers pulling jobs from a queue not stepping on each-other.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="36186771" class="c"><input type="checkbox" id="c-36186771" checked=""/><div class="controls bullet"><span class="by">whartung</span><span>|</span><a href="#36187106">prev</a><span>|</span><a href="#36191034">next</a><span>|</span><label class="collapse" for="c-36186771">[-]</label><label class="expand" for="c-36186771">[18 more]</label></div><br/><div class="children"><div class="content">I know of a Famous Large Company that used email as their message queue to synchronize the data across two of their large systems.<p>It&#x27;s a perfectly apt message queue, just a bit heavyweight. But if it&#x27;s &quot;light enough&quot;, it comes &quot;for free&quot; with many OSes.</div><br/><div id="36190334" class="c"><input type="checkbox" id="c-36190334" checked=""/><div class="controls bullet"><span class="by">anotherevan</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36186846">next</a><span>|</span><label class="collapse" for="c-36190334">[-]</label><label class="expand" for="c-36190334">[3 more]</label></div><br/><div class="children"><div class="content">One of my customers used email (a gmail account, no less) as a message queue between their front end site and the back-office processor. This worked quite well for close to a decade I think.<p>It basically evolved from when applications from their original customer facing site were emailed and manually entered into the back-office system by a human. They were looking to automate this with a minimum of changes to too many of the moving parts at once, so I reformatted the sent email to contain an XML payload so the new back-office automation could read and process it (and in a pinch, a human could still review any problem applications) using Java&#x27;s mail APIs.<p>Things evolved, the front-end web site got replaced with a Wordpress site, but the email message queue kept working for a long time. In the last year or so it was getting more and more onerous though. Reconciling information between the front-end and the mail box showed not all emails were being delivered, and authentication to gmail was becoming more and more of a burdensome moving target.<p>I just recently replaced the whole thing with an API call made from the back-office to the Wordpress site to access the stored data. (The original site didn&#x27;t store, just emailed, which was why this was not an option historically.)</div><br/><div id="36190435" class="c"><input type="checkbox" id="c-36190435" checked=""/><div class="controls bullet"><span class="by">schwartzworld</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36190334">parent</a><span>|</span><a href="#36186846">next</a><span>|</span><label class="collapse" for="c-36190435">[-]</label><label class="expand" for="c-36190435">[2 more]</label></div><br/><div class="children"><div class="content">I wrote a static site generator with comments that used email as an ingestion cue.</div><br/><div id="36193779" class="c"><input type="checkbox" id="c-36193779" checked=""/><div class="controls bullet"><span class="by">klysm</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36190435">parent</a><span>|</span><a href="#36186846">next</a><span>|</span><label class="collapse" for="c-36193779">[-]</label><label class="expand" for="c-36193779">[1 more]</label></div><br/><div class="children"><div class="content">Queue?</div><br/></div></div></div></div></div></div><div id="36186846" class="c"><input type="checkbox" id="c-36186846" checked=""/><div class="controls bullet"><span class="by">doubled112</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36190334">prev</a><span>|</span><a href="#36187362">next</a><span>|</span><label class="collapse" for="c-36186846">[-]</label><label class="expand" for="c-36186846">[6 more]</label></div><br/><div class="children"><div class="content">Email is a message queue in the most literal of senses, isn&#x27;t it?</div><br/><div id="36186851" class="c"><input type="checkbox" id="c-36186851" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36186846">parent</a><span>|</span><a href="#36187362">next</a><span>|</span><label class="collapse" for="c-36186851">[-]</label><label class="expand" for="c-36186851">[5 more]</label></div><br/><div class="children"><div class="content">Yes, it&#x27;s actually somewhat of a decent (if cursed) message queue for many usecases too. Not to mention the debuggability (you already know how to use an email client).</div><br/><div id="36187195" class="c"><input type="checkbox" id="c-36187195" checked=""/><div class="controls bullet"><span class="by">marcosdumay</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36186851">parent</a><span>|</span><a href="#36186970">next</a><span>|</span><label class="collapse" for="c-36187195">[-]</label><label class="expand" for="c-36187195">[2 more]</label></div><br/><div class="children"><div class="content">&gt; if cursed<p>As long as you keep it internal-only, get a reliable server that doesn&#x27;t do any anti-spam shit (AKA, nothing from MS or any other large company), doesn&#x27;t use some unreliable proprietary database (again no MS), and have a reliable journaled disk, your only important failure mode will be losing disks. That&#x27;s an easy failure mode to deal with.</div><br/><div id="36190843" class="c"><input type="checkbox" id="c-36190843" checked=""/><div class="controls bullet"><span class="by">alduin32</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36187195">parent</a><span>|</span><a href="#36186970">next</a><span>|</span><label class="collapse" for="c-36190843">[-]</label><label class="expand" for="c-36190843">[1 more]</label></div><br/><div class="children"><div class="content">I love email, and to me it is a very important part of our infrastructure, but it is quite cursed as an arbitrary transport. The semantics are very complex, and any transported data will generally need to be encoded as base64, which is very inefficient.<p>You also need to add misbehaving clients on your list of things not to use with a message-queue, just opening the queue&#x27;s folder on Outlook to inspect it may be enough to completely corrupt it (Outlook will happily reorder, even rewrite, header fields of incoming messages, replicate messages to infinity, or who knows what else).<p>I&#x27;d be worried to have a message queue that is compatible with such a cursed ecosystem and transport protocol.</div><br/></div></div></div></div><div id="36186970" class="c"><input type="checkbox" id="c-36186970" checked=""/><div class="controls bullet"><span class="by">Ozzie_osman</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36186851">parent</a><span>|</span><a href="#36187195">prev</a><span>|</span><a href="#36187362">next</a><span>|</span><label class="collapse" for="c-36186970">[-]</label><label class="expand" for="c-36186970">[2 more]</label></div><br/><div class="children"><div class="content">You could use Slack, too.</div><br/><div id="36189443" class="c"><input type="checkbox" id="c-36189443" checked=""/><div class="controls bullet"><span class="by">flir</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36186970">parent</a><span>|</span><a href="#36187362">next</a><span>|</span><label class="collapse" for="c-36189443">[-]</label><label class="expand" for="c-36189443">[1 more]</label></div><br/><div class="children"><div class="content">Email keeps everything on-prem.</div><br/></div></div></div></div></div></div></div></div><div id="36187362" class="c"><input type="checkbox" id="c-36187362" checked=""/><div class="controls bullet"><span class="by">EvanAnderson</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36186846">prev</a><span>|</span><a href="#36187108">next</a><span>|</span><label class="collapse" for="c-36187362">[-]</label><label class="expand" for="c-36187362">[1 more]</label></div><br/><div class="children"><div class="content">Active Directory is (was?) capable of running replication traffic (for very particular use cases) over SMTP. I always thought that was ingenious.</div><br/></div></div><div id="36187108" class="c"><input type="checkbox" id="c-36187108" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36187362">prev</a><span>|</span><a href="#36190128">next</a><span>|</span><label class="collapse" for="c-36187108">[-]</label><label class="expand" for="c-36187108">[1 more]</label></div><br/><div class="children"><div class="content">A famous financial news paper used an FTP server as its kafka &quot;fan in&quot; node.<p>It was so old that the 1u case started to droop in the middle. (it was an sparc something or other with real SCSI ultra 320 drives in them)</div><br/></div></div><div id="36190128" class="c"><input type="checkbox" id="c-36190128" checked=""/><div class="controls bullet"><span class="by">simonjgreen</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36187108">prev</a><span>|</span><a href="#36188102">next</a><span>|</span><label class="collapse" for="c-36190128">[-]</label><label class="expand" for="c-36190128">[1 more]</label></div><br/><div class="children"><div class="content">Before there was REST and other http based standards ebXML was a hotness and tools like bizspark etc. You could see the logical progression through:<p>I fill in the order form and post it. They mail back an invoice.<p>I fax the order form, they fax back an invoice.<p>My computer sends the order form in a structured way over email.<p>My computer sends the order form in a structured way over http.<p>And that&#x27;s why many large telcos and banks still use ebXML in their B2B transactions. It&#x27;s fundamentally the same business process and logic it&#x27;s always been, with glacially slow improvement in performance over time.</div><br/></div></div><div id="36188102" class="c"><input type="checkbox" id="c-36188102" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36190128">prev</a><span>|</span><a href="#36189124">next</a><span>|</span><label class="collapse" for="c-36188102">[-]</label><label class="expand" for="c-36188102">[1 more]</label></div><br/><div class="children"><div class="content">I co-founded a webmail provider in &#x27;99, and when we needed a message queue reaching for our heavily customized Qmail setup was a relatively natural choice. I&#x27;ve mentioned it here before. Provides all the routing and retries we needed, and made debugging trivial (e-mail from our desktop clients to the queues worked; cc:&#x27;ing a real mailbox with copies worked; checking out queues with POP3 worked...)</div><br/></div></div><div id="36189124" class="c"><input type="checkbox" id="c-36189124" checked=""/><div class="controls bullet"><span class="by">ahefner</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36188102">prev</a><span>|</span><a href="#36187421">next</a><span>|</span><label class="collapse" for="c-36189124">[-]</label><label class="expand" for="c-36189124">[1 more]</label></div><br/><div class="children"><div class="content">I always thought using e-mail in this would be good for systems that occasionally need a human in the loop. Normally one service processes and mails results to the next, occasionally something is forwarded to a human, who can make some decision, edit the mail, then forward it along back into the automated path.</div><br/></div></div><div id="36187421" class="c"><input type="checkbox" id="c-36187421" checked=""/><div class="controls bullet"><span class="by">lucianbr</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36189124">prev</a><span>|</span><a href="#36187291">next</a><span>|</span><label class="collapse" for="c-36187421">[-]</label><label class="expand" for="c-36187421">[1 more]</label></div><br/><div class="children"><div class="content">Using SMTP to transfer messages seems just plain common sense. Far different than IPv6-over-S3.</div><br/></div></div><div id="36187291" class="c"><input type="checkbox" id="c-36187291" checked=""/><div class="controls bullet"><span class="by">c54</span><span>|</span><a href="#36186771">parent</a><span>|</span><a href="#36187421">prev</a><span>|</span><a href="#36191034">next</a><span>|</span><label class="collapse" for="c-36187291">[-]</label><label class="expand" for="c-36187291">[2 more]</label></div><br/><div class="children"><div class="content">Ha! I think i know what company you’re referring to</div><br/><div id="36187489" class="c"><input type="checkbox" id="c-36187489" checked=""/><div class="controls bullet"><span class="by">SteveNuts</span><span>|</span><a href="#36186771">root</a><span>|</span><a href="#36187291">parent</a><span>|</span><a href="#36191034">next</a><span>|</span><label class="collapse" for="c-36187489">[-]</label><label class="expand" for="c-36187489">[1 more]</label></div><br/><div class="children"><div class="content">Oracle came to my mind but I&#x27;m sure it&#x27;s in common use in many places</div><br/></div></div></div></div></div></div><div id="36191034" class="c"><input type="checkbox" id="c-36191034" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36186771">prev</a><span>|</span><a href="#36189632">next</a><span>|</span><label class="collapse" for="c-36191034">[-]</label><label class="expand" for="c-36191034">[5 more]</label></div><br/><div class="children"><div class="content">I was hoping someone would notice this by arguing about my pricing estimates in the arguments, but nobody did so I&#x27;m gonna spoil the surprise: if you have JavaScript enabled your browser will render slightly different prices if you view this post from Hacker News. This will persist to when you visit from not-Hacker News too, just so you don&#x27;t notice the difference. The prices range from 0.8x to 5x the ones I figured out in the AWS calculator.<p>If you want to see how I did it, view source and search &quot;gaslight&quot;.</div><br/><div id="36191500" class="c"><input type="checkbox" id="c-36191500" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#36191034">parent</a><span>|</span><a href="#36191174">next</a><span>|</span><label class="collapse" for="c-36191500">[-]</label><label class="expand" for="c-36191500">[1 more]</label></div><br/><div class="children"><div class="content">If you have to point out how clever you are, you&#x27;re probably not as clever as you think you are</div><br/></div></div><div id="36191174" class="c"><input type="checkbox" id="c-36191174" checked=""/><div class="controls bullet"><span class="by">mkl</span><span>|</span><a href="#36191034">parent</a><span>|</span><a href="#36191500">prev</a><span>|</span><a href="#36189632">next</a><span>|</span><label class="collapse" for="c-36191174">[-]</label><label class="expand" for="c-36191174">[3 more]</label></div><br/><div class="children"><div class="content">Um... why?</div><br/><div id="36191250" class="c"><input type="checkbox" id="c-36191250" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36191034">root</a><span>|</span><a href="#36191174">parent</a><span>|</span><a href="#36189632">next</a><span>|</span><label class="collapse" for="c-36191250">[-]</label><label class="expand" for="c-36191250">[2 more]</label></div><br/><div class="children"><div class="content">Because I thought it could be fun if people took the bait lol</div><br/><div id="36192539" class="c"><input type="checkbox" id="c-36192539" checked=""/><div class="controls bullet"><span class="by">stingraycharles</span><span>|</span><a href="#36191034">root</a><span>|</span><a href="#36191250">parent</a><span>|</span><a href="#36189632">next</a><span>|</span><label class="collapse" for="c-36192539">[-]</label><label class="expand" for="c-36192539">[1 more]</label></div><br/><div class="children"><div class="content">Not really my type of humor to begin with, but having to explain the &quot;joke&quot; to the community you&#x27;re trying to bait because nobody cared really ruins it.</div><br/></div></div></div></div></div></div></div></div><div id="36189632" class="c"><input type="checkbox" id="c-36189632" checked=""/><div class="controls bullet"><span class="by">d0gsg0w00f</span><span>|</span><a href="#36191034">prev</a><span>|</span><a href="#36186579">next</a><span>|</span><label class="collapse" for="c-36189632">[-]</label><label class="expand" for="c-36189632">[7 more]</label></div><br/><div class="children"><div class="content">I always thought it would be fun to host a Rube Goldberg competition for systems engineering. Whoever could accomplish a simple task with the most ridiculous system would win.<p>Something like: read the 54th line of this file hosted at xx address.<p>Then a submission could look like:<p><pre><code>    1. FTP a file to a server with the address.
    2. the server reads the file and spins up a VM.
    3. The VM polls an endpoint to download code to pull the address.
    4. The code downloads the file and splits it into a single file per line.
    5. A script loads all the files into an array and accesses array[53] to get the answer.
</code></pre>
...you get the idea</div><br/><div id="36191946" class="c"><input type="checkbox" id="c-36191946" checked=""/><div class="controls bullet"><span class="by">myself248</span><span>|</span><a href="#36189632">parent</a><span>|</span><a href="#36189788">next</a><span>|</span><label class="collapse" for="c-36191946">[-]</label><label class="expand" for="c-36191946">[3 more]</label></div><br/><div class="children"><div class="content">I used to host a competition called Anything But Ethernet.<p>(You could use ethernet hops, they just didn&#x27;t score points, so say you had some ethernet-to-whatever bridge, only the &#x27;whatever&#x27; segment would count.)<p>Over the years, we saw physical proof that a T1 circuit would in fact run over barbed wire, we had a human-in-the-loop following a DDR-esque stream of arrows to stomp on a pad that encoded data from one hop to the next, we had a writable RFID tag stuck to the front bumper of an R&#x2F;C car that would drive back and forth between readers...</div><br/><div id="36192300" class="c"><input type="checkbox" id="c-36192300" checked=""/><div class="controls bullet"><span class="by">d0gsg0w00f</span><span>|</span><a href="#36189632">root</a><span>|</span><a href="#36191946">parent</a><span>|</span><a href="#36192334">next</a><span>|</span><label class="collapse" for="c-36192300">[-]</label><label class="expand" for="c-36192300">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s awesome. Was this part of a company? University? I&#x27;ve brought the idea up to coworkers but nobody wants to waste extra cycles for something this dumb.</div><br/></div></div><div id="36192334" class="c"><input type="checkbox" id="c-36192334" checked=""/><div class="controls bullet"><span class="by">promiseofbeans</span><span>|</span><a href="#36189632">root</a><span>|</span><a href="#36191946">parent</a><span>|</span><a href="#36192300">prev</a><span>|</span><a href="#36189788">next</a><span>|</span><label class="collapse" for="c-36192334">[-]</label><label class="expand" for="c-36192334">[1 more]</label></div><br/><div class="children"><div class="content">A vudeo of the barbed wire one: <a href="https:&#x2F;&#x2F;youtu.be&#x2F;MYRJ76RMAQY" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;MYRJ76RMAQY</a></div><br/></div></div></div></div><div id="36189788" class="c"><input type="checkbox" id="c-36189788" checked=""/><div class="controls bullet"><span class="by">Nextgrid</span><span>|</span><a href="#36189632">parent</a><span>|</span><a href="#36191946">prev</a><span>|</span><a href="#36186579">next</a><span>|</span><label class="collapse" for="c-36189788">[-]</label><label class="expand" for="c-36189788">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Whoever could accomplish a simple task with the most ridiculous system would win.<p>See also:<p>* Microservices<p>* &quot;Web scale&quot;<p>* Kubernetes<p>* Cloud computing</div><br/><div id="36193708" class="c"><input type="checkbox" id="c-36193708" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#36189632">root</a><span>|</span><a href="#36189788">parent</a><span>|</span><a href="#36191876">next</a><span>|</span><label class="collapse" for="c-36193708">[-]</label><label class="expand" for="c-36193708">[1 more]</label></div><br/><div class="children"><div class="content">Use Nix to install Conda to install NVM to install Node to install …</div><br/></div></div></div></div></div></div><div id="36186579" class="c"><input type="checkbox" id="c-36186579" checked=""/><div class="controls bullet"><span class="by">mtlmtlmtlmtl</span><span>|</span><a href="#36189632">prev</a><span>|</span><a href="#36187283">next</a><span>|</span><label class="collapse" for="c-36186579">[-]</label><label class="expand" for="c-36186579">[4 more]</label></div><br/><div class="children"><div class="content">I love this! Reminds me of Harder Drive by Tom 7:<p><a href="https:&#x2F;&#x2F;youtube.com&#x2F;watch?v=JcJSW7Rprio">https:&#x2F;&#x2F;youtube.com&#x2F;watch?v=JcJSW7Rprio</a><p>It&#x27;s better to go in unspoiled so I won&#x27;t reveal any details.</div><br/><div id="36186677" class="c"><input type="checkbox" id="c-36186677" checked=""/><div class="controls bullet"><span class="by">KineticLensman</span><span>|</span><a href="#36186579">parent</a><span>|</span><a href="#36186999">next</a><span>|</span><label class="collapse" for="c-36186677">[-]</label><label class="expand" for="c-36186677">[1 more]</label></div><br/><div class="children"><div class="content">Spoiler: &quot;we can of course ignore air resistance because chainsaws cut through the air like butter&quot;</div><br/></div></div><div id="36186999" class="c"><input type="checkbox" id="c-36186999" checked=""/><div class="controls bullet"><span class="by">Sniffnoy</span><span>|</span><a href="#36186579">parent</a><span>|</span><a href="#36186677">prev</a><span>|</span><a href="#36187283">next</a><span>|</span><label class="collapse" for="c-36186999">[-]</label><label class="expand" for="c-36186999">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m going to have to spoil some of it to point out that part of what he&#x27;s done is reinventing the idea of delay-line memory, although he makes no mention of this: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Delay-line_memory" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Delay-line_memory</a><p>...of course if that&#x27;s all there were to it it wouldn&#x27;t be interesting, but I won&#x27;t reveal what the rest is as per your suggestions. :)</div><br/><div id="36187093" class="c"><input type="checkbox" id="c-36187093" checked=""/><div class="controls bullet"><span class="by">mtlmtlmtlmtl</span><span>|</span><a href="#36186579">root</a><span>|</span><a href="#36186999">parent</a><span>|</span><a href="#36187283">next</a><span>|</span><label class="collapse" for="c-36187093">[-]</label><label class="expand" for="c-36187093">[1 more]</label></div><br/><div class="children"><div class="content">True, I suppose. Though the implementation details are certainly refreshing :)</div><br/></div></div></div></div></div></div><div id="36187283" class="c"><input type="checkbox" id="c-36187283" checked=""/><div class="controls bullet"><span class="by">mikece</span><span>|</span><a href="#36186579">prev</a><span>|</span><a href="#36186570">next</a><span>|</span><label class="collapse" for="c-36187283">[-]</label><label class="expand" for="c-36187283">[10 more]</label></div><br/><div class="children"><div class="content">As a junior dev I used folder pairs (to_process and processed) as a way to move messages between loosely coupled systems with file system watchers picking up new files in the to_process folder.  Very light weight, got the job done, and was told it was in production for over a decade (even after better best practices came into use).</div><br/><div id="36187478" class="c"><input type="checkbox" id="c-36187478" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#36187283">parent</a><span>|</span><a href="#36187407">next</a><span>|</span><label class="collapse" for="c-36187478">[-]</label><label class="expand" for="c-36187478">[2 more]</label></div><br/><div class="children"><div class="content">This is a very sensible design for small-scale queueing systems. A few implementation notes I’ve learned along the way:<p>- You’ll want writers to create a temp file and then rename it into place; otherwise your reader might pick up a file that’s only half-written. (POSIX rename() is atomic within a filesystem.)<p>- It’s also helpful to have an `in_process` folder, and a cronjob to send alerts if a task sits in that place too long. That way you can quickly catch crashes and other failures.<p>- You can have multiple readers; they cooperate by rename()ing the input file into in_process&#x2F; before they start working on it, and ignoring ENOENT (which indicates some other process got to it first).<p>- This pattern is great for loosely-coupled systems. In my case I was importing orders into a system that ran very slowly; once a reliable import queue was available new use cases kept presenting themselves, and it was very easy to add them; since the API was just “write a file in the correct format”, individual scripts could be written in whatever way was easiest for the particular task at hand. (It helped that the input format hadn’t changed in a couple decades; if it had needed changing a lot you’d want a more structured system. But this is the same as any distributed systems interface design.)</div><br/><div id="36193703" class="c"><input type="checkbox" id="c-36193703" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#36187283">root</a><span>|</span><a href="#36187478">parent</a><span>|</span><a href="#36187407">next</a><span>|</span><label class="collapse" for="c-36193703">[-]</label><label class="expand" for="c-36193703">[1 more]</label></div><br/><div class="children"><div class="content">With respect to how to move things into folders, the simplest advice is to tell people to just read the Maildir spec. And read Qmail as well. While Qmail is dated as a mailsystem, as a description of how to compose a decoupled system that reliably processes filesystem based queues, it contains lots of little nuggets.</div><br/></div></div></div></div><div id="36187407" class="c"><input type="checkbox" id="c-36187407" checked=""/><div class="controls bullet"><span class="by">derefr</span><span>|</span><a href="#36187283">parent</a><span>|</span><a href="#36187478">prev</a><span>|</span><a href="#36190296">next</a><span>|</span><label class="collapse" for="c-36187407">[-]</label><label class="expand" for="c-36187407">[5 more]</label></div><br/><div class="children"><div class="content">FYI, this is an old Unixism called a &quot;spool directory&quot; :)</div><br/><div id="36187606" class="c"><input type="checkbox" id="c-36187606" checked=""/><div class="controls bullet"><span class="by">WeAddValue</span><span>|</span><a href="#36187283">root</a><span>|</span><a href="#36187407">parent</a><span>|</span><a href="#36190296">next</a><span>|</span><label class="collapse" for="c-36187606">[-]</label><label class="expand" for="c-36187606">[4 more]</label></div><br/><div class="children"><div class="content">FYI, which was probably derived from the old mainframe-ism which had spooling before Unix was written.  See <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Spooling" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Spooling</a></div><br/><div id="36187723" class="c"><input type="checkbox" id="c-36187723" checked=""/><div class="controls bullet"><span class="by">derefr</span><span>|</span><a href="#36187283">root</a><span>|</span><a href="#36187606">parent</a><span>|</span><a href="#36190296">next</a><span>|</span><label class="collapse" for="c-36187723">[-]</label><label class="expand" for="c-36187723">[3 more]</label></div><br/><div class="children"><div class="content">Literally spooling message-filled tape onto a tape reel! I never even thought about that.<p>On the topic of message queues, I wonder if anyone ever designed a <i>mechanical, asynchronous hardware IPC</i> mechanism based on tape. Imagine: an endless-loop tape that stretches between a &quot;sender&quot; tape-drive on one machine, and a &quot;receiver&quot; tape-drive on another machine; with each tape drive locally tensioning the tape as it passes through, but letting it hang slack outside the drive; with two tape-width buffer boxes in between the two drives, for taking up the slack; and where each tape-drive has a strain gauge on its input-end capstan.<p>With this design, you&#x27;d never need to seek the tape (backward, at least) — the receive head would just read the tape forward at whatever speed it could until it ran out of slack in the tape (i.e. blocked on read); and the send head would write the tape forward at whatever speed <i>it</i> could until <i>it</i> ran out of slack (i.e. blocked on write.) The tape itself would be a literal, physical ring buffer.</div><br/><div id="36187848" class="c"><input type="checkbox" id="c-36187848" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#36187283">root</a><span>|</span><a href="#36187723">parent</a><span>|</span><a href="#36191854">next</a><span>|</span><label class="collapse" for="c-36187848">[-]</label><label class="expand" for="c-36187848">[1 more]</label></div><br/><div class="children"><div class="content">Western Union built a store-and-forward message switching system in pretty much exactly the way you describe (but with paper tape rather than magnetic): <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Plan_55-A" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Plan_55-A</a></div><br/></div></div><div id="36191854" class="c"><input type="checkbox" id="c-36191854" checked=""/><div class="controls bullet"><span class="by">robotresearcher</span><span>|</span><a href="#36187283">root</a><span>|</span><a href="#36187723">parent</a><span>|</span><a href="#36187848">prev</a><span>|</span><a href="#36190296">next</a><span>|</span><label class="collapse" for="c-36191854">[-]</label><label class="expand" for="c-36191854">[1 more]</label></div><br/><div class="children"><div class="content">Analog audio delay&#x2F;echo machines work like this. They could have multiple read heads and you could move them relative to each other and adjust the speed of the tape to get various cool effects.</div><br/></div></div></div></div></div></div></div></div><div id="36190296" class="c"><input type="checkbox" id="c-36190296" checked=""/><div class="controls bullet"><span class="by">fukawi2</span><span>|</span><a href="#36187283">parent</a><span>|</span><a href="#36187407">prev</a><span>|</span><a href="#36187439">next</a><span>|</span><label class="collapse" for="c-36190296">[-]</label><label class="expand" for="c-36190296">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m doing the same right now. The incoming messages are coming from a radio network at 1200 baud, so I don&#x27;t foresee capacity problems :D</div><br/></div></div><div id="36187439" class="c"><input type="checkbox" id="c-36187439" checked=""/><div class="controls bullet"><span class="by">florbo</span><span>|</span><a href="#36187283">parent</a><span>|</span><a href="#36190296">prev</a><span>|</span><a href="#36186570">next</a><span>|</span><label class="collapse" for="c-36187439">[-]</label><label class="expand" for="c-36187439">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes a filesystem-based queue like that is all you really need. Recently I used S3 API compatible storage for something similar, as introducing AMQP or pubsub would have been immensely overkill for this low volume component.</div><br/></div></div></div></div><div id="36186570" class="c"><input type="checkbox" id="c-36186570" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#36187283">prev</a><span>|</span><a href="#36187051">next</a><span>|</span><label class="collapse" for="c-36186570">[-]</label><label class="expand" for="c-36186570">[1 more]</label></div><br/><div class="children"><div class="content">I initially expected a horrible amount of flamewar tinder, but it is an Overton Window expanding Art Project and I love it!<p>The Cardio rate control library is cool, <a href="https:&#x2F;&#x2F;pkg.go.dev&#x2F;within.website&#x2F;x&#x2F;cardio" rel="nofollow">https:&#x2F;&#x2F;pkg.go.dev&#x2F;within.website&#x2F;x&#x2F;cardio</a> this library would be a great problem for using a neural net to model a PID loop.<p><a href="https:&#x2F;&#x2F;www.semanticscholar.org&#x2F;paper&#x2F;A-Design-of-FPGA-Based-Neural-Network-PID-for-Wang-Li&#x2F;a25682a60e13feea3e3ee6200e96e6650b7ca4b2" rel="nofollow">https:&#x2F;&#x2F;www.semanticscholar.org&#x2F;paper&#x2F;A-Design-of-FPGA-Based...</a><p><a href="https:&#x2F;&#x2F;www.semanticscholar.org&#x2F;paper&#x2F;Self-Tuning-Neural-Network-PID-With-Dynamic-Control-Rodr%C3%ADguez-Abreo-Rodr%C3%ADguez-Res%C3%A9ndiz&#x2F;f332ab78d9e3e52f780827d20a573ca9d56c7430" rel="nofollow">https:&#x2F;&#x2F;www.semanticscholar.org&#x2F;paper&#x2F;Self-Tuning-Neural-Net...</a></div><br/></div></div><div id="36187051" class="c"><input type="checkbox" id="c-36187051" checked=""/><div class="controls bullet"><span class="by">KaiserPro</span><span>|</span><a href="#36186570">prev</a><span>|</span><a href="#36193728">next</a><span>|</span><label class="collapse" for="c-36187051">[-]</label><label class="expand" for="c-36187051">[1 more]</label></div><br/><div class="children"><div class="content">This, this is what the internet used to be like.<p>ok, what the good parts of the internet used to be like.<p>I also love that its highlights an AWS dark pattern. more, more I say.</div><br/></div></div><div id="36193728" class="c"><input type="checkbox" id="c-36193728" checked=""/><div class="controls bullet"><span class="by">svilen_dobrev</span><span>|</span><a href="#36187051">prev</a><span>|</span><a href="#36186392">next</a><span>|</span><label class="collapse" for="c-36193728">[-]</label><label class="expand" for="c-36193728">[1 more]</label></div><br/><div class="children"><div class="content">i used Couchdb as &quot;RPC&quot; pseudo-HTTP request-response transport layer, essentialy two queues, both ways. Especialy useful for mobile devices when connectivity is a random thing. Hugely Simplifed both client and server - Let the db handle all the multiplication, connections, switch on and off, timeouts, retries, delays, repeats, etc.</div><br/></div></div><div id="36186392" class="c"><input type="checkbox" id="c-36186392" checked=""/><div class="controls bullet"><span class="by">h2odragon</span><span>|</span><a href="#36193728">prev</a><span>|</span><a href="#36186608">next</a><span>|</span><label class="collapse" for="c-36186392">[-]</label><label class="expand" for="c-36186392">[3 more]</label></div><br/><div class="children"><div class="content">What could be worse than IPv6? <i>this</i><p>Someone submit it as &quot;IPv8&quot; immediately.</div><br/><div id="36186915" class="c"><input type="checkbox" id="c-36186915" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#36186392">parent</a><span>|</span><a href="#36186608">next</a><span>|</span><label class="collapse" for="c-36186915">[-]</label><label class="expand" for="c-36186915">[2 more]</label></div><br/><div class="children"><div class="content">IPv9 is already a thing</div><br/><div id="36187101" class="c"><input type="checkbox" id="c-36187101" checked=""/><div class="controls bullet"><span class="by">h2odragon</span><span>|</span><a href="#36186392">root</a><span>|</span><a href="#36186915">parent</a><span>|</span><a href="#36186608">next</a><span>|</span><label class="collapse" for="c-36187101">[-]</label><label class="expand" for="c-36187101">[1 more]</label></div><br/><div class="children"><div class="content">Should this be IPv13 then?</div><br/></div></div></div></div></div></div><div id="36186608" class="c"><input type="checkbox" id="c-36186608" checked=""/><div class="controls bullet"><span class="by">pavlov</span><span>|</span><a href="#36186392">prev</a><span>|</span><a href="#36189674">next</a><span>|</span><label class="collapse" for="c-36186608">[-]</label><label class="expand" for="c-36186608">[3 more]</label></div><br/><div class="children"><div class="content">The only thing worse would be this “on the blockchain.”<p>On second thought it seems likely that some charlatan has already years ago raised a couple of millions in an ICO for such a project. “We’re making the entire Internet web3-compatible!”</div><br/><div id="36187003" class="c"><input type="checkbox" id="c-36187003" checked=""/><div class="controls bullet"><span class="by">xg15</span><span>|</span><a href="#36186608">parent</a><span>|</span><a href="#36189674">next</a><span>|</span><label class="collapse" for="c-36187003">[-]</label><label class="expand" for="c-36187003">[2 more]</label></div><br/><div class="children"><div class="content">I mean. Chain, queue, it&#x27;s not that different if you squint hard enough...</div><br/><div id="36188201" class="c"><input type="checkbox" id="c-36188201" checked=""/><div class="controls bullet"><span class="by">Izkata</span><span>|</span><a href="#36186608">root</a><span>|</span><a href="#36187003">parent</a><span>|</span><a href="#36189674">next</a><span>|</span><label class="collapse" for="c-36188201">[-]</label><label class="expand" for="c-36188201">[1 more]</label></div><br/><div class="children"><div class="content">2018: Modeling of Blockchain Based Systems Using Queuing Theory Simulation<p><a href="https:&#x2F;&#x2F;ieeexplore.ieee.org&#x2F;document&#x2F;8632560" rel="nofollow">https:&#x2F;&#x2F;ieeexplore.ieee.org&#x2F;document&#x2F;8632560</a></div><br/></div></div></div></div></div></div><div id="36189674" class="c"><input type="checkbox" id="c-36189674" checked=""/><div class="controls bullet"><span class="by">headPoet</span><span>|</span><a href="#36186608">prev</a><span>|</span><a href="#36186657">next</a><span>|</span><label class="collapse" for="c-36189674">[-]</label><label class="expand" for="c-36189674">[6 more]</label></div><br/><div class="children"><div class="content">&quot;anything stored in that pointer to memory you got back from malloc() is stored in an area of ram called &quot;the heap&quot;, which is moderately slower to access than it is to access the stack.&quot;
Is this true, or a myth? Ignoring the allocation cost and access patterns making cache misses more likely, surely memory is just memory</div><br/><div id="36190041" class="c"><input type="checkbox" id="c-36190041" checked=""/><div class="controls bullet"><span class="by">twoodfin</span><span>|</span><a href="#36189674">parent</a><span>|</span><a href="#36193394">next</a><span>|</span><label class="collapse" for="c-36190041">[-]</label><label class="expand" for="c-36190041">[2 more]</label></div><br/><div class="children"><div class="content">By definition, everything on the heap got where it is dynamically, so the minimum number of pointers to chase to find it is 1.<p>In contrast, what’s where on the stack can often be (and often must be) known statically by the compiler and accessed directly, even moved entirely out of memory and into a register. (It’s possible to do this with suitably constrained dynamic allocations, but the optimization is much harder.)</div><br/><div id="36191576" class="c"><input type="checkbox" id="c-36191576" checked=""/><div class="controls bullet"><span class="by">cdcarter</span><span>|</span><a href="#36189674">root</a><span>|</span><a href="#36190041">parent</a><span>|</span><a href="#36193394">next</a><span>|</span><label class="collapse" for="c-36191576">[-]</label><label class="expand" for="c-36191576">[1 more]</label></div><br/><div class="children"><div class="content">Some architectures (e.g. the 65816, the 6502&#x27;s &quot;big brother&quot; used in the Apple IIgs) include stack pointer relative addressing modes, which will complete the memory read and return data faster than the same instruction with a full address encoded.</div><br/></div></div></div></div><div id="36193394" class="c"><input type="checkbox" id="c-36193394" checked=""/><div class="controls bullet"><span class="by">proto_lambda</span><span>|</span><a href="#36189674">parent</a><span>|</span><a href="#36190041">prev</a><span>|</span><a href="#36189875">next</a><span>|</span><label class="collapse" for="c-36193394">[-]</label><label class="expand" for="c-36193394">[1 more]</label></div><br/><div class="children"><div class="content">Many architectures have hardware support for stacks, which could be slightly faster than arbitrary load&#x2F;stores. Only works in the function owning the stack frame of course, if you pass a pointer to a stack object somewhere else, it&#x27;s back to being normal memory.</div><br/></div></div><div id="36189875" class="c"><input type="checkbox" id="c-36189875" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36189674">parent</a><span>|</span><a href="#36193394">prev</a><span>|</span><a href="#36186657">next</a><span>|</span><label class="collapse" for="c-36189875">[-]</label><label class="expand" for="c-36189875">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m pretty sure this is still the case. I&#x27;m not sure how cross-platform that assumption is (it won&#x27;t work in Go where it has heapstacks I don&#x27;t think), but classically yeah the stack is put is slightly faster memory with fewer access barriers.</div><br/><div id="36193513" class="c"><input type="checkbox" id="c-36193513" checked=""/><div class="controls bullet"><span class="by">comex</span><span>|</span><a href="#36189674">root</a><span>|</span><a href="#36189875">parent</a><span>|</span><a href="#36186657">next</a><span>|</span><label class="collapse" for="c-36193513">[-]</label><label class="expand" for="c-36193513">[1 more]</label></div><br/><div class="children"><div class="content">I believe that’s inaccurate, at least on a modern CPU.  The bookkeeping for the stack is faster, since ‘allocating’ and ‘deallocating’ is just subtracting from and adding to a register.  And the area of the stack in active use at any given time is usually tiny (well under a kilobyte, even though the full stack is usually several megabytes), so it’s likely to stick around in L1 cache.  And return addresses on the stack get special treatment by the branch predictor.  But other than that, it’s treated the same as any other memory.</div><br/></div></div></div></div></div></div><div id="36186657" class="c"><input type="checkbox" id="c-36186657" checked=""/><div class="controls bullet"><span class="by">Codesleuth</span><span>|</span><a href="#36189674">prev</a><span>|</span><a href="#36186508">next</a><span>|</span><label class="collapse" for="c-36186657">[-]</label><label class="expand" for="c-36186657">[4 more]</label></div><br/><div class="children"><div class="content">&gt; What if there was a way you could reduce that cost for your own services by up to 700%?<p>How can something be reduced over 100% What is it that they actually mean here?</div><br/><div id="36186670" class="c"><input type="checkbox" id="c-36186670" checked=""/><div class="controls bullet"><span class="by">Kye</span><span>|</span><a href="#36186657">parent</a><span>|</span><a href="#36186696">next</a><span>|</span><label class="collapse" for="c-36186670">[-]</label><label class="expand" for="c-36186670">[2 more]</label></div><br/><div class="children"><div class="content">Like any good extended comedy bit, you have to read to the punchline to get it.</div><br/><div id="36186685" class="c"><input type="checkbox" id="c-36186685" checked=""/><div class="controls bullet"><span class="by">Codesleuth</span><span>|</span><a href="#36186657">root</a><span>|</span><a href="#36186670">parent</a><span>|</span><a href="#36186696">next</a><span>|</span><label class="collapse" for="c-36186685">[-]</label><label class="expand" for="c-36186685">[1 more]</label></div><br/><div class="children"><div class="content">Ah, good call. I&#x27;ll continue...</div><br/></div></div></div></div><div id="36186696" class="c"><input type="checkbox" id="c-36186696" checked=""/><div class="controls bullet"><span class="by">hdjjhhvvhga</span><span>|</span><a href="#36186657">parent</a><span>|</span><a href="#36186670">prev</a><span>|</span><a href="#36186508">next</a><span>|</span><label class="collapse" for="c-36186696">[-]</label><label class="expand" for="c-36186696">[1 more]</label></div><br/><div class="children"><div class="content">I believe they meant &quot;7 times&quot;, so around 85%.</div><br/></div></div></div></div><div id="36186508" class="c"><input type="checkbox" id="c-36186508" checked=""/><div class="controls bullet"><span class="by">JoelMcCracken</span><span>|</span><a href="#36186657">prev</a><span>|</span><a href="#36191744">next</a><span>|</span><label class="collapse" for="c-36186508">[-]</label><label class="expand" for="c-36186508">[1 more]</label></div><br/><div class="children"><div class="content">This is the first hn headline that I can remember actually making me laugh out loud. Bravo.</div><br/></div></div><div id="36191744" class="c"><input type="checkbox" id="c-36191744" checked=""/><div class="controls bullet"><span class="by">JenrHywy</span><span>|</span><a href="#36186508">prev</a><span>|</span><a href="#36187514">next</a><span>|</span><label class="collapse" for="c-36191744">[-]</label><label class="expand" for="c-36191744">[1 more]</label></div><br/><div class="children"><div class="content">The title reminds me that, in a previous life, our &quot;architecture&quot; team implemented a service bus using Lotus Notes email.</div><br/></div></div><div id="36187514" class="c"><input type="checkbox" id="c-36187514" checked=""/><div class="controls bullet"><span class="by">atmavatar</span><span>|</span><a href="#36191744">prev</a><span>|</span><a href="#36187749">next</a><span>|</span><label class="collapse" for="c-36187514">[-]</label><label class="expand" for="c-36187514">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The bytes are stored in the cloud, which is slightly slower to read from than it would be to read data out of the heap.<p>Given latency and bandwidth differences, that&#x27;s like saying that it&#x27;s slightly slower to transport water by driving standard, 1-gallon jugs between the US east and west coasts than it is to transport it a few miles using a tanker truck.</div><br/><div id="36187659" class="c"><input type="checkbox" id="c-36187659" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#36187514">parent</a><span>|</span><a href="#36187749">next</a><span>|</span><label class="collapse" for="c-36187659">[-]</label><label class="expand" for="c-36187659">[1 more]</label></div><br/><div class="children"><div class="content">that&#x27;s the joke.</div><br/></div></div></div></div><div id="36186774" class="c"><input type="checkbox" id="c-36186774" checked=""/><div class="controls bullet"><span class="by">ipython</span><span>|</span><a href="#36186672">prev</a><span>|</span><a href="#36186471">next</a><span>|</span><label class="collapse" for="c-36186774">[-]</label><label class="expand" for="c-36186774">[2 more]</label></div><br/><div class="children"><div class="content">Given that Corey Quinn is involved, I’m surprised that route 53 isn’t included somewhere (or maybe it is, I’m still reading through it)</div><br/><div id="36186783" class="c"><input type="checkbox" id="c-36186783" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36186774">parent</a><span>|</span><a href="#36186471">next</a><span>|</span><label class="collapse" for="c-36186783">[-]</label><label class="expand" for="c-36186783">[1 more]</label></div><br/><div class="children"><div class="content">I was gonna add Route 53 (to have each node set its own DNS record), but I&#x27;m saving that for part 2. Be afraid, part 2 is coming.</div><br/></div></div></div></div><div id="36186471" class="c"><input type="checkbox" id="c-36186471" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#36186774">prev</a><span>|</span><a href="#36188822">next</a><span>|</span><label class="collapse" for="c-36186471">[-]</label><label class="expand" for="c-36186471">[1 more]</label></div><br/><div class="children"><div class="content">This is the best worst thing in software that I have ever seen. I love it so much.</div><br/></div></div><div id="36188822" class="c"><input type="checkbox" id="c-36188822" checked=""/><div class="controls bullet"><span class="by">sam1r</span><span>|</span><a href="#36186471">prev</a><span>|</span><a href="#36187492">next</a><span>|</span><label class="collapse" for="c-36188822">[-]</label><label class="expand" for="c-36188822">[6 more]</label></div><br/><div class="children"><div class="content">&gt;&gt; Read time in minutes: 40<p>I wonder if this part is satire, if so, how come? I definitely feel it should be much less.</div><br/><div id="36188966" class="c"><input type="checkbox" id="c-36188966" checked=""/><div class="controls bullet"><span class="by">jerf</span><span>|</span><a href="#36188822">parent</a><span>|</span><a href="#36188879">next</a><span>|</span><label class="collapse" for="c-36188966">[-]</label><label class="expand" for="c-36188966">[1 more]</label></div><br/><div class="children"><div class="content">Estimate includes the additional latency you will experience while downloading the post through the mechanism described in the post, which is the only <i>true</i> way to read it.</div><br/></div></div><div id="36188879" class="c"><input type="checkbox" id="c-36188879" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36188822">parent</a><span>|</span><a href="#36188966">prev</a><span>|</span><a href="#36187492">next</a><span>|</span><label class="collapse" for="c-36188879">[-]</label><label class="expand" for="c-36188879">[4 more]</label></div><br/><div class="children"><div class="content">My read time estimate code is here: <a href="https:&#x2F;&#x2F;github.com&#x2F;Xe&#x2F;site&#x2F;blob&#x2F;aa3608afa6c62695ca0ab139f82352dd8e97994e&#x2F;src&#x2F;post&#x2F;mod.rs#L151-L159">https:&#x2F;&#x2F;github.com&#x2F;Xe&#x2F;site&#x2F;blob&#x2F;aa3608afa6c62695ca0ab139f823...</a><p>I&#x27;ve been trying to play with the constants over the years to make the read time estimate more &quot;accurate&quot;, but it&#x27;s a tough nut to crack in general. So I can go over my numbers more accurately, how long did it take you to read it?</div><br/><div id="36189494" class="c"><input type="checkbox" id="c-36189494" checked=""/><div class="controls bullet"><span class="by">ignoramous</span><span>|</span><a href="#36188822">root</a><span>|</span><a href="#36188879">parent</a><span>|</span><a href="#36187492">next</a><span>|</span><label class="collapse" for="c-36189494">[-]</label><label class="expand" for="c-36189494">[3 more]</label></div><br/><div class="children"><div class="content">fwiw, it took 5m to read. Nb: I was already familiar with a lot of the terms in the post (partly because I&#x27;ve already experimented relaying IP over Cloudflare&#x27;s DurableObjects instead of S3), and skipped the dialectics.</div><br/><div id="36189836" class="c"><input type="checkbox" id="c-36189836" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36188822">root</a><span>|</span><a href="#36189494">parent</a><span>|</span><a href="#36187492">next</a><span>|</span><label class="collapse" for="c-36189836">[-]</label><label class="expand" for="c-36189836">[2 more]</label></div><br/><div class="children"><div class="content">you what</div><br/><div id="36190313" class="c"><input type="checkbox" id="c-36190313" checked=""/><div class="controls bullet"><span class="by">Kye</span><span>|</span><a href="#36188822">root</a><span>|</span><a href="#36189836">parent</a><span>|</span><a href="#36187492">next</a><span>|</span><label class="collapse" for="c-36190313">[-]</label><label class="expand" for="c-36190313">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t even know what that is and I can tell it&#x27;s cursed.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="36187492" class="c"><input type="checkbox" id="c-36187492" checked=""/><div class="controls bullet"><span class="by">cosmolev</span><span>|</span><a href="#36188822">prev</a><span>|</span><a href="#36186966">next</a><span>|</span><label class="collapse" for="c-36187492">[-]</label><label class="expand" for="c-36187492">[1 more]</label></div><br/><div class="children"><div class="content">I think we can safely expand it even further: Anything can be a anything if you use it wrongly enough.</div><br/></div></div><div id="36186966" class="c"><input type="checkbox" id="c-36186966" checked=""/><div class="controls bullet"><span class="by">cratermoon</span><span>|</span><a href="#36187492">prev</a><span>|</span><a href="#36187160">next</a><span>|</span><label class="collapse" for="c-36186966">[-]</label><label class="expand" for="c-36186966">[1 more]</label></div><br/><div class="children"><div class="content">This is astoundingly well-written and informative. It&#x27;s the sort of thing I come here for. It&#x27;s also engaging and charming in a way rarely seen in tech writing.<p>I like that they started out by talking about $0.07&#x2F;G cost and went through the whole exercise before pointing out what immediately came to mind for me when they started pushing bytes in and out of S3.</div><br/></div></div><div id="36187160" class="c"><input type="checkbox" id="c-36187160" checked=""/><div class="controls bullet"><span class="by">rootw0rm</span><span>|</span><a href="#36186966">prev</a><span>|</span><a href="#36187527">next</a><span>|</span><label class="collapse" for="c-36187160">[-]</label><label class="expand" for="c-36187160">[1 more]</label></div><br/><div class="children"><div class="content">The title of this article is what malware authors say every day =)</div><br/></div></div><div id="36187527" class="c"><input type="checkbox" id="c-36187527" checked=""/><div class="controls bullet"><span class="by">cosmolev</span><span>|</span><a href="#36187160">prev</a><span>|</span><a href="#36188076">next</a><span>|</span><label class="collapse" for="c-36187527">[-]</label><label class="expand" for="c-36187527">[2 more]</label></div><br/><div class="children"><div class="content">At some point you can also discover it is Turing complete.</div><br/><div id="36187538" class="c"><input type="checkbox" id="c-36187538" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36187527">parent</a><span>|</span><a href="#36188076">next</a><span>|</span><label class="collapse" for="c-36187538">[-]</label><label class="expand" for="c-36187538">[1 more]</label></div><br/><div class="children"><div class="content">Wait, are you saying that AWS S3 is turing complete? How the hell if so.</div><br/></div></div></div></div><div id="36188076" class="c"><input type="checkbox" id="c-36188076" checked=""/><div class="controls bullet"><span class="by">jheriko</span><span>|</span><a href="#36187527">prev</a><span>|</span><a href="#36187612">next</a><span>|</span><label class="collapse" for="c-36188076">[-]</label><label class="expand" for="c-36188076">[1 more]</label></div><br/><div class="children"><div class="content">meanwhile in the minds of ZeroMQ devs...</div><br/></div></div><div id="36187612" class="c"><input type="checkbox" id="c-36187612" checked=""/><div class="controls bullet"><span class="by">xg15</span><span>|</span><a href="#36188076">prev</a><span>|</span><a href="#36187457">next</a><span>|</span><label class="collapse" for="c-36187612">[-]</label><label class="expand" for="c-36187612">[1 more]</label></div><br/><div class="children"><div class="content">Too late, already deployed to prod :)</div><br/></div></div><div id="36187457" class="c"><input type="checkbox" id="c-36187457" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#36187612">prev</a><span>|</span><label class="collapse" for="c-36187457">[-]</label><label class="expand" for="c-36187457">[5 more]</label></div><br/><div class="children"><div class="content">Could someone explain this please?</div><br/><div id="36187502" class="c"><input type="checkbox" id="c-36187502" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#36187457">parent</a><span>|</span><a href="#36187463">next</a><span>|</span><label class="collapse" for="c-36187502">[-]</label><label class="expand" for="c-36187502">[1 more]</label></div><br/><div class="children"><div class="content">This is one of those articles where the journey is far more interesting than the destination.<p>(Edit: this comment made more sense when it was replying to a different complaint about the article; the parent comment seems to have been edited in the interim.)</div><br/></div></div><div id="36187463" class="c"><input type="checkbox" id="c-36187463" checked=""/><div class="controls bullet"><span class="by">xena</span><span>|</span><a href="#36187457">parent</a><span>|</span><a href="#36187502">prev</a><span>|</span><a href="#36192292">next</a><span>|</span><label class="collapse" for="c-36187463">[-]</label><label class="expand" for="c-36187463">[1 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s the key paragraph in the article:<p>&gt; In Linux, you can create a TUN&#x2F;TAP device to let applications control how network or datagram links work. In essence, it lets you create a file descriptor that you can read packets from and write packets to. As long as you get the packets to their intended destination somehow and get any other packets that come back to the same file descriptor, the implementation isn&#x27;t relevant. This is how OpenVPN, ZeroTier, FreeLAN, Tinc, Hamachi, WireGuard and Tailscale work: they read packets from the kernel, encrypt them, send them to the destination, decrypt incoming packets, and then write them back into the kernel.</div><br/></div></div><div id="36192292" class="c"><input type="checkbox" id="c-36192292" checked=""/><div class="controls bullet"><span class="by">dikei</span><span>|</span><a href="#36187457">parent</a><span>|</span><a href="#36187463">prev</a><span>|</span><a href="#36189555">next</a><span>|</span><label class="collapse" for="c-36192292">[-]</label><label class="expand" for="c-36192292">[1 more]</label></div><br/><div class="children"><div class="content">So the premise of the problem is the need to egress traffic to the internet from a private VPC, without using an expensive NAT gateway. The solution is to do NAT manually by having an EC2 instance in a public VPC, and tunneling traffic from the private VPC through that instance.<p>The meat of the article is how to create that tunnel using S3 for data transfer instead of using a more traditional VPN service.</div><br/></div></div><div id="36189555" class="c"><input type="checkbox" id="c-36189555" checked=""/><div class="controls bullet"><span class="by">ignoramous</span><span>|</span><a href="#36187457">parent</a><span>|</span><a href="#36192292">prev</a><span>|</span><label class="collapse" for="c-36189555">[-]</label><label class="expand" for="c-36189555">[1 more]</label></div><br/><div class="children"><div class="content">Setup a TUN&#x2F;TAP device, which is a file one can read (egress packets) &#x2F; write to (ingress packets). Setup appropriate <i>ip route</i>s.<p>Read (egress) packets from the TUN&#x2F;TAP device.<p>Serialize them, assign sequence numbers, and upload them to S3.<p>On the recieve side, poll for newer objects (packets) in S3.<p>Write them to your TUN&#x2F;TAP device.<p>---<p>Here, the TUN device is a <i>router</i> using S3 as <i>gateway</i>.</div><br/></div></div></div></div></div></div></div></div></div></body></html>