<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1707210060341" as="style"/><link rel="stylesheet" href="styles.css?v=1707210060341"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://silent-tower.net/projects/visual-overview-malloc">Visual overview of a custom malloc() implementation</a> <span class="domain">(<a href="https://silent-tower.net">silent-tower.net</a>)</span></div><div class="subtext"><span>signa11</span> | <span>4 comments</span></div><br/><div><div id="39272290" class="c"><input type="checkbox" id="c-39272290" checked=""/><div class="controls bullet"><span class="by">unwind</span><span>|</span><a href="#39271191">next</a><span>|</span><label class="collapse" for="c-39272290">[-]</label><label class="expand" for="c-39272290">[1 more]</label></div><br/><div class="children"><div class="content">This was very good!<p>I was really happy when the first code on the page, for once, did not look like it was written by someone writing C when they would much rather write something else.<p>This line:<p><pre><code>    struct article *my_article = malloc(sizeof *my_article);
</code></pre>
Is almost exactly how I would have written it, and (to me) does three things very right:<p>- Does not use a pointless, wordy, bloated cast to somehow &quot;convert&quot; the pointer to the proper type. The point of malloc() returning a void pointer is that no such cast is needed.<p>- Does not hardcode a size, but uses the sizeof operator to let the compiler compute it.<p>- Does not repeat the type name, which is brittle and wordy, but instead (again) lets the compiler compute it from the target pointer.<p>I was a bit more hesitant about this line, later in the article:<p><pre><code>    return (void *)b + sizeof(block_t) + b-&gt;size;
</code></pre>
Not sure what language standard is targeted by the code in the article, but being able to do pointer arithmetic with void pointers is a GCC extension which at least should be mentioned.</div><br/></div></div><div id="39271191" class="c"><input type="checkbox" id="c-39271191" checked=""/><div class="controls bullet"><span class="by">ksvarma</span><span>|</span><a href="#39272290">prev</a><span>|</span><a href="#39271445">next</a><span>|</span><label class="collapse" for="c-39271191">[-]</label><label class="expand" for="c-39271191">[1 more]</label></div><br/><div class="children"><div class="content">Excellent, very well written.</div><br/></div></div><div id="39271445" class="c"><input type="checkbox" id="c-39271445" checked=""/><div class="controls bullet"><span class="by">tilt_error</span><span>|</span><a href="#39271191">prev</a><span>|</span><label class="collapse" for="c-39271445">[-]</label><label class="expand" for="c-39271445">[1 more]</label></div><br/><div class="children"><div class="content">Why are the letters ’p’, ’q’ and ’t’ missing from the article? Makes it a bit annoying to read.</div><br/></div></div></div></div></div></div></div></body></html>