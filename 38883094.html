<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704531656404" as="style"/><link rel="stylesheet" href="styles.css?v=1704531656404"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/MegaManSec/SSH-Snake">SSH-Snake: Automated SSH-Based Network Traversal</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>lozf</span> | <span>16 comments</span></div><br/><div><div id="38884952" class="c"><input type="checkbox" id="c-38884952" checked=""/><div class="controls bullet"><span class="by">godelski</span><span>|</span><a href="#38888932">next</a><span>|</span><label class="collapse" for="c-38884952">[-]</label><label class="expand" for="c-38884952">[2 more]</label></div><br/><div class="children"><div class="content">I know this is positioned as a hacking tool, but it seems actually pretty useful. It&#x27;s pretty easy to lose track of where your keys are used and how you might perform hops. Having that diagram be generated for you really looks useful and can help you navigate this.<p>I&#x27;m sure there are good practices to solve this (and please suggest them, I&#x27;m always looking to learn more), but I&#x27;m no expert. I do daily drive linux and am terminally terminal, so it wouldn&#x27;t surprise me if the GUI people are even worse. I think this is a general problem with a lot of terminal based tools, is that there are far higher expectations to read the documentation and less focus on design (and importantly, design that makes sense to someone that isn&#x27;t you). Totally fine for hacky projects but with something as mature as ssh it seems like we&#x27;d have far better tools built in or to exist. I&#x27;m sure many do exist, but are they well known? (I&#x27;m happy to see any tools if you all have some suggestions)</div><br/><div id="38887345" class="c"><input type="checkbox" id="c-38887345" checked=""/><div class="controls bullet"><span class="by">chaps</span><span>|</span><a href="#38884952">parent</a><span>|</span><a href="#38888932">next</a><span>|</span><label class="collapse" for="c-38887345">[-]</label><label class="expand" for="c-38887345">[1 more]</label></div><br/><div class="children"><div class="content">Yes, it is a very useful tool. Used to do very similar when I worked as a sysadmin in larger infrastructures that largely get managed over ssh. A surprisingly large number of infrastructures have keys setup for individual sysadmins across all hosts, through straight sshd user auth.<p>One problem this helps with is getting into older servers with an unknown password and can&#x27;t be rebooted for business reasons. At some point, some person may have setup keys to that host, and the only way to find out which is to basically try all hosts and all users. So having something that snakes through an infrastructure like this would help get into that host.</div><br/></div></div></div></div><div id="38888932" class="c"><input type="checkbox" id="c-38888932" checked=""/><div class="controls bullet"><span class="by">mmsc</span><span>|</span><a href="#38884952">prev</a><span>|</span><a href="#38889087">next</a><span>|</span><label class="collapse" for="c-38888932">[-]</label><label class="expand" for="c-38888932">[1 more]</label></div><br/><div class="children"><div class="content">[dupe] of <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38877185">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38877185</a> (I&#x27;m the author)</div><br/></div></div><div id="38889087" class="c"><input type="checkbox" id="c-38889087" checked=""/><div class="controls bullet"><span class="by">deoxykev</span><span>|</span><a href="#38888932">prev</a><span>|</span><a href="#38887127">next</a><span>|</span><label class="collapse" for="c-38889087">[-]</label><label class="expand" for="c-38889087">[1 more]</label></div><br/><div class="children"><div class="content">Here’s a similar project, but for windows AD networks<p><a href="https:&#x2F;&#x2F;github.com&#x2F;byt3bl33d3r&#x2F;DeathStar">https:&#x2F;&#x2F;github.com&#x2F;byt3bl33d3r&#x2F;DeathStar</a></div><br/></div></div><div id="38887127" class="c"><input type="checkbox" id="c-38887127" checked=""/><div class="controls bullet"><span class="by">tommsy64</span><span>|</span><a href="#38889087">prev</a><span>|</span><a href="#38887353">next</a><span>|</span><label class="collapse" for="c-38887127">[-]</label><label class="expand" for="c-38887127">[4 more]</label></div><br/><div class="children"><div class="content">An interesting limitation mentioned in the README<p>&quot;IPv4 Only: Like all of the best programs, the script does not support IPv6. I can&#x27;t imagine there will be support for this anytime soon.&quot;<p>What are considered &quot;all the best programs&quot; these days? Is IPv6 adoption really so looked down upon?</div><br/><div id="38887924" class="c"><input type="checkbox" id="c-38887924" checked=""/><div class="controls bullet"><span class="by">dtgriscom</span><span>|</span><a href="#38887127">parent</a><span>|</span><a href="#38888939">next</a><span>|</span><label class="collapse" for="c-38887924">[-]</label><label class="expand" for="c-38887924">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing &quot;all the best programs&quot; was offered tongue-in-cheek.</div><br/></div></div><div id="38888939" class="c"><input type="checkbox" id="c-38888939" checked=""/><div class="controls bullet"><span class="by">mmsc</span><span>|</span><a href="#38887127">parent</a><span>|</span><a href="#38887924">prev</a><span>|</span><a href="#38888566">next</a><span>|</span><label class="collapse" for="c-38888939">[-]</label><label class="expand" for="c-38888939">[1 more]</label></div><br/><div class="children"><div class="content">Author of the software here.<p>It was a joke.</div><br/></div></div><div id="38888566" class="c"><input type="checkbox" id="c-38888566" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#38887127">parent</a><span>|</span><a href="#38888939">prev</a><span>|</span><a href="#38887353">next</a><span>|</span><label class="collapse" for="c-38888566">[-]</label><label class="expand" for="c-38888566">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s for post-exploitation, all the &quot;crunchy outside, chewy interior&quot; 90s style insecure enterprise networks separated from the elements by a perimeter firewall have 10.x ipv4 addressing.</div><br/></div></div></div></div><div id="38887353" class="c"><input type="checkbox" id="c-38887353" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#38887127">prev</a><span>|</span><a href="#38888850">next</a><span>|</span><label class="collapse" for="c-38887353">[-]</label><label class="expand" for="c-38887353">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious why this tool wouldn&#x27;t use all the settings in the ssh config to attempt to connect to hosts.. instead it only picks a subset of those settings. For example, of the config file specifies a port besides 22, it won&#x27;t be able to connect to that host (or for example, if the config file sets `PubkeyAcceptedAlgorithms=+ssh-rsa` which is necessary, albeit insecure, if using an older private key file on a newer version of ssh which disables RSA key exchange)<p>I see no downside to just using the hostname from the config file instead of trying to apply a few select options from the config, and non-standard ports are extremely common</div><br/><div id="38888999" class="c"><input type="checkbox" id="c-38888999" checked=""/><div class="controls bullet"><span class="by">mmsc</span><span>|</span><a href="#38887353">parent</a><span>|</span><a href="#38887367">next</a><span>|</span><label class="collapse" for="c-38888999">[-]</label><label class="expand" for="c-38888999">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  or for example, if the config file sets `PubkeyAcceptedAlgorithms=+ssh-rsa` which is necessary
</code></pre>
It already does this: <a href="https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067a1b96f69e508df52831a08b8b&#x2F;Snake.sh#L216">https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067...</a> and <a href="https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067a1b96f69e508df52831a08b8b&#x2F;Snake.sh#L639C3-L639C3">https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067...</a><p><pre><code>  I see no downside to just using the hostname from the config file 
</code></pre>
It already does this: <a href="https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;main&#x2F;Snake.sh#L1225">https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;main&#x2F;Snake.sh#L...</a><p><pre><code>  the config file specifies a port besides 22, it won&#x27;t be able to connect to that host
</code></pre>
This shouldn&#x27;t be hard to implement and can certainly be added in a later version.</div><br/></div></div><div id="38887367" class="c"><input type="checkbox" id="c-38887367" checked=""/><div class="controls bullet"><span class="by">chaps</span><span>|</span><a href="#38887353">parent</a><span>|</span><a href="#38888999">prev</a><span>|</span><a href="#38888850">next</a><span>|</span><label class="collapse" for="c-38887367">[-]</label><label class="expand" for="c-38887367">[1 more]</label></div><br/><div class="children"><div class="content">My theory&#x27;s that it&#x27;s to ensure backwards compatibility with ooooold hosts.</div><br/></div></div></div></div><div id="38888850" class="c"><input type="checkbox" id="c-38888850" checked=""/><div class="controls bullet"><span class="by">stevebmark</span><span>|</span><a href="#38887353">prev</a><span>|</span><a href="#38886330">next</a><span>|</span><label class="collapse" for="c-38888850">[-]</label><label class="expand" for="c-38888850">[2 more]</label></div><br/><div class="children"><div class="content">Is there any risk with running this locally just to see what SSH traversal is available? I have several legitimate hosts I SSH into regularly, some are cloud hosting.</div><br/><div id="38889035" class="c"><input type="checkbox" id="c-38889035" checked=""/><div class="controls bullet"><span class="by">mmsc</span><span>|</span><a href="#38888850">parent</a><span>|</span><a href="#38886330">next</a><span>|</span><label class="collapse" for="c-38889035">[-]</label><label class="expand" for="c-38889035">[1 more]</label></div><br/><div class="children"><div class="content">Not really. You can comment out this line: <a href="https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067a1b96f69e508df52831a08b8b&#x2F;Snake.sh#L964">https:&#x2F;&#x2F;github.com&#x2F;MegaManSec&#x2F;SSH-Snake&#x2F;blob&#x2F;7ae7ef0afe0e067...</a> to disable the printing of the private keys to the terminal if you want, too.</div><br/></div></div></div></div><div id="38886330" class="c"><input type="checkbox" id="c-38886330" checked=""/><div class="controls bullet"><span class="by">GabrieleR</span><span>|</span><a href="#38888850">prev</a><span>|</span><a href="#38887700">next</a><span>|</span><label class="collapse" for="c-38886330">[-]</label><label class="expand" for="c-38886330">[1 more]</label></div><br/><div class="children"><div class="content">The snake sh code was a graceful late night read to me. Thanks. I can see it being used even to purposely puppeteer ssh linked machines</div><br/></div></div><div id="38887700" class="c"><input type="checkbox" id="c-38887700" checked=""/><div class="controls bullet"><span class="by">randombits0</span><span>|</span><a href="#38886330">prev</a><span>|</span><label class="collapse" for="c-38887700">[-]</label><label class="expand" for="c-38887700">[1 more]</label></div><br/><div class="children"><div class="content">A message-passer or a Quine?  Because a Quine would be awesome.</div><br/></div></div></div></div></div></div></div></body></html>