<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1715677264332" as="style"/><link rel="stylesheet" href="styles.css?v=1715677264332"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://arvyy.github.io/islisp-truffle/">Truffle ISLISP</a>Â <span class="domain">(<a href="https://arvyy.github.io">arvyy.github.io</a>)</span></div><div class="subtext"><span>mepian</span> | <span>15 comments</span></div><br/><div><div id="40352858" class="c"><input type="checkbox" id="c-40352858" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#40352942">next</a><span>|</span><label class="collapse" for="c-40352858">[-]</label><label class="expand" for="c-40352858">[1 more]</label></div><br/><div class="children"><div class="content">I remember a weird misconception floating around &quot;back in the day&quot; that ISLisp restricted the <i>cdr</i> fields of cons cells to be either <i>nil</i> or <i>cons</i>.  Or some sort of claim along those lines. But I see from even the 1997 draft that this is not true. I don&#x27;t see anything that could be easily misread that way, either.<p>Where did that come from?<p>In fact, quite the opposite: ISLisp requires all atoms to be considered list terminators. It is documented for the <i>length</i> function that (length &#x27;(a b . c)) =&gt; 2.</div><br/></div></div><div id="40352942" class="c"><input type="checkbox" id="c-40352942" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#40352858">prev</a><span>|</span><a href="#40351068">next</a><span>|</span><label class="collapse" for="c-40352942">[-]</label><label class="expand" for="c-40352942">[1 more]</label></div><br/><div class="children"><div class="content">Wow, the PDFs of the ISLisp spec are not searchable. Whether in the browser&#x27;s PDF reader or Acrobat, no hits on searches like &quot;mapcar&quot; or &quot;length&quot;.</div><br/></div></div><div id="40351068" class="c"><input type="checkbox" id="c-40351068" checked=""/><div class="controls bullet"><span class="by">WatchDog</span><span>|</span><a href="#40352942">prev</a><span>|</span><a href="#40351637">next</a><span>|</span><label class="collapse" for="c-40351068">[-]</label><label class="expand" for="c-40351068">[2 more]</label></div><br/><div class="children"><div class="content">Any benchmarks?</div><br/><div id="40352899" class="c"><input type="checkbox" id="c-40352899" checked=""/><div class="controls bullet"><span class="by">arvyy</span><span>|</span><a href="#40351068">parent</a><span>|</span><a href="#40351637">next</a><span>|</span><label class="collapse" for="c-40352899">[-]</label><label class="expand" for="c-40352899">[1 more]</label></div><br/><div class="children"><div class="content">Performance concerns are WIP, it&#x27;s too early to meaningfully benchmark. I did some napkin benchmarking against sbcl for curiosity and it was ~7 times slower</div><br/></div></div></div></div><div id="40351637" class="c"><input type="checkbox" id="c-40351637" checked=""/><div class="controls bullet"><span class="by">szopa</span><span>|</span><a href="#40351068">prev</a><span>|</span><label class="collapse" for="c-40351637">[-]</label><label class="expand" for="c-40351637">[10 more]</label></div><br/><div class="children"><div class="content">Why should we be excited about this?</div><br/><div id="40351741" class="c"><input type="checkbox" id="c-40351741" checked=""/><div class="controls bullet"><span class="by">ksaj</span><span>|</span><a href="#40351637">parent</a><span>|</span><a href="#40352058">next</a><span>|</span><label class="collapse" for="c-40351741">[-]</label><label class="expand" for="c-40351741">[2 more]</label></div><br/><div class="children"><div class="content">Judging by the name, the exciting part is the framework it was written on. As a habit, I do not use software that relies on code association in the name as a selling point. A lot of new coders use this naming convention, as they&#x27;ve become excited cheerleaders for their platform of choice (especially if it is a recent language or framework). But how much do actual users care about the underlying technicals? Why make the software sound like it is <i>part</i> of the language or framework when it isn&#x27;t?<p>Imagine if there was an InlineAsmGrub to compete against that other GRUB. It&#x27;s just that silly a practice.</div><br/><div id="40352727" class="c"><input type="checkbox" id="c-40352727" checked=""/><div class="controls bullet"><span class="by">arvyy</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40351741">parent</a><span>|</span><a href="#40352058">next</a><span>|</span><label class="collapse" for="c-40352727">[-]</label><label class="expand" for="c-40352727">[1 more]</label></div><br/><div class="children"><div class="content">I see where you&#x27;re coming from, and the naming was quite unimaginative, indeed. I saw that &quot;truffle ruby&quot; called itself that and copied it.<p>However, the fact it&#x27;s based on truffle is the selling point -- truffle enables interop between languages on the framework. So, for example, you can take truffle JS implementation, import express library or whatever, and then as part of the implementation do<p>````<p>let fn = Polyglot.eval(&#x27;islisp&#x27;, &#x27;(lambda (x) (+ x 1))&#x27;);<p>fn(1);<p>````<p>(toy example. But this interop can happen in all directions, it&#x27;s not limited to js but can be used from truffle python, ruby, java, etc; and it also isn&#x27;t limited to just primitive values, you can pass around functions as well).<p>If you aren&#x27;t looking for a specifically a truffle lisp, it would make more sense to use one of the established common lisp implementations.</div><br/></div></div></div></div><div id="40352058" class="c"><input type="checkbox" id="c-40352058" checked=""/><div class="controls bullet"><span class="by">cess11</span><span>|</span><a href="#40351637">parent</a><span>|</span><a href="#40351741">prev</a><span>|</span><label class="collapse" for="c-40352058">[-]</label><label class="expand" for="c-40352058">[7 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an implementation of an ISO-standardised Lisp, pretty much a cleaned up and streamlined ISO alternative to ANSI Common Lisp and the Scheme:s. Aims to be industrially relevant rather than academic, the object system is somewhat simpler than CLOS. More here: <a href="http:&#x2F;&#x2F;islisp.org&#x2F;" rel="nofollow">http:&#x2F;&#x2F;islisp.org&#x2F;</a><p>The GraalVM is a tool used, among other things, to produce native binaries, and Truffle a programming language for implementing programming languages on Graal.<p>One could expect pretty good performance, possibly at the price of somewhat slow compilation.</div><br/><div id="40352246" class="c"><input type="checkbox" id="c-40352246" checked=""/><div class="controls bullet"><span class="by">BoingBoomTschak</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40352058">parent</a><span>|</span><a href="#40352837">prev</a><span>|</span><label class="collapse" for="c-40352246">[-]</label><label class="expand" for="c-40352246">[5 more]</label></div><br/><div class="children"><div class="content">Which doesn&#x27;t have macros nor hash table according to <a href="http:&#x2F;&#x2F;www.islisp.org&#x2F;whatisISLisp.html" rel="nofollow">http:&#x2F;&#x2F;www.islisp.org&#x2F;whatisISLisp.html</a><p>Good joke.</div><br/><div id="40352285" class="c"><input type="checkbox" id="c-40352285" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40352246">parent</a><span>|</span><label class="collapse" for="c-40352285">[-]</label><label class="expand" for="c-40352285">[4 more]</label></div><br/><div class="children"><div class="content">ISLisp has macros. (I&#x27;m looking at section 16 of the latest 2007 working draft.)</div><br/><div id="40352630" class="c"><input type="checkbox" id="c-40352630" checked=""/><div class="controls bullet"><span class="by">a-french-anon</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40352285">parent</a><span>|</span><label class="collapse" for="c-40352630">[-]</label><label class="expand" for="c-40352630">[3 more]</label></div><br/><div class="children"><div class="content">Hmmm, then did I misread this fragment?<p>&quot;In ISLisp, language specifications are separated from processor specifications. ISLisp forms after macro expansion and other pre-processing are called &quot;prepared form&quot; and ISLisp does not define preparation procedures.&quot;</div><br/><div id="40352753" class="c"><input type="checkbox" id="c-40352753" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40352630">parent</a><span>|</span><a href="#40352726">next</a><span>|</span><label class="collapse" for="c-40352753">[-]</label><label class="expand" for="c-40352753">[1 more]</label></div><br/><div class="children"><div class="content">That exact text is not found in the spec; it&#x27;s from the ISLisp page. ISLisp does have the concept of &quot;prepared form&quot; it refers to, but you have to look at the spec to understand what that means.<p>It looks to me that this &quot;prepared form&quot; is the same as in other traditional Lisps: that the source code of the program is defined in terms of nested lists, but may undergo a transformation into an undocumented form (for instance ARM machine language) in preparation for execution. E.g. in Steel Bank Common Lisp, everything you type into the REPL is first transformed into machine code and then run. Common Lisp doesn&#x27;t define the details of such a thing, but does have a lot to say about compilation.<p>The actual ISLisp says:<p><i>An object is prepared for execution; this might include transformation or compilation,
including macro expansion. The method of preparation for execution and its result are not
defined in this document (with exception of the violations to be detected). After successful
preparation for execution the result is ready for execution.</i><p>Obviously, the macro expansion parts are defined at least to some extent because it interacts with user macro definitions. (Perhaps even when it comes to macro expansion, ISLisp doesn&#x27;t nail down the exact semantics, like when exactly is it done. It&#x27;s possible for a pure Lisp interpreter to work with unexpanded code and continuously re-expand any macro call that it encounters, in the latest dynamic environment. That allows for macros to be fixed on-the-fly.)</div><br/></div></div><div id="40352726" class="c"><input type="checkbox" id="c-40352726" checked=""/><div class="controls bullet"><span class="by">cess11</span><span>|</span><a href="#40351637">root</a><span>|</span><a href="#40352630">parent</a><span>|</span><a href="#40352753">prev</a><span>|</span><label class="collapse" for="c-40352726">[-]</label><label class="expand" for="c-40352726">[1 more]</label></div><br/><div class="children"><div class="content"><a href="http:&#x2F;&#x2F;islisp.org&#x2F;docs&#x2F;islisp-v23.pdf" rel="nofollow">http:&#x2F;&#x2F;islisp.org&#x2F;docs&#x2F;islisp-v23.pdf</a> , page 61-62. Has a familiar defmacro, with quote&#x2F;unquote&#x2F;quasiquote.<p>The text you&#x27;re quoting implies the language has a macro expander. There are arrays and vectors, so you could implement hashmaps, and I think some of the implementations of the language already does.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>