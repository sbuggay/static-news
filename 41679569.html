<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1727946065570" as="style"/><link rel="stylesheet" href="styles.css?v=1727946065570"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/NeilBotelho/turboAsync">Show HN: Bringing multithreading to Python&#x27;s async event loop</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>nbsande</span> | <span>11 comments</span></div><br/><div><div id="41682746" class="c"><input type="checkbox" id="c-41682746" checked=""/><div class="controls bullet"><span class="by">noident</span><span>|</span><a href="#41682712">next</a><span>|</span><label class="collapse" for="c-41682746">[-]</label><label class="expand" for="c-41682746">[3 more]</label></div><br/><div class="children"><div class="content">&gt; It got me wondering if it was actually possible to make Python’s async event loop work with multiple threads.<p>There is built-in support for this. Take a look at loop.run_in_executor. You can await something scheduled in a separate Thread&#x2F;ProcessPoolExecutor.<p>Granted, this is different than making the async library end-to-end multi-threaded as you seem to be trying to do, but it does seem worth mentioning in this context. You _can_ have async and multiple threads at the same time!</div><br/><div id="41685302" class="c"><input type="checkbox" id="c-41685302" checked=""/><div class="controls bullet"><span class="by">nbsande</span><span>|</span><a href="#41682746">parent</a><span>|</span><a href="#41682712">next</a><span>|</span><label class="collapse" for="c-41685302">[-]</label><label class="expand" for="c-41685302">[2 more]</label></div><br/><div class="children"><div class="content">run_in_executor is pretty powerful for running sync code in async code, but my use case was more making async code utlize the cpu better. I think, just using run_in_executor would add a lot of complication and changes to how you use async await. But great point none the less!</div><br/><div id="41728628" class="c"><input type="checkbox" id="c-41728628" checked=""/><div class="controls bullet"><span class="by">zo1</span><span>|</span><a href="#41682746">root</a><span>|</span><a href="#41685302">parent</a><span>|</span><a href="#41682712">next</a><span>|</span><label class="collapse" for="c-41728628">[-]</label><label class="expand" for="c-41728628">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve had plenty of success using run_in_executor in production. You basically just use the decorator, and it mostly just works.</div><br/></div></div></div></div></div></div><div id="41682712" class="c"><input type="checkbox" id="c-41682712" checked=""/><div class="controls bullet"><span class="by">quotemstr</span><span>|</span><a href="#41682746">prev</a><span>|</span><label class="collapse" for="c-41682712">[-]</label><label class="expand" for="c-41682712">[7 more]</label></div><br/><div class="children"><div class="content">At that point, why bother with asyncio? What we really want is something like Java virtual threads, something that doesn&#x27;t have a code color.</div><br/><div id="41683007" class="c"><input type="checkbox" id="c-41683007" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#41682712">parent</a><span>|</span><a href="#41685314">next</a><span>|</span><label class="collapse" for="c-41683007">[-]</label><label class="expand" for="c-41683007">[1 more]</label></div><br/><div class="children"><div class="content">gevent is exactly this! <a href="http:&#x2F;&#x2F;www.gevent.org&#x2F;" rel="nofollow">http:&#x2F;&#x2F;www.gevent.org&#x2F;</a><p>My startup has been using it in production for years. It excels at I&#x2F;O bound workflows where you have highly concurrent real-time usage of slow&#x2F;unpredictable partner APIs. You just write normal (non-async) Python code and the patched system internals create yields to the event loop whenever you’d be waiting for I&#x2F;O, giving you essentially unlimited concurrency (as long as all pending requests and their context fit in RAM).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;gfmio&#x2F;asyncio-gevent">https:&#x2F;&#x2F;github.com&#x2F;gfmio&#x2F;asyncio-gevent</a> does exist to let you use asyncio code in a gevent context, but it’s far less battle-tested and we’ve avoided using it so far.</div><br/></div></div><div id="41685314" class="c"><input type="checkbox" id="c-41685314" checked=""/><div class="controls bullet"><span class="by">nbsande</span><span>|</span><a href="#41682712">parent</a><span>|</span><a href="#41683007">prev</a><span>|</span><a href="#41683134">next</a><span>|</span><label class="collapse" for="c-41685314">[-]</label><label class="expand" for="c-41685314">[1 more]</label></div><br/><div class="children"><div class="content">Hmmm. That would indeed be better. Seems like an interesting experiment to try and implement virtual threads for python!</div><br/></div></div><div id="41683134" class="c"><input type="checkbox" id="c-41683134" checked=""/><div class="controls bullet"><span class="by">drowsspa</span><span>|</span><a href="#41682712">parent</a><span>|</span><a href="#41685314">prev</a><span>|</span><label class="collapse" for="c-41683134">[-]</label><label class="expand" for="c-41683134">[4 more]</label></div><br/><div class="children"><div class="content">Not for those of us stuck in Java 8... Is it stable already?</div><br/><div id="41684598" class="c"><input type="checkbox" id="c-41684598" checked=""/><div class="controls bullet"><span class="by">quotemstr</span><span>|</span><a href="#41682712">root</a><span>|</span><a href="#41683134">parent</a><span>|</span><label class="collapse" for="c-41684598">[-]</label><label class="expand" for="c-41684598">[3 more]</label></div><br/><div class="children"><div class="content">I hear that some Amish sects permit the use of technology that&#x27;s older and proven not to be too worldly, like washing machines, chainsaws, and Java 11. Have you considered converting?</div><br/><div id="41701208" class="c"><input type="checkbox" id="c-41701208" checked=""/><div class="controls bullet"><span class="by">drowsspa</span><span>|</span><a href="#41682712">root</a><span>|</span><a href="#41684598">parent</a><span>|</span><label class="collapse" for="c-41701208">[-]</label><label class="expand" for="c-41701208">[2 more]</label></div><br/><div class="children"><div class="content">Yeah... Unfortunately golden handcuffs are binding me to the  financial sector and, specifically, to Hadoop</div><br/><div id="41728503" class="c"><input type="checkbox" id="c-41728503" checked=""/><div class="controls bullet"><span class="by">fnord123</span><span>|</span><a href="#41682712">root</a><span>|</span><a href="#41701208">parent</a><span>|</span><label class="collapse" for="c-41728503">[-]</label><label class="expand" for="c-41728503">[1 more]</label></div><br/><div class="children"><div class="content">Hadoop &gt;=3.3 supports Java11.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>