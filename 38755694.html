<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1703494858722" as="style"/><link rel="stylesheet" href="styles.css?v=1703494858722"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://muxup.com/2023q4/let-the-terminal-bells-ring-out">Let the terminal bells ring out</a> <span class="domain">(<a href="https://muxup.com">muxup.com</a>)</span></div><div class="subtext"><span>hasheddan</span> | <span>28 comments</span></div><br/><div><div id="38757107" class="c"><input type="checkbox" id="c-38757107" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#38756438">next</a><span>|</span><label class="collapse" for="c-38757107">[-]</label><label class="expand" for="c-38757107">[5 more]</label></div><br/><div class="children"><div class="content">The article mentions not wanting to put a bell in their terminal prompt because it would cause too many notifications, but I found it difficult to remember to put `;tput bel` on every command that would be slow, so I compromised by configuring my shell to notify only on commands that took longer than 10 seconds. I also use a popup instead of a straight bell so I&#x27;ll see a reminder of what it was that was happening (this is for MacOS, on Linux it would use `notify-send` instead):<p><pre><code>    function preexec() {
      lrn_timer=${timer:-$SECONDS}
      lrn_command=&quot;$1&quot;
    }
    lrn_timer=0
    function precmd() {
      [[ -v lrn_timer ]] || return # preexec() doesn&#x27;t set timer if no command run (e.g. from ^C before running)
      timer_show=$(($SECONDS - $lrn_timer))
      unset lrn_timer
      # 10 is the notification threshold in seconds
      if (( ${timer_show} &gt; 10 )); then
        terminal-notifier -sound default -message &quot;Exit $? in ${timer_show}s: $lrn_command&quot;
      fi
    }
</code></pre>
(Based on <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;petethepig&#x2F;2d29e8b7e2ebc808bfe760b632608966" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;petethepig&#x2F;2d29e8b7e2ebc808bfe760b63...</a>)</div><br/><div id="38757500" class="c"><input type="checkbox" id="c-38757500" checked=""/><div class="controls bullet"><span class="by">mklein994</span><span>|</span><a href="#38757107">parent</a><span>|</span><a href="#38757785">next</a><span>|</span><label class="collapse" for="c-38757500">[-]</label><label class="expand" for="c-38757500">[1 more]</label></div><br/><div class="children"><div class="content">&gt; [...] but I found it difficult to remember to put `;tput bel` on every command that would be slow [...]<p>What I do in these situations (assuming the job is still in the foreground, and can be interrupted), is suspend the task with ctrl+z and resume with `fg`, chaining it with some other command:<p><pre><code>    fg; notify-send &quot;done&quot;
</code></pre>
This uses the &quot;job control&quot; feature of `bash`, so it requires no extra setup. Your approach has the simple advantage however, that once it&#x27;s set up, it just works, automatically.</div><br/></div></div><div id="38757785" class="c"><input type="checkbox" id="c-38757785" checked=""/><div class="controls bullet"><span class="by">JNRowe</span><span>|</span><a href="#38757107">parent</a><span>|</span><a href="#38757500">prev</a><span>|</span><a href="#38758868">next</a><span>|</span><label class="collapse" for="c-38757785">[-]</label><label class="expand" for="c-38757785">[1 more]</label></div><br/><div class="children"><div class="content">One of the smart things with zsh is that the hooks¹ like precmd can be replaced with arrays of functions, so that you can cleanly have multiple hooks per hook point.  It even provides a nice tool to work with the the arrays too², which makes editing&#x2F;enabling&#x2F;disabling far easier.<p>It makes life far easier when you see people post useful snippets(like wolfgang42&#x27;s), but don&#x27;t want to have to mangle them in to your already messy monolithic function.<p>¹ <a href="https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;Functions.html#Hook-Functions" rel="nofollow noreferrer">https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;Functions.html#Hook-F...</a><p>² <a href="https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;User-Contributions.html#Manipulating-Hook-Functions" rel="nofollow noreferrer">https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;User-Contributions.ht...</a></div><br/></div></div><div id="38758868" class="c"><input type="checkbox" id="c-38758868" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#38757107">parent</a><span>|</span><a href="#38757785">prev</a><span>|</span><a href="#38756438">next</a><span>|</span><label class="collapse" for="c-38758868">[-]</label><label class="expand" for="c-38758868">[2 more]</label></div><br/><div class="children"><div class="content">How does this work without `trap` or `PROMPT_COMMAND`?<p>(I think PROMPT_COMMAND will take an array of functions in later versions of Bash)</div><br/><div id="38759197" class="c"><input type="checkbox" id="c-38759197" checked=""/><div class="controls bullet"><span class="by">wolfgang42</span><span>|</span><a href="#38757107">root</a><span>|</span><a href="#38758868">parent</a><span>|</span><a href="#38756438">next</a><span>|</span><label class="collapse" for="c-38759197">[-]</label><label class="expand" for="c-38759197">[1 more]</label></div><br/><div class="children"><div class="content">zsh has some special handling if you define functions with magic names: <a href="https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;Functions.html#Hook-Functions" rel="nofollow noreferrer">https:&#x2F;&#x2F;zsh.sourceforge.io&#x2F;Doc&#x2F;Release&#x2F;Functions.html#Hook-F...</a><p>(I apparently knew this when I wrote the above code, since on closer inspection it doesn’t actually match the gist my comments claim it came from, but I have to admit I had since forgotten it.)</div><br/></div></div></div></div></div></div><div id="38756438" class="c"><input type="checkbox" id="c-38756438" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#38757107">prev</a><span>|</span><a href="#38757872">next</a><span>|</span><label class="collapse" for="c-38756438">[-]</label><label class="expand" for="c-38756438">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;d wanted a bell in the Rust Egui&#x2F;Winit system. There&#x27;s no simple cross-platform &quot;beep&quot; or bell feature, short of bringing up a whole audio system.<p>The original Teletype bell in a Model 15 Teletype is a 3-inch gong with a satisfying &quot;bong&quot; sound. That was intended to be heard across a room of noisy machines. There&#x27;s also a little end of line bell for typists, but that&#x27;s not loud.</div><br/><div id="38756922" class="c"><input type="checkbox" id="c-38756922" checked=""/><div class="controls bullet"><span class="by">10000truths</span><span>|</span><a href="#38756438">parent</a><span>|</span><a href="#38757872">next</a><span>|</span><label class="collapse" for="c-38756922">[-]</label><label class="expand" for="c-38756922">[3 more]</label></div><br/><div class="children"><div class="content">&gt; The original Teletype bell in a Model 15 Teletype is a 3-inch gong with a satisfying &quot;bong&quot; sound. That was intended to be heard across a room of noisy machines. There&#x27;s also a little end of line bell for typists, but that&#x27;s not loud.<p>What would the machine do if a mischievous prankster ran a program that endlessly outputted ASCII BEL characters in a tight loop?</div><br/><div id="38756968" class="c"><input type="checkbox" id="c-38756968" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#38756438">root</a><span>|</span><a href="#38756922">parent</a><span>|</span><a href="#38757872">next</a><span>|</span><label class="collapse" for="c-38756968">[-]</label><label class="expand" for="c-38756968">[2 more]</label></div><br/><div class="children"><div class="content">Ring the bell. Doesn&#x27;t hurt anything. Eventually someone will turn the machine off.<p>The later ASCII machines don&#x27;t have the big gong, just a smaller bell.</div><br/><div id="38759663" class="c"><input type="checkbox" id="c-38759663" checked=""/><div class="controls bullet"><span class="by">kps</span><span>|</span><a href="#38756438">root</a><span>|</span><a href="#38756968">parent</a><span>|</span><a href="#38757872">next</a><span>|</span><label class="collapse" for="c-38759663">[-]</label><label class="expand" for="c-38759663">[1 more]</label></div><br/><div class="children"><div class="content">I used to have a Model 43 Teletype. Sending a suitable number of BELs and then sleeping 4 seconds made for a convincing simulation of a ringing telephone.</div><br/></div></div></div></div></div></div></div></div><div id="38757872" class="c"><input type="checkbox" id="c-38757872" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#38756438">prev</a><span>|</span><a href="#38756481">next</a><span>|</span><label class="collapse" for="c-38757872">[-]</label><label class="expand" for="c-38757872">[2 more]</label></div><br/><div class="children"><div class="content">&gt; konsole: As far as I can tell it isn&#x27;t supported. Creating a new profile and setting the &quot;Terminal bell mode&quot; to &quot;Visual Bell&quot; doesn&#x27;t seem to result in the urgent hint being set.<p>However, Konsole has a way better solution for the presented problem: it has been possible to &quot;monitor for (in)activity for a long time. It is also now possible to monitor for process termination, which you can (un)check anytime if you decide that you need to be notified.<p>These features are very convenient, much better than having to hack a solution using the bell in my opinion.</div><br/><div id="38758171" class="c"><input type="checkbox" id="c-38758171" checked=""/><div class="controls bullet"><span class="by">chaps</span><span>|</span><a href="#38757872">parent</a><span>|</span><a href="#38756481">next</a><span>|</span><label class="collapse" for="c-38758171">[-]</label><label class="expand" for="c-38758171">[1 more]</label></div><br/><div class="children"><div class="content">Difference is that what the author wrote is a fair bit more portable since it doesn&#x27;t require the use of a separate terminal xlient. Sure, konsole is lightweight and relatively portable, but doing it in a shell this way would work regardless of the terminal.</div><br/></div></div></div></div><div id="38756481" class="c"><input type="checkbox" id="c-38756481" checked=""/><div class="controls bullet"><span class="by">efitz</span><span>|</span><a href="#38757872">prev</a><span>|</span><a href="#38758200">next</a><span>|</span><label class="collapse" for="c-38756481">[-]</label><label class="expand" for="c-38756481">[2 more]</label></div><br/><div class="children"><div class="content">I thought this was going to be an article about how someone used a Raspberry Pi and some  maker fu to connect 0x7 on their terminal to a cathedral or something.</div><br/><div id="38757935" class="c"><input type="checkbox" id="c-38757935" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#38756481">parent</a><span>|</span><a href="#38758200">next</a><span>|</span><label class="collapse" for="c-38757935">[-]</label><label class="expand" for="c-38757935">[1 more]</label></div><br/><div class="children"><div class="content">Now I want this.</div><br/></div></div></div></div><div id="38758200" class="c"><input type="checkbox" id="c-38758200" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#38756481">prev</a><span>|</span><a href="#38757640">next</a><span>|</span><label class="collapse" for="c-38758200">[-]</label><label class="expand" for="c-38758200">[2 more]</label></div><br/><div class="children"><div class="content">I still connect a piezo to the speaker port of the motherboard front panel block.<p>Cases don&#x27;t have the speakers anymore, but boards fortunately still have the port.<p>It beeps nicely with BEL or with invalid input.</div><br/><div id="38759001" class="c"><input type="checkbox" id="c-38759001" checked=""/><div class="controls bullet"><span class="by">tymscar</span><span>|</span><a href="#38758200">parent</a><span>|</span><a href="#38757640">next</a><span>|</span><label class="collapse" for="c-38759001">[-]</label><label class="expand" for="c-38759001">[1 more]</label></div><br/><div class="children"><div class="content">Mine does not as far as I can tell. Heres the manual:<p><a href="https:&#x2F;&#x2F;dlcdnets.asus.com&#x2F;pub&#x2F;ASUS&#x2F;mb&#x2F;LGA1700&#x2F;ROG_MAXIMUS_Z790_HERO&#x2F;E21512_ROG_MAXIMUS_Z790_HERO_UM_V3_WEB.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;dlcdnets.asus.com&#x2F;pub&#x2F;ASUS&#x2F;mb&#x2F;LGA1700&#x2F;ROG_MAXIMUS_Z7...</a></div><br/></div></div></div></div><div id="38757640" class="c"><input type="checkbox" id="c-38757640" checked=""/><div class="controls bullet"><span class="by">jhaenchen</span><span>|</span><a href="#38758200">prev</a><span>|</span><a href="#38758983">next</a><span>|</span><label class="collapse" for="c-38757640">[-]</label><label class="expand" for="c-38757640">[1 more]</label></div><br/><div class="children"><div class="content">I use BEL + IFFTT webhooks to trigger a notification on my laptop and my iPhone whenever something finishes. Echo hi; notification<p>With an alias for notification</div><br/></div></div><div id="38758983" class="c"><input type="checkbox" id="c-38758983" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#38757640">prev</a><span>|</span><a href="#38756466">next</a><span>|</span><label class="collapse" for="c-38758983">[-]</label><label class="expand" for="c-38758983">[1 more]</label></div><br/><div class="children"><div class="content">The terminal bell is dead; history has killed it.</div><br/></div></div><div id="38756466" class="c"><input type="checkbox" id="c-38756466" checked=""/><div class="controls bullet"><span class="by">wanderingjew</span><span>|</span><a href="#38758983">prev</a><span>|</span><a href="#38756630">next</a><span>|</span><label class="collapse" for="c-38756466">[-]</label><label class="expand" for="c-38756466">[5 more]</label></div><br/><div class="children"><div class="content">If you&#x27;ve ever wondered why it&#x27;s ctrl+g:<p><a href="https:&#x2F;&#x2F;twitter.com&#x2F;ViolenceWorks&#x2F;status&#x2F;1335382435031252992?t=opHY3wm7MCWz17exckm7vQ&amp;s=19" rel="nofollow noreferrer">https:&#x2F;&#x2F;twitter.com&#x2F;ViolenceWorks&#x2F;status&#x2F;1335382435031252992...</a></div><br/><div id="38758495" class="c"><input type="checkbox" id="c-38758495" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#38756466">parent</a><span>|</span><a href="#38758489">next</a><span>|</span><label class="collapse" for="c-38758495">[-]</label><label class="expand" for="c-38758495">[3 more]</label></div><br/><div class="children"><div class="content">Can&#x27;t open because twitter, but here&#x27;s own explanation:<p>Control-a inputs byte value 1, control-b 2 and so on.<p>BEL is mapped to value 7 in ascii, thus C-g.<p>Note control-space usually does input a NUL (0) in most terminals.</div><br/><div id="38758619" class="c"><input type="checkbox" id="c-38758619" checked=""/><div class="controls bullet"><span class="by">susam</span><span>|</span><a href="#38756466">root</a><span>|</span><a href="#38758495">parent</a><span>|</span><a href="#38758524">next</a><span>|</span><label class="collapse" for="c-38758619">[-]</label><label class="expand" for="c-38758619">[1 more]</label></div><br/><div class="children"><div class="content">Another way to look at it is that Ctrl+G takes the code (ASCII) of G, i.e., 71 (binary 1000111) and toggles its 7th least significant bit to get 7 (binary 111) and indeed 7 is the code of the BEL character.<p>This explanation is over-simplified though. In practice, different systems have used different techniques to derive control codes from key chords. I have a more detailed article about this at <a href="https:&#x2F;&#x2F;susam.net&#x2F;blog&#x2F;control-escape-meta-tricks.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;susam.net&#x2F;blog&#x2F;control-escape-meta-tricks.html</a> if anyone is interested to read it.</div><br/></div></div><div id="38758524" class="c"><input type="checkbox" id="c-38758524" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#38756466">root</a><span>|</span><a href="#38758495">parent</a><span>|</span><a href="#38758619">prev</a><span>|</span><a href="#38758489">next</a><span>|</span><label class="collapse" for="c-38758524">[-]</label><label class="expand" for="c-38758524">[1 more]</label></div><br/><div class="children"><div class="content">Producing ASCII control codes is why the Control code came to be and thats how it got its name:<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Control_key#History" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Control_key#History</a></div><br/></div></div></div></div><div id="38758489" class="c"><input type="checkbox" id="c-38758489" checked=""/><div class="controls bullet"><span class="by">Arch485</span><span>|</span><a href="#38756466">parent</a><span>|</span><a href="#38758495">prev</a><span>|</span><a href="#38756630">next</a><span>|</span><label class="collapse" for="c-38758489">[-]</label><label class="expand" for="c-38758489">[1 more]</label></div><br/><div class="children"><div class="content">This was super cool - I&#x27;ve always wondered why the bell character exists&#x2F;why it&#x27;s ctrl+G.</div><br/></div></div></div></div><div id="38756630" class="c"><input type="checkbox" id="c-38756630" checked=""/><div class="controls bullet"><span class="by">mprovost</span><span>|</span><a href="#38756466">prev</a><span>|</span><a href="#38757913">next</a><span>|</span><label class="collapse" for="c-38756630">[-]</label><label class="expand" for="c-38756630">[4 more]</label></div><br/><div class="children"><div class="content">‘Wuff, Wuff!!’</div><br/><div id="38757248" class="c"><input type="checkbox" id="c-38757248" checked=""/><div class="controls bullet"><span class="by">anilakar</span><span>|</span><a href="#38756630">parent</a><span>|</span><a href="#38757913">next</a><span>|</span><label class="collapse" for="c-38757248">[-]</label><label class="expand" for="c-38757248">[3 more]</label></div><br/><div class="children"><div class="content">Spawning a screen session by default is a good habit indeed. Especially on remote hosts when you are doing something critical.</div><br/><div id="38758186" class="c"><input type="checkbox" id="c-38758186" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#38756630">root</a><span>|</span><a href="#38757248">parent</a><span>|</span><a href="#38757913">next</a><span>|</span><label class="collapse" for="c-38758186">[-]</label><label class="expand" for="c-38758186">[2 more]</label></div><br/><div class="children"><div class="content">This, except tmux.</div><br/><div id="38758669" class="c"><input type="checkbox" id="c-38758669" checked=""/><div class="controls bullet"><span class="by">susam</span><span>|</span><a href="#38756630">root</a><span>|</span><a href="#38758186">parent</a><span>|</span><a href="#38757913">next</a><span>|</span><label class="collapse" for="c-38758669">[-]</label><label class="expand" for="c-38758669">[1 more]</label></div><br/><div class="children"><div class="content">Indeed! This is such an important part of my computing environment that I have the following in my &quot;.*shrc&quot;:<p><pre><code>  # Attach to an existing tmux or a launch new tmux.
  [ -n &quot;$STY$TMUX$INSIDE_EMACS&quot; ] || tmux at || tmux
</code></pre>
Source: <a href="https:&#x2F;&#x2F;github.com&#x2F;susam&#x2F;dotfiles&#x2F;blob&#x2F;main&#x2F;shrc#L381">https:&#x2F;&#x2F;github.com&#x2F;susam&#x2F;dotfiles&#x2F;blob&#x2F;main&#x2F;shrc#L381</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>