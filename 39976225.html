<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712653274363" as="style"/><link rel="stylesheet" href="styles.css?v=1712653274363"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.hezmatt.org/~mpalmer/blog/2024/04/09/how-i-tripped-over-the-debian-weak-keys-vuln.html">How I Tripped Over the Debian Weak Keys Vulnerability</a> <span class="domain">(<a href="https://www.hezmatt.org">www.hezmatt.org</a>)</span></div><div class="subtext"><span>ecliptik</span> | <span>27 comments</span></div><br/><div><div id="39977183" class="c"><input type="checkbox" id="c-39977183" checked=""/><div class="controls bullet"><span class="by">Sesse__</span><span>|</span><a href="#39977081">next</a><span>|</span><label class="collapse" for="c-39977183">[-]</label><label class="expand" for="c-39977183">[1 more]</label></div><br/><div class="children"><div class="content">“While I’ve not found a description of exactly when and how Luciano Bello discovered the vulnerability that became CVE-2008-0166 […]”<p>From my IRC logs at the time:<p><pre><code>  17:23 &lt; luciano&gt; has really an accident. I was needing many primes numbers... 0:-)
  17:23 &lt; Sesse&gt; and you got the same numbers every time?
  17:25 &lt; luciano&gt; Sesse, not every time :P</code></pre></div><br/></div></div><div id="39977081" class="c"><input type="checkbox" id="c-39977081" checked=""/><div class="controls bullet"><span class="by">ckastner</span><span>|</span><a href="#39977183">prev</a><span>|</span><a href="#39976547">next</a><span>|</span><label class="collapse" for="c-39977081">[-]</label><label class="expand" for="c-39977081">[1 more]</label></div><br/><div class="children"><div class="content">An important fact that I only recently learned about this vulnerability is that the change that introduced it was not some rushed act: the maintainer raised the problem they were seeing on the OpenSSL mailing list, proposed a change to fix the problem with a request for feedback, and got some (including from upstream).<p>The result was a terrible vulnerability, but it seems more of a case of spectacularly bad luck of everyone not spotting the issue.</div><br/></div></div><div id="39976547" class="c"><input type="checkbox" id="c-39976547" checked=""/><div class="controls bullet"><span class="by">ArtTimeInvestor</span><span>|</span><a href="#39977081">prev</a><span>|</span><a href="#39976816">next</a><span>|</span><label class="collapse" for="c-39976547">[-]</label><label class="expand" for="c-39976547">[9 more]</label></div><br/><div class="children"><div class="content">Reading this makes me wonder how probable&#x2F;improbable it is that this kind of thing has happened &#x2F; will happen with the seed generation function in one of the popular Bitcoin hardware wallets.<p>And what the fallout would be.</div><br/><div id="39976775" class="c"><input type="checkbox" id="c-39976775" checked=""/><div class="controls bullet"><span class="by">macrolime</span><span>|</span><a href="#39976547">parent</a><span>|</span><a href="#39976604">next</a><span>|</span><label class="collapse" for="c-39976775">[-]</label><label class="expand" for="c-39976775">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.unciphered.com&#x2F;blog&#x2F;randstorm-you-cant-patch-a-house-of-cards" rel="nofollow">https:&#x2F;&#x2F;www.unciphered.com&#x2F;blog&#x2F;randstorm-you-cant-patch-a-h...</a><p>Over the last 22 months, Unciphered has been working on a vulnerability which affected BitcoinJS, a popular package for the browser based generation of cryptocurrency wallets, as well as products and projects built from this software. Over a period of years, this vulnerability caused the generation of a significant number of vulnerable cryptocurrency wallets.</div><br/></div></div><div id="39976604" class="c"><input type="checkbox" id="c-39976604" checked=""/><div class="controls bullet"><span class="by">xiphias2</span><span>|</span><a href="#39976547">parent</a><span>|</span><a href="#39976775">prev</a><span>|</span><a href="#39976580">next</a><span>|</span><label class="collapse" for="c-39976604">[-]</label><label class="expand" for="c-39976604">[5 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=6195493">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=6195493</a></div><br/><div id="39976662" class="c"><input type="checkbox" id="c-39976662" checked=""/><div class="controls bullet"><span class="by">ArtTimeInvestor</span><span>|</span><a href="#39976547">root</a><span>|</span><a href="#39976604">parent</a><span>|</span><a href="#39977011">next</a><span>|</span><label class="collapse" for="c-39976662">[-]</label><label class="expand" for="c-39976662">[2 more]</label></div><br/><div class="children"><div class="content">In 2013, Bitcoin&#x27;s market cap was less than a Billion, I think. And those Android wallets probably only held small amounts.<p>But now that pension funds get into Bitcoin, one has to wonder what would happen if a giant like Coinbase turns out to be holding their funds in cold storage but with guessable keys.</div><br/><div id="39977067" class="c"><input type="checkbox" id="c-39977067" checked=""/><div class="controls bullet"><span class="by">3abiton</span><span>|</span><a href="#39976547">root</a><span>|</span><a href="#39976662">parent</a><span>|</span><a href="#39977011">next</a><span>|</span><label class="collapse" for="c-39977067">[-]</label><label class="expand" for="c-39977067">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s crazy to to from a hobbyist niche commodity to a nearly gold reserve alternative.</div><br/></div></div></div></div><div id="39977011" class="c"><input type="checkbox" id="c-39977011" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#39976547">root</a><span>|</span><a href="#39976604">parent</a><span>|</span><a href="#39976662">prev</a><span>|</span><a href="#39976609">next</a><span>|</span><label class="collapse" for="c-39977011">[-]</label><label class="expand" for="c-39977011">[1 more]</label></div><br/><div class="children"><div class="content">Interesting to see Vitalik pop up in that thread</div><br/></div></div><div id="39976609" class="c"><input type="checkbox" id="c-39976609" checked=""/><div class="controls bullet"><span class="by">baobun</span><span>|</span><a href="#39976547">root</a><span>|</span><a href="#39976604">parent</a><span>|</span><a href="#39977011">prev</a><span>|</span><a href="#39976580">next</a><span>|</span><label class="collapse" for="c-39976609">[-]</label><label class="expand" for="c-39976609">[1 more]</label></div><br/><div class="children"><div class="content">also <a href="https:&#x2F;&#x2F;blog.1inch.io&#x2F;a-vulnerability-disclosed-in-profanity-an-ethereum-vanity-address-tool&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.1inch.io&#x2F;a-vulnerability-disclosed-in-profanity...</a></div><br/></div></div></div></div><div id="39976580" class="c"><input type="checkbox" id="c-39976580" checked=""/><div class="controls bullet"><span class="by">trashburger</span><span>|</span><a href="#39976547">parent</a><span>|</span><a href="#39976604">prev</a><span>|</span><a href="#39976705">next</a><span>|</span><label class="collapse" for="c-39976580">[-]</label><label class="expand" for="c-39976580">[1 more]</label></div><br/><div class="children"><div class="content">Feels like that would be noticed rather quickly given that you would be able to access someone else&#x27;s funds on the network automatically, whereas in the SSH vulnerability case you have to proactively check if servers you want to access have one of the bad fingerprints.</div><br/></div></div><div id="39976705" class="c"><input type="checkbox" id="c-39976705" checked=""/><div class="controls bullet"><span class="by">pants2</span><span>|</span><a href="#39976547">parent</a><span>|</span><a href="#39976580">prev</a><span>|</span><a href="#39976816">next</a><span>|</span><label class="collapse" for="c-39976705">[-]</label><label class="expand" for="c-39976705">[1 more]</label></div><br/><div class="children"><div class="content">The $160M Wintermute hack was a result of insecure key generation in a public library, though it&#x27;s unlikely that one was introduced intentionally.</div><br/></div></div></div></div><div id="39976816" class="c"><input type="checkbox" id="c-39976816" checked=""/><div class="controls bullet"><span class="by">mkesper</span><span>|</span><a href="#39976547">prev</a><span>|</span><a href="#39976946">next</a><span>|</span><label class="collapse" for="c-39976816">[-]</label><label class="expand" for="c-39976816">[2 more]</label></div><br/><div class="children"><div class="content">I remember looking at SSH public key fingerprints in Savannah at the time and wondering why SO MANY started with AAAA (thought it was some padding first...)</div><br/><div id="39977005" class="c"><input type="checkbox" id="c-39977005" checked=""/><div class="controls bullet"><span class="by">unhammer</span><span>|</span><a href="#39976816">parent</a><span>|</span><a href="#39976946">next</a><span>|</span><label class="collapse" for="c-39977005">[-]</label><label class="expand" for="c-39977005">[1 more]</label></div><br/><div class="children"><div class="content">The AAAA (and several of the following characters) is just a header showing what type of key it is: <a href="https:&#x2F;&#x2F;crypto.stackexchange.com&#x2F;questions&#x2F;5944&#x2F;why-do-all-ssh-rsa-keys-begin-with-aaaab3nzac1yc" rel="nofollow">https:&#x2F;&#x2F;crypto.stackexchange.com&#x2F;questions&#x2F;5944&#x2F;why-do-all-s...</a></div><br/></div></div></div></div><div id="39976946" class="c"><input type="checkbox" id="c-39976946" checked=""/><div class="controls bullet"><span class="by">immibis</span><span>|</span><a href="#39976816">prev</a><span>|</span><a href="#39977019">next</a><span>|</span><label class="collapse" for="c-39976946">[-]</label><label class="expand" for="c-39976946">[2 more]</label></div><br/><div class="children"><div class="content">As I understand it, the OpenSSL RNG was seeded by uninitialised stack memory and the PID. Debian seeded it with just the PID. But wasn&#x27;t that already quite dangerous even without the Debian patch?</div><br/><div id="39977343" class="c"><input type="checkbox" id="c-39977343" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#39976946">parent</a><span>|</span><a href="#39977019">next</a><span>|</span><label class="collapse" for="c-39977343">[-]</label><label class="expand" for="c-39977343">[1 more]</label></div><br/><div class="children"><div class="content">This is incorrect. OpenSSL seeded its RNG also with data read from &#x2F;dev&#x2F;urandom.</div><br/></div></div></div></div><div id="39977019" class="c"><input type="checkbox" id="c-39977019" checked=""/><div class="controls bullet"><span class="by">matsemann</span><span>|</span><a href="#39976946">prev</a><span>|</span><a href="#39976558">next</a><span>|</span><label class="collapse" for="c-39977019">[-]</label><label class="expand" for="c-39977019">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Ezra Zygmuntowitz pointed GitHub in my direction, and let me take the time to really get into the problem with the GitHub team</i><p>This sentence is funny to me. Maybe because I&#x27;m not a native speaker, but I can&#x27;t avoid reading it as a big problem with the GH team itself, heh. I was expecting the next sentences to &quot;get into&quot; that.<p>&gt; <i>I wonder if Luciano hadn’t found it, how long it might have been before it was found</i><p>I think perhaps only GH or one of the big cloud providers would have stumbled upon it, few places I can think of that would have thousands and thousands of keys stored from users.</div><br/><div id="39977310" class="c"><input type="checkbox" id="c-39977310" checked=""/><div class="controls bullet"><span class="by">alias_neo</span><span>|</span><a href="#39977019">parent</a><span>|</span><a href="#39976558">next</a><span>|</span><label class="collapse" for="c-39977310">[-]</label><label class="expand" for="c-39977310">[1 more]</label></div><br/><div class="children"><div class="content">&gt; This sentence is funny to me<p>It does &#x2F; can read both ways, but a comma after &quot;problem&quot; would have removed that doubt.</div><br/></div></div></div></div><div id="39976558" class="c"><input type="checkbox" id="c-39976558" checked=""/><div class="controls bullet"><span class="by">cozzyd</span><span>|</span><a href="#39977019">prev</a><span>|</span><label class="collapse" for="c-39976558">[-]</label><label class="expand" for="c-39976558">[9 more]</label></div><br/><div class="children"><div class="content">I wonder if GitHub is still running a patched openssh...</div><br/><div id="39976585" class="c"><input type="checkbox" id="c-39976585" checked=""/><div class="controls bullet"><span class="by">TheDong</span><span>|</span><a href="#39976558">parent</a><span>|</span><a href="#39977376">next</a><span>|</span><label class="collapse" for="c-39976585">[-]</label><label class="expand" for="c-39976585">[5 more]</label></div><br/><div class="children"><div class="content">It&#x27;s pretty easy to check something kinda close to GitHub&#x27;s source code to see, if you want.<p>Just buy a copy of GitHub Enterprise, deobfuscate the files (it&#x27;s a fun challenge to deobfuscate them, and not all that hard), and look around to see.<p>It&#x27;s unfortunately not open source, so we can&#x27;t share and talk about the code, link to it on GitHub, or anything like that, but if GitHub Enterprise is still using such a patch, it&#x27;s like the prod github is too.</div><br/><div id="39976702" class="c"><input type="checkbox" id="c-39976702" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#39976558">root</a><span>|</span><a href="#39976585">parent</a><span>|</span><a href="#39976614">next</a><span>|</span><label class="collapse" for="c-39976702">[-]</label><label class="expand" for="c-39976702">[2 more]</label></div><br/><div class="children"><div class="content">Assuming they wrote an entirely new sshd in ruby or something. Otherwise why should they ship the source code to a patched-up opensshd...</div><br/><div id="39977024" class="c"><input type="checkbox" id="c-39977024" checked=""/><div class="controls bullet"><span class="by">TheDong</span><span>|</span><a href="#39976558">root</a><span>|</span><a href="#39976702">parent</a><span>|</span><a href="#39976614">next</a><span>|</span><label class="collapse" for="c-39977024">[-]</label><label class="expand" for="c-39977024">[1 more]</label></div><br/><div class="children"><div class="content">You can see them writing the ssh public keys that are entered into the settings page _somewhere_ in ruby, and you can then kinda guess :)</div><br/></div></div></div></div><div id="39976614" class="c"><input type="checkbox" id="c-39976614" checked=""/><div class="controls bullet"><span class="by">rudasn</span><span>|</span><a href="#39976558">root</a><span>|</span><a href="#39976585">parent</a><span>|</span><a href="#39976702">prev</a><span>|</span><a href="#39977376">next</a><span>|</span><label class="collapse" for="c-39976614">[-]</label><label class="expand" for="c-39976614">[2 more]</label></div><br/><div class="children"><div class="content">How do they distribute github enterprise? Like a VM or image?</div><br/><div id="39977153" class="c"><input type="checkbox" id="c-39977153" checked=""/><div class="controls bullet"><span class="by">everfrustrated</span><span>|</span><a href="#39976558">root</a><span>|</span><a href="#39976614">parent</a><span>|</span><a href="#39977376">next</a><span>|</span><label class="collapse" for="c-39977153">[-]</label><label class="expand" for="c-39977153">[1 more]</label></div><br/><div class="children"><div class="content">Publicly downloadable VM images. Choose openstack for a generic qcow image to run with opensource tools. Docker not supported.<p><a href="https:&#x2F;&#x2F;enterprise.github.com&#x2F;releases&#x2F;3.12.1&#x2F;download" rel="nofollow">https:&#x2F;&#x2F;enterprise.github.com&#x2F;releases&#x2F;3.12.1&#x2F;download</a></div><br/></div></div></div></div></div></div><div id="39977376" class="c"><input type="checkbox" id="c-39977376" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39976558">parent</a><span>|</span><a href="#39976585">prev</a><span>|</span><a href="#39976749">next</a><span>|</span><label class="collapse" for="c-39977376">[-]</label><label class="expand" for="c-39977376">[1 more]</label></div><br/><div class="children"><div class="content">Github uses a custom server they call babeld, which uses libssh as a SSH server library.</div><br/></div></div><div id="39976749" class="c"><input type="checkbox" id="c-39976749" checked=""/><div class="controls bullet"><span class="by">hanwenn</span><span>|</span><a href="#39976558">parent</a><span>|</span><a href="#39977376">prev</a><span>|</span><a href="#39976656">next</a><span>|</span><label class="collapse" for="c-39976749">[-]</label><label class="expand" for="c-39976749">[1 more]</label></div><br/><div class="children"><div class="content">github uses something called babeld (just telnet to github.com port 22; the version string is printed immediately.)</div><br/></div></div><div id="39976656" class="c"><input type="checkbox" id="c-39976656" checked=""/><div class="controls bullet"><span class="by">jarofgreen</span><span>|</span><a href="#39976558">parent</a><span>|</span><a href="#39976749">prev</a><span>|</span><label class="collapse" for="c-39976656">[-]</label><label class="expand" for="c-39976656">[1 more]</label></div><br/><div class="children"><div class="content">Well, I&#x27;ll bet they haven&#x27;t gone back to &quot;put all the keys in ~&#x2F;.ssh&#x2F;authorized_keys&quot; ...</div><br/></div></div></div></div></div></div></div></div></div></body></html>