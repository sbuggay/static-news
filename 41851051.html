<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1729069267399" as="style"/><link rel="stylesheet" href="styles.css?v=1729069267399"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sqlite.org/wasm/doc/trunk/index.md">Sqlite3 WebAssembly</a> <span class="domain">(<a href="https://sqlite.org">sqlite.org</a>)</span></div><div class="subtext"><span>whatever3</span> | <span>149 comments</span></div><br/><div><div id="41851934" class="c"><input type="checkbox" id="c-41851934" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41851270">next</a><span>|</span><label class="collapse" for="c-41851934">[-]</label><label class="expand" for="c-41851934">[29 more]</label></div><br/><div class="children"><div class="content">Something that would be really fun would be to run SQLite in-memory in a browser but use the same tricks as Litestream and Cloudflare Durable Objects (<a href="https:&#x2F;&#x2F;simonwillison.net&#x2F;2024&#x2F;Oct&#x2F;13&#x2F;zero-latency-sqlite-storage-in-every-durable-object&#x2F;" rel="nofollow">https:&#x2F;&#x2F;simonwillison.net&#x2F;2024&#x2F;Oct&#x2F;13&#x2F;zero-latency-sqlite-st...</a>) to stream a copy of the WAL log to a server (maybe over a WebSocket, though intermittent fetch() POST would work too).<p>Then on subsequent visits use that server-side data to rehydrate the client-side database.<p>From <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;forum&#x2F;info&#x2F;50a4bfdb294333eec1ba4749661934521af19e6fc0790a6189696607f67c2b54?t=h" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;forum&#x2F;info&#x2F;50a4bfdb294333eec1ba4749661934...</a> is looks like WAL mode is excluded from the default SQLite WASM build so you would have to go custom with that.</div><br/><div id="41853089" class="c"><input type="checkbox" id="c-41853089" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41854586">next</a><span>|</span><label class="collapse" for="c-41853089">[-]</label><label class="expand" for="c-41853089">[12 more]</label></div><br/><div class="children"><div class="content">There are many layers of that&#x27;s not how it works at play here.<p>In-memory SQLite databases don&#x27;t use WAL. Wasm (and browser Wasm, in particular) doesn&#x27;t support anything like the shared memory APIs SQLite wants for its WAL mode.<p>Litestream requires a very precise WAL setup to work (which just so happens to work with the default native SQLite setup, but is hard to replicate with Wasm).<p>Cloudflare Durable Objects may have been inspired by Litestream but works very differently (as do LiteFS, Turso, etc…)<p>The general idea of streaming changes from SQLite would work, but it&#x27;s a lot of work, and the concurrency model of in-browser Wasm will make it challenging to implement.<p>(I wrote that forum post some time ago, and have WAL working in a server side Wasm build of SQLite, but none of the options to make it work would make much sense, or be possible, in browser)</div><br/><div id="41853607" class="c"><input type="checkbox" id="c-41853607" checked=""/><div class="controls bullet"><span class="by">digdugdirk</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853089">parent</a><span>|</span><a href="#41853823">next</a><span>|</span><label class="collapse" for="c-41853607">[-]</label><label class="expand" for="c-41853607">[6 more]</label></div><br/><div class="children"><div class="content">As someone who uses sqlite fairly regularly, but doesn&#x27;t understand what most of those paragraphs mean, do you have any recommendations for learning resources?<p>I&#x27;m gathering that I need to learn about:
 - WAL
 - Shared Memory APIs
 - Concurrency models
 - Durable Objects?</div><br/><div id="41855356" class="c"><input type="checkbox" id="c-41855356" checked=""/><div class="controls bullet"><span class="by">throwaway2037</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853607">parent</a><span>|</span><a href="#41853788">next</a><span>|</span><label class="collapse" for="c-41855356">[-]</label><label class="expand" for="c-41855356">[1 more]</label></div><br/><div class="children"><div class="content">WAL - Shared Memory APIs: <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wal.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wal.html</a><p>concurrency model of in-browser Wasm: <a href="https:&#x2F;&#x2F;medium.com&#x2F;@quincarter&#x2F;wasm-is-awsm-and-multi-threading-the-web-is-not-so-impossible-297870a6c10" rel="nofollow">https:&#x2F;&#x2F;medium.com&#x2F;@quincarter&#x2F;wasm-is-awsm-and-multi-thread...</a><p>Cloudflare Durable Objects: <a href="https:&#x2F;&#x2F;www.cloudflare.com&#x2F;developer-platform&#x2F;durable-objects&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.cloudflare.com&#x2F;developer-platform&#x2F;durable-object...</a></div><br/></div></div><div id="41853788" class="c"><input type="checkbox" id="c-41853788" checked=""/><div class="controls bullet"><span class="by">wyager</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853607">parent</a><span>|</span><a href="#41855356">prev</a><span>|</span><a href="#41853823">next</a><span>|</span><label class="collapse" for="c-41853788">[-]</label><label class="expand" for="c-41853788">[4 more]</label></div><br/><div class="children"><div class="content">WAL: Write ahead log, common strategy for DBs (sqlite, postgres, etc.) to improve commit performance. Instead of fsync()ing every change, you just fsync() a log file that contains all the changes and then you can fsync() the actual changes at your leisure<p>Shared memory API: If you want to share (mutable) data between multiple processes, you need some kind of procedure in place to manage that. How do you get a reference to the data to multiple processes, how do you make sure they don&#x27;t trample each other&#x27;s writes, etc.<p>Concurrency model: There are many different ways you can formalize concurrent processes and the way they interact (message passing, locking, memory ordering semantics, etc.). Different platforms will expose different concurrency primitives that may not work the same way as other platforms and may require different reasoning or code structure<p>Durable objects - I think this is some Cloudflare service where they host data that can be read or modified by your users<p>This is all from memory, but IME, GPT is pretty good for asking about concepts at this level of abstraction</div><br/><div id="41854152" class="c"><input type="checkbox" id="c-41854152" checked=""/><div class="controls bullet"><span class="by">digdugdirk</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853788">parent</a><span>|</span><a href="#41853823">next</a><span>|</span><label class="collapse" for="c-41854152">[-]</label><label class="expand" for="c-41854152">[3 more]</label></div><br/><div class="children"><div class="content">Thank you!<p>And side note on your last point - I&#x27;ve been burned too many times by confident hallucinations to trust my foundational learning to GPT. I hope someday that will improve, but for now ChatGPT is as trustworthy as an evening chat with someone at the bar.<p>... Someone who has been drinking since happy hour.</div><br/><div id="41856177" class="c"><input type="checkbox" id="c-41856177" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854152">parent</a><span>|</span><a href="#41855004">next</a><span>|</span><label class="collapse" for="c-41856177">[-]</label><label class="expand" for="c-41856177">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;d like a trustworthy overview, the book <i>Designing Data-Intensive Applications</i> by Martin Kleppmann is a classic. I really hope we get an updated version, but the fundamentals all still hold anyway.</div><br/></div></div><div id="41855004" class="c"><input type="checkbox" id="c-41855004" checked=""/><div class="controls bullet"><span class="by">infogulch</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854152">parent</a><span>|</span><a href="#41856177">prev</a><span>|</span><a href="#41853823">next</a><span>|</span><label class="collapse" for="c-41855004">[-]</label><label class="expand" for="c-41855004">[1 more]</label></div><br/><div class="children"><div class="content">I was curious and Grok 2 seemed to do pretty good: <a href="https:&#x2F;&#x2F;x.com&#x2F;i&#x2F;grok&#x2F;share&#x2F;c2qCdF2wwIx7AHz0U1f2u8dTO" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;i&#x2F;grok&#x2F;share&#x2F;c2qCdF2wwIx7AHz0U1f2u8dTO</a></div><br/></div></div></div></div></div></div></div></div><div id="41853823" class="c"><input type="checkbox" id="c-41853823" checked=""/><div class="controls bullet"><span class="by">jchanimal</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853089">parent</a><span>|</span><a href="#41853607">prev</a><span>|</span><a href="#41853645">next</a><span>|</span><label class="collapse" for="c-41853823">[-]</label><label class="expand" for="c-41853823">[1 more]</label></div><br/><div class="children"><div class="content">If you like, solving these sort of problems, we are tackling them at Fireproof.<p>Our database API is modeled on CouchDB and MongoDB, but our storage abstractions are along the lines of what you need to build the multi writer WAL you describe.<p>More details here <a href="https:&#x2F;&#x2F;jsr.io&#x2F;@fireproof&#x2F;encrypted-blockstore" rel="nofollow">https:&#x2F;&#x2F;jsr.io&#x2F;@fireproof&#x2F;encrypted-blockstore</a></div><br/></div></div><div id="41853645" class="c"><input type="checkbox" id="c-41853645" checked=""/><div class="controls bullet"><span class="by">jauntywundrkind</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853089">parent</a><span>|</span><a href="#41853823">prev</a><span>|</span><a href="#41854586">next</a><span>|</span><label class="collapse" for="c-41853645">[-]</label><label class="expand" for="c-41853645">[4 more]</label></div><br/><div class="children"><div class="content">Then don&#x27;t use in-memory sqlite? Use file backed sqlite but have your wasm implementation of those &quot;system calls&quot; just be to memory?<p>I dunno, feels like you&#x27;re coming down too hard.</div><br/><div id="41854002" class="c"><input type="checkbox" id="c-41854002" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853645">parent</a><span>|</span><a href="#41854586">next</a><span>|</span><label class="collapse" for="c-41854002">[-]</label><label class="expand" for="c-41854002">[3 more]</label></div><br/><div class="children"><div class="content">File backed SQLite in a browser? Do you mean like OPFS?<p><a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md#opfs-wal" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md#opfs-wal</a><p>Again, just because the all the Lego pieces sound like they should all just fit together, doesn&#x27;t mean that they will.<p>The VFS mechanism was primarily designed to make SQLite easy to port to multiple OSes. WAL mode is hard to port everytime you step away from a more traditional OS.<p>“We have SQLite in the browser, let&#x27;s just stream the WAL like the Litestream <i>hack</i>” does not add up.<p>It&#x27;s not impossible, but it surely took a lot of effort at Cloudflare (or at Fly, or Turso) to get there. And neither of them opened it up sufficiently to help us do the same. In a browser.</div><br/><div id="41854206" class="c"><input type="checkbox" id="c-41854206" checked=""/><div class="controls bullet"><span class="by">andrewf</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854002">parent</a><span>|</span><a href="#41854586">next</a><span>|</span><label class="collapse" for="c-41854206">[-]</label><label class="expand" for="c-41854206">[2 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t looked but I bet a lot of the WAL complexity comes down to supporting consistency and durability guarantees, neither of which you necessarily need for your in-browser use case.</div><br/><div id="41856431" class="c"><input type="checkbox" id="c-41856431" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854206">parent</a><span>|</span><a href="#41854586">next</a><span>|</span><label class="collapse" for="c-41856431">[-]</label><label class="expand" for="c-41856431">[1 more]</label></div><br/><div class="children"><div class="content">Not really, or it depends. That complexity is dealt with by SQLite.<p>The complexity for <i>you</i> comes from trying to reuse their (battle tested) implementation when (as I wrote above) the primitives they depend upon were not meant to make porting to a browser sandbox easy.<p>And the problems there are the specific concurrency model they depend upon: communicate by sharing memory.<p>Then, you&#x27;re either working at the wrong abstraction level (and it shows), or you&#x27;re patching and gutting SQLite.<p>SQLite is meant to work with files, file locks, shared memory, fsync and mmap.<p>It also doesn&#x27;t work out great if you try to persist to an object store, to a KV store, or…<p>I&#x27;m repeating myself, but yeah. You <i>can</i> make it work. Others <i>have</i> made it work. But it&#x27;s still a lot of work, and you&#x27;re throwing away a lot of what makes SQLite… SQLite.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41854586" class="c"><input type="checkbox" id="c-41854586" checked=""/><div class="controls bullet"><span class="by">billywhizz</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41853089">prev</a><span>|</span><a href="#41856415">next</a><span>|</span><label class="collapse" for="c-41854586">[-]</label><label class="expand" for="c-41854586">[2 more]</label></div><br/><div class="children"><div class="content">hi simon. i direct messaged you on twitter about a PoC i did of this in aug 2022, but never heard back - i thought you might have been interested. my twitter handle is justjs14.<p>i have some code i would have to dig out that did this very thing - it allows you to open a SQLite db in browser using sqlite (with a VFS) compiled to wasm (not the official WASM build), make changes and both push and pull WALs to and from a server (or indeed browser to browser would be possible both manually or over WebRTC). it even works with github pages if you give the browser client a github token to work with.<p>if you are interested, feel free to ping me and i can see if i can get this up and running from scratch again. i did a ton of experiments with this approach around then and i think it could be useful for a subset of applications at least.<p>there&#x27;s also a working demo of the pull functionality only here: <a href="https:&#x2F;&#x2F;just.billywhizz.io&#x2F;sqlite&#x2F;demo&#x2F;#https:&#x2F;&#x2F;just.billywhizz.io&#x2F;sqlite&#x2F;demo&#x2F;db&#x2F;chinook.db" rel="nofollow">https:&#x2F;&#x2F;just.billywhizz.io&#x2F;sqlite&#x2F;demo&#x2F;#https:&#x2F;&#x2F;just.billywh...</a></div><br/><div id="41856980" class="c"><input type="checkbox" id="c-41856980" checked=""/><div class="controls bullet"><span class="by">adhamsalama</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854586">parent</a><span>|</span><a href="#41856415">next</a><span>|</span><label class="collapse" for="c-41856980">[-]</label><label class="expand" for="c-41856980">[1 more]</label></div><br/><div class="children"><div class="content">&gt; (or indeed browser to browser would be possible both manually or over WebRTC)<p>I have just done something similar in the past week, but without the WAL.<p>It&#x27;s pretty much an alternative to online spreadsheets for me.<p><a href="http:&#x2F;&#x2F;github.com&#x2F;adhamsalama&#x2F;sqlite-wasm-webrtc">http:&#x2F;&#x2F;github.com&#x2F;adhamsalama&#x2F;sqlite-wasm-webrtc</a></div><br/></div></div></div></div><div id="41856415" class="c"><input type="checkbox" id="c-41856415" checked=""/><div class="controls bullet"><span class="by">matharmin</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41854586">prev</a><span>|</span><a href="#41857000">next</a><span>|</span><label class="collapse" for="c-41856415">[-]</label><label class="expand" for="c-41856415">[1 more]</label></div><br/><div class="children"><div class="content">Unlike other opinions here I do think it is technically feasible to stream a copy of the WAL - it just has to be implemented in the VFS. &quot;Shared memory&quot; could be a SharedArrayBuffer, or just a normal buffer if you only have one database connection open at a time (for example in a SharedWorker, which is already common). It may not be simple to implement, but definitely possible.<p>The biggest actual issue is that it will capture block-level changes, not row-level changes. This means it can work to replicate a complete database, but partial sync (e.g. sharing some rows with other users) won&#x27;t be feasible.<p>To get row-level changes for partial sync, you need to use something like triggers or the SQLite session extension [1]. For PowerSync we just use triggers on the client side. I find that works really well, and I haven&#x27;t found any real downsides to that except perhaps for the work of maintaining the triggers.<p>[1]: <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;sessionintro.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;sessionintro.html</a></div><br/></div></div><div id="41857000" class="c"><input type="checkbox" id="c-41857000" checked=""/><div class="controls bullet"><span class="by">adhamsalama</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41856415">prev</a><span>|</span><a href="#41852040">next</a><span>|</span><label class="collapse" for="c-41857000">[-]</label><label class="expand" for="c-41857000">[1 more]</label></div><br/><div class="children"><div class="content">I used SQLite compiled to WebAssembly in the browser and replicated it (without the WAL) using WebRTC to create a way to collaborate on databases in the browser instead of using apps like Google Sheets. There&#x27;s no server required (other than the WebRTC signaling server), so it&#x27;s private and secure too.<p><a href="http:&#x2F;&#x2F;github.com&#x2F;adhamsalama&#x2F;sqlite-wasm-webrtc">http:&#x2F;&#x2F;github.com&#x2F;adhamsalama&#x2F;sqlite-wasm-webrtc</a></div><br/></div></div><div id="41852040" class="c"><input type="checkbox" id="c-41852040" checked=""/><div class="controls bullet"><span class="by">dustinchilson</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41857000">prev</a><span>|</span><a href="#41854540">next</a><span>|</span><label class="collapse" for="c-41852040">[-]</label><label class="expand" for="c-41852040">[6 more]</label></div><br/><div class="children"><div class="content">Are you thinking something like <a href="https:&#x2F;&#x2F;electric-sql.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;electric-sql.com&#x2F;</a></div><br/><div id="41853301" class="c"><input type="checkbox" id="c-41853301" checked=""/><div class="controls bullet"><span class="by">PUSH_AX</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41852040">parent</a><span>|</span><a href="#41854540">next</a><span>|</span><label class="collapse" for="c-41853301">[-]</label><label class="expand" for="c-41853301">[5 more]</label></div><br/><div class="children"><div class="content">What’s the catch with this thing?</div><br/><div id="41853915" class="c"><input type="checkbox" id="c-41853915" checked=""/><div class="controls bullet"><span class="by">T-Winsnes</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853301">parent</a><span>|</span><a href="#41854540">next</a><span>|</span><label class="collapse" for="c-41853915">[-]</label><label class="expand" for="c-41853915">[4 more]</label></div><br/><div class="children"><div class="content">The security model is challenging, as it relies on Postgres users for iam. Your users essentially log directly into your db</div><br/><div id="41855021" class="c"><input type="checkbox" id="c-41855021" checked=""/><div class="controls bullet"><span class="by">infogulch</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853915">parent</a><span>|</span><a href="#41854135">next</a><span>|</span><label class="collapse" for="c-41855021">[-]</label><label class="expand" for="c-41855021">[1 more]</label></div><br/><div class="children"><div class="content">You can see what this means specifically from the docs: <a href="https:&#x2F;&#x2F;electric-sql.com&#x2F;docs&#x2F;guides&#x2F;auth" rel="nofollow">https:&#x2F;&#x2F;electric-sql.com&#x2F;docs&#x2F;guides&#x2F;auth</a></div><br/></div></div><div id="41854135" class="c"><input type="checkbox" id="c-41854135" checked=""/><div class="controls bullet"><span class="by">dumbo-octopus</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41853915">parent</a><span>|</span><a href="#41855021">prev</a><span>|</span><a href="#41854540">next</a><span>|</span><label class="collapse" for="c-41854135">[-]</label><label class="expand" for="c-41854135">[2 more]</label></div><br/><div class="children"><div class="content">Isn’t Postgres a fairly capable IAM provider, all things considered? I’d their access control mechanisms at least as much as a run of the mill external backend’s.</div><br/><div id="41854423" class="c"><input type="checkbox" id="c-41854423" checked=""/><div class="controls bullet"><span class="by">T-Winsnes</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41854135">parent</a><span>|</span><a href="#41854540">next</a><span>|</span><label class="collapse" for="c-41854423">[-]</label><label class="expand" for="c-41854423">[1 more]</label></div><br/><div class="children"><div class="content">For basic auth it works well, but the challenge comes when you need to integrate with oidc, need to enforce mfa, enable sso etc. session invalidation is also quite complicated.<p>You need an identity middle man in front of the Postgres identity to tackle these and validate that the session is still active. Last time I looked at electric it was a big challenge to integrate such a service. This might have improved since then however</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41854540" class="c"><input type="checkbox" id="c-41854540" checked=""/><div class="controls bullet"><span class="by">Fabricio20</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41852040">prev</a><span>|</span><a href="#41854654">next</a><span>|</span><label class="collapse" for="c-41854540">[-]</label><label class="expand" for="c-41854540">[1 more]</label></div><br/><div class="children"><div class="content">I think OrbitDB [1] is the closest we have to a functional version of this right now? Unsure, but the concept is really cool!<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;orbitdb&#x2F;orbitdb&#x2F;blob&#x2F;main&#x2F;docs&#x2F;GETTING_STARTED.md">https:&#x2F;&#x2F;github.com&#x2F;orbitdb&#x2F;orbitdb&#x2F;blob&#x2F;main&#x2F;docs&#x2F;GETTING_ST...</a></div><br/></div></div><div id="41854654" class="c"><input type="checkbox" id="c-41854654" checked=""/><div class="controls bullet"><span class="by">conradev</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41854540">prev</a><span>|</span><a href="#41855596">next</a><span>|</span><label class="collapse" for="c-41854654">[-]</label><label class="expand" for="c-41854654">[1 more]</label></div><br/><div class="children"><div class="content">LiteVFS can be compiled in a browser and sync with LiteFS cloud: <a href="https:&#x2F;&#x2F;github.com&#x2F;superfly&#x2F;litevfs">https:&#x2F;&#x2F;github.com&#x2F;superfly&#x2F;litevfs</a><p>It needs to be run from a worker, though</div><br/></div></div><div id="41855596" class="c"><input type="checkbox" id="c-41855596" checked=""/><div class="controls bullet"><span class="by">hiccuphippo</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41854654">prev</a><span>|</span><a href="#41852194">next</a><span>|</span><label class="collapse" for="c-41855596">[-]</label><label class="expand" for="c-41855596">[2 more]</label></div><br/><div class="children"><div class="content">This sounds like what meteor was 10+ years ago but with sqlite instead of mongodb.</div><br/><div id="41855664" class="c"><input type="checkbox" id="c-41855664" checked=""/><div class="controls bullet"><span class="by">nesarkvechnep</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41855596">parent</a><span>|</span><a href="#41852194">next</a><span>|</span><label class="collapse" for="c-41855664">[-]</label><label class="expand" for="c-41855664">[1 more]</label></div><br/><div class="children"><div class="content">Nothing like it, actually.</div><br/></div></div></div></div><div id="41852194" class="c"><input type="checkbox" id="c-41852194" checked=""/><div class="controls bullet"><span class="by">fcanesin</span><span>|</span><a href="#41851934">parent</a><span>|</span><a href="#41855596">prev</a><span>|</span><a href="#41851270">next</a><span>|</span><label class="collapse" for="c-41852194">[-]</label><label class="expand" for="c-41852194">[2 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t a more advanced&#x2F;production version of this what the combo of couchdb and pouchdb do since several years ago?</div><br/><div id="41852240" class="c"><input type="checkbox" id="c-41852240" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41851934">root</a><span>|</span><a href="#41852194">parent</a><span>|</span><a href="#41851270">next</a><span>|</span><label class="collapse" for="c-41852240">[-]</label><label class="expand" for="c-41852240">[1 more]</label></div><br/><div class="children"><div class="content">Yeah this kind of thing has certainly been tried before, I feel like SQLite WASM plus WAL might be an interesting twist on the idea.</div><br/></div></div></div></div></div></div><div id="41851270" class="c"><input type="checkbox" id="c-41851270" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41851934">prev</a><span>|</span><a href="#41851815">next</a><span>|</span><label class="collapse" for="c-41851270">[-]</label><label class="expand" for="c-41851270">[16 more]</label></div><br/><div class="children"><div class="content">Slight point of confusion: that page says:<p>&gt; These components were initially released for public beta with version 3.40 and will tentatively be made API-stable with the 3.41 release, pending community feedback.<p>But the most recent release of SQLite is 3.46.1 (from 2024-08-13)<p>Presumably they are now &quot;API-stable&quot; but the page hasn&#x27;t been updated yet.<p>It would be great if the SQLite team published an official npm package bundling the WASM version, could be a neat distribution mechanism for them. (UPDATE: They do, see replies to this post.)<p>My favourite version of SQLite-in-WASM remains the Pyodide variant, which has been around since long before the official SQLite implementation. If you use Pyodide you get a WASM SQLite for free as part of the Python standard library - I use that for <a href="https:&#x2F;&#x2F;lite.datasette.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lite.datasette.io&#x2F;</a> and you can also try it out on <a href="https:&#x2F;&#x2F;pyodide.org&#x2F;en&#x2F;stable&#x2F;console.html" rel="nofollow">https:&#x2F;&#x2F;pyodide.org&#x2F;en&#x2F;stable&#x2F;console.html</a><p><pre><code>    import sqlite3
    print(sqlite3.connect(&#x27;:memory:&#x27;).execute(
        &#x27;select sqlite_version()&#x27;
    ).fetchall())
</code></pre>
That returns 3.39.0 from 2022-06-25 so Pyodide could do with a version bump. Looks like it inherits that version from emscripten: <a href="https:&#x2F;&#x2F;github.com&#x2F;emscripten-core&#x2F;emscripten&#x2F;blob&#x2F;main&#x2F;tools&#x2F;ports&#x2F;sqlite3.py">https:&#x2F;&#x2F;github.com&#x2F;emscripten-core&#x2F;emscripten&#x2F;blob&#x2F;main&#x2F;tool...</a></div><br/><div id="41853076" class="c"><input type="checkbox" id="c-41853076" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851270">parent</a><span>|</span><a href="#41851565">next</a><span>|</span><label class="collapse" for="c-41853076">[-]</label><label class="expand" for="c-41853076">[7 more]</label></div><br/><div class="children"><div class="content">&gt; Presumably they are now &quot;API-stable&quot; but the page hasn&#x27;t been updated yet.<p>That&#x27;s correct. i&#x27;ll try my best to remember to update that reference the next time i&#x27;m back on the computer.<p>&gt; It would be great if the SQLite team published an official npm package<p>Not a chance. We publish only vanilla JS and adamantly refuse to go down the rabit hole of supporting out-of-language tools (none of which any of our project members use). We support an &quot;officially sanctioned&quot; npm build, maintained by Thomas Steiner, but do not actively develop for any JS frameworks.<p>Direct support for any given framework (npm included) would give the impression that we endorse that framework, and endorsement of third-party projects is something we actively avoid.</div><br/><div id="41853135" class="c"><input type="checkbox" id="c-41853135" checked=""/><div class="controls bullet"><span class="by">rezonant</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853076">parent</a><span>|</span><a href="#41851565">next</a><span>|</span><label class="collapse" for="c-41853135">[-]</label><label class="expand" for="c-41853135">[6 more]</label></div><br/><div class="children"><div class="content">&gt; We publish ONLY vanilla JS and adamantly refuse to go down rabit hole of supporting the frameworks du jour<p>A bit confused at this, NPM is just a package manager &#x2F; distribution mechanism, not a framework. Totally fair if you don&#x27;t want to publish for all the package managers, though for Javascript there&#x27;s only a few that are relevant. NPM has been around for a decade.</div><br/><div id="41853181" class="c"><input type="checkbox" id="c-41853181" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853135">parent</a><span>|</span><a href="#41851565">next</a><span>|</span><label class="collapse" for="c-41853181">[-]</label><label class="expand" for="c-41853181">[5 more]</label></div><br/><div class="children"><div class="content">&gt; A bit confused at this, NPM is just a package manager &#x2F; distribution mechanism, not a framework<p>It&#x27;s an out-of-language packaging&#x2F;distribution framework (and it&#x27;s not the only one). It&#x27;s not part of the JS standards.<p>My comments above have been edited to reframe our stance on npm and frameworks in general.</div><br/><div id="41853749" class="c"><input type="checkbox" id="c-41853749" checked=""/><div class="controls bullet"><span class="by">rezonant</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853181">parent</a><span>|</span><a href="#41853977">next</a><span>|</span><label class="collapse" for="c-41853749">[-]</label><label class="expand" for="c-41853749">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think there will ever be a package manager dictated by the Ecmascript standards.</div><br/><div id="41854172" class="c"><input type="checkbox" id="c-41854172" checked=""/><div class="controls bullet"><span class="by">syndicatedjelly</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853749">parent</a><span>|</span><a href="#41853977">next</a><span>|</span><label class="collapse" for="c-41854172">[-]</label><label class="expand" for="c-41854172">[1 more]</label></div><br/><div class="children"><div class="content">Then ES will continue to remain an outlier among major language implementations</div><br/></div></div></div></div><div id="41853977" class="c"><input type="checkbox" id="c-41853977" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853181">parent</a><span>|</span><a href="#41853749">prev</a><span>|</span><a href="#41851565">next</a><span>|</span><label class="collapse" for="c-41853977">[-]</label><label class="expand" for="c-41853977">[2 more]</label></div><br/><div class="children"><div class="content">I think the communication barrier here is that in JavaScript, framework very distinctly means things like React, Vue, Angular, and so on. It definitely does not refer to projects like Node&#x2F;npm&#x2F;Bun&#x2F;Deno, those are toolchains, sometimes called ecosystems for obscure reasons.<p>If you changed the word &quot;framework&quot; to &quot;toolchain&quot; in your post I think it would make a lot more sense to people.</div><br/><div id="41854657" class="c"><input type="checkbox" id="c-41854657" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41853977">parent</a><span>|</span><a href="#41851565">next</a><span>|</span><label class="collapse" for="c-41854657">[-]</label><label class="expand" for="c-41854657">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If you changed the word &quot;framework&quot; to &quot;toolchain&quot; in your post I think it would make a lot more sense to people.<p>Fair point but the edit window has passed ;). For the sake of clarity for those still following along: &quot;framework,&quot; in the context of my above comments, includes any non-formally-standardized tools or APIs which are built atop the standardized core.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41851565" class="c"><input type="checkbox" id="c-41851565" checked=""/><div class="controls bullet"><span class="by">Ciantic</span><span>|</span><a href="#41851270">parent</a><span>|</span><a href="#41853076">prev</a><span>|</span><a href="#41851515">next</a><span>|</span><label class="collapse" for="c-41851565">[-]</label><label class="expand" for="c-41851565">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It would be great if the SQLite team published an official npm package bundling the WASM version, could be a neat distribution mechanism for them.<p>I think they&#x27;ve been doing that for a while, in JS script you can already do this:<p><pre><code>    import sqlite3InitModule from &quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;@sqlite.org&#x2F;sqlite-wasm&#x2F;sqlite-wasm&#x2F;jswasm&#x2F;sqlite3-bundler-friendly.mjs&quot;;

    const sqlite3 = await sqlite3InitModule({
        locateFile(file: string) {
            return &quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;@sqlite.org&#x2F;sqlite-wasm&#x2F;sqlite-wasm&#x2F;jswasm&#x2F;sqlite3.wasm&quot;;
        },
    });

    &#x2F;&#x2F; SQLite&#x27;s C API
    const capi = sqlite3.capi;
    console.log(&quot;sqlite3 version&quot;, capi.sqlite3_libversion(), capi.sqlite3_sourceid());

    &#x2F;&#x2F; OO API example below oo1 docs https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;tip&#x2F;api-oo1.md
    const oo = sqlite3.oo1;

    const db = new oo.DB();
    const createPersonTableSql = `
    CREATE TABLE IF NOT EXISTS person (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        age INTEGER NOT NULL
    );
    `;
    db.exec([createPersonTableSql]);
</code></pre>
It works in regular old script tag with type=module, or Deno. I have example HTML here:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;Ciantic&#x2F;experimenting-sqlite-wasm&#x2F;blob&#x2F;main&#x2F;standalone.html">https:&#x2F;&#x2F;github.com&#x2F;Ciantic&#x2F;experimenting-sqlite-wasm&#x2F;blob&#x2F;ma...</a></div><br/><div id="41854738" class="c"><input type="checkbox" id="c-41854738" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41851565">parent</a><span>|</span><a href="#41851515">next</a><span>|</span><label class="collapse" for="c-41854738">[-]</label><label class="expand" for="c-41854738">[1 more]</label></div><br/><div class="children"><div class="content">&gt; &gt; It would be great if the SQLite team published an official npm package<p>&gt; I think they&#x27;ve been doing that for a while,<p>Kinda: &lt;<a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;npm.md" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;npm.md</a>&gt;<p>We in the sqlite project neither use nor require npm in any capacity whatsoever, so it would be kinda silly for us to attempt to support it. We instead leave that level of code&#x2F;tools to folks who use and&#x2F;or care about them.<p>There _is_ an &quot;officially sanctioned&#x2F;blessed&quot; npm repo, and we actively support its maintainer (e.g. we participate the issue tracker and make patches in the core distribution where they&#x27;re strictly needed), but we otherwise keep a &quot;hands off&quot; policy when it comes to non-standardized APIs and toolchains.<p>We _like_ to see people to plug the sources into their tools of choice, but we cannot feasibly take on the burden of doing that plugging-in for them, especially given how fluid the JavaScript ecosystem is when it comes to frameworks and tools.<p>Sidebar: we rely heavily on Emscripten because there is, for all practical purposes, it has no substitute, but we also actively go out of our way to ensure that the sources can be easily plugged in to an alternative should one ever appear.</div><br/></div></div></div></div><div id="41851515" class="c"><input type="checkbox" id="c-41851515" checked=""/><div class="controls bullet"><span class="by">rblank</span><span>|</span><a href="#41851270">parent</a><span>|</span><a href="#41851565">prev</a><span>|</span><a href="#41852552">next</a><span>|</span><label class="collapse" for="c-41851515">[-]</label><label class="expand" for="c-41851515">[4 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;sqlite&#x2F;sqlite-wasm">https:&#x2F;&#x2F;github.com&#x2F;sqlite&#x2F;sqlite-wasm</a><p>sqlite-wasm loads much faster than Pyodide, so if you don&#x27;t need Python, then the former is a better choice.</div><br/><div id="41851545" class="c"><input type="checkbox" id="c-41851545" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41851515">parent</a><span>|</span><a href="#41852552">next</a><span>|</span><label class="collapse" for="c-41851545">[-]</label><label class="expand" for="c-41851545">[3 more]</label></div><br/><div class="children"><div class="content">Amazing!<p><pre><code>    npm install @sqlite.org&#x2F;sqlite-wasm</code></pre></div><br/><div id="41851788" class="c"><input type="checkbox" id="c-41851788" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41851545">parent</a><span>|</span><a href="#41851670">next</a><span>|</span><label class="collapse" for="c-41851788">[-]</label><label class="expand" for="c-41851788">[1 more]</label></div><br/><div class="children"><div class="content">I built my own little demo page here: <a href="https:&#x2F;&#x2F;tools.simonwillison.net&#x2F;sqlite-wasm" rel="nofollow">https:&#x2F;&#x2F;tools.simonwillison.net&#x2F;sqlite-wasm</a><p>With the help of Claude, though it incorrectly hallucinated some of the details despite me pasting in documentation: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;simonw&#x2F;677c3794051c4dfeac94e514a8e5b697" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;simonw&#x2F;677c3794051c4dfeac94e514a8e5b...</a></div><br/></div></div><div id="41851670" class="c"><input type="checkbox" id="c-41851670" checked=""/><div class="controls bullet"><span class="by">wg0</span><span>|</span><a href="#41851270">root</a><span>|</span><a href="#41851545">parent</a><span>|</span><a href="#41851788">prev</a><span>|</span><a href="#41852552">next</a><span>|</span><label class="collapse" for="c-41851670">[-]</label><label class="expand" for="c-41851670">[1 more]</label></div><br/><div class="children"><div class="content">This would run on client side I presume? Where the data would go?<p>Okay that&#x27;s listed here:
<a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md</a><p>EDIT: Self answered.</div><br/></div></div></div></div></div></div><div id="41852552" class="c"><input type="checkbox" id="c-41852552" checked=""/><div class="controls bullet"><span class="by">jarpineh</span><span>|</span><a href="#41851270">parent</a><span>|</span><a href="#41851515">prev</a><span>|</span><a href="#41851901">next</a><span>|</span><label class="collapse" for="c-41852552">[-]</label><label class="expand" for="c-41852552">[1 more]</label></div><br/><div class="children"><div class="content">You can use DuckDB WASM independently of Pyodide and can extend it with SQLite.<p>Though it seems to be somewhat limited. I couldn&#x27;t even check what version it has, since sqlite_version() was missing. Version in the repository [1] is 3.38.1, which is from quite a ways ago.<p>At the moment DuckDB web shell can&#x27;t load SQLite extension, since that hasn&#x27;t been released for yesterday&#x27;s 1.1.2. Earlier version does work using recently updated WASM edition. That can be extended with spatial including GDAL, vector search etc [2]. Making your own &quot;SQL web shell&quot; wasn&#x27;t too hard, though docs weren&#x27;t quite complete enough for me.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;duckdb&#x2F;sqlite_scanner&#x2F;blob&#x2F;main&#x2F;src&#x2F;sqlite&#x2F;sqlite3.h">https:&#x2F;&#x2F;github.com&#x2F;duckdb&#x2F;sqlite_scanner&#x2F;blob&#x2F;main&#x2F;src&#x2F;sqlit...</a>
[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;duckdb&#x2F;duckdb-wasm&#x2F;releases&#x2F;tag&#x2F;v1.29.0">https:&#x2F;&#x2F;github.com&#x2F;duckdb&#x2F;duckdb-wasm&#x2F;releases&#x2F;tag&#x2F;v1.29.0</a></div><br/></div></div><div id="41851901" class="c"><input type="checkbox" id="c-41851901" checked=""/><div class="controls bullet"><span class="by">CodeWriter23</span><span>|</span><a href="#41851270">parent</a><span>|</span><a href="#41852552">prev</a><span>|</span><a href="#41851815">next</a><span>|</span><label class="collapse" for="c-41851901">[-]</label><label class="expand" for="c-41851901">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It would be great if the SQLite team published an official npm package bundling the WASM version, could be a neat distribution mechanism for them.<p>You may benefit from perusing the FAQ on that page.</div><br/></div></div></div></div><div id="41851815" class="c"><input type="checkbox" id="c-41851815" checked=""/><div class="controls bullet"><span class="by">koeng</span><span>|</span><a href="#41851270">prev</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41851815">[-]</label><label class="expand" for="c-41851815">[8 more]</label></div><br/><div class="children"><div class="content">For use in Golang, I really like ncruces wasm SQLite package - <a href="https:&#x2F;&#x2F;github.com&#x2F;ncruces&#x2F;go-sqlite3">https:&#x2F;&#x2F;github.com&#x2F;ncruces&#x2F;go-sqlite3</a> . Unlike cznic&#x27;s go package (which is great, btw), the wasm version works well on OpenBSD and the like.</div><br/><div id="41853244" class="c"><input type="checkbox" id="c-41853244" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851815">parent</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41853244">[-]</label><label class="expand" for="c-41853244">[7 more]</label></div><br/><div class="children"><div class="content">Author here. If you&#x27;re interested, do ask questions.</div><br/><div id="41855097" class="c"><input type="checkbox" id="c-41855097" checked=""/><div class="controls bullet"><span class="by">infogulch</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41853244">parent</a><span>|</span><a href="#41853458">next</a><span>|</span><label class="collapse" for="c-41855097">[-]</label><label class="expand" for="c-41855097">[2 more]</label></div><br/><div class="children"><div class="content">Hey how&#x27;s the mmap-based shared memory WAL approach working out? It&#x27;s been about half a year since you finished the implementation and I only see one issue about it on the tracker, a good sign?</div><br/><div id="41856487" class="c"><input type="checkbox" id="c-41856487" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41855097">parent</a><span>|</span><a href="#41853458">next</a><span>|</span><label class="collapse" for="c-41856487">[-]</label><label class="expand" for="c-41856487">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s turning out great, I guess.<p>The current approach is not portable to Windows, but it works fine on Linux, macOS, BSD and illumos. In general, portability is hindered more by file locking (I hate POSIX locks) than mmap.<p>The currently open GitHub issue is more bad default configuration than anything else. Configuring connections to use less memory by default should fix it.<p>I already have a PR ready for the next release that also opens this up for 32-bit platforms.</div><br/></div></div></div></div><div id="41853458" class="c"><input type="checkbox" id="c-41853458" checked=""/><div class="controls bullet"><span class="by">TN1ck</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41853244">parent</a><span>|</span><a href="#41855097">prev</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41853458">[-]</label><label class="expand" for="c-41853458">[4 more]</label></div><br/><div class="children"><div class="content">Very cool project! Do you know if this would be possible for duckdb? Is there something about sqlites APIs and wasm build that made it feasible?<p>Context: Currently using go-duckdb and while it&#x27;s working for us, getting rid of cgo would be a huge help. Would be quite interested myself to attempt this.</div><br/><div id="41853561" class="c"><input type="checkbox" id="c-41853561" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41853458">parent</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41853561">[-]</label><label class="expand" for="c-41853561">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know much about DuckDB&#x27;s architecture.<p>Wasm is fine for compute (though concurrency is still a somewhat open question).<p>To have Wasm talk to the outside world, you need “host calls” where the guest calls the host.<p>On a browser that&#x27;s Wasm calling JavaScript. On my Go driver, it&#x27;s Wasm calling Go.<p>For server side, there&#x27;s also a standard set of “host calls” modeled around POSIX&#x2F;Linux syscalls called WASI.<p>I could&#x27;ve build my project around WASI, but WASI is rather limited (and SQLite support for WASI was more limited even, it&#x27;s improved a bit since). DuckDB might work out-of-the-box this way.<p>I, instead, took advantage of SQLite&#x27;s architecture and replaced its VFS layer with one in Go:
<a href="https:&#x2F;&#x2F;sqlite.org&#x2F;vfs.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;vfs.html</a><p>So SQLite in Wasm is just doing compute, and I do all the OS level stuff in Go. No need for Wasm concurrency, cause I can load multiple instances of my Wasm which act like independent OS processes that communicate through the filesystem (SQLite excels at this).<p>As I said, I dunno how well all those decisions would map to DuckDB.</div><br/><div id="41853953" class="c"><input type="checkbox" id="c-41853953" checked=""/><div class="controls bullet"><span class="by">koeng</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41853561">parent</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41853953">[-]</label><label class="expand" for="c-41853953">[2 more]</label></div><br/><div class="children"><div class="content">&gt; So SQLite in Wasm is just doing compute, and I do all the OS level stuff in Go. No need for Wasm concurrency, cause I can load multiple instances of my Wasm which act like independent OS processes that communicate through the filesystem (SQLite excels at this).<p>Interesting. So when I am running concurrent readers using your package, it is just loading multiple instances of the wasm code? (I bottleneck to a single writer in the application)</div><br/><div id="41856932" class="c"><input type="checkbox" id="c-41856932" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851815">root</a><span>|</span><a href="#41853953">parent</a><span>|</span><a href="#41853741">next</a><span>|</span><label class="collapse" for="c-41856932">[-]</label><label class="expand" for="c-41856932">[1 more]</label></div><br/><div class="children"><div class="content">Yes.<p>Each connection lives in its own isolated sandbox, and only communicates with other connections through the “file system” (which is a virtual abstraction, actually).<p>WAL mode is the “exception”: a few pages of the sandbox&#x27;s memory are mapped to a file, and shared by all connections to the same database.<p>Each sandbox is single threaded, and mostly lock free, does all its business in the calling goroutine, and regularly checks back with the Go runtime to play nice with the Go scheduler.<p>It&#x27;s a bit like an OS running multiple processes, with the VFS layer handling all syscalls.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41853741" class="c"><input type="checkbox" id="c-41853741" checked=""/><div class="controls bullet"><span class="by">chrysoprace</span><span>|</span><a href="#41851815">prev</a><span>|</span><a href="#41852607">next</a><span>|</span><label class="collapse" for="c-41853741">[-]</label><label class="expand" for="c-41853741">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been really interested in the local-first landscape lately but embedding SQLite seems really heavy-weight compared to using the browser&#x27;s built-in storage APIs (in particular, IndexedDB) and it seems to be what most of the main open source libraries do. I&#x27;m interested to see a open-source solution (with sync) which provides an SQLite-like API but for the browser&#x27;s native storage rather than trying to embed another executable in Web Assembly.</div><br/><div id="41854825" class="c"><input type="checkbox" id="c-41854825" checked=""/><div class="controls bullet"><span class="by">gavmor</span><span>|</span><a href="#41853741">parent</a><span>|</span><a href="#41855967">next</a><span>|</span><label class="collapse" for="c-41854825">[-]</label><label class="expand" for="c-41854825">[2 more]</label></div><br/><div class="children"><div class="content">SQL is, arguably, more ergonomic than IndexedDB APIs, and may take up less RAM&#x2F;CPU when, eg, using a `WHERE` clause rather than an `if() ` filter.</div><br/><div id="41856054" class="c"><input type="checkbox" id="c-41856054" checked=""/><div class="controls bullet"><span class="by">chrysoprace</span><span>|</span><a href="#41853741">root</a><span>|</span><a href="#41854825">parent</a><span>|</span><a href="#41855967">next</a><span>|</span><label class="collapse" for="c-41856054">[-]</label><label class="expand" for="c-41856054">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s definitely more ergonomic, but the browser doesn&#x27;t have an SQL API where as it does have IndexedDB. I&#x27;m hoping for tooling that <i>makes</i> IndexedDB more ergonomic while having a local-first syncing solution.<p>Dexie gives an ORM-like experience but their syncing solution is not FOSS.</div><br/></div></div></div></div><div id="41854044" class="c"><input type="checkbox" id="c-41854044" checked=""/><div class="controls bullet"><span class="by">jamesgpearce</span><span>|</span><a href="#41853741">parent</a><span>|</span><a href="#41855967">prev</a><span>|</span><a href="#41852607">next</a><span>|</span><label class="collapse" for="c-41854044">[-]</label><label class="expand" for="c-41854044">[3 more]</label></div><br/><div class="children"><div class="content">Disclaimer: I&#x27;m the author. But you might be interested in TinyBase.</div><br/><div id="41854213" class="c"><input type="checkbox" id="c-41854213" checked=""/><div class="controls bullet"><span class="by">chrysoprace</span><span>|</span><a href="#41853741">root</a><span>|</span><a href="#41854044">parent</a><span>|</span><a href="#41855339">next</a><span>|</span><label class="collapse" for="c-41854213">[-]</label><label class="expand" for="c-41854213">[1 more]</label></div><br/><div class="children"><div class="content">Thanks I&#x27;ll give it a look! I guess I really was fishing for someone to make a recommendation and I see you have a lot of backend persistence options which I&#x27;m very excited about.<p>Another issue I have with a lot of the new local first products is that they tend to lock you into a particular database type on the backend, so this is refreshing.</div><br/></div></div><div id="41855339" class="c"><input type="checkbox" id="c-41855339" checked=""/><div class="controls bullet"><span class="by">arunaugustine</span><span>|</span><a href="#41853741">root</a><span>|</span><a href="#41854044">parent</a><span>|</span><a href="#41854213">prev</a><span>|</span><a href="#41852607">next</a><span>|</span><label class="collapse" for="c-41855339">[-]</label><label class="expand" for="c-41855339">[1 more]</label></div><br/><div class="children"><div class="content">TinyBase looks very promising! Is there a doc or reference you can guide me to, for using TinyBase with Preact.js instead of React?</div><br/></div></div></div></div></div></div><div id="41852607" class="c"><input type="checkbox" id="c-41852607" checked=""/><div class="controls bullet"><span class="by">parhamn</span><span>|</span><a href="#41853741">prev</a><span>|</span><a href="#41851864">next</a><span>|</span><label class="collapse" for="c-41852607">[-]</label><label class="expand" for="c-41852607">[4 more]</label></div><br/><div class="children"><div class="content">WebSQL should&#x27;ve just been Sqlite and the whole offline-first (and general app storage) ecosystem would&#x27;ve been so much nicer.<p>Is there any hope of that happening? Instead of abstracting and over specifying sqlite, can the spec just specify a version of the SQLite API browsers should support and roll the version periodically?</div><br/><div id="41852850" class="c"><input type="checkbox" id="c-41852850" checked=""/><div class="controls bullet"><span class="by">emn13</span><span>|</span><a href="#41852607">parent</a><span>|</span><a href="#41852879">next</a><span>|</span><label class="collapse" for="c-41852850">[-]</label><label class="expand" for="c-41852850">[1 more]</label></div><br/><div class="children"><div class="content">&quot;Rolling the version periodically&quot; is probably quite problematic for browsers. Kind of a key point of the web is that stuff if at all possible keeps working. Breaking changes like that are hard.<p>Even if the spec just listed occasional version and the webpage could choose which one; that means a potentially tricky maintenance burden on browser to support old versions of a potentially no longer supported sqlite, and each version is another megabyte.<p>Why not then just choose this solution, and let each website pick its own poison?<p>If the concern is the repeated downloads of common resources, well, we&#x27;ve accepted that for other CDN&#x27;s too, and a solution for shared caching of common dependencies would in any case be more valuable than merely for sqlite.<p>The current approach seems better than a browser-provided version.</div><br/></div></div><div id="41852879" class="c"><input type="checkbox" id="c-41852879" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41852607">parent</a><span>|</span><a href="#41852850">prev</a><span>|</span><a href="#41851864">next</a><span>|</span><label class="collapse" for="c-41852879">[-]</label><label class="expand" for="c-41852879">[2 more]</label></div><br/><div class="children"><div class="content">I for one am glad WebSQL didn&#x27;t establish itself.<p>Now we get the most recent version of SQLite when we need it as a 410KB compressd WASM blob, as opposed to being stuck on browser-mandated versions of SQLite that might even be a decade old at this point.</div><br/><div id="41854591" class="c"><input type="checkbox" id="c-41854591" checked=""/><div class="controls bullet"><span class="by">xyc</span><span>|</span><a href="#41852607">root</a><span>|</span><a href="#41852879">parent</a><span>|</span><a href="#41851864">next</a><span>|</span><label class="collapse" for="c-41854591">[-]</label><label class="expand" for="c-41854591">[1 more]</label></div><br/><div class="children"><div class="content">They are not mutually exclusive though. WebSQL doesn&#x27;t prevent anyone from loading a WASM blob. And while moving slowly, the browsers does deprecate old stuff and update implementation.</div><br/></div></div></div></div></div></div><div id="41851864" class="c"><input type="checkbox" id="c-41851864" checked=""/><div class="controls bullet"><span class="by">brandonpollack2</span><span>|</span><a href="#41852607">prev</a><span>|</span><a href="#41852302">next</a><span>|</span><label class="collapse" for="c-41851864">[-]</label><label class="expand" for="c-41851864">[6 more]</label></div><br/><div class="children"><div class="content">I was trying to get this working in a rust ecosystem some time ago but none of the blessed.rs sql (rusqlite, sqlx) wrappers seem to take advantage of it yet and wrapping it yourself is a bit tricky since when I was trying I couldn&#x27;t figure out a way to to get emscripten wasm code to play nice with wasm32-unknown-unknown without some kind of JS wrapper which then requires implementing the interface those crates expect and exposing it from JS.  Once that is done in rust itll be great there too!</div><br/><div id="41852996" class="c"><input type="checkbox" id="c-41852996" checked=""/><div class="controls bullet"><span class="by">aabhay</span><span>|</span><a href="#41851864">parent</a><span>|</span><a href="#41854660">next</a><span>|</span><label class="collapse" for="c-41852996">[-]</label><label class="expand" for="c-41852996">[1 more]</label></div><br/><div class="children"><div class="content">I have been working on one. If you&#x27;re interested in working on it or contributing, feel free to chime in here:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;154">https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;154</a><p>This essentially requires that we import the sqlite emscripten build via an extern C header in wasm bindgen, and then we need to re-implement the VFS in rust while compiling it in multi-threaded mode to allow for shared array buffer access. After that is all done, we will be able to access SQLite rows as raw wasm bytes. That gives us the ability to implement a rust-sqlite style wrapper or integration. There would still not be some of the niceties such as connection pooling, but in wasm you likely want to use the db in exclusive mode.</div><br/></div></div><div id="41854660" class="c"><input type="checkbox" id="c-41854660" checked=""/><div class="controls bullet"><span class="by">azakai</span><span>|</span><a href="#41851864">parent</a><span>|</span><a href="#41852996">prev</a><span>|</span><a href="#41853144">next</a><span>|</span><label class="collapse" for="c-41854660">[-]</label><label class="expand" for="c-41854660">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I couldn&#x27;t figure out a way to to get emscripten wasm code to play nice with wasm32-unknown-unknown<p>There is good news there, some people plan to get Emscripten and Rust to work well together in Wasm:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;rustwasm&#x2F;wasm-bindgen&#x2F;pull&#x2F;4014#issuecomment-2356908451">https:&#x2F;&#x2F;github.com&#x2F;rustwasm&#x2F;wasm-bindgen&#x2F;pull&#x2F;4014#issuecomm...</a></div><br/></div></div><div id="41853144" class="c"><input type="checkbox" id="c-41853144" checked=""/><div class="controls bullet"><span class="by">insipx</span><span>|</span><a href="#41851864">parent</a><span>|</span><a href="#41854660">prev</a><span>|</span><a href="#41852082">next</a><span>|</span><label class="collapse" for="c-41853144">[-]</label><label class="expand" for="c-41853144">[1 more]</label></div><br/><div class="children"><div class="content">Got this SQLite build working with rusts diesel sqlite here: <a href="https:&#x2F;&#x2F;github.com&#x2F;xmtp&#x2F;diesel-wasm-sqlite">https:&#x2F;&#x2F;github.com&#x2F;xmtp&#x2F;diesel-wasm-sqlite</a><p>I&#x27;m gearing up for a 0.2 release this week which should iron out a few kinks, but otherwise you can use the diesel ORM as if its native</div><br/></div></div><div id="41852082" class="c"><input type="checkbox" id="c-41852082" checked=""/><div class="controls bullet"><span class="by">tonygiorgio</span><span>|</span><a href="#41851864">parent</a><span>|</span><a href="#41853144">prev</a><span>|</span><a href="#41852302">next</a><span>|</span><label class="collapse" for="c-41852082">[-]</label><label class="expand" for="c-41852082">[2 more]</label></div><br/><div class="children"><div class="content">Yeah I’ve been waiting awhile for this myself. A few PRs with work pending for a year or so. I’ve seen some proof of concepts but nothing anywhere close to usable.</div><br/><div id="41854235" class="c"><input type="checkbox" id="c-41854235" checked=""/><div class="controls bullet"><span class="by">insipx</span><span>|</span><a href="#41851864">root</a><span>|</span><a href="#41852082">parent</a><span>|</span><a href="#41852302">next</a><span>|</span><label class="collapse" for="c-41854235">[-]</label><label class="expand" for="c-41854235">[1 more]</label></div><br/><div class="children"><div class="content">you should check out <a href="https:&#x2F;&#x2F;github.com&#x2F;xmtp&#x2F;diesel-wasm-sqlite">https:&#x2F;&#x2F;github.com&#x2F;xmtp&#x2F;diesel-wasm-sqlite</a><p>reliable so far, being dogfooded in production as we speak</div><br/></div></div></div></div></div></div><div id="41852302" class="c"><input type="checkbox" id="c-41852302" checked=""/><div class="controls bullet"><span class="by">catapart</span><span>|</span><a href="#41851864">prev</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41852302">[-]</label><label class="expand" for="c-41852302">[6 more]</label></div><br/><div class="children"><div class="content">I wasn&#x27;t able to tell from a quick look through the page: could someone help me understand the use cases here?<p>More specifically, would this be able to be a &quot;replacement&quot; for indexedDB? Does the data persist, or do I need to keep the sqlite file in the filesytemAPI (or indexedDB&#x2F;localstorage) myself?</div><br/><div id="41852717" class="c"><input type="checkbox" id="c-41852717" checked=""/><div class="controls bullet"><span class="by">azangru</span><span>|</span><a href="#41852302">parent</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41852717">[-]</label><label class="expand" for="c-41852717">[5 more]</label></div><br/><div class="children"><div class="content">From the about page:<p>&gt; Specific Goals of this Project<p>&gt; Insofar as possible, support persistent client-side storage using available JS APIs. As of this writing, that includes the Origin-Private FileSystem (OPFS) and (very limited) storage via the window.localStorage and window.sessionStorage backend.</div><br/><div id="41852866" class="c"><input type="checkbox" id="c-41852866" checked=""/><div class="controls bullet"><span class="by">catapart</span><span>|</span><a href="#41852302">root</a><span>|</span><a href="#41852717">parent</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41852866">[-]</label><label class="expand" for="c-41852866">[4 more]</label></div><br/><div class="children"><div class="content">Right but, to my eyes, that&#x27;s vague?<p>What I&#x27;m asking is if I need to manage the sqlite file, as I would on an OS&#x27;s file system, or if accessing the sqlite library will automatically persist that data to those web-native storages, like the way indexedDB doesn&#x27;t require me to load an &quot;idb&quot; file and then &quot;save&quot; or &quot;commit&quot; that save. I just access it and write.<p>To be clear: I&#x27;m not asking academically. I wrote a whole library for managing data in indexedDB for local-first apps, and while it works well enough for what I need, it&#x27;s iDB so it&#x27;s subject to data deletion (not common, but allowed in the spec if necessary), and it&#x27;s a pain to work with just because of its nature and API. So I&#x27;ve been waiting to move to sqlite for a while with the only holdbacks being &quot;is it too heavy?&quot;, and &quot;how much has to change?&quot;. With WASM, I think we&#x27;re about as lightweight as its going to get. So I&#x27;m just curious if this aims to be a drop-in replacement, or if it still expects you to use it like sqlite on a native platform.</div><br/><div id="41854779" class="c"><input type="checkbox" id="c-41854779" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41852302">root</a><span>|</span><a href="#41852866">parent</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41854779">[-]</label><label class="expand" for="c-41854779">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Right but, to my eyes, that&#x27;s vague?<p>We (the sqlite project, where the &quot;vague&quot; description comes from) do not define the use cases. Similarly, in the docs for the C library you won&#x27;t find any more than passing references to specific use cases, and those are typically contrived for the sake of example. (One notable exception: &lt;<a href="https:&#x2F;&#x2F;sqlite.org&#x2F;appfileformat.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;appfileformat.html</a>&gt;)<p>&gt; What I&#x27;m asking is if I need to manage the sqlite file, as I would on an OS&#x27;s file system, or if accessing the sqlite library will automatically persist that data to those web-native storages, like the way indexedDB doesn&#x27;t require me to load an &quot;idb&quot; file and then &quot;save&quot; or &quot;commit&quot; that save. I just access it and write.<p>That&#x27;s all covered in the docs (of which there are well more than 100 lovingly-hand-written pages), but the short answer is &quot;it just works.&quot; You have the _option_ of importing and exporting databases from the browser-native storage, but you don&#x27;t have to.<p>For starters, see: &lt;<a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;tip&#x2F;persistence.md" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;tip&#x2F;persistence.md</a>&gt;</div><br/><div id="41856142" class="c"><input type="checkbox" id="c-41856142" checked=""/><div class="controls bullet"><span class="by">asdfman123</span><span>|</span><a href="#41852302">root</a><span>|</span><a href="#41854779">parent</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41856142">[-]</label><label class="expand" for="c-41856142">[2 more]</label></div><br/><div class="children"><div class="content">&gt; do not define the use cases<p>I genuinely don&#x27;t mean to sound rude, and maybe I misunderstand, but how do you build software if you&#x27;re not doing it with use cases in mind?</div><br/><div id="41856418" class="c"><input type="checkbox" id="c-41856418" checked=""/><div class="controls bullet"><span class="by">manmal</span><span>|</span><a href="#41852302">root</a><span>|</span><a href="#41856142">parent</a><span>|</span><a href="#41851263">next</a><span>|</span><label class="collapse" for="c-41856418">[-]</label><label class="expand" for="c-41856418">[1 more]</label></div><br/><div class="children"><div class="content">Usage is laid out well in the docs, I‘m not sure GP has read them. IMO it’s obvious that many use cases have been kept in mind. Defining a use case != accommodating a use case</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41851263" class="c"><input type="checkbox" id="c-41851263" checked=""/><div class="controls bullet"><span class="by">TiredGuy</span><span>|</span><a href="#41852302">prev</a><span>|</span><a href="#41856590">next</a><span>|</span><label class="collapse" for="c-41851263">[-]</label><label class="expand" for="c-41851263">[22 more]</label></div><br/><div class="children"><div class="content">So after downloading from the official downloads page and stripping away all the mjs files and &quot;bundler-friendly&quot; files, a minimal sqlite wasm dependency will be about 1.3MB.<p>For an in-browser app, that seems a bit much but of course wasm runs in other places these days where it might make more sense.</div><br/><div id="41851622" class="c"><input type="checkbox" id="c-41851622" checked=""/><div class="controls bullet"><span class="by">jsheard</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851724">next</a><span>|</span><label class="collapse" for="c-41851622">[-]</label><label class="expand" for="c-41851622">[6 more]</label></div><br/><div class="children"><div class="content">It&#x27;s pretty compressible at least, sqlite3.js+wasm are 1.3MB raw but minifying the JS and then compressing both files with Brotli gets them down to 410KB.</div><br/><div id="41852828" class="c"><input type="checkbox" id="c-41852828" checked=""/><div class="controls bullet"><span class="by">rmbyrro</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851622">parent</a><span>|</span><a href="#41851724">next</a><span>|</span><label class="collapse" for="c-41852828">[-]</label><label class="expand" for="c-41852828">[5 more]</label></div><br/><div class="children"><div class="content">A lot of HTML&#x27;s nowadays have 100 - 300 kb. That&#x27;s only the HTML (!!).<p>Adding 400 for such a high quality piece of DB actually borders reasonability.<p>And makes me think: what the hell are frontend devs thinking!? Multiple MB&#x27;s in JS for a news website. Hundreds of KB&#x27;s for HTML. It&#x27;s totally unreasonable.</div><br/><div id="41854129" class="c"><input type="checkbox" id="c-41854129" checked=""/><div class="controls bullet"><span class="by">jsheard</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41852828">parent</a><span>|</span><a href="#41853979">next</a><span>|</span><label class="collapse" for="c-41854129">[-]</label><label class="expand" for="c-41854129">[2 more]</label></div><br/><div class="children"><div class="content">&gt; A lot of HTML&#x27;s nowadays have 100 - 300 kb. That&#x27;s only the HTML (!!).<p>I think you can probably blame Tailwind for that.</div><br/><div id="41856625" class="c"><input type="checkbox" id="c-41856625" checked=""/><div class="controls bullet"><span class="by">yoavm</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41854129">parent</a><span>|</span><a href="#41853979">next</a><span>|</span><label class="collapse" for="c-41856625">[-]</label><label class="expand" for="c-41856625">[1 more]</label></div><br/><div class="children"><div class="content">Why? More often than not the classes are combined during post-processing to the most reusable unified classes, with very short classes names.</div><br/></div></div></div></div><div id="41853979" class="c"><input type="checkbox" id="c-41853979" checked=""/><div class="controls bullet"><span class="by">wahern</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41852828">parent</a><span>|</span><a href="#41854129">prev</a><span>|</span><a href="#41851724">next</a><span>|</span><label class="collapse" for="c-41853979">[-]</label><label class="expand" for="c-41853979">[2 more]</label></div><br/><div class="children"><div class="content">&gt; what the hell are frontend devs thinking!? Multiple MB&#x27;s in JS for a news website. Hundreds of KB&#x27;s for HTML. It&#x27;s totally unreasonable<p>They&#x27;re thinking, &quot;adding [some fraction of existing total payload] for such a high quality [feature] actually borders reasonability&quot;. Wash. Rinse. Repeat.</div><br/><div id="41856528" class="c"><input type="checkbox" id="c-41856528" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41853979">parent</a><span>|</span><a href="#41851724">next</a><span>|</span><label class="collapse" for="c-41856528">[-]</label><label class="expand" for="c-41856528">[1 more]</label></div><br/><div class="children"><div class="content">&gt; They&#x27;re thinking, &quot;adding [some fraction of existing total payload] for such a high quality [feature] actually borders reasonability&quot;. Wash. Rinse. Repeat.<p>Context makes all the difference here.  If you&#x27;re considering a big chunk of size for a relational database engine, you need to ask: are you making a complex application, or a normal web page?  If it&#x27;s the latter, then it&#x27;s not reasonable at all.<p>And anything that makes the HTML itself that big is almost certainly bloat, not &quot;high quality&quot;, and shouldn&#x27;t be used in any context.</div><br/></div></div></div></div></div></div></div></div><div id="41851724" class="c"><input type="checkbox" id="c-41851724" checked=""/><div class="controls bullet"><span class="by">coder543</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851622">prev</a><span>|</span><a href="#41851618">next</a><span>|</span><label class="collapse" for="c-41851724">[-]</label><label class="expand" for="c-41851724">[5 more]</label></div><br/><div class="children"><div class="content">1.3MB seems perfectly reasonable in a modern web app, especially since it will be cached after the first visit to the site.<p>If you’re just storing user preferences, obviously don’t download SQLite for your web app just to do that… but if you’re doing something that benefits from a full database, don’t fret so much about 1MB that you go try to reinvent the wheel for no reason.<p>If the other comment is correct, then it won’t even be 1.3MB on the network anyways.</div><br/><div id="41851925" class="c"><input type="checkbox" id="c-41851925" checked=""/><div class="controls bullet"><span class="by">telotortium</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851724">parent</a><span>|</span><a href="#41851618">next</a><span>|</span><label class="collapse" for="c-41851925">[-]</label><label class="expand" for="c-41851925">[4 more]</label></div><br/><div class="children"><div class="content">A megabyte here, a megabyte there, pretty soon you’re talking about a really heavyweight app.</div><br/><div id="41856577" class="c"><input type="checkbox" id="c-41856577" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851925">parent</a><span>|</span><a href="#41852353">next</a><span>|</span><label class="collapse" for="c-41856577">[-]</label><label class="expand" for="c-41856577">[1 more]</label></div><br/><div class="children"><div class="content">By the time you have a good reason to add this library, I think you&#x27;re <i>already</i> in heavyweight app territory.</div><br/></div></div><div id="41852353" class="c"><input type="checkbox" id="c-41852353" checked=""/><div class="controls bullet"><span class="by">zdragnar</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851925">parent</a><span>|</span><a href="#41856577">prev</a><span>|</span><a href="#41852576">next</a><span>|</span><label class="collapse" for="c-41852353">[-]</label><label class="expand" for="c-41852353">[1 more]</label></div><br/><div class="children"><div class="content">Given how hefty images are, a full database doesn&#x27;t seem too bad for the purpose of an &quot;app&quot; that would benefit from it, especially when compression can being the size down even lower.</div><br/></div></div><div id="41852576" class="c"><input type="checkbox" id="c-41852576" checked=""/><div class="controls bullet"><span class="by">littlecranky67</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851925">parent</a><span>|</span><a href="#41852353">prev</a><span>|</span><a href="#41851618">next</a><span>|</span><label class="collapse" for="c-41852576">[-]</label><label class="expand" for="c-41852576">[1 more]</label></div><br/><div class="children"><div class="content">We are past the stage where every piece of JS has to be loaded upfront and delay the first meaningful paint. Modern JS frameworks and module are chunked and can be eager&#x2F;lazy loaded. Unless you make the sqlite DB integral part for your first meaningful page load, preloading those 1.3MB in the background&#x2F;upon user request is easy.</div><br/></div></div></div></div></div></div><div id="41851618" class="c"><input type="checkbox" id="c-41851618" checked=""/><div class="controls bullet"><span class="by">flockonus</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851724">prev</a><span>|</span><a href="#41855860">next</a><span>|</span><label class="collapse" for="c-41851618">[-]</label><label class="expand" for="c-41851618">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a good consideration, together with the fact browsers already have IndexedDB embedded. One use case still for in-browser apps like Figma &#x2F; Photoshop-like &#x2F; ML apps, where the application code and data is very big anyway, 1.3Mb may not add that much<p>Also worth considering parsing of wasm is significantly faster than JS (unfortunately couldn&#x27;t find the source for this claim, there is at lease one great article on the topic)<p><a href="https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;API&#x2F;IndexedDB_API" rel="nofollow">https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;API&#x2F;IndexedDB_A...</a></div><br/><div id="41851728" class="c"><input type="checkbox" id="c-41851728" checked=""/><div class="controls bullet"><span class="by">aidos</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41851618">parent</a><span>|</span><a href="#41855860">next</a><span>|</span><label class="collapse" for="c-41851728">[-]</label><label class="expand" for="c-41851728">[1 more]</label></div><br/><div class="children"><div class="content">When we built our frontend sync system we tried a few different options. We had a fairly simple case of just trying to store entities so we could pull incremental updates since you were last online. The one we ran in production for a while was IndexedDB but found the overhead wasn’t worth it.<p>I played around with warm sqlite too. That was really nice but I decided against it due to the fact that it was totally unsupported.</div><br/></div></div></div></div><div id="41855860" class="c"><input type="checkbox" id="c-41855860" checked=""/><div class="controls bullet"><span class="by">pdyc</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851618">prev</a><span>|</span><a href="#41851840">next</a><span>|</span><label class="collapse" for="c-41855860">[-]</label><label class="expand" for="c-41855860">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s correct, people in this thread are comparing single compressed dependency of sqlite+wasm of 400KB to the total size of web pages which run in MB. I did some actual tests while trying to use sqlite and it does adds noticeable delay on first page load on mobile due to big size+decompression+ additional scaffolding of wasm.
Pages that run into MB have small files that are downloaded concurrently so the delay is not noticeable. I wrote about this and my other expriments with in browser db in my last article but it did not get any traction here.</div><br/></div></div><div id="41851840" class="c"><input type="checkbox" id="c-41851840" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41855860">prev</a><span>|</span><a href="#41851337">next</a><span>|</span><label class="collapse" for="c-41851840">[-]</label><label class="expand" for="c-41851840">[1 more]</label></div><br/><div class="children"><div class="content">For server side, you&#x27;ll likely need a different build of Wasm SQLite, that handles concurrency (and file locking) differently.<p>Also, WASI is very far from answer (so far). The SQLite amalgamation builds fine for WASI but concurrency is an unsolved issue.<p>I had to build a VFS from scratch to get my Wasm based SQLite driver into a usable shape.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ncruces&#x2F;go-sqlite3&#x2F;blob&#x2F;main&#x2F;vfs&#x2F;README.md">https:&#x2F;&#x2F;github.com&#x2F;ncruces&#x2F;go-sqlite3&#x2F;blob&#x2F;main&#x2F;vfs&#x2F;README.m...</a></div><br/></div></div><div id="41851337" class="c"><input type="checkbox" id="c-41851337" checked=""/><div class="controls bullet"><span class="by">jt2190</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851840">prev</a><span>|</span><a href="#41854092">next</a><span>|</span><label class="collapse" for="c-41851337">[-]</label><label class="expand" for="c-41851337">[1 more]</label></div><br/><div class="children"><div class="content">The thing to keep in mind is that the WebAssembly sandbox model means that in theory the program (SqlLite in this case) can run wherever it makes sense to run it. That might mean running it locally or it might mean running on a central server or it might mean  running nearby on the “edge”.</div><br/></div></div><div id="41854092" class="c"><input type="checkbox" id="c-41854092" checked=""/><div class="controls bullet"><span class="by">deskr</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41851337">prev</a><span>|</span><a href="#41852258">next</a><span>|</span><label class="collapse" for="c-41854092">[-]</label><label class="expand" for="c-41854092">[2 more]</label></div><br/><div class="children"><div class="content">Sadly, 1.3 MB is nothing on the modern web, especially for a static file.
BBC&#x27;s frontpage loads 3.78 MB.<p><a href="https:&#x2F;&#x2F;www.bbc.co.uk&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.bbc.co.uk&#x2F;</a></div><br/><div id="41854814" class="c"><input type="checkbox" id="c-41854814" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41854092">parent</a><span>|</span><a href="#41852258">next</a><span>|</span><label class="collapse" for="c-41854814">[-]</label><label class="expand" for="c-41854814">[1 more]</label></div><br/><div class="children"><div class="content">&gt; BBC&#x27;s frontpage loads 3.78 MB.<p>FWIW: Google Drive just downloaded 15.4mb to boot up for me and imdb dot com hit some 7+mb before it started auto-loading videos on top of that.</div><br/></div></div></div></div><div id="41852258" class="c"><input type="checkbox" id="c-41852258" checked=""/><div class="controls bullet"><span class="by">hawski</span><span>|</span><a href="#41851263">parent</a><span>|</span><a href="#41854092">prev</a><span>|</span><a href="#41856590">next</a><span>|</span><label class="collapse" for="c-41852258">[-]</label><label class="expand" for="c-41852258">[3 more]</label></div><br/><div class="children"><div class="content">Is there a way to statically compile an application with SQLite and the result WASM was smaller. So for example I have an app that would use only a specific subset of SQLite. Could the SQLite&#x27;s WASM be built with this in mind cutting down on code that is not used? Or is there a way to prune it having the used API surface?<p>In a regular compiler&#x2F;linker scenario it would just be a static compilation. Here we have a JS app and WASM library.</div><br/><div id="41854865" class="c"><input type="checkbox" id="c-41854865" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41852258">parent</a><span>|</span><a href="#41852312">next</a><span>|</span><label class="collapse" for="c-41854865">[-]</label><label class="expand" for="c-41854865">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Could the SQLite&#x27;s WASM be built with this in mind cutting down on code that is not used?<p>The pending 3.47 release has some build-side tweaks which enable a user to strip it down to &quot;just the basics,&quot; but we&#x27;ve not yet been able to get it smaller than about 25-30% less than it otherwise is:<p><pre><code>    cd ext&#x2F;wasm
    make barebones=1 ; # requires GNU Make and the Emscripten SDK
</code></pre>
Doing that requires building it yourself - there are no plans to publish deliverables built that way.<p>The build process also supports including one&#x27;s own C code, which could hypothetically be used to embed an application and the wasm part of the library (as distinct from the JS part) into a single wasm file. Its primary intended usage is to add SQLite extensions which are not part of the standard amalgamation build.<p>&gt; Or is there a way to prune it having the used API surface?<p>Not with the provided JS pieces. Those have to expose essentially the whole C library, so they will not be pruned from the wasm file.<p>However, you could provide your own JS bindings which only use a small subset of the API, and Emscripten is supposedly pretty good about stripping out C-side code which neither explicitly exported nor referenced anywhere. You&#x27;d be on your own - that&#x27;s not something we&#x27;ll integrate into the canonical build process - but we could provide high-level support, via the project&#x27;s forum, for folks taking that route.</div><br/></div></div><div id="41852312" class="c"><input type="checkbox" id="c-41852312" checked=""/><div class="controls bullet"><span class="by">hoten</span><span>|</span><a href="#41851263">root</a><span>|</span><a href="#41852258">parent</a><span>|</span><a href="#41854865">prev</a><span>|</span><a href="#41856590">next</a><span>|</span><label class="collapse" for="c-41852312">[-]</label><label class="expand" for="c-41852312">[1 more]</label></div><br/><div class="children"><div class="content">Since SQL takes arbitrary strings as input, this would require explicit compiler flags to disable the knobs you don&#x27;t want. Can&#x27;t rely on excluding unused symbols really.</div><br/></div></div></div></div></div></div><div id="41856590" class="c"><input type="checkbox" id="c-41856590" checked=""/><div class="controls bullet"><span class="by">k__</span><span>|</span><a href="#41851263">prev</a><span>|</span><a href="#41852085">next</a><span>|</span><label class="collapse" for="c-41856590">[-]</label><label class="expand" for="c-41856590">[1 more]</label></div><br/><div class="children"><div class="content">Half-OT:<p>What&#x27;s your opinion on SQLite in-memory vs plain objects&#x2F;arrays?<p>When would you use which and why?</div><br/></div></div><div id="41852085" class="c"><input type="checkbox" id="c-41852085" checked=""/><div class="controls bullet"><span class="by">bhelx</span><span>|</span><a href="#41856590">prev</a><span>|</span><a href="#41851916">next</a><span>|</span><label class="collapse" for="c-41852085">[-]</label><label class="expand" for="c-41852085">[5 more]</label></div><br/><div class="children"><div class="content">I used the wasm build of sqlite and the Chicory runtime to create a pure JVM executed sqlite library: <a href="https:&#x2F;&#x2F;github.com&#x2F;dylibso&#x2F;sqlite-zero">https:&#x2F;&#x2F;github.com&#x2F;dylibso&#x2F;sqlite-zero</a><p>It&#x27;s more of an experiment than an attempt to make something production ready, though I could see it being useful to bring dependency-less sqlite tooling to the JVM ecosystem.</div><br/><div id="41853167" class="c"><input type="checkbox" id="c-41853167" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41852085">parent</a><span>|</span><a href="#41851916">next</a><span>|</span><label class="collapse" for="c-41853167">[-]</label><label class="expand" for="c-41853167">[4 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the file system access like, WASI?</div><br/><div id="41853286" class="c"><input type="checkbox" id="c-41853286" checked=""/><div class="controls bullet"><span class="by">bhelx</span><span>|</span><a href="#41852085">root</a><span>|</span><a href="#41853167">parent</a><span>|</span><a href="#41851916">next</a><span>|</span><label class="collapse" for="c-41853286">[-]</label><label class="expand" for="c-41853286">[3 more]</label></div><br/><div class="children"><div class="content">Chicory has some partial wasip1 support. <a href="https:&#x2F;&#x2F;github.com&#x2F;dylibso&#x2F;chicory&#x2F;tree&#x2F;main&#x2F;wasi">https:&#x2F;&#x2F;github.com&#x2F;dylibso&#x2F;chicory&#x2F;tree&#x2F;main&#x2F;wasi</a>. We use jimfs to keep things simple and secure (and not worry about exposing the real filesystem): <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;jimfs">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;jimfs</a><p>When I did this experiment a few months ago, what we could accomplish was pretty limited. I could load and query databases, but not write to them. However the Chicory wasip1 implementation is advancing.<p>BTW, we&#x27;ve borrowed a few ideas from wazero so thanks for your work there :)</div><br/><div id="41853465" class="c"><input type="checkbox" id="c-41853465" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#41852085">root</a><span>|</span><a href="#41853286">parent</a><span>|</span><a href="#41851916">next</a><span>|</span><label class="collapse" for="c-41853465">[-]</label><label class="expand" for="c-41853465">[2 more]</label></div><br/><div class="children"><div class="content">If the goal is to improve Chicory WASI support, this is the way.<p>If the goal was pure Java SQLite¹, a VFS from scratch would be better.<p>I think since I started my Go&#x2F;wazero effort, WASI+SQLite improved a bunch. I had to start with the demo VFS; the Unix VFS now builds. But custom VFS is still the way to go, IMO.<p>And thanks! My contributions to wazero were tiny. Best of luck with Chicory!<p>1: strong NestedVM vibes here; 11 years ago… gosh, I feel old now. <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;18186507&#x2F;pure-java-vs-native-sqlitejdbc-driver-and-nested-vm" rel="nofollow">https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;18186507&#x2F;pure-java-vs-na...</a></div><br/><div id="41853521" class="c"><input type="checkbox" id="c-41853521" checked=""/><div class="controls bullet"><span class="by">bhelx</span><span>|</span><a href="#41852085">root</a><span>|</span><a href="#41853465">parent</a><span>|</span><a href="#41851916">next</a><span>|</span><label class="collapse" for="c-41853521">[-]</label><label class="expand" for="c-41853521">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If the goal was pure Java SQLite¹, a VFS from scratch would be better.<p>agreed, though this was more an experiment to test Chicory once we built initial wasi support. I&#x27;d love to see it picked up and improved. I think that&#x27;s the direction I&#x27;d go if i want some kind of production ready library.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41851916" class="c"><input type="checkbox" id="c-41851916" checked=""/><div class="controls bullet"><span class="by">jjcm</span><span>|</span><a href="#41852085">prev</a><span>|</span><a href="#41854598">next</a><span>|</span><label class="collapse" for="c-41851916">[-]</label><label class="expand" for="c-41851916">[5 more]</label></div><br/><div class="children"><div class="content">As a general question, in what scenarios is it more beneficial to send the full DB and let the browser handle the queries? Maybe phrased a better way - when would I use this to improve a user experience over the traditional server-hosted db model?</div><br/><div id="41852807" class="c"><input type="checkbox" id="c-41852807" checked=""/><div class="controls bullet"><span class="by">ThatPlayer</span><span>|</span><a href="#41851916">parent</a><span>|</span><a href="#41851976">next</a><span>|</span><label class="collapse" for="c-41852807">[-]</label><label class="expand" for="c-41852807">[1 more]</label></div><br/><div class="children"><div class="content">Personally I&#x27;m using it for a statically hosted website, so a server-hosted database was never an option. Also with the right driver, it&#x27;s possible to stream the chunks of the database as needed rather than sending the full database: <a href="https:&#x2F;&#x2F;github.com&#x2F;mmomtchev&#x2F;sqlite-wasm-http">https:&#x2F;&#x2F;github.com&#x2F;mmomtchev&#x2F;sqlite-wasm-http</a><p>I can even do Sqlite&#x27;s full text search without downloading the entire FTS database. Just most of it, if the search term is short enough.</div><br/></div></div><div id="41851976" class="c"><input type="checkbox" id="c-41851976" checked=""/><div class="controls bullet"><span class="by">bryanrasmussen</span><span>|</span><a href="#41851916">parent</a><span>|</span><a href="#41852807">prev</a><span>|</span><a href="#41855888">next</a><span>|</span><label class="collapse" for="c-41851976">[-]</label><label class="expand" for="c-41851976">[1 more]</label></div><br/><div class="children"><div class="content">&gt;when would I use this to improve a user experience over the traditional server-hosted db model?<p>just my intuition when I read the headline of this post - something like the interplay between PouchDB and CouchDB for offline first apps<p><a href="https:&#x2F;&#x2F;medium.com&#x2F;offline-camp&#x2F;couchdb-pouchdb-and-hoodie-as-a-stack-for-progressive-web-apps-a6078a985f18" rel="nofollow">https:&#x2F;&#x2F;medium.com&#x2F;offline-camp&#x2F;couchdb-pouchdb-and-hoodie-a...</a></div><br/></div></div><div id="41855888" class="c"><input type="checkbox" id="c-41855888" checked=""/><div class="controls bullet"><span class="by">pdyc</span><span>|</span><a href="#41851916">parent</a><span>|</span><a href="#41851976">prev</a><span>|</span><a href="#41851993">next</a><span>|</span><label class="collapse" for="c-41855888">[-]</label><label class="expand" for="c-41855888">[1 more]</label></div><br/><div class="children"><div class="content">i am creating host of dashboards which directly talk to different services with very little data on my own server that is used for access control and token management only so actual data never comes to my servers. This kind of app is a good candidate for client side embedded db.</div><br/></div></div><div id="41851993" class="c"><input type="checkbox" id="c-41851993" checked=""/><div class="controls bullet"><span class="by">harrisi</span><span>|</span><a href="#41851916">parent</a><span>|</span><a href="#41855888">prev</a><span>|</span><a href="#41854598">next</a><span>|</span><label class="collapse" for="c-41851993">[-]</label><label class="expand" for="c-41851993">[1 more]</label></div><br/><div class="children"><div class="content">For offline use it can be good when dealing with large amounts of data. Anything from like an audio library to 3D modeling software. Changes can be made locally and persisted and then you can sync things server side regularly or when online again.</div><br/></div></div></div></div><div id="41854598" class="c"><input type="checkbox" id="c-41854598" checked=""/><div class="controls bullet"><span class="by">koolala</span><span>|</span><a href="#41851916">prev</a><span>|</span><a href="#41851272">next</a><span>|</span><label class="collapse" for="c-41854598">[-]</label><label class="expand" for="c-41854598">[2 more]</label></div><br/><div class="children"><div class="content">The CORS restrictions &#x2F; needing SharedArrayBuffer support kinda stinks.<p>There is no way to use Sqlite3 off-thread without memory sharing? Couldn&#x27;t postMessage work to pass data to the sqlite thread by using the third Transfer argument?<p>Would postMessage transfer allow memory to be stored in a sqlite wasm database running a worker off-thread?<p>Refering to this implementation&#x27;s docs:
<a href="https:&#x2F;&#x2F;github.com&#x2F;sqlite&#x2F;sqlite-wasm">https:&#x2F;&#x2F;github.com&#x2F;sqlite&#x2F;sqlite-wasm</a></div><br/><div id="41854755" class="c"><input type="checkbox" id="c-41854755" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41854598">parent</a><span>|</span><a href="#41851272">next</a><span>|</span><label class="collapse" for="c-41854755">[-]</label><label class="expand" for="c-41854755">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The CORS restrictions &#x2F; needing SharedArrayBuffer support kinda stinks.<p>We have no CORS restrictions but one specific (and optional) VFS requires COOP&#x2F;COEP for SharedArrayBuffer. If SharedArrayBuffer isn&#x27;t available, that VFS won&#x27;t load, but the rest of the library will plod along just fine:<p><a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;tip&#x2F;persistence.md" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;tip&#x2F;persistence.md</a></div><br/></div></div></div></div><div id="41851272" class="c"><input type="checkbox" id="c-41851272" checked=""/><div class="controls bullet"><span class="by">outlore</span><span>|</span><a href="#41854598">prev</a><span>|</span><a href="#41854281">next</a><span>|</span><label class="collapse" for="c-41851272">[-]</label><label class="expand" for="c-41851272">[9 more]</label></div><br/><div class="children"><div class="content">i’ve been looking for a Tanstack Query style library that is backed by Sqlite (backed by OPFS or some other browser storage) and syncs with an API in the background. Does anything like that exist? i’ve seen ElectricSQL and other sync engines but they are a bit opinionated. I’m pretty new to local-first but i feel like the developer ergonomics are not quite there yet<p>Meanwhile for “local-only” it would be great to use sqlite in the browser + native file system API so that the db could be stored on the user’s file system and we wouldn’t have to worry about browser storage eviction. i think that could really open up a whole world of privacy preserving offline software delivered through the browser</div><br/><div id="41851686" class="c"><input type="checkbox" id="c-41851686" checked=""/><div class="controls bullet"><span class="by">gagik_co</span><span>|</span><a href="#41851272">parent</a><span>|</span><a href="#41851613">next</a><span>|</span><label class="collapse" for="c-41851686">[-]</label><label class="expand" for="c-41851686">[3 more]</label></div><br/><div class="children"><div class="content">I have working to replicate TanStack query experience by writing my own queries wrapped around PowerSync, although actually on Flutter (using Flutter Hooks! which was cool to use coming from React). It’s a very internal design meant for my app tetr[1] right now (and actually being migrated over from Realm). I am hoping to potentially standardize it and publish a package once it’s mature enough but not too wrap to make your own hooks around them for your needs.<p>[1] <a href="https:&#x2F;&#x2F;tetr.app" rel="nofollow">https:&#x2F;&#x2F;tetr.app</a></div><br/><div id="41855415" class="c"><input type="checkbox" id="c-41855415" checked=""/><div class="controls bullet"><span class="by">outlore</span><span>|</span><a href="#41851272">root</a><span>|</span><a href="#41851686">parent</a><span>|</span><a href="#41851613">next</a><span>|</span><label class="collapse" for="c-41855415">[-]</label><label class="expand" for="c-41855415">[2 more]</label></div><br/><div class="children"><div class="content">very cool product page!</div><br/><div id="41856313" class="c"><input type="checkbox" id="c-41856313" checked=""/><div class="controls bullet"><span class="by">gagik_co</span><span>|</span><a href="#41851272">root</a><span>|</span><a href="#41855415">parent</a><span>|</span><a href="#41851613">next</a><span>|</span><label class="collapse" for="c-41856313">[-]</label><label class="expand" for="c-41856313">[1 more]</label></div><br/><div class="children"><div class="content">thank you!</div><br/></div></div></div></div></div></div><div id="41851613" class="c"><input type="checkbox" id="c-41851613" checked=""/><div class="controls bullet"><span class="by">ochiba</span><span>|</span><a href="#41851272">parent</a><span>|</span><a href="#41851686">prev</a><span>|</span><a href="#41854685">next</a><span>|</span><label class="collapse" for="c-41851613">[-]</label><label class="expand" for="c-41851613">[2 more]</label></div><br/><div class="children"><div class="content">Not sure if you&#x27;ve looked at PowerSync yet: <a href="https:&#x2F;&#x2F;www.powersync.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.powersync.com&#x2F;</a> (I&#x27;m on the team)<p>For the read path it hooks into Postgres logical replication or MongoDB change streams (and MySQL binlog soon). It supports partial syncing using declarative rules. For the write path, it allows writing to the local SQLite database and also places writes into an upload queue, and then uses a developer-defined function to upload writes to the backend API.<p>We did a deep dive on current options for SQLite on the web, and are currently using an IndexedDB-based VFS, and looking to move to OPFS: <a href="https:&#x2F;&#x2F;www.powersync.com&#x2F;blog&#x2F;sqlite-persistence-on-the-web" rel="nofollow">https:&#x2F;&#x2F;www.powersync.com&#x2F;blog&#x2F;sqlite-persistence-on-the-web</a><p>We recently released an integration with TanStack Query to allow leveraging some of its features in conjunction with PowerSync: <a href="https:&#x2F;&#x2F;docs.powersync.com&#x2F;client-sdk-references&#x2F;js-web&#x2F;javascript-spa-frameworks" rel="nofollow">https:&#x2F;&#x2F;docs.powersync.com&#x2F;client-sdk-references&#x2F;js-web&#x2F;java...</a><p>&gt; Meanwhile for “local-only” it would be great to use sqlite in the browser + native file system API so that the db could be stored on the user’s file system and we wouldn’t have to worry about browser storage eviction. i think that could really open up a whole world of privacy preserving offline software delivered through the browser<p>Agreed. This is a limitation of IndexedDB and OPFS as persistent browser storage currently</div><br/><div id="41854199" class="c"><input type="checkbox" id="c-41854199" checked=""/><div class="controls bullet"><span class="by">outlore</span><span>|</span><a href="#41851272">root</a><span>|</span><a href="#41851613">parent</a><span>|</span><a href="#41854685">next</a><span>|</span><label class="collapse" for="c-41854199">[-]</label><label class="expand" for="c-41854199">[1 more]</label></div><br/><div class="children"><div class="content">ooo i haven’t! will check PowerSync out :)</div><br/></div></div></div></div><div id="41854685" class="c"><input type="checkbox" id="c-41854685" checked=""/><div class="controls bullet"><span class="by">matlin</span><span>|</span><a href="#41851272">parent</a><span>|</span><a href="#41851613">prev</a><span>|</span><a href="#41851366">next</a><span>|</span><label class="collapse" for="c-41854685">[-]</label><label class="expand" for="c-41854685">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve made just this!<p>Docs for it: <a href="https:&#x2F;&#x2F;www.triplit.dev&#x2F;docs&#x2F;frameworks&#x2F;tanstack-router#example-usage">https:&#x2F;&#x2F;www.triplit.dev&#x2F;docs&#x2F;frameworks&#x2F;tanstack-router#exam...</a><p>It by default uses IndexedDB but can also use SQLite but does real time, relational querying and (optionally) syncs with you server.<p>Re: developer ergonomics, this is our primary focus so I don&#x27;t love to get your feedback on!</div><br/><div id="41855413" class="c"><input type="checkbox" id="c-41855413" checked=""/><div class="controls bullet"><span class="by">outlore</span><span>|</span><a href="#41851272">root</a><span>|</span><a href="#41854685">parent</a><span>|</span><a href="#41851366">next</a><span>|</span><label class="collapse" for="c-41855413">[-]</label><label class="expand" for="c-41855413">[1 more]</label></div><br/><div class="children"><div class="content">thanks for sharing! will take a look :)</div><br/></div></div></div></div><div id="41851366" class="c"><input type="checkbox" id="c-41851366" checked=""/><div class="controls bullet"><span class="by">netghost</span><span>|</span><a href="#41851272">parent</a><span>|</span><a href="#41854685">prev</a><span>|</span><a href="#41854281">next</a><span>|</span><label class="collapse" for="c-41851366">[-]</label><label class="expand" for="c-41851366">[1 more]</label></div><br/><div class="children"><div class="content">ElectricSQL and friends seem to be the best option so far, but they all come with a lot of caveats.  It feels like local-first is near, and it&#x27;s so tantalizing, but I haven&#x27;t seen anything that feels like it&#x27;s done enough to build on just yet.</div><br/></div></div></div></div><div id="41854281" class="c"><input type="checkbox" id="c-41854281" checked=""/><div class="controls bullet"><span class="by">baudaux</span><span>|</span><a href="#41851272">prev</a><span>|</span><a href="#41851739">next</a><span>|</span><label class="collapse" for="c-41854281">[-]</label><label class="expand" for="c-41854281">[1 more]</label></div><br/><div class="children"><div class="content">I definitely have to put sqlite in  <a href="https:&#x2F;&#x2F;exaequOS.com" rel="nofollow">https:&#x2F;&#x2F;exaequOS.com</a></div><br/></div></div><div id="41851739" class="c"><input type="checkbox" id="c-41851739" checked=""/><div class="controls bullet"><span class="by">me551ah</span><span>|</span><a href="#41854281">prev</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41851739">[-]</label><label class="expand" for="c-41851739">[9 more]</label></div><br/><div class="children"><div class="content">After years of being able to run SQLite on my mobile phone, my tv, my router and gaming consoles, I can finally run it on my browser. Which also happens to be running on the most powerful machine I own</div><br/><div id="41852109" class="c"><input type="checkbox" id="c-41852109" checked=""/><div class="controls bullet"><span class="by">ibash</span><span>|</span><a href="#41851739">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41852109">[-]</label><label class="expand" for="c-41852109">[8 more]</label></div><br/><div class="children"><div class="content">surprise! it&#x27;s been there for decades: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Web_SQL_Database" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Web_SQL_Database</a></div><br/><div id="41852276" class="c"><input type="checkbox" id="c-41852276" checked=""/><div class="controls bullet"><span class="by">adregan</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41852109">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41852276">[-]</label><label class="expand" for="c-41852276">[7 more]</label></div><br/><div class="children"><div class="content">It <i>was</i> there for a decade: <a href="https:&#x2F;&#x2F;caniuse.com&#x2F;sql-storage" rel="nofollow">https:&#x2F;&#x2F;caniuse.com&#x2F;sql-storage</a></div><br/><div id="41852508" class="c"><input type="checkbox" id="c-41852508" checked=""/><div class="controls bullet"><span class="by">joemi</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41852276">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41852508">[-]</label><label class="expand" for="c-41852508">[6 more]</label></div><br/><div class="children"><div class="content">I wonder why it was unmaintained&#x2F;dropped. Was there something wrong with it, and if so, would that also apply to this kind of wasm implementation?</div><br/><div id="41852746" class="c"><input type="checkbox" id="c-41852746" checked=""/><div class="controls bullet"><span class="by">debugnik</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41852508">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41852746">[-]</label><label class="expand" for="c-41852746">[5 more]</label></div><br/><div class="children"><div class="content">Mozilla refused to support it because then every implementation would have simply used SQLite, which would have promoted any implementation details to a <i>de facto</i> standard. (Even caniuse erroneously describes the feature as &quot;allows SQLite database queries&quot;.)<p>From the latest spec [1]:<p>&gt; The specification reached an impasse: all interested implementors have used the same SQL backend (Sqlite), but we need multiple independent implementations to proceed along a standardisation path.<p>[1]: <a href="https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webdatabase&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webdatabase&#x2F;</a><p>This won&#x27;t be a problem for wasm SQLite because it isn&#x27;t a standard being shipped by browsers, just another dependency.</div><br/><div id="41853046" class="c"><input type="checkbox" id="c-41853046" checked=""/><div class="controls bullet"><span class="by">xyc</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41852746">parent</a><span>|</span><a href="#41853591">next</a><span>|</span><label class="collapse" for="c-41853046">[-]</label><label class="expand" for="c-41853046">[1 more]</label></div><br/><div class="children"><div class="content">i have a feeling that it set back the web by a decade<p><a href="https:&#x2F;&#x2F;x.com&#x2F;chxy&#x2F;status&#x2F;1822858746307170640" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;chxy&#x2F;status&#x2F;1822858746307170640</a></div><br/></div></div><div id="41853591" class="c"><input type="checkbox" id="c-41853591" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41852746">parent</a><span>|</span><a href="#41853046">prev</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41853591">[-]</label><label class="expand" for="c-41853591">[3 more]</label></div><br/><div class="children"><div class="content">Did they really assume that they were going to be able to _restandardize_ SQL?  No wonder IndexDB is hot useless garbage.<p>The standardization issues around SQL already exist,  are already widely known,  and where common workarounds are already in practice.  It&#x27;s also an open source project that could have _easily_ incorporated compatibility code for this specific use case anyways.<p>They made blind fealty to process more important than the outcome to end users.<p>What a waste.</div><br/><div id="41854893" class="c"><input type="checkbox" id="c-41854893" checked=""/><div class="controls bullet"><span class="by">sgbeal</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41853591">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41854893">[-]</label><label class="expand" for="c-41854893">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Did they really assume that they were going to be able to _restandardize_ SQL?<p>The core issue was not the SQL, but the underlying storage engine.<p>Microsoft&#x27;s office doc formats aside, standards bodies, as a general rule, require that a standard be built around multiple independent, conformant implementations. WebSQL did not measure up there because all vendors implementing it chose the only viable option they had for the underlying storage: SQLite.</div><br/><div id="41855067" class="c"><input type="checkbox" id="c-41855067" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#41851739">root</a><span>|</span><a href="#41854893">parent</a><span>|</span><a href="#41851345">next</a><span>|</span><label class="collapse" for="c-41855067">[-]</label><label class="expand" for="c-41855067">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve seen and understood that in hardware.  I&#x27;m less convinced it&#x27;s reasonable in this context.  If there wasn&#x27;t an _independent_ implementation it might barely make sense,  but given that sqlite exists separately and can be installed separately,  this is more of a &quot;package management&quot; or &quot;system library access&quot; problem than it is one of actual standardization by an independent body.<p>Which if you standardized this generic interface you could have multiple independent database engines available not just ones that are SQL based,  although,  SQL in particular was readily available through SQLite,  and would clearly be exceptionally popular.<p>Huge miss when organizations stick the the routine rather then take an opportunity to explore and examine new ways forward.  Meanwhile everyone is being held hostage by V2 to V3 manifest changes by _one_ vendor.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="41851345" class="c"><input type="checkbox" id="c-41851345" checked=""/><div class="controls bullet"><span class="by">gnarbarian</span><span>|</span><a href="#41851739">prev</a><span>|</span><a href="#41852016">next</a><span>|</span><label class="collapse" for="c-41851345">[-]</label><label class="expand" for="c-41851345">[10 more]</label></div><br/><div class="children"><div class="content">How long until we see WebAssembly&#x2F;WebGPU become a platform independent choice for deploying server side code as well?</div><br/><div id="41852090" class="c"><input type="checkbox" id="c-41852090" checked=""/><div class="controls bullet"><span class="by">stackskipton</span><span>|</span><a href="#41851345">parent</a><span>|</span><a href="#41852575">next</a><span>|</span><label class="collapse" for="c-41852090">[-]</label><label class="expand" for="c-41852090">[3 more]</label></div><br/><div class="children"><div class="content">SRE here, it&#x27;s currently happening in a few parts but overall, it&#x27;s not as attractive on server side. Server Side code running is mostly a solved problem and for very few organizations, the benefits of WASM don&#x27;t outweigh any difficulties in getting it running.</div><br/><div id="41853273" class="c"><input type="checkbox" id="c-41853273" checked=""/><div class="controls bullet"><span class="by">6gvONxR4sf7o</span><span>|</span><a href="#41851345">root</a><span>|</span><a href="#41852090">parent</a><span>|</span><a href="#41852575">next</a><span>|</span><label class="collapse" for="c-41853273">[-]</label><label class="expand" for="c-41853273">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Server Side code running is mostly a solved problem<p>I know what you mean here, but I think we&#x27;re very limited in what we tend to run. Polyglot programming still isn&#x27;t really a thing, and with things like WASI standardized (someday soon I hope), I could imagine it becoming a lot nicer.</div><br/><div id="41854086" class="c"><input type="checkbox" id="c-41854086" checked=""/><div class="controls bullet"><span class="by">stackskipton</span><span>|</span><a href="#41851345">root</a><span>|</span><a href="#41853273">parent</a><span>|</span><a href="#41852575">next</a><span>|</span><label class="collapse" for="c-41854086">[-]</label><label class="expand" for="c-41854086">[1 more]</label></div><br/><div class="children"><div class="content">I feel like Polyglot programming in single app sounds like a nightmare but as non dev, meh, whatever.</div><br/></div></div></div></div></div></div><div id="41852575" class="c"><input type="checkbox" id="c-41852575" checked=""/><div class="controls bullet"><span class="by">evacchi</span><span>|</span><a href="#41851345">parent</a><span>|</span><a href="#41852090">prev</a><span>|</span><a href="#41851398">next</a><span>|</span><label class="collapse" for="c-41852575">[-]</label><label class="expand" for="c-41852575">[1 more]</label></div><br/><div class="children"><div class="content">Shameless plug for Dylibso&#x27;s latest beta launch :) <a href="https:&#x2F;&#x2F;www.getxtp.com&#x2F;blog&#x2F;meet-xtp" rel="nofollow">https:&#x2F;&#x2F;www.getxtp.com&#x2F;blog&#x2F;meet-xtp</a><p>disclaimer: I work there</div><br/></div></div><div id="41851398" class="c"><input type="checkbox" id="c-41851398" checked=""/><div class="controls bullet"><span class="by">ruined</span><span>|</span><a href="#41851345">parent</a><span>|</span><a href="#41852575">prev</a><span>|</span><a href="#41852681">next</a><span>|</span><label class="collapse" for="c-41851398">[-]</label><label class="expand" for="c-41851398">[2 more]</label></div><br/><div class="children"><div class="content">as soon as wasi is settled</div><br/><div id="41852078" class="c"><input type="checkbox" id="c-41852078" checked=""/><div class="controls bullet"><span class="by">gnarbarian</span><span>|</span><a href="#41851345">root</a><span>|</span><a href="#41851398">parent</a><span>|</span><a href="#41852681">next</a><span>|</span><label class="collapse" for="c-41852078">[-]</label><label class="expand" for="c-41852078">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;wasi.dev&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wasi.dev&#x2F;</a><p>wow I didn&#x27;t know this was a thing. thanks for filling me in!</div><br/></div></div></div></div><div id="41852681" class="c"><input type="checkbox" id="c-41852681" checked=""/><div class="controls bullet"><span class="by">Thaxll</span><span>|</span><a href="#41851345">parent</a><span>|</span><a href="#41851398">prev</a><span>|</span><a href="#41851405">next</a><span>|</span><label class="collapse" for="c-41852681">[-]</label><label class="expand" for="c-41852681">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s kind of dying on the server, some people thought it would replace containers.</div><br/></div></div><div id="41851405" class="c"><input type="checkbox" id="c-41851405" checked=""/><div class="controls bullet"><span class="by">paulddraper</span><span>|</span><a href="#41851345">parent</a><span>|</span><a href="#41852681">prev</a><span>|</span><a href="#41852016">next</a><span>|</span><label class="collapse" for="c-41851405">[-]</label><label class="expand" for="c-41851405">[2 more]</label></div><br/><div class="children"><div class="content">Yesterday?<p>There&#x27;s a number of WASM platforms&#x2F;tools: Wasmer, wasmCloud, a few others that escape my memory.</div><br/><div id="41851445" class="c"><input type="checkbox" id="c-41851445" checked=""/><div class="controls bullet"><span class="by">jt2190</span><span>|</span><a href="#41851345">root</a><span>|</span><a href="#41851405">parent</a><span>|</span><a href="#41852016">next</a><span>|</span><label class="collapse" for="c-41851445">[-]</label><label class="expand" for="c-41851445">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;wasmer.io&#x2F;">https:&#x2F;&#x2F;wasmer.io&#x2F;</a><p><a href="https:&#x2F;&#x2F;wasmcloud.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wasmcloud.com&#x2F;</a><p><a href="https:&#x2F;&#x2F;wasmtime.dev&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wasmtime.dev&#x2F;</a></div><br/></div></div></div></div></div></div><div id="41852016" class="c"><input type="checkbox" id="c-41852016" checked=""/><div class="controls bullet"><span class="by">baq</span><span>|</span><a href="#41851345">prev</a><span>|</span><a href="#41852119">next</a><span>|</span><label class="collapse" for="c-41852016">[-]</label><label class="expand" for="c-41852016">[1 more]</label></div><br/><div class="children"><div class="content">See also <a href="https:&#x2F;&#x2F;github.com&#x2F;electric-sql&#x2F;pglite">https:&#x2F;&#x2F;github.com&#x2F;electric-sql&#x2F;pglite</a> (REPL at <a href="https:&#x2F;&#x2F;pglite.dev&#x2F;repl&#x2F;" rel="nofollow">https:&#x2F;&#x2F;pglite.dev&#x2F;repl&#x2F;</a>)<p>(Previously discussed 7 months ago: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39477457">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39477457</a>)</div><br/></div></div><div id="41852119" class="c"><input type="checkbox" id="c-41852119" checked=""/><div class="controls bullet"><span class="by">benthecarman</span><span>|</span><a href="#41852016">prev</a><span>|</span><a href="#41854170">next</a><span>|</span><label class="collapse" for="c-41852119">[-]</label><label class="expand" for="c-41852119">[2 more]</label></div><br/><div class="children"><div class="content">Whats needed is a rust-wasm compatible library that can use this.</div><br/><div id="41852964" class="c"><input type="checkbox" id="c-41852964" checked=""/><div class="controls bullet"><span class="by">aabhay</span><span>|</span><a href="#41852119">parent</a><span>|</span><a href="#41854170">next</a><span>|</span><label class="collapse" for="c-41852964">[-]</label><label class="expand" for="c-41852964">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re interested in contributing to that, here is a good place to start (in early discussion stages):<p><a href="https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;154">https:&#x2F;&#x2F;github.com&#x2F;rhashimoto&#x2F;wa-sqlite&#x2F;discussions&#x2F;154</a></div><br/></div></div></div></div><div id="41854170" class="c"><input type="checkbox" id="c-41854170" checked=""/><div class="controls bullet"><span class="by">runarberg</span><span>|</span><a href="#41852119">prev</a><span>|</span><a href="#41851202">next</a><span>|</span><label class="collapse" for="c-41854170">[-]</label><label class="expand" for="c-41854170">[1 more]</label></div><br/><div class="children"><div class="content">I’m working on a hobby-project that uses IndexedDB for persistent client-side storage, and it really feels like W3C made some very bad design decision and than instead of fixing they they have just given up on the standard. Issues like not being able to index values in objects in arrays [1] (not even in fixed position e.g. &quot;key.path.[0].value&quot;) despite almost a decade of developers asking for it, a very limited query syntax, and even the documentation on MDN seems of very lower quality than the rest of the web docs.<p>I’m happy that we are actually be able to use SQL in the browser now (although I would rather skip the MBs of the bundle bloat). But I feel like the standards committee will now have even less of a reason to fix the very broken state of IndexedDB.<p>1: <a href="https:&#x2F;&#x2F;github.com&#x2F;w3c&#x2F;IndexedDB&#x2F;issues&#x2F;35">https:&#x2F;&#x2F;github.com&#x2F;w3c&#x2F;IndexedDB&#x2F;issues&#x2F;35</a></div><br/></div></div><div id="41851202" class="c"><input type="checkbox" id="c-41851202" checked=""/><div class="controls bullet"><span class="by">dang-lover</span><span>|</span><a href="#41854170">prev</a><span>|</span><label class="collapse" for="c-41851202">[-]</label><label class="expand" for="c-41851202">[4 more]</label></div><br/><div class="children"><div class="content">I like it</div><br/><div id="41851364" class="c"><input type="checkbox" id="c-41851364" checked=""/><div class="controls bullet"><span class="by">bsimpson</span><span>|</span><a href="#41851202">parent</a><span>|</span><a href="#41852242">next</a><span>|</span><label class="collapse" for="c-41851364">[-]</label><label class="expand" for="c-41851364">[1 more]</label></div><br/><div class="children"><div class="content">And we loved you in Lethal Weapon.</div><br/></div></div><div id="41852242" class="c"><input type="checkbox" id="c-41852242" checked=""/><div class="controls bullet"><span class="by">akutlay</span><span>|</span><a href="#41851202">parent</a><span>|</span><a href="#41851364">prev</a><span>|</span><a href="#41851301">next</a><span>|</span><label class="collapse" for="c-41852242">[-]</label><label class="expand" for="c-41852242">[1 more]</label></div><br/><div class="children"><div class="content">Thankss for sharing</div><br/></div></div><div id="41851301" class="c"><input type="checkbox" id="c-41851301" checked=""/><div class="controls bullet"><span class="by">szundi</span><span>|</span><a href="#41851202">parent</a><span>|</span><a href="#41852242">prev</a><span>|</span><label class="collapse" for="c-41851301">[-]</label><label class="expand" for="c-41851301">[1 more]</label></div><br/><div class="children"><div class="content">We like that you like it</div><br/></div></div></div></div></div></div></div></div></div></body></html>