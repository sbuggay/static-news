<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1689411653434" as="style"/><link rel="stylesheet" href="styles.css?v=1689411653434"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.dancowell.com/balls-the-day-i-locked-ev/">The day I locked everyone out of the company intranet</a> <span class="domain">(<a href="https://www.dancowell.com">www.dancowell.com</a>)</span></div><div class="subtext"><span>dfcowell</span> | <span>23 comments</span></div><br/><div><div id="36734798" class="c"><input type="checkbox" id="c-36734798" checked=""/><div class="controls bullet"><span class="by">fukawi2</span><span>|</span><a href="#36734632">next</a><span>|</span><label class="collapse" for="c-36734798">[-]</label><label class="expand" for="c-36734798">[4 more]</label></div><br/><div class="children"><div class="content">I was working on an old old old &quot;ERP&quot; system written in D3 PICK. It&#x27;s a database, programming language and OS all in one with roots in tracking military helicopter parts in the 1960&#x27;s. I was working on it in the mid-2000s.<p>It had SQL like syntax for manipulating data, but it was interactive. So you would SELECT the rows from the table that you wanted, then those rows would be part of your state. You would then do UPDATE or DELETE without any kind of WHERE, because the state had your filter from the previous SELECT.<p>It has a fun quirk though - if your SELECT matched no rows, the state would be empty. So SELECT foo WHERE 1=2 would select nothing.<p>UPDATE and DELETE are perfectly valid actions even without a state...<p>Working late one night, I ran a SELECT STKM WHERE something that matched nothing, then before I realised I realised my state had no rows matched, I followed up with DELETE STKM.<p>Yep, the entire Stock Movements table four the last 20+ years of business were gone.<p>The nightly backup had not run, and I didn&#x27;t want to lose an entire day of processing to roll back to the previous night.<p>I spent the entire night writing a program to recreate that data based on invoices, purchase orders, stocktake data, etc. I was able to recreate every record and got home about 9am. Lots of lessons learnt that night.</div><br/><div id="36734818" class="c"><input type="checkbox" id="c-36734818" checked=""/><div class="controls bullet"><span class="by">albert_e</span><span>|</span><a href="#36734798">parent</a><span>|</span><a href="#36734632">next</a><span>|</span><label class="collapse" for="c-36734818">[-]</label><label class="expand" for="c-36734818">[3 more]</label></div><br/><div class="children"><div class="content">You recreated a production database of 20 years data by hand overnight?<p>You deserve an award !!!</div><br/><div id="36734874" class="c"><input type="checkbox" id="c-36734874" checked=""/><div class="controls bullet"><span class="by">testemailfordg2</span><span>|</span><a href="#36734798">root</a><span>|</span><a href="#36734818">parent</a><span>|</span><a href="#36734881">next</a><span>|</span><label class="collapse" for="c-36734874">[-]</label><label class="expand" for="c-36734874">[1 more]</label></div><br/><div class="children"><div class="content">Only that day&#x27;s data was added on top of backup from last night...</div><br/></div></div><div id="36734881" class="c"><input type="checkbox" id="c-36734881" checked=""/><div class="controls bullet"><span class="by">unnouinceput</span><span>|</span><a href="#36734798">root</a><span>|</span><a href="#36734818">parent</a><span>|</span><a href="#36734874">prev</a><span>|</span><a href="#36734632">next</a><span>|</span><label class="collapse" for="c-36734881">[-]</label><label class="expand" for="c-36734881">[1 more]</label></div><br/><div class="children"><div class="content">he only recreated the ones not saved by the nightly backup, meaning he used the previous nightly backup and recreated from invoices the last ~23 hours.</div><br/></div></div></div></div></div></div><div id="36734632" class="c"><input type="checkbox" id="c-36734632" checked=""/><div class="controls bullet"><span class="by">drsim</span><span>|</span><a href="#36734798">prev</a><span>|</span><a href="#36734597">next</a><span>|</span><label class="collapse" for="c-36734632">[-]</label><label class="expand" for="c-36734632">[1 more]</label></div><br/><div class="children"><div class="content">I wrap all of my production manipulations in a transaction, and commit only if the results are expected. Yes, it may take locks that block customer-facing transactions, so I have selects ready to go in the transaction to minimise this.<p>15 years and counting since wiping out a large production table and taking a day to restore from backup.</div><br/></div></div><div id="36734597" class="c"><input type="checkbox" id="c-36734597" checked=""/><div class="controls bullet"><span class="by">freetanga</span><span>|</span><a href="#36734632">prev</a><span>|</span><a href="#36734841">next</a><span>|</span><label class="collapse" for="c-36734597">[-]</label><label class="expand" for="c-36734597">[9 more]</label></div><br/><div class="children"><div class="content">Always do a select with your criteria before doing a Delete or update.<p>Don’t ask me how I learned this.</div><br/><div id="36734920" class="c"><input type="checkbox" id="c-36734920" checked=""/><div class="controls bullet"><span class="by">_nalply</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734815">next</a><span>|</span><label class="collapse" for="c-36734920">[-]</label><label class="expand" for="c-36734920">[1 more]</label></div><br/><div class="children"><div class="content">Once I wanted to do `rm -fr *~` to delete backup files, but the `~` key didn&#x27;t register...<p>Now I have learnt to instinctively stop before doing anything destructive and double-check and double-check again! This also applies to SQL `DELETE` and `UPDATE`!<p>I know that `-r` was not neccessary but hey that was a biiiig mistake of mine!</div><br/></div></div><div id="36734815" class="c"><input type="checkbox" id="c-36734815" checked=""/><div class="controls bullet"><span class="by">tgv</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734920">prev</a><span>|</span><a href="#36734604">next</a><span>|</span><label class="collapse" for="c-36734815">[-]</label><label class="expand" for="c-36734815">[1 more]</label></div><br/><div class="children"><div class="content">Then start a transaction, and only commit when the row numbers match.</div><br/></div></div><div id="36734604" class="c"><input type="checkbox" id="c-36734604" checked=""/><div class="controls bullet"><span class="by">gumballindie</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734815">prev</a><span>|</span><a href="#36734806">next</a><span>|</span><label class="collapse" for="c-36734604">[-]</label><label class="expand" for="c-36734604">[1 more]</label></div><br/><div class="children"><div class="content">Came here to say exactly that! I do a select count and then a limit against the returned count. At least it may reduce the blast radius.</div><br/></div></div><div id="36734806" class="c"><input type="checkbox" id="c-36734806" checked=""/><div class="controls bullet"><span class="by">chrisandchris</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734604">prev</a><span>|</span><a href="#36734639">next</a><span>|</span><label class="collapse" for="c-36734806">[-]</label><label class="expand" for="c-36734806">[1 more]</label></div><br/><div class="children"><div class="content">That, and some DB tools (line JetBrains DataGrip) block UPDATEs and DELETEs without a WHERE condition.</div><br/></div></div><div id="36734639" class="c"><input type="checkbox" id="c-36734639" checked=""/><div class="controls bullet"><span class="by">jojobas</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734806">prev</a><span>|</span><a href="#36734603">next</a><span>|</span><label class="collapse" for="c-36734639">[-]</label><label class="expand" for="c-36734639">[3 more]</label></div><br/><div class="children"><div class="content">&gt;Don’t ask me how I learned this.<p>Joke&#x27;s on you, we all learned it this exact way.</div><br/><div id="36734917" class="c"><input type="checkbox" id="c-36734917" checked=""/><div class="controls bullet"><span class="by">maccard</span><span>|</span><a href="#36734597">root</a><span>|</span><a href="#36734639">parent</a><span>|</span><a href="#36734766">next</a><span>|</span><label class="collapse" for="c-36734917">[-]</label><label class="expand" for="c-36734917">[1 more]</label></div><br/><div class="children"><div class="content">Luckily I learned from someone else. I did figure out start with a transaction the hard way though</div><br/></div></div><div id="36734766" class="c"><input type="checkbox" id="c-36734766" checked=""/><div class="controls bullet"><span class="by">seanthemon</span><span>|</span><a href="#36734597">root</a><span>|</span><a href="#36734639">parent</a><span>|</span><a href="#36734917">prev</a><span>|</span><a href="#36734603">next</a><span>|</span><label class="collapse" for="c-36734766">[-]</label><label class="expand" for="c-36734766">[1 more]</label></div><br/><div class="children"><div class="content">This gives my heart pains I can&#x27;t explain to my therapist..</div><br/></div></div></div></div><div id="36734603" class="c"><input type="checkbox" id="c-36734603" checked=""/><div class="controls bullet"><span class="by">lemper</span><span>|</span><a href="#36734597">parent</a><span>|</span><a href="#36734639">prev</a><span>|</span><a href="#36734841">next</a><span>|</span><label class="collapse" for="c-36734603">[-]</label><label class="expand" for="c-36734603">[1 more]</label></div><br/><div class="children"><div class="content">how did you learn it?</div><br/></div></div></div></div><div id="36734841" class="c"><input type="checkbox" id="c-36734841" checked=""/><div class="controls bullet"><span class="by">stuaxo</span><span>|</span><a href="#36734597">prev</a><span>|</span><a href="#36734783">next</a><span>|</span><label class="collapse" for="c-36734841">[-]</label><label class="expand" for="c-36734841">[2 more]</label></div><br/><div class="children"><div class="content">My manager had got me to look at backups.. but for cheap.<p>I decided on bacula - I had the clients installed on all the computers in the office, and it worked for some small tests.<p>My manager decided we would try this with a USB drive attached to one of the servers (somehow this didn&#x27;t seem like a bad idea).<p>In the morning, very uncaffinated he sent me to the other site - an unmanned basement office with the servers.<p>Being uncaffinated I forgot the door password and set off the alarm.<p>I had to go into the office and phone him with the alarm going to get the code to turn the alarm off.<p>OK, that was stressful but sorted out at least.<p>I plugged in the hard drive to the selected server and headed back.<p>Once I got back it turned out all the websites on that server had gone down - trying to send all the backups to this poor USB harddrive had overwhelmed the IO on that-era Linux server and the poor thing just froze.<p>Fairly soon after I was let go, and joined my friends at a much more fun company making mobile games.</div><br/><div id="36734877" class="c"><input type="checkbox" id="c-36734877" checked=""/><div class="controls bullet"><span class="by">sacnoradhq</span><span>|</span><a href="#36734841">parent</a><span>|</span><a href="#36734783">next</a><span>|</span><label class="collapse" for="c-36734877">[-]</label><label class="expand" for="c-36734877">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s the responsibility of the technical person to uphold engineering ethics, especially in the face of potentially inadequate recovery and security solutions.<p>I was once let go from a big name university for refusing to weaken and rush changes to a payment processing network (PCI-DSS) when there was &quot;no time&quot; to review them in detail. That&#x27;s a future FBI press conference sort of thing when it all comes crashing down. Not long after, all SS#s, DOBs, and deets for every employee was stolen from a &quot;rogue&quot; laptop taken by a consultant, likely to be sold on carder and identity theft forums because of an utter failure at data protection processes. That place was a shitshow because they didn&#x27;t have the professional ethics or leadership backbone to do what was prudent and necessary.</div><br/></div></div></div></div><div id="36734783" class="c"><input type="checkbox" id="c-36734783" checked=""/><div class="controls bullet"><span class="by">headline</span><span>|</span><a href="#36734841">prev</a><span>|</span><a href="#36734655">next</a><span>|</span><label class="collapse" for="c-36734783">[-]</label><label class="expand" for="c-36734783">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve just started my career - I wonder what my first fuck-up will be :)</div><br/></div></div><div id="36734655" class="c"><input type="checkbox" id="c-36734655" checked=""/><div class="controls bullet"><span class="by">Nextgrid</span><span>|</span><a href="#36734783">prev</a><span>|</span><a href="#36734641">next</a><span>|</span><label class="collapse" for="c-36734655">[-]</label><label class="expand" for="c-36734655">[2 more]</label></div><br/><div class="children"><div class="content">In the top bar of the site:<p>&gt; Sorry! Subscriptions were broken last week, but are now working. If you tried to subscribe and ran into issues, please try again!<p>I wonder if a similar incident involving a “UPDATE subscriptions” query happened recently.</div><br/><div id="36734680" class="c"><input type="checkbox" id="c-36734680" checked=""/><div class="controls bullet"><span class="by">dfcowell</span><span>|</span><a href="#36734655">parent</a><span>|</span><a href="#36734641">next</a><span>|</span><label class="collapse" for="c-36734680">[-]</label><label class="expand" for="c-36734680">[1 more]</label></div><br/><div class="children"><div class="content">Ha, no, that was a far more mundane issue. The CMS I&#x27;m using requires double opt-in to subscribe, meaning you need to enter your email address <i>and</i> click the confirmation link.<p>It also apparently requires double email configuration, meaning it has two places where you can configure your mailer. I had only set it up in one place, meaning the confirmations never got sent.<p>Bit of a facepalm moment.</div><br/></div></div></div></div><div id="36734641" class="c"><input type="checkbox" id="c-36734641" checked=""/><div class="controls bullet"><span class="by">quijoteuniv</span><span>|</span><a href="#36734655">prev</a><span>|</span><label class="collapse" for="c-36734641">[-]</label><label class="expand" for="c-36734641">[3 more]</label></div><br/><div class="children"><div class="content">Use chatGPT to double check too.</div><br/><div id="36734820" class="c"><input type="checkbox" id="c-36734820" checked=""/><div class="controls bullet"><span class="by">throwbadubadu</span><span>|</span><a href="#36734641">parent</a><span>|</span><label class="collapse" for="c-36734820">[-]</label><label class="expand" for="c-36734820">[2 more]</label></div><br/><div class="children"><div class="content">&quot;Yes, you can delete those items via that query.&quot;<p>&quot;But now all has been deleted??!?! WTF HEEELP&quot;<p>&quot;I apologize for my previous answer, you are correct, you now deleted everything!&quot;</div><br/><div id="36734886" class="c"><input type="checkbox" id="c-36734886" checked=""/><div class="controls bullet"><span class="by">archerx</span><span>|</span><a href="#36734641">root</a><span>|</span><a href="#36734820">parent</a><span>|</span><label class="collapse" for="c-36734886">[-]</label><label class="expand" for="c-36734886">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the laugh, I can imagine someone running untested chatGPT code on prod and this actually happening.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>