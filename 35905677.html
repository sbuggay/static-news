<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1683882047320" as="style"/><link rel="stylesheet" href="styles.css?v=1683882047320"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://tailscale.com/blog/session-recording-beta/">Session recording for Tailscale SSH in beta</a> <span class="domain">(<a href="https://tailscale.com">tailscale.com</a>)</span></div><div class="subtext"><span>geoffeg</span> | <span>25 comments</span></div><br/><div><div id="35911608" class="c"><input type="checkbox" id="c-35911608" checked=""/><div class="controls bullet"><span class="by">teeray</span><span>|</span><a href="#35908264">next</a><span>|</span><label class="collapse" for="c-35911608">[-]</label><label class="expand" for="c-35911608">[1 more]</label></div><br/><div class="children"><div class="content">Many folks don’t realize it, but sudo offers a sudoreplay[0] to do something similar. Obviously this won’t cover things they do outside of a sudo session, but you could construct permissions on the machine such that you would require them to use it for things you care about.<p>This isn’t to trivialize the work of Tailscale (like the famous Dropbox comment). I just wanted to point out a cool thing that sudo does that most people don’t know about.<p>[0] <a href="https:&#x2F;&#x2F;www.sudo.ws&#x2F;docs&#x2F;man&#x2F;1.8.13&#x2F;sudoreplay.man&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.sudo.ws&#x2F;docs&#x2F;man&#x2F;1.8.13&#x2F;sudoreplay.man&#x2F;</a></div><br/></div></div><div id="35908264" class="c"><input type="checkbox" id="c-35908264" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#35911608">prev</a><span>|</span><a href="#35909116">next</a><span>|</span><label class="collapse" for="c-35908264">[-]</label><label class="expand" for="c-35908264">[4 more]</label></div><br/><div class="children"><div class="content">This is a deceptively valuable feature for regulated&#x2F;compliance-trained companies, because a lot of things you want a detailed audit trail for are accessed via shells (most notably: the consoles for app frameworks).</div><br/><div id="35908545" class="c"><input type="checkbox" id="c-35908545" checked=""/><div class="controls bullet"><span class="by">liotier</span><span>|</span><a href="#35908264">parent</a><span>|</span><a href="#35908281">next</a><span>|</span><label class="collapse" for="c-35908545">[-]</label><label class="expand" for="c-35908545">[2 more]</label></div><br/><div class="children"><div class="content">Here at LargeTelco with a legally privileged and regulated safety-critical utility status, absolutely every administrative interaction with a production host goes through a bastion that, on top of enforcing access privileges, also records _everything_. Also, LargeTelco is a complex hell of subnetting. I can very well see the enterprisey attraction of having not just Tailscale&#x27;s low cost and extraordinary ease, but also session records like it is just a cherry on top !</div><br/><div id="35911906" class="c"><input type="checkbox" id="c-35911906" checked=""/><div class="controls bullet"><span class="by">nightfly</span><span>|</span><a href="#35908264">root</a><span>|</span><a href="#35908545">parent</a><span>|</span><a href="#35908281">next</a><span>|</span><label class="collapse" for="c-35911906">[-]</label><label class="expand" for="c-35911906">[1 more]</label></div><br/><div class="children"><div class="content">What do you use to log sessions?</div><br/></div></div></div></div></div></div><div id="35909116" class="c"><input type="checkbox" id="c-35909116" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#35908264">prev</a><span>|</span><a href="#35908170">next</a><span>|</span><label class="collapse" for="c-35909116">[-]</label><label class="expand" for="c-35909116">[1 more]</label></div><br/><div class="children"><div class="content">I use script(1) daily for creating papertrails:<p><pre><code>  script -ec &quot;command args&quot; ~&#x2F;$(date +%Y-%m-%d-%H%M%S_$$_script.txt)
</code></pre>
Works out of the box on almost every *nix system.<p>The recordings end up as textfiles with the control sequences in, you can use commands like cat -v, grep or less -R on them. If you also record a timing file, you can replay it 1:1 on you terminal.</div><br/></div></div><div id="35908170" class="c"><input type="checkbox" id="c-35908170" checked=""/><div class="controls bullet"><span class="by">matthewaveryusa</span><span>|</span><a href="#35909116">prev</a><span>|</span><a href="#35909498">next</a><span>|</span><label class="collapse" for="c-35908170">[-]</label><label class="expand" for="c-35908170">[9 more]</label></div><br/><div class="children"><div class="content">A very valid use-case not mentioned in the article is to save all your personal terminal interactions to a database so you can search it in the future. Your terminal&#x27;s input (and output) value per byte is enormous so really everyone should be saving it all.<p>I&#x27;ll be horsing around with this tonight -- I hope ts sshing to my local computer will just work so I can get local recording as well without a separate mechanism.</div><br/><div id="35910284" class="c"><input type="checkbox" id="c-35910284" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#35908170">parent</a><span>|</span><a href="#35912541">next</a><span>|</span><label class="collapse" for="c-35910284">[-]</label><label class="expand" for="c-35910284">[4 more]</label></div><br/><div class="children"><div class="content">The value is enormous but the security sensitivity is too, so it&#x27;s important to only store it in secure places.</div><br/><div id="35910336" class="c"><input type="checkbox" id="c-35910336" checked=""/><div class="controls bullet"><span class="by">wahern</span><span>|</span><a href="#35908170">root</a><span>|</span><a href="#35910284">parent</a><span>|</span><a href="#35912541">next</a><span>|</span><label class="collapse" for="c-35910336">[-]</label><label class="expand" for="c-35910336">[3 more]</label></div><br/><div class="children"><div class="content">And on a company laptop with automagic backups to the cloud of your home directory, what&#x27;s secure? At a previous company I disabled persistent shell history, and lost count of the number of times this prevented a sensitive password or key from being added to the treasure trove of secrets that are backup archives. (The backup app nominally supported exclusions, but 1) I don&#x27;t trust the correctness of corporate bloatware, and more importantly 2) I don&#x27;t trust that IT or an update wouldn&#x27;t reset those exclusions.)<p>Now, shell sessions from a bastion host scream (hopefully!) security sensitive to IT. Moreover, at that point you shouldn&#x27;t be entering any passwords or keys; one should trust least the integrity of application servers and similar end nodes. But dumps from company laptop home directories where 99% is crap from sales and management... no way that is going to be treated with proper care, no matter how much customer PII it might contain.</div><br/><div id="35911671" class="c"><input type="checkbox" id="c-35911671" checked=""/><div class="controls bullet"><span class="by">hamandcheese</span><span>|</span><a href="#35908170">root</a><span>|</span><a href="#35910336">parent</a><span>|</span><a href="#35912541">next</a><span>|</span><label class="collapse" for="c-35911671">[-]</label><label class="expand" for="c-35911671">[2 more]</label></div><br/><div class="children"><div class="content">In this day an age, are workstation backups really necessary? I can&#x27;t think of anything important I do on my work machine that would need it. Maybe a days worth of code edits that haven&#x27;t been pushed to GitHub.</div><br/><div id="35912303" class="c"><input type="checkbox" id="c-35912303" checked=""/><div class="controls bullet"><span class="by">snapplebobapple</span><span>|</span><a href="#35908170">root</a><span>|</span><a href="#35911671">parent</a><span>|</span><a href="#35912541">next</a><span>|</span><label class="collapse" for="c-35912303">[-]</label><label class="expand" for="c-35912303">[1 more]</label></div><br/><div class="children"><div class="content">If its windows and you use weird certs for external interaction like most power pools do, its pretty important, especially thw solutions that spin up a vm in the cloud foe you quickly.</div><br/></div></div></div></div></div></div></div></div><div id="35912541" class="c"><input type="checkbox" id="c-35912541" checked=""/><div class="controls bullet"><span class="by">yellow_lead</span><span>|</span><a href="#35908170">parent</a><span>|</span><a href="#35910284">prev</a><span>|</span><a href="#35908892">next</a><span>|</span><label class="collapse" for="c-35912541">[-]</label><label class="expand" for="c-35912541">[2 more]</label></div><br/><div class="children"><div class="content">This project was mentioned recently here - it does this locally, saving to sqlite.<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35839470" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35839470</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;ellie&#x2F;atuin">https:&#x2F;&#x2F;github.com&#x2F;ellie&#x2F;atuin</a></div><br/><div id="35912799" class="c"><input type="checkbox" id="c-35912799" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#35908170">root</a><span>|</span><a href="#35912541">parent</a><span>|</span><a href="#35908892">next</a><span>|</span><label class="collapse" for="c-35912799">[-]</label><label class="expand" for="c-35912799">[1 more]</label></div><br/><div class="children"><div class="content">And it looked amazing, until another user pointed out that if you install it, whitespace-prefixed commands will start being saved in your bash history, and they refuse to document this behaviour</div><br/></div></div></div></div><div id="35908892" class="c"><input type="checkbox" id="c-35908892" checked=""/><div class="controls bullet"><span class="by">chrisshroba</span><span>|</span><a href="#35908170">parent</a><span>|</span><a href="#35912541">prev</a><span>|</span><a href="#35908982">next</a><span>|</span><label class="collapse" for="c-35908892">[-]</label><label class="expand" for="c-35908892">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve thought about this too - if you use tmux, you can use `tmux capture-pane` to grab all the output and scrollback in the current window.</div><br/></div></div></div></div><div id="35909498" class="c"><input type="checkbox" id="c-35909498" checked=""/><div class="controls bullet"><span class="by">pelagicAustral</span><span>|</span><a href="#35908170">prev</a><span>|</span><a href="#35908174">next</a><span>|</span><label class="collapse" for="c-35909498">[-]</label><label class="expand" for="c-35909498">[5 more]</label></div><br/><div class="children"><div class="content">Maybe slightly off-topic, but does anybody here know how to record an(or any) SSH session(s)? On a debian server, for example?<p>I remember seeing someone do a demo on this but the result, after only 2 minutes where insane. There was so much data to go through that you might aswell just give up on trying to get anything useful.</div><br/><div id="35912269" class="c"><input type="checkbox" id="c-35912269" checked=""/><div class="controls bullet"><span class="by">zachn</span><span>|</span><a href="#35909498">parent</a><span>|</span><a href="#35909839">next</a><span>|</span><label class="collapse" for="c-35912269">[-]</label><label class="expand" for="c-35912269">[1 more]</label></div><br/><div class="children"><div class="content">I wrote an eBPF application that is launched and killed by a PAM session script. It uses the PPID to only record commands and arguments associated with that session. My application was heavily influenced by execsnoop:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;execsnoop.py">https:&#x2F;&#x2F;github.com&#x2F;iovisor&#x2F;bcc&#x2F;blob&#x2F;master&#x2F;tools&#x2F;execsnoop.p...</a></div><br/></div></div><div id="35909839" class="c"><input type="checkbox" id="c-35909839" checked=""/><div class="controls bullet"><span class="by">anonacct37</span><span>|</span><a href="#35909498">parent</a><span>|</span><a href="#35912269">prev</a><span>|</span><a href="#35910298">next</a><span>|</span><label class="collapse" for="c-35909839">[-]</label><label class="expand" for="c-35909839">[1 more]</label></div><br/><div class="children"><div class="content">In the old days I played with something like this: <a href="https:&#x2F;&#x2F;github.com&#x2F;desaster&#x2F;kippo">https:&#x2F;&#x2F;github.com&#x2F;desaster&#x2F;kippo</a><p>But a more modern alternative seems to be the container based approach outlined here. <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;848291&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;848291&#x2F;</a></div><br/></div></div><div id="35910298" class="c"><input type="checkbox" id="c-35910298" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#35909498">parent</a><span>|</span><a href="#35909839">prev</a><span>|</span><a href="#35912641">next</a><span>|</span><label class="collapse" for="c-35910298">[-]</label><label class="expand" for="c-35910298">[1 more]</label></div><br/><div class="children"><div class="content">PuTTY has very expensive logging options ranging from visible output only to full control codes and even packets.<p>I always assumed OpenSSH offers this too but I&#x27;ve never had a need to actually check. I guess you can just &#x27;tee&#x27; it anyway.</div><br/></div></div><div id="35912641" class="c"><input type="checkbox" id="c-35912641" checked=""/><div class="controls bullet"><span class="by">sph</span><span>|</span><a href="#35909498">parent</a><span>|</span><a href="#35910298">prev</a><span>|</span><a href="#35908174">next</a><span>|</span><label class="collapse" for="c-35912641">[-]</label><label class="expand" for="c-35912641">[1 more]</label></div><br/><div class="children"><div class="content">The `script` command is available and pre installed on most Linux distros.</div><br/></div></div></div></div><div id="35910392" class="c"><input type="checkbox" id="c-35910392" checked=""/><div class="controls bullet"><span class="by">jgalt212</span><span>|</span><a href="#35907899">prev</a><span>|</span><a href="#35908683">next</a><span>|</span><label class="collapse" for="c-35910392">[-]</label><label class="expand" for="c-35910392">[1 more]</label></div><br/><div class="children"><div class="content">This seems pretty nice, but having too many logs is yet another attack surface.</div><br/></div></div></div></div></div></div></div></body></html>