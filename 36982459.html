<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1691139660200" as="style"/><link rel="stylesheet" href="styles.css?v=1691139660200"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.jviotti.com/2022/05/05/debugging-the-cxx-standard-library-on-macos.html">Debugging the C++ standard library on macOS (2022)</a> <span class="domain">(<a href="https://www.jviotti.com">www.jviotti.com</a>)</span></div><div class="subtext"><span>japrozs</span> | <span>11 comments</span></div><br/><div><div id="36992768" class="c"><input type="checkbox" id="c-36992768" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#36992667">next</a><span>|</span><label class="collapse" for="c-36992768">[-]</label><label class="expand" for="c-36992768">[2 more]</label></div><br/><div class="children"><div class="content">I love that the author dives right in to learn C++ and I endorse their enthusiasm.<p>However I am not sure reading the standard library sources is a great way to learn early on.  Those sources have a lot of speciality code, and weird head-standing in order to handle various obscure corner cases, different architectures and the like.  And it’s so great they do!<p>When you’re still learning C++ all  that extra care will probably add to the learner’s confusion rather than reduce it.<p>And in fact, very few people need to write code like that.  When they do, they will often resort to obscure corners of the C++ standard which were added for library writers (hence the common response to a new standard, “why did the committee waste time on an obscure feature like that?”).<p>Also these libraries typically rely on compiler-specific features that may not even be documented.<p>I don’t mean to discourage anyone from reading the library sources!  But perhaps they are not the best place to start.</div><br/><div id="36995191" class="c"><input type="checkbox" id="c-36995191" checked=""/><div class="controls bullet"><span class="by">jbandela1</span><span>|</span><a href="#36992768">parent</a><span>|</span><a href="#36992667">next</a><span>|</span><label class="collapse" for="c-36995191">[-]</label><label class="expand" for="c-36995191">[1 more]</label></div><br/><div class="children"><div class="content">The standard library may not be the best way to learn C++ for several reasons.<p>1. The standard library is allowed to do things that you are not allowed to do. Because the standard library goes hand in hand with the compiler, it can take advantage of extensions or implementation defined behavior or even what is undefined behavior in the standard.<p>2. Because it has to be as resilient as possible despite people using macros and naming things, the standard library uses double underscores &quot;__&quot; a lot to name variables. That is not something you should do because those are reserved for the standard library implementer<p>3. Because the behavior of classes and functions is specified precisely by the standards documents, there is often less commenting that would be normal<p>4. Because of backwards compatibility, the standard implementation of certain things can be sub-optimal. For example, std::regex is slower than non-standard implementations and may have security issues with untrusted input. Another example is the hash containers unordered_map. The standard kind of forces you into a certain implementation, where others can be much better. The Abseil flat_hash_map containers can be much more efficient than std::unordered_map<p>This all is not to say the standard library doesn&#x27;t contain a wealth of information. It does. However, you may need more C++ experience before you can figure out what is a good technique for you to use in your own code, what is suboptimal for you to use, and what is dangerous for you to use in your own code.<p>If you want a kind of project that is along these lines, I would recommend the following.<p>1. Implement std::string (but use a different namespace). This will teach you about memory management, constructors, destructors, STL containers and algorithms.<p>1a. Implement the small string optimization for your class. Make sure you avoid undefined behavior. This will teach you about unions and type punning rules and when you are allowed to cast pointers in C++ without running into undefined behavior and type alias rules.<p>2. Implement std::tuple. This will teach you a lot of meta-programming techniques.<p>3. Implement a multi-threaded queue with push and pop. This will teach you about mutexes and condition variables.<p>3a. Make it lock free. This will teach you about atomics.</div><br/></div></div></div></div><div id="36992667" class="c"><input type="checkbox" id="c-36992667" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#36992768">prev</a><span>|</span><a href="#36993404">next</a><span>|</span><label class="collapse" for="c-36992667">[-]</label><label class="expand" for="c-36992667">[3 more]</label></div><br/><div class="children"><div class="content">Of course, LLDB is more likely than not to be useless when debugging complex templated code from the standard library :(</div><br/><div id="36992698" class="c"><input type="checkbox" id="c-36992698" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#36992667">parent</a><span>|</span><a href="#36993404">next</a><span>|</span><label class="collapse" for="c-36992698">[-]</label><label class="expand" for="c-36992698">[2 more]</label></div><br/><div class="children"><div class="content">what is the constructive part of this comment?  the debugger does what it is designed to do, and this author shows a clear example of setting it up?<p>kudos to the clarity of this simple effort in the &quot;tangled forests&quot; that are Modern C++</div><br/><div id="36996805" class="c"><input type="checkbox" id="c-36996805" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#36992667">root</a><span>|</span><a href="#36992698">parent</a><span>|</span><a href="#36993404">next</a><span>|</span><label class="collapse" for="c-36996805">[-]</label><label class="expand" for="c-36996805">[1 more]</label></div><br/><div class="children"><div class="content">I guess it&#x27;s a warning to people who try to do this and find that the debugging experience may not be what they expected it to be. Nothing against the author, of course.</div><br/></div></div></div></div></div></div><div id="36993404" class="c"><input type="checkbox" id="c-36993404" checked=""/><div class="controls bullet"><span class="by">chrisjj</span><span>|</span><a href="#36992667">prev</a><span>|</span><label class="collapse" for="c-36993404">[-]</label><label class="expand" for="c-36993404">[5 more]</label></div><br/><div class="children"><div class="content">&gt; Debugging the C++ standard library on macOS<p>Some mistake. The article contains nothing on this subject.</div><br/><div id="36993965" class="c"><input type="checkbox" id="c-36993965" checked=""/><div class="controls bullet"><span class="by">bastawhiz</span><span>|</span><a href="#36993404">parent</a><span>|</span><a href="#36995593">next</a><span>|</span><label class="collapse" for="c-36993965">[-]</label><label class="expand" for="c-36993965">[2 more]</label></div><br/><div class="children"><div class="content">What part of this isn&#x27;t about debugging the C++ stdlib on macOS? It talks about the special version of clang in Xcode. It has macOS-specific options. It gets into the details of doing this with Mach-O files. Almost no parts of this post <i>isn&#x27;t</i> about the c++ stdlib and essentially all of it is specific to macOS.</div><br/><div id="36996586" class="c"><input type="checkbox" id="c-36996586" checked=""/><div class="controls bullet"><span class="by">pipo234</span><span>|</span><a href="#36993404">root</a><span>|</span><a href="#36993965">parent</a><span>|</span><a href="#36995593">next</a><span>|</span><label class="collapse" for="c-36996586">[-]</label><label class="expand" for="c-36996586">[1 more]</label></div><br/><div class="children"><div class="content">I guess what chrisjj might have meant is that &quot;debugging&quot; usually starts with a bug, a or symptom. So in case of debugging the standard library, it usually is a problem in your <i>own</i> code that you cannot explain and try to blame on an error of the subsystem. In those cases, having access to a source-level debugger can be useful but in my experience this the subsystem is usually not where you&#x27;ll find the error; more often it&#x27;s in your own code.<p>So in case of this article, ask: <i>what is the symptom of an alleged bug in the standard library that the author is trying to uncover?</i><p>This article is more about using the online debugger to explore parts of the standard library. Which is interesting, but as others have pointed out probably not the best way to familiarize yourself with a language or library.</div><br/></div></div></div></div><div id="36995593" class="c"><input type="checkbox" id="c-36995593" checked=""/><div class="controls bullet"><span class="by">TheRealSteel</span><span>|</span><a href="#36993404">parent</a><span>|</span><a href="#36993965">prev</a><span>|</span><a href="#36994265">next</a><span>|</span><label class="collapse" for="c-36995593">[-]</label><label class="expand" for="c-36995593">[1 more]</label></div><br/><div class="children"><div class="content">What is it about, then?</div><br/></div></div><div id="36994265" class="c"><input type="checkbox" id="c-36994265" checked=""/><div class="controls bullet"><span class="by">vore</span><span>|</span><a href="#36993404">parent</a><span>|</span><a href="#36995593">prev</a><span>|</span><label class="collapse" for="c-36994265">[-]</label><label class="expand" for="c-36994265">[1 more]</label></div><br/><div class="children"><div class="content">I know Hacker News guidelines say you&#x27;re not supposed to ask if someone&#x27;s read the article but... did you even read the article? What part of the article is <i>not</i> about C++ and macOS?</div><br/></div></div></div></div></div></div></div></div></div></body></html>