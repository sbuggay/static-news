<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1706346051645" as="style"/><link rel="stylesheet" href="styles.css?v=1706346051645"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://ret2pop.nullring.xyz/blog/stem.html">Stem, a stack-based language with metaprogramming and a C FLI</a> <span class="domain">(<a href="https://ret2pop.nullring.xyz">ret2pop.nullring.xyz</a>)</span></div><div class="subtext"><span>GalaxyNova</span> | <span>32 comments</span></div><br/><div><div id="39152666" class="c"><input type="checkbox" id="c-39152666" checked=""/><div class="controls bullet"><span class="by">spindle</span><span>|</span><a href="#39152799">next</a><span>|</span><label class="collapse" for="c-39152666">[-]</label><label class="expand" for="c-39152666">[1 more]</label></div><br/><div class="children"><div class="content">Some other stack languages (not all of these  concatenative languages use a single stack but most of them do):<p><a href="https:&#x2F;&#x2F;concatenative.org&#x2F;wiki&#x2F;view&#x2F;Concatenative%20language" rel="nofollow">https:&#x2F;&#x2F;concatenative.org&#x2F;wiki&#x2F;view&#x2F;Concatenative%20language</a></div><br/></div></div><div id="39152799" class="c"><input type="checkbox" id="c-39152799" checked=""/><div class="controls bullet"><span class="by">transfire</span><span>|</span><a href="#39152666">prev</a><span>|</span><a href="#39151106">next</a><span>|</span><label class="collapse" for="c-39152799">[-]</label><label class="expand" for="c-39152799">[4 more]</label></div><br/><div class="children"><div class="content">A similar language that’s been worked on for a while now is [Min](<a href="https:&#x2F;&#x2F;min-lang.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;min-lang.org&#x2F;</a>). Interestingly it is written in Nim.<p>I was interested in the C interface part but it never got there. :(</div><br/><div id="39153524" class="c"><input type="checkbox" id="c-39153524" checked=""/><div class="controls bullet"><span class="by">h3rald</span><span>|</span><a href="#39152799">parent</a><span>|</span><a href="#39152870">next</a><span>|</span><label class="collapse" for="c-39153524">[-]</label><label class="expand" for="c-39153524">[1 more]</label></div><br/><div class="children"><div class="content">min creator here :)<p>min does not have a C FLI essentially because it has a &quot;Nim FLI&quot;. It is really easy to add new symbols to the language using a Nim API (which is also used internally to define all symbols of the language).<p>See <a href="https:&#x2F;&#x2F;min-lang.org&#x2F;learn-extending&#x2F;" rel="nofollow">https:&#x2F;&#x2F;min-lang.org&#x2F;learn-extending&#x2F;</a> for more info. Maybe I should generate some Nim docs for the public API though... but it&#x27;s really easy to use, and you can check the lib folder of the repo for examples: <a href="https:&#x2F;&#x2F;github.com&#x2F;h3rald&#x2F;min&#x2F;tree&#x2F;master&#x2F;minpkg&#x2F;lib">https:&#x2F;&#x2F;github.com&#x2F;h3rald&#x2F;min&#x2F;tree&#x2F;master&#x2F;minpkg&#x2F;lib</a></div><br/></div></div><div id="39152870" class="c"><input type="checkbox" id="c-39152870" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39152799">parent</a><span>|</span><a href="#39153524">prev</a><span>|</span><a href="#39152816">next</a><span>|</span><label class="collapse" for="c-39152870">[-]</label><label class="expand" for="c-39152870">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve updated the blog to include a short explanation of it.</div><br/></div></div><div id="39152816" class="c"><input type="checkbox" id="c-39152816" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39152799">parent</a><span>|</span><a href="#39152870">prev</a><span>|</span><a href="#39151106">next</a><span>|</span><label class="collapse" for="c-39152816">[-]</label><label class="expand" for="c-39152816">[1 more]</label></div><br/><div class="children"><div class="content">Writing that part right now</div><br/></div></div></div></div><div id="39151106" class="c"><input type="checkbox" id="c-39151106" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39152799">prev</a><span>|</span><a href="#39152472">next</a><span>|</span><label class="collapse" for="c-39151106">[-]</label><label class="expand" for="c-39151106">[16 more]</label></div><br/><div class="children"><div class="content">really cool project! (I am definitely not the person who made this)</div><br/><div id="39151386" class="c"><input type="checkbox" id="c-39151386" checked=""/><div class="controls bullet"><span class="by">SrslyJosh</span><span>|</span><a href="#39151106">parent</a><span>|</span><a href="#39152472">next</a><span>|</span><label class="collapse" for="c-39151386">[-]</label><label class="expand" for="c-39151386">[15 more]</label></div><br/><div class="children"><div class="content">This seems like a great introduction to stack-based languages!<p>I&#x27;m curious, why did you undertake the project? What are your goals for it, or what problems do you intend for it to solve?<p>I&#x27;m going to include a bit from the README here, which describes some of the functionality&#x2F;design but not the <i>why</i> behind the language:<p>&gt; Stem aims to be a minimal interpreted stack based programming language that allows for metaprogramming and a foreign language interface. It features a C API that is elegant and simple. Additionally, garbage collection is not needed in this language as the responsibility of writing memory safe operations is put in the hands of the maintainers of the builtin functions and FLI library maintainers. Therefore, the end user does not need to worry about memory allocation while the implementation remains extremely simple.<p>Ref: <a href="https:&#x2F;&#x2F;github.com&#x2F;ret2pop&#x2F;stem">https:&#x2F;&#x2F;github.com&#x2F;ret2pop&#x2F;stem</a></div><br/><div id="39151473" class="c"><input type="checkbox" id="c-39151473" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39151386">parent</a><span>|</span><a href="#39152779">next</a><span>|</span><label class="collapse" for="c-39151473">[-]</label><label class="expand" for="c-39151473">[10 more]</label></div><br/><div class="children"><div class="content">I decided to undertake the project after my friend Matthew Hinton introduced me to stack based programming -- he claimed that they were elegant because they allowed for both easy metaprogramming and side effects, to which I agreed after writing a little bit of my own language. It was really easy to implement, too -- most of it took only one day, and getting the basic functionality working took only 2-3 days.<p>Goals -- I eventually want to write an emacs-like text editor in stem by writing a C library that does bindings for ncurses. I think it would be fun, for one, and I think it would not be that hard of an end product to make. I also had plans of writing a stem compiler, and I already pretty much know how to do that, but there are a couple of difficulties in doing that. Namely, right now, there is no way of telling the difference between compile-time and runtime operations, which will slow the language down considerably. My solution to this currently is basically &quot;interpret once, run binary forever&quot;, but the details are still need to be worked out.<p>Problems it solves -- to be honest, you can really do anything in any programming language, but this langauge aims to be a higher level rendition of stack based programming languages, mostly for scripting and creating abstract representations of things.<p>Note that I am still trying to write in a couple things, namely, an actual include statement as a builtin that reads from some predetermined standard include directory, and an OOP implementation using metaprogramming in the standard library.<p>Not to mention the fact that I have been really interested in writing programming languages since I was in high school. One interesting thing about stack based languages is that the AST need not be generated at all. I taught myself a lot of linguistics, specifically generative grammar, as a result of attempting writing various programming languages in the past, and so these types of projects are just interesting to me.<p>If you ARE looking for one unique thing about this language, though, it is that `def`, the method by which you define functions, is itself a word. I don&#x27;t think a lot of stack based languages do this (because it is much harder to compile languages like this as mentioned above), but it offers much more internal consistency within the language as a result.</div><br/><div id="39152821" class="c"><input type="checkbox" id="c-39152821" checked=""/><div class="controls bullet"><span class="by">lebuffon</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39151473">parent</a><span>|</span><a href="#39152783">next</a><span>|</span><label class="collapse" for="c-39152821">[-]</label><label class="expand" for="c-39152821">[2 more]</label></div><br/><div class="children"><div class="content">Very neat. You have tried to make a very orthogonal language from what I can see.
One of the critiques of Forth is that it is postfix at runtime but typically prefix for compiling stuff. Your use of an unassigned text label being the default to which things can be attached with def is a nice solution.<p>How would say the language performs at runtime vs other REPL languages. 
Is it compiling to native code behind the curtain or is there a VM back there?</div><br/><div id="39152917" class="c"><input type="checkbox" id="c-39152917" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152821">parent</a><span>|</span><a href="#39152783">next</a><span>|</span><label class="collapse" for="c-39152917">[-]</label><label class="expand" for="c-39152917">[1 more]</label></div><br/><div class="children"><div class="content">Intepreted... right now. There isn&#x27;t a vm currently, but I&#x27;m planning to do native compilation pretty soon, as I already have an idea of how I would go about doing it.</div><br/></div></div></div></div><div id="39152783" class="c"><input type="checkbox" id="c-39152783" checked=""/><div class="controls bullet"><span class="by">transfire</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39151473">parent</a><span>|</span><a href="#39152821">prev</a><span>|</span><a href="#39152779">next</a><span>|</span><label class="collapse" for="c-39152783">[-]</label><label class="expand" for="c-39152783">[7 more]</label></div><br/><div class="children"><div class="content">&gt; `def` … is itself a word.<p>But of course, that is the way of the Forth.<p>Hmmm… Have a look at JonesForth. I think it might be very rewarding for you.</div><br/><div id="39152810" class="c"><input type="checkbox" id="c-39152810" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152783">parent</a><span>|</span><a href="#39152779">next</a><span>|</span><label class="collapse" for="c-39152810">[-]</label><label class="expand" for="c-39152810">[6 more]</label></div><br/><div class="children"><div class="content">correct me if I am wrong, but from my knowledge concatenative programming often assumes a different syntax for defining words. Usually it looks something like : add a b + ; if I am not mistaken.</div><br/><div id="39152837" class="c"><input type="checkbox" id="c-39152837" checked=""/><div class="controls bullet"><span class="by">klyrs</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152810">parent</a><span>|</span><a href="#39152841">next</a><span>|</span><label class="collapse" for="c-39152837">[-]</label><label class="expand" for="c-39152837">[3 more]</label></div><br/><div class="children"><div class="content">That isn&#x27;t syntax.  : is a word, and so is ;<p>Cool article posted to HN a little while back: <a href="http:&#x2F;&#x2F;ratfactor.com&#x2F;forth&#x2F;the_programming_language_that_writes_itself.html" rel="nofollow">http:&#x2F;&#x2F;ratfactor.com&#x2F;forth&#x2F;the_programming_language_that_wri...</a></div><br/><div id="39152908" class="c"><input type="checkbox" id="c-39152908" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152837">parent</a><span>|</span><a href="#39152841">next</a><span>|</span><label class="collapse" for="c-39152908">[-]</label><label class="expand" for="c-39152908">[2 more]</label></div><br/><div class="children"><div class="content">I was not aware of this, thanks for giving me an explanation. I don&#x27;t have any experience writing in forth, my friend described this type of language to me and I implemented it.</div><br/><div id="39153447" class="c"><input type="checkbox" id="c-39153447" checked=""/><div class="controls bullet"><span class="by">klyrs</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152908">parent</a><span>|</span><a href="#39152841">next</a><span>|</span><label class="collapse" for="c-39153447">[-]</label><label class="expand" for="c-39153447">[1 more]</label></div><br/><div class="children"><div class="content">Your language is really neat, thanks for putting it out there</div><br/></div></div></div></div></div></div><div id="39152841" class="c"><input type="checkbox" id="c-39152841" checked=""/><div class="controls bullet"><span class="by">lebuffon</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152810">parent</a><span>|</span><a href="#39152837">prev</a><span>|</span><a href="#39152779">next</a><span>|</span><label class="collapse" for="c-39152841">[-]</label><label class="expand" for="c-39152841">[2 more]</label></div><br/><div class="children"><div class="content">You are correct, but in Forth for example, the colon is a word in the dictionary of words and so is semi-colon. They just happen to parse the input stream rather than taking arguments off the stack. Everything in Forth is called a &quot;word&quot;.<p>So depending who your lawyer is,  : and ;  are &quot;words&quot;. :=)</div><br/><div id="39152904" class="c"><input type="checkbox" id="c-39152904" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152841">parent</a><span>|</span><a href="#39152779">next</a><span>|</span><label class="collapse" for="c-39152904">[-]</label><label class="expand" for="c-39152904">[1 more]</label></div><br/><div class="children"><div class="content">I am not generally knowledgeable about Forth and languages like it because the only experience I have writing in anything close to forth is in my own language. Thanks for explaining.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39152779" class="c"><input type="checkbox" id="c-39152779" checked=""/><div class="controls bullet"><span class="by">FwarkALark</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39151386">parent</a><span>|</span><a href="#39151473">prev</a><span>|</span><a href="#39151446">next</a><span>|</span><label class="collapse" for="c-39152779">[-]</label><label class="expand" for="c-39152779">[3 more]</label></div><br/><div class="children"><div class="content">&gt; This seems like a great introduction to stack-based languages!<p>Do you know of a language which is not based on stacks?</div><br/><div id="39152890" class="c"><input type="checkbox" id="c-39152890" checked=""/><div class="controls bullet"><span class="by">throwaway17_17</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152779">parent</a><span>|</span><a href="#39152995">next</a><span>|</span><label class="collapse" for="c-39152890">[-]</label><label class="expand" for="c-39152890">[1 more]</label></div><br/><div class="children"><div class="content">In this case, ‘stack-based language’ is used as a term of art. In particular, in programming language discourse the typical meaning of ‘stack-based’ is a language which there’s a stack threaded through successive procedure calls, where access to the values on that stack are accessed by popping them off and computing with them, then returning a result via a push. The stack is implicit and there are often no mechanisms to name values or to name particular locations on the stack, requiring all procedures to explicitly shuffle, rotate, pop, and push the stack to access data for computation.<p>I would say that languages where values are assigned a ‘name’ in the program text are not ‘stack-based’ in the manner implied by the term. So while C and nearly all other programming language have a stack data structure allocated as storage for values used in procedures&#x2F;functions, they are not ‘stack-based’.</div><br/></div></div><div id="39152995" class="c"><input type="checkbox" id="c-39152995" checked=""/><div class="controls bullet"><span class="by">rurban</span><span>|</span><a href="#39151106">root</a><span>|</span><a href="#39152779">parent</a><span>|</span><a href="#39152890">prev</a><span>|</span><a href="#39151446">next</a><span>|</span><label class="collapse" for="c-39152995">[-]</label><label class="expand" for="c-39152995">[1 more]</label></div><br/><div class="children"><div class="content">Fortran. Stacks were introduced to allow recursion.</div><br/></div></div></div></div></div></div></div></div><div id="39152472" class="c"><input type="checkbox" id="c-39152472" checked=""/><div class="controls bullet"><span class="by">msla</span><span>|</span><a href="#39151106">prev</a><span>|</span><a href="#39151510">next</a><span>|</span><label class="collapse" for="c-39152472">[-]</label><label class="expand" for="c-39152472">[2 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the difference between an FLI and an FFI?</div><br/><div id="39152501" class="c"><input type="checkbox" id="c-39152501" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39152472">parent</a><span>|</span><a href="#39151510">next</a><span>|</span><label class="collapse" for="c-39152501">[-]</label><label class="expand" for="c-39152501">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m kind of just using words. You can call it whatever you want, I just used words that my friends also used to describe what I wrote. Really, loading custom libraries from C is really easy but I decided to advertise that part of the project anyway.</div><br/></div></div></div></div><div id="39151510" class="c"><input type="checkbox" id="c-39151510" checked=""/><div class="controls bullet"><span class="by">brezelgoring</span><span>|</span><a href="#39152472">prev</a><span>|</span><a href="#39152775">next</a><span>|</span><label class="collapse" for="c-39151510">[-]</label><label class="expand" for="c-39151510">[3 more]</label></div><br/><div class="children"><div class="content">I have no comments on the project itself, which I’m sure is very nice. 
If you’re taking suggestions, the mobile web view unfortunately captures 75% of the viewport on the side menu, it’d be nice if it were collapsible or flexible.<p>Keep on keeping on!</div><br/><div id="39152036" class="c"><input type="checkbox" id="c-39152036" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39151510">parent</a><span>|</span><a href="#39151642">next</a><span>|</span><label class="collapse" for="c-39152036">[-]</label><label class="expand" for="c-39152036">[1 more]</label></div><br/><div class="children"><div class="content">Yes. I have realized this. I added a meta tag to the website recently, I don&#x27;t know if that solves the problem. I don&#x27;t know much about css really.<p>Edit: temporary fix of simply hiding the sidebar. lol.</div><br/></div></div></div></div><div id="39152775" class="c"><input type="checkbox" id="c-39152775" checked=""/><div class="controls bullet"><span class="by">FwarkALark</span><span>|</span><a href="#39151510">prev</a><span>|</span><label class="collapse" for="c-39152775">[-]</label><label class="expand" for="c-39152775">[5 more]</label></div><br/><div class="children"><div class="content">Is there a language which is not stack-based? I imagine &quot;concatenative&quot; would be mildly more precise of a description.<p>Coroutines (which often carry their own stacks) can sort-of dodge stacks—effectively utilizing a sort of bespoke linear typing to avoid this—but I don&#x27;t know of a language which doesn&#x27;t have c-like, stack-based procedures or subroutines, which places arguments on the stack and registers and operates mostly with respect to that stack and foreign API calls.<p>A stack is certainly the most intuitive data-structure with which to implement a lambda calculus.<p>Really, what Forth and descendent languages seem to emphasize is a sort of a data-oriented execution rather than a symbol-oriented execution—C very much encourages you to name types, function signatures, etc, and the result if you don&#x27;t is extremely difficult to parse and interpret manually, even if you can implement forth as a subset of C.<p>Forth emphasizes reasoning about the stack directly as data, seemingly forgoing any assistance outside of syntax. Arguably it forgoes the utility of syntax, too.</div><br/><div id="39153835" class="c"><input type="checkbox" id="c-39153835" checked=""/><div class="controls bullet"><span class="by">jkafjanvnfaf</span><span>|</span><a href="#39152775">parent</a><span>|</span><a href="#39152832">next</a><span>|</span><label class="collapse" for="c-39153835">[-]</label><label class="expand" for="c-39153835">[1 more]</label></div><br/><div class="children"><div class="content">For completeness, there are languages that do not require stacks to implement (nor any workarounds that in practice emulate a stack). If you do not support explicit recursion, you don&#x27;t need one. All variables can be statically allocated and only a single return address needs to be stored for each function, so you do not need a stack for return addresses either.<p>The most famous example is FORTRAN, until 1990 when they added RECURSIVE directive.</div><br/></div></div><div id="39152832" class="c"><input type="checkbox" id="c-39152832" checked=""/><div class="controls bullet"><span class="by">pizza</span><span>|</span><a href="#39152775">parent</a><span>|</span><a href="#39153835">prev</a><span>|</span><a href="#39152795">next</a><span>|</span><label class="collapse" for="c-39152832">[-]</label><label class="expand" for="c-39152832">[1 more]</label></div><br/><div class="children"><div class="content">True, it&#x27;s a convenient structure, but the Church–Rosser theorem says that the order of beta reduction of terms in the lambda calculus doesn&#x27;t matter, so a call stack pattern isn&#x27;t essential.</div><br/></div></div><div id="39152795" class="c"><input type="checkbox" id="c-39152795" checked=""/><div class="controls bullet"><span class="by">ret2pop</span><span>|</span><a href="#39152775">parent</a><span>|</span><a href="#39152832">prev</a><span>|</span><a href="#39152938">next</a><span>|</span><label class="collapse" for="c-39152795">[-]</label><label class="expand" for="c-39152795">[1 more]</label></div><br/><div class="children"><div class="content">Yes, you are correct. My friend made this post so I didn&#x27;t have control over the exact wording. That being said, in concatenative programming, the stack is public and, in my case, is virtual.</div><br/></div></div></div></div></div></div></div></div></div></body></html>