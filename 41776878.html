<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728464455038" as="style"/><link rel="stylesheet" href="styles.css?v=1728464455038"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.eriksen.com.br/en/introducing-kotlin-money">Show HN: Kotlin Money</a> <span class="domain">(<a href="https://blog.eriksen.com.br">blog.eriksen.com.br</a>)</span></div><div class="subtext"><span>eriksencosta</span> | <span>137 comments</span></div><br/><div><div id="41777532" class="c"><input type="checkbox" id="c-41777532" checked=""/><div class="controls bullet"><span class="by">occz</span><span>|</span><a href="#41777737">next</a><span>|</span><label class="collapse" for="c-41777532">[-]</label><label class="expand" for="c-41777532">[20 more]</label></div><br/><div class="children"><div class="content">Cool stuff!<p>The use of infix functions reads a bit weird to me.<p>If I were to design an API like this in Kotlin, I think I would have gone for regular extensions for many cases and perhaps extension properties, think as such:<p><pre><code>    val fiveBucks = 5.usd
    val fiveBucks = 5.money(&quot;USD&quot;)
    val tenPercent = 10.percent
</code></pre>
How come you went for &quot;increaseBy&quot; and &quot;decreaseBy&quot; instead of overloading `plus` and `minus`? Just curious, preference is a valid answer.</div><br/><div id="41778555" class="c"><input type="checkbox" id="c-41778555" checked=""/><div class="controls bullet"><span class="by">sigh_again</span><span>|</span><a href="#41777532">parent</a><span>|</span><a href="#41778015">next</a><span>|</span><label class="collapse" for="c-41778555">[-]</label><label class="expand" for="c-41778555">[1 more]</label></div><br/><div class="children"><div class="content">Nothing is preventing you from using it this way ? Infix functions are just syntactic sugar, some prefer it, some don&#x27;t, but there&#x27;s zero downsides to it (aside from your coworkers abusing it.) 5 money &quot;USD&quot; is literally the exact same thing as 5.money(&quot;USD&quot;), and Int.usd = this.money(&quot;USD&quot;)<p>+ and - are already overloaded (see val subtotal = price + shipping), increase&#x2F;decreaseBy are for operating over percentages (and could be written as subtotal * (1 - discount), which is much less clear). As the other comment say, it has an actual, real life meaning that people understand clearly. Your price increased by 10 percent. the <i>By convention is also already present in the Kotlin stdlib, although it&#x27;s more for grouping operations, numeric operations are taking the </i>Of suffix now (sumBy has been deprecated in favor of sumOf, increaseBy could become increaseOf without any loss of clarity)</div><br/></div></div><div id="41778015" class="c"><input type="checkbox" id="c-41778015" checked=""/><div class="controls bullet"><span class="by">nwatson</span><span>|</span><a href="#41777532">parent</a><span>|</span><a href="#41778555">prev</a><span>|</span><a href="#41782177">next</a><span>|</span><label class="collapse" for="c-41778015">[-]</label><label class="expand" for="c-41778015">[1 more]</label></div><br/><div class="children"><div class="content">`decreaseBy` is a multiplication and subtraction combined, map naturally to commerce domain, and is more complex than plain addition &#x2F; subtraction.</div><br/></div></div><div id="41782177" class="c"><input type="checkbox" id="c-41782177" checked=""/><div class="controls bullet"><span class="by">gus_massa</span><span>|</span><a href="#41777532">parent</a><span>|</span><a href="#41778015">prev</a><span>|</span><a href="#41778780">next</a><span>|</span><label class="collapse" for="c-41782177">[-]</label><label class="expand" for="c-41782177">[6 more]</label></div><br/><div class="children"><div class="content">&gt; <i>overloading `plus` and `minus`</i><p>Perhaps I&#x27;m misunderstanding your idea, but what about<p><pre><code>  val total = price + 10.percent * 2
</code></pre>
If the price is 10, then the total is 12 or 22?</div><br/><div id="41785469" class="c"><input type="checkbox" id="c-41785469" checked=""/><div class="controls bullet"><span class="by">occz</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41782177">parent</a><span>|</span><a href="#41782391">next</a><span>|</span><label class="collapse" for="c-41785469">[-]</label><label class="expand" for="c-41785469">[1 more]</label></div><br/><div class="children"><div class="content">I suppose that depends on how you implement `times` for the `Percent`-class. One way would be to say that 10% * 2 = 20%, making this expression evaluate to 12, in accordance with Kotlin operator precedence [1].<p>It&#x27;s possible to avoid making this decision altogether by not implementing `times` for `Percent`, making the user have to be more explicit about what they actually want to happen - for example, requiring them to add parenthesis to arrive at 22:<p><pre><code>    val total = (price + 10.percent) * 2
</code></pre>
Or to arrive at 11:<p><pre><code>    val total = price + (10 * 2).percent
</code></pre>
[1] <a href="https:&#x2F;&#x2F;kotlinlang.org&#x2F;docs&#x2F;reference&#x2F;grammar.html#expressions" rel="nofollow">https:&#x2F;&#x2F;kotlinlang.org&#x2F;docs&#x2F;reference&#x2F;grammar.html#expressio...</a></div><br/></div></div><div id="41782391" class="c"><input type="checkbox" id="c-41782391" checked=""/><div class="controls bullet"><span class="by">callmeal</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41782177">parent</a><span>|</span><a href="#41785469">prev</a><span>|</span><a href="#41778780">next</a><span>|</span><label class="collapse" for="c-41782391">[-]</label><label class="expand" for="c-41782391">[4 more]</label></div><br/><div class="children"><div class="content">&gt;val total = price + 10.percent * 2<p>If the price is 10, I would expect total to be 10,2.<p>(price + 10.percent) * 2 would be 22.<p>I don&#x27;t see any way to get 12.</div><br/><div id="41783652" class="c"><input type="checkbox" id="c-41783652" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41782391">parent</a><span>|</span><a href="#41782525">next</a><span>|</span><label class="collapse" for="c-41783652">[-]</label><label class="expand" for="c-41783652">[1 more]</label></div><br/><div class="children"><div class="content">How do you get 10.2?  I can only think of two (reasonable) ways to think about this:<p><pre><code>    (price + 10.percent) * 2 = (10 + 1) * 2 = 11 * 2 = 22
</code></pre>
and<p><pre><code>    price + (10.percent * 2) = 10 + 20.percent = 10 + 2 = 12
</code></pre>
Personally I would assume the latter, given standard operator precedence, where multiplication precedes addition.</div><br/></div></div><div id="41782525" class="c"><input type="checkbox" id="c-41782525" checked=""/><div class="controls bullet"><span class="by">ternaryoperator</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41782391">parent</a><span>|</span><a href="#41783652">prev</a><span>|</span><a href="#41778780">next</a><span>|</span><label class="collapse" for="c-41782525">[-]</label><label class="expand" for="c-41782525">[2 more]</label></div><br/><div class="children"><div class="content">price + (10.percent * 2) looks like 12: If 10.percent = 1, 1*2 = 2. 10 + 2 = 12.<p>Under the usual rules of operator precedence, that would be the expected answer (multiplication having higher precedence than addition).</div><br/><div id="41784169" class="c"><input type="checkbox" id="c-41784169" checked=""/><div class="controls bullet"><span class="by">bloated5048</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41782525">parent</a><span>|</span><a href="#41778780">next</a><span>|</span><label class="collapse" for="c-41784169">[-]</label><label class="expand" for="c-41784169">[1 more]</label></div><br/><div class="children"><div class="content">How does computer know it&#x27;s 10% of 10? Unless specified, 10% is 0.1
Or am I an idiot and missing something here</div><br/></div></div></div></div></div></div></div></div><div id="41778780" class="c"><input type="checkbox" id="c-41778780" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#41777532">parent</a><span>|</span><a href="#41782177">prev</a><span>|</span><a href="#41777737">next</a><span>|</span><label class="collapse" for="c-41778780">[-]</label><label class="expand" for="c-41778780">[11 more]</label></div><br/><div class="children"><div class="content">This does a better job of showing an uneasy feeling I have about Kotlin than anything I could say.<p>- The infix is weird and footgun-y.<p>- Extension methods on int&#x2F;double serving as constructors smells funny.<p>- Using infix operators as constructors but not using infix operators for addition&#x2F;subtraction smells funny.<p>In general, at least in a corporate environment switching off Java for Android, I found Kotlin a distracting step sideways.<p>Code reviews tended to involve a lot of bikeshedding over how to make it Kotlin-y, and there&#x27;s a sort of &quot;why not?&quot; approach to language features that creates much room for the bikeshedding.<p>It left me feeling like we were unconciously choosing to have the same arguments C++ programmers had in 1990, all over again. Except it was even more destructive, because those arguments were centered, and conflated with &quot;proper&quot; coding in  the fancy new language.<p>I&#x27;m not against new and shiny: I was the first to use Kotlin in the org., and I dove right into Swift. There&#x27;s something alarming with this transition.<p>I&#x27;m heartened by starting to see some debate in Android dev communities about whether Kotlin&#x2F;Compose were a bridge to nowhere that shouldn&#x27;t have been a focus for years.</div><br/><div id="41779524" class="c"><input type="checkbox" id="c-41779524" checked=""/><div class="controls bullet"><span class="by">mrcrumb1</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41778780">parent</a><span>|</span><a href="#41784229">next</a><span>|</span><label class="collapse" for="c-41779524">[-]</label><label class="expand" for="c-41779524">[2 more]</label></div><br/><div class="children"><div class="content">You can bikeshed in any language. Kotlin introduced a lot of optional syntactic sugar so that Java devs could choose their level of comfort with the language features. I don&#x27;t really see this as a problem unless your devs are prone to this sort of bikeshedding (see: your use of &quot;smells funny&quot;). I&#x27;ve used kotlin for Android since right before it was officially supported and there has been almost no downside other than the occasional hiccup with Java&#x2F;Kotlin nullability interop</div><br/><div id="41779728" class="c"><input type="checkbox" id="c-41779728" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41779524">parent</a><span>|</span><a href="#41784229">next</a><span>|</span><label class="collapse" for="c-41779728">[-]</label><label class="expand" for="c-41779728">[1 more]</label></div><br/><div class="children"><div class="content">Hear hear, agree whole heartedly.<p>Minor nit: bike shedding refers to, in the original, arguing about the color of the paint on the shed.<p>It follows that not all discussion is bike shedding.<p>In this instance, the references to C++ allude to a common best practice for programmers of avoiding custom operators, which goes far beyond an aesthetic, i.e.  style, i.e. color of paint on the bike shed difference. There are engineering consequences. This also applies across languages, I&#x27;m familiar with it only from trodding the same path you are, through Swift.<p>Bike shedding bike shedding is indeed possible, so I won&#x27;t suggest an umabiguous definition. :)<p>The bike shedding reference in OP  is to the different flavors, but equivalent, syntactic sugar that you mention. This uses the new shiny. But this creates toxic baggage, because among other things, because to a naive implementer, there is no solid engineering reason to e.g. avoid custom operators, it&#x27;s just a scarred C++ graybeard enforcing their opinion :)</div><br/></div></div></div></div><div id="41784229" class="c"><input type="checkbox" id="c-41784229" checked=""/><div class="controls bullet"><span class="by">ulrikrasmussen</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41778780">parent</a><span>|</span><a href="#41779524">prev</a><span>|</span><a href="#41779371">next</a><span>|</span><label class="collapse" for="c-41784229">[-]</label><label class="expand" for="c-41784229">[1 more]</label></div><br/><div class="children"><div class="content">I think that&#x27;s more an effect of the language being new to you, and the company coding culture not having developed around it yet, than a problem with the language. Kotlin has warts, sure, but we have been using it for seven years now, and while we did have some bikeshedding in the beginning, it is virtually absent from our code reviews now. The language didn&#x27;t change (well, it got even more features), but we did.</div><br/></div></div><div id="41779371" class="c"><input type="checkbox" id="c-41779371" checked=""/><div class="controls bullet"><span class="by">t-writescode</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41778780">parent</a><span>|</span><a href="#41784229">prev</a><span>|</span><a href="#41779654">next</a><span>|</span><label class="collapse" for="c-41779371">[-]</label><label class="expand" for="c-41779371">[3 more]</label></div><br/><div class="children"><div class="content">I have used Kotlin professionally for a couple-few years; and, in my experience, infix operations are a choice and you don&#x27;t have to use them. - in fact, I don&#x27;t think any bit of code in anything I&#x27;ve used uses infix operations, this is my first time seeing them in Kotlin in the wild.<p>For example, I haven&#x27;t used them even once.<p>That said, I, personally, have done almost no Android programming in Kotlin, so perhaps I&#x27;m missing the main environment where such things are done? For me, Kotlin has mostly been an aggressive amount of syntactic sugar to make Java a nice experience?<p>And most of the DSL-style code that I write uses function pointers as the last parameter, so I can do doTheThing(parameters) { anonymous function } and that&#x27;s about it?<p>I&#x27;m sorry that the organization you work with has aggressive bikeshedding. Perhaps this is something your organization, in general, could have a conversation about?</div><br/><div id="41780051" class="c"><input type="checkbox" id="c-41780051" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41779371">parent</a><span>|</span><a href="#41779654">next</a><span>|</span><label class="collapse" for="c-41780051">[-]</label><label class="expand" for="c-41780051">[2 more]</label></div><br/><div class="children"><div class="content">I agree, you nailed it. Operators are something that feels like using the new shiny but are repeating well-trodden mistakes that are well-understand in languages ranging in age from C++ to Swift.</div><br/><div id="41782883" class="c"><input type="checkbox" id="c-41782883" checked=""/><div class="controls bullet"><span class="by">t-writescode</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41780051">parent</a><span>|</span><a href="#41779654">next</a><span>|</span><label class="collapse" for="c-41782883">[-]</label><label class="expand" for="c-41782883">[1 more]</label></div><br/><div class="children"><div class="content">I was referring to in-fix, like can be found in Kotlin and Ruby, not necessarily operator overloads. I&#x27;ve found pretty usable operator overloading, in appropriate contexts, like adding two lists meaning append.</div><br/></div></div></div></div></div></div><div id="41779654" class="c"><input type="checkbox" id="c-41779654" checked=""/><div class="controls bullet"><span class="by">zoogeny</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41778780">parent</a><span>|</span><a href="#41779371">prev</a><span>|</span><a href="#41780936">next</a><span>|</span><label class="collapse" for="c-41779654">[-]</label><label class="expand" for="c-41779654">[3 more]</label></div><br/><div class="children"><div class="content">I hear what you are saying but there is the other side. Perhaps the opinion&#x2F;feeling you are having is related to getting older.<p>We&#x27;ve learned a lot about what works and what doesn&#x27;t in programming languages. Goto considered harmful and all that kind of stuff. If you want to get a Lisp&#x2F;Haskell fanatic really going point out how so many of the features in those languages have finally made their way into mainstream languages (lambdas, etc.).<p>What we don&#x27;t often consider are all of the language features that didn&#x27;t make it.<p>This process didn&#x27;t stop sometime in the past. It is happening right now. That feeling of unease may not be an indication of the quality of the features you are considering. It may largely be uncertainty about what features will or will not stand the test of time.<p>Perhaps as we get older, we want languages that have all of the good stuff we&#x27;ve learned from the past and none of the experimental stuff that we aren&#x27;t too sure about yet. That might be because we are starting to notice that we won&#x27;t have enough time left in our remaining days to sort all the new toys into the good&#x2F;bad bin.</div><br/><div id="41779894" class="c"><input type="checkbox" id="c-41779894" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41779654">parent</a><span>|</span><a href="#41780936">next</a><span>|</span><label class="collapse" for="c-41779894">[-]</label><label class="expand" for="c-41779894">[2 more]</label></div><br/><div class="children"><div class="content">Stirring call to action for creativity, but it is unclear how a comment that boils down to &quot;new things might be good&quot; applies in this context.<p>as OP refers to, custom operators are considered harmful in languages ranging from C++ to Swift. It&#x27;s a great contemporary example of goto.</div><br/><div id="41780438" class="c"><input type="checkbox" id="c-41780438" checked=""/><div class="controls bullet"><span class="by">zoogeny</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41779894">parent</a><span>|</span><a href="#41780936">next</a><span>|</span><label class="collapse" for="c-41780438">[-]</label><label class="expand" for="c-41780438">[1 more]</label></div><br/><div class="children"><div class="content">I suppose the more poetic: &quot;don&#x27;t speak too soon, for the wheel&#x27;s still in spin&quot; is another way to state it. It isn&#x27;t &quot;new things might be good&quot; it is more a reminder that your self-described feeling of unease may say more about you than it does about the language feature under question.<p>I&#x27;ve seen some horrors in my time due to custom operators. I&#x27;ve also suffered through some horrors when they are missing and would clearly be appropriate. They seem appropriate for linear algebra libraries for example. Not everyone agrees, obviously.<p>As an aside, I have been watching a lot of YouTube videos of people programming C. I notice that goto shows up very frequently, especially in modern C. Usually it is a label at the end of a function to manage resource cleanup before returning, almost like a manual `defer`. Sometimes it is to break out of nested loops. I mean, I&#x27;ve always taken Dijkstra&#x27;s point to be that long jumping out of a procedural boundary was the real problem, not the keyword &quot;goto&quot;. And built-in language features that obviate the need to use goto even for the reasonable use cases are my preference.<p>I feel the same about custom infix operators. I too share an unease about them. But I have to admit they feel right sometimes. I admit I don&#x27;t have enough information on their use in this kind of case to know if it is one of the good ones or one of the bad ones.</div><br/></div></div></div></div></div></div><div id="41780936" class="c"><input type="checkbox" id="c-41780936" checked=""/><div class="controls bullet"><span class="by">Clamchop</span><span>|</span><a href="#41777532">root</a><span>|</span><a href="#41778780">parent</a><span>|</span><a href="#41779654">prev</a><span>|</span><a href="#41777737">next</a><span>|</span><label class="collapse" for="c-41780936">[-]</label><label class="expand" for="c-41780936">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The infix is weird and footgun-y.<p>If it&#x27;s a foot gun, then I&#x27;m not seeing how the gun is loaded?<p>&gt; Extension methods on int&#x2F;double serving as constructors smells funny.<p>It doesn&#x27;t feel meaningfully different from the static factory pattern in traditional Java, where 10.percent() would be something like MoneyUtils.createPercent() or Percent.create() with several overloads. Under the hood, that is essentially what is happening. Only downside I can see is that it muddies what truly belongs to the class, but that&#x27;s true of any extension function and Kotlin is intended to be used with IDEA&#x27;s introspection anyway.<p>The Kotlin standard library has lots of extension functions that construct new objects.<p>It also reminds me of Ruby, which perhaps you&#x27;re also not a fan of and that&#x27;s OK.</div><br/></div></div></div></div></div></div><div id="41777737" class="c"><input type="checkbox" id="c-41777737" checked=""/><div class="controls bullet"><span class="by">bojanz</span><span>|</span><a href="#41777532">prev</a><span>|</span><a href="#41780037">next</a><span>|</span><label class="collapse" for="c-41777737">[-]</label><label class="expand" for="c-41777737">[7 more]</label></div><br/><div class="children"><div class="content">I like the support for custom currencies, as that is an edge case that often pops up.<p>On the other hand, be careful about tying the symbol to the currency, as symbols are locale specific. For example, the symbol for USD is $ in eu-US but US$ in en-CA and en-AU (Canada and Australia), and then $US in French locales.<p><a href="https:&#x2F;&#x2F;cldr.unicode.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cldr.unicode.org&#x2F;</a> is the magical dataset behind most good implementations that deal with currency display. Updated twice a year, available in JSON, providing currency symbols and formatting rules for all locales, as well as country =&gt; currency mappings and other useful information.<p>Disclaimer: I maintain a Go solution in this problem space: <a href="https:&#x2F;&#x2F;github.com&#x2F;bojanz&#x2F;currency">https:&#x2F;&#x2F;github.com&#x2F;bojanz&#x2F;currency</a></div><br/><div id="41777955" class="c"><input type="checkbox" id="c-41777955" checked=""/><div class="controls bullet"><span class="by">dkarl</span><span>|</span><a href="#41777737">parent</a><span>|</span><a href="#41780421">next</a><span>|</span><label class="collapse" for="c-41777955">[-]</label><label class="expand" for="c-41777955">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious, is there a standard practice of library developers in a certain space collaborating across languages, sharing issues and corner cases and solutions? Is this a common practice with a name? Or is it up to you to look through issues and release notes on projects in the same space to glean useful information?</div><br/></div></div><div id="41780421" class="c"><input type="checkbox" id="c-41780421" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777737">parent</a><span>|</span><a href="#41777955">prev</a><span>|</span><a href="#41778022">next</a><span>|</span><label class="collapse" for="c-41780421">[-]</label><label class="expand" for="c-41780421">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll introduce l10n support in a future release. My starting point was to make currency names and symbols unaware of the locale as I embedded cryptocurrency data in the mix.<p>Anyway, the library uses the CLDR dataset through ICU: <a href="https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;docs&#x2F;appendixes&#x2F;circulating-currencies.md#source-data">https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;docs&#x2F;append...</a></div><br/></div></div><div id="41778022" class="c"><input type="checkbox" id="c-41778022" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#41777737">parent</a><span>|</span><a href="#41780421">prev</a><span>|</span><a href="#41778332">next</a><span>|</span><label class="collapse" for="c-41778022">[-]</label><label class="expand" for="c-41778022">[3 more]</label></div><br/><div class="children"><div class="content">I know this is a mere quibble as a rider on a helpful post, but a disclosure is not a disclaimer.<p>Disclaimers separate you from the comment, examples:<p>&gt; Disclaimer: I am not a lawyer and this is not legal advice<p>&gt; [says things about $company] Disclaimer: I don&#x27;t work for $company, I heard this from someone who does but I can&#x27;t link to a primary source<p>Disclosures are additional information which you think it&#x27;s proper to add, to be open about your interest or stake in the topic:<p>&gt; Disclosure: I wrote a similar library<p>&gt; [replies to thing about $company] Disclosure: I used to work for $company</div><br/><div id="41779246" class="c"><input type="checkbox" id="c-41779246" checked=""/><div class="controls bullet"><span class="by">ahoka</span><span>|</span><a href="#41777737">root</a><span>|</span><a href="#41778022">parent</a><span>|</span><a href="#41778068">next</a><span>|</span><label class="collapse" for="c-41779246">[-]</label><label class="expand" for="c-41779246">[1 more]</label></div><br/><div class="children"><div class="content">Disclaimer is more often used for humblebrag, not to disclose any information.</div><br/></div></div><div id="41778068" class="c"><input type="checkbox" id="c-41778068" checked=""/><div class="controls bullet"><span class="by">bojanz</span><span>|</span><a href="#41777737">root</a><span>|</span><a href="#41778022">parent</a><span>|</span><a href="#41779246">prev</a><span>|</span><a href="#41778332">next</a><span>|</span><label class="collapse" for="c-41778068">[-]</label><label class="expand" for="c-41778068">[1 more]</label></div><br/><div class="children"><div class="content">Right, indeed!</div><br/></div></div></div></div></div></div><div id="41780037" class="c"><input type="checkbox" id="c-41780037" checked=""/><div class="controls bullet"><span class="by">proper_elb</span><span>|</span><a href="#41777737">prev</a><span>|</span><a href="#41779155">next</a><span>|</span><label class="collapse" for="c-41780037">[-]</label><label class="expand" for="c-41780037">[3 more]</label></div><br/><div class="children"><div class="content">First, congrats on the library and thank you for sharing it!<p>1) A hint about potential prior art: F# (and&#x2F;or C#?) have a first-class unit system (physical units I think), which sounds a bit similar to monetary calculations. However, physical unit are easier to model than monetary unit I think.<p>2) Currently, I am building something tangentially related in Rust: A backtester (test trading strategies on historical and&#x2F;or simulated data) with focus on accuracy. So one thing I included already is that Assets (like etfs) are valued in a currency.<p>If I may be so bold: How would you approach these questions &#x2F; where could I read more about that?
1) When simulating, can I always assume that the exchange will work? (For assets, that is not always the case, sometimes one has to wait a bit until there is a buyer, or there might not be a buyer at all)
2) Is there public domain data in exchange rates?
3) If I have to choose, which exchange rate should I pick? The lower one, higher? What would make the most sense in the context of trading etfs, stocks, options, crypto etc.?
4) How to approach rounding, is there a best practise?
5) I assume it is best to immediately substract taxes in every transaction, even if they are formally defined annually, right?
6) Would you model inflation? I currently plan to ignore it and present it at the very end: &quot;Your portfolio has a final value of X.X ¥. Adjusted for inflation, that would be Y.Y ¥ today (2024-10-08).&quot;</div><br/><div id="41780722" class="c"><input type="checkbox" id="c-41780722" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41780037">parent</a><span>|</span><a href="#41779155">next</a><span>|</span><label class="collapse" for="c-41780722">[-]</label><label class="expand" for="c-41780722">[2 more]</label></div><br/><div class="children"><div class="content">The currency exchange support is way simpler than this. The library only provides a method that will calculate the monetary amount given another Money object as the rate:<p>val amount = 1 money &quot;USD&quot;    &#x2F;&#x2F; USD 1.00<p>val rate = 5.4905 money &quot;BRL&quot; &#x2F;&#x2F; BRL 5.4905<p>amount exchange rate          &#x2F;&#x2F; BRL 5.49<p>It&#x27;s up to implementers to hook up in other datasets and to consume the rates. Exchange rates datasets differ from country to country and some foreign exchange companies offer short-term contracts to hold a transaction at a given rate (sort of &quot;guaranteed rate&#x2F;price&quot;). I don&#x27;t see myself supporting this use case.<p>Nevertheless, Java Money (Moneta) has this feature. Never used it so, I don&#x27;t know how it works.</div><br/><div id="41782040" class="c"><input type="checkbox" id="c-41782040" checked=""/><div class="controls bullet"><span class="by">proper_elb</span><span>|</span><a href="#41780037">root</a><span>|</span><a href="#41780722">parent</a><span>|</span><a href="#41779155">next</a><span>|</span><label class="collapse" for="c-41782040">[-]</label><label class="expand" for="c-41782040">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for your insights!<p>I think it makes sense that this feature would not be planned in your library - as I understand, its goal is to support developers to write better money-related logic, which is sometimes related but different from simulating as accurately as possible.<p>I just noticed a potential misuse of your API: Transitve relationships: &quot;A&quot; = 2.0000 &quot;B&quot;, and &quot;B&quot; = 3.0000 &quot;C&quot;, then implicitely, &quot;A&quot; = 6.0000 &quot;C&quot;. Can the user now define &quot;A&quot; = 7.0000 &quot;C&quot;?<p>That would be wrong - but not trivial to prevent, and practically speaking, it is okay I think.<p>Thank you for your time and for this exchange, wish you good success and fun with kotlin money! :)</div><br/></div></div></div></div></div></div><div id="41779155" class="c"><input type="checkbox" id="c-41779155" checked=""/><div class="controls bullet"><span class="by">wiremine</span><span>|</span><a href="#41780037">prev</a><span>|</span><a href="#41779747">next</a><span>|</span><label class="collapse" for="c-41779155">[-]</label><label class="expand" for="c-41779155">[2 more]</label></div><br/><div class="children"><div class="content">Nice! Reminds me of the ergonomics of Rebol&#x27;s money type:<p><a href="https:&#x2F;&#x2F;www.rebol.com&#x2F;docs&#x2F;core23&#x2F;rebolcore-16.html#section-3.4" rel="nofollow">https:&#x2F;&#x2F;www.rebol.com&#x2F;docs&#x2F;core23&#x2F;rebolcore-16.html#section-...</a><p>&gt; $100 + 11
$111.00<p>&gt; $10 &#x2F; .50
$20.00<p>In general, Rebol&#x27;s type system was very expressive. Would love to see more libraries like this provide that type of experience.</div><br/><div id="41780299" class="c"><input type="checkbox" id="c-41780299" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41779155">parent</a><span>|</span><a href="#41779747">next</a><span>|</span><label class="collapse" for="c-41780299">[-]</label><label class="expand" for="c-41780299">[1 more]</label></div><br/><div class="children"><div class="content">This is great!</div><br/></div></div></div></div><div id="41779747" class="c"><input type="checkbox" id="c-41779747" checked=""/><div class="controls bullet"><span class="by">zoogeny</span><span>|</span><a href="#41779155">prev</a><span>|</span><a href="#41777196">next</a><span>|</span><label class="collapse" for="c-41779747">[-]</label><label class="expand" for="c-41779747">[1 more]</label></div><br/><div class="children"><div class="content">What I want more than a library is an exhaustive test suite for all of the edge cases segmented by currency or finance authority.<p>Tangentially, I also often think about super-strict typing. I know people mention some languages that already do this sort of thing (Units of Measure in F# was talked about). It seems silly to me that so many low level programming languages still use uint64, size_t, or char equivalents for the vast majority of the code. Why not `celsius` vs `farenheit`? Or `meters` vs `feet`. That would stop a lot of possible errors. And even more so, if the language supported things like (2 feet * 2 feet) = (4 square feet). Or (10 meters &#x2F; 5 seconds = 2 m&#x2F;s).</div><br/></div></div><div id="41777196" class="c"><input type="checkbox" id="c-41777196" checked=""/><div class="controls bullet"><span class="by">getfroggie</span><span>|</span><a href="#41779747">prev</a><span>|</span><a href="#41779858">next</a><span>|</span><label class="collapse" for="c-41777196">[-]</label><label class="expand" for="c-41777196">[14 more]</label></div><br/><div class="children"><div class="content">It&#x27;s kind of strange that spreadsheet languages don&#x27;t support money well. Using spreadsheets for escalator style automation is actually quite good and would really be amazing in a language that took typing seriously.</div><br/><div id="41777447" class="c"><input type="checkbox" id="c-41777447" checked=""/><div class="controls bullet"><span class="by">ebiester</span><span>|</span><a href="#41777196">parent</a><span>|</span><a href="#41777237">next</a><span>|</span><label class="collapse" for="c-41777447">[-]</label><label class="expand" for="c-41777447">[10 more]</label></div><br/><div class="children"><div class="content">I think there&#x27;s a good reason for it to be part of a library. The problem with currencies is much like dates: they&#x27;re a social construct, and change more than most of the social constructs we embed in programming languages.<p>I don&#x27;t want to update my interpreter or compiler because Turkey changed their rules of daylight savings time, or Ethereum becomes popular.</div><br/><div id="41779035" class="c"><input type="checkbox" id="c-41779035" checked=""/><div class="controls bullet"><span class="by">JumpCrisscross</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777447">parent</a><span>|</span><a href="#41777592">next</a><span>|</span><label class="collapse" for="c-41779035">[-]</label><label class="expand" for="c-41779035">[4 more]</label></div><br/><div class="children"><div class="content">Oh, this reminds me of my first job out of college at a Swiss bank. Apparently every time a currency conversion was done in a particular model, there was a routine that translated back and forth between the pre-Euro currency and Euro at the conversion rate. So a USD-EUR transaction with a party in France would be run as USD-FRF --&gt; FRF-EUR. All in COBOL. As a result, every so often, you&#x27;d get a <i>slightly</i> different result running a USD-EUR trade with a party in France versus <i>e.g.</i> Germany or the U.K.</div><br/><div id="41779842" class="c"><input type="checkbox" id="c-41779842" checked=""/><div class="controls bullet"><span class="by">tomcam</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41779035">parent</a><span>|</span><a href="#41777592">next</a><span>|</span><label class="collapse" for="c-41779842">[-]</label><label class="expand" for="c-41779842">[3 more]</label></div><br/><div class="children"><div class="content">So what happened when those discrepancies arose?</div><br/><div id="41780375" class="c"><input type="checkbox" id="c-41780375" checked=""/><div class="controls bullet"><span class="by">tvaughan</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41779842">parent</a><span>|</span><a href="#41780288">next</a><span>|</span><label class="collapse" for="c-41780375">[-]</label><label class="expand" for="c-41780375">[1 more]</label></div><br/><div class="children"><div class="content">They became the basis for the plot of Superman III</div><br/></div></div><div id="41780288" class="c"><input type="checkbox" id="c-41780288" checked=""/><div class="controls bullet"><span class="by">JumpCrisscross</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41779842">parent</a><span>|</span><a href="#41780375">prev</a><span>|</span><a href="#41777592">next</a><span>|</span><label class="collapse" for="c-41780288">[-]</label><label class="expand" for="c-41780288">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>what happened when those discrepancies arose?</i><p>They were just passed along.</div><br/></div></div></div></div></div></div><div id="41777592" class="c"><input type="checkbox" id="c-41777592" checked=""/><div class="controls bullet"><span class="by">coreload</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777447">parent</a><span>|</span><a href="#41779035">prev</a><span>|</span><a href="#41778869">next</a><span>|</span><label class="collapse" for="c-41777592">[-]</label><label class="expand" for="c-41777592">[3 more]</label></div><br/><div class="children"><div class="content">Yes, and sometimes the context is not just social but legal or contractual, e.g. rounding currency.</div><br/><div id="41777685" class="c"><input type="checkbox" id="c-41777685" checked=""/><div class="controls bullet"><span class="by">ebiester</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777592">parent</a><span>|</span><a href="#41778869">next</a><span>|</span><label class="collapse" for="c-41777685">[-]</label><label class="expand" for="c-41777685">[2 more]</label></div><br/><div class="children"><div class="content">Yes, and rounding currency is just something that is always handled, as is the number of places that you take a currency out to - for example, gas is often priced at thousandths of a dollar rather than hundreds but presented to the customer in hundredths at the end. Or Yen in most cases does not have a decimal point, except that the places where you round or don&#x27;t round can be consequential in large enough quantities.<p>These are largely things that can be handled by a library, but if it&#x27;s in the language you best not get it wrong because it&#x27;s so much harder to change!</div><br/><div id="41779517" class="c"><input type="checkbox" id="c-41779517" checked=""/><div class="controls bullet"><span class="by">benatkin</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777685">parent</a><span>|</span><a href="#41778869">next</a><span>|</span><label class="collapse" for="c-41779517">[-]</label><label class="expand" for="c-41779517">[1 more]</label></div><br/><div class="children"><div class="content">From my perspective those are tenths of a cent. Stripe has integer values for cents.<p>Am I wrong here?<p><a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;35326710&#x2F;stripe-currency-are-all-amounts-in-cents-100ths-or-does-it-depend-on-curren" rel="nofollow">https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;35326710&#x2F;stripe-currency...</a></div><br/></div></div></div></div></div></div><div id="41778869" class="c"><input type="checkbox" id="c-41778869" checked=""/><div class="controls bullet"><span class="by">skybrian</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777447">parent</a><span>|</span><a href="#41777592">prev</a><span>|</span><a href="#41778544">next</a><span>|</span><label class="collapse" for="c-41778869">[-]</label><label class="expand" for="c-41778869">[1 more]</label></div><br/><div class="children"><div class="content">You could say the same of Unicode, though. Some cultural abstractions become increasingly rigid <i>because</i> they’re embedded in computer systems everywhere.</div><br/></div></div><div id="41778544" class="c"><input type="checkbox" id="c-41778544" checked=""/><div class="controls bullet"><span class="by">carapace</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41777447">parent</a><span>|</span><a href="#41778869">prev</a><span>|</span><a href="#41777237">next</a><span>|</span><label class="collapse" for="c-41778544">[-]</label><label class="expand" for="c-41778544">[1 more]</label></div><br/><div class="children"><div class="content">This.  But more than being changeable they (time and money) are supra-logical or trans-rational.  In other words, computers are limited to what can be modeled or calculated with the one logical operation (it has lots of names, I like &quot;Quine dagger&quot;) but these phenomenon are not.</div><br/></div></div></div></div><div id="41777237" class="c"><input type="checkbox" id="c-41777237" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777196">parent</a><span>|</span><a href="#41777447">prev</a><span>|</span><a href="#41778713">next</a><span>|</span><label class="collapse" for="c-41777237">[-]</label><label class="expand" for="c-41777237">[1 more]</label></div><br/><div class="children"><div class="content">I couldn&#x27;t agree more as someone who has been using more spreadsheets than actually coding in the last 10 years.</div><br/></div></div><div id="41778713" class="c"><input type="checkbox" id="c-41778713" checked=""/><div class="controls bullet"><span class="by">weego</span><span>|</span><a href="#41777196">parent</a><span>|</span><a href="#41777237">prev</a><span>|</span><a href="#41779858">next</a><span>|</span><label class="collapse" for="c-41778713">[-]</label><label class="expand" for="c-41778713">[2 more]</label></div><br/><div class="children"><div class="content">Spreadsheets, browsers, databases.<p>Everything is decided to be an &#x27;abstraction&#x27; and it&#x27;s someone else down the line that has to be concerned. Over the last 30 years of starting as a developer I&#x27;ve really lost faith that the majority are actually concerned with solving anything vs just indulging conceptual whims.</div><br/><div id="41779010" class="c"><input type="checkbox" id="c-41779010" checked=""/><div class="controls bullet"><span class="by">chipdart</span><span>|</span><a href="#41777196">root</a><span>|</span><a href="#41778713">parent</a><span>|</span><a href="#41779858">next</a><span>|</span><label class="collapse" for="c-41779010">[-]</label><label class="expand" for="c-41779010">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Spreadsheets, browsers, databases.<p>I think you&#x27;re mixing up stuff that&#x27;s unrelated to your concern.<p>The concerns you&#x27;re expressing only apply to operations and financial transactions. That&#x27;s not handled by spreadsheets, browsers, or databases. In fact, the primary concern of a browser is to provide views over data fed by servers.<p>In addition, it sounds like you&#x27;re confusing minor conveniences with something being somehow broken by design. The reason why no one bothered to standardize a money type is the fact that there isn&#x27;t a technical requirements for it at all.</div><br/></div></div></div></div></div></div><div id="41779858" class="c"><input type="checkbox" id="c-41779858" checked=""/><div class="controls bullet"><span class="by">hathawsh</span><span>|</span><a href="#41777196">prev</a><span>|</span><a href="#41779381">next</a><span>|</span><label class="collapse" for="c-41779858">[-]</label><label class="expand" for="c-41779858">[2 more]</label></div><br/><div class="children"><div class="content">I have questions about some edge cases I&#x27;ve encountered in dealing with money.<p>- Let&#x27;s say I load two money values from a database. Value A is 1 USD and value B is 1 BTC. If I try to add them together, what happens? (I would expect a runtime exception. In fact, I would hope for a runtime exception, because the operation usually indicates a programming error.)<p>- If I divide $2.00 by 3, do I get $0.66 or $0.67? If I want to specify the rounding rule, is there a simple way to do it? I see there&#x27;s support for allocation by percentage, but sometimes the allocation rules are more complex and I need to be able to specify the rounding rule.<p>- Does this library help parse user input? When parsing user input, what happens to extra digits? Does &quot;0.015&quot; get interpreted as $0.01 or $0.02?<p>Edit: one more question. Sometimes people bend the rules on the number of digits; for example, gas stations may charge $3.599 per gallon. Can the library deal with that or would I have to convert to decimal, multiply, and then convert back to money?</div><br/><div id="41780249" class="c"><input type="checkbox" id="c-41780249" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41779858">parent</a><span>|</span><a href="#41779381">next</a><span>|</span><label class="collapse" for="c-41780249">[-]</label><label class="expand" for="c-41780249">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the questions. Answers:<p>1. You get an exception<p>2. You may specify the rounding rule: <a href="https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;docs&#x2F;usage&#x2F;rounding.md">https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;docs&#x2F;usage&#x2F;...</a><p>3. It has some parsing capabilities. The extra digit is kept, rounding is only applied when doing an operation with the Money object<p>4. Same as 2</div><br/></div></div></div></div><div id="41779381" class="c"><input type="checkbox" id="c-41779381" checked=""/><div class="controls bullet"><span class="by">yett</span><span>|</span><a href="#41779858">prev</a><span>|</span><a href="#41777232">next</a><span>|</span><label class="collapse" for="c-41779381">[-]</label><label class="expand" for="c-41779381">[16 more]</label></div><br/><div class="children"><div class="content">C# has a decimal type: &quot;The decimal type is a 128-bit data type suitable for financial and monetary calculations.&quot; 
<a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;dotnet&#x2F;csharp&#x2F;language-reference&#x2F;language-specification&#x2F;types#838-the-decimal-type" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;dotnet&#x2F;csharp&#x2F;language-ref...</a></div><br/><div id="41779763" class="c"><input type="checkbox" id="c-41779763" checked=""/><div class="controls bullet"><span class="by">nsxwolf</span><span>|</span><a href="#41779381">parent</a><span>|</span><a href="#41777232">next</a><span>|</span><label class="collapse" for="c-41779763">[-]</label><label class="expand" for="c-41779763">[15 more]</label></div><br/><div class="children"><div class="content">That provides the basis for solving precision and rounding issues but for a money library you need more abstractions. The ability to assign a currency code and supply conversion rates and convert between currencies at a minimum.</div><br/><div id="41780488" class="c"><input type="checkbox" id="c-41780488" checked=""/><div class="controls bullet"><span class="by">epolanski</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779763">parent</a><span>|</span><a href="#41781424">next</a><span>|</span><label class="collapse" for="c-41780488">[-]</label><label class="expand" for="c-41780488">[1 more]</label></div><br/><div class="children"><div class="content">Also, avoid making errors like summing different currencies.</div><br/></div></div><div id="41781424" class="c"><input type="checkbox" id="c-41781424" checked=""/><div class="controls bullet"><span class="by">moomin</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779763">parent</a><span>|</span><a href="#41780488">prev</a><span>|</span><a href="#41779965">next</a><span>|</span><label class="collapse" for="c-41781424">[-]</label><label class="expand" for="c-41781424">[1 more]</label></div><br/><div class="children"><div class="content">The thing is, it doesn’t really help. A system I’m working on can have hundreds of monetary amounts in the same currency. Storing the currency against each one is an awful waste of space.<p>Equally the allocation trick is good, but you’ll find that the people who really care about this stuff really care about the exact algorithm you’re using and who it favours.</div><br/></div></div><div id="41779965" class="c"><input type="checkbox" id="c-41779965" checked=""/><div class="controls bullet"><span class="by">tightbookkeeper</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779763">parent</a><span>|</span><a href="#41781424">prev</a><span>|</span><a href="#41777232">next</a><span>|</span><label class="collapse" for="c-41779965">[-]</label><label class="expand" for="c-41779965">[12 more]</label></div><br/><div class="children"><div class="content">That’s an application design choice, not a minimum. An alternative is to work internally in one unit and convert at format time.</div><br/><div id="41781282" class="c"><input type="checkbox" id="c-41781282" checked=""/><div class="controls bullet"><span class="by">knodi123</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779965">parent</a><span>|</span><a href="#41780883">next</a><span>|</span><label class="collapse" for="c-41781282">[-]</label><label class="expand" for="c-41781282">[2 more]</label></div><br/><div class="children"><div class="content">We store all our financial data in Greenwich Mean Dollars.</div><br/><div id="41781894" class="c"><input type="checkbox" id="c-41781894" checked=""/><div class="controls bullet"><span class="by">irq-1</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41781282">parent</a><span>|</span><a href="#41780883">next</a><span>|</span><label class="collapse" for="c-41781894">[-]</label><label class="expand" for="c-41781894">[1 more]</label></div><br/><div class="children"><div class="content">What are you going to do about the new Moon Dollars?</div><br/></div></div></div></div><div id="41780883" class="c"><input type="checkbox" id="c-41780883" checked=""/><div class="controls bullet"><span class="by">Phrodo_00</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779965">parent</a><span>|</span><a href="#41781282">prev</a><span>|</span><a href="#41780145">next</a><span>|</span><label class="collapse" for="c-41780883">[-]</label><label class="expand" for="c-41780883">[1 more]</label></div><br/><div class="children"><div class="content">Might be a minimum for a money library (not completely sure what the absolute minimum would be). It would be an application design choice to not use one and stick to general fixed point&#x2F;Big Num constructs.</div><br/></div></div><div id="41780145" class="c"><input type="checkbox" id="c-41780145" checked=""/><div class="controls bullet"><span class="by">maest</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779965">parent</a><span>|</span><a href="#41780883">prev</a><span>|</span><a href="#41780979">next</a><span>|</span><label class="collapse" for="c-41780145">[-]</label><label class="expand" for="c-41780145">[5 more]</label></div><br/><div class="children"><div class="content">That is not a viable alternative.</div><br/><div id="41780314" class="c"><input type="checkbox" id="c-41780314" checked=""/><div class="controls bullet"><span class="by">serial_dev</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41780145">parent</a><span>|</span><a href="#41780879">next</a><span>|</span><label class="collapse" for="c-41780314">[-]</label><label class="expand" for="c-41780314">[1 more]</label></div><br/><div class="children"><div class="content">Even though my gut reaction is to agree with you, it’s true that it is an app design decision, so in certain scenarios it might very well be a good design decision.</div><br/></div></div><div id="41780879" class="c"><input type="checkbox" id="c-41780879" checked=""/><div class="controls bullet"><span class="by">tightbookkeeper</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41780145">parent</a><span>|</span><a href="#41780314">prev</a><span>|</span><a href="#41780979">next</a><span>|</span><label class="collapse" for="c-41780879">[-]</label><label class="expand" for="c-41780879">[3 more]</label></div><br/><div class="children"><div class="content">Shipped applications disagree with you.</div><br/><div id="41781166" class="c"><input type="checkbox" id="c-41781166" checked=""/><div class="controls bullet"><span class="by">dmoy</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41780879">parent</a><span>|</span><a href="#41780979">next</a><span>|</span><label class="collapse" for="c-41781166">[-]</label><label class="expand" for="c-41781166">[2 more]</label></div><br/><div class="children"><div class="content">It really depends on the context of the app<p>Sometimes you can do all calculations in a single currency and convert at reporting time.  I&#x27;ve worked on teams where that was fine.<p>Sometimes... you really cannot do that.</div><br/><div id="41781331" class="c"><input type="checkbox" id="c-41781331" checked=""/><div class="controls bullet"><span class="by">tightbookkeeper</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41781166">parent</a><span>|</span><a href="#41780979">next</a><span>|</span><label class="collapse" for="c-41781331">[-]</label><label class="expand" for="c-41781331">[1 more]</label></div><br/><div class="children"><div class="content">Completely agree.</div><br/></div></div></div></div></div></div></div></div><div id="41780979" class="c"><input type="checkbox" id="c-41780979" checked=""/><div class="controls bullet"><span class="by">V41frQo1SccpfHI</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41779965">parent</a><span>|</span><a href="#41780145">prev</a><span>|</span><a href="#41777232">next</a><span>|</span><label class="collapse" for="c-41780979">[-]</label><label class="expand" for="c-41780979">[3 more]</label></div><br/><div class="children"><div class="content">Out of curiosity, how do you deal with changing exchange rates in that case?</div><br/><div id="41781897" class="c"><input type="checkbox" id="c-41781897" checked=""/><div class="controls bullet"><span class="by">amoshebb</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41780979">parent</a><span>|</span><a href="#41784409">next</a><span>|</span><label class="collapse" for="c-41781897">[-]</label><label class="expand" for="c-41781897">[1 more]</label></div><br/><div class="children"><div class="content">it depends, if it was a currency exchange, it&#x27;ll be labeled in one of 3 ways, either average rate per unit, absolute, or it&#x27;ll be a reference to a MSSQL table containing exceptional spot transactions. Otherwise, a complete history of exchange rates is stored in KDB, most days you can take the average, and for small amounts on weekends or days the exchange is closed you can just interpolate, there&#x27;s also a half dozen XLSXs full of certain exceptional days, so you&#x27;ll have to check that you&#x27;re not on one of those lists. Then if you&#x27;re not dealing with USD-&gt;X or CAD-&gt;USD-&gt;X things start to get hairy.</div><br/></div></div><div id="41784409" class="c"><input type="checkbox" id="c-41784409" checked=""/><div class="controls bullet"><span class="by">tightbookkeeper</span><span>|</span><a href="#41779381">root</a><span>|</span><a href="#41780979">parent</a><span>|</span><a href="#41781897">prev</a><span>|</span><a href="#41777232">next</a><span>|</span><label class="collapse" for="c-41784409">[-]</label><label class="expand" for="c-41784409">[1 more]</label></div><br/><div class="children"><div class="content">You never want to be lossy with user inputs. Save what they told you and then convert for internal logic.<p>The OP just described a language feature where you want to multiply euros with usd one place and yen and dinar in another.<p>You don’t need to do that which is why a decimal or 64 bit int is a fine language approach.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41777232" class="c"><input type="checkbox" id="c-41777232" checked=""/><div class="controls bullet"><span class="by">Etheryte</span><span>|</span><a href="#41779381">prev</a><span>|</span><a href="#41780640">next</a><span>|</span><label class="collapse" for="c-41777232">[-]</label><label class="expand" for="c-41777232">[11 more]</label></div><br/><div class="children"><div class="content">Does this library handle rounding rules [0]? In many countries, prices are rounded to the nearest 5 cent, but the rules can often be elaborate. It looks like the allocation interface might support this, but at the moment I didn&#x27;t find any mention of it without digging into the docs themselves.<p>[0] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cash_rounding" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cash_rounding</a></div><br/><div id="41777429" class="c"><input type="checkbox" id="c-41777429" checked=""/><div class="controls bullet"><span class="by">graypegg</span><span>|</span><a href="#41777232">parent</a><span>|</span><a href="#41781995">next</a><span>|</span><label class="collapse" for="c-41777429">[-]</label><label class="expand" for="c-41777429">[1 more]</label></div><br/><div class="children"><div class="content">I think one common feature of those rounding procedures is that they are only done for cash payments, rather than plastic, so rather than representing a monetary value, it would have to represent a payment specifically. (With knowledge of payment method and time of transaction since a lot of these rules had a start date.) Possibly a good library to extend off of this!</div><br/></div></div><div id="41781995" class="c"><input type="checkbox" id="c-41781995" checked=""/><div class="controls bullet"><span class="by">sernamar</span><span>|</span><a href="#41777232">parent</a><span>|</span><a href="#41777429">prev</a><span>|</span><a href="#41777318">next</a><span>|</span><label class="collapse" for="c-41781995">[-]</label><label class="expand" for="c-41781995">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m working on a Clojure library for working with money [0] that handles specific rounding rules by passing a custom rounding function to the round function, allowing you to specify different rules as needed.<p>There&#x27;s an example for the Swiss Franc in the README (the code is here [1]).<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;sernamar&#x2F;dinero">https:&#x2F;&#x2F;github.com&#x2F;sernamar&#x2F;dinero</a><p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;sernamar&#x2F;dinero&#x2F;blob&#x2F;main&#x2F;src&#x2F;dinero&#x2F;rounding.clj">https:&#x2F;&#x2F;github.com&#x2F;sernamar&#x2F;dinero&#x2F;blob&#x2F;main&#x2F;src&#x2F;dinero&#x2F;roun...</a></div><br/></div></div><div id="41777318" class="c"><input type="checkbox" id="c-41777318" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777232">parent</a><span>|</span><a href="#41781995">prev</a><span>|</span><a href="#41780640">next</a><span>|</span><label class="collapse" for="c-41777318">[-]</label><label class="expand" for="c-41777318">[8 more]</label></div><br/><div class="children"><div class="content">This is something I am aware but there is no support for this rounding scheme at the moment.</div><br/><div id="41777391" class="c"><input type="checkbox" id="c-41777391" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777318">parent</a><span>|</span><a href="#41780640">next</a><span>|</span><label class="collapse" for="c-41777391">[-]</label><label class="expand" for="c-41777391">[7 more]</label></div><br/><div class="children"><div class="content">Wait, how do you round?  A fixed table from currency to minimum increment?  You’re not about to find 1&#x2F;100-Yen coins, for example.</div><br/><div id="41777514" class="c"><input type="checkbox" id="c-41777514" checked=""/><div class="controls bullet"><span class="by">vetinari</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777391">parent</a><span>|</span><a href="#41777456">next</a><span>|</span><label class="collapse" for="c-41777514">[-]</label><label class="expand" for="c-41777514">[5 more]</label></div><br/><div class="children"><div class="content">You are not going to find 1 or 2 eurocents anymore either, but it is still a valid amount. You can pay that electronically, but not in cash.<p>So rounding for cash is a different problem that rounding money in general.</div><br/><div id="41777680" class="c"><input type="checkbox" id="c-41777680" checked=""/><div class="controls bullet"><span class="by">cyxxon</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777514">parent</a><span>|</span><a href="#41778927">next</a><span>|</span><label class="collapse" for="c-41777680">[-]</label><label class="expand" for="c-41777680">[3 more]</label></div><br/><div class="children"><div class="content">Huh? 1 and 2 eurocents have not been deprecated, afaik only Finland and the Netherlands don&#x27;t use them anymore...</div><br/><div id="41785203" class="c"><input type="checkbox" id="c-41785203" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777680">parent</a><span>|</span><a href="#41778126">next</a><span>|</span><label class="collapse" for="c-41785203">[-]</label><label class="expand" for="c-41785203">[1 more]</label></div><br/><div class="children"><div class="content">The 1 and 2 eurocent coins are still legal tender in the Netherlands, stores just have the option not to accept them and are allowed to round prices to avoid having to stock them (if communicated beforehand).<p>It&#x27;s been years since I last saw a eurocent coin, but it&#x27;s been eliminated by permitting businesses to remove the need for them, not because they&#x27;re being phased out.</div><br/></div></div><div id="41778126" class="c"><input type="checkbox" id="c-41778126" checked=""/><div class="controls bullet"><span class="by">vetinari</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777680">parent</a><span>|</span><a href="#41785203">prev</a><span>|</span><a href="#41778927">next</a><span>|</span><label class="collapse" for="c-41778126">[-]</label><label class="expand" for="c-41778126">[1 more]</label></div><br/><div class="children"><div class="content">Also Belgium, Ireland, Italy, Slovakia...<p>Technically, you can use them for payment, they are still valid money; but the price will be rounded to 5 cents when paying in cash and you won&#x27;t get them in the other direction.</div><br/></div></div></div></div><div id="41778927" class="c"><input type="checkbox" id="c-41778927" checked=""/><div class="controls bullet"><span class="by">sigh_again</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777514">parent</a><span>|</span><a href="#41777680">prev</a><span>|</span><a href="#41777456">next</a><span>|</span><label class="collapse" for="c-41778927">[-]</label><label class="expand" for="c-41778927">[1 more]</label></div><br/><div class="children"><div class="content">&gt;You are not going to find 1 or 2 eurocents anymore either<p>You may want to tell that to my wallet, as well as the payments I make with them. There&#x27;s a cool 37 billion coins outside in the wild, so you&#x27;re going to find them rather easily throughout Europe, even if your own country has stopped using them.</div><br/></div></div></div></div><div id="41777456" class="c"><input type="checkbox" id="c-41777456" checked=""/><div class="controls bullet"><span class="by">criddell</span><span>|</span><a href="#41777232">root</a><span>|</span><a href="#41777391">parent</a><span>|</span><a href="#41777514">prev</a><span>|</span><a href="#41780640">next</a><span>|</span><label class="collapse" for="c-41777456">[-]</label><label class="expand" for="c-41777456">[1 more]</label></div><br/><div class="children"><div class="content">Things like gasoline can have a price that is a fraction of a cent. The ultimate price is rounded.<p>Canada has these guidelines:
<a href="https:&#x2F;&#x2F;www.canada.ca&#x2F;en&#x2F;revenue-agency&#x2F;programs&#x2F;about-canada-revenue-agency-cra&#x2F;phasing-penny.html" rel="nofollow">https:&#x2F;&#x2F;www.canada.ca&#x2F;en&#x2F;revenue-agency&#x2F;programs&#x2F;about-canad...</a></div><br/></div></div></div></div></div></div></div></div><div id="41780640" class="c"><input type="checkbox" id="c-41780640" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777232">prev</a><span>|</span><a href="#41778702">next</a><span>|</span><label class="collapse" for="c-41780640">[-]</label><label class="expand" for="c-41780640">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m very grateful so far by the comments. I&#x27;ve learned a lot and it will help me on the next iterations of the library.</div><br/></div></div><div id="41778702" class="c"><input type="checkbox" id="c-41778702" checked=""/><div class="controls bullet"><span class="by">donjigweed</span><span>|</span><a href="#41780640">prev</a><span>|</span><a href="#41779029">next</a><span>|</span><label class="collapse" for="c-41778702">[-]</label><label class="expand" for="c-41778702">[1 more]</label></div><br/><div class="children"><div class="content">Nice. Looks like it satisfies all the requirements detailed here [0]. Also, good discussion of the major difficulty dealing with money here [1].<p>[0] <a href="https:&#x2F;&#x2F;cs-syd.eu&#x2F;posts&#x2F;2022-08-22-how-to-deal-with-money-in-software" rel="nofollow">https:&#x2F;&#x2F;cs-syd.eu&#x2F;posts&#x2F;2022-08-22-how-to-deal-with-money-in...</a><p>[1] <a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;java&#x2F;comments&#x2F;wmqv3q&#x2F;standards_for_handling_monetary_values&#x2F;ik2w72k&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;java&#x2F;comments&#x2F;wmqv3q&#x2F;standards_for_...</a></div><br/></div></div><div id="41779029" class="c"><input type="checkbox" id="c-41779029" checked=""/><div class="controls bullet"><span class="by">jsiepkes</span><span>|</span><a href="#41778702">prev</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41779029">[-]</label><label class="expand" for="c-41779029">[9 more]</label></div><br/><div class="children"><div class="content">Java has JSR 354 for money [1]. There is also a reference implementation [2]. So there is official support for money in Java.<p>[1] <a href="https:&#x2F;&#x2F;jcp.org&#x2F;en&#x2F;jsr&#x2F;detail?id=354" rel="nofollow">https:&#x2F;&#x2F;jcp.org&#x2F;en&#x2F;jsr&#x2F;detail?id=354</a>
[2] <a href="https:&#x2F;&#x2F;javamoney.github.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;javamoney.github.io&#x2F;</a></div><br/><div id="41785180" class="c"><input type="checkbox" id="c-41785180" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41779029">parent</a><span>|</span><a href="#41779825">next</a><span>|</span><label class="collapse" for="c-41785180">[-]</label><label class="expand" for="c-41785180">[1 more]</label></div><br/><div class="children"><div class="content">It will never not be funny to me how Java language designs have such a hatred for operator overloading yet will happily accept .multiply(2).add(something) as a substitute.</div><br/></div></div><div id="41779825" class="c"><input type="checkbox" id="c-41779825" checked=""/><div class="controls bullet"><span class="by">owlstuffing</span><span>|</span><a href="#41779029">parent</a><span>|</span><a href="#41785180">prev</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41779825">[-]</label><label class="expand" for="c-41779825">[7 more]</label></div><br/><div class="children"><div class="content">Would be cool to hook this up as a manifold unit[1]. This way you could write code like:<p>Money ask = 2.1M USD;<p>What I don&#x27;t see with the Java JSR is how exchange rate services are integrated (if at all?). In the best of worlds, as with manifold&#x27;s units I could write.<p>Money deposit = 300 USD + 500 EUR;<p>Where internally the deposit automatically maintains the amounts separately and uses exchange rates only for spot display&#x2F;calc, transfer, etc.<p>1. <a href="https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;manifold-deps-parent&#x2F;manifold-ext#unit-expressions">https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;man...</a></div><br/><div id="41784444" class="c"><input type="checkbox" id="c-41784444" checked=""/><div class="controls bullet"><span class="by">wtetzner</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41779825">parent</a><span>|</span><a href="#41781183">next</a><span>|</span><label class="collapse" for="c-41784444">[-]</label><label class="expand" for="c-41784444">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Money ask = 2.1M USD;<p>Feels like it should be<p><pre><code>  Money&lt;USD&gt; ask = 2.1M USD;
</code></pre>
Then methods like .plus() wouldn&#x27;t even be defined for incompatible currencies. Of course that doesn&#x27;t work for .equals(), so you&#x27;d still have to fall back to exceptions in that case.</div><br/><div id="41785169" class="c"><input type="checkbox" id="c-41785169" checked=""/><div class="controls bullet"><span class="by">owlstuffing</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41784444">parent</a><span>|</span><a href="#41781183">next</a><span>|</span><label class="collapse" for="c-41785169">[-]</label><label class="expand" for="c-41785169">[1 more]</label></div><br/><div class="children"><div class="content">Generally, the idea is that there is no incompatibility between units. Money is a bit exotic given its abstract nature wrt units &#x2F; exchange rates.<p>For instance, physical dimensions store values as SI units, regardless of supplied unit, but retain the supplied unit type as a display hint.<p>Here, the Length dimension illustrates working with amounts of any unit.<p>Length orbit = 250 mi;<p>Length moon = 238000 km;<p>Length landing = moon + orbit;<p>display(landing); &#x2F;&#x2F; prints 148,136.344 mi<p>display(landing.to(km)); &#x2F;&#x2F; prints 238,402.336 km<p>&#x2F;&#x2F; where<p>display(landing.to(mi) == landing.to(km)); &#x2F;&#x2F; prints true<p>&#x2F;&#x2F; perhaps a better example<p>Rate rate =  1.41 km&#x2F;s;<p>Time duration = 76 hours;<p>Length distance = rate * duration;<p>&#x2F;&#x2F; make your own unit constants<p>RateUnit kps = km&#x2F;s;<p>rate = 1.41 kps;<p>You can play with the manifold-science[1] project, it implements the complete SI physical dimensions and many derived dimensions along with comprehensive operator overloading[2] support etc. to make working with and reading code using quantities more productive in Java.<p>1. <a href="https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;manifold-deps-parent&#x2F;manifold-science">https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;man...</a><p>2. <a href="https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;manifold-deps-parent&#x2F;manifold-ext#operator-overloading">https:&#x2F;&#x2F;github.com&#x2F;manifold-systems&#x2F;manifold&#x2F;tree&#x2F;master&#x2F;man...</a></div><br/></div></div></div></div><div id="41781183" class="c"><input type="checkbox" id="c-41781183" checked=""/><div class="controls bullet"><span class="by">willcipriano</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41779825">parent</a><span>|</span><a href="#41784444">prev</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41781183">[-]</label><label class="expand" for="c-41781183">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;d like types for all the currencies.<p>USD rent = 2000<p>EUR salary = 6000.53<p>USD disposableIncome = salary - rent<p>Then:<p>disposableIncome.toDecimal()<p>disposableIncome.toInteger()<p>disposableIncome.toString()<p>USD interest = disposableIncome.compoundInterest(startDate, endDate, apy)<p>USD tip = billTotal.tip(percentage)<p>USD and EUR would inherit from Money<p>Not sure how to implement it, might be a JVM magic thing.</div><br/><div id="41782033" class="c"><input type="checkbox" id="c-41782033" checked=""/><div class="controls bullet"><span class="by">owlstuffing</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41781183">parent</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41782033">[-]</label><label class="expand" for="c-41782033">[3 more]</label></div><br/><div class="children"><div class="content">What you want is Money, currency is a _unit_ type of a Money quantity, just as meter is a unit type of Length.<p>Money cost = 25M USD;<p>cost += 12M EUR;<p>display(cost.to(EUR));</div><br/><div id="41784451" class="c"><input type="checkbox" id="c-41784451" checked=""/><div class="controls bullet"><span class="by">wtetzner</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41782033">parent</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41784451">[-]</label><label class="expand" for="c-41784451">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think this makes sense? You need to specify an exchange rate somewhere.<p>&gt; just as meter is a unit type of Length<p>The difference is that length units are fixed, but exchange rates are constantly changing.</div><br/><div id="41784918" class="c"><input type="checkbox" id="c-41784918" checked=""/><div class="controls bullet"><span class="by">owlstuffing</span><span>|</span><a href="#41779029">root</a><span>|</span><a href="#41784451">parent</a><span>|</span><a href="#41777430">next</a><span>|</span><label class="collapse" for="c-41784918">[-]</label><label class="expand" for="c-41784918">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You need to specify an exchange rate somewhere.<p>Right. As I mentioned earlier exchange rate services would need to be integrated into the API.<p>Also, exchange rate services would not be needed until a conversion is necessary. For instance, when adding money of different currencies internally the Money type maintains currencies separately, subtotals for USD, EUR, etc. are managed. If at a later time the sum of Money should be displayed, deposited, etc. as a single currency, only then is an exchange service involved.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41777430" class="c"><input type="checkbox" id="c-41777430" checked=""/><div class="controls bullet"><span class="by">hiddew</span><span>|</span><a href="#41779029">prev</a><span>|</span><a href="#41781445">next</a><span>|</span><label class="collapse" for="c-41777430">[-]</label><label class="expand" for="c-41777430">[5 more]</label></div><br/><div class="children"><div class="content">How does it compare to the Java money API (<a href="https:&#x2F;&#x2F;jcp.org&#x2F;en&#x2F;jsr&#x2F;detail?id=354" rel="nofollow">https:&#x2F;&#x2F;jcp.org&#x2F;en&#x2F;jsr&#x2F;detail?id=354</a>) and the related Kotlin DSL in <a href="https:&#x2F;&#x2F;github.com&#x2F;hiddewie&#x2F;money-kotlin&#x2F;?tab=readme-ov-file#kotlin-extensions-for-javaxmoney-moneta-jsr-354">https:&#x2F;&#x2F;github.com&#x2F;hiddewie&#x2F;money-kotlin&#x2F;?tab=readme-ov-file...</a>?</div><br/><div id="41777756" class="c"><input type="checkbox" id="c-41777756" checked=""/><div class="controls bullet"><span class="by">rafaelferreira</span><span>|</span><a href="#41777430">parent</a><span>|</span><a href="#41777855">next</a><span>|</span><label class="collapse" for="c-41777756">[-]</label><label class="expand" for="c-41777756">[1 more]</label></div><br/><div class="children"><div class="content">Another library in this space is Eric Evans&#x27; (of DDD fame) Time &amp; Money library <a href="https:&#x2F;&#x2F;timeandmoney.sourceforge.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;timeandmoney.sourceforge.net&#x2F;</a>.</div><br/></div></div><div id="41777855" class="c"><input type="checkbox" id="c-41777855" checked=""/><div class="controls bullet"><span class="by">stickfigure</span><span>|</span><a href="#41777430">parent</a><span>|</span><a href="#41777756">prev</a><span>|</span><a href="#41781445">next</a><span>|</span><label class="collapse" for="c-41777855">[-]</label><label class="expand" for="c-41777855">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m surprised nobody has mentioned Joda Money yet:<p><a href="https:&#x2F;&#x2F;www.joda.org&#x2F;joda-money&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.joda.org&#x2F;joda-money&#x2F;</a><p>From the same person that brought us Joda Time (ie, what the java time API was based on). I&#x27;ve used Joda Money a lot and it&#x27;s great.<p>Honestly I prefer APIs that look like APIs and I think this trend towards inventing DSLs is a bad one. Rails works because there&#x27;s a critical mass of people who have adopted what is essentially a whole new language on top of Ruby. A money library doesn&#x27;t warrant a new language, it&#x27;s unnecessary cognitive load. This new money library would look fine with simple constructors and method calls.</div><br/><div id="41780290" class="c"><input type="checkbox" id="c-41780290" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777430">root</a><span>|</span><a href="#41777855">parent</a><span>|</span><a href="#41779272">next</a><span>|</span><label class="collapse" for="c-41780290">[-]</label><label class="expand" for="c-41780290">[1 more]</label></div><br/><div class="children"><div class="content">Joda is impressive and has great performance.<p>The examples were written using the infix notation but you can just use regular method calls. For example:<p>val price = Money.of(100, &quot;USD&quot;)<p>val shipping = Money.of(5, &quot;USD&quot;)<p>val subtotal = price.plus(shipping)<p>val discount = Percentage.of(10)<p>val total = subtotal.decreaseBy(discount)<p>total.allocate(2)<p>total.allocate(60.percent(), 40.percent())</div><br/></div></div><div id="41779272" class="c"><input type="checkbox" id="c-41779272" checked=""/><div class="controls bullet"><span class="by">nogridbag</span><span>|</span><a href="#41777430">root</a><span>|</span><a href="#41777855">parent</a><span>|</span><a href="#41780290">prev</a><span>|</span><a href="#41781445">next</a><span>|</span><label class="collapse" for="c-41779272">[-]</label><label class="expand" for="c-41779272">[1 more]</label></div><br/><div class="children"><div class="content">I personally went with Joda money versus the Java money API mentioned above. Our needs are a bit simpler and the Joda Money API is a bit simpler to understand. Our app only deals in USD so I wrote a small utility class to help initialize Money instances so devs don&#x27;t have to write:<p><pre><code>    Money.of(CurrencyUnit.USD, amount)
</code></pre>
...everywhere and do a few other things like total Money instances.</div><br/></div></div></div></div></div></div><div id="41781445" class="c"><input type="checkbox" id="c-41781445" checked=""/><div class="controls bullet"><span class="by">0rzech</span><span>|</span><a href="#41777430">prev</a><span>|</span><a href="#41777794">next</a><span>|</span><label class="collapse" for="c-41781445">[-]</label><label class="expand" for="c-41781445">[1 more]</label></div><br/><div class="children"><div class="content">Not a mainstream language, but Ada has Annex F - Information Systems, which can be used for currency handling. [1][2]<p>[1] <a href="https:&#x2F;&#x2F;ada-lang.io&#x2F;docs&#x2F;arm&#x2F;AA-F&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ada-lang.io&#x2F;docs&#x2F;arm&#x2F;AA-F&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;www.adaic.org&#x2F;resources&#x2F;add_content&#x2F;standards&#x2F;22rm&#x2F;html&#x2F;RM-F.html" rel="nofollow">https:&#x2F;&#x2F;www.adaic.org&#x2F;resources&#x2F;add_content&#x2F;standards&#x2F;22rm&#x2F;h...</a></div><br/></div></div><div id="41777794" class="c"><input type="checkbox" id="c-41777794" checked=""/><div class="controls bullet"><span class="by">Exerosis</span><span>|</span><a href="#41781445">prev</a><span>|</span><a href="#41778815">next</a><span>|</span><label class="collapse" for="c-41777794">[-]</label><label class="expand" for="c-41777794">[2 more]</label></div><br/><div class="children"><div class="content">My only complaint is that there seems to be too much infix. Why not just do 50.btc, 25.3.usd
This would keep it inline with the time API doing 20.seconds
Also percentages could be standard library if you ask me but would probably also need to be 2.3.percent.<p>Looks cool, always happy to see Kotlin love!</div><br/><div id="41780505" class="c"><input type="checkbox" id="c-41780505" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777794">parent</a><span>|</span><a href="#41778815">next</a><span>|</span><label class="collapse" for="c-41780505">[-]</label><label class="expand" for="c-41780505">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for commenting. I&#x27;m still learning Kotlin and I overlooked the usage of get() with vals. This will be the next syntactic sugar into the mix. I think it makes sense.<p>When I was designing the API, I created methods like toUSD() and toEUR(). But with 306+ circulating&#x2F;tender currencies and 2000+ cryptocurrencies, I thought it could lead to a bad experience when using code completion.</div><br/></div></div></div></div><div id="41778815" class="c"><input type="checkbox" id="c-41778815" checked=""/><div class="controls bullet"><span class="by">textlapse</span><span>|</span><a href="#41777794">prev</a><span>|</span><a href="#41780601">next</a><span>|</span><label class="collapse" for="c-41778815">[-]</label><label class="expand" for="c-41778815">[6 more]</label></div><br/><div class="children"><div class="content">Kotlin has the problem of &quot;I had N problems, so I think I can create 1 new solution, now I have N+1 problems&quot; (obligatory <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;927&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;927&#x2F;</a>).<p>The &#x27;money&#x2F;percent&#x2F;usd&#x27; are almost like new keywords - which to me seems bad. Why not a formatter or another tool that simplifies but doesn&#x27;t make it too clever or worse, hard to read.<p>Kotlin is really cool and arguably better than Java. But the language is very hard to read (&#x27;easy&#x27; to write). And with so many different ways of doing a single thing (and many of them exist to support Java, I understand) plus new &#x27;macro-like&#x27; things expanding the language automagically makes it very hard to grasp.<p>I hope I am not the only one with this same feeling...</div><br/><div id="41778966" class="c"><input type="checkbox" id="c-41778966" checked=""/><div class="controls bullet"><span class="by">occz</span><span>|</span><a href="#41778815">parent</a><span>|</span><a href="#41779665">next</a><span>|</span><label class="collapse" for="c-41778966">[-]</label><label class="expand" for="c-41778966">[1 more]</label></div><br/><div class="children"><div class="content">I think one clear tradeoff that Kotlin - arguably intentionally - makes, is that it&#x27;s harder to work with than other languages without the use of an IDE. It is after all made by an IDE developer.<p>It&#x27;s also quite a bit more liberal in introducing new features than Java is, and with a larger feature surface there&#x27;s more potential for misuse.<p>On balance, I think using Kotlin over Java is worth it, though.</div><br/></div></div><div id="41779665" class="c"><input type="checkbox" id="c-41779665" checked=""/><div class="controls bullet"><span class="by">dakiol</span><span>|</span><a href="#41778815">parent</a><span>|</span><a href="#41778966">prev</a><span>|</span><a href="#41780448">next</a><span>|</span><label class="collapse" for="c-41779665">[-]</label><label class="expand" for="c-41779665">[2 more]</label></div><br/><div class="children"><div class="content">Same feeling. It’s rather painful to read Kotlin code because of so many features that imho are not really that needed… and every developer wants to use them all.</div><br/><div id="41785295" class="c"><input type="checkbox" id="c-41785295" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#41778815">root</a><span>|</span><a href="#41779665">parent</a><span>|</span><a href="#41780448">next</a><span>|</span><label class="collapse" for="c-41785295">[-]</label><label class="expand" for="c-41785295">[1 more]</label></div><br/><div class="children"><div class="content">Kotlin has a few new features (infix operations for instance) but most of its feature set is stuff other languages have had for years, sometimes decades, written down a little bit differently. There&#x27;s no functional difference between lambdas in Kotlin and Java, class extensions have been in C# for ages, and operator overloading has been a thing for decades.<p>Most of the resistence to Kotlin I see seems to come down to &quot;I don&#x27;t know the syntax and that makes it hard for me to understand the language&quot; or &quot;this isn&#x27;t like the language I prefer&quot;.<p>Kotlin actually brings surprisingly few language features to the table, its API is just very effective at making use of the few new features it brings as opposed to the ossified languages from a few decades ago that offer new features but then decide not to make use of them in the standard library in case a programmer doesn&#x27;t like using part of the language.<p>Criticising Kotlin for using things like infix operators or lambdas is like criticising Java for shoving classes and generics down everyone&#x27;s throat. You can write Java with only minimal use of these, but you&#x27;d end up with a weird, non-standard code style for the language. There are still plenty of programmers around that despise the concept of classes or inheritance and will declare any Java&#x2F;C#&#x2F;C++&#x2F;Javascript&#x2F;Go program unreadable for making use of OOP concepts, not dissimilar to the &quot;I don&#x27;t get Kotlin&quot; people that seem to have been tricked into believing Kotlin is supposed to look like Java.</div><br/></div></div></div></div><div id="41780448" class="c"><input type="checkbox" id="c-41780448" checked=""/><div class="controls bullet"><span class="by">ttymck</span><span>|</span><a href="#41778815">parent</a><span>|</span><a href="#41779665">prev</a><span>|</span><a href="#41781217">next</a><span>|</span><label class="collapse" for="c-41780448">[-]</label><label class="expand" for="c-41780448">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Kotlin is really cool and arguably better than Java. But the language is very hard to read (&#x27;easy&#x27; to write)<p>I had the same immediate reaction. This style of code is something the Scala community used to be in love with, and was criticized for it. The community has largely moved away from this style, so it&#x27;s interesting to see history possibly repeating itself with Kotlin.</div><br/></div></div><div id="41781217" class="c"><input type="checkbox" id="c-41781217" checked=""/><div class="controls bullet"><span class="by">vips7L</span><span>|</span><a href="#41778815">parent</a><span>|</span><a href="#41780448">prev</a><span>|</span><a href="#41780601">next</a><span>|</span><label class="collapse" for="c-41781217">[-]</label><label class="expand" for="c-41781217">[1 more]</label></div><br/><div class="children"><div class="content">It feels so lambda and extension function heavy.</div><br/></div></div></div></div><div id="41780601" class="c"><input type="checkbox" id="c-41780601" checked=""/><div class="controls bullet"><span class="by">kens</span><span>|</span><a href="#41778815">prev</a><span>|</span><a href="#41780373">next</a><span>|</span><label class="collapse" for="c-41780601">[-]</label><label class="expand" for="c-41780601">[2 more]</label></div><br/><div class="children"><div class="content">The IBM 1401 mainframe (1959) optionally supported pounds&#x2F;shillings&#x2F;pence (£sd) arithmetic in hardware. In those days, there were 12 pence in a shilling and 20 shillings in a pound, so arithmetic with UK money was non-trivial. (This wasn&#x27;t even microcode; this was literally boards full of transistors to add, subtract, multiply, divide, and format currency values.)</div><br/><div id="41780732" class="c"><input type="checkbox" id="c-41780732" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41780601">parent</a><span>|</span><a href="#41780373">next</a><span>|</span><label class="collapse" for="c-41780732">[-]</label><label class="expand" for="c-41780732">[1 more]</label></div><br/><div class="children"><div class="content">I love to learn more about the history of computing. Thanks.</div><br/></div></div></div></div><div id="41780373" class="c"><input type="checkbox" id="c-41780373" checked=""/><div class="controls bullet"><span class="by">serial_dev</span><span>|</span><a href="#41780601">prev</a><span>|</span><a href="#41779951">next</a><span>|</span><label class="collapse" for="c-41780373">[-]</label><label class="expand" for="c-41780373">[1 more]</label></div><br/><div class="children"><div class="content">Congrats on the library, I’ll be looking into it for some nuggets of knowledge.<p>However, the Kotlin code looks absolutely… wrong? Strange? It just feels like a lot of magic to end up with ugly code.<p>This is all subjective, so my question is only this: is this how Kotlin is like in 2024?</div><br/></div></div><div id="41779951" class="c"><input type="checkbox" id="c-41779951" checked=""/><div class="controls bullet"><span class="by">wiseowise</span><span>|</span><a href="#41780373">prev</a><span>|</span><a href="#41778494">next</a><span>|</span><label class="collapse" for="c-41779951">[-]</label><label class="expand" for="c-41779951">[1 more]</label></div><br/><div class="children"><div class="content">Infix functions is one of the worst features of Kotlin.</div><br/></div></div><div id="41778494" class="c"><input type="checkbox" id="c-41778494" checked=""/><div class="controls bullet"><span class="by">zellyn</span><span>|</span><a href="#41779951">prev</a><span>|</span><a href="#41777534">next</a><span>|</span><label class="collapse" for="c-41778494">[-]</label><label class="expand" for="c-41778494">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;m new to Kotlin. Can someone explain how this function creates a Money object incorporating the given count of them?<p>This looks like it&#x27;s ignoring the Number and creating a new Money object (of denomination 1?)<p>&gt; public infix fun Number.money(currency: String): Money = money(currency, defaultRoundingMode, null)</div><br/><div id="41778577" class="c"><input type="checkbox" id="c-41778577" checked=""/><div class="controls bullet"><span class="by">thomascgalvin</span><span>|</span><a href="#41778494">parent</a><span>|</span><a href="#41778543">next</a><span>|</span><label class="collapse" for="c-41778577">[-]</label><label class="expand" for="c-41778577">[3 more]</label></div><br/><div class="children"><div class="content">In Kotlin, an infix method can be called without the `.` operator, and without the parens surrounding arguments.<p><pre><code>    100 money &quot;USD&quot;
</code></pre>
is the same as<p><pre><code>    100.money(&quot;USD&quot;)
</code></pre>
`Number.money(currency: String): Money` is an extension method; Kotlin provides syntactic sugar which allows you to &quot;add&quot; methods to existing classes. The above is basically equivalent to:<p><pre><code>    fun money(count: Number, currency: String): Money</code></pre></div><br/><div id="41780149" class="c"><input type="checkbox" id="c-41780149" checked=""/><div class="controls bullet"><span class="by">zellyn</span><span>|</span><a href="#41778494">root</a><span>|</span><a href="#41778577">parent</a><span>|</span><a href="#41781648">next</a><span>|</span><label class="collapse" for="c-41780149">[-]</label><label class="expand" for="c-41780149">[1 more]</label></div><br/><div class="children"><div class="content">Thanks!<p>I allowed myself to be distracted by all the weird infix stuff. I was thinking &quot;but it&#x27;s not passing itself into the money constructor&quot; but it&#x27;s actually just delegating to a different-signature version of `money` _on itself_ that will use its value then.</div><br/></div></div><div id="41781648" class="c"><input type="checkbox" id="c-41781648" checked=""/><div class="controls bullet"><span class="by">adamgordonbell</span><span>|</span><a href="#41778494">root</a><span>|</span><a href="#41778577">parent</a><span>|</span><a href="#41780149">prev</a><span>|</span><a href="#41778543">next</a><span>|</span><label class="collapse" for="c-41781648">[-]</label><label class="expand" for="c-41781648">[1 more]</label></div><br/><div class="children"><div class="content">Great see that kotlin didn&#x27;t avoid all Scala&#x27;s bad ideas.</div><br/></div></div></div></div><div id="41778543" class="c"><input type="checkbox" id="c-41778543" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#41778494">parent</a><span>|</span><a href="#41778577">prev</a><span>|</span><a href="#41777534">next</a><span>|</span><label class="collapse" for="c-41778543">[-]</label><label class="expand" for="c-41778543">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;d be easier to follow if you could provide a link to the GitHub line you&#x27;re looking at, but most likely the `money` function being called is a second extension method of the Number class, which means that it implicitly gets the Number object as `this` and presumably uses it to build the Money.</div><br/><div id="41780126" class="c"><input type="checkbox" id="c-41780126" checked=""/><div class="controls bullet"><span class="by">zellyn</span><span>|</span><a href="#41778494">root</a><span>|</span><a href="#41778543">parent</a><span>|</span><a href="#41777534">next</a><span>|</span><label class="collapse" for="c-41780126">[-]</label><label class="expand" for="c-41780126">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;4bef95a1d2158e3088d832217d46407bad87c7ba&#x2F;money&#x2F;src&#x2F;main&#x2F;kotlin&#x2F;com&#x2F;eriksencosta&#x2F;money&#x2F;Number.kt#L37">https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;4bef95a1d2158e308...</a></div><br/><div id="41780212" class="c"><input type="checkbox" id="c-41780212" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#41778494">root</a><span>|</span><a href="#41780126">parent</a><span>|</span><a href="#41777534">next</a><span>|</span><label class="collapse" for="c-41780212">[-]</label><label class="expand" for="c-41780212">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that&#x27;s just an infix function that provides some default parameters to this extension method:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;4bef95a1d2158e3088d832217d46407bad87c7ba&#x2F;money&#x2F;src&#x2F;main&#x2F;kotlin&#x2F;com&#x2F;eriksencosta&#x2F;money&#x2F;Number.kt#L79">https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;4bef95a1d2158e308...</a></div><br/></div></div></div></div></div></div></div></div><div id="41777534" class="c"><input type="checkbox" id="c-41777534" checked=""/><div class="controls bullet"><span class="by">DaiPlusPlus</span><span>|</span><a href="#41778494">prev</a><span>|</span><a href="#41779124">next</a><span>|</span><label class="collapse" for="c-41777534">[-]</label><label class="expand" for="c-41777534">[5 more]</label></div><br/><div class="children"><div class="content">&gt; no mainstream language has a first-class data type for representing money<p>Visual Basic 6 and VGA had a `Currency` type (replaced by `Decimal` in VB.NET): <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;office&#x2F;vba&#x2F;language&#x2F;reference&#x2F;user-interface-help&#x2F;currency-data-type" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;office&#x2F;vba&#x2F;language&#x2F;refere...</a><p>T-SQL has `money` and `smallmoney` types: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;sql&#x2F;t-sql&#x2F;data-types&#x2F;money-and-smallmoney-transact-sql?view=sql-server-ver16" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;sql&#x2F;t-sql&#x2F;data-types&#x2F;money...</a><p>...am I missing something?</div><br/><div id="41779563" class="c"><input type="checkbox" id="c-41779563" checked=""/><div class="controls bullet"><span class="by">DaiPlusPlus</span><span>|</span><a href="#41777534">parent</a><span>|</span><a href="#41777660">next</a><span>|</span><label class="collapse" for="c-41779563">[-]</label><label class="expand" for="c-41779563">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Visual Basic 6 and VGA<p>*VBA, sorry; typo. HN won&#x27;t let me edit my posts argh.</div><br/></div></div><div id="41777660" class="c"><input type="checkbox" id="c-41777660" checked=""/><div class="controls bullet"><span class="by">sam0x17</span><span>|</span><a href="#41777534">parent</a><span>|</span><a href="#41779563">prev</a><span>|</span><a href="#41779124">next</a><span>|</span><label class="collapse" for="c-41777660">[-]</label><label class="expand" for="c-41777660">[3 more]</label></div><br/><div class="children"><div class="content">&gt; mainstream<p>;)</div><br/><div id="41778008" class="c"><input type="checkbox" id="c-41778008" checked=""/><div class="controls bullet"><span class="by">DaiPlusPlus</span><span>|</span><a href="#41777534">root</a><span>|</span><a href="#41777660">parent</a><span>|</span><a href="#41779124">next</a><span>|</span><label class="collapse" for="c-41778008">[-]</label><label class="expand" for="c-41778008">[2 more]</label></div><br/><div class="children"><div class="content">What could be more mainstream than VB6?</div><br/><div id="41780859" class="c"><input type="checkbox" id="c-41780859" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41777534">root</a><span>|</span><a href="#41778008">parent</a><span>|</span><a href="#41779124">next</a><span>|</span><label class="collapse" for="c-41780859">[-]</label><label class="expand" for="c-41780859">[1 more]</label></div><br/><div class="children"><div class="content">Excel macros.</div><br/></div></div></div></div></div></div></div></div><div id="41779124" class="c"><input type="checkbox" id="c-41779124" checked=""/><div class="controls bullet"><span class="by">afh1</span><span>|</span><a href="#41777534">prev</a><span>|</span><a href="#41781803">next</a><span>|</span><label class="collapse" for="c-41779124">[-]</label><label class="expand" for="c-41779124">[1 more]</label></div><br/><div class="children"><div class="content">&gt;However, no mainstream language has a first-class data type for representing money<p>Parcal has a Currency type. Though, I can understand not calling it mainstream... Fun fact it&#x27;s a fixed point type which is just a Int64 behind the scenes, at least in Delphi.</div><br/></div></div><div id="41781803" class="c"><input type="checkbox" id="c-41781803" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#41779124">prev</a><span>|</span><a href="#41783678">next</a><span>|</span><label class="collapse" for="c-41781803">[-]</label><label class="expand" for="c-41781803">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if this would handle small decimals.<p>Edge case?<p>I want to calculate the installments of 265 Wei (0.000000000000000265 ETH) over a period of 144 months</div><br/></div></div><div id="41783678" class="c"><input type="checkbox" id="c-41783678" checked=""/><div class="controls bullet"><span class="by">endgame</span><span>|</span><a href="#41781803">prev</a><span>|</span><a href="#41781748">next</a><span>|</span><label class="collapse" for="c-41783678">[-]</label><label class="expand" for="c-41783678">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know Kotlin very well. Can it track the currencies involved at the type level, so that trying to combine (say) USD and EUR amounts in an error?</div><br/></div></div><div id="41781748" class="c"><input type="checkbox" id="c-41781748" checked=""/><div class="controls bullet"><span class="by">pbreit</span><span>|</span><a href="#41783678">prev</a><span>|</span><a href="#41780544">next</a><span>|</span><label class="collapse" for="c-41781748">[-]</label><label class="expand" for="c-41781748">[3 more]</label></div><br/><div class="children"><div class="content">Are integers still a preferred method for working with and storing monetary amounts or can we go back to decimals now that most languages handle decimals decently? Monetary amounts pretty much always need to eventually be presented to humans so handling them as integers is quite a pain.</div><br/><div id="41781885" class="c"><input type="checkbox" id="c-41781885" checked=""/><div class="controls bullet"><span class="by">jacobsenscott</span><span>|</span><a href="#41781748">parent</a><span>|</span><a href="#41781773">next</a><span>|</span><label class="collapse" for="c-41781885">[-]</label><label class="expand" for="c-41781885">[1 more]</label></div><br/><div class="children"><div class="content">It isn&#x27;t that common to need fractions though. Money <i>is</i> typically handled in integer amounts (we just divide the amounts by 100 or whatever to make it easier for humans to grok).  Nobody&#x27;s going to pay half a cent for a latte for example. If for some reason you do need to deal with 1&#x2F;1000 of a dollar, or 1&#x2F;10000 of a dollar, you can still use integers. You just need to know the scaling factor.<p>Your presentation layer is probably always going to need to do some manipulation of the number anyway (put a dollar sign on it, etc) so using a decimal amount just for presentation needs isn&#x27;t a huge win. But it will work too.</div><br/></div></div><div id="41781773" class="c"><input type="checkbox" id="c-41781773" checked=""/><div class="controls bullet"><span class="by">hansonkd</span><span>|</span><a href="#41781748">parent</a><span>|</span><a href="#41781885">prev</a><span>|</span><a href="#41780544">next</a><span>|</span><label class="collapse" for="c-41781773">[-]</label><label class="expand" for="c-41781773">[1 more]</label></div><br/><div class="children"><div class="content">A decimal type is sometimes orders of magnitude slower than integer do simple stuff like summing (at least in Postgres and Python).<p>This comes into play if you have to do aggregate functions across tens of thousands of rows and can kill performance compared to integers.</div><br/></div></div></div></div><div id="41780544" class="c"><input type="checkbox" id="c-41780544" checked=""/><div class="controls bullet"><span class="by">ppeetteerr</span><span>|</span><a href="#41781748">prev</a><span>|</span><a href="#41779669">next</a><span>|</span><label class="collapse" for="c-41780544">[-]</label><label class="expand" for="c-41780544">[3 more]</label></div><br/><div class="children"><div class="content">What is up with that API? `1.25.percent()`? `1 money &#x27;USD&#x27;`? Love the spirit of a money library, but this is a little odd.</div><br/><div id="41780594" class="c"><input type="checkbox" id="c-41780594" checked=""/><div class="controls bullet"><span class="by">foooorsyth</span><span>|</span><a href="#41780544">parent</a><span>|</span><a href="#41779669">next</a><span>|</span><label class="collapse" for="c-41780594">[-]</label><label class="expand" for="c-41780594">[2 more]</label></div><br/><div class="children"><div class="content">Even as someone familiar with Kotlin, it&#x27;s hard to decipher what this library is doing without syntax highlighting here. The author is using infix functions and custom extension functions on primitive types. Non-Kotlin-natives will scratch heads.</div><br/><div id="41784532" class="c"><input type="checkbox" id="c-41784532" checked=""/><div class="controls bullet"><span class="by">ppeetteerr</span><span>|</span><a href="#41780544">root</a><span>|</span><a href="#41780594">parent</a><span>|</span><a href="#41779669">next</a><span>|</span><label class="collapse" for="c-41784532">[-]</label><label class="expand" for="c-41784532">[1 more]</label></div><br/><div class="children"><div class="content">Oh no, I know how it&#x27;s done, I&#x27;m just surprised by it. There are more straight forward ways of expressing the same thing without using infix functions and those extensions (e.g. `val price = USD(100)` or `val price = Money(100, &#x27;USD&#x27;)`).</div><br/></div></div></div></div></div></div><div id="41779669" class="c"><input type="checkbox" id="c-41779669" checked=""/><div class="controls bullet"><span class="by">vintagedave</span><span>|</span><a href="#41780544">prev</a><span>|</span><a href="#41779261">next</a><span>|</span><label class="collapse" for="c-41779669">[-]</label><label class="expand" for="c-41779669">[2 more]</label></div><br/><div class="children"><div class="content">Delphi has a currency type, as does C++Builder (so, a native Currency type available in C++ with that toolchain.)<p>This one seems to carry units, as in, it is not a type with math for a known amount of fixed point precision that differentiates this library, but that it captures that plus the unit -- the currency, USD, EUR, etc -- that it is in.</div><br/><div id="41780346" class="c"><input type="checkbox" id="c-41780346" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41779669">parent</a><span>|</span><a href="#41779261">next</a><span>|</span><label class="collapse" for="c-41780346">[-]</label><label class="expand" for="c-41780346">[1 more]</label></div><br/><div class="children"><div class="content">You are right. Languages indeed have support for currencies and decimal numbers. My implementation is based on Fowler&#x27;s Money pattern. The Money object is thus a value object representing a monetary amount in a given currency.</div><br/></div></div></div></div><div id="41779261" class="c"><input type="checkbox" id="c-41779261" checked=""/><div class="controls bullet"><span class="by">rebeccaskinner</span><span>|</span><a href="#41779669">prev</a><span>|</span><a href="#41777466">next</a><span>|</span><label class="collapse" for="c-41779261">[-]</label><label class="expand" for="c-41779261">[3 more]</label></div><br/><div class="children"><div class="content">Neat. It seems to me like this is filling three separate gaps:<p><pre><code>  - fixed point arithmetic
  - tagging values with units
  - localization for parsing currency names into units
</code></pre>
I&#x27;m curious if Kotlin&#x27;s type system is expressive enough to allow you to catch at compile time cases where you might be trying to, e.g. add USD to GBP.</div><br/><div id="41780432" class="c"><input type="checkbox" id="c-41780432" checked=""/><div class="controls bullet"><span class="by">eriksencosta</span><span>|</span><a href="#41779261">parent</a><span>|</span><a href="#41779832">next</a><span>|</span><label class="collapse" for="c-41780432">[-]</label><label class="expand" for="c-41780432">[1 more]</label></div><br/><div class="children"><div class="content">The library will throw an exception if doing an operation with different currencies: <a href="https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;money&#x2F;src&#x2F;test&#x2F;kotlin&#x2F;com&#x2F;eriksencosta&#x2F;money&#x2F;MoneyTest.kt#L207">https:&#x2F;&#x2F;github.com&#x2F;eriksencosta&#x2F;money&#x2F;blob&#x2F;trunk&#x2F;money&#x2F;src&#x2F;t...</a><p>But I think I&#x27;ll make it explicit in the documentation. Thanks for pointing out!</div><br/></div></div><div id="41779832" class="c"><input type="checkbox" id="c-41779832" checked=""/><div class="controls bullet"><span class="by">ackfoobar</span><span>|</span><a href="#41779261">parent</a><span>|</span><a href="#41780432">prev</a><span>|</span><a href="#41777466">next</a><span>|</span><label class="collapse" for="c-41779832">[-]</label><label class="expand" for="c-41779832">[1 more]</label></div><br/><div class="children"><div class="content">&gt; catch at compile time<p>Not in this library, but I think it&#x27;s possible to put the currency as a type parameter.</div><br/></div></div></div></div><div id="41777466" class="c"><input type="checkbox" id="c-41777466" checked=""/><div class="controls bullet"><span class="by">yafetn</span><span>|</span><a href="#41779261">prev</a><span>|</span><a href="#41777622">next</a><span>|</span><label class="collapse" for="c-41777466">[-]</label><label class="expand" for="c-41777466">[4 more]</label></div><br/><div class="children"><div class="content">The currency codes could probably be inline value classes. That way, you can do<p><pre><code>    val price = 100 money USD
</code></pre>
Note the lack of quotes around USD.</div><br/><div id="41778580" class="c"><input type="checkbox" id="c-41778580" checked=""/><div class="controls bullet"><span class="by">sigh_again</span><span>|</span><a href="#41777466">parent</a><span>|</span><a href="#41777622">next</a><span>|</span><label class="collapse" for="c-41778580">[-]</label><label class="expand" for="c-41778580">[3 more]</label></div><br/><div class="children"><div class="content">Maintaining an up to date currency list is, quite frankly, hell. Your code will always, always be more up to date than said list.</div><br/><div id="41778664" class="c"><input type="checkbox" id="c-41778664" checked=""/><div class="controls bullet"><span class="by">946789987649</span><span>|</span><a href="#41777466">root</a><span>|</span><a href="#41778580">parent</a><span>|</span><a href="#41777622">next</a><span>|</span><label class="collapse" for="c-41778664">[-]</label><label class="expand" for="c-41778664">[2 more]</label></div><br/><div class="children"><div class="content">You could argue the same for timezones in a date library, yet they have them. I would think a library dedicated to money will in fact be the most up to date.</div><br/><div id="41778718" class="c"><input type="checkbox" id="c-41778718" checked=""/><div class="controls bullet"><span class="by">sigh_again</span><span>|</span><a href="#41777466">root</a><span>|</span><a href="#41778664">parent</a><span>|</span><a href="#41777622">next</a><span>|</span><label class="collapse" for="c-41778718">[-]</label><label class="expand" for="c-41778718">[1 more]</label></div><br/><div class="children"><div class="content">Do they ? I&#x27;ve never once had a library that stores Europe_Paris, or Offset_Plus_7_45, they&#x27;ve always been stringly typed. Do you have an example of who&#x27;d be crazy enough to maintain a wrapper around tzdb?</div><br/></div></div></div></div></div></div></div></div><div id="41777622" class="c"><input type="checkbox" id="c-41777622" checked=""/><div class="controls bullet"><span class="by">bradley13</span><span>|</span><a href="#41777466">prev</a><span>|</span><label class="collapse" for="c-41777622">[-]</label><label class="expand" for="c-41777622">[1 more]</label></div><br/><div class="children"><div class="content">Look nice. I do find the wordy operators reminiscent of Cobol. Instead of &quot;subtotal decreaseBy discount&quot; in Kotline I would expect either &quot;subtotal.decreaseBy(discount)&quot; or perhaps &quot;subtotal * (1 - discount)&quot;.</div><br/></div></div></div></div></div></div></div></body></html>