<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1737363652207" as="style"/><link rel="stylesheet" href="styles.css?v=1737363652207"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://berthub.eu/articles/posts/how-to-get-a-unix-epoch-from-a-utc-date-time-string/">The surprising struggle to get a Unix Epoch time from a UTC string in C or C++</a> <span class="domain">(<a href="https://berthub.eu">berthub.eu</a>)</span></div><div class="subtext"><span>PascalW</span> | <span>56 comments</span></div><br/><div><div id="42760597" class="c"><input type="checkbox" id="c-42760597" checked=""/><div class="controls bullet"><span class="by">chikere232</span><span>|</span><a href="#42761541">next</a><span>|</span><label class="collapse" for="c-42760597">[-]</label><label class="expand" for="c-42760597">[13 more]</label></div><br/><div class="children"><div class="content">Is it a struggle though?<p>They needed to have a locale matching the language of the localised time string they wanted to parse, they needed to use strptime to parse the string, they needed to use timegm() to convert the result to seconds when seen as UTC. The man pages pretty much describe these things.<p>The interface or these things could certainly be nicer, but most of the things they bring up as issues aren&#x27;t even relevant for the task they&#x27;re trying to do. Why do they talk about daylight savings time being confusing when they&#x27;re only trying to deal with UTC which doesn&#x27;t have it?</div><br/><div id="42760980" class="c"><input type="checkbox" id="c-42760980" checked=""/><div class="controls bullet"><span class="by">johnisgood</span><span>|</span><a href="#42760597">parent</a><span>|</span><a href="#42764909">next</a><span>|</span><label class="collapse" for="c-42760980">[-]</label><label class="expand" for="c-42760980">[8 more]</label></div><br/><div class="children"><div class="content">It is not.<p><pre><code>  int main(void) {
    struct tm tm = {0}; 
    const char *time_str = &quot;Mon, 20 Jan 2025 06:07:07 GMT&quot;; 
    const char *fmt = &quot;%a, %d %b %Y %H:%M:%S GMT&quot;; 

    &#x2F;&#x2F; Parse the time string
    if (strptime(time_str, fmt, &amp;tm) == NULL) {
        fprintf(stderr, &quot;Error parsing time\n&quot;);
        return 1;
    }

    &#x2F;&#x2F; Convert to Unix timestamp (UTC)
    time_t timestamp = timegm(&amp;tm);
    if (timestamp == -1) {
        fprintf(stderr, &quot;Error converting to timestamp\n&quot;);
        return 1;
    }

    printf(&quot;Unix timestamp: %ld\n&quot;, timestamp);
    return 0;
  }
</code></pre>
It is a C99 code snippet that parses the UTC time string and safely converts it to a Unix timestamp and it follows best practices from the SEI CERT C standard, avoiding locale and timezone issues by using UTC and timegm().<p>You can avoids pitfalls of mktime() by using timegm() which directly works with UTC time.<p>Where is the struggle? Am I misunderstanding it?<p>Oh by the way, must read: <a href="https:&#x2F;&#x2F;www.catb.org&#x2F;esr&#x2F;time-programming&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.catb.org&#x2F;esr&#x2F;time-programming&#x2F;</a> (Time, Clock, and Calendar Programming In C by Eric S. Raymond)</div><br/><div id="42764977" class="c"><input type="checkbox" id="c-42764977" checked=""/><div class="controls bullet"><span class="by">1vuio0pswjnm7</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42760980">parent</a><span>|</span><a href="#42761425">next</a><span>|</span><label class="collapse" for="c-42764977">[-]</label><label class="expand" for="c-42764977">[2 more]</label></div><br/><div class="children"><div class="content">&quot;Mon, 20 Jan 2025 06:07:07 GMT&quot;<p>I thought the default output of date(1), with TZ unset, is something like<p><pre><code>   Mon Jan 20 06:07:07 UTC 2025
</code></pre>
That&#x27;s the busybox default anyway</div><br/><div id="42765561" class="c"><input type="checkbox" id="c-42765561" checked=""/><div class="controls bullet"><span class="by">johnisgood</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42764977">parent</a><span>|</span><a href="#42761425">next</a><span>|</span><label class="collapse" for="c-42765561">[-]</label><label class="expand" for="c-42765561">[1 more]</label></div><br/><div class="children"><div class="content">Well, `Mon Jan 20 06:07:07 UTC 2025` does not match `fmt` in the code. My input matches the format string exactly, which is why it works.<p>You could use `&quot;%a %b %d %H:%M:%S %Z %Y&quot;` for `fmt` (which is indeed the default for `date`) and it would work with yours.<p>Both results in the same timestamp.</div><br/></div></div></div></div><div id="42761425" class="c"><input type="checkbox" id="c-42761425" checked=""/><div class="controls bullet"><span class="by">paxcoder</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42760980">parent</a><span>|</span><a href="#42764977">prev</a><span>|</span><a href="#42764909">next</a><span>|</span><label class="collapse" for="c-42761425">[-]</label><label class="expand" for="c-42761425">[5 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t find `timegm` neither in the C99 standard draft nor in POSIX.1-2024.<p>The first sentence of your link reads:<p>&gt;The C&#x2F;Unix time- and date-handling API is a confusing jungle full of the corpses of failed experiments and various other traps for the unwary, many of them resulting from design decisions that may have been defensible when the originals were written but appear at best puzzling today.</div><br/><div id="42765351" class="c"><input type="checkbox" id="c-42765351" checked=""/><div class="controls bullet"><span class="by">wahern</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42761425">parent</a><span>|</span><a href="#42762438">next</a><span>|</span><label class="collapse" for="c-42765351">[-]</label><label class="expand" for="c-42765351">[1 more]</label></div><br/><div class="children"><div class="content">timegm was finally standardized by C23, and POSIX-2024 mentions it in the FUTURE DIRECTIONS section of mktime. I don&#x27;t know precisely what happened with POSIX. I <i>think</i> timegm got lost in the shuffle and by the time Austin Group attention turned back to it, it made more sense to let C23 pick it up first so there were no accidental conflicts in specification.[1]<p>[1] POSIX-2024 incorporates C17, not C23, but in practice the typical POSIX environment going forward will likely be targeting POSIX-2024 + C23, or just POSIX-2024 + extensions; and hopefully neither POSIX nor C will wait as long between standard updates as previously.</div><br/></div></div><div id="42762438" class="c"><input type="checkbox" id="c-42762438" checked=""/><div class="controls bullet"><span class="by">chikere232</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42761425">parent</a><span>|</span><a href="#42765351">prev</a><span>|</span><a href="#42762535">next</a><span>|</span><label class="collapse" for="c-42762438">[-]</label><label class="expand" for="c-42762438">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man3&#x2F;timegm.3.html" rel="nofollow">https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man3&#x2F;timegm.3.html</a><p>It&#x27;s not posix, but it&#x27;s pretty available</div><br/></div></div><div id="42762535" class="c"><input type="checkbox" id="c-42762535" checked=""/><div class="controls bullet"><span class="by">johnisgood</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42761425">parent</a><span>|</span><a href="#42762438">prev</a><span>|</span><a href="#42764909">next</a><span>|</span><label class="collapse" for="c-42762535">[-]</label><label class="expand" for="c-42762535">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, you&#x27;re correct that `timegm` is neither part of the C99 standard nor officially specified in POSIX.1-2024 but it is widely supported in practice on many platforms, including glibc, musl, and BSD systems which makes it a pragmatic choice in environments where it is available. Additionally, it is easy to implement it in a portable way when unavailable.<p>So, while `timegm` is not standardized in C99 or POSIX, it is a practical solution in most real-world environments, and alternatives exist for portability, and thus: handling time in C is not inherently a struggle.<p>As for the link, it says &quot;You may want to bite the bullet and use timegm(3), even though it’s nominally not portable.&quot;, but see what I wrote above.</div><br/><div id="42762615" class="c"><input type="checkbox" id="c-42762615" checked=""/><div class="controls bullet"><span class="by">oofabz</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42762535">parent</a><span>|</span><a href="#42764909">next</a><span>|</span><label class="collapse" for="c-42762615">[-]</label><label class="expand" for="c-42762615">[1 more]</label></div><br/><div class="children"><div class="content">timegm() is even available on Haiku</div><br/></div></div></div></div></div></div></div></div><div id="42760858" class="c"><input type="checkbox" id="c-42760858" checked=""/><div class="controls bullet"><span class="by">pif</span><span>|</span><a href="#42760597">parent</a><span>|</span><a href="#42764909">prev</a><span>|</span><a href="#42761541">next</a><span>|</span><label class="collapse" for="c-42760858">[-]</label><label class="expand" for="c-42760858">[3 more]</label></div><br/><div class="children"><div class="content">What&#x27;s a man page? [cit]</div><br/><div id="42761001" class="c"><input type="checkbox" id="c-42761001" checked=""/><div class="controls bullet"><span class="by">johnisgood</span><span>|</span><a href="#42760597">root</a><span>|</span><a href="#42760858">parent</a><span>|</span><a href="#42762406">next</a><span>|</span><label class="collapse" for="c-42761001">[-]</label><label class="expand" for="c-42761001">[1 more]</label></div><br/><div class="children"><div class="content">&quot;manual pages&quot;, type &quot;man man&quot; in your terminal.<p><a href="https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man1&#x2F;man.1.html" rel="nofollow">https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man1&#x2F;man.1.html</a></div><br/></div></div></div></div></div></div><div id="42761541" class="c"><input type="checkbox" id="c-42761541" checked=""/><div class="controls bullet"><span class="by">d_burfoot</span><span>|</span><a href="#42760597">prev</a><span>|</span><a href="#42760394">next</a><span>|</span><label class="collapse" for="c-42761541">[-]</label><label class="expand" for="c-42761541">[5 more]</label></div><br/><div class="children"><div class="content">My personal rule for time processing: use the language-provided libraries for ONLY 2 operations: converting back and forth between a formatted time string with a time zone, and a Unix epoch timestamp. Perform all other time processing in your own code based on those 2 operations, and whenever you start with a new language or framework, just learn those 2.<p>I&#x27;ve wasted so many dreary hours trying to figure out crappy time processing APIs and libraries. Never again!</div><br/><div id="42764798" class="c"><input type="checkbox" id="c-42764798" checked=""/><div class="controls bullet"><span class="by">avalys</span><span>|</span><a href="#42761541">parent</a><span>|</span><a href="#42760394">next</a><span>|</span><label class="collapse" for="c-42764798">[-]</label><label class="expand" for="c-42764798">[4 more]</label></div><br/><div class="children"><div class="content">Starting from timestamp A, how do I find the Unix timestamp B corresponding to exactly 6 months in the future from timestamp B?</div><br/><div id="42765247" class="c"><input type="checkbox" id="c-42765247" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#42761541">root</a><span>|</span><a href="#42764798">parent</a><span>|</span><a href="#42765153">next</a><span>|</span><label class="collapse" for="c-42765247">[-]</label><label class="expand" for="c-42765247">[2 more]</label></div><br/><div class="children"><div class="content">Adding or subtracting &quot;months&quot; is inherently difficult because months don&#x27;t have set lengths, varying from 28 through 31 days.  Thus adding one month to May 31 is weird: should that be June 30 or July 1 or some other date?<p>Try not to have to do this sort of thing.  You might have to though, and then you&#x27;ll have to figure out what adding months means for your app.</div><br/><div id="42765677" class="c"><input type="checkbox" id="c-42765677" checked=""/><div class="controls bullet"><span class="by">mjevans</span><span>|</span><a href="#42761541">root</a><span>|</span><a href="#42765247">parent</a><span>|</span><a href="#42765153">next</a><span>|</span><label class="collapse" for="c-42765677">[-]</label><label class="expand" for="c-42765677">[1 more]</label></div><br/><div class="children"><div class="content">Welcome to Business Logic.  This is where I&#x27;d really like pushback to result in things that aren&#x27;t edgecases.<p>However you also run into day to day business issues like:<p>* What if it&#x27;s now a Holiday and things are closed?<p>* What if it&#x27;s some commonly busy time like winter break?  (Not quite a single holiday)<p>* What if a disaster of somekind (even just a burst waterpipe) halts operations in an unplanned way?<p>Usually flexability needs to be built in.  It can be fine to &#x27;target&#x27; +3 months, but specify it as something like +3m(-0d:+2w) (so, add &#x27;3 months&#x27; ignoring the day of month, clamp dom to a valid value, allow 0 days before or 14 days after),</div><br/></div></div></div></div><div id="42765153" class="c"><input type="checkbox" id="c-42765153" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#42761541">root</a><span>|</span><a href="#42764798">parent</a><span>|</span><a href="#42765247">prev</a><span>|</span><a href="#42760394">next</a><span>|</span><label class="collapse" for="c-42765153">[-]</label><label class="expand" for="c-42765153">[1 more]</label></div><br/><div class="children"><div class="content">I think the parent is describing a &quot;bring your own library&quot; approach where a set of known to the author algorithms will be used for those calculations and the only thing the host language will be used for is the parse&#x2F;convert.<p>It does remove a lot of the ambiguity of &quot;I wonder what this stdlib&#x27;s quirks are in their date calculations&quot; but it also seems like a non-trivial amount of effort to port every time.</div><br/></div></div></div></div></div></div><div id="42760394" class="c"><input type="checkbox" id="c-42760394" checked=""/><div class="controls bullet"><span class="by">1970-01-01</span><span>|</span><a href="#42761541">prev</a><span>|</span><a href="#42764847">next</a><span>|</span><label class="collapse" for="c-42760394">[-]</label><label class="expand" for="c-42760394">[2 more]</label></div><br/><div class="children"><div class="content">13 more years to go until the 2038 problem.<p>Surely we&#x27;ll have everything patched up by then..</div><br/><div id="42760503" class="c"><input type="checkbox" id="c-42760503" checked=""/><div class="controls bullet"><span class="by">ahubert</span><span>|</span><a href="#42760394">parent</a><span>|</span><a href="#42764847">next</a><span>|</span><label class="collapse" for="c-42760503">[-]</label><label class="expand" for="c-42760503">[1 more]</label></div><br/><div class="children"><div class="content">wow that is dedication 1970-01-01! :-)</div><br/></div></div></div></div><div id="42764847" class="c"><input type="checkbox" id="c-42764847" checked=""/><div class="controls bullet"><span class="by">blindriver</span><span>|</span><a href="#42760394">prev</a><span>|</span><a href="#42761624">next</a><span>|</span><label class="collapse" for="c-42764847">[-]</label><label class="expand" for="c-42764847">[1 more]</label></div><br/><div class="children"><div class="content">I used the ICU packages when I needed to do something like this but it&#x27;s been a decade since I coded in C++.<p><a href="https:&#x2F;&#x2F;unicode-org.github.io&#x2F;icu&#x2F;userguide&#x2F;datetime&#x2F;" rel="nofollow">https:&#x2F;&#x2F;unicode-org.github.io&#x2F;icu&#x2F;userguide&#x2F;datetime&#x2F;</a></div><br/></div></div><div id="42761624" class="c"><input type="checkbox" id="c-42761624" checked=""/><div class="controls bullet"><span class="by">p0w3n3d</span><span>|</span><a href="#42764847">prev</a><span>|</span><a href="#42762113">next</a><span>|</span><label class="collapse" for="c-42761624">[-]</label><label class="expand" for="c-42761624">[4 more]</label></div><br/><div class="children"><div class="content">I think that time handling is the most hard thing in the world of programming.<p>Explanation: you can learn heap sort or FFT or whatever algorithm there is and implement it. But writing your own calendar from scratch, that will do for example chron job on 3 am in the day of DST transition, that works in every TZ, is a work for many people and many months if not years...</div><br/><div id="42761647" class="c"><input type="checkbox" id="c-42761647" checked=""/><div class="controls bullet"><span class="by">timewizard</span><span>|</span><a href="#42761624">parent</a><span>|</span><a href="#42762113">next</a><span>|</span><label class="collapse" for="c-42761647">[-]</label><label class="expand" for="c-42761647">[3 more]</label></div><br/><div class="children"><div class="content">Time handling is exceptionally easy.  Time zone handling is hard.  It doesn&#x27;t help that the timezone database isn&#x27;t actually designed to make this any easier.</div><br/><div id="42761712" class="c"><input type="checkbox" id="c-42761712" checked=""/><div class="controls bullet"><span class="by">p0w3n3d</span><span>|</span><a href="#42761624">root</a><span>|</span><a href="#42761647">parent</a><span>|</span><a href="#42763433">next</a><span>|</span><label class="collapse" for="c-42761712">[-]</label><label class="expand" for="c-42761712">[1 more]</label></div><br/><div class="children"><div class="content">Meanwhile I edited my comment but we&#x27;re still agreeing. And adding them for example to embedded systems is additional pain. Example: tram or train electronic boards &#x2F; screens</div><br/></div></div><div id="42763433" class="c"><input type="checkbox" id="c-42763433" checked=""/><div class="controls bullet"><span class="by">DougN7</span><span>|</span><a href="#42761624">root</a><span>|</span><a href="#42761647">parent</a><span>|</span><a href="#42761712">prev</a><span>|</span><a href="#42762113">next</a><span>|</span><label class="collapse" for="c-42763433">[-]</label><label class="expand" for="c-42763433">[1 more]</label></div><br/><div class="children"><div class="content">I don’t know.  I’ve written that seemed like obvious simple code that got tripped up with the 25 hour day on DST transition.  That’s when I learned to stick to UTC.</div><br/></div></div></div></div></div></div><div id="42762113" class="c"><input type="checkbox" id="c-42762113" checked=""/><div class="controls bullet"><span class="by">rstuart4133</span><span>|</span><a href="#42761624">prev</a><span>|</span><a href="#42765036">next</a><span>|</span><label class="collapse" for="c-42762113">[-]</label><label class="expand" for="c-42762113">[3 more]</label></div><br/><div class="children"><div class="content">For those skimmimg the problem is mktime() returns local time, and they want it in UTC. So you need to subtract the timezone used, but the timezone varies by date you feed mktime() and there is no easy way to determime it.<p>If you are happy for the time to perhaps be wrong around the hours timezone changes, this is an easy hack:<p><pre><code>    import time
    def time_mktime_utc(_tuple):
        result = time.mktime(_tuple[:-1] + (0,))
        return result * 2 - time.mktime(time.gmtime(result))
</code></pre>
If you are just using it for display this is usually fine as time zone changes are usually timed to happen when nobody is looking.</div><br/><div id="42765256" class="c"><input type="checkbox" id="c-42765256" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#42762113">parent</a><span>|</span><a href="#42762391">next</a><span>|</span><label class="collapse" for="c-42765256">[-]</label><label class="expand" for="c-42765256">[1 more]</label></div><br/><div class="children"><div class="content">And the answer is to use `gmtime()`, which AIX doesn&#x27;t have and which Windows calls something else, but, whatever, if you need to support AIX you can use an open source library.</div><br/></div></div><div id="42762391" class="c"><input type="checkbox" id="c-42762391" checked=""/><div class="controls bullet"><span class="by">chikere232</span><span>|</span><a href="#42762113">parent</a><span>|</span><a href="#42765256">prev</a><span>|</span><a href="#42765036">next</a><span>|</span><label class="collapse" for="c-42762391">[-]</label><label class="expand" for="c-42762391">[1 more]</label></div><br/><div class="children"><div class="content">That is not really the problem.<p>mktime() parses the time string which lacks any information on time zones<p>then the article uses timegm() to convert it to unixtime on the assumption that it was in UTC<p>also it&#x27;s about C</div><br/></div></div></div></div><div id="42765036" class="c"><input type="checkbox" id="c-42765036" checked=""/><div class="controls bullet"><span class="by">havermeyer</span><span>|</span><a href="#42762113">prev</a><span>|</span><a href="#42760599">next</a><span>|</span><label class="collapse" for="c-42765036">[-]</label><label class="expand" for="c-42765036">[1 more]</label></div><br/><div class="children"><div class="content">The Abseil time library makes time and date parsing and manipulation a lot nicer in C++: <a href="https:&#x2F;&#x2F;abseil.io&#x2F;docs&#x2F;cpp&#x2F;guides&#x2F;time" rel="nofollow">https:&#x2F;&#x2F;abseil.io&#x2F;docs&#x2F;cpp&#x2F;guides&#x2F;time</a></div><br/></div></div><div id="42760599" class="c"><input type="checkbox" id="c-42760599" checked=""/><div class="controls bullet"><span class="by">zX41ZdbW</span><span>|</span><a href="#42765036">prev</a><span>|</span><a href="#42761552">next</a><span>|</span><label class="collapse" for="c-42760599">[-]</label><label class="expand" for="c-42760599">[1 more]</label></div><br/><div class="children"><div class="content">The first rule of thumb is to never use functions from glibc (gmtime, localtime, mktime, etc) because half of them are non-thread-safe, and another half use a global mutex, and they are unreasonably slow. The second rule of thumb is to never use functions from C++, because iostreams are slow, and a stringstream can lead to a silent data loss if an exception is thrown during memory allocation.<p>ClickHouse has the &quot;parseDateTimeBestEffort&quot; function: <a href="https:&#x2F;&#x2F;clickhouse.com&#x2F;docs&#x2F;en&#x2F;sql-reference&#x2F;functions&#x2F;type-conversion-functions#parsedatetimebesteffort" rel="nofollow">https:&#x2F;&#x2F;clickhouse.com&#x2F;docs&#x2F;en&#x2F;sql-reference&#x2F;functions&#x2F;type-...</a> and here is its source code: <a href="https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;blob&#x2F;74d8551dadf735b97fae310f718b14598e55f8b5&#x2F;src&#x2F;IO&#x2F;parseDateTimeBestEffort.cpp">https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;blob&#x2F;74d8551dadf735...</a></div><br/></div></div><div id="42761552" class="c"><input type="checkbox" id="c-42761552" checked=""/><div class="controls bullet"><span class="by">jonstewart</span><span>|</span><a href="#42760599">prev</a><span>|</span><a href="#42760119">next</a><span>|</span><label class="collapse" for="c-42761552">[-]</label><label class="expand" for="c-42761552">[4 more]</label></div><br/><div class="children"><div class="content">The headline doesn’t match the article. As it points out, C++20 has a very nice, and portable, time library. I quibble with the article here, though: in 2025, C++20 is widely available.</div><br/><div id="42762992" class="c"><input type="checkbox" id="c-42762992" checked=""/><div class="controls bullet"><span class="by">spacechild1</span><span>|</span><a href="#42761552">parent</a><span>|</span><a href="#42761924">next</a><span>|</span><label class="collapse" for="c-42762992">[-]</label><label class="expand" for="c-42762992">[1 more]</label></div><br/><div class="children"><div class="content">Damn, I didn&#x27;t notice that C++20 added a whole bunch of new features to the std::chrono library! Nice!</div><br/></div></div><div id="42761924" class="c"><input type="checkbox" id="c-42761924" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#42761552">parent</a><span>|</span><a href="#42762992">prev</a><span>|</span><a href="#42760119">next</a><span>|</span><label class="collapse" for="c-42761924">[-]</label><label class="expand" for="c-42761924">[2 more]</label></div><br/><div class="children"><div class="content">Indeed. The article should be retitled &quot;C still useless in 2025, including time handling&quot;.</div><br/><div id="42766244" class="c"><input type="checkbox" id="c-42766244" checked=""/><div class="controls bullet"><span class="by">chikere232</span><span>|</span><a href="#42761552">root</a><span>|</span><a href="#42761924">parent</a><span>|</span><a href="#42760119">next</a><span>|</span><label class="collapse" for="c-42766244">[-]</label><label class="expand" for="c-42766244">[1 more]</label></div><br/><div class="children"><div class="content">It would be incorrect, but it&#x27;s already incorrect as what they&#x27;re doing isn&#x27;t really a struggle, so I guess the net result is neutral?</div><br/></div></div></div></div></div></div><div id="42762545" class="c"><input type="checkbox" id="c-42762545" checked=""/><div class="controls bullet"><span class="by">richrichie</span><span>|</span><a href="#42760119">prev</a><span>|</span><a href="#42759713">next</a><span>|</span><label class="collapse" for="c-42762545">[-]</label><label class="expand" for="c-42762545">[1 more]</label></div><br/><div class="children"><div class="content">&gt; give us some truly excellent code that we really don’t deserve<p>Why such self flagellation?</div><br/></div></div><div id="42759713" class="c"><input type="checkbox" id="c-42759713" checked=""/><div class="controls bullet"><span class="by">sylware</span><span>|</span><a href="#42762545">prev</a><span>|</span><a href="#42760289">next</a><span>|</span><label class="collapse" for="c-42759713">[-]</label><label class="expand" for="c-42759713">[4 more]</label></div><br/><div class="children"><div class="content">Until you understand that the core of unix time is the &quot;day&quot;, in the end, you only need to know the first leap year (If I recall properly it is 1972), then you have to handle the &quot;rules&quot; of leap years, and you will be ok (wikipedia I think, don&#x27;t use google anymore since they now force javascript upon new web engines).<p>I did write such code in RISC-V assembly (for a custom command line on linux to  output the statx syscall output). Then, don&#x27;t be scared, with a bit of motivation, you&#x27;ll figure it out.</div><br/><div id="42761137" class="c"><input type="checkbox" id="c-42761137" checked=""/><div class="controls bullet"><span class="by">DamonHD</span><span>|</span><a href="#42759713">parent</a><span>|</span><a href="#42760289">next</a><span>|</span><label class="collapse" for="c-42761137">[-]</label><label class="expand" for="c-42761137">[3 more]</label></div><br/><div class="children"><div class="content">The core of the UNIX time is <i>seconds</i> since epoch, nothing else.  &#x27;Day&#x27; has no special place at all.  There are calendars for converting to and from dates, including Western-style, but the days in those calendars vary in length because of daylight saving switches and leap seconds for example.</div><br/><div id="42761378" class="c"><input type="checkbox" id="c-42761378" checked=""/><div class="controls bullet"><span class="by">Kwpolska</span><span>|</span><a href="#42759713">root</a><span>|</span><a href="#42761137">parent</a><span>|</span><a href="#42760289">next</a><span>|</span><label class="collapse" for="c-42761378">[-]</label><label class="expand" for="c-42761378">[2 more]</label></div><br/><div class="children"><div class="content">UNIX time ignores leap seconds, so every day is exactly 86400 seconds, and every year is either 365*86400 or 366*86400 seconds. This makes converting from yyyy-mm-dd to UNIX time quite easy, as you can just do `365*86400*(yyyy-1970) + leap_years*86400` to get to yyyy-01-01.</div><br/><div id="42762404" class="c"><input type="checkbox" id="c-42762404" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#42759713">root</a><span>|</span><a href="#42761378">parent</a><span>|</span><a href="#42760289">next</a><span>|</span><label class="collapse" for="c-42762404">[-]</label><label class="expand" for="c-42762404">[1 more]</label></div><br/><div class="children"><div class="content">Well yes, in the sense that not all Unix epoch seconds are equally long...</div><br/></div></div></div></div></div></div></div></div><div id="42760289" class="c"><input type="checkbox" id="c-42760289" checked=""/><div class="controls bullet"><span class="by">emcell</span><span>|</span><a href="#42759713">prev</a><span>|</span><a href="#42761483">next</a><span>|</span><label class="collapse" for="c-42760289">[-]</label><label class="expand" for="c-42760289">[7 more]</label></div><br/><div class="children"><div class="content">again, one of the many reasons i dont code in c or cpp anymore</div><br/><div id="42762986" class="c"><input type="checkbox" id="c-42762986" checked=""/><div class="controls bullet"><span class="by">npalli</span><span>|</span><a href="#42760289">parent</a><span>|</span><a href="#42761607">next</a><span>|</span><label class="collapse" for="c-42762986">[-]</label><label class="expand" for="c-42762986">[1 more]</label></div><br/><div class="children"><div class="content">Jeez, read the article. C++20 has such an elegant solution that it has him swooning.<p><i>Being truly luxurious, the tz library supports using not just your operating system’s time zone databases, which might lack crucial leap second detail, but can also source the IANA tzdb directly. This allows you to faithfully calculate the actual duration of a plane flight in 1978 that not only passed through a DST change, but also an actual leap second. I don’t swoon easily, but I’m swooning.</i></div><br/></div></div><div id="42761607" class="c"><input type="checkbox" id="c-42761607" checked=""/><div class="controls bullet"><span class="by">ta-195678</span><span>|</span><a href="#42760289">parent</a><span>|</span><a href="#42762986">prev</a><span>|</span><a href="#42760892">next</a><span>|</span><label class="collapse" for="c-42761607">[-]</label><label class="expand" for="c-42761607">[3 more]</label></div><br/><div class="children"><div class="content">Was waiting for rustaceans to come and base c&#x2F;cpp.. didn’t take long</div><br/><div id="42763939" class="c"><input type="checkbox" id="c-42763939" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#42760289">root</a><span>|</span><a href="#42761607">parent</a><span>|</span><a href="#42760892">next</a><span>|</span><label class="collapse" for="c-42763939">[-]</label><label class="expand" for="c-42763939">[2 more]</label></div><br/><div class="children"><div class="content">They have five comments ever.  What makes you think they use rust?</div><br/><div id="42764428" class="c"><input type="checkbox" id="c-42764428" checked=""/><div class="controls bullet"><span class="by">ranger_danger</span><span>|</span><a href="#42760289">root</a><span>|</span><a href="#42763939">parent</a><span>|</span><a href="#42760892">next</a><span>|</span><label class="collapse" for="c-42764428">[-]</label><label class="expand" for="c-42764428">[1 more]</label></div><br/><div class="children"><div class="content">emcell is the name of a rust crate</div><br/></div></div></div></div></div></div><div id="42760892" class="c"><input type="checkbox" id="c-42760892" checked=""/><div class="controls bullet"><span class="by">pif</span><span>|</span><a href="#42760289">parent</a><span>|</span><a href="#42761607">prev</a><span>|</span><a href="#42761483">next</a><span>|</span><label class="collapse" for="c-42760892">[-]</label><label class="expand" for="c-42760892">[2 more]</label></div><br/><div class="children"><div class="content">And the fox said: &quot;These grapes are sour&quot;.</div><br/><div id="42761321" class="c"><input type="checkbox" id="c-42761321" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#42760289">root</a><span>|</span><a href="#42760892">parent</a><span>|</span><a href="#42761483">next</a><span>|</span><label class="collapse" for="c-42761321">[-]</label><label class="expand" for="c-42761321">[1 more]</label></div><br/><div class="children"><div class="content">That makes no sense in this context.  What&#x27;s the situation you&#x27;re imagining where they <i>wanted</i> to use C but something else prevented them so they made up an excuse to call C bad?<p>You know sometimes people just dislike things, right?</div><br/></div></div></div></div></div></div><div id="42759490" class="c"><input type="checkbox" id="c-42759490" checked=""/><div class="controls bullet"><span class="by">udidnmem</span><span>|</span><a href="#42761483">prev</a><span>|</span><label class="collapse" for="c-42759490">[-]</label><label class="expand" for="c-42759490">[7 more]</label></div><br/><div class="children"><div class="content">You cannot since it&#x27;s missing time zone</div><br/><div id="42759592" class="c"><input type="checkbox" id="c-42759592" checked=""/><div class="controls bullet"><span class="by">RHSeeger</span><span>|</span><a href="#42759490">parent</a><span>|</span><label class="collapse" for="c-42759592">[-]</label><label class="expand" for="c-42759592">[6 more]</label></div><br/><div class="children"><div class="content">UTC is a timezone, though. Or am I misunderstanding what you&#x27;re saying?</div><br/><div id="42759823" class="c"><input type="checkbox" id="c-42759823" checked=""/><div class="controls bullet"><span class="by">cvadict</span><span>|</span><a href="#42759490">root</a><span>|</span><a href="#42759592">parent</a><span>|</span><a href="#42759954">next</a><span>|</span><label class="collapse" for="c-42759823">[-]</label><label class="expand" for="c-42759823">[1 more]</label></div><br/><div class="children"><div class="content">That is fine as long as the input &#x2F; output is always in UTC...  but at the end of the day you often want to communicate that timepoint to a human user (e.g. an appointment time, the time at which some event happened, etc.), which is when our stupid monkey brains expect the ascii string you are showing us to actually make sense in our specific locale (including all of the warts each of those particular timezones have, including leap second, DST, etc.)</div><br/></div></div><div id="42759954" class="c"><input type="checkbox" id="c-42759954" checked=""/><div class="controls bullet"><span class="by">jxjsndbxbd</span><span>|</span><a href="#42759490">root</a><span>|</span><a href="#42759592">parent</a><span>|</span><a href="#42759823">prev</a><span>|</span><label class="collapse" for="c-42759954">[-]</label><label class="expand" for="c-42759954">[4 more]</label></div><br/><div class="children"><div class="content">UTC would be marked as +Z<p>Without any marking, it could be anything</div><br/><div id="42760125" class="c"><input type="checkbox" id="c-42760125" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#42759490">root</a><span>|</span><a href="#42759954">parent</a><span>|</span><a href="#42761161">next</a><span>|</span><label class="collapse" for="c-42760125">[-]</label><label class="expand" for="c-42760125">[1 more]</label></div><br/><div class="children"><div class="content">The article explicitly mentions UTC all over the place.  It&#x27;s UTC.</div><br/></div></div><div id="42761161" class="c"><input type="checkbox" id="c-42761161" checked=""/><div class="controls bullet"><span class="by">DamonHD</span><span>|</span><a href="#42759490">root</a><span>|</span><a href="#42759954">parent</a><span>|</span><a href="#42760125">prev</a><span>|</span><label class="collapse" for="c-42761161">[-]</label><label class="expand" for="c-42761161">[2 more]</label></div><br/><div class="children"><div class="content">No &#x27;+&#x27;.<p>Noon UTC is &quot;12:00Z&quot;.</div><br/><div id="42765474" class="c"><input type="checkbox" id="c-42765474" checked=""/><div class="controls bullet"><span class="by">nophunphil</span><span>|</span><a href="#42759490">root</a><span>|</span><a href="#42761161">parent</a><span>|</span><label class="collapse" for="c-42765474">[-]</label><label class="expand" for="c-42765474">[1 more]</label></div><br/><div class="children"><div class="content">One factor complicates things a bit: this is one way to encode that the timezone is UTC, but +00:00 is also commonly used for example.<p>RFC 3339 is nice for this reason. Always UTC and terminated with a Z.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>