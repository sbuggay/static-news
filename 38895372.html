<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704618054741" as="style"/><link rel="stylesheet" href="styles.css?v=1704618054741"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://anishathalye.com/inverting-photodna/">Inverting PhotoDNA (2021)</a> <span class="domain">(<a href="https://anishathalye.com">anishathalye.com</a>)</span></div><div class="subtext"><span>jxmorris12</span> | <span>19 comments</span></div><br/><div><div id="38899607" class="c"><input type="checkbox" id="c-38899607" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38897197">next</a><span>|</span><label class="collapse" for="c-38899607">[-]</label><label class="expand" for="c-38899607">[1 more]</label></div><br/><div class="children"><div class="content">Discussed at the time:<p><i>Inverting PhotoDNA</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=29626911">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=29626911</a> - Dec 2021 (25 comments)</div><br/></div></div><div id="38897197" class="c"><input type="checkbox" id="c-38897197" checked=""/><div class="controls bullet"><span class="by">KTibow</span><span>|</span><a href="#38899607">prev</a><span>|</span><a href="#38896905">next</a><span>|</span><label class="collapse" for="c-38897197">[-]</label><label class="expand" for="c-38897197">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s worth noting that even if PhotoDNA didn&#x27;t do any extra obfuscation, 144 bytes of grayscale isn&#x27;t a lot to work with. If we assume each pixel takes up half a byte that&#x27;s barely a 17x17 image.</div><br/><div id="38898131" class="c"><input type="checkbox" id="c-38898131" checked=""/><div class="controls bullet"><span class="by">kragen</span><span>|</span><a href="#38897197">parent</a><span>|</span><a href="#38896905">next</a><span>|</span><label class="collapse" for="c-38898131">[-]</label><label class="expand" for="c-38898131">[2 more]</label></div><br/><div class="children"><div class="content">raw grayscale downscaling is not the best possible lossy image compression<p>i have a high-quality 1280×720 color jpeg of macaulay culkin here which is 99191 bytes; that&#x27;s 0.86 bits per pixel.  recompressing it with the gimp with quality set to 15%, 4:2:0 subsampling, arithmetic coding, no color profile, and no progressive reduces it to 13269 bytes, the only visible effect being a subtle posterized blockiness in low-contrast areas of the photo; subtle details of the facial expression and hair texture survive.  that&#x27;s 0.115 bits per pixel<p>the same compression ratio at 144 bytes would be a 100×100 full-color image.  jpeg can&#x27;t compress small images that well, but plausibly something could</div><br/><div id="38898398" class="c"><input type="checkbox" id="c-38898398" checked=""/><div class="controls bullet"><span class="by">qayxc</span><span>|</span><a href="#38897197">root</a><span>|</span><a href="#38898131">parent</a><span>|</span><a href="#38896905">next</a><span>|</span><label class="collapse" for="c-38898398">[-]</label><label class="expand" for="c-38898398">[1 more]</label></div><br/><div class="children"><div class="content">The compression ratio depends on the entropy of the image more than anything else.<p>Chroma subsampling isn&#x27;t the reason for low bitrates - by your own logic, grayscale would be smaller since it&#x27;s effectively removing any chroma information.<p>What gets you from 24 bpp to 0.12 bpp is primarily the arithmetic coder and that only depends on entropy. Just for shits and giggles I took two images (resized and cropped to 1280x720) and saved them as jpeg (15%, 4:2:0).<p>The high entropy image (a garden with lots of flowers [1]) resulted in 83.476 bytes. The low entropy image (a stylised drawing of hills with a sunrise [2]) resulted in 22.299 bytes using the same settings.<p>To further confirm the hypothesis, I applied a size 4 average blur to the low entropy image to further reduce details and saved it using the same settings. The result was a 19.104 bytes file. Doing the same to the high entropy image resulted in a 34.646 bytes file - a whopping 60% reduction in size by just reducing the entropy.<p>This shows that reducing entropy is the significant factor here, not colour.
It also means that you can get <i>some</i> 100x100 images to compress down to 144 bytes, but for most that simply doesn&#x27;t apply.<p><pre><code>  [1] https:&#x2F;&#x2F;images.hdqwalls.com&#x2F;wallpapers&#x2F;sunrise-landscape-minimalism-5k-ex.jpg
  [2] https:&#x2F;&#x2F;homesfeed.com&#x2F;wp-content&#x2F;uploads&#x2F;2015&#x2F;08&#x2F;wonderful-landscaping-ideas-for-front-of-house-and-backyard-with-cool-walkways-and-colorful-flower-plants-and-trees.jpg</code></pre></div><br/></div></div></div></div></div></div><div id="38896905" class="c"><input type="checkbox" id="c-38896905" checked=""/><div class="controls bullet"><span class="by">changoplatanero</span><span>|</span><a href="#38897197">prev</a><span>|</span><a href="#38897793">next</a><span>|</span><label class="collapse" for="c-38896905">[-]</label><label class="expand" for="c-38896905">[1 more]</label></div><br/><div class="children"><div class="content">I would not call those blurry thumbnail size images as reconstructions of the original image. Sure you can figure out what pose the person was in but you won’t see any detailed content and you won’t be able to identify the person.</div><br/></div></div><div id="38897793" class="c"><input type="checkbox" id="c-38897793" checked=""/><div class="controls bullet"><span class="by">dr_kiszonka</span><span>|</span><a href="#38896905">prev</a><span>|</span><a href="#38898243">next</a><span>|</span><label class="collapse" for="c-38897793">[-]</label><label class="expand" for="c-38897793">[1 more]</label></div><br/><div class="children"><div class="content">If we assumed this algorithm extracts all of the information from the hash, PhotoDNA would have many false positives given how poor the reconstructions are, correct?</div><br/></div></div><div id="38898243" class="c"><input type="checkbox" id="c-38898243" checked=""/><div class="controls bullet"><span class="by">chpatrick</span><span>|</span><a href="#38897793">prev</a><span>|</span><a href="#38896720">next</a><span>|</span><label class="collapse" for="c-38898243">[-]</label><label class="expand" for="c-38898243">[4 more]</label></div><br/><div class="children"><div class="content">Does there exist some kind of hash that preserves some notion of distance but which prevents recovery of the original data?<p>So f(X) is close to f(Y) if X and Y are themselves close, but without telling you about X or Y. Is that mathematically impossible?</div><br/><div id="38898735" class="c"><input type="checkbox" id="c-38898735" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#38898243">parent</a><span>|</span><a href="#38898435">next</a><span>|</span><label class="collapse" for="c-38898735">[-]</label><label class="expand" for="c-38898735">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  Does there exist some kind of hash that preserves some notion of distance but which prevents recovery of the original data?<p>I don&#x27;t think that&#x27;s possible. If you can hash a test image, and you can evaluate its &quot;distance&quot; from other images, an attacker can use that distance as a metric for a hill-climbing or simulated annealing algorithm.</div><br/></div></div><div id="38898435" class="c"><input type="checkbox" id="c-38898435" checked=""/><div class="controls bullet"><span class="by">qayxc</span><span>|</span><a href="#38898243">parent</a><span>|</span><a href="#38898735">prev</a><span>|</span><a href="#38896720">next</a><span>|</span><label class="collapse" for="c-38898435">[-]</label><label class="expand" for="c-38898435">[2 more]</label></div><br/><div class="children"><div class="content">Yes that is possible. Fully holomorphic encryption schemes allow functions to be evaluated on encrypted data without deciphering the data at any point, for example. The problem is that these techniques are very slow, which limits their practical use.</div><br/></div></div></div></div><div id="38896720" class="c"><input type="checkbox" id="c-38896720" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#38898243">prev</a><span>|</span><a href="#38898490">next</a><span>|</span><label class="collapse" for="c-38896720">[-]</label><label class="expand" for="c-38896720">[1 more]</label></div><br/><div class="children"><div class="content">The result here seems pretty lackluster tbh. Like maybe you get a blur of colour in the same place as the original.</div><br/></div></div><div id="38898490" class="c"><input type="checkbox" id="c-38898490" checked=""/><div class="controls bullet"><span class="by">programjames</span><span>|</span><a href="#38896720">prev</a><span>|</span><a href="#38896864">next</a><span>|</span><label class="collapse" for="c-38898490">[-]</label><label class="expand" for="c-38898490">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;d be interesting to see a diffusion model for this.</div><br/></div></div><div id="38896864" class="c"><input type="checkbox" id="c-38896864" checked=""/><div class="controls bullet"><span class="by">DJPocari</span><span>|</span><a href="#38898490">prev</a><span>|</span><a href="#38897238">next</a><span>|</span><label class="collapse" for="c-38896864">[-]</label><label class="expand" for="c-38896864">[4 more]</label></div><br/><div class="children"><div class="content">I wonder if Apple had some understanding of these advancements in inverting image hashes when they decided to drop their on-device image scanning plans.</div><br/><div id="38896876" class="c"><input type="checkbox" id="c-38896876" checked=""/><div class="controls bullet"><span class="by">echelon</span><span>|</span><a href="#38896864">parent</a><span>|</span><a href="#38897238">next</a><span>|</span><label class="collapse" for="c-38896876">[-]</label><label class="expand" for="c-38896876">[3 more]</label></div><br/><div class="children"><div class="content">They got push back from the &quot;screeching&quot; minority [1] about their needless and wanton surveillance.<p>[1] <a href="https:&#x2F;&#x2F;www.howtogeek.com&#x2F;746588&#x2F;apple-discusses-screeching-voices-of-the-minority-in-internal-memos&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.howtogeek.com&#x2F;746588&#x2F;apple-discusses-screeching-...</a></div><br/><div id="38897400" class="c"><input type="checkbox" id="c-38897400" checked=""/><div class="controls bullet"><span class="by">rustcleaner</span><span>|</span><a href="#38896864">root</a><span>|</span><a href="#38896876">parent</a><span>|</span><a href="#38897238">next</a><span>|</span><label class="collapse" for="c-38897400">[-]</label><label class="expand" for="c-38897400">[2 more]</label></div><br/><div class="children"><div class="content">That screeching minority needs to become a belligerently agitated majority...<p>... in a more perfect world maybe.</div><br/><div id="38898154" class="c"><input type="checkbox" id="c-38898154" checked=""/><div class="controls bullet"><span class="by">judge2020</span><span>|</span><a href="#38896864">root</a><span>|</span><a href="#38897400">parent</a><span>|</span><a href="#38897238">next</a><span>|</span><label class="collapse" for="c-38898154">[-]</label><label class="expand" for="c-38898154">[1 more]</label></div><br/><div class="children"><div class="content">What Apple forgot to market was the fact that it was only scanning photos that were destined for upload to iCloud Photos, which most people turn off because they don&#x27;t want to pay more than $1&#x2F;month for iCloud storage (or $4 if you happen to have a family).<p>Thankfully, they went forward with &quot;encrypt everything in iCloud E2E&quot;[0] despite not having a way to detect CSAM anymore, probably much to law enforcement&#x27;s chagrin.<p>0: <a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;108756" rel="nofollow">https:&#x2F;&#x2F;support.apple.com&#x2F;en-us&#x2F;108756</a></div><br/></div></div></div></div></div></div></div></div><div id="38897238" class="c"><input type="checkbox" id="c-38897238" checked=""/><div class="controls bullet"><span class="by">cf1241290841</span><span>|</span><a href="#38896864">prev</a><span>|</span><a href="#38897875">next</a><span>|</span><label class="collapse" for="c-38897238">[-]</label><label class="expand" for="c-38897238">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Neither details of the PhotoDNA algorithm nor an implementation is officially available to the public, but the algorithm has been reverse-engineered based on public documents<p>Sounds totally trustworthy</div><br/></div></div><div id="38897875" class="c"><input type="checkbox" id="c-38897875" checked=""/><div class="controls bullet"><span class="by">chipsa</span><span>|</span><a href="#38897238">prev</a><span>|</span><label class="collapse" for="c-38897875">[-]</label><label class="expand" for="c-38897875">[1 more]</label></div><br/><div class="children"><div class="content">PhotoDNA is officially non-invertible, because it’s used for CSAM, and if you can invert it, then anyone having the hashes also has CSAM.</div><br/></div></div></div></div></div></div></div></body></html>