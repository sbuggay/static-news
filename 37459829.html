<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1694422870094" as="style"/><link rel="stylesheet" href="styles.css?v=1694422870094"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://tmikov.blogspot.com/2023/09/how-to-speed-up-micro-benchmark-300x.html">Static Hermes: Compile JavaScript to speed it up 300x (in microbenchmarks)</a> <span class="domain">(<a href="https://tmikov.blogspot.com">tmikov.blogspot.com</a>)</span></div><div class="subtext"><span>unchar1</span> | <span>13 comments</span></div><br/><div><div id="37460794" class="c"><input type="checkbox" id="c-37460794" checked=""/><div class="controls bullet"><span class="by">jitl</span><span>|</span><a href="#37462080">next</a><span>|</span><label class="collapse" for="c-37460794">[-]</label><label class="expand" for="c-37460794">[6 more]</label></div><br/><div class="children"><div class="content">I wonder how this compares to v8 over the same code. Will v8 get this smart after running the benchmark? I’d test it myself but I’m on an iPhone right now. I wonder if static Hermes will ever end up at break-even or ahead of v8 - especially if doing a lot of FFI in WASM, Hermes might have a better shot at bypassing the memcopy&#x2F;TextDecoder needed to interop between browser JS strings and WASM utf8 strings in other languages.</div><br/><div id="37463749" class="c"><input type="checkbox" id="c-37463749" checked=""/><div class="controls bullet"><span class="by">iainmerrick</span><span>|</span><a href="#37460794">parent</a><span>|</span><a href="#37464326">next</a><span>|</span><label class="collapse" for="c-37463749">[-]</label><label class="expand" for="c-37463749">[3 more]</label></div><br/><div class="children"><div class="content">If your runtime is a JS interpreter, on iOS you’re almost always better off just using the OS’s interpreter (JSC). Your app will be smaller, and only the OS is allowed to do JIT so it will be much faster.<p>Even without the JIT restriction, you wouldn’t be able to beat JSC as it’s one of the fastest runtimes out there, pretty much level with V8.<p><i>Static</i> Hermes sounds like a different prospect, though, if it’s able to use TS annotations to compile to mostly-static native code. That could be great for genuinely high-performance TS code. (Although you wouldn’t want to immediately shackle it to React Native...)</div><br/><div id="37464053" class="c"><input type="checkbox" id="c-37464053" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#37460794">root</a><span>|</span><a href="#37463749">parent</a><span>|</span><a href="#37464049">next</a><span>|</span><label class="collapse" for="c-37464053">[-]</label><label class="expand" for="c-37464053">[1 more]</label></div><br/><div class="children"><div class="content">JavaScriptCore (the framework) does not use a JIT because it runs in-process. JavaScriptCore (running in a webview) does because it’s out-of-process.</div><br/></div></div><div id="37464049" class="c"><input type="checkbox" id="c-37464049" checked=""/><div class="controls bullet"><span class="by">jamil7</span><span>|</span><a href="#37460794">root</a><span>|</span><a href="#37463749">parent</a><span>|</span><a href="#37464053">prev</a><span>|</span><a href="#37464326">next</a><span>|</span><label class="collapse" for="c-37464049">[-]</label><label class="expand" for="c-37464049">[1 more]</label></div><br/><div class="children"><div class="content">I believe JIT is disabled in JSC itself on iOS, to take advantage of JIT in JSC you&#x27;d have to go through an out-of-process WKWebView instance.</div><br/></div></div></div></div><div id="37464326" class="c"><input type="checkbox" id="c-37464326" checked=""/><div class="controls bullet"><span class="by">ricardobeat</span><span>|</span><a href="#37460794">parent</a><span>|</span><a href="#37463749">prev</a><span>|</span><a href="#37462321">next</a><span>|</span><label class="collapse" for="c-37464326">[-]</label><label class="expand" for="c-37464326">[1 more]</label></div><br/><div class="children"><div class="content">Hermes itself is already faster than JSC, which is on par with V8. This just puts it way ahead and probably closer to Swift&#x2F;Kotlin code, at least in the realm of mobile apps.</div><br/></div></div></div></div><div id="37462080" class="c"><input type="checkbox" id="c-37462080" checked=""/><div class="controls bullet"><span class="by">andrewstuart</span><span>|</span><a href="#37460794">prev</a><span>|</span><a href="#37463651">next</a><span>|</span><label class="collapse" for="c-37462080">[-]</label><label class="expand" for="c-37462080">[3 more]</label></div><br/><div class="children"><div class="content">There&#x27;s not much sign of &quot;Static Hermes&quot; on the web. Appears to be a JavaScript compiler from facebook.<p>&quot;Static Hermes is the the next major version of Hermes, still under active development. It enables optional ahead-of-time native compilation of soundly typed JavaScript, using TypeScript or Flow type annotations.&quot;<p>I find the AI images in this presentation to be quite distracting for some reason.</div><br/><div id="37462114" class="c"><input type="checkbox" id="c-37462114" checked=""/><div class="controls bullet"><span class="by">sangelxyz</span><span>|</span><a href="#37462080">parent</a><span>|</span><a href="#37463574">next</a><span>|</span><label class="collapse" for="c-37462114">[-]</label><label class="expand" for="c-37462114">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s the runtime used in React Native.</div><br/></div></div><div id="37463574" class="c"><input type="checkbox" id="c-37463574" checked=""/><div class="controls bullet"><span class="by">zer0zzz</span><span>|</span><a href="#37462080">parent</a><span>|</span><a href="#37462114">prev</a><span>|</span><a href="#37463651">next</a><span>|</span><label class="collapse" for="c-37463574">[-]</label><label class="expand" for="c-37463574">[1 more]</label></div><br/><div class="children"><div class="content">The GitHub repo is there. Branch is static_h</div><br/></div></div></div></div><div id="37463651" class="c"><input type="checkbox" id="c-37463651" checked=""/><div class="controls bullet"><span class="by">fergie</span><span>|</span><a href="#37462080">prev</a><span>|</span><label class="collapse" for="c-37463651">[-]</label><label class="expand" for="c-37463651">[3 more]</label></div><br/><div class="children"><div class="content">That was an interesting read, but why do Hermes (and React, React Native, etc) still use javascript as a compile target rather than Wasm?</div><br/><div id="37464435" class="c"><input type="checkbox" id="c-37464435" checked=""/><div class="controls bullet"><span class="by">circuit10</span><span>|</span><a href="#37463651">parent</a><span>|</span><a href="#37463689">next</a><span>|</span><label class="collapse" for="c-37464435">[-]</label><label class="expand" for="c-37464435">[1 more]</label></div><br/><div class="children"><div class="content">Hermes is a JavaScript engine, where does being a compile target come into this?</div><br/></div></div><div id="37463689" class="c"><input type="checkbox" id="c-37463689" checked=""/><div class="controls bullet"><span class="by">iainmerrick</span><span>|</span><a href="#37463651">parent</a><span>|</span><a href="#37464435">prev</a><span>|</span><label class="collapse" for="c-37463689">[-]</label><label class="expand" for="c-37463689">[1 more]</label></div><br/><div class="children"><div class="content">Because the user’s code is typically written in JavaScript (or TypeScript)?<p>Wasm isn’t a great target for JS.</div><br/></div></div></div></div></div></div></div></div></div></body></html>