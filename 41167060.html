<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1722934862187" as="style"/><link rel="stylesheet" href="styles.css?v=1722934862187"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.philipotoole.com/building-rqlite-9-0-cutting-disk-usage-by-half/">Building rqlite 9.0: Cutting disk usage by half</a> <span class="domain">(<a href="https://www.philipotoole.com">www.philipotoole.com</a>)</span></div><div class="subtext"><span>otoolep</span> | <span>15 comments</span></div><br/><div><div id="41168749" class="c"><input type="checkbox" id="c-41168749" checked=""/><div class="controls bullet"><span class="by">yNeolh</span><span>|</span><a href="#41167850">next</a><span>|</span><label class="collapse" for="c-41168749">[-]</label><label class="expand" for="c-41168749">[1 more]</label></div><br/><div class="children"><div class="content">A little off-topic, but I love that the first paragraph describes the project. Usually, posts exclude that information, and the landing is not of more help.</div><br/></div></div><div id="41167850" class="c"><input type="checkbox" id="c-41167850" checked=""/><div class="controls bullet"><span class="by">west0n</span><span>|</span><a href="#41168749">prev</a><span>|</span><a href="#41168253">next</a><span>|</span><label class="collapse" for="c-41167850">[-]</label><label class="expand" for="c-41167850">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious about how rqlite&#x27;s performance compares to other distributed databases developed in Go, such as CockroachDB, Vitess, and TiDB.</div><br/><div id="41168044" class="c"><input type="checkbox" id="c-41168044" checked=""/><div class="controls bullet"><span class="by">jitl</span><span>|</span><a href="#41167850">parent</a><span>|</span><a href="#41168253">next</a><span>|</span><label class="collapse" for="c-41168044">[-]</label><label class="expand" for="c-41168044">[3 more]</label></div><br/><div class="children"><div class="content">It’s going to have much lower write throughput, since SQLite is single-writer and on top of that you need to do Raft consensus. TiDB and CockroachDB can handle concurrent writes easily. Cockroach runs raft per “range” of 128mb of the key space, I’m not as familiar with TiDB. Vitess is an orchestration layer over MySQL, and MySQL handles concurrent writes easily.</div><br/><div id="41168669" class="c"><input type="checkbox" id="c-41168669" checked=""/><div class="controls bullet"><span class="by">otoolep</span><span>|</span><a href="#41167850">root</a><span>|</span><a href="#41168044">parent</a><span>|</span><a href="#41168253">next</a><span>|</span><label class="collapse" for="c-41168669">[-]</label><label class="expand" for="c-41168669">[2 more]</label></div><br/><div class="children"><div class="content">rqlite creator here.<p>That&#x27;s correct, there is a write-performance hit for the reasons you say. All Raft systems will take the same hit, and SQLite is intrinsically single-writer -- nothing about rqlite changes that[2]. That said, there are approaches to increasing write-performance substantially. See [1] for much more information.<p>Write-performance is not the only thing to consider though (assuming one has sufficient performance in that dimension). Ease of deployment and operation are also important, and that&#x27;s an area in which rqlite excels[3] (at least I think so, but I&#x27;m biased).<p>[1] <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;guides&#x2F;performance&#x2F;" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;guides&#x2F;performance&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;faq&#x2F;#rqlite-is-distributed-does-that-mean-it-can-increase-sqlite-performance" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;faq&#x2F;#rqlite-is-distributed-does-that-...</a><p>[3] <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;faq&#x2F;#why-would-i-use-this-versus-some-other-distributed-database" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;faq&#x2F;#why-would-i-use-this-versus-some...</a></div><br/><div id="41168722" class="c"><input type="checkbox" id="c-41168722" checked=""/><div class="controls bullet"><span class="by">otoolep</span><span>|</span><a href="#41167850">root</a><span>|</span><a href="#41168669">parent</a><span>|</span><a href="#41168253">next</a><span>|</span><label class="collapse" for="c-41168722">[-]</label><label class="expand" for="c-41168722">[1 more]</label></div><br/><div class="children"><div class="content">Oh, I also presented some performance numbers in a presentation to a CMU a couple of years back. A little out-of-date, but gives a order-of-magnitude sense. <a href="https:&#x2F;&#x2F;youtu.be&#x2F;JLlIAWjvHxM?t=2690" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;JLlIAWjvHxM?t=2690</a><p>The biggest performance improvement since is due to the introduction of Queued Writes. See <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;api&#x2F;queued-writes&#x2F;" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;api&#x2F;queued-writes&#x2F;</a></div><br/></div></div></div></div></div></div></div></div><div id="41168253" class="c"><input type="checkbox" id="c-41168253" checked=""/><div class="controls bullet"><span class="by">djbusby</span><span>|</span><a href="#41167850">prev</a><span>|</span><a href="#41168158">next</a><span>|</span><label class="collapse" for="c-41168253">[-]</label><label class="expand" for="c-41168253">[1 more]</label></div><br/><div class="children"><div class="content">Cool! We use this but never had too much problems with disk usage (I&#x2F;o or size).  But, were only using to deploy configs across multiple nodes. And we read the local copy directly!</div><br/></div></div><div id="41168158" class="c"><input type="checkbox" id="c-41168158" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#41168253">prev</a><span>|</span><a href="#41167964">next</a><span>|</span><label class="collapse" for="c-41168158">[-]</label><label class="expand" for="c-41168158">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s been many years that I haven&#x27;t been working actively with databases anymore, but I have never heard about Raft or rq before. Is that system used by many &#x2F; by significant players?</div><br/><div id="41168206" class="c"><input type="checkbox" id="c-41168206" checked=""/><div class="controls bullet"><span class="by">hencoappel</span><span>|</span><a href="#41168158">parent</a><span>|</span><a href="#41168647">next</a><span>|</span><label class="collapse" for="c-41168206">[-]</label><label class="expand" for="c-41168206">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve not heard of rqlite, but raft is a popular consensus algorithm used by several quite a few notable systems including CockroachDB, MongoDB, RabbitMQ.
<a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Raft_(algorithm)" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Raft_(algorithm)</a></div><br/><div id="41168707" class="c"><input type="checkbox" id="c-41168707" checked=""/><div class="controls bullet"><span class="by">kitd</span><span>|</span><a href="#41168158">root</a><span>|</span><a href="#41168206">parent</a><span>|</span><a href="#41168647">next</a><span>|</span><label class="collapse" for="c-41168707">[-]</label><label class="expand" for="c-41168707">[1 more]</label></div><br/><div class="children"><div class="content">And now Kafka, without Zookeeper.</div><br/></div></div></div></div><div id="41168647" class="c"><input type="checkbox" id="c-41168647" checked=""/><div class="controls bullet"><span class="by">otoolep</span><span>|</span><a href="#41168158">parent</a><span>|</span><a href="#41168206">prev</a><span>|</span><a href="#41167964">next</a><span>|</span><label class="collapse" for="c-41168647">[-]</label><label class="expand" for="c-41168647">[1 more]</label></div><br/><div class="children"><div class="content">rqlite creator here.<p>One notable production user is Replicated: <a href="https:&#x2F;&#x2F;www.philipotoole.com&#x2F;replicated-postgres-to-rqlite&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.philipotoole.com&#x2F;replicated-postgres-to-rqlite&#x2F;</a></div><br/></div></div></div></div><div id="41167964" class="c"><input type="checkbox" id="c-41167964" checked=""/><div class="controls bullet"><span class="by">commercialnix</span><span>|</span><a href="#41168158">prev</a><span>|</span><a href="#41168788">next</a><span>|</span><label class="collapse" for="c-41167964">[-]</label><label class="expand" for="c-41167964">[1 more]</label></div><br/><div class="children"><div class="content">Looking forward to a Rust implementation.</div><br/></div></div><div id="41168788" class="c"><input type="checkbox" id="c-41168788" checked=""/><div class="controls bullet"><span class="by">ku1ik</span><span>|</span><a href="#41167964">prev</a><span>|</span><label class="collapse" for="c-41168788">[-]</label><label class="expand" for="c-41168788">[3 more]</label></div><br/><div class="children"><div class="content">Version 9.0 already? To me this unfortunately signals lack of focus and&#x2F;or disregard for backward compatibility, which means unnecessary churn for me as user of this project. Hard pass.</div><br/><div id="41168824" class="c"><input type="checkbox" id="c-41168824" checked=""/><div class="controls bullet"><span class="by">otoolep</span><span>|</span><a href="#41168788">parent</a><span>|</span><a href="#41168841">next</a><span>|</span><label class="collapse" for="c-41168824">[-]</label><label class="expand" for="c-41168824">[1 more]</label></div><br/><div class="children"><div class="content">rqlite creator here. That&#x27;s a mischaracterization.<p>rqlite has been in development for 10 years[1], it&#x27;s a long-running project and its design goals have never changed. The API hasn&#x27;t changed in a breaking fashion since 2016 and rqlite has supported seamless upgrades for years now.<p>In other words rqlite users have been upgrading from version to version for over 8 years, without having to change a single line of their code.<p>[1] <a href="https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;design&#x2F;" rel="nofollow">https:&#x2F;&#x2F;rqlite.io&#x2F;docs&#x2F;design&#x2F;</a></div><br/></div></div><div id="41168841" class="c"><input type="checkbox" id="c-41168841" checked=""/><div class="controls bullet"><span class="by">sevg</span><span>|</span><a href="#41168788">parent</a><span>|</span><a href="#41168824">prev</a><span>|</span><label class="collapse" for="c-41168841">[-]</label><label class="expand" for="c-41168841">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps do a bit more research before you spread FUD from a knee-jerk reaction to a version number.</div><br/></div></div></div></div></div></div></div></div></div></body></html>