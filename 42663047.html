<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1736586060714" as="style"/><link rel="stylesheet" href="styles.css?v=1736586060714"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://msgpack.org/">MessagePack: It&#x27;s like JSON, but fast and small.</a> <span class="domain">(<a href="https://msgpack.org">msgpack.org</a>)</span></div><div class="subtext"><span>davikr</span> | <span>24 comments</span></div><br/><div><div id="42664448" class="c"><input type="checkbox" id="c-42664448" checked=""/><div class="controls bullet"><span class="by">ubutler</span><span>|</span><a href="#42664447">next</a><span>|</span><label class="collapse" for="c-42664448">[-]</label><label class="expand" for="c-42664448">[1 more]</label></div><br/><div class="children"><div class="content">Although MessagePack is definitely <i>not</i> a drop-in replacement for JSON, it is certainly extremely useful.<p>Unlike JSON, you can’t just open a MessagePack file in Notepad or vim and have it make sense. It’s often not human readable. So using MessagePack to store config files probably isn’t a good idea if you or your users will ever need to read them for debugging purposes.<p>But as a format for something like IPC or high-performance, low-latency communication in general, MessagePack brings serious improvements over JSON.<p>I recently had to build an inference server that needed to be able to communicate with an API server with minimal latency.<p>I started with gRPC and protobuf since it’s what everyone recommends, yet after a lot of benchmarking, I found a way faster method to be serving MessagePack over HTTP with a Litestar Python server (it’s much faster than FastAPI), using msgspec for super fast MessagePack encoding and ormsgpack for super fast decoding.<p>Not sure how this beat protobuf and gRPC but it did. Perhaps the Python implementation is just slow. It was still faster than JSON over HTTP, however.</div><br/></div></div><div id="42664447" class="c"><input type="checkbox" id="c-42664447" checked=""/><div class="controls bullet"><span class="by">fshafique</span><span>|</span><a href="#42664448">prev</a><span>|</span><a href="#42664039">next</a><span>|</span><label class="collapse" for="c-42664447">[-]</label><label class="expand" for="c-42664447">[1 more]</label></div><br/><div class="children"><div class="content">Does it solve the problem of repeating set of keys in an object array, eg. when representing a table?<p>I don&#x27;t think using a dictionary of key values is the way to go here. I think there should be a dedicated &quot;table&quot; type, where the column keys are only defined once, and not repeated for every single row.</div><br/></div></div><div id="42664039" class="c"><input type="checkbox" id="c-42664039" checked=""/><div class="controls bullet"><span class="by">janalsncm</span><span>|</span><a href="#42664447">prev</a><span>|</span><a href="#42664186">next</a><span>|</span><label class="collapse" for="c-42664039">[-]</label><label class="expand" for="c-42664039">[1 more]</label></div><br/><div class="children"><div class="content">In my experience protobuf was smaller than MessagePack. I even tried compressing both with zstd and protobuf was still smaller. On the other hand protobuf is a lot less flexible.</div><br/></div></div><div id="42664186" class="c"><input type="checkbox" id="c-42664186" checked=""/><div class="controls bullet"><span class="by">toomim</span><span>|</span><a href="#42664039">prev</a><span>|</span><a href="#42664406">next</a><span>|</span><label class="collapse" for="c-42664186">[-]</label><label class="expand" for="c-42664186">[3 more]</label></div><br/><div class="children"><div class="content">MessagePack saves a little bit of space and CPU ... but not a lot:<p><a href="https:&#x2F;&#x2F;media.licdn.com&#x2F;dms&#x2F;image&#x2F;v2&#x2F;D5612AQF-nFt1cYZhKg&#x2F;article-inline_image-shrink_1000_1488&#x2F;article-inline_image-shrink_1000_1488&#x2F;0&#x2F;1703965440210?e=2147483647&amp;v=beta&amp;t=XOmhYJP5X6iYJ17RYsk3SjX9FTvfcZbQFP-OTOg6flk" rel="nofollow">https:&#x2F;&#x2F;media.licdn.com&#x2F;dms&#x2F;image&#x2F;v2&#x2F;D5612AQF-nFt1cYZhKg&#x2F;art...</a><p>Source: <a href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;pulse&#x2F;json-vs-messagepack-battle-data-efficiency-akshay-singh-kanawat-7dx2c" rel="nofollow">https:&#x2F;&#x2F;www.linkedin.com&#x2F;pulse&#x2F;json-vs-messagepack-battle-da...</a></div><br/><div id="42664300" class="c"><input type="checkbox" id="c-42664300" checked=""/><div class="controls bullet"><span class="by">koito17</span><span>|</span><a href="#42664186">parent</a><span>|</span><a href="#42664406">next</a><span>|</span><label class="collapse" for="c-42664300">[-]</label><label class="expand" for="c-42664300">[2 more]</label></div><br/><div class="children"><div class="content">An approximate 20% reduction in bandwidth looks significant to me. I think the problem here is that the chart uses a linear scale instead of a logarithmic scale.<p>Looking at the data, I&#x27;m inclined to agree that not much CPU is saved, but the point of MessagePack is to save bandwidth, and it seems to be doing a good job at that.</div><br/><div id="42664438" class="c"><input type="checkbox" id="c-42664438" checked=""/><div class="controls bullet"><span class="by">motorest</span><span>|</span><a href="#42664186">root</a><span>|</span><a href="#42664300">parent</a><span>|</span><a href="#42664406">next</a><span>|</span><label class="collapse" for="c-42664438">[-]</label><label class="expand" for="c-42664438">[1 more]</label></div><br/><div class="children"><div class="content">&gt; An approximate 20% reduction in bandwidth looks significant to me.<p>Significante with regards to what? Not doing anything? Flipping the toggle to compress the response?</div><br/></div></div></div></div></div></div><div id="42664406" class="c"><input type="checkbox" id="c-42664406" checked=""/><div class="controls bullet"><span class="by">eeasss</span><span>|</span><a href="#42664186">prev</a><span>|</span><a href="#42663939">next</a><span>|</span><label class="collapse" for="c-42664406">[-]</label><label class="expand" for="c-42664406">[1 more]</label></div><br/><div class="children"><div class="content">Serialziation vulnerabilities anyone</div><br/></div></div><div id="42663939" class="c"><input type="checkbox" id="c-42663939" checked=""/><div class="controls bullet"><span class="by">karteum</span><span>|</span><a href="#42664406">prev</a><span>|</span><a href="#42663832">next</a><span>|</span><label class="collapse" for="c-42663939">[-]</label><label class="expand" for="c-42663939">[1 more]</label></div><br/><div class="children"><div class="content">I discovered JSON Binpack recently, which works either schemaless (like msgpack) or - supposedly more efficiently - with a schema. I haven&#x27;t tried the codebase yet but it looks interesting.<p><a href="https:&#x2F;&#x2F;jsonbinpack.sourcemeta.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jsonbinpack.sourcemeta.com&#x2F;</a></div><br/></div></div><div id="42663832" class="c"><input type="checkbox" id="c-42663832" checked=""/><div class="controls bullet"><span class="by">slurpyb</span><span>|</span><a href="#42663939">prev</a><span>|</span><a href="#42664261">next</a><span>|</span><label class="collapse" for="c-42663832">[-]</label><label class="expand" for="c-42663832">[1 more]</label></div><br/><div class="children"><div class="content">Shouts to msgspec - i havent had a project without it in awhile.</div><br/></div></div><div id="42664261" class="c"><input type="checkbox" id="c-42664261" checked=""/><div class="controls bullet"><span class="by">agieocean</span><span>|</span><a href="#42663832">prev</a><span>|</span><a href="#42664005">next</a><span>|</span><label class="collapse" for="c-42664261">[-]</label><label class="expand" for="c-42664261">[1 more]</label></div><br/><div class="children"><div class="content">Made an open image format with this for constrained networks and it works great</div><br/></div></div><div id="42664005" class="c"><input type="checkbox" id="c-42664005" checked=""/><div class="controls bullet"><span class="by">mdhb</span><span>|</span><a href="#42664261">prev</a><span>|</span><a href="#42663129">next</a><span>|</span><label class="collapse" for="c-42664005">[-]</label><label class="expand" for="c-42664005">[3 more]</label></div><br/><div class="children"><div class="content">CBOR: It’s like JSON but fast and small but also an official IETF standard.<p><a href="https:&#x2F;&#x2F;cbor.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cbor.io&#x2F;</a></div><br/><div id="42664201" class="c"><input type="checkbox" id="c-42664201" checked=""/><div class="controls bullet"><span class="by">nmadden</span><span>|</span><a href="#42664005">parent</a><span>|</span><a href="#42663129">next</a><span>|</span><label class="collapse" for="c-42664201">[-]</label><label class="expand" for="c-42664201">[2 more]</label></div><br/><div class="children"><div class="content">CBOR is basically a fork of MsgPack. I prefer the original - it’s simpler and there are more high-quality implementations available.</div><br/><div id="42664415" class="c"><input type="checkbox" id="c-42664415" checked=""/><div class="controls bullet"><span class="by">jpc0</span><span>|</span><a href="#42664005">root</a><span>|</span><a href="#42664201">parent</a><span>|</span><a href="#42663129">next</a><span>|</span><label class="collapse" for="c-42664415">[-]</label><label class="expand" for="c-42664415">[1 more]</label></div><br/><div class="children"><div class="content">CBOR is actively used in the WebAuthN spec (passkeys) so browsers ship with en implementation... And if you intend to support it even via a library you will be shipping an implementation as well.<p><a href="https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webauthn-2&#x2F;#sctn-conforming-all-classes" rel="nofollow">https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webauthn-2&#x2F;#sctn-conforming-all-classe...</a></div><br/></div></div></div></div></div></div><div id="42663129" class="c"><input type="checkbox" id="c-42663129" checked=""/><div class="controls bullet"><span class="by">mattbillenstein</span><span>|</span><a href="#42664005">prev</a><span>|</span><a href="#42663891">next</a><span>|</span><label class="collapse" for="c-42663129">[-]</label><label class="expand" for="c-42663129">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve built a few systems using msgpack-rpc - serves really well as a transport format in my experience!</div><br/></div></div><div id="42663891" class="c"><input type="checkbox" id="c-42663891" checked=""/><div class="controls bullet"><span class="by">vdqtp3</span><span>|</span><a href="#42663129">prev</a><span>|</span><label class="collapse" for="c-42663891">[-]</label><label class="expand" for="c-42663891">[9 more]</label></div><br/><div class="children"><div class="content">Ignorant question - is the relatively small size benefit worth another standard that&#x27;s fairly opaque to troubleshooting and loses readability?<p>Is there a direct comparison of why someone should choose this over alternatives? 27 bytes down to 18 bytes (for their example) just doesn&#x27;t seem like enough of a benefit. This clearly isn&#x27;t targeted to me in either case, but for someone without much knowledge of the space, it seems like a solution in search of a problem.</div><br/><div id="42664445" class="c"><input type="checkbox" id="c-42664445" checked=""/><div class="controls bullet"><span class="by">diath</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42664451">next</a><span>|</span><label class="collapse" for="c-42664445">[-]</label><label class="expand" for="c-42664445">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s useful when dealing with high traffic networked services, the little saves here and there have compounding effects over time and save you a lot of bandwidth.</div><br/></div></div><div id="42664451" class="c"><input type="checkbox" id="c-42664451" checked=""/><div class="controls bullet"><span class="by">goodpoint</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42664445">prev</a><span>|</span><a href="#42664303">next</a><span>|</span><label class="collapse" for="c-42664451">[-]</label><label class="expand" for="c-42664451">[1 more]</label></div><br/><div class="children"><div class="content">MessagePack and CBOR allow zero-copy parsing.</div><br/></div></div><div id="42664303" class="c"><input type="checkbox" id="c-42664303" checked=""/><div class="controls bullet"><span class="by">palmfacehn</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42664451">prev</a><span>|</span><a href="#42663966">next</a><span>|</span><label class="collapse" for="c-42664303">[-]</label><label class="expand" for="c-42664303">[1 more]</label></div><br/><div class="children"><div class="content">It starts to make sense if you are returning a large array of objects and each object contains several long values. Unfortunately it looks like msgpack doesn&#x27;t support u128 or arbitrary precision big integers. I suppose you can always cast to byte[].</div><br/></div></div><div id="42663966" class="c"><input type="checkbox" id="c-42663966" checked=""/><div class="controls bullet"><span class="by">div3rs3</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42664303">prev</a><span>|</span><a href="#42663949">next</a><span>|</span><label class="collapse" for="c-42663966">[-]</label><label class="expand" for="c-42663966">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d argue the value goes up with larger payloads. The tradeoff is ease of use vs efficiency.</div><br/></div></div><div id="42663949" class="c"><input type="checkbox" id="c-42663949" checked=""/><div class="controls bullet"><span class="by">willhbr</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42663966">prev</a><span>|</span><a href="#42663944">next</a><span>|</span><label class="collapse" for="c-42663949">[-]</label><label class="expand" for="c-42663949">[1 more]</label></div><br/><div class="children"><div class="content">If you need a format that can transport byte arrays unmodified (image data, etc), msgpack (or protos or whatever) is much better than JSON since you don&#x27;t have to base64 encode or escape the data. It also supports non-string keys which can be convenient.</div><br/></div></div><div id="42663944" class="c"><input type="checkbox" id="c-42663944" checked=""/><div class="controls bullet"><span class="by">2muchcoffeeman</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42663949">prev</a><span>|</span><a href="#42663941">next</a><span>|</span><label class="collapse" for="c-42663944">[-]</label><label class="expand" for="c-42663944">[1 more]</label></div><br/><div class="children"><div class="content">I’m not sure why you wouldn’t just develop in json, then flick a switch to use binary.</div><br/></div></div><div id="42663941" class="c"><input type="checkbox" id="c-42663941" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#42663891">parent</a><span>|</span><a href="#42663944">prev</a><span>|</span><label class="collapse" for="c-42663941">[-]</label><label class="expand" for="c-42663941">[2 more]</label></div><br/><div class="children"><div class="content">We already have CBOR and other binary JSONs.</div><br/><div id="42664421" class="c"><input type="checkbox" id="c-42664421" checked=""/><div class="controls bullet"><span class="by">jakewins</span><span>|</span><a href="#42663891">root</a><span>|</span><a href="#42663941">parent</a><span>|</span><label class="collapse" for="c-42664421">[-]</label><label class="expand" for="c-42664421">[1 more]</label></div><br/><div class="children"><div class="content">CBOR is a clone of msgpack: <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;CBOR" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;CBOR</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>