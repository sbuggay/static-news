<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1714813258525" as="style"/><link rel="stylesheet" href="styles.css?v=1714813258525"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://alexgarcia.xyz/blog/2024/building-new-vector-search-sqlite/index.html">I’m writing a new vector search SQLite Extension</a> <span class="domain">(<a href="https://alexgarcia.xyz">alexgarcia.xyz</a>)</span></div><div class="subtext"><span>sebg</span> | <span>86 comments</span></div><br/><div><div id="40244002" class="c"><input type="checkbox" id="c-40244002" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40244002">[-]</label><label class="expand" for="c-40244002">[36 more]</label></div><br/><div class="children"><div class="content">Author here — happy to answer any questions! This is more of a &quot;I&#x27;m working on a new project&quot; rather than an official release, the extension itself is still a work-in-progress. A link to the project: <a href="https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec">https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec</a><p>I have a pretty specific vision of what v0.1.0 of this extension will look like, but it&#x27;ll take a few more weeks to get there. This blog post was more for letting users of sqlite-vss (a previous vector search SQLite extension I wrote) know what will be coming next. There will be a much bigger release when that is ready.<p>But in general, I&#x27;m super excited to have an easy embeddable vector search alternative! Especially one that runs on all operating system, in WASM, mobile devices, Raspberry Pis, etc. I personally I&#x27;m trying to run a lil&#x27; semantic search app on my Beepy[0], which is a ton of fun to play with.<p>[0] <a href="https:&#x2F;&#x2F;beepy.sqfmi.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;beepy.sqfmi.com&#x2F;</a></div><br/><div id="40249743" class="c"><input type="checkbox" id="c-40249743" checked=""/><div class="controls bullet"><span class="by">HanClinto</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40244090">next</a><span>|</span><label class="collapse" for="c-40249743">[-]</label><label class="expand" for="c-40249743">[2 more]</label></div><br/><div class="children"><div class="content">Awesome work!!<p>* Which distance functions does this support? Looks like it supports binary vectors already -- is Hamming distance supported?<p>* How does the performance compare with sqlite-vss? I&#x27;m curious about the profiling numbers -- both in terms of query speed, as well as memory usage.<p>Overall, this looks absolutely fantastic, and I love the direction you&#x27;re heading with all of this.<p>&gt; Though initially, sqlite-vec will only support exhaustive full-scan vector search. There will be no &quot;approximate nearest neighbors&quot; (ANN) options. But I hope to add IVF + HNSW in the future!<p>I think this is 1000% the correct approach -- kudos for not over-complicating things initially!  I&#x27;ve shipped on-device vector search (128-bit binary vectors, Hamming distance) and even with a database size of 200k+ entries, it was still fast enough to do full brute-force distance search on every camera frame -- even running on crappy phones it was fast enough to get 10+ fps, and nicer phones were buttery-smooth. It&#x27;s amazing how frequently brute-force is good enough.<p>That said, for implementing ANN algorithms like HNSW and whatnot, my first thought is that it would be slick if these could be accomplished with a table index paradigm -- so that switching from brute-force to ANN would be as simple as creating an index on your table. Experimenting with different ANN algorithms and parameters would be accomplished by adjusting the index creation parameters, and that would let developers smoothly evaluate and iterate between the various options. Maybe that&#x27;s where your mind is going with it already, but I figured I would mention it just in case.<p>Overall, awesome writeup, and fantastic project!!</div><br/><div id="40250882" class="c"><input type="checkbox" id="c-40250882" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40249743">parent</a><span>|</span><a href="#40244090">next</a><span>|</span><label class="collapse" for="c-40250882">[-]</label><label class="expand" for="c-40250882">[1 more]</label></div><br/><div class="children"><div class="content">re distance functions: current L2+cosine for float&#x2F;int8 vectors, and hamming for bit vectors. There are explicit vec_distance_l2()&#x2F;vec_distance_cosine()&#x2F;vec_distance_hamming() SQL functions, and the vec0 table will implicitly call the configured distance function on KNN queries.<p>re comparison to sqlite-vss: In general, since sqlite-vss uses Faiss, it&#x27;s much faster at KNN queries, and probably faster at fullscans. Faiss stores everything in memory and uses multithreading for &gt;10k vectors, so hard to beat that. sqlite-vec on the other hand doesnt use as much memory (vectors are read chunk-by-chunk), but it still relatively fast. There are SQLite settings like page_size&#x2F;mmap_size that can make things go faster as well.<p>For writes (ie INSERT&#x2F;UPDATE&#x2F;DELETE), sqlite-vec is much much faster. sqlite-vss requires a full index re-write for all writes, even single vector stuff. sqlite-vec on the other hand only writes to the effected vectors, so it&#x27;s MUCH more performant than sqlite-vss in that workflow specifically. I view it as sqlite-vss is more OLAP focused (many fast read and slow writes), and sqlite-vec is more OLTP focused (fast-enough reads and fast writes).<p>I agree, brute-force hamming distance is surprisingly super fast, especially for resource-constraint environments! Really looking forward to more embedding models to properly support binary vectors.<p>And yea, I&#x27;m still mulling over how ANN queries will work. My initial thought would be to add it to the vector column definition, like:<p><pre><code>  CREATE VIRTUAL TABLE vec_items USING vec0(
    title_embeddings float[768] indexed by HNSW(m=32)
  )
</code></pre>
Or something like that. But that means you&#x27;d need to recreate the table from scratch if you wanted to change the index. SQLite doesn&#x27;t have custom indexes, so it&#x27;s tricky for virtual tables. Then there&#x27;s the question of how you train it to begin with, so lots to explore there.<p><pre><code>  )</code></pre></div><br/></div></div></div></div><div id="40244090" class="c"><input type="checkbox" id="c-40244090" checked=""/><div class="controls bullet"><span class="by">lsb</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40249743">prev</a><span>|</span><a href="#40244689">next</a><span>|</span><label class="collapse" for="c-40244090">[-]</label><label class="expand" for="c-40244090">[7 more]</label></div><br/><div class="children"><div class="content">Would this implement indexing strategies like HNSW? Linear scan is obviously great to start out with, and can definitely be performant, especially if your data is in a reasonable order and under (say) 10MB, so this shouldn&#x27;t block a beta release.<p>Also do you build with sqlite-httpvfs? This would go together great <a href="https:&#x2F;&#x2F;github.com&#x2F;phiresky&#x2F;sql.js-httpvfs">https:&#x2F;&#x2F;github.com&#x2F;phiresky&#x2F;sql.js-httpvfs</a></div><br/><div id="40244148" class="c"><input type="checkbox" id="c-40244148" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244090">parent</a><span>|</span><a href="#40244689">next</a><span>|</span><label class="collapse" for="c-40244148">[-]</label><label class="expand" for="c-40244148">[6 more]</label></div><br/><div class="children"><div class="content">The initial v0.1.0 release will only have linear scans, but I want to support ANN indexes like IVF&#x2F;HNSW in the future! Wanted to focus on fullscans first to make things easier.<p>In my experiments you can get pretty far with linear scans using sqlite-vec. Depends on the number of dimensions of course, but I&#x27;d expect it can handle searching 100&#x27;s of thousands of vectors to maybe a million with sub-second searches, especially if you tweak some settings (page_size, mmap_size, etc.). And if you quantize your vectors (int8 reduces size 4x, binary 32x) you can get even faster, at the expense of quality. Or use Matryoshka embeddings[0] to shave down dimensions even more.<p>Building sql.js-httpvfs would be cool! Though I&#x27;m using the &quot;official&quot; SQLite WASM builds which came out after sql.js, so I don&#x27;t think it&#x27;ll be compatible out of the box. Would be very curious to see how much effort it would be to make a new HTTP VFS for SQLite&#x27;s new WASM builds<p>[0] <a href="https:&#x2F;&#x2F;huggingface.co&#x2F;blog&#x2F;matryoshka" rel="nofollow">https:&#x2F;&#x2F;huggingface.co&#x2F;blog&#x2F;matryoshka</a></div><br/><div id="40244678" class="c"><input type="checkbox" id="c-40244678" checked=""/><div class="controls bullet"><span class="by">mkesper</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244148">parent</a><span>|</span><a href="#40244232">next</a><span>|</span><label class="collapse" for="c-40244678">[-]</label><label class="expand" for="c-40244678">[1 more]</label></div><br/><div class="children"><div class="content">Have a look at <a href="https:&#x2F;&#x2F;jkatz05.com&#x2F;post&#x2F;postgres&#x2F;pgvector-performance-150x-speedup&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jkatz05.com&#x2F;post&#x2F;postgres&#x2F;pgvector-performance-150x-...</a> fp16 for indices seems to give a nice size compression without reducing quality with HNSW.</div><br/></div></div><div id="40244232" class="c"><input type="checkbox" id="c-40244232" checked=""/><div class="controls bullet"><span class="by">sroussey</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244148">parent</a><span>|</span><a href="#40244678">prev</a><span>|</span><a href="#40253873">next</a><span>|</span><label class="collapse" for="c-40244232">[-]</label><label class="expand" for="c-40244232">[3 more]</label></div><br/><div class="children"><div class="content">Might have a look at this library:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;unum-cloud&#x2F;usearch">https:&#x2F;&#x2F;github.com&#x2F;unum-cloud&#x2F;usearch</a><p>It does HNSW and there is a SQLite related project, though not quite the same thing.</div><br/><div id="40244277" class="c"><input type="checkbox" id="c-40244277" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244232">parent</a><span>|</span><a href="#40253873">next</a><span>|</span><label class="collapse" for="c-40244277">[-]</label><label class="expand" for="c-40244277">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for sharing! I&#x27;ve looked into usearch before, it&#x27;s really sleek, especially all their language bindings. Though I want sqlite-vec to have total control over what stays in-memory vs on-disk during searches, and most vector search libraries like usearch&#x2F;hnswlib&#x2F;faiss&#x2F;annoy either always store in-memory or don&#x27;t offer hooks for other storage systems.<p>Additionally, sqlite-vec takes advantage of some SQLite specific APIs, like BLOB I&#x2F;O [0], which I hope would speed things up a ton. It&#x27;s a ton more work, coming up with new storage solutions that are backed by SQLite shadow tables, but I think it&#x27;ll be work it!<p>And I also like how sqlite-vec is just a single sqlite-vec.c file. It makes linking + cross-compiling super easy, and since I got burned relying on heavy C++ dependencies with sqlite-vss, a no-dependency rule feels good. Mostly inspired by SQLite single-file sqlite3.c amalgamation, and Josh Baker&#x27;s single file C projects like tg[1].<p>[0] <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;c3ref&#x2F;blob_open.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;c3ref&#x2F;blob_open.html</a><p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;tg">https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;tg</a></div><br/><div id="40248112" class="c"><input type="checkbox" id="c-40248112" checked=""/><div class="controls bullet"><span class="by">ashvardanian</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244277">parent</a><span>|</span><a href="#40253873">next</a><span>|</span><label class="collapse" for="c-40248112">[-]</label><label class="expand" for="c-40248112">[1 more]</label></div><br/><div class="children"><div class="content">USearch author here :)<p>You are right. I don&#x27;t yet support pluggable storage systems, but you can check the Lantern&#x27;s fork of USearch. It may have the right capabilities, as they wanted the same level of integration for Postgres.<p>Our current SQLite extension brings &quot;search APIs&quot; to SQLite but not the index itself. Think of it as a bundle of SIMD-vectorized Cosine&#x2F;Dot&#x2F;L2&#x2F;Hamming&#x2F;Jaccard... (for vectors) and Levenshtein&#x2F;Hamming&#x2F;NW (for text) distances coming from SimSIMD and StringZilla. Unlike USearch, the latter are pure C 99 header-only libraries, in case you need smth similar.<p>Best of luck with your project!</div><br/></div></div></div></div></div></div><div id="40253873" class="c"><input type="checkbox" id="c-40253873" checked=""/><div class="controls bullet"><span class="by">sdenton4</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244148">parent</a><span>|</span><a href="#40244232">prev</a><span>|</span><a href="#40244689">next</a><span>|</span><label class="collapse" for="c-40253873">[-]</label><label class="expand" for="c-40253873">[1 more]</label></div><br/><div class="children"><div class="content">DiskANN is worth taking a look at; their game is fast graph based search using an index on disk.</div><br/></div></div></div></div></div></div><div id="40244689" class="c"><input type="checkbox" id="c-40244689" checked=""/><div class="controls bullet"><span class="by">TachyonicBytes</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40244090">prev</a><span>|</span><a href="#40247409">next</a><span>|</span><label class="collapse" for="c-40244689">[-]</label><label class="expand" for="c-40244689">[2 more]</label></div><br/><div class="children"><div class="content">Really nice to see Wasm there, usually vector search in sqlite wasn&#x27;t available in the browser.<p>Did you ever consider making it syntax compatible with pgvector, in order to have a common SQL vector DSL? I am sure the benefits are much smaller than the disadvantages, but I&#x27;m curious if it&#x27;s possible.</div><br/><div id="40244839" class="c"><input type="checkbox" id="c-40244839" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244689">parent</a><span>|</span><a href="#40247409">next</a><span>|</span><label class="collapse" for="c-40244839">[-]</label><label class="expand" for="c-40244839">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not possible to match pgvector&#x27;s syntax with SQLite. SQLite doesn&#x27;t have custom indexes, and since I want to have full control of how vectors are stored on disk, the only real way to do that in SQLite is with virtual tables[0]. And there&#x27;s a few other smaller details that don&#x27;t match (postgres operators like &lt;-&gt;&#x2F;&lt;=&gt;, SQLite&#x27;s limited virtual table constraints, etc.), so matching pgvector wasn&#x27;t a priority.<p>I instead tried to match SQLite&#x27;s FTS5 full text search[1] extension where possible. It solves a similar problem: storing data in its own optimized format with a virtual table, so offering a similar API seemed appropriate.<p>Plus, there&#x27;s a few quirks with the pgvector API that I don&#x27;t quite like (like vector column definitions), so starting from scratch is nice!<p>[0] <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;vtab.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;vtab.html</a><p>[1] <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;fts5.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;fts5.html</a></div><br/></div></div></div></div><div id="40247409" class="c"><input type="checkbox" id="c-40247409" checked=""/><div class="controls bullet"><span class="by">datadeft</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40244689">prev</a><span>|</span><a href="#40253272">next</a><span>|</span><label class="collapse" for="c-40247409">[-]</label><label class="expand" for="c-40247409">[2 more]</label></div><br/><div class="children"><div class="content">Could this be implemented in Rust? Does that project (sqlite-loadable-rs) support WASM?<p><a href="https:&#x2F;&#x2F;observablehq.com&#x2F;@asg017&#x2F;introducing-sqlite-loadable-rs" rel="nofollow">https:&#x2F;&#x2F;observablehq.com&#x2F;@asg017&#x2F;introducing-sqlite-loadable...</a></div><br/><div id="40248326" class="c"><input type="checkbox" id="c-40248326" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40247409">parent</a><span>|</span><a href="#40253272">next</a><span>|</span><label class="collapse" for="c-40248326">[-]</label><label class="expand" for="c-40248326">[1 more]</label></div><br/><div class="children"><div class="content">It will! I&#x27;ve neglected that project a bit, but in some of the alpha builds I was able to get WASM to work, I just have documented or blogged about it yet. SQLite extensions in WASM written with sqlite-loadable-rs are a bit large, mostly because of Rust. But it&#x27;s possible!</div><br/></div></div></div></div><div id="40253272" class="c"><input type="checkbox" id="c-40253272" checked=""/><div class="controls bullet"><span class="by">israrkhan</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40247409">prev</a><span>|</span><a href="#40245091">next</a><span>|</span><label class="collapse" for="c-40253272">[-]</label><label class="expand" for="c-40253272">[1 more]</label></div><br/><div class="children"><div class="content">This is awesome. In past I worked on adding support for meta-data queries to faiss DB, by hooking up faiss db with SQlite, but this approach (Sqlite extension) is much more cleaner and better. Not sure about performance though.</div><br/></div></div><div id="40245091" class="c"><input type="checkbox" id="c-40245091" checked=""/><div class="controls bullet"><span class="by">jeanloolz</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40253272">prev</a><span>|</span><a href="#40244217">next</a><span>|</span><label class="collapse" for="c-40245091">[-]</label><label class="expand" for="c-40245091">[4 more]</label></div><br/><div class="children"><div class="content">I originally added sqlite-vss (your original vector search implementation) on Langchain as a vectorstore. Do you think this one is mature enough to add on Langchain, or should I wait a bit?<p>Love your work by the way, I have been using sqlite-vss on a few projects already.</div><br/><div id="40248131" class="c"><input type="checkbox" id="c-40248131" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40245091">parent</a><span>|</span><a href="#40246323">next</a><span>|</span><label class="collapse" for="c-40248131">[-]</label><label class="expand" for="c-40248131">[2 more]</label></div><br/><div class="children"><div class="content">Hey really cool to see re sqlite-vss+langchain! You could try a langchain integration now, there&#x27;s an (undocumented) sqlite-vec pypi package you can install that&#x27;s similar to the sqlite-vss one. Though I&#x27;d only try it for dev stuff now (or stick to alpha releases), but things will be much more stable when v0.1.0 comes out. Though I doubt the main SQL API (the vec0 table) syntax will change much between now and then.</div><br/><div id="40248306" class="c"><input type="checkbox" id="c-40248306" checked=""/><div class="controls bullet"><span class="by">jeanloolz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40248131">parent</a><span>|</span><a href="#40246323">next</a><span>|</span><label class="collapse" for="c-40248306">[-]</label><label class="expand" for="c-40248306">[1 more]</label></div><br/><div class="children"><div class="content">Cool beans!
I&#x27;ll look into it soon then</div><br/></div></div></div></div><div id="40246323" class="c"><input type="checkbox" id="c-40246323" checked=""/><div class="controls bullet"><span class="by">davedx</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40245091">parent</a><span>|</span><a href="#40248131">prev</a><span>|</span><a href="#40244217">next</a><span>|</span><label class="collapse" for="c-40246323">[-]</label><label class="expand" for="c-40246323">[1 more]</label></div><br/><div class="children"><div class="content">He says in the blog post and here that this isn&#x27;t finished yet</div><br/></div></div></div></div><div id="40244217" class="c"><input type="checkbox" id="c-40244217" checked=""/><div class="controls bullet"><span class="by">xyc</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40245091">prev</a><span>|</span><a href="#40245505">next</a><span>|</span><label class="collapse" for="c-40244217">[-]</label><label class="expand" for="c-40244217">[3 more]</label></div><br/><div class="children"><div class="content">This is awesome! We used Qdrant vector DB for a local AI RAG app <a href="https:&#x2F;&#x2F;recurse.chat&#x2F;blog&#x2F;posts&#x2F;local-docs#vector-database" rel="nofollow">https:&#x2F;&#x2F;recurse.chat&#x2F;blog&#x2F;posts&#x2F;local-docs#vector-database</a>, but was eyeing up sqlite-vss as a lightweight embedded solution. Excited to see you are making a successor. Would be interested to learn about latency and scalability benchmarks.</div><br/><div id="40244292" class="c"><input type="checkbox" id="c-40244292" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244217">parent</a><span>|</span><a href="#40245505">next</a><span>|</span><label class="collapse" for="c-40244292">[-]</label><label class="expand" for="c-40244292">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s great to hear, thanks for sharing! Will definitely have benchmarks to share later<p>Would love to hear about the scale of the vector data you&#x27;re working with in your local app. Do you actually find yourself with &gt; 1 million vectors? Do you get away with just storing it all in-memory?</div><br/><div id="40244399" class="c"><input type="checkbox" id="c-40244399" checked=""/><div class="controls bullet"><span class="by">xyc</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244292">parent</a><span>|</span><a href="#40245505">next</a><span>|</span><label class="collapse" for="c-40244399">[-]</label><label class="expand" for="c-40244399">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think we need &gt; 1 million vector yet. But we plan to target folder of local document such as obsidian vault or store web search results which could rack up a large number of vectors. Persistence on disk is also a desired feature when looking at the choices because we don&#x27;t want to reindex existing files.<p>Benchmark is also not everything, easiness to embed and integrate with existing sqlite apps could make sqlite-vec stand out and help with adoption.</div><br/></div></div></div></div></div></div><div id="40245505" class="c"><input type="checkbox" id="c-40245505" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40244217">prev</a><span>|</span><a href="#40251878">next</a><span>|</span><label class="collapse" for="c-40245505">[-]</label><label class="expand" for="c-40245505">[2 more]</label></div><br/><div class="children"><div class="content">Very exciting and I can’t wait to try it. Dependency issues are the reason I am currently not using sqlite-vss (i.e. not using an index for my vector searches), but man do I wish for better performance.<p>At the risk of fulfilling a HN stereotype, may I ask why you ditched Rust for this extension?</div><br/><div id="40248390" class="c"><input type="checkbox" id="c-40248390" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40245505">parent</a><span>|</span><a href="#40251878">next</a><span>|</span><label class="collapse" for="c-40248390">[-]</label><label class="expand" for="c-40248390">[1 more]</label></div><br/><div class="children"><div class="content">Went back, and forth a lot, but the short version:<p>1. Having directly access to SQLite&#x27;s C APIs is really useful, especially for BLOB I&#x2F;O and some rarely-used APIs that sqlite-vec uses and aren&#x27;t available in some SQLite&#x2F;Rust bindings<p>2. Writing in Rust for this project would have meant adding a few dependencies which would make some builds a bit more complicated<p>3. Pure C means easier to compile for some targets I wanted to support, like WASM&#x2F;mobile devices&#x2F;raspberry pis<p>4. A single sqlite-vec.c&#x2F;h file means you can drag+drop a single file into your C projects and &quot;it just works&quot;<p>5. I wanted full control over what stays in memory and what doesn&#x27;t, and it&#x27;s a bit easier to do so in C (at least in my brain)<p>6. Most vector search operations aren&#x27;t too complicated, so I feel comfortable manually handling memory access. You work with fixed length vectors, pretty easy to do manual checks for. If it required a lot of string parsing&#x2F;validation or other dicey work, then Rust would have been a godsend, but vector search specifically fits C pretty well.<p>7. Ton of C&#x2F;C++ vector search examples I could reference from Faiss&#x2F;hnswlib&#x2F;annoy</div><br/></div></div></div></div><div id="40251878" class="c"><input type="checkbox" id="c-40251878" checked=""/><div class="controls bullet"><span class="by">bendavis381</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40245505">prev</a><span>|</span><a href="#40244625">next</a><span>|</span><label class="collapse" for="c-40251878">[-]</label><label class="expand" for="c-40251878">[3 more]</label></div><br/><div class="children"><div class="content">Very very excited by this! I saw on the repo that `sqlite-vec` will support `row in`?</div><br/><div id="40252194" class="c"><input type="checkbox" id="c-40252194" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40251878">parent</a><span>|</span><a href="#40244625">next</a><span>|</span><label class="collapse" for="c-40252194">[-]</label><label class="expand" for="c-40252194">[2 more]</label></div><br/><div class="children"><div class="content">Ya you&#x27;ll be able to do things like:<p><pre><code>  SELECT 
    rowid,
    distance
  FROM vec_items
  WHERE rowid IN (SELECT rowid FROM ...)
    AND title_embeddings MATCH ?
  ORDER BY distance
  LIMIT 10
</code></pre>
^ This would do a KNN style query, k=10, but only include results where the item&#x27;s rowid is included in the (...) subquery. This is a half-measure for metadata filtering, by pre-filtering which items should be considered in the KNN search.<p>It&#x27;s currently a bit slow, and not the best solution. Eventually there will be support for metadata column in vec0 tables, which with trickery should be much faster, but isn&#x27;t planned for v0.1.0.</div><br/><div id="40252706" class="c"><input type="checkbox" id="c-40252706" checked=""/><div class="controls bullet"><span class="by">bendavis381</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40252194">parent</a><span>|</span><a href="#40244625">next</a><span>|</span><label class="collapse" for="c-40252706">[-]</label><label class="expand" for="c-40252706">[1 more]</label></div><br/><div class="children"><div class="content">Nice. So if I understand correctly, pre-filtering means we&#x27;d get 10 results here if there are at least 10 returned from the subquery?</div><br/></div></div></div></div></div></div><div id="40244625" class="c"><input type="checkbox" id="c-40244625" checked=""/><div class="controls bullet"><span class="by">nnx</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40251878">prev</a><span>|</span><a href="#40250936">next</a><span>|</span><label class="collapse" for="c-40244625">[-]</label><label class="expand" for="c-40244625">[2 more]</label></div><br/><div class="children"><div class="content">Interesting idea.<p>Do you intend to compress the vector storage in any way and do you intend to implement your own vector search algorithms or reuse some already optimized libraries like usearch?</div><br/><div id="40244862" class="c"><input type="checkbox" id="c-40244862" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40244625">parent</a><span>|</span><a href="#40250936">next</a><span>|</span><label class="collapse" for="c-40244862">[-]</label><label class="expand" for="c-40244862">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t have plans for compressed vector storage. There is support for int8&#x2F;binary quantization, which can reduce the size of stored vectors drastically, but impacts performance quite a lot. I&#x27;d like to support something like product quantization[0] in the future, though!<p>No plans for using usearch or another vector search library, either. I want to keep dependencies low to make compilingeasy, and I want full control for how vectors are stored on-disk and in-memory.<p>[0] <a href="https:&#x2F;&#x2F;www.pinecone.io&#x2F;learn&#x2F;series&#x2F;faiss&#x2F;product-quantization&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.pinecone.io&#x2F;learn&#x2F;series&#x2F;faiss&#x2F;product-quantizat...</a></div><br/></div></div></div></div><div id="40250936" class="c"><input type="checkbox" id="c-40250936" checked=""/><div class="controls bullet"><span class="by">Technetium</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40244625">prev</a><span>|</span><a href="#40245266">next</a><span>|</span><label class="collapse" for="c-40250936">[-]</label><label class="expand" for="c-40250936">[2 more]</label></div><br/><div class="children"><div class="content">Can you include a license? Will it be MIT like sqlite-vss?</div><br/><div id="40251118" class="c"><input type="checkbox" id="c-40251118" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40250936">parent</a><span>|</span><a href="#40245266">next</a><span>|</span><label class="collapse" for="c-40251118">[-]</label><label class="expand" for="c-40251118">[1 more]</label></div><br/><div class="children"><div class="content">Ya I&#x27;ll put a license soon, will be MIT</div><br/></div></div></div></div><div id="40245266" class="c"><input type="checkbox" id="c-40245266" checked=""/><div class="controls bullet"><span class="by">tipsytoad</span><span>|</span><a href="#40244002">parent</a><span>|</span><a href="#40250936">prev</a><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40245266">[-]</label><label class="expand" for="c-40245266">[5 more]</label></div><br/><div class="children"><div class="content">Looks really nice, but the only concern I had — how does the perf compare to more mature libraries like faiss?</div><br/><div id="40248216" class="c"><input type="checkbox" id="c-40248216" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40245266">parent</a><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40248216">[-]</label><label class="expand" for="c-40248216">[4 more]</label></div><br/><div class="children"><div class="content">Benchmarking for this project is a bit weird, since 1) only linear scans are supported, and 2) it&#x27;s an &quot;embeddable&quot; vector search tool, so it doesn&#x27;t make a lot of sense to benchmark against &quot;server&quot; vector databases like qdrant or pinecone.<p>That being said, ~generally~ I&#x27;d say it&#x27;s faster than using numpy and tools like txtai&#x2F;chromadb. Faiss and hnswlib (bruteforce) are faster because they store everything in memory and use multiple threads. But for smaller vector indexes, I don&#x27;t think you&#x27;d notice much of a difference. sqlite-vec has some support for SIMD operations, which speeds things up quite a bit, but Faiss still takes the cake.</div><br/><div id="40249776" class="c"><input type="checkbox" id="c-40249776" checked=""/><div class="controls bullet"><span class="by">dmezzetti</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40248216">parent</a><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40249776">[-]</label><label class="expand" for="c-40249776">[3 more]</label></div><br/><div class="children"><div class="content">Author of txtai here - great work with this extension.<p>I wouldn&#x27;t consider it a &quot;this or that&quot; decision. While txtai does combine Faiss and SQLite, it could also utilize this extension. The same task was just done for Postgres + pgvector. txtai is not tied to any particular backend components.</div><br/><div id="40251054" class="c"><input type="checkbox" id="c-40251054" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40249776">parent</a><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40251054">[-]</label><label class="expand" for="c-40251054">[2 more]</label></div><br/><div class="children"><div class="content">Ya I worded this part awkwardly - I was hinting that querying a vector index and joining with metadata with sqlite + sqlite-vec (in a single SQL join) will probably be faster than other methods, like txtai, which do the joining phase in a higher level like Python. Which isn&#x27;t a fair comparison, especially since txtai can switch to much faster vector stores, but I think is fair for most embedded use-cases.<p>That being said, txtai offers way more than sqlite-vec, like builtin embedding models and other nice LLM features, so it&#x27;s definitely apples to oranges.</div><br/><div id="40251552" class="c"><input type="checkbox" id="c-40251552" checked=""/><div class="controls bullet"><span class="by">dmezzetti</span><span>|</span><a href="#40244002">root</a><span>|</span><a href="#40251054">parent</a><span>|</span><a href="#40243906">next</a><span>|</span><label class="collapse" for="c-40251552">[-]</label><label class="expand" for="c-40251552">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll keep an eye on this extension.<p>With this, what DuckDB just added and pgvector, we&#x27;re seeing a blurring of the lines. Back in 2021, there wasn&#x27;t a RDBMS that had native vector support. But native vector integration makes it possible for txtai to just run SQL-driven vector queries...exciting times.<p>I think systems that bet on existing databases eventually catching up (as is txtai&#x27;s model) vs trying to reinvent the entire database stack will win out.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40243906" class="c"><input type="checkbox" id="c-40243906" checked=""/><div class="controls bullet"><span class="by">barakm</span><span>|</span><a href="#40244002">prev</a><span>|</span><a href="#40246236">next</a><span>|</span><label class="collapse" for="c-40243906">[-]</label><label class="expand" for="c-40243906">[7 more]</label></div><br/><div class="children"><div class="content">&gt; Thy are binary vectors with 768 dimensions, which takes up 96 bytes (768 &#x2F; 8 = 96).<p>I guess I’m confused. This is honestly the problem that most vector storage faces (“curse of dimensionality”) let alone the indexing.<p>I assume that you meant 768 dimensions * 8 bytes (for a f64) which is 6144 bytes.  Usually, these get shrunk with some (hopefully minor) loss, so like a f32 or f16 (or smaller!).<p>If you can post how you fit 768 dimensions in 96 bytes, even with compression or trie-equivalent amortization, or whatever… I’d love to hear more about that for another post.<p>Ninja edit: Unless you’re treating each dimension as one-bit? But then I still have questions around retrieval quality</div><br/><div id="40243952" class="c"><input type="checkbox" id="c-40243952" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40243906">parent</a><span>|</span><a href="#40243924">next</a><span>|</span><label class="collapse" for="c-40243952">[-]</label><label class="expand" for="c-40243952">[2 more]</label></div><br/><div class="children"><div class="content">Author here - ya &quot;binary vectors&quot; means quantizing to one bit per dimension. Normally it would be 4 * dimensions bytes of space per vector (where 4=sizeof(float)).  Some embedding models, like nomic v1.5[0] and mixedbread&#x27;s new model[1] are specifically trained to retain quality after binary quantization. Not all models do tho, so results may vary. I think in general for really large vectors, like OpenAI&#x27;s large embeddings model with 3072 dimensions, it kindof works, even if they didn&#x27;t specifically train for it.<p>[0] <a href="https:&#x2F;&#x2F;twitter.com&#x2F;nomic_ai&#x2F;status&#x2F;1769837800793243687" rel="nofollow">https:&#x2F;&#x2F;twitter.com&#x2F;nomic_ai&#x2F;status&#x2F;1769837800793243687</a><p>[1] <a href="https:&#x2F;&#x2F;www.mixedbread.ai&#x2F;blog&#x2F;binary-mrl" rel="nofollow">https:&#x2F;&#x2F;www.mixedbread.ai&#x2F;blog&#x2F;binary-mrl</a></div><br/><div id="40243978" class="c"><input type="checkbox" id="c-40243978" checked=""/><div class="controls bullet"><span class="by">barakm</span><span>|</span><a href="#40243906">root</a><span>|</span><a href="#40243952">parent</a><span>|</span><a href="#40243924">next</a><span>|</span><label class="collapse" for="c-40243978">[-]</label><label class="expand" for="c-40243978">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! As you keep posting your progress, and I hope you do, adding these references would probably help warding off crusty fuddy-duddys like me (or at least give them more to research either way) ;)</div><br/></div></div></div></div><div id="40243924" class="c"><input type="checkbox" id="c-40243924" checked=""/><div class="controls bullet"><span class="by">lsb</span><span>|</span><a href="#40243906">parent</a><span>|</span><a href="#40243952">prev</a><span>|</span><a href="#40248917">next</a><span>|</span><label class="collapse" for="c-40243924">[-]</label><label class="expand" for="c-40243924">[3 more]</label></div><br/><div class="children"><div class="content">Binary, quantize each dimension to +1 or -1<p>You can try out binary vectors, in comparison to quantize every pair of vectors to one of four values, and a lot more, by using a FAISS index on your data, and using Product Quantization (like PQ768x1 for binary features in this case) <a href="https:&#x2F;&#x2F;github.com&#x2F;facebookresearch&#x2F;faiss&#x2F;wiki&#x2F;The-index-factory">https:&#x2F;&#x2F;github.com&#x2F;facebookresearch&#x2F;faiss&#x2F;wiki&#x2F;The-index-fac...</a></div><br/><div id="40243954" class="c"><input type="checkbox" id="c-40243954" checked=""/><div class="controls bullet"><span class="by">barakm</span><span>|</span><a href="#40243906">root</a><span>|</span><a href="#40243924">parent</a><span>|</span><a href="#40248917">next</a><span>|</span><label class="collapse" for="c-40243954">[-]</label><label class="expand" for="c-40243954">[2 more]</label></div><br/><div class="children"><div class="content">Appreciate the link; but would still like to know how well it works.<p>If you have a link for that, I’d be much obliged</div><br/><div id="40243990" class="c"><input type="checkbox" id="c-40243990" checked=""/><div class="controls bullet"><span class="by">lsb</span><span>|</span><a href="#40243906">root</a><span>|</span><a href="#40243954">parent</a><span>|</span><a href="#40248917">next</a><span>|</span><label class="collapse" for="c-40243990">[-]</label><label class="expand" for="c-40243990">[1 more]</label></div><br/><div class="children"><div class="content">It depends on your data and your embedding model. For example, I was able to quantize embeddings of English Wikipedia from 384-dimensions down to 48 7-bit dimensions, and the search works great: <a href="https:&#x2F;&#x2F;www.leebutterman.com&#x2F;2023&#x2F;06&#x2F;01&#x2F;offline-realtime-embedding-search.html" rel="nofollow">https:&#x2F;&#x2F;www.leebutterman.com&#x2F;2023&#x2F;06&#x2F;01&#x2F;offline-realtime-emb...</a></div><br/></div></div></div></div></div></div><div id="40248917" class="c"><input type="checkbox" id="c-40248917" checked=""/><div class="controls bullet"><span class="by">queuebert</span><span>|</span><a href="#40243906">parent</a><span>|</span><a href="#40243924">prev</a><span>|</span><a href="#40246236">next</a><span>|</span><label class="collapse" for="c-40248917">[-]</label><label class="expand" for="c-40248917">[1 more]</label></div><br/><div class="children"><div class="content">BTW, the &quot;curse of dimensionality&quot; technically refers to the relative sparsity of high-dimensional space and the need for geometrically increasing data to fill it. It has nothing to do with storage. And typically in vector databases the data are compressed&#x2F;projected into a lower dimensionality space before storage, which actually improves the situation.</div><br/></div></div></div></div><div id="40246236" class="c"><input type="checkbox" id="c-40246236" checked=""/><div class="controls bullet"><span class="by">yard2010</span><span>|</span><a href="#40243906">prev</a><span>|</span><a href="#40250624">next</a><span>|</span><label class="collapse" for="c-40246236">[-]</label><label class="expand" for="c-40246236">[2 more]</label></div><br/><div class="children"><div class="content">Thank you for creating sqlite-vss. It helped me learn how RAG works and implement one in my toy project. It was a bit hard to debug but it worked FLAWLESSLY on ubuntu when done right. I&#x27;m still using it. I&#x27;m glad you&#x27;re making a new better version with no limiting deps! You are awesome. Thank you and good luck!</div><br/><div id="40248141" class="c"><input type="checkbox" id="c-40248141" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40246236">parent</a><span>|</span><a href="#40250624">next</a><span>|</span><label class="collapse" for="c-40248141">[-]</label><label class="expand" for="c-40248141">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the kinds words! Really cool to hear that people were able to use sqlite-vss, lol.</div><br/></div></div></div></div><div id="40250624" class="c"><input type="checkbox" id="c-40250624" checked=""/><div class="controls bullet"><span class="by">laurels-marts</span><span>|</span><a href="#40246236">prev</a><span>|</span><a href="#40245186">next</a><span>|</span><label class="collapse" for="c-40250624">[-]</label><label class="expand" for="c-40250624">[2 more]</label></div><br/><div class="children"><div class="content">DuckDB today announced their &quot;Vector Similarity Search in DuckDB&quot; extension.<p><a href="https:&#x2F;&#x2F;duckdb.org&#x2F;2024&#x2F;05&#x2F;03&#x2F;vector-similarity-search-vss.html" rel="nofollow">https:&#x2F;&#x2F;duckdb.org&#x2F;2024&#x2F;05&#x2F;03&#x2F;vector-similarity-search-vss.h...</a></div><br/><div id="40251635" class="c"><input type="checkbox" id="c-40251635" checked=""/><div class="controls bullet"><span class="by">jasonjmcghee</span><span>|</span><a href="#40250624">parent</a><span>|</span><a href="#40245186">next</a><span>|</span><label class="collapse" for="c-40251635">[-]</label><label class="expand" for="c-40251635">[1 more]</label></div><br/><div class="children"><div class="content">This is exciting!<p>This could really simplify a little CDN-based HNSW project I did (<a href="https:&#x2F;&#x2F;github.com&#x2F;jasonjmcghee&#x2F;portable-hnsw">https:&#x2F;&#x2F;github.com&#x2F;jasonjmcghee&#x2F;portable-hnsw</a>)<p>Seems like with duckdb vss you could just embed, store as duckdb format, then execute sql against it (in the CDN).</div><br/></div></div></div></div><div id="40245186" class="c"><input type="checkbox" id="c-40245186" checked=""/><div class="controls bullet"><span class="by">TheAnkurTyagi</span><span>|</span><a href="#40250624">prev</a><span>|</span><a href="#40243851">next</a><span>|</span><label class="collapse" for="c-40245186">[-]</label><label class="expand" for="c-40245186">[2 more]</label></div><br/><div class="children"><div class="content">This is great. we used Qdrant vector DB for an end to end automation for our AI RAG app at <a href="https:&#x2F;&#x2F;github.com&#x2F;rnadigital&#x2F;agentcloud">https:&#x2F;&#x2F;github.com&#x2F;rnadigital&#x2F;agentcloud</a>, but very excited to see you are making a successor. any ETA when it would be ready to use and any quickstart guide? Maybe I can help in writing a blog as well.</div><br/><div id="40248589" class="c"><input type="checkbox" id="c-40248589" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40245186">parent</a><span>|</span><a href="#40243851">next</a><span>|</span><label class="collapse" for="c-40248589">[-]</label><label class="expand" for="c-40248589">[1 more]</label></div><br/><div class="children"><div class="content">I plan to have v0.1.0 in about a month or so! Definitely will include a ton of docs and a quickstart guide. There&#x27;s an undocumented pip package &quot;sqlite-vec&quot; that you might be able to use now, if you wanted to call it from your Python &quot;Agent Backend&quot; directly.</div><br/></div></div></div></div><div id="40243851" class="c"><input type="checkbox" id="c-40243851" checked=""/><div class="controls bullet"><span class="by">Trufa</span><span>|</span><a href="#40245186">prev</a><span>|</span><a href="#40247186">next</a><span>|</span><label class="collapse" for="c-40243851">[-]</label><label class="expand" for="c-40243851">[1 more]</label></div><br/><div class="children"><div class="content">I love this style of projects, OSS project for a very particular issue.<p>I keep thinking what can I do in the Typescript&#x2F;Next.js&#x2F;React ecosystem that&#x27;s very useful to a technical niche but I haven&#x27;t had the inspiration yet.</div><br/></div></div><div id="40247186" class="c"><input type="checkbox" id="c-40247186" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#40243851">prev</a><span>|</span><a href="#40243740">next</a><span>|</span><label class="collapse" for="c-40247186">[-]</label><label class="expand" for="c-40247186">[5 more]</label></div><br/><div class="children"><div class="content">Do you plan to only use public SQLite APIs, or do you expect to be appended to the amalgamation?<p>I&#x27;m definitely interested in something like this, but need to think through how I could distribute this separate from SQLite in my Wasm based Go bindings. So far everything C is bundled, because it&#x27;s a lot simpler than Wasm &quot;dynamic linking&quot;.<p>Also, you&#x27;ve mentioned incremental BLOB I&#x2F;O, and you probably know this already, but keep in mind that BLOB I&#x2F;O is <i>never</i> random access, as large BLOBs are stored as a linked list of pages.</div><br/><div id="40248289" class="c"><input type="checkbox" id="c-40248289" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40247186">parent</a><span>|</span><a href="#40249717">next</a><span>|</span><label class="collapse" for="c-40248289">[-]</label><label class="expand" for="c-40248289">[3 more]</label></div><br/><div class="children"><div class="content">Only public SQLite APIs! So no need to append to amalgamation.<p>I&#x27;m a big fan of your wazero SQLite bindings! I actually plan on providing 1) CGO bindings to sqlite-vec and 2) a custom WASI build sqlite-vec that can be used in go-sqlite3 directly. My plan was to build a sqlite3.wasm file using the build scripts in your repo. If you did want to support it in your project directly, I think you could just drop the sqlite-vec.c&#x2F;h file in go-sqlite3&#x2F;sqlite3 and be good to go<p>Re incremental Blob I&#x2F;O: I learned that the hard way! It&#x27;s definitely the limiting factor on query speed for sqlite-vec. I&#x27;ve found that keeping the chunks relatively low in size (low MB&#x27;s) and increasing the page_size strikes a good balance, but page_size in particular has consequences. PRAGMA mmap_size also helps out a ton, since it seems to keep pages in memory and makes overflow lookups faster, but that of course means a ton more memory usage. It&#x27;s a difficult balance!</div><br/><div id="40248435" class="c"><input type="checkbox" id="c-40248435" checked=""/><div class="controls bullet"><span class="by">ncruces</span><span>|</span><a href="#40247186">root</a><span>|</span><a href="#40248289">parent</a><span>|</span><a href="#40249717">next</a><span>|</span><label class="collapse" for="c-40248435">[-]</label><label class="expand" for="c-40248435">[2 more]</label></div><br/><div class="children"><div class="content">OK, when you feel it&#x27;s time, feel free to ping me on my repo, and I&#x27;ll look into it.<p>A custom Wasm blob definitely works: it&#x27;s an explicit design goal of my bindings that one can bring their own Wasm (e.g. because one wants to configure the build differently, or bought the SEE extension, or something). And if your extension turns out much like FTS5 that would work.<p>Still, &quot;one big Wasm blob&quot; is less flexible than I&#x27;d like, because all connections in an app (currently? maybe this could be lifted) need to use the same Wasm blob. Then (and if you want to import different extensions...) it becomes a fight over who got to initialize the global variable last.<p>So, I&#x27;ve been on-and-off looking into what it would take to &quot;dynamically link&quot; a C extension as a second Wasm, but... I&#x27;m not even sure it&#x27;s possible.</div><br/><div id="40248614" class="c"><input type="checkbox" id="c-40248614" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40247186">root</a><span>|</span><a href="#40248435">parent</a><span>|</span><a href="#40249717">next</a><span>|</span><label class="collapse" for="c-40248614">[-]</label><label class="expand" for="c-40248614">[1 more]</label></div><br/><div class="children"><div class="content">Ya dynamically linking extensions in WASM would be amazing, but really hard to see how it would work. DuckDB was able to figure it out[0], but I struggle to see how it would work for SQLite. Though if anything, I think your library would make it easier to solve, since you don&#x27;t have to fight with the browser&#x2F;JavaScript<p>[0] <a href="https:&#x2F;&#x2F;duckdb.org&#x2F;2023&#x2F;12&#x2F;18&#x2F;duckdb-extensions-in-wasm.html" rel="nofollow">https:&#x2F;&#x2F;duckdb.org&#x2F;2023&#x2F;12&#x2F;18&#x2F;duckdb-extensions-in-wasm.html</a></div><br/></div></div></div></div></div></div><div id="40249717" class="c"><input type="checkbox" id="c-40249717" checked=""/><div class="controls bullet"><span class="by">koeng</span><span>|</span><a href="#40247186">parent</a><span>|</span><a href="#40248289">prev</a><span>|</span><a href="#40243740">next</a><span>|</span><label class="collapse" for="c-40249717">[-]</label><label class="expand" for="c-40249717">[1 more]</label></div><br/><div class="children"><div class="content">Definitely interested in this for your wasm Go bindings!</div><br/></div></div></div></div><div id="40243740" class="c"><input type="checkbox" id="c-40243740" checked=""/><div class="controls bullet"><span class="by">codazoda</span><span>|</span><a href="#40247186">prev</a><span>|</span><a href="#40244568">next</a><span>|</span><label class="collapse" for="c-40243740">[-]</label><label class="expand" for="c-40243740">[3 more]</label></div><br/><div class="children"><div class="content">This is a lot like I imagine “readme driven development” to look like. I’m curious if the author started with docs first.</div><br/><div id="40243975" class="c"><input type="checkbox" id="c-40243975" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40243740">parent</a><span>|</span><a href="#40244568">next</a><span>|</span><label class="collapse" for="c-40243975">[-]</label><label class="expand" for="c-40243975">[2 more]</label></div><br/><div class="children"><div class="content">Thanks for the kind words!<p>I started with code first — the extension itself is already mostly written[0]. But it&#x27;s one of those &quot;20% effort for 80% of the work,&quot; where the last 20% I need to write (error handling, fuzzy tests, correctness testing) will take 80% of the time. But people already have questions about the current status of `sqlite-vss`, so I figured this &quot;work-in-progress&quot; blog post could answer some questions.<p>Though I do like the idea of starting with docs first! Especially with SQLite extensions, where it all really matters what the SQL API looks like (scalar functions, virtual tables, etc.). I definitely did a lot of sketching of what the SQL part of sqlite-vec should look like before writing most of the code.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec&#x2F;blob&#x2F;main&#x2F;sqlite-vec.c">https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec&#x2F;blob&#x2F;main&#x2F;sqlite-vec.c</a></div><br/><div id="40244101" class="c"><input type="checkbox" id="c-40244101" checked=""/><div class="controls bullet"><span class="by">peter_l_downs</span><span>|</span><a href="#40243740">root</a><span>|</span><a href="#40243975">parent</a><span>|</span><a href="#40244568">next</a><span>|</span><label class="collapse" for="c-40244101">[-]</label><label class="expand" for="c-40244101">[1 more]</label></div><br/><div class="children"><div class="content">You’ve done a great job communicating the project, in every aspect. Nice work. I’m excited to try this out!</div><br/></div></div></div></div></div></div><div id="40244568" class="c"><input type="checkbox" id="c-40244568" checked=""/><div class="controls bullet"><span class="by">ComputerGuru</span><span>|</span><a href="#40243740">prev</a><span>|</span><a href="#40249711">next</a><span>|</span><label class="collapse" for="c-40244568">[-]</label><label class="expand" for="c-40244568">[4 more]</label></div><br/><div class="children"><div class="content">I guess this is an answer (not <i>in answer</i>, mind!) to the GitHub issue I opened against SQLite-vss a couple of months ago?<p><a href="https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vss&#x2F;issues&#x2F;124">https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vss&#x2F;issues&#x2F;124</a></div><br/><div id="40244895" class="c"><input type="checkbox" id="c-40244895" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244568">parent</a><span>|</span><a href="#40249711">next</a><span>|</span><label class="collapse" for="c-40244895">[-]</label><label class="expand" for="c-40244895">[3 more]</label></div><br/><div class="children"><div class="content">Yes it is! Sorry for not following up there. Actually, when I first read that ticket, it started me down the rabbit-hole of &quot;how can I make sqlite-vss&quot; better, which eventually turned into &quot;I should make sqlite-vec.&quot; So thanks for helping me go down this path!<p>With sqlite-vec&#x27;s builtin binary quantization, you should be able to do something like:<p><pre><code>  CREATE VIRTUAL TABLE vec_files USING vec0 (
    contents_embedding bit[1536]
  );

  INSERT INTO vec_files(rowid,contents_embedding) 
    VALUES (
      (1, vec_quantize_binary( &#x2F;* 1536-dimension float vector here*&#x2F;))
    )</code></pre></div><br/><div id="40250367" class="c"><input type="checkbox" id="c-40250367" checked=""/><div class="controls bullet"><span class="by">ComputerGuru</span><span>|</span><a href="#40244568">root</a><span>|</span><a href="#40244895">parent</a><span>|</span><a href="#40249711">next</a><span>|</span><label class="collapse" for="c-40250367">[-]</label><label class="expand" for="c-40250367">[2 more]</label></div><br/><div class="children"><div class="content">Hey, you’re welcome! Looking forward to trying this at some point. Sooner if rust bindings are available, later if I have to contribute them.<p>My embedding is already binary, presumably I can bind a blob instead of the call to vec_quantize_binary?</div><br/><div id="40250921" class="c"><input type="checkbox" id="c-40250921" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244568">root</a><span>|</span><a href="#40250367">parent</a><span>|</span><a href="#40249711">next</a><span>|</span><label class="collapse" for="c-40250921">[-]</label><label class="expand" for="c-40250921">[1 more]</label></div><br/><div class="children"><div class="content">Yup, you&#x27;ll be able to bind blobs, you&#x27;ll currently have to do use vec_bit(?) which is a bit awkward, but it works!</div><br/></div></div></div></div></div></div></div></div><div id="40249711" class="c"><input type="checkbox" id="c-40249711" checked=""/><div class="controls bullet"><span class="by">fitzn</span><span>|</span><a href="#40244568">prev</a><span>|</span><a href="#40245085">next</a><span>|</span><label class="collapse" for="c-40249711">[-]</label><label class="expand" for="c-40249711">[2 more]</label></div><br/><div class="children"><div class="content">Cool stuff. I&#x27;m probably missing this, but where in the code are you ensuring that all feature vectors have the same number of dimensions (i.e., length)? From what I can tell, for a text value from sqlite, the code converts each char to a float and stores those bits in the vector. This could work if the hamming distance accounts for different length vectors, but that function appears to assume they are the same. Thanks for the clarification.</div><br/><div id="40251115" class="c"><input type="checkbox" id="c-40251115" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40249711">parent</a><span>|</span><a href="#40245085">next</a><span>|</span><label class="collapse" for="c-40251115">[-]</label><label class="expand" for="c-40251115">[1 more]</label></div><br/><div class="children"><div class="content">Internally vectors (at least float vectors) get converted to float * arrays, where the vectors lengths are manually checked. If you provide a vector in JSON form, then it parses that JSON into a float * array. Vectors must be the same length for distance operations.</div><br/></div></div></div></div><div id="40245085" class="c"><input type="checkbox" id="c-40245085" checked=""/><div class="controls bullet"><span class="by">usgroup</span><span>|</span><a href="#40249711">prev</a><span>|</span><a href="#40247018">next</a><span>|</span><label class="collapse" for="c-40245085">[-]</label><label class="expand" for="c-40245085">[2 more]</label></div><br/><div class="children"><div class="content">Shallow insight, but separating the algorithmic&#x2F;representational and sqlite operational parts into own C projects, is possibly a good idea.<p>I&#x27;d expect the rate of evolution to be significantly different between the two parts, and if you are using an algorithm library adopted by others, you may get progress &quot;for free&quot;.</div><br/><div id="40248101" class="c"><input type="checkbox" id="c-40248101" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40245085">parent</a><span>|</span><a href="#40247018">next</a><span>|</span><label class="collapse" for="c-40248101">[-]</label><label class="expand" for="c-40248101">[1 more]</label></div><br/><div class="children"><div class="content">Oooh I haven&#x27;t thought of seperating the SQLite stuff and the vector search stuff. Good idea, will keep that in mind!</div><br/></div></div></div></div><div id="40247018" class="c"><input type="checkbox" id="c-40247018" checked=""/><div class="controls bullet"><span class="by">rcarmo</span><span>|</span><a href="#40245085">prev</a><span>|</span><a href="#40244410">next</a><span>|</span><label class="collapse" for="c-40247018">[-]</label><label class="expand" for="c-40247018">[1 more]</label></div><br/><div class="children"><div class="content">Great news. Looking forward to it, as I&#x27;m constantly looking for simple solutions that work in constrained environments, and this looks like it&#x27;s going to be in one of them.</div><br/></div></div><div id="40244410" class="c"><input type="checkbox" id="c-40244410" checked=""/><div class="controls bullet"><span class="by">xrd</span><span>|</span><a href="#40247018">prev</a><span>|</span><a href="#40245171">next</a><span>|</span><label class="collapse" for="c-40244410">[-]</label><label class="expand" for="c-40244410">[3 more]</label></div><br/><div class="children"><div class="content">Very excited about this.<p>When running inside the browser, is sqlite-vec able to persist data into the browser-native indexdb? Or, is this part left to the user? If you can share the thinking there I would appreciate it, even if that is, &quot;no thinking yet!&quot;</div><br/><div id="40244498" class="c"><input type="checkbox" id="c-40244498" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244410">parent</a><span>|</span><a href="#40245171">next</a><span>|</span><label class="collapse" for="c-40244498">[-]</label><label class="expand" for="c-40244498">[2 more]</label></div><br/><div class="children"><div class="content">It could! It&#x27;s based on the official  SQLite WASM build, so you can use the same persistent options[0] that are offered there. Not sure if IndexedDB is specifically supported, but localStorage&#x2F;OPFS VFS is available.<p>[0] <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md#kvvfs" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;wasm&#x2F;doc&#x2F;trunk&#x2F;persistence.md#kvvfs</a></div><br/><div id="40244875" class="c"><input type="checkbox" id="c-40244875" checked=""/><div class="controls bullet"><span class="by">samwillis</span><span>|</span><a href="#40244410">root</a><span>|</span><a href="#40244498">parent</a><span>|</span><a href="#40245171">next</a><span>|</span><label class="collapse" for="c-40244875">[-]</label><label class="expand" for="c-40244875">[1 more]</label></div><br/><div class="children"><div class="content">OP is correct, the official WASM SQLite build is a sync only build and doesn&#x27;t support async VFSs (which a IndexedDB VFS needs to be as it&#x27;s an async api, unless you load the whole file into memory).<p>The best option for IndexedDB backed WASM SQLite is wa-sqlite, it offered both a sync and async build and a bunch of different VFSs, including an IndexedDB one. Note however that the async builds add significant overhead and reduce performance.<p>The most performant VFS is the &quot;OPFS access handle pool&quot; VFS that Roy developed for wa-SQLite and the official build also adopted as an option. That would be my recommendation for now.</div><br/></div></div></div></div></div></div><div id="40245171" class="c"><input type="checkbox" id="c-40245171" checked=""/><div class="controls bullet"><span class="by">elitan</span><span>|</span><a href="#40244410">prev</a><span>|</span><a href="#40254337">next</a><span>|</span><label class="collapse" for="c-40245171">[-]</label><label class="expand" for="c-40245171">[1 more]</label></div><br/><div class="children"><div class="content">Vector search in SQLite is what&#x27;s keeping me from switching from Postgres.</div><br/></div></div><div id="40254337" class="c"><input type="checkbox" id="c-40254337" checked=""/><div class="controls bullet"><span class="by">brainless</span><span>|</span><a href="#40245171">prev</a><span>|</span><a href="#40244182">next</a><span>|</span><label class="collapse" for="c-40254337">[-]</label><label class="expand" for="c-40254337">[1 more]</label></div><br/><div class="children"><div class="content">I have been looking at your extension for the last couple weeks and I think I will end up using it. I am also looking at running qdrant locally. I am creating an open source AI studio (desktop app) (1). It is in very early stages but it is fun to get to know this landscape. I would be happy to contribute to your project in any way I can. And thank you for this project.<p>1. <a href="https:&#x2F;&#x2F;github.com&#x2F;brainless&#x2F;dwata">https:&#x2F;&#x2F;github.com&#x2F;brainless&#x2F;dwata</a></div><br/></div></div><div id="40244182" class="c"><input type="checkbox" id="c-40244182" checked=""/><div class="controls bullet"><span class="by">auraham</span><span>|</span><a href="#40254337">prev</a><span>|</span><a href="#40245364">next</a><span>|</span><label class="collapse" for="c-40244182">[-]</label><label class="expand" for="c-40244182">[3 more]</label></div><br/><div class="children"><div class="content">Awesome work! It would be great if you can share a post of how you developed that extension. I am not familiar with SQLite extensions, so I am not sure how to dig into the github repo.</div><br/><div id="40244207" class="c"><input type="checkbox" id="c-40244207" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40244182">parent</a><span>|</span><a href="#40245364">next</a><span>|</span><label class="collapse" for="c-40244207">[-]</label><label class="expand" for="c-40244207">[2 more]</label></div><br/><div class="children"><div class="content">I definitely plan to! I have a much larger list of SQLite extensions I&#x27;ve built here: <a href="https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-ecosystem">https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-ecosystem</a><p>Here&#x27;s a few other references you may enjoy if you wanna learn more about SQLite extensions:<p>- The single source file for sqlite-vec: <a href="https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec&#x2F;blob&#x2F;main&#x2F;sqlite-vec.c">https:&#x2F;&#x2F;github.com&#x2F;asg017&#x2F;sqlite-vec&#x2F;blob&#x2F;main&#x2F;sqlite-vec.c</a><p>- sqlean, a project from Anton Zhiyanov which is good base of great SQLite extensions: <a href="https:&#x2F;&#x2F;github.com&#x2F;nalgeon&#x2F;sqlean">https:&#x2F;&#x2F;github.com&#x2F;nalgeon&#x2F;sqlean</a><p>- The official SQLite docs: <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;loadext.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;loadext.html</a><p>- The &quot;hello world&quot; SQLite extension example: <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;src&#x2F;file&#x2F;ext&#x2F;misc&#x2F;rot13.c" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;src&#x2F;file&#x2F;ext&#x2F;misc&#x2F;rot13.c</a></div><br/><div id="40255087" class="c"><input type="checkbox" id="c-40255087" checked=""/><div class="controls bullet"><span class="by">auraham</span><span>|</span><a href="#40244182">root</a><span>|</span><a href="#40244207">parent</a><span>|</span><a href="#40245364">next</a><span>|</span><label class="collapse" for="c-40255087">[-]</label><label class="expand" for="c-40255087">[1 more]</label></div><br/><div class="children"><div class="content">Awesome! Thanks</div><br/></div></div></div></div></div></div><div id="40245364" class="c"><input type="checkbox" id="c-40245364" checked=""/><div class="controls bullet"><span class="by">blizzardman</span><span>|</span><a href="#40244182">prev</a><span>|</span><a href="#40251295">next</a><span>|</span><label class="collapse" for="c-40245364">[-]</label><label class="expand" for="c-40245364">[2 more]</label></div><br/><div class="children"><div class="content">Are you looking for contributor by any chance?</div><br/><div id="40248106" class="c"><input type="checkbox" id="c-40248106" checked=""/><div class="controls bullet"><span class="by">alexgarcia-xyz</span><span>|</span><a href="#40245364">parent</a><span>|</span><a href="#40251295">next</a><span>|</span><label class="collapse" for="c-40248106">[-]</label><label class="expand" for="c-40248106">[1 more]</label></div><br/><div class="children"><div class="content">As of now for this beta release not really, but after v0.1.0 is released, will definitely have contributing guides + issues that people could tackle!</div><br/></div></div></div></div><div id="40251295" class="c"><input type="checkbox" id="c-40251295" checked=""/><div class="controls bullet"><span class="by">jokull</span><span>|</span><a href="#40245364">prev</a><span>|</span><a href="#40251617">next</a><span>|</span><label class="collapse" for="c-40251295">[-]</label><label class="expand" for="c-40251295">[1 more]</label></div><br/><div class="children"><div class="content">libsql (from turso) is also working on this - the more the merrier</div><br/></div></div><div id="40251617" class="c"><input type="checkbox" id="c-40251617" checked=""/><div class="controls bullet"><span class="by">michaelsbradley</span><span>|</span><a href="#40251295">prev</a><span>|</span><a href="#40245074">next</a><span>|</span><label class="collapse" for="c-40251617">[-]</label><label class="expand" for="c-40251617">[1 more]</label></div><br/><div class="children"><div class="content">Any thoughts on how your project will compare to CozoDB?<p><a href="https:&#x2F;&#x2F;github.com&#x2F;cozodb&#x2F;cozo">https:&#x2F;&#x2F;github.com&#x2F;cozodb&#x2F;cozo</a></div><br/></div></div><div id="40245074" class="c"><input type="checkbox" id="c-40245074" checked=""/><div class="controls bullet"><span class="by">zaeger</span><span>|</span><a href="#40251617">prev</a><span>|</span><a href="#40245576">next</a><span>|</span><label class="collapse" for="c-40245074">[-]</label><label class="expand" for="c-40245074">[1 more]</label></div><br/><div class="children"><div class="content">very good</div><br/></div></div><div id="40245576" class="c"><input type="checkbox" id="c-40245576" checked=""/><div class="controls bullet"><span class="by">babox</span><span>|</span><a href="#40245074">prev</a><span>|</span><a href="#40245027">next</a><span>|</span><label class="collapse" for="c-40245576">[-]</label><label class="expand" for="c-40245576">[1 more]</label></div><br/><div class="children"><div class="content">very cool i like so much sqlite</div><br/></div></div><div id="40245027" class="c"><input type="checkbox" id="c-40245027" checked=""/><div class="controls bullet"><span class="by">goprams</span><span>|</span><a href="#40245576">prev</a><span>|</span><label class="collapse" for="c-40245027">[-]</label><label class="expand" for="c-40245027">[4 more]</label></div><br/><div class="children"><div class="content">&gt; KNN style query goes brrrr<p>Why do devs write comments like this? What does &quot;goes brrrr&quot; add to anyone&#x27;s understanding of the code? It&#x27;s so annoying. Is it supposed to be amusing or cute? It&#x27;s not.<p>The rest of the article is great but it&#x27;s so jarring to see this sort of nonsense in amongst a solid piece of work.<p>It&#x27;s like when you go to a conference and the presentations are peppered with unfunny &quot;meme&quot; pictures. Grow up, people.</div><br/><div id="40245453" class="c"><input type="checkbox" id="c-40245453" checked=""/><div class="controls bullet"><span class="by">efdee</span><span>|</span><a href="#40245027">parent</a><span>|</span><a href="#40245043">next</a><span>|</span><label class="collapse" for="c-40245453">[-]</label><label class="expand" for="c-40245453">[1 more]</label></div><br/><div class="children"><div class="content">Why do people write comments like this? What does &quot;grow up, people&quot; add to anyone&#x27;s understanding of the topic? It&#x27;s so annoying. Is it supposed to make you look better? It doesn&#x27;t.</div><br/></div></div><div id="40245043" class="c"><input type="checkbox" id="c-40245043" checked=""/><div class="controls bullet"><span class="by">dayjaby</span><span>|</span><a href="#40245027">parent</a><span>|</span><a href="#40245453">prev</a><span>|</span><a href="#40245191">next</a><span>|</span><label class="collapse" for="c-40245043">[-]</label><label class="expand" for="c-40245043">[1 more]</label></div><br/><div class="children"><div class="content">Language evolves. Grow up yourself.</div><br/></div></div><div id="40245191" class="c"><input type="checkbox" id="c-40245191" checked=""/><div class="controls bullet"><span class="by">timmy777</span><span>|</span><a href="#40245027">parent</a><span>|</span><a href="#40245043">prev</a><span>|</span><label class="collapse" for="c-40245191">[-]</label><label class="expand" for="c-40245191">[1 more]</label></div><br/><div class="children"><div class="content">Keep in mind, a presentation (text, or otherwise) is an art. Culture, background, experiences and ideologies influences art.<p>... and to address your tone, did you know, you can give feedback with empathy?</div><br/></div></div></div></div></div></div></div></div></div></body></html>