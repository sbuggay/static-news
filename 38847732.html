<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704272454178" as="style"/><link rel="stylesheet" href="styles.css?v=1704272454178"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="http://blog.vmsplice.net/2024/01/qemu-aiocontext-removal-and-how-it-was.html">QEMU AioContext removal and how it was done</a>Â <span class="domain">(<a href="http://blog.vmsplice.net">blog.vmsplice.net</a>)</span></div><div class="subtext"><span>ingve</span> | <span>4 comments</span></div><br/><div><div id="38852028" class="c"><input type="checkbox" id="c-38852028" checked=""/><div class="controls bullet"><span class="by">bonzini</span><span>|</span><a href="#38849382">next</a><span>|</span><label class="collapse" for="c-38852028">[-]</label><label class="expand" for="c-38852028">[1 more]</label></div><br/><div class="children"><div class="content">What Stefan (the author) calls my vision, I call my arrogance. :)<p>Some bits of my plan, especially with respect to how the async runtime in QEMU is designed, were good. However I had vastly underestimated the complexity of one step. The various disk images form a graph that can change on the fly, for example if you make a live snapshot of a VM disk. The method I had thought of to handle changes to the graph would have added a lot of technical debt. Fortunately it was nacked by the maintainer Kevin Wolf and replaced with something better.<p>For more details on both my plan and what was actually done, see <a href="https:&#x2F;&#x2F;kvm-forum.qemu.org&#x2F;2023&#x2F;Multiqueue_in_the_block_layer_wLom4Bt.pdf" rel="nofollow">https:&#x2F;&#x2F;kvm-forum.qemu.org&#x2F;2023&#x2F;Multiqueue_in_the_block_laye...</a> (slides) or <a href="https:&#x2F;&#x2F;youtu.be&#x2F;Ubped0PgvZI?si=IsckfZ7uDNYJNp_y" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;Ubped0PgvZI?si=IsckfZ7uDNYJNp_y</a> (video).<p>The important thing, at every step, was being committed to getting it done. Some of the intermediate step were better in terms of bugs fixed, but worse in terms of complexity because you had to juggle both the &quot;good&quot; locks and the legacy global locks.</div><br/></div></div><div id="38849382" class="c"><input type="checkbox" id="c-38849382" checked=""/><div class="controls bullet"><span class="by">alhirzel</span><span>|</span><a href="#38852028">prev</a><span>|</span><label class="collapse" for="c-38849382">[-]</label><label class="expand" for="c-38849382">[2 more]</label></div><br/><div class="children"><div class="content">I like how short and sweet this summary is; it&#x27;s impressive to think that years worth of person-hours of labor can be wrapped up like this.<p>It reminds me of a short version of AOSA: <a href="https:&#x2F;&#x2F;aosabook.org&#x2F;en&#x2F;" rel="nofollow">https:&#x2F;&#x2F;aosabook.org&#x2F;en&#x2F;</a><p>Are there any more write-ups like this about open source software? (Apart from things like LWN)</div><br/><div id="38851064" class="c"><input type="checkbox" id="c-38851064" checked=""/><div class="controls bullet"><span class="by">eadler</span><span>|</span><a href="#38849382">parent</a><span>|</span><label class="collapse" for="c-38851064">[-]</label><label class="expand" for="c-38851064">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;d like the Dolphin Emulator blog.<p><a href="https:&#x2F;&#x2F;dolphin-emu.org&#x2F;blog&#x2F;" rel="nofollow">https:&#x2F;&#x2F;dolphin-emu.org&#x2F;blog&#x2F;</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>