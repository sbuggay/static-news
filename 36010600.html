<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1684746064258" as="style"/><link rel="stylesheet" href="styles.css?v=1684746064258"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://cprimozic.net/blog/building-a-signal-analyzer-with-modern-web-tech/">Building a Signal Analyzer with Modern Web Tech</a>Â <span class="domain">(<a href="https://cprimozic.net">cprimozic.net</a>)</span></div><div class="subtext"><span>Ameo</span> | <span>27 comments</span></div><br/><div><div id="36023774" class="c"><input type="checkbox" id="c-36023774" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#36028726">next</a><span>|</span><label class="collapse" for="c-36023774">[-]</label><label class="expand" for="c-36023774">[12 more]</label></div><br/><div class="children"><div class="content">The overall article is extremely clearly written and well-diagrammed, as you&#x27;d expect from someone who writes software for test&#x2F;metrology equipment. It does look pretty different from your usual web-dev retrospective, and shares more in common with &quot;$BROWSER Internals&quot; style articles.<p>The thesis:<p>&gt; I recently spent some time building a browser-based signal analyzer (spectrogram + oscilloscope) as part of one of my projects. I ended up using some very modern browser APIs and technologies that I&#x27;d not worked with before, and I discovered a lot of really interesting patterns and techniques that I&#x27;d never seen before in a web app.<p>&gt; <i>Building this application has made it clear to me that the modern web is extremely well-suited to building complex multi-threaded and graphics-intensive applications.</i></div><br/><div id="36028632" class="c"><input type="checkbox" id="c-36028632" checked=""/><div class="controls bullet"><span class="by">metanonsense</span><span>|</span><a href="#36023774">parent</a><span>|</span><a href="#36024183">next</a><span>|</span><label class="collapse" for="c-36028632">[-]</label><label class="expand" for="c-36028632">[1 more]</label></div><br/><div class="children"><div class="content">&quot;$BROWSER Internals style articles&quot; sounds like something I would crave for. Do you have any examples with actual &quot;$BROWSER Internals&quot;?</div><br/></div></div><div id="36024183" class="c"><input type="checkbox" id="c-36024183" checked=""/><div class="controls bullet"><span class="by">CamperBob2</span><span>|</span><a href="#36023774">parent</a><span>|</span><a href="#36028632">prev</a><span>|</span><a href="#36028726">next</a><span>|</span><label class="collapse" for="c-36024183">[-]</label><label class="expand" for="c-36024183">[10 more]</label></div><br/><div class="children"><div class="content">Demo doesn&#x27;t work on FF in Windows 10, not clear that it&#x27;s meant to run anywhere other than on Chrome or Safari.<p>So I&#x27;m not really sure the author&#x27;s thesis has been validated, as interesting and useful as the concept appears to be.</div><br/><div id="36024278" class="c"><input type="checkbox" id="c-36024278" checked=""/><div class="controls bullet"><span class="by">onion2k</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36024183">parent</a><span>|</span><a href="#36024399">next</a><span>|</span><label class="collapse" for="c-36024278">[-]</label><label class="expand" for="c-36024278">[6 more]</label></div><br/><div class="children"><div class="content">Firefox is lagging behind on a lot of the more esoteric web APIs. I think it&#x27;s a choice by the Firefox team, and a valid one given the effort required, Mozilla&#x27;s relatively limited resources, and how few devs actually want or need these APIs. Firefox is more like a &quot;website viewer&quot; than a &quot;web app host&quot; like Chrome and Safari. I think that&#x27;s what a lot of Firefox users want, and why they choose that browser. It might even be useful to differentiate between them instead of calling everything a &#x27;web browser&#x27; in the future.<p>To that end I don&#x27;t think it&#x27;s a fair criticism of web app developers <i>or</i> Firefox that apps like this don&#x27;t work in your browser.</div><br/><div id="36025061" class="c"><input type="checkbox" id="c-36025061" checked=""/><div class="controls bullet"><span class="by">pfg_</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36024278">parent</a><span>|</span><a href="#36024399">next</a><span>|</span><label class="collapse" for="c-36025061">[-]</label><label class="expand" for="c-36025061">[5 more]</label></div><br/><div class="children"><div class="content">The specs that firefox chooses not to implement are stuff like web midi for security concerns. Firefox does not try to market itself as a &quot;website viewer&quot; that does not support &quot;web apps&quot;</div><br/><div id="36025141" class="c"><input type="checkbox" id="c-36025141" checked=""/><div class="controls bullet"><span class="by">jacquesm</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36025061">parent</a><span>|</span><a href="#36024399">next</a><span>|</span><label class="collapse" for="c-36025141">[-]</label><label class="expand" for="c-36025141">[4 more]</label></div><br/><div class="children"><div class="content">You must have missed the announcement. Firefox now supports web midi, their security concerns where BS all along anyway.</div><br/><div id="36026530" class="c"><input type="checkbox" id="c-36026530" checked=""/><div class="controls bullet"><span class="by">mindslight</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36025141">parent</a><span>|</span><a href="#36028899">next</a><span>|</span><label class="collapse" for="c-36026530">[-]</label><label class="expand" for="c-36026530">[2 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t speak on the specific details of web midi, but after the spate of poorly designed browser features with intrinsic security vulnerabilities (eg canvas fingerprinting), it&#x27;s reasonable to be wary of things coming down the pipeline.</div><br/><div id="36027693" class="c"><input type="checkbox" id="c-36027693" checked=""/><div class="controls bullet"><span class="by">jacquesm</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36026530">parent</a><span>|</span><a href="#36028899">next</a><span>|</span><label class="collapse" for="c-36027693">[-]</label><label class="expand" for="c-36027693">[1 more]</label></div><br/><div class="children"><div class="content">That always makes good sense. I think Chrome got this one right though, have a reasonable protection against abuse and trust that the end user is capable of weighing the risks.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="36024399" class="c"><input type="checkbox" id="c-36024399" checked=""/><div class="controls bullet"><span class="by">Ameo</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36024183">parent</a><span>|</span><a href="#36024278">prev</a><span>|</span><a href="#36024881">next</a><span>|</span><label class="collapse" for="c-36024399">[-]</label><label class="expand" for="c-36024399">[2 more]</label></div><br/><div class="children"><div class="content">Hmm it should be working in Firefox - as long as you&#x27;re using the latest version instead of ESR it should be good; works for me on Firefox 113.0 on Linux.<p>Some browsers have anti-autoplay-ad protections built in that prevent audio from playing until you interact with the page.  You might have to click the page or press a key on the keyboard to get it started.</div><br/><div id="36024733" class="c"><input type="checkbox" id="c-36024733" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36024399">parent</a><span>|</span><a href="#36024881">next</a><span>|</span><label class="collapse" for="c-36024733">[-]</label><label class="expand" for="c-36024733">[1 more]</label></div><br/><div class="children"><div class="content">Works great here (Firefox 113.0.1 on Windows)</div><br/></div></div></div></div><div id="36024881" class="c"><input type="checkbox" id="c-36024881" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#36023774">root</a><span>|</span><a href="#36024183">parent</a><span>|</span><a href="#36024399">prev</a><span>|</span><a href="#36028726">next</a><span>|</span><label class="collapse" for="c-36024881">[-]</label><label class="expand" for="c-36024881">[1 more]</label></div><br/><div class="children"><div class="content">This works fine for me (Firefox, Ubuntu, tracking protection set to max, uBlock origin on, privacy badger on, resistFingerprinting on). You need to click the play button to make it go, of course, but then it just works.<p>Maybe there&#x27;s a setting you&#x27;ve disabled previously and have since forgotten about?</div><br/></div></div></div></div></div></div><div id="36028726" class="c"><input type="checkbox" id="c-36028726" checked=""/><div class="controls bullet"><span class="by">Kiro</span><span>|</span><a href="#36023774">prev</a><span>|</span><a href="#36026292">next</a><span>|</span><label class="collapse" for="c-36028726">[-]</label><label class="expand" for="c-36028726">[1 more]</label></div><br/><div class="children"><div class="content">I think the biggest problem with SharedArrayBuffer is that you need to set the Cross-Origin-Opener-Policy and Cross-Origin-Embedder-Policy headers for it to work at all (due to Spectre), which means you need a host or a web server where you can configure that.</div><br/></div></div><div id="36026292" class="c"><input type="checkbox" id="c-36026292" checked=""/><div class="controls bullet"><span class="by">password4321</span><span>|</span><a href="#36028726">prev</a><span>|</span><a href="#36026269">next</a><span>|</span><label class="collapse" for="c-36026292">[-]</label><label class="expand" for="c-36026292">[3 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>Show HN: I&#x27;ve built a spectrogram analyzer web app</i><p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35781959" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35781959</a> (19 days ago)<p><a href="https:&#x2F;&#x2F;webfft.net&#x2F;dft&#x2F;" rel="nofollow">https:&#x2F;&#x2F;webfft.net&#x2F;dft&#x2F;</a></div><br/><div id="36026381" class="c"><input type="checkbox" id="c-36026381" checked=""/><div class="controls bullet"><span class="by">totetsu</span><span>|</span><a href="#36026292">parent</a><span>|</span><a href="#36027039">next</a><span>|</span><label class="collapse" for="c-36026381">[-]</label><label class="expand" for="c-36026381">[1 more]</label></div><br/><div class="children"><div class="content">That Webfft is fun. Try recording yourself making a few long vowel sounds A I U E O AE UH , and take a look at how the harmonics&#x2F;formants&#x2F; the pattern of peeks at different frequencies is distributed between sounds.</div><br/></div></div><div id="36027039" class="c"><input type="checkbox" id="c-36027039" checked=""/><div class="controls bullet"><span class="by">ssgh</span><span>|</span><a href="#36026292">parent</a><span>|</span><a href="#36026381">prev</a><span>|</span><a href="#36026269">next</a><span>|</span><label class="collapse" for="c-36027039">[-]</label><label class="expand" for="c-36027039">[1 more]</label></div><br/><div class="children"><div class="content">FYI, it supports <i>decoding</i> ultrasound wav files. I use a Dodotronic UM250K mic to capture ultrasound up to 125 kHz. LCD monitor and other electronics emits some interesting sounds. For some reason, getUserMedia doesn&#x27;t allow high sample rates, but ffmpeg works:<p>ffmpeg -f alsa -channels 1 -sample_rate 250000 -i hw:CARD=r4,DEV=0 -t 5 mic.wav</div><br/></div></div></div></div><div id="36026269" class="c"><input type="checkbox" id="c-36026269" checked=""/><div class="controls bullet"><span class="by">bigger_cheese</span><span>|</span><a href="#36026292">prev</a><span>|</span><a href="#36024884">next</a><span>|</span><label class="collapse" for="c-36026269">[-]</label><label class="expand" for="c-36026269">[4 more]</label></div><br/><div class="children"><div class="content">Being able to run an FFT on audio signal in real time in a background thread seems really cool. Not sure how feasible it is but could be the basis for speech recognition engine running in browser (I&#x27;m not expert but I know Speech detection machine learning models are trained on range of FFT derived signals) - if you can pipe the FFT output to ML endpoint you could potentially have speech to text generation running in the browser - or something like automatic closed caption generation from an incoming audio signal.</div><br/><div id="36026295" class="c"><input type="checkbox" id="c-36026295" checked=""/><div class="controls bullet"><span class="by">Ameo</span><span>|</span><a href="#36026269">parent</a><span>|</span><a href="#36026532">next</a><span>|</span><label class="collapse" for="c-36026295">[-]</label><label class="expand" for="c-36026295">[1 more]</label></div><br/><div class="children"><div class="content">Definitely possible to run high-quality speech-to-text in realtime in the browser: <a href="https:&#x2F;&#x2F;whisper.ggerganov.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;whisper.ggerganov.com&#x2F;</a><p>Made by the same guy who created the popular llama.cpp LLM library.  The model uses log-mel spectrograms as input.<p>Using modern algorithms, FFT is actually really fast to compute.  Definitely dwarfed by the evaluation of the model itself, even when using many threads and Wasm SIMD.</div><br/></div></div><div id="36026532" class="c"><input type="checkbox" id="c-36026532" checked=""/><div class="controls bullet"><span class="by">ioseph</span><span>|</span><a href="#36026269">parent</a><span>|</span><a href="#36026295">prev</a><span>|</span><a href="#36024884">next</a><span>|</span><label class="collapse" for="c-36026532">[-]</label><label class="expand" for="c-36026532">[2 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t that already offered out of the box via WebAudio&#x27;s `AnalyserNode` ? <a href="https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;API&#x2F;AnalyserNode" rel="nofollow">https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;API&#x2F;AnalyserNod...</a></div><br/><div id="36026725" class="c"><input type="checkbox" id="c-36026725" checked=""/><div class="controls bullet"><span class="by">bigger_cheese</span><span>|</span><a href="#36026269">root</a><span>|</span><a href="#36026532">parent</a><span>|</span><a href="#36024884">next</a><span>|</span><label class="collapse" for="c-36026725">[-]</label><label class="expand" for="c-36026725">[1 more]</label></div><br/><div class="children"><div class="content">Yep looks like it - wasn&#x27;t expecting browsers to have it baked in. I&#x27;m not all that familiar with what is available in the world of audio.<p>I&#x27;ve done some rudimentary signal analysis on other types of sensors - accelerometer (for detecting vibrations of specific frequency) and millivolt probes on a hardware instrument - I&#x27;ve used stuff like Matlab or Python to do the signal analysis.</div><br/></div></div></div></div></div></div><div id="36024884" class="c"><input type="checkbox" id="c-36024884" checked=""/><div class="controls bullet"><span class="by">cushychicken</span><span>|</span><a href="#36026269">prev</a><span>|</span><a href="#36026226">next</a><span>|</span><label class="collapse" for="c-36024884">[-]</label><label class="expand" for="c-36024884">[3 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t seem like something you should be able to do with a web browser.<p>Very dope. Glad I saw this. Great work.</div><br/><div id="36024903" class="c"><input type="checkbox" id="c-36024903" checked=""/><div class="controls bullet"><span class="by">dist-epoch</span><span>|</span><a href="#36024884">parent</a><span>|</span><a href="#36026226">next</a><span>|</span><label class="collapse" for="c-36024903">[-]</label><label class="expand" for="c-36024903">[2 more]</label></div><br/><div class="children"><div class="content">People were running full 3D engines in the browser 10 years ago (the original asm.js).</div><br/><div id="36026294" class="c"><input type="checkbox" id="c-36026294" checked=""/><div class="controls bullet"><span class="by">_trampeltier</span><span>|</span><a href="#36024884">root</a><span>|</span><a href="#36024903">parent</a><span>|</span><a href="#36026226">next</a><span>|</span><label class="collapse" for="c-36026294">[-]</label><label class="expand" for="c-36026294">[1 more]</label></div><br/><div class="children"><div class="content">3D in browsers was even in the mid 90s possible. But the hardware was not ready, so VRML never really became a thing.<p><a href="https:&#x2F;&#x2F;www.howtogeek.com&#x2F;778554&#x2F;remembering-vrml-the-metaverse-of-1995&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.howtogeek.com&#x2F;778554&#x2F;remembering-vrml-the-metave...</a></div><br/></div></div></div></div></div></div><div id="36026226" class="c"><input type="checkbox" id="c-36026226" checked=""/><div class="controls bullet"><span class="by">jcparkyn</span><span>|</span><a href="#36024884">prev</a><span>|</span><a href="#36024996">next</a><span>|</span><label class="collapse" for="c-36026226">[-]</label><label class="expand" for="c-36026226">[1 more]</label></div><br/><div class="children"><div class="content">Very cool project and great write-up, nice work OP.</div><br/></div></div><div id="36024996" class="c"><input type="checkbox" id="c-36024996" checked=""/><div class="controls bullet"><span class="by">amelius</span><span>|</span><a href="#36026226">prev</a><span>|</span><label class="collapse" for="c-36024996">[-]</label><label class="expand" for="c-36024996">[2 more]</label></div><br/><div class="children"><div class="content">You really need a realtime-OS for this if you want to prevent buffer underruns from happening. Otherwise, it is certainly not audiophile-safe.</div><br/><div id="36025886" class="c"><input type="checkbox" id="c-36025886" checked=""/><div class="controls bullet"><span class="by">tonyarkles</span><span>|</span><a href="#36024996">parent</a><span>|</span><label class="collapse" for="c-36025886">[-]</label><label class="expand" for="c-36025886">[1 more]</label></div><br/><div class="children"><div class="content">I meanâ¦ Pro Tools, Reaper, Ableton, Logic, Cubaseâ¦ these all run just fine without an RTOS. But you did say âaudiophileâ specifically and not âaudio professionalâ so you might be right, but it likely doesnât matter in practice.</div><br/></div></div></div></div></div></div></div></div></div></body></html>