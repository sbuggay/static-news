<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1693904466104" as="style"/><link rel="stylesheet" href="styles.css?v=1693904466104"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://gist.github.com/senderle/8ad6aae251c4ddf9424f8a05dd0e8c18">So you want to modify the text of a PDF by hand (2020)</a> <span class="domain">(<a href="https://gist.github.com">gist.github.com</a>)</span></div><div class="subtext"><span>mutant_glofish</span> | <span>81 comments</span></div><br/><div><div id="37384319" class="c"><input type="checkbox" id="c-37384319" checked=""/><div class="controls bullet"><span class="by">blincoln</span><span>|</span><a href="#37384058">next</a><span>|</span><label class="collapse" for="c-37384319">[-]</label><label class="expand" for="c-37384319">[9 more]</label></div><br/><div class="children"><div class="content">The PDF specification is wild. My current favourite trivia is that it supports all of Photoshop&#x27;s layer blend modes for rendering overlapping elements.[1] My second-favourite is that it supports appended content that modifies earlier content, so one should always look for forensic evidence in all distinct versions represented in a given file.[2]<p>It&#x27;s also a fun example of the futility of DRM. The spec includes password-based encryption, and allows for different &quot;owner&quot; and &quot;user&quot; passwords. There&#x27;s a bitfield with options for things like &quot;prevent printing&quot;, &quot;prevent copying text&quot;, and so forth,[3] but because reading the document necessarily involves decrypting it, one can use the &quot;user&quot; password to open an encrypted PDF in a non-compliant tool,[4] then save the unencrypted version to get an editable equivalent.<p>[1] &quot;More than just transparency&quot; section of <a href="https:&#x2F;&#x2F;blog.adobe.com&#x2F;en&#x2F;publish&#x2F;2022&#x2F;01&#x2F;31&#x2F;20-years-of-transparency-in-pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.adobe.com&#x2F;en&#x2F;publish&#x2F;2022&#x2F;01&#x2F;31&#x2F;20-years-of-tra...</a><p>[2] <a href="https:&#x2F;&#x2F;blog.didierstevens.com&#x2F;2008&#x2F;05&#x2F;07&#x2F;solving-a-little-pdf-puzzle&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.didierstevens.com&#x2F;2008&#x2F;05&#x2F;07&#x2F;solving-a-little-p...</a><p>[3] Page 61 of <a href="https:&#x2F;&#x2F;opensource.adobe.com&#x2F;dc-acrobat-sdk-docs&#x2F;pdfstandards&#x2F;PDF32000_2008.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;opensource.adobe.com&#x2F;dc-acrobat-sdk-docs&#x2F;pdfstandard...</a><p>[4] For example, a script that uses the pypdf library.</div><br/><div id="37384523" class="c"><input type="checkbox" id="c-37384523" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#37384319">parent</a><span>|</span><a href="#37386443">next</a><span>|</span><label class="collapse" for="c-37384523">[-]</label><label class="expand" for="c-37384523">[1 more]</label></div><br/><div class="children"><div class="content">In the context of a format that was originally proprietary and not widely available to everyone, and conceived in an era where encryption was strongly controlled by export law, that sort of security-by-obscurity was very common. Incidentally, a popular cracking tutorial back then was to de-DRM the official reader by patching the function that checks those permissions.</div><br/></div></div><div id="37386443" class="c"><input type="checkbox" id="c-37386443" checked=""/><div class="controls bullet"><span class="by">totetsu</span><span>|</span><a href="#37384319">parent</a><span>|</span><a href="#37384523">prev</a><span>|</span><a href="#37384817">next</a><span>|</span><label class="collapse" for="c-37386443">[-]</label><label class="expand" for="c-37386443">[2 more]</label></div><br/><div class="children"><div class="content">Howto <a href="https:&#x2F;&#x2F;www.cyberciti.biz&#x2F;faq&#x2F;removing-password-from-pdf-on-linux&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.cyberciti.biz&#x2F;faq&#x2F;removing-password-from-pdf-on-...</a></div><br/><div id="37387955" class="c"><input type="checkbox" id="c-37387955" checked=""/><div class="controls bullet"><span class="by">Helmut10001</span><span>|</span><a href="#37384319">root</a><span>|</span><a href="#37386443">parent</a><span>|</span><a href="#37384817">next</a><span>|</span><label class="collapse" for="c-37387955">[-]</label><label class="expand" for="c-37387955">[1 more]</label></div><br/><div class="children"><div class="content">Or:<p><pre><code>    qpdf --decrypt &lt;source pdf&gt; &lt;destination pdf&gt;</code></pre></div><br/></div></div></div></div><div id="37384817" class="c"><input type="checkbox" id="c-37384817" checked=""/><div class="controls bullet"><span class="by">aardvark179</span><span>|</span><a href="#37384319">parent</a><span>|</span><a href="#37386443">prev</a><span>|</span><a href="#37384752">next</a><span>|</span><label class="collapse" for="c-37384817">[-]</label><label class="expand" for="c-37384817">[3 more]</label></div><br/><div class="children"><div class="content">Aren’t the blend modes supported just the Porter-Duff compositing modes? You might think that’s overkill, but it’s a really good mapping of what other rendering pipelines offer and it can really help reduce the work to produce a PDF.</div><br/><div id="37385179" class="c"><input type="checkbox" id="c-37385179" checked=""/><div class="controls bullet"><span class="by">pavlov</span><span>|</span><a href="#37384319">root</a><span>|</span><a href="#37384817">parent</a><span>|</span><a href="#37384752">next</a><span>|</span><label class="collapse" for="c-37385179">[-]</label><label class="expand" for="c-37385179">[2 more]</label></div><br/><div class="children"><div class="content">The original Porter-Duff compositing operators don’t cover Photoshop-style blending. Here’s a link with pictures:<p><a href="http:&#x2F;&#x2F;ssp.impulsetrain.com&#x2F;porterduff.html" rel="nofollow noreferrer">http:&#x2F;&#x2F;ssp.impulsetrain.com&#x2F;porterduff.html</a><p>The Porter-Duff operators are appealingly rigorous and easy to implement because they’re simply the possible combinations of a simple formula. But many of these operators are not very useful either.<p>The Photoshop blending modes are practically the opposite: they are not derived from anything mathematically appealing, it’s really just a collection of algorithms that Photoshop’s designers originally found useful. They reflect the limitations of their early 1990s desktop computer implementations (for example, no attempt is made to account for gamma correction when combining the layers, which makes many of these operations behave very differently from actual light that they mean to emulate).</div><br/><div id="37386069" class="c"><input type="checkbox" id="c-37386069" checked=""/><div class="controls bullet"><span class="by">aardvark179</span><span>|</span><a href="#37384319">root</a><span>|</span><a href="#37385179">parent</a><span>|</span><a href="#37384752">next</a><span>|</span><label class="collapse" for="c-37386069">[-]</label><label class="expand" for="c-37386069">[1 more]</label></div><br/><div class="children"><div class="content">An yes. I had forgotten that the blend modes added an arbitrary function that goes beyond the original model.</div><br/></div></div></div></div></div></div><div id="37384752" class="c"><input type="checkbox" id="c-37384752" checked=""/><div class="controls bullet"><span class="by">aidos</span><span>|</span><a href="#37384319">parent</a><span>|</span><a href="#37384817">prev</a><span>|</span><a href="#37384058">next</a><span>|</span><label class="collapse" for="c-37384752">[-]</label><label class="expand" for="c-37384752">[2 more]</label></div><br/><div class="children"><div class="content">To be fair, if you wanted to stop copying of text it would be easiest just to drop the ToUnicode mapping against the fonts and then it’s a manual process for people to recreate them.</div><br/><div id="37385087" class="c"><input type="checkbox" id="c-37385087" checked=""/><div class="controls bullet"><span class="by">miki123211</span><span>|</span><a href="#37384319">root</a><span>|</span><a href="#37384752">parent</a><span>|</span><a href="#37384058">next</a><span>|</span><label class="collapse" for="c-37385087">[-]</label><label class="expand" for="c-37385087">[1 more]</label></div><br/><div class="children"><div class="content">That also breaks search (and more importantly screen reader accessibility), and if you&#x27;re professionally required to specifically produce PDFs with these security features enabled, you&#x27;re pretty likely to be working in a context where that would be illegal.</div><br/></div></div></div></div></div></div><div id="37384058" class="c"><input type="checkbox" id="c-37384058" checked=""/><div class="controls bullet"><span class="by">aidos</span><span>|</span><a href="#37384319">prev</a><span>|</span><a href="#37384546">next</a><span>|</span><label class="collapse" for="c-37384058">[-]</label><label class="expand" for="c-37384058">[11 more]</label></div><br/><div class="children"><div class="content">This topic comes up periodically as most people think PDFs are some impenetrable binary format, but they’re really not.<p>They are a graph of objects of different types. The types themselves are well described in the official spec (I’m a sadist, I read it for fun).<p>My advice is always to convert the pdf to a version without compressed data like the author here has. My tool of choice is mutool (mutool clean -d in.pdf out.pdf). Then just have a rummage. You’ll be surprised by how much you can follow.<p>In the article the author missed a step where you look at the page object to see the resources. That’s where the mapping from the font name use in the content stream to the underlying object is made.<p>There’s also another important bit missing - most fonts are subset into the pdf. Ie, only the glyphs that are needed are maintained in the font. I think that’s often where the re-encoding happens. ToUnicode is maintained to allow you to copy text (or search in a PDF). It’s a nice to have for users (in my experience it’s normally there and correct though).</div><br/><div id="37384310" class="c"><input type="checkbox" id="c-37384310" checked=""/><div class="controls bullet"><span class="by">esafak</span><span>|</span><a href="#37384058">parent</a><span>|</span><a href="#37388865">next</a><span>|</span><label class="collapse" for="c-37384310">[-]</label><label class="expand" for="c-37384310">[6 more]</label></div><br/><div class="children"><div class="content">It is a shame Adobe designed a format so hard to work with that people are amazed when someone accomplishes what should be a basic task with it.<p>Their design philosophy of creating a read-only format was flawed to begin with. What&#x27;s the first feature people are going to ask for??</div><br/><div id="37385489" class="c"><input type="checkbox" id="c-37385489" checked=""/><div class="controls bullet"><span class="by">pwg</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37384310">parent</a><span>|</span><a href="#37384610">next</a><span>|</span><label class="collapse" for="c-37385489">[-]</label><label class="expand" for="c-37385489">[4 more]</label></div><br/><div class="children"><div class="content">&gt; It is a shame Adobe designed a format so hard to work with<p>PDF was not designed to be editable, nor for anyone to &quot;work with&quot; it in that way.<p>It was designed (at least the original purpose circa 1989) to represent printed pages electronically in a format that would view and print identically everywhere.  In fact, the initial advertising for the &quot;value&quot; of the PDF format was exactly this, no matter where a recipient viewed your PDF output, it would look, and print, identically to everywhere else.<p>It was originally meant to be &quot;electronic paper&quot;.</div><br/><div id="37385752" class="c"><input type="checkbox" id="c-37385752" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37385489">parent</a><span>|</span><a href="#37384610">next</a><span>|</span><label class="collapse" for="c-37385752">[-]</label><label class="expand" for="c-37385752">[3 more]</label></div><br/><div class="children"><div class="content">Wasn&#x27;t the PDF format based on the Illustrator format?<p>The weird thing to me is people using a distribution format as an original source. It&#x27;s right up there with video cameras shooting an acquisition source as an MP4 and all of the negative baggage that comes with that.</div><br/><div id="37385878" class="c"><input type="checkbox" id="c-37385878" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37385752">parent</a><span>|</span><a href="#37387275">next</a><span>|</span><label class="collapse" for="c-37385878">[-]</label><label class="expand" for="c-37385878">[1 more]</label></div><br/><div class="children"><div class="content">I believe Illustrator format is very similar to PostScript.</div><br/></div></div><div id="37387275" class="c"><input type="checkbox" id="c-37387275" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37385752">parent</a><span>|</span><a href="#37385878">prev</a><span>|</span><a href="#37384610">next</a><span>|</span><label class="collapse" for="c-37387275">[-]</label><label class="expand" for="c-37387275">[1 more]</label></div><br/><div class="children"><div class="content">1.4.4 Portable Document Format (PDF)
Adobe has specified another format, PDF, for portable representation of electronic documents. PDF is documented in the Portable Document Format Reference
Manual.
PDF and the PostScript language share the same underlying Adobe imaging
model. A document can be converted straightforwardly between PDF and the
PostScript language; the two representations produce the same output when
printed. However, PDF lacks the general-purpose programming language framework of the PostScript language. A PDF document is a static data structure that is
designed for efficient random access and includes navigational information suitable for interactive viewing.<p>-- <a href="https:&#x2F;&#x2F;www.adobe.com&#x2F;jp&#x2F;print&#x2F;postscript&#x2F;pdfs&#x2F;PLRM.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.adobe.com&#x2F;jp&#x2F;print&#x2F;postscript&#x2F;pdfs&#x2F;PLRM.pdf</a></div><br/></div></div></div></div></div></div><div id="37384610" class="c"><input type="checkbox" id="c-37384610" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37384310">parent</a><span>|</span><a href="#37385489">prev</a><span>|</span><a href="#37388865">next</a><span>|</span><label class="collapse" for="c-37384610">[-]</label><label class="expand" for="c-37384610">[1 more]</label></div><br/><div class="children"><div class="content">.. waves to Leonard Rosenthol</div><br/></div></div></div></div><div id="37388865" class="c"><input type="checkbox" id="c-37388865" checked=""/><div class="controls bullet"><span class="by">azangru</span><span>|</span><a href="#37384058">parent</a><span>|</span><a href="#37384310">prev</a><span>|</span><a href="#37387136">next</a><span>|</span><label class="collapse" for="c-37388865">[-]</label><label class="expand" for="c-37388865">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I’m a sadist, I read it for fun.<p>I think this is called masochist. Now, if you participated in writing the spec or were making others read it...</div><br/></div></div><div id="37387136" class="c"><input type="checkbox" id="c-37387136" checked=""/><div class="controls bullet"><span class="by">gobdovan</span><span>|</span><a href="#37384058">parent</a><span>|</span><a href="#37388865">prev</a><span>|</span><a href="#37387310">next</a><span>|</span><label class="collapse" for="c-37387136">[-]</label><label class="expand" for="c-37387136">[1 more]</label></div><br/><div class="children"><div class="content">If you find pleasure in something that gives you pain, you&#x27;re a masochist. A sadist likes inflicting pain onto others. Since you seem that you like helping people I&#x27;d say it&#x27;s more likely you&#x27;re the former. I appreciate the mutool advice!</div><br/></div></div><div id="37387310" class="c"><input type="checkbox" id="c-37387310" checked=""/><div class="controls bullet"><span class="by">haolez</span><span>|</span><a href="#37384058">parent</a><span>|</span><a href="#37387136">prev</a><span>|</span><a href="#37384546">next</a><span>|</span><label class="collapse" for="c-37387310">[-]</label><label class="expand" for="c-37387310">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s awesome. I&#x27;m relying a lot  on Amazon Textract for my PDF parsing needs.<p>Do you have any other insights on how to do a good job at that natively, i.e. without a cloud provider? Especially when dealing with tables.</div><br/><div id="37387673" class="c"><input type="checkbox" id="c-37387673" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#37384058">root</a><span>|</span><a href="#37387310">parent</a><span>|</span><a href="#37384546">next</a><span>|</span><label class="collapse" for="c-37387673">[-]</label><label class="expand" for="c-37387673">[1 more]</label></div><br/><div class="children"><div class="content">PDF format does not give you enough semantic information to understand there is a table. The stream contains instructions such as moving to a coordinate, adding some text, adding some lines. No tool can extract tables with 100% precision.</div><br/></div></div></div></div></div></div><div id="37384546" class="c"><input type="checkbox" id="c-37384546" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#37384058">prev</a><span>|</span><a href="#37384220">next</a><span>|</span><label class="collapse" for="c-37384546">[-]</label><label class="expand" for="c-37384546">[7 more]</label></div><br/><div class="children"><div class="content">You can do this:<p><pre><code>    pdf2ps a.pdf    # convert to postscript &quot;a.ps&quot;
    vim a.ps        # edit postscript by hand
    ps2pdf a.ps     # convert back to pdf
</code></pre>
Some complex pdf (with embedded javascript, animations, etc) fail to work correctly after this back and forth.  Yet for &quot;plain&quot; documents this works alright.  You can easily remove watermarks, change some words and numbers, etc.  Spacing is harder to modify.  Of course you need to know some postscript.</div><br/><div id="37387590" class="c"><input type="checkbox" id="c-37387590" checked=""/><div class="controls bullet"><span class="by">hnick</span><span>|</span><a href="#37384546">parent</a><span>|</span><a href="#37386878">next</a><span>|</span><label class="collapse" for="c-37387590">[-]</label><label class="expand" for="c-37387590">[1 more]</label></div><br/><div class="children"><div class="content">This is essentially how we used to do it for some &quot;print-ready&quot; jobs at a mailhouse I worked at. Usually we&#x27;d use proper tools to produce documents ready to print, but sometimes clients thought they knew better and would send us PDFs. It was more effort to work with those usually, and had a higher chance of errors.<p>Even if the output was correct, we still needed to re-order pages, apply barcodes for mail machine processing and postal sorting, and produce reports - which usually involved text scraping off the page to get an address via perl and other tools. Much easier in PS than PDF usually, but sometimes very unreliable when e.g. their PDFs were &#x27;secure&#x27; and didn&#x27;t have correct glyph mappings.<p>In the worst cases, they would supply single document PDFs, and merging those would cause an explosion of subset fonts in the output which would fill the printer&#x27;s memory and crash it. When I stopped working in the area, I think there still wasn&#x27;t a useful tool to consolidate and merge subset fonts known to come from the same parent font - it would have been a very useful tool and should be possible but I didn&#x27;t have the time or knowledge to look into it.</div><br/></div></div><div id="37386878" class="c"><input type="checkbox" id="c-37386878" checked=""/><div class="controls bullet"><span class="by">indeedmug</span><span>|</span><a href="#37384546">parent</a><span>|</span><a href="#37387590">prev</a><span>|</span><a href="#37387835">next</a><span>|</span><label class="collapse" for="c-37386878">[-]</label><label class="expand" for="c-37386878">[3 more]</label></div><br/><div class="children"><div class="content">If you can put javascript and animations in pdf, what&#x27;s stopping you from making a frontend in it? I wonder what are the frontiers of things you can do in pdf.<p>Honestly, it seems like only malware authors benefit from the complexity of pdfs.</div><br/><div id="37388752" class="c"><input type="checkbox" id="c-37388752" checked=""/><div class="controls bullet"><span class="by">haraldooo</span><span>|</span><a href="#37384546">root</a><span>|</span><a href="#37386878">parent</a><span>|</span><a href="#37388665">next</a><span>|</span><label class="collapse" for="c-37388752">[-]</label><label class="expand" for="c-37388752">[1 more]</label></div><br/><div class="children"><div class="content">MacOS‘s Quartz (original 2D rendering) is based on pdf: <a href="https:&#x2F;&#x2F;www.prepressure.com&#x2F;pdf&#x2F;basics&#x2F;osx-quartz" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.prepressure.com&#x2F;pdf&#x2F;basics&#x2F;osx-quartz</a></div><br/></div></div><div id="37388665" class="c"><input type="checkbox" id="c-37388665" checked=""/><div class="controls bullet"><span class="by">lionkor</span><span>|</span><a href="#37384546">root</a><span>|</span><a href="#37386878">parent</a><span>|</span><a href="#37388752">prev</a><span>|</span><a href="#37387835">next</a><span>|</span><label class="collapse" for="c-37388665">[-]</label><label class="expand" for="c-37388665">[1 more]</label></div><br/><div class="children"><div class="content">The most widespread javascript packaging format turns out to be PDF[1]<p>[1] source: made it up</div><br/></div></div></div></div><div id="37387835" class="c"><input type="checkbox" id="c-37387835" checked=""/><div class="controls bullet"><span class="by">hackernewds</span><span>|</span><a href="#37384546">parent</a><span>|</span><a href="#37386878">prev</a><span>|</span><a href="#37384220">next</a><span>|</span><label class="collapse" for="c-37387835">[-]</label><label class="expand" for="c-37387835">[2 more]</label></div><br/><div class="children"><div class="content">in vim?</div><br/><div id="37388449" class="c"><input type="checkbox" id="c-37388449" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#37384546">root</a><span>|</span><a href="#37387835">parent</a><span>|</span><a href="#37384220">next</a><span>|</span><label class="collapse" for="c-37388449">[-]</label><label class="expand" for="c-37388449">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t matter, just use any text editor.</div><br/></div></div></div></div></div></div><div id="37384220" class="c"><input type="checkbox" id="c-37384220" checked=""/><div class="controls bullet"><span class="by">ks2048</span><span>|</span><a href="#37384546">prev</a><span>|</span><a href="#37389337">next</a><span>|</span><label class="collapse" for="c-37384220">[-]</label><label class="expand" for="c-37384220">[8 more]</label></div><br/><div class="children"><div class="content">This seems to be missing an important point: at the end of PDF is a table (&quot;cross-reference&quot; table) that stores the BYTE-OFFSET to different objects in the file.<p>If you modify things within the file, typically these offsets will change and the file will be corrupt. It looks like in this article, maybe they were only interested in changing one number to another, so none of the positions change.<p>But, generally, adding&#x2F;removing&#x2F;modifying things in the middle of the file require recomputing the xref table and thus become much easier to use a library rather than direct text editing.</div><br/><div id="37384892" class="c"><input type="checkbox" id="c-37384892" checked=""/><div class="controls bullet"><span class="by">gpvos</span><span>|</span><a href="#37384220">parent</a><span>|</span><a href="#37384483">next</a><span>|</span><label class="collapse" for="c-37384892">[-]</label><label class="expand" for="c-37384892">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why they decode it with qpdf and re-encode it again afterwards, so qpdf takes care of that. qpdf reconstructs the original PDF structure, and I think it even tries to keep the object numbers the same, but the offsets are recalculated completely.</div><br/></div></div><div id="37384483" class="c"><input type="checkbox" id="c-37384483" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#37384220">parent</a><span>|</span><a href="#37384892">prev</a><span>|</span><a href="#37384699">next</a><span>|</span><label class="collapse" for="c-37384483">[-]</label><label class="expand" for="c-37384483">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the weirdest part of the PDF spec IMHO. It&#x27;s a mix of both binary and text, with text-specified byte offsets. It would be very interesting to read about why the format became like that, if its authors would ever talk about it. My guess is that it was meant to be completely textual at first (but then requiring the xref table to have fixed-length entries is odd), and then they decided binary would be more efficient.</div><br/><div id="37384645" class="c"><input type="checkbox" id="c-37384645" checked=""/><div class="controls bullet"><span class="by">detourdog</span><span>|</span><a href="#37384220">root</a><span>|</span><a href="#37384483">parent</a><span>|</span><a href="#37385053">next</a><span>|</span><label class="collapse" for="c-37384645">[-]</label><label class="expand" for="c-37384645">[1 more]</label></div><br/><div class="children"><div class="content">I actually was at a Acrobat&#x2F;PDF launch event in midtown NYC.
It was an embedded file type that could be generated at the type of publishing and all dependencies could either be embedded or not.<p>This made a coherent point in a digital workflow that could be saved and reprinted with ease. This was a big deal before the portable document format came to be.<p>I once made a workflow that took pdf files from Word, filemaker, excel, and mini-cad. This all got combined into a single 9,000 page pdf. The final pdf had a coherent thumbnails, page numbers and headers and footer.<p>Only took a couple of hours to get the final documnet after pushing the go buttton.</div><br/></div></div><div id="37385053" class="c"><input type="checkbox" id="c-37385053" checked=""/><div class="controls bullet"><span class="by">Someone</span><span>|</span><a href="#37384220">root</a><span>|</span><a href="#37384483">parent</a><span>|</span><a href="#37384645">prev</a><span>|</span><a href="#37385424">next</a><span>|</span><label class="collapse" for="c-37385053">[-]</label><label class="expand" for="c-37385053">[1 more]</label></div><br/><div class="children"><div class="content">&gt; My guess is that it was meant to be completely textual at first<p>It indeed started life as “not Turing complete postscript with an index” (those makes it easy to render just the third page of a PDF file, something that’s impossible in postscript without rendering the first and second pages first). Like postscript, that was a pure text format.<p>One nice feature is that you can append a few pieces and a new index to an existing PDF file and get a new valid PDF file (which would still contain its old index as a piece of “junk DNA”)<p>I think compression was added because users complained about file sizes. Ascii85 (<a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Ascii85" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Ascii85</a>) grows binary data by 25%.<p>&gt; but then requiring the xref table to have fixed-length entries is odd<p>My guess is that made it easier to hack together a tool to convert PDF to postscript.</div><br/></div></div><div id="37385424" class="c"><input type="checkbox" id="c-37385424" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#37384220">root</a><span>|</span><a href="#37384483">parent</a><span>|</span><a href="#37385053">prev</a><span>|</span><a href="#37384699">next</a><span>|</span><label class="collapse" for="c-37385424">[-]</label><label class="expand" for="c-37385424">[1 more]</label></div><br/><div class="children"><div class="content">The roots of PDF are PostScript, which is like Forth, and is text-based, so that’s why</div><br/></div></div></div></div><div id="37384699" class="c"><input type="checkbox" id="c-37384699" checked=""/><div class="controls bullet"><span class="by">aidos</span><span>|</span><a href="#37384220">parent</a><span>|</span><a href="#37384483">prev</a><span>|</span><a href="#37384793">next</a><span>|</span><label class="collapse" for="c-37384699">[-]</label><label class="expand" for="c-37384699">[1 more]</label></div><br/><div class="children"><div class="content">In my experience it’s easiest just to break the xref table and run something like “mutool clean” to fix it again. It can be completely derived from the content so it’s safe to do.</div><br/></div></div><div id="37384793" class="c"><input type="checkbox" id="c-37384793" checked=""/><div class="controls bullet"><span class="by">bena</span><span>|</span><a href="#37384220">parent</a><span>|</span><a href="#37384699">prev</a><span>|</span><a href="#37389337">next</a><span>|</span><label class="collapse" for="c-37384793">[-]</label><label class="expand" for="c-37384793">[1 more]</label></div><br/><div class="children"><div class="content">Ah. So it&#x27;s a lot like editing compiled binaries.<p>You can modify binaries all you want as long as you preserve the length of everything.<p>Some piece of software we had authenticated against a server, but everything was done on the client. The client executed SQL against the server directly, etc. Basically, the server checked to see if this client would put you over the number of licenses you purchased and that&#x27;s it.<p>I had run it against a disassembler, found the part where it performed the check, and was able to change it to a straight JMP and then pad the rest of the space with NOPs.</div><br/></div></div></div></div><div id="37389337" class="c"><input type="checkbox" id="c-37389337" checked=""/><div class="controls bullet"><span class="by">herbst</span><span>|</span><a href="#37384220">prev</a><span>|</span><a href="#37384741">next</a><span>|</span><label class="collapse" for="c-37389337">[-]</label><label class="expand" for="c-37389337">[1 more]</label></div><br/><div class="children"><div class="content">Just a heads up. You can edit PDFs in Gimp. AFAIK it just embeds a huge image in the end but easy to add a signature or something</div><br/></div></div><div id="37384741" class="c"><input type="checkbox" id="c-37384741" checked=""/><div class="controls bullet"><span class="by">jl6</span><span>|</span><a href="#37389337">prev</a><span>|</span><a href="#37388882">next</a><span>|</span><label class="collapse" for="c-37384741">[-]</label><label class="expand" for="c-37384741">[4 more]</label></div><br/><div class="children"><div class="content">This seems to be missing an important step in the use of qpdf’s --qdf mode: after you’ve finished editing, you need to run the file through the fix-pdf utility to recalculate all the object offsets and rebuild the cross-reference table that lives at the end of the file (unless you only change bytes in-place rather than adding or removing bytes).<p>My top 3 fun PDF facts:<p>1) Although PDF documents are typically 8-bit binary files, you can make one that is valid UTF-8 “plain text”, even including images, through the use of the ASCII85 filter.[0]<p>2) PDF allows an incredible variety of freaky features (3D objects, JavaScript, movies in an embedded flash object, invisible annotations…). PDF&#x2F;A is a much saner, safer subset.<p>3) The PDF spec allows you to write widgets (e.g. form controls) using “rich text”, which is a subset of XHTML and CSS - but this feature is very sparsely supported outside the official Adobe Reader.<p>[0] For example: <a href="https:&#x2F;&#x2F;lab6.com&#x2F;2" rel="nofollow noreferrer">https:&#x2F;&#x2F;lab6.com&#x2F;2</a></div><br/><div id="37384928" class="c"><input type="checkbox" id="c-37384928" checked=""/><div class="controls bullet"><span class="by">gpvos</span><span>|</span><a href="#37384741">parent</a><span>|</span><a href="#37388882">next</a><span>|</span><label class="collapse" for="c-37384928">[-]</label><label class="expand" for="c-37384928">[3 more]</label></div><br/><div class="children"><div class="content">After you&#x27;ve finished editing, just run it through qpdf without parameters, as explained in the beginning of the article, and it will recompress the data and recreate the xref table. No need for yet another tool.</div><br/><div id="37385273" class="c"><input type="checkbox" id="c-37385273" checked=""/><div class="controls bullet"><span class="by">jl6</span><span>|</span><a href="#37384741">root</a><span>|</span><a href="#37384928">parent</a><span>|</span><a href="#37388882">next</a><span>|</span><label class="collapse" for="c-37385273">[-]</label><label class="expand" for="c-37385273">[2 more]</label></div><br/><div class="children"><div class="content">I guess you could, but this is the source of the errors (actually warnings) that the article mentions. Probably best to fix the file with the provided tool (fix-qdf is distributed with qpdf) rather than get in the habit of ignoring warnings.</div><br/><div id="37388333" class="c"><input type="checkbox" id="c-37388333" checked=""/><div class="controls bullet"><span class="by">gpvos</span><span>|</span><a href="#37384741">root</a><span>|</span><a href="#37385273">parent</a><span>|</span><a href="#37388882">next</a><span>|</span><label class="collapse" for="c-37388333">[-]</label><label class="expand" for="c-37388333">[1 more]</label></div><br/><div class="children"><div class="content">OK. I have never needed or used fix-qdf and forgot about it, so your typo (fix-pdf) made me think it was from a different package.</div><br/></div></div></div></div></div></div></div></div><div id="37388882" class="c"><input type="checkbox" id="c-37388882" checked=""/><div class="controls bullet"><span class="by">pmontra</span><span>|</span><a href="#37384741">prev</a><span>|</span><a href="#37385373">next</a><span>|</span><label class="collapse" for="c-37388882">[-]</label><label class="expand" for="c-37388882">[1 more]</label></div><br/><div class="children"><div class="content">Some small PDF files are saved as uncompressed text. Invoices are a typical example.<p>This means that we can open those files, read them as one single string and match the expected text in unit tests. I&#x27;ve got a few projects doing that and it was fine.<p>If the text is compressed, pipe its content to qpdf first.</div><br/></div></div><div id="37385373" class="c"><input type="checkbox" id="c-37385373" checked=""/><div class="controls bullet"><span class="by">miki123211</span><span>|</span><a href="#37388882">prev</a><span>|</span><a href="#37385569">next</a><span>|</span><label class="collapse" for="c-37385373">[-]</label><label class="expand" for="c-37385373">[2 more]</label></div><br/><div class="children"><div class="content">What people often miss about PDF is that it&#x27;s closer to an image format in some ways than to a Word document. Word documents, PDFs and images are in document editing what DAW projects, midis and mp3 files are in music and what Java source code, JVM bytecode and pure x86 machine code are in software.<p>The primary purpose of a PDF file is to tell you what to display (or print), with perfect clarity, in much fewer bytes than an actual image would take. It exploits the fact that the document creator knows about patterns in the document structure that, if expressed properly, make the document much more compressible than anything that an actual image compression algorithm could accomplish. For example, if you have access to the actual font, it&#x27;s better to say &quot;put these characters at these coordinates with that much spacing between them&quot; than to include every occurrence of every character as a part of the image, hoping that the compression algorithm notices and compresses away the repetitions. Things like what character is part of what word, or even what unicode codepoint is mapped to which font glyph are basically unimportant if all you&#x27;re after is efficiently transferring the image of a document.<p>If you have an editable document, you care a lot more about the semantics of the content, not just about its presentation. It matters to you whether a particular break in the text is supposed to be multiple spaces, the next column in a table or just a weird page layout caused by an image being present. If you have some text at the bottom of each page, you care whether that text was put there by the document author multiple times, or whether it was entered once and set as a footer. If you add a new paragraph and have to change page layout, it matters to you that the last paragraph on this page is a footnote and should not be moved to the next one. If a section heading moves to another page, you care about the fact that the table of contents should update automatically and isn&#x27;t just some text that the author has manually entered. If you&#x27;re a printer or screen, you care about none of these things, you just print or display whatever you&#x27;re told to print or display. For a PDF, footnotes, section headings, footers or tables of contents don&#x27;t have to be special, they can just be text with some meaningless formatting applied to it. This is why making PDF work for any purpose which isn&#x27;t displaying or printing is never going to be 100% accurate. Of course, there are efforts to remedy this, and a PDF-creating program is free to include any metadata it sees fit, but it&#x27;s by no means required to do so.<p>This isn&#x27;t necessarily the mental model that the PDF authors had in mind, but it&#x27;s an useful way to look at PDF and understand why it is the way it is.</div><br/><div id="37388754" class="c"><input type="checkbox" id="c-37388754" checked=""/><div class="controls bullet"><span class="by">mannyv</span><span>|</span><a href="#37385373">parent</a><span>|</span><a href="#37385569">next</a><span>|</span><label class="collapse" for="c-37388754">[-]</label><label class="expand" for="c-37388754">[1 more]</label></div><br/><div class="children"><div class="content">The original goal of PDF was to have a portable print fidelity copy; WYSIWYG for real. You could take a PDF file and print it on a laser printer, a linotype, or a screen and it would look the same.<p>If you printed it on a postscript printer it would look exactly the same (or better, if you used type 1 fonts).</div><br/></div></div></div></div><div id="37385569" class="c"><input type="checkbox" id="c-37385569" checked=""/><div class="controls bullet"><span class="by">desgeeko</span><span>|</span><a href="#37385373">prev</a><span>|</span><a href="#37385394">next</a><span>|</span><label class="collapse" for="c-37385569">[-]</label><label class="expand" for="c-37385569">[1 more]</label></div><br/><div class="children"><div class="content">If you want to continue this journey and learn more about PDF, you can read the anatomy of a file I documented recently: 
<a href="https:&#x2F;&#x2F;pdfsyntax.dev&#x2F;introduction_pdf_syntax.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;pdfsyntax.dev&#x2F;introduction_pdf_syntax.html</a></div><br/></div></div><div id="37385394" class="c"><input type="checkbox" id="c-37385394" checked=""/><div class="controls bullet"><span class="by">eschaton</span><span>|</span><a href="#37385569">prev</a><span>|</span><a href="#37386865">next</a><span>|</span><label class="collapse" for="c-37385394">[-]</label><label class="expand" for="c-37385394">[7 more]</label></div><br/><div class="children"><div class="content">Anybody trying to do this is missing the point of PDF: It’s a <i>page-description format</i> and therefore only represents the <i>marks on a page</i>, not <i>document structure</i>.<p>One should not attempt to edit a PDF, one should edit the document from which the PDF is generated.</div><br/><div id="37385504" class="c"><input type="checkbox" id="c-37385504" checked=""/><div class="controls bullet"><span class="by">lucb1e</span><span>|</span><a href="#37385394">parent</a><span>|</span><a href="#37385578">next</a><span>|</span><label class="collapse" for="c-37385504">[-]</label><label class="expand" for="c-37385504">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll stop trying to edit PDFs when people stop sending me PDFs that I want to edit.<p>Somehow it became &quot;unprofessional&quot; to just send meant-to-be-editable documents around for everyone to enjoy, so this is where we end up...</div><br/><div id="37388241" class="c"><input type="checkbox" id="c-37388241" checked=""/><div class="controls bullet"><span class="by">NoPicklez</span><span>|</span><a href="#37385394">root</a><span>|</span><a href="#37385504">parent</a><span>|</span><a href="#37386248">next</a><span>|</span><label class="collapse" for="c-37388241">[-]</label><label class="expand" for="c-37388241">[1 more]</label></div><br/><div class="children"><div class="content">It isn&#x27;t &quot;somehow&quot; there are some legitimate reasons why.<p>When I send a client a final document (that&#x27;s not intended to be edited) in a .PDF format you can almost guarantee that it will look the same to them as it did for me. When I send someone a Word document, I can&#x27;t guarantee that it will look the same between different versions of Word, Mac Word, Pages, Google doc etc.<p>I&#x27;m not saying .PDF formats are perfect, but they&#x27;re certainly more consistently presented to the end user.</div><br/></div></div><div id="37386248" class="c"><input type="checkbox" id="c-37386248" checked=""/><div class="controls bullet"><span class="by">lacrimacida</span><span>|</span><a href="#37385394">root</a><span>|</span><a href="#37385504">parent</a><span>|</span><a href="#37388241">prev</a><span>|</span><a href="#37385578">next</a><span>|</span><label class="collapse" for="c-37386248">[-]</label><label class="expand" for="c-37386248">[1 more]</label></div><br/><div class="children"><div class="content">Yes, This is exactly the source of the problem. Otherwise editing would rarely be a problem or even needed. And for this it is extremely ill suited. I remember having printed a document, typed by hand and scan it back in a pressing situation. It felt bizantinely complicated and equally frustrating.</div><br/></div></div></div></div><div id="37385578" class="c"><input type="checkbox" id="c-37385578" checked=""/><div class="controls bullet"><span class="by">layer8</span><span>|</span><a href="#37385394">parent</a><span>|</span><a href="#37385504">prev</a><span>|</span><a href="#37385606">next</a><span>|</span><label class="collapse" for="c-37385578">[-]</label><label class="expand" for="c-37385578">[1 more]</label></div><br/><div class="children"><div class="content">PDF does support incorporating information about the logical document structure, aka Tagged PDF. It’s optional, but recommended for accessibility (e.g. PDF&#x2F;UA). See chapters 14.7–14.8 in [1].<p>[1] <a href="https:&#x2F;&#x2F;opensource.adobe.com&#x2F;dc-acrobat-sdk-docs&#x2F;pdfstandards&#x2F;PDF32000_2008.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;opensource.adobe.com&#x2F;dc-acrobat-sdk-docs&#x2F;pdfstandard...</a></div><br/></div></div><div id="37385606" class="c"><input type="checkbox" id="c-37385606" checked=""/><div class="controls bullet"><span class="by">o1y32</span><span>|</span><a href="#37385394">parent</a><span>|</span><a href="#37385578">prev</a><span>|</span><a href="#37385560">next</a><span>|</span><label class="collapse" for="c-37385606">[-]</label><label class="expand" for="c-37385606">[1 more]</label></div><br/><div class="children"><div class="content">&quot;should not&quot; is meaningless here, because in the real world there are tons of situations where people <i>want</i> you to edit PDF, one way or another</div><br/></div></div><div id="37385560" class="c"><input type="checkbox" id="c-37385560" checked=""/><div class="controls bullet"><span class="by">louthy</span><span>|</span><a href="#37385394">parent</a><span>|</span><a href="#37385606">prev</a><span>|</span><a href="#37386865">next</a><span>|</span><label class="collapse" for="c-37385560">[-]</label><label class="expand" for="c-37385560">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It’s a page-description format and therefore only represents the marks on a page, not document structure<p>Maybe they should have called it ‘Page Description Format’ then?  Instead of ‘Portable <i>Document</i> Format’</div><br/></div></div></div></div><div id="37386865" class="c"><input type="checkbox" id="c-37386865" checked=""/><div class="controls bullet"><span class="by">nathan_f77</span><span>|</span><a href="#37385394">prev</a><span>|</span><a href="#37386909">next</a><span>|</span><label class="collapse" for="c-37386865">[-]</label><label class="expand" for="c-37386865">[1 more]</label></div><br/><div class="children"><div class="content">Great post. I&#x27;ve spend a lot of time reading through the PDF specification over the last ~5 years while building DocSpring [1], and I still feel like I&#x27;ve barely scratched the surface. qpdf is a great tool. One of my other favorites is RUPS [2], which really lets you dig into the structure of a PDF.<p>[1] <a href="https:&#x2F;&#x2F;docspring.com" rel="nofollow noreferrer">https:&#x2F;&#x2F;docspring.com</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;itext&#x2F;i7j-rups">https:&#x2F;&#x2F;github.com&#x2F;itext&#x2F;i7j-rups</a></div><br/></div></div><div id="37386909" class="c"><input type="checkbox" id="c-37386909" checked=""/><div class="controls bullet"><span class="by">yboris</span><span>|</span><a href="#37386865">prev</a><span>|</span><a href="#37383774">next</a><span>|</span><label class="collapse" for="c-37386909">[-]</label><label class="expand" for="c-37386909">[2 more]</label></div><br/><div class="children"><div class="content">Semi-related(?) - I created a repository to convert PDF to JPG and back to PDF:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;whyboris&#x2F;PDF-to-JPG-to-PDF">https:&#x2F;&#x2F;github.com&#x2F;whyboris&#x2F;PDF-to-JPG-to-PDF</a><p>A government form didn&#x27;t have editable fields that needed to be filled out. And editing the PDF was impossible (password protection). This was my solution.</div><br/><div id="37387720" class="c"><input type="checkbox" id="c-37387720" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#37386909">parent</a><span>|</span><a href="#37383774">next</a><span>|</span><label class="collapse" for="c-37387720">[-]</label><label class="expand" for="c-37387720">[1 more]</label></div><br/><div class="children"><div class="content">On macOS using Preview you can add textual comments on otherwise uneditable PDFs. Then you can simply print the commented PDF as a new PDF.<p>Converting to JPG unnecessarily rasterizes text and introduces ugly compression artefacts.</div><br/></div></div></div></div><div id="37383774" class="c"><input type="checkbox" id="c-37383774" checked=""/><div class="controls bullet"><span class="by">seszett</span><span>|</span><a href="#37386909">prev</a><span>|</span><a href="#37388533">next</a><span>|</span><label class="collapse" for="c-37383774">[-]</label><label class="expand" for="c-37383774">[6 more]</label></div><br/><div class="children"><div class="content">Although this is an interesting dive into the PDF format, just opening the PDF in Libreoffice or Inkscape usually works fine to modify its text.</div><br/><div id="37383973" class="c"><input type="checkbox" id="c-37383973" checked=""/><div class="controls bullet"><span class="by">gcanyon</span><span>|</span><a href="#37383774">parent</a><span>|</span><a href="#37386457">next</a><span>|</span><label class="collapse" for="c-37383973">[-]</label><label class="expand" for="c-37383973">[4 more]</label></div><br/><div class="children"><div class="content">I’m interested in extracting the contents of a pdf form — many individual text boxes. You’re saying libre office would likely be able to parse that pdf into a usable format?</div><br/><div id="37384040" class="c"><input type="checkbox" id="c-37384040" checked=""/><div class="controls bullet"><span class="by">pikrzyszto</span><span>|</span><a href="#37383774">root</a><span>|</span><a href="#37383973">parent</a><span>|</span><a href="#37384217">next</a><span>|</span><label class="collapse" for="c-37384040">[-]</label><label class="expand" for="c-37384040">[1 more]</label></div><br/><div class="children"><div class="content">Poppler ( <a href="https:&#x2F;&#x2F;poppler.freedesktop.org&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;poppler.freedesktop.org&#x2F;</a> ) handles this for you with pdftotext utility. It also ships with bunch of other utilities to work with PDFs</div><br/></div></div><div id="37384217" class="c"><input type="checkbox" id="c-37384217" checked=""/><div class="controls bullet"><span class="by">anon____</span><span>|</span><a href="#37383774">root</a><span>|</span><a href="#37383973">parent</a><span>|</span><a href="#37384040">prev</a><span>|</span><a href="#37386457">next</a><span>|</span><label class="collapse" for="c-37384217">[-]</label><label class="expand" for="c-37384217">[2 more]</label></div><br/><div class="children"><div class="content">With LibreOffice Draw you can edit the PDF (modify the text, move or change images, etc), then save as pdf, but it can&#x27;t parse and save it as .odt, .doc, .html or similar.</div><br/><div id="37384518" class="c"><input type="checkbox" id="c-37384518" checked=""/><div class="controls bullet"><span class="by">ShadowBanThis01</span><span>|</span><a href="#37383774">root</a><span>|</span><a href="#37384217">parent</a><span>|</span><a href="#37386457">next</a><span>|</span><label class="collapse" for="c-37384518">[-]</label><label class="expand" for="c-37384518">[1 more]</label></div><br/><div class="children"><div class="content">LibreOffice has some really perplexing functionality gaps.<p>The one that baffles me is that it doesn&#x27;t understand its own graphics format, so you have to export drawings to TIFF or something (if I remember correctly).</div><br/></div></div></div></div></div></div><div id="37386457" class="c"><input type="checkbox" id="c-37386457" checked=""/><div class="controls bullet"><span class="by">totetsu</span><span>|</span><a href="#37383774">parent</a><span>|</span><a href="#37383973">prev</a><span>|</span><a href="#37388533">next</a><span>|</span><label class="collapse" for="c-37386457">[-]</label><label class="expand" for="c-37386457">[1 more]</label></div><br/><div class="children"><div class="content">Pdfmaster is a good tool for this too but the free version leaves a watermark</div><br/></div></div></div></div><div id="37388533" class="c"><input type="checkbox" id="c-37388533" checked=""/><div class="controls bullet"><span class="by">tomalbrc</span><span>|</span><a href="#37383774">prev</a><span>|</span><a href="#37385845">next</a><span>|</span><label class="collapse" for="c-37388533">[-]</label><label class="expand" for="c-37388533">[1 more]</label></div><br/><div class="children"><div class="content">I have been using Apples Preview.app to open &quot;encrypted&quot; or protected PDFs for quite a while, until it stopped working (Big Sur)</div><br/></div></div><div id="37385845" class="c"><input type="checkbox" id="c-37385845" checked=""/><div class="controls bullet"><span class="by">jordann</span><span>|</span><a href="#37388533">prev</a><span>|</span><a href="#37385761">next</a><span>|</span><label class="collapse" for="c-37385845">[-]</label><label class="expand" for="c-37385845">[2 more]</label></div><br/><div class="children"><div class="content">If you don&#x27;t mind using java, you can use the open source Apache PDFBox library<p><a href="https:&#x2F;&#x2F;pdfbox.apache.org&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;pdfbox.apache.org&#x2F;</a><p>It&#x27;s relatively performant and it&#x27;s a mature and supported codebase that can accomplish most pdf tasks.</div><br/><div id="37389192" class="c"><input type="checkbox" id="c-37389192" checked=""/><div class="controls bullet"><span class="by">Drakinte</span><span>|</span><a href="#37385845">parent</a><span>|</span><a href="#37385761">next</a><span>|</span><label class="collapse" for="c-37389192">[-]</label><label class="expand" for="c-37389192">[1 more]</label></div><br/><div class="children"><div class="content">Except text substitution<p><a href="https:&#x2F;&#x2F;pdfbox.apache.org&#x2F;2.0&#x2F;migration.html#why-was-the-replacetext-example-removed%3F" rel="nofollow noreferrer">https:&#x2F;&#x2F;pdfbox.apache.org&#x2F;2.0&#x2F;migration.html#why-was-the-rep...</a><p>&gt; ReplaceText example has been removed as it gave the incorrect illusion that text can be replaced easily</div><br/></div></div></div></div><div id="37385761" class="c"><input type="checkbox" id="c-37385761" checked=""/><div class="controls bullet"><span class="by">Const-me</span><span>|</span><a href="#37385845">prev</a><span>|</span><a href="#37384747">next</a><span>|</span><label class="collapse" for="c-37385761">[-]</label><label class="expand" for="c-37385761">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I didn&#x27;t see an obvious open-source tool that lets you dig into PDF internals<p>That’s a matter of the toolset. I program C#, and I have good experience with that open source library: <a href="https:&#x2F;&#x2F;www.nuget.org&#x2F;packages&#x2F;iTextSharp-LGPL&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.nuget.org&#x2F;packages&#x2F;iTextSharp-LGPL&#x2F;</a> It’s a decade old by now, but PDF ain’t exactly a new format. That library is not terribly bad for many practical use cases. Particularly good when you only need to create the documents as opposed to editing them, because for that use case you’d want to use an old version of the format anyway, for optimal compatibility.</div><br/></div></div><div id="37384747" class="c"><input type="checkbox" id="c-37384747" checked=""/><div class="controls bullet"><span class="by">LispSporks22</span><span>|</span><a href="#37385761">prev</a><span>|</span><a href="#37388231">next</a><span>|</span><label class="collapse" for="c-37384747">[-]</label><label class="expand" for="c-37384747">[1 more]</label></div><br/><div class="children"><div class="content">As I recall, words aren’t even necessarily made up of contiguous characters. Especially true in OCRed documents in PDF.</div><br/></div></div><div id="37388231" class="c"><input type="checkbox" id="c-37388231" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#37384747">prev</a><span>|</span><a href="#37385621">next</a><span>|</span><label class="collapse" for="c-37388231">[-]</label><label class="expand" for="c-37388231">[1 more]</label></div><br/><div class="children"><div class="content">Is there any tool that competes with Adobe Acrobat? Like the censoring tool is rarely founs anywhere else.</div><br/></div></div><div id="37385621" class="c"><input type="checkbox" id="c-37385621" checked=""/><div class="controls bullet"><span class="by">schlowmo</span><span>|</span><a href="#37388231">prev</a><span>|</span><a href="#37385612">next</a><span>|</span><label class="collapse" for="c-37385621">[-]</label><label class="expand" for="c-37385621">[3 more]</label></div><br/><div class="children"><div class="content">PDF is such a weird format. Not so long ago I had to write some Java code for manipulating PDFs: find a string, remove it and place an image at the former string position. I should have known better as I thought &quot;Well, how hard can that be?”<p>What followed was a deep dive down the rabbit hole, a lot of fiddling with the same tools the author of this gist is using trying to make sense of it all.<p>The final solution worked better than I thought while at the same time felt incredibly wrong.<p>I&#x27;m very thankful for all the (probably painful) work that went into those open source PDF tools.</div><br/><div id="37387093" class="c"><input type="checkbox" id="c-37387093" checked=""/><div class="controls bullet"><span class="by">mx_02</span><span>|</span><a href="#37385621">parent</a><span>|</span><a href="#37385612">next</a><span>|</span><label class="collapse" for="c-37387093">[-]</label><label class="expand" for="c-37387093">[2 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;Well, how hard can that be?”<p>Very hard?<p>I worked on a tool that generated PDFs based on API responses. The tool added charts from the api data.<p>Those PDFs were reports with some hardcoded text.<p>Yesh what a fun ride that was.</div><br/><div id="37387686" class="c"><input type="checkbox" id="c-37387686" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#37385621">root</a><span>|</span><a href="#37387093">parent</a><span>|</span><a href="#37385612">next</a><span>|</span><label class="collapse" for="c-37387686">[-]</label><label class="expand" for="c-37387686">[1 more]</label></div><br/><div class="children"><div class="content">Generating PDFs are incredibly easy. I just generate LaTeX and run it through lualatex. When precise positioning is needed, I just use a giant tikzpicture.</div><br/></div></div></div></div></div></div><div id="37385612" class="c"><input type="checkbox" id="c-37385612" checked=""/><div class="controls bullet"><span class="by">crtified</span><span>|</span><a href="#37385621">prev</a><span>|</span><a href="#37384059">next</a><span>|</span><label class="collapse" for="c-37385612">[-]</label><label class="expand" for="c-37385612">[1 more]</label></div><br/><div class="children"><div class="content">This brings back horrible memories of working with large complex maps back in the 2000s. Having various CAD and GIS applications generate messy, inefficient spaghetti-coded PDF outputs - then bouncing those PDFs around the Adobe apps of the time, to add effects and other prettifications not available in the mapping apps.<p>It would reach the point where things would start to break, and .... &quot;good times were had, by all&quot;.</div><br/></div></div><div id="37384059" class="c"><input type="checkbox" id="c-37384059" checked=""/><div class="controls bullet"><span class="by">lucascacho</span><span>|</span><a href="#37385612">prev</a><span>|</span><a href="#37385219">next</a><span>|</span><label class="collapse" for="c-37384059">[-]</label><label class="expand" for="c-37384059">[1 more]</label></div><br/><div class="children"><div class="content">Every time I read about the hardships of interacting with the PDF format, I gain more respect for Photopea, which has full PDF editing support.</div><br/></div></div><div id="37385219" class="c"><input type="checkbox" id="c-37385219" checked=""/><div class="controls bullet"><span class="by">rogeliodh</span><span>|</span><a href="#37384059">prev</a><span>|</span><a href="#37385909">next</a><span>|</span><label class="collapse" for="c-37385219">[-]</label><label class="expand" for="c-37385219">[2 more]</label></div><br/><div class="children"><div class="content">LibreOffice can open and edit PDFs. Last time I tried it was really good. Not sure what limitations are there.</div><br/><div id="37385519" class="c"><input type="checkbox" id="c-37385519" checked=""/><div class="controls bullet"><span class="by">lucb1e</span><span>|</span><a href="#37385219">parent</a><span>|</span><a href="#37385909">next</a><span>|</span><label class="collapse" for="c-37385519">[-]</label><label class="expand" for="c-37385519">[1 more]</label></div><br/><div class="children"><div class="content">For me it always seems to change the font from whatever was built into the PDF (rendered just fine in any PDF reader) to a random system font which completely breaks the spacing, making different parts of the document overflow into each other</div><br/></div></div></div></div><div id="37385909" class="c"><input type="checkbox" id="c-37385909" checked=""/><div class="controls bullet"><span class="by">yair99dd</span><span>|</span><a href="#37385219">prev</a><span>|</span><a href="#37386232">next</a><span>|</span><label class="collapse" for="c-37385909">[-]</label><label class="expand" for="c-37385909">[1 more]</label></div><br/><div class="children"><div class="content">Inkscape+1.2 multipage support is Great for editing graphics and text on PDFs</div><br/></div></div><div id="37387087" class="c"><input type="checkbox" id="c-37387087" checked=""/><div class="controls bullet"><span class="by">elyobo</span><span>|</span><a href="#37386232">prev</a><span>|</span><a href="#37384280">next</a><span>|</span><label class="collapse" for="c-37387087">[-]</label><label class="expand" for="c-37387087">[1 more]</label></div><br/><div class="children"><div class="content">&quot;want&quot; is probably a misleading term here</div><br/></div></div><div id="37384280" class="c"><input type="checkbox" id="c-37384280" checked=""/><div class="controls bullet"><span class="by">aleden</span><span>|</span><a href="#37387087">prev</a><span>|</span><label class="collapse" for="c-37384280">[-]</label><label class="expand" for="c-37384280">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m surprised no one has mentioned qpdf.<p><a href="https:&#x2F;&#x2F;qpdf.readthedocs.io&#x2F;en&#x2F;stable&#x2F;overview.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;qpdf.readthedocs.io&#x2F;en&#x2F;stable&#x2F;overview.html</a><p>It turns a PDF (typically everything in it is compressed binary blobs) into a mixed binary&#x2F;ASCII file (which itself is a PDF) that can be edited with vim.</div><br/><div id="37384362" class="c"><input type="checkbox" id="c-37384362" checked=""/><div class="controls bullet"><span class="by">chrnola</span><span>|</span><a href="#37384280">parent</a><span>|</span><a href="#37384958">next</a><span>|</span><label class="collapse" for="c-37384362">[-]</label><label class="expand" for="c-37384362">[1 more]</label></div><br/><div class="children"><div class="content">The linked article literally mentions qpdf within the first  few paragraphs.</div><br/></div></div><div id="37384958" class="c"><input type="checkbox" id="c-37384958" checked=""/><div class="controls bullet"><span class="by">gpvos</span><span>|</span><a href="#37384280">parent</a><span>|</span><a href="#37384362">prev</a><span>|</span><a href="#37384358">next</a><span>|</span><label class="collapse" for="c-37384958">[-]</label><label class="expand" for="c-37384958">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure what you were reading, but the fine article is centred around using qpdf.</div><br/></div></div><div id="37384358" class="c"><input type="checkbox" id="c-37384358" checked=""/><div class="controls bullet"><span class="by">rhaway84773</span><span>|</span><a href="#37384280">parent</a><span>|</span><a href="#37384958">prev</a><span>|</span><label class="collapse" for="c-37384358">[-]</label><label class="expand" for="c-37384358">[1 more]</label></div><br/><div class="children"><div class="content">It’s mentioned in the gist<p>&gt; To view the compressed data, you can use a command line tool called qpdf.</div><br/></div></div></div></div></div></div></div></div></div></body></html>