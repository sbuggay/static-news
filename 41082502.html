<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1722070848590" as="style"/><link rel="stylesheet" href="styles.css?v=1722070848590"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://krebsonsecurity.com/2024/07/crooks-bypassed-googles-email-verification-to-create-workspace-accounts-access-3rd-party-services/">Crooks Bypassed Google&#x27;s Email Verification to Create Workspace Accounts, Acces</a> <span class="domain">(<a href="https://krebsonsecurity.com">krebsonsecurity.com</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>35 comments</span></div><br/><div><div id="41085277" class="c"><input type="checkbox" id="c-41085277" checked=""/><div class="controls bullet"><span class="by">nottorp</span><span>|</span><a href="#41084271">next</a><span>|</span><label class="collapse" for="c-41085277">[-]</label><label class="expand" for="c-41085277">[1 more]</label></div><br/><div class="children"><div class="content">So if you own example.com and use bigboss@example.com as log in to greatonlinegame.com ...<p>Someone can register example.com with google workspace and then they can use &quot;login with google&quot; to log in to your bigboss@example.com account at greatonlinegame.com, even though your account did not use &quot;login with google&quot;.<p>Did i get it right?<p>And if i did, i wonder...<p>Why aren&#x27;t these logins separate on greatonlinegame.com? If I did it i&#x27;d allow a login only by the method that was used to create the account, unless the user configures it otherwise.</div><br/></div></div><div id="41084271" class="c"><input type="checkbox" id="c-41084271" checked=""/><div class="controls bullet"><span class="by">mcoliver</span><span>|</span><a href="#41085277">prev</a><span>|</span><a href="#41083542">next</a><span>|</span><label class="collapse" for="c-41084271">[-]</label><label class="expand" for="c-41084271">[2 more]</label></div><br/><div class="children"><div class="content">I got hit by this.  On June 6 I got an email from Google saying welcome to Google workspace for my domain.<p>I don&#x27;t have Google workspace for this domain and use an alternate email provider.  I was curious so tried to signin and was told that the admin account was an email on my domain (eg foo@mydomain.com). Ok, created that account so I could receive email, except then Google said that I had to use the backup recovery email which happened to be mydomain@gmail.com.<p>Google said that non verified workspaces (eg not verified through txt or cname records) would be automatically deleted after 7 days.<p>14 days later the workspace was still there.<p>I had to go through a convoluted manual form and process to get my workspace domain back and then properly register it so this would not happen again.<p>I provided the following feedback which seems like common sense, but I guess it ain&#x27;t that common:<p>1) you shouldn&#x27;t be able to create a workspace with a custom domain without verifying it via DNS records from the start.  No 7 day grace which  actually was broken and for all I know was infinite grace period.<p>2) the established admin account with a custom domain email address should be eligible to perform recovery.  Not some arbitrary secondary Gmail account.</div><br/><div id="41085265" class="c"><input type="checkbox" id="c-41085265" checked=""/><div class="controls bullet"><span class="by">ryanjshaw</span><span>|</span><a href="#41084271">parent</a><span>|</span><a href="#41083542">next</a><span>|</span><label class="collapse" for="c-41085265">[-]</label><label class="expand" for="c-41085265">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for taking the time to explain the issue. I found the article confusing and vague.</div><br/></div></div></div></div><div id="41083542" class="c"><input type="checkbox" id="c-41083542" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#41084271">prev</a><span>|</span><a href="#41084296">next</a><span>|</span><label class="collapse" for="c-41083542">[-]</label><label class="expand" for="c-41083542">[2 more]</label></div><br/><div class="children"><div class="content">Maybe we need the IdP equivalent of CAA records. If I have a domain that doesn’t use a given IdP, I want everyone who might rely on that IdP to know that the IdP in question has no authority on that domain.</div><br/></div></div><div id="41084296" class="c"><input type="checkbox" id="c-41084296" checked=""/><div class="controls bullet"><span class="by">anoncow</span><span>|</span><a href="#41083542">prev</a><span>|</span><a href="#41083697">next</a><span>|</span><label class="collapse" for="c-41084296">[-]</label><label class="expand" for="c-41084296">[2 more]</label></div><br/><div class="children"><div class="content">A related topic. I saw Google create hotmail accounts on the Gmail platform e.g., myname@hotmail.com when myname@hotmail.com was a functioning email ID on outlook.com.<p>I was able to login to Gmail with myname@hotmail.com and send emails. Emails were however being received only on the outlook.com account. Blew my mind.</div><br/><div id="41085095" class="c"><input type="checkbox" id="c-41085095" checked=""/><div class="controls bullet"><span class="by">gopkarthik</span><span>|</span><a href="#41084296">parent</a><span>|</span><a href="#41083697">next</a><span>|</span><label class="collapse" for="c-41085095">[-]</label><label class="expand" for="c-41085095">[1 more]</label></div><br/><div class="children"><div class="content">A Google account was being created without Gmail in this case.</div><br/></div></div></div></div><div id="41083697" class="c"><input type="checkbox" id="c-41083697" checked=""/><div class="controls bullet"><span class="by">nurtbo</span><span>|</span><a href="#41084296">prev</a><span>|</span><a href="#41084760">next</a><span>|</span><label class="collapse" for="c-41083697">[-]</label><label class="expand" for="c-41083697">[2 more]</label></div><br/><div class="children"><div class="content">So these attackers could gain access to any account with email with a domain not currently registered to a Google Workspace? This seems like a huge breach of trust. (Especially given that it gave access to <i>outside</i> of Google accounts).<p>Is there a best practice around confirming adding social login to a pre-existing account? (Like entering current password or email confirmation?)<p>From the article:<p>&gt; In the case of the reader who shared the breach notice from Google, the imposters used the authentication bypass to associate his domain with a Workspace account. And that domain was tied to his login at several third-party services online. Indeed, the alert this reader received from Google said the unauthorized Workspace account appears to have been used to sign in to his account at Dropbox</div><br/><div id="41084026" class="c"><input type="checkbox" id="c-41084026" checked=""/><div class="controls bullet"><span class="by">AnotherGoodName</span><span>|</span><a href="#41083697">parent</a><span>|</span><a href="#41084760">next</a><span>|</span><label class="collapse" for="c-41084026">[-]</label><label class="expand" for="c-41084026">[1 more]</label></div><br/><div class="children"><div class="content">From what’s stated they could create a new account but not gain access to an existing account. So they create “totally_the_admin@bigco.com” and then login via google elsewhere and try to use that as a way to gain further access to bigco accounts, presumably by some manual support.</div><br/></div></div></div></div><div id="41084760" class="c"><input type="checkbox" id="c-41084760" checked=""/><div class="controls bullet"><span class="by">taspeotis</span><span>|</span><a href="#41083697">prev</a><span>|</span><a href="#41083466">next</a><span>|</span><label class="collapse" for="c-41084760">[-]</label><label class="expand" for="c-41084760">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The vector here is they would use one email address to try to sign in, and a completely different email address to verify a token<p>Is this like the PayPal XSRF vulnerability where any issued XSRF token was considered valid regardless of the user trying to use it?<p>I’d expect Google to have some standard way to handle this stuff.</div><br/></div></div><div id="41083466" class="c"><input type="checkbox" id="c-41083466" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#41084760">prev</a><span>|</span><a href="#41085120">next</a><span>|</span><label class="collapse" for="c-41083466">[-]</label><label class="expand" for="c-41083466">[4 more]</label></div><br/><div class="children"><div class="content">&gt; through Google’s “Sign in with Google”<p>I used to use these “social logins” exclusively. Whether they were FB, Apple, or Google. Because big tech couldn’t get hacked and it was convenient.<p>But quickly realized how much of a pain it was to deal with when issues at various service providers arose. It complicated operations for small businesses. Often I lost accounts because their support just gave up on trying to diagnose issue.<p>But also if those IdPs deemed your account in violation  of some vague policy, or maybe they just don’t like you because of “freeloading”. Then you will quickly lose out on access to numerous services.<p>Some services have sane account management practices and allow you to dissociate the account from a SSO provider. But most I have encountered are just clueless. Some services, the system is designed so bad that I cannot change the email.<p>I remember l1 support for some company stating emails are immutable because it’s more secure that way. Such bullshit.<p>this bypass event is yet another reason to avoid using Google&#x2F;Apple&#x2F;Facebook as SSO provider. These companies have time and time again proved they are pregnable.<p>Fortunately, thanks to password managers it makes creating complicated passwords with hundreds of services much easier.</div><br/><div id="41083710" class="c"><input type="checkbox" id="c-41083710" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#41083466">parent</a><span>|</span><a href="#41083587">next</a><span>|</span><label class="collapse" for="c-41083710">[-]</label><label class="expand" for="c-41083710">[1 more]</label></div><br/><div class="children"><div class="content">I used to feel similar. But then I realized that my browser&#x27;s password manager also can&#x27;t get hacked (or if it does they have full browser access anyways) and it is actually easier to sign in with a pre-filled username and password (just click login) than going through the third-party auth flow (and remembering which one you used).</div><br/></div></div><div id="41083587" class="c"><input type="checkbox" id="c-41083587" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#41083466">parent</a><span>|</span><a href="#41083710">prev</a><span>|</span><a href="#41085120">next</a><span>|</span><label class="collapse" for="c-41083587">[-]</label><label class="expand" for="c-41083587">[2 more]</label></div><br/><div class="children"><div class="content">I really like Spotify&#x27;s approach. In previous years it was confusing as if you signed up under a social you didn&#x27;t have a user&#x2F;pass to login with; but now they just break out all login methods and let you link Google&#x2F;Facebook or just set a standard email&#x2F;pass.</div><br/><div id="41083977" class="c"><input type="checkbox" id="c-41083977" checked=""/><div class="controls bullet"><span class="by">w-ll</span><span>|</span><a href="#41083466">root</a><span>|</span><a href="#41083587">parent</a><span>|</span><a href="#41085120">next</a><span>|</span><label class="collapse" for="c-41083977">[-]</label><label class="expand" for="c-41083977">[1 more]</label></div><br/><div class="children"><div class="content">this backfired on me a few years ago, my nvidia shield was connected to my account and then a friend on wifi linked to it, and it nuked both our accounts. lol</div><br/></div></div></div></div></div></div><div id="41085120" class="c"><input type="checkbox" id="c-41085120" checked=""/><div class="controls bullet"><span class="by">kalaksi</span><span>|</span><a href="#41083466">prev</a><span>|</span><a href="#41083170">next</a><span>|</span><label class="collapse" for="c-41085120">[-]</label><label class="expand" for="c-41085120">[1 more]</label></div><br/><div class="children"><div class="content">Uhh, I also received an email like that. I was suspecting something fishy but hoped that they just expect someone to click a link.
Any idea what they could have done? I never auth with google. And the email domain is not mine but email provider&#x27;s.<p>To add, the welcome email doesn&#x27;t directly say the domain used</div><br/></div></div><div id="41083170" class="c"><input type="checkbox" id="c-41083170" checked=""/><div class="controls bullet"><span class="by">kabdib</span><span>|</span><a href="#41085120">prev</a><span>|</span><a href="#41084731">next</a><span>|</span><label class="collapse" for="c-41083170">[-]</label><label class="expand" for="c-41083170">[6 more]</label></div><br/><div class="children"><div class="content">I get occasional probes from Google services against my domain, clearly made by bad actors who are trying to break into it. It&#x27;s not &quot;lose your domain with a slip of the finger&quot; territory, but it&#x27;s still not great.<p>There doesn&#x27;t appear to be a way to tell Google, &quot;I own this domain, just block all of these bogus requests&quot; other than signing up for the services in question (which I don&#x27;t want to do!)<p>Scammers will be scammers, but this is also pretty shitty behavior on Google&#x27;s part.</div><br/><div id="41083637" class="c"><input type="checkbox" id="c-41083637" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#41083170">parent</a><span>|</span><a href="#41083313">next</a><span>|</span><label class="collapse" for="c-41083637">[-]</label><label class="expand" for="c-41083637">[1 more]</label></div><br/><div class="children"><div class="content">For Google and Microsoft, you have to add some TXT records to verify your domain.<p>Surely they could add support for checking that TXT record to &quot;anti-verify&quot; the domain? Ie instead of the &quot;MS=ms12345&quot; value to verify with Microsoft, have some fixed &quot;MS=NOJOY&quot; or whatever to signal to Microsoft you don&#x27;t want any registrations against your domain.</div><br/></div></div><div id="41083313" class="c"><input type="checkbox" id="c-41083313" checked=""/><div class="controls bullet"><span class="by">kyrra</span><span>|</span><a href="#41083170">parent</a><span>|</span><a href="#41083637">prev</a><span>|</span><a href="#41084634">next</a><span>|</span><label class="collapse" for="c-41083313">[-]</label><label class="expand" for="c-41083313">[3 more]</label></div><br/><div class="children"><div class="content">What do you mean probing your domain from Google?</div><br/><div id="41083325" class="c"><input type="checkbox" id="c-41083325" checked=""/><div class="controls bullet"><span class="by">HideousKojima</span><span>|</span><a href="#41083170">root</a><span>|</span><a href="#41083313">parent</a><span>|</span><a href="#41084634">next</a><span>|</span><label class="collapse" for="c-41083325">[-]</label><label class="expand" for="c-41083325">[2 more]</label></div><br/><div class="children"><div class="content">I assume trying to sign up for Google services (business email etc.) for his domain</div><br/><div id="41083338" class="c"><input type="checkbox" id="c-41083338" checked=""/><div class="controls bullet"><span class="by">kabdib</span><span>|</span><a href="#41083170">root</a><span>|</span><a href="#41083325">parent</a><span>|</span><a href="#41084634">next</a><span>|</span><label class="collapse" for="c-41083338">[-]</label><label class="expand" for="c-41083338">[1 more]</label></div><br/><div class="children"><div class="content">Exactly.</div><br/></div></div></div></div></div></div><div id="41084634" class="c"><input type="checkbox" id="c-41084634" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#41083170">parent</a><span>|</span><a href="#41083313">prev</a><span>|</span><a href="#41084731">next</a><span>|</span><label class="collapse" for="c-41084634">[-]</label><label class="expand" for="c-41084634">[1 more]</label></div><br/><div class="children"><div class="content">When I was an admin for a Google Apps Domain, you couldn&#x27;t even stop people from making a google account that aliases a google apps account.<p>Best I could do was run reports and yell at people. But it really would have been nice to stop all attempts to make google accounts for the domain.</div><br/></div></div></div></div><div id="41084731" class="c"><input type="checkbox" id="c-41084731" checked=""/><div class="controls bullet"><span class="by">alchemist1e9</span><span>|</span><a href="#41083170">prev</a><span>|</span><a href="#41084917">next</a><span>|</span><label class="collapse" for="c-41084731">[-]</label><label class="expand" for="c-41084731">[2 more]</label></div><br/><div class="children"><div class="content">This was done to me. They even called me imitating google security team by using google assistant feature and using a free trial to register my own phone number as the business name then calling via Google to get assistant to call me repeatedly showing up as google. Eventually I picked up as I was also get simultaneously account recovery requests on my gmail. AND they sent me DKIM verified emails that appear to come from google themselves. I recorded the phone conversation if LE might be interested. The combination of there existing an account on workspaces, verified emails, and spoofed google caller ID from numbers that superficially appear to be actually google numbers - you have to read closely that they are Google Assistant numbers! was pretty convincing initially, they had be for a few minutes on the call. And they tell you your account is having it’s phone number changed, we need to do something now or it will take a long time to recover it. I didn’t fall for it but then I pretended I was and put on a big show. I have a long recording with their voice and timestamps of everything.<p>Anyway the incident shook me as they also gave me my personal information to prove they are real and it was accurate and kept saying look we aren’t asking you for information we are telling you yours so you see we are Google Security!<p>It has triggered for me a giant project to carefully review all my attack surfaces across all accounts and systems.</div><br/><div id="41085063" class="c"><input type="checkbox" id="c-41085063" checked=""/><div class="controls bullet"><span class="by">megous</span><span>|</span><a href="#41084731">parent</a><span>|</span><a href="#41084917">next</a><span>|</span><label class="collapse" for="c-41085063">[-]</label><label class="expand" for="c-41085063">[1 more]</label></div><br/><div class="children"><div class="content">&gt; ... as they also gave me my personal information to prove they are real and it was accurate and kept saying look we aren’t asking you for information we are telling you yours so you see we are Google Security!<p>Yeah, anytime someone gives me information about me, to prove who <i>they</i> are, is instantly suspect. Same goes for not yet authenticated caller (caller id doesn&#x27;t count) asking for <i>my details</i> so that they get a proof of who I am. Not going to give extra info to an unknown person, sorry.<p>I train myself on legit calls to not fall for this, despite some inconvenience.<p>My hope is that in the future, when the real scummer call will eventually come, I&#x27;ll be less likely to fall for social engineering tricks, and psychological pressure.</div><br/></div></div></div></div><div id="41084917" class="c"><input type="checkbox" id="c-41084917" checked=""/><div class="controls bullet"><span class="by">alpenbazi</span><span>|</span><a href="#41084731">prev</a><span>|</span><a href="#41083225">next</a><span>|</span><label class="collapse" for="c-41084917">[-]</label><label class="expand" for="c-41084917">[1 more]</label></div><br/><div class="children"><div class="content">had that too. did not react. after some time got a mail &quot;workspace closed&quot;</div><br/></div></div></div></div></div></div></div></body></html>