<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725699671405" as="style"/><link rel="stylesheet" href="styles.css?v=1725699671405"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.computerenhance.com/p/zen-cuda-and-tensor-cores-part-i">Zen, CUDA, and Tensor Cores, Part I: The Silicon</a> <span class="domain">(<a href="https://www.computerenhance.com">www.computerenhance.com</a>)</span></div><div class="subtext"><span>throwaway71271</span> | <span>13 comments</span></div><br/><div><div id="41471542" class="c"><input type="checkbox" id="c-41471542" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#41471732">next</a><span>|</span><label class="collapse" for="c-41471542">[-]</label><label class="expand" for="c-41471542">[5 more]</label></div><br/><div class="children"><div class="content">The answer to the leading question &quot;What’s the difference between a Zen core, a CUDA core, and a Tensor core?&quot; is not covered in Part 1, so you may want to wait  if this interests you more than chip layouts.</div><br/><div id="41471947" class="c"><input type="checkbox" id="c-41471947" checked=""/><div class="controls bullet"><span class="by">raphlinus</span><span>|</span><a href="#41471542">parent</a><span>|</span><a href="#41471732">next</a><span>|</span><label class="collapse" for="c-41471947">[-]</label><label class="expand" for="c-41471947">[4 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s my quick take.<p>A top of the line Zen core is a powerful CPU with wide SIMD (AVX-512 is 16 lanes of 32 bit quantities), significant superscalar parallelism (capable of issuing approximately 4 SIMD operations per clock), and a high clock rate (over 5GHz). There isn&#x27;t a lot of confusion about what constitutes a &quot;core,&quot; though multithreading can inflate the &quot;thread&quot; count. See [1] for a detailed analysis of the Zen 5 line.<p>A single Granite Ridge core has peak 32 bit multiply-add performance of about 730 GFLOPS.<p>Nvidia, by contrast, uses the marketing term &quot;core&quot; to refer to a single SIMD lane. Their GPUs are organized as 32 SIMD lanes grouped into each &quot;warp,&quot; and 4 warps grouped into a Streaming Multiprocessor (SM). CPU and GPU architectures can&#x27;t be directly compared, but just going by peak floating point performance, the most comparable granularity to a CPU core is the SM. A warp is in some ways more powerful than a CPU core (generally wider SIMD, larger register file, more local SRAM, better latency hiding) but in other ways less (much less superscalar parallelism, lower clock, around 2.5GHz). A 4090 has 128 SMs, which is a lot and goes a long way to explaining why a GPU has so much throughput. A 1080, by contrast, has 20 SMs - still a goodly number but not mind-meltingly bigger than a high end CPU. See the Nvidia Ada whitepaper [2] for an extremely detailed breakdown of 4090 specs (among other things).<p>A single Nvidia 4090 &quot;core&quot; has peak 32 bit multiply-add performance of about 5 GFLOPS, while an SM has 640 GFLOPS.<p>I don&#x27;t know anybody who counts tensor cores by core count, as the capacity of a &quot;core&quot; varies pretty widely by generation. It&#x27;s almost certainly best just to compare TFLOPS - also a bit of a slippery concept, as that depends on the precision and also whether the application can make use of the sparsity feature.<p>I&#x27;ll also note that not all GPU vendors follow Nvidia&#x27;s lead in counting individual SIMD lanes as &quot;cores.&quot; Apple Silicon, by contrast, uses &quot;core&quot; to refer to a grouping of 128 SIMD lanes, similar to an Nvidia SM. A top of the line M2 Ultra contains 76 such cores, for 9728 SIMD lanes. I found Philip Turner&#x27;s Metal benchmarks [3] useful for understanding the quantitative similarities and differences between Apple, AMD, and Nvidia GPUs.<p>[1]: <a href="http:&#x2F;&#x2F;www.numberworld.org&#x2F;blogs&#x2F;2024_8_7_zen5_avx512_teardown&#x2F;" rel="nofollow">http:&#x2F;&#x2F;www.numberworld.org&#x2F;blogs&#x2F;2024_8_7_zen5_avx512_teardo...</a><p>[2]: <a href="https:&#x2F;&#x2F;images.nvidia.com&#x2F;aem-dam&#x2F;Solutions&#x2F;Data-Center&#x2F;l4&#x2F;nvidia-ada-gpu-architecture-whitepaper-V2.02.pdf" rel="nofollow">https:&#x2F;&#x2F;images.nvidia.com&#x2F;aem-dam&#x2F;Solutions&#x2F;Data-Center&#x2F;l4&#x2F;n...</a><p>[3]: <a href="https:&#x2F;&#x2F;github.com&#x2F;philipturner&#x2F;metal-benchmarks">https:&#x2F;&#x2F;github.com&#x2F;philipturner&#x2F;metal-benchmarks</a></div><br/><div id="41472136" class="c"><input type="checkbox" id="c-41472136" checked=""/><div class="controls bullet"><span class="by">JonChesterfield</span><span>|</span><a href="#41471542">root</a><span>|</span><a href="#41471947">parent</a><span>|</span><a href="#41472235">next</a><span>|</span><label class="collapse" for="c-41472136">[-]</label><label class="expand" for="c-41472136">[2 more]</label></div><br/><div class="children"><div class="content">An x64 core roughly corresponding to a SM, or in the amdgpu world a compute unit (CU) seems right. It&#x27;s in the same ballpark for power consumption, represents the component handling an instruction pointer and a local register file and so forth.<p>A really big CPU is a couple of hundred cores, a big GPU is a few hundred SM &#x2F; CUs. Some low power chips are 8 x64 cores and 8 CUs on the same package. All roughly lines up.</div><br/><div id="41472536" class="c"><input type="checkbox" id="c-41472536" checked=""/><div class="controls bullet"><span class="by">openrisk</span><span>|</span><a href="#41471542">root</a><span>|</span><a href="#41472136">parent</a><span>|</span><a href="#41472235">next</a><span>|</span><label class="collapse" for="c-41472536">[-]</label><label class="expand" for="c-41472536">[1 more]</label></div><br/><div class="children"><div class="content">If SIMD lanes come to vastly dominate the composition of a typical computer chip (in terms, e.g., of where power is consumed) will the distinction between CPU&#x2F;GPU continue to be meaningful?<p>For decades the GPU was &quot;special purpose&quot; hardware dedicated to the math of screen graphics. If the type of larger-scale numerical computation that has been popularised with LLM&#x27;s is now deemed &quot;typical use&quot;, then the distinction may be becoming irrelevant (and even counterproductive from a software development perspective).</div><br/></div></div></div></div><div id="41472235" class="c"><input type="checkbox" id="c-41472235" checked=""/><div class="controls bullet"><span class="by">Remnant44</span><span>|</span><a href="#41471542">root</a><span>|</span><a href="#41471947">parent</a><span>|</span><a href="#41472136">prev</a><span>|</span><a href="#41471732">next</a><span>|</span><label class="collapse" for="c-41472235">[-]</label><label class="expand" for="c-41472235">[1 more]</label></div><br/><div class="children"><div class="content">Hi Raph, first of all thank you for all of your contributions and writings - I&#x27;ve learned a ton from reading your blog!<p>A minor quibble amidst your good comparison above ;)<p>For a zen5 core, we have 16-wide SIMD with 4 pipes; 2 are FMA (2 flop), and 2 are FADD @ ~5GHZ. I math that out to 16 * 6 * 5 = 480 GFLOP&#x2F;core... am I missing something?</div><br/></div></div></div></div></div></div><div id="41471732" class="c"><input type="checkbox" id="c-41471732" checked=""/><div class="controls bullet"><span class="by">diabllicseagull</span><span>|</span><a href="#41471542">prev</a><span>|</span><a href="#41471255">next</a><span>|</span><label class="collapse" for="c-41471732">[-]</label><label class="expand" for="c-41471732">[1 more]</label></div><br/><div class="children"><div class="content">It was a good read. I wonder what hot takes he&#x27;ll have in the second part if any.</div><br/></div></div><div id="41471255" class="c"><input type="checkbox" id="c-41471255" checked=""/><div class="controls bullet"><span class="by">downvotetruth</span><span>|</span><a href="#41471732">prev</a><span>|</span><label class="collapse" for="c-41471255">[-]</label><label class="expand" for="c-41471255">[6 more]</label></div><br/><div class="children"><div class="content">I refused to buy the so determined defective chips even if they represented better value because if the intent was truly to try and max yield then there should be for Ryzen for example good 7 core versions with only 1 core that was found to be defective. Since no 7 core zens exist, then at least some of the CPUs with 6 core CCDs have intentionally had 1 of the cores destroyed for reasons unknown, which could be to meet volume targets. If this is because for Ryzen the cores can only be disabled in pairs, then it boggles my mind that it would not be economic given the $ diff of tens to hundreds of dollars between the 6 and 8 core versions that is does not make sense to add the circuits to allow each core to be individually fused off and allow further product differentiation, especially considering how much effort and # of SKUs have been put forth with the frequency binning in AM4 (5700x, 5800, 5800x, 5800xt, etc.), rather than bigger market segmentation jumps.</div><br/><div id="41471418" class="c"><input type="checkbox" id="c-41471418" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#41471255">parent</a><span>|</span><a href="#41471491">next</a><span>|</span><label class="collapse" for="c-41471418">[-]</label><label class="expand" for="c-41471418">[1 more]</label></div><br/><div class="children"><div class="content">&gt; if the intent was truly to try and max yield then there should be for Ryzen for example good 7 core versions with only 1 core that was found to be defective. Since no 7 core zens exist<p>There are Zen processors that use 7 cores per CCD, e.g. Epyc 7663, 7453, 9634.<p>The difference between Ryzen and Epyc is the I&#x2F;O die. The CCDs are the same so that&#x27;s presumably where they go.<p>Another reason you might not see this on the consumer chips is that they have higher base clocks. If you have a CCD where one core is bad and another isn&#x27;t exactly bad but can&#x27;t hit the same frequencies as the other six, it doesn&#x27;t take a lot of difference before it makes more sense to turn off the slowest than lower the base clock for the whole processor. 6 x 4.7GHz is faster than 7 x 4.0GHz, much less 7 x 2.5GHz.<p>In theory you could let that one core run at a significantly lower speed than the others, but there is <i>a lot</i> of naive software that will misbehave in that context. Whereas the base clock for the Epyc 9634 is 2.25GHz, because it has twelve 7-core CCDs so it&#x27;s nearly 300W, and doesn&#x27;t want to be nearly 1300W regardless of whether or not most of the cores could do &gt;4GHz.</div><br/></div></div><div id="41471491" class="c"><input type="checkbox" id="c-41471491" checked=""/><div class="controls bullet"><span class="by">MobiusHorizons</span><span>|</span><a href="#41471255">parent</a><span>|</span><a href="#41471418">prev</a><span>|</span><a href="#41471434">next</a><span>|</span><label class="collapse" for="c-41471491">[-]</label><label class="expand" for="c-41471491">[3 more]</label></div><br/><div class="children"><div class="content">I would guess that there is a desire to not create too many product tiers. I believe 6 core parts are made from 2 3-core CCXs, (rather than 4 and 2) so only one core is disabled per ccx.</div><br/><div id="41471520" class="c"><input type="checkbox" id="c-41471520" checked=""/><div class="controls bullet"><span class="by">cinnamonteal</span><span>|</span><a href="#41471255">root</a><span>|</span><a href="#41471491">parent</a><span>|</span><a href="#41471434">next</a><span>|</span><label class="collapse" for="c-41471520">[-]</label><label class="expand" for="c-41471520">[2 more]</label></div><br/><div class="children"><div class="content">Current Ryzen and EPYC processors have 8 core CCXs. The 6 core parts used to be as you described, but are now a single CCX. The Zen C dies have two CCXs, but they are still 8 core CCXs, and are always symmetrical in core count.<p>The big exception is that the new Zen 5 Strix Point chip has a 4 core CCX for the non-C cores. I think the Zen 4 based Z1 has a similar setup but don&#x27;t remember and couldn&#x27;t quickly find the actual information to confirm.</div><br/><div id="41472128" class="c"><input type="checkbox" id="c-41472128" checked=""/><div class="controls bullet"><span class="by">wtallis</span><span>|</span><a href="#41471255">root</a><span>|</span><a href="#41471520">parent</a><span>|</span><a href="#41471434">next</a><span>|</span><label class="collapse" for="c-41472128">[-]</label><label class="expand" for="c-41472128">[1 more]</label></div><br/><div class="children"><div class="content">The Ryzen Z1 was a weird one: two Zen4 cores plus four Zen4c cores all in one cluster, sharing the same 16MB L3 cache.</div><br/></div></div></div></div></div></div><div id="41471434" class="c"><input type="checkbox" id="c-41471434" checked=""/><div class="controls bullet"><span class="by">tverbeure</span><span>|</span><a href="#41471255">parent</a><span>|</span><a href="#41471491">prev</a><span>|</span><label class="collapse" for="c-41471434">[-]</label><label class="expand" for="c-41471434">[1 more]</label></div><br/><div class="children"><div class="content">That’s first sentence is a spectacular non-sequitur.</div><br/></div></div></div></div></div></div></div></div></div></body></html>