<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710666065876" as="style"/><link rel="stylesheet" href="styles.css?v=1710666065876"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://research.kudelskisecurity.com/2024/03/14/passkeys-under-the-hood/">Passkeys – Under the Hood</a> <span class="domain">(<a href="https://research.kudelskisecurity.com">research.kudelskisecurity.com</a>)</span></div><div class="subtext"><span>paulgerhardt</span> | <span>17 comments</span></div><br/><div><div id="39732282" class="c"><input type="checkbox" id="c-39732282" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#39732685">next</a><span>|</span><label class="collapse" for="c-39732282">[-]</label><label class="expand" for="c-39732282">[2 more]</label></div><br/><div class="children"><div class="content">I wish the support of real tokens would also benefit from the attention Passkeys receive though. They use the same protocol after all.<p>On Firefox on Android I still get the message that physical tokens are not supported on mobile when I try to authenticate to e.g. PayPal. I don&#x27;t really like Passkeys because I prefer the security of real tokens (yubikeys). And I don&#x27;t want to register with big tech companies to be able to use passkeys - for example I don&#x27;t even have a google account logged in on my android phone.</div><br/><div id="39732888" class="c"><input type="checkbox" id="c-39732888" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#39732282">parent</a><span>|</span><a href="#39732685">next</a><span>|</span><label class="collapse" for="c-39732888">[-]</label><label class="expand" for="c-39732888">[1 more]</label></div><br/><div class="children"><div class="content">I use all the same things as you, but PayPal doesn&#x27;t use WebAuthn (that I can see). It&#x27;s just 2FA hardware tokens, which should work fine (and I do get a prompt to use a USB key on Firefox).</div><br/></div></div></div></div><div id="39732685" class="c"><input type="checkbox" id="c-39732685" checked=""/><div class="controls bullet"><span class="by">snowstormsun</span><span>|</span><a href="#39732282">prev</a><span>|</span><a href="#39732222">next</a><span>|</span><label class="collapse" for="c-39732685">[-]</label><label class="expand" for="c-39732685">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;d switch to passkeys immediately where possible, if Android&#x2F;Google would allow third party password manager apps to provide and store them. Afaik they still want you to use the Google Password Manager, which is not an option for me.</div><br/><div id="39732703" class="c"><input type="checkbox" id="c-39732703" checked=""/><div class="controls bullet"><span class="by">dyml</span><span>|</span><a href="#39732685">parent</a><span>|</span><a href="#39732861">next</a><span>|</span><label class="collapse" for="c-39732703">[-]</label><label class="expand" for="c-39732703">[3 more]</label></div><br/><div class="children"><div class="content">You can use any passkey provider app. I work at Bitwarden and we’re building mobile passkeys for android right now. We can do the e2e sync, but if you want you can always self host Bitwarden server and just use our clients app.</div><br/><div id="39732851" class="c"><input type="checkbox" id="c-39732851" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#39732685">root</a><span>|</span><a href="#39732703">parent</a><span>|</span><a href="#39732757">next</a><span>|</span><label class="collapse" for="c-39732851">[-]</label><label class="expand" for="c-39732851">[1 more]</label></div><br/><div class="children"><div class="content">The BitWarden passkey dialog irks me because it makes me click the passkey I want, even if I have exactly one. It would be better to have a feature where I could specify &quot;always use this passkey and don&#x27;t prompt&quot;, since that&#x27;s what I need 99% of the time.</div><br/></div></div><div id="39732757" class="c"><input type="checkbox" id="c-39732757" checked=""/><div class="controls bullet"><span class="by">josteink</span><span>|</span><a href="#39732685">root</a><span>|</span><a href="#39732703">parent</a><span>|</span><a href="#39732851">prev</a><span>|</span><a href="#39732861">next</a><span>|</span><label class="collapse" for="c-39732757">[-]</label><label class="expand" for="c-39732757">[1 more]</label></div><br/><div class="children"><div class="content">This is such a big small thing.<p>Patiently waiting for passkey support on Bitwarden iOS to replace all my passwords everywhere.<p>Do you guys have any rough idea how far away you are from launch? Is it weeks? Months? Quarters?</div><br/></div></div></div></div><div id="39732861" class="c"><input type="checkbox" id="c-39732861" checked=""/><div class="controls bullet"><span class="by">cquintana92</span><span>|</span><a href="#39732685">parent</a><span>|</span><a href="#39732703">prev</a><span>|</span><a href="#39732222">next</a><span>|</span><label class="collapse" for="c-39732861">[-]</label><label class="expand" for="c-39732861">[1 more]</label></div><br/><div class="children"><div class="content">3rd party passkey provider support is possible on Android if:<p>- You are using Android 14<p>- Your manufacturer has added support for it (e. g. Oppo and OnePlus still haven&#x27;t)<p>- If you want to use them in chrome, you need to enable the experimental feature at chrome:&#x2F;&#x2F;flags , search for &quot;passkeys&quot; and enable the feature for 3rd party (for brave just replace &quot;chrome&quot; with &quot;brave&quot;<p>Even with that, support may still be a bit buggy, such as:<p>- Chrome displaying the &quot;Google Password Manager&quot; logo instead of your password manager&#x27;s one<p>- The app&#x2F;website not understanding properly how to implement them and sending wrong values &#x2F; sometimes invalid payloads<p>But let&#x27;s hope this technology gains massive adoption, proper support and can help non-technical users benefit from increased security at (almost) no cost.<p>Disclaimer: work for a Password Manager</div><br/></div></div></div></div><div id="39732222" class="c"><input type="checkbox" id="c-39732222" checked=""/><div class="controls bullet"><span class="by">crote</span><span>|</span><a href="#39732685">prev</a><span>|</span><a href="#39732737">next</a><span>|</span><label class="collapse" for="c-39732222">[-]</label><label class="expand" for="c-39732222">[8 more]</label></div><br/><div class="children"><div class="content">&gt; With a security key, the private key is stored inside a secure element and an attacker with physical access to a security key would not be able to recover the private key value.<p>This glances over one of the most powerful features of non-resident (not Passkey, regular U2F &#x2F; Webauthn) keys: you don&#x27;t actually <i>need</i> to store the private key on the client!<p>Non-resident keys only use a single per-token secret key. On registration a random number is generated, which is used together with the secret key to derive a public&#x2F;private keypair used for the whole authentication flow. This random number is sent to the server along with some check digits, forming a token ID. On authentication the server sends the ID back to the token, who uses it to again derive the same keypair which is for authentication. The biggest benefit is that a single cheap token can support an unlimited number of websites. It only needs to store a single secret, after all. If the user has multiple hardware tokens, just send all the numbers one-by-one and see which one is accepted by the token. This also provides essentially perfect privacy: the token doesn&#x27;t store anything about the websites or accounts it is used with, so an attacker gaining control over a token cannot easily determine where it can be used and has to manually try each website one-by-one by actually visiting the site and trying potential usernames.<p>With resident keys (&quot;Passkeys&quot;) the website does not know which ID to return, because a username is not yet known so you&#x27;d have to try <i>all</i> registered IDs for <i>all</i> users to look for a match. That&#x27;s impossible, so the token needs to store some per-user-account data which allows it to map from a domain name to one or more stored credentials and their IDs (which allow both authentication and a mapping to a specific user on login). This places a hard upper limit to the number of Passkey websites a security key can support, and in practice forces you to use a smartphone or computer instead if you want to register a nontrivial number of websites. There are also privacy risks here, as it must by definition be possible to query a token for the existence of an account at a website.<p>Passkeys have been heavily pushed by major tech companies as a replacement for both a username, password, <i>and</i> 2FA method - but (assuming proper 2FA) it&#x27;s a strict downgrade with serious drawbacks. It&#x27;s really sad to see companies ditching proper Webauthn 2FA support when switching to Passkeys, because it&#x27;s making security worse for the people who actually care about it.</div><br/><div id="39732313" class="c"><input type="checkbox" id="c-39732313" checked=""/><div class="controls bullet"><span class="by">dyml</span><span>|</span><a href="#39732222">parent</a><span>|</span><a href="#39732824">next</a><span>|</span><label class="collapse" for="c-39732313">[-]</label><label class="expand" for="c-39732313">[4 more]</label></div><br/><div class="children"><div class="content">You make a valid point about “non-resident” WebAuthn 2FA being great 2FA. However, passkeys are also great, and they depend on your context…. Most people are in the passkey context.<p>For people who are not knee-deep I think we can explain it a bit better, why passkeys replaces passwords:<p>With non-resident (2FA keys) you need to identify your account first. Since you don’t want to have account enumeration, this means doing a primary authentication, e.g. passwords.<p>With passkeys, the website can just ask your browser) to sign in with any of the accounts it has passkeys for; which result in a one click sign in.<p>While hardware backed Security Keys for 2FA is great 2FA, there’s a tangible cost, both in UX and $ that leaves many users left out (not everyone can afford $20 for a security key)<p>Source: I work at Bitwarden building our Passkey API for developers. We support both 2FA and passkeys, both in the API service and in our password manager. Feel free to ask my anything related.</div><br/><div id="39732882" class="c"><input type="checkbox" id="c-39732882" checked=""/><div class="controls bullet"><span class="by">TomatoDash</span><span>|</span><a href="#39732222">root</a><span>|</span><a href="#39732313">parent</a><span>|</span><a href="#39732836">next</a><span>|</span><label class="collapse" for="c-39732882">[-]</label><label class="expand" for="c-39732882">[2 more]</label></div><br/><div class="children"><div class="content">A bit of a tangent but do you have a view on prices for hardware security keys like YubiKey? For private use they&#x27;re a pricey option, especially if you get a few backup keys. Could a big actor like Google, if they wanted, scale up production, sell at cost and get prices down to say $2 each? Or is the components and manufacturing inherently more costly? Is there anything on the horizon that likely will bring much lower prices?</div><br/><div id="39732942" class="c"><input type="checkbox" id="c-39732942" checked=""/><div class="controls bullet"><span class="by">ptman</span><span>|</span><a href="#39732222">root</a><span>|</span><a href="#39732882">parent</a><span>|</span><a href="#39732836">next</a><span>|</span><label class="collapse" for="c-39732942">[-]</label><label class="expand" for="c-39732942">[1 more]</label></div><br/><div class="children"><div class="content">Affordable option: <a href="https:&#x2F;&#x2F;www.token2.com&#x2F;shop&#x2F;product&#x2F;fido-bundle-2-x-fido2-usb-keys" rel="nofollow">https:&#x2F;&#x2F;www.token2.com&#x2F;shop&#x2F;product&#x2F;fido-bundle-2-x-fido2-us...</a></div><br/></div></div></div></div><div id="39732836" class="c"><input type="checkbox" id="c-39732836" checked=""/><div class="controls bullet"><span class="by">Borealid</span><span>|</span><a href="#39732222">root</a><span>|</span><a href="#39732313">parent</a><span>|</span><a href="#39732882">prev</a><span>|</span><a href="#39732824">next</a><span>|</span><label class="collapse" for="c-39732836">[-]</label><label class="expand" for="c-39732836">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need a password to prevent account enumeration; you can send people who choose a nonexistent account a bogus credential that the token won&#x27;t accept.<p>You have to display the password prompt for invalid accounts to avoid enumeration without webauthn too...</div><br/></div></div></div></div><div id="39732824" class="c"><input type="checkbox" id="c-39732824" checked=""/><div class="controls bullet"><span class="by">dwaite</span><span>|</span><a href="#39732222">parent</a><span>|</span><a href="#39732313">prev</a><span>|</span><a href="#39732683">next</a><span>|</span><label class="collapse" for="c-39732824">[-]</label><label class="expand" for="c-39732824">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Passkeys have been heavily pushed by major tech companies as a replacement for both a username, password, and 2FA method - but (assuming proper 2FA) it&#x27;s a strict downgrade with serious drawbacks. It&#x27;s really sad to see companies ditching proper Webauthn 2FA support when switching to Passkeys, because it&#x27;s making security worse for the people who actually care about it.<p>Authentication which requires multiple independent mechanisms is rarely a user benefit though; it is the result of regulatory requirements or corporate risk aversion.<p>If companies are adopting passkeys, it likely means risk that they were formerly solving with a second factor (like weak&#x2F;passive phishing resistance or credential reuse) are solved via baseline passkey provider behavior.<p>&gt; There are also privacy risks here, as it must by definition be possible to query a token for the existence of an account at a website.<p>You can protect this via the PIN of the security key, to prevent third parties who get access to your key (such as through coercion) seeing which websites you have accounts on.</div><br/><div id="39732874" class="c"><input type="checkbox" id="c-39732874" checked=""/><div class="controls bullet"><span class="by">cuu508</span><span>|</span><a href="#39732222">root</a><span>|</span><a href="#39732824">parent</a><span>|</span><a href="#39732683">next</a><span>|</span><label class="collapse" for="c-39732874">[-]</label><label class="expand" for="c-39732874">[1 more]</label></div><br/><div class="children"><div class="content">For users who currently reuse weak passwords, passkeys are a security upgrade. For users who use strong unique passwords + FIDO keys, it is a downgrade. Both types of users exist.</div><br/></div></div></div></div><div id="39732683" class="c"><input type="checkbox" id="c-39732683" checked=""/><div class="controls bullet"><span class="by">dandanua</span><span>|</span><a href="#39732222">parent</a><span>|</span><a href="#39732824">prev</a><span>|</span><a href="#39732737">next</a><span>|</span><label class="collapse" for="c-39732683">[-]</label><label class="expand" for="c-39732683">[1 more]</label></div><br/><div class="children"><div class="content">My thoughts too, resident keys don&#x27;t have real advantages and only complicate things for users and developers.</div><br/></div></div></div></div><div id="39732737" class="c"><input type="checkbox" id="c-39732737" checked=""/><div class="controls bullet"><span class="by">rettichschnidi</span><span>|</span><a href="#39732222">prev</a><span>|</span><label class="collapse" for="c-39732737">[-]</label><label class="expand" for="c-39732737">[1 more]</label></div><br/><div class="children"><div class="content">Meanwhile, Microsoft sabotages FIDO2&#x2F;Firefox on office.com: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38502340">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38502340</a></div><br/></div></div></div></div></div></div></div></body></html>