<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1690189249069" as="style"/><link rel="stylesheet" href="styles.css?v=1690189249069"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://undeadly.org/cgi?action=article;sid=20230723185853">OpenBSD: AMD processor microcode support added to -current</a> <span class="domain">(<a href="https://undeadly.org">undeadly.org</a>)</span></div><div class="subtext"><span>peter_hansteen</span> | <span>17 comments</span></div><br/><div><div id="36840385" class="c"><input type="checkbox" id="c-36840385" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#36841263">next</a><span>|</span><label class="collapse" for="c-36840385">[-]</label><label class="expand" for="c-36840385">[11 more]</label></div><br/><div class="children"><div class="content">An example of something that wouldn&#x27;t be needed at all with an open boot process, as earlier firmware would take care of it.<p>But we have to work with the poor state some motherboard vendor&#x27;s UEFI BIOS leaves the computer in, as control is passed to Openbsd&#x27;s bootloader.<p>We should prevent ever getting to this situation on RISC-V. So far, implementations have done well in this regard, with TH1520 and JH7110 following u-boot spl to opensbi to u-boot flow, with UEFI on the works on the latter chip.</div><br/><div id="36841021" class="c"><input type="checkbox" id="c-36841021" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#36840385">parent</a><span>|</span><a href="#36841194">next</a><span>|</span><label class="collapse" for="c-36841021">[-]</label><label class="expand" for="c-36841021">[6 more]</label></div><br/><div class="children"><div class="content">If boot firmware implemented it, I wouldn&#x27;t count on it being updated very often.<p>Every OS these days has a pretty good update process that patches things frequently. Doing it there means most users actually have a chance of seeing the patches.</div><br/><div id="36841566" class="c"><input type="checkbox" id="c-36841566" checked=""/><div class="controls bullet"><span class="by">cesarb</span><span>|</span><a href="#36840385">root</a><span>|</span><a href="#36841021">parent</a><span>|</span><a href="#36841170">next</a><span>|</span><label class="collapse" for="c-36841566">[-]</label><label class="expand" for="c-36841566">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If boot firmware implemented it, I wouldn&#x27;t count on it being updated very often. Every OS these days has a pretty good update process that patches things frequently.<p>Not only that, but updating firmware is always riskier than updating the OS. If an OS update is broken, you can easily use the firmware to recover (booting from the OS install media and working from there); recovering from a failed firmware update can be much harder and&#x2F;or obscure.</div><br/><div id="36842211" class="c"><input type="checkbox" id="c-36842211" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#36840385">root</a><span>|</span><a href="#36841566">parent</a><span>|</span><a href="#36841170">next</a><span>|</span><label class="collapse" for="c-36842211">[-]</label><label class="expand" for="c-36842211">[1 more]</label></div><br/><div class="children"><div class="content">In some cases nearly impossible for the owner of the hardware.<p>Supermicro BIOS updates advise that in case of failed updates, it may be necessary to send the board back to be reflashed, presumably via some sort of direct hardware connection.</div><br/></div></div></div></div><div id="36841170" class="c"><input type="checkbox" id="c-36841170" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#36840385">root</a><span>|</span><a href="#36841021">parent</a><span>|</span><a href="#36841566">prev</a><span>|</span><a href="#36841471">next</a><span>|</span><label class="collapse" for="c-36841170">[-]</label><label class="expand" for="c-36841170">[1 more]</label></div><br/><div class="children"><div class="content">&gt;If boot firmware implemented it, I wouldn&#x27;t count on it being updated very often.<p>That&#x27;s precisely the problem when it&#x27;s not possible to upgrade that boot firmware without the vendor&#x27;s help.<p>Or why x86 firmware contains microcode, yet we still have to update it later.</div><br/></div></div><div id="36841471" class="c"><input type="checkbox" id="c-36841471" checked=""/><div class="controls bullet"><span class="by">KennyBlanken</span><span>|</span><a href="#36840385">root</a><span>|</span><a href="#36841021">parent</a><span>|</span><a href="#36841170">prev</a><span>|</span><a href="#36841194">next</a><span>|</span><label class="collapse" for="c-36841471">[-]</label><label class="expand" for="c-36841471">[2 more]</label></div><br/><div class="children"><div class="content">AGESA is updated every few months and a number of motherboard vendors track those changes with BIOS updates. The updates can often contain pretty substantial changes, like resizable BAR support.<p>Further: I&#x27;m typing this on a Macbook Pro which is running right now only because I was able to pull the bootrom (which is UEFI), add a NVME driver from a newer Macbook Pro, package it back up, and flash it back to the older Macbook Pro.<p>This let me use an NVME drive in a machine released before they added NVME support to that system&#x27;s bootrom. The only side effect was that the OS didn&#x27;t fully support NVME standby modes so power consumption was slightly higher, but even that was fixed in a later OS update which was released after NVME drives were in several models.</div><br/><div id="36843575" class="c"><input type="checkbox" id="c-36843575" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#36840385">root</a><span>|</span><a href="#36841471">parent</a><span>|</span><a href="#36841194">next</a><span>|</span><label class="collapse" for="c-36843575">[-]</label><label class="expand" for="c-36843575">[1 more]</label></div><br/><div class="children"><div class="content">&gt; AGESA is updated every few months and a number of motherboard vendors track those changes with BIOS updates.<p>And very few people update their BIOS with any frequency.  But most people update their OS.</div><br/></div></div></div></div></div></div><div id="36841194" class="c"><input type="checkbox" id="c-36841194" checked=""/><div class="controls bullet"><span class="by">nemetroid</span><span>|</span><a href="#36840385">parent</a><span>|</span><a href="#36841021">prev</a><span>|</span><a href="#36841794">next</a><span>|</span><label class="collapse" for="c-36841194">[-]</label><label class="expand" for="c-36841194">[1 more]</label></div><br/><div class="children"><div class="content">No thanks. Early boot software should only do the bare minimum required to hand over control to the real operating system.<p>If this means some code duplication between operating systems, that’s OK.</div><br/></div></div><div id="36841794" class="c"><input type="checkbox" id="c-36841794" checked=""/><div class="controls bullet"><span class="by">nazgulsenpai</span><span>|</span><a href="#36840385">parent</a><span>|</span><a href="#36841194">prev</a><span>|</span><a href="#36841497">next</a><span>|</span><label class="collapse" for="c-36841794">[-]</label><label class="expand" for="c-36841794">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know to what extent but I believe that&#x27;s what AMD&#x27;s openSIL project aims to do.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openSIL&#x2F;openSIL">https:&#x2F;&#x2F;github.com&#x2F;openSIL&#x2F;openSIL</a></div><br/></div></div><div id="36841497" class="c"><input type="checkbox" id="c-36841497" checked=""/><div class="controls bullet"><span class="by">bpye</span><span>|</span><a href="#36840385">parent</a><span>|</span><a href="#36841794">prev</a><span>|</span><a href="#36840878">next</a><span>|</span><label class="collapse" for="c-36841497">[-]</label><label class="expand" for="c-36841497">[1 more]</label></div><br/><div class="children"><div class="content">I haven’t checked the changes here, but even if your FW carries a recent ucode at boot, you may find yourself wanting to update the ucode at runtime without a reboot. This is certainly possible on Linux.</div><br/></div></div><div id="36840878" class="c"><input type="checkbox" id="c-36840878" checked=""/><div class="controls bullet"><span class="by">chriscappuccio</span><span>|</span><a href="#36840385">parent</a><span>|</span><a href="#36841497">prev</a><span>|</span><a href="#36841263">next</a><span>|</span><label class="collapse" for="c-36840878">[-]</label><label class="expand" for="c-36840878">[1 more]</label></div><br/><div class="children"><div class="content">RISC V will end at the same fate when implemented by the same vendors</div><br/></div></div></div></div><div id="36841263" class="c"><input type="checkbox" id="c-36841263" checked=""/><div class="controls bullet"><span class="by">johnklos</span><span>|</span><a href="#36840385">prev</a><span>|</span><label class="collapse" for="c-36841263">[-]</label><label class="expand" for="c-36841263">[5 more]</label></div><br/><div class="children"><div class="content">This is an area where AMD has typically been better than Intel. With the longevity of the AMD4 platform, even ancient motherboards have had recent BIOS updates to bring in newer AGESA versions, so most motherboards have gotten lots of updates for very long periods of time. I wonder how many Kaby Lake motherboards are still getting updates.<p>OTOH, no matter the history of updates, it&#x27;s better to have this under the OS&#x27;s control, particularly when running OSes more suitable for servers. The thought of sending someone to update a BIOS in a colo facility is just... frightening.</div><br/><div id="36844269" class="c"><input type="checkbox" id="c-36844269" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#36841263">parent</a><span>|</span><a href="#36842098">next</a><span>|</span><label class="collapse" for="c-36844269">[-]</label><label class="expand" for="c-36844269">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The thought of sending someone to update a BIOS in a colo facility is just... frightening.<p>That&#x27;s not something you do. BMC can update itself and system BIOS out of band for quite some time. Also, if the BIOS update fails, it generally rolls-back itself.<p>Last but not least, BMC is a completely independent &quot;computer&quot;, so system BIOS is foreign to it, so faiing to update the BIOS doesn&#x27;t brick the box.<p>Implications of this &quot;independent computer&quot; is subject to another comment, tho.</div><br/></div></div><div id="36842098" class="c"><input type="checkbox" id="c-36842098" checked=""/><div class="controls bullet"><span class="by">booi</span><span>|</span><a href="#36841263">parent</a><span>|</span><a href="#36844269">prev</a><span>|</span><label class="collapse" for="c-36842098">[-]</label><label class="expand" for="c-36842098">[3 more]</label></div><br/><div class="children"><div class="content">&gt; The thought of sending someone to update a BIOS in a colo facility is just... frightening.<p>Happens a lot more than you’d think.. and for more than just servers (switch gear, routers, appliances etc..)</div><br/><div id="36842355" class="c"><input type="checkbox" id="c-36842355" checked=""/><div class="controls bullet"><span class="by">yes29922</span><span>|</span><a href="#36841263">root</a><span>|</span><a href="#36842098">parent</a><span>|</span><label class="collapse" for="c-36842355">[-]</label><label class="expand" for="c-36842355">[2 more]</label></div><br/><div class="children"><div class="content">Most decent rack servers will have some out of band management to allow this. If that fails then some dude at Equinix rolls over some stone age KVM trolley for you for a few hundred dollars..</div><br/><div id="36843950" class="c"><input type="checkbox" id="c-36843950" checked=""/><div class="controls bullet"><span class="by">stingraycharles</span><span>|</span><a href="#36841263">root</a><span>|</span><a href="#36842355">parent</a><span>|</span><label class="collapse" for="c-36843950">[-]</label><label class="expand" for="c-36843950">[1 more]</label></div><br/><div class="children"><div class="content">Don’t most modern server motherboards come with a BMC controller that allows KVM over IP? That’s my experience at least for colos.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>