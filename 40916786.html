<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1720602064561" as="style"/><link rel="stylesheet" href="styles.css?v=1720602064561"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://turbopuffer.com/blog/turbopuffer">Turbopuffer: Fast search on object storage</a> <span class="domain">(<a href="https://turbopuffer.com">turbopuffer.com</a>)</span></div><div class="subtext"><span>Sirupsen</span> | <span>40 comments</span></div><br/><div><div id="40923564" class="c"><input type="checkbox" id="c-40923564" checked=""/><div class="controls bullet"><span class="by">nh2</span><span>|</span><a href="#40920438">next</a><span>|</span><label class="collapse" for="c-40923564">[-]</label><label class="expand" for="c-40923564">[2 more]</label></div><br/><div class="children"><div class="content">&gt; $3600.00&#x2F;TB&#x2F;month<p>It doesn&#x27;t have to be that way.<p>At Hetzner I pay $200&#x2F;TB&#x2F;month for RAM. That&#x27;s 18x cheaper.<p>Sometimes you can reach the goal faster with less complexity by removing the part with the 20x markup.</div><br/><div id="40924513" class="c"><input type="checkbox" id="c-40924513" checked=""/><div class="controls bullet"><span class="by">TechDebtDevin</span><span>|</span><a href="#40923564">parent</a><span>|</span><a href="#40920438">next</a><span>|</span><label class="collapse" for="c-40924513">[-]</label><label class="expand" for="c-40924513">[1 more]</label></div><br/><div class="children"><div class="content">I will likely never leave Hetzner.</div><br/></div></div></div></div><div id="40920438" class="c"><input type="checkbox" id="c-40920438" checked=""/><div class="controls bullet"><span class="by">softwaredoug</span><span>|</span><a href="#40923564">prev</a><span>|</span><a href="#40920639">next</a><span>|</span><label class="collapse" for="c-40920438">[-]</label><label class="expand" for="c-40920438">[2 more]</label></div><br/><div class="children"><div class="content">Having worked with Simon he knows his sh*t. We talked a lot about what the ideal search stack would look when we worked together at Shopify on search (him more infra, me more ML+relevance). I discussed how I just want a thing in the cloud to provide my retrieval arms, let me express ranking in a fluent &quot;py-data&quot; first way, and get out of my way<p>My ideal is that turbopuffer ultimately is like a Polars dataframe where all my ranking is expressed in my search API. I could just lazily express some lexical or embedding similarity, boost with various attributes like, maybe by recency, popularity, etc to get a first pass (again all just with dataframe math). Then compute features for a reranking model I run on my side - dataframe math - and it &quot;just works&quot; - runs all this as some kind of query execution DAG - and stays out of my way.</div><br/><div id="40922580" class="c"><input type="checkbox" id="c-40922580" checked=""/><div class="controls bullet"><span class="by">bkitano19</span><span>|</span><a href="#40920438">parent</a><span>|</span><a href="#40920639">next</a><span>|</span><label class="collapse" for="c-40922580">[-]</label><label class="expand" for="c-40922580">[1 more]</label></div><br/><div class="children"><div class="content">+1, had the fortune to work with him at a previous startup and meetup in person. Our convo very much broadened my perspective on engineering as a career and a craft, always excited to see what he&#x27;s working on. Good luck Simon!</div><br/></div></div></div></div><div id="40920639" class="c"><input type="checkbox" id="c-40920639" checked=""/><div class="controls bullet"><span class="by">cmcollier</span><span>|</span><a href="#40920438">prev</a><span>|</span><a href="#40922055">next</a><span>|</span><label class="collapse" for="c-40920639">[-]</label><label class="expand" for="c-40920639">[7 more]</label></div><br/><div class="children"><div class="content">Unrelated to the core topic, I really enjoy the aesthetic of their website.  Another similar one is from Fixie.ai (also, interestingly, one of their customers).</div><br/><div id="40924468" class="c"><input type="checkbox" id="c-40924468" checked=""/><div class="controls bullet"><span class="by">k2so</span><span>|</span><a href="#40920639">parent</a><span>|</span><a href="#40923242">next</a><span>|</span><label class="collapse" for="c-40924468">[-]</label><label class="expand" for="c-40924468">[1 more]</label></div><br/><div class="children"><div class="content">This was my first thought too, after reading through their blog. This feels like a no-frills website made by an engineer, who makes things that just work.<p>The documentation is great, I really appreciate them putting the roadmap front and centre.</div><br/></div></div><div id="40923242" class="c"><input type="checkbox" id="c-40923242" checked=""/><div class="controls bullet"><span class="by">xarope</span><span>|</span><a href="#40920639">parent</a><span>|</span><a href="#40924468">prev</a><span>|</span><a href="#40923134">next</a><span>|</span><label class="collapse" for="c-40923242">[-]</label><label class="expand" for="c-40923242">[1 more]</label></div><br/><div class="children"><div class="content">Yes, I like the turboxyz123 animation and contrast to the minimalist website (reminds me of the zen garden with a single rock).  I think people forget nowadays in their haste to add the latest and greatest react animation, that too much noise is a thing.</div><br/></div></div><div id="40923134" class="c"><input type="checkbox" id="c-40923134" checked=""/><div class="controls bullet"><span class="by">swyx</span><span>|</span><a href="#40920639">parent</a><span>|</span><a href="#40923242">prev</a><span>|</span><a href="#40921496">next</a><span>|</span><label class="collapse" for="c-40923134">[-]</label><label class="expand" for="c-40923134">[2 more]</label></div><br/><div class="children"><div class="content">what does fixie do these days?</div><br/><div id="40924182" class="c"><input type="checkbox" id="c-40924182" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#40920639">root</a><span>|</span><a href="#40923134">parent</a><span>|</span><a href="#40921496">next</a><span>|</span><label class="collapse" for="c-40924182">[-]</label><label class="expand" for="c-40924182">[1 more]</label></div><br/><div class="children"><div class="content">They pivoted, but will probably pivot back to their original quest.</div><br/></div></div></div></div><div id="40921496" class="c"><input type="checkbox" id="c-40921496" checked=""/><div class="controls bullet"><span class="by">itunpredictable</span><span>|</span><a href="#40920639">parent</a><span>|</span><a href="#40923134">prev</a><span>|</span><a href="#40921849">next</a><span>|</span><label class="collapse" for="c-40921496">[-]</label><label class="expand" for="c-40921496">[1 more]</label></div><br/><div class="children"><div class="content">This website rocks</div><br/></div></div><div id="40921849" class="c"><input type="checkbox" id="c-40921849" checked=""/><div class="controls bullet"><span class="by">nsguy</span><span>|</span><a href="#40920639">parent</a><span>|</span><a href="#40921496">prev</a><span>|</span><a href="#40922055">next</a><span>|</span><label class="collapse" for="c-40921849">[-]</label><label class="expand" for="c-40921849">[1 more]</label></div><br/><div class="children"><div class="content">Yeah! fast, clean, cool, unique.</div><br/></div></div></div></div><div id="40922055" class="c"><input type="checkbox" id="c-40922055" checked=""/><div class="controls bullet"><span class="by">omneity</span><span>|</span><a href="#40920639">prev</a><span>|</span><a href="#40924313">next</a><span>|</span><label class="collapse" for="c-40922055">[-]</label><label class="expand" for="c-40922055">[3 more]</label></div><br/><div class="children"><div class="content">&gt; In 2022, production-grade vector databases were relying on in-memory storage<p>This is irking me. pg_vector has existed from before that, doesn&#x27;t require in-memory storage and can definitely handle vector search for 100m+ documents in a decently performant manner. Did they have a particular requirement somewhere?</div><br/><div id="40922076" class="c"><input type="checkbox" id="c-40922076" checked=""/><div class="controls bullet"><span class="by">jbellis</span><span>|</span><a href="#40922055">parent</a><span>|</span><a href="#40924313">next</a><span>|</span><label class="collapse" for="c-40922076">[-]</label><label class="expand" for="c-40922076">[2 more]</label></div><br/><div class="children"><div class="content">Have you tried it? pgvector performance falls off a cliff once you can&#x27;t cache in ram. Vector search isn&#x27;t like &quot;normal&quot; workloads that follow a nice pareto distribution.</div><br/><div id="40922426" class="c"><input type="checkbox" id="c-40922426" checked=""/><div class="controls bullet"><span class="by">omneity</span><span>|</span><a href="#40922055">root</a><span>|</span><a href="#40922076">parent</a><span>|</span><a href="#40924313">next</a><span>|</span><label class="collapse" for="c-40922426">[-]</label><label class="expand" for="c-40922426">[1 more]</label></div><br/><div class="children"><div class="content">Tried and deployed in production with similar sized collections.<p>You only need enough memory to load the index, definitely not the whole collection. A typical index would most likely fit within a few GBs. And even if you need dozens of GBs of RAM it won’t cost nearly as much as $20k&#x2F;month as the article surmises.</div><br/></div></div></div></div></div></div><div id="40924313" class="c"><input type="checkbox" id="c-40924313" checked=""/><div class="controls bullet"><span class="by">zX41ZdbW</span><span>|</span><a href="#40922055">prev</a><span>|</span><a href="#40920788">next</a><span>|</span><label class="collapse" for="c-40924313">[-]</label><label class="expand" for="c-40924313">[1 more]</label></div><br/><div class="children"><div class="content">A correction to the article. It mentions<p><pre><code>    Warehouse BigQuery, Snowflake, Clickhouse ≥1s Minutes
</code></pre>
For ClickHouse, it should be: read latency &lt;= 100ms, write latency &lt;= 1s.<p>Logging, real-time analytics, and RAG are also suitable for ClickHouse.</div><br/></div></div><div id="40920788" class="c"><input type="checkbox" id="c-40920788" checked=""/><div class="controls bullet"><span class="by">bigbones</span><span>|</span><a href="#40924313">prev</a><span>|</span><a href="#40921379">next</a><span>|</span><label class="collapse" for="c-40920788">[-]</label><label class="expand" for="c-40920788">[3 more]</label></div><br/><div class="children"><div class="content">Sounds like a source-unavailable version of Quickwit? <a href="https:&#x2F;&#x2F;quickwit.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;quickwit.io&#x2F;</a></div><br/><div id="40920922" class="c"><input type="checkbox" id="c-40920922" checked=""/><div class="controls bullet"><span class="by">pushrax</span><span>|</span><a href="#40920788">parent</a><span>|</span><a href="#40921379">next</a><span>|</span><label class="collapse" for="c-40920922">[-]</label><label class="expand" for="c-40920922">[2 more]</label></div><br/><div class="children"><div class="content">LSM tree storage engine vs time series storage engine, similar philosophy but different use cases</div><br/><div id="40923436" class="c"><input type="checkbox" id="c-40923436" checked=""/><div class="controls bullet"><span class="by">singhrac</span><span>|</span><a href="#40920788">root</a><span>|</span><a href="#40920922">parent</a><span>|</span><a href="#40921379">next</a><span>|</span><label class="collapse" for="c-40923436">[-]</label><label class="expand" for="c-40923436">[1 more]</label></div><br/><div class="children"><div class="content">Maybe I misunderstood both products but I think neither Quickwit or Turbopuffer is either of those things intrinsically (though log structured messages are a good fit for Quickfit). I think Quickwit is essentially Lucene&#x2F;Elasticsearch (i.e. sparse queries or BM25) and Turbopuffer does vector search (or dense queries) like say Faiss&#x2F;Pinecone&#x2F;Qdrant&#x2F;Vectorize, both over object storage.</div><br/></div></div></div></div></div></div><div id="40921379" class="c"><input type="checkbox" id="c-40921379" checked=""/><div class="controls bullet"><span class="by">eknkc</span><span>|</span><a href="#40920788">prev</a><span>|</span><a href="#40921306">next</a><span>|</span><label class="collapse" for="c-40921379">[-]</label><label class="expand" for="c-40921379">[11 more]</label></div><br/><div class="children"><div class="content">Is there a good general purpose solution where I can store a large read only database in s3 or something and do lookups directly on it?<p>Duckdb can open parquet files over http and query them but I found it to trigger a lot of small requests reading bunch of places from the files. I mean a lot.<p>I mostly need key &#x2F; value lookups and could potentially store each key in a seperate object in s3 but for a couple hundred million objects.. It would be a lot more managable to have a single file and maybe a cacheable index.</div><br/><div id="40922842" class="c"><input type="checkbox" id="c-40922842" checked=""/><div class="controls bullet"><span class="by">tionis</span><span>|</span><a href="#40921379">parent</a><span>|</span><a href="#40923712">next</a><span>|</span><label class="collapse" for="c-40922842">[-]</label><label class="expand" for="c-40922842">[3 more]</label></div><br/><div class="children"><div class="content">You could use a sqlite database and use range queries using something like this:
<a href="https:&#x2F;&#x2F;github.com&#x2F;psanford&#x2F;sqlite3vfshttp">https:&#x2F;&#x2F;github.com&#x2F;psanford&#x2F;sqlite3vfshttp</a>
<a href="https:&#x2F;&#x2F;github.com&#x2F;phiresky&#x2F;sql.js-httpvfs">https:&#x2F;&#x2F;github.com&#x2F;phiresky&#x2F;sql.js-httpvfs</a><p>Simon Willison wrote about it:
<a href="https:&#x2F;&#x2F;simonwillison.net&#x2F;2022&#x2F;Aug&#x2F;10&#x2F;sqlite-http&#x2F;" rel="nofollow">https:&#x2F;&#x2F;simonwillison.net&#x2F;2022&#x2F;Aug&#x2F;10&#x2F;sqlite-http&#x2F;</a></div><br/><div id="40924633" class="c"><input type="checkbox" id="c-40924633" checked=""/><div class="controls bullet"><span class="by">eknkc</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40922842">parent</a><span>|</span><a href="#40924060">next</a><span>|</span><label class="collapse" for="c-40924633">[-]</label><label class="expand" for="c-40924633">[1 more]</label></div><br/><div class="children"><div class="content">Yep this thing is the reason I thought about doing it in the first place. Tried duckdb which has built in support for range requests over http.<p>Whole idea makes sense but I feel like the file format should be specifically tuned for this use case. Otherwise you end up with a lot of range requests because it was designed for disk access. I wondered if anything was actually designed for that.</div><br/></div></div><div id="40924060" class="c"><input type="checkbox" id="c-40924060" checked=""/><div class="controls bullet"><span class="by">arcanemachiner</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40922842">parent</a><span>|</span><a href="#40924633">prev</a><span>|</span><a href="#40923712">next</a><span>|</span><label class="collapse" for="c-40924060">[-]</label><label class="expand" for="c-40924060">[1 more]</label></div><br/><div class="children"><div class="content">That whole thing still blows my mind.</div><br/></div></div></div></div><div id="40923712" class="c"><input type="checkbox" id="c-40923712" checked=""/><div class="controls bullet"><span class="by">cdchn</span><span>|</span><a href="#40921379">parent</a><span>|</span><a href="#40922842">prev</a><span>|</span><a href="#40922137">next</a><span>|</span><label class="collapse" for="c-40923712">[-]</label><label class="expand" for="c-40923712">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Is there a good general purpose solution where I can store a large read only database in s3 or something and do lookups directly on it?<p>I think this is pretty much what AWS Athena is.</div><br/></div></div><div id="40922137" class="c"><input type="checkbox" id="c-40922137" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#40921379">parent</a><span>|</span><a href="#40923712">prev</a><span>|</span><a href="#40922166">next</a><span>|</span><label class="collapse" for="c-40922137">[-]</label><label class="expand" for="c-40922137">[3 more]</label></div><br/><div class="children"><div class="content">&gt; trigger a lot of small requests reading bunch of places from the files. I mean a lot.<p>That’s… the whole point. That’s how Parquet files are supposed to be used. They’re an improvement over CSV or JSON because clients can read small subsets of them efficiently!<p>For comparison, I’ve tried a few other client products that don’t use Parquet files properly and just read the whole file every time, no matter how trivial the query is.</div><br/><div id="40924681" class="c"><input type="checkbox" id="c-40924681" checked=""/><div class="controls bullet"><span class="by">eknkc</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40922137">parent</a><span>|</span><a href="#40922166">next</a><span>|</span><label class="collapse" for="c-40924681">[-]</label><label class="expand" for="c-40924681">[2 more]</label></div><br/><div class="children"><div class="content">This makes sense but the problem I had with duckdb + parquet is it looks like there is no metadata caching so each and every query triggers a lot of requests.<p>Duckdb can query a remote duckdb database too, in that case it looks like there is caching. Which might be better.<p>I wonder if anyone actually worked on a specific file format for this use case (relatively high latency random access) to minimize reads to as little blocks as possible.</div><br/><div id="40924698" class="c"><input type="checkbox" id="c-40924698" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40924681">parent</a><span>|</span><a href="#40922166">next</a><span>|</span><label class="collapse" for="c-40924698">[-]</label><label class="expand" for="c-40924698">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like a bug or missing feature in DuckDB more than an issue with the format</div><br/></div></div></div></div></div></div><div id="40922166" class="c"><input type="checkbox" id="c-40922166" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#40921379">parent</a><span>|</span><a href="#40922137">prev</a><span>|</span><a href="#40921306">next</a><span>|</span><label class="collapse" for="c-40922166">[-]</label><label class="expand" for="c-40922166">[3 more]</label></div><br/><div class="children"><div class="content">ClickHouse can also read from S3. I&#x27;m not sure how it compares to DuckDB re efficiency, but it worked fine for my simple use case.</div><br/><div id="40922670" class="c"><input type="checkbox" id="c-40922670" checked=""/><div class="controls bullet"><span class="by">masterj</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40922166">parent</a><span>|</span><a href="#40921306">next</a><span>|</span><label class="collapse" for="c-40922670">[-]</label><label class="expand" for="c-40922670">[2 more]</label></div><br/><div class="children"><div class="content">Neither of these support indexes afaik. They are designed to do fast scans &#x2F; computation.</div><br/><div id="40923656" class="c"><input type="checkbox" id="c-40923656" checked=""/><div class="controls bullet"><span class="by">hodgesrm</span><span>|</span><a href="#40921379">root</a><span>|</span><a href="#40922670">parent</a><span>|</span><a href="#40921306">next</a><span>|</span><label class="collapse" for="c-40923656">[-]</label><label class="expand" for="c-40923656">[1 more]</label></div><br/><div class="children"><div class="content">It depends on what you mean by &quot;support.&quot; ClickHouse as I recall can read min&#x2F;max indexes from Parquet row groups. One of my colleagues is working on a PR to add support for bloom filter indexes. So that will be covered as well.<p>Right now one of the main performance problems is that Clickhouse does not cache index metadata yet, so you still have to scan files rather than keeping the metadata in memory. ClickHouse does this for native MergeTree tables. There are a couple of steps to get there but I have no doubt that metadata caching will be properly handled soon.<p>Disclaimer: I work for Altinity, an enterprise provider for ClickHouse software.</div><br/></div></div></div></div></div></div></div></div><div id="40921306" class="c"><input type="checkbox" id="c-40921306" checked=""/><div class="controls bullet"><span class="by">drodgers</span><span>|</span><a href="#40921379">prev</a><span>|</span><a href="#40923728">next</a><span>|</span><label class="collapse" for="c-40921306">[-]</label><label class="expand" for="c-40921306">[1 more]</label></div><br/><div class="children"><div class="content">I love the object-storage-first approach; it seems like such a natural fit for the could.</div><br/></div></div><div id="40923728" class="c"><input type="checkbox" id="c-40923728" checked=""/><div class="controls bullet"><span class="by">cdchn</span><span>|</span><a href="#40921306">prev</a><span>|</span><a href="#40922957">next</a><span>|</span><label class="collapse" for="c-40923728">[-]</label><label class="expand" for="c-40923728">[1 more]</label></div><br/><div class="children"><div class="content">The very long introductory page has a ton of very juicy data in it, even if you don&#x27;t care about the product itself.</div><br/></div></div><div id="40922957" class="c"><input type="checkbox" id="c-40922957" checked=""/><div class="controls bullet"><span class="by">endisneigh</span><span>|</span><a href="#40923728">prev</a><span>|</span><a href="#40923669">next</a><span>|</span><label class="collapse" for="c-40922957">[-]</label><label class="expand" for="c-40922957">[1 more]</label></div><br/><div class="children"><div class="content">Slightly relevant - do people really want article recommendations? I don’t think I’ve ever read an article and wanted a recommendation. Even with this one - I sort of read it and that’s it; no feeling of wanting recommendations.<p>Am I alone in this?<p>In any case this seems like a pretty interesting approach. Reminds me of Warpstream which does something similar with S3 to replace Kafka.</div><br/></div></div><div id="40923669" class="c"><input type="checkbox" id="c-40923669" checked=""/><div class="controls bullet"><span class="by">yawnxyz</span><span>|</span><a href="#40922957">prev</a><span>|</span><a href="#40920899">next</a><span>|</span><label class="collapse" for="c-40923669">[-]</label><label class="expand" for="c-40923669">[1 more]</label></div><br/><div class="children"><div class="content">can&#x27;t wait for the day the get into GA!</div><br/></div></div><div id="40920899" class="c"><input type="checkbox" id="c-40920899" checked=""/><div class="controls bullet"><span class="by">vidar</span><span>|</span><a href="#40923669">prev</a><span>|</span><a href="#40922360">next</a><span>|</span><label class="collapse" for="c-40920899">[-]</label><label class="expand" for="c-40920899">[1 more]</label></div><br/><div class="children"><div class="content">Can you compare to S3 Athena (ELI5)?</div><br/></div></div><div id="40922360" class="c"><input type="checkbox" id="c-40922360" checked=""/><div class="controls bullet"><span class="by">yamumsahoe</span><span>|</span><a href="#40920899">prev</a><span>|</span><a href="#40922898">next</a><span>|</span><label class="collapse" for="c-40922360">[-]</label><label class="expand" for="c-40922360">[1 more]</label></div><br/><div class="children"><div class="content">unsure if they are comparable, but is this and quickwit comparable?</div><br/></div></div><div id="40922898" class="c"><input type="checkbox" id="c-40922898" checked=""/><div class="controls bullet"><span class="by">hipadev23</span><span>|</span><a href="#40922360">prev</a><span>|</span><a href="#40921143">next</a><span>|</span><label class="collapse" for="c-40922898">[-]</label><label class="expand" for="c-40922898">[1 more]</label></div><br/><div class="children"><div class="content">That’s some woefully disappointing and incorrect metrics (read and write latency are both sub-second, storage medium would be “ Memory + Replicated SSDs”) you’ve got for Clickhouse there, but I understand what you’re going for and why you categorized it where you did.</div><br/></div></div><div id="40921143" class="c"><input type="checkbox" id="c-40921143" checked=""/><div class="controls bullet"><span class="by">CyberDildonics</span><span>|</span><a href="#40922898">prev</a><span>|</span><a href="#40922010">next</a><span>|</span><label class="collapse" for="c-40921143">[-]</label><label class="expand" for="c-40921143">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like a filesystem with attributes in a database.</div><br/></div></div></div></div></div></div></div></body></html>