<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1698224463499" as="style"/><link rel="stylesheet" href="styles.css?v=1698224463499"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://simonwillison.net/2023/Sep/30/cli-tools-python/">Things I&#x27;ve learned about building CLI tools in Python</a> <span class="domain">(<a href="https://simonwillison.net">simonwillison.net</a>)</span></div><div class="subtext"><span>gilad</span> | <span>47 comments</span></div><br/><div><div id="38009649" class="c"><input type="checkbox" id="c-38009649" checked=""/><div class="controls bullet"><span class="by">guessmyname</span><span>|</span><a href="#38009672">next</a><span>|</span><label class="collapse" for="c-38009649">[-]</label><label class="expand" for="c-38009649">[14 more]</label></div><br/><div class="children"><div class="content">I’ve noticed that I never quite feel at ease with the Python programs I write.<p>I’ve been using Go to create projects, both big and small, since 2013.<p>Almost every time I attempt to build something even remotely complex with Python, I end up regretting it, especially when other people besides myself start using these programs. The main problem is the lack of assurance that the same program will function correctly on another person’s computer. With Go programs, it’s as simple as having a statically linked binary, and given the ease of cross-compilation, I’m very confident that what works on my machine will work on my coworker&#x27;s or customer&#x27;s computer as well.<p>You know how some people suggest that Shell scripts should not exceed a certain number of lines, because beyond that point, it’s better to create a Python, Ruby, PHP, or similar script? I experience a similar sentiment when working with Python. A few hundred lines may be acceptable, but anything larger than that, I believe, is better suited to be written in a compiled language.</div><br/><div id="38009800" class="c"><input type="checkbox" id="c-38009800" checked=""/><div class="controls bullet"><span class="by">athrun</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38010056">next</a><span>|</span><label class="collapse" for="c-38009800">[-]</label><label class="expand" for="c-38009800">[2 more]</label></div><br/><div class="children"><div class="content">I feel the same way.<p>Python has been my goto language for a long time, but lately I&#x27;ve been noticing that I&#x27;ve been holding off on writing new tools with it because on the back of my mind I have this nagging feeling that making them robust and portable will take too much work—and so I don&#x27;t even bother getting started.<p>It&#x27;s this trap of yes you get to ~99% pretty fast, but the last 1% (packaging&#x2F;distribution) then take forever.<p>But I&#x27;m still looking for a good alternative... Golang does the job—no question, but it doesn&#x27;t spark joy for me.</div><br/><div id="38010699" class="c"><input type="checkbox" id="c-38010699" checked=""/><div class="controls bullet"><span class="by">chasinglogic</span><span>|</span><a href="#38009649">root</a><span>|</span><a href="#38009800">parent</a><span>|</span><a href="#38010056">next</a><span>|</span><label class="collapse" for="c-38010699">[-]</label><label class="expand" for="c-38010699">[1 more]</label></div><br/><div class="children"><div class="content">While there is definitely a higher barrier to entry, once I got comfortable with Rust (and finally stole someones working cross-compile &#x2F; publish github actions for it) it has surplanted Golang in this use case because it does spark joy for me.</div><br/></div></div></div></div><div id="38010056" class="c"><input type="checkbox" id="c-38010056" checked=""/><div class="controls bullet"><span class="by">rtpg</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38009800">prev</a><span>|</span><a href="#38009702">next</a><span>|</span><label class="collapse" for="c-38010056">[-]</label><label class="expand" for="c-38010056">[2 more]</label></div><br/><div class="children"><div class="content">There are packaging tools for Python, and if your tooling is targetting people already using Python, just relying on `pip` + writing a proper pyproject.toml is a good solution nowadays (protip for people with virtualenv issues: direnv solves so much of this it&#x27;s not funny).<p>But I have been looking around for a while for something that&#x27;s more certain than `pip`, and unfortunately everything I&#x27;ve found (like Bazel or Buck) suffers from having to do a lot of futzing to use dependencies.</div><br/><div id="38010116" class="c"><input type="checkbox" id="c-38010116" checked=""/><div class="controls bullet"><span class="by">zuck_vs_musk</span><span>|</span><a href="#38009649">root</a><span>|</span><a href="#38010056">parent</a><span>|</span><a href="#38009702">next</a><span>|</span><label class="collapse" for="c-38010116">[-]</label><label class="expand" for="c-38010116">[1 more]</label></div><br/><div class="children"><div class="content">pip will install dependencies transitively.
Some of those dependencies or some version of those might be uninstallable on certain platforms and you won&#x27;t even know!<p>Further, if I am building using Python 3.11 features and you are stuck on Python 3.10 then you cannot install my Python CLI tool.</div><br/></div></div></div></div><div id="38009702" class="c"><input type="checkbox" id="c-38009702" checked=""/><div class="controls bullet"><span class="by">Jare</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38010056">prev</a><span>|</span><a href="#38010550">next</a><span>|</span><label class="collapse" for="c-38009702">[-]</label><label class="expand" for="c-38009702">[2 more]</label></div><br/><div class="children"><div class="content">My rule of thumb used to be shell scripts past 100 lines get converted to Python, and Python scripts past 1000 lines should get converted to something else. But in practice, the Python has stayed almost always.</div><br/><div id="38010380" class="c"><input type="checkbox" id="c-38010380" checked=""/><div class="controls bullet"><span class="by">m463</span><span>|</span><a href="#38009649">root</a><span>|</span><a href="#38009702">parent</a><span>|</span><a href="#38010550">next</a><span>|</span><label class="collapse" for="c-38010380">[-]</label><label class="expand" for="c-38010380">[1 more]</label></div><br/><div class="children"><div class="content">I think simple shell scripts are usually more terse than python.<p>But as a shell script grows, python starts winning.<p>By the time you get to 1000 lines of python, you are probably doing a lot of heavy lifting and it is probably non-trivial to change languages.</div><br/></div></div></div></div><div id="38010550" class="c"><input type="checkbox" id="c-38010550" checked=""/><div class="controls bullet"><span class="by">DanielHB</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38009702">prev</a><span>|</span><a href="#38009717">next</a><span>|</span><label class="collapse" for="c-38010550">[-]</label><label class="expand" for="c-38010550">[1 more]</label></div><br/><div class="children"><div class="content">If you distribute any CLI tool you should include the runtime and any attached dependencies, but with dynamic languages that can easily put your distributable in the tens of megabytes in size which is a bit of a pain.<p>I mean for the longest time the AWS CLI used the python&#x2F;pip installed in your own machine and it probably caused thousands of man-hours of wasted time.</div><br/></div></div><div id="38009717" class="c"><input type="checkbox" id="c-38009717" checked=""/><div class="controls bullet"><span class="by">rjzzleep</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38010550">prev</a><span>|</span><a href="#38010554">next</a><span>|</span><label class="collapse" for="c-38009717">[-]</label><label class="expand" for="c-38009717">[2 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t say I can relate at all. If you do things from scratch that might be true, but there is a pretty popular python tool called cookiecutter that allows you to generate the basic skeleton of the app. I usually pick something that contains poetry, click(I guess there is typed now) and some linting choices.<p>For fun I just googled a template and tried: <a href="https:&#x2F;&#x2F;github.com&#x2F;radix-ai&#x2F;poetry-cookiecutter">https:&#x2F;&#x2F;github.com&#x2F;radix-ai&#x2F;poetry-cookiecutter</a><p>And the result is quite good.<p>Your comment assumes that python cli scripts need to be single liners, but IIRC there are several tools that allow you to bundle a package into a single file like pex, shiv, and zipapp.</div><br/><div id="38009900" class="c"><input type="checkbox" id="c-38009900" checked=""/><div class="controls bullet"><span class="by">zaphirplane</span><span>|</span><a href="#38009649">root</a><span>|</span><a href="#38009717">parent</a><span>|</span><a href="#38010554">next</a><span>|</span><label class="collapse" for="c-38009900">[-]</label><label class="expand" for="c-38009900">[1 more]</label></div><br/><div class="children"><div class="content">That actually look very good thanks !</div><br/></div></div></div></div><div id="38010554" class="c"><input type="checkbox" id="c-38010554" checked=""/><div class="controls bullet"><span class="by">switch007</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38009717">prev</a><span>|</span><a href="#38010198">next</a><span>|</span><label class="collapse" for="c-38010554">[-]</label><label class="expand" for="c-38010554">[1 more]</label></div><br/><div class="children"><div class="content">For me Python is addictive.<p>You know the tooling is bad and in the long term it will hurt, but the standard library and third party packages are just phenomenally productive and that’s a huge draw.</div><br/></div></div><div id="38010198" class="c"><input type="checkbox" id="c-38010198" checked=""/><div class="controls bullet"><span class="by">xen0</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38010554">prev</a><span>|</span><a href="#38009692">next</a><span>|</span><label class="collapse" for="c-38010198">[-]</label><label class="expand" for="c-38010198">[1 more]</label></div><br/><div class="children"><div class="content">The equivalent to static linking in Python would be bundling all code into an archive (including transitive dependencies), along with an interpreter. Some shell script can be used to unpack and run.<p>It&#x27;s possible, just not the norm.</div><br/></div></div><div id="38009692" class="c"><input type="checkbox" id="c-38009692" checked=""/><div class="controls bullet"><span class="by">ShadowBanThis01</span><span>|</span><a href="#38009649">parent</a><span>|</span><a href="#38010198">prev</a><span>|</span><a href="#38009672">next</a><span>|</span><label class="collapse" for="c-38009692">[-]</label><label class="expand" for="c-38009692">[2 more]</label></div><br/><div class="children"><div class="content">I was going to learn Python for the same reason: to create utilities that would run on most any computer. Mostly to do things like file-parsing and data-format conversion.<p>But the Python ecosystem seems to be such a disappointing mess that I just gave up on the whole idea. I&#x27;m learning JavaScript&#x2F;TypeScript now and you can build CLI programs with Deno.</div><br/><div id="38010566" class="c"><input type="checkbox" id="c-38010566" checked=""/><div class="controls bullet"><span class="by">DanielHB</span><span>|</span><a href="#38009649">root</a><span>|</span><a href="#38009692">parent</a><span>|</span><a href="#38009672">next</a><span>|</span><label class="collapse" for="c-38010566">[-]</label><label class="expand" for="c-38010566">[1 more]</label></div><br/><div class="children"><div class="content">The npm package called &quot;pkg&quot; seems to be the standard for packaging NodeJS applications<p><a href="https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;pkg" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;pkg</a><p>Unfortunately you also need to bundle all your code into a single file for it to work, but you can use any bundler (webpack, parcel, etc) you want at least</div><br/></div></div></div></div></div></div><div id="38009672" class="c"><input type="checkbox" id="c-38009672" checked=""/><div class="controls bullet"><span class="by">thrdbndndn</span><span>|</span><a href="#38009649">prev</a><span>|</span><a href="#38009441">next</a><span>|</span><label class="collapse" for="c-38009672">[-]</label><label class="expand" for="c-38009672">[6 more]</label></div><br/><div class="children"><div class="content">I&#x27;m sure click has its advantage if your CLI is particularly complex, but for me the built-in argparse is more than enough, it has almost all the common things you need.<p>By the way, argparse (and I assume click too) by default allows having positional arguments and switches in any order, i.e., both:<p><pre><code>    mycli pospara0 --switch --option A
    mycli --switch --option A pospara0 
</code></pre>
work. This seems like nothing but I&#x27;ve encountered many CLI utilities written in other languages (particularly, go and node.js) that force you to have switches at the beginning. and I <i>really</i> hate that.<p>I don&#x27;t know if it&#x27;s caused by their corresponding default&#x2F;popular CLI library or what, someone could enlighten me.<p>(Of course, in some cases like things like FFMPEG, the order absolutely matters; but it&#x27;s not the case for 99% of utilities.)</div><br/><div id="38010577" class="c"><input type="checkbox" id="c-38010577" checked=""/><div class="controls bullet"><span class="by">omgmajk</span><span>|</span><a href="#38009672">parent</a><span>|</span><a href="#38009948">next</a><span>|</span><label class="collapse" for="c-38010577">[-]</label><label class="expand" for="c-38010577">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. I, and we (at work) use argparse and it works as intended. I don&#x27;t know why I would ever switch at this point. Also I feel like arguments should not be ordered unless absolutely necessary, just feels like a head ache to me.</div><br/></div></div><div id="38009948" class="c"><input type="checkbox" id="c-38009948" checked=""/><div class="controls bullet"><span class="by">raffraffraff</span><span>|</span><a href="#38009672">parent</a><span>|</span><a href="#38010577">prev</a><span>|</span><a href="#38010165">next</a><span>|</span><label class="collapse" for="c-38009948">[-]</label><label class="expand" for="c-38009948">[1 more]</label></div><br/><div class="children"><div class="content">I hate it when a cli forces ordering of args when there&#x27;s no reason to! It&#x27;s mitigated somewhat by decent tab-completion that only completed what is allowed.</div><br/></div></div><div id="38010165" class="c"><input type="checkbox" id="c-38010165" checked=""/><div class="controls bullet"><span class="by">crabbone</span><span>|</span><a href="#38009672">parent</a><span>|</span><a href="#38009948">prev</a><span>|</span><a href="#38009789">next</a><span>|</span><label class="collapse" for="c-38010165">[-]</label><label class="expand" for="c-38010165">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;m sure click has its advantage if your CLI is particularly complex<p>None whatsoever.  Argsparse is better all around.  Click is just a worthless piece of software that nobody should be using.<p>As for the order of options &#x2F; arguments.  I think, the reason is the historical implementations and use of getopt that would be used in a switch inside a loop, which (maybe unintentionally) made the order irrelevant.  It&#x27;s likely that other libraries implement parsers in the way that is sensitive to the order.  Whether that&#x27;s deliberate it&#x27;s hard to tell.  There are definitely advantages to this approach too, but it&#x27;s hard to know whether authors sought out those advantages deliberately.<p>For instance, when options can take arguments (especially when they can take multiple arguments) they can be confused with sub-commands or the arguments to commands.  Imposing ordering restrictions helps to resolve ambiguities as to what argument is being processed.  On the other hand, you may claim that not imposing ordering on arguments prevents CLI authors from creating confusing interfaces where users can accidentally mix arguments to options with sub-commands or arguments to commands.</div><br/><div id="38010653" class="c"><input type="checkbox" id="c-38010653" checked=""/><div class="controls bullet"><span class="by">thrdbndndn</span><span>|</span><a href="#38009672">root</a><span>|</span><a href="#38010165">parent</a><span>|</span><a href="#38009789">next</a><span>|</span><label class="collapse" for="c-38010653">[-]</label><label class="expand" for="c-38010653">[1 more]</label></div><br/><div class="children"><div class="content">Glad to know I&#x27;m not missing anything, then!</div><br/></div></div></div></div><div id="38009789" class="c"><input type="checkbox" id="c-38009789" checked=""/><div class="controls bullet"><span class="by">atoav</span><span>|</span><a href="#38009672">parent</a><span>|</span><a href="#38010165">prev</a><span>|</span><a href="#38009441">next</a><span>|</span><label class="collapse" for="c-38009789">[-]</label><label class="expand" for="c-38009789">[1 more]</label></div><br/><div class="children"><div class="content">blender is also one of those where order matters. »Oh, you want me to render <i>after</i> loading the file, then you should have told me«</div><br/></div></div></div></div><div id="38009441" class="c"><input type="checkbox" id="c-38009441" checked=""/><div class="controls bullet"><span class="by">hiAndrewQuinn</span><span>|</span><a href="#38009672">prev</a><span>|</span><a href="#38009446">next</a><span>|</span><label class="collapse" for="c-38009441">[-]</label><label class="expand" for="c-38009441">[1 more]</label></div><br/><div class="children"><div class="content">I build little CLI tools in Python non-stop. ChatGPT and some basic knowledge of how the `click` library works has made it almost completely trivial to get the ball rolling for whatever need I have for it, `--help` text included.<p>The fact that the barrier for creation is so low means I&#x27;m even willing to do them to solve very niche problems in generalizable ways. [1] is common enough that a few people have starred it. [2] is niche enough that other Anki folks haven&#x27;t used it AFAICT. [3] is likely something I&#x27;ll never personally need again, even though Azure VM reservations not letting you customize your reminders for when they&#x27;re about to expire is probably a costly mistake for a great many firms.<p>All started with this same starting methodology, because what I wanted was <i>just</i> a little too fiddly to want to hack together with my shell toolkit.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;finstem">https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;finstem</a><p>[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;table2anki">https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;table2anki</a><p>[3]: <a href="https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;AzureReservations2ICS">https:&#x2F;&#x2F;github.com&#x2F;hiAndrewQuinn&#x2F;AzureReservations2ICS</a></div><br/></div></div><div id="38009446" class="c"><input type="checkbox" id="c-38009446" checked=""/><div class="controls bullet"><span class="by">jdoss</span><span>|</span><a href="#38009441">prev</a><span>|</span><a href="#38009345">next</a><span>|</span><label class="collapse" for="c-38009446">[-]</label><label class="expand" for="c-38009446">[2 more]</label></div><br/><div class="children"><div class="content">I have been using Typer on every one of my CLI projects which uses Click under the hood. The documentation is fantastic, the CLI app it produces looks great and Typer lets you create things quickly. I high recommend it.<p><a href="https:&#x2F;&#x2F;typer.tiangolo.com&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;typer.tiangolo.com&#x2F;</a></div><br/><div id="38009452" class="c"><input type="checkbox" id="c-38009452" checked=""/><div class="controls bullet"><span class="by">hiAndrewQuinn</span><span>|</span><a href="#38009446">parent</a><span>|</span><a href="#38009345">next</a><span>|</span><label class="collapse" for="c-38009452">[-]</label><label class="expand" for="c-38009452">[1 more]</label></div><br/><div class="children"><div class="content">I didn&#x27;t know it used Click under the hood. That&#x27;s really good to know!</div><br/></div></div></div></div><div id="38009345" class="c"><input type="checkbox" id="c-38009345" checked=""/><div class="controls bullet"><span class="by">wedn3sday</span><span>|</span><a href="#38009446">prev</a><span>|</span><a href="#38009464">next</a><span>|</span><label class="collapse" for="c-38009345">[-]</label><label class="expand" for="c-38009345">[3 more]</label></div><br/><div class="children"><div class="content">&gt;&gt; Flags with single character shortcuts can be easily combined—symbex -in fetch_data is short for symbex --imports --no-file fetch_data for example.<p>I pretty much use argparse for making all my CLI tools, but I dont know of an easy way of doing this single character flag thing. Is it possible&#x2F;easy with argparse?</div><br/><div id="38009436" class="c"><input type="checkbox" id="c-38009436" checked=""/><div class="controls bullet"><span class="by">jmholla</span><span>|</span><a href="#38009345">parent</a><span>|</span><a href="#38009421">next</a><span>|</span><label class="collapse" for="c-38009436">[-]</label><label class="expand" for="c-38009436">[1 more]</label></div><br/><div class="children"><div class="content">`argparse` does it by default:<p><pre><code>    &gt;&gt;&gt; import argparse
    &gt;&gt;&gt; p = argparse.ArgumentParser()
    &gt;&gt;&gt; p.add_argument(&quot;--foo&quot;, &quot;-f&quot;, action=&quot;store_true&quot;)
    &gt;&gt;&gt; p.add_argument(&quot;--bar&quot;, &quot;-b&quot;)
    &gt;&gt;&gt; p.parse_args([&quot;-fb&quot;, &quot;baz&quot;])
    Namespace(foo=True, bar=&#x27;baz&#x27;)</code></pre></div><br/></div></div><div id="38009421" class="c"><input type="checkbox" id="c-38009421" checked=""/><div class="controls bullet"><span class="by">m463</span><span>|</span><a href="#38009345">parent</a><span>|</span><a href="#38009436">prev</a><span>|</span><a href="#38009464">next</a><span>|</span><label class="collapse" for="c-38009421">[-]</label><label class="expand" for="c-38009421">[1 more]</label></div><br/><div class="children"><div class="content">I use argparse too, and it&#x27;s one of the best python libraries (and my most-used)<p>you can do short (one character) or long arguments with argparse directly:<p><pre><code>  parser = argparse.ArgumentParser(argument_default=None)
  parser.add_argument(&#x27;-d&#x27;, &#x27;--debug&#x27;, action=&#x27;store_true&#x27;, help=&#x27;debug flag&#x27;)
</code></pre>
I also do lots of other things, like long help with no args like this:<p><pre><code>  if len(sys.argv) == 1:
      parser.print_help(sys.stderr)
      sys.exit(1)</code></pre></div><br/></div></div></div></div><div id="38009464" class="c"><input type="checkbox" id="c-38009464" checked=""/><div class="controls bullet"><span class="by">stevenrj</span><span>|</span><a href="#38009345">prev</a><span>|</span><a href="#38009483">next</a><span>|</span><label class="collapse" for="c-38009464">[-]</label><label class="expand" for="c-38009464">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been using docopt to handle CLI arguments for years now.<p><a href="http:&#x2F;&#x2F;docopt.org&#x2F;" rel="nofollow noreferrer">http:&#x2F;&#x2F;docopt.org&#x2F;</a></div><br/><div id="38009796" class="c"><input type="checkbox" id="c-38009796" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#38009464">parent</a><span>|</span><a href="#38009483">next</a><span>|</span><label class="collapse" for="c-38009796">[-]</label><label class="expand" for="c-38009796">[1 more]</label></div><br/><div class="children"><div class="content">This is my pick. Self documenting code ftw!</div><br/></div></div></div></div><div id="38009483" class="c"><input type="checkbox" id="c-38009483" checked=""/><div class="controls bullet"><span class="by">spearo77</span><span>|</span><a href="#38009464">prev</a><span>|</span><a href="#38009890">next</a><span>|</span><label class="collapse" for="c-38009483">[-]</label><label class="expand" for="c-38009483">[3 more]</label></div><br/><div class="children"><div class="content">The folks at Textualize have taken it one step further with <a href="https:&#x2F;&#x2F;github.com&#x2F;Textualize&#x2F;trogon">https:&#x2F;&#x2F;github.com&#x2F;Textualize&#x2F;trogon</a><p>It&#x27;s a neat way to make powerful CLIs more accessible to less-technical users.</div><br/><div id="38009518" class="c"><input type="checkbox" id="c-38009518" checked=""/><div class="controls bullet"><span class="by">renewiltord</span><span>|</span><a href="#38009483">parent</a><span>|</span><a href="#38009537">next</a><span>|</span><label class="collapse" for="c-38009518">[-]</label><label class="expand" for="c-38009518">[1 more]</label></div><br/><div class="children"><div class="content">This rules. Thank you for sharing!</div><br/></div></div></div></div><div id="38009890" class="c"><input type="checkbox" id="c-38009890" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#38009483">prev</a><span>|</span><a href="#38009768">next</a><span>|</span><label class="collapse" for="c-38009890">[-]</label><label class="expand" for="c-38009890">[11 more]</label></div><br/><div class="children"><div class="content">Is there a way to compile a python CLI script, and it’s dependencies and python itself into an executable.<p>That makes the tool nicer to use. To me a CLI tool should stand alone ideally. Obviously that is not the trend as many things that are CLI are installed via node or npm.<p>I guess docker could solve most of the issues here</div><br/><div id="38009977" class="c"><input type="checkbox" id="c-38009977" checked=""/><div class="controls bullet"><span class="by">zinodaur</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38010106">next</a><span>|</span><label class="collapse" for="c-38009977">[-]</label><label class="expand" for="c-38009977">[1 more]</label></div><br/><div class="children"><div class="content">Yeah! pyinstaller is an example. They do it by bundling a standalone python interpreter (x-platform ones too) with the necessary python libraries bundled in, just like you suggested</div><br/></div></div><div id="38010106" class="c"><input type="checkbox" id="c-38010106" checked=""/><div class="controls bullet"><span class="by">archargelod</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38009977">prev</a><span>|</span><a href="#38009996">next</a><span>|</span><label class="collapse" for="c-38010106">[-]</label><label class="expand" for="c-38010106">[1 more]</label></div><br/><div class="children"><div class="content">You better off with using a compiled language.<p>If you interested in a language that&#x27;s compiled, fast, but as easy and pleasant as Python - I&#x27;d recommend you take a look at Nim: <a href="https:&#x2F;&#x2F;nim-lang.org" rel="nofollow noreferrer">https:&#x2F;&#x2F;nim-lang.org</a>.<p>Nim has cligen library to generate and parse arguments: <a href="https:&#x2F;&#x2F;github.com&#x2F;c-blake&#x2F;cligen">https:&#x2F;&#x2F;github.com&#x2F;c-blake&#x2F;cligen</a><p>And to prove what Nim&#x27;s capable of - here&#x27;s a cool repo with 100+ cli apps cligen author wrote in Nim: <a href="https:&#x2F;&#x2F;github.com&#x2F;c-blake&#x2F;bu">https:&#x2F;&#x2F;github.com&#x2F;c-blake&#x2F;bu</a></div><br/></div></div><div id="38009996" class="c"><input type="checkbox" id="c-38009996" checked=""/><div class="controls bullet"><span class="by">xavdid</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38010106">prev</a><span>|</span><a href="#38009986">next</a><span>|</span><label class="collapse" for="c-38009996">[-]</label><label class="expand" for="c-38009996">[4 more]</label></div><br/><div class="children"><div class="content">I recommend pipx (<a href="https:&#x2F;&#x2F;pypa.github.io&#x2F;pipx&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;pypa.github.io&#x2F;pipx&#x2F;</a>) for this to get the same basic result. While it&#x27;s not a pre-compiled binary, it <i>is</i> a standalone installation that takes care of dependencies and virtual virtual environments in a way that the user never has to think about them. As far as they&#x27;re concerned, they `pipx install ...` and it &quot;just works&quot;.</div><br/><div id="38010133" class="c"><input type="checkbox" id="c-38010133" checked=""/><div class="controls bullet"><span class="by">zuck_vs_musk</span><span>|</span><a href="#38009890">root</a><span>|</span><a href="#38009996">parent</a><span>|</span><a href="#38009986">next</a><span>|</span><label class="collapse" for="c-38010133">[-]</label><label class="expand" for="c-38010133">[3 more]</label></div><br/><div class="children"><div class="content">What if you are on Python 3.10 and the Python code was built using Python 3.11 features?
I don&#x27;t think `pipx` would work in that case.</div><br/><div id="38010479" class="c"><input type="checkbox" id="c-38010479" checked=""/><div class="controls bullet"><span class="by">tspng</span><span>|</span><a href="#38009890">root</a><span>|</span><a href="#38010133">parent</a><span>|</span><a href="#38010188">next</a><span>|</span><label class="collapse" for="c-38010479">[-]</label><label class="expand" for="c-38010479">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;d need to install 3.11 first.
When installing a package with pipx you can specify what other Python installation to use, if it&#x27;s not the default one.</div><br/></div></div><div id="38010188" class="c"><input type="checkbox" id="c-38010188" checked=""/><div class="controls bullet"><span class="by">xavdid</span><span>|</span><a href="#38009890">root</a><span>|</span><a href="#38010133">parent</a><span>|</span><a href="#38010479">prev</a><span>|</span><a href="#38009986">next</a><span>|</span><label class="collapse" for="c-38010188">[-]</label><label class="expand" for="c-38010188">[1 more]</label></div><br/><div class="children"><div class="content">IIRC pipx uses your local Python version. So in your example, you&#x27;d need to `pipx install` while py 3.11 was active.<p>Certainly not ideal, but I find it&#x27;s unusual for a tool to require a super-new version. Plus, `pyenv` makes it easy enough to install multiple versions in parallel and run commands under specific versions.<p>Sure, it would be better if this whole process wasn&#x27;t so complicated, but I find it&#x27;s pretty workable overall.</div><br/></div></div></div></div></div></div><div id="38009986" class="c"><input type="checkbox" id="c-38009986" checked=""/><div class="controls bullet"><span class="by">raffraffraff</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38009996">prev</a><span>|</span><a href="#38009929">next</a><span>|</span><label class="collapse" for="c-38009986">[-]</label><label class="expand" for="c-38009986">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s the main reason for Go&#x27;s popularity imho. I loved the fact that all the Hashicorp stuff i used (consul, packer, vault, terraform) were just binaries.</div><br/></div></div><div id="38009929" class="c"><input type="checkbox" id="c-38009929" checked=""/><div class="controls bullet"><span class="by">tgmux</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38009986">prev</a><span>|</span><a href="#38010295">next</a><span>|</span><label class="collapse" for="c-38009929">[-]</label><label class="expand" for="c-38009929">[1 more]</label></div><br/><div class="children"><div class="content">Containers are the strategy I&#x27;ve used in the past for this purpose. For my needs, I&#x27;ve found any extra runtime to be negligible.</div><br/></div></div><div id="38010295" class="c"><input type="checkbox" id="c-38010295" checked=""/><div class="controls bullet"><span class="by">crabbone</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38009929">prev</a><span>|</span><a href="#38009913">next</a><span>|</span><label class="collapse" for="c-38010295">[-]</label><label class="expand" for="c-38010295">[1 more]</label></div><br/><div class="children"><div class="content">The answer is &quot;sometimes&quot;.<p>Python can be relatively easily embedded in a C program and its source code can be compiled to C.  The problems come from Python modules that are built to use shared libraries.  It&#x27;s not impossible to solve, but it means that you&#x27;d have to find the source code for those modules and recompile them to link statically with those libraries.  This could be quite an undertaking, and is probably not worth it, unless you want to learn more about build systems and build tools in general.<p>Finally, in some cases it&#x27;s impossible due to the licensing.  I.e. you may have a Python module that relies on a shared library with license that prohibits redistribution.  In that case it&#x27;s not a technical, but a legal problem.  This, however, isn&#x27;t unique to Python, and you&#x27;d face similar issues no matter the language you chose to use.<p>Re&#x27; Docker: in most cases this is not a solution to making command-line interfaces.  I actually struggle to think in what case it is.  You&#x27;d have to write a program with the command-line interface and then put it in the image for Docker to create a container from (which will usually make it very inconvenient to use due to the Docker containers by default running such programs in separate filesystem, user and network interfaces.)  This would make things like user identity, user&#x27;s data and, well, obviously, network hard to access for the program while gaining you noting of substance.</div><br/></div></div><div id="38009913" class="c"><input type="checkbox" id="c-38009913" checked=""/><div class="controls bullet"><span class="by">synthos</span><span>|</span><a href="#38009890">parent</a><span>|</span><a href="#38010295">prev</a><span>|</span><a href="#38009768">next</a><span>|</span><label class="collapse" for="c-38009913">[-]</label><label class="expand" for="c-38009913">[1 more]</label></div><br/><div class="children"><div class="content">Maybe one day, Mojo</div><br/></div></div></div></div><div id="38009768" class="c"><input type="checkbox" id="c-38009768" checked=""/><div class="controls bullet"><span class="by">ArcHound</span><span>|</span><a href="#38009890">prev</a><span>|</span><a href="#38009540">next</a><span>|</span><label class="collapse" for="c-38009768">[-]</label><label class="expand" for="c-38009768">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve came to the same conclusion as the author some time ago, my cookiecutter template is more opinionated <a href="https:&#x2F;&#x2F;github.com&#x2F;ArcHound&#x2F;python_script_cc">https:&#x2F;&#x2F;github.com&#x2F;ArcHound&#x2F;python_script_cc</a> . Best for use-cases when you need to do some automated API calls. Will checkout Typer and Textualize too, thanks HN!</div><br/></div></div><div id="38009540" class="c"><input type="checkbox" id="c-38009540" checked=""/><div class="controls bullet"><span class="by">jackblemming</span><span>|</span><a href="#38009768">prev</a><span>|</span><a href="#38009487">next</a><span>|</span><label class="collapse" for="c-38009540">[-]</label><label class="expand" for="c-38009540">[1 more]</label></div><br/><div class="children"><div class="content">Simon is a well of knowledge and good advice!</div><br/></div></div><div id="38009487" class="c"><input type="checkbox" id="c-38009487" checked=""/><div class="controls bullet"><span class="by">thowafasdflkj</span><span>|</span><a href="#38009540">prev</a><span>|</span><a href="#38010109">next</a><span>|</span><label class="collapse" for="c-38009487">[-]</label><label class="expand" for="c-38009487">[1 more]</label></div><br/><div class="children"><div class="content">I use clap and embed cpython</div><br/></div></div><div id="38010109" class="c"><input type="checkbox" id="c-38010109" checked=""/><div class="controls bullet"><span class="by">crabbone</span><span>|</span><a href="#38009487">prev</a><span>|</span><label class="collapse" for="c-38010109">[-]</label><label class="expand" for="c-38010109">[1 more]</label></div><br/><div class="children"><div class="content">Saw &quot;Click&quot; being used.  Didn&#x27;t read further.  This is worthless.<p>For those who don&#x27;t know.  Python has argsparse package that ships with every Python distribution.  It&#x27;s much better in terms of organizing command-line arguments, easier to debug, easier to extend (which is very rarely necessary).<p>Click is a third-party dependency.  It&#x27;s not solving any real problems.  It&#x27;s not like argsparse had a problem and Click came to solve those.  It&#x27;s just that author had too much spare time on their hands and decided to learn how to do something new.  The author made some rooky mistakes along the way.  He totally misunderstood how locales and encodings work and for a while Click was a source of errors related to that.  Maybe still is, but fewer packages are using it? -- I don&#x27;t know.<p>If anyone chooses to use Click over argsparse, it only means lack of research.  Following fads w&#x2F;o any sort of independent thinking.  Not someone I&#x27;d encourage to take advice from.</div><br/></div></div></div></div></div></div></div></body></html>