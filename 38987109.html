<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1705222856642" as="style"/><link rel="stylesheet" href="styles.css?v=1705222856642"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://gist.github.com/adtac/595b5823ef73b329167b815757bbce9f">Show HN: #!/usr/bin/env docker run</a> <span class="domain">(<a href="https://gist.github.com">gist.github.com</a>)</span></div><div class="subtext"><span>adtac</span> | <span>75 comments</span></div><br/><div><div id="38988696" class="c"><input type="checkbox" id="c-38988696" checked=""/><div class="controls bullet"><span class="by">jcul</span><span>|</span><a href="#38987388">next</a><span>|</span><label class="collapse" for="c-38988696">[-]</label><label class="expand" for="c-38988696">[1 more]</label></div><br/><div class="children"><div class="content">Reminds me of the &quot;self consuming script pattern&quot;.
Seen in this super user answer.<p><a href="https:&#x2F;&#x2F;superuser.com&#x2F;a&#x2F;440059" rel="nofollow">https:&#x2F;&#x2F;superuser.com&#x2F;a&#x2F;440059</a><p>It embeds an awk (or any interpreter) script, and uses sed to cut out the script between tags in $0.<p>I agree with other comments that this kind of thing can get messy, but sometimes it makes a lot of sense and let&#x27;s you share a single file.</div><br/></div></div><div id="38987388" class="c"><input type="checkbox" id="c-38987388" checked=""/><div class="controls bullet"><span class="by">pushedx</span><span>|</span><a href="#38988696">prev</a><span>|</span><a href="#38987688">next</a><span>|</span><label class="collapse" for="c-38987388">[-]</label><label class="expand" for="c-38987388">[26 more]</label></div><br/><div class="children"><div class="content">The readme compares it to the cross-architecture Cosmopolitan libc, but Docker is anything but cross-platform. On any other platform besides Linux it requires a Linux VM.<p>Linux containers are great (and I run Linux as my desktop OS), just pointing out the not-so-efficient nature of considering this cross-platform.</div><br/><div id="38987543" class="c"><input type="checkbox" id="c-38987543" checked=""/><div class="controls bullet"><span class="by">doctorpangloss</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38987543">[-]</label><label class="expand" for="c-38987543">[12 more]</label></div><br/><div class="children"><div class="content">OCI image manifests can specify platforms and architectures. From the end user’s point of view it can be all the same invocation.<p>Docker natively supports Windows, and it is low lift to make native Windows images for many common programming environments.<p>Does anyone use it? No not really. It makes a lot of sense if you need Windows stack stuff that is superior to Linux, like DirectX, but maybe not so much for regular applications.<p>There is also macOS containers, a project that has a decent proof of concept of a containerd fork that runs macOS container images. In principle there is a shorter path of work for so called host process containers, but fully isolated exists for macOS, it could work with e.g. Kubernetes, and people want it and it makes sense, and it sort of does exist.<p>The difference between cross-platform and “cross-platform” as you’re talking about it is really having some absolutely gigantic company, like Amazon or Google, literally top 10 in the world, putting this stuff into a social media zeitgeist.</div><br/><div id="38987768" class="c"><input type="checkbox" id="c-38987768" checked=""/><div class="controls bullet"><span class="by">cowboyscott</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987543">parent</a><span>|</span><a href="#38988285">next</a><span>|</span><label class="collapse" for="c-38987768">[-]</label><label class="expand" for="c-38987768">[3 more]</label></div><br/><div class="children"><div class="content">I really like what this script is doing - it&#x27;s specifying system level dependencies, a database schema, an interpreter, the code that runs on that interpreter, the data (on disk!) required by that code, and an invocation to execute the code all in one script. That&#x27;s amazing, and this is an excellent model for sharing a stand alone applications with non-trivial dependencies!<p>However, Docker is an OS-level virtualization. Docker natively supports Windows in the sense that there is a native app. That native app spins up Linux virtual machines, so the container is &quot;native&quot; to my Intel CPU with their virtualization extensions, but it is not native to Windows. I use it, which I say with no animus toward your original message.<p>edit: I was ignorant of native windows containers. I&#x27;m old and my brain still maps docker to lxc I guess. Apologies to OP - the DirectX line should have caught my attention.</div><br/><div id="38987839" class="c"><input type="checkbox" id="c-38987839" checked=""/><div class="controls bullet"><span class="by">cpuguy83</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987768">parent</a><span>|</span><a href="#38988285">next</a><span>|</span><label class="collapse" for="c-38987839">[-]</label><label class="expand" for="c-38987839">[2 more]</label></div><br/><div class="children"><div class="content">No, Docker supports native Windows containers.<p>Docker Desktop aims to provide the same experience across Mac and Windows and as such those use Linux VM&#x27;s, yes. However Docker most definitely supports Windows containers.</div><br/><div id="38987921" class="c"><input type="checkbox" id="c-38987921" checked=""/><div class="controls bullet"><span class="by">cowboyscott</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987839">parent</a><span>|</span><a href="#38988285">next</a><span>|</span><label class="collapse" for="c-38987921">[-]</label><label class="expand" for="c-38987921">[1 more]</label></div><br/><div class="children"><div class="content">Sorry, that&#x27;s right. You can probably guess that all of my Windows Docker use is with Linux images. This particular script wouldn&#x27;t work as there is no node image for a native windows host (unless there is? again, I&#x27;m ignorant of native windows containers).</div><br/></div></div></div></div></div></div><div id="38988205" class="c"><input type="checkbox" id="c-38988205" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987543">parent</a><span>|</span><a href="#38988285">prev</a><span>|</span><a href="#38987642">next</a><span>|</span><label class="collapse" for="c-38988205">[-]</label><label class="expand" for="c-38988205">[1 more]</label></div><br/><div class="children"><div class="content">Plenty of Windows shops use Windows containers, from my side you can count with 5 projects delivered into production using Windows Containers.<p>Many App deployments in Azure also use Windows containers.</div><br/></div></div><div id="38987642" class="c"><input type="checkbox" id="c-38987642" checked=""/><div class="controls bullet"><span class="by">tomjen3</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987543">parent</a><span>|</span><a href="#38988205">prev</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38987642">[-]</label><label class="expand" for="c-38987642">[6 more]</label></div><br/><div class="children"><div class="content">The main problem, I think, with Windows containers is that they are only really supported on Windows Server - which most developers don&#x27;t have access to.<p>You can run them through Docker Desktop, but then why not just run the same containers you will be deploying on you server (which is most likely going to be linux based?).<p>I would love for MS to make containers the way to deploy programs to Windows, but that requires them to make the runtime part of the default install and to make it available on all the OSs.</div><br/><div id="38987711" class="c"><input type="checkbox" id="c-38987711" checked=""/><div class="controls bullet"><span class="by">doctorpangloss</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987642">parent</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38987711">[-]</label><label class="expand" for="c-38987711">[5 more]</label></div><br/><div class="children"><div class="content">Windows 2022 containers work on Windows 11. Docker Desktop uses a shim for Windows containers. “dockerd” a single binary for Windows statically compiled is all you need to run Windows containers with the familiar Docker commands, you could also use PowerShell.<p>They are supported all the same. IMO the main issue is that this feature is poorly marketed.</div><br/><div id="38988180" class="c"><input type="checkbox" id="c-38988180" checked=""/><div class="controls bullet"><span class="by">gnatolf</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987711">parent</a><span>|</span><a href="#38988163">next</a><span>|</span><label class="collapse" for="c-38988180">[-]</label><label class="expand" for="c-38988180">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t this still the Windows Server images only? Can I expect everything to run that would run on win 10, 11 and&#x2F;or server?</div><br/></div></div><div id="38988163" class="c"><input type="checkbox" id="c-38988163" checked=""/><div class="controls bullet"><span class="by">tomjen3</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987711">parent</a><span>|</span><a href="#38988180">prev</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38988163">[-]</label><label class="expand" for="c-38988163">[3 more]</label></div><br/><div class="children"><div class="content">Its extremely poorly marketed, since I looked up the MS documentation when I wrote that comment and it only still only said windows server.<p>Still unless it works on Win10 home, it won&#x27;t be the default way to install software for windows - which sucks, since its a better way than the current one.</div><br/><div id="38988237" class="c"><input type="checkbox" id="c-38988237" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38988163">parent</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38988237">[-]</label><label class="expand" for="c-38988237">[2 more]</label></div><br/><div class="children"><div class="content">Software delivered via Windows store, specially if packaged with MSIX already uses containers.<p>Windows containers are supported in Windows Professional as well.<p>Maybe it is because I spend most of my time as Windows developer, this wasn&#x27;t hard to find,<p>&gt; One physical computer system running Windows 10 or 11 Professional or Enterprise with Anniversary Update (version 1607) or later.<p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscontainers&#x2F;quick-start&#x2F;set-up-environment?tabs=dockerce#windows-10-and-11" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscont...</a></div><br/><div id="38988501" class="c"><input type="checkbox" id="c-38988501" checked=""/><div class="controls bullet"><span class="by">tomjen3</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38988237">parent</a><span>|</span><a href="#38988261">next</a><span>|</span><label class="collapse" for="c-38988501">[-]</label><label class="expand" for="c-38988501">[1 more]</label></div><br/><div class="children"><div class="content">It does further down say that you need a windows server even for development purposes.<p>What I missed was that it only applied to windows server images.<p>Also the exception only seems to apply for development and testing services and, for some reason, only a physical computer.<p>Regardless, I was clearly wrong: it is possible, just not well documented.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38988261" class="c"><input type="checkbox" id="c-38988261" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38987543">prev</a><span>|</span><a href="#38987504">next</a><span>|</span><label class="collapse" for="c-38988261">[-]</label><label class="expand" for="c-38988261">[1 more]</label></div><br/><div class="children"><div class="content">As a curiosity, there&#x27;s also such a thing as Windows Docker containers, see eg <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscontainers&#x2F;quick-start&#x2F;run-your-first-container" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscont...</a></div><br/></div></div><div id="38987504" class="c"><input type="checkbox" id="c-38987504" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38988261">prev</a><span>|</span><a href="#38988202">next</a><span>|</span><label class="collapse" for="c-38987504">[-]</label><label class="expand" for="c-38987504">[4 more]</label></div><br/><div class="children"><div class="content">I explored the idea of using the scratch image with a cosmopolitan binary to get something more cross-architecture, but you need a shell to run those binaries. I&#x27;d love to see cross architecture Docker images, if someone else can figure out a trick to make it work.</div><br/><div id="38987593" class="c"><input type="checkbox" id="c-38987593" checked=""/><div class="controls bullet"><span class="by">alganet</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987504">parent</a><span>|</span><a href="#38987545">next</a><span>|</span><label class="collapse" for="c-38987593">[-]</label><label class="expand" for="c-38987593">[1 more]</label></div><br/><div class="children"><div class="content">Just use redbean and provide a init lua file. Or use a <a href="http:&#x2F;&#x2F;cosmo.zip" rel="nofollow">http:&#x2F;&#x2F;cosmo.zip</a> provided interpreter (like python, maybe even bash).<p>Each ape file is also a valid zip file. Add your dependencies as if the ape was an archive:<p><pre><code>    zip -ur myape.com mydependency.anything
</code></pre>
Also add a `.args` file:<p><pre><code>    zip -ur myape.com .args
</code></pre>
For this .args file, put one argument per line. This will run on start. You can use `&#x2F;zip&#x2F;mydepencency.anything` to read from files, but if you have an executable dependency you&#x27;ll need to extract it first (I use the host shell or host powershell for this).<p>You can do this with any software you can compile with comsocc, by adding a call to LoadZipArgs[1] in the main function.<p>It&#x27;s easy to get started, your ideas will branch out as soon as you start playing with it.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;master&#x2F;tool&#x2F;args&#x2F;args.c">https:&#x2F;&#x2F;github.com&#x2F;jart&#x2F;cosmopolitan&#x2F;blob&#x2F;master&#x2F;tool&#x2F;args&#x2F;a...</a></div><br/></div></div><div id="38987545" class="c"><input type="checkbox" id="c-38987545" checked=""/><div class="controls bullet"><span class="by">t0astbread</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987504">parent</a><span>|</span><a href="#38987593">prev</a><span>|</span><a href="#38988202">next</a><span>|</span><label class="collapse" for="c-38987545">[-]</label><label class="expand" for="c-38987545">[2 more]</label></div><br/><div class="children"><div class="content">I think parent was pointing out that you need Linux to run Docker (since it doesn&#x27;t run natively on any other OS) which is different from what Cosmopolitan provides.<p>Edit: Ok, apparently it natively supports Windows for Windows containers and for everything else there&#x27;s a Hyper-V integration. Not sure if you can write a portable Dockerfile script like that though.</div><br/><div id="38988249" class="c"><input type="checkbox" id="c-38988249" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987545">parent</a><span>|</span><a href="#38988202">next</a><span>|</span><label class="collapse" for="c-38988249">[-]</label><label class="expand" for="c-38988249">[1 more]</label></div><br/><div class="children"><div class="content">You surely can, I have Dockerfiles that do it.<p>It is a matter of having build parameters for base images and using programming languages that are mostly OS agnostic.</div><br/></div></div></div></div></div></div><div id="38988202" class="c"><input type="checkbox" id="c-38988202" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38987504">prev</a><span>|</span><a href="#38987528">next</a><span>|</span><label class="collapse" for="c-38988202">[-]</label><label class="expand" for="c-38988202">[1 more]</label></div><br/><div class="children"><div class="content">Not on Windows when using Windows containers.</div><br/></div></div><div id="38987528" class="c"><input type="checkbox" id="c-38987528" checked=""/><div class="controls bullet"><span class="by">erik_seaberg</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38988202">prev</a><span>|</span><a href="#38988111">next</a><span>|</span><label class="collapse" for="c-38987528">[-]</label><label class="expand" for="c-38987528">[2 more]</label></div><br/><div class="children"><div class="content">Doesn’t Cosmopolitan rely on QEMU to emulate an x86_64 CPU when running on any other platform?</div><br/><div id="38988002" class="c"><input type="checkbox" id="c-38988002" checked=""/><div class="controls bullet"><span class="by">HumanOstrich</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38987528">parent</a><span>|</span><a href="#38988111">next</a><span>|</span><label class="collapse" for="c-38988002">[-]</label><label class="expand" for="c-38988002">[1 more]</label></div><br/><div class="children"><div class="content">No</div><br/></div></div></div></div><div id="38988111" class="c"><input type="checkbox" id="c-38988111" checked=""/><div class="controls bullet"><span class="by">adastra22</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38987528">prev</a><span>|</span><a href="#38987881">next</a><span>|</span><label class="collapse" for="c-38988111">[-]</label><label class="expand" for="c-38988111">[3 more]</label></div><br/><div class="children"><div class="content">Doesn’t windows use WSL?</div><br/><div id="38988131" class="c"><input type="checkbox" id="c-38988131" checked=""/><div class="controls bullet"><span class="by">voxic11</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38988111">parent</a><span>|</span><a href="#38987881">next</a><span>|</span><label class="collapse" for="c-38988131">[-]</label><label class="expand" for="c-38988131">[2 more]</label></div><br/><div class="children"><div class="content">Not for windows containers. But no one really uses those anyways.</div><br/><div id="38988251" class="c"><input type="checkbox" id="c-38988251" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38987388">root</a><span>|</span><a href="#38988131">parent</a><span>|</span><a href="#38987881">next</a><span>|</span><label class="collapse" for="c-38988251">[-]</label><label class="expand" for="c-38988251">[1 more]</label></div><br/><div class="children"><div class="content">We use them.<p>Many Windows products, e.g. Sitecore, only support Windows containers.<p>Microsoft Store software relies on Windows containers infrastructure.<p>Windows containers make use of Windows jobs APIs.</div><br/></div></div></div></div></div></div><div id="38987592" class="c"><input type="checkbox" id="c-38987592" checked=""/><div class="controls bullet"><span class="by">riffic</span><span>|</span><a href="#38987388">parent</a><span>|</span><a href="#38987881">prev</a><span>|</span><a href="#38987688">next</a><span>|</span><label class="collapse" for="c-38987592">[-]</label><label class="expand" for="c-38987592">[1 more]</label></div><br/><div class="children"><div class="content">that&#x27;s not necessarily true</div><br/></div></div></div></div><div id="38987688" class="c"><input type="checkbox" id="c-38987688" checked=""/><div class="controls bullet"><span class="by">chubot</span><span>|</span><a href="#38987388">prev</a><span>|</span><a href="#38987335">next</a><span>|</span><label class="collapse" for="c-38987688">[-]</label><label class="expand" for="c-38987688">[11 more]</label></div><br/><div class="children"><div class="content">Something like this should definitely exist, just not with Docker!<p>Podman is better but it&#x27;s also a bit coupled to a distro - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38981844">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38981844</a><p>The problem is the Linux kernel container primitives are a bit of a mess<p>bubblewrap is a lot closer, although last I heard it&#x27;s not in some distros for security reasons - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30823164">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30823164</a></div><br/><div id="38987886" class="c"><input type="checkbox" id="c-38987886" checked=""/><div class="controls bullet"><span class="by">nickstinemates</span><span>|</span><a href="#38987688">parent</a><span>|</span><a href="#38987908">next</a><span>|</span><label class="collapse" for="c-38987886">[-]</label><label class="expand" for="c-38987886">[7 more]</label></div><br/><div class="children"><div class="content">another docker post filled with podman propaganda. despite it all, still no one uses it.</div><br/><div id="38988300" class="c"><input type="checkbox" id="c-38988300" checked=""/><div class="controls bullet"><span class="by">65a</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987886">parent</a><span>|</span><a href="#38987896">next</a><span>|</span><label class="collapse" for="c-38988300">[-]</label><label class="expand" for="c-38988300">[1 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t used docker since ~2017. My clusters run on cri-o, builds are with kaniko, and some of my systems just call runc with OCI container definitions. Docker (especially its API) is a giant mess, and the sooner it&#x27;s replaced by smaller tools and clear standards the better.</div><br/></div></div><div id="38987896" class="c"><input type="checkbox" id="c-38987896" checked=""/><div class="controls bullet"><span class="by">ekianjo</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987886">parent</a><span>|</span><a href="#38988300">prev</a><span>|</span><a href="#38987888">next</a><span>|</span><label class="collapse" for="c-38987896">[-]</label><label class="expand" for="c-38987896">[1 more]</label></div><br/><div class="children"><div class="content">Still a useful alternative to docker and can be packaged in distros</div><br/></div></div><div id="38987888" class="c"><input type="checkbox" id="c-38987888" checked=""/><div class="controls bullet"><span class="by">rtpg</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987886">parent</a><span>|</span><a href="#38987896">prev</a><span>|</span><a href="#38987908">next</a><span>|</span><label class="collapse" for="c-38987888">[-]</label><label class="expand" for="c-38987888">[4 more]</label></div><br/><div class="children"><div class="content">I mean I know several people who run their infra with podman. But it&#x27;s for personal things, I don&#x27;t know if there is any level of usage at the enterprise level.</div><br/><div id="38988144" class="c"><input type="checkbox" id="c-38988144" checked=""/><div class="controls bullet"><span class="by">oso2k</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987888">parent</a><span>|</span><a href="#38987947">next</a><span>|</span><label class="collapse" for="c-38988144">[-]</label><label class="expand" for="c-38988144">[1 more]</label></div><br/><div class="children"><div class="content">DISCLAIMER: I work for Red Hat.  I&#x27;m formerly an OpenShift Consultant and SA.<p>podman has underpinned our Kubernetes distribution, OpenShift, since 4.0 was released in 2019.  OpenShift is a $1B+ USD business for us (<a href="https:&#x2F;&#x2F;www.newsobserver.com&#x2F;news&#x2F;business&#x2F;article271678707.html" rel="nofollow">https:&#x2F;&#x2F;www.newsobserver.com&#x2F;news&#x2F;business&#x2F;article271678707....</a>).  You can search and see a sample of who uses it for Enterprise level business.</div><br/></div></div><div id="38987947" class="c"><input type="checkbox" id="c-38987947" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987888">parent</a><span>|</span><a href="#38988144">prev</a><span>|</span><a href="#38987908">next</a><span>|</span><label class="collapse" for="c-38987947">[-]</label><label class="expand" for="c-38987947">[2 more]</label></div><br/><div class="children"><div class="content">Not enterprise level, but I made a choice of deploying podman at $job rather than docker for a few reasons.</div><br/><div id="38988674" class="c"><input type="checkbox" id="c-38988674" checked=""/><div class="controls bullet"><span class="by">KAMSPioneer</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987947">parent</a><span>|</span><a href="#38987908">next</a><span>|</span><label class="collapse" for="c-38988674">[-]</label><label class="expand" for="c-38988674">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll chime in to say that I have started deploying podman over Docker where it&#x27;s frictionless at $job as well. I&#x27;d say half (or more) of my new container deploys are podman.<p>At home I use only podman because my tinkering doesn&#x27;t affect anyone but me.</div><br/></div></div></div></div></div></div></div></div><div id="38987908" class="c"><input type="checkbox" id="c-38987908" checked=""/><div class="controls bullet"><span class="by">a-dub</span><span>|</span><a href="#38987688">parent</a><span>|</span><a href="#38987886">prev</a><span>|</span><a href="#38988601">next</a><span>|</span><label class="collapse" for="c-38987908">[-]</label><label class="expand" for="c-38987908">[2 more]</label></div><br/><div class="children"><div class="content">i think the kernel primitives are fine, unshare and namespaces make perfect sense to me. docker, podman, buildah, buildx, whatever... all these things with cutesy names and fatal flaws seem like the mess to me.</div><br/><div id="38988201" class="c"><input type="checkbox" id="c-38988201" checked=""/><div class="controls bullet"><span class="by">ksjskskskkk</span><span>|</span><a href="#38987688">root</a><span>|</span><a href="#38987908">parent</a><span>|</span><a href="#38988601">next</a><span>|</span><label class="collapse" for="c-38988201">[-]</label><label class="expand" for="c-38988201">[1 more]</label></div><br/><div class="children"><div class="content">the feature IS the fatal flaw. after unsharing namespace you still want your network to &quot;just work&quot;. the &quot;quality&quot;of the solution is directly proportional to how bad the security is.<p>the scale is non virtualized qemu all the way to docker which will even screw your iptables rules for your convenience. hn crowd falling in the middle as the Goldie locks we all are.</div><br/></div></div></div></div><div id="38988601" class="c"><input type="checkbox" id="c-38988601" checked=""/><div class="controls bullet"><span class="by">orhmeh09</span><span>|</span><a href="#38987688">parent</a><span>|</span><a href="#38987908">prev</a><span>|</span><a href="#38987335">next</a><span>|</span><label class="collapse" for="c-38988601">[-]</label><label class="expand" for="c-38988601">[1 more]</label></div><br/><div class="children"><div class="content">No love for Apptainer&#x2F;Singularity?</div><br/></div></div></div></div><div id="38987335" class="c"><input type="checkbox" id="c-38987335" checked=""/><div class="controls bullet"><span class="by">tzury</span><span>|</span><a href="#38987688">prev</a><span>|</span><a href="#38987675">next</a><span>|</span><label class="collapse" for="c-38987335">[-]</label><label class="expand" for="c-38987335">[6 more]</label></div><br/><div class="children"><div class="content">As a rule, if you can write your code in a file, and run it as a script, it is better than writing scrolls between<p><pre><code>    &lt;&lt;EOF 
    …
    EOF
</code></pre>
The why is obvious.</div><br/><div id="38987419" class="c"><input type="checkbox" id="c-38987419" checked=""/><div class="controls bullet"><span class="by">jonahx</span><span>|</span><a href="#38987335">parent</a><span>|</span><a href="#38987605">next</a><span>|</span><label class="collapse" for="c-38987419">[-]</label><label class="expand" for="c-38987419">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not obvious to me that the benefits outweigh the benefits of a single, easily readable file.</div><br/><div id="38987759" class="c"><input type="checkbox" id="c-38987759" checked=""/><div class="controls bullet"><span class="by">d-z-m</span><span>|</span><a href="#38987335">root</a><span>|</span><a href="#38987419">parent</a><span>|</span><a href="#38987605">next</a><span>|</span><label class="collapse" for="c-38987759">[-]</label><label class="expand" for="c-38987759">[1 more]</label></div><br/><div class="children"><div class="content">Some would disagree that heredoc&#x27;ing your scripts makes them easily readable.</div><br/></div></div></div></div><div id="38987438" class="c"><input type="checkbox" id="c-38987438" checked=""/><div class="controls bullet"><span class="by">mattigames</span><span>|</span><a href="#38987335">parent</a><span>|</span><a href="#38987605">prev</a><span>|</span><a href="#38987675">next</a><span>|</span><label class="collapse" for="c-38987438">[-]</label><label class="expand" for="c-38987438">[2 more]</label></div><br/><div class="children"><div class="content">Some people like their personal full-programs inside a single-file, I think the appeal is that after opening you only have to keep scrolling to continue reading the other &quot;files&quot;, or that if you need to attach it to an email or something similar you are sure it has no dependency on other files, but yeah the trade-off is not worth it.</div><br/><div id="38987629" class="c"><input type="checkbox" id="c-38987629" checked=""/><div class="controls bullet"><span class="by">devoutsalsa</span><span>|</span><a href="#38987335">root</a><span>|</span><a href="#38987438">parent</a><span>|</span><a href="#38987675">next</a><span>|</span><label class="collapse" for="c-38987629">[-]</label><label class="expand" for="c-38987629">[1 more]</label></div><br/><div class="children"><div class="content">And keeping it one file means you&#x27;re reducing risk of a breaking change in the external script.</div><br/></div></div></div></div></div></div><div id="38987675" class="c"><input type="checkbox" id="c-38987675" checked=""/><div class="controls bullet"><span class="by">Kab1r</span><span>|</span><a href="#38987335">prev</a><span>|</span><a href="#38988530">next</a><span>|</span><label class="collapse" for="c-38987675">[-]</label><label class="expand" for="c-38987675">[3 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t POSIX compliant is it? I feel like I tried to do something different but trying to put arguments in a shebang and ran into trouble there a year or two ago.</div><br/><div id="38987849" class="c"><input type="checkbox" id="c-38987849" checked=""/><div class="controls bullet"><span class="by">cpuguy83</span><span>|</span><a href="#38987675">parent</a><span>|</span><a href="#38988333">next</a><span>|</span><label class="collapse" for="c-38987849">[-]</label><label class="expand" for="c-38987849">[1 more]</label></div><br/><div class="children"><div class="content">It depends on the version of &#x2F;usr&#x2F;bin&#x2F;env.</div><br/></div></div><div id="38988333" class="c"><input type="checkbox" id="c-38988333" checked=""/><div class="controls bullet"><span class="by">error9348</span><span>|</span><a href="#38987675">parent</a><span>|</span><a href="#38987849">prev</a><span>|</span><a href="#38988530">next</a><span>|</span><label class="collapse" for="c-38988333">[-]</label><label class="expand" for="c-38988333">[1 more]</label></div><br/><div class="children"><div class="content">Should be fine, you can even compile and run a C file using a shebang</div><br/></div></div></div></div><div id="38988530" class="c"><input type="checkbox" id="c-38988530" checked=""/><div class="controls bullet"><span class="by">WhyNotHugo</span><span>|</span><a href="#38987675">prev</a><span>|</span><a href="#38987420">next</a><span>|</span><label class="collapse" for="c-38988530">[-]</label><label class="expand" for="c-38988530">[3 more]</label></div><br/><div class="children"><div class="content">Using spaces in a shebang is not a standard thing and doesn’t work in most shells.</div><br/><div id="38988578" class="c"><input type="checkbox" id="c-38988578" checked=""/><div class="controls bullet"><span class="by">jstanley</span><span>|</span><a href="#38988530">parent</a><span>|</span><a href="#38988600">next</a><span>|</span><label class="collapse" for="c-38988578">[-]</label><label class="expand" for="c-38988578">[1 more]</label></div><br/><div class="children"><div class="content">The spaces are being handled by `env`:<p><pre><code>    $ env &quot;-S echo hello world&quot;
    hello world
</code></pre>
<a href="https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;coreutils&#x2F;manual&#x2F;html_node&#x2F;env-invocation.html#g_t_002dS_002f_002d_002dsplit_002dstring-usage-in-scripts" rel="nofollow">https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;coreutils&#x2F;manual&#x2F;html_node&#x2F;env-...</a></div><br/></div></div><div id="38988600" class="c"><input type="checkbox" id="c-38988600" checked=""/><div class="controls bullet"><span class="by">flakes</span><span>|</span><a href="#38988530">parent</a><span>|</span><a href="#38988578">prev</a><span>|</span><a href="#38987420">next</a><span>|</span><label class="collapse" for="c-38988600">[-]</label><label class="expand" for="c-38988600">[1 more]</label></div><br/><div class="children"><div class="content">Curious for what systems this does not work? I start a lot of my shebangs with `#!&#x2F;usr&#x2F;bin&#x2F;env &lt;app&gt;` such that I can rely on PATH for resolving application locations.</div><br/></div></div></div></div><div id="38987420" class="c"><input type="checkbox" id="c-38987420" checked=""/><div class="controls bullet"><span class="by">benatkin</span><span>|</span><a href="#38988530">prev</a><span>|</span><a href="#38988583">next</a><span>|</span><label class="collapse" for="c-38987420">[-]</label><label class="expand" for="c-38987420">[2 more]</label></div><br/><div class="children"><div class="content">I feel comfortable with fenced code blocks. Using heredocs all the time, not so much.<p><pre><code>    ```js title=&quot;&#x2F;root&#x2F;server.js&quot;
    console.log(&#x27;test&#x27;)
    ```
</code></pre>
or<p><pre><code>    `&#x2F;root&#x2F;server.js`

    ```js
    console.log(&#x27;test&#x27;)
    ```
</code></pre>
vs<p><pre><code>    RUN &lt;&lt;EOF cat &gt;&#x2F;root&#x2F;server.js
    console.log(&#x27;test&#x27;)
    EOF
</code></pre>
However the Markdown one is better if the syntax highlighting theme makes the code fence a color that doesn&#x27;t stick out - either monochrome or closer to the background color.</div><br/><div id="38987595" class="c"><input type="checkbox" id="c-38987595" checked=""/><div class="controls bullet"><span class="by">pushedx</span><span>|</span><a href="#38987420">parent</a><span>|</span><a href="#38988583">next</a><span>|</span><label class="collapse" for="c-38987595">[-]</label><label class="expand" for="c-38987595">[1 more]</label></div><br/><div class="children"><div class="content">The file is a Dockerfile with a shebang line that ignores the comments with a regex. Code fences would not be valid.<p>The point of this isn&#x27;t to share this code, it&#x27;s a demo of the clever shebang line.</div><br/></div></div></div></div><div id="38988583" class="c"><input type="checkbox" id="c-38988583" checked=""/><div class="controls bullet"><span class="by">kitd</span><span>|</span><a href="#38987420">prev</a><span>|</span><a href="#38987454">next</a><span>|</span><label class="collapse" for="c-38988583">[-]</label><label class="expand" for="c-38988583">[1 more]</label></div><br/><div class="children"><div class="content">For added excitement,  you could go the whole hog, and generate, build and run via docker compose. Apart from anything else, you wouldn&#x27;t need the 2-step build&amp;run.<p>I mean, you could. Whether you should, well ...</div><br/></div></div><div id="38987454" class="c"><input type="checkbox" id="c-38987454" checked=""/><div class="controls bullet"><span class="by">keepamovin</span><span>|</span><a href="#38988583">prev</a><span>|</span><a href="#38987655">next</a><span>|</span><label class="collapse" for="c-38987454">[-]</label><label class="expand" for="c-38987454">[1 more]</label></div><br/><div class="children"><div class="content">Can we figure out a way to throw an exec into the shebang so the Docker process replaces the bash One?</div><br/></div></div><div id="38987655" class="c"><input type="checkbox" id="c-38987655" checked=""/><div class="controls bullet"><span class="by">throwaway892238</span><span>|</span><a href="#38987454">prev</a><span>|</span><a href="#38987338">next</a><span>|</span><label class="collapse" for="c-38987655">[-]</label><label class="expand" for="c-38987655">[3 more]</label></div><br/><div class="children"><div class="content">Cute trick, but it&#x27;s not actually what the title claims.<p>Since this is actually <i>env</i> calling <i>bash</i> first, not docker, this should just be a Bash script. You can still feed the Dockerfile to <i>docker build</i> via STDIN. But you&#x27;d gain the ability to shellcheck the Bash, the code would be easier to read, write, maintain, add comments to, etc. You could keep the filename the same, run it the same way, etc. The way they&#x27;ve done it here is just unnecessarily difficult.</div><br/><div id="38987822" class="c"><input type="checkbox" id="c-38987822" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#38987655">parent</a><span>|</span><a href="#38988206">next</a><span>|</span><label class="collapse" for="c-38987822">[-]</label><label class="expand" for="c-38987822">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  You can still feed the Dockerfile to docker build via STDIN.<p>but you&#x27;d then have to work out how to &quot;filter out&quot; the bash commands inside this bash script to make it a valid docker file.<p>Unless of course, you entirely store the docker file contents inside heredocs. That works fine, but it&#x27;s not as &quot;cool&quot; as &quot;executing&quot; dockerfiles as a script.</div><br/></div></div><div id="38988206" class="c"><input type="checkbox" id="c-38988206" checked=""/><div class="controls bullet"><span class="by">notso411</span><span>|</span><a href="#38987655">parent</a><span>|</span><a href="#38987822">prev</a><span>|</span><a href="#38987338">next</a><span>|</span><label class="collapse" for="c-38988206">[-]</label><label class="expand" for="c-38988206">[1 more]</label></div><br/><div class="children"><div class="content">You can say it is wrong without being insufferably condescending</div><br/></div></div></div></div><div id="38987338" class="c"><input type="checkbox" id="c-38987338" checked=""/><div class="controls bullet"><span class="by">a_t48</span><span>|</span><a href="#38987655">prev</a><span>|</span><a href="#38988422">next</a><span>|</span><label class="collapse" for="c-38987338">[-]</label><label class="expand" for="c-38987338">[9 more]</label></div><br/><div class="children"><div class="content">That’s cute - though typically the docker images I build need supporting infra around them anyhow - I’d have to forward to the build script.</div><br/><div id="38987380" class="c"><input type="checkbox" id="c-38987380" checked=""/><div class="controls bullet"><span class="by">adtac</span><span>|</span><a href="#38987338">parent</a><span>|</span><a href="#38988422">next</a><span>|</span><label class="collapse" for="c-38987380">[-]</label><label class="expand" for="c-38987380">[8 more]</label></div><br/><div class="children"><div class="content">I&#x27;m probably getting banned for committing this war crime but have you considered a<p><pre><code>    #!&#x2F;usr&#x2F;bin&#x2F;env -S bash -c &quot;docker run --privileged ...&quot;

    FROM docker
    
    RUN &lt;&lt;EOF cat &gt;&#x2F;other.Dockerfile
      #!&#x2F;usr&#x2F;bin&#x2F;env -S bash -c &quot;docker run ...&quot;
      FROM debian:buster
    EOF
    RUN chmod +x &#x2F;other.Dockerfile
    
    CMD bash -c &quot;&#x2F;other.Dockerfile &amp;; .&#x2F;main&quot;</code></pre></div><br/><div id="38987474" class="c"><input type="checkbox" id="c-38987474" checked=""/><div class="controls bullet"><span class="by">a_t48</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987380">parent</a><span>|</span><a href="#38987392">next</a><span>|</span><label class="collapse" for="c-38987474">[-]</label><label class="expand" for="c-38987474">[3 more]</label></div><br/><div class="children"><div class="content">No, but that’s a fun idea. Most of my docker crimes involve working around the lack of REBASE or similar to transplant a layer from another stage. Instead I’m forced to abuse rsync.</div><br/><div id="38988702" class="c"><input type="checkbox" id="c-38988702" checked=""/><div class="controls bullet"><span class="by">efrecon</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987474">parent</a><span>|</span><a href="#38987536">next</a><span>|</span><label class="collapse" for="c-38988702">[-]</label><label class="expand" for="c-38988702">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve got that for rebasing: <a href="https:&#x2F;&#x2F;github.com&#x2F;efrecon&#x2F;docker-rebase">https:&#x2F;&#x2F;github.com&#x2F;efrecon&#x2F;docker-rebase</a></div><br/></div></div><div id="38987536" class="c"><input type="checkbox" id="c-38987536" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987474">parent</a><span>|</span><a href="#38988702">prev</a><span>|</span><a href="#38987392">next</a><span>|</span><label class="collapse" for="c-38987536">[-]</label><label class="expand" for="c-38987536">[1 more]</label></div><br/><div class="children"><div class="content">I use `COPY --from=image` to move data between images. Do you need some more advanced features of rsync?</div><br/></div></div></div></div><div id="38987392" class="c"><input type="checkbox" id="c-38987392" checked=""/><div class="controls bullet"><span class="by">asn1parse</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987380">parent</a><span>|</span><a href="#38987474">prev</a><span>|</span><a href="#38987443">next</a><span>|</span><label class="collapse" for="c-38987392">[-]</label><label class="expand" for="c-38987392">[3 more]</label></div><br/><div class="children"><div class="content">heck, why not toss in --net=host</div><br/><div id="38987444" class="c"><input type="checkbox" id="c-38987444" checked=""/><div class="controls bullet"><span class="by">bravetraveler</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987392">parent</a><span>|</span><a href="#38987455">next</a><span>|</span><label class="collapse" for="c-38987444">[-]</label><label class="expand" for="c-38987444">[1 more]</label></div><br/><div class="children"><div class="content">... and privileged, then make the entrypoint <i>&#x27;nsenter&#x27;</i> for PID 1</div><br/></div></div><div id="38987455" class="c"><input type="checkbox" id="c-38987455" checked=""/><div class="controls bullet"><span class="by">yonatan8070</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987392">parent</a><span>|</span><a href="#38987444">prev</a><span>|</span><a href="#38987443">next</a><span>|</span><label class="collapse" for="c-38987455">[-]</label><label class="expand" for="c-38987455">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    -v &#x2F;:&#x2F;sysroot</code></pre></div><br/></div></div></div></div><div id="38987443" class="c"><input type="checkbox" id="c-38987443" checked=""/><div class="controls bullet"><span class="by">ta988</span><span>|</span><a href="#38987338">root</a><span>|</span><a href="#38987380">parent</a><span>|</span><a href="#38987392">prev</a><span>|</span><a href="#38988422">next</a><span>|</span><label class="collapse" for="c-38987443">[-]</label><label class="expand" for="c-38987443">[1 more]</label></div><br/><div class="children"><div class="content">could you make it curl a script as well</div><br/></div></div></div></div></div></div><div id="38988422" class="c"><input type="checkbox" id="c-38988422" checked=""/><div class="controls bullet"><span class="by">forrestthewoods</span><span>|</span><a href="#38987338">prev</a><span>|</span><a href="#38987671">next</a><span>|</span><label class="collapse" for="c-38988422">[-]</label><label class="expand" for="c-38988422">[3 more]</label></div><br/><div class="children"><div class="content">Can someone explain what this is and what it does? I have no idea. I use Windows and have never needed to use Docker for anything.</div><br/><div id="38988509" class="c"><input type="checkbox" id="c-38988509" checked=""/><div class="controls bullet"><span class="by">maronato</span><span>|</span><a href="#38988422">parent</a><span>|</span><a href="#38988442">next</a><span>|</span><label class="collapse" for="c-38988509">[-]</label><label class="expand" for="c-38988509">[1 more]</label></div><br/><div class="children"><div class="content">It’s a Docker shebang.
Normally shebangs are used to define what shell to use when running a script, or in the case of a python script, to run it with “.&#x2F;myscript” instead of “python myscript.py”.<p>Here OP created a little hack for building and running a docker container by adding a shebang to a Dockerfile.<p>Usually it’s a two step process. You first use “docker build” to build the image and then “docker run” to create a container from it. With this little hack you just run “.&#x2F;Dockerfile” and it does both.<p>It’s cool, but not really useful for most people.</div><br/></div></div><div id="38988442" class="c"><input type="checkbox" id="c-38988442" checked=""/><div class="controls bullet"><span class="by">BossingAround</span><span>|</span><a href="#38988422">parent</a><span>|</span><a href="#38988509">prev</a><span>|</span><a href="#38987671">next</a><span>|</span><label class="collapse" for="c-38988442">[-]</label><label class="expand" for="c-38988442">[1 more]</label></div><br/><div class="children"><div class="content">It turns a Dockerfile into an executable script, so that by executing the Dockerfile, the shebang invokes docker to build and run the file.<p>Pretty neat if you&#x27;re using Dockerfiles, but also highly non-standard so you wouldn&#x27;t use it in your company repo (unless you want to increase the &quot;what-the-fuck&quot; level of your repo).<p>It&#x27;s more of a &quot;look, this is cool&quot; kind of a thing if you&#x27;re a Linux and container user.</div><br/></div></div></div></div><div id="38987671" class="c"><input type="checkbox" id="c-38987671" checked=""/><div class="controls bullet"><span class="by">IggleSniggle</span><span>|</span><a href="#38988422">prev</a><span>|</span><a href="#38987784">next</a><span>|</span><label class="collapse" for="c-38987671">[-]</label><label class="expand" for="c-38987671">[1 more]</label></div><br/><div class="children"><div class="content">I like how the last code line reads<p><pre><code>   ctx.stroke()</code></pre></div><br/></div></div><div id="38987784" class="c"><input type="checkbox" id="c-38987784" checked=""/><div class="controls bullet"><span class="by">renewiltord</span><span>|</span><a href="#38987671">prev</a><span>|</span><a href="#38987657">next</a><span>|</span><label class="collapse" for="c-38987784">[-]</label><label class="expand" for="c-38987784">[1 more]</label></div><br/><div class="children"><div class="content">Haha very clever. I like it. L</div><br/></div></div><div id="38987657" class="c"><input type="checkbox" id="c-38987657" checked=""/><div class="controls bullet"><span class="by">phone8675309</span><span>|</span><a href="#38987784">prev</a><span>|</span><label class="collapse" for="c-38987657">[-]</label><label class="expand" for="c-38987657">[3 more]</label></div><br/><div class="children"><div class="content">Is this webscale?</div><br/><div id="38988615" class="c"><input type="checkbox" id="c-38988615" checked=""/><div class="controls bullet"><span class="by">scrps</span><span>|</span><a href="#38987657">parent</a><span>|</span><a href="#38988282">next</a><span>|</span><label class="collapse" for="c-38988615">[-]</label><label class="expand" for="c-38988615">[1 more]</label></div><br/><div class="children"><div class="content">Is hyperscale.</div><br/></div></div><div id="38988282" class="c"><input type="checkbox" id="c-38988282" checked=""/><div class="controls bullet"><span class="by">mirekrusin</span><span>|</span><a href="#38987657">parent</a><span>|</span><a href="#38988615">prev</a><span>|</span><label class="collapse" for="c-38988282">[-]</label><label class="expand" for="c-38988282">[1 more]</label></div><br/><div class="children"><div class="content">It has web scales on it for sure.</div><br/></div></div></div></div></div></div></div></div></div></body></html>