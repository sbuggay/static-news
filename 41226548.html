<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1723626078522" as="style"/><link rel="stylesheet" href="styles.css?v=1723626078522"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.edgedb.com/blog/an-approach-to-optimizing-typescript-type-checking-performance#how-do-we-quantify-the-type-checker-s-workload">An approach to optimizing TypeScript type checking performance</a> <span class="domain">(<a href="https://www.edgedb.com">www.edgedb.com</a>)</span></div><div class="subtext"><span>beerose</span> | <span>20 comments</span></div><br/><div><div id="41243599" class="c"><input type="checkbox" id="c-41243599" checked=""/><div class="controls bullet"><span class="by">tarasglek</span><span>|</span><a href="#41243138">next</a><span>|</span><label class="collapse" for="c-41243599">[-]</label><label class="expand" for="c-41243599">[2 more]</label></div><br/><div class="children"><div class="content">I really wish to find ts tooling that would show me deltas in ts checker memory usage and tie them to diffs in ci</div><br/><div id="41243679" class="c"><input type="checkbox" id="c-41243679" checked=""/><div class="controls bullet"><span class="by">kevingadd</span><span>|</span><a href="#41243599">parent</a><span>|</span><a href="#41243138">next</a><span>|</span><label class="collapse" for="c-41243679">[-]</label><label class="expand" for="c-41243679">[1 more]</label></div><br/><div class="children"><div class="content">We accidentally had a regression slip into our TS once that made it take over 7 seconds to typecheck a file, and that was surprisingly painful to diagnose. It meant our CI builds were slower, our local builds were slower, and the language server (in VS code, sublime, etc) would just randomly go unresponsive while editing. If there were tooling to track deltas in that per-file we would have noticed it immediately.</div><br/></div></div></div></div><div id="41243138" class="c"><input type="checkbox" id="c-41243138" checked=""/><div class="controls bullet"><span class="by">codeflo</span><span>|</span><a href="#41243599">prev</a><span>|</span><label class="collapse" for="c-41243138">[-]</label><label class="expand" for="c-41243138">[17 more]</label></div><br/><div class="children"><div class="content">These days, TypeScript is effectively nothing more than a high-powered linter. The performance of this linter is so bad that we need to structure our code in a specific way so that we can still afford to run the linter.<p>Of the performance tips at the end, the interface vs. intersection type one is the suggestion I find the most annoying. That’s because it’s the most common pattern, and using interfaces is conceptually a lot less clean. It’s terrible that a linter effectively forces you into writing worse code.<p>I really wish the TypeScript team got their act together and fixed the performance of their linter <i>somehow</i>. Finding clever optimizations, porting to Go&#x2F;Rust, whatever is necessary. (3rd-party reimplementations won’t do: they’ll never catch up with a corporate-funded moving target.)</div><br/><div id="41244106" class="c"><input type="checkbox" id="c-41244106" checked=""/><div class="controls bullet"><span class="by">bk496</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243416">next</a><span>|</span><label class="collapse" for="c-41244106">[-]</label><label class="expand" for="c-41244106">[1 more]</label></div><br/><div class="children"><div class="content">There is a new type checker called Ezno that is written in Rust and is a lot faster [1].<p>I have been tracking PRs like [2] that change the definitions to better be optimised by V8. But the effects are only ~30% and not the 50x that might be achievable by native.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;kaleidawave&#x2F;ezno&#x2F;actions&#x2F;runs&#x2F;10299707325">https:&#x2F;&#x2F;github.com&#x2F;kaleidawave&#x2F;ezno&#x2F;actions&#x2F;runs&#x2F;10299707325</a>
[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;pull&#x2F;58928">https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;pull&#x2F;58928</a></div><br/></div></div><div id="41243416" class="c"><input type="checkbox" id="c-41243416" checked=""/><div class="controls bullet"><span class="by">rafaelmn</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41244106">prev</a><span>|</span><a href="#41243752">next</a><span>|</span><label class="collapse" for="c-41243416">[-]</label><label class="expand" for="c-41243416">[1 more]</label></div><br/><div class="children"><div class="content">&gt; These days, TypeScript is effectively nothing more than a high-powered linter.<p>That&#x27;s a bad take - typescript enables tooling like refactoring&#x2F;navigation&#x2F;completion that goes far above a linter. Development tools are just better with typescript vs JS.</div><br/></div></div><div id="41243752" class="c"><input type="checkbox" id="c-41243752" checked=""/><div class="controls bullet"><span class="by">bluepnume</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243416">prev</a><span>|</span><a href="#41243957">next</a><span>|</span><label class="collapse" for="c-41243752">[-]</label><label class="expand" for="c-41243752">[1 more]</label></div><br/><div class="children"><div class="content">At this point TS is a turing complete language.<p>Complaining that you have to tune it for performance is like complaining that your runtime code isn&#x27;t automatically maximally performant without a little tuning.</div><br/></div></div><div id="41243957" class="c"><input type="checkbox" id="c-41243957" checked=""/><div class="controls bullet"><span class="by">xboxnolifes</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243752">prev</a><span>|</span><a href="#41243267">next</a><span>|</span><label class="collapse" for="c-41243957">[-]</label><label class="expand" for="c-41243957">[1 more]</label></div><br/><div class="children"><div class="content">With such a broad definition of linter, wouldn&#x27;t the type systems of <i>all</i> statically typed languages just be high-powered linters?</div><br/></div></div><div id="41243267" class="c"><input type="checkbox" id="c-41243267" checked=""/><div class="controls bullet"><span class="by">rtpg</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243957">prev</a><span>|</span><a href="#41243235">next</a><span>|</span><label class="collapse" for="c-41243267">[-]</label><label class="expand" for="c-41243267">[4 more]</label></div><br/><div class="children"><div class="content">Complicated types are effectively little Prolog programs, doing a bunch of very useful and helpful checks to make sure that your code does what you expect it to.<p>I do wish that Typescript would offer some tools to make it more ergonomic to write performant unifying code (I kind of despise conditional types, especially when you then use it to create the partially valid types by resolving to never). But I think it would also be very helpful to get people to understand that your types are their own little program that run and have performance characteristics. It&#x27;s not magic!<p>There&#x27;s been some handwaving about performance not being due to it running in JS (because at the end of the day unification is unification is unification and it takes time), but looking at the Typescript codebase in general and poking at it, I can&#x27;t help but wonder how much of even the heavier stuff is &quot;death by 1000 cuts&quot; on that front.</div><br/><div id="41243363" class="c"><input type="checkbox" id="c-41243363" checked=""/><div class="controls bullet"><span class="by">vmfunction</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243267">parent</a><span>|</span><a href="#41243235">next</a><span>|</span><label class="collapse" for="c-41243363">[-]</label><label class="expand" for="c-41243363">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I do wish that Typescript would offer some tools to make it more ergonomic to write performant unifying code (I kind of despise conditional types<p>Maybe give <a href="https:&#x2F;&#x2F;gcanti.github.io&#x2F;fp-ts&#x2F;" rel="nofollow">https:&#x2F;&#x2F;gcanti.github.io&#x2F;fp-ts&#x2F;</a> a go?</div><br/><div id="41243632" class="c"><input type="checkbox" id="c-41243632" checked=""/><div class="controls bullet"><span class="by">rtpg</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243363">parent</a><span>|</span><a href="#41243235">next</a><span>|</span><label class="collapse" for="c-41243632">[-]</label><label class="expand" for="c-41243632">[2 more]</label></div><br/><div class="children"><div class="content">I use fp.ts quite a lot! I think it&#x27;s _extremely unfortunate_ that the API docs don&#x27;t include top-level examples for basically anything, though. So when people hit a problem that fp-ts or io-ts can solve, I have to basically write a disclaimer about the slight impenetrability before suggesting it.<p>I really think that TS itself should offer syntax more or less matching what that lib does at the type level, but this is a bit of a maximalist request.</div><br/><div id="41243748" class="c"><input type="checkbox" id="c-41243748" checked=""/><div class="controls bullet"><span class="by">epolanski</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243632">parent</a><span>|</span><a href="#41243235">next</a><span>|</span><label class="collapse" for="c-41243748">[-]</label><label class="expand" for="c-41243748">[1 more]</label></div><br/><div class="children"><div class="content">effect-ts is nowadays the de facto successor of fp-ts and has better docs.<p>As for fp-ts all APIs have examples&#x2F;tests that show their usage.</div><br/></div></div></div></div></div></div></div></div><div id="41243235" class="c"><input type="checkbox" id="c-41243235" checked=""/><div class="controls bullet"><span class="by">seanmcdirmid</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243267">prev</a><span>|</span><a href="#41243755">next</a><span>|</span><label class="collapse" for="c-41243235">[-]</label><label class="expand" for="c-41243235">[5 more]</label></div><br/><div class="children"><div class="content">Doesn’t the type checker have to run in JavaScript to fit into VS code? A C# implementation would be much faster, no need to go native with C++&#x2F;Rust (not sure speed in Go would really compete).<p>The big issue is dealing with a structural highly expressive type system, the language of implementation is only going to be a constant slow down (but that constant can be large).</div><br/><div id="41243402" class="c"><input type="checkbox" id="c-41243402" checked=""/><div class="controls bullet"><span class="by">Quothling</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243235">parent</a><span>|</span><a href="#41243384">next</a><span>|</span><label class="collapse" for="c-41243402">[-]</label><label class="expand" for="c-41243402">[3 more]</label></div><br/><div class="children"><div class="content">It depends on which typescript toolset you use, but generally speaking you&#x27;re probably riding on mix of C++ and Javascript if you&#x27;re using VSC. VSC itself uses C++ in it&#x27;s core components since that is how electron works. Similarly the language server and tooling for both Typescript and Node are build with C++. If you&#x27;re fancy and use Bun you&#x27;re running on Zig. Eslint itself runs on Javascript, but the parser it uses feeds it something called an abstract syntax tree, and different parsers will do this differently.<p>So the relatively simple answer would be no, it would not be faster with C# (or Go which would likely have a similar speed to C#).</div><br/><div id="41243445" class="c"><input type="checkbox" id="c-41243445" checked=""/><div class="controls bullet"><span class="by">seanmcdirmid</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243402">parent</a><span>|</span><a href="#41243384">next</a><span>|</span><label class="collapse" for="c-41243445">[-]</label><label class="expand" for="c-41243445">[2 more]</label></div><br/><div class="children"><div class="content">C# should be faster than JavaScript, at least, given all the optimization Microsoft puts into the CLR. But it might not be super portable. I’ve never seen the typescript type checker before, but I wouldn’t be surprised if it were in typescript, which is common as these things go.</div><br/><div id="41243604" class="c"><input type="checkbox" id="c-41243604" checked=""/><div class="controls bullet"><span class="by">troupo</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243445">parent</a><span>|</span><a href="#41243384">next</a><span>|</span><label class="collapse" for="c-41243604">[-]</label><label class="expand" for="c-41243604">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But it might not be super portable.<p>.net is available on all systems where developers work with their code.</div><br/></div></div></div></div></div></div><div id="41243384" class="c"><input type="checkbox" id="c-41243384" checked=""/><div class="controls bullet"><span class="by">mook</span><span>|</span><a href="#41243138">root</a><span>|</span><a href="#41243235">parent</a><span>|</span><a href="#41243402">prev</a><span>|</span><a href="#41243755">next</a><span>|</span><label class="collapse" for="c-41243384">[-]</label><label class="expand" for="c-41243384">[1 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t a lot of the linters run externally via language servers? I&#x27;m pretty sure the rust linters are rust-native for example.</div><br/></div></div></div></div><div id="41243755" class="c"><input type="checkbox" id="c-41243755" checked=""/><div class="controls bullet"><span class="by">epolanski</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243235">prev</a><span>|</span><a href="#41243463">next</a><span>|</span><label class="collapse" for="c-41243755">[-]</label><label class="expand" for="c-41243755">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the alternative?<p>Anything you name has either less support or different cons.</div><br/></div></div><div id="41243463" class="c"><input type="checkbox" id="c-41243463" checked=""/><div class="controls bullet"><span class="by">k__</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243755">prev</a><span>|</span><a href="#41243406">next</a><span>|</span><label class="collapse" for="c-41243463">[-]</label><label class="expand" for="c-41243463">[1 more]</label></div><br/><div class="children"><div class="content">Technically, it is more than a linter, as enums don&#x27;t have a direct representation in JS.</div><br/></div></div><div id="41243406" class="c"><input type="checkbox" id="c-41243406" checked=""/><div class="controls bullet"><span class="by">Narhem</span><span>|</span><a href="#41243138">parent</a><span>|</span><a href="#41243463">prev</a><span>|</span><label class="collapse" for="c-41243406">[-]</label><label class="expand" for="c-41243406">[1 more]</label></div><br/><div class="children"><div class="content">If I had to guess working with parsing xml is more complicated than traditional code.<p>Can’t find the links but one of the reasons I’ve seen people move away from xml has been due to the speed in parsing when compared to json or csv.</div><br/></div></div></div></div></div></div></div></div></div></body></html>