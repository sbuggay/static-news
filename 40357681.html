<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1715763670889" as="style"/><link rel="stylesheet" href="styles.css?v=1715763670889"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://ai.google.dev/edge/model-explorer">Model Explorer: intuitive and hierarchical visualization of model graphs</a>Â <span class="domain">(<a href="https://ai.google.dev">ai.google.dev</a>)</span></div><div class="subtext"><span>antognini</span> | <span>37 comments</span></div><br/><div><div id="40357930" class="c"><input type="checkbox" id="c-40357930" checked=""/><div class="controls bullet"><span class="by">joaquincabezas</span><span>|</span><a href="#40358882">next</a><span>|</span><label class="collapse" for="c-40357930">[-]</label><label class="expand" for="c-40357930">[1 more]</label></div><br/><div class="children"><div class="content">I normally use Netron for quickly inspecting models and making this &#x27;mental picture&#x27; of the architecture, but this hierarchical approach seems a better fit for my needs.<p>I&#x27;m just starting and the first impression is pretty good!</div><br/></div></div><div id="40358882" class="c"><input type="checkbox" id="c-40358882" checked=""/><div class="controls bullet"><span class="by">tomrod</span><span>|</span><a href="#40357930">prev</a><span>|</span><a href="#40358022">next</a><span>|</span><label class="collapse" for="c-40358882">[-]</label><label class="expand" for="c-40358882">[3 more]</label></div><br/><div class="children"><div class="content">Looks like they have moved to <a href="https:&#x2F;&#x2F;ai.google.dev&#x2F;edge&#x2F;model-explorer" rel="nofollow">https:&#x2F;&#x2F;ai.google.dev&#x2F;edge&#x2F;model-explorer</a></div><br/><div id="40359145" class="c"><input type="checkbox" id="c-40359145" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#40358882">parent</a><span>|</span><a href="#40358022">next</a><span>|</span><label class="collapse" for="c-40359145">[-]</label><label class="expand" for="c-40359145">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure which link is more up to date, but since this one appears to give more background, we&#x27;ve switched to it from <a href="https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer">https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer</a> above. Thanks!</div><br/><div id="40362429" class="c"><input type="checkbox" id="c-40362429" checked=""/><div class="controls bullet"><span class="by">tomrod</span><span>|</span><a href="#40358882">root</a><span>|</span><a href="#40359145">parent</a><span>|</span><a href="#40358022">next</a><span>|</span><label class="collapse" for="c-40362429">[-]</label><label class="expand" for="c-40362429">[1 more]</label></div><br/><div class="children"><div class="content">You bet! They reference the github repo, but more info is in the link you moved it to.</div><br/></div></div></div></div></div></div><div id="40358022" class="c"><input type="checkbox" id="c-40358022" checked=""/><div class="controls bullet"><span class="by">fabmilo</span><span>|</span><a href="#40358882">prev</a><span>|</span><a href="#40357907">next</a><span>|</span><label class="collapse" for="c-40358022">[-]</label><label class="expand" for="c-40358022">[1 more]</label></div><br/><div class="children"><div class="content">These tools are eye candy and have been around from tensorflow&#x2F;tensorboard 0.x 10 years ago but never used after just trying them for fun. You need to read the source code no easy way around it.</div><br/></div></div><div id="40357907" class="c"><input type="checkbox" id="c-40357907" checked=""/><div class="controls bullet"><span class="by">swaptr</span><span>|</span><a href="#40358022">prev</a><span>|</span><a href="#40357888">next</a><span>|</span><label class="collapse" for="c-40357907">[-]</label><label class="expand" for="c-40357907">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;lutzroeder&#x2F;netron">https:&#x2F;&#x2F;github.com&#x2F;lutzroeder&#x2F;netron</a><p><a href="https:&#x2F;&#x2F;netron.app&#x2F;" rel="nofollow">https:&#x2F;&#x2F;netron.app&#x2F;</a></div><br/></div></div><div id="40357888" class="c"><input type="checkbox" id="c-40357888" checked=""/><div class="controls bullet"><span class="by">anvuong</span><span>|</span><a href="#40357907">prev</a><span>|</span><a href="#40359487">next</a><span>|</span><label class="collapse" for="c-40357888">[-]</label><label class="expand" for="c-40357888">[2 more]</label></div><br/><div class="children"><div class="content">Looks cool but seems like it doesn&#x27;t work on torch 2.0<p>&quot;AttributeError: module &#x27;torch&#x27; has no attribute &#x27;export&#x27;&quot;<p>The torch.export API is currently in active development with planned breaking changes. The installation guide for this is still very minimal, anyone knows how to get it working on torch 2.0?</div><br/><div id="40360381" class="c"><input type="checkbox" id="c-40360381" checked=""/><div class="controls bullet"><span class="by">frontierkodiak</span><span>|</span><a href="#40357888">parent</a><span>|</span><a href="#40359487">next</a><span>|</span><label class="collapse" for="c-40360381">[-]</label><label class="expand" for="c-40360381">[1 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t managed to successfully export my custom ViT model yet, but I&#x27;ve not had an issue accessing the export methods in torch 2.3 within the nvcr.io&#x2F;nvidia&#x2F;pytorch:24.02-py3 container.<p>I may have some more time to debug my trace tonight (i.e. remove conditionals from model + make sure everything is on CPU) and will update if I have any new insights.<p>```
from torch.export import export
...
    example_args = (dummy_input)
    exported_program = export(model, args=example_args)
```<p>Links:
- torch.export docs: <a href="https:&#x2F;&#x2F;pytorch.org&#x2F;docs&#x2F;stable&#x2F;export.html#serialization" rel="nofollow">https:&#x2F;&#x2F;pytorch.org&#x2F;docs&#x2F;stable&#x2F;export.html#serialization</a>
- Using 24.02 container: <a href="https:&#x2F;&#x2F;docs.nvidia.com&#x2F;deeplearning&#x2F;frameworks&#x2F;pytorch-release-notes&#x2F;rel-24-02.html" rel="nofollow">https:&#x2F;&#x2F;docs.nvidia.com&#x2F;deeplearning&#x2F;frameworks&#x2F;pytorch-rele...</a></div><br/></div></div></div></div><div id="40359487" class="c"><input type="checkbox" id="c-40359487" checked=""/><div class="controls bullet"><span class="by">westurner</span><span>|</span><a href="#40357888">prev</a><span>|</span><a href="#40360334">next</a><span>|</span><label class="collapse" for="c-40359487">[-]</label><label class="expand" for="c-40359487">[1 more]</label></div><br/><div class="children"><div class="content">google-ai-edge&#x2F;model-explorer&#x2F;&#x2F;example_colabs&#x2F;quick_start.ipynb: <a href="https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;blob&#x2F;main&#x2F;example_colabs&#x2F;quick_start.ipynb">https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;blob&#x2F;main&#x2F;e...</a><p>XAI: Explainable AI: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Explainable_artificial_intelligence" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Explainable_artificial_intelli...</a></div><br/></div></div><div id="40360334" class="c"><input type="checkbox" id="c-40360334" checked=""/><div class="controls bullet"><span class="by">germanjoey</span><span>|</span><a href="#40359487">prev</a><span>|</span><a href="#40357979">next</a><span>|</span><label class="collapse" for="c-40360334">[-]</label><label class="expand" for="c-40360334">[1 more]</label></div><br/><div class="children"><div class="content">Is there a demo of a model visualized using this somewhere? Even if it&#x27;s just a short video... it&#x27;s hard to tell what it&#x27;s like from screenshots.</div><br/></div></div><div id="40357979" class="c"><input type="checkbox" id="c-40357979" checked=""/><div class="controls bullet"><span class="by">brrrrrm</span><span>|</span><a href="#40360334">prev</a><span>|</span><a href="#40358053">next</a><span>|</span><label class="collapse" for="c-40357979">[-]</label><label class="expand" for="c-40357979">[11 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve never really understood the point of these visualizer things.  The idea that a model is always well represented by a directed acyclic graph seems extremely dated.<p>I really would love a PyTorch&#x2F;JAX profiler that shows, in annotated Python, where your code is allocating memory, using compute or doing device copies.</div><br/><div id="40358031" class="c"><input type="checkbox" id="c-40358031" checked=""/><div class="controls bullet"><span class="by">lamename</span><span>|</span><a href="#40357979">parent</a><span>|</span><a href="#40358564">next</a><span>|</span><label class="collapse" for="c-40358031">[-]</label><label class="expand" for="c-40358031">[2 more]</label></div><br/><div class="children"><div class="content">It may be that the way you like to think about things and the way others like to are different.<p>I find that quickly grasping a new architecture is easiest with a graph-based diagram first. Then code for details. All with the goal of internalizing the information processing steps. Not memory allocation per se.<p>In my mind, how the network implementation allocates memory is a different question.<p>But I think both of our desires just reflect our jobs, our interests, and simply how our brains conceptualize things differently.</div><br/><div id="40359313" class="c"><input type="checkbox" id="c-40359313" checked=""/><div class="controls bullet"><span class="by">brrrrrm</span><span>|</span><a href="#40357979">root</a><span>|</span><a href="#40358031">parent</a><span>|</span><a href="#40358564">next</a><span>|</span><label class="collapse" for="c-40359313">[-]</label><label class="expand" for="c-40359313">[1 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;s a trap of visual elegance.  When you start thinking of models this way you miss the way a lot of models are actually written.<p>E.g. how do you represent an online fine-tuning process?  I want to randomly switch between a reference impl and an approximation method, but when using the approx method I want to back-propagate so that it gets better over time.<p>full disclosure: I&#x27;ve written plenty of these little visualizers and also fallen for the trap of &quot;everything should be a declarative graph.&quot;</div><br/></div></div></div></div><div id="40358564" class="c"><input type="checkbox" id="c-40358564" checked=""/><div class="controls bullet"><span class="by">almostgotcaught</span><span>|</span><a href="#40357979">parent</a><span>|</span><a href="#40358031">prev</a><span>|</span><a href="#40360820">next</a><span>|</span><label class="collapse" for="c-40358564">[-]</label><label class="expand" for="c-40358564">[4 more]</label></div><br/><div class="children"><div class="content">Lol I interned inside pytorch a few years ago (you and I even met&#x2F;talked about tangential things :)) and worked on tracking such allocations (although I didn&#x27;t hook it up to profiler). Spoiler alert: you can&#x27;t track such provenance because everything gets muddled in the dispatcher.<p>EDIT: not completely accurate to say you <i>can&#x27;t</i> do it. I prototyped a little allocator that would stamp every allocation (the pointer itself, in the unused bits, a trick I learned from zach) with the thread id and a timestamp (just an incrementing counter) and then percolate that up to the surface. Obv that didn&#x27;t land lol.</div><br/><div id="40359282" class="c"><input type="checkbox" id="c-40359282" checked=""/><div class="controls bullet"><span class="by">chillee</span><span>|</span><a href="#40357979">root</a><span>|</span><a href="#40358564">parent</a><span>|</span><a href="#40359261">next</a><span>|</span><label class="collapse" for="c-40359282">[-]</label><label class="expand" for="c-40359282">[2 more]</label></div><br/><div class="children"><div class="content">We actually do track such provenance now (<a href="https:&#x2F;&#x2F;pytorch.org&#x2F;blog&#x2F;understanding-gpu-memory-1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;pytorch.org&#x2F;blog&#x2F;understanding-gpu-memory-1&#x2F;</a>) - works pretty well I think :)</div><br/><div id="40359362" class="c"><input type="checkbox" id="c-40359362" checked=""/><div class="controls bullet"><span class="by">almostgotcaught</span><span>|</span><a href="#40357979">root</a><span>|</span><a href="#40359282">parent</a><span>|</span><a href="#40359261">next</a><span>|</span><label class="collapse" for="c-40359362">[-]</label><label class="expand" for="c-40359362">[1 more]</label></div><br/><div class="children"><div class="content">well you should tell bram then :p<p>but also while generally &quot;in all things i defer to horace&quot; (ok not really) so maybe i&#x27;m not looking closely enough (and missed it) but the bottom of that stack shows (roughly) the autograd dispatch key and not the python call site (or some such). and maybe it&#x27;s a pedantic difference (depends on what bram wants) but i wanted provenance back to the TS op so that i could then do static memory allocation things with that representation (now i&#x27;ve probably fully de-anonymized myself...) and for that use-case, even what you have now, isn&#x27;t enough (you can&#x27;t get a total sum for how much each TS op or whatever allocates and when the corresponding free happens).</div><br/></div></div></div></div><div id="40359261" class="c"><input type="checkbox" id="c-40359261" checked=""/><div class="controls bullet"><span class="by">brrrrrm</span><span>|</span><a href="#40357979">root</a><span>|</span><a href="#40358564">parent</a><span>|</span><a href="#40359282">prev</a><span>|</span><a href="#40360820">next</a><span>|</span><label class="collapse" for="c-40359261">[-]</label><label class="expand" for="c-40359261">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if you could track provenance by operating at the highest layer of the dispatcher and capture any calls to GPU operations (ala Cuda Graph)?<p>&gt; in the unused bits<p>I feel like this is a PT rite of passage :P</div><br/></div></div></div></div><div id="40360820" class="c"><input type="checkbox" id="c-40360820" checked=""/><div class="controls bullet"><span class="by">hatthew</span><span>|</span><a href="#40357979">parent</a><span>|</span><a href="#40358564">prev</a><span>|</span><a href="#40358356">next</a><span>|</span><label class="collapse" for="c-40360820">[-]</label><label class="expand" for="c-40360820">[1 more]</label></div><br/><div class="children"><div class="content">A DAG visualization of a model is a good abstraction to learn the general structure of the model to help contextualize the code you&#x27;re reading.</div><br/></div></div><div id="40358356" class="c"><input type="checkbox" id="c-40358356" checked=""/><div class="controls bullet"><span class="by">gedy</span><span>|</span><a href="#40357979">parent</a><span>|</span><a href="#40360820">prev</a><span>|</span><a href="#40358706">next</a><span>|</span><label class="collapse" for="c-40358356">[-]</label><label class="expand" for="c-40358356">[1 more]</label></div><br/><div class="children"><div class="content">Not mocking you, but I&#x27;d make a guess you don&#x27;t like to draw block diagrams when discussing designs or code architecture with others either?  Some folks aren&#x27;t &quot;visual&quot; thinkers, and took me a long time working to realize that some folks are like that.</div><br/></div></div><div id="40358706" class="c"><input type="checkbox" id="c-40358706" checked=""/><div class="controls bullet"><span class="by">mathematicaster</span><span>|</span><a href="#40357979">parent</a><span>|</span><a href="#40358356">prev</a><span>|</span><a href="#40358053">next</a><span>|</span><label class="collapse" for="c-40358706">[-]</label><label class="expand" for="c-40358706">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t see any reference to acyclic as a requirement.</div><br/><div id="40359274" class="c"><input type="checkbox" id="c-40359274" checked=""/><div class="controls bullet"><span class="by">brrrrrm</span><span>|</span><a href="#40357979">root</a><span>|</span><a href="#40358706">parent</a><span>|</span><a href="#40358053">next</a><span>|</span><label class="collapse" for="c-40359274">[-]</label><label class="expand" for="c-40359274">[1 more]</label></div><br/><div class="children"><div class="content">I think it uses TF&#x27;s graph construct which has that built in?  it&#x27;s like a weird mix of dataflow and control flow graphs.</div><br/></div></div></div></div></div></div><div id="40358053" class="c"><input type="checkbox" id="c-40358053" checked=""/><div class="controls bullet"><span class="by">pdevr</span><span>|</span><a href="#40357979">prev</a><span>|</span><a href="#40358291">next</a><span>|</span><label class="collapse" for="c-40358053">[-]</label><label class="expand" for="c-40358053">[1 more]</label></div><br/><div class="children"><div class="content">Other than visualizing, creating custom nodes seems to be the most interesting available operation (at the time of writing this).<p>API Guide:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;wiki&#x2F;4.-API-Guide">https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;wiki&#x2F;4.-API...</a><p>Custom Nodes - User Guide:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;wiki&#x2F;2.-User-Guide#custom-node-data">https:&#x2F;&#x2F;github.com&#x2F;google-ai-edge&#x2F;model-explorer&#x2F;wiki&#x2F;2.-Use...</a></div><br/></div></div><div id="40358291" class="c"><input type="checkbox" id="c-40358291" checked=""/><div class="controls bullet"><span class="by">toddmorey</span><span>|</span><a href="#40358053">prev</a><span>|</span><a href="#40357956">next</a><span>|</span><label class="collapse" for="c-40358291">[-]</label><label class="expand" for="c-40358291">[2 more]</label></div><br/><div class="children"><div class="content">Is it becoming more and more common to launch open software like this without accepting contributions?</div><br/></div></div><div id="40358731" class="c"><input type="checkbox" id="c-40358731" checked=""/><div class="controls bullet"><span class="by">kleiba</span><span>|</span><a href="#40357956">prev</a><span>|</span><a href="#40357934">next</a><span>|</span><label class="collapse" for="c-40358731">[-]</label><label class="expand" for="c-40358731">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m confused - so it runs only in Edge or what&#x27;s with the name?!</div><br/><div id="40358770" class="c"><input type="checkbox" id="c-40358770" checked=""/><div class="controls bullet"><span class="by">inhumantsar</span><span>|</span><a href="#40358731">parent</a><span>|</span><a href="#40357934">next</a><span>|</span><label class="collapse" for="c-40358770">[-]</label><label class="expand" for="c-40358770">[2 more]</label></div><br/><div class="children"><div class="content">the team is building tools to help run models on edge devices. embedded, mobile, laptops, etc.</div><br/><div id="40359093" class="c"><input type="checkbox" id="c-40359093" checked=""/><div class="controls bullet"><span class="by">kleiba</span><span>|</span><a href="#40358731">root</a><span>|</span><a href="#40358770">parent</a><span>|</span><a href="#40357934">next</a><span>|</span><label class="collapse" for="c-40359093">[-]</label><label class="expand" for="c-40359093">[1 more]</label></div><br/><div class="children"><div class="content">Okay, thanks for the explanation!</div><br/></div></div></div></div></div></div><div id="40357934" class="c"><input type="checkbox" id="c-40357934" checked=""/><div class="controls bullet"><span class="by">spydum</span><span>|</span><a href="#40358731">prev</a><span>|</span><a href="#40358137">next</a><span>|</span><label class="collapse" for="c-40357934">[-]</label><label class="expand" for="c-40357934">[1 more]</label></div><br/><div class="children"><div class="content">Not to be confused with Microsoft Edge, which replaced Internet Explorer with Chromium (the browser that Google Chrome is based on). &#x2F;s</div><br/></div></div><div id="40358137" class="c"><input type="checkbox" id="c-40358137" checked=""/><div class="controls bullet"><span class="by">Veuxdo</span><span>|</span><a href="#40357934">prev</a><span>|</span><label class="collapse" for="c-40358137">[-]</label><label class="expand" for="c-40358137">[7 more]</label></div><br/><div class="children"><div class="content">What is the &quot;AI&quot; part of this...?</div><br/><div id="40358203" class="c"><input type="checkbox" id="c-40358203" checked=""/><div class="controls bullet"><span class="by">minimaxir</span><span>|</span><a href="#40358137">parent</a><span>|</span><a href="#40358212">next</a><span>|</span><label class="collapse" for="c-40358203">[-]</label><label class="expand" for="c-40358203">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an &quot;AI Model&quot; Explorer, not an AI &quot;Model Explorer.&quot;</div><br/></div></div><div id="40358212" class="c"><input type="checkbox" id="c-40358212" checked=""/><div class="controls bullet"><span class="by">Veuxdo</span><span>|</span><a href="#40358137">parent</a><span>|</span><a href="#40358203">prev</a><span>|</span><a href="#40358152">next</a><span>|</span><label class="collapse" for="c-40358212">[-]</label><label class="expand" for="c-40358212">[4 more]</label></div><br/><div class="children"><div class="content">Also, what is the &quot;Google&quot; part of this?</div><br/><div id="40358265" class="c"><input type="checkbox" id="c-40358265" checked=""/><div class="controls bullet"><span class="by">minimaxir</span><span>|</span><a href="#40358137">root</a><span>|</span><a href="#40358212">parent</a><span>|</span><a href="#40358245">next</a><span>|</span><label class="collapse" for="c-40358265">[-]</label><label class="expand" for="c-40358265">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s owned and operated by Google.</div><br/></div></div><div id="40358245" class="c"><input type="checkbox" id="c-40358245" checked=""/><div class="controls bullet"><span class="by">nashashmi</span><span>|</span><a href="#40358137">root</a><span>|</span><a href="#40358212">parent</a><span>|</span><a href="#40358265">prev</a><span>|</span><a href="#40358152">next</a><span>|</span><label class="collapse" for="c-40358245">[-]</label><label class="expand" for="c-40358245">[1 more]</label></div><br/><div class="children"><div class="content">And why is this referring to MS Edge?</div><br/></div></div></div></div><div id="40358152" class="c"><input type="checkbox" id="c-40358152" checked=""/><div class="controls bullet"><span class="by">akomtu</span><span>|</span><a href="#40358137">parent</a><span>|</span><a href="#40358212">prev</a><span>|</span><label class="collapse" for="c-40358152">[-]</label><label class="expand" for="c-40358152">[1 more]</label></div><br/><div class="children"><div class="content">Marketing &amp; SEO.</div><br/></div></div></div></div></div></div></div></div></div></body></html>