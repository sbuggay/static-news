<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711530068056" as="style"/><link rel="stylesheet" href="styles.css?v=1711530068056"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://cliffle.com/blog/who-killed-the-network-switch/">Who killed the network switch? A Hubris Bug Story</a> <span class="domain">(<a href="https://cliffle.com">cliffle.com</a>)</span></div><div class="subtext"><span>ingve</span> | <span>65 comments</span></div><br/><div><div id="39836115" class="c"><input type="checkbox" id="c-39836115" checked=""/><div class="controls bullet"><span class="by">rablackburn</span><span>|</span><a href="#39833751">next</a><span>|</span><label class="collapse" for="c-39836115">[-]</label><label class="expand" for="c-39836115">[3 more]</label></div><br/><div class="children"><div class="content">This is one of the best job ads I’ve ever seen. Seamless segue into culture and “btw we’re hiring” at the end :)<p>This is truly a fantastic post-mortem: even an application-level developer like myself could follow it. Though I am in the middle of Rust in Action at the moment so I was primed for this type of content (:<p>And of course it’s always a pleasure seeing someone else who comments their code at such a high LoC ratio. Literate programming works!</div><br/><div id="39836431" class="c"><input type="checkbox" id="c-39836431" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#39836115">parent</a><span>|</span><a href="#39833751">next</a><span>|</span><label class="collapse" for="c-39836431">[-]</label><label class="expand" for="c-39836431">[2 more]</label></div><br/><div class="children"><div class="content">Only in America though unfortunately.</div><br/></div></div></div></div><div id="39833751" class="c"><input type="checkbox" id="c-39833751" checked=""/><div class="controls bullet"><span class="by">orf</span><span>|</span><a href="#39836115">prev</a><span>|</span><a href="#39836824">next</a><span>|</span><label class="collapse" for="c-39833751">[-]</label><label class="expand" for="c-39833751">[23 more]</label></div><br/><div class="children"><div class="content">Hubris is really, really nice. I&#x27;ve spent half an hour reading some of the kernel code and it’s exceptionally clear and well written - a far cry from ifdef macro soup, two letter variable name loving, comment starved C code I’ve seen previously. A good bit of bedtime reading!<p>I recommend leafing through it: <a href="https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;hubris&#x2F;blob&#x2F;b44e677fb39cde8be5b10bbf78a9f26c000f6ad6&#x2F;sys&#x2F;kern&#x2F;src&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;hubris&#x2F;blob&#x2F;b44e677fb39cde8...</a></div><br/><div id="39835100" class="c"><input type="checkbox" id="c-39835100" checked=""/><div class="controls bullet"><span class="by">nebula8804</span><span>|</span><a href="#39833751">parent</a><span>|</span><a href="#39834087">next</a><span>|</span><label class="collapse" for="c-39835100">[-]</label><label class="expand" for="c-39835100">[5 more]</label></div><br/><div class="children"><div class="content">AI might kill this convention when everyone pipes their old crusty C code and all of a sudden all the variables are clean and named in the fashion the user loves best (because the AI has learned exactly the quirks of how a specific coder likes it).</div><br/><div id="39835564" class="c"><input type="checkbox" id="c-39835564" checked=""/><div class="controls bullet"><span class="by">chc4</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835100">parent</a><span>|</span><a href="#39835982">next</a><span>|</span><label class="collapse" for="c-39835564">[-]</label><label class="expand" for="c-39835564">[3 more]</label></div><br/><div class="children"><div class="content">AI might also make unicorns real and usher in world peace, while we&#x27;re wishing for things.</div><br/><div id="39836291" class="c"><input type="checkbox" id="c-39836291" checked=""/><div class="controls bullet"><span class="by">TeMPOraL</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835564">parent</a><span>|</span><a href="#39835982">next</a><span>|</span><label class="collapse" for="c-39836291">[-]</label><label class="expand" for="c-39836291">[2 more]</label></div><br/><div class="children"><div class="content">Unicorns are merely an engineering problem tho (specifically, genetic engineering).</div><br/><div id="39836589" class="c"><input type="checkbox" id="c-39836589" checked=""/><div class="controls bullet"><span class="by">dxdm</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39836291">parent</a><span>|</span><a href="#39835982">next</a><span>|</span><label class="collapse" for="c-39836589">[-]</label><label class="expand" for="c-39836589">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Unicorns are merely an engineering problem tho (specifically, genetic engineering).<p>So is world peace, while we&#x27;re saying things that contain the word &quot;merely&quot;. :)</div><br/></div></div></div></div></div></div><div id="39835982" class="c"><input type="checkbox" id="c-39835982" checked=""/><div class="controls bullet"><span class="by">aitchnyu</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835100">parent</a><span>|</span><a href="#39835564">prev</a><span>|</span><a href="#39834087">next</a><span>|</span><label class="collapse" for="c-39835982">[-]</label><label class="expand" for="c-39835982">[1 more]</label></div><br/><div class="children"><div class="content">One dev uses an autoformatter (black for Python) for his codebase. When he wants to do side by side diff on a laptop, he reduces line width to 70 characters and formats his entire codebase, works with his diff tool, then reformats back to original width.</div><br/></div></div></div></div><div id="39834087" class="c"><input type="checkbox" id="c-39834087" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#39833751">parent</a><span>|</span><a href="#39835100">prev</a><span>|</span><a href="#39836824">next</a><span>|</span><label class="collapse" for="c-39834087">[-]</label><label class="expand" for="c-39834087">[17 more]</label></div><br/><div class="children"><div class="content">It bothers me deeply how much of C ethos can be boiled down to, &quot;We can&#x27;t be bothered to learn to type at a reasonable speed&quot;<p>Disk space for source code hasn&#x27;t really been a problem for forty years (binaries definitely), and yet we are still being stingy with variable names.</div><br/><div id="39834596" class="c"><input type="checkbox" id="c-39834596" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39835816">next</a><span>|</span><label class="collapse" for="c-39834596">[-]</label><label class="expand" for="c-39834596">[1 more]</label></div><br/><div class="children"><div class="content">&gt; how much of C ethos can be boiled down to<p>A lot of commercial code is like this,  regardless of the language;  there just happen to be people trying to sell new languages.  They desperately want to convince you that this is all the fault of C and it&#x27;s nebulous &quot;ethos,&quot;  and if you just use their new language,  it will all magically go away and possibly improve human rights somehow.</div><br/></div></div><div id="39835816" class="c"><input type="checkbox" id="c-39835816" checked=""/><div class="controls bullet"><span class="by">StressedDev</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39834596">prev</a><span>|</span><a href="#39836590">next</a><span>|</span><label class="collapse" for="c-39835816">[-]</label><label class="expand" for="c-39835816">[3 more]</label></div><br/><div class="children"><div class="content">C (the language) does not cause people to write unmaintainable or hard to understand code.  Programmers who choose to write unmaintainable or hard to understand code are the problem.  I have seen great C code, good C code, mediocre C code, etc.  It really depends on who is writing this.  This is true of all languages.<p>In short, technology cannot fix people problems.</div><br/><div id="39836137" class="c"><input type="checkbox" id="c-39836137" checked=""/><div class="controls bullet"><span class="by">hnaccount_rng</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835816">parent</a><span>|</span><a href="#39836590">next</a><span>|</span><label class="collapse" for="c-39836137">[-]</label><label class="expand" for="c-39836137">[2 more]</label></div><br/><div class="children"><div class="content">That’s a statement that comes up a lot. And while it is technically true, it really isn’t in practice. We can and do design systems to expose less of their surfaces that represent open knifes and more of the safe handle side. It is near universally true, that the easier to access way is the one that will be taken more often.<p>To be fair to C, it was designed long before we as a society really appreciated that. So there is a lot of old code whose authors just couldn’t know better. And some (probably few) will even have managed to write readable code! But that doesn’t mean that languages can’t encourage good behavior and discourage bad. (I’m not even sure where I come down wrt Rust here)
And that will (somewhat reliably) end in better or worse code. Not necessarily in a reliable way. But it’s e.g. really hard to write python code where local control flow isn’t reasonably obvious (since scoping is enforced by white space). Not impossible of course</div><br/><div id="39836724" class="c"><input type="checkbox" id="c-39836724" checked=""/><div class="controls bullet"><span class="by">pastage</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39836137">parent</a><span>|</span><a href="#39836590">next</a><span>|</span><label class="collapse" for="c-39836724">[-]</label><label class="expand" for="c-39836724">[1 more]</label></div><br/><div class="children"><div class="content">There are lots of example of hard to understand Python local control flow, Python is a long way from being consistent in encourge good behaviour. When comparing the same type of code let say arg parsing C is usually worse. In Python you can get lost in library hell looking at the details of that code but in C it&#x27;s just knowledge of basic functions of the language how ever terse it might be. On avarage I agree.</div><br/></div></div></div></div></div></div><div id="39836590" class="c"><input type="checkbox" id="c-39836590" checked=""/><div class="controls bullet"><span class="by">anilakar</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39835816">prev</a><span>|</span><a href="#39834242">next</a><span>|</span><label class="collapse" for="c-39836590">[-]</label><label class="expand" for="c-39836590">[1 more]</label></div><br/><div class="children"><div class="content">Most of the bad habits stem from how C is taught.<p>It should not be the first language freshmen are taught in universities. All the effort will be wasted on teaching basic programming instead of the actual language and good programming habits.<p>Pointers and the memory model are core concepts and should be taught early on. The worst programming books I have seen introduce them in the very last chapter, often called &quot;advanced language features&quot; or something similar.<p>It is not a compiled scripting language for Unix systems either and should not be programmed with a text editor on a remote machine. The programmer should have a proper development environment installed locally.<p>Valgrind and and Clang&#x27;s sanitizers should be used extensively. There is no such thing as partial credit when it comes to memory correctness.<p>If a certain QuakeNet IRCop is reading this, thank you. Your uni C course managed to avoid all the pitfalls above.</div><br/></div></div><div id="39834242" class="c"><input type="checkbox" id="c-39834242" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39836590">prev</a><span>|</span><a href="#39835147">next</a><span>|</span><label class="collapse" for="c-39834242">[-]</label><label class="expand" for="c-39834242">[7 more]</label></div><br/><div class="children"><div class="content">If it bothers you so much I&#x27;m happy to tell that that is not the reason for it.</div><br/><div id="39834550" class="c"><input type="checkbox" id="c-39834550" checked=""/><div class="controls bullet"><span class="by">spc476</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834242">parent</a><span>|</span><a href="#39835414">next</a><span>|</span><label class="collapse" for="c-39834550">[-]</label><label class="expand" for="c-39834550">[4 more]</label></div><br/><div class="children"><div class="content">Could you spend some effort to explain the reason then?</div><br/><div id="39834859" class="c"><input type="checkbox" id="c-39834859" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834550">parent</a><span>|</span><a href="#39835414">next</a><span>|</span><label class="collapse" for="c-39834859">[-]</label><label class="expand" for="c-39834859">[3 more]</label></div><br/><div class="children"><div class="content">Fwiw I&#x27;ve written some Real C++, think, audio encoders&#x2F;decoders for voice recognition for 1B MAUs on the server, audio encoder on 2B devices.<p>Each and every time there was just insane excuses that boiled down to only a few people wanted to write C++ and they found infinite ways to justify not doing things, like all us humans do.<p>My favorite was the &quot;don&#x27;t write comments because as soon as you do they&#x27;re out of date.&quot;<p>Even though this is recognizably  trollish tripe at the extreme it was implemented, I still find it hard to ignore that brainworm in my day to day coding.</div><br/><div id="39834902" class="c"><input type="checkbox" id="c-39834902" checked=""/><div class="controls bullet"><span class="by">Retric</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834859">parent</a><span>|</span><a href="#39835414">next</a><span>|</span><label class="collapse" for="c-39834902">[-]</label><label class="expand" for="c-39834902">[2 more]</label></div><br/><div class="children"><div class="content">I think that’s a common mutation of the far more useful and therefore relevant “Don’t trust comments” which everyone learns at some point.</div><br/><div id="39836389" class="c"><input type="checkbox" id="c-39836389" checked=""/><div class="controls bullet"><span class="by">citrin_ru</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834902">parent</a><span>|</span><a href="#39835414">next</a><span>|</span><label class="collapse" for="c-39836389">[-]</label><label class="expand" for="c-39836389">[1 more]</label></div><br/><div class="children"><div class="content">“Don’t trust people” is a heuristic to avoid being scammed. But it is much nicer to live in a society where you can trust most of the people. The same way it is nice to work with code base where you can trust comments by default. Which is the case for many open source projects.</div><br/></div></div></div></div></div></div></div></div><div id="39835414" class="c"><input type="checkbox" id="c-39835414" checked=""/><div class="controls bullet"><span class="by">IggleSniggle</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834242">parent</a><span>|</span><a href="#39834550">prev</a><span>|</span><a href="#39834495">next</a><span>|</span><label class="collapse" for="c-39835414">[-]</label><label class="expand" for="c-39835414">[1 more]</label></div><br/><div class="children"><div class="content">Ah, yes, we are all elucidated once again. Thanks for the ctx</div><br/></div></div><div id="39834495" class="c"><input type="checkbox" id="c-39834495" checked=""/><div class="controls bullet"><span class="by">throwaway11460</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834242">parent</a><span>|</span><a href="#39835414">prev</a><span>|</span><a href="#39835147">next</a><span>|</span><label class="collapse" for="c-39834495">[-]</label><label class="expand" for="c-39834495">[1 more]</label></div><br/><div class="children"><div class="content">Who cares though? Just use an IDE or Copilot or something.</div><br/></div></div></div></div><div id="39835147" class="c"><input type="checkbox" id="c-39835147" checked=""/><div class="controls bullet"><span class="by">hughesjj</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39834242">prev</a><span>|</span><a href="#39835759">next</a><span>|</span><label class="collapse" for="c-39835147">[-]</label><label class="expand" for="c-39835147">[3 more]</label></div><br/><div class="children"><div class="content">I get that we as an industry went a bit overboard when Java +ooo was in vouge novelty with entire sentences being method names, but I&#x27;m with you that all the people I see making super compressed var names with contexts longer than a for loop initializer<p>And don&#x27;t even get me started on trying to text to speak your `mCtx` or whatever</div><br/><div id="39835263" class="c"><input type="checkbox" id="c-39835263" checked=""/><div class="controls bullet"><span class="by">OJFord</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835147">parent</a><span>|</span><a href="#39835759">next</a><span>|</span><label class="collapse" for="c-39835263">[-]</label><label class="expand" for="c-39835263">[2 more]</label></div><br/><div class="children"><div class="content">&gt; And don&#x27;t even get me started on trying to text to speak your `mCtx` or whatever<p>I&#x27;m not saying TTS is there (I have no idea) but from an ideal point of view, to have it be equivalent, surely it would read &#x27;m context&#x27;, which then isn&#x27;t so bad (maybe m is clear from the ..err.. context).</div><br/><div id="39836574" class="c"><input type="checkbox" id="c-39836574" checked=""/><div class="controls bullet"><span class="by">ElFitz</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39835263">parent</a><span>|</span><a href="#39835759">next</a><span>|</span><label class="collapse" for="c-39836574">[-]</label><label class="expand" for="c-39836574">[1 more]</label></div><br/><div class="children"><div class="content">You could run a LLM pass to &quot;expand&quot; abbreviations and acronyms before running it through text to speech.<p>Although more expensive, it worked wonders for me with text containing units of measurement (°F, °C, m&#x2F;s, etc).</div><br/></div></div></div></div></div></div><div id="39835759" class="c"><input type="checkbox" id="c-39835759" checked=""/><div class="controls bullet"><span class="by">cdchn</span><span>|</span><a href="#39833751">root</a><span>|</span><a href="#39834087">parent</a><span>|</span><a href="#39835147">prev</a><span>|</span><a href="#39836824">next</a><span>|</span><label class="collapse" for="c-39835759">[-]</label><label class="expand" for="c-39835759">[1 more]</label></div><br/><div class="children"><div class="content">Its funny because the article even talks about the importance of reducing space for binaries.</div><br/></div></div></div></div></div></div><div id="39836824" class="c"><input type="checkbox" id="c-39836824" checked=""/><div class="controls bullet"><span class="by">retSava</span><span>|</span><a href="#39833751">prev</a><span>|</span><a href="#39833580">next</a><span>|</span><label class="collapse" for="c-39836824">[-]</label><label class="expand" for="c-39836824">[1 more]</label></div><br/><div class="children"><div class="content">Anyone knows what they mean by &quot;For instance, we have an internal board that serves as a useful I2C debugging probe and has 8 kiB of RAM and 32 kiB of flash.&quot;.<p>What could that interesting thing be? An inline-I2C sniffer perhaps? Or an interface board to inject i2c commands? Or something else?</div><br/></div></div><div id="39833580" class="c"><input type="checkbox" id="c-39833580" checked=""/><div class="controls bullet"><span class="by">scottlamb</span><span>|</span><a href="#39836824">prev</a><span>|</span><a href="#39836840">next</a><span>|</span><label class="collapse" for="c-39833580">[-]</label><label class="expand" for="c-39833580">[2 more]</label></div><br/><div class="children"><div class="content">Nice read!<p>Nit:<p><pre><code>    &#x2F;&#x2F; Order the task&#x27;s regions in ascending address order.
    &#x2F;&#x2F;
    &#x2F;&#x2F; THIS IS IMPORTANT. The kernel exploits this property to do cheaper
    &#x2F;&#x2F; access tests.
    regions.sort_by_key(|i| region_table.get_index(*i).unwrap().1.base);
</code></pre>
I wouldn&#x27;t put this comment here. It&#x27;s not just some detail of this function; it&#x27;s an invariant of the field that all writers have to respect (maybe this is the only one now but still) and all readers can take advantage of. So I&#x27;d add it to the `TaskDesc::regions` docstring. [1]<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;hubris&#x2F;commit&#x2F;b44e677fb39cde8be5b10bbf78a9f26c000f6ad6#diff-96e27941c050f6013357d7ad1716058d7171f2ab012e2bc5ee01a6c19701d826L45">https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;hubris&#x2F;commit&#x2F;b44e677fb39cd...</a></div><br/><div id="39835623" class="c"><input type="checkbox" id="c-39835623" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39833580">parent</a><span>|</span><a href="#39836840">next</a><span>|</span><label class="collapse" for="c-39835623">[-]</label><label class="expand" for="c-39835623">[1 more]</label></div><br/><div class="children"><div class="content">It is nice to have the comment next to the sort though, which is otherwise going to be surprising.<p>Probably the best thing to do is to make a constructor method for the TaskDesc that sorts the regions to enforce the invariants. The code is evidently getting more complex over time, so packing the complexity up into methods is probably now worth spending a little time on.</div><br/></div></div></div></div><div id="39836840" class="c"><input type="checkbox" id="c-39836840" checked=""/><div class="controls bullet"><span class="by">WatchDog</span><span>|</span><a href="#39833580">prev</a><span>|</span><a href="#39823769">next</a><span>|</span><label class="collapse" for="c-39836840">[-]</label><label class="expand" for="c-39836840">[1 more]</label></div><br/><div class="children"><div class="content">Refactoring that `can_access` function into it&#x27;s own crate, seems excessive, leftPad vibes.</div><br/></div></div><div id="39823769" class="c"><input type="checkbox" id="c-39823769" checked=""/><div class="controls bullet"><span class="by">moosingin3space</span><span>|</span><a href="#39836840">prev</a><span>|</span><a href="#39834094">next</a><span>|</span><label class="collapse" for="c-39823769">[-]</label><label class="expand" for="c-39823769">[1 more]</label></div><br/><div class="children"><div class="content">This is a fantastic in-depth look at debugging a complex problem, and the fact that the rest of the system remained stable is a testament to the quality of the engineering work that the Oxide team put into this. I&#x27;m personally quite inspired by this and plan on applying similar techniques in my day job!</div><br/></div></div><div id="39834094" class="c"><input type="checkbox" id="c-39834094" checked=""/><div class="controls bullet"><span class="by">mgerdts</span><span>|</span><a href="#39823769">prev</a><span>|</span><a href="#39833302">next</a><span>|</span><label class="collapse" for="c-39834094">[-]</label><label class="expand" for="c-39834094">[1 more]</label></div><br/><div class="children"><div class="content">According to [1] the prequel is found at [2].<p>1. <a href="https:&#x2F;&#x2F;hachyderm.io&#x2F;@mjk&#x2F;112157472314396711" rel="nofollow">https:&#x2F;&#x2F;hachyderm.io&#x2F;@mjk&#x2F;112157472314396711</a><p>2. <a href="https:&#x2F;&#x2F;www.mattkeeter.com&#x2F;blog&#x2F;2024-03-25-packing&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.mattkeeter.com&#x2F;blog&#x2F;2024-03-25-packing&#x2F;</a></div><br/></div></div><div id="39833302" class="c"><input type="checkbox" id="c-39833302" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#39834094">prev</a><span>|</span><a href="#39833295">next</a><span>|</span><label class="collapse" for="c-39833302">[-]</label><label class="expand" for="c-39833302">[7 more]</label></div><br/><div class="children"><div class="content">FWIW, you can support more than 8 regions by treating that hardware more like a soft fill TLB.</div><br/><div id="39833679" class="c"><input type="checkbox" id="c-39833679" checked=""/><div class="controls bullet"><span class="by">robocat</span><span>|</span><a href="#39833302">parent</a><span>|</span><a href="#39833461">next</a><span>|</span><label class="collapse" for="c-39833679">[-]</label><label class="expand" for="c-39833679">[2 more]</label></div><br/><div class="children"><div class="content">I would guess they (a) want  soft realtime performance, and (b) would not want to introduce something critical that could interfere with debuggability or potentially reliability. I&#x27;d never do it unless it was the last choice available. Virtual paging is nasty and I wouldn&#x27;t want the doubt.</div><br/><div id="39833812" class="c"><input type="checkbox" id="c-39833812" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#39833302">root</a><span>|</span><a href="#39833679">parent</a><span>|</span><a href="#39833461">next</a><span>|</span><label class="collapse" for="c-39833812">[-]</label><label class="expand" for="c-39833812">[1 more]</label></div><br/><div class="children"><div class="content">I think they&#x27;re just trying to keep it simple (which is totally fair, KISS principle is valuable).<p>You can keep soft real time perf with this scheme, just like you can keep soft realtime perf on any system with a soft fill TLB.<p>I say all of this as I used to be the lead for a real time kernel that would allow more than 8 regions on a task on a Cortex-M0&#x2F;M3.<p>It&#x27;s pretty easy to hit that amount with a combo of fine grain access (you probably want your RO section different than your TEXT section, you probably want your stack discontiguous with any mapped section, you&#x27;ve got all of your MMIO regions your task cares about which necessitate other MPU regions because the difference between normal memory and device memory is configured by the MPU), combined with breaking some apart to get greater granularity&#x2F;packing like they talk about here.</div><br/></div></div></div></div><div id="39833461" class="c"><input type="checkbox" id="c-39833461" checked=""/><div class="controls bullet"><span class="by">packetlost</span><span>|</span><a href="#39833302">parent</a><span>|</span><a href="#39833679">prev</a><span>|</span><a href="#39833295">next</a><span>|</span><label class="collapse" for="c-39833461">[-]</label><label class="expand" for="c-39833461">[4 more]</label></div><br/><div class="children"><div class="content">I assume TLB is translation lookaside buffer, but what do you mean by &quot;soft fill&quot; here?</div><br/><div id="39833489" class="c"><input type="checkbox" id="c-39833489" checked=""/><div class="controls bullet"><span class="by">Veserv</span><span>|</span><a href="#39833302">root</a><span>|</span><a href="#39833461">parent</a><span>|</span><a href="#39833295">next</a><span>|</span><label class="collapse" for="c-39833489">[-]</label><label class="expand" for="c-39833489">[3 more]</label></div><br/><div class="children"><div class="content">They mean software-filled. On “page fault (really a illegal memory access)” you walk a software data structure to determine if there should actually be accessible memory there then you “page in (update the MPU to make the memory accessible, possibly evicting another entry)” the memory.<p>This is how some older chips used to work. Hardware page table walkers can be viewed as just a hardware implementation of such code.</div><br/><div id="39835662" class="c"><input type="checkbox" id="c-39835662" checked=""/><div class="controls bullet"><span class="by">chc4</span><span>|</span><a href="#39833302">root</a><span>|</span><a href="#39833489">parent</a><span>|</span><a href="#39833295">next</a><span>|</span><label class="collapse" for="c-39835662">[-]</label><label class="expand" for="c-39835662">[2 more]</label></div><br/><div class="children"><div class="content">I was horrified to learn that PowerPC uses an &quot;inverted page table&quot;, which is essentially just a TLB implemented as a hash table. If the requested page isn&#x27;t resident in the inverted page table it delivers an interrupt, where the kernel is supposed to walk it&#x27;s own internal internal page table data structure and populate the hash table entry for the missing page. It was a big surprise coming from x86 or ARM on personal computer kernels where they have a fully populated page table as the canonical source of mappings, and all walking in hardware!</div><br/><div id="39836140" class="c"><input type="checkbox" id="c-39836140" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39833302">root</a><span>|</span><a href="#39835662">parent</a><span>|</span><a href="#39833295">next</a><span>|</span><label class="collapse" for="c-39836140">[-]</label><label class="expand" for="c-39836140">[1 more]</label></div><br/><div class="children"><div class="content">It does let you do some cute things in the software implementation though. I’d prefer a hardware walk of course but if I can’t have it might as well enjoy things.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39833295" class="c"><input type="checkbox" id="c-39833295" checked=""/><div class="controls bullet"><span class="by">aus10d</span><span>|</span><a href="#39833302">prev</a><span>|</span><a href="#39834450">next</a><span>|</span><label class="collapse" for="c-39833295">[-]</label><label class="expand" for="c-39833295">[8 more]</label></div><br/><div class="children"><div class="content">The work Oxide is doing is truly amazing</div><br/><div id="39833820" class="c"><input type="checkbox" id="c-39833820" checked=""/><div class="controls bullet"><span class="by">brcmthrowaway</span><span>|</span><a href="#39833295">parent</a><span>|</span><a href="#39834450">next</a><span>|</span><label class="collapse" for="c-39833820">[-]</label><label class="expand" for="c-39833820">[7 more]</label></div><br/><div class="children"><div class="content">First tailscale, now Oxide is the darling of projects 99% of people will never need</div><br/><div id="39834119" class="c"><input type="checkbox" id="c-39834119" checked=""/><div class="controls bullet"><span class="by">aus10d</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39833895">next</a><span>|</span><label class="collapse" for="c-39834119">[-]</label><label class="expand" for="c-39834119">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t have to &quot;need&quot; it to admire the scope of what they created. Hardware AND software engineering at its finest solving some very hard problems.</div><br/></div></div><div id="39833895" class="c"><input type="checkbox" id="c-39833895" checked=""/><div class="controls bullet"><span class="by">maybeben</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39834119">prev</a><span>|</span><a href="#39836543">next</a><span>|</span><label class="collapse" for="c-39833895">[-]</label><label class="expand" for="c-39833895">[1 more]</label></div><br/><div class="children"><div class="content">I look forward to scoring some beefy Milan boxes with weird rails for cheap on ebay because the firmware only loads OpenSolaris.</div><br/></div></div><div id="39836543" class="c"><input type="checkbox" id="c-39836543" checked=""/><div class="controls bullet"><span class="by">breakingcups</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39833895">prev</a><span>|</span><a href="#39835823">next</a><span>|</span><label class="collapse" for="c-39836543">[-]</label><label class="expand" for="c-39836543">[1 more]</label></div><br/><div class="children"><div class="content">Not only is that not really relevant, but I&#x27;d argue Tailscale is actually very useful even to many people who don&#x27;t feel like they currently &quot;need&quot; it.</div><br/></div></div><div id="39835823" class="c"><input type="checkbox" id="c-39835823" checked=""/><div class="controls bullet"><span class="by">StressedDev</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39836543">prev</a><span>|</span><a href="#39833866">next</a><span>|</span><label class="collapse" for="c-39835823">[-]</label><label class="expand" for="c-39835823">[1 more]</label></div><br/><div class="children"><div class="content">OK, this comment was not really helpful.  The article described some really interesting tech.  Trashing tech or people who are excited by it does not really make things better.</div><br/></div></div><div id="39833866" class="c"><input type="checkbox" id="c-39833866" checked=""/><div class="controls bullet"><span class="by">always2slow</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39835823">prev</a><span>|</span><a href="#39834872">next</a><span>|</span><label class="collapse" for="c-39833866">[-]</label><label class="expand" for="c-39833866">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s ok to have heroes.</div><br/></div></div><div id="39834872" class="c"><input type="checkbox" id="c-39834872" checked=""/><div class="controls bullet"><span class="by">pstuart</span><span>|</span><a href="#39833295">root</a><span>|</span><a href="#39833820">parent</a><span>|</span><a href="#39833866">prev</a><span>|</span><a href="#39834450">next</a><span>|</span><label class="collapse" for="c-39834872">[-]</label><label class="expand" for="c-39834872">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m assuming that 1% will make their efforts worthwhile. It <i>is</i> impressive regardless of whether or not you&#x27;re going to use it.</div><br/></div></div></div></div></div></div><div id="39834450" class="c"><input type="checkbox" id="c-39834450" checked=""/><div class="controls bullet"><span class="by">quasarj</span><span>|</span><a href="#39833295">prev</a><span>|</span><a href="#39833614">next</a><span>|</span><label class="collapse" for="c-39834450">[-]</label><label class="expand" for="c-39834450">[4 more]</label></div><br/><div class="children"><div class="content">Somebody named an OS Hubris? Oh the.. I can&#x27;t even say it</div><br/><div id="39834525" class="c"><input type="checkbox" id="c-39834525" checked=""/><div class="controls bullet"><span class="by">mkeeter</span><span>|</span><a href="#39834450">parent</a><span>|</span><a href="#39835766">next</a><span>|</span><label class="collapse" for="c-39834525">[-]</label><label class="expand" for="c-39834525">[2 more]</label></div><br/><div class="children"><div class="content">You’ll be glad to learn that the debugger is named “humility”:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;humility">https:&#x2F;&#x2F;github.com&#x2F;oxidecomputer&#x2F;humility</a></div><br/><div id="39835978" class="c"><input type="checkbox" id="c-39835978" checked=""/><div class="controls bullet"><span class="by">k0stas</span><span>|</span><a href="#39834450">root</a><span>|</span><a href="#39834525">parent</a><span>|</span><a href="#39835766">next</a><span>|</span><label class="collapse" for="c-39835978">[-]</label><label class="expand" for="c-39835978">[1 more]</label></div><br/><div class="children"><div class="content">And the author of the post is named Cliff L. Biffle, which is one of the best names I have ever heard.</div><br/></div></div></div></div><div id="39835766" class="c"><input type="checkbox" id="c-39835766" checked=""/><div class="controls bullet"><span class="by">cdchn</span><span>|</span><a href="#39834450">parent</a><span>|</span><a href="#39834525">prev</a><span>|</span><a href="#39833614">next</a><span>|</span><label class="collapse" for="c-39835766">[-]</label><label class="expand" for="c-39835766">[1 more]</label></div><br/><div class="children"><div class="content">Seems pretty on-brand.</div><br/></div></div></div></div><div id="39833614" class="c"><input type="checkbox" id="c-39833614" checked=""/><div class="controls bullet"><span class="by">sbt567</span><span>|</span><a href="#39834450">prev</a><span>|</span><a href="#39834083">next</a><span>|</span><label class="collapse" for="c-39833614">[-]</label><label class="expand" for="c-39833614">[1 more]</label></div><br/><div class="children"><div class="content">I adore whatever folks at Oxide does. And this is one of it</div><br/></div></div><div id="39834083" class="c"><input type="checkbox" id="c-39834083" checked=""/><div class="controls bullet"><span class="by">dralley</span><span>|</span><a href="#39833614">prev</a><span>|</span><a href="#39834855">next</a><span>|</span><label class="collapse" for="c-39834083">[-]</label><label class="expand" for="c-39834083">[5 more]</label></div><br/><div class="children"><div class="content">Why&#x2F;when would one use Hubris over something like embassy_rs, or vice-versa?</div><br/><div id="39834235" class="c"><input type="checkbox" id="c-39834235" checked=""/><div class="controls bullet"><span class="by">steveklabnik</span><span>|</span><a href="#39834083">parent</a><span>|</span><a href="#39834855">next</a><span>|</span><label class="collapse" for="c-39834235">[-]</label><label class="expand" for="c-39834235">[4 more]</label></div><br/><div class="children"><div class="content">Hubris has some particular design constraints that allow it to do interesting things, but also may disqualify it for certain projects. The main one is that everything is static, ahead of time: you set up tasks when you build the OS and the tasks, there&#x27;s no &quot;spawn new task&quot; sort of APIs.<p>Another difference is that Hubris does not use async Rust, and embassy does. That may be something you desire either way. We don&#x27;t believe async Rust is bad (heck it&#x27;s used further up the stack quite a bit) but it wasn&#x27;t a fit for this project.<p>The documentation explains the design goals: <a href="https:&#x2F;&#x2F;hubris.oxide.computer&#x2F;reference&#x2F;" rel="nofollow">https:&#x2F;&#x2F;hubris.oxide.computer&#x2F;reference&#x2F;</a><p>Doesn&#x27;t mean embassy isn&#x27;t good too, it&#x27;s just different.</div><br/><div id="39835825" class="c"><input type="checkbox" id="c-39835825" checked=""/><div class="controls bullet"><span class="by">StressedDev</span><span>|</span><a href="#39834083">root</a><span>|</span><a href="#39834235">parent</a><span>|</span><a href="#39836486">next</a><span>|</span><label class="collapse" for="c-39835825">[-]</label><label class="expand" for="c-39835825">[2 more]</label></div><br/><div class="children"><div class="content">Thank you for the thoughtful reply.  I really appreciated it.</div><br/><div id="39835995" class="c"><input type="checkbox" id="c-39835995" checked=""/><div class="controls bullet"><span class="by">steveklabnik</span><span>|</span><a href="#39834083">root</a><span>|</span><a href="#39835825">parent</a><span>|</span><a href="#39836486">next</a><span>|</span><label class="collapse" for="c-39835995">[-]</label><label class="expand" for="c-39835995">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re welcome!</div><br/></div></div></div></div><div id="39836486" class="c"><input type="checkbox" id="c-39836486" checked=""/><div class="controls bullet"><span class="by">MrBuddyCasino</span><span>|</span><a href="#39834083">root</a><span>|</span><a href="#39834235">parent</a><span>|</span><a href="#39835825">prev</a><span>|</span><a href="#39834855">next</a><span>|</span><label class="collapse" for="c-39836486">[-]</label><label class="expand" for="c-39836486">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Hubris does not use async Rust, and embassy does</i><p>As much as I understand why you&#x27;d want async on an MCU for efficiency reasons, I&#x27;m very glad there is now a good option without it.<p>I wonder what the Hubris team thinks of rtic and its design.</div><br/></div></div></div></div></div></div><div id="39834855" class="c"><input type="checkbox" id="c-39834855" checked=""/><div class="controls bullet"><span class="by">0xfedbee</span><span>|</span><a href="#39834083">prev</a><span>|</span><label class="collapse" for="c-39834855">[-]</label><label class="expand" for="c-39834855">[7 more]</label></div><br/><div class="children"><div class="content">Moral of the story: using Rust will not automatically make your code bug proof. It can actually introduce bugs that are of totally new breed and hard to debug.</div><br/><div id="39835014" class="c"><input type="checkbox" id="c-39835014" checked=""/><div class="controls bullet"><span class="by">eigenform</span><span>|</span><a href="#39834855">parent</a><span>|</span><a href="#39835287">next</a><span>|</span><label class="collapse" for="c-39835014">[-]</label><label class="expand" for="c-39835014">[1 more]</label></div><br/><div class="children"><div class="content">I know you&#x27;re intentionally spinning this as a bad thing, but it&#x27;s really not.<p>Instead of worrying about simple and very common classes of bugs that can be solved statically with the help of the compiler, you are free to worry about whatever other non-trivial bugs in your program are remaining.<p>You&#x27;re obviously free to waste your own time if you&#x27;d like.</div><br/></div></div><div id="39835287" class="c"><input type="checkbox" id="c-39835287" checked=""/><div class="controls bullet"><span class="by">nemothekid</span><span>|</span><a href="#39834855">parent</a><span>|</span><a href="#39835014">prev</a><span>|</span><a href="#39835828">next</a><span>|</span><label class="collapse" for="c-39835287">[-]</label><label class="expand" for="c-39835287">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know, the fact that a buggy memory allocator implementation <i>crashed</i> rather than silently worked until it became a CVE seems like a win to me.</div><br/></div></div><div id="39835828" class="c"><input type="checkbox" id="c-39835828" checked=""/><div class="controls bullet"><span class="by">StressedDev</span><span>|</span><a href="#39834855">parent</a><span>|</span><a href="#39835287">prev</a><span>|</span><a href="#39834982">next</a><span>|</span><label class="collapse" for="c-39835828">[-]</label><label class="expand" for="c-39835828">[1 more]</label></div><br/><div class="children"><div class="content">Nope - This bug was not caused by the language.  Also, no one has ever claimed Rust is perfect.  What people are claiming is it is a good alternative to C&#x2F;C++ which prevents a lot of common errors like buffer overflows.</div><br/></div></div><div id="39834982" class="c"><input type="checkbox" id="c-39834982" checked=""/><div class="controls bullet"><span class="by">kibwen</span><span>|</span><a href="#39834855">parent</a><span>|</span><a href="#39835828">prev</a><span>|</span><a href="#39835665">next</a><span>|</span><label class="collapse" for="c-39834982">[-]</label><label class="expand" for="c-39834982">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure I see where the bug here is due to Rust, or of a totally new breed. And the latter half of the blog post notes that it was fixed less than three hours after first being noticed.</div><br/><div id="39836121" class="c"><input type="checkbox" id="c-39836121" checked=""/><div class="controls bullet"><span class="by">rablackburn</span><span>|</span><a href="#39834855">root</a><span>|</span><a href="#39834982">parent</a><span>|</span><a href="#39835665">next</a><span>|</span><label class="collapse" for="c-39836121">[-]</label><label class="expand" for="c-39836121">[1 more]</label></div><br/><div class="children"><div class="content">And to quote the article itself:<p>&gt;&gt; (…) it’s a rare case of a kernel memory access check bug that had no security implications.<p>My favourite type of kernel bug.</div><br/></div></div></div></div><div id="39835665" class="c"><input type="checkbox" id="c-39835665" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#39834855">parent</a><span>|</span><a href="#39834982">prev</a><span>|</span><label class="collapse" for="c-39835665">[-]</label><label class="expand" for="c-39835665">[1 more]</label></div><br/><div class="children"><div class="content">This example showed an introduced bug that was easy to debug, though.</div><br/></div></div></div></div></div></div></div></div></div></body></html>