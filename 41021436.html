<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1721552453418" as="style"/><link rel="stylesheet" href="styles.css?v=1721552453418"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/ADD-SP/json-threat-protection.rs">Show HN: JSON-Threat-Protection Rust High-Performance Crate</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>ADD-SP</span> | <span>11 comments</span></div><br/><div><div id="41022331" class="c"><input type="checkbox" id="c-41022331" checked=""/><div class="controls bullet"><span class="by">anonymoushn</span><span>|</span><a href="#41021640">next</a><span>|</span><label class="collapse" for="c-41022331">[-]</label><label class="expand" for="c-41022331">[2 more]</label></div><br/><div class="children"><div class="content">For things that are claimed to be high-performance, it would be helpful to see some numbers without running it locally on our own json files.</div><br/><div id="41023426" class="c"><input type="checkbox" id="c-41023426" checked=""/><div class="controls bullet"><span class="by">ADD-SP</span><span>|</span><a href="#41022331">parent</a><span>|</span><a href="#41021640">next</a><span>|</span><label class="collapse" for="c-41023426">[-]</label><label class="expand" for="c-41023426">[1 more]</label></div><br/><div class="children"><div class="content">Makes sense, numbers added.</div><br/></div></div></div></div><div id="41021640" class="c"><input type="checkbox" id="c-41021640" checked=""/><div class="controls bullet"><span class="by">blirio</span><span>|</span><a href="#41022331">prev</a><span>|</span><a href="#41021807">next</a><span>|</span><label class="collapse" for="c-41021640">[-]</label><label class="expand" for="c-41021640">[5 more]</label></div><br/><div class="children"><div class="content">&quot;Whether to allow duplicate object entry names.&quot; This is interesting. I just did a test and it look like `jq` evaluates `{ &quot;a&quot;: 1, &quot;a&quot;: 2 }` to just `{ &quot;a&quot;: 2 }`. I have always thought that this was invalid JSON. This mean that the order of keys in JSON do have some semantic meaning.</div><br/><div id="41021719" class="c"><input type="checkbox" id="c-41021719" checked=""/><div class="controls bullet"><span class="by">ADD-SP</span><span>|</span><a href="#41021640">parent</a><span>|</span><a href="#41021710">next</a><span>|</span><label class="collapse" for="c-41021719">[-]</label><label class="expand" for="c-41021719">[2 more]</label></div><br/><div class="children"><div class="content">The JSON RFC (<a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8259#page-6" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8259#page-6</a>) doesn&#x27;t require the unique entry name, and also the fact is that many parser uses the last-win strategy like serde_json.<p>For human, this is invalid, but many web services accepts this kind of JSON consciously or unconsciously.<p>I&#x27;m guessing this may have become a feature of some services and it&#x27;s hard for maintainers to break this behavior. ᵕ︵ᵕ</div><br/><div id="41022794" class="c"><input type="checkbox" id="c-41022794" checked=""/><div class="controls bullet"><span class="by">rmetzler</span><span>|</span><a href="#41021640">root</a><span>|</span><a href="#41021719">parent</a><span>|</span><a href="#41021710">next</a><span>|</span><label class="collapse" for="c-41022794">[-]</label><label class="expand" for="c-41022794">[1 more]</label></div><br/><div class="children"><div class="content">For security researchers it’s also interesting which implementations parse with first-win strategy and which allow comments (I think Ruby does this).</div><br/></div></div></div></div><div id="41021710" class="c"><input type="checkbox" id="c-41021710" checked=""/><div class="controls bullet"><span class="by">scottlamb</span><span>|</span><a href="#41021640">parent</a><span>|</span><a href="#41021719">prev</a><span>|</span><a href="#41021807">next</a><span>|</span><label class="collapse" for="c-41021710">[-]</label><label class="expand" for="c-41021710">[2 more]</label></div><br/><div class="children"><div class="content">Interestingly, ECMA-404 says the following:<p>&gt; The goal of this specification is only to define the syntax of valid JSON texts. Its intent is not to provide any semantics or interpretation of text conforming to that syntax.<p>So it is legal JSON although not useful with a lot of concrete implementations. Maybe a way to find an exciting security vulnerability involving two parsers differing in their interpretation...</div><br/><div id="41021752" class="c"><input type="checkbox" id="c-41021752" checked=""/><div class="controls bullet"><span class="by">ADD-SP</span><span>|</span><a href="#41021640">root</a><span>|</span><a href="#41021710">parent</a><span>|</span><a href="#41021807">next</a><span>|</span><label class="collapse" for="c-41021752">[-]</label><label class="expand" for="c-41021752">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps checking a service&#x27;s behavior in response to such JSON is high on the security researcher&#x27;s list of things to do that are high priority and simple.<p>&quot;( – ⌓ – )</div><br/></div></div></div></div></div></div><div id="41021807" class="c"><input type="checkbox" id="c-41021807" checked=""/><div class="controls bullet"><span class="by">peterkelly</span><span>|</span><a href="#41021640">prev</a><span>|</span><label class="collapse" for="c-41021807">[-]</label><label class="expand" for="c-41021807">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;lexi-lambda.github.io&#x2F;blog&#x2F;2019&#x2F;11&#x2F;05&#x2F;parse-don-t-validate&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lexi-lambda.github.io&#x2F;blog&#x2F;2019&#x2F;11&#x2F;05&#x2F;parse-don-t-va...</a></div><br/><div id="41022581" class="c"><input type="checkbox" id="c-41022581" checked=""/><div class="controls bullet"><span class="by">kstenerud</span><span>|</span><a href="#41021807">parent</a><span>|</span><a href="#41022357">next</a><span>|</span><label class="collapse" for="c-41022581">[-]</label><label class="expand" for="c-41022581">[1 more]</label></div><br/><div class="children"><div class="content">I think you may have misunderstood the article.<p>The point of the article is to parse AND validate input AT THE BOUNDARY between the outside world and your program, rather than a bunch of ad-hoc validations at various points after the suspect data has entered the castle walls and has already been (at least partially) processed (thus making the program state harder to reason about). By enforcing your invariants at the border, you ensure that all data entering your system always conforms to your expectations, just like a strong type system ensures that invalid states are not representable. A schema is basically a type system for your raw data.<p>This concept is also a major element of Domain Driven Design <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Domain-driven_design" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Domain-driven_design</a></div><br/></div></div><div id="41022357" class="c"><input type="checkbox" id="c-41022357" checked=""/><div class="controls bullet"><span class="by">ADD-SP</span><span>|</span><a href="#41021807">parent</a><span>|</span><a href="#41022581">prev</a><span>|</span><label class="collapse" for="c-41022357">[-]</label><label class="expand" for="c-41022357">[1 more]</label></div><br/><div class="children"><div class="content">Great to see this article, I totally agreed with the view that rejecting any invalid case by designing the right data structure.<p>Unfortunately, it is hard to achieve it in practice and people even don&#x27;t realize this, JSON Object is a good example, Human are incline expecting the duplicated key is not allowed in JSON, but it happens.<p>For this goal, I think the Protobuf is good way to eliminate the possible invalid data for data transportation.</div><br/></div></div></div></div></div></div></div></div></div></body></html>