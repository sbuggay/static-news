<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1716886857253" as="style"/><link rel="stylesheet" href="styles.css?v=1716886857253"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://maskray.me/blog/2024-05-26-evolution-of-elf-object-file-format">Evolution of the ELF object file format</a> <span class="domain">(<a href="https://maskray.me">maskray.me</a>)</span></div><div class="subtext"><span>MaskRay</span> | <span>46 comments</span></div><br/><div><div id="40486361" class="c"><input type="checkbox" id="c-40486361" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40491918">next</a><span>|</span><label class="collapse" for="c-40486361">[-]</label><label class="expand" for="c-40486361">[37 more]</label></div><br/><div class="children"><div class="content">A few folks have asked me the generic ABI status (unmaintained?) and the availability of an up-to-date specification (no). I compiled “History” and “Evolution of the generic ABI” in the blog post.<p>I have two specific questions:<p>- Key features (symbol visibility, section groups, SHF_MERGE, etc) were all available as of April 2001. Where can we find the discussion mailing lists? Are they still available?<p>- How does the ABI end up being “All rights reserved” by SCO? Tool Interface Standard (TIS) Portable Formats Specification, version 1.2 effectively put the specification in the public domain.</div><br/><div id="40490828" class="c"><input type="checkbox" id="c-40490828" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">parent</a><span>|</span><a href="#40490322">next</a><span>|</span><label class="collapse" for="c-40490828">[-]</label><label class="expand" for="c-40490828">[17 more]</label></div><br/><div class="children"><div class="content">One of the things I&#x27;ve been (very slowly) putting together is a master list of all the references one needs to build a compiler toolchain--such as processor ISA manuals, ABI specifications, language standards, even things like IEEE 754 or DWARF.<p>While IEEE 754 is an issue because it&#x27;s not freely available for most people, the only document that has truly stumped me is the ELF specification. From your blog post, it seems like my failure to find the most up-to-date specification is simply because one <i>doesn&#x27;t exist.</i></div><br/><div id="40492458" class="c"><input type="checkbox" id="c-40492458" checked=""/><div class="controls bullet"><span class="by">marssaxman</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40490828">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40492458">[-]</label><label class="expand" for="c-40492458">[6 more]</label></div><br/><div class="children"><div class="content">Are you familiar with the OSDev wiki? Perhaps their list of links will be helpful:<p><a href="https:&#x2F;&#x2F;wiki.osdev.org&#x2F;ELF#External_Links" rel="nofollow">https:&#x2F;&#x2F;wiki.osdev.org&#x2F;ELF#External_Links</a></div><br/><div id="40492701" class="c"><input type="checkbox" id="c-40492701" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40492458">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40492701">[-]</label><label class="expand" for="c-40492701">[5 more]</label></div><br/><div class="children"><div class="content">That wiki&#x27;s list of links isn&#x27;t always the most up-to-date.</div><br/><div id="40495037" class="c"><input type="checkbox" id="c-40495037" checked=""/><div class="controls bullet"><span class="by">marssaxman</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40492701">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40495037">[-]</label><label class="expand" for="c-40495037">[4 more]</label></div><br/><div class="children"><div class="content">How often does anyone change the ELF file format, though?<p>No matter; but that&#x27;s the most up-to-date list of references I know about.</div><br/><div id="40495526" class="c"><input type="checkbox" id="c-40495526" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495037">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40495526">[-]</label><label class="expand" for="c-40495526">[3 more]</label></div><br/><div class="children"><div class="content">The ELF format isn&#x27;t the one that I&#x27;m the most concerned about, but for example compressed sections were updated in the past decade. The ABI for x86-64 is out-of-date (actually, the site it links to is now a 404, but my recollection was that was a version around 2013)--missing things like _Float16 rules, DWARF register naming for AMX and APX registers, microarchitecture levels, new relocation types,</div><br/><div id="40495631" class="c"><input type="checkbox" id="c-40495631" checked=""/><div class="controls bullet"><span class="by">khuey</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495526">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40495631">[-]</label><label class="expand" for="c-40495631">[2 more]</label></div><br/><div class="children"><div class="content">The up to date ABI for x86-64 lives at <a href="https:&#x2F;&#x2F;gitlab.com&#x2F;x86-psABIs&#x2F;x86-64-ABI" rel="nofollow">https:&#x2F;&#x2F;gitlab.com&#x2F;x86-psABIs&#x2F;x86-64-ABI</a></div><br/><div id="40495749" class="c"><input type="checkbox" id="c-40495749" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495631">parent</a><span>|</span><a href="#40493749">next</a><span>|</span><label class="collapse" for="c-40495749">[-]</label><label class="expand" for="c-40495749">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m aware of that (and peeved that they&#x27;ve got runners set up for the x86-64 ABI but not the i386 ABI, so there&#x27;s no nice PDF version of the i386 version I can use).</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40493749" class="c"><input type="checkbox" id="c-40493749" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40490828">parent</a><span>|</span><a href="#40492458">prev</a><span>|</span><a href="#40493722">next</a><span>|</span><label class="collapse" for="c-40493749">[-]</label><label class="expand" for="c-40493749">[7 more]</label></div><br/><div class="children"><div class="content">Thank you! This will be very useful. Yes, for C&#x2F;C++ one needs:<p>* ISA manual
* ELF (generic ABI, psABI (e.g. x86-64-psABI), OSABI)
* DWARF
* Floating-point
* Language standards
* Itanium C++ ABI<p>and probably a few other stuff.<p>&gt; it seems like my failure to find the most up-to-date specification is simply because one doesn&#x27;t exist.<p>While the up-to-date specification is unavailable, hopefully it is not too bad because all essential features have been completed as of 2001:)<p>RELR is a linker and loader feature, not on the compiler side.
Compressed debug sections are a pretty natural extension.</div><br/><div id="40494146" class="c"><input type="checkbox" id="c-40494146" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40493749">parent</a><span>|</span><a href="#40493722">next</a><span>|</span><label class="collapse" for="c-40494146">[-]</label><label class="expand" for="c-40494146">[6 more]</label></div><br/><div class="children"><div class="content">I file things like linkers, loaders, and debuggers into the same bucket as compilers, so all of the ELF extensions are interesting to me, even if compilers directly don&#x27;t interact with them. I&#x27;m also interested in things like the loader-debugger rendezvous interface. Basically any document anyone who touches any project in llvm-project might need to read.<p>And then there are things like the layout of .gcc_except_table, which are undocumented except for random blog posts.</div><br/><div id="40495976" class="c"><input type="checkbox" id="c-40495976" checked=""/><div class="controls bullet"><span class="by">matt_d</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40494146">parent</a><span>|</span><a href="#40496792">next</a><span>|</span><label class="collapse" for="c-40495976">[-]</label><label class="expand" for="c-40495976">[1 more]</label></div><br/><div class="children"><div class="content">In case this is of interest, here&#x27;s an attempt at gathering the references, including random blog posts (as well as articles, documentation, papers, software, and talks), on these topics:<p>- assembly &amp; ISA (instruction set architecture):<p>- Arm: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.arm.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.arm....</a><p>- RISC-V: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.riscv.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.risc...</a><p>- x86: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.x86.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;assembly.x86....</a><p>- debugging: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;debugging.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;debugging.md</a><p>- debugging: tracing: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;debugging.tracing.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;debugging.tra...</a><p>- executable and object file formats (ELF, Mach-O, PE); debugging data formats (DWARF, PDB): <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;executables.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;executables.m...</a><p>- linking and loading: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;executables.linking_loading.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;executables.l...</a><p>- compilers: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;compilers.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;compilers.md</a><p>- compilers correctness: <a href="https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;compilers.correctness.md">https:&#x2F;&#x2F;github.com&#x2F;MattPD&#x2F;cpplinks&#x2F;blob&#x2F;master&#x2F;compilers.cor...</a></div><br/></div></div><div id="40496792" class="c"><input type="checkbox" id="c-40496792" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40494146">parent</a><span>|</span><a href="#40495976">prev</a><span>|</span><a href="#40495713">next</a><span>|</span><label class="collapse" for="c-40496792">[-]</label><label class="expand" for="c-40496792">[1 more]</label></div><br/><div class="children"><div class="content">&gt; even if compilers directly don&#x27;t interact with them<p>Essentially they do as they put directives into the asm files to put things in specific sections, to define certain symbol visibility etc all of which depend on the object file format (e.g. a classic BSD a.out file, using a format I called “a.out” in BFD, can’t represent most of that).  So the compiler does need to know.  And the assembler absolutely needs to know since it generates object files!<p>So yes an a.out file can be an ELF file (always is on Linux) or could be an “a.out” file.  Sorry!  In retrospect I should have called that format “bsd”.</div><br/></div></div><div id="40495713" class="c"><input type="checkbox" id="c-40495713" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40494146">parent</a><span>|</span><a href="#40496792">prev</a><span>|</span><a href="#40493722">next</a><span>|</span><label class="collapse" for="c-40495713">[-]</label><label class="expand" for="c-40495713">[3 more]</label></div><br/><div class="children"><div class="content">&gt; there are things like the layout of .gcc_except_table, which are undocumented except for random blog posts.<p>The way I dealt with it was write an ELF dumper for the tables, and then run various C++ code snippets through g++ and look at how the tables were constructed.</div><br/><div id="40496796" class="c"><input type="checkbox" id="c-40496796" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495713">parent</a><span>|</span><a href="#40493722">next</a><span>|</span><label class="collapse" for="c-40496796">[-]</label><label class="expand" for="c-40496796">[2 more]</label></div><br/><div class="children"><div class="content">You could just have called objdump — that’s what it’s for.</div><br/><div id="40496986" class="c"><input type="checkbox" id="c-40496986" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40496796">parent</a><span>|</span><a href="#40493722">next</a><span>|</span><label class="collapse" for="c-40496986">[-]</label><label class="expand" for="c-40496986">[1 more]</label></div><br/><div class="children"><div class="content">I like mine better :-&#x2F;<p>The same executable will also detect and dump Elf, Mach, MScoff, and OMF object files.<p>Besides, one doesn&#x27;t learn anything about how to decode the format by using an existing tool that presents it in decoded form.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40493722" class="c"><input type="checkbox" id="c-40493722" checked=""/><div class="controls bullet"><span class="by">agent281</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40490828">parent</a><span>|</span><a href="#40493749">prev</a><span>|</span><a href="#40490322">next</a><span>|</span><label class="collapse" for="c-40493722">[-]</label><label class="expand" for="c-40493722">[3 more]</label></div><br/><div class="children"><div class="content">Are you going to make this list of resources available online or is it for personal consumption only?</div><br/><div id="40494181" class="c"><input type="checkbox" id="c-40494181" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40493722">parent</a><span>|</span><a href="#40490322">next</a><span>|</span><label class="collapse" for="c-40494181">[-]</label><label class="expand" for="c-40494181">[2 more]</label></div><br/><div class="children"><div class="content">So far, the list of resources is a collection of PDFs I&#x27;ve downloaded plus a script to download the latest version of every relevant specification. (Although it does seem that Intel likes breaking its links to the latest ISA PDF every now and then). I don&#x27;t have a great solution for things that are essentially web-only pages, which is how the Itanium ABI is handled (and unlike C, C++ makes it hard to find the relevant working draft copies, instead preferring to use the HTML-based <a href="https:&#x2F;&#x2F;eel.is&#x2F;c++draft" rel="nofollow">https:&#x2F;&#x2F;eel.is&#x2F;c++draft</a> for that).<p>I probably will make it publicly available eventually, it just hasn&#x27;t been a priority for me.</div><br/><div id="40497237" class="c"><input type="checkbox" id="c-40497237" checked=""/><div class="controls bullet"><span class="by">int_19h</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40494181">parent</a><span>|</span><a href="#40490322">next</a><span>|</span><label class="collapse" for="c-40497237">[-]</label><label class="expand" for="c-40497237">[1 more]</label></div><br/><div class="children"><div class="content">The most widespread standard for archiving collections of web pages is WARC - it is a publicly available ISO standard so it&#x27;s very future-proof. WACZ (<a href="https:&#x2F;&#x2F;specs.webrecorder.net&#x2F;wacz&#x2F;1.1.1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;specs.webrecorder.net&#x2F;wacz&#x2F;1.1.1&#x2F;</a>) is a more recent take that is basically zipped WARC + index + metadata, and Internet Archive can generate them when archiving is requested (<a href="https:&#x2F;&#x2F;web.archive.org&#x2F;save&#x2F;" rel="nofollow">https:&#x2F;&#x2F;web.archive.org&#x2F;save&#x2F;</a>).<p><i>In addition</i> to that, I would also suggest using <a href="https:&#x2F;&#x2F;zimit.kiwix.org" rel="nofollow">https:&#x2F;&#x2F;zimit.kiwix.org</a>. It&#x27;s a very compact representation that has full text index support for convenient searching, the format is open and documented, and first-party readers are available on all major platforms. And for stuff like this, Kiwix might actually be interested in adding them to their official library at <a href="https:&#x2F;&#x2F;library.kiwix.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;library.kiwix.org&#x2F;</a> if you contact them.</div><br/></div></div></div></div></div></div></div></div><div id="40490322" class="c"><input type="checkbox" id="c-40490322" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#40486361">parent</a><span>|</span><a href="#40490828">prev</a><span>|</span><a href="#40496151">next</a><span>|</span><label class="collapse" for="c-40490322">[-]</label><label class="expand" for="c-40490322">[12 more]</label></div><br/><div class="children"><div class="content">&gt; How does the ABI end up being “All rights reserved” by SCO?<p>Text of the spec is copyrighted by the SCO, they did not put it in public domain. That&#x27;s what &quot;All rights reserved&quot; was intended to mean even though this phrase has not been meaning anything since 2000.</div><br/><div id="40491547" class="c"><input type="checkbox" id="c-40491547" checked=""/><div class="controls bullet"><span class="by">vintagedave</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40490322">parent</a><span>|</span><a href="#40491479">next</a><span>|</span><label class="collapse" for="c-40491547">[-]</label><label class="expand" for="c-40491547">[7 more]</label></div><br/><div class="children"><div class="content">It&#x27;s concerning that a huge open source ecosystem like Linux depends on a closed specification. That is, I read it as that the spec cannot be continued, developed, and evolved or republished without full redefinition and respecification.<p>Has anyone looked at creating a new object format for Linux? A non-open spec seems a minor issue, really, in an era when we put binary blobs in the kernel (hi Nvidia.) But the more decades I work in closed source, the more I value open source, and believe keeping _everything_ open.</div><br/><div id="40494327" class="c"><input type="checkbox" id="c-40494327" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40491547">parent</a><span>|</span><a href="#40494748">next</a><span>|</span><label class="collapse" for="c-40494327">[-]</label><label class="expand" for="c-40494327">[5 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t think you&#x27;d need to create a new format, just write up a spec of what all available FOSS implementations are actually doing and agree that that&#x27;s the standard going forward. Between Linux&#x2F;*BSD&#x2F;illumos you should be able to pretty completely describe all currently-active uses of ELF.<p>(Of course this assumes that doing this is sufficient to make it legally not derived from the original spec as far as copyright law cares about, which is beyond my non-lawyer ability to be that confident in.)</div><br/><div id="40495896" class="c"><input type="checkbox" id="c-40495896" checked=""/><div class="controls bullet"><span class="by">skissane</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40494327">parent</a><span>|</span><a href="#40494748">next</a><span>|</span><label class="collapse" for="c-40495896">[-]</label><label class="expand" for="c-40495896">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Between Linux&#x2F;*BSD&#x2F;illumos you should be able to pretty completely describe all currently-active uses of ELF.<p>OpenVMS uses ELF too. Rather niche proprietary OS but still maintained and in production use. (Not a new thing with x86-64 port, ELF was adopted during the Alpha to Iranian transition.)<p>As do many RTOS (both open source and proprietary)</div><br/><div id="40496768" class="c"><input type="checkbox" id="c-40496768" checked=""/><div class="controls bullet"><span class="by">Iwan-Zotow</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495896">parent</a><span>|</span><a href="#40494748">next</a><span>|</span><label class="collapse" for="c-40496768">[-]</label><label class="expand" for="c-40496768">[3 more]</label></div><br/><div class="children"><div class="content">To WHAT transition?</div><br/><div id="40497500" class="c"><input type="checkbox" id="c-40497500" checked=""/><div class="controls bullet"><span class="by">skissane</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40496768">parent</a><span>|</span><a href="#40496866">next</a><span>|</span><label class="collapse" for="c-40497500">[-]</label><label class="expand" for="c-40497500">[1 more]</label></div><br/><div class="children"><div class="content">I typed Itanium and my phone very helpfully “corrected” it to Iranian and unfortunately I didn’t notice it had done so</div><br/></div></div><div id="40496866" class="c"><input type="checkbox" id="c-40496866" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40496768">parent</a><span>|</span><a href="#40497500">prev</a><span>|</span><a href="#40494748">next</a><span>|</span><label class="collapse" for="c-40496866">[-]</label><label class="expand" for="c-40496866">[1 more]</label></div><br/><div class="children"><div class="content">Lol. Although, <i>Itanium</i> does have an entertaining history of having caused a lot of positive changes even though it crashed and burned itself - it&#x27;s where we got UEFI, and apparently a good time for some OSs to pick up ELF.</div><br/></div></div></div></div></div></div></div></div><div id="40494748" class="c"><input type="checkbox" id="c-40494748" checked=""/><div class="controls bullet"><span class="by">aseipp</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40491547">parent</a><span>|</span><a href="#40494327">prev</a><span>|</span><a href="#40491479">next</a><span>|</span><label class="collapse" for="c-40494748">[-]</label><label class="expand" for="c-40494748">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Has anyone looked at creating a new object format for Linux?<p>No, because that&#x27;s overkill for this problem, because the <i>de facto</i> standard is &quot;What do modern free Unicies do&quot;, where those are basically Linux&#x2F;BSD&#x2F;Illumos. Besides, it&#x27;s not unheard of in Unix history to have free implementations of proprietary standards, where those implementations became de facto standards anyway.<p>Even if it was a seriously pressing issue, writing a new specification that covers ELF as it exists today is going to be many, many, many times easier than introducing a new executable format across the ecosystem, they&#x27;re not even in the same league or sport in terms of effort. If you were going to introduce a whole new object file format it would be much better to do it and justify it on the basis of fundamental technical&#x2F;architectural changes.</div><br/></div></div></div></div><div id="40491479" class="c"><input type="checkbox" id="c-40491479" checked=""/><div class="controls bullet"><span class="by">LegionMammal978</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40490322">parent</a><span>|</span><a href="#40491547">prev</a><span>|</span><a href="#40496151">next</a><span>|</span><label class="collapse" for="c-40491479">[-]</label><label class="expand" for="c-40491479">[4 more]</label></div><br/><div class="children"><div class="content">Yeah, it&#x27;s not like they could copyright the ELF format anyway, only that particular description, or any particular implementation they had. Pretty much everyone seems to agree that file formats themselves aren&#x27;t copyrightable expression, though I have trouble finding any U.S. case law to that effect.<p>(Personally, that makes me a bit uneasy: for instance, if the copyrighted spec lists the file sections in a certain order, and your implementation happens to output them in the same order even if it doesn&#x27;t have to, then have you infringed on the owner&#x27;s copyright of that particular arrangement?)<p>Meanwhile, they could have gotten a patent on (some parts of) the format, but that doesn&#x27;t seem to be the case here.</div><br/><div id="40493498" class="c"><input type="checkbox" id="c-40493498" checked=""/><div class="controls bullet"><span class="by">Veserv</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40491479">parent</a><span>|</span><a href="#40493944">next</a><span>|</span><label class="collapse" for="c-40493498">[-]</label><label class="expand" for="c-40493498">[2 more]</label></div><br/><div class="children"><div class="content">The rule in general (not just for software) is that patents are for functional elements where as copyrights are for non-functional elements; they are exclusive, a element can only be patentable or copyrightable, not both.<p>If it is necessary for operation or inter-operation [1] then they can probably not enforce copyright or trademark.<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sega_v._Accolade" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sega_v._Accolade</a></div><br/><div id="40493975" class="c"><input type="checkbox" id="c-40493975" checked=""/><div class="controls bullet"><span class="by">LegionMammal978</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40493498">parent</a><span>|</span><a href="#40493944">next</a><span>|</span><label class="collapse" for="c-40493975">[-]</label><label class="expand" for="c-40493975">[1 more]</label></div><br/><div class="children"><div class="content">Sure, but usually in any file format, an encoder has some choice in how to produce its output, with no functional difference either way. For instance, different PNG encoders might include the necessary chunks in a different order in the file. And my concern is that some such choices, if they align with choices described in the copyrighted spec, might be protectable as a creative arrangement or similar. (E.g., a spec might list the chunks in such an order that their names form a creative acronym.)<p>Of course, the defense against this would be to scramble (or normalize) all non-functional choices compared to anything in the spec. But you have to be careful to make sure there&#x27;s nothing left of the spec&#x27;s non-functional influence.<p>At least <i>Oracle v. Google</i> appears to provide some ammunition here in favor of implementers: the court found the transformative use in that case enough to trump even the byte-for-byte copying of the API signatures. So perhaps interoperability could similarly trump such non-functional copying from the spec. But overall, it&#x27;s still on shakier ground than I&#x27;d like.</div><br/></div></div></div></div><div id="40493944" class="c"><input type="checkbox" id="c-40493944" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40491479">parent</a><span>|</span><a href="#40493498">prev</a><span>|</span><a href="#40496151">next</a><span>|</span><label class="collapse" for="c-40493944">[-]</label><label class="expand" for="c-40493944">[1 more]</label></div><br/><div class="children"><div class="content">I feel that The SCO Group&#x27;s role in the evolution of the System V ABI seems to have been more of a curator&#x2F;editor than an innovator, inheriting the System V ABI from previous entities.
Given that the Tool Interface Standard (TIS) Committee has essentially released the ELF-related chapters into the public domain, and others have made changes,
it&#x27;s unclear what specific rights The SCO Group (and now Xinuos) could claim to reserve.
(That said, their maintenance work needs to be remembered.)</div><br/></div></div></div></div></div></div><div id="40496151" class="c"><input type="checkbox" id="c-40496151" checked=""/><div class="controls bullet"><span class="by">trws</span><span>|</span><a href="#40486361">parent</a><span>|</span><a href="#40490322">prev</a><span>|</span><a href="#40495694">next</a><span>|</span><label class="collapse" for="c-40496151">[-]</label><label class="expand" for="c-40496151">[2 more]</label></div><br/><div class="children"><div class="content">I fell very far down this rabbit hole trying to figure out the history of library link orders and symbol resolution. One fun outcome of which was finding that the first ever public release of a manpage for ld.so on Linux listed RPATH as deprecated. Finding mailing lists from before the source ware transition is hard, some of it exists if you follow the path back to the Solaris forums, but only some. I’ll look through my archives for the features you listed, but I don’t think I uncovered anything about them specifically. Good luck!</div><br/><div id="40498234" class="c"><input type="checkbox" id="c-40498234" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40496151">parent</a><span>|</span><a href="#40495694">next</a><span>|</span><label class="collapse" for="c-40498234">[-]</label><label class="expand" for="c-40498234">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.sco.com&#x2F;developers&#x2F;gabi&#x2F;latest&#x2F;revision.html" rel="nofollow">https:&#x2F;&#x2F;www.sco.com&#x2F;developers&#x2F;gabi&#x2F;latest&#x2F;revision.html</a> specifies<p>&gt; Second draft published May 3, 1999.
&gt; ...
&gt; New dynamic section tags DT_RUNPATH and DT_FLAGS added. Dynamic section tag DT_RPATH moved to level 2.<p>In glibc, DT_RPATH and DT_RUNPATH have different semantics regarding precedence related to LD_LIBRARY_PATH. In FreeBSD rtld and musl, DT_RPATH and DT_RUNPATH are equivallent.</div><br/></div></div></div></div><div id="40495694" class="c"><input type="checkbox" id="c-40495694" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#40486361">parent</a><span>|</span><a href="#40496151">prev</a><span>|</span><a href="#40497048">next</a><span>|</span><label class="collapse" for="c-40495694">[-]</label><label class="expand" for="c-40495694">[4 more]</label></div><br/><div class="children"><div class="content">The first thing I do when porting to a new platform is build an object file format pretty-printer. It&#x27;s the only way to figure out how it really works.<p>The written specifications for them are often a bit of a fairy tale. The real specification is whatever the local C compiler generates.<p>The other gatekeeper is what the linker will accept. That can sometimes be a nightmare.</div><br/><div id="40495780" class="c"><input type="checkbox" id="c-40495780" checked=""/><div class="controls bullet"><span class="by">rvbissell</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495694">parent</a><span>|</span><a href="#40497048">next</a><span>|</span><label class="collapse" for="c-40495780">[-]</label><label class="expand" for="c-40495780">[3 more]</label></div><br/><div class="children"><div class="content">Do you have any examples of the pretty-printing that you&#x27;ve generated?</div><br/><div id="40496334" class="c"><input type="checkbox" id="c-40496334" checked=""/><div class="controls bullet"><span class="by">WalterBright</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40495780">parent</a><span>|</span><a href="#40497048">next</a><span>|</span><label class="collapse" for="c-40496334">[-]</label><label class="expand" for="c-40496334">[2 more]</label></div><br/><div class="children"><div class="content">I never got around to open sourcing them. But here&#x27;s part of a dump of a .o file:<p><pre><code>    Section 14  .eh_frame  PROGBITS,ALLOC,SIZE=0x0030(48),OFFSET=0x0040,ALIGN=8
      offset = 00000000, length = 0x0014(20)
            CIE_id                      = 00000000
            version                     = 1
            augmentation                = &#x27;zR&#x27;
            code_alignment_factor       = 1
            data_alignment_factor       = -8
            return_address_register     = 16
            Augmentation_Length = 1
                    Address pointer encoding = DW_EH_PE_pcrel|sdata4
            DW_CFA_def_cfa      reg = 7, off = 00000008
            DW_CFA_offset_10    off = 1
            DW_CFA_nop
            DW_CFA_nop
      offset = 00000018, length = 0x0014(20)
            CIE_pointer         = 0000001c offset 00000000
            augmentation                = &#x27;zR&#x27;
            PC_Begin            = 0
            PC_Range            = 6
            Augmentation_Length = 0
            DW_CFA_nop
            DW_CFA_nop
            DW_CFA_nop
            DW_CFA_nop
            DW_CFA_nop
            DW_CFA_nop
            DW_CFA_nop
     0040:  14  0  0  0  0  0  0  0  1 7a 52  0  1 78 10  1   .........zR..x..
     0050:  1b  c  7  8 90  1  0  0 14  0  0  0 1c  0  0  0   ................
     0060:   0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0   ................

    Section 15  .data._D16TypeInfo_S3__C1S6__initZ  PROGBITS,WRITE,ALLOC,SIZE=0x0090(144),OFFSET=0x0070,ALIGN=16
     0070:   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     0080:   7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     0090:   4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     00a0:   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     00b0:   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     00c0:   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     00d0:   0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0   ................
     00e0:   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   ................
     00f0:   0  0  0  0  0  0  0  0 53 33 5f 5f 43 31 53  0   ........S3__C1S.

    Section 16  .rela.data._D16TypeInfo_S3__C1S6__initZ  RELA,ENTRIES=3,OFFSET=0x06A4,ALIGN=8,LINK=8,INFO=15
       0 offset=00000000 addend=0000000000000000 type=R_X86_64_64 sym=24 sym=&quot;_D15TypeInfo_Struct6__vtblZ&quot;
       1 offset=00000018 addend=0000000000000088 type=R_X86_64_64 sym=21 sym=&quot;_D16TypeInfo_S3__C1S6__initZ&quot;
       2 offset=00000070 addend=0000000000000000 type=R_X86_64_64 sym=25 sym=&quot;_D10TypeInfo_i6__initZ&quot;

    Section 17  .bss.__bzeroBytes  NOBITS,WRITE,ALLOC,SIZE=0x0080(128),OFFSET=0x0100,ALIGN=16

    Section 18  .group  GROUP,ENTRIES=2,OFFSET=0x0100,ALIGN=4,LINK=8,INFO=23
     0100:   1  0  0  0 13  0  0  0                           ........

    Section 19  .text.test  PROGBITS,ALLOC,EXEC,GROUP,SIZE=0x0008(8),OFFSET=0x0108,ALIGN=4
     0108:  b8  4  0  0  0 c3  0  0                           ........</code></pre></div><br/><div id="40498217" class="c"><input type="checkbox" id="c-40498217" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40486361">root</a><span>|</span><a href="#40496334">parent</a><span>|</span><a href="#40497048">next</a><span>|</span><label class="collapse" for="c-40498217">[-]</label><label class="expand" for="c-40498217">[1 more]</label></div><br/><div class="children"><div class="content">Nice!<p>In llvm-project, obj2yaml pretty prints an object file in YAML and yaml2obj can convert the output back to an object file.<p>The test cases are a good way to explore the functionality:
<a href="https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;tree&#x2F;main&#x2F;llvm&#x2F;test&#x2F;tools&#x2F;obj2yaml&#x2F;ELF">https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;tree&#x2F;main&#x2F;llvm&#x2F;test&#x2F;too...</a>
<a href="https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;tree&#x2F;main&#x2F;llvm&#x2F;test&#x2F;tools&#x2F;yaml2obj&#x2F;ELF">https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;tree&#x2F;main&#x2F;llvm&#x2F;test&#x2F;too...</a></div><br/></div></div></div></div></div></div></div></div><div id="40497048" class="c"><input type="checkbox" id="c-40497048" checked=""/><div class="controls bullet"><span class="by">IAmLiterallyAB</span><span>|</span><a href="#40486361">parent</a><span>|</span><a href="#40495694">prev</a><span>|</span><a href="#40491918">next</a><span>|</span><label class="collapse" for="c-40497048">[-]</label><label class="expand" for="c-40497048">[1 more]</label></div><br/><div class="children"><div class="content">Just want to say, your blog has been a godsend for understanding the weird quirks of linking and ABI stuff. Thank you.</div><br/></div></div></div></div><div id="40491918" class="c"><input type="checkbox" id="c-40491918" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40486361">prev</a><span>|</span><a href="#40497128">next</a><span>|</span><label class="collapse" for="c-40491918">[-]</label><label class="expand" for="c-40491918">[2 more]</label></div><br/><div class="children"><div class="content">&gt;    Q18: How can you get a single binary to work identically across all these diverse systems?<p>&gt;    Most Unix-on-Intel binary packages are already largely similar. Almost all such operating systems use the &quot;ELF&quot; binary &#x27;packaging&#x27;; the various operating systems have small but significant differences, though, that make each system&#x27;s ELF binary unusable on others&#x27;.<p>Though the scope has diminished with the decline of proprietary unixen, there is a nice bright spot with APE binaries ( <a href="https:&#x2F;&#x2F;justine.lol&#x2F;ape.html" rel="nofollow">https:&#x2F;&#x2F;justine.lol&#x2F;ape.html</a> ) which are in some regards even <i>more</i> portable since they work on Darwin (which natively uses Mach-O) and NT (which natively uses PE).</div><br/><div id="40498180" class="c"><input type="checkbox" id="c-40498180" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40491918">parent</a><span>|</span><a href="#40497128">next</a><span>|</span><label class="collapse" for="c-40498180">[-]</label><label class="expand" for="c-40498180">[1 more]</label></div><br/><div class="children"><div class="content">Yes! I immediately thought about APE when I read The 86open Project&#x27;s FAQ. However, I feel that APE is less related to the blog post so decide not to add the link to the post.</div><br/></div></div></div></div><div id="40497128" class="c"><input type="checkbox" id="c-40497128" checked=""/><div class="controls bullet"><span class="by">kibwen</span><span>|</span><a href="#40491918">prev</a><span>|</span><a href="#40493198">next</a><span>|</span><label class="collapse" for="c-40497128">[-]</label><label class="expand" for="c-40497128">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;d be interested in reading about the history of object file formats in general. I&#x27;m wondering what motivates them being so relatively complicated for something that seems so conceptually simple; is it historical baggage or is it essential complexity?</div><br/><div id="40498203" class="c"><input type="checkbox" id="c-40498203" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40497128">parent</a><span>|</span><a href="#40497309">next</a><span>|</span><label class="collapse" for="c-40498203">[-]</label><label class="expand" for="c-40498203">[1 more]</label></div><br/><div class="children"><div class="content">Linkers and Loaders<p>I have analyzed a few object file formats in another blog post
<a href="https:&#x2F;&#x2F;maskray.me&#x2F;blog&#x2F;2024-01-14-exploring-object-file-formats" rel="nofollow">https:&#x2F;&#x2F;maskray.me&#x2F;blog&#x2F;2024-01-14-exploring-object-file-for...</a> (HN discussion: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38998914">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38998914</a>)<p>ELF is technically not complicated and simpler than COFF and Mach-O.</div><br/></div></div><div id="40497309" class="c"><input type="checkbox" id="c-40497309" checked=""/><div class="controls bullet"><span class="by">KerrAvon</span><span>|</span><a href="#40497128">parent</a><span>|</span><a href="#40498203">prev</a><span>|</span><a href="#40493198">next</a><span>|</span><label class="collapse" for="c-40497309">[-]</label><label class="expand" for="c-40497309">[1 more]</label></div><br/><div class="children"><div class="content">Get yourself a copy of “Linkers and Loaders” — <a href="https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.5555&#x2F;519563" rel="nofollow">https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.5555&#x2F;519563</a> . Explains the history of it all.</div><br/></div></div></div></div><div id="40493198" class="c"><input type="checkbox" id="c-40493198" checked=""/><div class="controls bullet"><span class="by">CalChris</span><span>|</span><a href="#40497128">prev</a><span>|</span><a href="#40496881">next</a><span>|</span><label class="collapse" for="c-40493198">[-]</label><label class="expand" for="c-40493198">[2 more]</label></div><br/><div class="children"><div class="content">Who controls the ELF standard? The best I can tell is that you submit a pull request with LLVM and maybe GCC.</div><br/><div id="40494124" class="c"><input type="checkbox" id="c-40494124" checked=""/><div class="controls bullet"><span class="by">MaskRay</span><span>|</span><a href="#40493198">parent</a><span>|</span><a href="#40496881">next</a><span>|</span><label class="collapse" for="c-40494124">[-]</label><label class="expand" for="c-40494124">[1 more]</label></div><br/><div class="children"><div class="content">- 2003-2010 The SCO Group<p>- 2011- Xinous, but Xinous has stopped updating <a href="https:&#x2F;&#x2F;www.sco.com&#x2F;developers&#x2F;gabi&#x2F;latest&#x2F;contents.html" rel="nofollow">https:&#x2F;&#x2F;www.sco.com&#x2F;developers&#x2F;gabi&#x2F;latest&#x2F;contents.html</a> . It seems that Xinous has moved on from System V based OpenServer&#x2F;UnixWare. The newer OpenServer seems to be based on FreeBSD. They likely no longer care about the System V ABI.<p>Nowadays, people make proposals to the generic-abi Google Group.
Essentially, a proposal is considered &quot;standardized&quot; if it receives approval from GNU, LLVM, and Ali Bahrami (Solaris representative).<p>Many GNU extensions are implemented by LLVM and adopted by BSD and newer ELF-based OSes.
For extensions that are considered generic enough, it&#x27;s recommended to propose them through the generic-abi Google Group.
psABI documents generally prefer generic extensions over GNU or LLVM-specific ones.</div><br/></div></div></div></div><div id="40496881" class="c"><input type="checkbox" id="c-40496881" checked=""/><div class="controls bullet"><span class="by">matheusmoreira</span><span>|</span><a href="#40493198">prev</a><span>|</span><label class="collapse" for="c-40496881">[-]</label><label class="expand" for="c-40496881">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Despite this uncertainty, innovation within the ELF ecosystem should continue.<p>&gt; In practice, achieving consensus among major toolchain vendors (GNU and LLVM) may be sufficient, even without formal approval from the generic ABI.<p>That makes it sound easy. GNU projects seem to be very conservatively maintained. LLVM has around one trillion open pull requests.<p>I came up with a little mechanism to get the kernel to automatically load into memory data embedded into the program. I used it in my programming language to embed code into the interpreter so that they can be automatically loaded and executed.<p><a href="https:&#x2F;&#x2F;www.matheusmoreira.com&#x2F;articles&#x2F;self-contained-lone-lisp-applications" rel="nofollow">https:&#x2F;&#x2F;www.matheusmoreira.com&#x2F;articles&#x2F;self-contained-lone-...</a><p>Only the maintainer of the relatively new mold linker cared to implement a helpful feature to make this kind of thing possible and easy. I requested the same feature in GNU ld and the idea wasn&#x27;t exactly received with enthusiasm. I&#x27;m not sure LLVM ever received it at all.<p>And that was just a linker option to add some extra PT_NULL segments for easy and efficient patching. Can&#x27;t even imagine the effort it would take to <i>actually change</i> something about this ABI.</div><br/></div></div></div></div></div></div></div></body></html>