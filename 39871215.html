<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711789269389" as="style"/><link rel="stylesheet" href="styles.css?v=1711789269389"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://medium.com/@magda7817/why-has-figma-reinveted-the-wheel-with-postgresql-3a1cb2e9297c">Why Has Figma Reinvented the Wheel with PostgreSQL?</a> <span class="domain">(<a href="https://medium.com">medium.com</a>)</span></div><div class="subtext"><span>magden</span> | <span>17 comments</span></div><br/><div><div id="39872438" class="c"><input type="checkbox" id="c-39872438" checked=""/><div class="controls bullet"><span class="by">seanhunter</span><span>|</span><a href="#39873013">next</a><span>|</span><label class="collapse" for="c-39872438">[-]</label><label class="expand" for="c-39872438">[11 more]</label></div><br/><div class="children"><div class="content">The answer is obvious: they invented their own sharding solution because it&#x27;s a really really cool problem to work on and they have more engineers than they really need to develop their actual product.  A more resource-constrained team would have found a solution that sharded their backend using one of the existing solutions out there.<p>I have seen this several times before and it&#x27;s always a symptom of having too many engineers working below the waterline.  Rather than work on the actual customer-facing problem, let&#x27;s port the backend to do event-sourcing&#x2F;cqrs, move all our infrastructure to k8s, change language from x to y etc.<p>These are all what I would call &quot;internal goals&quot; (ie they may or may not be necessary or even essential to progress but are not directly customer-visible in their outcomes even if they may enable customer features to be built or indirectly improve the customer experience later) and need to be held to an extremely high level of scrutiny.<p>If you&#x27;re amazon&#x2F;google&#x2F;meta and you need to do this because of extreme user scale I might believe you.  If you&#x27;re CERN or someone and you need to do this because of absolutely ridiculous data scale I might believe you.  The idea that it&#x27;s better for figma to write their own sharding solution than it is to port to one of the existing ones just doesn&#x27;t pass even the most basic sniff test.</div><br/><div id="39873044" class="c"><input type="checkbox" id="c-39873044" checked=""/><div class="controls bullet"><span class="by">thibaut_barrere</span><span>|</span><a href="#39872438">parent</a><span>|</span><a href="#39872459">next</a><span>|</span><label class="collapse" for="c-39873044">[-]</label><label class="expand" for="c-39873044">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t read the story this way personally (not saying that these scenarios do not occur, but I feel the narrative detailed in the original article makes sense even without &quot;chasing cool problems&quot;).</div><br/></div></div><div id="39872459" class="c"><input type="checkbox" id="c-39872459" checked=""/><div class="controls bullet"><span class="by">djtango</span><span>|</span><a href="#39872438">parent</a><span>|</span><a href="#39873044">prev</a><span>|</span><a href="#39873013">next</a><span>|</span><label class="collapse" for="c-39872459">[-]</label><label class="expand" for="c-39872459">[9 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t have a read on this - do we know that Figma isn&#x27;t doing difficult stuff that warrants proprietary solutions?</div><br/><div id="39872670" class="c"><input type="checkbox" id="c-39872670" checked=""/><div class="controls bullet"><span class="by">winrid</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872459">parent</a><span>|</span><a href="#39872473">next</a><span>|</span><label class="collapse" for="c-39872670">[-]</label><label class="expand" for="c-39872670">[6 more]</label></div><br/><div class="children"><div class="content">Absolutely not. Citus would have solved this problem. Or move to MySQL and use PlanetScale etc.<p>Second best option is ability to easily create prod environments, and then give those to your biggest customers (bigname.figma.com) etc. No single figma customer will go beyond an i3.metal for the DB, or the app.</div><br/><div id="39872746" class="c"><input type="checkbox" id="c-39872746" checked=""/><div class="controls bullet"><span class="by">djtango</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872670">parent</a><span>|</span><a href="#39872473">next</a><span>|</span><label class="collapse" for="c-39872746">[-]</label><label class="expand" for="c-39872746">[5 more]</label></div><br/><div class="children"><div class="content">So I just read the article - they were on RDS so Citus wasn&#x27;t an option.<p>They also stated it was too risky to migrate data stores on the timeline they were working within<p>Those all seem like measured engineering decisions AFAICT</div><br/><div id="39873062" class="c"><input type="checkbox" id="c-39873062" checked=""/><div class="controls bullet"><span class="by">thibaut_barrere</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872746">parent</a><span>|</span><a href="#39872831">next</a><span>|</span><label class="collapse" for="c-39873062">[-]</label><label class="expand" for="c-39873062">[1 more]</label></div><br/><div class="children"><div class="content">I do agree here. The choice to prefer X over Y for hosting (no matter X and Y) often makes sense, changing hosting providers can take a bit of time &amp; it&#x27;s hard to fully assess the reality of the quality of support &#x2F; security (again, not specifically writing about RDS or Citus, both are very good teams) beforehand, so it usually is safer to have a long probing period to move safely, which takes time, something they visibly didn&#x27;t have much.</div><br/></div></div><div id="39872831" class="c"><input type="checkbox" id="c-39872831" checked=""/><div class="controls bullet"><span class="by">winrid</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872746">parent</a><span>|</span><a href="#39873062">prev</a><span>|</span><a href="#39872473">next</a><span>|</span><label class="collapse" for="c-39872831">[-]</label><label class="expand" for="c-39872831">[3 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t sound right.<p>Do data dump from prod for initial sync and then setup replication from RDS to new cluster. Once synced do switch. Then you&#x27;re off RDS and can shard on Citus.</div><br/><div id="39872951" class="c"><input type="checkbox" id="c-39872951" checked=""/><div class="controls bullet"><span class="by">nathanappere</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872831">parent</a><span>|</span><a href="#39872945">next</a><span>|</span><label class="collapse" for="c-39872951">[-]</label><label class="expand" for="c-39872951">[1 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t work with the constraint of &quot;staying on AWS&quot; though.</div><br/></div></div><div id="39872945" class="c"><input type="checkbox" id="c-39872945" checked=""/><div class="controls bullet"><span class="by">raverbashing</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872831">parent</a><span>|</span><a href="#39872951">prev</a><span>|</span><a href="#39872473">next</a><span>|</span><label class="collapse" for="c-39872945">[-]</label><label class="expand" for="c-39872945">[1 more]</label></div><br/><div class="children"><div class="content">Yes but they probably wouldn&#x27;t want to migrate off RDS.</div><br/></div></div></div></div></div></div></div></div><div id="39872473" class="c"><input type="checkbox" id="c-39872473" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872459">parent</a><span>|</span><a href="#39872670">prev</a><span>|</span><a href="#39873013">next</a><span>|</span><label class="collapse" for="c-39872473">[-]</label><label class="expand" for="c-39872473">[2 more]</label></div><br/><div class="children"><div class="content">I just read through several thousand lines of code re-implementing the concept of a distributed queue from the ground up... for an application that has maybe a few hundred users. And doesn&#x27;t need queues, at all.<p>This issue is so pervasive that we&#x27;ve all just assumed that it must be necessary.</div><br/><div id="39872750" class="c"><input type="checkbox" id="c-39872750" checked=""/><div class="controls bullet"><span class="by">djtango</span><span>|</span><a href="#39872438">root</a><span>|</span><a href="#39872473">parent</a><span>|</span><a href="#39873013">next</a><span>|</span><label class="collapse" for="c-39872750">[-]</label><label class="expand" for="c-39872750">[1 more]</label></div><br/><div class="children"><div class="content">I couldn&#x27;t get the context of this response - is this application you read unrelated to the featured article?<p>I just read the article and from what I can tell the Figma team made a somewhat reasonable sounding decision</div><br/></div></div></div></div></div></div></div></div><div id="39873013" class="c"><input type="checkbox" id="c-39873013" checked=""/><div class="controls bullet"><span class="by">Ozzie_osman</span><span>|</span><a href="#39872438">prev</a><span>|</span><a href="#39872429">next</a><span>|</span><label class="collapse" for="c-39873013">[-]</label><label class="expand" for="c-39873013">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m at a company that is weighing a very similar decision (we are on RDS Postgres with a rapidly growing database that will require some horizontal partitioning). There really isn&#x27;t an easy solution. We spoke to people who have done sharding in-house (Figma, Robinhood) as well as others who migrated to natively distributed systems like Cockroach (Doordash).<p>If you decide to move off of RDS but stay on Postgres, you can run your own Postgres but now lose all the benefits of a managed service. You could move off of AWS (eg to Azure), but moving to a different cloud is a huge lift. That, btw, would also be required if you want to try something like Spanner (move to GCP). Moving off of Postgres to another database is also risky. The migration will obviously take some effort, but you&#x27;re also probably talking about lots of code changes, schema changes, etc, as well as unknown operational risks that you&#x27;ll discover on the new system. This applies if you&#x27;re talking about things like Cockroach or even moving to MySQL.<p>That said, rolling your own sharding is a MASSIVE undertaking. Limitless looks promising, since it takes care of a lot of the issues that Figma ended up spending time on (basically, you shouldn&#x27;t need something like Figma&#x27;s DBProxy, as shard routing, shard splitting, etc will be taken care of). It&#x27;s still in preview though, and like the article mentioned, the costs may be high.<p>Overall, no easy decisions on this one, unfortunately.</div><br/></div></div><div id="39872429" class="c"><input type="checkbox" id="c-39872429" checked=""/><div class="controls bullet"><span class="by">cplat</span><span>|</span><a href="#39873013">prev</a><span>|</span><a href="#39872300">next</a><span>|</span><label class="collapse" for="c-39872429">[-]</label><label class="expand" for="c-39872429">[1 more]</label></div><br/><div class="children"><div class="content">Good points. Although, having worked on many high scale architectures before, I always err on the side of thinking that any technical solution of this magnitude would have far too many nuances for a blog post to capture. And I believe Figma’s post also talks mainly about the common denominator that’s easier to communicate to the external world.<p>For me to understand their choices, I’ll first have to understand their system, which can be a task in itself. Without that, I’d not become aware of the nuances, only general patterns.</div><br/></div></div><div id="39872300" class="c"><input type="checkbox" id="c-39872300" checked=""/><div class="controls bullet"><span class="by">willsmith72</span><span>|</span><a href="#39872429">prev</a><span>|</span><a href="#39872610">next</a><span>|</span><label class="collapse" for="c-39872300">[-]</label><label class="expand" for="c-39872300">[2 more]</label></div><br/><div class="children"><div class="content">Nice article, I also wondered why they omitted citus. Is there any plan from rds to offer it?<p>Obviously it could interfere with demand for aurora limitless</div><br/><div id="39872866" class="c"><input type="checkbox" id="c-39872866" checked=""/><div class="controls bullet"><span class="by">plq</span><span>|</span><a href="#39872300">parent</a><span>|</span><a href="#39872610">next</a><span>|</span><label class="collapse" for="c-39872866">[-]</label><label class="expand" for="c-39872866">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Is there any plan from rds to offer it?<p>I don&#x27;t think so because Microsoft bought Citus.</div><br/></div></div></div></div><div id="39872610" class="c"><input type="checkbox" id="c-39872610" checked=""/><div class="controls bullet"><span class="by">robust-cactus</span><span>|</span><a href="#39872300">prev</a><span>|</span><label class="collapse" for="c-39872610">[-]</label><label class="expand" for="c-39872610">[1 more]</label></div><br/><div class="children"><div class="content">Now seems a good time to point out, the wheel has literally been reinvented over and over again. The wheels of yesterday were terrible. Each version gets better. It&#x27;s fine, reinvent away folks :)</div><br/></div></div></div></div></div></div></div></body></html>