<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1723971667778" as="style"/><link rel="stylesheet" href="styles.css?v=1723971667778"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a>Ask HN: What do you monitor on your servers?</a> </div><div class="subtext"><span>gorkemcetin</span> | <span>82 comments</span></div><br/><div><div id="41278373" class="c"><input type="checkbox" id="c-41278373" checked=""/><div class="controls bullet"><span class="by">kevg123</span><span>|</span><a href="#41277030">next</a><span>|</span><label class="collapse" for="c-41278373">[-]</label><label class="expand" for="c-41278373">[4 more]</label></div><br/><div class="children"><div class="content">&gt; What are the key assets you monitor beyond the basics like CPU, RAM, and disk usage?<p>* Network is another basic that should be there<p>* Average disk service time<p>* Memory is tricky (even MemAvailable can miss important anonymous memory pageouts with a mistuned vm.swappiness), so also monitor swap page out rates<p>* TCP retransmits as a warning sign of network&#x2F;hardware issues<p>* UDP &amp; TCP connection counts by state (for TCP: established, time_wait, etc.) broken down by incoming and outgoing<p>* Per-CPU utilization<p>* Rates of operating system warnings and errors in the kernel log<p>* Application average&#x2F;max response time<p>* Application throughput (both total and broken down by the error rate, e.g. HTTP response code &gt;= 400)<p>* Application thread pool utilization<p>* Rates of application warnings and errors in the application log<p>* Application up&#x2F;down with heartbeat<p>* Per-application &amp; per-thread CPU utilization<p>* Periodic on-CPU sampling for a bit of time and then flame graph that<p>* DNS lookup response times&#x2F;errors<p>&gt; Do you also keep tabs on network performance, processes, services, or other metrics?<p>Per-process and over time, yes, which are useful for post-mortem analysis</div><br/><div id="41280814" class="c"><input type="checkbox" id="c-41280814" checked=""/><div class="controls bullet"><span class="by">m3nu</span><span>|</span><a href="#41278373">parent</a><span>|</span><a href="#41280862">next</a><span>|</span><label class="collapse" for="c-41280814">[-]</label><label class="expand" for="c-41280814">[1 more]</label></div><br/><div class="children"><div class="content">Those are some great ideas for Prometheus alert rules. If they aren&#x27;t already added here: <a href="https:&#x2F;&#x2F;samber.github.io&#x2F;awesome-prometheus-alerts&#x2F;" rel="nofollow">https:&#x2F;&#x2F;samber.github.io&#x2F;awesome-prometheus-alerts&#x2F;</a></div><br/></div></div><div id="41280862" class="c"><input type="checkbox" id="c-41280862" checked=""/><div class="controls bullet"><span class="by">jstummbillig</span><span>|</span><a href="#41278373">parent</a><span>|</span><a href="#41280814">prev</a><span>|</span><a href="#41279967">next</a><span>|</span><label class="collapse" for="c-41280862">[-]</label><label class="expand" for="c-41280862">[1 more]</label></div><br/><div class="children"><div class="content">How to identify a mistuned vm.swappiness?</div><br/></div></div><div id="41279967" class="c"><input type="checkbox" id="c-41279967" checked=""/><div class="controls bullet"><span class="by">graycat</span><span>|</span><a href="#41278373">parent</a><span>|</span><a href="#41280862">prev</a><span>|</span><a href="#41277030">next</a><span>|</span><label class="collapse" for="c-41279967">[-]</label><label class="expand" for="c-41279967">[1 more]</label></div><br/><div class="children"><div class="content">With all that, might want some good automatic <i>anomaly detection</i>.  While at IBM&#x27;s Watson lab, I worked out something new, gave an invited talk on the work at the NASDAQ server farm, and published it.<p>With a lot of monitoring someone might be interested.</div><br/></div></div></div></div><div id="41277030" class="c"><input type="checkbox" id="c-41277030" checked=""/><div class="controls bullet"><span class="by">aflukasz</span><span>|</span><a href="#41278373">prev</a><span>|</span><a href="#41278227">next</a><span>|</span><label class="collapse" for="c-41277030">[-]</label><label class="expand" for="c-41277030">[2 more]</label></div><br/><div class="children"><div class="content">When it comes to &quot;what&quot; to monitor, many usual suspects already posted in this thread, so in an attempt not to repeat what&#x27;s there already, I will mention just the following (will somewhat assume Linux&#x2F;systemd):<p>- systemd unit failures - I install a global OnFailure hook that applies for all the units, to trigger an alert via a mechanism of choice for a given system,<p>- restarts of key services - you typically don&#x27;t want to miss those, but if they are silent, then you quite likely will,<p>- netfilter reconfigurations - nftables cli has useful `monitor` subcommand for this,<p>- unexpected ingress or egress connection attempts,<p>- connections from unknown&#x2F;unexpected networks (if can&#x27;t just outright block them for any reason).</div><br/><div id="41281058" class="c"><input type="checkbox" id="c-41281058" checked=""/><div class="controls bullet"><span class="by">ffsm8</span><span>|</span><a href="#41277030">parent</a><span>|</span><a href="#41278227">next</a><span>|</span><label class="collapse" for="c-41281058">[-]</label><label class="expand" for="c-41281058">[1 more]</label></div><br/><div class="children"><div class="content">Can I bother you for a rough <i>how</i> wrt unexpected ingress&#x2F;egress and unknown connections?<p>I&#x27;m not aware of any tooling that&#x27;d enable such monitoring without massively impacting performance - but I&#x27;m not particularly knowledgeable in this field either.<p>Just from someone that&#x27;d be interested to improve my monitoring on my homelab server</div><br/></div></div></div></div><div id="41278227" class="c"><input type="checkbox" id="c-41278227" checked=""/><div class="controls bullet"><span class="by">dfox</span><span>|</span><a href="#41277030">prev</a><span>|</span><a href="#41253782">next</a><span>|</span><label class="collapse" for="c-41278227">[-]</label><label class="expand" for="c-41278227">[9 more]</label></div><br/><div class="children"><div class="content">My two cents: monitoring RAM usage is completely useless, as whatever number you consider an “used&#x2F;free RAM” is meaningless (and the ideal state is that all of the RAM is somehow “used” anyway). You should monitor for page faults and cache misses in block device reads.</div><br/><div id="41278381" class="c"><input type="checkbox" id="c-41278381" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#41278227">parent</a><span>|</span><a href="#41278793">next</a><span>|</span><label class="collapse" for="c-41278381">[-]</label><label class="expand" for="c-41278381">[7 more]</label></div><br/><div class="children"><div class="content">Depends. &quot;free&quot; reports the area used for disk buffers and programs, hence &quot;available&quot; and &quot;free&quot; numbers.<p>On my servers I want some available RAM which means &quot;used - buffers&quot;, because this means I configured my servers correctly and nothing is running away, or nothing is using more than it should.<p>On the other hand, you want &quot;free&quot; almost zero on a warmed up server (except some cases which hints that heaps of memory has been recently freed) since the rest is always utilized as disk cache.<p>Similarly having some data on swap state doesn&#x27;t harm as long as it&#x27;s spilled there because some process has ran away and used more memory than it should be.<p>So, RAM usage metrics carry a ton of nuance and can mean totally different things depending on how you use that particular server.</div><br/><div id="41278518" class="c"><input type="checkbox" id="c-41278518" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278381">parent</a><span>|</span><a href="#41278793">next</a><span>|</span><label class="collapse" for="c-41278518">[-]</label><label class="expand" for="c-41278518">[6 more]</label></div><br/><div class="children"><div class="content">One of the older arguments I get to keep having over and over is No, You May Not Put Another Service on These Servers. We are using those disk caches thank you very much.<p>I do not enjoy showing up to yet another discussion of why our response times just went up “for no reason”. Learn your latency tables people.</div><br/><div id="41278551" class="c"><input type="checkbox" id="c-41278551" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278518">parent</a><span>|</span><a href="#41278793">next</a><span>|</span><label class="collapse" for="c-41278551">[-]</label><label class="expand" for="c-41278551">[5 more]</label></div><br/><div class="children"><div class="content">Yeah, people tend to think server utilization as black and white.<p>Look, we&#x27;re using just 50% of that RAM. Look, there&#x27;re two cores that are almost idle.<p>No &amp; No. Rest of the RAM is your secret for instant responses, and that spare CPU resource is for me to do system management without you notice or to front the odd torrent of requests we have semi regularly (e.g.: &#x2F;. hug of death. Remember?).</div><br/><div id="41278640" class="c"><input type="checkbox" id="c-41278640" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278551">parent</a><span>|</span><a href="#41278793">next</a><span>|</span><label class="collapse" for="c-41278640">[-]</label><label class="expand" for="c-41278640">[4 more]</label></div><br/><div class="children"><div class="content">I need to find a really good intro to queuing theory to send people to. A full queue is a slow queue. You actually want to aim for about 65% utilization.</div><br/><div id="41280168" class="c"><input type="checkbox" id="c-41280168" checked=""/><div class="controls bullet"><span class="by">Version467</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278640">parent</a><span>|</span><a href="#41280001">next</a><span>|</span><label class="collapse" for="c-41280168">[-]</label><label class="expand" for="c-41280168">[1 more]</label></div><br/><div class="children"><div class="content">This might be too basic, but I found this blog post to be an incredible introduction to queues: <a href="https:&#x2F;&#x2F;encore.dev&#x2F;blog&#x2F;queueing" rel="nofollow">https:&#x2F;&#x2F;encore.dev&#x2F;blog&#x2F;queueing</a></div><br/></div></div><div id="41280001" class="c"><input type="checkbox" id="c-41280001" checked=""/><div class="controls bullet"><span class="by">redxtech</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278640">parent</a><span>|</span><a href="#41280168">prev</a><span>|</span><a href="#41278663">next</a><span>|</span><label class="collapse" for="c-41280001">[-]</label><label class="expand" for="c-41280001">[1 more]</label></div><br/><div class="children"><div class="content">If the numbers from the phoenix project are to be trusted, a loose estimate is the time spent in queue is proportional to the ratio of utilized to unutilized resources. For example, 50% used &amp; 50% unused is 50:50 = 1 unit of time. 99% used is 99:1 = 99 units of time.</div><br/></div></div><div id="41278663" class="c"><input type="checkbox" id="c-41278663" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#41278227">root</a><span>|</span><a href="#41278640">parent</a><span>|</span><a href="#41280001">prev</a><span>|</span><a href="#41278793">next</a><span>|</span><label class="collapse" for="c-41278663">[-]</label><label class="expand" for="c-41278663">[1 more]</label></div><br/><div class="children"><div class="content">Also, there was a formula for determining the optimal cache size. I forget the name all the time. IIRC, in the end, caching most popular 10 items was enough to respond to 95% of your queries without hitting the disk.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41278793" class="c"><input type="checkbox" id="c-41278793" checked=""/><div class="controls bullet"><span class="by">hi-v-rocknroll</span><span>|</span><a href="#41278227">parent</a><span>|</span><a href="#41278381">prev</a><span>|</span><a href="#41253782">next</a><span>|</span><label class="collapse" for="c-41278793">[-]</label><label class="expand" for="c-41278793">[1 more]</label></div><br/><div class="children"><div class="content">Correct identification but wrong prescription.<p>Cache misses don&#x27;t have anything to do with memory pressure, they&#x27;re related to caching effectiveness.<p>Production systems shouldn&#x27;t have any page faults because they shouldn&#x27;t be using swap.<p>The traditional way Linux memory pressure was measured using a very small swap file and check for any usage of it. Modern Linux has the PSI subsystem.<p>Also, monitoring for OOM events also means a system needs more RAM or a workload needs to be tuned or spread out.</div><br/></div></div></div></div><div id="41253782" class="c"><input type="checkbox" id="c-41253782" checked=""/><div class="controls bullet"><span class="by">uaas</span><span>|</span><a href="#41278227">prev</a><span>|</span><a href="#41276838">next</a><span>|</span><label class="collapse" for="c-41253782">[-]</label><label class="expand" for="c-41253782">[19 more]</label></div><br/><div class="children"><div class="content">You cannot go wrong with the most popular choice: Prometheus&#x2F;Grafana stack. That includes node_exporter for anything host related, and optionally Loki (and one of its agents) for logs. All this can run anywhere, not just on k8s.</div><br/><div id="41276315" class="c"><input type="checkbox" id="c-41276315" checked=""/><div class="controls bullet"><span class="by">slimsag</span><span>|</span><a href="#41253782">parent</a><span>|</span><a href="#41267184">next</a><span>|</span><label class="collapse" for="c-41276315">[-]</label><label class="expand" for="c-41276315">[9 more]</label></div><br/><div class="children"><div class="content">Related, have there been any &#x27;truly open-source&#x27; forks of Grafana since their license change? Or does anyone know of good Grafana alternatives from FOSS devs in general? My default right now is to just use Prometheus itself, but I miss some of the dashboard functionality etc. from Grafana.<p>Grafana&#x27;s license change to AGPLv3 (I suspect to drive their enterprise sales), combined with an experience I had reporting security vulnerabilities, combined with seeing changes like this[1] not get integrated has left a bad taste in my mouth.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;grafana&#x2F;grafana&#x2F;pull&#x2F;6627">https:&#x2F;&#x2F;github.com&#x2F;grafana&#x2F;grafana&#x2F;pull&#x2F;6627</a></div><br/><div id="41276488" class="c"><input type="checkbox" id="c-41276488" checked=""/><div class="controls bullet"><span class="by">jchw</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41279157">next</a><span>|</span><label class="collapse" for="c-41276488">[-]</label><label class="expand" for="c-41276488">[1 more]</label></div><br/><div class="children"><div class="content">AGPLv3 is a completely valid choice for an open source license, and (not that it was necessarily questioned, but since critique of pushing enterprise sales comes up,) having a split open source&#x2F;enterprise license structure is not particularly egregious and definitely not new. Some people definitely don&#x27;t like it, but even Richard Stallman is generally approving of this model[1]. It&#x27;s hard to find someone more ideologically-oriented towards the success and proliferation of free and open source software, though that obviously doesn&#x27;t mean everyone agrees.<p>I&#x27;m not saying, FWIW, that I think AGPL is &quot;good&quot;, but it is at least a perfectly valid open source license. I&#x27;m well aware of the criticisms of it in general. But if you&#x27;re going to relicense an open source project to &quot;defend&quot; it against abuse, AGPL is probably the most difficult to find any objection to. It <i>literally</i> exists for that reason.<p>I don&#x27;t necessarily think that Grafana is the greatest company ever or anything, but I think these gripes are relatively minor in the grand scheme of things. (Well, the security issue might be a bit more serious, but without context I can&#x27;t judge that one.)<p>[1]: <a href="https:&#x2F;&#x2F;www.fsf.org&#x2F;blogs&#x2F;rms&#x2F;selling-exceptions" rel="nofollow">https:&#x2F;&#x2F;www.fsf.org&#x2F;blogs&#x2F;rms&#x2F;selling-exceptions</a></div><br/></div></div><div id="41279157" class="c"><input type="checkbox" id="c-41279157" checked=""/><div class="controls bullet"><span class="by">FridgeSeal</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41276488">prev</a><span>|</span><a href="#41277849">next</a><span>|</span><label class="collapse" for="c-41279157">[-]</label><label class="expand" for="c-41279157">[1 more]</label></div><br/><div class="children"><div class="content">To be fair, AGPLv3 is a very valid open source licence.<p>Now, poor and bad behaviour from the prom maintainers is a very fertile subject. If you want to see some real spicy threads check out the one where people raised that Prom’s calculation of rate is incorrect, or the thread where people asked for prom to interpolate secrets into its config from env cars - like every other bit of common cloud-adjacent software.<p>Both times prom devs behaved pretty poorly and left really bad taste in my mouth. Victoria Metrics seems like a much better replacement.</div><br/></div></div><div id="41277849" class="c"><input type="checkbox" id="c-41277849" checked=""/><div class="controls bullet"><span class="by">max-privatevoid</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41279157">prev</a><span>|</span><a href="#41276432">next</a><span>|</span><label class="collapse" for="c-41277849">[-]</label><label class="expand" for="c-41277849">[2 more]</label></div><br/><div class="children"><div class="content">The AGPL is probably the best option for a FOSS license. Why do you consider it &quot;not truly open-source&quot;?</div><br/><div id="41280646" class="c"><input type="checkbox" id="c-41280646" checked=""/><div class="controls bullet"><span class="by">valyala</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41277849">parent</a><span>|</span><a href="#41276432">next</a><span>|</span><label class="collapse" for="c-41280646">[-]</label><label class="expand" for="c-41280646">[1 more]</label></div><br/><div class="children"><div class="content">AGPL prevents from wide product adoption, since corporate lawyers caution against relying on AGPL products because it is easy to violate the license terms and being sued after that.</div><br/></div></div></div></div><div id="41276432" class="c"><input type="checkbox" id="c-41276432" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41277849">prev</a><span>|</span><a href="#41278010">next</a><span>|</span><label class="collapse" for="c-41276432">[-]</label><label class="expand" for="c-41276432">[1 more]</label></div><br/><div class="children"><div class="content">&gt; combined with them not being a good steward for changes like this[1] left a bad taste in my mouth.<p>What they did wrong with this PR? It seems eventually they realized the scope was much bigger, requiring changes on both the frontend and backend, and asked potential contributors to reach out if they&#x27;re interested in contributing that particular feature (saying between the lines that they themselves don&#x27;t have a use, but they won&#x27;t reject a PR).<p>Seems like they didn&#x27;t need it themselves, and asked the community to contribute it if someone really wanted it, but no one has stepped up since then.</div><br/></div></div><div id="41278010" class="c"><input type="checkbox" id="c-41278010" checked=""/><div class="controls bullet"><span class="by">getcrunk</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41276432">prev</a><span>|</span><a href="#41280250">next</a><span>|</span><label class="collapse" for="c-41278010">[-]</label><label class="expand" for="c-41278010">[1 more]</label></div><br/><div class="children"><div class="content">I think the word is rather use is copyleft! Agpl is fully open source in its truest sense! It’s so open that it ensures it always stays open!</div><br/></div></div><div id="41280250" class="c"><input type="checkbox" id="c-41280250" checked=""/><div class="controls bullet"><span class="by">oriettaxx</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41278010">prev</a><span>|</span><a href="#41280020">next</a><span>|</span><label class="collapse" for="c-41280250">[-]</label><label class="expand" for="c-41280250">[1 more]</label></div><br/><div class="children"><div class="content">can y explain the problem with that github pull request? I did not get it</div><br/></div></div><div id="41280020" class="c"><input type="checkbox" id="c-41280020" checked=""/><div class="controls bullet"><span class="by">immibis</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276315">parent</a><span>|</span><a href="#41280250">prev</a><span>|</span><a href="#41267184">next</a><span>|</span><label class="collapse" for="c-41280020">[-]</label><label class="expand" for="c-41280020">[1 more]</label></div><br/><div class="children"><div class="content">The FOSS alternative to Grafana is Grafana, which is FOSS. More FOSS than it was before, actually.</div><br/></div></div></div></div><div id="41267184" class="c"><input type="checkbox" id="c-41267184" checked=""/><div class="controls bullet"><span class="by">dengolius</span><span>|</span><a href="#41253782">parent</a><span>|</span><a href="#41276315">prev</a><span>|</span><a href="#41279893">next</a><span>|</span><label class="collapse" for="c-41267184">[-]</label><label class="expand" for="c-41267184">[8 more]</label></div><br/><div class="children"><div class="content">I&#x27;m using VictoriaMetrics instead of Prometheus, am doing something wrong? 
I have zabbix as well as node_exporter and Percona PMM for mysql servers because sometimes it is hard to configure prometheus stack for snmp when zabbix cover this case out of the box.</div><br/><div id="41276533" class="c"><input type="checkbox" id="c-41276533" checked=""/><div class="controls bullet"><span class="by">mcpherrinm</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41267184">parent</a><span>|</span><a href="#41276722">next</a><span>|</span><label class="collapse" for="c-41276533">[-]</label><label class="expand" for="c-41276533">[1 more]</label></div><br/><div class="children"><div class="content">Prometheus itself is pretty simple, fairly robust, but doesn’t necessarily scale for long-term storage as well.  Things like VictoriaMetrics, Mimir, and Thanos tend to be a bit more scalable for longer term storage of metrics.<p>For a few hundred gigs of metrics, I’ve been fine with Prometheus and some ZFS-send backups.</div><br/></div></div><div id="41276722" class="c"><input type="checkbox" id="c-41276722" checked=""/><div class="controls bullet"><span class="by">cassianoleal</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41267184">parent</a><span>|</span><a href="#41276533">prev</a><span>|</span><a href="#41279074">next</a><span>|</span><label class="collapse" for="c-41276722">[-]</label><label class="expand" for="c-41276722">[2 more]</label></div><br/><div class="children"><div class="content">I wrote an extensive reply to this but unfortunately the HN servers restarted and lost it.<p>The TL;DR was that from where I stand, you’re doing nothing wrong.<p>In a previous client we ran Prometheus for months, then Thanos, and eventually we implemented Victoria Metrics and everyone was happy. It became an order of magnitude cheaper due to using spinning rust for storage and still getting better performance. It was infinitely and very easily scalable, mostly automatically.<p>The “non-compliant” bits of the query language turned out to be fixes to the UX and other issues. Lots of new functions and features.<p>Support was always excellent.<p>I’m not affiliated with them in any way. Was always just a very happy freeloading user.</div><br/><div id="41280497" class="c"><input type="checkbox" id="c-41280497" checked=""/><div class="controls bullet"><span class="by">raffraffraff</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41276722">parent</a><span>|</span><a href="#41279074">next</a><span>|</span><label class="collapse" for="c-41280497">[-]</label><label class="expand" for="c-41280497">[1 more]</label></div><br/><div class="children"><div class="content">I have deployed lots of metrics systems, starting with cacti and moving through graphite, kairosdb (which used Cassandra under the hood), Prometheus, Thanos and now Mimir.<p>What I&#x27;ve realised is that they&#x27;re all painful to scale &#x27;really big&#x27;. One Prometheus server is easy. And you can scale vertically and go pretty big. But you need to think about redundancy, and you want to avoid ending up accidentally running 50 Prometheus instances, because that becomes a pain for the Grafana people. Unless you use an aggregating proxy like Promxy. But even then you have issues running aggregating functions across all of the instances. You need to think about expiring old data and possibly aggregating it down into into a smaller set so you can still look at certain charts over long periods. What&#x27;s the Prometheus solution here? MOAR INSTANCES. And reads need to be performant or you&#x27;ll have very angry engineers during the next SEV1, because their dashboards aren&#x27;t loading. So you throw in an additional caching solution like Trickster (which rocks!) between Grafana and the metrics. Back in the Kairosdb days you had to know a fair bit about running Cassandra clusters, but these days it&#x27;s all baked into Mimir.<p>I&#x27;m lucky enough to be working for a smaller company right now, so I don&#x27;t have to spend a lot of time tending to the monitoring systems. I love that Mimir is  basically Prometheus backed by S3, with all of the scalability and redundancy features built in (though you still have to configure them in large deployments). As long as you&#x27;re small enough to run their monolithic mode you don&#x27;t have to worry about individually scaling half a dozen separate components. The actual challenge is getting the $CLOUD side of it deployed, and then passing roles and buckets to the nasty helm charts while still making it easy to configure the ~10 things that you actually care about. Oh and the helm charts and underlying configs are still not rock solid yet, so upgrades can be hairy.<p>Ditto all of that for logging via Loki.<p>It&#x27;s very possible that Mimir is no better than Victoria Metrics, but unless it burns me really badly I think I&#x27;ll stick with it for now.</div><br/></div></div></div></div><div id="41279074" class="c"><input type="checkbox" id="c-41279074" checked=""/><div class="controls bullet"><span class="by">YZF</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41267184">parent</a><span>|</span><a href="#41276722">prev</a><span>|</span><a href="#41268596">next</a><span>|</span><label class="collapse" for="c-41279074">[-]</label><label class="expand" for="c-41279074">[1 more]</label></div><br/><div class="children"><div class="content">Not doing anything wrong. It scales better and has better performance. Works well. Prometheus is also fine.</div><br/></div></div><div id="41268596" class="c"><input type="checkbox" id="c-41268596" checked=""/><div class="controls bullet"><span class="by">uaas</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41267184">parent</a><span>|</span><a href="#41279074">prev</a><span>|</span><a href="#41279893">next</a><span>|</span><label class="collapse" for="c-41268596">[-]</label><label class="expand" for="c-41268596">[3 more]</label></div><br/><div class="children"><div class="content">Well, they claim superior performance (which might be true), but the costs are high and include a small community, low quality APIs, best effort correctness&#x2F;PromQL compatibility, and FUD marketing, so I decided to go with the de-facto standard without all of the issues above.</div><br/><div id="41279079" class="c"><input type="checkbox" id="c-41279079" checked=""/><div class="controls bullet"><span class="by">YZF</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41268596">parent</a><span>|</span><a href="#41280698">next</a><span>|</span><label class="collapse" for="c-41279079">[-]</label><label class="expand" for="c-41279079">[1 more]</label></div><br/><div class="children"><div class="content">No costs if you&#x27;re hosting everything. It does scale better and has better performance. Used it and have nothing bad to say about it. For the most part a drop-in replacement that just performs better. Didn&#x27;t run into PromQL compatibility issues with off-the-shelf Grafana dashboards.</div><br/></div></div><div id="41280698" class="c"><input type="checkbox" id="c-41280698" checked=""/><div class="controls bullet"><span class="by">valyala</span><span>|</span><a href="#41253782">root</a><span>|</span><a href="#41268596">parent</a><span>|</span><a href="#41279079">prev</a><span>|</span><a href="#41279893">next</a><span>|</span><label class="collapse" for="c-41280698">[-]</label><label class="expand" for="c-41280698">[1 more]</label></div><br/><div class="children"><div class="content">Could you provide more details regarding low quality APIs and PromQL compatibility issues? The following article explains &quot;issues&quot; with PromQL compatibility in VictoriaMetrics - <a href="https:&#x2F;&#x2F;medium.com&#x2F;@romanhavronenko&#x2F;victoriametrics-promql-compliance-d4318203f51e" rel="nofollow">https:&#x2F;&#x2F;medium.com&#x2F;@romanhavronenko&#x2F;victoriametrics-promql-c...</a> . See also  <a href="https:&#x2F;&#x2F;docs.victoriametrics.com&#x2F;metricsql&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.victoriametrics.com&#x2F;metricsql&#x2F;</a> . TL;DR: MetricsQL fixes PromQL issues with rate() and increase() functions. That&#x27;s why it is &quot;incompatible&quot; with PromQL.<p>Could you provide examples of FUD marketing from VictoriaMetrics?</div><br/></div></div></div></div></div></div><div id="41279893" class="c"><input type="checkbox" id="c-41279893" checked=""/><div class="controls bullet"><span class="by">29athrowaway</span><span>|</span><a href="#41253782">parent</a><span>|</span><a href="#41267184">prev</a><span>|</span><a href="#41276838">next</a><span>|</span><label class="collapse" for="c-41279893">[-]</label><label class="expand" for="c-41279893">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s how to monitor not what to monitor</div><br/></div></div></div></div><div id="41276838" class="c"><input type="checkbox" id="c-41276838" checked=""/><div class="controls bullet"><span class="by">cmg</span><span>|</span><a href="#41253782">prev</a><span>|</span><a href="#41280223">next</a><span>|</span><label class="collapse" for="c-41276838">[-]</label><label class="expand" for="c-41276838">[1 more]</label></div><br/><div class="children"><div class="content">With Icinga, for webservers:<p>- apt status (for security&#x2F;critical updates that haven&#x27;t been run yet)<p>- reboot needed (presence of &#x2F;var&#x2F;run&#x2F;reboot-required)<p>- fail2ban jail status (how many are in each of our defined jails)<p>- CPU usage<p>- MySQL active, long-running processes, number of queries<p>- iostat numbers<p>- disk space<p>- SSL cert expiration date<p>- domain expiration date<p>- reachability (ping, domain resolution, specific string in an HTTP request)<p>- Application-specific checks (WordPress, Drupal, CRM, etc)<p>- postfix queue size</div><br/></div></div><div id="41280223" class="c"><input type="checkbox" id="c-41280223" checked=""/><div class="controls bullet"><span class="by">mekster</span><span>|</span><a href="#41276838">prev</a><span>|</span><a href="#41276821">next</a><span>|</span><label class="collapse" for="c-41280223">[-]</label><label class="expand" for="c-41280223">[1 more]</label></div><br/><div class="children"><div class="content">Make sure whatever information provided can be actionable.<p>For example, providing CPU metric alone is just for alerting. If it exceeds a threshold, make sure it gives insights into which process&#x2F;container was using how much CPU at given moment. Bonus point if you can link logs from that process&#x2F;container of that time.<p>For disks, tell which directory is large, and what kind of file types are using much space.<p>Pretty graphs that don&#x27;t tell you what to look for next are nothing.</div><br/></div></div><div id="41276821" class="c"><input type="checkbox" id="c-41276821" checked=""/><div class="controls bullet"><span class="by">mgbmtl</span><span>|</span><a href="#41280223">prev</a><span>|</span><a href="#41243121">next</a><span>|</span><label class="collapse" for="c-41276821">[-]</label><label class="expand" for="c-41276821">[1 more]</label></div><br/><div class="children"><div class="content">I like icinga&#x27;s model, which can run a small agent on the server, but it doesn&#x27;t run as root. I grant specific sudo rules for checks that need elevated permissions.<p>I find it easier to write custom checks for things where I don&#x27;t control the application. My custom checks often do API calls for the applications they monitor (using curl locally against their own API).<p>There are also lots of existing scripts I can re-use, either from the Icinga or from Nagios community, so that I don&#x27;t write my own.<p>For example, recently I added systemd monitoring. There is a package for the check (monitoring-plugins-systemd). So I used Ansible to install everywhere, and then &quot;apply&quot; a conf to all my Debian servers. Helped me find a bunch of failing services or timers, which previously went un-noticed, including things like backups, where my backup monitoring said everything was OK, but the systemd service for borgmatic was running a &quot;check&quot; a found some corruption.<p>For logs I use promtail&#x2F;loki. Also very much worth the investment. Useful to detect elevated error rates, and also for finding slow http queries (again, I don&#x27;t fully control the code of applications I manage).</div><br/></div></div><div id="41243121" class="c"><input type="checkbox" id="c-41243121" checked=""/><div class="controls bullet"><span class="by">mmarian</span><span>|</span><a href="#41276821">prev</a><span>|</span><a href="#41278863">next</a><span>|</span><label class="collapse" for="c-41243121">[-]</label><label class="expand" for="c-41243121">[1 more]</label></div><br/><div class="children"><div class="content">I use netdata, works like a charm <a href="https:&#x2F;&#x2F;github.com&#x2F;netdata&#x2F;netdata">https:&#x2F;&#x2F;github.com&#x2F;netdata&#x2F;netdata</a></div><br/></div></div><div id="41278863" class="c"><input type="checkbox" id="c-41278863" checked=""/><div class="controls bullet"><span class="by">LeoPanthera</span><span>|</span><a href="#41243121">prev</a><span>|</span><a href="#41279438">next</a><span>|</span><label class="collapse" for="c-41278863">[-]</label><label class="expand" for="c-41278863">[8 more]</label></div><br/><div class="children"><div class="content">Perhaps I can hijack this post to ask some advice on <i>how</i> to monitor servers.<p>I don&#x27;t do this professionally. I have a small homelab that is mostly one router running opnsense, one fileserver running TrueNAS, and one container host running Proxmox.<p>Proxmox does have about 10-15 containers though, almost all Debian, and I feel like I should be doing more to keep an eye on both them and the physical servers themselves. Any suggestions?</div><br/><div id="41279396" class="c"><input type="checkbox" id="c-41279396" checked=""/><div class="controls bullet"><span class="by">eddyg</span><span>|</span><a href="#41278863">parent</a><span>|</span><a href="#41278909">next</a><span>|</span><label class="collapse" for="c-41279396">[-]</label><label class="expand" for="c-41279396">[4 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;netdata&#x2F;netdata">https:&#x2F;&#x2F;github.com&#x2F;netdata&#x2F;netdata</a></div><br/><div id="41280208" class="c"><input type="checkbox" id="c-41280208" checked=""/><div class="controls bullet"><span class="by">oriettaxx</span><span>|</span><a href="#41278863">root</a><span>|</span><a href="#41279396">parent</a><span>|</span><a href="#41278909">next</a><span>|</span><label class="collapse" for="c-41280208">[-]</label><label class="expand" for="c-41280208">[3 more]</label></div><br/><div class="children"><div class="content">nope please<p>all the free stuff almost disappeared, plus you&#x27;ll become stupid when you then want to remove their &quot;client&quot; (a huge bunch of stuff spread out everywhere)... I am talking about linux, of course.<p>Before installing everything assure you read the &quot;uninstall&quot; page, if any</div><br/><div id="41280991" class="c"><input type="checkbox" id="c-41280991" checked=""/><div class="controls bullet"><span class="by">oriettaxx</span><span>|</span><a href="#41278863">root</a><span>|</span><a href="#41280208">parent</a><span>|</span><a href="#41280362">next</a><span>|</span><label class="collapse" for="c-41280991">[-]</label><label class="expand" for="c-41280991">[1 more]</label></div><br/><div class="children"><div class="content">or yes, install it <i>only</i> as a container separated, as somebody suggested, but again: it costs a lot</div><br/></div></div></div></div></div></div><div id="41278909" class="c"><input type="checkbox" id="c-41278909" checked=""/><div class="controls bullet"><span class="by">SamPlgmsTooth</span><span>|</span><a href="#41278863">parent</a><span>|</span><a href="#41279396">prev</a><span>|</span><a href="#41279060">next</a><span>|</span><label class="collapse" for="c-41278909">[-]</label><label class="expand" for="c-41278909">[1 more]</label></div><br/><div class="children"><div class="content">snmp v3 (v3, because anything lower then this is unencrypted and 4) therefore not advised unless it’s on a trusted network)<p>For most Linux distros and network equipment, this will get you CPU&#x2F;Disk&#x2F;RAM&#x2F;Net statistics. Use LibreNMS for this which runs in a VM or CT which can alert you if metrics go out of spec.</div><br/></div></div><div id="41279060" class="c"><input type="checkbox" id="c-41279060" checked=""/><div class="controls bullet"><span class="by">YZF</span><span>|</span><a href="#41278863">parent</a><span>|</span><a href="#41278909">prev</a><span>|</span><a href="#41279056">next</a><span>|</span><label class="collapse" for="c-41279060">[-]</label><label class="expand" for="c-41279060">[1 more]</label></div><br/><div class="children"><div class="content">- Prometheus&#x2F;Grafana&#x2F;Alertmanager<p>- Zabbix<p>What are your goals though? I.e. why are you monitoring? Do you really care that much about getting alerted when something is down? Are you going to be looking at dashboards? Or do you just want to experiment&#x2F;learn the technologies?</div><br/></div></div><div id="41279056" class="c"><input type="checkbox" id="c-41279056" checked=""/><div class="controls bullet"><span class="by">pnw</span><span>|</span><a href="#41278863">parent</a><span>|</span><a href="#41279060">prev</a><span>|</span><a href="#41279438">next</a><span>|</span><label class="collapse" for="c-41279056">[-]</label><label class="expand" for="c-41279056">[1 more]</label></div><br/><div class="children"><div class="content">I run Uptime Kuma, it&#x27;s a simple but extensible set of monitors but perfect for a home network.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;louislam&#x2F;uptime-kuma">https:&#x2F;&#x2F;github.com&#x2F;louislam&#x2F;uptime-kuma</a></div><br/></div></div></div></div><div id="41279438" class="c"><input type="checkbox" id="c-41279438" checked=""/><div class="controls bullet"><span class="by">zie</span><span>|</span><a href="#41278863">prev</a><span>|</span><a href="#41280752">next</a><span>|</span><label class="collapse" for="c-41279438">[-]</label><label class="expand" for="c-41279438">[1 more]</label></div><br/><div class="children"><div class="content">I monitor periods between naps.  The longer I get naps the happier I am :)<p>Seriously though, the server itself is not the part that matters, what matters is the application(s) running on the server. So it depends heavily on what the application(s) care about.<p>If I&#x27;m doing some CPU heavy calculations on one server and streaming HTTPS off a different server, I&#x27;m going to care about different things.  Sure there are some common denominators, but for streaming static content I barely care about CPU stuff, but I care a lot about IO stuff.<p>I&#x27;m mostly agnostic to push vs pull, they both have their weaknesses. Ideally I would get to decide given my particular use case.<p>The lazy metrics, like you mentioned, are not that useful, like another commenter mentioned, &quot;free&quot; ram is mostly a pointless number, since these days most OS&#x27;s, wisely use it for caching. But information on the OS level caching can be very useful, depending on the work-loads I&#x27;m running on the system.<p>As for agents, what I care about is how stable, reliable and resource intensive it is. I want it to take zero resources, rock solid and reliable. Many agents fail spectacularly at all 3 of those things.  Crowdstrike is the most recent example of failure here with agent based monitoring.<p>The point of monitoring systems to me are two-fold:<p><pre><code>  *  Trying to spot problems before they become problems(i.e. we have X days before disk is full given current usage patterns).

  *  Trying to track down a problem as it is happening(i.e. App Y is slow in X scenario all of a sudden, why?).
</code></pre>
Focus on the point of monitoring and keep your agent as simple, solid and idiot proof as possible. Crowdstrike&#x27;s recent failure mode was completely preventable had the agent been written differently. Architect your agent as much as possible to never be another Crowdstrike.<p>Yes I know Crowdstrike was user machines, not servers, but server agent failures happen all the time too, in roughly the same ways, they just don&#x27;t make the news quite as often.</div><br/></div></div><div id="41280752" class="c"><input type="checkbox" id="c-41280752" checked=""/><div class="controls bullet"><span class="by">valyala</span><span>|</span><a href="#41279438">prev</a><span>|</span><a href="#41280741">next</a><span>|</span><label class="collapse" for="c-41280752">[-]</label><label class="expand" for="c-41280752">[1 more]</label></div><br/><div class="children"><div class="content">node_exporter ( <a href="https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;node_exporter">https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;node_exporter</a> ) and process_exporter ( <a href="https:&#x2F;&#x2F;github.com&#x2F;ncabatoff&#x2F;process-exporter">https:&#x2F;&#x2F;github.com&#x2F;ncabatoff&#x2F;process-exporter</a> ) expose the most of the useful metrics needed for monitoring server infrastructure together with the running processes. I&#x27;d recommend also taking a look at Coroot agent, which uses ebpf for exporting the essential host and process metrics - <a href="https:&#x2F;&#x2F;github.com&#x2F;coroot&#x2F;coroot-node-agent">https:&#x2F;&#x2F;github.com&#x2F;coroot&#x2F;coroot-node-agent</a> .<p>As for the agent, it is better from operations perspective to run a single observability agent per host. This agent should be small in size and lightweight on CPU and RAM usage, should have no external dependencies and should have close to zero configs, which need to be tuned, e.g. it should automatically discover all the apps and metrics needed to be monitored, and send them to the centralized observability database.<p>If you are lazy to write the agent on yourself, then take a look at vmagent ( <a href="https:&#x2F;&#x2F;docs.victoriametrics.com&#x2F;vmagent&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.victoriametrics.com&#x2F;vmagent&#x2F;</a> ), which scrapes metrics from the exporters mentioned above. vmagent satisfies most of the requirements stated above except of configuration - you need to provide configs for scraping metrics from separately installed exporters.</div><br/></div></div><div id="41280741" class="c"><input type="checkbox" id="c-41280741" checked=""/><div class="controls bullet"><span class="by">Izkata</span><span>|</span><a href="#41280752">prev</a><span>|</span><a href="#41280119">next</a><span>|</span><label class="collapse" for="c-41280741">[-]</label><label class="expand" for="c-41280741">[1 more]</label></div><br/><div class="children"><div class="content">&gt; For those of you managing server infrastructure,<p>As a developer who has often had to look into problems and performance issues, instead of an infrastructure person, this is basically the bare minimum of what I want to see:<p>* CPU usage<p>* RAM breakdown by at least Used&#x2F;Disk cache&#x2F;Free<p>* Disk fullness (preferably in absolute numbers, percents get screwy when total size changes)<p>* Disk reads&#x2F;writes<p>* Network reads&#x2F;writes<p>And this is high on the list but not required:<p>* Number of open TCP connections, possibly broken down by state<p>* Used&#x2F;free inodes (for relevant filesystems); we have actually used them up before (thanks npm)</div><br/></div></div><div id="41280119" class="c"><input type="checkbox" id="c-41280119" checked=""/><div class="controls bullet"><span class="by">tiffanyh</span><span>|</span><a href="#41280741">prev</a><span>|</span><a href="#41280913">next</a><span>|</span><label class="collapse" for="c-41280119">[-]</label><label class="expand" for="c-41280119">[3 more]</label></div><br/><div class="children"><div class="content">Q1: Can some ELI5 when you’d use:<p>- nagios<p>- Victoria metrics<p>- monit<p>- datadog<p>- prometheus grafana<p>- etc …<p>Q2: Also, is there something akin to “SQLite” for monitoring servers. Meaning, simple &#x2F; tested &#x2F; reliable tool to use.<p>Q3: if you ran a small saas business, which simple tool would you use to monitor your servers &amp; services health?</div><br/><div id="41280451" class="c"><input type="checkbox" id="c-41280451" checked=""/><div class="controls bullet"><span class="by">Yasuraka</span><span>|</span><a href="#41280119">parent</a><span>|</span><a href="#41280774">next</a><span>|</span><label class="collapse" for="c-41280451">[-]</label><label class="expand" for="c-41280451">[1 more]</label></div><br/><div class="children"><div class="content">Q1:<p>- Nagios: if it is already set up and covering all requirements in a legacy system.<p>- Prometheus + Grafana (+ Loki + ...): modern and extensible ecosystem with a unix-philosophy, my default choice of the times.<p>- Victoria Metrics: up and coming player that combines several features of the promstack into one but is also compatible to be used as part of the mix. Less moving parts and supposedly more performant, but also less accumulated knowledge in forums and the workforce.<p>- Datadog: if in a team of mainly developers who want good insights out of the box, ootb being the main feature, and if money is of no concern. Complete vendor lock-in and their sales reps will call your private number at 3 am on a sunday if they have it.<p>- Monit: if im a one man army (RoR on heroku type) who needs some basic monitoring and more importantly supervisor capabilities (e.g. restart service on failure).<p>Q2. That depends on your requirements (Scale? Logs? UI? Tracing? Environment (e.g. container)?), the less you need the simpler you can go. Some bash, systemd unit files and htop could be all you need.<p>Q3: I&#x27;d go with Prometheus and Grafana, easy enough to get going, extend as needed (features and scale) and hire for.</div><br/></div></div><div id="41280774" class="c"><input type="checkbox" id="c-41280774" checked=""/><div class="controls bullet"><span class="by">CSMastermind</span><span>|</span><a href="#41280119">parent</a><span>|</span><a href="#41280451">prev</a><span>|</span><a href="#41280913">next</a><span>|</span><label class="collapse" for="c-41280774">[-]</label><label class="expand" for="c-41280774">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Q3: if you ran a small saas business, which simple tool would you use to monitor your servers &amp; services health?<p>It seems like Datadog is an extremely obvious choice for this?<p>Unless you have someone you&#x27;re paying to do devops full time it&#x27;s almost certainly not worth the time you&#x27;ll have to invest in setting up any of the open source tools.<p>At small scales Datadog is fairly cheap and will almost certainly give you everything you need out of the box.</div><br/></div></div></div></div><div id="41280913" class="c"><input type="checkbox" id="c-41280913" checked=""/><div class="controls bullet"><span class="by">sebazzz</span><span>|</span><a href="#41280119">prev</a><span>|</span><a href="#41241777">next</a><span>|</span><label class="collapse" for="c-41280913">[-]</label><label class="expand" for="c-41280913">[1 more]</label></div><br/><div class="children"><div class="content">Is this from a sysops perspective? Because Nagios and its fork Ingca are still a thing.</div><br/></div></div><div id="41241777" class="c"><input type="checkbox" id="c-41241777" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#41280913">prev</a><span>|</span><a href="#41276973">next</a><span>|</span><label class="collapse" for="c-41241777">[-]</label><label class="expand" for="c-41241777">[2 more]</label></div><br/><div class="children"><div class="content">none of the things you list are for Logs. metrics are different use cases. do not use opentelemetry or you will suffer (and everyone who suffered will try to bring you to their hell)<p>look for guides written before 2010. seriously. it&#x27;s this bad. then after you have everything in one syslog somewhere, dump to a facy dashboard like o2.</div><br/><div id="41276372" class="c"><input type="checkbox" id="c-41276372" checked=""/><div class="controls bullet"><span class="by">tekno45</span><span>|</span><a href="#41241777">parent</a><span>|</span><a href="#41276973">next</a><span>|</span><label class="collapse" for="c-41276372">[-]</label><label class="expand" for="c-41276372">[1 more]</label></div><br/><div class="children"><div class="content">WHat are you using?<p>Haven&#x27;t seen the bad parts of open telemetry yet. Im thinking for a k8s cluster but curious what you&#x27;re using.</div><br/></div></div></div></div><div id="41276973" class="c"><input type="checkbox" id="c-41276973" checked=""/><div class="controls bullet"><span class="by">aleda145</span><span>|</span><a href="#41241777">prev</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41276973">[-]</label><label class="expand" for="c-41276973">[8 more]</label></div><br/><div class="children"><div class="content">For my homeserver I just have a small python script dumping metrics (CPU, RAM, disk, temperature and network speed) into a database (timescaleDB).<p>Then I visualize it with grafana, It&#x27;s actually live here if you want to check it out: <a href="https:&#x2F;&#x2F;grafana.dahl.dev" rel="nofollow">https:&#x2F;&#x2F;grafana.dahl.dev</a></div><br/><div id="41277029" class="c"><input type="checkbox" id="c-41277029" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#41276973">parent</a><span>|</span><a href="#41277044">next</a><span>|</span><label class="collapse" for="c-41277029">[-]</label><label class="expand" for="c-41277029">[2 more]</label></div><br/><div class="children"><div class="content">What’s the benefit of having this exposed to the web? Given it’s monitoring a homeserver, seems like overkill.<p>Why not secure it behind a VPN or tailscale if it’s just for personal use?</div><br/><div id="41277290" class="c"><input type="checkbox" id="c-41277290" checked=""/><div class="controls bullet"><span class="by">aleda145</span><span>|</span><a href="#41276973">root</a><span>|</span><a href="#41277029">parent</a><span>|</span><a href="#41277044">next</a><span>|</span><label class="collapse" for="c-41277290">[-]</label><label class="expand" for="c-41277290">[1 more]</label></div><br/><div class="children"><div class="content">None really, I had an idea that my friends could check it out if they notice a service disruption. They don&#x27;t though, so it&#x27;s just for fun!</div><br/></div></div></div></div><div id="41277044" class="c"><input type="checkbox" id="c-41277044" checked=""/><div class="controls bullet"><span class="by">jovial_cavalier</span><span>|</span><a href="#41276973">parent</a><span>|</span><a href="#41277029">prev</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41277044">[-]</label><label class="expand" for="c-41277044">[5 more]</label></div><br/><div class="children"><div class="content">having this up seems ill-advised. posting a link on HN seems crazy</div><br/><div id="41277227" class="c"><input type="checkbox" id="c-41277227" checked=""/><div class="controls bullet"><span class="by">simpaticoder</span><span>|</span><a href="#41276973">root</a><span>|</span><a href="#41277044">parent</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41277227">[-]</label><label class="expand" for="c-41277227">[4 more]</label></div><br/><div class="children"><div class="content">How does the threat model change when exposing grafana to the public? Apart from vulnerabilities in grafana itself? Perhaps  hackers will be extra motivated to cause blips in those graphs? Exposing grafana publically is unusual, but I don&#x27;t see an obvious error-mode.</div><br/><div id="41277270" class="c"><input type="checkbox" id="c-41277270" checked=""/><div class="controls bullet"><span class="by">linuxdude314</span><span>|</span><a href="#41276973">root</a><span>|</span><a href="#41277227">parent</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41277270">[-]</label><label class="expand" for="c-41277270">[3 more]</label></div><br/><div class="children"><div class="content">It’s really not abnormal. GrafanaLabs does this all the time with their IaaS product.<p>There’s nothing wrong with exposing Grafana as long as you’re following security best practices.<p>It’s 2024, zero trust networking is where you want to be.  Real zero trust networking is NOT adding a VPN to access internal services. It’s doing away with the notion of internal services all together and securing them for exposure on the internet.</div><br/><div id="41278861" class="c"><input type="checkbox" id="c-41278861" checked=""/><div class="controls bullet"><span class="by">Fripplebubby</span><span>|</span><a href="#41276973">root</a><span>|</span><a href="#41277270">parent</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41278861">[-]</label><label class="expand" for="c-41278861">[2 more]</label></div><br/><div class="children"><div class="content">Really? So in 2024, folks are only deploying services that have excellent security, and not anything else? This seems like a high bar to clear but I&#x27;m curious to learn.</div><br/><div id="41278947" class="c"><input type="checkbox" id="c-41278947" checked=""/><div class="controls bullet"><span class="by">e28eta</span><span>|</span><a href="#41276973">root</a><span>|</span><a href="#41278861">parent</a><span>|</span><a href="#41280905">next</a><span>|</span><label class="collapse" for="c-41278947">[-]</label><label class="expand" for="c-41278947">[1 more]</label></div><br/><div class="children"><div class="content">Article and discussion from earlier today that’s relevant: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41274932">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41274932</a><p>It’s about zero trust, includes the claim “VPNs are Deprecated!”</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41280905" class="c"><input type="checkbox" id="c-41280905" checked=""/><div class="controls bullet"><span class="by">whirlwin</span><span>|</span><a href="#41276973">prev</a><span>|</span><a href="#41279873">next</a><span>|</span><label class="collapse" for="c-41280905">[-]</label><label class="expand" for="c-41280905">[1 more]</label></div><br/><div class="children"><div class="content">node_exporter all the way: <a href="https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;node_exporter">https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;node_exporter</a></div><br/></div></div><div id="41279873" class="c"><input type="checkbox" id="c-41279873" checked=""/><div class="controls bullet"><span class="by">nrr</span><span>|</span><a href="#41280905">prev</a><span>|</span><a href="#41280228">next</a><span>|</span><label class="collapse" for="c-41279873">[-]</label><label class="expand" for="c-41279873">[3 more]</label></div><br/><div class="children"><div class="content">One thing to be aware of is that up&#x2F;down alerting bakes downtime into the incident detection and response process, so literally anything anyone can do to get away from that will help.<p>A lot of the details are pretty application-specific, but the metrics I care about can be broadly classified as &quot;pressure&quot; metrics: CPU pressure, memory pressure, I&#x2F;O pressure, network pressure, etc.<p>Something that&#x27;s &quot;overpressure&quot; can manifest as, e.g., excessively paging in and out, a lot of processes&#x2F;threads stuck in &quot;defunct&quot; state, DNS resolutions failing, and so on.<p>I don&#x27;t have much of an opinion about push versus pull metrics collection as long as it doesn&#x27;t melt my switches. They both have their place. (That said, programmable aggregation on the metrics exporter is something that&#x27;s nice to have.)</div><br/><div id="41279885" class="c"><input type="checkbox" id="c-41279885" checked=""/><div class="controls bullet"><span class="by">29athrowaway</span><span>|</span><a href="#41279873">parent</a><span>|</span><a href="#41280228">next</a><span>|</span><label class="collapse" for="c-41279885">[-]</label><label class="expand" for="c-41279885">[2 more]</label></div><br/><div class="children"><div class="content">What you call pressure is often called saturation. Saturation means the resource is at 100% utilization.<p>But saturation is not the same as errors.</div><br/><div id="41280327" class="c"><input type="checkbox" id="c-41280327" checked=""/><div class="controls bullet"><span class="by">nrr</span><span>|</span><a href="#41279873">root</a><span>|</span><a href="#41279885">parent</a><span>|</span><a href="#41280228">next</a><span>|</span><label class="collapse" for="c-41280327">[-]</label><label class="expand" for="c-41280327">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m talking <i>beyond</i> saturation.<p>There are actually quite a few resources for which I&#x27;d like to maintain something resembling steady-state saturation, like CPU and RAM utilization. However, it&#x27;s when I&#x27;ve overcommitted those resources (e.g., for RAM, no more cache pages that can&#x27;t simply be purged to make more room for RSS) that I start to see problems. (Of note, if I start paging in and out too much, that can also affect task switching, which leaves the kernel doing way more work, which itself can lead to a fun cascade of problems.)</div><br/></div></div></div></div></div></div><div id="41280228" class="c"><input type="checkbox" id="c-41280228" checked=""/><div class="controls bullet"><span class="by">oriettaxx</span><span>|</span><a href="#41279873">prev</a><span>|</span><a href="#41280239">next</a><span>|</span><label class="collapse" for="c-41280228">[-]</label><label class="expand" for="c-41280228">[1 more]</label></div><br/><div class="children"><div class="content">don&#x27;t forget the &quot;CPU steal&quot; state, and AWS cpu burst credit<p>I general I would also suggest to monitor server costs (aws EC2 costs, e.g.)<p>For example, you should be aware that T3 AWS Ec2 instances will just cost <i>double</i> if your CPU is just used, and this since the flag &quot;unlimited&quot; in credit is ON by default: I personally hate the whole &quot;cpu credit&quot; AWS model... it is an instrument totally in their (AWS) hands to just make more money...</div><br/></div></div><div id="41280239" class="c"><input type="checkbox" id="c-41280239" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#41280228">prev</a><span>|</span><a href="#41280376">next</a><span>|</span><label class="collapse" for="c-41280239">[-]</label><label class="expand" for="c-41280239">[1 more]</label></div><br/><div class="children"><div class="content">&gt; disk usage<p>There&#x27;s a bunch of ways of measuring &quot;usage&quot; for disks, apart from the &quot;how much space is used&quot;.  There&#x27;s &quot;how many iops&quot; (vs the total available for the disk), there&#x27;s how much wear % is used&#x2F;left for the disk (specific to flash), how much read&#x2F;write bandwidth is being used (vs the maximum for the disk), and so on.</div><br/></div></div><div id="41280376" class="c"><input type="checkbox" id="c-41280376" checked=""/><div class="controls bullet"><span class="by">udev4096</span><span>|</span><a href="#41280239">prev</a><span>|</span><a href="#41279267">next</a><span>|</span><label class="collapse" for="c-41280376">[-]</label><label class="expand" for="c-41280376">[1 more]</label></div><br/><div class="children"><div class="content">For monitoring proxmox host(s), I use the influxdb to store all the proxmox metrics and then grafana for a beautiful display.<p>As for the servers, I use uptime kuma (notifies whenever a service goes down), glance (htop in web), vnstat (for network traffic usage) and loki (for logs monitoring)</div><br/></div></div><div id="41279267" class="c"><input type="checkbox" id="c-41279267" checked=""/><div class="controls bullet"><span class="by">tgtweak</span><span>|</span><a href="#41280376">prev</a><span>|</span><a href="#41278800">next</a><span>|</span><label class="collapse" for="c-41279267">[-]</label><label class="expand" for="c-41279267">[1 more]</label></div><br/><div class="children"><div class="content">using datadog these days, newrelic previously - basically every metric you can collect.<p>Disk i&#x2F;o and network i&#x2F;o is particularly important but most of the information you truly care about lies in application traces and application logs.
Database metrics in a close second particularly cache&#x2F;index usage and disk activity, query profiling.
Network too if your application is bandwidth heavy.</div><br/></div></div><div id="41278800" class="c"><input type="checkbox" id="c-41278800" checked=""/><div class="controls bullet"><span class="by">xorcist</span><span>|</span><a href="#41279267">prev</a><span>|</span><a href="#41276316">next</a><span>|</span><label class="collapse" for="c-41278800">[-]</label><label class="expand" for="c-41278800">[1 more]</label></div><br/><div class="children"><div class="content">Active monitoring is a different animal from passive metrics collection. Which is different from log transport.<p>The Nagios ecosystem was fragmented for the longest time but now it seems most users have drifted towards Icinga, so this is what I use for monitoring. There is some basic integration with Grafana for metrics, so that is for I use for metrics panels. There is good reason to not use your innovation budget on monitoring, instead use simple software that will continue to be around for a long time.<p>As for what to monitor, that is application specific and should go into the application manifest or configuration management. But generally there should be some sort of active operation that touches the common data path, such as a login, creation of a dummy object such as for example an empty order, validation of said object, and destruction&#x2F;clean up.<p>Outside the application there should be checks for whatever the application relies on. Working DNS, NTP drift, Ansible health, certificate validity, applicable APT&#x2F;RPM packages, database vacuums, log transport health, and the exit status or last file date of scheduled or backgrounded jobs.<p>Metrics should be collected for total connections, their return status, all types of I&#x2F;O latency and throughput, and system resources such as CPU, memory, disk space.</div><br/></div></div><div id="41276316" class="c"><input type="checkbox" id="c-41276316" checked=""/><div class="controls bullet"><span class="by">waynenilsen</span><span>|</span><a href="#41278800">prev</a><span>|</span><a href="#41279863">next</a><span>|</span><label class="collapse" for="c-41276316">[-]</label><label class="expand" for="c-41276316">[1 more]</label></div><br/><div class="children"><div class="content">Available file descriptors</div><br/></div></div><div id="41279863" class="c"><input type="checkbox" id="c-41279863" checked=""/><div class="controls bullet"><span class="by">bearjaws</span><span>|</span><a href="#41276316">prev</a><span>|</span><a href="#41278424">next</a><span>|</span><label class="collapse" for="c-41279863">[-]</label><label class="expand" for="c-41279863">[2 more]</label></div><br/><div class="children"><div class="content">Tasks are the more annoying things to track.<p>Did it run? Is it still running? Did it have any errors? Why did it fail? Which step did it fail on?<p>My last job built a job tracker for &quot;cron&quot; tasks that supported actual cron tab + could schedule hitting a https endpoint.<p>Of course it requires code modification to ensure it writes <i>something</i> so you can tell it ran in the first place. But that was part of modernizing a 10 year old LAMP stack.</div><br/><div id="41280630" class="c"><input type="checkbox" id="c-41280630" checked=""/><div class="controls bullet"><span class="by">porker</span><span>|</span><a href="#41279863">parent</a><span>|</span><a href="#41278424">next</a><span>|</span><label class="collapse" for="c-41280630">[-]</label><label class="expand" for="c-41280630">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;healthchecks.io" rel="nofollow">https:&#x2F;&#x2F;healthchecks.io</a> ftw</div><br/></div></div></div></div><div id="41278424" class="c"><input type="checkbox" id="c-41278424" checked=""/><div class="controls bullet"><span class="by">arcbyte</span><span>|</span><a href="#41279863">prev</a><span>|</span><a href="#41280080">next</a><span>|</span><label class="collapse" for="c-41278424">[-]</label><label class="expand" for="c-41278424">[2 more]</label></div><br/><div class="children"><div class="content">Whatever directly and naterially affects affects cost and that&#x27;s it.<p>For some of my services on DigitalOcean for instance, I monitor RAM because using a smaller instance can dramatically save money.<p>But for the most part I don&#x27;t monitor anything - if it doesn&#x27;t make me money why do I care?</div><br/><div id="41278560" class="c"><input type="checkbox" id="c-41278560" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#41278424">parent</a><span>|</span><a href="#41280080">next</a><span>|</span><label class="collapse" for="c-41278560">[-]</label><label class="expand" for="c-41278560">[1 more]</label></div><br/><div class="children"><div class="content">I have a list of things I look at every few weeks to see if we’ve developed any new bad habits that are going to bite us.<p>Open feedback loops make it difficult for people to adjust their behavior. Catching the bad habits early makes them a lot more shallow.</div><br/></div></div></div></div><div id="41280080" class="c"><input type="checkbox" id="c-41280080" checked=""/><div class="controls bullet"><span class="by">damonll</span><span>|</span><a href="#41278424">prev</a><span>|</span><a href="#41277191">next</a><span>|</span><label class="collapse" for="c-41280080">[-]</label><label class="expand" for="c-41280080">[1 more]</label></div><br/><div class="children"><div class="content">Look at major cloud providers and what they offer in monitoring such AWS CloudWatch, etc.<p>Be warned though there are a ton of monitoring solutions already. Hopefully yours has something special to bring to the table.</div><br/></div></div><div id="41277191" class="c"><input type="checkbox" id="c-41277191" checked=""/><div class="controls bullet"><span class="by">koliber</span><span>|</span><a href="#41280080">prev</a><span>|</span><a href="#41279113">next</a><span>|</span><label class="collapse" for="c-41277191">[-]</label><label class="expand" for="c-41277191">[1 more]</label></div><br/><div class="children"><div class="content">In addition to the things already mentioned, there are a few higher level things which I find helpful:<p>- http req counts vs total non-200-response count vs. 404-and-30x count.<p>- whatever asynchronous jobs your run, a graph of jobs started vs jobs finished will show you a rough resource utilization and highlight gross bottlenecks.</div><br/></div></div><div id="41279113" class="c"><input type="checkbox" id="c-41279113" checked=""/><div class="controls bullet"><span class="by">malkosta</span><span>|</span><a href="#41277191">prev</a><span>|</span><a href="#41280091">next</a><span>|</span><label class="collapse" for="c-41279113">[-]</label><label class="expand" for="c-41279113">[1 more]</label></div><br/><div class="children"><div class="content">Amount of 4xx, 500, and 2xx of an http application can tell a lot about application anomalies. Other protocols also have their error responses.<p>I also keep a close eye in the throughput VS response time ratio, specially the 95th percentile of the resp time.<p>It’s also great to have this same ratio measurement for the DBs you might use.<p>Those are my go to daily metrics, the rest can be zoomed in their own dashboards after I first check this.</div><br/></div></div><div id="41280091" class="c"><input type="checkbox" id="c-41280091" checked=""/><div class="controls bullet"><span class="by">maxboone</span><span>|</span><a href="#41279113">prev</a><span>|</span><label class="collapse" for="c-41280091">[-]</label><label class="expand" for="c-41280091">[1 more]</label></div><br/><div class="children"><div class="content">Take a look at vector, I personally prefer it over fluentd and don&#x27;t think you&#x27;ll need a custom monitoring agent with it.</div><br/></div></div></div></div></div></div></div></body></html>