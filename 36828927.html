<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1690102844211" as="style"/><link rel="stylesheet" href="styles.css?v=1690102844211"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://eclecticlight.co/2022/10/05/making-the-most-of-apple-silicon-power-2-core-capabilities/">Making the most of Apple Silicon power: 2 Core capabilities (2022)</a> <span class="domain">(<a href="https://eclecticlight.co">eclecticlight.co</a>)</span></div><div class="subtext"><span>nateb2022</span> | <span>22 comments</span></div><br/><div><div id="36830980" class="c"><input type="checkbox" id="c-36830980" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#36830477">next</a><span>|</span><label class="collapse" for="c-36830980">[-]</label><label class="expand" for="c-36830980">[4 more]</label></div><br/><div class="children"><div class="content">This is part 2 of a series of 7 articles. Navigation between the articles isn&#x27;t super clear, so here&#x27;s an index:<p>1. &quot;M-series chips are different&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;03&#x2F;making-the-most-of-apple-silicon-power-1-m-series-chips-are-different&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;03&#x2F;making-the-most-of-apple...</a><p>2. &quot;Core capabilities&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;05&#x2F;making-the-most-of-apple-silicon-power-2-core-capabilities&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;05&#x2F;making-the-most-of-apple...</a> (this one)<p>3. &quot;Controls&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;13&#x2F;making-the-most-of-apple-silicon-power-3-controls&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;13&#x2F;making-the-most-of-apple...</a><p>4. &quot;Frequency&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;17&#x2F;making-the-most-of-apple-silicon-power-4-frequency&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;17&#x2F;making-the-most-of-apple...</a><p>5. &quot;User control&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;20&#x2F;making-the-most-of-apple-silicon-power-5-user-control&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;20&#x2F;making-the-most-of-apple...</a><p>6. &quot;Empowering users&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;24&#x2F;making-the-most-of-apple-silicon-power-6-empowering-users&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;24&#x2F;making-the-most-of-apple...</a><p>7. &quot;Virtualisation and core use&quot; <a href="https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;27&#x2F;making-the-most-of-apple-silicon-power-7-virtualisation-and-core-use&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;27&#x2F;making-the-most-of-apple...</a></div><br/><div id="36831363" class="c"><input type="checkbox" id="c-36831363" checked=""/><div class="controls bullet"><span class="by">zeusk</span><span>|</span><a href="#36830980">parent</a><span>|</span><a href="#36830477">next</a><span>|</span><label class="collapse" for="c-36831363">[-]</label><label class="expand" for="c-36831363">[3 more]</label></div><br/><div class="children"><div class="content">1, is incorrect in the last paragraph about Intel Thread Director.<p>The hardware classifies every thread context into one of 4 classes and provides the OS with dynamic perf&#x2F;power values for all cores. It&#x27;s the Windows thread scheduler that makes the final decision just like on mac but can make use of the additional hints from the CPU for doing a better job.<p>I&#x27;m lost on how a CPU would schedule workload when most of the information is stored in OS&#x27;s process&#x2F;thread structures that aren&#x27;t shared with the firmware&#x2F;p-code and it&#x27;s supposed to work with multiple platforms.</div><br/><div id="36831458" class="c"><input type="checkbox" id="c-36831458" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#36830980">root</a><span>|</span><a href="#36831363">parent</a><span>|</span><a href="#36830477">next</a><span>|</span><label class="collapse" for="c-36831458">[-]</label><label class="expand" for="c-36831458">[2 more]</label></div><br/><div class="children"><div class="content">Additionally, Intel Thread Director only works under Windows 11 and whichever version of Linux that implemented support onwards.<p>Windows 10 and prior schedule in the blind, so to speak.</div><br/><div id="36832440" class="c"><input type="checkbox" id="c-36832440" checked=""/><div class="controls bullet"><span class="by">zeusk</span><span>|</span><a href="#36830980">root</a><span>|</span><a href="#36831458">parent</a><span>|</span><a href="#36830477">next</a><span>|</span><label class="collapse" for="c-36832440">[-]</label><label class="expand" for="c-36832440">[1 more]</label></div><br/><div class="children"><div class="content">Yup; well that&#x27;s because Microsoft has extremely high bar for backporting feature requests. In thread director&#x27;s case, the missing functionality isn&#x27;t a deal breaker for the types of systems restricted to Win 10.</div><br/></div></div></div></div></div></div></div></div><div id="36830477" class="c"><input type="checkbox" id="c-36830477" checked=""/><div class="controls bullet"><span class="by">rubatuga</span><span>|</span><a href="#36830980">prev</a><span>|</span><a href="#36833096">next</a><span>|</span><label class="collapse" for="c-36830477">[-]</label><label class="expand" for="c-36830477">[2 more]</label></div><br/><div class="children"><div class="content">You can force it to E core, using the taskpolicy command.<p>Here I use it to let my VM run in the background:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;yoonsikp&#x2F;vm_configs&#x2F;blob&#x2F;master&#x2F;power_save.sh">https:&#x2F;&#x2F;github.com&#x2F;yoonsikp&#x2F;vm_configs&#x2F;blob&#x2F;master&#x2F;power_sav...</a></div><br/><div id="36831093" class="c"><input type="checkbox" id="c-36831093" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#36830477">parent</a><span>|</span><a href="#36833096">next</a><span>|</span><label class="collapse" for="c-36831093">[-]</label><label class="expand" for="c-36831093">[1 more]</label></div><br/><div class="children"><div class="content">How much RAM do you account for this using (regardless of E core or not)?</div><br/></div></div></div></div><div id="36831792" class="c"><input type="checkbox" id="c-36831792" checked=""/><div class="controls bullet"><span class="by">bartekpacia</span><span>|</span><a href="#36833096">prev</a><span>|</span><a href="#36830729">next</a><span>|</span><label class="collapse" for="c-36831792">[-]</label><label class="expand" for="c-36831792">[1 more]</label></div><br/><div class="children"><div class="content">This website has so many more great articles, and now there&#x27;s a new one! I highly recommend reading the other ones about macOS internals.</div><br/></div></div><div id="36830729" class="c"><input type="checkbox" id="c-36830729" checked=""/><div class="controls bullet"><span class="by">polishTar</span><span>|</span><a href="#36831792">prev</a><span>|</span><a href="#36829745">next</a><span>|</span><label class="collapse" for="c-36830729">[-]</label><label class="expand" for="c-36830729">[2 more]</label></div><br/><div class="children"><div class="content">Interesting read.<p>I wonder what went into the decision on the ratio of P to E cores. Naively it seems like more of the die space should be dedicated to E cores since they&#x27;re so killer for workloads where efficiency or throughput matter. Obviously some jobs  can&#x27;t spread the load across multiple threads and are sensitive to single-threaded latency, but those workloads won&#x27;t benefit from so many P cores anyways.</div><br/><div id="36833645" class="c"><input type="checkbox" id="c-36833645" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#36830729">parent</a><span>|</span><a href="#36829745">next</a><span>|</span><label class="collapse" for="c-36833645">[-]</label><label class="expand" for="c-36833645">[1 more]</label></div><br/><div class="children"><div class="content">There’s only so many background &#x2F; non-interactive tasks you need to run, and especially that you need to run <i>now</i>: with more Es you increase the parallelism but if everything goes idle quickly you’ve kinda wasted the silicon.<p>P cores are more relevant for interactive work which the user is waiting on, hence he sacrifice if efficiency.</div><br/></div></div></div></div><div id="36829745" class="c"><input type="checkbox" id="c-36829745" checked=""/><div class="controls bullet"><span class="by">mandalorianer</span><span>|</span><a href="#36830729">prev</a><span>|</span><a href="#36830086">next</a><span>|</span><label class="collapse" for="c-36829745">[-]</label><label class="expand" for="c-36829745">[2 more]</label></div><br/><div class="children"><div class="content">The link is dead.</div><br/><div id="36829851" class="c"><input type="checkbox" id="c-36829851" checked=""/><div class="controls bullet"><span class="by">crtasm</span><span>|</span><a href="#36829745">parent</a><span>|</span><a href="#36830086">next</a><span>|</span><label class="collapse" for="c-36829851">[-]</label><label class="expand" for="c-36829851">[1 more]</label></div><br/><div class="children"><div class="content">Working here, and also now saved to wayback machine.<p><a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20230722191544&#x2F;https:&#x2F;&#x2F;eclecticlight.co&#x2F;2022&#x2F;10&#x2F;05&#x2F;making-the-most-of-apple-silicon-power-2-core-capabilities&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20230722191544&#x2F;https:&#x2F;&#x2F;eclecticl...</a></div><br/></div></div></div></div><div id="36830086" class="c"><input type="checkbox" id="c-36830086" checked=""/><div class="controls bullet"><span class="by">BeastMachine</span><span>|</span><a href="#36829745">prev</a><span>|</span><label class="collapse" for="c-36830086">[-]</label><label class="expand" for="c-36830086">[9 more]</label></div><br/><div class="children"><div class="content">While you can&#x27;t explicitly allocate a process to E cores, I wonder if you&#x27;d be able  to make a program which floods high QoS processes to saturate E cores until they are full and then launch the desired application into a P core</div><br/><div id="36830222" class="c"><input type="checkbox" id="c-36830222" checked=""/><div class="controls bullet"><span class="by">treesciencebot</span><span>|</span><a href="#36830086">parent</a><span>|</span><a href="#36830999">next</a><span>|</span><label class="collapse" for="c-36830222">[-]</label><label class="expand" for="c-36830222">[2 more]</label></div><br/><div class="children"><div class="content">This is a similar hack to what AMD does with their new 3D-series processors with two CCDs (or clusters following this article&#x27;s terminology). One of them has a higher clock count but the other one has much more L3 cache. Since their target is gamers (at least at the consumer level chips), they basically ship a driver which detects when you launch a game and &quot;parks&quot; the low-cache CCD from being assigned tasks which effectively dispatches your processes to the high-cache ccd.</div><br/><div id="36831419" class="c"><input type="checkbox" id="c-36831419" checked=""/><div class="controls bullet"><span class="by">nagisa</span><span>|</span><a href="#36830086">root</a><span>|</span><a href="#36830222">parent</a><span>|</span><a href="#36830999">next</a><span>|</span><label class="collapse" for="c-36831419">[-]</label><label class="expand" for="c-36831419">[1 more]</label></div><br/><div class="children"><div class="content">EPYC SKUs with 3D cache also exist. Though I’m not 100% sure if it uses heterogenous chiplet approach that is seen in consumer RYZEN chips.</div><br/></div></div></div></div><div id="36830999" class="c"><input type="checkbox" id="c-36830999" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#36830086">parent</a><span>|</span><a href="#36830222">prev</a><span>|</span><a href="#36832388">next</a><span>|</span><label class="collapse" for="c-36830999">[-]</label><label class="expand" for="c-36830999">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure I see the point? Applications generally run on P cores by default; there&#x27;s no need to go through those sorts of gymnastics to make that happen.</div><br/><div id="36831441" class="c"><input type="checkbox" id="c-36831441" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#36830086">root</a><span>|</span><a href="#36830999">parent</a><span>|</span><a href="#36832388">next</a><span>|</span><label class="collapse" for="c-36831441">[-]</label><label class="expand" for="c-36831441">[1 more]</label></div><br/><div class="children"><div class="content">On my M2 Macbook Air, I see everything generally executes on the E-cores. The P-cores only see load when there&#x27;s clearly something that needs lots of processing power.<p>I presume there&#x27;s logic in the scheduler to prioritize E-cores for battery life purposes.</div><br/></div></div></div></div><div id="36832388" class="c"><input type="checkbox" id="c-36832388" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#36830086">parent</a><span>|</span><a href="#36830999">prev</a><span>|</span><a href="#36830228">next</a><span>|</span><label class="collapse" for="c-36832388">[-]</label><label class="expand" for="c-36832388">[1 more]</label></div><br/><div class="children"><div class="content">No. Application with low priority will only be scheduled on efficiency cores regardless of how oversubscribed they are.</div><br/></div></div><div id="36830228" class="c"><input type="checkbox" id="c-36830228" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#36830086">parent</a><span>|</span><a href="#36832388">prev</a><span>|</span><label class="collapse" for="c-36830228">[-]</label><label class="expand" for="c-36830228">[3 more]</label></div><br/><div class="children"><div class="content">You can&#x27;t set a process&#x27;s processor affinity (aka which core(s) the process will execute on)?</div><br/><div id="36830767" class="c"><input type="checkbox" id="c-36830767" checked=""/><div class="controls bullet"><span class="by">Shekelphile</span><span>|</span><a href="#36830086">root</a><span>|</span><a href="#36830228">parent</a><span>|</span><a href="#36832391">next</a><span>|</span><label class="collapse" for="c-36830767">[-]</label><label class="expand" for="c-36830767">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it&#x27;s completely guaranteed that you can choose such things anymore. Some scheduling work has to be done at the hardware level and it&#x27;s certainly going to be hijacked as heterogeneous CPU micro architecture becomes more pervasive and the gulf of difference in feature set between efficiency and performance cores becomes wider.</div><br/></div></div><div id="36832391" class="c"><input type="checkbox" id="c-36832391" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#36830086">root</a><span>|</span><a href="#36830228">parent</a><span>|</span><a href="#36830767">prev</a><span>|</span><label class="collapse" for="c-36832391">[-]</label><label class="expand" for="c-36832391">[1 more]</label></div><br/><div class="children"><div class="content">This is not exposed on production systems.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>