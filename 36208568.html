<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1686042057472" as="style"/><link rel="stylesheet" href="styles.css?v=1686042057472"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.turso.tech/why-sqlite-is-so-great-for-the-edge-ee00a3a9a55f">Why SQLite is so great for the edge</a> <span class="domain">(<a href="https://blog.turso.tech">blog.turso.tech</a>)</span></div><div class="subtext"><span>thunderbong</span> | <span>31 comments</span></div><br/><div><div id="36209896" class="c"><input type="checkbox" id="c-36209896" checked=""/><div class="controls bullet"><span class="by">xyx0826</span><span>|</span><a href="#36210045">next</a><span>|</span><label class="collapse" for="c-36209896">[-]</label><label class="expand" for="c-36209896">[3 more]</label></div><br/><div class="children"><div class="content">I extensively used SQLite in a telemetry system for an electric race car. The car has an onboard computer, first a Raspberry Pi then a dual core Arm processor. Onboard code logs ~4000 messages a second into three SQLite databases. After a drive session a script merges the three databases into a single SQLite session log. The session log is decoded on a different computer to ~400 columns of time series data again stored in SQLite. This data is then finally converted into a proprietary format for visual analysis.<p>Prior to SQLite I tried CSV files and raw binary formats. None of them could match the flexibility, ease of use, and throughput of SQLite. My setup has been in use for several weeks now and has processed numerous rows of data. As the SQLite project outlines on its website:<p>&gt; SQLite does not compete with client&#x2F;server databases. SQLite competes with fopen().</div><br/><div id="36209919" class="c"><input type="checkbox" id="c-36209919" checked=""/><div class="controls bullet"><span class="by">lloydatkinson</span><span>|</span><a href="#36209896">parent</a><span>|</span><a href="#36209920">next</a><span>|</span><label class="collapse" for="c-36209919">[-]</label><label class="expand" for="c-36209919">[1 more]</label></div><br/><div class="children"><div class="content">Sounds cool! Any project details anywhere?</div><br/></div></div><div id="36209920" class="c"><input type="checkbox" id="c-36209920" checked=""/><div class="controls bullet"><span class="by">nitwit005</span><span>|</span><a href="#36209896">parent</a><span>|</span><a href="#36209919">prev</a><span>|</span><a href="#36210045">next</a><span>|</span><label class="collapse" for="c-36209920">[-]</label><label class="expand" for="c-36209920">[1 more]</label></div><br/><div class="children"><div class="content">This article isn&#x27;t talking about the edge as embedded systems. It means cloudflare workers and the like.</div><br/></div></div></div></div><div id="36210045" class="c"><input type="checkbox" id="c-36210045" checked=""/><div class="controls bullet"><span class="by">jgrahamc</span><span>|</span><a href="#36209896">prev</a><span>|</span><a href="#36209938">next</a><span>|</span><label class="collapse" for="c-36210045">[-]</label><label class="expand" for="c-36210045">[1 more]</label></div><br/><div class="children"><div class="content">This no need to compile SQLite into your Cloudflare Worker. We provide it native on our platform as D1. <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;d1-turning-it-up-to-11&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;d1-turning-it-up-to-11&#x2F;</a><p>Also, I think the idea of “edge” doesn’t make a ton of sense. What we really need is code and data that move around as needed for the best performance. See: <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;announcing-workers-smart-placement&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;announcing-workers-smart-placeme...</a><p>What people call “edge” is a single optimization bringing code near the user. I think we should go far beyond that.</div><br/></div></div><div id="36209938" class="c"><input type="checkbox" id="c-36209938" checked=""/><div class="controls bullet"><span class="by">kubb</span><span>|</span><a href="#36210045">prev</a><span>|</span><a href="#36209447">next</a><span>|</span><label class="collapse" for="c-36209938">[-]</label><label class="expand" for="c-36209938">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s so insane that he links to a whole another post to clarify what he means by &quot;the edge&quot;, and he struggles to state that in the first 5 paragraphs of it.</div><br/><div id="36210029" class="c"><input type="checkbox" id="c-36210029" checked=""/><div class="controls bullet"><span class="by">melx</span><span>|</span><a href="#36209938">parent</a><span>|</span><a href="#36209447">next</a><span>|</span><label class="collapse" for="c-36210029">[-]</label><label class="expand" for="c-36210029">[1 more]</label></div><br/><div class="children"><div class="content">Well, the post &quot;about the edge&quot; also links to some announcement post there they &quot;tried&quot; to talk about the edge in more edgy details. Yet, it&#x27;s like paragraph 67 on that 3rd post they were mention something about &quot;the edge&quot;.</div><br/></div></div></div></div><div id="36209447" class="c"><input type="checkbox" id="c-36209447" checked=""/><div class="controls bullet"><span class="by">runeks</span><span>|</span><a href="#36209938">prev</a><span>|</span><a href="#36210017">next</a><span>|</span><label class="collapse" for="c-36209447">[-]</label><label class="expand" for="c-36209447">[4 more]</label></div><br/><div class="children"><div class="content">&gt; It’s borderline impossible to compare it against networked database management systems like MySQL or Postgres, because SQLite is a library that operates on a local file — it bypasses all the costs incurred by the network, layers of serialization and deserialization, authentication, authorization, and more.<p>Postgres can run locally, communicating via a Unix socket. You should try benchmarking this before stating that it&#x27;s so much slower than SQLite.</div><br/><div id="36209523" class="c"><input type="checkbox" id="c-36209523" checked=""/><div class="controls bullet"><span class="by">citrin_ru</span><span>|</span><a href="#36209447">parent</a><span>|</span><a href="#36209964">next</a><span>|</span><label class="collapse" for="c-36209523">[-]</label><label class="expand" for="c-36209523">[1 more]</label></div><br/><div class="children"><div class="content">Even with Unix socket there will be at least one additional copy across kernel - userpace boundary compare to SQLite (and likely at least one copy inside the kernel too from one socket buffer to another). Yes, a Unix socket has lower overhead than a TCP one, but still not free:<p><pre><code>  kernel (filesystem) -&gt; app with SQLite library
  kernel (filesystem) -&gt; Postgres -&gt; kernel -&gt; app with Postgres client
</code></pre>
If Postgres reads data from own cache (not from disk) the chain will be one step shorter: Postgres -&gt; kernel -&gt; client, but the same true for SQLite own cache.<p>If mmap is used (make sense for small data sets cached in RAM) then reading data by SQLite can be zero-copy [1].<p>Benchmark result highly depends on a use case - neither is better for all use cases but at least for some use cases SQLite is faster.<p>[1] <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;mmap.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;mmap.html</a></div><br/></div></div><div id="36209964" class="c"><input type="checkbox" id="c-36209964" checked=""/><div class="controls bullet"><span class="by">pjaoko</span><span>|</span><a href="#36209447">parent</a><span>|</span><a href="#36209523">prev</a><span>|</span><a href="#36209468">next</a><span>|</span><label class="collapse" for="c-36209964">[-]</label><label class="expand" for="c-36209964">[1 more]</label></div><br/><div class="children"><div class="content">I understood &quot;networked database&quot; to mean a client-server DB architecture. So that Postgres for example is running locally, but communicating with a local server.</div><br/></div></div><div id="36209468" class="c"><input type="checkbox" id="c-36209468" checked=""/><div class="controls bullet"><span class="by">mschuster91</span><span>|</span><a href="#36209447">parent</a><span>|</span><a href="#36209964">prev</a><span>|</span><a href="#36210017">next</a><span>|</span><label class="collapse" for="c-36209468">[-]</label><label class="expand" for="c-36209468">[1 more]</label></div><br/><div class="children"><div class="content">No matter what, PostgreSQL can&#x27;t (trivially) run in-memory only, and even Unix sockets has a performance cost compared to a library running in the same address space.</div><br/></div></div></div></div><div id="36209944" class="c"><input type="checkbox" id="c-36209944" checked=""/><div class="controls bullet"><span class="by">rapnie</span><span>|</span><a href="#36210017">prev</a><span>|</span><a href="#36209558">next</a><span>|</span><label class="collapse" for="c-36209944">[-]</label><label class="expand" for="c-36209944">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But WebAssembly goes way beyond browsers, and so does SQLite. Recent releases compile to WASI — a modular system interface for WebAssembly.<p>Wasm Labs group in VMware was involved with this.<p>See: &quot;SQLite builds for WASI since 3.41.0&quot; discussed at <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36054521" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36054521</a></div><br/></div></div><div id="36209558" class="c"><input type="checkbox" id="c-36209558" checked=""/><div class="controls bullet"><span class="by">samwillis</span><span>|</span><a href="#36209944">prev</a><span>|</span><a href="#36209332">next</a><span>|</span><label class="collapse" for="c-36209558">[-]</label><label class="expand" for="c-36209558">[1 more]</label></div><br/><div class="children"><div class="content">For a tenanted SAAS app SQLite at the edge is a really compelling architecture. You have a single DB per customer&#x2F;company&#x2F;group with all their users woking against that. It can operate at the edge, closest to where the majority of the customers users are.<p>SQLite could scale to even quite large customers with this.<p>Another really compelling architecture is a DB per user, with partial&#x2F;selective sync between the nodes. If you then couple this with a &quot;local first&quot; design, the &quot;edge&quot; just becomes an other local deployment that the users db can sync against. Collaborative apps, where the users have their own documents but can also share&#x2F;fork them would align well with this.<p>I believe starting with &quot;local first&quot; and using the edge for sync and &quot;online only&quot; modes is going to become the default for a significant number of apps moving forward. SQLite with CRDT based syncing and merge conflict resolution is the way to do this. There are a couple of exciting projects working on this:<p><a href="https:&#x2F;&#x2F;electric-sql.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;electric-sql.com&#x2F;</a><p><a href="https:&#x2F;&#x2F;vlcn.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;vlcn.io&#x2F;</a></div><br/></div></div><div id="36209332" class="c"><input type="checkbox" id="c-36209332" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#36209558">prev</a><span>|</span><a href="#36209653">next</a><span>|</span><label class="collapse" for="c-36209332">[-]</label><label class="expand" for="c-36209332">[3 more]</label></div><br/><div class="children"><div class="content">Turns out you don&#x27;t need to cram SQLite into a Cloudflare worker anymore. <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;introducing-d1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;introducing-d1&#x2F;</a></div><br/><div id="36209722" class="c"><input type="checkbox" id="c-36209722" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#36209332">parent</a><span>|</span><a href="#36209653">next</a><span>|</span><label class="collapse" for="c-36209722">[-]</label><label class="expand" for="c-36209722">[2 more]</label></div><br/><div class="children"><div class="content">A year later, still in Alpha! But generally available albeit with 100mb limit.</div><br/><div id="36209748" class="c"><input type="checkbox" id="c-36209748" checked=""/><div class="controls bullet"><span class="by">rozenmd</span><span>|</span><a href="#36209332">root</a><span>|</span><a href="#36209722">parent</a><span>|</span><a href="#36209653">next</a><span>|</span><label class="collapse" for="c-36209748">[-]</label><label class="expand" for="c-36209748">[1 more]</label></div><br/><div class="children"><div class="content">There was a recent update about that: <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;d1-turning-it-up-to-11&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;d1-turning-it-up-to-11&#x2F;</a></div><br/></div></div></div></div></div></div><div id="36209653" class="c"><input type="checkbox" id="c-36209653" checked=""/><div class="controls bullet"><span class="by">stoicjumbotron</span><span>|</span><a href="#36209332">prev</a><span>|</span><a href="#36209567">next</a><span>|</span><label class="collapse" for="c-36209653">[-]</label><label class="expand" for="c-36209653">[3 more]</label></div><br/><div class="children"><div class="content">In what scenarios would one opt for SQLite over MongoDB or vice versa for a basic CRUD app?</div><br/><div id="36209793" class="c"><input type="checkbox" id="c-36209793" checked=""/><div class="controls bullet"><span class="by">TylerE</span><span>|</span><a href="#36209653">parent</a><span>|</span><a href="#36209878">next</a><span>|</span><label class="collapse" for="c-36209793">[-]</label><label class="expand" for="c-36209793">[1 more]</label></div><br/><div class="children"><div class="content">One in which one wishes to retain one’s sanity. It’s _that_ bad, and I don’t especially care for SQLite.</div><br/></div></div><div id="36209878" class="c"><input type="checkbox" id="c-36209878" checked=""/><div class="controls bullet"><span class="by">thunderbong</span><span>|</span><a href="#36209653">parent</a><span>|</span><a href="#36209793">prev</a><span>|</span><a href="#36209567">next</a><span>|</span><label class="collapse" for="c-36209878">[-]</label><label class="expand" for="c-36209878">[1 more]</label></div><br/><div class="children"><div class="content">All of them. Plus, MongoDB is not an RDBMS.</div><br/></div></div></div></div><div id="36209567" class="c"><input type="checkbox" id="c-36209567" checked=""/><div class="controls bullet"><span class="by">revskill</span><span>|</span><a href="#36209653">prev</a><span>|</span><a href="#36209890">next</a><span>|</span><label class="collapse" for="c-36209567">[-]</label><label class="expand" for="c-36209567">[8 more]</label></div><br/><div class="children"><div class="content">I want to hear &quot;What&#x27;s not great using SQLite compare to PostgreSQL&quot; instead .</div><br/><div id="36210080" class="c"><input type="checkbox" id="c-36210080" checked=""/><div class="controls bullet"><span class="by">chasil</span><span>|</span><a href="#36209567">parent</a><span>|</span><a href="#36209841">next</a><span>|</span><label class="collapse" for="c-36210080">[-]</label><label class="expand" for="c-36210080">[1 more]</label></div><br/><div class="children"><div class="content">No foreign keys by default. Using them means that every connecting session must toggle it on. Forget one and it will be free to violate referential integrity.<p>One writer. Any session that issues BEGIN TRANSACTION and then hangs halts all dml.<p>WAL mode confusion. WAL cannot safely be used on network filesystems, and it breaks ACID on ATTACHed databases, among other problems.<p>Date and time types don&#x27;t really exist. There are functions to assemble your own, but it does require some thought.<p>Length specifications on a column are ignored. CHAR(2) will allow the insertion of a blob. I think that check constraints could be used to enforce this.<p>Type affinity means that any data type can be inserted into columns declared as any other data type. Rigid type enforcement can be done, but it is not the default.<p>Those are the major eye-openers.</div><br/></div></div><div id="36209841" class="c"><input type="checkbox" id="c-36209841" checked=""/><div class="controls bullet"><span class="by">citrin_ru</span><span>|</span><a href="#36209567">parent</a><span>|</span><a href="#36210080">prev</a><span>|</span><a href="#36209645">next</a><span>|</span><label class="collapse" for="c-36209841">[-]</label><label class="expand" for="c-36209841">[1 more]</label></div><br/><div class="children"><div class="content">SQLite is not a good choice if you want to access a DB over the network from different hosts or even from many processes on the same host (later may work good in some cases but not all). Large write (insert&#x2F;update) volume is also not the best load for SQLite. And of course where replication is needed I would prefer PostgreSQL or MySQL with mature replication support to things like SQLite+litestream.</div><br/></div></div><div id="36209645" class="c"><input type="checkbox" id="c-36209645" checked=""/><div class="controls bullet"><span class="by">Archelaos</span><span>|</span><a href="#36209567">parent</a><span>|</span><a href="#36209841">prev</a><span>|</span><a href="#36209681">next</a><span>|</span><label class="collapse" for="c-36209645">[-]</label><label class="expand" for="c-36209645">[1 more]</label></div><br/><div class="children"><div class="content">A short use-case comparison with client&#x2F;server database engines in general can be found on the SQLite Web-site itself:<p><a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;whentouse.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;whentouse.html</a></div><br/></div></div><div id="36209681" class="c"><input type="checkbox" id="c-36209681" checked=""/><div class="controls bullet"><span class="by">frou_dh</span><span>|</span><a href="#36209567">parent</a><span>|</span><a href="#36209645">prev</a><span>|</span><a href="#36209737">next</a><span>|</span><label class="collapse" for="c-36209681">[-]</label><label class="expand" for="c-36209681">[3 more]</label></div><br/><div class="children"><div class="content">Poverty in terms of datatypes available to use.</div><br/><div id="36209767" class="c"><input type="checkbox" id="c-36209767" checked=""/><div class="controls bullet"><span class="by">mjevans</span><span>|</span><a href="#36209567">root</a><span>|</span><a href="#36209681">parent</a><span>|</span><a href="#36209737">next</a><span>|</span><label class="collapse" for="c-36209767">[-]</label><label class="expand" for="c-36209767">[2 more]</label></div><br/><div class="children"><div class="content">Offhand, Date types are really strings in SQLite.<p>Personally I&#x27;m not yet convinced that the normal SQL representation for what a &#x27;date&#x27; object is matches real world use cases that well, or at least doesn&#x27;t cover all of them.<p>As a programmer, what I find I want is a &#x27;moment&#x27; which retains the input specification. Possibly in a sanitized binary format that&#x27;s not the literal text, but also isn&#x27;t a single numeric value either.  E.G. Timezone Specifier &#x2F; City (not just one per TZ!) + Human timespec (5 PM Tuesday the Whatever day of Month in Year) AND a pair of evaluation rules version and &#x27;effective UTC||TAI time&#x27; for comparisons.  The evaluation version thing needn&#x27;t be a full version it might even just be a couple bits at the top or bottom of a long range 64 or 128 etc time number of some units.  Something that can be used to determine if a value still needs to be updated with the latest rules set rather than using the cached representation.</div><br/><div id="36210071" class="c"><input type="checkbox" id="c-36210071" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#36209567">root</a><span>|</span><a href="#36209767">parent</a><span>|</span><a href="#36209737">next</a><span>|</span><label class="collapse" for="c-36210071">[-]</label><label class="expand" for="c-36210071">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Offhand, Date types are really strings in SQLite.</i><p>It’s more that there’s no such thing as a date type, but that date and time functions can work with text <i>or numbers</i>, in a few different interpretations.<p>Documentation: <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;lang_datefunc.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;lang_datefunc.html</a>.</div><br/></div></div></div></div></div></div><div id="36209737" class="c"><input type="checkbox" id="c-36209737" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#36209567">parent</a><span>|</span><a href="#36209681">prev</a><span>|</span><a href="#36209890">next</a><span>|</span><label class="collapse" for="c-36209737">[-]</label><label class="expand" for="c-36209737">[1 more]</label></div><br/><div class="children"><div class="content">No kitchen sink?</div><br/></div></div></div></div><div id="36209890" class="c"><input type="checkbox" id="c-36209890" checked=""/><div class="controls bullet"><span class="by">ushakov</span><span>|</span><a href="#36209567">prev</a><span>|</span><label class="collapse" for="c-36209890">[-]</label><label class="expand" for="c-36209890">[3 more]</label></div><br/><div class="children"><div class="content">What are the economics with SQLite on edge? Do I have to pay for a copy of the database in every edge location?</div><br/><div id="36210012" class="c"><input type="checkbox" id="c-36210012" checked=""/><div class="controls bullet"><span class="by">randunel</span><span>|</span><a href="#36209890">parent</a><span>|</span><a href="#36209946">next</a><span>|</span><label class="collapse" for="c-36210012">[-]</label><label class="expand" for="c-36210012">[1 more]</label></div><br/><div class="children"><div class="content">For FaaS and the like, I&#x27;d expect pricing schemes similar to cloudflare&#x27;s <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;content&#x2F;images&#x2F;2023&#x2F;05&#x2F;Screenshot-2023-05-19-at-10.14.58.png" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;content&#x2F;images&#x2F;2023&#x2F;05&#x2F;Screensho...</a><p>This means you&#x27;d be paying per writes, reads and storage.</div><br/></div></div><div id="36209946" class="c"><input type="checkbox" id="c-36209946" checked=""/><div class="controls bullet"><span class="by">stormdennis</span><span>|</span><a href="#36209890">parent</a><span>|</span><a href="#36210012">prev</a><span>|</span><label class="collapse" for="c-36209946">[-]</label><label class="expand" for="c-36209946">[1 more]</label></div><br/><div class="children"><div class="content">sqlite is free</div><br/></div></div></div></div></div></div></div></div></div></body></html>