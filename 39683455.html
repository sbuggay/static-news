<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710320462169" as="style"/><link rel="stylesheet" href="styles.css?v=1710320462169"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/ProfJski/FloatCompMandelbrot">How Mandelbrot set images are affected by floating point precision</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>66 comments</span></div><br/><div><div id="39686073" class="c"><input type="checkbox" id="c-39686073" checked=""/><div class="controls bullet"><span class="by">rkevingibson</span><span>|</span><a href="#39688423">next</a><span>|</span><label class="collapse" for="c-39686073">[-]</label><label class="expand" for="c-39686073">[4 more]</label></div><br/><div class="children"><div class="content">From a cursory look at the code, I don&#x27;t see any use of fused-multiply-add (FMA) which would likely help with precision issues in a number of places with the float version. The &quot;problem in more detail&quot;[1] readme specifically calls out computation of `x^2 - y^2` as a source for error, and that has methods that dramatically reduce error with FMAs[2].<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;ProfJski&#x2F;FloatCompMandelbrot&#x2F;blob&#x2F;master&#x2F;FloatCompMset.md">https:&#x2F;&#x2F;github.com&#x2F;ProfJski&#x2F;FloatCompMandelbrot&#x2F;blob&#x2F;master&#x2F;...</a>
[2] <a href="https:&#x2F;&#x2F;pharr.org&#x2F;matt&#x2F;blog&#x2F;2019&#x2F;11&#x2F;03&#x2F;difference-of-floats" rel="nofollow">https:&#x2F;&#x2F;pharr.org&#x2F;matt&#x2F;blog&#x2F;2019&#x2F;11&#x2F;03&#x2F;difference-of-floats</a></div><br/><div id="39687988" class="c"><input type="checkbox" id="c-39687988" checked=""/><div class="controls bullet"><span class="by">fanf2</span><span>|</span><a href="#39686073">parent</a><span>|</span><a href="#39688449">next</a><span>|</span><label class="collapse" for="c-39687988">[-]</label><label class="expand" for="c-39687988">[1 more]</label></div><br/><div class="children"><div class="content">The author needs to learn about techniques for rendering deep zooms into the Mandelbrot set. Since 2013 it has been possible to render images that are 2^-hundreds across using mostly double precision arithmetic, apart from a few anchor points calculated with multiprecision (hundreds of bits) arithmetic.<p>The deep zoom mathematics includes techniques for introspecting the iterations to detect glitches, which need extra multiprecision anchor points to be calculated.<p><a href="https:&#x2F;&#x2F;mathr.co.uk&#x2F;blog&#x2F;2021-05-14_deep_zoom_theory_and_practice.html" rel="nofollow">https:&#x2F;&#x2F;mathr.co.uk&#x2F;blog&#x2F;2021-05-14_deep_zoom_theory_and_pra...</a><p><a href="https:&#x2F;&#x2F;dirkwhoffmann.github.io&#x2F;DeepDrill&#x2F;docs&#x2F;Theory&#x2F;MandelbrotSet.html" rel="nofollow">https:&#x2F;&#x2F;dirkwhoffmann.github.io&#x2F;DeepDrill&#x2F;docs&#x2F;Theory&#x2F;Mandel...</a><p>In my experience of non-deep-zoom rendering, and contrary to the authors arguments, period detection works well for speeding up renders. It appeared to be fairly safe from false positives. <a href="https:&#x2F;&#x2F;dotat.at&#x2F;@&#x2F;2010-11-16-interior-iteration-with-less-period-pain.html" rel="nofollow">https:&#x2F;&#x2F;dotat.at&#x2F;@&#x2F;2010-11-16-interior-iteration-with-less-p...</a> <a href="https:&#x2F;&#x2F;dotat.at&#x2F;prog&#x2F;mandelbrot&#x2F;cyclic.png" rel="nofollow">https:&#x2F;&#x2F;dotat.at&#x2F;prog&#x2F;mandelbrot&#x2F;cyclic.png</a></div><br/></div></div><div id="39688449" class="c"><input type="checkbox" id="c-39688449" checked=""/><div class="controls bullet"><span class="by">teo_zero</span><span>|</span><a href="#39686073">parent</a><span>|</span><a href="#39687988">prev</a><span>|</span><a href="#39687131">next</a><span>|</span><label class="collapse" for="c-39688449">[-]</label><label class="expand" for="c-39688449">[1 more]</label></div><br/><div class="children"><div class="content">But the goal of the study is expressly to highlight precision issues. Using such techniques wouldn&#x27;t help to make them surface.</div><br/></div></div><div id="39687131" class="c"><input type="checkbox" id="c-39687131" checked=""/><div class="controls bullet"><span class="by">jacobolus</span><span>|</span><a href="#39686073">parent</a><span>|</span><a href="#39688449">prev</a><span>|</span><a href="#39688423">next</a><span>|</span><label class="collapse" for="c-39687131">[-]</label><label class="expand" for="c-39687131">[1 more]</label></div><br/><div class="children"><div class="content">I wish someone made up a better explicit FMA syntax than std::fma(-c, d, cd) ... maybe something along the lines of ((-c * d + cd)) with special brackets or (-c) ⊠ d + cd with a special multiplication symbol.<p>And if only we could effectively use FMAs from javascript...</div><br/></div></div></div></div><div id="39688423" class="c"><input type="checkbox" id="c-39688423" checked=""/><div class="controls bullet"><span class="by">hkmaxpro</span><span>|</span><a href="#39686073">prev</a><span>|</span><a href="#39687479">next</a><span>|</span><label class="collapse" for="c-39688423">[-]</label><label class="expand" for="c-39688423">[1 more]</label></div><br/><div class="children"><div class="content">This post prompted me to look into the theoretical question of the computability of the Mandelbrot set. And I found this excellent answer: <a href="https:&#x2F;&#x2F;math.stackexchange.com&#x2F;q&#x2F;4611850" rel="nofollow">https:&#x2F;&#x2F;math.stackexchange.com&#x2F;q&#x2F;4611850</a></div><br/></div></div><div id="39687479" class="c"><input type="checkbox" id="c-39687479" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#39688423">prev</a><span>|</span><a href="#39685286">next</a><span>|</span><label class="collapse" for="c-39687479">[-]</label><label class="expand" for="c-39687479">[4 more]</label></div><br/><div class="children"><div class="content">If you need to use 128-bit floats for something, note that your processor probably supports them natively and that there are standard C&#x2F;C++ types for them.<p>(The boost thing the article links says their quad precision type is “functionally equivalent” to standard types, but uses a different bit layout.)</div><br/><div id="39687902" class="c"><input type="checkbox" id="c-39687902" checked=""/><div class="controls bullet"><span class="by">fanf2</span><span>|</span><a href="#39687479">parent</a><span>|</span><a href="#39687898">next</a><span>|</span><label class="collapse" for="c-39687902">[-]</label><label class="expand" for="c-39687902">[1 more]</label></div><br/><div class="children"><div class="content">Your processor probably doesn’t support quad precision floats in hardware unless it’s an IBM mainframe. <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Quadruple-precision_floating-point_format#Hardware_support" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Quadruple-precision_floating...</a></div><br/></div></div><div id="39687898" class="c"><input type="checkbox" id="c-39687898" checked=""/><div class="controls bullet"><span class="by">andrewf</span><span>|</span><a href="#39687479">parent</a><span>|</span><a href="#39687902">prev</a><span>|</span><a href="#39688285">next</a><span>|</span><label class="collapse" for="c-39687898">[-]</label><label class="expand" for="c-39687898">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve read this a few places recently but I can&#x27;t figure out how? <a href="https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;Mbjs73qar" rel="nofollow">https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;Mbjs73qar</a> -- using doubles I get AVX instructions but using 128-bit floats calls some very hefty runtime support functions.</div><br/></div></div><div id="39688285" class="c"><input type="checkbox" id="c-39688285" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#39687479">parent</a><span>|</span><a href="#39687898">prev</a><span>|</span><a href="#39685286">next</a><span>|</span><label class="collapse" for="c-39688285">[-]</label><label class="expand" for="c-39688285">[1 more]</label></div><br/><div class="children"><div class="content">Standard C&#x2F;C++ types may still use a software implementation behind the scene, and this is almost always the case for std::float128_t.</div><br/></div></div></div></div><div id="39685286" class="c"><input type="checkbox" id="c-39685286" checked=""/><div class="controls bullet"><span class="by">terlisimo</span><span>|</span><a href="#39687479">prev</a><span>|</span><a href="#39684507">next</a><span>|</span><label class="collapse" for="c-39685286">[-]</label><label class="expand" for="c-39685286">[12 more]</label></div><br/><div class="children"><div class="content">Mandelbrot set calculation is a curious intersection of math and computer science. I went down that rabbit hole once :)<p>Naive implementation is easy, but there are many ways to improve performance.</div><br/><div id="39686285" class="c"><input type="checkbox" id="c-39686285" checked=""/><div class="controls bullet"><span class="by">tantalor</span><span>|</span><a href="#39685286">parent</a><span>|</span><a href="#39684507">next</a><span>|</span><label class="collapse" for="c-39686285">[-]</label><label class="expand" for="c-39686285">[11 more]</label></div><br/><div class="children"><div class="content">Strange thing to say since CS is a sub-field of math.</div><br/><div id="39686341" class="c"><input type="checkbox" id="c-39686341" checked=""/><div class="controls bullet"><span class="by">Etheryte</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39687098">next</a><span>|</span><label class="collapse" for="c-39686341">[-]</label><label class="expand" for="c-39686341">[1 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t really say that&#x27;s a universally held notion, especially in the modern world. Historically, yes, but these days it stands more on its own. In similar vein, you could say biology is a subfield of physics, but most people don&#x27;t think of them that way.</div><br/></div></div><div id="39687098" class="c"><input type="checkbox" id="c-39687098" checked=""/><div class="controls bullet"><span class="by">adonovan</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39686341">prev</a><span>|</span><a href="#39687503">next</a><span>|</span><label class="collapse" for="c-39687098">[-]</label><label class="expand" for="c-39687098">[2 more]</label></div><br/><div class="children"><div class="content">To a librarian, Computer Science and Library Science are just different aspects of information systems, which are (a librarian need hardly tell HN) humanity&#x27;s highest calling, thus justifying their shared Dewey classification of 0.</div><br/><div id="39689232" class="c"><input type="checkbox" id="c-39689232" checked=""/><div class="controls bullet"><span class="by">DougBTX</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39687098">parent</a><span>|</span><a href="#39687503">next</a><span>|</span><label class="collapse" for="c-39689232">[-]</label><label class="expand" for="c-39689232">[1 more]</label></div><br/><div class="children"><div class="content">Interesting! And &quot;Science&quot; is all the way down in Class 500.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_Dewey_Decimal_classes" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_Dewey_Decimal_classes</a></div><br/></div></div></div></div><div id="39687503" class="c"><input type="checkbox" id="c-39687503" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39687098">prev</a><span>|</span><a href="#39686612">next</a><span>|</span><label class="collapse" for="c-39687503">[-]</label><label class="expand" for="c-39687503">[2 more]</label></div><br/><div class="children"><div class="content">Software engineering has as much to do with sociology as it does with math.<p>Systems software has to deal with a lot of physics and engineering stuff (speed of light, power, heat, mean time to component failure, etc, etc.)</div><br/><div id="39687685" class="c"><input type="checkbox" id="c-39687685" checked=""/><div class="controls bullet"><span class="by">yunwal</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39687503">parent</a><span>|</span><a href="#39686612">next</a><span>|</span><label class="collapse" for="c-39687685">[-]</label><label class="expand" for="c-39687685">[1 more]</label></div><br/><div class="children"><div class="content">Software Engineering and Computer Science don&#x27;t necessarily mean the same thing (even though at this point, most schools with CS programs just teach software engineering anyway).</div><br/></div></div></div></div><div id="39686612" class="c"><input type="checkbox" id="c-39686612" checked=""/><div class="controls bullet"><span class="by">ks2048</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39687503">prev</a><span>|</span><a href="#39688763">next</a><span>|</span><label class="collapse" for="c-39686612">[-]</label><label class="expand" for="c-39686612">[2 more]</label></div><br/><div class="children"><div class="content">Of course these terms aren’t well-defined, but some (me) would say both math and CS are subfields of “formal systems” (but “formal systems” could be named CS, which would put it at the top of the hierarchy)</div><br/><div id="39687019" class="c"><input type="checkbox" id="c-39687019" checked=""/><div class="controls bullet"><span class="by">anthk</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686612">parent</a><span>|</span><a href="#39688763">next</a><span>|</span><label class="collapse" for="c-39687019">[-]</label><label class="expand" for="c-39687019">[1 more]</label></div><br/><div class="children"><div class="content">The Joy computer language and Scheme with SICP are prime examples.<p>Reading SICP it&#x27;s the &#x27;easy way&#x27; and the Joy docs plus trying to code even simple
as a quadratic eqn solver it&#x27;s a deep, hard task which requires lots of knowledge on cathegory theory.</div><br/></div></div></div></div><div id="39688763" class="c"><input type="checkbox" id="c-39688763" checked=""/><div class="controls bullet"><span class="by">ant6n</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39686612">prev</a><span>|</span><a href="#39686708">next</a><span>|</span><label class="collapse" for="c-39688763">[-]</label><label class="expand" for="c-39688763">[1 more]</label></div><br/><div class="children"><div class="content">…and I thought math branched off from computing science sometime in the 19th century. Before that, what was called „math“ was mostly algorithms to compute stuff.</div><br/></div></div><div id="39686708" class="c"><input type="checkbox" id="c-39686708" checked=""/><div class="controls bullet"><span class="by">couchand</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686285">parent</a><span>|</span><a href="#39688763">prev</a><span>|</span><a href="#39684507">next</a><span>|</span><label class="collapse" for="c-39686708">[-]</label><label class="expand" for="c-39686708">[2 more]</label></div><br/><div class="children"><div class="content">All fields are subfields of polymathy.</div><br/><div id="39689208" class="c"><input type="checkbox" id="c-39689208" checked=""/><div class="controls bullet"><span class="by">MrYellowP</span><span>|</span><a href="#39685286">root</a><span>|</span><a href="#39686708">parent</a><span>|</span><a href="#39684507">next</a><span>|</span><label class="collapse" for="c-39689208">[-]</label><label class="expand" for="c-39689208">[1 more]</label></div><br/><div class="children"><div class="content">I thought you&#x27;re joking, but nope.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Polymath" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Polymath</a></div><br/></div></div></div></div></div></div></div></div><div id="39684507" class="c"><input type="checkbox" id="c-39684507" checked=""/><div class="controls bullet"><span class="by">DRAGONERO</span><span>|</span><a href="#39685286">prev</a><span>|</span><a href="#39688376">next</a><span>|</span><label class="collapse" for="c-39684507">[-]</label><label class="expand" for="c-39684507">[7 more]</label></div><br/><div class="children"><div class="content">Another way to explore floating point representation can also be to compare rounding modes, as this can impact a lot of what is generated for floating point operations. Most systems are round to nearest even, but round to zero, round towards positive and round towards negative also exist.
Bonus points if you also check results for x87 floats.</div><br/><div id="39685274" class="c"><input type="checkbox" id="c-39685274" checked=""/><div class="controls bullet"><span class="by">Sesse__</span><span>|</span><a href="#39684507">parent</a><span>|</span><a href="#39689278">next</a><span>|</span><label class="collapse" for="c-39685274">[-]</label><label class="expand" for="c-39685274">[4 more]</label></div><br/><div class="children"><div class="content">For Mandelbrot, presumably you can do exact rational arithmetic (all it needs is multiplications and add, and you presumably start with a floating-point coordinate, which is eminently rational). It will be very slow with many iterations, of course, since the fractions will rapidly spin out of control.<p>Edit: I see the supplementary material addresses this: “One could attempt to avoid the problem by using arbitrary-precision floating point representation, or rational representation (using two integers, for numerator and denominator, i.e., keep everything as fractions), but that quickly leads to so many significant digits to multiply in every iteration that calculations become enormously slow. For many points in a Mandelbrot Set Image, the number of significant digits in a trajectory tends to double with each iteration, leading to O(n^2) time complexity for evaluating one point with n iterations. Iterations must then be kept very low (e.g., 20-30 on a modern PC!), which means that many higher-iteration points cannot be evaluated. So accumulated round-off error is hard to avoid.” 20-30 sounds crazy low even for O(n²), though.<p>Edit 2: This part seems wrong: “Cycle detection would work if floating point quantities could be compared exactly, but they cannot.” They certainly can. If you detect a cycle, you will never escape _given your working precision_. Floats can cycle just as well as fixed-point numbers can. But I suppose true cycles (those that would be cycles even in rationals) are extremely unlikely.</div><br/><div id="39687222" class="c"><input type="checkbox" id="c-39687222" checked=""/><div class="controls bullet"><span class="by">drdeca</span><span>|</span><a href="#39684507">root</a><span>|</span><a href="#39685274">parent</a><span>|</span><a href="#39687423">next</a><span>|</span><label class="collapse" for="c-39687222">[-]</label><label class="expand" for="c-39687222">[1 more]</label></div><br/><div class="children"><div class="content">Hm, what about intervals of rationals, and then approximating the intervals with a slightly wider interval in order to make the denominators smaller? I guess the intervals for the real and imaginary components might grow too quickly?<p>if 0 &lt; a_L &lt; a &lt; a_R , 0 &lt; b_L &lt; b &lt; b_R , then (a + b i)^2 = (a^2 - b^2) + 2 a b i ,
and a_L^2 - b_R^2 &lt; a^2 - b^2 &lt; a_R^2 - b_L^2
and 2 a_L b_L &lt; 2 a b &lt; 2 a_R b_R ,<p>uh,<p>(a_R^2 - b_L^2) - (a_L^2 - b_R^2) = (a_R^2 - a_L^2) + (b_R^2 - b_L^2)  
= 2 (a_R - a_L) ((a_L + a_R)&#x2F;2) + 2 (b_R - b_L) ((b_L + b_R)&#x2F;2)<p>And, a_R b_R - a_L b_L = a_R b_R - a_R b_L + a_R b_L - a_L b_L
= a_R (b_R - b_L) + (a_R - a_L) b_L<p>So, looks like the size of the intervals are like, (size of the actual coordinate) * (size of interval in previous step), times like, 2?</div><br/></div></div><div id="39687423" class="c"><input type="checkbox" id="c-39687423" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#39684507">root</a><span>|</span><a href="#39685274">parent</a><span>|</span><a href="#39687222">prev</a><span>|</span><a href="#39687158">next</a><span>|</span><label class="collapse" for="c-39687423">[-]</label><label class="expand" for="c-39687423">[1 more]</label></div><br/><div class="children"><div class="content">“One could” indeed:<p><a href="https:&#x2F;&#x2F;www.fractint.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.fractint.org&#x2F;</a><p>From wikipedia:<p>&gt; The name is a portmanteau of fractal and integer, since the first versions of Fractint used only integer arithmetic (also known as fixed-point arithmetic), for faster rendering on computers without math coprocessors. Since then, floating-point arithmetic and arbitrary-precision arithmetic modes have been added.</div><br/></div></div><div id="39687158" class="c"><input type="checkbox" id="c-39687158" checked=""/><div class="controls bullet"><span class="by">groby_b</span><span>|</span><a href="#39684507">root</a><span>|</span><a href="#39685274">parent</a><span>|</span><a href="#39687423">prev</a><span>|</span><a href="#39689278">next</a><span>|</span><label class="collapse" for="c-39687158">[-]</label><label class="expand" for="c-39687158">[1 more]</label></div><br/><div class="children"><div class="content">&quot;20-30 sounds crazy low even for O(n²), though.&quot;<p>I mean, 30 means 2^30 sig digits. That means any operation on those are a bit expensive in pure memory throughput. Squaring that, let&#x27;s use an FFT then it&#x27;s just O(n log n) for the next step, with n being number of digits here. Or 30 * 2^30 ops, let&#x27;s call it 2^35 ops. We&#x27;re at 32 MFlops for a single dot. Let&#x27;s only do a 1280*768 image, that&#x27;s 32 GFlops to compute that image.<p>That&#x27;s a perfectly nice rate, let&#x27;s pretend it&#x27;s half a second because all memory access was just perfectly sequential. (It&#x27;s not, it&#x27;s more).<p>Each additional step more than doubles the time spent. Which means even at 6 more iterations, we&#x27;re staring at half a minute compute time. Nobody waits half a minute for anything. (Unless it&#x27;s a web page downloading JS)<p>Now add the fact that I lied, memory access can&#x27;t be fully sequential here. But even if it was, we&#x27;re at least spilling into L3 cache, and that means some 40 cycles penalty every time we do. We&#x27;ll do that a lot. So multiply time with 10 or so (I&#x27;m still hopelessly optimistic we have some efficiencies.), and suddenly even 30 iterations cost you 5 seconds.<p>And so, yes, it&#x27;s really expensive even for modern PCs.<p>If you have a GPU, you can shuffle it off to the GPU, they&#x27;re pretty good at FFTs - but even that&#x27;s going to buy you, if we&#x27;re really really optimistic, another 20 or so iterations before it bogs down. Doubling digits every cycle will make any hardware melt quickly.</div><br/></div></div></div></div><div id="39689278" class="c"><input type="checkbox" id="c-39689278" checked=""/><div class="controls bullet"><span class="by">BlueTemplar</span><span>|</span><a href="#39684507">parent</a><span>|</span><a href="#39685274">prev</a><span>|</span><a href="#39684533">next</a><span>|</span><label class="collapse" for="c-39689278">[-]</label><label class="expand" for="c-39689278">[1 more]</label></div><br/><div class="children"><div class="content">I had never realized the necessity of nearest <i>even</i>.<p>I thought that 0.5 ought to be rounded to 1, mirroring 0.0 rounded to 0 !<p>But I can now see how this only works for reals, while anything non-continuous (even rationals ?) could end up with compounding errors...</div><br/></div></div><div id="39684533" class="c"><input type="checkbox" id="c-39684533" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#39684507">parent</a><span>|</span><a href="#39689278">prev</a><span>|</span><a href="#39688376">next</a><span>|</span><label class="collapse" for="c-39684533">[-]</label><label class="expand" for="c-39684533">[1 more]</label></div><br/><div class="children"><div class="content">afaik all ieee floating point systems allow configuring rounding mode, for example  with fesetround or equivalent <a href="https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9699919799&#x2F;basedefs&#x2F;fenv.h.html" rel="nofollow">https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9699919799&#x2F;basedefs&#x2F;fe...</a></div><br/></div></div></div></div><div id="39688376" class="c"><input type="checkbox" id="c-39688376" checked=""/><div class="controls bullet"><span class="by">em3rgent0rdr</span><span>|</span><a href="#39684507">prev</a><span>|</span><a href="#39686408">next</a><span>|</span><label class="collapse" for="c-39688376">[-]</label><label class="expand" for="c-39688376">[2 more]</label></div><br/><div class="children"><div class="content">25 years ago I did Mandelbrot with fixed-point integer, and I remember zooming in enough and eventually hit the end of the fractal due to limited resolution.</div><br/><div id="39689297" class="c"><input type="checkbox" id="c-39689297" checked=""/><div class="controls bullet"><span class="by">thesimp</span><span>|</span><a href="#39688376">parent</a><span>|</span><a href="#39686408">next</a><span>|</span><label class="collapse" for="c-39689297">[-]</label><label class="expand" for="c-39689297">[1 more]</label></div><br/><div class="children"><div class="content">I fondly remember Fractint (<a href="https:&#x2F;&#x2F;www.fractint.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.fractint.org&#x2F;</a>). And these days I&#x27;m amazed at what it could calculate with the very limited CPU cycles at that time. I&#x27;m not sure how to compare a 386 running at 25MHz with my AMD 5950x that I have now.</div><br/></div></div></div></div><div id="39686408" class="c"><input type="checkbox" id="c-39686408" checked=""/><div class="controls bullet"><span class="by">PaulHoule</span><span>|</span><a href="#39688376">prev</a><span>|</span><a href="#39684958">next</a><span>|</span><label class="collapse" for="c-39686408">[-]</label><label class="expand" for="c-39686408">[1 more]</label></div><br/><div class="children"><div class="content">In Hamiltonian Chaos you draw Poincaré sections of systems like this one<p><a href="https:&#x2F;&#x2F;mathworld.wolfram.com&#x2F;Henon-HeilesEquation.html" rel="nofollow">https:&#x2F;&#x2F;mathworld.wolfram.com&#x2F;Henon-HeilesEquation.html</a><p>and see these chaos zones that look like a field of random dots that probably miss a lot of the structure.  The reason why we know those areas are dense with unstable periodic orbits is because they are also dense with periodic orbits.  It doesn’t seem feasible to accurately track a system for long enough to believe those.</div><br/></div></div><div id="39684958" class="c"><input type="checkbox" id="c-39684958" checked=""/><div class="controls bullet"><span class="by">weinzierl</span><span>|</span><a href="#39686408">prev</a><span>|</span><a href="#39685896">next</a><span>|</span><label class="collapse" for="c-39684958">[-]</label><label class="expand" for="c-39684958">[11 more]</label></div><br/><div class="children"><div class="content">The second[1] C program I read in my life was Fractint[2]. It is called that way because it calculated fractals with integer math[3].<p>At that time integer math was not only faster than floating point, but the only thing available to most of us. Processors like the 80386 did <i>not</i> come with any floating point facilities whatsoever. The FPU was a separate unit (aptly called a coprocessor at the time) which was expensive and hard to obtain where I lived.<p>[1] The first one was DKBTrace, which lives on as POVRay. Thank you David K. Buck, where ever you are now. I learned a lot from you.<p>[2] <a href="https:&#x2F;&#x2F;fractint.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;fractint.org&#x2F;</a><p>[3] Technically we should call it fixed point I guess, but in the end it was all done with the integer instructions of the CPU. So integer math is not completely wrong.</div><br/><div id="39685302" class="c"><input type="checkbox" id="c-39685302" checked=""/><div class="controls bullet"><span class="by">IncreasePosts</span><span>|</span><a href="#39684958">parent</a><span>|</span><a href="#39686163">next</a><span>|</span><label class="collapse" for="c-39685302">[-]</label><label class="expand" for="c-39685302">[1 more]</label></div><br/><div class="children"><div class="content">I think he&#x27;s in Ontario, but you can ask him yourself: david at simberon dot com ;)</div><br/></div></div><div id="39686163" class="c"><input type="checkbox" id="c-39686163" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#39684958">parent</a><span>|</span><a href="#39685302">prev</a><span>|</span><a href="#39686614">next</a><span>|</span><label class="collapse" for="c-39686163">[-]</label><label class="expand" for="c-39686163">[5 more]</label></div><br/><div class="children"><div class="content">&quot;Processors like the 80386 did not come with any floating point facilities whatsoever.&quot;<p>The 80286 needed a 80287 - I bought one to run AutoCAD (1MB RAM!)<p>I can&#x27;t quite remember the exact order of events but either or both 80386 and 80486 had a co-pro initially.  Then Intel re-invented the IBM magic screwdriver.  They dropped the 80 prefix and added SX or DX and an i prefix for a laugh.  SX had no co-pro or it was disabled and DX was the full fat model.<p>They really started to screw the punter with the 586 ... Pentium.  The trend has continued - Core iBollocks.</div><br/><div id="39686807" class="c"><input type="checkbox" id="c-39686807" checked=""/><div class="controls bullet"><span class="by">beezle</span><span>|</span><a href="#39684958">root</a><span>|</span><a href="#39686163">parent</a><span>|</span><a href="#39686250">next</a><span>|</span><label class="collapse" for="c-39686807">[-]</label><label class="expand" for="c-39686807">[1 more]</label></div><br/><div class="children"><div class="content">They offered the 80387 co-processor a few years after the 80386 came out<p>ref <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;X87#80387" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;X87#80387</a></div><br/></div></div><div id="39686250" class="c"><input type="checkbox" id="c-39686250" checked=""/><div class="controls bullet"><span class="by">weinzierl</span><span>|</span><a href="#39684958">root</a><span>|</span><a href="#39686163">parent</a><span>|</span><a href="#39686807">prev</a><span>|</span><a href="#39686614">next</a><span>|</span><label class="collapse" for="c-39686250">[-]</label><label class="expand" for="c-39686250">[3 more]</label></div><br/><div class="children"><div class="content">I had an 80386DX (or maybe i386DX, but DX for sure) and it definitely had no FPU. Always wanted one so badly.</div><br/><div id="39687394" class="c"><input type="checkbox" id="c-39687394" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#39684958">root</a><span>|</span><a href="#39686250">parent</a><span>|</span><a href="#39687643">next</a><span>|</span><label class="collapse" for="c-39687394">[-]</label><label class="expand" for="c-39687394">[1 more]</label></div><br/><div class="children"><div class="content">I was going to correct you, and say the DX had a coprocessor, but the SX did not.<p>Apparently, that’s incorrect, and the difference is bus width.<p>However, at the end of its life, my 386 motherboard was running one of these at 100MHz, with a coprocessor on the daughterboard in the main CPU socket:<p><a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Evergreen_Technologies" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Evergreen_Technologies</a><p>(I think I had an IBM 486, not a Cyrix, fwiw.)<p>Sadly, I’d moved to Linux at that point, and the processor needed a special MSDOS binary to flip into 100MHz mode after boot.<p>Even with the handicap, it booted into X11 + enlightenment at 25MHz (or maybe 33MHz) faster than it could boot into Windows 3.11 at 100MHz.</div><br/></div></div><div id="39687643" class="c"><input type="checkbox" id="c-39687643" checked=""/><div class="controls bullet"><span class="by">johnklos</span><span>|</span><a href="#39684958">root</a><span>|</span><a href="#39686250">parent</a><span>|</span><a href="#39687394">prev</a><span>|</span><a href="#39686614">next</a><span>|</span><label class="collapse" for="c-39687643">[-]</label><label class="expand" for="c-39687643">[1 more]</label></div><br/><div class="children"><div class="content">PLCC i80387 or compatible can be had from eBay for less than $20, and PGA generally for less than $30 USD.</div><br/></div></div></div></div></div></div><div id="39686614" class="c"><input type="checkbox" id="c-39686614" checked=""/><div class="controls bullet"><span class="by">bongodongobob</span><span>|</span><a href="#39684958">parent</a><span>|</span><a href="#39686163">prev</a><span>|</span><a href="#39687308">next</a><span>|</span><label class="collapse" for="c-39686614">[-]</label><label class="expand" for="c-39686614">[1 more]</label></div><br/><div class="children"><div class="content">I still have the entire manual that I printed and bound circa 1996. I saw a program on PBS about fractals and we had just got dial up internet. I found fractint and cut my programming teeth with that and a copy of Borland that I convinced my parents to buy for me. Running on a 75MHz Compaq. Being a teenager at that time was just magical.<p>Edit: Just noticed you mentioned Povray too. Are you me? Wow, lol.</div><br/></div></div><div id="39687308" class="c"><input type="checkbox" id="c-39687308" checked=""/><div class="controls bullet"><span class="by">RachelF</span><span>|</span><a href="#39684958">parent</a><span>|</span><a href="#39686614">prev</a><span>|</span><a href="#39685216">next</a><span>|</span><label class="collapse" for="c-39687308">[-]</label><label class="expand" for="c-39687308">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, Fractint was great. The VGA color palette cycling was trippy.<p>In the mid 1980&#x27;s I typed in a Mandlebrot set program from a magazine. It was for the Apple 2, written in BASIC. It took around 12 hours to generate a 280x192 monochrome Mandlebrot.</div><br/></div></div><div id="39685216" class="c"><input type="checkbox" id="c-39685216" checked=""/><div class="controls bullet"><span class="by">samstave</span><span>|</span><a href="#39684958">parent</a><span>|</span><a href="#39687308">prev</a><span>|</span><a href="#39685073">next</a><span>|</span><label class="collapse" for="c-39685216">[-]</label><label class="expand" for="c-39685216">[1 more]</label></div><br/><div class="children"><div class="content">Wow! I used to use fractint ages ago, and I thought &quot;tint&quot; was for colors...</div><br/></div></div></div></div><div id="39685896" class="c"><input type="checkbox" id="c-39685896" checked=""/><div class="controls bullet"><span class="by">pictureofabear</span><span>|</span><a href="#39684958">prev</a><span>|</span><a href="#39685918">next</a><span>|</span><label class="collapse" for="c-39685896">[-]</label><label class="expand" for="c-39685896">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=aP0Y1uAA-2Y" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=aP0Y1uAA-2Y</a><p>A good lecture by John L. Gustafson on beyond floating points?</div><br/></div></div><div id="39685918" class="c"><input type="checkbox" id="c-39685918" checked=""/><div class="controls bullet"><span class="by">zeitgeistcowboy</span><span>|</span><a href="#39685896">prev</a><span>|</span><a href="#39684875">next</a><span>|</span><label class="collapse" for="c-39685918">[-]</label><label class="expand" for="c-39685918">[3 more]</label></div><br/><div class="children"><div class="content">Did anyone else think it was interesting that the difference between the two floating point images looked like a Julia set? It’s probably trivial, but I liked that.</div><br/><div id="39686260" class="c"><input type="checkbox" id="c-39686260" checked=""/><div class="controls bullet"><span class="by">Turneyboy</span><span>|</span><a href="#39685918">parent</a><span>|</span><a href="#39687537">next</a><span>|</span><label class="collapse" for="c-39686260">[-]</label><label class="expand" for="c-39686260">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s essentially just the boundary of the Mandelbrot set  which makes sense as that&#x27;s where the calculation is the most unstable.</div><br/></div></div><div id="39687537" class="c"><input type="checkbox" id="c-39687537" checked=""/><div class="controls bullet"><span class="by">calibas</span><span>|</span><a href="#39685918">parent</a><span>|</span><a href="#39686260">prev</a><span>|</span><a href="#39684875">next</a><span>|</span><label class="collapse" for="c-39687537">[-]</label><label class="expand" for="c-39687537">[1 more]</label></div><br/><div class="children"><div class="content">Mandelbrot and Julia sets are related:<p><a href="https:&#x2F;&#x2F;www.karlsims.com&#x2F;julia.html" rel="nofollow">https:&#x2F;&#x2F;www.karlsims.com&#x2F;julia.html</a></div><br/></div></div></div></div><div id="39684875" class="c"><input type="checkbox" id="c-39684875" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#39685918">prev</a><span>|</span><a href="#39685515">next</a><span>|</span><label class="collapse" for="c-39684875">[-]</label><label class="expand" for="c-39684875">[4 more]</label></div><br/><div class="children"><div class="content">A related question I&#x27;ve wondered is, can you rearrange the formulae to reduce precision loss, without having to actually use more bits of precision in the data type?</div><br/><div id="39686603" class="c"><input type="checkbox" id="c-39686603" checked=""/><div class="controls bullet"><span class="by">nimos</span><span>|</span><a href="#39684875">parent</a><span>|</span><a href="#39684910">next</a><span>|</span><label class="collapse" for="c-39686603">[-]</label><label class="expand" for="c-39686603">[1 more]</label></div><br/><div class="children"><div class="content">Long time since I looked at this but you might be interested in:<p><a href="https:&#x2F;&#x2F;mathr.co.uk&#x2F;blog&#x2F;2021-05-14_deep_zoom_theory_and_practice.html" rel="nofollow">https:&#x2F;&#x2F;mathr.co.uk&#x2F;blog&#x2F;2021-05-14_deep_zoom_theory_and_pra...</a><p>IIRC it is calculating a few points at high precision and then estimating the rest.</div><br/></div></div><div id="39684910" class="c"><input type="checkbox" id="c-39684910" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#39684875">parent</a><span>|</span><a href="#39686603">prev</a><span>|</span><a href="#39685515">next</a><span>|</span><label class="collapse" for="c-39684910">[-]</label><label class="expand" for="c-39684910">[2 more]</label></div><br/><div class="children"><div class="content">Mandelbrot specifically, or computations in general? For the latter, absolutely yes. See Herbie for automated tool for doing it <a href="https:&#x2F;&#x2F;herbie.uwplse.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;herbie.uwplse.org&#x2F;</a></div><br/><div id="39685067" class="c"><input type="checkbox" id="c-39685067" checked=""/><div class="controls bullet"><span class="by">Retr0id</span><span>|</span><a href="#39684875">root</a><span>|</span><a href="#39684910">parent</a><span>|</span><a href="#39685515">next</a><span>|</span><label class="collapse" for="c-39685067">[-]</label><label class="expand" for="c-39685067">[1 more]</label></div><br/><div class="children"><div class="content">The former</div><br/></div></div></div></div></div></div><div id="39685515" class="c"><input type="checkbox" id="c-39685515" checked=""/><div class="controls bullet"><span class="by">stabbles</span><span>|</span><a href="#39684875">prev</a><span>|</span><a href="#39685687">next</a><span>|</span><label class="collapse" for="c-39685515">[-]</label><label class="expand" for="c-39685515">[2 more]</label></div><br/><div class="children"><div class="content">Computing the color of a pixel is computing the (averaged) integral of some iteration counting function. It looks like there are areas where this function is pretty chaotic -- isn&#x27;t the problem very ill-conditioned? If so adding more precision may not even help?</div><br/><div id="39689296" class="c"><input type="checkbox" id="c-39689296" checked=""/><div class="controls bullet"><span class="by">BlueTemplar</span><span>|</span><a href="#39685515">parent</a><span>|</span><a href="#39685687">next</a><span>|</span><label class="collapse" for="c-39689296">[-]</label><label class="expand" for="c-39689296">[1 more]</label></div><br/><div class="children"><div class="content">Seems like this algorithm does <i>not</i> do that ?<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ProfJski&#x2F;FloatCompMandelbrot&#x2F;blob&#x2F;master&#x2F;FloatCompMset.md#perhaps-obvious-but-also-no-supersampling">https:&#x2F;&#x2F;github.com&#x2F;ProfJski&#x2F;FloatCompMandelbrot&#x2F;blob&#x2F;master&#x2F;...</a><p>&gt; [...]  Instead, we put pixels in a one-to-one relation to the points they represent. You can think of this as mapping some imaginary point on the pixel, such as its center or corner, onto the complex plane, and making the whole pixel represent that value.</div><br/></div></div></div></div><div id="39685687" class="c"><input type="checkbox" id="c-39685687" checked=""/><div class="controls bullet"><span class="by">shaun_arundell</span><span>|</span><a href="#39685515">prev</a><span>|</span><a href="#39686905">next</a><span>|</span><label class="collapse" for="c-39685687">[-]</label><label class="expand" for="c-39685687">[1 more]</label></div><br/><div class="children"><div class="content">This reminds me of the issues with calculating the zeros of the Riemann  zeta equation - your code design quickly becomes dominated by numerical implementation considerations</div><br/></div></div><div id="39686905" class="c"><input type="checkbox" id="c-39686905" checked=""/><div class="controls bullet"><span class="by">anthk</span><span>|</span><a href="#39685687">prev</a><span>|</span><a href="#39684957">next</a><span>|</span><label class="collapse" for="c-39686905">[-]</label><label class="expand" for="c-39686905">[1 more]</label></div><br/><div class="children"><div class="content">Code from &quot;The Computational Beauty of Nature&quot; managed to crash CWM under GNU&#x2F;Linux+X. No issues with FVWM.  WIth LibdieHard I managed to avoid the crash.<p>Maybe some ANSI C code from the 90&#x27;s doesn&#x27;t like current layouts...<p>On FP precision, sh has almost none, AWK often has up to 20 bit and 53 with gawk and the math library. Ditto with bc -l.<p>Calc has an arbitrary decimal precision and it&#x27;s really fast.
<a href="https:&#x2F;&#x2F;github.com&#x2F;lcn2&#x2F;calc">https:&#x2F;&#x2F;github.com&#x2F;lcn2&#x2F;calc</a></div><br/></div></div><div id="39684957" class="c"><input type="checkbox" id="c-39684957" checked=""/><div class="controls bullet"><span class="by">captaincrowbar</span><span>|</span><a href="#39686905">prev</a><span>|</span><a href="#39684469">next</a><span>|</span><label class="collapse" for="c-39684957">[-]</label><label class="expand" for="c-39684957">[5 more]</label></div><br/><div class="children"><div class="content">Some people, when they have a problem, think, “I know, I’ll use floating point.” Now they have 1.9999998 problems.</div><br/><div id="39686847" class="c"><input type="checkbox" id="c-39686847" checked=""/><div class="controls bullet"><span class="by">beezle</span><span>|</span><a href="#39684957">parent</a><span>|</span><a href="#39686388">next</a><span>|</span><label class="collapse" for="c-39686847">[-]</label><label class="expand" for="c-39686847">[1 more]</label></div><br/><div class="children"><div class="content">Funny story from today while briefly on hold for a support rep.  Got the standard &#x27;we&#x27;ll call you back if you want blah blah&#x27; followed by - I kid not - &quot;you&#x27;re estimated wait time for the next representative is 0.58333333 minutes&quot;<p>At the end of the call I suggested if she can log a problem for IT to include this and that they should either round up or use seconds  (I suspect it was 35 seconds)</div><br/></div></div><div id="39686388" class="c"><input type="checkbox" id="c-39686388" checked=""/><div class="controls bullet"><span class="by">recursive</span><span>|</span><a href="#39684957">parent</a><span>|</span><a href="#39686847">prev</a><span>|</span><a href="#39685055">next</a><span>|</span><label class="collapse" for="c-39686388">[-]</label><label class="expand" for="c-39686388">[1 more]</label></div><br/><div class="children"><div class="content">Some numbers can be precisely represented using IEEE-754 floats.  Two (2) is one of them.</div><br/></div></div><div id="39685865" class="c"><input type="checkbox" id="c-39685865" checked=""/><div class="controls bullet"><span class="by">markab21</span><span>|</span><a href="#39684957">parent</a><span>|</span><a href="#39685055">prev</a><span>|</span><a href="#39684469">next</a><span>|</span><label class="collapse" for="c-39685865">[-]</label><label class="expand" for="c-39685865">[1 more]</label></div><br/><div class="children"><div class="content">I bet you have been waiting years to pull that one out of your pocket.<p>Well played sir! Nice shot man! :D</div><br/></div></div></div></div><div id="39684469" class="c"><input type="checkbox" id="c-39684469" checked=""/><div class="controls bullet"><span class="by">efitz</span><span>|</span><a href="#39684957">prev</a><span>|</span><a href="#39684447">next</a><span>|</span><label class="collapse" for="c-39684469">[-]</label><label class="expand" for="c-39684469">[3 more]</label></div><br/><div class="children"><div class="content">The document (&quot;What Every Computer Scientist Should Know About Floating-Point Arithmetic&quot;) linked from the article was IMO even more interesting than the article: <a href="https:&#x2F;&#x2F;docs.oracle.com&#x2F;cd&#x2F;E19957-01&#x2F;806-3568&#x2F;ncg_goldberg.html" rel="nofollow">https:&#x2F;&#x2F;docs.oracle.com&#x2F;cd&#x2F;E19957-01&#x2F;806-3568&#x2F;ncg_goldberg.h...</a></div><br/><div id="39684518" class="c"><input type="checkbox" id="c-39684518" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#39684469">parent</a><span>|</span><a href="#39685063">next</a><span>|</span><label class="collapse" for="c-39684518">[-]</label><label class="expand" for="c-39684518">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s definitely an evergreen article <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23665529">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23665529</a><p><a href="https:&#x2F;&#x2F;xkcd.com&#x2F;1053&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;1053&#x2F;</a></div><br/></div></div></div></div><div id="39684447" class="c"><input type="checkbox" id="c-39684447" checked=""/><div class="controls bullet"><span class="by">repelsteeltje</span><span>|</span><a href="#39684469">prev</a><span>|</span><a href="#39687061">next</a><span>|</span><label class="collapse" for="c-39684447">[-]</label><label class="expand" for="c-39684447">[2 more]</label></div><br/><div class="children"><div class="content">Ironic that the last two letters in the tittle are truncated, &quot;Mandelbr&quot;.<p>Must be a floating point rounding error.</div><br/></div></div></div></div></div></div></div></body></html>