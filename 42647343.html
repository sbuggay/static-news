<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1736499664085" as="style"/><link rel="stylesheet" href="styles.css?v=1736499664085"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.nature.com/articles/s41586-024-08328-6/link">Show HN: TabPFN v2 – A SOTA foundation model for small tabular data</a> <span class="domain">(<a href="https://www.nature.com">www.nature.com</a>)</span></div><div class="subtext"><span>onasta</span> | <span>24 comments</span></div><br/><div><div id="42653722" class="c"><input type="checkbox" id="c-42653722" checked=""/><div class="controls bullet"><span class="by">patcon</span><span>|</span><a href="#42652065">next</a><span>|</span><label class="collapse" for="c-42653722">[-]</label><label class="expand" for="c-42653722">[1 more]</label></div><br/><div class="children"><div class="content">Neat! Might this even be useful to impute missing data for a sparse network of votes, for a system like this (pol.is) whose goal is to do dimensional reduction and visualise the opinion space of divisive social topics: <a href="https:&#x2F;&#x2F;gwern.net&#x2F;doc&#x2F;sociology&#x2F;2021-small.pdf" rel="nofollow">https:&#x2F;&#x2F;gwern.net&#x2F;doc&#x2F;sociology&#x2F;2021-small.pdf</a><p>200 voters on 50 statements would fall within the 10,000 sample threshold. This is well within the bounds of some existing conversations with open data, so it could be tested... Potential values on each statement are agree&#x2F;disagree&#x2F;pass (+1&#x2F;-1&#x2F;0)<p><a href="https:&#x2F;&#x2F;github.com&#x2F;compdemocracy&#x2F;openData&#x2F;blob&#x2F;master&#x2F;brexit-consensus&#x2F;summary.csv">https:&#x2F;&#x2F;github.com&#x2F;compdemocracy&#x2F;openData&#x2F;blob&#x2F;master&#x2F;brexit...</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;compdemocracy&#x2F;openData&#x2F;blob&#x2F;master&#x2F;brexit-consensus&#x2F;votes.csv">https:&#x2F;&#x2F;github.com&#x2F;compdemocracy&#x2F;openData&#x2F;blob&#x2F;master&#x2F;brexit...</a></div><br/></div></div><div id="42652065" class="c"><input type="checkbox" id="c-42652065" checked=""/><div class="controls bullet"><span class="by">gcr</span><span>|</span><a href="#42653722">prev</a><span>|</span><a href="#42647737">next</a><span>|</span><label class="collapse" for="c-42652065">[-]</label><label class="expand" for="c-42652065">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for such a cool project! It&#x27;s immediately apparent how to use it and I appreciate the brief examples.<p>Quick question: In the breast cancer example from the README, simple support vector machines from sklearn (the first thing i tried to compare baseline performance, incidentally) seem to outperform TabPFN. Is this expected? I know it&#x27;s a baseline to demonstrate ease of use rather than SOTA performance, but I am curious.<p><pre><code>    # (TabPFN)
    In [13]: print(&quot;ROC AUC:&quot;, roc_auc_score(y_test, prediction_probabilities[:, 1]))
    ROC AUC: 0.996299494264216

    # (LinearSVC)
    In [27]: from sklearn.svm import LinearSVC
    
    In [28]: clf=LinearSVC(C=0.01).fit(X_train, y_train)
    
    In [29]: roc_auc_score(y_test, clf.decision_function(X_test))
    Out[29]: 0.997532996176144</code></pre></div><br/></div></div><div id="42647737" class="c"><input type="checkbox" id="c-42647737" checked=""/><div class="controls bullet"><span class="by">instanceofme</span><span>|</span><a href="#42652065">prev</a><span>|</span><a href="#42652818">next</a><span>|</span><label class="collapse" for="c-42647737">[-]</label><label class="expand" for="c-42647737">[2 more]</label></div><br/><div class="children"><div class="content">Related: CARTE-AI, which can also deal with multiple tables.<p><a href="https:&#x2F;&#x2F;soda-inria.github.io&#x2F;carte&#x2F;" rel="nofollow">https:&#x2F;&#x2F;soda-inria.github.io&#x2F;carte&#x2F;</a>
<a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2402.16785" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2402.16785</a><p>The paper includes a comparison to TabPFN v1 (among others), noting the lack of categorical &amp; missing values handling which v2 now seems to have. Would be curious to see an updated comparison.</div><br/><div id="42650700" class="c"><input type="checkbox" id="c-42650700" checked=""/><div class="controls bullet"><span class="by">onasta</span><span>|</span><a href="#42647737">parent</a><span>|</span><a href="#42652818">next</a><span>|</span><label class="collapse" for="c-42650700">[-]</label><label class="expand" for="c-42650700">[1 more]</label></div><br/><div class="children"><div class="content">TabPFN is better on numerical data since v1 (see figure 6 in the CARTE paper). CARTE&#x27;s main strength in on text features, which are now also supported for TabPFN v2 API version (<a href="https:&#x2F;&#x2F;github.com&#x2F;PriorLabs&#x2F;tabpfn-client">https:&#x2F;&#x2F;github.com&#x2F;PriorLabs&#x2F;tabpfn-client</a>). We compared this to CARTE and found our model to be generally quite better, and much faster. CARTE multi-table approach is also very interesting, and we want to tackle this setting in the future.</div><br/></div></div></div></div><div id="42652818" class="c"><input type="checkbox" id="c-42652818" checked=""/><div class="controls bullet"><span class="by">tmostak</span><span>|</span><a href="#42647737">prev</a><span>|</span><a href="#42650431">next</a><span>|</span><label class="collapse" for="c-42652818">[-]</label><label class="expand" for="c-42652818">[2 more]</label></div><br/><div class="children"><div class="content">This looks amazing!<p>Just looking through the code a bit, it seems that the model both supports a (custom) attention mechanism between features and between rows (code uses the term items)? If so, does the attention between rows help improve accuracy significantly?<p>Generally, for standard regression and classification use cases, rows (observations) are seen to be independent, but I&#x27;m guessing cross-row attention might help the model see the gestalt of the data in some way that improves accuracy even when the independence assumption holds?</div><br/><div id="42653892" class="c"><input type="checkbox" id="c-42653892" checked=""/><div class="controls bullet"><span class="by">dist-epoch</span><span>|</span><a href="#42652818">parent</a><span>|</span><a href="#42650431">next</a><span>|</span><label class="collapse" for="c-42653892">[-]</label><label class="expand" for="c-42653892">[1 more]</label></div><br/><div class="children"><div class="content">Speculating, cross-row might give you information where you are in that row distribution.</div><br/></div></div></div></div><div id="42650431" class="c"><input type="checkbox" id="c-42650431" checked=""/><div class="controls bullet"><span class="by">ggnore7452</span><span>|</span><a href="#42652818">prev</a><span>|</span><a href="#42651369">next</a><span>|</span><label class="collapse" for="c-42650431">[-]</label><label class="expand" for="c-42650431">[3 more]</label></div><br/><div class="children"><div class="content">anyone tried this? is this actually overall better than xgboost&#x2F;catboost?</div><br/><div id="42650792" class="c"><input type="checkbox" id="c-42650792" checked=""/><div class="controls bullet"><span class="by">westurner</span><span>|</span><a href="#42650431">parent</a><span>|</span><a href="#42651085">next</a><span>|</span><label class="collapse" for="c-42650792">[-]</label><label class="expand" for="c-42650792">[1 more]</label></div><br/><div class="children"><div class="content">Benchmark of tabpfn&lt;2 compared to xgboost, lightgbm, and catboost: <a href="https:&#x2F;&#x2F;x.com&#x2F;FrankRHutter&#x2F;status&#x2F;1583410845307977733" rel="nofollow">https:&#x2F;&#x2F;x.com&#x2F;FrankRHutter&#x2F;status&#x2F;1583410845307977733</a> .. <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33486914">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33486914</a></div><br/></div></div><div id="42651085" class="c"><input type="checkbox" id="c-42651085" checked=""/><div class="controls bullet"><span class="by">enigmaa99</span><span>|</span><a href="#42650431">parent</a><span>|</span><a href="#42650792">prev</a><span>|</span><a href="#42651369">next</a><span>|</span><label class="collapse" for="c-42651085">[-]</label><label class="expand" for="c-42651085">[1 more]</label></div><br/><div class="children"><div class="content">Yes it actually is but the limitations of rows and features could be a hindrance.</div><br/></div></div></div></div><div id="42651369" class="c"><input type="checkbox" id="c-42651369" checked=""/><div class="controls bullet"><span class="by">peepeepoopoo99</span><span>|</span><a href="#42650431">prev</a><span>|</span><a href="#42651068">next</a><span>|</span><label class="collapse" for="c-42651369">[-]</label><label class="expand" for="c-42651369">[1 more]</label></div><br/><div class="children"><div class="content">How can you train a tabular foundation model when the tabular features themselves are inherently domain-specific?  Is there some kind of preprocessing step beforehand to match the inference time features with their closest analogues in the training set?</div><br/></div></div><div id="42651068" class="c"><input type="checkbox" id="c-42651068" checked=""/><div class="controls bullet"><span class="by">enigmaa99</span><span>|</span><a href="#42651369">prev</a><span>|</span><a href="#42651759">next</a><span>|</span><label class="collapse" for="c-42651068">[-]</label><label class="expand" for="c-42651068">[1 more]</label></div><br/><div class="children"><div class="content">I tried this on a few CARTE datasets and it works surprisingly better!! Woahhh</div><br/></div></div><div id="42651759" class="c"><input type="checkbox" id="c-42651759" checked=""/><div class="controls bullet"><span class="by">hooloovoo_zoo</span><span>|</span><a href="#42651068">prev</a><span>|</span><a href="#42652306">next</a><span>|</span><label class="collapse" for="c-42651759">[-]</label><label class="expand" for="c-42651759">[2 more]</label></div><br/><div class="children"><div class="content">Were your benchmark methods tuned per dataset or across datasets?</div><br/><div id="42653827" class="c"><input type="checkbox" id="c-42653827" checked=""/><div class="controls bullet"><span class="by">ersiees</span><span>|</span><a href="#42651759">parent</a><span>|</span><a href="#42652306">next</a><span>|</span><label class="collapse" for="c-42653827">[-]</label><label class="expand" for="c-42653827">[1 more]</label></div><br/><div class="children"><div class="content">Tuned per dataset</div><br/></div></div></div></div><div id="42652306" class="c"><input type="checkbox" id="c-42652306" checked=""/><div class="controls bullet"><span class="by">nickpsecurity</span><span>|</span><a href="#42651759">prev</a><span>|</span><a href="#42650510">next</a><span>|</span><label class="collapse" for="c-42652306">[-]</label><label class="expand" for="c-42652306">[1 more]</label></div><br/><div class="children"><div class="content">A while back, I was looking for a project amateurs could do for experimenting with Transformer alternatives and optimization algorithms. My concept was grabbing objective, test functions from the literature, making custom ones based on realistic data, and layering them together based on real-world depth. Then, training various approaches on them using consumer GPU’s or spot instances of high-end GPU’s.<p>What I read in this paper blew that idea out the water! I mean, it’s still doable but you’ve far exceeded it.<p>I love that you covered many types of structures, used 8x consumer GPU’s more like OSS folks do (widely-accessible pretraining), claim no copyright infringement for pretraining, and use enough techniques in ML that people can enjoy Googling stuff for days.<p>I do have some questions about what I might have overlooked in the paper.<p>1. Is the training data and code available to reproduce the model? And iteratively improve its architectural decisions?<p>2. Most authors claiming their data was legal or open were actually committing copyright infringement. Your method might dodge that if users generate their own synthetic data using methods they can verify aren’t themselves encumbered. Is that code available under open licensing? If not, would you offer it for a fee for companies or free for researchers?<p>3. What specific, common uses could amateurs try that would display the model’s ability in a business setting? (Both to drive more research or build products on the model.)<p>I thank you for your time.</div><br/></div></div><div id="42650510" class="c"><input type="checkbox" id="c-42650510" checked=""/><div class="controls bullet"><span class="by">bbstats</span><span>|</span><a href="#42652306">prev</a><span>|</span><a href="#42651078">next</a><span>|</span><label class="collapse" for="c-42650510">[-]</label><label class="expand" for="c-42650510">[1 more]</label></div><br/><div class="children"><div class="content">looks amazing - finally, DL that beats a tuned catboost?</div><br/></div></div><div id="42647723" class="c"><input type="checkbox" id="c-42647723" checked=""/><div class="controls bullet"><span class="by">OutOfHere</span><span>|</span><a href="#42651078">prev</a><span>|</span><a href="#42647638">next</a><span>|</span><label class="collapse" for="c-42647723">[-]</label><label class="expand" for="c-42647723">[1 more]</label></div><br/><div class="children"><div class="content">Related repo: <a href="https:&#x2F;&#x2F;github.com&#x2F;liam-sbhoo&#x2F;tabpfn-time-series">https:&#x2F;&#x2F;github.com&#x2F;liam-sbhoo&#x2F;tabpfn-time-series</a></div><br/></div></div><div id="42650749" class="c"><input type="checkbox" id="c-42650749" checked=""/><div class="controls bullet"><span class="by">_giorgio_</span><span>|</span><a href="#42647424">prev</a><span>|</span><label class="collapse" for="c-42650749">[-]</label><label class="expand" for="c-42650749">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s probably the same model with the same limitations, released nearly two years ago?<p><a href="https:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;2207.01848" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;2207.01848</a></div><br/><div id="42650930" class="c"><input type="checkbox" id="c-42650930" checked=""/><div class="controls bullet"><span class="by">onasta</span><span>|</span><a href="#42650749">parent</a><span>|</span><a href="#42650830">next</a><span>|</span><label class="collapse" for="c-42650930">[-]</label><label class="expand" for="c-42650930">[1 more]</label></div><br/><div class="children"><div class="content">There have been a ton of improvements! Much better performance overall, way larger data size limit (1K--&gt;10K rows, 100--&gt;500 features), regression support, native categorical data and missing values handling, much better support for uninformative or outlier features etc.</div><br/></div></div><div id="42650830" class="c"><input type="checkbox" id="c-42650830" checked=""/><div class="controls bullet"><span class="by">ersiees</span><span>|</span><a href="#42650749">parent</a><span>|</span><a href="#42650930">prev</a><span>|</span><label class="collapse" for="c-42650830">[-]</label><label class="expand" for="c-42650830">[1 more]</label></div><br/><div class="children"><div class="content">No, it is *much* stronger, a different architecture and scales to 10x the number of examples. It can also do regression now, and handle categorical features. Please, have a quick look at the abstract before making such claims.</div><br/></div></div></div></div></div></div></div></div></div></body></html>