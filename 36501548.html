<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1687942852557" as="style"/><link rel="stylesheet" href="styles.css?v=1687942852557"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://cohost.org/tef/post/1764930-how-not-to-write-a">How not to write a pipeline</a> <span class="domain">(<a href="https://cohost.org">cohost.org</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>20 comments</span></div><br/><div><div id="36502124" class="c"><input type="checkbox" id="c-36502124" checked=""/><div class="controls bullet"><span class="by">larusso</span><span>|</span><a href="#36502773">next</a><span>|</span><label class="collapse" for="c-36502124">[-]</label><label class="expand" for="c-36502124">[8 more]</label></div><br/><div class="children"><div class="content">I don’t like the snarky attitude in the post. I don’t work on backend systems but the problem described is similar elsewhere: less knowledgeable or naive programmer writes a feature which looks simple but would create more work to maintain in the long run, a more expert programmer trying to sway said programmer to change the design without forcing a total change.<p>What irritated me was the underlying sound that programmers of category 1 are always building bad solutions and programmer 2 has to fight to save the day. It feels like this person has worked to long in a bad position and started to see the world in this simple black and white form.<p>To be fair I’ve been there before myself. I maintain a ton of build pipelines and build tools. And for a while I had the world view of them against me. Them, who by design create bad build scripts which never scale and never survive a second use-case change and me, the unsung hero who fights the verbal battle why one should not write build output into the build source directory etc.<p>For me it boiled down to understand that these other people where not standing in line to make my life harder. They simply didn’t know or had no capacity to learn this because they also had their fair share of problems in their respective domains etc.<p>I think there is some good information in this post. But I would have liked if it had been wrapped differently.</div><br/><div id="36502838" class="c"><input type="checkbox" id="c-36502838" checked=""/><div class="controls bullet"><span class="by">mspcommentary</span><span>|</span><a href="#36502124">parent</a><span>|</span><a href="#36502247">next</a><span>|</span><label class="collapse" for="c-36502838">[-]</label><label class="expand" for="c-36502838">[4 more]</label></div><br/><div class="children"><div class="content">About 10 years ago I joined a new company, and I looked at their code and thought &quot;what idiots wrote this?&quot;, which was strange, because everyone there was very bright. A little while later, some more new devs joined, looked at the code, and thought &quot;what idiots wrote this?&quot;, and I was a bit annoyed, because some of that code was mine.  They did a big rewrite. A little while after that, some more devs joined, looked at the rewrite and thought &quot;what idiots wrote this?&quot;.<p>Fundamentally, no-one likes working with other people&#x27;s code or solutions. They always think that they&#x27;d have done it better if they&#x27;d had the chance.</div><br/><div id="36504019" class="c"><input type="checkbox" id="c-36504019" checked=""/><div class="controls bullet"><span class="by">kieckerjan</span><span>|</span><a href="#36502124">root</a><span>|</span><a href="#36502838">parent</a><span>|</span><a href="#36503826">next</a><span>|</span><label class="collapse" for="c-36504019">[-]</label><label class="expand" for="c-36504019">[1 more]</label></div><br/><div class="children"><div class="content">I regularly look at code and think &quot;what idiot wrote this?&quot; and then realize that idiot was me.</div><br/></div></div><div id="36503826" class="c"><input type="checkbox" id="c-36503826" checked=""/><div class="controls bullet"><span class="by">camgunz</span><span>|</span><a href="#36502124">root</a><span>|</span><a href="#36502838">parent</a><span>|</span><a href="#36504019">prev</a><span>|</span><a href="#36503191">next</a><span>|</span><label class="collapse" for="c-36503826">[-]</label><label class="expand" for="c-36503826">[1 more]</label></div><br/><div class="children"><div class="content">I see this attitude a lot and I now kind of categorize it within &quot;contempt culture&quot;, which I think mostly just falls out of insecurity. I&#x27;ve been guilty of this myself and I try pretty hard to not do it now, but life is a journey and all that.<p>I do two things to dig out of this particular hole:<p>- Have some (relatively) objective standards by which I judge code&#x2F;a project<p>- Have some empathy for people who were probably just doing their best, in the most multivariate sense (&quot;I wrote this in Clojure so I didn&#x27;t burn out&quot;, &quot;I had to ship this in three days and I was just back from paternity leave&quot;, &quot;I was onboarding a junior engineer and dumped this spaghetti in a spare 3 hours to mollify an important client&quot;<p>#2 is very useful because it snaps me out of contempt and helps prevent me from spreading that culture to the engineers around me. But #1 is actionable in that when I do get time to &quot;do things right&quot; I have some values to aim at. Mostly they&#x27;re:<p>- Does this code build&#x2F;respect a coherent mental model of the problem space<p>- Is it possible to represent invalid state<p>- Are surprises&#x2F;pitfalls noted (I&#x27;m not a big commenter in general, but this is a case where I find them useful)<p>- Does this code consider likely engineer workflows (e.g. is it easy to add another case to handle, is it easy to enable debugging, etc.)<p>Notably none of these are like, &quot;methods are too long&quot; or &quot;variable names are too short&quot; or whatever. I find orthodoxies like these just serve to create in&#x2F;out groups and have no impact on code quality. Or, another way to say this is that if you&#x27;re building a coherent mental model, your methods are probably the right size.</div><br/></div></div><div id="36503191" class="c"><input type="checkbox" id="c-36503191" checked=""/><div class="controls bullet"><span class="by">KnobbleMcKnees</span><span>|</span><a href="#36502124">root</a><span>|</span><a href="#36502838">parent</a><span>|</span><a href="#36503826">prev</a><span>|</span><a href="#36502247">next</a><span>|</span><label class="collapse" for="c-36503191">[-]</label><label class="expand" for="c-36503191">[1 more]</label></div><br/><div class="children"><div class="content">It gets worse as time goes on to. Old code and teenage fashion choices have a lot in common.</div><br/></div></div></div></div><div id="36502247" class="c"><input type="checkbox" id="c-36502247" checked=""/><div class="controls bullet"><span class="by">parentheses</span><span>|</span><a href="#36502124">parent</a><span>|</span><a href="#36502838">prev</a><span>|</span><a href="#36502384">next</a><span>|</span><label class="collapse" for="c-36502247">[-]</label><label class="expand" for="c-36502247">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. The us&#x2F;them-ness of this article immediately turned me off.</div><br/></div></div><div id="36502384" class="c"><input type="checkbox" id="c-36502384" checked=""/><div class="controls bullet"><span class="by">hbarka</span><span>|</span><a href="#36502124">parent</a><span>|</span><a href="#36502247">prev</a><span>|</span><a href="#36502773">next</a><span>|</span><label class="collapse" for="c-36502384">[-]</label><label class="expand" for="c-36502384">[2 more]</label></div><br/><div class="children"><div class="content">Agreed. If there was a thesis in there, I wouldn&#x27;t have mind reading through but it became tldr and I wanted so hard to find the life lesson. I also don&#x27;t understand what&#x27;s hip with ignoring the uppercasing of the initial letter in sentences. In code or short tweets, fine, but in composition of an essay it looks unscholarly and pretentious.</div><br/><div id="36503677" class="c"><input type="checkbox" id="c-36503677" checked=""/><div class="controls bullet"><span class="by">placesalt</span><span>|</span><a href="#36502124">root</a><span>|</span><a href="#36502384">parent</a><span>|</span><a href="#36502773">next</a><span>|</span><label class="collapse" for="c-36503677">[-]</label><label class="expand" for="c-36503677">[1 more]</label></div><br/><div class="children"><div class="content">&gt; In code or short tweets, fine, but in composition of an essay it looks unscholarly and pretentious.<p>I think a good general rule is: for a single sentence, not capitalizing the first letter (and not using a period) is fine. Longer than that and it both makes parsing more difficult and looks strongly like an affectation. There is a practical purpose for sentence start&#x2F;end punctuation.</div><br/></div></div></div></div></div></div><div id="36502773" class="c"><input type="checkbox" id="c-36502773" checked=""/><div class="controls bullet"><span class="by">jahsome</span><span>|</span><a href="#36502124">prev</a><span>|</span><a href="#36502560">next</a><span>|</span><label class="collapse" for="c-36502773">[-]</label><label class="expand" for="c-36502773">[1 more]</label></div><br/><div class="children"><div class="content">I kept skimming to find the &quot;real&quot; article. Couldn&#x27;t figure out if the schtick ever ended but I found it too distracting.<p>I say this as someone who spent 10 years dreaming of working for The Onion.<p>I feel this type of tone can work as a brief intro&#x2F;aside, but is rarely suited for long form. I certainly don&#x27;t think it befits a technical topic.</div><br/></div></div><div id="36502560" class="c"><input type="checkbox" id="c-36502560" checked=""/><div class="controls bullet"><span class="by">photonthug</span><span>|</span><a href="#36502773">prev</a><span>|</span><a href="#36501853">next</a><span>|</span><label class="collapse" for="c-36502560">[-]</label><label class="expand" for="c-36502560">[1 more]</label></div><br/><div class="children"><div class="content">author seems to be describing the kind of patterns you might make with <a href="https:&#x2F;&#x2F;argoproj.github.io&#x2F;argo-workflows&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;argoproj.github.io&#x2F;argo-workflows&#x2F;</a> .  or see for example <a href="https:&#x2F;&#x2F;github.com&#x2F;couler-proj&#x2F;couler">https:&#x2F;&#x2F;github.com&#x2F;couler-proj&#x2F;couler</a> , which is an sdk for describing tasks that may be submitted to different workflow engines on the backend.<p>it&#x27;s a little confusing to me that the author seems to object to &quot;pipelines&quot; and then equate them with messaging-queues. for me at least, &quot;pipeline&quot; vs &quot;workflow-engine&quot; vs &quot;scheduler&quot; are all basically synonyms in this context.  those things may or may not be implemented with a message-queue for persistence, but the persistence layer itself is usually below the level of abstraction that $current_problem is really concerned with.  like the author says, eventually you have to track state&#x2F;timestamps&#x2F;logs, but you get that from the beginning if you start with a workflow engine.<p>i agree with author that message-queues should not be a knee-jerk response to most problems because the LoE for edge-cases&#x2F;observability&#x2F;monitoring is huge.  (maybe reach for a queue only if you may actually overwhelm whatever the &quot;scheduler&quot; can handle.)  but don&#x27;t build the scheduler from scratch either.. use argowf, kubeflow, or a more opinionated framework like airflow, mlflow, databricks, aws lamda or step-functions.  all&#x2F;any of these should have config or api that&#x27;s robust enough to express rate-limit&#x2F;retry stuff.  almost any of these choices has better observability out-of-the-box than you can easily get from a queue.  but most importantly.. they provide idioms for handling failure that data-science folks and junior devs can work with.  the right way to structure code is just much more clear and things like structuring messages&#x2F;events, subclassing workers, repeating&#x2F;retrying tasks, is just harder to mess up.</div><br/></div></div><div id="36501853" class="c"><input type="checkbox" id="c-36501853" checked=""/><div class="controls bullet"><span class="by">macintux</span><span>|</span><a href="#36502560">prev</a><span>|</span><a href="#36503733">next</a><span>|</span><label class="collapse" for="c-36501853">[-]</label><label class="expand" for="c-36501853">[3 more]</label></div><br/><div class="children"><div class="content">I think this was bitten by HN’s title algorithm (but I’ve never fully understood it, so maybe the “how” was just dropped accidentally by the submitter).</div><br/><div id="36502427" class="c"><input type="checkbox" id="c-36502427" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#36501853">parent</a><span>|</span><a href="#36501919">next</a><span>|</span><label class="collapse" for="c-36502427">[-]</label><label class="expand" for="c-36502427">[1 more]</label></div><br/><div class="children"><div class="content">&quot;How not&quot; is spared by the title debaiter, but &quot;How (not)&quot; wasn&#x27;t - i.e. we weren&#x27;t catching the parens. I&#x27;ve fixed that now.<p>But we take gratuitous parens out of titles anyway and it looks like a mod did that later.</div><br/></div></div><div id="36501919" class="c"><input type="checkbox" id="c-36501919" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#36501853">parent</a><span>|</span><a href="#36502427">prev</a><span>|</span><a href="#36503733">next</a><span>|</span><label class="collapse" for="c-36501919">[-]</label><label class="expand" for="c-36501919">[1 more]</label></div><br/><div class="children"><div class="content">On the other hand this is exactly the kind of uninformative click-baity titles that this algorithm was built to combat.<p>Having read the original title and the first fourth of the article, I still don&#x27;t know what it is about.</div><br/></div></div></div></div><div id="36503733" class="c"><input type="checkbox" id="c-36503733" checked=""/><div class="controls bullet"><span class="by">foul</span><span>|</span><a href="#36501853">prev</a><span>|</span><a href="#36502145">next</a><span>|</span><label class="collapse" for="c-36503733">[-]</label><label class="expand" for="c-36503733">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  &gt; you are

  [...]

  &gt; employee number four and the ceo keeps writing code on weekends
</code></pre>
F***, I am literally employee number four where I work</div><br/></div></div><div id="36502145" class="c"><input type="checkbox" id="c-36502145" checked=""/><div class="controls bullet"><span class="by">fwungy</span><span>|</span><a href="#36503733">prev</a><span>|</span><a href="#36502644">next</a><span>|</span><label class="collapse" for="c-36502145">[-]</label><label class="expand" for="c-36502145">[4 more]</label></div><br/><div class="children"><div class="content">Is there an existing framework for building what the author proposes?<p>I&#x27;ve seen the &quot;queue mess&quot; architecture many times myself but it&#x27;s been too embedded to easily migrate to something else.</div><br/><div id="36502831" class="c"><input type="checkbox" id="c-36502831" checked=""/><div class="controls bullet"><span class="by">flaminHotSpeedo</span><span>|</span><a href="#36502145">parent</a><span>|</span><a href="#36503707">next</a><span>|</span><label class="collapse" for="c-36502831">[-]</label><label class="expand" for="c-36502831">[2 more]</label></div><br/><div class="children"><div class="content">Full disclosure, the author sounds like an arrogant ass and I couldn&#x27;t stomach the full article...<p>But I find that queues are often misunderstood&#x2F;misused. You have to be careful not to use them in systems where the producer cares about the output (true story - I&#x27;ve had someone earnestly suggest an &quot;ack queue,&quot; essentially implementing TCP-over-SQS), you absolutely cannot use them in latency sensitive contexts (if you need an async job pool, use a stack. Your peak load customers will thank you), and you have to be careful about idempotency, ordering, and delivery guarantees.<p>Also to put on my own arrogant hat, most of the time I&#x27;ve seen linked queues it&#x27;s been better to orchestrate the system as a state machine.</div><br/><div id="36503340" class="c"><input type="checkbox" id="c-36503340" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#36502145">root</a><span>|</span><a href="#36502831">parent</a><span>|</span><a href="#36503707">next</a><span>|</span><label class="collapse" for="c-36503340">[-]</label><label class="expand" for="c-36503340">[1 more]</label></div><br/><div class="children"><div class="content">I have coworkers debating how to automatically update half a hundred build scripts to pick up new runtime versions.<p>I’ve long, long since given up getting the, to realize that separate build plans are only accomplishing one thing: Enabling (as in codependency) a bunch of bad, slow tests in two sections of the code to persist instead of needing to be rewritten.<p>This project has no proper reason to be more than a dozen modules, and we’ve spent time on tooling to reduce the burden of managing so many repos at once.<p>If you don’t have a small mountain of builds you have to compose, you don’t have the queuing problems that go along with them.</div><br/></div></div></div></div><div id="36503707" class="c"><input type="checkbox" id="c-36503707" checked=""/><div class="controls bullet"><span class="by">jatins</span><span>|</span><a href="#36502145">parent</a><span>|</span><a href="#36502831">prev</a><span>|</span><a href="#36502644">next</a><span>|</span><label class="collapse" for="c-36503707">[-]</label><label class="expand" for="c-36503707">[1 more]</label></div><br/><div class="children"><div class="content">I have found temporal.io to be a great replacement for queue mess.</div><br/></div></div></div></div></div></div></div></div></div></body></html>