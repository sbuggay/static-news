<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1684918865747" as="style"/><link rel="stylesheet" href="styles.css?v=1684918865747"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://wasmlabs.dev/articles/sqlite-wasi-support/">SQLite builds for WASI since 3.41.0</a>Â <span class="domain">(<a href="https://wasmlabs.dev">wasmlabs.dev</a>)</span></div><div class="subtext"><span>rapnie</span> | <span>24 comments</span></div><br/><div><div id="36055032" class="c"><input type="checkbox" id="c-36055032" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#36054859">next</a><span>|</span><label class="collapse" for="c-36055032">[-]</label><label class="expand" for="c-36055032">[7 more]</label></div><br/><div class="children"><div class="content">&gt; For legal reasons, we could not contribute directly, but we could discuss the required changes with someone from the SQLite team and then iterate with them by testing or commenting.<p>Ah, here&#x27;s the catch! I knew SQLite didn&#x27;t accept code contributions, I was suprised they managed to contribute anyway, and then this sentence clarified the situation. So they indeed did not manage to contribute their code itself, but the SQLite team agreed to write this code themselves. I wonder what was the SQLite team&#x27;s motivation behind this cooperative work.</div><br/><div id="36055184" class="c"><input type="checkbox" id="c-36055184" checked=""/><div class="controls bullet"><span class="by">jillesvangurp</span><span>|</span><a href="#36055032">parent</a><span>|</span><a href="#36054859">next</a><span>|</span><label class="collapse" for="c-36055184">[-]</label><label class="expand" for="c-36055184">[6 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;copyright.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;copyright.html</a><p>To summarize, instead of using one of the OSS licenses, the copyright holders simply declare the source to be in the public domain. In order to preserve that status they don&#x27;t accept patches unless you submit some signed document that you agree with that.<p>To make things more complicated, they also use their a relatively niche version management system instead of git. Which would complicate making contributions (if they accepted them).<p>There&#x27;s a popular fork that fixes all of these issues: <a href="https:&#x2F;&#x2F;github.com&#x2F;libsql&#x2F;libsql">https:&#x2F;&#x2F;github.com&#x2F;libsql&#x2F;libsql</a> It is MIT licensed, on Github, and open for contributions.<p>Kind of a weird legal situation for a popular project like this that so many people depend on to have. Not judging; but it is odd. Seems like a lot of wasted efforts between users, would be contributors, and the people that forked this thing to address all that.</div><br/><div id="36055358" class="c"><input type="checkbox" id="c-36055358" checked=""/><div class="controls bullet"><span class="by">KronisLV</span><span>|</span><a href="#36055032">root</a><span>|</span><a href="#36055184">parent</a><span>|</span><a href="#36055313">next</a><span>|</span><label class="collapse" for="c-36055358">[-]</label><label class="expand" for="c-36055358">[1 more]</label></div><br/><div class="children"><div class="content">&gt; To make things more complicated, they also use their a relatively niche version management system instead of git. Which would complicate making contributions (if they accepted them).<p>The Fossil VCS actually has a page explaining why it was created, instead of just using Git: <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;whynotgit.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;whynotgit.html</a><p>Honestly, a lot of those points make sense, especially how Git is perhaps a little bit more complex and tricky to wrap one&#x27;s head around than it should be, making you think more about the VCS than just what you want to do. To that end, I&#x27;d actually suggest that people have a brief look at Fossil, it even comes with a built in web interface and some common functionality out of the box (vs most folks needing to setup Gitea&#x2F;GitLab or use GitHub&#x2F;Bitbucket etc. separately): <a href="https:&#x2F;&#x2F;fossil-scm.org&#x2F;home&#x2F;doc&#x2F;trunk&#x2F;www&#x2F;index.wiki" rel="nofollow">https:&#x2F;&#x2F;fossil-scm.org&#x2F;home&#x2F;doc&#x2F;trunk&#x2F;www&#x2F;index.wiki</a><p>Of course, realistically, Fossil will be dead in the water for most, given that it&#x27;s still niche and won&#x27;t have integrations with any graphical software that some might want to use (e.g. SourceTree, GitKraken, Git Cola exist, but I&#x27;m not aware of a rich ecosystem of solutions for Fossil, something like Fuel seems dead <a href="https:&#x2F;&#x2F;fuel-scm.org&#x2F;fossil&#x2F;brlist" rel="nofollow">https:&#x2F;&#x2F;fuel-scm.org&#x2F;fossil&#x2F;brlist</a>), or even with any CI&#x2F;CD server solutions.</div><br/></div></div><div id="36055313" class="c"><input type="checkbox" id="c-36055313" checked=""/><div class="controls bullet"><span class="by">hitekker</span><span>|</span><a href="#36055032">root</a><span>|</span><a href="#36055184">parent</a><span>|</span><a href="#36055358">prev</a><span>|</span><a href="#36055306">next</a><span>|</span><label class="collapse" for="c-36055313">[-]</label><label class="expand" for="c-36055313">[1 more]</label></div><br/><div class="children"><div class="content">Wait, when did libsql become popular? As I recall, the libsql startup burned some goodwill when they tried to publicly shame SQLite, after forking SQLite and barely changing its code[1]. Looking at the libsql repo today, it looks like the contributors are still on the payroll of that startup.<p>Beyond that, the insinuation that good OSS must conform to Github social norms is silly given SQLite&#x27;s track record of success. The maintainers are smart to direct their limited time and resources into development and not into community management or clout-chasing.<p>[1]<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33099222" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33099222</a> and <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33081159" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=33081159</a></div><br/></div></div><div id="36055306" class="c"><input type="checkbox" id="c-36055306" checked=""/><div class="controls bullet"><span class="by">tarruda</span><span>|</span><a href="#36055032">root</a><span>|</span><a href="#36055184">parent</a><span>|</span><a href="#36055313">prev</a><span>|</span><a href="#36055281">next</a><span>|</span><label class="collapse" for="c-36055306">[-]</label><label class="expand" for="c-36055306">[1 more]</label></div><br/><div class="children"><div class="content">&gt; they also use their a relatively niche version management system instead of git<p>They use Fossil for source control: <a href="https:&#x2F;&#x2F;www2.fossil-scm.org&#x2F;home&#x2F;doc&#x2F;trunk&#x2F;www&#x2F;index.wiki" rel="nofollow">https:&#x2F;&#x2F;www2.fossil-scm.org&#x2F;home&#x2F;doc&#x2F;trunk&#x2F;www&#x2F;index.wiki</a><p>It is a git-like system, but instead of storing objects on the filesystem, it uses a SQLite database.<p>Has some interesting features:<p>- Project Management<p>- Built-in Web Interface<p>- Single executable</div><br/></div></div><div id="36055281" class="c"><input type="checkbox" id="c-36055281" checked=""/><div class="controls bullet"><span class="by">mehdix</span><span>|</span><a href="#36055032">root</a><span>|</span><a href="#36055184">parent</a><span>|</span><a href="#36055306">prev</a><span>|</span><a href="#36055244">next</a><span>|</span><label class="collapse" for="c-36055281">[-]</label><label class="expand" for="c-36055281">[1 more]</label></div><br/><div class="children"><div class="content">Aren&#x27;t all those potential limitations, in fact their strengths? They are eating their own dogfood, which works for them. That sounds great to me.</div><br/></div></div><div id="36055244" class="c"><input type="checkbox" id="c-36055244" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#36055032">root</a><span>|</span><a href="#36055184">parent</a><span>|</span><a href="#36055281">prev</a><span>|</span><a href="#36054859">next</a><span>|</span><label class="collapse" for="c-36055244">[-]</label><label class="expand" for="c-36055244">[1 more]</label></div><br/><div class="children"><div class="content">&gt; To summarize, instead of using one of the OSS licenses, the copyright holders simply declare the source to be in the public domain. In order to preserve that status they don&#x27;t accept patches unless you submit some signed document that you agree with that.<p>Yep, see also this discussion about it in this thread <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36054521#36055014" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36054521#36055014</a></div><br/></div></div></div></div></div></div><div id="36054859" class="c"><input type="checkbox" id="c-36054859" checked=""/><div class="controls bullet"><span class="by">aargh_aargh</span><span>|</span><a href="#36055032">prev</a><span>|</span><a href="#36055014">next</a><span>|</span><label class="collapse" for="c-36054859">[-]</label><label class="expand" for="c-36054859">[9 more]</label></div><br/><div class="children"><div class="content">What would you use this for? I don&#x27;t get the whole picture and the article doesn&#x27;t talk about it.</div><br/><div id="36055567" class="c"><input type="checkbox" id="c-36055567" checked=""/><div class="controls bullet"><span class="by">angelmm</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055046">next</a><span>|</span><label class="collapse" for="c-36055567">[-]</label><label class="expand" for="c-36055567">[1 more]</label></div><br/><div class="children"><div class="content">SQLite is a pretty popular database and it&#x27;s a critical dependency for many different applications. By compiling it to Wasm32-wasi, you can add it to any WebAssembly module.<p>This enables a new set of possibilities for Wasm and SQLite. For example, now you can run a full WordPress application in the browser [1][2] &#x2F; server [3] using the same Wasm module. Note that for the browser these projects use Emscripten [4], but in the future the same Wasm32-wasi module will work.<p>In general, any environment that includes a wasm runtime can potentially run applications that uses SQLite under the hood. Before, it wasn&#x27;t possible.<p>- [1] <a href="https:&#x2F;&#x2F;wordpress.wasmlabs.dev&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wordpress.wasmlabs.dev&#x2F;</a><p>- [2] <a href="https:&#x2F;&#x2F;developer.wordpress.org&#x2F;playground&#x2F;demo&#x2F;" rel="nofollow">https:&#x2F;&#x2F;developer.wordpress.org&#x2F;playground&#x2F;demo&#x2F;</a><p>- [3] <a href="https:&#x2F;&#x2F;wasmlabs.dev&#x2F;articles&#x2F;running-wordpress-with-mod-wasm&#x2F;" rel="nofollow">https:&#x2F;&#x2F;wasmlabs.dev&#x2F;articles&#x2F;running-wordpress-with-mod-was...</a><p>- [4] <a href="https:&#x2F;&#x2F;emscripten.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;emscripten.org&#x2F;</a></div><br/></div></div><div id="36055046" class="c"><input type="checkbox" id="c-36055046" checked=""/><div class="controls bullet"><span class="by">fastball</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055567">prev</a><span>|</span><a href="#36055015">next</a><span>|</span><label class="collapse" for="c-36055046">[-]</label><label class="expand" for="c-36055046">[3 more]</label></div><br/><div class="children"><div class="content">The goal of WASI is to add a standardized system API to WebAssembly, allowing you to access underlying systems (filesystem, networking, etc) in a homomorphic and secure way.<p>In practice, this means that you can compile your Rust&#x2F;C++&#x2F;etc code to WASM + WASI, and that code will run anywhere you have a WebAssembly VM. So the same code that accesses the &quot;filesystem&quot; in a browser context can also access the filesystem in a desktop&#x2F;mobile&#x2F;edge&#x2F;etc environment.<p>You could also think of it as an attempt to turn WebAssembly into a fully-fledged JVM alternative. Compile once, run anywhere (including browser).<p>For this specifically, it means that SQLite can integrate with WASI APIs (instead of only Web APIs as before) so that an SQLite Wasm build can run in other contexts besides browsers.</div><br/><div id="36055192" class="c"><input type="checkbox" id="c-36055192" checked=""/><div class="controls bullet"><span class="by">aargh_aargh</span><span>|</span><a href="#36054859">root</a><span>|</span><a href="#36055046">parent</a><span>|</span><a href="#36055015">next</a><span>|</span><label class="collapse" for="c-36055192">[-]</label><label class="expand" for="c-36055192">[2 more]</label></div><br/><div class="children"><div class="content">What I don&#x27;t get specifically is what&#x27;s being implemented here with SQLite. Assuming WASI is an interface an application can call into for things like filesystem access, sockets, does this add SQLite as interface (analogously to sqlite.h) next to these as part of WASI? So SQLite will be &quot;under&quot; the interface, i.e. part of a standard runtime?<p>How much &quot;batteries included&quot; is this runtime (planned to be)? If I understood this correctly, then there would be a tradeoff with having more batteries included which would imply more functionality for applications but make porting to new targets more work.</div><br/><div id="36055599" class="c"><input type="checkbox" id="c-36055599" checked=""/><div class="controls bullet"><span class="by">angelmm</span><span>|</span><a href="#36054859">root</a><span>|</span><a href="#36055192">parent</a><span>|</span><a href="#36055015">next</a><span>|</span><label class="collapse" for="c-36055599">[-]</label><label class="expand" for="c-36055599">[1 more]</label></div><br/><div class="children"><div class="content">The main work behind this patch is to ensure that SQLite can compile to Wasm32-wasi. WASI doesn&#x27;t offer all syscalls that SQLite may require, so it may require some conditional definitions and code to ensure it works properly. It doesn&#x27;t mean that SQLite is part of WASI, but you can embed SQLite in a Wasm32-wasi module.<p>In the future, the WASI standard will include more and more features. This will allow SQLite to enable more internal features that are currently skipped due to the limitations on WASI.</div><br/></div></div></div></div></div></div><div id="36055015" class="c"><input type="checkbox" id="c-36055015" checked=""/><div class="controls bullet"><span class="by">samwillis</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055046">prev</a><span>|</span><a href="#36055016">next</a><span>|</span><label class="collapse" for="c-36055015">[-]</label><label class="expand" for="c-36055015">[1 more]</label></div><br/><div class="children"><div class="content">So far the official WASM support from the SQLite project have only targeted WASM in the browser with a JS API. If I follow correctly this is about working with the SQLite team to upstream WASI support, which will eventually enable official support for it, and hence WASM on the server&#x2F;cloud&#x2F;edge and other WASI complement runners.</div><br/></div></div><div id="36055016" class="c"><input type="checkbox" id="c-36055016" checked=""/><div class="controls bullet"><span class="by">cfn</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055015">prev</a><span>|</span><a href="#36055009">next</a><span>|</span><label class="collapse" for="c-36055016">[-]</label><label class="expand" for="c-36055016">[1 more]</label></div><br/><div class="children"><div class="content">The file of my desktop app is a SQLite db in disguise, I could use this to open these files in a web version of my app, I suppose. I know there is a javascript implementation of SQLite out there but maybe this has better performance.</div><br/></div></div><div id="36055009" class="c"><input type="checkbox" id="c-36055009" checked=""/><div class="controls bullet"><span class="by">rcarmo</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055016">prev</a><span>|</span><a href="#36055005">next</a><span>|</span><label class="collapse" for="c-36055009">[-]</label><label class="expand" for="c-36055009">[1 more]</label></div><br/><div class="children"><div class="content">Well, you can use it to access SQLite files in WASM runners, of course. So you get a portable, platform-independent piece of code that can run anywhere.<p>Although it was a bit of a surprise to see that they started out with the toy CLI tool that my self and Nicholas hacked on for a weekend (I wanted to be able to run SQLite commands in a-Shell, which is an excellent iPad CLI environment).</div><br/></div></div><div id="36055005" class="c"><input type="checkbox" id="c-36055005" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#36054859">parent</a><span>|</span><a href="#36055009">prev</a><span>|</span><a href="#36055014">next</a><span>|</span><label class="collapse" for="c-36055005">[-]</label><label class="expand" for="c-36055005">[1 more]</label></div><br/><div class="children"><div class="content">Apparently they use it for their tests.<p>&gt; We wanted to contribute upstream our patches for SQLite, as we were heavily relying on libsqlite for our tests of PHP.wasm with WordPress and Drupal.</div><br/></div></div></div></div><div id="36055014" class="c"><input type="checkbox" id="c-36055014" checked=""/><div class="controls bullet"><span class="by">raybb</span><span>|</span><a href="#36054859">prev</a><span>|</span><label class="collapse" for="c-36055014">[-]</label><label class="expand" for="c-36055014">[7 more]</label></div><br/><div class="children"><div class="content">&gt; For legal reasons, we could not contribute directly (their patches)<p>What were the legal reasons?</div><br/><div id="36055041" class="c"><input type="checkbox" id="c-36055041" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#36055014">parent</a><span>|</span><a href="#36055038">next</a><span>|</span><label class="collapse" for="c-36055041">[-]</label><label class="expand" for="c-36055041">[2 more]</label></div><br/><div class="children"><div class="content">Most likely what is documented at <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;copyright.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;copyright.html</a><p>&gt;  SQLite is open-source, meaning that you can make as many copies of it as you want and do whatever you want with those copies, without limitation. But SQLite is not open-contribution. In order to keep SQLite in the public domain and ensure that the code does not become contaminated with proprietary or licensed content, the project does not accept patches from people who have not submitted an affidavit dedicating their contribution into the public domain.<p>&gt; All of the code in SQLite is original, having been written specifically for use by SQLite. No code has been copied from unknown sources on the internet.<p>They want to be freaking sure they are the original authors &#x2F; they can release the code in the public domain.<p>Public domain is tricky and does not exist in the same way everywhere. Where I live, you just can&#x27;t decide to put something in the public domain, you need to use something like CC0 [1]<p>[1] <a href="https:&#x2F;&#x2F;creativecommons.org&#x2F;share-your-work&#x2F;public-domain&#x2F;cc0&#x2F;" rel="nofollow">https:&#x2F;&#x2F;creativecommons.org&#x2F;share-your-work&#x2F;public-domain&#x2F;cc...</a></div><br/><div id="36055099" class="c"><input type="checkbox" id="c-36055099" checked=""/><div class="controls bullet"><span class="by">x-complexity</span><span>|</span><a href="#36055014">root</a><span>|</span><a href="#36055041">parent</a><span>|</span><a href="#36055038">next</a><span>|</span><label class="collapse" for="c-36055099">[-]</label><label class="expand" for="c-36055099">[1 more]</label></div><br/><div class="children"><div class="content">This is the one case where NIH syndrome is warranted: Entangled legal issues &amp; legal dependencies are no fun for anyone.</div><br/></div></div></div></div><div id="36055038" class="c"><input type="checkbox" id="c-36055038" checked=""/><div class="controls bullet"><span class="by">foota</span><span>|</span><a href="#36055014">parent</a><span>|</span><a href="#36055041">prev</a><span>|</span><label class="collapse" for="c-36055038">[-]</label><label class="expand" for="c-36055038">[4 more]</label></div><br/><div class="children"><div class="content">Looks like this: <a href="https:&#x2F;&#x2F;www.sqlite.org&#x2F;copyright.html" rel="nofollow">https:&#x2F;&#x2F;www.sqlite.org&#x2F;copyright.html</a><p>Kind of weird, couldn&#x27;t they use a CLA?</div><br/><div id="36055055" class="c"><input type="checkbox" id="c-36055055" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#36055014">root</a><span>|</span><a href="#36055038">parent</a><span>|</span><a href="#36055119">next</a><span>|</span><label class="collapse" for="c-36055055">[-]</label><label class="expand" for="c-36055055">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not enough to <i>guarantee</i> the code has not been copied from somewhere &#x2F; can be released in the public domain. The only way to have this guarantee is to write it yourself.</div><br/><div id="36055471" class="c"><input type="checkbox" id="c-36055471" checked=""/><div class="controls bullet"><span class="by">foota</span><span>|</span><a href="#36055014">root</a><span>|</span><a href="#36055055">parent</a><span>|</span><a href="#36055119">next</a><span>|</span><label class="collapse" for="c-36055471">[-]</label><label class="expand" for="c-36055471">[1 more]</label></div><br/><div class="children"><div class="content">I suppose that&#x27;s true, but that&#x27;s no different from any other project, no? If I write a contribution to React that wasn&#x27;t actually mine, it doesn&#x27;t matter that it&#x27;s just open source and not being released into the public domain, it&#x27;s still a violation of the real author&#x27;s copyright.<p>So if they&#x27;ve chosen a different risk model than essentially every other company doing open source software then that&#x27;s up to them, but I&#x27;m not sure the need for it follows from it being public domain?</div><br/></div></div></div></div><div id="36055119" class="c"><input type="checkbox" id="c-36055119" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#36055014">root</a><span>|</span><a href="#36055038">parent</a><span>|</span><a href="#36055055">prev</a><span>|</span><label class="collapse" for="c-36055119">[-]</label><label class="expand" for="c-36055119">[1 more]</label></div><br/><div class="children"><div class="content">A CLA only covers the things you wrote, and while you ensure in the CLA that you only contribute things you wrote and are allowed to license to them, it is possible that you lie, so there is the danger (although a small one), that contributors might upload proprietary code written by others. IANAL</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>