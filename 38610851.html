<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1702458075824" as="style"/><link rel="stylesheet" href="styles.css?v=1702458075824"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://nedbatchelder.com/code/cog/">Cog: Use Python in your source files to generate pieces of code</a> <span class="domain">(<a href="https://nedbatchelder.com">nedbatchelder.com</a>)</span></div><div class="subtext"><span>goranmoomin</span> | <span>41 comments</span></div><br/><div><div id="38624355" class="c"><input type="checkbox" id="c-38624355" checked=""/><div class="controls bullet"><span class="by">rogual</span><span>|</span><a href="#38624026">next</a><span>|</span><label class="collapse" for="c-38624355">[-]</label><label class="expand" for="c-38624355">[1 more]</label></div><br/><div class="children"><div class="content">Cog is great. I use it all the time in my personal projects. It really shines in C++.<p>Some uses I&#x27;ve found for it:<p>* Generate long literal lists, with less tedium and fewer bugs:<p><pre><code>  snprintf(buf, sizeof buf,
      &quot;%f %f %f %f\n&quot;
      &quot;%f %f %f %f\n&quot;
      &quot;%f %f %f %f\n&quot;
      &quot;%f %f %f %f\n&quot;
      &quot;%f %f %f %f\n&quot;,
      &#x2F;* [[[cog
      for i in range(20):
          cog.outl(f&quot;matrix[{i}]&quot; + (&#x27;,&#x27; if i != 19 else &#x27;&#x27;))
      ]]] *&#x2F;
      matrix[0],
      matrix[1],
      (...)
</code></pre>
* Automatically instantiate classes from a set of files:<p><pre><code>  &#x2F;* [[[cog
    for path in glob(&#x27;src&#x2F;editor&#x2F;Panel*.cc&#x27;):
      name = stem(path)
      instance = name[0].lower() + name[1:]
      outl(f&#x27;{name} {instance};&#x27;)
  ]]] *&#x2F;
      PanelInspector inspector;
      PanelGame game;
      PanelTextures textures;
      PanelModules modules;
      PanelProject project;
      PanelInput input;
      PanelPerformance performance;
  &#x2F;&#x2F; [[[end]]]
</code></pre>
* Given a list of Python strings, generate a C++ enum, and functions to conver it to and from a string.<p>* Parse a C++ source file for struct definitions, and generate code to debug-dump them, inspect them in a GUI, save&#x2F;load them... alright, Clang might be a better tool for this, but Cog will do in a pinch.<p>All this is stuff that a more expressive language could do without external tools, but even in such a language, you won&#x27;t usually see what a macro is being expanded to without some sort of tooling. Cog puts it right there in the file for you, which I often appreciate.</div><br/></div></div><div id="38624026" class="c"><input type="checkbox" id="c-38624026" checked=""/><div class="controls bullet"><span class="by">Bimos</span><span>|</span><a href="#38624355">prev</a><span>|</span><a href="#38623936">next</a><span>|</span><label class="collapse" for="c-38624026">[-]</label><label class="expand" for="c-38624026">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If dedent is True, then common initial white space is removed from the lines in sOut before adding them to the output. If trimblanklines is True, then an initial and trailing blank line are removed from sOut before adding them to the output. Together, these option arguments make it easier to use multi-line strings, and they only are useful for multi-line strings<p>I&#x27;ve recently learnt Julia and known how multiline strings in Julia works: normal &quot; allow multiline strings, while &quot;&quot;&quot; will automatically remove the first blank line and all indents.</div><br/></div></div><div id="38623936" class="c"><input type="checkbox" id="c-38623936" checked=""/><div class="controls bullet"><span class="by">lifeisstillgood</span><span>|</span><a href="#38624026">prev</a><span>|</span><a href="#38622518">next</a><span>|</span><label class="collapse" for="c-38623936">[-]</label><label class="expand" for="c-38623936">[3 more]</label></div><br/><div class="children"><div class="content">I get it but I don&#x27;t <i>get</i> it.  I have seen cog before and respect ned so I assume there are sound uses, but the demo versions are trivial and Instruggle to see how I can use it for more complex cases.<p>My thoughts are the python code will be most effective if it can read config or access chunks of data outside the source (ie auto-generating fetter setter style stuff). I am trying to see how much is dangerous and how much is trivial or better handled pre-commit</div><br/><div id="38624007" class="c"><input type="checkbox" id="c-38624007" checked=""/><div class="controls bullet"><span class="by">jmopp</span><span>|</span><a href="#38623936">parent</a><span>|</span><a href="#38624037">next</a><span>|</span><label class="collapse" for="c-38624007">[-]</label><label class="expand" for="c-38624007">[1 more]</label></div><br/><div class="children"><div class="content">For my work I often run a lot of queries with a similar structure, but not repetitive enough that I can just have one query. What I normally do is paste the query template in a Python REPL and write some code to generate all my queries, which I then output to a file that I can call before ending work and leave running through the night. This would allow me to do the same thing, but in a more reproducible way that I can, for instance, share with my teammates.</div><br/></div></div><div id="38624037" class="c"><input type="checkbox" id="c-38624037" checked=""/><div class="controls bullet"><span class="by">pseudony</span><span>|</span><a href="#38623936">parent</a><span>|</span><a href="#38624007">prev</a><span>|</span><a href="#38622518">next</a><span>|</span><label class="collapse" for="c-38624037">[-]</label><label class="expand" for="c-38624037">[1 more]</label></div><br/><div class="children"><div class="content">Having written something similar ( <a href="https:&#x2F;&#x2F;pypi.org&#x2F;project&#x2F;gcgen&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;pypi.org&#x2F;project&#x2F;gcgen&#x2F;</a> ), it is sometimes hard to provide examples without being overly specific.<p>However, some &quot;meta&quot; examples:
* If you have an authoritative source - a protobuf&#x2F;openai&#x2F;some other structured specification, then this is helpful (if there isn&#x27;t a specific generator already).<p>* Whenever you&#x27;re knee-deep in meta-classes in Python, generating code from annotations in Java or similar - then this might actually be better - the code will likely be simpler and therefore easier for teammates to maintain as well.</div><br/></div></div></div></div><div id="38622518" class="c"><input type="checkbox" id="c-38622518" checked=""/><div class="controls bullet"><span class="by">url00</span><span>|</span><a href="#38623936">prev</a><span>|</span><a href="#38623228">next</a><span>|</span><label class="collapse" for="c-38622518">[-]</label><label class="expand" for="c-38622518">[1 more]</label></div><br/><div class="children"><div class="content">I never expected to see this here! I used this in my earlier programming days. A great idea that sadly never caught on enough to allow for tooling integration with popular editors&#x2F;IDEs. I still love the concept and the source code is super readable. Makes me want to revisit it…</div><br/></div></div><div id="38623228" class="c"><input type="checkbox" id="c-38623228" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38622518">prev</a><span>|</span><a href="#38623164">next</a><span>|</span><label class="collapse" for="c-38623228">[-]</label><label class="expand" for="c-38623228">[1 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>Cog: Use pieces of Python code as generators in your source files</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=19566384">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=19566384</a> - April 2019 (72 comments)</div><br/></div></div><div id="38623164" class="c"><input type="checkbox" id="c-38623164" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38623228">prev</a><span>|</span><a href="#38623580">next</a><span>|</span><label class="collapse" for="c-38623164">[-]</label><label class="expand" for="c-38623164">[2 more]</label></div><br/><div class="children"><div class="content">I discovered Cog a couple of years ago and I use it on dozens of my own projects now. It&#x27;s a really neat thing to have around.<p>One trick I use a lot is including the output of the &quot;--help&quot; command in the README files for CLI tools that I release.<p>Here&#x27;s an example: <a href="https:&#x2F;&#x2F;github.com&#x2F;simonw&#x2F;ospeak&#x2F;blob&#x2F;main&#x2F;README.md#ospeak---help">https:&#x2F;&#x2F;github.com&#x2F;simonw&#x2F;ospeak&#x2F;blob&#x2F;main&#x2F;README.md#ospeak-...</a><p>View source on that file and you&#x27;ll see this:<p><pre><code>    ## ospeak --help

    &lt;!-- [[[cog
    import cog
    from ospeak import cli
    from click.testing import CliRunner
    runner = CliRunner()
    result = runner.invoke(cli.cli, [&quot;--help&quot;])
    help = result.output.replace(&quot;Usage: cli&quot;, &quot;Usage: ospeak&quot;)
    cog.out(
        &quot;```\n{}\n```&quot;.format(help)
    )
    ]]] --&gt;
    ```
    Usage: ospeak [OPTIONS] [TEXT]

      CLI tool for running text through OpenAI Text to speech

      Set the OPENAI_API_KEY environment variable to your OpenAI API key to avoid
      using the --token option every time.

      Example usage:

          ospeak &quot;Everyone deserves a pelican&quot; --voice alloy -x 1.5

    Options:
      --version                       Show the version and exit.
      -v, --voice [alloy|echo|fable|onyx|nova|shimmer|all]
                                      Voice to use
      -o, --output FILE               Save audio to this file on disk
      -x, --speed FLOAT RANGE         Speed of the voice  [0.25&lt;=x&lt;=4.0]
      -s, --speak                     Speak the text even when saving to a file
      --token TEXT                    OpenAI API key
      --help                          Show this message and exit.

    ```
    &lt;!-- [[[end]]] --&gt;
</code></pre>
I can now run &quot;cog -r README.md&quot; any time I want to update that block of text in the README.<p>I also have this line in my GitHub Actions test.yml workflow: <a href="https:&#x2F;&#x2F;github.com&#x2F;simonw&#x2F;ospeak&#x2F;blob&#x2F;73a449d3f006737e72e7a0c5ae47516d7ede766e&#x2F;.github&#x2F;workflows&#x2F;test.yml#L29">https:&#x2F;&#x2F;github.com&#x2F;simonw&#x2F;ospeak&#x2F;blob&#x2F;73a449d3f006737e72e7a0...</a><p><pre><code>    cog --check README.md
</code></pre>
That way my tests will fail if I make a change to the help and forget to update the README.<p>I like reflecting my help output in my documentation mainly because it&#x27;s a useful way to review if the help makes sense without having to actually run the command.<p>I maintain these much larger pages using Cog in a similar way:<p>- <a href="https:&#x2F;&#x2F;docs.datasette.io&#x2F;en&#x2F;stable&#x2F;cli-reference.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.datasette.io&#x2F;en&#x2F;stable&#x2F;cli-reference.html</a><p>- <a href="https:&#x2F;&#x2F;sqlite-utils.datasette.io&#x2F;en&#x2F;stable&#x2F;cli-reference.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;sqlite-utils.datasette.io&#x2F;en&#x2F;stable&#x2F;cli-reference.ht...</a><p>- <a href="https:&#x2F;&#x2F;llm.datasette.io&#x2F;en&#x2F;stable&#x2F;help.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;llm.datasette.io&#x2F;en&#x2F;stable&#x2F;help.html</a><p>I wrote a bit more about this pattern here: <a href="https:&#x2F;&#x2F;til.simonwillison.net&#x2F;python&#x2F;cog-to-update-help-in-readme" rel="nofollow noreferrer">https:&#x2F;&#x2F;til.simonwillison.net&#x2F;python&#x2F;cog-to-update-help-in-r...</a></div><br/><div id="38623970" class="c"><input type="checkbox" id="c-38623970" checked=""/><div class="controls bullet"><span class="by">lifeisstillgood</span><span>|</span><a href="#38623164">parent</a><span>|</span><a href="#38623580">next</a><span>|</span><label class="collapse" for="c-38623970">[-]</label><label class="expand" for="c-38623970">[1 more]</label></div><br/><div class="children"><div class="content">Ok, just wanted to say I had no idea click.CLIRunner was a thing - going to try that today for my own test suite<p>but this shows me a style Indid wonder about - cog is importing other python code (inside the package?) to do its thing. Makes more sense than attaching to C++ code I think</div><br/></div></div></div></div><div id="38623580" class="c"><input type="checkbox" id="c-38623580" checked=""/><div class="controls bullet"><span class="by">pjungwir</span><span>|</span><a href="#38623164">prev</a><span>|</span><a href="#38623377">next</a><span>|</span><label class="collapse" for="c-38623580">[-]</label><label class="expand" for="c-38623580">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve read technical books that say the code samples are actually executed to avoid typos. I wonder if you could use cog for that. Probably there are LaTeX packages that can do it, but what if I&#x27;m writing in markdown?</div><br/><div id="38623842" class="c"><input type="checkbox" id="c-38623842" checked=""/><div class="controls bullet"><span class="by">lvncelot</span><span>|</span><a href="#38623580">parent</a><span>|</span><a href="#38623968">next</a><span>|</span><label class="collapse" for="c-38623842">[-]</label><label class="expand" for="c-38623842">[1 more]</label></div><br/><div class="children"><div class="content">This is a perfect use case for org[1] and org-babel[2] and actually one of the reasons I&#x27;ve switched from vim to emacs.<p>I wonder whether there&#x27;s something similar that executes code fences in markdown? After a cursory search I found markdown-exec[3], which seems to be a more editor-agnostic solution, although I don&#x27;t know whether it can compete with org-babel in terms of language support and being maintained.<p>[1] <a href="https:&#x2F;&#x2F;orgmode.org&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;orgmode.org&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;orgmode.org&#x2F;worg&#x2F;org-contrib&#x2F;babel&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;orgmode.org&#x2F;worg&#x2F;org-contrib&#x2F;babel&#x2F;</a><p>[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;pawamoy&#x2F;markdown-exec">https:&#x2F;&#x2F;github.com&#x2F;pawamoy&#x2F;markdown-exec</a></div><br/></div></div><div id="38623968" class="c"><input type="checkbox" id="c-38623968" checked=""/><div class="controls bullet"><span class="by">devsda</span><span>|</span><a href="#38623580">parent</a><span>|</span><a href="#38623842">prev</a><span>|</span><a href="#38623623">next</a><span>|</span><label class="collapse" for="c-38623968">[-]</label><label class="expand" for="c-38623968">[1 more]</label></div><br/><div class="children"><div class="content">This approach is sometimes referred to as literate programming.<p>Emacs&#x27;s org-babel package implements it for a variety of languages but only within org-mode files (.org).<p>You might be able to find a 3rd party package&#x2F;script that works for you or you might find it easy to write&#x2F;modify existing scripts depending on your particular use case.</div><br/></div></div><div id="38623623" class="c"><input type="checkbox" id="c-38623623" checked=""/><div class="controls bullet"><span class="by">lf-non</span><span>|</span><a href="#38623580">parent</a><span>|</span><a href="#38623968">prev</a><span>|</span><a href="#38623377">next</a><span>|</span><label class="collapse" for="c-38623623">[-]</label><label class="expand" for="c-38623623">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think that would fall within the scope of a utility like cog.<p>I wrote a minimal tool long back which I used to extract parts of code from my test suite as json which I could then use within my documentation generator to embed these snippets as example.<p>The examples then are guaranteed to be correct because they are quite literally pulled from the project&#x27;s test suite. The util is written i n ts but should work with any lang. that supports C or Python style comments.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;lorefnon&#x2F;snippet-collector">https:&#x2F;&#x2F;github.com&#x2F;lorefnon&#x2F;snippet-collector</a></div><br/></div></div></div></div><div id="38623377" class="c"><input type="checkbox" id="c-38623377" checked=""/><div class="controls bullet"><span class="by">throwawaaarrgh</span><span>|</span><a href="#38623580">prev</a><span>|</span><a href="#38623460">next</a><span>|</span><label class="collapse" for="c-38623377">[-]</label><label class="expand" for="c-38623377">[2 more]</label></div><br/><div class="children"><div class="content">I wrote a thing like this once, only it would find any matching multiline regex, send it to any external command you wanted, and substitute the result. That way you could replace any text with any kind of processing program depending on your needs. Too bad I wrote it at work, was probably ditched when I left.</div><br/><div id="38623440" class="c"><input type="checkbox" id="c-38623440" checked=""/><div class="controls bullet"><span class="by">atoav</span><span>|</span><a href="#38623377">parent</a><span>|</span><a href="#38623460">next</a><span>|</span><label class="collapse" for="c-38623440">[-]</label><label class="expand" for="c-38623440">[1 more]</label></div><br/><div class="children"><div class="content">Was it only a twmporary fix? Then no, nothing is more permanent than a twmporary fix.</div><br/></div></div></div></div><div id="38623460" class="c"><input type="checkbox" id="c-38623460" checked=""/><div class="controls bullet"><span class="by">pseudony</span><span>|</span><a href="#38623377">prev</a><span>|</span><a href="#38623085">next</a><span>|</span><label class="collapse" for="c-38623460">[-]</label><label class="expand" for="c-38623460">[2 more]</label></div><br/><div class="children"><div class="content">Wrote something similar, but while you can mix generated and hand-written code, the actual python code for that is moved out of the file.<p><a href="https:&#x2F;&#x2F;jwdevantier.github.io&#x2F;gcgen&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;jwdevantier.github.io&#x2F;gcgen&#x2F;</a></div><br/><div id="38623490" class="c"><input type="checkbox" id="c-38623490" checked=""/><div class="controls bullet"><span class="by">rjeli</span><span>|</span><a href="#38623460">parent</a><span>|</span><a href="#38623085">next</a><span>|</span><label class="collapse" for="c-38623490">[-]</label><label class="expand" for="c-38623490">[1 more]</label></div><br/><div class="children"><div class="content">this looks nice, but I feel like mixing the python into the source is actually the reason I like cog so much. It feels weird at first, but having it all inline and checking it in together is simpler to work with IMO</div><br/></div></div></div></div><div id="38623085" class="c"><input type="checkbox" id="c-38623085" checked=""/><div class="controls bullet"><span class="by">devsda</span><span>|</span><a href="#38623460">prev</a><span>|</span><a href="#38623366">next</a><span>|</span><label class="collapse" for="c-38623085">[-]</label><label class="expand" for="c-38623085">[1 more]</label></div><br/><div class="children"><div class="content">Interesting. I know IDE snippets are not the same, but I wish that they can do more than token replacement and have features that enable us to do the same.<p>Neovim has few snippet plugins that are powerful enough(after setup) to do similar code-gen but I think LSP servers might be more suitable to do this(based on a dsl may be) in an IDE agnostic way.</div><br/></div></div><div id="38622445" class="c"><input type="checkbox" id="c-38622445" checked=""/><div class="controls bullet"><span class="by">sakesun</span><span>|</span><a href="#38623366">prev</a><span>|</span><a href="#38624294">next</a><span>|</span><label class="collapse" for="c-38622445">[-]</label><label class="expand" for="c-38622445">[1 more]</label></div><br/><div class="children"><div class="content">Wow. Cog is almost 20 years now. Still cool today. Perhaps we should try to put GPT prompt into the Cog comment these days.</div><br/></div></div><div id="38624294" class="c"><input type="checkbox" id="c-38624294" checked=""/><div class="controls bullet"><span class="by">mytailorisrich</span><span>|</span><a href="#38622445">prev</a><span>|</span><a href="#38623419">next</a><span>|</span><label class="collapse" for="c-38624294">[-]</label><label class="expand" for="c-38624294">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s quite common to use scripts to generate code.<p>My experience is that this is best kept as standalone scripts executed only when needed with the resulting generated code committed to source control (scripts are also of course under source control).<p>Code generated on the fly during the build process and never committed to source control is a pain, IMHO.</div><br/></div></div><div id="38622602" class="c"><input type="checkbox" id="c-38622602" checked=""/><div class="controls bullet"><span class="by">adriangrigore</span><span>|</span><a href="#38623419">prev</a><span>|</span><a href="#38623028">next</a><span>|</span><label class="collapse" for="c-38622602">[-]</label><label class="expand" for="c-38622602">[1 more]</label></div><br/><div class="children"><div class="content">I use shell in the same way <a href="https:&#x2F;&#x2F;mkws.sh&#x2F;docs" rel="nofollow noreferrer">https:&#x2F;&#x2F;mkws.sh&#x2F;docs</a> for static site generation!</div><br/></div></div><div id="38623028" class="c"><input type="checkbox" id="c-38623028" checked=""/><div class="controls bullet"><span class="by">selcuka</span><span>|</span><a href="#38622602">prev</a><span>|</span><a href="#38623639">next</a><span>|</span><label class="collapse" for="c-38623028">[-]</label><label class="expand" for="c-38623028">[11 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure if I&#x27;m missing anything, but if you ever need something like this, it generally means that you have a serious issue in your design.<p>I can understand templating languages (e.g. jinja2) which add dynamic logic using a high level language (e.g. Python) to a dumb markdown language (e.g. HTML), but I don&#x27;t see the need to generate code for another high level language.</div><br/><div id="38624071" class="c"><input type="checkbox" id="c-38624071" checked=""/><div class="controls bullet"><span class="by">whilenot-dev</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623182">next</a><span>|</span><label class="collapse" for="c-38624071">[-]</label><label class="expand" for="c-38624071">[2 more]</label></div><br/><div class="children"><div class="content">A metaprogramming technique like source-code generation is not a serious issue in any design. It&#x27;s especially helpful if the source of truth in your design is external to the current code base. You can generate:<p>- documentation from source-code files, some CLI frameworks are offering this (eg. oclif[0])<p>- types from schema files, and schemas from types (eg. quicktype[1])<p>- API clients and servers from specifications (eg. openapi-generator[2])<p>...these are all repetitive tasks that can be automated.<p>That being said, I wouldn&#x27;t personally generate it in the build step, but rather introduce an additional generate step for it and sync the generated output with the VCS of choice. I recently wrote about it a bit here[3].<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;oclif&#x2F;oclif#oclif-readme">https:&#x2F;&#x2F;github.com&#x2F;oclif&#x2F;oclif#oclif-readme</a><p>[1]: <a href="https:&#x2F;&#x2F;app.quicktype.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;app.quicktype.io&#x2F;</a><p>[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;OpenAPITools&#x2F;openapi-generator">https:&#x2F;&#x2F;github.com&#x2F;OpenAPITools&#x2F;openapi-generator</a><p>[3]: <a href="https:&#x2F;&#x2F;blog.whilenot.dev&#x2F;posts&#x2F;typescript-source-code-generation&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.whilenot.dev&#x2F;posts&#x2F;typescript-source-code-gener...</a></div><br/><div id="38624475" class="c"><input type="checkbox" id="c-38624475" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#38623028">root</a><span>|</span><a href="#38624071">parent</a><span>|</span><a href="#38623182">next</a><span>|</span><label class="collapse" for="c-38624475">[-]</label><label class="expand" for="c-38624475">[1 more]</label></div><br/><div class="children"><div class="content">Exactly. I&#x27;ve used something like this before when writing a lexer and a parser and it was really helpful.</div><br/></div></div></div></div><div id="38623182" class="c"><input type="checkbox" id="c-38623182" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38624071">prev</a><span>|</span><a href="#38623373">next</a><span>|</span><label class="collapse" for="c-38623182">[-]</label><label class="expand" for="c-38623182">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s mainly useful for automating chunks of documentation.<p>Markdown files on GitHub for example don&#x27;t support any form of templating language - but Cog is a template language which can be hidden away in &lt;!-- comments --&gt; in your Markdown, and then executed using a separate command:<p><pre><code>    cog -r README.md
</code></pre>
So it&#x27;s a templating language for files that don&#x27;t usually support templating languages, but that do support comments.</div><br/></div></div><div id="38623373" class="c"><input type="checkbox" id="c-38623373" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623182">prev</a><span>|</span><a href="#38623794">next</a><span>|</span><label class="collapse" for="c-38623373">[-]</label><label class="expand" for="c-38623373">[1 more]</label></div><br/><div class="children"><div class="content">It is not for dynamic logic, it is more like a code generation tool. The inlined output means that you don&#x27;t have to rerun the embedded code every time, which is useful for many cases where templating as a part of the build process would be inadaquate or cumbersome.</div><br/></div></div><div id="38623794" class="c"><input type="checkbox" id="c-38623794" checked=""/><div class="controls bullet"><span class="by">jitl</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623373">prev</a><span>|</span><a href="#38623055">next</a><span>|</span><label class="collapse" for="c-38623794">[-]</label><label class="expand" for="c-38623794">[1 more]</label></div><br/><div class="children"><div class="content">I would often prefer to have this kind of code generation to magic reflection or dynamism at runtime, especially if runtime magicks come with a performance cost. For example in JavaScript you can intercept any method call or object access at runtime using Proxy, or in Ruby using method_missing, but it such code is often hard to maintain and understand.<p>If you statically generate a bunch of methods from a schema, it’s very easy to just read the output source, and the JIT is much happier with the code.</div><br/></div></div><div id="38623055" class="c"><input type="checkbox" id="c-38623055" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623794">prev</a><span>|</span><a href="#38623589">next</a><span>|</span><label class="collapse" for="c-38623055">[-]</label><label class="expand" for="c-38623055">[1 more]</label></div><br/><div class="children"><div class="content">Before the introduction of generics quite a few projects used source code generation in Go projects, to make them manageable.<p>(Lisps, OTOH, have macro capabilities that do the same thing elegantly behind the scenes.)</div><br/></div></div><div id="38623589" class="c"><input type="checkbox" id="c-38623589" checked=""/><div class="controls bullet"><span class="by">rtpg</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623055">prev</a><span>|</span><a href="#38623981">next</a><span>|</span><label class="collapse" for="c-38623589">[-]</label><label class="expand" for="c-38623589">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes it&#x27;s easier to just codegen than to figure out the performant way to do something like read some spec file and generate an API from it. Especially if the generation target is something like Java or C++.<p>Code generation is also nice for things like generating Typescript definitions for your frontend to interact with a backend API. The value is partly derived from Python being a language with great introspection tools, so the codegen code itself is easy.<p>It&#x27;s not so much that this is the principled way of doing things, but it might be a way that is good enough and gets you where you need to be, in a slightly reproducible fashion.</div><br/></div></div><div id="38623981" class="c"><input type="checkbox" id="c-38623981" checked=""/><div class="controls bullet"><span class="by">cavallo71</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623589">prev</a><span>|</span><a href="#38623500">next</a><span>|</span><label class="collapse" for="c-38623981">[-]</label><label class="expand" for="c-38623981">[1 more]</label></div><br/><div class="children"><div class="content">Or one’s been programming in C++ where they use an ungodly amount of preprocessor and templates.. cog solves that elegantly.</div><br/></div></div><div id="38623500" class="c"><input type="checkbox" id="c-38623500" checked=""/><div class="controls bullet"><span class="by">faizshah</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623981">prev</a><span>|</span><a href="#38623507">next</a><span>|</span><label class="collapse" for="c-38623500">[-]</label><label class="expand" for="c-38623500">[1 more]</label></div><br/><div class="children"><div class="content">There’s definitely use cases for example API client generation.</div><br/></div></div><div id="38623507" class="c"><input type="checkbox" id="c-38623507" checked=""/><div class="controls bullet"><span class="by">svilen_dobrev</span><span>|</span><a href="#38623028">parent</a><span>|</span><a href="#38623500">prev</a><span>|</span><a href="#38623639">next</a><span>|</span><label class="collapse" for="c-38623507">[-]</label><label class="expand" for="c-38623507">[1 more]</label></div><br/><div class="children"><div class="content">then you have not gone high enough in abstraction&#x2F;interoperability within some code food-chain .<p>i had python code that generated another python code which then generated C (and C++) for wrapping CORBA.. 20 years ago.<p>Like 1000 LOC generated 5k that generated about 100K C.. No way to make that by hand - and keep it consistent.. Unless, one has to employ large number of people for the sake of it..</div><br/></div></div></div></div><div id="38623639" class="c"><input type="checkbox" id="c-38623639" checked=""/><div class="controls bullet"><span class="by">kasajian</span><span>|</span><a href="#38623028">prev</a><span>|</span><a href="#38622794">next</a><span>|</span><label class="collapse" for="c-38623639">[-]</label><label class="expand" for="c-38623639">[3 more]</label></div><br/><div class="children"><div class="content">I would want this for C, C within C.  You can just write C code in a C file that runs at &quot;compile time&quot; to create more C code.<p>And I want it to be built-in to Prettier, so all this happens when I press Ctrl+S to save the file.</div><br/><div id="38623851" class="c"><input type="checkbox" id="c-38623851" checked=""/><div class="controls bullet"><span class="by">egeozcan</span><span>|</span><a href="#38623639">parent</a><span>|</span><a href="#38623866">next</a><span>|</span><label class="collapse" for="c-38623851">[-]</label><label class="expand" for="c-38623851">[1 more]</label></div><br/><div class="children"><div class="content">From what I hear, perhaps Zig could be something for you? Of course, that&#x27;s no use if you just want to keep writing C but perhaps worth a try?</div><br/></div></div></div></div><div id="38622794" class="c"><input type="checkbox" id="c-38622794" checked=""/><div class="controls bullet"><span class="by">fake-name</span><span>|</span><a href="#38623639">prev</a><span>|</span><label class="collapse" for="c-38622794">[-]</label><label class="expand" for="c-38622794">[3 more]</label></div><br/><div class="children"><div class="content">How is this different then literally any other templating language?</div><br/><div id="38623187" class="c"><input type="checkbox" id="c-38623187" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38622794">parent</a><span>|</span><a href="#38622921">next</a><span>|</span><label class="collapse" for="c-38623187">[-]</label><label class="expand" for="c-38623187">[1 more]</label></div><br/><div class="children"><div class="content">See comment here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38623182">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38623182</a><p>The clever thing about Cog is that it&#x27;s a templating language which is designed to be hidden in comments inside files (such as Markdown) that don&#x27;t usually support an embedded templating language.</div><br/></div></div><div id="38622921" class="c"><input type="checkbox" id="c-38622921" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#38622794">parent</a><span>|</span><a href="#38623187">prev</a><span>|</span><label class="collapse" for="c-38622921">[-]</label><label class="expand" for="c-38622921">[1 more]</label></div><br/><div class="children"><div class="content">Normally code generation via templates is a part of the build process, but this is not always ideal for all uses. For example some template is simply too slow to run, or needs some specialized dependency which is otherwise not required. Or a particular code can be manually written, but you want to further document how that code could have been automatically generated. Cog templates are intended to persist, so that the output can safely replace the input and be directly checked into the repository without any additional dependency, making them useful for such situations.<p>(This concept is not that unusual, by the way. CPython itself has a preprocessor called the Argument Clinic [1] which was in fact inspired by Cog.)<p>[1] <a href="https:&#x2F;&#x2F;devguide.python.org&#x2F;development-tools&#x2F;clinic&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;devguide.python.org&#x2F;development-tools&#x2F;clinic&#x2F;</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>