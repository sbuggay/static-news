<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1697101265565" as="style"/><link rel="stylesheet" href="styles.css?v=1697101265565"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://matklad.github.io/2023/10/12/lsp-could-have-been-better.html">How LSP could have been better</a> <span class="domain">(<a href="https://matklad.github.io">matklad.github.io</a>)</span></div><div class="subtext"><span>packetlost</span> | <span>107 comments</span></div><br/><div><div id="37853337" class="c"><input type="checkbox" id="c-37853337" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853337">[-]</label><label class="expand" for="c-37853337">[14 more]</label></div><br/><div class="children"><div class="content">I’m fighting with it right now. LSP specifies several configuration mechanisms but there isn’t a “blessed” one. This is a pain point because:<p>I want to write Python.<p>There’s one FOSS language server (pylsp) that’s a better fit for my needs than the other Python servers.<p>I want to use a certain commercial editor.<p>The editor and the language server don’t share a common configuration method.<p>Ergo, I can’t use the editor I’d like to write Python the way I want. It’s no one’s fault. The editor works just fine with other servers, for Python and for lots of other languages. The server is also operating within spec, and plenty of editors support its configuration method. However, they don’t play well with each other. I can still use the editor with that server as long as I’m ok with the default settings, but I’m not.<p>It would’ve been spiffy to have a preferred baseline method that all editors and language servers spoke, but they went the enterprisey “here are a hundred options - pick a few!” overly configurable direction.<p>Bummer. I really, really like that editor.</div><br/><div id="37853773" class="c"><input type="checkbox" id="c-37853773" checked=""/><div class="controls bullet"><span class="by">smacke</span><span>|</span><a href="#37853337">parent</a><span>|</span><a href="#37853404">next</a><span>|</span><label class="collapse" for="c-37853773">[-]</label><label class="expand" for="c-37853773">[2 more]</label></div><br/><div class="children"><div class="content">Have you opened an issue against <a href="https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server">https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server</a>? I&#x27;m an occasional contributor for easy fixes; if your fix is easy chances are it would get picked up.</div><br/><div id="37853792" class="c"><input type="checkbox" id="c-37853792" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853773">parent</a><span>|</span><a href="#37853404">next</a><span>|</span><label class="collapse" for="c-37853792">[-]</label><label class="expand" for="c-37853792">[1 more]</label></div><br/><div class="children"><div class="content">I came in at the tail end of <a href="https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server&#x2F;issues&#x2F;195">https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server&#x2F;issues&#x2F;195</a>. The possibility of me sponsoring a fix came up, and I’m on board with it, but the other contributor never replied.</div><br/></div></div></div></div><div id="37853404" class="c"><input type="checkbox" id="c-37853404" checked=""/><div class="controls bullet"><span class="by">foota</span><span>|</span><a href="#37853337">parent</a><span>|</span><a href="#37853773">prev</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853404">[-]</label><label class="expand" for="c-37853404">[11 more]</label></div><br/><div class="children"><div class="content">What is configuration in this case?</div><br/><div id="37853429" class="c"><input type="checkbox" id="c-37853429" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853404">parent</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853429">[-]</label><label class="expand" for="c-37853429">[10 more]</label></div><br/><div class="children"><div class="content">In this specific case, enabling specific plugins, configuring their behavior, adjusting maximum line lengths, that sort of thing.</div><br/><div id="37853474" class="c"><input type="checkbox" id="c-37853474" checked=""/><div class="controls bullet"><span class="by">duped</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853429">parent</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853474">[-]</label><label class="expand" for="c-37853474">[9 more]</label></div><br/><div class="children"><div class="content">That seems out of scope of what LSP deals with</div><br/><div id="37853543" class="c"><input type="checkbox" id="c-37853543" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853474">parent</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853543">[-]</label><label class="expand" for="c-37853543">[8 more]</label></div><br/><div class="children"><div class="content">That’s exactly the kind of thing LSP deals with. You have to get those settings into the server somehow, and the main methods are for the editor to send them to the server, or for the server to load them from somewhere in the filesystem or similar. A lot of those settings (like line length) are configured in the editor by the user. It makes a lot more sense to have a mechanism to communicate them over the same protocol than to use a janky method like writing to a file with a specific name, or some other out-of-band method.</div><br/><div id="37853636" class="c"><input type="checkbox" id="c-37853636" checked=""/><div class="controls bullet"><span class="by">duped</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853543">parent</a><span>|</span><a href="#37853593">next</a><span>|</span><label class="collapse" for="c-37853636">[-]</label><label class="expand" for="c-37853636">[5 more]</label></div><br/><div class="children"><div class="content">LSP is a protocol for answering queries about the language model behind the text, not controlling anything about the text itself (expect for auto formatting, but that&#x27;s a bit special). Those configurations seem to be in scope for the text editor, not the language server.<p>In fact LSP is mostly configuration agnostic. It might use configuration for a particular query like autoformatting, but it&#x27;s still request&#x2F;response in terms of text edits.</div><br/><div id="37854327" class="c"><input type="checkbox" id="c-37854327" checked=""/><div class="controls bullet"><span class="by">kmarc</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853636">parent</a><span>|</span><a href="#37853688">next</a><span>|</span><label class="collapse" for="c-37854327">[-]</label><label class="expand" for="c-37854327">[1 more]</label></div><br/><div class="children"><div class="content">This is incorrect;<p>The textDocument&#x2F;diagnostic[1] is far beyond &quot;the language model behind the text&quot; and includes linting which many LSP servers implement (TS and python for example), and it can also happen as a &quot;push&quot; as opposed to &quot;request&#x2F;response&quot;<p>[1]: <a href="https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifications&#x2F;lsp&#x2F;3.17&#x2F;specification&#x2F;#textDocument_diagnostic" rel="nofollow noreferrer">https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifi...</a></div><br/></div></div><div id="37853688" class="c"><input type="checkbox" id="c-37853688" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853636">parent</a><span>|</span><a href="#37854327">prev</a><span>|</span><a href="#37853593">next</a><span>|</span><label class="collapse" for="c-37853688">[-]</label><label class="expand" for="c-37853688">[3 more]</label></div><br/><div class="children"><div class="content">You have to tell the server how to interpret the code somehow. I mentioned line length. In Python, you may want one configurable max for code and another for comments. If you can pass those to the server, it can tell you which lines are too long using the standard mechanism for identifying errors and warnings. Otherwise, the editor would have to know how to parse the code so it could know whether a given line is code or comment. That’s the sort of thing LSP can do better.<p>That’s just one example, not the lone thing users would likely configure.<p>Edit: More concretely, here are some of the config knobs you can twiddle via LSP for the particular server I’ve been discussing: <a href="https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server&#x2F;blob&#x2F;develop&#x2F;CONFIGURATION.md">https:&#x2F;&#x2F;github.com&#x2F;python-lsp&#x2F;python-lsp-server&#x2F;blob&#x2F;develop...</a><p>There are other plugins around with settings that aren’t documented there, but are still configured through the same mechanism.</div><br/><div id="37853967" class="c"><input type="checkbox" id="c-37853967" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853688">parent</a><span>|</span><a href="#37853593">next</a><span>|</span><label class="collapse" for="c-37853967">[-]</label><label class="expand" for="c-37853967">[2 more]</label></div><br/><div class="children"><div class="content">I get what you are saying, but it still sounds like a linter. And the linter (and syntax highlighting etc.) do need to understand the code - but the LSP is not necessarily the right tool for that.<p>In many cases the right tool is something like treesitter. Treesitter paired with an LSP is an incredible combination.<p>But yes, I understand your frustration. And if the best implementation happens to be inside the LSP then so be it.</div><br/><div id="37854013" class="c"><input type="checkbox" id="c-37854013" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853967">parent</a><span>|</span><a href="#37853593">next</a><span>|</span><label class="collapse" for="c-37854013">[-]</label><label class="expand" for="c-37854013">[1 more]</label></div><br/><div class="children"><div class="content">I see your point, too. (And also <i>adore</i> treesitter!)<p>The examples I gave were around lint-y types of things, but the same problem affects more LSP-y things, too. The link I gave has lots of tweakable knobs for refactoring plugins and other stuff that’s more philosophically in-scope for language servers.</div><br/></div></div></div></div></div></div></div></div><div id="37853593" class="c"><input type="checkbox" id="c-37853593" checked=""/><div class="controls bullet"><span class="by">the_mitsuhiko</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853543">parent</a><span>|</span><a href="#37853636">prev</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853593">[-]</label><label class="expand" for="c-37853593">[2 more]</label></div><br/><div class="children"><div class="content">LSP assumes that there is a higher level editor integration that handles configuration. That’s not ideal but it’s somewhat sensible as different editors will want to expose different ways to configure them.</div><br/><div id="37853622" class="c"><input type="checkbox" id="c-37853622" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853337">root</a><span>|</span><a href="#37853593">parent</a><span>|</span><a href="#37853303">next</a><span>|</span><label class="collapse" for="c-37853622">[-]</label><label class="expand" for="c-37853622">[1 more]</label></div><br/><div class="children"><div class="content">True, but there are also a slew of methods like workspace&#x2F;didChangeConfiguration for passing config around in-band.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="37853303" class="c"><input type="checkbox" id="c-37853303" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#37853337">prev</a><span>|</span><a href="#37853265">next</a><span>|</span><label class="collapse" for="c-37853303">[-]</label><label class="expand" for="c-37853303">[12 more]</label></div><br/><div class="children"><div class="content">The way a language server should work, imo, is it holds all the code and serves projections of the code on the fly to the editor. The user of the editor makes changes to the code and commits it back, at which point the language server parses the code and integrates it into the codebase, pretty-printing it to files as necessary for source control.  But, the file layout should be an implementation detail that the editor knows nothing about.</div><br/><div id="37854485" class="c"><input type="checkbox" id="c-37854485" checked=""/><div class="controls bullet"><span class="by">jesperlang</span><span>|</span><a href="#37853303">parent</a><span>|</span><a href="#37853545">next</a><span>|</span><label class="collapse" for="c-37854485">[-]</label><label class="expand" for="c-37854485">[2 more]</label></div><br/><div class="children"><div class="content">Exactly! There is such a shift in paradigm that needs to happen here and the only project I know of that is moving in this direction is Unison.<p>I don&#x27;t want to edit a &quot;file&quot;, I want to edit these two functions that exist in some module(s), why can&#x27;t I just see those two?<p>I constantly jump between many different languages and the cognitive load is noticeable: was it &quot;!=&quot;, &quot;&#x2F;=&quot; or &quot;~=&quot;? Why am I writing&#x2F;viewing ascii art when I&#x27;m coding?<p>If I am most comfortable&#x2F;fluent viewing python, why can&#x27;t I view a javascript source as python?<p>I think the remaining challenge is what sort of projections are the best&#x2F;most useful? How do we manipulate these projections? I have played around with these ideas and made an AST viewer for the browser where you could configure exactly how a node was represented (using CSS) and navigation was done in block mode (node traversal) but I found it really hard to build an editing experience that felt smooth..</div><br/><div id="37854769" class="c"><input type="checkbox" id="c-37854769" checked=""/><div class="controls bullet"><span class="by">rayuela</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37854485">parent</a><span>|</span><a href="#37853545">next</a><span>|</span><label class="collapse" for="c-37854769">[-]</label><label class="expand" for="c-37854769">[1 more]</label></div><br/><div class="children"><div class="content">This browser AST viewer sounds pretty neat. Mind sharing a link to your repo of it?</div><br/></div></div></div></div><div id="37853545" class="c"><input type="checkbox" id="c-37853545" checked=""/><div class="controls bullet"><span class="by">slimsag</span><span>|</span><a href="#37853303">parent</a><span>|</span><a href="#37854485">prev</a><span>|</span><a href="#37853730">next</a><span>|</span><label class="collapse" for="c-37853545">[-]</label><label class="expand" for="c-37853545">[6 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly how LSP is designed. The editor e.g. requests &#x27;the user is hovering over code &lt;here&gt;, what should I show?&#x27; and the server responds with some Markdown text. Or &#x27;the user wants to navigate to the thing under their cursor &lt;here&gt;, where should I go?&#x27; and the server responds with a file&#x2F;line.<p>Once you try to use LSP for anything not in that form.. it&#x27;s not so fun.</div><br/><div id="37853681" class="c"><input type="checkbox" id="c-37853681" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853545">parent</a><span>|</span><a href="#37853730">next</a><span>|</span><label class="collapse" for="c-37853681">[-]</label><label class="expand" for="c-37853681">[5 more]</label></div><br/><div class="children"><div class="content">No, this is the opposite of how LSP is designed: LSP assumes the editor is looking at a file and this results in a complicated sync dance between editor state and file state. I want the editor to look at temporary buffers served up from the language server and have the code be “written” by sending the temporary buffer back to the language server which handles writing it out to files itself.<p>As far as I know, the only languages with something even vaguely like this are Pharo Smalltalk (with its git integration) and unison</div><br/><div id="37854917" class="c"><input type="checkbox" id="c-37854917" checked=""/><div class="controls bullet"><span class="by">arp242</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853681">parent</a><span>|</span><a href="#37853720">next</a><span>|</span><label class="collapse" for="c-37854917">[-]</label><label class="expand" for="c-37854917">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t use LSP for all the real-time stuff, but I do use it for other things like rename symbol, lookup documentation, jump to, etc. and just &quot;the file you have open&quot; isn&#x27;t really enough for that in most cases. You need to know about the &quot;file layout&quot; or &quot;complete project&quot; for that sort of thing.</div><br/></div></div><div id="37853720" class="c"><input type="checkbox" id="c-37853720" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853681">parent</a><span>|</span><a href="#37854917">prev</a><span>|</span><a href="#37853894">next</a><span>|</span><label class="collapse" for="c-37853720">[-]</label><label class="expand" for="c-37853720">[1 more]</label></div><br/><div class="children"><div class="content">The advantage here is this enables some interesting workflows, like “show me this method and every definition that overrides it in a single view” or “show me this method and all the methods it calls directly”. So you can project the interesting part of your code base into a temporary editor buffer and then edit it and the language server takes care of persistence.<p>Also, it ends the formatting wars because the in-repository format is disconnected from the user’s preferred format.</div><br/></div></div><div id="37853894" class="c"><input type="checkbox" id="c-37853894" checked=""/><div class="controls bullet"><span class="by">zarzavat</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853681">parent</a><span>|</span><a href="#37853720">prev</a><span>|</span><a href="#37853730">next</a><span>|</span><label class="collapse" for="c-37853894">[-]</label><label class="expand" for="c-37853894">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I want the editor to look at temporary buffers served up from the language server and have the code be “written” by sending the temporary buffer back to the language server which handles writing it out to files itself.<p>I don’t think any editor would want to accept this workflow. The biggest issue is that writing is reputation-critical, if the editor writes to the wrong place, or it fails to write when it should have written, then users lose their work which makes them very unhappy. So the editor has to take responsibility for doing the writing, and that is the user’s mental model when they save their work.</div><br/><div id="37854105" class="c"><input type="checkbox" id="c-37854105" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853894">parent</a><span>|</span><a href="#37853730">next</a><span>|</span><label class="collapse" for="c-37854105">[-]</label><label class="expand" for="c-37854105">[1 more]</label></div><br/><div class="children"><div class="content">I want a system more like Bank Python[1] or Unison[2] or Pharo Smalltalk[3] that gets us beyond the idea of &quot;code in files&quot;. And I have plans to build this on top of Common Lisp + SLIME<p>[1]: <a href="https:&#x2F;&#x2F;calpaterson.com&#x2F;bank-python.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;calpaterson.com&#x2F;bank-python.html</a><p>[2]: <a href="https:&#x2F;&#x2F;www.unison-lang.org" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.unison-lang.org</a><p>[3]: <a href="https:&#x2F;&#x2F;pharo.org" rel="nofollow noreferrer">https:&#x2F;&#x2F;pharo.org</a></div><br/></div></div></div></div></div></div></div></div><div id="37853730" class="c"><input type="checkbox" id="c-37853730" checked=""/><div class="controls bullet"><span class="by">jenadine</span><span>|</span><a href="#37853303">parent</a><span>|</span><a href="#37853545">prev</a><span>|</span><a href="#37853265">next</a><span>|</span><label class="collapse" for="c-37853730">[-]</label><label class="expand" for="c-37853730">[3 more]</label></div><br/><div class="children"><div class="content">Imho it should be the other way around: the editor knows about file layout and everything, and the language server queries the editor when it needs contents for a specific file. Unfortunately the LSP don&#x27;t have calls to query contents.<p>The rationale is that only the editor knows what files are open and modified. Also we can imagine scenario where the editor and the language server are on different remote (eg GitHub codespace or the browser version of vscode. The language server could be a wasm build running where the editor is running, but the editor may access files in a remote server, or vice versa)</div><br/><div id="37854090" class="c"><input type="checkbox" id="c-37854090" checked=""/><div class="controls bullet"><span class="by">fiddlerwoaroof</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37853730">parent</a><span>|</span><a href="#37853265">next</a><span>|</span><label class="collapse" for="c-37854090">[-]</label><label class="expand" for="c-37854090">[2 more]</label></div><br/><div class="children"><div class="content">Well, a lot of this is that I think files are a bad way to represent code.  You really want something more shaped like a database that allows for multiple views into the same code.  Git would for serialization, but the source of truth should be inside the language server and either the files or the repository.</div><br/><div id="37854361" class="c"><input type="checkbox" id="c-37854361" checked=""/><div class="controls bullet"><span class="by">Reisen</span><span>|</span><a href="#37853303">root</a><span>|</span><a href="#37854090">parent</a><span>|</span><a href="#37853265">next</a><span>|</span><label class="collapse" for="c-37854361">[-]</label><label class="expand" for="c-37854361">[1 more]</label></div><br/><div class="children"><div class="content">This is something I have been wanting for nearly a decade. A lot of writing software isn&#x27;t just implementing your logic and abstractions but actively thinking about how to organize code to the constraints of the filesystem. Having to actively model your modules around file paths, Rust for example tightly binding the use of `mod` to your layout. Refactoring is the same, a non-trivial amount of time on large projects when re-factoring is realising you need to re-organise some module hierarchy and that involves modifying the file system too.<p>I really dislike this, instead of a fuzzy file finder I want a fuzzy function finder, where all functions are just kept in a database that I can pull into buffers at will. Where hierarchy is only based on the logical structure of your program and the filesystem ceases exist. &quot;New Function&quot; over &quot;New File&quot;. You can get the &quot;Fuzzy Function&quot; finder part somewhat with LSP Symbols, but it doesn&#x27;t get rid of the having to think about files.<p>Unfortunately I don&#x27;t think you can get this without first-class support by the language itself, and new languages getting critical adoption isn&#x27;t a regular thing.</div><br/></div></div></div></div></div></div></div></div><div id="37853265" class="c"><input type="checkbox" id="c-37853265" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37853303">prev</a><span>|</span><a href="#37853317">next</a><span>|</span><label class="collapse" for="c-37853265">[-]</label><label class="expand" for="c-37853265">[5 more]</label></div><br/><div class="children"><div class="content">Recently I stumbled upon this issue:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;joaotavora&#x2F;eglot&#x2F;discussions&#x2F;1127">https:&#x2F;&#x2F;github.com&#x2F;joaotavora&#x2F;eglot&#x2F;discussions&#x2F;1127</a><p>I don&#x27;t know enough about emacs and LSP to see the full picture, but it seems that both eglot&#x27;s and corfu&#x27;s maintainers, assumably very competent programmers, can&#x27;t find a solution for this.<p>I only skimmed the thread. My understanding is that LSP dumps a long list of completion candidates at once and they can&#x27;t decide a cache strategy that works well with existing code...? If someone who know more about this please enlighten us.</div><br/><div id="37854852" class="c"><input type="checkbox" id="c-37854852" checked=""/><div class="controls bullet"><span class="by">gpderetta</span><span>|</span><a href="#37853265">parent</a><span>|</span><a href="#37854049">next</a><span>|</span><label class="collapse" for="c-37854852">[-]</label><label class="expand" for="c-37854852">[1 more]</label></div><br/><div class="children"><div class="content">I read the almost the whole thread and it does not seem to be an LSP issue. As far as I can tell, the issue is purely corfu and eglot disagreeing about the semantics of internal emacs completion hooks they use to communicate and whether corfu should cache on its side or should rely on eglot. Company does not have this impedance mismatch with elgot so it works fine.</div><br/></div></div><div id="37854049" class="c"><input type="checkbox" id="c-37854049" checked=""/><div class="controls bullet"><span class="by">jhoechtl</span><span>|</span><a href="#37853265">parent</a><span>|</span><a href="#37854852">prev</a><span>|</span><a href="#37853582">next</a><span>|</span><label class="collapse" for="c-37854049">[-]</label><label class="expand" for="c-37854049">[2 more]</label></div><br/><div class="children"><div class="content">I wonder if this is still the case as most comments petered out end of March. There was a nasty bug discovered in Emacs JSONRPC-Library, which did cause spurious LSP connect errors and likely other issues in LSP server communication<p><a href="https:&#x2F;&#x2F;git.savannah.gnu.org&#x2F;cgit&#x2F;emacs.git&#x2F;commit&#x2F;?id=8bf4cdcf79bc3254a9169f28f68922ab83bd4e78" rel="nofollow noreferrer">https:&#x2F;&#x2F;git.savannah.gnu.org&#x2F;cgit&#x2F;emacs.git&#x2F;commit&#x2F;?id=8bf4c...</a><p>Do note that many users might have not been aware of this issue. The fixed library is part of Emacs 29. If you are not on Emacs 29 you might pull in a more recent JSONRPC-package from ELPA in which case it will shadow the inbuilt&#x2F;pre-shipped library.</div><br/><div id="37854189" class="c"><input type="checkbox" id="c-37854189" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37853265">root</a><span>|</span><a href="#37854049">parent</a><span>|</span><a href="#37853582">next</a><span>|</span><label class="collapse" for="c-37854189">[-]</label><label class="expand" for="c-37854189">[1 more]</label></div><br/><div class="children"><div class="content">I stumbled upon this issue because my eglot still constantly gets out of sync with LSP. (emacs 29.1, latest stable corfu and eglot)</div><br/></div></div></div></div><div id="37853582" class="c"><input type="checkbox" id="c-37853582" checked=""/><div class="controls bullet"><span class="by">b5n</span><span>|</span><a href="#37853265">parent</a><span>|</span><a href="#37854049">prev</a><span>|</span><a href="#37853317">next</a><span>|</span><label class="collapse" for="c-37853582">[-]</label><label class="expand" for="c-37853582">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious to know what `company` does differently here than `corfu`.<p>As a longtime user I couldn&#x27;t be happier: <a href="https:&#x2F;&#x2F;company-mode.github.io&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;company-mode.github.io&#x2F;</a></div><br/></div></div></div></div><div id="37853317" class="c"><input type="checkbox" id="c-37853317" checked=""/><div class="controls bullet"><span class="by">hgs3</span><span>|</span><a href="#37853265">prev</a><span>|</span><a href="#37853480">next</a><span>|</span><label class="collapse" for="c-37853317">[-]</label><label class="expand" for="c-37853317">[3 more]</label></div><br/><div class="children"><div class="content">&gt; The problem, column is counted using UTF-16 code units.<p>Rather than fixing the problem by using code points, they made it worse by allowing any encoding. Now, not only do you need to support UTF-16, but also UTF-8 and UTF-32 [1].<p>[1] <a href="https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifications&#x2F;lsp&#x2F;3.17&#x2F;specification&#x2F;#positionEncodingKind" rel="nofollow noreferrer">https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifi...</a></div><br/><div id="37853431" class="c"><input type="checkbox" id="c-37853431" checked=""/><div class="controls bullet"><span class="by">sillysaurusx</span><span>|</span><a href="#37853317">parent</a><span>|</span><a href="#37853654">next</a><span>|</span><label class="collapse" for="c-37853431">[-]</label><label class="expand" for="c-37853431">[1 more]</label></div><br/><div class="children"><div class="content">Or use UTF-8 everywhere to fix the problem. Code points have their own issues (as does UTF-8, but on balance these seem like better engineering tradeoffs).</div><br/></div></div><div id="37853654" class="c"><input type="checkbox" id="c-37853654" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#37853317">parent</a><span>|</span><a href="#37853431">prev</a><span>|</span><a href="#37853480">next</a><span>|</span><label class="collapse" for="c-37853654">[-]</label><label class="expand" for="c-37853654">[1 more]</label></div><br/><div class="children"><div class="content">You don’t <i>need</i> to; UTF-16 is mandatory (ugh), but support for other encodings is negotiated (see ClientCapabilities.positionEncoding and ServerCapabilities.positionEncoding).</div><br/></div></div></div></div><div id="37853480" class="c"><input type="checkbox" id="c-37853480" checked=""/><div class="controls bullet"><span class="by">__MatrixMan__</span><span>|</span><a href="#37853317">prev</a><span>|</span><a href="#37853259">next</a><span>|</span><label class="collapse" for="c-37853480">[-]</label><label class="expand" for="c-37853480">[8 more]</label></div><br/><div class="children"><div class="content">I hope we&#x27;re nearing the end of the era where we&#x27;re editing text in a bubble of tooling that understands ASTs but has to map everything back to text.<p>I look forward making tabs vs spaces a viewer setting and not an author choice.</div><br/><div id="37853736" class="c"><input type="checkbox" id="c-37853736" checked=""/><div class="controls bullet"><span class="by">akhosravian</span><span>|</span><a href="#37853480">parent</a><span>|</span><a href="#37853546">next</a><span>|</span><label class="collapse" for="c-37853736">[-]</label><label class="expand" for="c-37853736">[2 more]</label></div><br/><div class="children"><div class="content">Tabs vs spaces has been a viewer setting for decades for tab users.</div><br/><div id="37854118" class="c"><input type="checkbox" id="c-37854118" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#37853480">root</a><span>|</span><a href="#37853736">parent</a><span>|</span><a href="#37853546">next</a><span>|</span><label class="collapse" for="c-37854118">[-]</label><label class="expand" for="c-37854118">[1 more]</label></div><br/><div class="children"><div class="content">Exactly! A tab is literally &quot;1 level of indentation&quot;. You can render that one level any way you like.<p>Unfortunately, though, everyone who has used tabs got bitten by stupid text editors that don&#x27;t make it obvious whether you&#x27;ve used a tab or a space and substitute a tab for <i>any</i> run of 8 spaces. So if you&#x27;re aligning an argument list you&#x27;ll get a mixture of tabs and spaces. Everyone got bitten by this once back in the day then switched tabs off forever. They then switched tabs off in the text editors that the next generation are using.</div><br/></div></div></div></div><div id="37853546" class="c"><input type="checkbox" id="c-37853546" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37853480">parent</a><span>|</span><a href="#37853736">prev</a><span>|</span><a href="#37853549">next</a><span>|</span><label class="collapse" for="c-37853546">[-]</label><label class="expand" for="c-37853546">[2 more]</label></div><br/><div class="children"><div class="content">People have kept saying this since paredit...</div><br/><div id="37853655" class="c"><input type="checkbox" id="c-37853655" checked=""/><div class="controls bullet"><span class="by">__MatrixMan__</span><span>|</span><a href="#37853480">root</a><span>|</span><a href="#37853546">parent</a><span>|</span><a href="#37853549">next</a><span>|</span><label class="collapse" for="c-37853655">[-]</label><label class="expand" for="c-37853655">[1 more]</label></div><br/><div class="children"><div class="content">Yes, but we&#x27;ve been getting closer since then.  Unison, for instance, is a step in this direction.</div><br/></div></div></div></div><div id="37853549" class="c"><input type="checkbox" id="c-37853549" checked=""/><div class="controls bullet"><span class="by">ianlevesque</span><span>|</span><a href="#37853480">parent</a><span>|</span><a href="#37853546">prev</a><span>|</span><a href="#37853259">next</a><span>|</span><label class="collapse" for="c-37853549">[-]</label><label class="expand" for="c-37853549">[3 more]</label></div><br/><div class="children"><div class="content">Agreed. Even beyond that it would be great for merging &amp; conflict resolution too.</div><br/><div id="37853658" class="c"><input type="checkbox" id="c-37853658" checked=""/><div class="controls bullet"><span class="by">__MatrixMan__</span><span>|</span><a href="#37853480">root</a><span>|</span><a href="#37853549">parent</a><span>|</span><a href="#37853259">next</a><span>|</span><label class="collapse" for="c-37853658">[-]</label><label class="expand" for="c-37853658">[2 more]</label></div><br/><div class="children"><div class="content">Right. Line-wise diff is such a crude instrument.</div><br/><div id="37854080" class="c"><input type="checkbox" id="c-37854080" checked=""/><div class="controls bullet"><span class="by">mfashby</span><span>|</span><a href="#37853480">root</a><span>|</span><a href="#37853658">parent</a><span>|</span><a href="#37853259">next</a><span>|</span><label class="collapse" for="c-37854080">[-]</label><label class="expand" for="c-37854080">[1 more]</label></div><br/><div class="children"><div class="content">You can already get some tools e.g. <a href="https:&#x2F;&#x2F;difftastic.wilfred.me.uk&#x2F;introduction.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;difftastic.wilfred.me.uk&#x2F;introduction.html</a> which try to do semantic rather than purely textual diffs</div><br/></div></div></div></div></div></div></div></div><div id="37853259" class="c"><input type="checkbox" id="c-37853259" checked=""/><div class="controls bullet"><span class="by">zyedidia</span><span>|</span><a href="#37853480">prev</a><span>|</span><a href="#37854001">next</a><span>|</span><label class="collapse" for="c-37853259">[-]</label><label class="expand" for="c-37853259">[10 more]</label></div><br/><div class="children"><div class="content">Does anyone know why LSP uses UTF-16 for encoding columns? It seems like everyone agrees it is a bad choice, so I&#x27;m curious about the original reasoning.  Are there any benefits at all to using UTF-16, or was it something to do with Microsoft legacy code?</div><br/><div id="37853349" class="c"><input type="checkbox" id="c-37853349" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#37853259">parent</a><span>|</span><a href="#37853292">next</a><span>|</span><label class="collapse" for="c-37853349">[-]</label><label class="expand" for="c-37853349">[1 more]</label></div><br/><div class="children"><div class="content">The JavaScript VM, Java VM, .NET VM, and several other runtimes (including effectively the entire Windows API) have their fundamental definition of strings be based on UTF-16 baked in.<p>I believe the original producers and consumers of LSP were written in languages that had string lengths based on UTF-16, so it was the literal easiest way to do it, even though UTF-16 is probably objectively the most painful thing to compute if your string system isn&#x27;t UTF-16.<p>LSP eventually got a solution where you can request something other than UTF-16 offset calculations, but I don&#x27;t remember the details of what that solution is.</div><br/></div></div><div id="37853292" class="c"><input type="checkbox" id="c-37853292" checked=""/><div class="controls bullet"><span class="by">hgs3</span><span>|</span><a href="#37853259">parent</a><span>|</span><a href="#37853349">prev</a><span>|</span><a href="#37853280">next</a><span>|</span><label class="collapse" for="c-37853292">[-]</label><label class="expand" for="c-37853292">[6 more]</label></div><br/><div class="children"><div class="content">There was a lengthy discussion on this [1]. UTF-16 was used because it was convenient: it&#x27;s what Microsoft API&#x27;s and JavaScript already use (the latter being the language VS Code is written in).<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;language-server-protocol&#x2F;issues&#x2F;376">https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;language-server-protocol&#x2F;issues...</a></div><br/><div id="37853430" class="c"><input type="checkbox" id="c-37853430" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853259">root</a><span>|</span><a href="#37853292">parent</a><span>|</span><a href="#37853529">next</a><span>|</span><label class="collapse" for="c-37853430">[-]</label><label class="expand" for="c-37853430">[4 more]</label></div><br/><div class="children"><div class="content">That thread was infuriating. Since when does an encoding format have an evangelical task force? I&#x27;m all for UTF8 everywhere but wow some of the replies were super cringe.<p>Even when the proposal of &quot;UTF-16 default, UTF-8 optional&quot; was made to keep backwards compatibility, it was not enough. It has to be UTF8 because it&#x27;s superior technically, as if that&#x27;s the only consideration! I agree they should&#x27;ve just picked one, but I still don&#x27;t think the maintainers needed a refresher on what is UTF-8 every 3 comments.</div><br/><div id="37853446" class="c"><input type="checkbox" id="c-37853446" checked=""/><div class="controls bullet"><span class="by">sillysaurusx</span><span>|</span><a href="#37853259">root</a><span>|</span><a href="#37853430">parent</a><span>|</span><a href="#37853529">next</a><span>|</span><label class="collapse" for="c-37853446">[-]</label><label class="expand" for="c-37853446">[3 more]</label></div><br/><div class="children"><div class="content">Count me among the UTF-8 everywhere absolutists. There are two ways to encode text: UTF-8, and a worse choice.<p>But I wouldn’t be annoying about it. I’d just tut tut from afar. (Though if the decision is still up in the air, I’d argue as passionately as any preacher to persuade our fellow devs to adopt our lord and savior UTF-8 into their hearts and minds.)</div><br/><div id="37853462" class="c"><input type="checkbox" id="c-37853462" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853259">root</a><span>|</span><a href="#37853446">parent</a><span>|</span><a href="#37853529">next</a><span>|</span><label class="collapse" for="c-37853462">[-]</label><label class="expand" for="c-37853462">[2 more]</label></div><br/><div class="children"><div class="content">Yeah I would absolutely take utf8 everywhere. I hate dealing with anything else.<p>But I think the worst part was that the maintainer was clear that he&#x2F;she wasn&#x27;t debating this on a technical level. Like, they weren&#x27;t trying to decide which encoding was better. From what I understand it was more about how best to deal with the (at the time) current design choices without breaking the current implementations, and feedback from actual implementers.</div><br/><div id="37853848" class="c"><input type="checkbox" id="c-37853848" checked=""/><div class="controls bullet"><span class="by">inferiorhuman</span><span>|</span><a href="#37853259">root</a><span>|</span><a href="#37853462">parent</a><span>|</span><a href="#37853529">next</a><span>|</span><label class="collapse" for="c-37853848">[-]</label><label class="expand" for="c-37853848">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m inclined to agree that some manner of backwards compatibility is important.  A middle ground with a path towards exclusive UTF-8 use seems like a fine compromise.  However three things come to mind:<p>* LSP is being used outside of VSCode, and while UTF-16 may be helpful in that case it&#x27;s a hinderance for others.<p>* Institutional knowledge of UTF-16 ain&#x27;t great at Microsoft either.  Github broke rendering of multibyte characters and it took a random GH user to the devs explain how multibyte characters and strings interact in Javascript before that got fixed.<p>* [insert lots of handwaving about the downsides of electron]</div><br/></div></div></div></div></div></div></div></div><div id="37853529" class="c"><input type="checkbox" id="c-37853529" checked=""/><div class="controls bullet"><span class="by">raphlinus</span><span>|</span><a href="#37853259">root</a><span>|</span><a href="#37853292">parent</a><span>|</span><a href="#37853430">prev</a><span>|</span><a href="#37853280">next</a><span>|</span><label class="collapse" for="c-37853529">[-]</label><label class="expand" for="c-37853529">[1 more]</label></div><br/><div class="children"><div class="content">For earlier archaeology see [19]. It seems to me people had started coding extensions in VS Code without giving any real thought to the question, so the default choice inherited from the language was UTF-16.<p>[19]: <a href="https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;language-server-protocol&#x2F;issues&#x2F;19">https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;language-server-protocol&#x2F;issues...</a></div><br/></div></div></div></div><div id="37853280" class="c"><input type="checkbox" id="c-37853280" checked=""/><div class="controls bullet"><span class="by">slimsag</span><span>|</span><a href="#37853259">parent</a><span>|</span><a href="#37853292">prev</a><span>|</span><a href="#37853610">next</a><span>|</span><label class="collapse" for="c-37853280">[-]</label><label class="expand" for="c-37853280">[1 more]</label></div><br/><div class="children"><div class="content">JavaScript uses UTF-16 for everything is why, and LSP is a TypeScript-first protocol.</div><br/></div></div><div id="37853610" class="c"><input type="checkbox" id="c-37853610" checked=""/><div class="controls bullet"><span class="by">the_mitsuhiko</span><span>|</span><a href="#37853259">parent</a><span>|</span><a href="#37853280">prev</a><span>|</span><a href="#37854001">next</a><span>|</span><label class="collapse" for="c-37853610">[-]</label><label class="expand" for="c-37853610">[1 more]</label></div><br/><div class="children"><div class="content">Sadly there is some standard to that. JavaScript source maps also use the same definition for columns.</div><br/></div></div></div></div><div id="37854001" class="c"><input type="checkbox" id="c-37854001" checked=""/><div class="controls bullet"><span class="by">grumpyprole</span><span>|</span><a href="#37853259">prev</a><span>|</span><a href="#37853553">next</a><span>|</span><label class="collapse" for="c-37854001">[-]</label><label class="expand" for="c-37854001">[7 more]</label></div><br/><div class="children"><div class="content">The biggest problem with LSP is that it&#x27;s a lowest common denominator solution. If I try to edit OCaml using an LSP solution, I don&#x27;t get features like &quot;query type of symbol&quot;, presumably because JavaScript doesn&#x27;t need it.</div><br/><div id="37854260" class="c"><input type="checkbox" id="c-37854260" checked=""/><div class="controls bullet"><span class="by">kmarc</span><span>|</span><a href="#37854001">parent</a><span>|</span><a href="#37854128">next</a><span>|</span><label class="collapse" for="c-37854260">[-]</label><label class="expand" for="c-37854260">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not a problem, in contrary it is good that implementors are pointed to possible code intelligence features that they current IDE&#x27;s don&#x27;t provide either.<p>I read some factual inaccuracies here.<p>LSP (the protocol)&#x27;s main driving force was for a long time TypeScript rather than JS. FYI TypesSript has a stronger type system than Java at this point, and it&#x27;s LSP server is the most comprehensive and supported way to write TS with.<p>Another example of an LSP success story is Rust&#x27;s rust-analyzer. Not to mention that C++&#x27;s clangd also became an LSP server many years ago.<p>All these are strongly typed and bring extra semantics (templates, lifetimes) way beyond other languages.<p>&quot;query type of symbol&quot; functionality is provided as an example by the textdocument&#x2F;hover call [1]<p>But even if this wasn&#x27;t implemented, the protocol lets any implementor extend the interface with additional &#x2F; non-standard methods (and clangd did exactly that[2])<p>It might be that the not-widely-popular ocaml&#x27;s LSP support is not there yet. Probably it&#x27;s an open source project, so you can help with the implementation, or at least vote for missing features to be implemented.<p>[1]: <a href="https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifications&#x2F;lsp&#x2F;3.17&#x2F;specification&#x2F;#textDocument_hover" rel="nofollow noreferrer">https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;specifi...</a><p>[2]: <a href="https:&#x2F;&#x2F;clangd.llvm.org&#x2F;extensions" rel="nofollow noreferrer">https:&#x2F;&#x2F;clangd.llvm.org&#x2F;extensions</a></div><br/><div id="37854798" class="c"><input type="checkbox" id="c-37854798" checked=""/><div class="controls bullet"><span class="by">matklad</span><span>|</span><a href="#37854001">root</a><span>|</span><a href="#37854260">parent</a><span>|</span><a href="#37854128">next</a><span>|</span><label class="collapse" for="c-37854798">[-]</label><label class="expand" for="c-37854798">[1 more]</label></div><br/><div class="children"><div class="content">Agree this is not a problem. rust-analyzer also includes a boatload of custom extensions. Here&#x27;s how &quot;query type of the selected expression&quot; works, for example:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust-analyzer&#x2F;blob&#x2F;master&#x2F;docs&#x2F;dev&#x2F;lsp-extensions.md#hover-range">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust-analyzer&#x2F;blob&#x2F;master&#x2F;docs&#x2F;...</a></div><br/></div></div></div></div><div id="37854128" class="c"><input type="checkbox" id="c-37854128" checked=""/><div class="controls bullet"><span class="by">runeks</span><span>|</span><a href="#37854001">parent</a><span>|</span><a href="#37854260">prev</a><span>|</span><a href="#37854684">next</a><span>|</span><label class="collapse" for="c-37854128">[-]</label><label class="expand" for="c-37854128">[1 more]</label></div><br/><div class="children"><div class="content">Hovering over the name of a variable in Haskell shows the type. It sounds like your OCaml LSP server just hasn&#x27;t implemented this yet.</div><br/></div></div><div id="37854684" class="c"><input type="checkbox" id="c-37854684" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#37854001">parent</a><span>|</span><a href="#37854128">prev</a><span>|</span><a href="#37854067">next</a><span>|</span><label class="collapse" for="c-37854684">[-]</label><label class="expand" for="c-37854684">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t get those features because the OCaml LSP doesn&#x27;t implement it.<p>Works fine in other LSPs.</div><br/></div></div><div id="37854067" class="c"><input type="checkbox" id="c-37854067" checked=""/><div class="controls bullet"><span class="by">pxc</span><span>|</span><a href="#37854001">parent</a><span>|</span><a href="#37854684">prev</a><span>|</span><a href="#37854020">next</a><span>|</span><label class="collapse" for="c-37854067">[-]</label><label class="expand" for="c-37854067">[1 more]</label></div><br/><div class="children"><div class="content">Wait, does that feature mean what is sounds like? That sounds too basic to be fundamentally beyond LSP.</div><br/></div></div></div></div><div id="37853553" class="c"><input type="checkbox" id="c-37853553" checked=""/><div class="controls bullet"><span class="by">oaiey</span><span>|</span><a href="#37854001">prev</a><span>|</span><a href="#37853340">next</a><span>|</span><label class="collapse" for="c-37853553">[-]</label><label class="expand" for="c-37853553">[1 more]</label></div><br/><div class="children"><div class="content">I do not follow the argumentation. LSPs are created for text editors. They are focused on lightweight text editor presentation. If you want to expose AST, you either start implementing clients again (defeating the original purpose) or you start being 3-7 levels down the abstraction madness. You can do that and projecting ASTs instead of representing text (looking at you JetBrains MPS) but even the best IDE companies in the world has abondon that in favor of being text based.<p>With that LSP would not solve the n x m problem of editors to languages but would require all text editors to reinvent themselves into something completely different.</div><br/></div></div><div id="37853340" class="c"><input type="checkbox" id="c-37853340" checked=""/><div class="controls bullet"><span class="by">duped</span><span>|</span><a href="#37853553">prev</a><span>|</span><a href="#37853339">next</a><span>|</span><label class="collapse" for="c-37853340">[-]</label><label class="expand" for="c-37853340">[1 more]</label></div><br/><div class="children"><div class="content">I feel like the RPC protocol (minus a good text representation) that LSP needs is ONC RPC. It&#x27;s ancient, to be sure, but it is stupid simple to implement either with a ton of boilerplate or with a compiler to generate the structs and serializers&#x2F;deserializers for you.</div><br/></div></div><div id="37853339" class="c"><input type="checkbox" id="c-37853339" checked=""/><div class="controls bullet"><span class="by">dom2</span><span>|</span><a href="#37853340">prev</a><span>|</span><a href="#37853557">next</a><span>|</span><label class="collapse" for="c-37853339">[-]</label><label class="expand" for="c-37853339">[4 more]</label></div><br/><div class="children"><div class="content">One thing that has annoyed me with some personal implementation work is why does DAP use a cosmetically similar but not following spec version of JSONRPC? Why not just use JSONRPC especially considering LSP already does?</div><br/><div id="37853346" class="c"><input type="checkbox" id="c-37853346" checked=""/><div class="controls bullet"><span class="by">duped</span><span>|</span><a href="#37853339">parent</a><span>|</span><a href="#37853348">next</a><span>|</span><label class="collapse" for="c-37853346">[-]</label><label class="expand" for="c-37853346">[2 more]</label></div><br/><div class="children"><div class="content">Because of organizational disorganization within the VS Code development teams. LSP and DAP are basically the VSCode APIs for implementing language support and debuggers but bolted onto an RPC layer without synchronization or consistency between the people&#x2F;teams that develop them.</div><br/><div id="37854316" class="c"><input type="checkbox" id="c-37854316" checked=""/><div class="controls bullet"><span class="by">sakras</span><span>|</span><a href="#37853339">root</a><span>|</span><a href="#37853346">parent</a><span>|</span><a href="#37853348">next</a><span>|</span><label class="collapse" for="c-37854316">[-]</label><label class="expand" for="c-37854316">[1 more]</label></div><br/><div class="children"><div class="content">Conway’s law at its finest!</div><br/></div></div></div></div><div id="37853348" class="c"><input type="checkbox" id="c-37853348" checked=""/><div class="controls bullet"><span class="by">schemescape</span><span>|</span><a href="#37853339">parent</a><span>|</span><a href="#37853346">prev</a><span>|</span><a href="#37853557">next</a><span>|</span><label class="collapse" for="c-37853348">[-]</label><label class="expand" for="c-37853348">[1 more]</label></div><br/><div class="children"><div class="content">I would assume DAP predates (and possibly motivated) JSONRPC (edit: so it might have been working off of a draft spec). Hopefully someone knowledgeable can comment.</div><br/></div></div></div></div><div id="37853557" class="c"><input type="checkbox" id="c-37853557" checked=""/><div class="controls bullet"><span class="by">Ozzie_osman</span><span>|</span><a href="#37853339">prev</a><span>|</span><a href="#37853295">next</a><span>|</span><label class="collapse" for="c-37853557">[-]</label><label class="expand" for="c-37853557">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve read a bunch of articles about LSP, and some of the docs, but still not entirely sure what it is. I mean, abstractly I understand, but to truly understand what it&#x27;s capable of doing and when I might need to use it... Does anyone have any good pointers?</div><br/><div id="37853656" class="c"><input type="checkbox" id="c-37853656" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#37853557">parent</a><span>|</span><a href="#37853588">next</a><span>|</span><label class="collapse" for="c-37853656">[-]</label><label class="expand" for="c-37853656">[1 more]</label></div><br/><div class="children"><div class="content">LSP stands for Language Server Protocol.  It&#x27;s a communication protocol between the clients (text editors, debuggers, source viewers, etc) and the language servers.<p>Typically a language compiler runs over the source files and terminates once it&#x27;s done.  All the compilation states are gone.  The language server is the compiler itself running for a long time; its aim is to maintain the compiled states of the source files alongside of the editing session in the editor client.  It&#x27;s ready to answer requests from the editor in regarding the source code.<p>E.g. The editor loads a source file.  It sends a LSP request to the language server saying the file is opened.  The language server would compile the file and maintain its compiled states.  The compilation process might involve other source files as well.  The language server reports any errors or warnings back to the editor.  The editor shows them to the user right the way.<p>The user modifies a function and hits save.  The editor sends a file-changed request to the language server.  It recompiles the file and sends back any errors or warnings.<p>The user places the cursor at a function call and issues the jump-to-definition command.  The editor sends a LSP request to the language server to look up the location of the definition of the function.  The language server has all the compiled states of the source files and knows where the function definition is.  It sends back the target location (file and line number).  The editor can switch to the target file and jump to the line number.<p>LSP defines a whole bunch of these requests and responses (e.g. looking up the type of a variable, definition of a value, auto-completion suggestion of function parameters, etc).  A language server for a language can implement these and suddenly all the clients that talk LSP can utilize the features.</div><br/></div></div><div id="37853588" class="c"><input type="checkbox" id="c-37853588" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853557">parent</a><span>|</span><a href="#37853656">prev</a><span>|</span><a href="#37854019">next</a><span>|</span><label class="collapse" for="c-37853588">[-]</label><label class="expand" for="c-37853588">[1 more]</label></div><br/><div class="children"><div class="content">At a high level, it’s a standard way for an editor to ask another program for information about a source code file: What are the function definitions here? What are the available completions for this text? What errors are there? Can you reformat this in standard way? Where is the thing one line 23, row 41 defined?<p>Instead of every single editor having to understand C and Python and JavaScript and Rust and SQL and Ruby, they only have to know how to talk to a language server using a standard protocol. And if you’re writing a new language, you can make a language server for it, and then every editor that knows how to use LSP can be used to comfortably write code in that new language.<p>The old way is that M editors want to support N languages, someone has to write M times N language parsers. With LSP, they can write N. That’s way less work.</div><br/></div></div><div id="37854019" class="c"><input type="checkbox" id="c-37854019" checked=""/><div class="controls bullet"><span class="by">umanwizard</span><span>|</span><a href="#37853557">parent</a><span>|</span><a href="#37853588">prev</a><span>|</span><a href="#37854202">next</a><span>|</span><label class="collapse" for="c-37854019">[-]</label><label class="expand" for="c-37854019">[1 more]</label></div><br/><div class="children"><div class="content">What do you typically program in?</div><br/></div></div><div id="37854202" class="c"><input type="checkbox" id="c-37854202" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#37853557">parent</a><span>|</span><a href="#37854019">prev</a><span>|</span><a href="#37853295">next</a><span>|</span><label class="collapse" for="c-37854202">[-]</label><label class="expand" for="c-37854202">[1 more]</label></div><br/><div class="children"><div class="content">For a more succinct answer, I use it for three things: jumping to the definition of a symbol, auto completion of symbols and keywords and showing documentation.<p>None of this is new. We&#x27;ve had TAGS tables forever. Certain editors would provide the rest for certain languages in language-specific ways. LSP is just a general solution to the any editor&#x2F;any language problem. It seems to work at least as good and often better than the custom solutions before.</div><br/></div></div></div></div><div id="37853436" class="c"><input type="checkbox" id="c-37853436" checked=""/><div class="controls bullet"><span class="by">bumbledraven</span><span>|</span><a href="#37853295">prev</a><span>|</span><a href="#37853660">next</a><span>|</span><label class="collapse" for="c-37853436">[-]</label><label class="expand" for="c-37853436">[26 more]</label></div><br/><div class="children"><div class="content">Jonathan Blow criticized the performance and complexity of LSP in his talk at DevGAMM 2019 titled &quot;Preventing the Collapse of Civilization&quot; (timestamp 42m26s; <a href="https:&#x2F;&#x2F;youtu.be&#x2F;pW-SOdj4Kkk?t=2546" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;pW-SOdj4Kkk?t=2546</a>):<p>&gt; In the programming language world, there&#x27;s this thing called Language Server Protocol that is pretty much the worst thing I&#x27;ve ever heard of. There are proponents of this all over, building systems for it right now that are going to be living on your computer tomorrow, or maybe even today. As far as I can tell, it&#x27;s basically a more complicated, slower way to do libraries.<p>&gt; Say you&#x27;ve got an editor for some programming language and you want to be able to do stuff that we&#x27;ve been doing for decades already. For example, look up the declaration of an identifier by clicking on it, or have tooltips that say, &quot;What type is this value?&quot; Well, they say the way you should do that is—you know, you have your editor and then it&#x27;s a hassle to make plugins. This is the made-up problem. It&#x27;s a hassle to make plugins for all these different things. So in order to standardize, you&#x27;re going to run a server on your machine. Then your editor talks over a socket to the server, and the server talks back and gives you the answer. This approach has now turned your single program into a distributed system.<p>&gt; The flaw in this whole line of thinking, that none of these people seem to actually think about, is that there&#x27;s nothing special about looking up the location of an identifier in your code. That&#x27;s just an API, like we have all the time for everything. So the obvious next step, if you&#x27;re saying that we should architect our APIs like this, is to do this for other tasks. Now your editor, or whatever program, is going to be talking to multiple of these things. If you ever want to author anything for this, you now have to author and debug components of a distributed system where state is not located in any central place. We all know how fun that is, right?<p>&gt; But of course, libraries are not that simple. Libraries use other libraries. So what happens at that point is you&#x27;re running all these servers on your system, and who knows, some of them are going to go down and have to restart. People are synchronizing with each other—no, this is a disaster. And people are actively building this right now, while we&#x27;re spending all this time overcomplicating stuff that we used to be able to do in 1960.<p>(Transcript produced by asking GPT-4 to clean up the raw output from youtubetranscript.com: <a href="https:&#x2F;&#x2F;chat.openai.com&#x2F;share&#x2F;e1bc0e87-f79e-4958-98e7-b93c1b510a21" rel="nofollow noreferrer">https:&#x2F;&#x2F;chat.openai.com&#x2F;share&#x2F;e1bc0e87-f79e-4958-98e7-b93c1b...</a>)</div><br/><div id="37853591" class="c"><input type="checkbox" id="c-37853591" checked=""/><div class="controls bullet"><span class="by">valcron1000</span><span>|</span><a href="#37853436">parent</a><span>|</span><a href="#37854849">next</a><span>|</span><label class="collapse" for="c-37853591">[-]</label><label class="expand" for="c-37853591">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t care how many credentials Jonathan Blow has, this take is pure bs. &quot;we&#x27;re spending all this time overcomplicating stuff that we used to be able to do in 1960&quot;, yet he takes the time to explain &quot;tricks&quot; on how to rename variables [1], while modern tools (not necessarily LSP) let you fly through the code [2].<p>This is just an &quot;old man rants at cloud&quot; take.<p>1. <a href="https:&#x2F;&#x2F;youtu.be&#x2F;2J-HIh3kXCQ" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;2J-HIh3kXCQ</a><p>2. <a href="https:&#x2F;&#x2F;youtu.be&#x2F;AxxNHKCldzA" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;AxxNHKCldzA</a></div><br/><div id="37854243" class="c"><input type="checkbox" id="c-37854243" checked=""/><div class="controls bullet"><span class="by">alexvitkov</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853591">parent</a><span>|</span><a href="#37854849">next</a><span>|</span><label class="collapse" for="c-37854243">[-]</label><label class="expand" for="c-37854243">[1 more]</label></div><br/><div class="children"><div class="content">The environments we work in shape our biases and what we find good and bad.<p>Game programmers spend their careers writing C++ where, yes, you really need tricks like this to rename the variable, as the language is so fucking insane that ALL tooling gets it wrong - and the consequences of getting it wrong can be disastrous.<p>The most widely used options for C++ are VS&#x27;s IntelliSense and clangd. IntelliSense is utter garbage, I never trust it for renaming things. clangd is better but can still get things wrong if your build process is complicated your compile_commands.json doesn&#x27;t perfectly reflect it.<p>Managed languages have fantastic tooling with perfect context of your project, but they&#x27;re also managed and are not applicable in a lot of environments.</div><br/></div></div></div></div><div id="37854849" class="c"><input type="checkbox" id="c-37854849" checked=""/><div class="controls bullet"><span class="by">matklad</span><span>|</span><a href="#37853436">parent</a><span>|</span><a href="#37853591">prev</a><span>|</span><a href="#37853523">next</a><span>|</span><label class="collapse" for="c-37854849">[-]</label><label class="expand" for="c-37854849">[2 more]</label></div><br/><div class="children"><div class="content">There&#x27;s some truth to this! I <i>strongly</i> encourage to architect language servers as libraries first and foremost, with LSP being a relatively thin layer on top of protocol-agnostic library, and only _one_ of the ways to consume the results of the analysis.<p>At the same time, libraries, sadly, do not actually exist. I can not easily cook up an `.so` and then hook that up with Emacs, Vim, VS Code, and Helix. Moreover, any crash in an `.so` library brings down the whole process, which isn&#x27;t a good idea for an IDE.<p>Maybe several years in the future we get an actually good implementation of libraries (I have high hopes for WebAssembly component model), but until then, text-over-stdio can actually be better in practice for some use-cases!</div><br/><div id="37854890" class="c"><input type="checkbox" id="c-37854890" checked=""/><div class="controls bullet"><span class="by">gpderetta</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37854849">parent</a><span>|</span><a href="#37853523">next</a><span>|</span><label class="collapse" for="c-37854890">[-]</label><label class="expand" for="c-37854890">[1 more]</label></div><br/><div class="children"><div class="content">Yes. LSP is the worst thing in the world. But nothing better exists for this use case, so I&#x27;m glad that LSP was invented and I can enjoy working C++ completion, go-to symbol and other nice IDE niceties in emacs.</div><br/></div></div></div></div><div id="37853523" class="c"><input type="checkbox" id="c-37853523" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853436">parent</a><span>|</span><a href="#37854849">prev</a><span>|</span><a href="#37853744">next</a><span>|</span><label class="collapse" for="c-37853523">[-]</label><label class="expand" for="c-37853523">[18 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t get his point? It basically amounts to &quot;nuh uh, this is just bloat&quot;.<p>&gt;What type is this value?&quot; Well, they say the way you should do that is—you know, you have your editor and then it&#x27;s a hassle to make plugins. This is the made-up problem<p>Ok so it&#x27;s just a made up problem? Like, the &quot;plug in&quot; part or the need for having tooltips&#x2F;completion etc?  If he was referring to the perceived need of a plugin (vs. a more integrated) architecture being just due to a made up problem,  the linked article in this thread shows this is absolutely not the case. I&#x27;m not sure it&#x27;s better to reimplement the same features every time for every single editor?<p>And if he meant that needing IDE features is the made up problem, then I guess... lol
?<p>&gt;People are synchronizing with each other—no, this is a disaster. And people are actively building this right now, while we&#x27;re spending all this time overcomplicating stuff that we used to be able to do in 1960.<p>I get the &quot;old good&quot; aesthetics he always aims for, but come on. Even the most charitable interpretation of this part is ridiculous. Like sure we probably had some IDE features back then, but that&#x27;s not the point of LSP. The point is standardizing said features. And specifically, the interface to access them without knowing anything about the editor or how the code is written.<p>I&#x27;m sure your proprietary custom made computer was able to get or provide code completion from other ultra closed systems in the 1960s. It would&#x27;ve been helpful for him to be more specific about what exactly they were doing back then. Again, the whole point is to not have to reimplement a sort-of-compiler for every editor and whatever quirks it comes with.<p>He is not even doing the regular &quot;YAGNI, it&#x27;s bloat&quot;, it&#x27;s just downright weird and devoid of actual arguments imo. I&#x27;m not even saying he needs to propose a better way to do it, because he doesn&#x27;t even seem to acknowledge the point of language servers</div><br/><div id="37853561" class="c"><input type="checkbox" id="c-37853561" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853523">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853561">[-]</label><label class="expand" for="c-37853561">[10 more]</label></div><br/><div class="children"><div class="content">I agree, and mentioning libraries seems like a non-sequitur to me. It’s handy to be able to integrate a language server written in Lisp with an editor made in Swift, for instance, without coming up with a way to link them as shared libraries. That sounds like a nightmare.</div><br/><div id="37853603" class="c"><input type="checkbox" id="c-37853603" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853561">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853603">[-]</label><label class="expand" for="c-37853603">[9 more]</label></div><br/><div class="children"><div class="content">He is trying to say that LSP should be implemented as a set of libraries (like liblsppython.so). Your editor compiles with these libraries and provide API for plugin authors.<p>It&#x27;s not unreasonable to expect an editor&#x27;s developers to know how to link a native library.</div><br/><div id="37853657" class="c"><input type="checkbox" id="c-37853657" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853603">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853657">[-]</label><label class="expand" for="c-37853657">[8 more]</label></div><br/><div class="children"><div class="content">That’s the part I vehemently disagree with. There are servers written in a whole lot of languages. I’d bet there are Java servers written in Java. How are you going to link that into an editor written in C? What if the server’s written in Python? A shell script (crazy but legal!)? And even if you solve all of those for C, what if you want to write an editor in Swift. Now you have to implement all those shared library linkers again in that language.<p>Oooorrrrr, you could communicate with another process via stdin&#x2F;stdout and call it a day.</div><br/><div id="37853879" class="c"><input type="checkbox" id="c-37853879" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853657">parent</a><span>|</span><a href="#37854149">next</a><span>|</span><label class="collapse" for="c-37853879">[-]</label><label class="expand" for="c-37853879">[1 more]</label></div><br/><div class="children"><div class="content">&gt; There are servers written in a whole lot of languages.<p>I believe his opinion is that there shouldn&#x27;t be LP (since he&#x27;s against to use servers I remove the S from LSP) written in language that can&#x27;t be compiled to xxx.so. We&#x27;re talking about Jonathen Blow after all.<p>It make sense if you view LP as a part of an editor. But in our reality the language servers are often maintained by that specific language&#x27;s community, not the editor devs, so it&#x27;s probably not the best idea to expect them all to be willing to write in low-level language.</div><br/></div></div><div id="37854149" class="c"><input type="checkbox" id="c-37854149" checked=""/><div class="controls bullet"><span class="by">alexvitkov</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853657">parent</a><span>|</span><a href="#37853879">prev</a><span>|</span><a href="#37853690">next</a><span>|</span><label class="collapse" for="c-37854149">[-]</label><label class="expand" for="c-37854149">[1 more]</label></div><br/><div class="children"><div class="content">Frankly, if your language can&#x27;t compile a .so&#x2F;.dll that can interact with the rest of the system in a sane way, use a better language.<p>I used to disagree with Blow on this point, as stdin&#x2F;stdout communication really has the arguable advantage that you can write your Brainfuck LSP in Brainfuck, but I&#x27;ve spent way more time than I find reasonable over the last few years dealing with the consequences of the LSP model - tweaking environment variables, paths, command line arguments for the server, server crashes, mismatches of server version vs the compiler, the client picking the wrong server executable, system-provided language vs downloaded by VS code extension......<p>I&#x27;d rather just drop a dll in Plugins&#x2F; and be done with it.</div><br/></div></div><div id="37853690" class="c"><input type="checkbox" id="c-37853690" checked=""/><div class="controls bullet"><span class="by">marwis</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853657">parent</a><span>|</span><a href="#37854149">prev</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853690">[-]</label><label class="expand" for="c-37853690">[5 more]</label></div><br/><div class="children"><div class="content">Use COM or something like it</div><br/><div id="37853722" class="c"><input type="checkbox" id="c-37853722" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853690">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853722">[-]</label><label class="expand" for="c-37853722">[4 more]</label></div><br/><div class="children"><div class="content">What if you are not on Windows? Or if you want to remotely run the language server?</div><br/><div id="37853755" class="c"><input type="checkbox" id="c-37853755" checked=""/><div class="controls bullet"><span class="by">marwis</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853722">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853755">[-]</label><label class="expand" for="c-37853755">[3 more]</label></div><br/><div class="children"><div class="content">You can implement it (&quot;or something like it&quot;) on any system. In fact there is a plenty of those. Remoting isn&#x27;t impossible either (e.g. DCOM, CORBA, GRPC).</div><br/><div id="37853992" class="c"><input type="checkbox" id="c-37853992" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853755">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37853992">[-]</label><label class="expand" for="c-37853992">[2 more]</label></div><br/><div class="children"><div class="content">Why not just use a server then? Surely that&#x27;s less complicated than implementing or even just using CORBA&#x2F;DCOM?</div><br/><div id="37854408" class="c"><input type="checkbox" id="c-37854408" checked=""/><div class="controls bullet"><span class="by">marwis</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853992">parent</a><span>|</span><a href="#37853648">next</a><span>|</span><label class="collapse" for="c-37854408">[-]</label><label class="expand" for="c-37854408">[1 more]</label></div><br/><div class="children"><div class="content">No it is not (well it might be with antiquated CORBA&#x2F;DCOM stack but these are just examples, something newer like GRPC would be easier, the point is that it&#x27;s solvable).<p>Also the original complaint was about explosion of language combinations and I just pointed the solutions to this are well known.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="37853648" class="c"><input type="checkbox" id="c-37853648" checked=""/><div class="controls bullet"><span class="by">moring</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853523">parent</a><span>|</span><a href="#37853561">prev</a><span>|</span><a href="#37853744">next</a><span>|</span><label class="collapse" for="c-37853648">[-]</label><label class="expand" for="c-37853648">[7 more]</label></div><br/><div class="children"><div class="content">He&#x27;s saying (without saying it) that LSP is another instance of the &quot;microservices everywhere&quot; hype, and bad for the same reasons -- you have a problem, you try to solve it with a distributed system, now you have two problems and one of them is a set of microproblems.<p>I don&#x27;t think he is arguing against a standardized interface to language-specific logic, but arguing for that standard to be a library interface, not a distributed system.</div><br/><div id="37853693" class="c"><input type="checkbox" id="c-37853693" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853648">parent</a><span>|</span><a href="#37854709">next</a><span>|</span><label class="collapse" for="c-37853693">[-]</label><label class="expand" for="c-37853693">[5 more]</label></div><br/><div class="children"><div class="content">He doesn&#x27;t say why a library interface would be better. That&#x27;s why I&#x27;m saying he doesn&#x27;t even address the main point of LSPs, which is that they came in response to have your IDE or editor maybe-kind of plug into some libraries and wish for the best. Just saying that a library interface would be better because it&#x27;s less complex is meaningless, when we obviously have not managed to get anything close to that for the past 40 years.<p>It&#x27;s not super convincing to just dismiss the only solution that seems to have sort of worked by saying that we only had to keep doing it the way that never really worked.<p>I&#x27;m sure the implementation can be a lot better, but he does not provide any argument for why the architecture itself is bad. Sometimes abstractions are actually useful.</div><br/><div id="37853899" class="c"><input type="checkbox" id="c-37853899" checked=""/><div class="controls bullet"><span class="by">jcrites</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853693">parent</a><span>|</span><a href="#37854709">next</a><span>|</span><label class="collapse" for="c-37853899">[-]</label><label class="expand" for="c-37853899">[4 more]</label></div><br/><div class="children"><div class="content">I also think it&#x27;s a bit overblown to call communication with a locally running process a &quot;distributed system&quot;. I mean, that&#x27;s <i>kind of</i> true, but not really any more true than if you were to call having multiple threads in your process a &quot;distributed system&quot;.</div><br/><div id="37854044" class="c"><input type="checkbox" id="c-37854044" checked=""/><div class="controls bullet"><span class="by">moring</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853899">parent</a><span>|</span><a href="#37854063">next</a><span>|</span><label class="collapse" for="c-37854044">[-]</label><label class="expand" for="c-37854044">[2 more]</label></div><br/><div class="children"><div class="content">It introduces _some_ of the failure modes of a distributed system, like unsynchronized &#x2F; inconsistent data, but not all, like network failures. I think he does have a point there -- as a user, I should not have to care whether an IDE talks to a library via its API or to a language server via LSP, but here I am, watching WebStorm to act up and complain that the TS language server crashed.<p>One thing that Blow misses IMHO is to what extent libraries introduce these failure modes _too_: A library can crash as well (and take down the IDE with it), and multiple libraries that deal with the same data can get inconsistent. That&#x27;s actually a problem of quality control, integrating code from multiple third parties, and so on.</div><br/><div id="37854138" class="c"><input type="checkbox" id="c-37854138" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37854044">parent</a><span>|</span><a href="#37854063">next</a><span>|</span><label class="collapse" for="c-37854138">[-]</label><label class="expand" for="c-37854138">[1 more]</label></div><br/><div class="children"><div class="content">Security, too. If I’m editing a .env file with a bunch of passwords in one buffer, or maybe some sensitive data I copied and pasted into an empty text window I’m using for temporary notes, I don’t necessarily want some random code written by some 3rd party running in the same process space. I mean, most of userland is pretty much written by various random people already, but I might trust a language server to tell me that I forgot a semicolon in a shell script without trusting it with the contents of &#x2F;etc&#x2F;shadow.</div><br/></div></div></div></div><div id="37854063" class="c"><input type="checkbox" id="c-37854063" checked=""/><div class="controls bullet"><span class="by">umanwizard</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853899">parent</a><span>|</span><a href="#37854044">prev</a><span>|</span><a href="#37854709">next</a><span>|</span><label class="collapse" for="c-37854063">[-]</label><label class="expand" for="c-37854063">[1 more]</label></div><br/><div class="children"><div class="content">It’s true in the sense that every invocation takes arbitrarily long and can fail, which isn’t really true for normal libraries.</div><br/></div></div></div></div></div></div><div id="37854709" class="c"><input type="checkbox" id="c-37854709" checked=""/><div class="controls bullet"><span class="by">kohlerm</span><span>|</span><a href="#37853436">root</a><span>|</span><a href="#37853648">parent</a><span>|</span><a href="#37853693">prev</a><span>|</span><a href="#37853744">next</a><span>|</span><label class="collapse" for="c-37854709">[-]</label><label class="expand" for="c-37854709">[1 more]</label></div><br/><div class="children"><div class="content">The reason is probably that dependency management gets much easier (or at least can get much easier). E.g. using any module in VSCode that requires native code (sqlite, treesitter etc)  will have to work with that specific version of NodeJs for theat specific Electron version. Also quite a few languages already got implementations of parsers in their native language, porting them over would be a big effort.</div><br/></div></div></div></div></div></div><div id="37853744" class="c"><input type="checkbox" id="c-37853744" checked=""/><div class="controls bullet"><span class="by">blackoil</span><span>|</span><a href="#37853436">parent</a><span>|</span><a href="#37853523">prev</a><span>|</span><a href="#37853709">next</a><span>|</span><label class="collapse" for="c-37853744">[-]</label><label class="expand" for="c-37853744">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like a cultist who people listen because of their need to be angry at someone. Even after cleaning, this is a word soup with little substance.<p>LSPs solves two &quot;made-up&quot; problems. Editor and LSP team can be different and independent. Go teams work on LSP without actively collaborating with VSCode team for feature and release. Second, both can run at different places, it allows for things like devcontainer and Codespace. code is built&#x2F;run on some remote server while IDE is running on local.</div><br/></div></div><div id="37853709" class="c"><input type="checkbox" id="c-37853709" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#37853436">parent</a><span>|</span><a href="#37853744">prev</a><span>|</span><a href="#37853506">next</a><span>|</span><label class="collapse" for="c-37853709">[-]</label><label class="expand" for="c-37853709">[1 more]</label></div><br/><div class="children"><div class="content">He was wrong on this issue.  LSP reduces the MxN problem to Mx1 &lt;-&gt; 1xN, i.e. to M+N.</div><br/></div></div></div></div><div id="37853660" class="c"><input type="checkbox" id="c-37853660" checked=""/><div class="controls bullet"><span class="by">KirillPanov</span><span>|</span><a href="#37853436">prev</a><span>|</span><a href="#37853254">next</a><span>|</span><label class="collapse" for="c-37853660">[-]</label><label class="expand" for="c-37853660">[1 more]</label></div><br/><div class="children"><div class="content">&quot;How&quot; did the word &quot;how&quot; end up in the HN title for this?<p>Spin?</div><br/></div></div><div id="37853254" class="c"><input type="checkbox" id="c-37853254" checked=""/><div class="controls bullet"><span class="by">warble</span><span>|</span><a href="#37853660">prev</a><span>|</span><label class="collapse" for="c-37853254">[-]</label><label class="expand" for="c-37853254">[8 more]</label></div><br/><div class="children"><div class="content">What the hell is LSP?</div><br/><div id="37853257" class="c"><input type="checkbox" id="c-37853257" checked=""/><div class="controls bullet"><span class="by">Brybry</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853263">next</a><span>|</span><label class="collapse" for="c-37853257">[-]</label><label class="expand" for="c-37853257">[1 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;s <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Language_Server_Protocol" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Language_Server_Protocol</a> but those words definitely do not exist in the post</div><br/></div></div><div id="37853263" class="c"><input type="checkbox" id="c-37853263" checked=""/><div class="controls bullet"><span class="by">teraflop</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853257">prev</a><span>|</span><a href="#37853359">next</a><span>|</span><label class="collapse" for="c-37853263">[-]</label><label class="expand" for="c-37853263">[1 more]</label></div><br/><div class="children"><div class="content">If you click the &quot;Why LSP?&quot; link in the first sentence of the article, or type &quot;lsp&quot; into Google, you&#x27;ll get your answer:<p>&gt; The Language Server Protocol (LSP) defines the protocol used between an editor or IDE and a language server that provides language features like auto complete, go to definition, find all references etc.</div><br/></div></div><div id="37853359" class="c"><input type="checkbox" id="c-37853359" checked=""/><div class="controls bullet"><span class="by">reywood</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853263">prev</a><span>|</span><a href="#37853661">next</a><span>|</span><label class="collapse" for="c-37853359">[-]</label><label class="expand" for="c-37853359">[1 more]</label></div><br/><div class="children"><div class="content">My first thought was Liskov Substitution Principle</div><br/></div></div><div id="37853661" class="c"><input type="checkbox" id="c-37853661" checked=""/><div class="controls bullet"><span class="by">moring</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853359">prev</a><span>|</span><a href="#37853261">next</a><span>|</span><label class="collapse" for="c-37853661">[-]</label><label class="expand" for="c-37853661">[1 more]</label></div><br/><div class="children"><div class="content">Why the downvote? It took me quite some reading before I understood it, given that LSP can refer to multiple things. I, too, thought about the Liskov Substitution Principle first.</div><br/></div></div><div id="37853261" class="c"><input type="checkbox" id="c-37853261" checked=""/><div class="controls bullet"><span class="by">duxup</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853661">prev</a><span>|</span><a href="#37853281">next</a><span>|</span><label class="collapse" for="c-37853261">[-]</label><label class="expand" for="c-37853261">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;microsoft.github.io&#x2F;language-server-protocol&#x2F;</a></div><br/></div></div><div id="37853281" class="c"><input type="checkbox" id="c-37853281" checked=""/><div class="controls bullet"><span class="by">everyone</span><span>|</span><a href="#37853254">parent</a><span>|</span><a href="#37853261">prev</a><span>|</span><label class="collapse" for="c-37853281">[-]</label><label class="expand" for="c-37853281">[2 more]</label></div><br/><div class="children"><div class="content">Lumpy Space Princess<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_Adventure_Time_characters#Lumpy_Space_Princess" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_Adventure_Time_charact...</a></div><br/><div id="37854018" class="c"><input type="checkbox" id="c-37854018" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#37853254">root</a><span>|</span><a href="#37853281">parent</a><span>|</span><label class="collapse" for="c-37854018">[-]</label><label class="expand" for="c-37854018">[1 more]</label></div><br/><div class="children"><div class="content">Article title: How Lumpy Space Princess could have been better<p>Article content in full: She couldn’t.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>