<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725613277131" as="style"/><link rel="stylesheet" href="styles.css?v=1725613277131"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/RaisinTen/electron-snapshot-experiment">Speeding up Electron apps by using V8 snapshots in the main process</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>raisin10</span> | <span>28 comments</span></div><br/><div><div id="41462957" class="c"><input type="checkbox" id="c-41462957" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#41464236">next</a><span>|</span><label class="collapse" for="c-41462957">[-]</label><label class="expand" for="c-41462957">[3 more]</label></div><br/><div class="children"><div class="content">What&#x27;s old is new again. Emacs has long done snapshots a bit like this, albeit in a hacky way[1][2]<p>[1]: <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;673724&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;673724&#x2F;</a> (2016)<p>[2]: <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;707615&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;707615&#x2F;</a> (2016) and discussion here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=13073566">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=13073566</a></div><br/><div id="41463901" class="c"><input type="checkbox" id="c-41463901" checked=""/><div class="controls bullet"><span class="by">dig1</span><span>|</span><a href="#41462957">parent</a><span>|</span><a href="#41464236">next</a><span>|</span><label class="collapse" for="c-41463901">[-]</label><label class="expand" for="c-41463901">[2 more]</label></div><br/><div class="children"><div class="content">JVM has a similar thing called appcds (<a href="https:&#x2F;&#x2F;docs.oracle.com&#x2F;en&#x2F;java&#x2F;javase&#x2F;17&#x2F;vm&#x2F;class-data-sharing.html" rel="nofollow">https:&#x2F;&#x2F;docs.oracle.com&#x2F;en&#x2F;java&#x2F;javase&#x2F;17&#x2F;vm&#x2F;class-data-shar...</a>)  since JDK 10 and you can also use Criu (<a href="https:&#x2F;&#x2F;criu.org" rel="nofollow">https:&#x2F;&#x2F;criu.org</a>) for this, at least I used it for some JVM apps before.<p>Don&#x27;t forget that Common Lisp and Smalltak implementations have had this since the beginning of time :D</div><br/><div id="41464162" class="c"><input type="checkbox" id="c-41464162" checked=""/><div class="controls bullet"><span class="by">jmaker</span><span>|</span><a href="#41462957">root</a><span>|</span><a href="#41463901">parent</a><span>|</span><a href="#41464236">next</a><span>|</span><label class="collapse" for="c-41464162">[-]</label><label class="expand" for="c-41464162">[1 more]</label></div><br/><div class="children"><div class="content">There’s also OpenJDK Project CRaC (based on CRIU) and AWS Lambda SnapStart (leveraging CRaC).</div><br/></div></div></div></div></div></div><div id="41464236" class="c"><input type="checkbox" id="c-41464236" checked=""/><div class="controls bullet"><span class="by">Pepe1vo</span><span>|</span><a href="#41462957">prev</a><span>|</span><a href="#41463207">next</a><span>|</span><label class="collapse" for="c-41464236">[-]</label><label class="expand" for="c-41464236">[1 more]</label></div><br/><div class="children"><div class="content">Is there an advantage to doing this versus using something like ncc to just package everything into a single js file with zero dependencies?</div><br/></div></div><div id="41463207" class="c"><input type="checkbox" id="c-41463207" checked=""/><div class="controls bullet"><span class="by">bhawks</span><span>|</span><a href="#41464236">prev</a><span>|</span><a href="#41462696">next</a><span>|</span><label class="collapse" for="c-41463207">[-]</label><label class="expand" for="c-41463207">[2 more]</label></div><br/><div class="children"><div class="content">Android uses a similar approach to launch apps quickly. When you request to start an app the zygote process forks and the child does the work of starting the app. It allows the children to share all the upfront initialization that is done once per boot.</div><br/><div id="41463600" class="c"><input type="checkbox" id="c-41463600" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#41463207">parent</a><span>|</span><a href="#41462696">next</a><span>|</span><label class="collapse" for="c-41463600">[-]</label><label class="expand" for="c-41463600">[1 more]</label></div><br/><div class="children"><div class="content">iOS does this too now.</div><br/></div></div></div></div><div id="41462696" class="c"><input type="checkbox" id="c-41462696" checked=""/><div class="controls bullet"><span class="by">ilrwbwrkhv</span><span>|</span><a href="#41463207">prev</a><span>|</span><a href="#41463230">next</a><span>|</span><label class="collapse" for="c-41462696">[-]</label><label class="expand" for="c-41462696">[9 more]</label></div><br/><div class="children"><div class="content">Will this make slack work fast? That piece of crap even cannot resize efficiently on a Mac m3 pro.</div><br/><div id="41463250" class="c"><input type="checkbox" id="c-41463250" checked=""/><div class="controls bullet"><span class="by">hsbauauvhabzb</span><span>|</span><a href="#41462696">parent</a><span>|</span><a href="#41463431">next</a><span>|</span><label class="collapse" for="c-41463250">[-]</label><label class="expand" for="c-41463250">[4 more]</label></div><br/><div class="children"><div class="content">I see electron get a lot of hate, and don’t get me wrong, I empathise with your issue, but has anyone ever documented an analysis on whether these sorts of things are caused by electron itself, or just bad application logic which just happens to be running under electron?</div><br/><div id="41463471" class="c"><input type="checkbox" id="c-41463471" checked=""/><div class="controls bullet"><span class="by">tomphoolery</span><span>|</span><a href="#41462696">root</a><span>|</span><a href="#41463250">parent</a><span>|</span><a href="#41463875">next</a><span>|</span><label class="collapse" for="c-41463471">[-]</label><label class="expand" for="c-41463471">[1 more]</label></div><br/><div class="children"><div class="content">As someone who&#x27;s made a few Electron apps in the past, I can say that it has a lot more to do with what you&#x27;re putting into the app itself than the runtime shell you&#x27;re working with. It&#x27;s not impossible to make an Electron app that&#x27;s very efficient, to the point where people probably wouldn&#x27;t realize it uses Electron unless they opened the app itself and poked through the source code. That said, due to Electron being a layer above the actual application stuff that&#x27;s doing the &quot;real&quot; work, it&#x27;s a lot harder to sniff out performance problems and especially to reproduce them on all platforms. So I wouldn&#x27;t call this &quot;bad application logic&quot;, I would say that it probably has more to do with using older (and deprecated) APIs to handle certain things like resizing the window, which could be replaced with better ones if the devs at Slack were able to easily see that this was causing problems for people. Unfortunately, Electron does make that a bit harder to do.<p>Basically...I&#x27;d say this has more to do with the fact that Slack&#x27;s development team doesn&#x27;t get enough control over their applications in order to make things like this happen faster.</div><br/></div></div><div id="41463875" class="c"><input type="checkbox" id="c-41463875" checked=""/><div class="controls bullet"><span class="by">jiehong</span><span>|</span><a href="#41462696">root</a><span>|</span><a href="#41463250">parent</a><span>|</span><a href="#41463471">prev</a><span>|</span><a href="#41463407">next</a><span>|</span><label class="collapse" for="c-41463875">[-]</label><label class="expand" for="c-41463875">[1 more]</label></div><br/><div class="children"><div class="content">Maybe it&#x27;s just not a &#x27;pit of performance&#x27;.<p>What I mean is: perhaps the path of least resistance (and thus the cheaper way) does not lead to good performance by default.<p>If only platforms and frameworks would make the fast way easy, and the slow way hard, it would be simpler to have faster software (not that it&#x27;s easy to do).<p>Now, if only all programs had performance tests on all commits (like browsers use speedometer 3, and track the trend over time, because they know it matters to users).</div><br/></div></div><div id="41463407" class="c"><input type="checkbox" id="c-41463407" checked=""/><div class="controls bullet"><span class="by">eric-hu</span><span>|</span><a href="#41462696">root</a><span>|</span><a href="#41463250">parent</a><span>|</span><a href="#41463875">prev</a><span>|</span><a href="#41463431">next</a><span>|</span><label class="collapse" for="c-41463407">[-]</label><label class="expand" for="c-41463407">[1 more]</label></div><br/><div class="children"><div class="content">After using VS Code for a while coming from vim, I’m inclined to say it’s bad application programming.</div><br/></div></div></div></div><div id="41463431" class="c"><input type="checkbox" id="c-41463431" checked=""/><div class="controls bullet"><span class="by">guappa</span><span>|</span><a href="#41462696">parent</a><span>|</span><a href="#41463250">prev</a><span>|</span><a href="#41462724">next</a><span>|</span><label class="collapse" for="c-41463431">[-]</label><label class="expand" for="c-41463431">[1 more]</label></div><br/><div class="children"><div class="content">I use localslackirc at work, so I don&#x27;t get overwhelmed. But it&#x27;s certainly not for everyone. I&#x27;m the only one in my company who uses it (AFAIK).</div><br/></div></div><div id="41462724" class="c"><input type="checkbox" id="c-41462724" checked=""/><div class="controls bullet"><span class="by">onedognight</span><span>|</span><a href="#41462696">parent</a><span>|</span><a href="#41463431">prev</a><span>|</span><a href="#41463230">next</a><span>|</span><label class="collapse" for="c-41462724">[-]</label><label class="expand" for="c-41462724">[3 more]</label></div><br/><div class="children"><div class="content">Slack is just a website you can open in a tab&#x2F;window.  You don’t need to add Electron your browser diet to use it.</div><br/><div id="41462836" class="c"><input type="checkbox" id="c-41462836" checked=""/><div class="controls bullet"><span class="by">samtheprogram</span><span>|</span><a href="#41462696">root</a><span>|</span><a href="#41462724">parent</a><span>|</span><a href="#41463230">next</a><span>|</span><label class="collapse" for="c-41462836">[-]</label><label class="expand" for="c-41462836">[2 more]</label></div><br/><div class="children"><div class="content">It’s desktop app that’s built on Electron.<p>Although, yes, when I’m on resourced constrained machines, I open it in a Firefox tab.</div><br/><div id="41463461" class="c"><input type="checkbox" id="c-41463461" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#41462696">root</a><span>|</span><a href="#41462836">parent</a><span>|</span><a href="#41463230">next</a><span>|</span><label class="collapse" for="c-41463461">[-]</label><label class="expand" for="c-41463461">[1 more]</label></div><br/><div class="children"><div class="content">I run Slack in a Firefox window, and I had to add an extension to reload the page every 15 minutes due to live leaks.<p>Would cause FF to eat tens of GB, making FF sluggish until it crashed...</div><br/></div></div></div></div></div></div></div></div><div id="41463230" class="c"><input type="checkbox" id="c-41463230" checked=""/><div class="controls bullet"><span class="by">Scarlxd</span><span>|</span><a href="#41462696">prev</a><span>|</span><a href="#41463416">next</a><span>|</span><label class="collapse" for="c-41463230">[-]</label><label class="expand" for="c-41463230">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, this really helps! We are planning to improve the performance of our Electron app.</div><br/></div></div><div id="41463416" class="c"><input type="checkbox" id="c-41463416" checked=""/><div class="controls bullet"><span class="by">tomphoolery</span><span>|</span><a href="#41463230">prev</a><span>|</span><a href="#41463400">next</a><span>|</span><label class="collapse" for="c-41463416">[-]</label><label class="expand" for="c-41463416">[4 more]</label></div><br/><div class="children"><div class="content">can we do this for react native? asking for a friend...</div><br/><div id="41463873" class="c"><input type="checkbox" id="c-41463873" checked=""/><div class="controls bullet"><span class="by">whizzter</span><span>|</span><a href="#41463416">parent</a><span>|</span><a href="#41463621">next</a><span>|</span><label class="collapse" for="c-41463873">[-]</label><label class="expand" for="c-41463873">[1 more]</label></div><br/><div class="children"><div class="content">Not the same runtime, but iirc parsing,etc is done at an earlier stage in Hermes&#x2F;RN so some parts of the initialization process is already done in that way if I&#x27;m not mistaken.</div><br/></div></div><div id="41463621" class="c"><input type="checkbox" id="c-41463621" checked=""/><div class="controls bullet"><span class="by">traspler</span><span>|</span><a href="#41463416">parent</a><span>|</span><a href="#41463873">prev</a><span>|</span><a href="#41463400">next</a><span>|</span><label class="collapse" for="c-41463621">[-]</label><label class="expand" for="c-41463621">[2 more]</label></div><br/><div class="children"><div class="content">Isn‘t that kind of the idea of Hermes?</div><br/><div id="41463879" class="c"><input type="checkbox" id="c-41463879" checked=""/><div class="controls bullet"><span class="by">whizzter</span><span>|</span><a href="#41463416">root</a><span>|</span><a href="#41463621">parent</a><span>|</span><a href="#41463400">next</a><span>|</span><label class="collapse" for="c-41463879">[-]</label><label class="expand" for="c-41463879">[1 more]</label></div><br/><div class="children"><div class="content">I think all the sources are pre-parsed and compiled but it&#x27;s not an outright snapshot as in nothing is executed ahead of time.</div><br/></div></div></div></div></div></div><div id="41463400" class="c"><input type="checkbox" id="c-41463400" checked=""/><div class="controls bullet"><span class="by">xenospn</span><span>|</span><a href="#41463416">prev</a><span>|</span><a href="#41462632">next</a><span>|</span><label class="collapse" for="c-41463400">[-]</label><label class="expand" for="c-41463400">[5 more]</label></div><br/><div class="children"><div class="content">Hopefully this applies to VSCode as well. I try to avoid Electron apps at all costs, but sometimes there&#x27;s no other choice.</div><br/><div id="41463425" class="c"><input type="checkbox" id="c-41463425" checked=""/><div class="controls bullet"><span class="by">eknkc</span><span>|</span><a href="#41463400">parent</a><span>|</span><a href="#41463806">next</a><span>|</span><label class="collapse" for="c-41463425">[-]</label><label class="expand" for="c-41463425">[3 more]</label></div><br/><div class="children"><div class="content">VsCode surprises me to be honest. Besides slow starts, it does not seem to be suffering from any major slowdown for me. I’d expect that thing to get bloated pretty far, really fast.</div><br/><div id="41464209" class="c"><input type="checkbox" id="c-41464209" checked=""/><div class="controls bullet"><span class="by">gardaani</span><span>|</span><a href="#41463400">root</a><span>|</span><a href="#41463425">parent</a><span>|</span><a href="#41463806">next</a><span>|</span><label class="collapse" for="c-41464209">[-]</label><label class="expand" for="c-41464209">[2 more]</label></div><br/><div class="children"><div class="content">VS Code does become slower for me on my MacBook M1. I typically don&#x27;t restart the app unless I have to. After few days of usage, scrolling the code area becomes so slow (&lt;20fps) that I have to restart the app. I haven&#x27;t experienced such slowdown in other IDEs, such as Xcode or Qt Creator.</div><br/><div id="41464220" class="c"><input type="checkbox" id="c-41464220" checked=""/><div class="controls bullet"><span class="by">xenospn</span><span>|</span><a href="#41463400">root</a><span>|</span><a href="#41464209">parent</a><span>|</span><a href="#41463806">next</a><span>|</span><label class="collapse" for="c-41464220">[-]</label><label class="expand" for="c-41464220">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if there are any other native IDEs with the same level of functionality. I feel like electron is forcing me to compromise on performance in exchange for features.</div><br/></div></div></div></div></div></div><div id="41463806" class="c"><input type="checkbox" id="c-41463806" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#41463400">parent</a><span>|</span><a href="#41463425">prev</a><span>|</span><a href="#41462632">next</a><span>|</span><label class="collapse" for="c-41463806">[-]</label><label class="expand" for="c-41463806">[1 more]</label></div><br/><div class="children"><div class="content">Do you actually care about the vscode startup time? That&#x27;s the only part that&#x27;s really improved here. I restart my IDE basically once every update, so that time barely registers.</div><br/></div></div></div></div><div id="41462632" class="c"><input type="checkbox" id="c-41462632" checked=""/><div class="controls bullet"><span class="by">jauntywundrkind</span><span>|</span><a href="#41463400">prev</a><span>|</span><label class="collapse" for="c-41462632">[-]</label><label class="expand" for="c-41462632">[2 more]</label></div><br/><div class="children"><div class="content">There&#x27;s so so much goodness available from tapping vm&#x27;s as such, as virtual machines that we might do cool checkpoint&#x2F;restore off on.<p>Java has had some similar abilities to rebuild the pre-compiled stdlib with whatever else you want already included. So, each Java instance both boots faster &amp; has less overhead. Forgetting the name though! Node has options too! <a href="https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#--build-snapshot" rel="nofollow">https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#--build-snapshot</a></div><br/><div id="41463741" class="c"><input type="checkbox" id="c-41463741" checked=""/><div class="controls bullet"><span class="by">Skinney</span><span>|</span><a href="#41462632">parent</a><span>|</span><label class="collapse" for="c-41463741">[-]</label><label class="expand" for="c-41463741">[1 more]</label></div><br/><div class="children"><div class="content">Problem with Node is that the snapshot functionality has several severe limitations.<p>Copy pasted from NodeJS docs:<p>---<p>Currently the support for run-time snapshot is experimental in that:<p>1. User-land modules are not yet supported in the snapshot, so only one single file can be snapshotted. Users can bundle their applications into a single script with their bundler of choice before building a snapshot, however.<p>2. Only a subset of the built-in modules work in the snapshot, though the Node.js core test suite checks that a few fairly complex applications can be snapshotted. Support for more modules are being added. If any crashes or buggy behaviors occur when building a snapshot, please file a report in the Node.js issue tracker and link to it in the tracking issue for user-land snapshots.<p>---<p>(1) is fine as you can use a bundler to work around it. (2) can&#x27;t, as far as I know, be worked around.</div><br/></div></div></div></div></div></div></div></div></div></body></html>