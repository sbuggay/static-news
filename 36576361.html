<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1688461260284" as="style"/><link rel="stylesheet" href="styles.css?v=1688461260284"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://conduition.io/cryptography/schnorr/">A Dive into the Math Behind Bitcoin Schnorr Signatures</a> <span class="domain">(<a href="https://conduition.io">conduition.io</a>)</span></div><div class="subtext"><span>janandonly</span> | <span>10 comments</span></div><br/><div><div id="36580394" class="c"><input type="checkbox" id="c-36580394" checked=""/><div class="controls bullet"><span class="by">gwillen</span><span>|</span><a href="#36579378">next</a><span>|</span><label class="collapse" for="c-36580394">[-]</label><label class="expand" for="c-36580394">[2 more]</label></div><br/><div class="children"><div class="content">As I understand it, Schnorr signatures are the &quot;natural&quot; (and simplest) construction for a digital signature in elliptic curve cryptography. The reason ECDSA exists is simply <a href="https:&#x2F;&#x2F;patents.google.com&#x2F;patent&#x2F;US4995082" rel="nofollow noreferrer">https:&#x2F;&#x2F;patents.google.com&#x2F;patent&#x2F;US4995082</a> (now expired), which made Schnorr illegal to use, so something worse had to be invented.</div><br/><div id="36582834" class="c"><input type="checkbox" id="c-36582834" checked=""/><div class="controls bullet"><span class="by">KirillPanov</span><span>|</span><a href="#36580394">parent</a><span>|</span><a href="#36579378">next</a><span>|</span><label class="collapse" for="c-36582834">[-]</label><label class="expand" for="c-36582834">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The reason ECDSA exists is simply <a href="https:&#x2F;&#x2F;patents.google.com&#x2F;patent&#x2F;US4995082" rel="nofollow noreferrer">https:&#x2F;&#x2F;patents.google.com&#x2F;patent&#x2F;US4995082</a> (now expired),<p>Sort of.<p>Schnorr signatures have a &quot;linearity&quot; property -- if you add together two signatures you get a valid signature of the same text using the sum of the keys.<p>Sometimes you don&#x27;t want people to be able to obtain signatures-with-the-sum-of-the-keys, or you don&#x27;t want to enable bulk key-cracking via the same techniques that allow bulk validation.<p>Also, confusingly, &quot;EdDSA&quot; signatures (aka ed25519 signatures) <i>are</i> Schnorr signatures:<p><a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8032#section-1" rel="nofollow noreferrer">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc8032#section-1</a><p>... however EdDSA:<p>1. Uses hashing instead of either multiplicative inverse (slow) or a source of randomness (footgun) for the nonce.<p>2. Hashes the public key into the signature in order to deliberately break linearity.  Signatures with different keys will use different hashes, and hashing isn&#x27;t linear, so adding the signatures no longer yields anything useful.  The signature verifier checks this (they can, since they have your <i>public</i> key), so a defective implementation can&#x27;t skip this step without producing bogus signatures.</div><br/></div></div></div></div><div id="36579378" class="c"><input type="checkbox" id="c-36579378" checked=""/><div class="controls bullet"><span class="by">_nhynes</span><span>|</span><a href="#36580394">prev</a><span>|</span><a href="#36579295">next</a><span>|</span><label class="collapse" for="c-36579378">[-]</label><label class="expand" for="c-36579378">[3 more]</label></div><br/><div class="children"><div class="content">I was searching for implementations to get a more concrete idea of the algorithm and came across <a href="https:&#x2F;&#x2F;github.com&#x2F;Yawning&#x2F;secp256k1-voi">https:&#x2F;&#x2F;github.com&#x2F;Yawning&#x2F;secp256k1-voi</a> which appears to be well commented, robust, and oddly entertaining. It’s got Schnorr, and ECDSA for comparison.<p>There’s also a musig2 one by the same author.</div><br/><div id="36580737" class="c"><input type="checkbox" id="c-36580737" checked=""/><div class="controls bullet"><span class="by">adastra22</span><span>|</span><a href="#36579378">parent</a><span>|</span><a href="#36580208">next</a><span>|</span><label class="collapse" for="c-36580737">[-]</label><label class="expand" for="c-36580737">[1 more]</label></div><br/><div class="children"><div class="content">&gt; No, this has not been audited. Fuck you, pay me.<p>Lol. Nice.</div><br/></div></div><div id="36580208" class="c"><input type="checkbox" id="c-36580208" checked=""/><div class="controls bullet"><span class="by">drexlspivey</span><span>|</span><a href="#36579378">parent</a><span>|</span><a href="#36580737">prev</a><span>|</span><a href="#36579295">next</a><span>|</span><label class="collapse" for="c-36580208">[-]</label><label class="expand" for="c-36580208">[1 more]</label></div><br/><div class="children"><div class="content">Reference python implementation straight from the BIP <a href="https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;blob&#x2F;master&#x2F;bip-0340&#x2F;reference.py">https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;blob&#x2F;master&#x2F;bip-0340&#x2F;referen...</a></div><br/></div></div></div></div><div id="36579295" class="c"><input type="checkbox" id="c-36579295" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#36579378">prev</a><span>|</span><a href="#36579115">next</a><span>|</span><label class="collapse" for="c-36579295">[-]</label><label class="expand" for="c-36579295">[3 more]</label></div><br/><div class="children"><div class="content">The most widely-used (but not widely-known) application of Schnorr signatures may be in Microsoft&#x27;s product keys. Of course they used a much smaller private key than we&#x27;d think is normal today, and as a result, I believe it&#x27;s been cracked for everything up to ~XP.</div><br/><div id="36580237" class="c"><input type="checkbox" id="c-36580237" checked=""/><div class="controls bullet"><span class="by">wslh</span><span>|</span><a href="#36579295">parent</a><span>|</span><a href="#36579115">next</a><span>|</span><label class="collapse" for="c-36580237">[-]</label><label class="expand" for="c-36580237">[2 more]</label></div><br/><div class="children"><div class="content">Do you have any source for that? Another alternative to generate livense keys is via Feistel Networks or just random generation.</div><br/><div id="36580829" class="c"><input type="checkbox" id="c-36580829" checked=""/><div class="controls bullet"><span class="by">nyolfen</span><span>|</span><a href="#36579295">root</a><span>|</span><a href="#36580237">parent</a><span>|</span><a href="#36579115">next</a><span>|</span><label class="collapse" for="c-36580829">[-]</label><label class="expand" for="c-36580829">[1 more]</label></div><br/><div class="children"><div class="content">this went around recently <a href="https:&#x2F;&#x2F;www.theregister.com&#x2F;2023&#x2F;05&#x2F;26&#x2F;windows_xp_activation_keygen&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.theregister.com&#x2F;2023&#x2F;05&#x2F;26&#x2F;windows_xp_activation...</a></div><br/></div></div></div></div></div></div><div id="36579115" class="c"><input type="checkbox" id="c-36579115" checked=""/><div class="controls bullet"><span class="by">ForHackernews</span><span>|</span><a href="#36579295">prev</a><span>|</span><label class="collapse" for="c-36579115">[-]</label><label class="expand" for="c-36579115">[1 more]</label></div><br/><div class="children"><div class="content">Are they still trying to make fetch happen?</div><br/></div></div></div></div></div></div></div></body></html>