<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1734166872139" as="style"/><link rel="stylesheet" href="styles.css?v=1734166872139"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.npmjs.com/package/@smoores/epub">Show HN: @smoores/epub, a JavaScript library for working with EPUB publications</a> <span class="domain">(<a href="https://www.npmjs.com">www.npmjs.com</a>)</span></div><div class="subtext"><span>smoores</span> | <span>42 comments</span></div><br/><div><div id="42413423" class="c"><input type="checkbox" id="c-42413423" checked=""/><div class="controls bullet"><span class="by">antonyt</span><span>|</span><a href="#42411872">next</a><span>|</span><label class="collapse" for="c-42413423">[-]</label><label class="expand" for="c-42413423">[5 more]</label></div><br/><div class="children"><div class="content">I feel stupid. I read “automatically syncing ebooks and audiobooks” and thought StoryTeller was a file synchronization service (like SyncThing) that for some reason only supported certain file types.<p>Maybe “syncing ebooks with audiobooks” would be clearer? Also entirely possible this is just a me problem, not a general one.<p>Really cool project!</div><br/><div id="42414159" class="c"><input type="checkbox" id="c-42414159" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42413423">parent</a><span>|</span><a href="#42413844">next</a><span>|</span><label class="collapse" for="c-42414159">[-]</label><label class="expand" for="c-42414159">[3 more]</label></div><br/><div class="children"><div class="content">This is like... comically hard to express succinctly haha. We&#x27;ve been having several conversations about how to explain it quickly to new folks. I like the phrase that the Readium folks use, &quot;guided narration&quot;, but I don&#x27;t know how useful that is for folks that aren&#x27;t already familiar with what Storyteller does</div><br/><div id="42414492" class="c"><input type="checkbox" id="c-42414492" checked=""/><div class="controls bullet"><span class="by">rahimnathwani</span><span>|</span><a href="#42413423">root</a><span>|</span><a href="#42414159">parent</a><span>|</span><a href="#42414279">next</a><span>|</span><label class="collapse" for="c-42414492">[-]</label><label class="expand" for="c-42414492">[1 more]</label></div><br/><div class="children"><div class="content">Maybe you can use examples of the &#x27;why&#x27;?<p>- Switch between reading and listening whenever you want<p>- Follow the text while listening to audiobooks<p>- Enjoy audiobooks while reading along with the text<p>Or even simpler:<p>- Read or listen - switch anytime<p>- See the words as you listen<p>- Listen while you read along</div><br/></div></div><div id="42414279" class="c"><input type="checkbox" id="c-42414279" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#42413423">root</a><span>|</span><a href="#42414159">parent</a><span>|</span><a href="#42414492">prev</a><span>|</span><a href="#42413844">next</a><span>|</span><label class="collapse" for="c-42414279">[-]</label><label class="expand" for="c-42414279">[1 more]</label></div><br/><div class="children"><div class="content">“Aligning” seems a perfectly good word to me. It’s the technical term that gets used, and it’s not <i>particularly</i> overloaded so people aren’t going to expect it to mean something else, and it’s easy to demonstrate even pictorially.<p>(I would also use the term “synchronising” rather than “syncing”, because “syncing” has kinda developed a meaning of its own, even though it came from the same place. And use the word “with”, and try to use the words “text”. “Synchronising ebook text with audiobooks” is <i>way</i> better than “syncing ebooks and audiobooks”.)</div><br/></div></div></div></div><div id="42413844" class="c"><input type="checkbox" id="c-42413844" checked=""/><div class="controls bullet"><span class="by">trevor-e</span><span>|</span><a href="#42413423">parent</a><span>|</span><a href="#42414159">prev</a><span>|</span><a href="#42411872">next</a><span>|</span><label class="collapse" for="c-42413844">[-]</label><label class="expand" for="c-42413844">[1 more]</label></div><br/><div class="children"><div class="content">I thought the exact same thing, especially since one of the main selling points is around self-hosting which I thought was for the file syncing.</div><br/></div></div></div></div><div id="42411872" class="c"><input type="checkbox" id="c-42411872" checked=""/><div class="controls bullet"><span class="by">hombre_fatal</span><span>|</span><a href="#42413423">prev</a><span>|</span><a href="#42412611">next</a><span>|</span><label class="collapse" for="c-42411872">[-]</label><label class="expand" for="c-42411872">[3 more]</label></div><br/><div class="children"><div class="content">Extracting a library from a real world project is one of my favorite parts of software.<p>I&#x27;m sure the march of LLMs will continue eating into this pie, and that&#x27;s a good thing (most of it is a distraction from the real work), but I love polishing a library on my laptop in a cafe. It&#x27;s like working on a painting or something.</div><br/><div id="42412510" class="c"><input type="checkbox" id="c-42412510" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411872">parent</a><span>|</span><a href="#42412342">next</a><span>|</span><label class="collapse" for="c-42412510">[-]</label><label class="expand" for="c-42412510">[1 more]</label></div><br/><div class="children"><div class="content">It was, actually, very enjoyable! When we pulled React ProseMirror[1] out of the NYT text editor, it was a pretty laborious process that we had to careful plan and execute for months, and we still ended up with an internal fork for a while.<p>By contrast, this was mostly just moving a file around and then writing documentation and cleaning up the public API. I rather enjoy thinking about and modeling library APIs in general, so I actually had a lot of fun with it!<p>[1]: <a href="https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;@nytimes&#x2F;react-prosemirror" rel="nofollow">https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;@nytimes&#x2F;react-prosemirror</a></div><br/></div></div></div></div><div id="42411873" class="c"><input type="checkbox" id="c-42411873" checked=""/><div class="controls bullet"><span class="by">gavmor</span><span>|</span><a href="#42412611">prev</a><span>|</span><a href="#42412436">next</a><span>|</span><label class="collapse" for="c-42411873">[-]</label><label class="expand" for="c-42411873">[2 more]</label></div><br/><div class="children"><div class="content">Cool! I totally could have used this earlier this year... can&#x27;t remember what for...<p>Interesting choice to publish from the storyteller &quot;monorepo.&quot; Is that because it evolved in situ, and you&#x27;ve no impetus to incur the overhead of extraction?</div><br/><div id="42411985" class="c"><input type="checkbox" id="c-42411985" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411873">parent</a><span>|</span><a href="#42412436">next</a><span>|</span><label class="collapse" for="c-42411985">[-]</label><label class="expand" for="c-42411985">[1 more]</label></div><br/><div class="children"><div class="content">Hahaha, well if it comes to you, the library will still be there for you :)<p>Right, this was actually just a file within the Storyteller web package to start. It was fairly well defined, and so pretty easy to pull out into another package in the monorepo, but Storyteller is the primary consumer at the moment, and I want to be able to develop them in sync. Plus, it provides a great test bed for development of the library!<p>edit: I forgot to mention that the eventual goal is to (hopefully!) publish this package as @storyteller&#x2F;epub, along with any other packages that end up split out of Storyteller. That will probably include at least a @storyteller&#x2F;synchronize and a @storyteller&#x2F;cli.<p>Unfortunately, someone seems to have snagged the @storyteller org on NPM several years ago and left it to languish without really using it, so I&#x27;m waiting to see whether GitHub will consider this squatting and transfer the org to me.<p>I&#x27;ve also tried reaching out to the developer that owns the org, but they don&#x27;t seem to have been active on GitHub or NPM for the past 5 years or so, and my only real strategy for reaching out to them was to open an issue on one of their other GitHub projects!</div><br/></div></div></div></div><div id="42412436" class="c"><input type="checkbox" id="c-42412436" checked=""/><div class="controls bullet"><span class="by">herrvogel-</span><span>|</span><a href="#42411873">prev</a><span>|</span><a href="#42411966">next</a><span>|</span><label class="collapse" for="c-42412436">[-]</label><label class="expand" for="c-42412436">[3 more]</label></div><br/><div class="children"><div class="content">Storyteller seems pretty cool in general. Can it be used to host books for other people?</div><br/><div id="42412482" class="c"><input type="checkbox" id="c-42412482" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42412436">parent</a><span>|</span><a href="#42411966">next</a><span>|</span><label class="collapse" for="c-42412482">[-]</label><label class="expand" for="c-42412482">[2 more]</label></div><br/><div class="children"><div class="content">Thanks! Absolutely. You can invite users to your Storyteller server and give them whatever permissions are appropriate (e.g. you can choose whether they can only download books, or can also manage uploading and syncing books and&#x2F;or managing users). It has SMTP support for emailing invites, or it can just generate invite links for you to share yourself.<p>More info here: <a href="https:&#x2F;&#x2F;smoores.gitlab.io&#x2F;storyteller&#x2F;docs&#x2F;administering#inviting-users" rel="nofollow">https:&#x2F;&#x2F;smoores.gitlab.io&#x2F;storyteller&#x2F;docs&#x2F;administering#inv...</a></div><br/><div id="42412604" class="c"><input type="checkbox" id="c-42412604" checked=""/><div class="controls bullet"><span class="by">9dev</span><span>|</span><a href="#42412436">root</a><span>|</span><a href="#42412482">parent</a><span>|</span><a href="#42411966">next</a><span>|</span><label class="collapse" for="c-42412604">[-]</label><label class="expand" for="c-42412604">[1 more]</label></div><br/><div class="children"><div class="content">Oh my! This looks very neat, and I’ve been working on something similar to Storyteller (i think): <a href="https:&#x2F;&#x2F;github.com&#x2F;project-kiosk&#x2F;kiosk">https:&#x2F;&#x2F;github.com&#x2F;project-kiosk&#x2F;kiosk</a><p>I don’t get around working on it right now, but maybe there’s something useful there for you.</div><br/></div></div></div></div></div></div><div id="42411966" class="c"><input type="checkbox" id="c-42411966" checked=""/><div class="controls bullet"><span class="by">curtis3389</span><span>|</span><a href="#42412436">prev</a><span>|</span><a href="#42414232">next</a><span>|</span><label class="collapse" for="c-42411966">[-]</label><label class="expand" for="c-42411966">[14 more]</label></div><br/><div class="children"><div class="content">Something I&#x27;ve been wondering: why do ebooks take so long to render? My kindle seems good at it, but opening an ebook in calibre&#x2F;fbreader&#x2F;etc can take minutes or even fail in some readers depending on the ebook.</div><br/><div id="42412078" class="c"><input type="checkbox" id="c-42412078" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411966">parent</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42412078">[-]</label><label class="expand" for="c-42412078">[12 more]</label></div><br/><div class="children"><div class="content">I would guess there are multiple potential pitfalls here. Firstly, not all ebook formats are created equal -- Storyteller only operates on EPUB files, because EPUB is an open source format and it supports Media Overlays (read-aloud) natively. I can only really speak to that format, but there are others (MOBI, PDF, etc).<p>An EPUB is just a ZIP archive of XML and XHTML files (plus other assets, like images). Partly, I suspect, because of the dearth of actively maintained open source projects in the space, and partly because of the nature of tech in the book publishing industry, EPUB generation software used by authors and publishers often messes up this spec, which means that EPUB readers sometimes need to have fairly complex fallback logic for trying to figure out how to render a book. Also, because EPUBs are ZIP archives, some readers may either unzip the entire book into memory or &quot;explode&quot; it into an unzipped directory on disk, both of which may result in some slowness, especially if the book has lots of large resources. The newest Brandon Sanderson novel, for example, is ~300MB _zipped_.<p>Additionally, and perhaps more importantly, EPUBs (and I believe MOBIs as well) represent content as XHTML and CSS, which means that readers very often need to use a browser or webview to actually render the book. Precisely how they deliver this content into the webview can have a huge impact on performance; most browser don&#x27;t love to be told to format entire novels worth of content into text columns, for example.</div><br/><div id="42412614" class="c"><input type="checkbox" id="c-42412614" checked=""/><div class="controls bullet"><span class="by">Yoric</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412078">parent</a><span>|</span><a href="#42412337">next</a><span>|</span><label class="collapse" for="c-42412614">[-]</label><label class="expand" for="c-42412614">[1 more]</label></div><br/><div class="children"><div class="content">FWIW, I wrote an EPUB (well, it was called OEBPS at the time) reader that rendered pretty much all of the format ~21 years ago (including all of XHTML and CSS) and it had very decent performance. I seem to recall that someone tried it on the One Laptop Per Child XO and it was... well, slow, but it worked.<p>So it&#x27;s possible :)</div><br/></div></div><div id="42412337" class="c"><input type="checkbox" id="c-42412337" checked=""/><div class="controls bullet"><span class="by">curtis3389</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412078">parent</a><span>|</span><a href="#42412614">prev</a><span>|</span><a href="#42412384">next</a><span>|</span><label class="collapse" for="c-42412337">[-]</label><label class="expand" for="c-42412337">[2 more]</label></div><br/><div class="children"><div class="content">Thank you so much! That&#x27;s incredibly enlightening!</div><br/><div id="42412385" class="c"><input type="checkbox" id="c-42412385" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412337">parent</a><span>|</span><a href="#42412384">next</a><span>|</span><label class="collapse" for="c-42412385">[-]</label><label class="expand" for="c-42412385">[1 more]</label></div><br/><div class="children"><div class="content">Of course! I&#x27;m hoping to have a web reader with Media Overlay support built in to Storyteller available in the next few months, along with some much needed library management tooling, so maybe that will be useful for you! I&#x27;ll try to make it snappy :)</div><br/></div></div></div></div><div id="42412384" class="c"><input type="checkbox" id="c-42412384" checked=""/><div class="controls bullet"><span class="by">giantrobot</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412078">parent</a><span>|</span><a href="#42412337">prev</a><span>|</span><a href="#42412728">next</a><span>|</span><label class="collapse" for="c-42412384">[-]</label><label class="expand" for="c-42412384">[3 more]</label></div><br/><div class="children"><div class="content">Additionally the XHTML content <i>can</i> just be a single large file instead of one file per chapter&#x2F;section. Paginating and rendering the large single file is going to be more effort than the same on a smaller file. This is all on top of the pitfalls and variability you mention.</div><br/><div id="42412531" class="c"><input type="checkbox" id="c-42412531" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412384">parent</a><span>|</span><a href="#42412762">next</a><span>|</span><label class="collapse" for="c-42412531">[-]</label><label class="expand" for="c-42412531">[1 more]</label></div><br/><div class="children"><div class="content">Yup, great point. Especially if you&#x27;ve used some tool to convert from another file, like a PDF, into an EPUB, you can easily end up with the entire book in a single XHTML file, which, again, can be pretty heavy for a browser to parse and format! I also have no idea whether Calibre et al actually use native web views, or have their own renderers, which are almost certainly less performant than native web views!</div><br/></div></div><div id="42412762" class="c"><input type="checkbox" id="c-42412762" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412384">parent</a><span>|</span><a href="#42412531">prev</a><span>|</span><a href="#42412728">next</a><span>|</span><label class="collapse" for="c-42412762">[-]</label><label class="expand" for="c-42412762">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Additionally the XHTML content can just be a single large file instead of one file per chapter&#x2F;section.<p>Terry Pratchett books are notorious for that. Some tools EPUB authoring tools artificially introduce breaks, but you can&#x27;t rely on them.</div><br/></div></div></div></div><div id="42412728" class="c"><input type="checkbox" id="c-42412728" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412078">parent</a><span>|</span><a href="#42412384">prev</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42412728">[-]</label><label class="expand" for="c-42412728">[5 more]</label></div><br/><div class="children"><div class="content">I used Storyteller to align the most recent Sanderson&#x27;s novel on audio and the result is 1.7Gb. That&#x27;s... painful. It resulted in it crashing the reader on Remarkable2 tablet.<p>I&#x27;m now actually working on a Calibre-Web change to strip the audio and media overlay from the books it serves via OPDS.<p>Then I&#x27;ll need to tackle cross-device progress sync. This turned out to be surprisingly tricky.</div><br/><div id="42412814" class="c"><input type="checkbox" id="c-42412814" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412728">parent</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42412814">[-]</label><label class="expand" for="c-42412814">[4 more]</label></div><br/><div class="children"><div class="content">You can’t do much better than that; that’s the size of the audiobook! For what it’s worth, I also used Storyteller on Wind and Truth, and got it down to 1.2GB by using the OPUS codec with a 32 kb&#x2F;s bitrate.</div><br/><div id="42412885" class="c"><input type="checkbox" id="c-42412885" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412814">parent</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42412885">[-]</label><label class="expand" for="c-42412885">[3 more]</label></div><br/><div class="children"><div class="content">Yeah. My current workaround is to create KEPUBs (Kobo-optimized epubs), but that creates an issue with cross-format reading progress sync. This is an interesting task in itself, though.<p>So I&#x27;m trying to design a progress sync protocol. My current idea is to just use several words from the text itself to unambiguously pinpoint the position within a section (chapter).</div><br/><div id="42412938" class="c"><input type="checkbox" id="c-42412938" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412885">parent</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42412938">[-]</label><label class="expand" for="c-42412938">[2 more]</label></div><br/><div class="children"><div class="content">Is the idea that you have some devices that you want to download just the text to, but have it sync with your other devices? I think we could support that natively, honestly! Storyteller already has the input files, and it uses a text-based position system that doesn’t require the audio to exist. If you’re already doing work on this, maybe we could add it to Storyteller?</div><br/><div id="42413683" class="c"><input type="checkbox" id="c-42413683" checked=""/><div class="controls bullet"><span class="by">smeej</span><span>|</span><a href="#42411966">root</a><span>|</span><a href="#42412938">parent</a><span>|</span><a href="#42412786">next</a><span>|</span><label class="collapse" for="c-42413683">[-]</label><label class="expand" for="c-42413683">[1 more]</label></div><br/><div class="children"><div class="content">Ooh, that&#x27;s an interesting idea. I only have one device where I would ever want to switch to <i>listening</i> to my book, but a couple others where I would like to read it.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42412786" class="c"><input type="checkbox" id="c-42412786" checked=""/><div class="controls bullet"><span class="by">sriacha</span><span>|</span><a href="#42411966">parent</a><span>|</span><a href="#42412078">prev</a><span>|</span><a href="#42414232">next</a><span>|</span><label class="collapse" for="c-42412786">[-]</label><label class="expand" for="c-42412786">[1 more]</label></div><br/><div class="children"><div class="content">I find Koreader (linux version) leaps and bounds faster than the calibre reader.</div><br/></div></div></div></div><div id="42414232" class="c"><input type="checkbox" id="c-42414232" checked=""/><div class="controls bullet"><span class="by">tills13</span><span>|</span><a href="#42411966">prev</a><span>|</span><a href="#42412785">next</a><span>|</span><label class="collapse" for="c-42414232">[-]</label><label class="expand" for="c-42414232">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m going to be annoying and simply laugh at the fact it&#x27;s a 2k line, single file in source. It&#x27;s TypeScript! You HAVE to compile it to ship it as an npm package (_technically_ you don&#x27;t but). Split it up into smaller modules with `import` statements!</div><br/><div id="42414316" class="c"><input type="checkbox" id="c-42414316" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#42414232">parent</a><span>|</span><a href="#42412785">next</a><span>|</span><label class="collapse" for="c-42414316">[-]</label><label class="expand" for="c-42414316">[2 more]</label></div><br/><div class="children"><div class="content">Quite seriously: why? What actual advantage do you get? People tend to split things up into separate files far too eagerly. A single two-thousand-line file is <i>nothing</i>. Especially when most of that is in one class, and <i>needs</i> to be, so you <i>can’t</i> really split things up, or at the very least there would be runtime overhead to it.</div><br/><div id="42414449" class="c"><input type="checkbox" id="c-42414449" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42414232">root</a><span>|</span><a href="#42414316">parent</a><span>|</span><a href="#42412785">next</a><span>|</span><label class="collapse" for="c-42414449">[-]</label><label class="expand" for="c-42414449">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, yeah I agree. The vast majority of the code in this library lives in a single class definition. Is it possible to move the implementations into separate files? Totally. Would that make the codebase more legible? I think at the moment, I would argue no, it would actually hurt legibility. If the class needs to grow dramatically, then maybe we’ll need a different approach, but I think this is actually the right thing to do for now!</div><br/></div></div></div></div></div></div><div id="42412785" class="c"><input type="checkbox" id="c-42412785" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42414232">prev</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42412785">[-]</label><label class="expand" for="c-42412785">[7 more]</label></div><br/><div class="children"><div class="content">BTW, I&#x27;ve had this idea in my mind for a while, after slowly working through my e-library infrastructure.<p>Do you think it might be a good idea to set up a site to share the aligned overlays from Storyteller? This way, people won&#x27;t have to waste CPU&#x2F;GPU time re-aligning the same files over and over again.<p>It should be OK from a copyright perspective, as it won&#x27;t be distributing any copyrighted material, only the media overlay information.</div><br/><div id="42412858" class="c"><input type="checkbox" id="c-42412858" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42412785">parent</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42412858">[-]</label><label class="expand" for="c-42412858">[6 more]</label></div><br/><div class="children"><div class="content">That’s a really interesting idea! The more I think about it, the more I like it.<p>A challenge I foresee is that the media overlays are only reusable if you have the exact same input EPUB file, and have processed it with Storyteller to mark up the sentence boundaries. EPUBs have unique identifiers, though, so maybe this would be fine! We’d need to add a new processing flow to Storyteller, but it should be doable.<p>Feel free to hit me up in the Storyteller chat if you want to discuss more! Thanks for sharing this idea!</div><br/><div id="42413692" class="c"><input type="checkbox" id="c-42413692" checked=""/><div class="controls bullet"><span class="by">smeej</span><span>|</span><a href="#42412785">root</a><span>|</span><a href="#42412858">parent</a><span>|</span><a href="#42413579">next</a><span>|</span><label class="collapse" for="c-42413692">[-]</label><label class="expand" for="c-42413692">[1 more]</label></div><br/><div class="children"><div class="content">It would be cool to do this with Project Gutenberg and LibriVox files, since they&#x27;re all public domain works anyway.<p>The entire <i>Great Books of Western Civilization</i> are on both, and I know I&#x27;d make more progress on reading it if I could hand off between reading and listening more easily!</div><br/></div></div><div id="42413579" class="c"><input type="checkbox" id="c-42413579" checked=""/><div class="controls bullet"><span class="by">NoahKAndrews</span><span>|</span><a href="#42412785">root</a><span>|</span><a href="#42412858">parent</a><span>|</span><a href="#42413692">prev</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42413579">[-]</label><label class="expand" for="c-42413579">[4 more]</label></div><br/><div class="children"><div class="content">You could require that the input files have the same sha256 hash, that would presumably be more robust than trusting an ID from the file itself</div><br/><div id="42413703" class="c"><input type="checkbox" id="c-42413703" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42412785">root</a><span>|</span><a href="#42413579">parent</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42413703">[-]</label><label class="expand" for="c-42413703">[3 more]</label></div><br/><div class="children"><div class="content">Yeah I was toying around with that, too… but folks often mess around with metadata in tools like Calibre and Audiobookshelf in ways that wouldn’t have an impact on Storyteller’s sync, but would change their hash. On the other hand, I don’t know how various publishers handle EPUB dc:identifiers and that may not be robust enough, either. We could try doing something like hashing only the contents of spine items (including their file names, since that’s how media overlays refer to content)</div><br/><div id="42413776" class="c"><input type="checkbox" id="c-42413776" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42412785">root</a><span>|</span><a href="#42413703">parent</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42413776">[-]</label><label class="expand" for="c-42413776">[2 more]</label></div><br/><div class="children"><div class="content">I was going to suggest to use the same approach as the old CD tagging systems. Count the number of words in each chapter to create a &quot;book fingerprint&quot;.<p>It&#x27;s highly likely to be globally unique, and it can also help with the missing forewords&#x2F;afterwords&#x2F;bonus content sections.<p>In addition, you can also add fuzzy matching for the title.</div><br/><div id="42414143" class="c"><input type="checkbox" id="c-42414143" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42412785">root</a><span>|</span><a href="#42413776">parent</a><span>|</span><a href="#42412395">next</a><span>|</span><label class="collapse" for="c-42414143">[-]</label><label class="expand" for="c-42414143">[1 more]</label></div><br/><div class="children"><div class="content">I think that the thing we need to account for (which, number of words per chapter would capture this, I think) is different publications of the same book, which would need different overlays if they have different chapter filepaths, etc.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42412395" class="c"><input type="checkbox" id="c-42412395" checked=""/><div class="controls bullet"><span class="by">revskill</span><span>|</span><a href="#42412785">prev</a><span>|</span><a href="#42411968">next</a><span>|</span><label class="collapse" for="c-42412395">[-]</label><label class="expand" for="c-42412395">[1 more]</label></div><br/><div class="children"><div class="content">Genius. Thanks.</div><br/></div></div><div id="42411968" class="c"><input type="checkbox" id="c-42411968" checked=""/><div class="controls bullet"><span class="by">seanwessmith</span><span>|</span><a href="#42412395">prev</a><span>|</span><label class="collapse" for="c-42411968">[-]</label><label class="expand" for="c-42411968">[2 more]</label></div><br/><div class="children"><div class="content">sometimes life just delivers. was looking for this 2 days ago</div><br/><div id="42412000" class="c"><input type="checkbox" id="c-42412000" checked=""/><div class="controls bullet"><span class="by">smoores</span><span>|</span><a href="#42411968">parent</a><span>|</span><label class="collapse" for="c-42412000">[-]</label><label class="expand" for="c-42412000">[1 more]</label></div><br/><div class="children"><div class="content">Outstanding. Let me know if you run into any issues!</div><br/></div></div></div></div></div></div></div></div></div></body></html>