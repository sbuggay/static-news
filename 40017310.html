<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712998867886" as="style"/><link rel="stylesheet" href="styles.css?v=1712998867886"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://securelist.com/xz-backdoor-story-part-1/112354/">XZ backdoor story – Initial analysis</a> <span class="domain">(<a href="https://securelist.com">securelist.com</a>)</span></div><div class="subtext"><span>kryster</span> | <span>99 comments</span></div><br/><div><div id="40021471" class="c"><input type="checkbox" id="c-40021471" checked=""/><div class="controls bullet"><span class="by">johnwheeler</span><span>|</span><a href="#40019967">next</a><span>|</span><label class="collapse" for="c-40021471">[-]</label><label class="expand" for="c-40021471">[4 more]</label></div><br/><div class="children"><div class="content">Here’s a twist - with the amount of effort the attacker went through to evade detection in their scripts and code, this whole project could function as a diversion or at least fallback to one while multiple efforts go on simultaneously.<p>How do you get one step ahead of that? Does the community focusing on SSHD impact some other part of the system as a whole? Some other technological aspect? Social?<p>Tin foil hats are fun!</div><br/><div id="40021575" class="c"><input type="checkbox" id="c-40021575" checked=""/><div class="controls bullet"><span class="by">hmottestad</span><span>|</span><a href="#40021471">parent</a><span>|</span><a href="#40021546">next</a><span>|</span><label class="collapse" for="c-40021575">[-]</label><label class="expand" for="c-40021575">[1 more]</label></div><br/><div class="children"><div class="content">You could write all code yourself for absolutely everything with your own dedicated crew of vetted developers.<p>Or buy closed source from someone like Microsoft, hoping that they have the resources and actually use the resources to scrutinise code more vigorously.<p>And there is always the approach of having a great secops team to detect strange network activity and attempts to escalate.</div><br/></div></div><div id="40021546" class="c"><input type="checkbox" id="c-40021546" checked=""/><div class="controls bullet"><span class="by">mathverse</span><span>|</span><a href="#40021471">parent</a><span>|</span><a href="#40021575">prev</a><span>|</span><a href="#40021510">next</a><span>|</span><label class="collapse" for="c-40021546">[-]</label><label class="expand" for="c-40021546">[1 more]</label></div><br/><div class="children"><div class="content">We dont need any tinfoil hats. FOSS projects were being backdoored even before they became a thing the difference is that this time it&#x27;s state sponsored actors doing it.<p>The old groups GOBBLES,ADM,ac1db1tch3z,~el8 were doing it, private &quot;security researchers&quot; like isec.pl were doing it.<p>This time it&#x27;s a problem because state actors are abusing the corporate capitalism that created this era of underpaid people working on foundational projects. The bad actors have unlimited resources for their objectives.<p>That&#x27;s basically what created the demand and ineption of groups like NSO,Zerodium etc..<p>Basically before that exploits and backdoors were worthless and hackers hoped to be sponsored or hired by companies like Qualys.</div><br/></div></div><div id="40021510" class="c"><input type="checkbox" id="c-40021510" checked=""/><div class="controls bullet"><span class="by">AndyMcConachie</span><span>|</span><a href="#40021471">parent</a><span>|</span><a href="#40021546">prev</a><span>|</span><a href="#40019967">next</a><span>|</span><label class="collapse" for="c-40021510">[-]</label><label class="expand" for="c-40021510">[1 more]</label></div><br/><div class="children"><div class="content">Cool story bro. You got any evidence for any of this?</div><br/></div></div></div></div><div id="40019967" class="c"><input type="checkbox" id="c-40019967" checked=""/><div class="controls bullet"><span class="by">dvsfish</span><span>|</span><a href="#40021471">prev</a><span>|</span><a href="#40019640">next</a><span>|</span><label class="collapse" for="c-40019967">[-]</label><label class="expand" for="c-40019967">[39 more]</label></div><br/><div class="children"><div class="content">Great read - the lengths the attacker went to to not only hide it but also build the trust to be able to pull this off is incredible. So calculated. 
One can only imagine they felt a great deal of panic and despair as the security community lit up the issue, regardless of a near zero chance of repercussions.
Very clever - those involved in catching this are, quietly, heroes</div><br/><div id="40020100" class="c"><input type="checkbox" id="c-40020100" checked=""/><div class="controls bullet"><span class="by">jerjerjer</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40021349">next</a><span>|</span><label class="collapse" for="c-40020100">[-]</label><label class="expand" for="c-40020100">[11 more]</label></div><br/><div class="children"><div class="content">The use of trie structure to compare strings without hardcoding raw, searchable string values is very inspired.<p>But yes, some black hat had a really really bad day: being so close to owning any ssh-enabled recently-updated box and when they can finally see a finish line it is just poof... gone in a day. It was two years of effort from at least one guy and more likely a team.</div><br/><div id="40021013" class="c"><input type="checkbox" id="c-40021013" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40020442">next</a><span>|</span><label class="collapse" for="c-40021013">[-]</label><label class="expand" for="c-40021013">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  The use of trie structure to compare strings without hardcoding raw, searchable string values is very inspired.<p>Aside, this is one of my grumpy-old-dude opinions when it comes to regular non-malicious code: Source &quot;greppability&quot; is a virtue, one that must be balanced against &quot;don&#x27;t repeat yourself&quot; and &quot;compile time checking&quot;, etc.<p>Some examples off the top of my head:<p>1. One import&#x2F;alias per line, no wildcards.<p>2. If you have to concatenate a literal string across multiple lines, try to ensure the break isn&#x27;t inside an interesting substring someone would search for.<p>3. If you write a compile-time constant like foo=4*6*9, the comments around it should also contain the result. Sure, someone might screw up and forget to keep the comment in-sync, but it can also be invaluable when someone else is tearing their hair out trying to find out why the production logs are saying nothing but &quot;Illegal frump: 216&quot;.<p>Don&#x27;t get me wrong, I love a good IDE, and many will offer &quot;Find Usages&quot; or &quot;Find Literal&quot;... but it doesn&#x27;t always work all the time, for all languages in the project at once, for everyone on a team who might use other tools, or during a PR review through a web-browser, etc.</div><br/></div></div><div id="40020442" class="c"><input type="checkbox" id="c-40020442" checked=""/><div class="controls bullet"><span class="by">lenerdenator</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40021013">prev</a><span>|</span><a href="#40020741">next</a><span>|</span><label class="collapse" for="c-40020442">[-]</label><label class="expand" for="c-40020442">[2 more]</label></div><br/><div class="children"><div class="content">I think it goes beyond just this particular attempt. I bet they were looking for other targets, targets that are widely-used but maintained by resource-deficient projects. They wanted to do maximum damage with the fewest possible supply chain attacks.<p>The fact that many projects are now searching deep and wide through their commit histories, looking at just who they&#x27;re taking code from, beginning to develop frameworks for attack mitigation and remediation... an entire type of previously very-promising attack is completely burned. This has been a massive defeat. And it happened all by chance.</div><br/><div id="40021141" class="c"><input type="checkbox" id="c-40021141" checked=""/><div class="controls bullet"><span class="by">fauigerzigerk</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020442">parent</a><span>|</span><a href="#40020741">next</a><span>|</span><label class="collapse" for="c-40021141">[-]</label><label class="expand" for="c-40021141">[1 more]</label></div><br/><div class="children"><div class="content"><i>&gt;an entire type of previously very-promising attack is completely burned.</i><p>I fear it&#x27;s not just the attack that is burned. If new contributors have to be distrusted and&#x2F;or go through some sort of vetting that isn&#x27;t based on the merit of their contributions, that is a terrible blow to the entire open source movement.<p>The threshold for young coders without a great deal of history and without a network of contacts to become contributors to important open source projects has just gone up massively.</div><br/></div></div></div></div><div id="40020741" class="c"><input type="checkbox" id="c-40020741" checked=""/><div class="controls bullet"><span class="by">KeplerBoy</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40020442">prev</a><span>|</span><a href="#40020612">next</a><span>|</span><label class="collapse" for="c-40020741">[-]</label><label class="expand" for="c-40020741">[1 more]</label></div><br/><div class="children"><div class="content">How much effort was it really? Yes, they worked on it over 2 years, but I guess it wasn&#x27;t more effort than a few hours every other week (apart from engineering the actual exploit). After all putting in a full time effort as an unpaid contributor would be suspicious in itself.<p>Assuming they work 40 hours a week and are doing this in a team (presumably every major player has such a team or is scrambling to get one now), one must expect many potentially infiltrated projects out there.</div><br/></div></div><div id="40020612" class="c"><input type="checkbox" id="c-40020612" checked=""/><div class="controls bullet"><span class="by">issafram</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40020741">prev</a><span>|</span><a href="#40020907">next</a><span>|</span><label class="collapse" for="c-40020612">[-]</label><label class="expand" for="c-40020612">[3 more]</label></div><br/><div class="children"><div class="content">It was most likely done by a government.  Not just one hacker.</div><br/><div id="40020929" class="c"><input type="checkbox" id="c-40020929" checked=""/><div class="controls bullet"><span class="by">gizmo686</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020612">parent</a><span>|</span><a href="#40020907">next</a><span>|</span><label class="collapse" for="c-40020929">[-]</label><label class="expand" for="c-40020929">[2 more]</label></div><br/><div class="children"><div class="content">Governments are made up of people. There is likely at least 1 real person (if not more) for whom this attack has been the entirety of their professional life for years.</div><br/></div></div></div></div><div id="40020907" class="c"><input type="checkbox" id="c-40020907" checked=""/><div class="controls bullet"><span class="by">wjholden</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40020612">prev</a><span>|</span><a href="#40020140">next</a><span>|</span><label class="collapse" for="c-40020907">[-]</label><label class="expand" for="c-40020907">[1 more]</label></div><br/><div class="children"><div class="content">I agree, I had never heard of using a trie as a means of hiding strings.<p>I&#x27;m not familiar with any programming language that provides tries in a standardized way. They&#x27;re not so hard to code, so I wonder if this will become a trend in future malware.</div><br/></div></div><div id="40020140" class="c"><input type="checkbox" id="c-40020140" checked=""/><div class="controls bullet"><span class="by">jumelles</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020100">parent</a><span>|</span><a href="#40020907">prev</a><span>|</span><a href="#40021349">next</a><span>|</span><label class="collapse" for="c-40020140">[-]</label><label class="expand" for="c-40020140">[2 more]</label></div><br/><div class="children"><div class="content">Honestly? Good. Anyone doing this sort of work willingly deserves worse.</div><br/><div id="40021105" class="c"><input type="checkbox" id="c-40021105" checked=""/><div class="controls bullet"><span class="by">optimalsolver</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020140">parent</a><span>|</span><a href="#40021349">next</a><span>|</span><label class="collapse" for="c-40021105">[-]</label><label class="expand" for="c-40021105">[1 more]</label></div><br/><div class="children"><div class="content">That they were harassing and manipulating a lone, unthanked maintainer who had already told them he was dealing with mental issues makes them evil, IMO.<p>The honorable thing for &quot;Jia&quot; to do after this epic failure is seppuku, or whatever his or her local equivalent is.</div><br/></div></div></div></div></div></div><div id="40021349" class="c"><input type="checkbox" id="c-40021349" checked=""/><div class="controls bullet"><span class="by">cnvogel</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40020100">prev</a><span>|</span><a href="#40020562">next</a><span>|</span><label class="collapse" for="c-40021349">[-]</label><label class="expand" for="c-40021349">[2 more]</label></div><br/><div class="children"><div class="content">Here’s what I don’t get: why the many layers of obfuscation in the build phase? (I understand why in the binary linked into ssh.)<p>Once the first stage, extracting a shell script from one of the „test“ data blobs, has been found it was clear to <i>everybody</i> that something fishy is going on.<p>It’s inconceivable that I’ve would have found the first stage and just given up, but then it was „only“ a matter of tedious shell reversing…<p>They could easily done without the „striping“ or „awk RC4“, but that must have complicated their internal testing and development quite a bit.</div><br/><div id="40021446" class="c"><input type="checkbox" id="c-40021446" checked=""/><div class="controls bullet"><span class="by">almostnormal</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40021349">parent</a><span>|</span><a href="#40020562">next</a><span>|</span><label class="collapse" for="c-40021446">[-]</label><label class="expand" for="c-40021446">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Here’s what I don’t get: why the many layers of obfuscation in the build phase?<p>For a one of its kind deployment it would probably not matter. However, deploying to multiple targets using the same basic approach would allow all of them to be found once one was discovered. With some mildly confsing but different scripting for each target systematic detection of others becomes more difficult.</div><br/></div></div></div></div><div id="40020562" class="c"><input type="checkbox" id="c-40020562" checked=""/><div class="controls bullet"><span class="by">codezero</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40021349">prev</a><span>|</span><a href="#40021282">next</a><span>|</span><label class="collapse" for="c-40020562">[-]</label><label class="expand" for="c-40020562">[3 more]</label></div><br/><div class="children"><div class="content">or they are totally nonplussed because they are not even a single individual, and a state actor who is doing this on 10-20 other projects for the past 5-10 years which haven&#x27;t got the same attention. This is their job, being compromised is always a risk.</div><br/><div id="40020644" class="c"><input type="checkbox" id="c-40020644" checked=""/><div class="controls bullet"><span class="by">redox99</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020562">parent</a><span>|</span><a href="#40021282">next</a><span>|</span><label class="collapse" for="c-40020644">[-]</label><label class="expand" for="c-40020644">[2 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t matter if it&#x27;s a team working for a state actor. You&#x27;d still be pissed your 2 year project failed so close to the finish line.</div><br/><div id="40020681" class="c"><input type="checkbox" id="c-40020681" checked=""/><div class="controls bullet"><span class="by">codezero</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020644">parent</a><span>|</span><a href="#40021282">next</a><span>|</span><label class="collapse" for="c-40020681">[-]</label><label class="expand" for="c-40020681">[1 more]</label></div><br/><div class="children"><div class="content">Not if this is one of a few dozen or few hundred similar ongoing operations. The risk is always there, they have to expect some amount of failure. Open source software is constantly being probed for vulnerabilities in every way possible, from random commits to high level members of committees for standards. Every operation is one in a grab bag of disposable and deniable efforts.<p>I also am a little biased and assume being burned in state-sponsored acts is similar to the no-blame culture of breaking infrastructure in tech :) because by all accounts this compromise was extremely well done, until it wasn&#x27;t.<p>Also, we can&#x27;t be sure the compromise wasn&#x27;t intentionally telegraphed to cause some other action (using a different library) on purpose.</div><br/></div></div></div></div></div></div><div id="40021282" class="c"><input type="checkbox" id="c-40021282" checked=""/><div class="controls bullet"><span class="by">grumpyprole</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40020562">prev</a><span>|</span><a href="#40020942">next</a><span>|</span><label class="collapse" for="c-40021282">[-]</label><label class="expand" for="c-40021282">[2 more]</label></div><br/><div class="children"><div class="content">Those who caught it were indeed very clever. But the attacker did make mistakes, particularly the Valgrind issues and large performance regression. That ultimately is what raised suspicions.</div><br/><div id="40021511" class="c"><input type="checkbox" id="c-40021511" checked=""/><div class="controls bullet"><span class="by">glandium</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40021282">parent</a><span>|</span><a href="#40020942">next</a><span>|</span><label class="collapse" for="c-40021511">[-]</label><label class="expand" for="c-40021511">[1 more]</label></div><br/><div class="children"><div class="content">The large performance regression was a feature of the string obfuscation.</div><br/></div></div></div></div><div id="40020942" class="c"><input type="checkbox" id="c-40020942" checked=""/><div class="controls bullet"><span class="by">macrolime</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40021282">prev</a><span>|</span><a href="#40020514">next</a><span>|</span><label class="collapse" for="c-40020942">[-]</label><label class="expand" for="c-40020942">[2 more]</label></div><br/><div class="children"><div class="content">I wonder then, whether the attacker has already started over with a new open source project, or found something else to do.<p>Or was xz only one of multiple targets where the overall plan didn&#x27;t actually fail and an updated backdoor, without the performance issues, will soon be injected again through some other project.</div><br/><div id="40020956" class="c"><input type="checkbox" id="c-40020956" checked=""/><div class="controls bullet"><span class="by">peddling-brink</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020942">parent</a><span>|</span><a href="#40020514">next</a><span>|</span><label class="collapse" for="c-40020956">[-]</label><label class="expand" for="c-40020956">[1 more]</label></div><br/><div class="children"><div class="content">Started over? They’ve certainly been cultivating other unrelated sock puppet accounts that they’ve switched over to.</div><br/></div></div></div></div><div id="40020514" class="c"><input type="checkbox" id="c-40020514" checked=""/><div class="controls bullet"><span class="by">inkyoto</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40020942">prev</a><span>|</span><a href="#40020403">next</a><span>|</span><label class="collapse" for="c-40020514">[-]</label><label class="expand" for="c-40020514">[11 more]</label></div><br/><div class="children"><div class="content">The fundamental question remains: considering the in-depth knowledge of low-level (a small scale disassembler), system programming and the practical application of data structures (i.e. using a trie for all string operations to avoid the use of string constants), was it a state sponsored attack, or it was a one man show who did it for personal gain? Attempting to backdoor nearly every single Linux instance of sshd goes beyond the definition of just being brazen.</div><br/><div id="40020684" class="c"><input type="checkbox" id="c-40020684" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020514">parent</a><span>|</span><a href="#40020567">next</a><span>|</span><label class="collapse" for="c-40020684">[-]</label><label class="expand" for="c-40020684">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The fundamental question remains: considering the in-depth knowledge of low-level (a small scale disassembler), system programming and the practical application of data structures (i.e. using a trie for all string operations to avoid the use of string constants), was it a state sponsored attack<p>I think you&#x27;re missing where the difficulty is. I&#x27;d argue the technical knowledge here isn&#x27;t the hard part here. You can find more than enough folks who would know how to do everything you listed outside of any state-sponsored context. The hard part is the methodical execution, including the opsec, backup plans, plausible deniability, false identities, knowing how to play the long game, being able to precisely target what you want, understanding human psychological tendencies, identifying unforeseen security vulnerabilities, etc... these are the things that I imagine are likely to distinguish talented individuals from state-sponsored actors, not something like &quot;knows tries and x86 assembly&quot;.<p>And taking all those into account, this absolutely smells state-sponsored. I just see no way that a private entity had enough of an incentive, foresight, experience, <i>and</i> patience to play such a long game with such careful maneuvers.</div><br/><div id="40021416" class="c"><input type="checkbox" id="c-40021416" checked=""/><div class="controls bullet"><span class="by">inkyoto</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020684">parent</a><span>|</span><a href="#40020567">next</a><span>|</span><label class="collapse" for="c-40021416">[-]</label><label class="expand" for="c-40021416">[1 more]</label></div><br/><div class="children"><div class="content">I do not think I am missing out: the supply chain attack which included playing the long game, subverting the trust of the development community is the real issue that the open source community has no defences against – the thwarted attack has surpassed the scale of all previous supply chain attacks on NodeJs, Python and similar ecosystems and went deep down into the low level, technical layers as well.<p>The assault was comprehensive, holistic and systematic in its approach – this article does not mention it, but other reports have indicated that the person behind it also managed to compromise the PKI layer at the edge between OpenSSL and sshd which brings an extra level of complexity to the backdoor.</div><br/></div></div></div></div><div id="40020567" class="c"><input type="checkbox" id="c-40020567" checked=""/><div class="controls bullet"><span class="by">codezero</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020514">parent</a><span>|</span><a href="#40020684">prev</a><span>|</span><a href="#40021517">next</a><span>|</span><label class="collapse" for="c-40020567">[-]</label><label class="expand" for="c-40020567">[6 more]</label></div><br/><div class="children"><div class="content">That nobody is talking about the person&#x27;s IP addresses (the xz project was hosted on a personal server of the maintainer), or any details about their actions indicates to me it was a state actor and the original xz maintainer is cooperating with law enforcement to uncover their actions.</div><br/><div id="40021398" class="c"><input type="checkbox" id="c-40021398" checked=""/><div class="controls bullet"><span class="by">miohtama</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020567">parent</a><span>|</span><a href="#40020922">next</a><span>|</span><label class="collapse" for="c-40021398">[-]</label><label class="expand" for="c-40021398">[1 more]</label></div><br/><div class="children"><div class="content">Based on working hours Israeli is likely<p><a href="https:&#x2F;&#x2F;rheaeve.substack.com&#x2F;p&#x2F;xz-backdoor-times-damned-times-and" rel="nofollow">https:&#x2F;&#x2F;rheaeve.substack.com&#x2F;p&#x2F;xz-backdoor-times-damned-time...</a><p>There are other countries on the same time zone, but only Israel has history of using and selling hacks of this level.</div><br/></div></div><div id="40020922" class="c"><input type="checkbox" id="c-40020922" checked=""/><div class="controls bullet"><span class="by">willvarfar</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020567">parent</a><span>|</span><a href="#40021398">prev</a><span>|</span><a href="#40021057">next</a><span>|</span><label class="collapse" for="c-40020922">[-]</label><label class="expand" for="c-40020922">[1 more]</label></div><br/><div class="children"><div class="content">Whilst the ip addresses and email headers etc should be examined meticulously, in the distant hope that they lead somewhere, the chances are that they won&#x27;t.  Very basic opsec.</div><br/></div></div><div id="40021057" class="c"><input type="checkbox" id="c-40021057" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020567">parent</a><span>|</span><a href="#40020922">prev</a><span>|</span><a href="#40020767">next</a><span>|</span><label class="collapse" for="c-40021057">[-]</label><label class="expand" for="c-40021057">[1 more]</label></div><br/><div class="children"><div class="content">CISA is investigating it.</div><br/></div></div><div id="40020767" class="c"><input type="checkbox" id="c-40020767" checked=""/><div class="controls bullet"><span class="by">cdelsolar</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020567">parent</a><span>|</span><a href="#40021057">prev</a><span>|</span><a href="#40021517">next</a><span>|</span><label class="collapse" for="c-40020767">[-]</label><label class="expand" for="c-40020767">[2 more]</label></div><br/><div class="children"><div class="content">I thought it was on GitHub pages?</div><br/><div id="40020887" class="c"><input type="checkbox" id="c-40020887" checked=""/><div class="controls bullet"><span class="by">codezero</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020767">parent</a><span>|</span><a href="#40021517">next</a><span>|</span><label class="collapse" for="c-40020887">[-]</label><label class="expand" for="c-40020887">[1 more]</label></div><br/><div class="children"><div class="content">Before pages the project was hosted on the server of the original maintainer.</div><br/></div></div></div></div></div></div><div id="40021517" class="c"><input type="checkbox" id="c-40021517" checked=""/><div class="controls bullet"><span class="by">AtNightWeCode</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020514">parent</a><span>|</span><a href="#40020567">prev</a><span>|</span><a href="#40020403">next</a><span>|</span><label class="collapse" for="c-40021517">[-]</label><label class="expand" for="c-40021517">[2 more]</label></div><br/><div class="children"><div class="content">I think it is a professional attempt. It does not have to be a goverment. There are other cyber criminals.</div><br/><div id="40021573" class="c"><input type="checkbox" id="c-40021573" checked=""/><div class="controls bullet"><span class="by">lmm</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40021517">parent</a><span>|</span><a href="#40020403">next</a><span>|</span><label class="collapse" for="c-40021573">[-]</label><label class="expand" for="c-40021573">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It does not have to be a goverment. There are other cyber criminals.<p>Criminals with the resources to maintain such a complex operation for two years?</div><br/></div></div></div></div></div></div><div id="40020403" class="c"><input type="checkbox" id="c-40020403" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#40019967">parent</a><span>|</span><a href="#40020514">prev</a><span>|</span><a href="#40020832">next</a><span>|</span><label class="collapse" for="c-40020403">[-]</label><label class="expand" for="c-40020403">[6 more]</label></div><br/><div class="children"><div class="content">&gt;One can only imagine they felt a great deal of panic and despair as the security community lit up the issue,<p>Jia Tan mook: &quot;Sir, they found us out.&quot;<p>Jia Tan officer: &quot;What&#x27;s the sitrep, are they coming for us? Are they getting our operatives in the field?&quot;<p>Jia Tan mook: &quot;No sir, they&#x27;re just reverting and blacklisting our accounts and releases. Muttering something about &#x27;uptime&#x27;.&quot;<p>Jia Tan officer: &quot;Shit, we&#x27;re dealing with sysadmins.&quot;</div><br/><div id="40020510" class="c"><input type="checkbox" id="c-40020510" checked=""/><div class="controls bullet"><span class="by">flomo</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020403">parent</a><span>|</span><a href="#40020832">next</a><span>|</span><label class="collapse" for="c-40020510">[-]</label><label class="expand" for="c-40020510">[5 more]</label></div><br/><div class="children"><div class="content">--</div><br/><div id="40020547" class="c"><input type="checkbox" id="c-40020547" checked=""/><div class="controls bullet"><span class="by">arrowsmith</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020510">parent</a><span>|</span><a href="#40020544">next</a><span>|</span><label class="collapse" for="c-40020547">[-]</label><label class="expand" for="c-40020547">[2 more]</label></div><br/><div class="children"><div class="content">I imagine that government security agencies are mainly thinking &quot;shit, why didn&#x27;t we think to do that?&quot;</div><br/></div></div><div id="40020544" class="c"><input type="checkbox" id="c-40020544" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#40019967">root</a><span>|</span><a href="#40020510">parent</a><span>|</span><a href="#40020547">prev</a><span>|</span><a href="#40020832">next</a><span>|</span><label class="collapse" for="c-40020544">[-]</label><label class="expand" for="c-40020544">[2 more]</label></div><br/><div class="children"><div class="content">If a government agency tasked with national security started caring about a critical home project by Nebraskaman only and long after Nebraskaman collapsed, that country needs a new government agency.</div><br/></div></div></div></div></div></div></div></div><div id="40019640" class="c"><input type="checkbox" id="c-40019640" checked=""/><div class="controls bullet"><span class="by">vlovich123</span><span>|</span><a href="#40019967">prev</a><span>|</span><a href="#40021287">next</a><span>|</span><label class="collapse" for="c-40019640">[-]</label><label class="expand" for="c-40019640">[11 more]</label></div><br/><div class="children"><div class="content">So if I&#x27;m understanding correctly, a useful hardening step would be to ensure that each dynamically linked library had it&#x27;s own GOT &amp; that the tables are marked as read-only once dynamic linking completes (i.e. you can&#x27;t reach across dynamic boundaries to patch someone else&#x27;s ifunc entries).<p>That would improve the supply chain security of code getting linked in somewhere but never executed.<p>EDIT: Or even better, perhaps ifunc should be implemented in a declarative fashion so that you can&#x27;t just cause arbitrary code execution from each library you link against. That might be harder to implement at this point considering back compat, but probably is something that could be layered in over a longer time period (i.e. if you build any library with &quot;declaratively linked ifunc&quot; feature bit set, then the dynamic linker will force all linked libraries to have that feature flag or fail to launch).</div><br/><div id="40020061" class="c"><input type="checkbox" id="c-40020061" checked=""/><div class="controls bullet"><span class="by">jerjerjer</span><span>|</span><a href="#40019640">parent</a><span>|</span><a href="#40020065">next</a><span>|</span><label class="collapse" for="c-40020061">[-]</label><label class="expand" for="c-40020061">[4 more]</label></div><br/><div class="children"><div class="content">From another angle: build systems.<p>Currently building most libraries usually involves executing a series of highly complex byzantine scripts, requiring turing-complete environment. This gives attacker an endless attack surface, and when the build process is hijacked - well, the opportunities are there.<p>Moving to a declarative build process with only a limited state machine as an executor would help. Requiring all source blobs being reproducible might also be something to think about.</div><br/><div id="40020602" class="c"><input type="checkbox" id="c-40020602" checked=""/><div class="controls bullet"><span class="by">kimixa</span><span>|</span><a href="#40019640">root</a><span>|</span><a href="#40020061">parent</a><span>|</span><a href="#40020174">next</a><span>|</span><label class="collapse" for="c-40020602">[-]</label><label class="expand" for="c-40020602">[2 more]</label></div><br/><div class="children"><div class="content">Having a &quot;simple&quot; declarative build definition won&#x27;t help if the thing that interprets and executes that definition is shipped with the package, as said interpreter is likely orders of magnitude more complex and harder to personally review. As is what happened with the xz example - the &quot;attack&quot; was hidden in code that is autogenerated by autotools, not the build or configuration definitions.<p>People put trust in distros and packagers to having something of a review chain - there&#x27;s 0% chance you personally be an expert in everything executing on your workstation right now (outside of maybe toy systems). I&#x27;m not an expert in m4 or bash, but I hope enough experts <i>are</i> in the chain to get to my distro&#x27;s package library are that such things are less likely. But that is all bypassed here.<p>I think this particular approach is a one-off, as I know of no other build environment where it&#x27;s <i>expected</i> to have the generated executable of the build system &quot;helpfully&quot; packaged in the tarball as a packaging step.<p>If it is in some I&#x27;m not aware of, I <i>hope</i> that decision is being re-examined now.</div><br/><div id="40021311" class="c"><input type="checkbox" id="c-40021311" checked=""/><div class="controls bullet"><span class="by">AtlasBarfed</span><span>|</span><a href="#40019640">root</a><span>|</span><a href="#40020602">parent</a><span>|</span><a href="#40020174">next</a><span>|</span><label class="collapse" for="c-40021311">[-]</label><label class="expand" for="c-40021311">[1 more]</label></div><br/><div class="children"><div class="content">It needs money and people.<p>Government funding for defense of the economy and computing in the &quot;free world&quot;.<p>Certainly the defense department has a billion to spare, and so does  the EU</div><br/></div></div></div></div></div></div><div id="40020065" class="c"><input type="checkbox" id="c-40020065" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#40019640">parent</a><span>|</span><a href="#40020061">prev</a><span>|</span><a href="#40020099">next</a><span>|</span><label class="collapse" for="c-40020065">[-]</label><label class="expand" for="c-40020065">[2 more]</label></div><br/><div class="children"><div class="content">Yes and no, but mostly no. This would prevent simple use of ifuncs in this way, but it&#x27;s important to understand that the author of this could inject arbitrary code into the library that ends up in the address space of a sensitive process. At that point, all bets are off: it could remap the GOT as writable if it so chose, or (this is mostly here for the EDR people will certainly bring it up after reading this) if trying to do that is flagged as &quot;suspicious&quot; or the OS gains the ability to block such a transition, the injected code can subvert control flow in hundreds of other ways. It has arbitrary read&#x2F;write, code execution, everything: there is no security mitigation that can stop it. If it so wishes it can leak private keys and send them to the attacker directly. It can spawn a shell. Trying to design protections at this stage of compromise is a fool&#x27;s errand.</div><br/><div id="40021570" class="c"><input type="checkbox" id="c-40021570" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#40019640">root</a><span>|</span><a href="#40020065">parent</a><span>|</span><a href="#40020099">next</a><span>|</span><label class="collapse" for="c-40021570">[-]</label><label class="expand" for="c-40021570">[1 more]</label></div><br/><div class="children"><div class="content">&gt;it&#x27;s important to understand that the author of this could inject arbitrary code into the library that ends up in the address space of a sensitive process. At that point, all bets are off: it could remap the GOT as writable if it so chose, or (this is mostly here for the EDR people will certainly bring it up after reading this) if trying to do that is flagged as &quot;suspicious&quot; or the OS gains the ability to block such a transition, the injected code can subvert control flow in hundreds of other ways.<p>I think it&#x27;s important to push back on a very specific point here. It&#x27;s true in general that if the attacker has added a backdoor in your library, and you&#x27;re going to call that library&#x27;s code, you&#x27;ve pretty much lost. Game over. Go home.<p>But this was a very different attack, in that the attackers couldn&#x27;t directly target sshd. They couldn&#x27;t manage to target any library that sshd calls directly either.<p>The library with the backdoor is code that was <i>never actually called</i> at runtime. This is important because it means it *doesn&#x27;t* have a hundred ways to reach code execution. It only had a few select ways, mainly constructors and indirect function resolvers.<p>The amount of weirdness in glibc&#x27;s runtime loader is not unbounded. There aren&#x27;t actually a hundred places where it allows random libs to run code before main. And we should take a good look at those couple place that are clearly juicy high-value gadgets to attacker.<p>When glibc&#x27;s runtime loader first loads a binary, first reaches a relocation for a STT_GNU_IFUNC, everything is still in a pristine state and no arbitrary code can run without being explicitly called. Attackers don&#x27;t have magical powers that allow them to run code before you hand them the control flow. At this point in the runtime loader, an ifunc resolver cannot do anything without being caught. It cannot &quot;just open &#x2F;proc&#x2F;self&#x2F;mem&quot; or &quot;just call mprotect&quot;. It cannot &quot;just disassemble the caller&quot; or &quot;just overwrite the GOT&quot;.<p>I really want to hammer home how different that is from letting the attacker run code after main. There&#x27;s nothing you can do if you directly call a backdoored library. But we shouldn&#x27;t let attackers get away with spending 400ms parsing and disassembling ELFs in memory <i>in an ifunc resolver of all things</i>. Overwriting the GOT like nobody&#x27;s watching.<p>The backdoor isn&#x27;t magic. For all the beautiful sophistication that went into it, it made many mistakes along the way that could have led to a detection. From valgrind errors to unacceptable amount of noise (400ms!) before main.</div><br/></div></div></div></div><div id="40020099" class="c"><input type="checkbox" id="c-40020099" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#40019640">parent</a><span>|</span><a href="#40020065">prev</a><span>|</span><a href="#40020440">next</a><span>|</span><label class="collapse" for="c-40020099">[-]</label><label class="expand" for="c-40020099">[3 more]</label></div><br/><div class="children"><div class="content">&gt; the tables are marked as read-only once dynamic linking completes<p>Alas this won&#x27;t work.  Dynamic linking is lazy, there&#x27;s no moment when it&#x27;s &quot;complete&quot;.  The correct function pointers get loaded and inserted into the table (in place of stubs) when called the first time, which can be arbitrarily far into the future.  In fact in most large library ecosystems (gtk apps, etc...) most of the linked functions are never called at all.</div><br/><div id="40020908" class="c"><input type="checkbox" id="c-40020908" checked=""/><div class="controls bullet"><span class="by">CUViper</span><span>|</span><a href="#40019640">root</a><span>|</span><a href="#40020099">parent</a><span>|</span><a href="#40021524">next</a><span>|</span><label class="collapse" for="c-40020908">[-]</label><label class="expand" for="c-40020908">[1 more]</label></div><br/><div class="children"><div class="content">Best practice is to resolve them early now: <a href="https:&#x2F;&#x2F;www.redhat.com&#x2F;en&#x2F;blog&#x2F;hardening-elf-binaries-using-relocation-read-only-relro" rel="nofollow">https:&#x2F;&#x2F;www.redhat.com&#x2F;en&#x2F;blog&#x2F;hardening-elf-binaries-using-...</a></div><br/></div></div><div id="40021524" class="c"><input type="checkbox" id="c-40021524" checked=""/><div class="controls bullet"><span class="by">lyu07282</span><span>|</span><a href="#40019640">root</a><span>|</span><a href="#40020099">parent</a><span>|</span><a href="#40020908">prev</a><span>|</span><a href="#40020440">next</a><span>|</span><label class="collapse" for="c-40021524">[-]</label><label class="expand" for="c-40021524">[1 more]</label></div><br/><div class="children"><div class="content">in this case it takes advantage of the fact that sshd is compiled with early binding not lazy. The ifunc resolver function is called early, right after the dynamic libraries are loaded. It&#x27;s eager binding (that&#x27;s what LD_BIND_NOW=1 &#x2F; -W,-z,now are doing) is a security feature, GOT table will be readonly early. Didn&#x27;t help with security in this case lol</div><br/></div></div></div></div><div id="40020440" class="c"><input type="checkbox" id="c-40020440" checked=""/><div class="controls bullet"><span class="by">BobbyTables2</span><span>|</span><a href="#40019640">parent</a><span>|</span><a href="#40020099">prev</a><span>|</span><a href="#40021287">next</a><span>|</span><label class="collapse" for="c-40020440">[-]</label><label class="expand" for="c-40020440">[1 more]</label></div><br/><div class="children"><div class="content">And yet such is all trivially defeated by writing read-only memory using &#x2F;proc&#x2F;self&#x2F;mem.<p>Even a Rust program with no unsafe code can do this.<p>Patching readonly libc code from Python without external modules is also trivial,  resulting in arbitrary execution!</div><br/></div></div></div></div><div id="40021287" class="c"><input type="checkbox" id="c-40021287" checked=""/><div class="controls bullet"><span class="by">nonane</span><span>|</span><a href="#40019640">prev</a><span>|</span><a href="#40021226">next</a><span>|</span><label class="collapse" for="c-40021287">[-]</label><label class="expand" for="c-40021287">[2 more]</label></div><br/><div class="children"><div class="content">Has anyone done an analysis of the bug in the backdoor that caused valgrind errors and slowness in SSH which eventually exposed it?</div><br/><div id="40021592" class="c"><input type="checkbox" id="c-40021592" checked=""/><div class="controls bullet"><span class="by">lyu07282</span><span>|</span><a href="#40021287">parent</a><span>|</span><a href="#40021226">next</a><span>|</span><label class="collapse" for="c-40021592">[-]</label><label class="expand" for="c-40021592">[1 more]</label></div><br/><div class="children"><div class="content">Invalid memory write apparently: <a href="https:&#x2F;&#x2F;www.mail-archive.com&#x2F;valgrind-users@lists.sourceforge.net&#x2F;msg07546.html" rel="nofollow">https:&#x2F;&#x2F;www.mail-archive.com&#x2F;valgrind-users@lists.sourceforg...</a>
The valgrind &quot;fix&quot; was to disable ifunc which disabled the backdoor so the errors went away.<p>The slowness derived from all the symbol and instruction lookups it did afaik</div><br/></div></div></div></div><div id="40021226" class="c"><input type="checkbox" id="c-40021226" checked=""/><div class="controls bullet"><span class="by">buster</span><span>|</span><a href="#40021287">prev</a><span>|</span><a href="#40020048">next</a><span>|</span><label class="collapse" for="c-40021226">[-]</label><label class="expand" for="c-40021226">[5 more]</label></div><br/><div class="children"><div class="content">What I am really curious about is what caused the initial delay in ssh which was what triggered the research into xz in the first place. Has someone figured that out?</div><br/><div id="40021335" class="c"><input type="checkbox" id="c-40021335" checked=""/><div class="controls bullet"><span class="by">pja</span><span>|</span><a href="#40021226">parent</a><span>|</span><a href="#40020048">next</a><span>|</span><label class="collapse" for="c-40021335">[-]</label><label class="expand" for="c-40021335">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s doing an extra ECC operation on every connection, but that shouldn&#x27;t take 500ms on a modern CPU.<p>The people who have reverse engineered the code say it also requires the command message to be bound to the ssh host key as well, so if the host key is an RSA key then it might be doing an extra RSA decryption operation on every connection as well?<p>That would probably do it.</div><br/><div id="40021479" class="c"><input type="checkbox" id="c-40021479" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#40021226">root</a><span>|</span><a href="#40021335">parent</a><span>|</span><a href="#40020048">next</a><span>|</span><label class="collapse" for="c-40021479">[-]</label><label class="expand" for="c-40021479">[3 more]</label></div><br/><div class="children"><div class="content">I believe it&#x27;s all the ELF parsing and disassembly in memory that happens on startup.<p>The really went crazy with the home-made x86 disassembler and everything they do with it. Must have been super fun to write though! Someone clearly had a great time coming up with clever ideas for a backdoor.</div><br/><div id="40021515" class="c"><input type="checkbox" id="c-40021515" checked=""/><div class="controls bullet"><span class="by">pja</span><span>|</span><a href="#40021226">root</a><span>|</span><a href="#40021479">parent</a><span>|</span><a href="#40020048">next</a><span>|</span><label class="collapse" for="c-40021515">[-]</label><label class="expand" for="c-40021515">[2 more]</label></div><br/><div class="children"><div class="content">That only happens once at startup though?<p>IIRC the original detection was because sshd was using a lot more CPU coping with the torrent of spam connections any sshd on the internet gets than it usually would.</div><br/><div id="40021602" class="c"><input type="checkbox" id="c-40021602" checked=""/><div class="controls bullet"><span class="by">tux3</span><span>|</span><a href="#40021226">root</a><span>|</span><a href="#40021515">parent</a><span>|</span><a href="#40020048">next</a><span>|</span><label class="collapse" for="c-40021602">[-]</label><label class="expand" for="c-40021602">[1 more]</label></div><br/><div class="children"><div class="content">ssh forks a new clean process for each connection, so this whole machinery happens each time you connect. Each connection is a full fork&#x2F;exec, and the backdoor has to set itself up from scratch again, including all the parsing and hooking.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40020048" class="c"><input type="checkbox" id="c-40020048" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#40021226">prev</a><span>|</span><a href="#40020801">next</a><span>|</span><label class="collapse" for="c-40020048">[-]</label><label class="expand" for="c-40020048">[13 more]</label></div><br/><div class="children"><div class="content">I saw the xz repo is back on GitHub, Lasse and a new contributor were cleaning it up. They removed ifunc support and they committed code to generate test files into the repo, so that they can do test files without blobs. It looks like they&#x27;re doing good stuff.</div><br/><div id="40020076" class="c"><input type="checkbox" id="c-40020076" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#40020048">parent</a><span>|</span><a href="#40020801">next</a><span>|</span><label class="collapse" for="c-40020076">[-]</label><label class="expand" for="c-40020076">[12 more]</label></div><br/><div class="children"><div class="content">&gt; a new contributor<p>Jia Tan, is that you?</div><br/><div id="40020141" class="c"><input type="checkbox" id="c-40020141" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020076">parent</a><span>|</span><a href="#40020404">next</a><span>|</span><label class="collapse" for="c-40020141">[-]</label><label class="expand" for="c-40020141">[1 more]</label></div><br/><div class="children"><div class="content">Very funny. This one:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;tukaani-project&#x2F;xz&#x2F;commits?author=thesamesam">https:&#x2F;&#x2F;github.com&#x2F;tukaani-project&#x2F;xz&#x2F;commits?author=thesame...</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;thesamesam">https:&#x2F;&#x2F;github.com&#x2F;thesamesam</a><p>Seems like he&#x27;s a Gentoo contributor.</div><br/></div></div><div id="40020404" class="c"><input type="checkbox" id="c-40020404" checked=""/><div class="controls bullet"><span class="by">willsmith72</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020076">parent</a><span>|</span><a href="#40020141">prev</a><span>|</span><a href="#40020801">next</a><span>|</span><label class="collapse" for="c-40020404">[-]</label><label class="expand" for="c-40020404">[10 more]</label></div><br/><div class="children"><div class="content">I know part of the fun of oss is anyone can contribute behind an anonymous github username, but is this a wake up call for the package owners?<p>Do we need at least some form of basic identity verification (even in the form of an employer link, LinkedIn, or similar)?</div><br/><div id="40020501" class="c"><input type="checkbox" id="c-40020501" checked=""/><div class="controls bullet"><span class="by">CiPHPerCoder</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020404">parent</a><span>|</span><a href="#40020573">next</a><span>|</span><label class="collapse" for="c-40020501">[-]</label><label class="expand" for="c-40020501">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve argued in a blog post [1] that we need to delineate between &quot;open source developer&quot; and &quot;supplier&quot;. If we don&#x27;t do that, calling thankless unpaid volunteers and hobbyists a &quot;supply chain&quot; is kind of insulting [2].<p>I don&#x27;t believe that &quot;identity verification&quot; for F&#x2F;OSS developers is a good idea. Suppliers? Sure. That can be a contract negotiation when you decide how much you pay for it.<p>Also, I don&#x27;t think identity verification helps when your adversary is a nation state, which can just falsify government identification if it suits them.<p>[1] <a href="https:&#x2F;&#x2F;scottarc.blog&#x2F;2024&#x2F;04&#x2F;04&#x2F;open-source-supply-chains-and-bears-oh-my&#x2F;" rel="nofollow">https:&#x2F;&#x2F;scottarc.blog&#x2F;2024&#x2F;04&#x2F;04&#x2F;open-source-supply-chains-a...</a><p>[2] <a href="https:&#x2F;&#x2F;crankysec.com&#x2F;blog&#x2F;supply&#x2F;" rel="nofollow">https:&#x2F;&#x2F;crankysec.com&#x2F;blog&#x2F;supply&#x2F;</a></div><br/><div id="40020529" class="c"><input type="checkbox" id="c-40020529" checked=""/><div class="controls bullet"><span class="by">xcrunner529</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020501">parent</a><span>|</span><a href="#40020573">next</a><span>|</span><label class="collapse" for="c-40020529">[-]</label><label class="expand" for="c-40020529">[3 more]</label></div><br/><div class="children"><div class="content">Just because it can by beaten doesn’t mean making it harder isn’t useful. This person&#x2F;team used a VPN. Masking your location is a big red flag for just dev work like this. These things could be exposed in UI.</div><br/><div id="40020546" class="c"><input type="checkbox" id="c-40020546" checked=""/><div class="controls bullet"><span class="by">CiPHPerCoder</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020529">parent</a><span>|</span><a href="#40020573">next</a><span>|</span><label class="collapse" for="c-40020546">[-]</label><label class="expand" for="c-40020546">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Just because it can by beaten doesn’t mean making it harder isn’t useful.<p>Fair.<p>&gt; This person&#x2F;team used a VPN. Masking your location is a big red flag for just dev work like this. These things could be exposed in UI.<p>I disagree strongly, and am surprised to hear this argument on <i>Hacker News</i> of all places.</div><br/><div id="40020765" class="c"><input type="checkbox" id="c-40020765" checked=""/><div class="controls bullet"><span class="by">ogurechny</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020546">parent</a><span>|</span><a href="#40020573">next</a><span>|</span><label class="collapse" for="c-40020765">[-]</label><label class="expand" for="c-40020765">[1 more]</label></div><br/><div class="children"><div class="content">People are so used to see artificial bureaucratic structures as more real than their real counterparts that they constantly invent such naive solutions. “Just make the gub&#x27;ment provide an official paper (with a stamp) that Joe Random Dude is a real developer, a father of two, not a fan of satanic metal music, and the project will be safe”.</div><br/></div></div></div></div></div></div></div></div><div id="40020573" class="c"><input type="checkbox" id="c-40020573" checked=""/><div class="controls bullet"><span class="by">usefulcat</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020404">parent</a><span>|</span><a href="#40020501">prev</a><span>|</span><a href="#40020655">next</a><span>|</span><label class="collapse" for="c-40020573">[-]</label><label class="expand" for="c-40020573">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Do we need at least some form of basic identity verification<p>For dedicated attackers (as was the case here) that will move the goal posts ever so slightly farther away, but not much else. I see how it&#x27;s tempting to focus on identity, but I don&#x27;t see how it&#x27;s productive.</div><br/></div></div><div id="40020655" class="c"><input type="checkbox" id="c-40020655" checked=""/><div class="controls bullet"><span class="by">redox99</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020404">parent</a><span>|</span><a href="#40020573">prev</a><span>|</span><a href="#40020473">next</a><span>|</span><label class="collapse" for="c-40020655">[-]</label><label class="expand" for="c-40020655">[3 more]</label></div><br/><div class="children"><div class="content">State actors (probably the case here) can handle all that stuff.</div><br/><div id="40021248" class="c"><input type="checkbox" id="c-40021248" checked=""/><div class="controls bullet"><span class="by">danieldk</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020655">parent</a><span>|</span><a href="#40020473">next</a><span>|</span><label class="collapse" for="c-40021248">[-]</label><label class="expand" for="c-40021248">[2 more]</label></div><br/><div class="children"><div class="content">If an identity (known or pseudonymous) was signed by a government, there would at least be some accountability. Like if Jia Tan&#x27;s identity is signed by government X, then there is a good hint that they are a state actor for X or otherwise there is a burden for X to come up with convincing evidence that this is not the case.<p>Obviously, every system is going to have weaknesses, but it would at least introduce some accountability.<p>The main issues are all related to privacy. What if your government is not nice and you don&#x27;t want them to track all your contributions?</div><br/><div id="40021378" class="c"><input type="checkbox" id="c-40021378" checked=""/><div class="controls bullet"><span class="by">wasmitnetzen</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40021248">parent</a><span>|</span><a href="#40020473">next</a><span>|</span><label class="collapse" for="c-40021378">[-]</label><label class="expand" for="c-40021378">[1 more]</label></div><br/><div class="children"><div class="content">Let&#x27;s say we would have definite proof that this was a Chinese op. Then what? No other government is gonna complain too hard because they know that their own agencies are doing the very same thing too.<p>Additionally, creating fake identities in other states is base level spying.</div><br/></div></div></div></div></div></div><div id="40020473" class="c"><input type="checkbox" id="c-40020473" checked=""/><div class="controls bullet"><span class="by">some_furry</span><span>|</span><a href="#40020048">root</a><span>|</span><a href="#40020404">parent</a><span>|</span><a href="#40020655">prev</a><span>|</span><a href="#40020801">next</a><span>|</span><label class="collapse" for="c-40020473">[-]</label><label class="expand" for="c-40020473">[1 more]</label></div><br/><div class="children"><div class="content">No. I love contributing as my fursona sometimes. I don&#x27;t want to dox myself to do so.<p>We shouldn&#x27;t need to know who you are to be verify that your contribution is trustworthy. Code should stand on its own merits. Ideas like this tend to dovetail into &quot;real name policies&quot;, which suck <a href="https:&#x2F;&#x2F;www.eff.org&#x2F;deeplinks&#x2F;2014&#x2F;09&#x2F;facebooks-real-name-policy-can-cause-real-world-harm-lgbtq-community" rel="nofollow">https:&#x2F;&#x2F;www.eff.org&#x2F;deeplinks&#x2F;2014&#x2F;09&#x2F;facebooks-real-name-po...</a></div><br/></div></div></div></div></div></div></div></div><div id="40020801" class="c"><input type="checkbox" id="c-40020801" checked=""/><div class="controls bullet"><span class="by">matt3210</span><span>|</span><a href="#40020048">prev</a><span>|</span><a href="#40021093">next</a><span>|</span><label class="collapse" for="c-40020801">[-]</label><label class="expand" for="c-40020801">[1 more]</label></div><br/><div class="children"><div class="content">I hope there aren’t any like this which went unnoticed :-(</div><br/></div></div><div id="40021093" class="c"><input type="checkbox" id="c-40021093" checked=""/><div class="controls bullet"><span class="by">levleontiev</span><span>|</span><a href="#40020801">prev</a><span>|</span><a href="#40021461">next</a><span>|</span><label class="collapse" for="c-40021093">[-]</label><label class="expand" for="c-40021093">[3 more]</label></div><br/><div class="children"><div class="content">Sorry if I trigger anyone&#x27;s paranoia, but 
1. who told you that it&#x27;s not a state-backed attack?
2. and if 1 is true, who told it, it&#x27;s not Russia staying behind it?<p>and if 2 is true, the KGB university alumni Kaspersky definitely is related to it.</div><br/><div id="40021147" class="c"><input type="checkbox" id="c-40021147" checked=""/><div class="controls bullet"><span class="by">thrdbndndn</span><span>|</span><a href="#40021093">parent</a><span>|</span><a href="#40021461">next</a><span>|</span><label class="collapse" for="c-40021147">[-]</label><label class="expand" for="c-40021147">[2 more]</label></div><br/><div class="children"><div class="content">And it&#x27;s relevant to the article because?</div><br/><div id="40021555" class="c"><input type="checkbox" id="c-40021555" checked=""/><div class="controls bullet"><span class="by">fodmap</span><span>|</span><a href="#40021093">root</a><span>|</span><a href="#40021147">parent</a><span>|</span><a href="#40021461">next</a><span>|</span><label class="collapse" for="c-40021555">[-]</label><label class="expand" for="c-40021555">[1 more]</label></div><br/><div class="children"><div class="content">I suppose they say that because the article has been written by Kaspersky, and it&#x27;s hosted on a server under their control?</div><br/></div></div></div></div></div></div><div id="40021461" class="c"><input type="checkbox" id="c-40021461" checked=""/><div class="controls bullet"><span class="by">lyu07282</span><span>|</span><a href="#40021093">prev</a><span>|</span><a href="#40020330">next</a><span>|</span><label class="collapse" for="c-40021461">[-]</label><label class="expand" for="c-40021461">[1 more]</label></div><br/><div class="children"><div class="content">The authors show a great deal of knowledge of glibc internals, the sort of things you really have to be neck deep in the source code for. Lots of novel techniques in there.<p>The custom elf parser and disassembler are so complex that I can&#x27;t imagine they didn&#x27;t use that code &#x2F; or will never use that code for something else in the future.<p>I wonder if this gets the serious investigation it deserves, but I doubt it.</div><br/></div></div><div id="40020164" class="c"><input type="checkbox" id="c-40020164" checked=""/><div class="controls bullet"><span class="by">m3kw9</span><span>|</span><a href="#40020330">prev</a><span>|</span><a href="#40019383">next</a><span>|</span><label class="collapse" for="c-40020164">[-]</label><label class="expand" for="c-40020164">[1 more]</label></div><br/><div class="children"><div class="content">I’ve seen some google zero day vulnerability hack analysis and those looked out of this world but this hack must be one of the all time</div><br/></div></div><div id="40021061" class="c"><input type="checkbox" id="c-40021061" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#40019383">prev</a><span>|</span><a href="#40021146">next</a><span>|</span><label class="collapse" for="c-40021061">[-]</label><label class="expand" for="c-40021061">[5 more]</label></div><br/><div class="children"><div class="content">Why is &quot;hooking&quot; allowed at all in non-debug code? The legit applications all involve tracing or profiling.</div><br/><div id="40021081" class="c"><input type="checkbox" id="c-40021081" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40021061">parent</a><span>|</span><a href="#40021146">next</a><span>|</span><label class="collapse" for="c-40021081">[-]</label><label class="expand" for="c-40021081">[4 more]</label></div><br/><div class="children"><div class="content">What does &quot;non-debug&quot; code mean in this context?  Most distros compile everything with -g and then separate out the debug symbols into a different package, because you almost always want to be able to attach gdb to any process when something goes wrong (and no, recompiling at that point is a much worse idea, because it means installing compilers on your production system as well as not being able to debug what was actually running).<p>It doesn&#x27;t matter anyway, because once you&#x27;re running inside a process you can do most anything you like.  This was a convenient mechanism, but there are scores of ways to scan over the symbols and modify code inside the same process.</div><br/><div id="40021179" class="c"><input type="checkbox" id="c-40021179" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#40021061">root</a><span>|</span><a href="#40021081">parent</a><span>|</span><a href="#40021146">next</a><span>|</span><label class="collapse" for="c-40021179">[-]</label><label class="expand" for="c-40021179">[3 more]</label></div><br/><div class="children"><div class="content">&quot;You almost always want to be able to attach gdb to any process when something goes wrong&quot;.<p>Now, this is why we can&#x27;t have secure systems.<p>Somehow, I&#x27;ve never needed to attach GDB to a running process. Start up programs under GDB, yes. Read crash dumps, yes. If you&#x27;re using a debugger in a production system, something has gone horribly wrong.</div><br/><div id="40021286" class="c"><input type="checkbox" id="c-40021286" checked=""/><div class="controls bullet"><span class="by">troad</span><span>|</span><a href="#40021061">root</a><span>|</span><a href="#40021179">parent</a><span>|</span><a href="#40021495">next</a><span>|</span><label class="collapse" for="c-40021286">[-]</label><label class="expand" for="c-40021286">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If you&#x27;re using a debugger in a production system, something has gone horribly wrong.<p>That&#x27;s right, hence the debugger.</div><br/></div></div><div id="40021495" class="c"><input type="checkbox" id="c-40021495" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40021061">root</a><span>|</span><a href="#40021179">parent</a><span>|</span><a href="#40021286">prev</a><span>|</span><a href="#40021146">next</a><span>|</span><label class="collapse" for="c-40021495">[-]</label><label class="expand" for="c-40021495">[1 more]</label></div><br/><div class="children"><div class="content">Or you want to capture accurate core dumps for a tool like ABRT.  We (Red Hat) work very closely with customers to find out what is and isn&#x27;t acceptable to be running on their production systems, including customers who store very sensitive data.</div><br/></div></div></div></div></div></div></div></div><div id="40021146" class="c"><input type="checkbox" id="c-40021146" checked=""/><div class="controls bullet"><span class="by">noname120</span><span>|</span><a href="#40021061">prev</a><span>|</span><a href="#40020976">next</a><span>|</span><label class="collapse" for="c-40021146">[-]</label><label class="expand" for="c-40021146">[1 more]</label></div><br/><div class="children"><div class="content">What proves us that tukaani and jiaT75 aren&#x27;t the same person? Creating a new nickname and handing write access to it sounds like the perfect way to shift blame and claim that his trust was betrayed once the backdoor is found out.</div><br/></div></div><div id="40020976" class="c"><input type="checkbox" id="c-40020976" checked=""/><div class="controls bullet"><span class="by">TheSeeker11</span><span>|</span><a href="#40021146">prev</a><span>|</span><a href="#40020885">next</a><span>|</span><label class="collapse" for="c-40020976">[-]</label><label class="expand" for="c-40020976">[2 more]</label></div><br/><div class="children"><div class="content">I was rather amused to see Chris Titus announce that &quot;XZ Backdoor is NOT that bad!&quot; He seems to have done next to no research into this <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=s_WkMtEPsuE" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=s_WkMtEPsuE</a></div><br/><div id="40021067" class="c"><input type="checkbox" id="c-40021067" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40020976">parent</a><span>|</span><a href="#40020885">next</a><span>|</span><label class="collapse" for="c-40021067">[-]</label><label class="expand" for="c-40021067">[1 more]</label></div><br/><div class="children"><div class="content">Never heard of him before but after watching 10 seconds he seems like an idiot.</div><br/></div></div></div></div><div id="40020885" class="c"><input type="checkbox" id="c-40020885" checked=""/><div class="controls bullet"><span class="by">ogurechny</span><span>|</span><a href="#40020976">prev</a><span>|</span><label class="collapse" for="c-40020885">[-]</label><label class="expand" for="c-40020885">[2 more]</label></div><br/><div class="children"><div class="content">As an armchair specialist, I don&#x27;t support the “owning each ssh server on the planet” reactions.<p>Public networks have too many eyes potentially (not just the admins responsible for specific systems). Traffic to ssh server that corresponds to suspicious activity but is also absent from logs would raise the alarms quite soon.<p>Hooking the build process also means that the main targets are places that are important enough to have their own siloed software repositories. Getting into two LTS systems was a bonus. I suppose that simpler exploits are available for popular systems (if they run regular complex applications instead of being a minimal empty box that securely does nothing).<p>The number of modification&#x2F;decryption layers is probably not arbitrary. Most likely, each was added to evade detection by one or another protection system you and I don&#x27;t know about, but with which attacker is familiar.</div><br/><div id="40021291" class="c"><input type="checkbox" id="c-40021291" checked=""/><div class="controls bullet"><span class="by">raggi</span><span>|</span><a href="#40020885">parent</a><span>|</span><label class="collapse" for="c-40021291">[-]</label><label class="expand" for="c-40021291">[1 more]</label></div><br/><div class="children"><div class="content">Can you point to an URL where a system has a documented or implemented configuration that correlates traffic to log entries in a manner that can be alarmed on without just going off all the time?<p>Junk packets to port 22 arrive all the time.</div><br/></div></div></div></div></div></div></div></div></div></body></html>