<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1688115646420" as="style"/><link rel="stylesheet" href="styles.css?v=1688115646420"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://gfw.report/publications/usenixsecurity23/data/paper/paper.pdf">How the Great Firewall of China Detects and Blocks Fully Encrypted Traffic [pdf]</a> <span class="domain">(<a href="https://gfw.report">gfw.report</a>)</span></div><div class="subtext"><span>mngnt</span> | <span>16 comments</span></div><br/><div><div id="36531827" class="c"><input type="checkbox" id="c-36531827" checked=""/><div class="controls bullet"><span class="by">WinstonSmith84</span><span>|</span><a href="#36531834">next</a><span>|</span><label class="collapse" for="c-36531827">[-]</label><label class="expand" for="c-36531827">[1 more]</label></div><br/><div class="children"><div class="content">I was wondering about simply using VPNs, which is not mentioned in the article at all, but checking GFW on Wikipedia, it tells:<p>&gt; The use of VPNs in China can provide individuals access to the international internet, but in China, it can be a potential legal risk. In 2017, the Chinese government declared all unauthorized VPN services to be illegal.[94] An example of the use of this punishment is Vera Zhou, a student at the University of Washington, who, when visiting her Hui parents in Xinjiang, China, used a VPN to access her school homework. She was arrested and sent to a Xinjiang internment camp from October 2017 until March 2018, followed by house arrest after her release. She was not able to return to the US until September 2019.[95][96]</div><br/></div></div><div id="36531834" class="c"><input type="checkbox" id="c-36531834" checked=""/><div class="controls bullet"><span class="by">jiggywiggy</span><span>|</span><a href="#36531827">prev</a><span>|</span><a href="#36531990">next</a><span>|</span><label class="collapse" for="c-36531834">[-]</label><label class="expand" for="c-36531834">[1 more]</label></div><br/><div class="children"><div class="content">Yeah already 10-12 years ago was clear.<p>My university vpn only worked for a few days while studying in China.<p>But there is this tiny little vpn software being spread around. Not sure if it&#x27;s true but I remember it&#x27;s falun gong teaming up with the CIA. Which at the time was able to go undetected, I think they keep rotating the IPS or something.<p>Was interesting how fast that tool spread &quot;offline&quot; between international students. Also Chinese have it but its less known among them.<p>Not sure if it still works:<a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Freegate" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Freegate</a><p>[Edit] Here is an old hn comment saying it doesn&#x27;t work anymore and other options that are also hard;<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=10101965">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=10101965</a></div><br/></div></div><div id="36531990" class="c"><input type="checkbox" id="c-36531990" checked=""/><div class="controls bullet"><span class="by">Renaud</span><span>|</span><a href="#36531834">prev</a><span>|</span><a href="#36532134">next</a><span>|</span><label class="collapse" for="c-36531990">[-]</label><label class="expand" for="c-36531990">[2 more]</label></div><br/><div class="children"><div class="content">I remember having to deal with the early GFW about 20 years ago when I was working for a company that had some employees on a site in Shanghai.<p>Every morning, our colleagues in China would open their mail client and it would connect to our server abroad.<p>The first person would usually be OK, but for everyone else, the connection would fail.<p>At the time, almost nothing was known of the GFW and it wasn&#x27;t as clever as it is now. I found out that the POP connection was quickly blocked after a few minutes, probably triggering some slow firewall rules along the way (it seemed a bit random, so I assumed the firewall setup wasn&#x27;t unified).<p>Moving to POPS&#x2F;SMTPS seemed to improve things for a while, but the connection would still be randomly blocked.<p>What worked in the end was to use a bunch of random ports instead of the well known ones to accept POP&#x2F;SMTP connections on the server, and we never had any issues after that, at least until we changed system a couple of years later.</div><br/><div id="36532108" class="c"><input type="checkbox" id="c-36532108" checked=""/><div class="controls bullet"><span class="by">dizhn</span><span>|</span><a href="#36531990">parent</a><span>|</span><a href="#36532134">next</a><span>|</span><label class="collapse" for="c-36532108">[-]</label><label class="expand" for="c-36532108">[1 more]</label></div><br/><div class="children"><div class="content">We have a satellite office in Dubai. I know their static IP. When they connect to our imap&#x2F;smtp server they are coming in from another IP. I never looked into it deeply but assumed their connection is being diverted for inspection. (If true, they would probably not be below performing industrial espionage with the data they are accessing)</div><br/></div></div></div></div><div id="36532134" class="c"><input type="checkbox" id="c-36532134" checked=""/><div class="controls bullet"><span class="by">mdhb</span><span>|</span><a href="#36531990">prev</a><span>|</span><a href="#36531879">next</a><span>|</span><label class="collapse" for="c-36532134">[-]</label><label class="expand" for="c-36532134">[1 more]</label></div><br/><div class="children"><div class="content">Limited use cases but for moving info in and out of a system like this you should be able to use this <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Chaffing_and_winnowing" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Chaffing_and_winnowing</a></div><br/></div></div><div id="36531879" class="c"><input type="checkbox" id="c-36531879" checked=""/><div class="controls bullet"><span class="by">JPLeRouzic</span><span>|</span><a href="#36532134">prev</a><span>|</span><a href="#36531767">next</a><span>|</span><label class="collapse" for="c-36531879">[-]</label><label class="expand" for="c-36531879">[4 more]</label></div><br/><div class="children"><div class="content">The algorithm found seems so unintuitive that I wonder if it was not found by the AI.<p>&quot;<i>Allow a connection to continue if the first TCP payload (pkt)
sent by the client satisfies any of the following exemptions:<p>Ex1:
popcount(pkt)
len(pkt) ≤ 3.4 or popcount(pkt)
len(pkt) ≥ 4.6.<p>Ex2: The first six (or more) bytes of pkt are [0x20,0x7e].<p>Ex3: More than 50% of pkt’s bytes are [0x20,0x7e].<p>Ex4: More than 20 contiguous bytes of pkt are [0x20,0x7e].<p>Ex5: It matches the protocol fingerprint for TLS or HTTP.<p>Block if none of the above hold.</i>&quot;</div><br/><div id="36532034" class="c"><input type="checkbox" id="c-36532034" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#36531879">parent</a><span>|</span><a href="#36531973">next</a><span>|</span><label class="collapse" for="c-36532034">[-]</label><label class="expand" for="c-36532034">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I wonder if it was not found by the AI.<p>Do you mean &quot;found&quot; by the CCP, or &quot;found&quot; by the researchers? In the case of the CCP it was likely generated through basic statistical analysis, and tuned to minimize side effects and collateral damage below some threshold of acceptability (~0.6% of global traffic unintentionally blocked). In the case of the researchers, the paper details the basic statistical analysis used to discover these rules.</div><br/></div></div><div id="36531973" class="c"><input type="checkbox" id="c-36531973" checked=""/><div class="controls bullet"><span class="by">vbezhenar</span><span>|</span><a href="#36531879">parent</a><span>|</span><a href="#36532034">prev</a><span>|</span><a href="#36531767">next</a><span>|</span><label class="collapse" for="c-36531973">[-]</label><label class="expand" for="c-36531973">[2 more]</label></div><br/><div class="children"><div class="content">This is just some experimentation results, it&#x27;s not algorithm.</div><br/><div id="36531999" class="c"><input type="checkbox" id="c-36531999" checked=""/><div class="controls bullet"><span class="by">amrocha</span><span>|</span><a href="#36531879">root</a><span>|</span><a href="#36531973">parent</a><span>|</span><a href="#36531767">next</a><span>|</span><label class="collapse" for="c-36531999">[-]</label><label class="expand" for="c-36531999">[1 more]</label></div><br/><div class="children"><div class="content">An algorithm is just a bunch of rules to follow to perform an operation, so this looks like an algorithm to me.</div><br/></div></div></div></div></div></div><div id="36531767" class="c"><input type="checkbox" id="c-36531767" checked=""/><div class="controls bullet"><span class="by">Ballas</span><span>|</span><a href="#36531879">prev</a><span>|</span><label class="collapse" for="c-36531767">[-]</label><label class="expand" for="c-36531767">[6 more]</label></div><br/><div class="children"><div class="content">Seems like UDP is completely exempt, which would allow UDP-based VPNs, like Wireguard through.<p>SSH is also exempt...</div><br/><div id="36531996" class="c"><input type="checkbox" id="c-36531996" checked=""/><div class="controls bullet"><span class="by">sysstemlord</span><span>|</span><a href="#36531767">parent</a><span>|</span><a href="#36532021">next</a><span>|</span><label class="collapse" for="c-36531996">[-]</label><label class="expand" for="c-36531996">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d go for ssh if I was trying to bypass it. At least legally I can claim that I&#x27;m just sshing to my aws server and not be jailed for using vpn.</div><br/></div></div><div id="36532021" class="c"><input type="checkbox" id="c-36532021" checked=""/><div class="controls bullet"><span class="by">lordnacho</span><span>|</span><a href="#36531767">parent</a><span>|</span><a href="#36531996">prev</a><span>|</span><a href="#36531850">next</a><span>|</span><label class="collapse" for="c-36532021">[-]</label><label class="expand" for="c-36532021">[1 more]</label></div><br/><div class="children"><div class="content">Why would they let that happen? Doesn&#x27;t seem to make any sense to me if it&#x27;s how you describe it.</div><br/></div></div><div id="36531850" class="c"><input type="checkbox" id="c-36531850" checked=""/><div class="controls bullet"><span class="by">WinstonSmith84</span><span>|</span><a href="#36531767">parent</a><span>|</span><a href="#36532021">prev</a><span>|</span><label class="collapse" for="c-36531850">[-]</label><label class="expand" for="c-36531850">[3 more]</label></div><br/><div class="children"><div class="content">that&#x27;s mentioned at the end of Page 17. The author tells it&#x27;s a short term solution: &quot;This is merely a stopgap measure, as the censor can enable their censorship for UDP.&quot;<p>It doesn&#x27;t seem that there are any (long term) solution to bypass the rules ...</div><br/><div id="36531907" class="c"><input type="checkbox" id="c-36531907" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#36531767">root</a><span>|</span><a href="#36531850">parent</a><span>|</span><a href="#36531872">next</a><span>|</span><label class="collapse" for="c-36531907">[-]</label><label class="expand" for="c-36531907">[1 more]</label></div><br/><div class="children"><div class="content">It does seem like this GFW scheme can be tuned to severely degrade the reliability of any <i>unapproved high entropy</i> traffic. However, this single scheme doesn&#x27;t cover many other types of circumvention traffic, several of which are noted in the beginning of the paper. This scheme primarily applies to &quot;fully encrypted&quot; traffic - not SSL&#x2F;TLS, etc.<p>So for now, circumvention can live on, but this explains to everyone using fully encrypted protocols exactly why their connections would have been degraded over the past couple years. In the long term, steganography will probably work well as long as users are able to endure much higher costs for traffic (low ratio of true data to apparent data) and as long as the steganographic systems are effective at hiding any statistical fingerprints (very difficult). Protocol mimicry is another strategy, but a paper cited in this work details why successful protocol mimicry is very difficult.[0]<p>Attempts to disguise circumvention traffic as typical traffic is very difficult, because a lot of fingerprinting information can be gleaned from handshakes and headers. The draw of fully encrypted traffic is that it provides very little variation which can be used to fingerprint and classify different types of usages. However, it&#x27;s also easy to detect and block en masse -- that much is obvious, but this paper does a great job of showing how China does it and inferences can be made from that to provide a view into China&#x27;s priorities (how much cost they&#x27;re willing to incur, rates of false positives they feel is acceptable). Overall, China&#x27;s blocking current appears to be fairly conservative here, with relatively low rates of false positives.<p>In wider context, China is constantly updating their detection schemes, they&#x27;re quite competent at it, and anything which doesn&#x27;t match typical traffic is at risk.<p>0: <a href="https:&#x2F;&#x2F;people.cs.umass.edu&#x2F;~amir&#x2F;papers&#x2F;parrot.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;people.cs.umass.edu&#x2F;~amir&#x2F;papers&#x2F;parrot.pdf</a></div><br/></div></div><div id="36531872" class="c"><input type="checkbox" id="c-36531872" checked=""/><div class="controls bullet"><span class="by">throwawayadvsec</span><span>|</span><a href="#36531767">root</a><span>|</span><a href="#36531850">parent</a><span>|</span><a href="#36531907">prev</a><span>|</span><label class="collapse" for="c-36531872">[-]</label><label class="expand" for="c-36531872">[1 more]</label></div><br/><div class="children"><div class="content">steganography?</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>