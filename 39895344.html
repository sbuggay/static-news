<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712048452241" as="style"/><link rel="stylesheet" href="styles.css?v=1712048452241"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/amlweems/xzbot">Xzbot: Notes, honeypot, and exploit demo for the xz backdoor</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>q3k</span> | <span>412 comments</span></div><br/><div><div id="39902555" class="c"><input type="checkbox" id="c-39902555" checked=""/><div class="controls bullet"><span class="by">bilekas</span><span>|</span><a href="#39896221">next</a><span>|</span><label class="collapse" for="c-39902555">[-]</label><label class="expand" for="c-39902555">[7 more]</label></div><br/><div class="children"><div class="content">This whole thing has been consuming me over the whole weekend. The mechanisms are interesting and a collection of great obfuscations, the social engineering is a story that’s shamefully all too familiar for open source maintainers.<p>I find most interesting how they chose their attack vector of using BAD test data, it makes the rest of the steps incredibly easier when you have a good archive, manipulate it in a structured method (this should show on a graph of the binary pattern btw for future reference) then use it for a fuzzy bad data test. It’s great.<p>The rest of the techniques are banal enough except the most brilliant move seems to be that they could add “patches” or even whole new back doors using the same pattern on a different test file. Without being noticed.<p>Really really interesting, GitHub shouldn’t have hidden and removed the repo though. It’s not helpful at all to work through this whole drama.<p>Edit: I don’t mean to say this is banal in any way, but once the payload was decided and achieved through a super clever idea, the rest was just great obfuscation.</div><br/><div id="39902916" class="c"><input type="checkbox" id="c-39902916" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39902555">parent</a><span>|</span><a href="#39902590">next</a><span>|</span><label class="collapse" for="c-39902916">[-]</label><label class="expand" for="c-39902916">[3 more]</label></div><br/><div class="children"><div class="content">It’s got me suspicious of build-time dependency we have in an open source tool, where the dependency goes out of its way to prefer xz and we even discovered that it installs xz on the host machine if it isn’t already installed — as a convenience. Kinda weird because it didn’t do that for any other dependencies.<p>These long-games are kinda scary and until whatever “evil” is actually done you have no idea what is actually malicious or just weird.</div><br/><div id="39903225" class="c"><input type="checkbox" id="c-39903225" checked=""/><div class="controls bullet"><span class="by">ToneWashed</span><span>|</span><a href="#39902555">root</a><span>|</span><a href="#39902916">parent</a><span>|</span><a href="#39902590">next</a><span>|</span><label class="collapse" for="c-39903225">[-]</label><label class="expand" for="c-39903225">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It’s got me suspicious of build-time dependency we have in an open source tool, where the dependency goes out of its way to prefer xz and we even discovered that it installs xz on the host machine if it isn’t already installed — as a convenience. Kinda weird because it didn’t do that for any other dependencies.<p>Have you considered reaching out to the maintainers of that project and (politely) asking them to explain? In lieu of recent events I don&#x27;t think anyone would blame you, in fact you might even suggest they explain such an oddly specific side effect in a README or such.</div><br/><div id="39903251" class="c"><input type="checkbox" id="c-39903251" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39902555">root</a><span>|</span><a href="#39903225">parent</a><span>|</span><a href="#39902590">next</a><span>|</span><label class="collapse" for="c-39903251">[-]</label><label class="expand" for="c-39903251">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Have you considered reaching out to the maintainers of that project and (politely) asking them to explain?<p>That&#x27;s kind of a catch-22, right? They&#x27;d explain with a seemingly good answer if they did it for actual reasons. They&#x27;ll still explain with a seemingly good answer if they did it for nefarious reasons.<p>I don&#x27;t have a good answer to this except to monitor this dependency and its changes.</div><br/></div></div></div></div></div></div><div id="39902590" class="c"><input type="checkbox" id="c-39902590" checked=""/><div class="controls bullet"><span class="by">mondrian</span><span>|</span><a href="#39902555">parent</a><span>|</span><a href="#39902916">prev</a><span>|</span><a href="#39896221">next</a><span>|</span><label class="collapse" for="c-39902590">[-]</label><label class="expand" for="c-39902590">[3 more]</label></div><br/><div class="children"><div class="content">A main culprit seems to be the addition of binary files to the repo, to be used as test inputs. Especially if these files are “binary garbage” to prove a test fails. Seems like an obvious place to hide malicious stuff.</div><br/><div id="39902634" class="c"><input type="checkbox" id="c-39902634" checked=""/><div class="controls bullet"><span class="by">bilekas</span><span>|</span><a href="#39902555">root</a><span>|</span><a href="#39902590">parent</a><span>|</span><a href="#39896221">next</a><span>|</span><label class="collapse" for="c-39902634">[-]</label><label class="expand" for="c-39902634">[2 more]</label></div><br/><div class="children"><div class="content">It is an obvious place for sure, but it also would have been picked up if the builds where a bit more transperant. That batch build script should have been questioned before approval.</div><br/><div id="39903094" class="c"><input type="checkbox" id="c-39903094" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#39902555">root</a><span>|</span><a href="#39902634">parent</a><span>|</span><a href="#39896221">next</a><span>|</span><label class="collapse" for="c-39903094">[-]</label><label class="expand" for="c-39903094">[1 more]</label></div><br/><div class="children"><div class="content">By whom? The attacker have assumed the maintainer role. Nobody is reviewing.</div><br/></div></div></div></div></div></div></div></div><div id="39896221" class="c"><input type="checkbox" id="c-39896221" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39902555">prev</a><span>|</span><a href="#39895799">next</a><span>|</span><label class="collapse" for="c-39896221">[-]</label><label class="expand" for="c-39896221">[107 more]</label></div><br/><div class="children"><div class="content">It&#x27;s pretty interesting that they didn&#x27;t just introduce an RCE that anyone can exploit, it requires the attacker&#x27;s private key. It&#x27;s ironically a very security conscious vulnerability.</div><br/><div id="39896392" class="c"><input type="checkbox" id="c-39896392" checked=""/><div class="controls bullet"><span class="by">haswell</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39898665">next</a><span>|</span><label class="collapse" for="c-39896392">[-]</label><label class="expand" for="c-39896392">[37 more]</label></div><br/><div class="children"><div class="content">I suspect the original rationale is about preserving the longevity of the backdoor. If you blow a hole wide open that anyone can enter, it’s going to be found and shut down quickly.<p>If this hadn’t had the performance impact that brought it quickly to the surface, it’s possible that this would have lived quietly for a long time exactly because it’s not widely exploitable.</div><br/><div id="39898419" class="c"><input type="checkbox" id="c-39898419" checked=""/><div class="controls bullet"><span class="by">eli</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896392">parent</a><span>|</span><a href="#39897179">next</a><span>|</span><label class="collapse" for="c-39898419">[-]</label><label class="expand" for="c-39898419">[1 more]</label></div><br/><div class="children"><div class="content">More to the point it prevents your enemies from using the exploit against friendly targets.<p>The tradeoff is that, once you find it, it&#x27;s very clearly a backdoor. No way you can pretend this was an innocent bug.</div><br/></div></div><div id="39897179" class="c"><input type="checkbox" id="c-39897179" checked=""/><div class="controls bullet"><span class="by">declan_roberts</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896392">parent</a><span>|</span><a href="#39898419">prev</a><span>|</span><a href="#39901409">next</a><span>|</span><label class="collapse" for="c-39897179">[-]</label><label class="expand" for="c-39897179">[31 more]</label></div><br/><div class="children"><div class="content">I agree that this is probably about persistence. Initially I thought the developer was playing the long-con to dump some crypto exchange and make off with literally a billion dollars or more.<p>But if that was the case they wouldn&#x27;t bother with the key. It&#x27;d be a one-and-done situation. It would be a stop-the-world event.<p>Now it looks more like nation-state spycraft.</div><br/><div id="39897999" class="c"><input type="checkbox" id="c-39897999" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897179">parent</a><span>|</span><a href="#39900218">next</a><span>|</span><label class="collapse" for="c-39897999">[-]</label><label class="expand" for="c-39897999">[18 more]</label></div><br/><div class="children"><div class="content">It&#x27;s worth also noting that the spycraft involved a coordinated harassment campaign of the original maintainer, with multiple writing styles, to accelerate a transition of maintainership to the attacker:<p><a href="https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00566.html" rel="nofollow">https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00566.h...</a><p><a href="https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00568.html" rel="nofollow">https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00568.h...</a><p><a href="https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00569.html" rel="nofollow">https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00569.h...</a><p>While this doesn&#x27;t prove nation-state involvement, it certainly borrows from a wide-ranging playbook of techniques.</div><br/><div id="39898806" class="c"><input type="checkbox" id="c-39898806" checked=""/><div class="controls bullet"><span class="by">mrkramer</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39898785">next</a><span>|</span><label class="collapse" for="c-39898806">[-]</label><label class="expand" for="c-39898806">[3 more]</label></div><br/><div class="children"><div class="content">At first I thought the guy who did this was a lone wolf but now I believe it was indeed state actor. They coordinated and harassed original maintainer into giving them access to the project, basically they hijacked the open source project. The poor guy(the original maintainer) was alone against state actor who was persistent with the goal of hijacking and then backdooring the open source project.<p>It seems like they were actively looking[0] which open source compression library they can inject with vulnerable code and then exploit and backdoor afterwards.<p>[0] <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;967763&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;967763&#x2F;</a></div><br/><div id="39903218" class="c"><input type="checkbox" id="c-39903218" checked=""/><div class="controls bullet"><span class="by">pyinstallwoes</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898806">parent</a><span>|</span><a href="#39899304">next</a><span>|</span><label class="collapse" for="c-39903218">[-]</label><label class="expand" for="c-39903218">[1 more]</label></div><br/><div class="children"><div class="content">&gt; “Recently I&#x27;ve worked off-list a bit with Jia Tan on XZ Utils and”<p>&gt; &quot;In 2021, JiaT75 submitted a pull request to the libarchive repository with the title ‘Added error text to warning when untaring with bsdtar’ which seemed legitimate at first glance. &quot;<p>Seems “Jia” is related to both</div><br/></div></div><div id="39899304" class="c"><input type="checkbox" id="c-39899304" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898806">parent</a><span>|</span><a href="#39903218">prev</a><span>|</span><a href="#39898785">next</a><span>|</span><label class="collapse" for="c-39899304">[-]</label><label class="expand" for="c-39899304">[1 more]</label></div><br/><div class="children"><div class="content">Reading that link, it seems like the vulnerability is that a file name gets printed, so you can add terminal control characters in a file name and have it printed.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;1609#issuecomment-2028125584">https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;1609#issuecomm...</a></div><br/></div></div></div></div><div id="39898785" class="c"><input type="checkbox" id="c-39898785" checked=""/><div class="controls bullet"><span class="by">allanbreyes</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39898806">prev</a><span>|</span><a href="#39899810">next</a><span>|</span><label class="collapse" for="c-39898785">[-]</label><label class="expand" for="c-39898785">[6 more]</label></div><br/><div class="children"><div class="content">Ugh, that this psyops sockpuppetry may have started or contributed to the maintainer&#x27;s mental health issues seems like the most depressing part of all this. Maintaining OSS is hard enough.</div><br/><div id="39899213" class="c"><input type="checkbox" id="c-39899213" checked=""/><div class="controls bullet"><span class="by">btown</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898785">parent</a><span>|</span><a href="#39900799">next</a><span>|</span><label class="collapse" for="c-39899213">[-]</label><label class="expand" for="c-39899213">[1 more]</label></div><br/><div class="children"><div class="content">I hope that one takeaway from this entire situation is that if you&#x27;re a maintainer and your users are pushing you outside your levels of comfort, that&#x27;s a reflection on them, not on you - and that it could be reflective of something far, far worse than just their impatience.<p>If you, as a maintainer, value stability of not only your software but also your own mental health, it is <i>entirely</i> something you can be proud of to resist calls for new features, scope increases, and rapid team additions.</div><br/></div></div><div id="39900799" class="c"><input type="checkbox" id="c-39900799" checked=""/><div class="controls bullet"><span class="by">heavyset_go</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898785">parent</a><span>|</span><a href="#39899213">prev</a><span>|</span><a href="#39899183">next</a><span>|</span><label class="collapse" for="c-39900799">[-]</label><label class="expand" for="c-39900799">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that was a hard read. I think it highlights the importance of emotionally distancing yourself from your projects.<p>It&#x27;s also interesting because it exploits the current zeitgeist when it comes to maintainers&#x27; responsibilities to their users and communities. Personally, I think it puts too much expectation on maintainers&#x27; shoulders, especially when they&#x27;re working for free.<p>Personally, I think maintainers are doing favors for users, and if they don&#x27;t like how the project is progressing or not, then too bad. That&#x27;s not a popular sentiment, though.</div><br/></div></div><div id="39899183" class="c"><input type="checkbox" id="c-39899183" checked=""/><div class="controls bullet"><span class="by">__MatrixMan__</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898785">parent</a><span>|</span><a href="#39900799">prev</a><span>|</span><a href="#39899561">next</a><span>|</span><label class="collapse" for="c-39899183">[-]</label><label class="expand" for="c-39899183">[1 more]</label></div><br/><div class="children"><div class="content">No good deed goes unpunished, what a shame.</div><br/></div></div><div id="39899561" class="c"><input type="checkbox" id="c-39899561" checked=""/><div class="controls bullet"><span class="by">Delk</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898785">parent</a><span>|</span><a href="#39899183">prev</a><span>|</span><a href="#39899810">next</a><span>|</span><label class="collapse" for="c-39899561">[-]</label><label class="expand" for="c-39899561">[2 more]</label></div><br/><div class="children"><div class="content">Probably didn&#x27;t start them, considering that he already mentioned (long-term) mental health issues in the mailing list discussion in which the (likely) sock puppets started making demands.<p>But it&#x27;s hard to see the whole thing helping, and it is some combination of depressing and infuriating. I hope he&#x27;s doing ok.</div><br/><div id="39900586" class="c"><input type="checkbox" id="c-39900586" checked=""/><div class="controls bullet"><span class="by">tapland</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899561">parent</a><span>|</span><a href="#39899810">next</a><span>|</span><label class="collapse" for="c-39900586">[-]</label><label class="expand" for="c-39900586">[1 more]</label></div><br/><div class="children"><div class="content">You only push after you&#x27;ve established your guy as the likely successor. If this was coordinated it was not the first move.</div><br/></div></div></div></div></div></div><div id="39899810" class="c"><input type="checkbox" id="c-39899810" checked=""/><div class="controls bullet"><span class="by">furstenheim</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39898785">prev</a><span>|</span><a href="#39902591">next</a><span>|</span><label class="collapse" for="c-39899810">[-]</label><label class="expand" for="c-39899810">[1 more]</label></div><br/><div class="children"><div class="content">I actually wondered how many packages they harassed until they got access to one such</div><br/></div></div><div id="39902591" class="c"><input type="checkbox" id="c-39902591" checked=""/><div class="controls bullet"><span class="by">metrxqin</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39899810">prev</a><span>|</span><a href="#39899101">next</a><span>|</span><label class="collapse" for="c-39902591">[-]</label><label class="expand" for="c-39902591">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m literally shocked by the conversations in the mail-list, it&#x27;s blatantly an exploitation of others&#x27; kindness.</div><br/></div></div><div id="39899101" class="c"><input type="checkbox" id="c-39899101" checked=""/><div class="controls bullet"><span class="by">Voultapher</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39902591">prev</a><span>|</span><a href="#39899418">next</a><span>|</span><label class="collapse" for="c-39899101">[-]</label><label class="expand" for="c-39899101">[1 more]</label></div><br/><div class="children"><div class="content">I mean one person can use sock puppet accounts to write emails.</div><br/></div></div><div id="39899418" class="c"><input type="checkbox" id="c-39899418" checked=""/><div class="controls bullet"><span class="by">yread</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897999">parent</a><span>|</span><a href="#39899101">prev</a><span>|</span><a href="#39900218">next</a><span>|</span><label class="collapse" for="c-39899418">[-]</label><label class="expand" for="c-39899418">[5 more]</label></div><br/><div class="children"><div class="content">Maybe they weren&#x27;t all sockpuppets. Here Jigar Kumar was nitpicking Jia Tan&#x27;s changes:<p><a href="https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00556.html" rel="nofollow">https:&#x2F;&#x2F;www.mail-archive.com&#x2F;xz-devel@tukaani.org&#x2F;msg00556.h...</a><p>That was not necessary to gain trust. Writing style is different, too. Later when Jia gained commit access he reminds him to merge it.</div><br/><div id="39900302" class="c"><input type="checkbox" id="c-39900302" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899418">parent</a><span>|</span><a href="#39899787">next</a><span>|</span><label class="collapse" for="c-39900302">[-]</label><label class="expand" for="c-39900302">[2 more]</label></div><br/><div class="children"><div class="content">This looks like a very phony &quot;debate&quot;.<p>I think the most convincing case made about the sock puppets is around account creation dates, and also people disappearing after they get what they need. Like Jigar disappearing after Jia becomes maintainer. Or the guy &quot;misoeater19&quot; who creates his debian bug tracker account to say that his work is totally blocked on needing xz 5.6.1 to be in debian unstable.</div><br/><div id="39903227" class="c"><input type="checkbox" id="c-39903227" checked=""/><div class="controls bullet"><span class="by">pyinstallwoes</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900302">parent</a><span>|</span><a href="#39899787">next</a><span>|</span><label class="collapse" for="c-39903227">[-]</label><label class="expand" for="c-39903227">[1 more]</label></div><br/><div class="children"><div class="content">Ah, the good ol’ lever of urgency. Urgency frequency smells of deception.</div><br/></div></div></div></div><div id="39899787" class="c"><input type="checkbox" id="c-39899787" checked=""/><div class="controls bullet"><span class="by">barkingcat</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899418">parent</a><span>|</span><a href="#39900302">prev</a><span>|</span><a href="#39900218">next</a><span>|</span><label class="collapse" for="c-39899787">[-]</label><label class="expand" for="c-39899787">[2 more]</label></div><br/><div class="children"><div class="content">that&#x27;s precisely what sock puppetry does ... talk&#x2F;write in a different writing style to make others believe it&#x27;s different people.</div><br/><div id="39902569" class="c"><input type="checkbox" id="c-39902569" checked=""/><div class="controls bullet"><span class="by">bdowling</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899787">parent</a><span>|</span><a href="#39900218">next</a><span>|</span><label class="collapse" for="c-39902569">[-]</label><label class="expand" for="c-39902569">[1 more]</label></div><br/><div class="children"><div class="content">For all we know there is a whole cyber-squadron (or whatever their military units are called) behind Jia Tan and other accounts.</div><br/></div></div></div></div></div></div></div></div><div id="39900218" class="c"><input type="checkbox" id="c-39900218" checked=""/><div class="controls bullet"><span class="by">juitpykyk</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897179">parent</a><span>|</span><a href="#39897999">prev</a><span>|</span><a href="#39897792">next</a><span>|</span><label class="collapse" for="c-39900218">[-]</label><label class="expand" for="c-39900218">[9 more]</label></div><br/><div class="children"><div class="content">You&#x27;re talking as if securing a backdoor with public cryptography is some unimaginable feat of technology.<p>It&#x27;s literally a couple hours work.</div><br/><div id="39902258" class="c"><input type="checkbox" id="c-39902258" checked=""/><div class="controls bullet"><span class="by">parl_match</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900218">parent</a><span>|</span><a href="#39900311">next</a><span>|</span><label class="collapse" for="c-39902258">[-]</label><label class="expand" for="c-39902258">[1 more]</label></div><br/><div class="children"><div class="content">Inserting a change like this as a one off would cause lots of scrutiny, which would probably get it detected. Instead, the bad actor spent years contributing to the project before dropping this.<p>So, while writing the exploit might be a couple of hours work, actually pulling it off is quite a bit more difficult.</div><br/></div></div><div id="39900311" class="c"><input type="checkbox" id="c-39900311" checked=""/><div class="controls bullet"><span class="by">kbenson</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900218">parent</a><span>|</span><a href="#39902258">prev</a><span>|</span><a href="#39900654">next</a><span>|</span><label class="collapse" for="c-39900311">[-]</label><label class="expand" for="c-39900311">[4 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think they were using complexity as the reason for that assumption, but instead goals.  Adding security doesn&#x27;t require a nation state&#x27;s level of resources, but it is a more attractive feature for a nation state that wants to preserve it over time and prevent adversaries from making use of it.</div><br/><div id="39900743" class="c"><input type="checkbox" id="c-39900743" checked=""/><div class="controls bullet"><span class="by">heavyset_go</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900311">parent</a><span>|</span><a href="#39900333">next</a><span>|</span><label class="collapse" for="c-39900743">[-]</label><label class="expand" for="c-39900743">[1 more]</label></div><br/><div class="children"><div class="content">This makes sense in closed source products where you&#x27;ll never get to audit the source for such exploits, but little sense in open source projects where anyone can audit it.<p>That&#x27;s to say an enterprise router or switch would likely have secured exploits put there by corporate and national security agencies, whereas open source exploits would benefit from the probable deniability.</div><br/></div></div><div id="39900333" class="c"><input type="checkbox" id="c-39900333" checked=""/><div class="controls bullet"><span class="by">neodymiumphish</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900311">parent</a><span>|</span><a href="#39900743">prev</a><span>|</span><a href="#39900654">next</a><span>|</span><label class="collapse" for="c-39900333">[-]</label><label class="expand" for="c-39900333">[2 more]</label></div><br/><div class="children"><div class="content">And on the contrary, creating a vulnerability that’s not identifiable to a limited attack group provides for a bit more deniability and anonymity. It’s hard to say which is more favorable by a nation-state actor.</div><br/><div id="39900587" class="c"><input type="checkbox" id="c-39900587" checked=""/><div class="controls bullet"><span class="by">usrusr</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900333">parent</a><span>|</span><a href="#39900654">next</a><span>|</span><label class="collapse" for="c-39900587">[-]</label><label class="expand" for="c-39900587">[1 more]</label></div><br/><div class="children"><div class="content">An interesting angle: if this was somehow observed in use instead of getting discovered without observing use, there would be a glaring bright cui bono associated with what it was being used <i>for</i>.<p>Theoretically, I could even imagine that public key security motivated by some &quot;mostly benign&quot; actor who fell in love with the question &quot;could I pull this off?&quot; dreading the scenario of their future hacker superpower falling in the wrong hands. It&#x27;s not entirely unthinkable that an alternative timeline where this was never discovered would only ever see this superbackdoor getting used for harmless pranks, winning bets and the like. In this unlikely scenario, the discovery, through the state actor and crime syndicate activities undoubtedly inspired by the discovery, would paradoxically lead to a less safe computing world than the alternative timeline where the person with the key had free RCE almost everywhere.</div><br/></div></div></div></div></div></div><div id="39900654" class="c"><input type="checkbox" id="c-39900654" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900218">parent</a><span>|</span><a href="#39900311">prev</a><span>|</span><a href="#39897792">next</a><span>|</span><label class="collapse" for="c-39900654">[-]</label><label class="expand" for="c-39900654">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;ll be kind of tragic if this backdoor turns out to be the developer&#x27;s pet &quot;enable remote debugging&quot; code, and they didn&#x27;t mean for it to get out into a release. ;)</div><br/><div id="39901524" class="c"><input type="checkbox" id="c-39901524" checked=""/><div class="controls bullet"><span class="by">unkulunkulu</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900654">parent</a><span>|</span><a href="#39897792">next</a><span>|</span><label class="collapse" for="c-39901524">[-]</label><label class="expand" for="c-39901524">[2 more]</label></div><br/><div class="children"><div class="content">I would be scared to work near a person who writes his debugging tools this way :D</div><br/><div id="39902499" class="c"><input type="checkbox" id="c-39902499" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39901524">parent</a><span>|</span><a href="#39897792">next</a><span>|</span><label class="collapse" for="c-39902499">[-]</label><label class="expand" for="c-39902499">[1 more]</label></div><br/><div class="children"><div class="content">Heh Heh Heh<p>&quot;It seemed like a good idea at the time&quot; is a pretty common story though. ;)</div><br/></div></div></div></div></div></div></div></div><div id="39897792" class="c"><input type="checkbox" id="c-39897792" checked=""/><div class="controls bullet"><span class="by">meowface</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897179">parent</a><span>|</span><a href="#39900218">prev</a><span>|</span><a href="#39900710">next</a><span>|</span><label class="collapse" for="c-39897792">[-]</label><label class="expand" for="c-39897792">[2 more]</label></div><br/><div class="children"><div class="content">&gt;But if that was the case they wouldn&#x27;t bother with the key. It&#x27;d be a one-and-done situation. It would be a stop-the-world event.<p>Why not? It&#x27;s possible someone else could&#x27;ve discovered the exploit before the big attack but decided not to disclose it. Or that they could&#x27;ve disclosed it and caused a lot of damage the attacker didn&#x27;t necessarily want. And they easily could&#x27;ve been planning both a long-term way to access a huge swath of machines and also biding their time for a huge heist.<p>They have no reason to not restrict the backdoor to their personal use. And it probably is spycraft of some sort, and I think more likely than not it&#x27;s a nation-state, but not necessarily. I could see a talented individual or group wanting to pull this off.</div><br/><div id="39899717" class="c"><input type="checkbox" id="c-39899717" checked=""/><div class="controls bullet"><span class="by">varenc</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897792">parent</a><span>|</span><a href="#39900710">next</a><span>|</span><label class="collapse" for="c-39899717">[-]</label><label class="expand" for="c-39899717">[1 more]</label></div><br/><div class="children"><div class="content">I think we need to consider the context. The attacker ultimately only had control over the lzma library. I&#x27;m skeptical that there&#x27;s an innocent looking way that lzma could have in the open introduced an &quot;accidental&quot; RCE vuln that&#x27;d affect sshd. Of course I agree that they also wanted an explicit stealth backdoor for all the other reasons, but I don&#x27;t think a plausibly deniable RCE or authentication bypass vuln would have even been possible.</div><br/></div></div></div></div><div id="39900710" class="c"><input type="checkbox" id="c-39900710" checked=""/><div class="controls bullet"><span class="by">heavyset_go</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897179">parent</a><span>|</span><a href="#39897792">prev</a><span>|</span><a href="#39901409">next</a><span>|</span><label class="collapse" for="c-39900710">[-]</label><label class="expand" for="c-39900710">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Now it looks more like nation-state spycraft.</i><p>I disagree, plenty of exploits implemented WireGuard-like crypto key access to them.</div><br/></div></div></div></div><div id="39899888" class="c"><input type="checkbox" id="c-39899888" checked=""/><div class="controls bullet"><span class="by">Beijinger</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896392">parent</a><span>|</span><a href="#39901409">prev</a><span>|</span><a href="#39899313">next</a><span>|</span><label class="collapse" for="c-39899888">[-]</label><label class="expand" for="c-39899888">[2 more]</label></div><br/><div class="children"><div class="content">This is just a safety measure that it does not blow up in your own face (country).</div><br/><div id="39902072" class="c"><input type="checkbox" id="c-39902072" checked=""/><div class="controls bullet"><span class="by">CommitSyn</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899888">parent</a><span>|</span><a href="#39899313">next</a><span>|</span><label class="collapse" for="c-39902072">[-]</label><label class="expand" for="c-39902072">[1 more]</label></div><br/><div class="children"><div class="content">Not only did it mandate authentication, but there was also a Killswitch, and there&#x27;s no other reason for that than because you have reasons to suspect someone may have access to this sensitive world-stopper exploit and use it against you. That leaves simply a (reasonably, but still) paranoid person, and people worried about that+consequences are unlikely to have the mental well-being to pull this off, or, a group of people.</div><br/></div></div></div></div><div id="39899313" class="c"><input type="checkbox" id="c-39899313" checked=""/><div class="controls bullet"><span class="by">chpatrick</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896392">parent</a><span>|</span><a href="#39899888">prev</a><span>|</span><a href="#39898665">next</a><span>|</span><label class="collapse" for="c-39899313">[-]</label><label class="expand" for="c-39899313">[1 more]</label></div><br/><div class="children"><div class="content">Also people can come and immediately undo whatever you did if it&#x27;s not authenticated.</div><br/></div></div></div></div><div id="39898665" class="c"><input type="checkbox" id="c-39898665" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39896392">prev</a><span>|</span><a href="#39896418">next</a><span>|</span><label class="collapse" for="c-39898665">[-]</label><label class="expand" for="c-39898665">[7 more]</label></div><br/><div class="children"><div class="content">If you think of it as a state sponsored attack it makes a lot of sense to have a &quot;secure&quot; vulnerability in system that your own citizens might use.<p>It looks like the whole contribution to xz was an effort to just inject that backdoor. For example the author created the whole test framework where he could hide the malicious payload.<p>Before he started work on xz, he made contribution to libarchive in BSD which created a vulnerability.</div><br/><div id="39898964" class="c"><input type="checkbox" id="c-39898964" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898665">parent</a><span>|</span><a href="#39896418">next</a><span>|</span><label class="collapse" for="c-39898964">[-]</label><label class="expand" for="c-39898964">[6 more]</label></div><br/><div class="children"><div class="content">The libarchive diff didn&#x27;t create any vulnerability. The fprintf calls were consistent with others in the same repository.</div><br/><div id="39900284" class="c"><input type="checkbox" id="c-39900284" checked=""/><div class="controls bullet"><span class="by">jhugo</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898964">parent</a><span>|</span><a href="#39899246">next</a><span>|</span><label class="collapse" for="c-39900284">[-]</label><label class="expand" for="c-39900284">[3 more]</label></div><br/><div class="children"><div class="content">It did, actually: the filename can contain terminal control characters, which thanks to the change from safe_fprintf to fprintf, were printed without escaping, which allows the creator of the archive being extracted to control the terminal of the user extracting the archive.</div><br/><div id="39901542" class="c"><input type="checkbox" id="c-39901542" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900284">parent</a><span>|</span><a href="#39899246">next</a><span>|</span><label class="collapse" for="c-39901542">[-]</label><label class="expand" for="c-39901542">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s<p>(a) not exploitable without the existence of a much higher-severity exploit -- sure you can clear the screen, but that&#x27;s low impact<p>(b) possible to trigger on other extant paths; see <a href="https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;issues&#x2F;2107">https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;issues&#x2F;2107</a> so it seems nothing new was introduced<p>(c) kind of contrived to get to execute; you have to somehow fail to extract the archive but on the happy path you&#x27;ll see a bunch of weirdly-named files<p>I think it&#x27;s distinctly higher-probability that this change was just meant to build credibility for the GitHub account. The diff is a fairly trivial patch to a minor issue filed around the same time as the pull request.</div><br/><div id="39902150" class="c"><input type="checkbox" id="c-39902150" checked=""/><div class="controls bullet"><span class="by">CommitSyn</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39901542">parent</a><span>|</span><a href="#39899246">next</a><span>|</span><label class="collapse" for="c-39902150">[-]</label><label class="expand" for="c-39902150">[1 more]</label></div><br/><div class="children"><div class="content">Is it possible it was part of a planned or current exploit chain, some other way it could have been utilized?</div><br/></div></div></div></div></div></div><div id="39899246" class="c"><input type="checkbox" id="c-39899246" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898964">parent</a><span>|</span><a href="#39900284">prev</a><span>|</span><a href="#39896418">next</a><span>|</span><label class="collapse" for="c-39899246">[-]</label><label class="expand" for="c-39899246">[2 more]</label></div><br/><div class="children"><div class="content">They still preferred to revert it as it looks very suspicious.<p><a href="https:&#x2F;&#x2F;bugs.debian.org&#x2F;cgi-bin&#x2F;bugreport.cgi?bug=1068047" rel="nofollow">https:&#x2F;&#x2F;bugs.debian.org&#x2F;cgi-bin&#x2F;bugreport.cgi?bug=1068047</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;2101">https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;2101</a></div><br/><div id="39899322" class="c"><input type="checkbox" id="c-39899322" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899246">parent</a><span>|</span><a href="#39896418">next</a><span>|</span><label class="collapse" for="c-39899322">[-]</label><label class="expand" for="c-39899322">[1 more]</label></div><br/><div class="children"><div class="content">If I read that correctly the problem is that it prints a filename that might include terminal control sequences that come from an attacker-controlled file name.<p>Comment in your second link:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;1609#issuecomment-2028125584">https:&#x2F;&#x2F;github.com&#x2F;libarchive&#x2F;libarchive&#x2F;pull&#x2F;1609#issuecomm...</a></div><br/></div></div></div></div></div></div></div></div><div id="39896418" class="c"><input type="checkbox" id="c-39896418" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39898665">prev</a><span>|</span><a href="#39897569">next</a><span>|</span><label class="collapse" for="c-39896418">[-]</label><label class="expand" for="c-39896418">[41 more]</label></div><br/><div class="children"><div class="content">For real, it&#x27;s almost like a state-sponsored exploit. It&#x27;s crafted and executed incredibly well, the performance issue feels like pure luck it got found.</div><br/><div id="39896585" class="c"><input type="checkbox" id="c-39896585" checked=""/><div class="controls bullet"><span class="by">stingraycharles</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39896475">next</a><span>|</span><label class="collapse" for="c-39896585">[-]</label><label class="expand" for="c-39896585">[23 more]</label></div><br/><div class="children"><div class="content">I like the theory that actually, it wasn’t luck but was picked up on by detection tools of a large entity (Google &#x2F; Microsoft &#x2F; NSA &#x2F; whatever), and they’re just presenting the story like this to keep their detection methods a secret. It’s what I would do.</div><br/><div id="39896859" class="c"><input type="checkbox" id="c-39896859" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39896702">next</a><span>|</span><label class="collapse" for="c-39896859">[-]</label><label class="expand" for="c-39896859">[9 more]</label></div><br/><div class="children"><div class="content">I doubt that if Google detected it with some internal tool, they&#x27;d reach out to Microsoft to hide their contribution.<p>It was reported by an MS engineer who happens to be involved in another OSS project. MS is doing business with the US intelligence community, for example there is the Skype story: First, rumors that NSA offers a lot of money for people who can break Skype&#x27;s E2E encryption, then MS buys Skype, then MS changes Skype&#x27;s client to not be E2E encrypted any more and to use MS servers instead of peer to peer, allowing undetectable wiretapping of arbitrary connections.<p>But it&#x27;s a quite credible story too that it was just a random discovery. Even if it was the NSA, why would they hide that capability. It doesn&#x27;t take much to run a script to compare git state with uploaded source tarballs in distros like Debian (Debian has separate tarballs for the source and the source with Debian patches applied).</div><br/><div id="39897640" class="c"><input type="checkbox" id="c-39897640" checked=""/><div class="controls bullet"><span class="by">anarazel</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896859">parent</a><span>|</span><a href="#39899230">next</a><span>|</span><label class="collapse" for="c-39897640">[-]</label><label class="expand" for="c-39897640">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It was reported by an MS engineer who happens to be involved in another OSS project.<p>I view it as being OSS or postgresql dev that happens to work at microsoft. I&#x27;ve been doing the former for much longer (starting somewhere between 2005 and 2008, depending on how you count) than the latter (2019-12).</div><br/><div id="39900111" class="c"><input type="checkbox" id="c-39900111" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897640">parent</a><span>|</span><a href="#39899230">next</a><span>|</span><label class="collapse" for="c-39900111">[-]</label><label class="expand" for="c-39900111">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the explanation. Also thanks for catching this and protecting us all; I think in the end it&#x27;s way more believable that you indeed found it on your own, above was just brainless blathering into the ether =). Lastly, thanks for your Postgres contributions.</div><br/></div></div></div></div><div id="39899230" class="c"><input type="checkbox" id="c-39899230" checked=""/><div class="controls bullet"><span class="by">t0mas88</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896859">parent</a><span>|</span><a href="#39897640">prev</a><span>|</span><a href="#39898477">next</a><span>|</span><label class="collapse" for="c-39899230">[-]</label><label class="expand" for="c-39899230">[1 more]</label></div><br/><div class="children"><div class="content">Intelligence agencies are very careful about sharing their findings, even with &quot;friends&quot;, because the findings will disclose some information about their capabilities and possibly methods.<p>Let&#x27;s say agency A has some scanning capability on open source software that detected this backdoor attempt by agency B. If they had gone public, agency B now knows they have this ability. So agency B will adjust their ways the next time and the scanning capability becomes less useful. While if agency A had told Microsoft to &quot;find&quot; this by accident, nobody would know about their scanning capability. And the next attempt by agency B would only try to avoid having the performance impact this first attempt had, probably leaving it visible to agency A.</div><br/></div></div><div id="39898477" class="c"><input type="checkbox" id="c-39898477" checked=""/><div class="controls bullet"><span class="by">bevekspldnw</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896859">parent</a><span>|</span><a href="#39899230">prev</a><span>|</span><a href="#39900208">next</a><span>|</span><label class="collapse" for="c-39898477">[-]</label><label class="expand" for="c-39898477">[2 more]</label></div><br/><div class="children"><div class="content">“Even if it was the NSA, why would they hide that capability”<p>Perhaps you’re not familiar with what NSA historically stood for: Never Say Anything.</div><br/><div id="39900782" class="c"><input type="checkbox" id="c-39900782" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898477">parent</a><span>|</span><a href="#39900208">next</a><span>|</span><label class="collapse" for="c-39900782">[-]</label><label class="expand" for="c-39900782">[1 more]</label></div><br/><div class="children"><div class="content">Googling for &quot;site:nsa.gov filetype:pdf&quot; gives tens of thousands of results with documents produced by the NSA about various things (the google counter is known to lie but that&#x27;s not my point). They do publish things.</div><br/></div></div></div></div><div id="39900208" class="c"><input type="checkbox" id="c-39900208" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896859">parent</a><span>|</span><a href="#39898477">prev</a><span>|</span><a href="#39896702">next</a><span>|</span><label class="collapse" for="c-39900208">[-]</label><label class="expand" for="c-39900208">[3 more]</label></div><br/><div class="children"><div class="content">&gt;  an MS engineer<p>no this engineer is world-known for being core PostgreSQL, a team with high standards.. unlike that company you mention</div><br/><div id="39902739" class="c"><input type="checkbox" id="c-39902739" checked=""/><div class="controls bullet"><span class="by">jeltz</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900208">parent</a><span>|</span><a href="#39900713">next</a><span>|</span><label class="collapse" for="c-39902739">[-]</label><label class="expand" for="c-39902739">[1 more]</label></div><br/><div class="children"><div class="content">He is also one of the sharpest developers I have had the fortune to speak to (and do some minor work with on the mailing list) and he knows a lot about performance and profiling. I 100% think that he found it on his own. He would also be an odd choice for Microsoft to pick since I doubt he works anywhere close to any of their security teams (unless they went through some serious lengths to find just the guy where it would be 100% believable that he just stumbled on it).</div><br/></div></div><div id="39900713" class="c"><input type="checkbox" id="c-39900713" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900208">parent</a><span>|</span><a href="#39902739">prev</a><span>|</span><a href="#39896702">next</a><span>|</span><label class="collapse" for="c-39900713">[-]</label><label class="expand" for="c-39900713">[1 more]</label></div><br/><div class="children"><div class="content">Yeah definitely, good point. I got that wrong above: He is in fact a postgres contributor who happens to be MS employee and not an MS employee who happens to be a postgres contributor.</div><br/></div></div></div></div></div></div><div id="39896702" class="c"><input type="checkbox" id="c-39896702" checked=""/><div class="controls bullet"><span class="by">jsmith99</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39896859">prev</a><span>|</span><a href="#39896937">next</a><span>|</span><label class="collapse" for="c-39896702">[-]</label><label class="expand" for="c-39896702">[4 more]</label></div><br/><div class="children"><div class="content">The attacker changed the projects contact details at oss fuzz (an automated detection tool). There’s an interesting discussion as to whether that would have picked up the vulnerability <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;issues&#x2F;11760">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;oss-fuzz&#x2F;issues&#x2F;11760</a></div><br/><div id="39898865" class="c"><input type="checkbox" id="c-39898865" checked=""/><div class="controls bullet"><span class="by">metzmanj</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896702">parent</a><span>|</span><a href="#39897837">next</a><span>|</span><label class="collapse" for="c-39898865">[-]</label><label class="expand" for="c-39898865">[2 more]</label></div><br/><div class="children"><div class="content">I work on oss-fuzz.<p>I don&#x27;t think it&#x27;s plausible OSS-Fuzz could have found this. The backdoor required a build configuration that was not used in OSS-Fuzz.<p>I&#x27;m guessing &quot;Jia Tan&quot; knew this and made changes to XZ&#x27;s use of OSS-Fuzz for the purposes of cementing their position as the new maintainer of XZ, rather than out of worry OSS-Fuzz would find the backdoor as people have speculated.</div><br/><div id="39901889" class="c"><input type="checkbox" id="c-39901889" checked=""/><div class="controls bullet"><span class="by">Aloisius</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898865">parent</a><span>|</span><a href="#39897837">next</a><span>|</span><label class="collapse" for="c-39901889">[-]</label><label class="expand" for="c-39901889">[1 more]</label></div><br/><div class="children"><div class="content">How many oss-fuzz packages have a Dockerfile that runs apt-get install liblzma-dev first?<p>Had this not been discovered, the backdoored version of xz could have eventually ended up in the ubuntu version oss-fuzz uses for its docker image - and linked into all those packages being tested as well.<p>Except now there&#x27;s an explanation if fuzzing starts to fail  - honggfuzz uses -fsanitize which is incompatible with xz&#x27;s use of ifunc, so any package that depends on it should rebuild xz from source with --disable-ifunc instead of using the binary package.</div><br/></div></div></div></div><div id="39897837" class="c"><input type="checkbox" id="c-39897837" checked=""/><div class="controls bullet"><span class="by">meowface</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896702">parent</a><span>|</span><a href="#39898865">prev</a><span>|</span><a href="#39896937">next</a><span>|</span><label class="collapse" for="c-39897837">[-]</label><label class="expand" for="c-39897837">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a fascinating extra detail. They really tried to cover all their bases.<p>There&#x27;s some plausible evidence here that they may&#x27;ve tried to use alter egos to encourage Debian to update the package: <a href="https:&#x2F;&#x2F;twitter.com&#x2F;f0wlsec&#x2F;status&#x2F;1773824841331740708" rel="nofollow">https:&#x2F;&#x2F;twitter.com&#x2F;f0wlsec&#x2F;status&#x2F;1773824841331740708</a></div><br/></div></div></div></div><div id="39896937" class="c"><input type="checkbox" id="c-39896937" checked=""/><div class="controls bullet"><span class="by">edflsafoiewq</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39896702">prev</a><span>|</span><a href="#39897993">next</a><span>|</span><label class="collapse" for="c-39896937">[-]</label><label class="expand" for="c-39896937">[4 more]</label></div><br/><div class="children"><div class="content">They could announce it without revealing their detection method. I don&#x27;t see what the extra indirection buys them.</div><br/><div id="39897075" class="c"><input type="checkbox" id="c-39897075" checked=""/><div class="controls bullet"><span class="by">MOARDONGZPLZ</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896937">parent</a><span>|</span><a href="#39897993">next</a><span>|</span><label class="collapse" for="c-39897075">[-]</label><label class="expand" for="c-39897075">[3 more]</label></div><br/><div class="children"><div class="content">Shutting down 99.9% of speculation on how the vulnerability was found in the first place.</div><br/><div id="39899011" class="c"><input type="checkbox" id="c-39899011" checked=""/><div class="controls bullet"><span class="by">VMG</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897075">parent</a><span>|</span><a href="#39897993">next</a><span>|</span><label class="collapse" for="c-39899011">[-]</label><label class="expand" for="c-39899011">[2 more]</label></div><br/><div class="children"><div class="content">(1) obviously not<p>(2) they could just say they found it during some routine dependency review or whatever</div><br/><div id="39901363" class="c"><input type="checkbox" id="c-39901363" checked=""/><div class="controls bullet"><span class="by">MOARDONGZPLZ</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899011">parent</a><span>|</span><a href="#39897993">next</a><span>|</span><label class="collapse" for="c-39901363">[-]</label><label class="expand" for="c-39901363">[1 more]</label></div><br/><div class="children"><div class="content">I mean, yes. I’ve read all the commentary I can get my hands on about this incident because it is fascinating and this is the first instance of some parallel construction theory of finding it I’ve seen.<p>Second, maybe a routine dependency review is how they _actually_ found it but they don’t want future people like this focusing too much on that otherwise they may try to mitigate, whereas now they may focus on something inane like a 0.5 second increase in sshd’s load time or whatever.</div><br/></div></div></div></div></div></div></div></div><div id="39897993" class="c"><input type="checkbox" id="c-39897993" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39896937">prev</a><span>|</span><a href="#39898827">next</a><span>|</span><label class="collapse" for="c-39897993">[-]</label><label class="expand" for="c-39897993">[1 more]</label></div><br/><div class="children"><div class="content">&gt; ... nd they’re just presenting the story like this to keep their detection methods a secret. It’s what I would do.<p>Basically &quot;parallel construction&quot;. It&#x27;s very possible it&#x27;s what happened.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Parallel_construction" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Parallel_construction</a></div><br/></div></div><div id="39898827" class="c"><input type="checkbox" id="c-39898827" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39897993">prev</a><span>|</span><a href="#39899795">next</a><span>|</span><label class="collapse" for="c-39898827">[-]</label><label class="expand" for="c-39898827">[1 more]</label></div><br/><div class="children"><div class="content">Sorry for that ugly comparison, but that explanation reminds me of the theories when covid started, that it was created by secret organization that is actually ruling the world.<p>People love when there&#x27;s some explanation that doesn&#x27;t involve randomness, because with randomness looks like we don&#x27;t have grasp on things.<p>Google actually had tooling that was detecting it, but he disabled check that would show it.<p>Google&#x2F;Microsoft&#x2F;NSA could just say they detected it with internal tooling and not disclose how exactly. Google and Microsoft would love to have credit.</div><br/></div></div><div id="39897804" class="c"><input type="checkbox" id="c-39897804" checked=""/><div class="controls bullet"><span class="by">meowface</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39899795">prev</a><span>|</span><a href="#39900841">next</a><span>|</span><label class="collapse" for="c-39897804">[-]</label><label class="expand" for="c-39897804">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s really interesting to think what might&#x27;ve happened if they could&#x27;ve implemented this with much less performance overhead. How long might it have lasted for? Years?</div><br/></div></div><div id="39900841" class="c"><input type="checkbox" id="c-39900841" checked=""/><div class="controls bullet"><span class="by">heavyset_go</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896585">parent</a><span>|</span><a href="#39897804">prev</a><span>|</span><a href="#39896475">next</a><span>|</span><label class="collapse" for="c-39900841">[-]</label><label class="expand" for="c-39900841">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re describing parallel construction and it is something that happens all of the time.</div><br/></div></div></div></div><div id="39896475" class="c"><input type="checkbox" id="c-39896475" checked=""/><div class="controls bullet"><span class="by">andersa</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39896585">prev</a><span>|</span><a href="#39897549">next</a><span>|</span><label class="collapse" for="c-39896475">[-]</label><label class="expand" for="c-39896475">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;d make total sense if it was. This way you get to have the backdoor without your enemies being able to use it against your own companies.</div><br/></div></div><div id="39897549" class="c"><input type="checkbox" id="c-39897549" checked=""/><div class="controls bullet"><span class="by">timmytokyo</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39896475">prev</a><span>|</span><a href="#39897827">next</a><span>|</span><label class="collapse" for="c-39897549">[-]</label><label class="expand" for="c-39897549">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure why everyone is 100% sure this was a state-sponsored security breach. I agree that it&#x27;s more likely than not state-sponsored, but I can imagine all sorts of other groups who would have an interest in something like this, organized crime in particular. Imagine how many banks or crypto wallets they could break into with a RCE this pervasive.</div><br/><div id="39898515" class="c"><input type="checkbox" id="c-39898515" checked=""/><div class="controls bullet"><span class="by">bevekspldnw</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897549">parent</a><span>|</span><a href="#39902820">next</a><span>|</span><label class="collapse" for="c-39898515">[-]</label><label class="expand" for="c-39898515">[1 more]</label></div><br/><div class="children"><div class="content">Motive and patience. Motive as you point out is shared by many parties.<p>Typically its only state agencies that will fund an operation with uncertain pay off over long periods of time. That type of patience is expensive.<p>Online criminals are beholden to changing market pressures and short term investment pressures like any other start up.</div><br/></div></div><div id="39897779" class="c"><input type="checkbox" id="c-39897779" checked=""/><div class="controls bullet"><span class="by">blablabla123</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897549">parent</a><span>|</span><a href="#39902820">prev</a><span>|</span><a href="#39897827">next</a><span>|</span><label class="collapse" for="c-39897779">[-]</label><label class="expand" for="c-39897779">[1 more]</label></div><br/><div class="children"><div class="content">Especially considering this introduced a 500ms waiting time. But surely this was quite a risky time investment, 2 years. How likely is it that this was the only attempt if this was done by a group? (And maybe there were failed attempts after trying to take over maintenance of other packages?) Maybe really a very well-funded cybercrime group that can afford such moonshot endeavours or a state group that doesn&#x27;t completely know yet what it&#x27;s doing or isn&#x27;t that well equipped (anymore?). I&#x27;m definitely curious about analysis of attribution</div><br/></div></div></div></div><div id="39897827" class="c"><input type="checkbox" id="c-39897827" checked=""/><div class="controls bullet"><span class="by">7373737373</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39897549">prev</a><span>|</span><a href="#39896453">next</a><span>|</span><label class="collapse" for="c-39897827">[-]</label><label class="expand" for="c-39897827">[2 more]</label></div><br/><div class="children"><div class="content">I read someone speculating that the performance issue was intentional, so infected machines could be easily identified by an internet wide scan without arousing further suspicicion.<p>If this is or becomes a widespread method, then anti-malware groups should perhaps conduct these scans themselves.</div><br/><div id="39899376" class="c"><input type="checkbox" id="c-39899376" checked=""/><div class="controls bullet"><span class="by">zarzavat</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897827">parent</a><span>|</span><a href="#39896453">next</a><span>|</span><label class="collapse" for="c-39899376">[-]</label><label class="expand" for="c-39899376">[1 more]</label></div><br/><div class="children"><div class="content">Very small differences in performance can be detected over the network as long as you have enough samples. Given that every port 22 is being hit by a gazillion attempts per day already, sample count shouldn’t be an issue.<p>So if distinguishing infected machines was their intention they definitely over-egged it.</div><br/></div></div></div></div><div id="39896453" class="c"><input type="checkbox" id="c-39896453" checked=""/><div class="controls bullet"><span class="by">jdewerd</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39897827">prev</a><span>|</span><a href="#39896530">next</a><span>|</span><label class="collapse" for="c-39896453">[-]</label><label class="expand" for="c-39896453">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, we should probably expect that there are roughly 1&#x2F;p(found) more of these lurking out there. Not a pleasant thought.</div><br/></div></div><div id="39896530" class="c"><input type="checkbox" id="c-39896530" checked=""/><div class="controls bullet"><span class="by">hnthrowaway0328</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39896453">prev</a><span>|</span><a href="#39898786">next</a><span>|</span><label class="collapse" for="c-39896530">[-]</label><label class="expand" for="c-39896530">[3 more]</label></div><br/><div class="children"><div class="content">Do we have a detailed technical analysis of the code? I read a few analysis but they all seem preliminary. It is very useful to learn from the code.</div><br/><div id="39896934" class="c"><input type="checkbox" id="c-39896934" checked=""/><div class="controls bullet"><span class="by">coldpie</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896530">parent</a><span>|</span><a href="#39898786">next</a><span>|</span><label class="collapse" for="c-39896934">[-]</label><label class="expand" for="c-39896934">[2 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a few links down at the bottom of the OP to quite detailed analysis. From there you could join a Discord where discussion is ongoing.</div><br/><div id="39899014" class="c"><input type="checkbox" id="c-39899014" checked=""/><div class="controls bullet"><span class="by">hnthrowaway0328</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896934">parent</a><span>|</span><a href="#39898786">next</a><span>|</span><label class="collapse" for="c-39899014">[-]</label><label class="expand" for="c-39899014">[1 more]</label></div><br/><div class="children"><div class="content">Thanks coldpie.</div><br/></div></div></div></div></div></div><div id="39898786" class="c"><input type="checkbox" id="c-39898786" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39896530">prev</a><span>|</span><a href="#39897427">next</a><span>|</span><label class="collapse" for="c-39898786">[-]</label><label class="expand" for="c-39898786">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it was executed incredibly well. There were definitely very clever aspects but they made multiple mistakes - triggering Valgrind, the performance issue, using a `.` to break the Landlock test, not giving the author a proper background identity.<p>I guess you could also include the fact that they made it a very obvious back door rather than an exploitable bug, but that has the advantage of only letting you exploit it so it was probably an intentional trade-off.<p>Just think how many back doors &#x2F; intentional bugs there are that we don&#x27;t know about because they didn&#x27;t make any of these mistakes.</div><br/><div id="39899341" class="c"><input type="checkbox" id="c-39899341" checked=""/><div class="controls bullet"><span class="by">richardfey</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898786">parent</a><span>|</span><a href="#39897427">next</a><span>|</span><label class="collapse" for="c-39899341">[-]</label><label class="expand" for="c-39899341">[1 more]</label></div><br/><div class="children"><div class="content">Maybe it&#x27;s the first successful attempt of a state which nobody would right now suspect as capable of carrying this out. Everyone is looking at the big guys but a new player has entered the game.</div><br/></div></div></div></div><div id="39897427" class="c"><input type="checkbox" id="c-39897427" checked=""/><div class="controls bullet"><span class="by">lyu07282</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39898786">prev</a><span>|</span><a href="#39897373">next</a><span>|</span><label class="collapse" for="c-39897427">[-]</label><label class="expand" for="c-39897427">[1 more]</label></div><br/><div class="children"><div class="content">one question I still have is what exactly the performance issue was? I heard it might be related to enumeration of shared libraries, decoding of the scrambled strings[1], etc. anyone know for sure yet?<p>one other point for investigation is if the code is similar to any other known implants? like the way it obfuscates strings, the way it detects debuggers, the way its setting up a vtable, there might be code fragments shared across projects. Which might give clues about its origin.<p>[1] <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01</a></div><br/></div></div><div id="39897373" class="c"><input type="checkbox" id="c-39897373" checked=""/><div class="controls bullet"><span class="by">webmaven</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896418">parent</a><span>|</span><a href="#39897427">prev</a><span>|</span><a href="#39897569">next</a><span>|</span><label class="collapse" for="c-39897373">[-]</label><label class="expand" for="c-39897373">[3 more]</label></div><br/><div class="children"><div class="content">Was the performance issue pure luck? Or was it a subtle bit of sabotage by someone inside the attacking group worried about the implications of the capability?<p>If it had been successfully and secretly deployed, this is the sort of thing that could make your leaders <i>much</i> more comfortable with starting a &quot;limited war&quot;.<p>There are shades of &quot;Setec Astronomy&quot; here.</div><br/><div id="39900755" class="c"><input type="checkbox" id="c-39900755" checked=""/><div class="controls bullet"><span class="by">papascrubs</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897373">parent</a><span>|</span><a href="#39901291">next</a><span>|</span><label class="collapse" for="c-39900755">[-]</label><label class="expand" for="c-39900755">[1 more]</label></div><br/><div class="children"><div class="content">Plot twist:<p>It was a psyop to increase the scrutiny around OSS components.<p>Kidding. Mostly...<p>But given the amount of scrutiny folks are going to start putting into some supply chains... Probably cheaper to execute than most company&#x27;s annual security awareness budgets cost.</div><br/></div></div><div id="39901291" class="c"><input type="checkbox" id="c-39901291" checked=""/><div class="controls bullet"><span class="by">neodymiumphish</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897373">parent</a><span>|</span><a href="#39900755">prev</a><span>|</span><a href="#39897569">next</a><span>|</span><label class="collapse" for="c-39901291">[-]</label><label class="expand" for="c-39901291">[1 more]</label></div><br/><div class="children"><div class="content">Considering how difficult it might be (and identifiable) to attempt direct exploitation of this without being sure your target is vulnerable, it’s plausible the performance issue allowed for an identifiable delay in attempts. This might be useful in determining whether to attempt the exploit, with an auto-skip if it received a response in less than N milliseconds.</div><br/></div></div></div></div></div></div><div id="39897569" class="c"><input type="checkbox" id="c-39897569" checked=""/><div class="controls bullet"><span class="by">cesarb</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39896418">prev</a><span>|</span><a href="#39902996">next</a><span>|</span><label class="collapse" for="c-39897569">[-]</label><label class="expand" for="c-39897569">[4 more]</label></div><br/><div class="children"><div class="content">This is called NOBUS: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NOBUS" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NOBUS</a></div><br/><div id="39899045" class="c"><input type="checkbox" id="c-39899045" checked=""/><div class="controls bullet"><span class="by">halJordan</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897569">parent</a><span>|</span><a href="#39902996">next</a><span>|</span><label class="collapse" for="c-39899045">[-]</label><label class="expand" for="c-39899045">[3 more]</label></div><br/><div class="children"><div class="content">This is not that concept. That concept is no one but us can technically complete the exploit. Technical feasibility in that you need a supercomputer to do it, not protecting a backdoor with the normal cia triad</div><br/><div id="39900723" class="c"><input type="checkbox" id="c-39900723" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39899045">parent</a><span>|</span><a href="#39902996">next</a><span>|</span><label class="collapse" for="c-39900723">[-]</label><label class="expand" for="c-39900723">[2 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t seem correct:<p><pre><code>    If they determine the vulnerability is only exploitable by the NSA for reasons
    such as computational resources, budget, or skill set, they label it as NOBUS
    and will not move to patch it, but rather leave it open to exploit against current
    or future targets.
</code></pre>
If (!) the NSA regards ssh keys as secure, then from that article it sounds like the NOBUS thing would fit.</div><br/><div id="39902860" class="c"><input type="checkbox" id="c-39902860" checked=""/><div class="controls bullet"><span class="by">CommitSyn</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900723">parent</a><span>|</span><a href="#39902996">next</a><span>|</span><label class="collapse" for="c-39902860">[-]</label><label class="expand" for="c-39902860">[1 more]</label></div><br/><div class="children"><div class="content">That would only fit &quot;If (!) the NSA regards ssh keys as secure &gt;for everyone but them&lt;</div><br/></div></div></div></div></div></div></div></div><div id="39902996" class="c"><input type="checkbox" id="c-39902996" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39897569">prev</a><span>|</span><a href="#39902404">next</a><span>|</span><label class="collapse" for="c-39902996">[-]</label><label class="expand" for="c-39902996">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a (failed) case study in &quot;what if we backdoor it in a way only good guys can use but bad guys can&#x27;t?&quot;<p>Computers don&#x27;t know who&#x27;s &#x2F; what&#x27;s good or bad. They&#x27;re deterministic machines which responds to commands.<p>I don&#x27;t know whether there&#x27;ll be any clues about who did this, but this will be the poster child of &quot;you can&#x27;t have backdoors and security in a single system&quot; argument (which I strongly support).</div><br/></div></div><div id="39902404" class="c"><input type="checkbox" id="c-39902404" checked=""/><div class="controls bullet"><span class="by">Taniwha</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39902996">prev</a><span>|</span><a href="#39896420">next</a><span>|</span><label class="collapse" for="c-39902404">[-]</label><label class="expand" for="c-39902404">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if anyone has packet logs from the past few weeks that show attempts at sshd - might be some incriminating IP addresses to start hunting with</div><br/></div></div><div id="39896420" class="c"><input type="checkbox" id="c-39896420" checked=""/><div class="controls bullet"><span class="by">linsomniac</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39902404">prev</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39896420">[-]</label><label class="expand" for="c-39896420">[10 more]</label></div><br/><div class="children"><div class="content">Am I reading it correctly that the payload signature includes the target SSH host key?  So you can&#x27;t just spray it around to servers, it&#x27;s fairly computationally expensive to send it to a host.</div><br/><div id="39896477" class="c"><input type="checkbox" id="c-39896477" checked=""/><div class="controls bullet"><span class="by">miduil</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896420">parent</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39896477">[-]</label><label class="expand" for="c-39896477">[9 more]</label></div><br/><div class="children"><div class="content">*host key fingerprint, but I assume what you&#x27;ve meant.<p>It&#x27;s practically a good backdoor then, crypto graphically protected and safe against &quot;re-play&quot; attacks.</div><br/><div id="39897359" class="c"><input type="checkbox" id="c-39897359" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39896477">parent</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39897359">[-]</label><label class="expand" for="c-39897359">[8 more]</label></div><br/><div class="children"><div class="content">Not quite. It still looks vulnerable:   an attacker A without the private key impersonates a victim server V and reports their host key. A careless attacker B with the key tries to attack A, but an ends up recovering a valid payload targeting V.</div><br/><div id="39897590" class="c"><input type="checkbox" id="c-39897590" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897359">parent</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39897590">[-]</label><label class="expand" for="c-39897590">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not too familar with the SSH protocol, but is it possible to impersonate a victim server V without having the private key to their host key?</div><br/><div id="39898073" class="c"><input type="checkbox" id="c-39898073" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897590">parent</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39898073">[-]</label><label class="expand" for="c-39898073">[6 more]</label></div><br/><div class="children"><div class="content">This stuff is pre-auth.<p>You can just treat the entire thing as opaque and proxy everything to the host you&#x27;re trying to compromise; as soon as you have an exploit string for a given host you can just replay it.</div><br/><div id="39900571" class="c"><input type="checkbox" id="c-39900571" checked=""/><div class="controls bullet"><span class="by">robryk</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898073">parent</a><span>|</span><a href="#39902112">next</a><span>|</span><label class="collapse" for="c-39900571">[-]</label><label class="expand" for="c-39900571">[2 more]</label></div><br/><div class="children"><div class="content">Ssh does client authentication after handshake. The server is required to sign the handshake result with its private key, so you won&#x27;t get past handshake if you are a server that claims to have a public key that you don&#x27;t know the private key for.<p>E: see RFC 4253, sections 8 and 10, and RFC 4252 for corroboration</div><br/><div id="39901809" class="c"><input type="checkbox" id="c-39901809" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39900571">parent</a><span>|</span><a href="#39902112">next</a><span>|</span><label class="collapse" for="c-39901809">[-]</label><label class="expand" for="c-39901809">[1 more]</label></div><br/><div class="children"><div class="content">Huh, I had erroneously thought the exploit string was sent earlier in the connection, before the handshaking completed (note the &quot;handshake failed&quot; error in xzbot on successful exploit, and also the fact that no logging is done).<p>But you&#x27;re right: we&#x27;ve verified the hostkey by the time we send the special certificate. So there&#x27;s no way to effectively replay this without access to the server keys. My original comment is incorrect.<p>I&#x27;m actually surprised there&#x27;s no logging at INFO or higher after this succeeds, given that openssh typically logs preauth connection closes. But I guess the crutch is that we never log connection opens and we only really log failures in handshaking, and it&#x27;s not like the backdoor is going to go out of its way to log the fact that it opened itself...</div><br/></div></div></div></div><div id="39902112" class="c"><input type="checkbox" id="c-39902112" checked=""/><div class="controls bullet"><span class="by">bandrami</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898073">parent</a><span>|</span><a href="#39900571">prev</a><span>|</span><a href="#39900883">next</a><span>|</span><label class="collapse" for="c-39902112">[-]</label><label class="expand" for="c-39902112">[2 more]</label></div><br/><div class="children"><div class="content">The whole point of asymmetric-key is that a middleman can&#x27;t do that. Even if you relayed the entire handshake, all traffic after that is just line noise to you unless you have the transmitter&#x27;s private key. You can&#x27;t read it or mangle it (well, you can mangle it, but the receiving party will know it was mangled in transit). The exploit string on the wire for that transmission won&#x27;t work in the context of any other transmission sequence.</div><br/><div id="39902128" class="c"><input type="checkbox" id="c-39902128" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39902112">parent</a><span>|</span><a href="#39900883">next</a><span>|</span><label class="collapse" for="c-39902128">[-]</label><label class="expand" for="c-39902128">[1 more]</label></div><br/><div class="children"><div class="content">Yeah I had mistakenly thought the exploit string was transmitted during key exchange (read too quickly on &quot;pre-auth&quot;), which is incorrect; see sibling comment. I&#x27;m unfortunately past the edit window now.</div><br/></div></div></div></div><div id="39900883" class="c"><input type="checkbox" id="c-39900883" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39898073">parent</a><span>|</span><a href="#39902112">prev</a><span>|</span><a href="#39901527">next</a><span>|</span><label class="collapse" for="c-39900883">[-]</label><label class="expand" for="c-39900883">[1 more]</label></div><br/><div class="children"><div class="content">I suppose the original attacker could give really fancy exploit strings that verify the eventual payload strongly enough to prevent someone replaying the attack from accomplishing much.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="39901527" class="c"><input type="checkbox" id="c-39901527" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39896420">prev</a><span>|</span><a href="#39897212">next</a><span>|</span><label class="collapse" for="c-39901527">[-]</label><label class="expand" for="c-39901527">[1 more]</label></div><br/><div class="children"><div class="content">IMHO it&#x27;s not that surprising; asymmetric crypto has been common in ransomware for a long time, and of course ransomware in general is based on securing data from its owner.<p>&quot;It&#x27;s not only the good guys who have guns.&quot;</div><br/></div></div><div id="39897212" class="c"><input type="checkbox" id="c-39897212" checked=""/><div class="controls bullet"><span class="by">nialv7</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39901527">prev</a><span>|</span><a href="#39902895">next</a><span>|</span><label class="collapse" for="c-39897212">[-]</label><label class="expand" for="c-39897212">[2 more]</label></div><br/><div class="children"><div class="content">how are you going to sell it if anyone can get in?</div><br/><div id="39900760" class="c"><input type="checkbox" id="c-39900760" checked=""/><div class="controls bullet"><span class="by">ryanmerket</span><span>|</span><a href="#39896221">root</a><span>|</span><a href="#39897212">parent</a><span>|</span><a href="#39902895">next</a><span>|</span><label class="collapse" for="c-39900760">[-]</label><label class="expand" for="c-39900760">[1 more]</label></div><br/><div class="children"><div class="content">this is probably the right answer. hacking group getting a 0day to sell to nation states on a per-use agreement.</div><br/></div></div></div></div><div id="39902895" class="c"><input type="checkbox" id="c-39902895" checked=""/><div class="controls bullet"><span class="by">whirlwin</span><span>|</span><a href="#39896221">parent</a><span>|</span><a href="#39897212">prev</a><span>|</span><a href="#39900790">next</a><span>|</span><label class="collapse" for="c-39902895">[-]</label><label class="expand" for="c-39902895">[1 more]</label></div><br/><div class="children"><div class="content">Imagine how much the private key is worth on the black market</div><br/></div></div></div></div><div id="39895799" class="c"><input type="checkbox" id="c-39895799" checked=""/><div class="controls bullet"><span class="by">miduil</span><span>|</span><a href="#39896221">prev</a><span>|</span><a href="#39895984">next</a><span>|</span><label class="collapse" for="c-39895799">[-]</label><label class="expand" for="c-39895799">[14 more]</label></div><br/><div class="children"><div class="content">Super impressed how quickly the community and in particular amlweems were able to implement and document a POC. If the cryptographic or payload loading functionality has no further vulnerabilities, this would have been also at least not introducing a security flaw to all the other attackers until the key is broken or something.<p>Edit: I think what&#x27;s next for anyone is to figure out a way to probe for vulnerable deployments (which seems non-trivial) and also perhaps possibly ?upstreaming? a way to monitor if someone actively probes ssh servers with the hardcoded key.<p>Kudos!</div><br/><div id="39895840" class="c"><input type="checkbox" id="c-39895840" checked=""/><div class="controls bullet"><span class="by">rst</span><span>|</span><a href="#39895799">parent</a><span>|</span><a href="#39896033">next</a><span>|</span><label class="collapse" for="c-39895840">[-]</label><label class="expand" for="c-39895840">[9 more]</label></div><br/><div class="children"><div class="content">Well, it&#x27;s a POC against a re-keyed version of the exploit; a POC against the original version would require the attacker&#x27;s private key, which is undisclosed.</div><br/><div id="39895867" class="c"><input type="checkbox" id="c-39895867" checked=""/><div class="controls bullet"><span class="by">miduil</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39895840">parent</a><span>|</span><a href="#39899979">next</a><span>|</span><label class="collapse" for="c-39895867">[-]</label><label class="expand" for="c-39895867">[7 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a POC nevertheless, it&#x27;s a complete implementation of the RCE minus obviously the private key.</div><br/><div id="39895992" class="c"><input type="checkbox" id="c-39895992" checked=""/><div class="controls bullet"><span class="by">nindalf</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39895867">parent</a><span>|</span><a href="#39899979">next</a><span>|</span><label class="collapse" for="c-39895992">[-]</label><label class="expand" for="c-39895992">[6 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t matter. The people with the private key already knew all of this because they implemented it. The script kiddies without the private key can&#x27;t do anything without it. A POC doesn&#x27;t help them in any way.<p>A way to check if servers are vulnerable is probably by querying the package manager for the installed version of xz. Not very sophisticated, but it&#x27;ll work.</div><br/><div id="39896276" class="c"><input type="checkbox" id="c-39896276" checked=""/><div class="controls bullet"><span class="by">miduil</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39895992">parent</a><span>|</span><a href="#39896488">next</a><span>|</span><label class="collapse" for="c-39896276">[-]</label><label class="expand" for="c-39896276">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It doesn&#x27;t matter.<p>To understand the exact behavior and extend of the backdoor, this does matter. An end to end proof of how it works is exactly what was needed.<p>&gt; A way to check if servers are vulnerable is probably by querying the package manager<p>Yes, this has been know since the initial report + later discovering what exact strings are present for the payload.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;Neo23x0&#x2F;signature-base&#x2F;blob&#x2F;master&#x2F;yara&#x2F;bkdr_xz_util_cve_2024_3094.yar">https:&#x2F;&#x2F;github.com&#x2F;Neo23x0&#x2F;signature-base&#x2F;blob&#x2F;master&#x2F;yara&#x2F;b...</a><p>&gt; Not very sophisticated, but it&#x27;ll work.<p>Unfortunately, we live in a world with closed-servers and appliances - being able as a customer or pen tester rule out certain class of security issues without having the source&#x2F;insights available is usually desirable.</div><br/><div id="39896643" class="c"><input type="checkbox" id="c-39896643" checked=""/><div class="controls bullet"><span class="by">nindalf</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39896276">parent</a><span>|</span><a href="#39896488">next</a><span>|</span><label class="collapse" for="c-39896643">[-]</label><label class="expand" for="c-39896643">[1 more]</label></div><br/><div class="children"><div class="content">&gt; we live in a world with closed-servers and appliances<p>Yeah but these servers and appliances aren&#x27;t running Debian unstable are they? I&#x27;d understand if it affected LTS versions of distros, but these were people living on the bleeding edge anyway. Folks managing such servers are going to be fine running `apt-get update`.<p>We got lucky with this one, tbh.</div><br/></div></div></div></div><div id="39896488" class="c"><input type="checkbox" id="c-39896488" checked=""/><div class="controls bullet"><span class="by">doakes</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39895992">parent</a><span>|</span><a href="#39896276">prev</a><span>|</span><a href="#39899979">next</a><span>|</span><label class="collapse" for="c-39896488">[-]</label><label class="expand" for="c-39896488">[3 more]</label></div><br/><div class="children"><div class="content">Are you saying POCs are pointless unless a script kiddie can use it?</div><br/><div id="39896691" class="c"><input type="checkbox" id="c-39896691" checked=""/><div class="controls bullet"><span class="by">nindalf</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39896488">parent</a><span>|</span><a href="#39899979">next</a><span>|</span><label class="collapse" for="c-39896691">[-]</label><label class="expand" for="c-39896691">[2 more]</label></div><br/><div class="children"><div class="content">The <i>context</i> of the conversation, which you seem to have missed, is that now that we have a POC, we need a way to check for vulnerable servers. The link being that a POC makes it easier for script kiddies to use it, meaning we&#x27;re in a race against them. But we aren&#x27;t, because only one group in the whole world can use this exploit.</div><br/><div id="39897177" class="c"><input type="checkbox" id="c-39897177" checked=""/><div class="controls bullet"><span class="by">miduil</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39896691">parent</a><span>|</span><a href="#39899979">next</a><span>|</span><label class="collapse" for="c-39897177">[-]</label><label class="expand" for="c-39897177">[1 more]</label></div><br/><div class="children"><div class="content">&gt; is that now that we have a POC, we need a way to check for vulnerable servers.<p>You misunderstand me, the &quot;need to check for vulnerable servers&quot; has nothing to do with the PoC in itself. You want to know whether you&#x27;re vulnerable against this mysterious unknown attacker that went through the all the hoops for a sophisticated supply chain attack. I never said that we need a way to detect it because there is a POC out, at least I didn&#x27;t meant to imply that either.<p>&gt; script kiddies to use it, meaning we&#x27;re in a race against them<p>This is something you and the other person were suddenly coming up with, never said this in first place.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39899979" class="c"><input type="checkbox" id="c-39899979" checked=""/><div class="controls bullet"><span class="by">misswaterfairy</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39895840">parent</a><span>|</span><a href="#39895867">prev</a><span>|</span><a href="#39896033">next</a><span>|</span><label class="collapse" for="c-39899979">[-]</label><label class="expand" for="c-39899979">[1 more]</label></div><br/><div class="children"><div class="content">Could the provided honeypot print out keys used in successful and unsuccessful attempts?</div><br/></div></div></div></div><div id="39896033" class="c"><input type="checkbox" id="c-39896033" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39895799">parent</a><span>|</span><a href="#39895840">prev</a><span>|</span><a href="#39895984">next</a><span>|</span><label class="collapse" for="c-39896033">[-]</label><label class="expand" for="c-39896033">[4 more]</label></div><br/><div class="children"><div class="content">Probing for vulnerable deployments over the network (without the attacker&#x27;s private key) seems impossible, not non-trivial.<p>The best one could do is more micro-benchmarking, but for an arbitrary Internet host you aren&#x27;t going to know whether it&#x27;s slow because it&#x27;s vulnerable, or because it&#x27;s far away, or because the computer&#x27;s slow in general -- you don&#x27;t have access to how long connection attempts to that host took historically. (And of course, there are also routing fluctuations.)</div><br/><div id="39899659" class="c"><input type="checkbox" id="c-39899659" checked=""/><div class="controls bullet"><span class="by">anonymous-panda</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39896033">parent</a><span>|</span><a href="#39896368">next</a><span>|</span><label class="collapse" for="c-39899659">[-]</label><label class="expand" for="c-39899659">[2 more]</label></div><br/><div class="children"><div class="content">Should be able to do it by having the scanner take multiple samples. As long as you don’t need a valid login and the performance issue is still observable, you should be about to scan for it with minimal cost</div><br/><div id="39902728" class="c"><input type="checkbox" id="c-39902728" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#39895799">root</a><span>|</span><a href="#39899659">parent</a><span>|</span><a href="#39896368">next</a><span>|</span><label class="collapse" for="c-39902728">[-]</label><label class="expand" for="c-39902728">[1 more]</label></div><br/><div class="children"><div class="content">Looks like the slowdown is actually at sshd process startup time, not authentication time. So it&#x27;s back to being completely impossible to network-probe for.</div><br/></div></div></div></div></div></div></div></div><div id="39895984" class="c"><input type="checkbox" id="c-39895984" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39895799">prev</a><span>|</span><a href="#39902790">next</a><span>|</span><label class="collapse" for="c-39895984">[-]</label><label class="expand" for="c-39895984">[8 more]</label></div><br/><div class="children"><div class="content">Has anyone tried the PoC against one of the anomalous process behavior tools? (Carbon Black, AWS GuardDuty, SysDig, etc.) I’m curious how likely it is that someone would have noticed relatively quickly had this rolled forward and this seems like a perfect test case for that product category.</div><br/><div id="39898972" class="c"><input type="checkbox" id="c-39898972" checked=""/><div class="controls bullet"><span class="by">dogman144</span><span>|</span><a href="#39895984">parent</a><span>|</span><a href="#39896512">next</a><span>|</span><label class="collapse" for="c-39898972">[-]</label><label class="expand" for="c-39898972">[2 more]</label></div><br/><div class="children"><div class="content">Depends how closely the exploit mirrors and&#x2F;or masks itself within normal compression behavior imo.<p>I don’t think GuardDuty would catch it as it doesn’t look at processes like an EDR does (CrowdStrike, Carbon black), I don’t think sysdig would catch it as looks at containers and cloud infra. Handwaving some complexity here, as GD and sysdig could prob catch something odd via privileges gained and follow-on efforts by the threat actor via this exploit.<p>So imo means only EDRs (monitoring processes on endpoints) or software supply chain evaluations (monitoring sec problems in upstream FOSS) are most likely to catch the exploit itself.<p>Leads into another fairly large security theme interestingly - dev teams can dislike putting EDRs on boxes bc of the hit on compute and UX issues if a containment happens, and can dislike limits policy and limits around FOSS use. So this exploit hits at the heart of a org-driven “vulnerability” that has a lot of logic to stay exposed to or to fix, depending on where you sit.  Security industry’s problem set in a nutshell.</div><br/><div id="39899845" class="c"><input type="checkbox" id="c-39899845" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39895984">root</a><span>|</span><a href="#39898972">parent</a><span>|</span><a href="#39896512">next</a><span>|</span><label class="collapse" for="c-39899845">[-]</label><label class="expand" for="c-39899845">[1 more]</label></div><br/><div class="children"><div class="content">Guard Duty does have some ptocees level monitoring with some recent additions: <a href="https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;aws&#x2F;amazon-guardduty-ec2-runtime-monitoring-is-now-generally-available&#x2F;" rel="nofollow">https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;aws&#x2F;amazon-guardduty-ec2-runtim...</a><p>The main thing I was thinking is that the audit hooking and especially runtime patching across modules (liblzma5 patching functions in the main sshd code block) seems like the kind of thing a generic behavioral profile could get but especially one driven by the fact that sshd does not do any of that normally.<p>And, yes, performance and reliability issues are a big problem here. When CarbonBlack takes down production again, you probably end up with a bunch of exclusions which mean an actual attacker might be missed.</div><br/></div></div></div></div><div id="39896512" class="c"><input type="checkbox" id="c-39896512" checked=""/><div class="controls bullet"><span class="by">knoxa2511</span><span>|</span><a href="#39895984">parent</a><span>|</span><a href="#39898972">prev</a><span>|</span><a href="#39896387">next</a><span>|</span><label class="collapse" for="c-39896512">[-]</label><label class="expand" for="c-39896512">[4 more]</label></div><br/><div class="children"><div class="content">Sysdig released a blog on friday. &quot;For runtime detection, one way to go about it is to watch for the loading of the malicious library by SSHD. These shared libraries often include the version in their filename.&quot;<p>The blog has the actual rule content which I haven&#x27;t seen from other security vendors<p><a href="https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;cve-2024-3094-detecting-the-sshd-backdoor-in-xz-utils&#x2F;" rel="nofollow">https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;cve-2024-3094-detecting-the-sshd-bac...</a></div><br/><div id="39898274" class="c"><input type="checkbox" id="c-39898274" checked=""/><div class="controls bullet"><span class="by">RamRodification</span><span>|</span><a href="#39895984">root</a><span>|</span><a href="#39896512">parent</a><span>|</span><a href="#39897445">next</a><span>|</span><label class="collapse" for="c-39898274">[-]</label><label class="expand" for="c-39898274">[1 more]</label></div><br/><div class="children"><div class="content">That relies on knowing what to look for. I.e. &quot;the malicious library&quot;. The question is whether any of these solutions could catch it without knowing about it beforehand and having a detection rule specifically made for it.</div><br/></div></div><div id="39897445" class="c"><input type="checkbox" id="c-39897445" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39895984">root</a><span>|</span><a href="#39896512">parent</a><span>|</span><a href="#39898274">prev</a><span>|</span><a href="#39896387">next</a><span>|</span><label class="collapse" for="c-39897445">[-]</label><label class="expand" for="c-39897445">[2 more]</label></div><br/><div class="children"><div class="content">Thanks! That’s a little disappointing since I would have thought that the way it hooked those functions could’ve been caught by a generic heuristic but perhaps that’s more common than I thought.</div><br/><div id="39901191" class="c"><input type="checkbox" id="c-39901191" checked=""/><div class="controls bullet"><span class="by">acid__</span><span>|</span><a href="#39895984">root</a><span>|</span><a href="#39897445">parent</a><span>|</span><a href="#39896387">next</a><span>|</span><label class="collapse" for="c-39901191">[-]</label><label class="expand" for="c-39901191">[1 more]</label></div><br/><div class="children"><div class="content">My experience from working in the security space is that all the tech is pretty un-sexy (with very good sales pitches), and none of it will save you from a nation-state attacker.</div><br/></div></div></div></div></div></div></div></div><div id="39902790" class="c"><input type="checkbox" id="c-39902790" checked=""/><div class="controls bullet"><span class="by">dxthrwy856</span><span>|</span><a href="#39895984">prev</a><span>|</span><a href="#39896629">next</a><span>|</span><label class="collapse" for="c-39902790">[-]</label><label class="expand" for="c-39902790">[3 more]</label></div><br/><div class="children"><div class="content">The parallels in this one to the audacity event a couple years back are ridiculous.<p>Cookie guy claimed that he got stabbed and that the federal police was involved in the case, which kind of hints that the events were connected to much bigger actors than just 4chan. At the time a lot of people thought its just Muse Group that&#x27;s involved, but maybe it was a (Russian) state actor?<p>Because before that he claimed that audacity had lots of telemetry&#x2F;backdoors which were the reason he forked and removed in his first commits. Maybe audacity is backdoored after all?<p>Have to check the audacity source code now.</div><br/><div id="39903024" class="c"><input type="checkbox" id="c-39903024" checked=""/><div class="controls bullet"><span class="by">cookiengineer</span><span>|</span><a href="#39902790">parent</a><span>|</span><a href="#39902875">next</a><span>|</span><label class="collapse" for="c-39903024">[-]</label><label class="expand" for="c-39903024">[1 more]</label></div><br/><div class="children"><div class="content">Careful, APT28 is pretty dangerous. They are merging their ops with APT29 these days, and I wouldn&#x27;t wake the cozy bear if I were you.</div><br/></div></div><div id="39902875" class="c"><input type="checkbox" id="c-39902875" checked=""/><div class="controls bullet"><span class="by">CommitSyn</span><span>|</span><a href="#39902790">parent</a><span>|</span><a href="#39903024">prev</a><span>|</span><a href="#39896629">next</a><span>|</span><label class="collapse" for="c-39902875">[-]</label><label class="expand" for="c-39902875">[1 more]</label></div><br/><div class="children"><div class="content">Cookie guy?</div><br/></div></div></div></div><div id="39896629" class="c"><input type="checkbox" id="c-39896629" checked=""/><div class="controls bullet"><span class="by">faxmeyourcode</span><span>|</span><a href="#39902790">prev</a><span>|</span><a href="#39896915">next</a><span>|</span><label class="collapse" for="c-39896629">[-]</label><label class="expand" for="c-39896629">[7 more]</label></div><br/><div class="children"><div class="content">Edit: I misunderstood what I was reading in the link below, my original comment is here for posterity. :)<p>&gt; From down in the same mail thread: it looks like the individual who committed the backdoor has made some recent contributions to the kernel as well... Ouch.<p><a href="https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;10" rel="nofollow">https:&#x2F;&#x2F;www.openwall.com&#x2F;lists&#x2F;oss-security&#x2F;2024&#x2F;03&#x2F;29&#x2F;10</a><p>The OP is such great analysis, I love reading this kind of stuff!</div><br/><div id="39897150" class="c"><input type="checkbox" id="c-39897150" checked=""/><div class="controls bullet"><span class="by">ibotty</span><span>|</span><a href="#39896629">parent</a><span>|</span><a href="#39897083">next</a><span>|</span><label class="collapse" for="c-39897150">[-]</label><label class="expand" for="c-39897150">[1 more]</label></div><br/><div class="children"><div class="content">No that patch series is from Lasse.  He said himself that it&#x27;s not urgent in any way and it won&#x27;t be merged this merge window, but nobody (sane) is accusing Lasse of being the bad actor.</div><br/></div></div><div id="39897083" class="c"><input type="checkbox" id="c-39897083" checked=""/><div class="controls bullet"><span class="by">davikr</span><span>|</span><a href="#39896629">parent</a><span>|</span><a href="#39897150">prev</a><span>|</span><a href="#39897141">next</a><span>|</span><label class="collapse" for="c-39897083">[-]</label><label class="expand" for="c-39897083">[3 more]</label></div><br/><div class="children"><div class="content">Lasse Collin is not Jia Tan until proven otherwise.</div><br/><div id="39901239" class="c"><input type="checkbox" id="c-39901239" checked=""/><div class="controls bullet"><span class="by">pavon</span><span>|</span><a href="#39896629">root</a><span>|</span><a href="#39897083">parent</a><span>|</span><a href="#39899379">next</a><span>|</span><label class="collapse" for="c-39901239">[-]</label><label class="expand" for="c-39901239">[1 more]</label></div><br/><div class="children"><div class="content">No, he likely is not. But the patch series includes commits co-developed by Jia Tan, and lists Jia Tan as a maintainer of the kernel module.</div><br/></div></div><div id="39899379" class="c"><input type="checkbox" id="c-39899379" checked=""/><div class="controls bullet"><span class="by">robocat</span><span>|</span><a href="#39896629">root</a><span>|</span><a href="#39897083">parent</a><span>|</span><a href="#39901239">prev</a><span>|</span><a href="#39897141">next</a><span>|</span><label class="collapse" for="c-39899379">[-]</label><label class="expand" for="c-39899379">[1 more]</label></div><br/><div class="children"><div class="content">Passive aggressive accusation.<p>This style of fake doubt is really not appropriate anywhere.</div><br/></div></div></div></div><div id="39897141" class="c"><input type="checkbox" id="c-39897141" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39896629">parent</a><span>|</span><a href="#39897083">prev</a><span>|</span><a href="#39900994">next</a><span>|</span><label class="collapse" for="c-39897141">[-]</label><label class="expand" for="c-39897141">[1 more]</label></div><br/><div class="children"><div class="content">The referenced patch series had not made it into the kernel yet.</div><br/></div></div><div id="39900994" class="c"><input type="checkbox" id="c-39900994" checked=""/><div class="controls bullet"><span class="by">wezdog1</span><span>|</span><a href="#39896629">parent</a><span>|</span><a href="#39897141">prev</a><span>|</span><a href="#39896915">next</a><span>|</span><label class="collapse" for="c-39900994">[-]</label><label class="expand" for="c-39900994">[1 more]</label></div><br/><div class="children"><div class="content">Also it may br a coincidence but JiaT75 looks a lot like Transponder 7500 which in aviation means hijacked...</div><br/></div></div></div></div><div id="39896915" class="c"><input type="checkbox" id="c-39896915" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#39896629">prev</a><span>|</span><a href="#39896524">next</a><span>|</span><label class="collapse" for="c-39896915">[-]</label><label class="expand" for="c-39896915">[17 more]</label></div><br/><div class="children"><div class="content">Instead of needing the honeypot openssh.patch at compile-time <a href="https:&#x2F;&#x2F;github.com&#x2F;amlweems&#x2F;xzbot&#x2F;blob&#x2F;main&#x2F;openssh.patch">https:&#x2F;&#x2F;github.com&#x2F;amlweems&#x2F;xzbot&#x2F;blob&#x2F;main&#x2F;openssh.patch</a><p>How did the exploit do this at runtime?<p>I know the chain was:<p>opensshd -&gt; systemd for notifications -&gt; xz included as transient dependency<p>How did liblzma.so.5.6.1 hook&#x2F;patch all the way back to openssh_RSA_verify when it was loaded into memory?</div><br/><div id="39897012" class="c"><input type="checkbox" id="c-39897012" checked=""/><div class="controls bullet"><span class="by">tadfisher</span><span>|</span><a href="#39896915">parent</a><span>|</span><a href="#39897002">next</a><span>|</span><label class="collapse" for="c-39897012">[-]</label><label class="expand" for="c-39897012">[13 more]</label></div><br/><div class="children"><div class="content">When loading liblzma, it patches the ELF GOT (global offset table) with the address of the malicious code. In case it&#x27;s loaded before libcrypto, it registers a symbol audit handler (a glibc-specific feature, IIUC) to get notified when libcrypto&#x27;s symbols are resolved so it can defer patching the GOT.</div><br/><div id="39897102" class="c"><input type="checkbox" id="c-39897102" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897012">parent</a><span>|</span><a href="#39897002">next</a><span>|</span><label class="collapse" for="c-39897102">[-]</label><label class="expand" for="c-39897102">[12 more]</label></div><br/><div class="children"><div class="content">&gt; When loading liblzma, it patches the ELF GOT (global offset table) with the address of the malicious code.<p>How was this part obfuscated&#x2F;undetected?</div><br/><div id="39897184" class="c"><input type="checkbox" id="c-39897184" checked=""/><div class="controls bullet"><span class="by">bewaretheirs</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897102">parent</a><span>|</span><a href="#39897002">next</a><span>|</span><label class="collapse" for="c-39897184">[-]</label><label class="expand" for="c-39897184">[11 more]</label></div><br/><div class="children"><div class="content">it was part of the binary malware payload hidden in a binary blob of &quot;test data&quot;.<p>In a compression&#x2F;decompression test suite, a subtly broken allegedly compressed binary blob is not out of place.<p>This suggests we need to audit information flow during builds - the shipping production binary package should be reproduceably buildable without reading test data or test code.</div><br/><div id="39897276" class="c"><input type="checkbox" id="c-39897276" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897184">parent</a><span>|</span><a href="#39900305">prev</a><span>|</span><a href="#39897002">next</a><span>|</span><label class="collapse" for="c-39897276">[-]</label><label class="expand" for="c-39897276">[9 more]</label></div><br/><div class="children"><div class="content">How&#x2F;why did the test data get bundled into the final library output?</div><br/><div id="39897676" class="c"><input type="checkbox" id="c-39897676" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897276">parent</a><span>|</span><a href="#39897562">next</a><span>|</span><label class="collapse" for="c-39897676">[-]</label><label class="expand" for="c-39897676">[6 more]</label></div><br/><div class="children"><div class="content">That’s what the compromised build stage did. It’s really interesting to read if you want to see the details of how a sophisticated attacker works:<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;thesamesam&#x2F;223949d5a074ebc3dce9ee78baad9e27#design" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;thesamesam&#x2F;223949d5a074ebc3dce9ee78b...</a><p><a href="https:&#x2F;&#x2F;gynvael.coldwind.pl&#x2F;?lang=en&amp;id=782" rel="nofollow">https:&#x2F;&#x2F;gynvael.coldwind.pl&#x2F;?lang=en&amp;id=782</a></div><br/><div id="39898286" class="c"><input type="checkbox" id="c-39898286" checked=""/><div class="controls bullet"><span class="by">MuffinFlavored</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897676">parent</a><span>|</span><a href="#39897562">next</a><span>|</span><label class="collapse" for="c-39898286">[-]</label><label class="expand" for="c-39898286">[5 more]</label></div><br/><div class="children"><div class="content">&gt; build-to-host.m4<p>I wasn&#x27;t aware that the rogue maintainer was able to commit himself without any PR review (or he snuck it through PR review) rogue steps in the build process as well that went unnoticed so that he could bundle decompressed `xz` streams from test data, that also patched output .so files well enough to add hooking code to them.<p>How many &quot;process failures&quot; are described in that process that exist in every OSS repo with volunteer unknown untrusted maintainers?</div><br/><div id="39898765" class="c"><input type="checkbox" id="c-39898765" checked=""/><div class="controls bullet"><span class="by">belthesar</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39898286">parent</a><span>|</span><a href="#39900497">next</a><span>|</span><label class="collapse" for="c-39898765">[-]</label><label class="expand" for="c-39898765">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s kind of the rub here.<p>&gt; volunteer
That&#x27;s the majority of OSS. Only a handful of the projects we use today as a part of the core set of systems in the OSS world actually have corporate sponsorship by virtue of maintainers&#x2F;contributors on the payroll. 
&gt; unknown
The actor built up a positive reputation by assisting with maintaining the repo at a time when the lead dev was unable to take an active role. In this sense, although we did not have some kind of full chain of authentication that &quot;Jia Tan&quot; was a real human that existed, that&#x27;s about as good as it gets, and there&#x27;s plenty of real world examples of espionage in both the open and closed source software world that can tell us that identity verification may not have prevented anything.
&gt; untrusted
The actor gained trust. The barrier to gaining trust may have been low due to the mental health of the lead maintainer, but trust was earned and received. The lead maintainer communicated to distros that they should be added.<p>That&#x27;s the rub here. It&#x27;s _really easy_ to say this is a process problem. It&#x27;s not. This was a social engineering attack first and foremost before anything else. It unlocked the way forward for the threat actor to take many actions unilaterally.</div><br/></div></div><div id="39900497" class="c"><input type="checkbox" id="c-39900497" checked=""/><div class="controls bullet"><span class="by">Aloisius</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39898286">parent</a><span>|</span><a href="#39898765">prev</a><span>|</span><a href="#39899749">next</a><span>|</span><label class="collapse" for="c-39900497">[-]</label><label class="expand" for="c-39900497">[1 more]</label></div><br/><div class="children"><div class="content">The changes to build-to-host.m4 <i>weren&#x27;t</i> in the source repo, so there was no commit.<p>The attacker had permissions to create GitHub releases, so they simply added it to the GitHub release tarball.</div><br/></div></div><div id="39899749" class="c"><input type="checkbox" id="c-39899749" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39898286">parent</a><span>|</span><a href="#39900497">prev</a><span>|</span><a href="#39898934">next</a><span>|</span><label class="collapse" for="c-39899749">[-]</label><label class="expand" for="c-39899749">[1 more]</label></div><br/><div class="children"><div class="content">This guy was pretty trusted after a couple of years of working on the project so I think it’s a category error to say process improvements could have fixed it. The use of autoconf detritus was a canny move since I’d bet long odds that even if your process said three other people had to review every commit they would have skimmed right over that to the ”important” changes.</div><br/></div></div><div id="39898934" class="c"><input type="checkbox" id="c-39898934" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39898286">parent</a><span>|</span><a href="#39899749">prev</a><span>|</span><a href="#39897562">next</a><span>|</span><label class="collapse" for="c-39898934">[-]</label><label class="expand" for="c-39898934">[1 more]</label></div><br/><div class="children"><div class="content">&gt; How many &quot;process failures&quot; are described in that process that exist in every OSS repo with volunteer unknown untrusted maintainers?<p>What process failures actually happened here? What changes in process do you think would have stopped this?</div><br/></div></div></div></div></div></div><div id="39897562" class="c"><input type="checkbox" id="c-39897562" checked=""/><div class="controls bullet"><span class="by">matthew-wegner</span><span>|</span><a href="#39896915">root</a><span>|</span><a href="#39897276">parent</a><span>|</span><a href="#39897676">prev</a><span>|</span><a href="#39897620">next</a><span>|</span><label class="collapse" for="c-39897562">[-]</label><label class="expand" for="c-39897562">[1 more]</label></div><br/><div class="children"><div class="content">&quot;xz&#x2F;liblzma: Bash-stage Obfuscation Explained&quot; covers it well<p><a href="https:&#x2F;&#x2F;gynvael.coldwind.pl&#x2F;?lang=en&amp;id=782" rel="nofollow">https:&#x2F;&#x2F;gynvael.coldwind.pl&#x2F;?lang=en&amp;id=782</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="39896972" class="c"><input type="checkbox" id="c-39896972" checked=""/><div class="controls bullet"><span class="by">jeffrallen</span><span>|</span><a href="#39896915">parent</a><span>|</span><a href="#39897090">prev</a><span>|</span><a href="#39896524">next</a><span>|</span><label class="collapse" for="c-39896972">[-]</label><label class="expand" for="c-39896972">[1 more]</label></div><br/><div class="children"><div class="content">ifunc</div><br/></div></div></div></div><div id="39896524" class="c"><input type="checkbox" id="c-39896524" checked=""/><div class="controls bullet"><span class="by">mrob</span><span>|</span><a href="#39896915">prev</a><span>|</span><a href="#39901869">next</a><span>|</span><label class="collapse" for="c-39896524">[-]</label><label class="expand" for="c-39896524">[3 more]</label></div><br/><div class="children"><div class="content">Do we know if this exploit only did something if a SSH connection was made? There&#x27;s a list of strings from it on Github that includes &quot;DISPLAY&quot; and &quot;WAYLAND_DISPLAY&quot;:<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;q3k&#x2F;af3d93b6a1f399de28fe194add452d01</a><p>These don&#x27;t have any obvious connection to SSH, so maybe it did things even if there was no connection. This could be important to people who ran the code but never exposed their SSH server to the Internet, which some people seem to be assuming was safe.</div><br/><div id="39896689" class="c"><input type="checkbox" id="c-39896689" checked=""/><div class="controls bullet"><span class="by">rdtsc</span><span>|</span><a href="#39896524">parent</a><span>|</span><a href="#39896553">next</a><span>|</span><label class="collapse" for="c-39896689">[-]</label><label class="expand" for="c-39896689">[1 more]</label></div><br/><div class="children"><div class="content">Those are probably kill switches to prevent the exploit from working if there is a terminal open or runs in a GUI session. In other words someone trying to detect, reproduce or debug it.</div><br/></div></div><div id="39896553" class="c"><input type="checkbox" id="c-39896553" checked=""/><div class="controls bullet"><span class="by">cma</span><span>|</span><a href="#39896524">parent</a><span>|</span><a href="#39896689">prev</a><span>|</span><a href="#39901869">next</a><span>|</span><label class="collapse" for="c-39896553">[-]</label><label class="expand" for="c-39896553">[1 more]</label></div><br/><div class="children"><div class="content">Could that be related x11 session forwarding (common security hole on the connectors&#x27; side if they don&#x27;t turn it off when connecting to an untrusted machine).</div><br/></div></div></div></div><div id="39901869" class="c"><input type="checkbox" id="c-39901869" checked=""/><div class="controls bullet"><span class="by">heeen2</span><span>|</span><a href="#39896524">prev</a><span>|</span><a href="#39896455">next</a><span>|</span><label class="collapse" for="c-39901869">[-]</label><label class="expand" for="c-39901869">[2 more]</label></div><br/><div class="children"><div class="content">I wonder if separating the test files out into their own repo, so that they would not have been available at build time could have made this harder. The reasoning being that anything available and this potentially involved in the build should be human readable.</div><br/><div id="39902031" class="c"><input type="checkbox" id="c-39902031" checked=""/><div class="controls bullet"><span class="by">Zuiii</span><span>|</span><a href="#39901869">parent</a><span>|</span><a href="#39896455">next</a><span>|</span><label class="collapse" for="c-39902031">[-]</label><label class="expand" for="c-39902031">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Anything available and this potentially involved in the build should be human readable.<p>That&#x27;s actually a good principle to adopt overall.<p>We should treat this attack like an air plane accident and adopt new rules that mitigate the chances of it being successfully carried out again. We might not be able to vet every single person who contributes, but we should be able to easily separate out noisy test data.</div><br/></div></div></div></div><div id="39896455" class="c"><input type="checkbox" id="c-39896455" checked=""/><div class="controls bullet"><span class="by">herpderperator</span><span>|</span><a href="#39901869">prev</a><span>|</span><a href="#39902972">next</a><span>|</span><label class="collapse" for="c-39896455">[-]</label><label class="expand" for="c-39896455">[12 more]</label></div><br/><div class="children"><div class="content">&gt; Note: successful exploitation does not generate any log entries.<p>Does this mean, had this exploit gone unnoticed, the attacker could have executed arbitrary commands as root without even a single sshd log entry on the compromised host regarding the &#x27;connection&#x27;?</div><br/><div id="39896527" class="c"><input type="checkbox" id="c-39896527" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#39896455">parent</a><span>|</span><a href="#39896592">next</a><span>|</span><label class="collapse" for="c-39896527">[-]</label><label class="expand" for="c-39896527">[3 more]</label></div><br/><div class="children"><div class="content">Yes.. The RCE happens at the connection stage before anything is logged.</div><br/><div id="39897465" class="c"><input type="checkbox" id="c-39897465" checked=""/><div class="controls bullet"><span class="by">udev4096</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39896527">parent</a><span>|</span><a href="#39896592">next</a><span>|</span><label class="collapse" for="c-39897465">[-]</label><label class="expand" for="c-39897465">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s insane. How exactly does this happen? Are there no EDR&#x2F;IDS who can detect an RCE at the connection stage?</div><br/><div id="39898966" class="c"><input type="checkbox" id="c-39898966" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39897465">parent</a><span>|</span><a href="#39896592">next</a><span>|</span><label class="collapse" for="c-39898966">[-]</label><label class="expand" for="c-39898966">[1 more]</label></div><br/><div class="children"><div class="content">An IDS may detect something depending on what it is looking for. The grandparent is saying that sshd doesn&#x27;t log anything. Which is not that surprising since sshd is atracker controlled.</div><br/></div></div></div></div></div></div><div id="39896592" class="c"><input type="checkbox" id="c-39896592" checked=""/><div class="controls bullet"><span class="by">gitfan86</span><span>|</span><a href="#39896455">parent</a><span>|</span><a href="#39896527">prev</a><span>|</span><a href="#39902972">next</a><span>|</span><label class="collapse" for="c-39896592">[-]</label><label class="expand" for="c-39896592">[8 more]</label></div><br/><div class="children"><div class="content">Yeah, but then you would have ssh traffic without a matching login.<p>Wonder if any anomaly detection would work on that</div><br/><div id="39901328" class="c"><input type="checkbox" id="c-39901328" checked=""/><div class="controls bullet"><span class="by">skykooler</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39896592">parent</a><span>|</span><a href="#39897476">next</a><span>|</span><label class="collapse" for="c-39901328">[-]</label><label class="expand" for="c-39901328">[1 more]</label></div><br/><div class="children"><div class="content">That would look the same as a random failed ssh login, which happens all the time. The connection isn&#x27;t maintained past that point (unless the payload chooses to do so).</div><br/></div></div><div id="39897476" class="c"><input type="checkbox" id="c-39897476" checked=""/><div class="controls bullet"><span class="by">FergusArgyll</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39896592">parent</a><span>|</span><a href="#39901328">prev</a><span>|</span><a href="#39902972">next</a><span>|</span><label class="collapse" for="c-39897476">[-]</label><label class="expand" for="c-39897476">[6 more]</label></div><br/><div class="children"><div class="content">Interesting... Though you can edit whatever log file you want</div><br/><div id="39898875" class="c"><input type="checkbox" id="c-39898875" checked=""/><div class="controls bullet"><span class="by">jmb99</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39897476">parent</a><span>|</span><a href="#39902972">next</a><span>|</span><label class="collapse" for="c-39898875">[-]</label><label class="expand" for="c-39898875">[5 more]</label></div><br/><div class="children"><div class="content">Any log that root on that box has write access to. It’s theoretically possible to have an anomaly detection service running on a vulnerable machine dumping all of its’ data to an append-only service on some other non-compromised box. In that case, (in this ideal world) the attacker would not be able to disable the detection service before it had logged the anomalous traffic, and wouldn’t be able to purge those logs since they were on another machine.<p>I’m not aware of any services that a) work like this, or b) would be able to detect this class of attack earlier than last week. If someone does though, please share.</div><br/><div id="39899811" class="c"><input type="checkbox" id="c-39899811" checked=""/><div class="controls bullet"><span class="by">fubar9463</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39898875">parent</a><span>|</span><a href="#39902139">prev</a><span>|</span><a href="#39900335">next</a><span>|</span><label class="collapse" for="c-39899811">[-]</label><label class="expand" for="c-39899811">[2 more]</label></div><br/><div class="children"><div class="content">You would be sending logs to a log collector (a SIEM) in security terms, and then you could join your firewall logs against your SSH auth logs.<p>This kind of anomaly detection is possible. Not sure how common it is. I doubt it is common.</div><br/><div id="39900334" class="c"><input type="checkbox" id="c-39900334" checked=""/><div class="controls bullet"><span class="by">fubar9463</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39899811">parent</a><span>|</span><a href="#39900335">next</a><span>|</span><label class="collapse" for="c-39900334">[-]</label><label class="expand" for="c-39900334">[1 more]</label></div><br/><div class="children"><div class="content">In any case the ROI for correlating SSH logs against network traffic is potentially error prone and may be more noisy than useful (can you differentiate in logs between SSH logins from a private IP and a public one?).<p>An EDR tool would be much better to look for an attacker’s <i>next</i> steps. But if you’re trying to catch a nation state they probably already have a plan for hiding their tracks.</div><br/></div></div></div></div><div id="39900335" class="c"><input type="checkbox" id="c-39900335" checked=""/><div class="controls bullet"><span class="by">juitpykyk</span><span>|</span><a href="#39896455">root</a><span>|</span><a href="#39898875">parent</a><span>|</span><a href="#39899811">prev</a><span>|</span><a href="#39902972">next</a><span>|</span><label class="collapse" for="c-39900335">[-]</label><label class="expand" for="c-39900335">[1 more]</label></div><br/><div class="children"><div class="content">You can do it on a single machine if you use the TPM to create log hashes which can&#x27;t be rolled back.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39902972" class="c"><input type="checkbox" id="c-39902972" checked=""/><div class="controls bullet"><span class="by">EasyMark</span><span>|</span><a href="#39896455">prev</a><span>|</span><a href="#39896664">next</a><span>|</span><label class="collapse" for="c-39902972">[-]</label><label class="expand" for="c-39902972">[3 more]</label></div><br/><div class="children"><div class="content">This whole thing makes me wonder if AI could detect &quot;anomalies&quot; like the human who found the actual hack did. Observe a system (lots of systems) and use that data to spot anomylous behavior from &quot;new&quot; versions of packages being added, throw up a red flag that is like &quot;this really doesn&#x27;t act like it did in the past because parameter(s) are unusual given previous versions&quot;</div><br/><div id="39903026" class="c"><input type="checkbox" id="c-39903026" checked=""/><div class="controls bullet"><span class="by">pixelfarmer</span><span>|</span><a href="#39902972">parent</a><span>|</span><a href="#39903112">next</a><span>|</span><label class="collapse" for="c-39903026">[-]</label><label class="expand" for="c-39903026">[1 more]</label></div><br/><div class="children"><div class="content">Just needs a fine grained enough set of parameters that are observed on a system, aka &quot;monitoring&quot;, and flag anything that sticks out. No need for &quot;AI&quot; unless the parameters that are monitored have more of a (complex) pattern to them than some value +&#x2F;- deviation or similar things. &quot;AI&quot; is, in an abstract way, a pattern matcher and replacer, but also a big cannon that is often not needed and simpler heuristics work faster and better (and are usually deterministic).</div><br/></div></div><div id="39903112" class="c"><input type="checkbox" id="c-39903112" checked=""/><div class="controls bullet"><span class="by">lpapez</span><span>|</span><a href="#39902972">parent</a><span>|</span><a href="#39903026">prev</a><span>|</span><a href="#39896664">next</a><span>|</span><label class="collapse" for="c-39903112">[-]</label><label class="expand" for="c-39903112">[1 more]</label></div><br/><div class="children"><div class="content">Anomaly, fraud, outlier detection...<p>AI has been trying to solve that for several decades and in my experience in production these systems usually end up being a set of expert written rules saying &quot;if X is greater than Y, notify someone to check&quot;.</div><br/></div></div></div></div><div id="39896664" class="c"><input type="checkbox" id="c-39896664" checked=""/><div class="controls bullet"><span class="by">gghffguhvc</span><span>|</span><a href="#39902972">prev</a><span>|</span><a href="#39902183">next</a><span>|</span><label class="collapse" for="c-39896664">[-]</label><label class="expand" for="c-39896664">[28 more]</label></div><br/><div class="children"><div class="content">Is there anything actually illegal here? Like is it a plausible “business” model for talented and morally compromised developers to do this and then sell the private key to state actors without actually breaking in themselves or allowing anyone else to break in.<p>Edit: MIT license provides a pretty broad disclaimer to say it isn’t fit for any purpose implied or otherwise.</div><br/><div id="39899057" class="c"><input type="checkbox" id="c-39899057" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39896926">next</a><span>|</span><label class="collapse" for="c-39899057">[-]</label><label class="expand" for="c-39899057">[2 more]</label></div><br/><div class="children"><div class="content">There are things you can&#x27;t contractually wave away, especially in form contracts that the other side has no ability to negotiate (which is what software licenses amount to).<p>One of those things is going to be fraud: if the maintainer is intentionally installing backdoors into their software and not telling the user, there&#x27;s going to be some fraud-like statute that they&#x27;ll be liable for.</div><br/><div id="39899942" class="c"><input type="checkbox" id="c-39899942" checked=""/><div class="controls bullet"><span class="by">dannyw</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899057">parent</a><span>|</span><a href="#39896926">next</a><span>|</span><label class="collapse" for="c-39899942">[-]</label><label class="expand" for="c-39899942">[1 more]</label></div><br/><div class="children"><div class="content">That said, if you’re doing this for your jurisdiction’s security agency, you’ll certainly be protected.</div><br/></div></div></div></div><div id="39896926" class="c"><input type="checkbox" id="c-39896926" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39899057">prev</a><span>|</span><a href="#39899963">next</a><span>|</span><label class="collapse" for="c-39896926">[-]</label><label class="expand" for="c-39896926">[14 more]</label></div><br/><div class="children"><div class="content">Yes. This would surely be prosecutable under the CFAA.<p>Honestly, if I were involved in this, I&#x27;d <i>hope</i> that it was, say, the FBI that caught me. I think that&#x27;d be the best chance of staying out of the Guantanamo Bay Hilton, laws be damned.</div><br/><div id="39899149" class="c"><input type="checkbox" id="c-39899149" checked=""/><div class="controls bullet"><span class="by">shp0ngle</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39896926">parent</a><span>|</span><a href="#39897267">next</a><span>|</span><label class="collapse" for="c-39899149">[-]</label><label class="expand" for="c-39899149">[4 more]</label></div><br/><div class="children"><div class="content">CIA didn&#x27;t put anyone new into gitmo for years.<p>The 30 remaining gitmo prisoners are all W Bush holdovers that all subsequent administrations forgot.</div><br/><div id="39899647" class="c"><input type="checkbox" id="c-39899647" checked=""/><div class="controls bullet"><span class="by">aftbit</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899149">parent</a><span>|</span><a href="#39899343">next</a><span>|</span><label class="collapse" for="c-39899647">[-]</label><label class="expand" for="c-39899647">[1 more]</label></div><br/><div class="children"><div class="content">Sure but that&#x27;s because the world knows about Gitmo now. What about the other quieter black sites?</div><br/></div></div><div id="39899343" class="c"><input type="checkbox" id="c-39899343" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899149">parent</a><span>|</span><a href="#39899647">prev</a><span>|</span><a href="#39897267">next</a><span>|</span><label class="collapse" for="c-39899343">[-]</label><label class="expand" for="c-39899343">[2 more]</label></div><br/><div class="children"><div class="content">Conspiracy theorist: <i>That&#x27;s what they want you to believe.</i><p>And in fairness, the whole nature of their secrecy means there&#x27;s no way to know for sure. It might be just a boogeyman kept around as a useful tool for scaring people into not breaking national security-level laws. I mean, it&#x27;s not as though I want to go around hacking the planet, but the idea of ending up at a CIA &quot;black site&quot;, assuming such things even exist, would be enough to keep me from trying it.</div><br/></div></div></div></div><div id="39897267" class="c"><input type="checkbox" id="c-39897267" checked=""/><div class="controls bullet"><span class="by">gghffguhvc</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39896926">parent</a><span>|</span><a href="#39899149">prev</a><span>|</span><a href="#39899963">next</a><span>|</span><label class="collapse" for="c-39897267">[-]</label><label class="expand" for="c-39897267">[9 more]</label></div><br/><div class="children"><div class="content">Even with the MIT disclaimer and the author not being the distributor or have any relationship with the distributor. Publishing vulnerable open source software to GitHub with a disclaimer that says it isn’t fit for any purpose seems like a bit of an oversight of using MIT license in distros to me.</div><br/><div id="39899028" class="c"><input type="checkbox" id="c-39899028" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39897267">parent</a><span>|</span><a href="#39897440">next</a><span>|</span><label class="collapse" for="c-39899028">[-]</label><label class="expand" for="c-39899028">[6 more]</label></div><br/><div class="children"><div class="content">That is not how disclaimers work. You cannot disclaim liability for intentionally harming someone.<p>You also cannot avoid criminal charges for a crime simply by shouting &quot;don&#x27;t blame me&quot;</div><br/><div id="39902947" class="c"><input type="checkbox" id="c-39902947" checked=""/><div class="controls bullet"><span class="by">gghffguhvc</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899028">parent</a><span>|</span><a href="#39899570">next</a><span>|</span><label class="collapse" for="c-39902947">[-]</label><label class="expand" for="c-39902947">[1 more]</label></div><br/><div class="children"><div class="content">I did setup the question in a way that the developer doesn’t harm someone themselves but sells it to a state actor. I.e extremely similar outcome to finding a zero day and selling it to a state actor except it is “more” secure - need private key.<p>The point about MIT is that they are saying to the world when publishing “as is” folks. Not claiming I haven’t backdoored it for Uncle Sam.in fact I’m not claiming anything, use at your own risk.<p>It used to be the law to implicitly do this by weak encryption for exports.</div><br/></div></div><div id="39899570" class="c"><input type="checkbox" id="c-39899570" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899028">parent</a><span>|</span><a href="#39902947">prev</a><span>|</span><a href="#39902561">next</a><span>|</span><label class="collapse" for="c-39899570">[-]</label><label class="expand" for="c-39899570">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly right. Imagine a license that said &quot;...and I can come to your house and kill you if I want to.&quot; Even if someone signed it in ink and mailed a copy back, the licensor still can&#x27;t go to their house and kill them even though the agreement says they can.<p>I can imagine the case of maybe a &quot;King of the Hill&quot;-type game played on bare hardware, where you&#x27;re actively trying to hack into and destroy other players&#x27; systems. Such a thing might have a license saying &quot;you agree we may wipe your drive after downloading all your data&quot;, and that <i>might</i> be acceptable in that specific situation. You knew you were signing up for a risking endeavor that might harm your system. If&#x2F;when it happens, you&#x27;d have a hard time complaining about it doing the thing it advertised that it would do.<p><i>Maybe.</i> Get a jury involved and who knows?<p>But somewhere between those 2 examples is the xz case. There&#x27;s no way a user of xz could think that it was designed to hack their system, and no amount of licensing can just wave that away.<p>For a real world analogy, if you go skydiving, and you sign an injury against waiver, and you get hurt out of pure dumb luck and not negligence, good luck suing anyone for that. You jumped out of a plane. What did you think might happen? But if you walk into a McDonald&#x27;s and fall through the floor into a basement and break your leg, no number of &quot;not responsible for accidents&quot; signs on the walls would keep them from being liable.</div><br/><div id="39899836" class="c"><input type="checkbox" id="c-39899836" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899570">parent</a><span>|</span><a href="#39902561">next</a><span>|</span><label class="collapse" for="c-39899836">[-]</label><label class="expand" for="c-39899836">[2 more]</label></div><br/><div class="children"><div class="content">&gt; For a real world analogy, if you go skydiving, and you sign an injury against waiver, and you get hurt out of pure dumb luck and not negligence, good luck suing anyone for that. You jumped out of a plane. What did you think might happen? But if you walk into a McDonald&#x27;s and fall through the floor into a basement and break your leg, no number of &quot;not responsible for accidents&quot; signs on the walls would keep them from being liable.<p>Even this is a bad example, since it is just gross negligence and not intentional. A better analogy would be if mcdonalds shoots you.</div><br/><div id="39900118" class="c"><input type="checkbox" id="c-39900118" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899836">parent</a><span>|</span><a href="#39902561">next</a><span>|</span><label class="collapse" for="c-39900118">[-]</label><label class="expand" for="c-39900118">[1 more]</label></div><br/><div class="children"><div class="content">I use to go to the In-N-Out in Oakland that just closed. That was a possibility, believe me.</div><br/></div></div></div></div></div></div><div id="39902561" class="c"><input type="checkbox" id="c-39902561" checked=""/><div class="controls bullet"><span class="by">seattle_spring</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899028">parent</a><span>|</span><a href="#39899570">prev</a><span>|</span><a href="#39897440">next</a><span>|</span><label class="collapse" for="c-39902561">[-]</label><label class="expand" for="c-39902561">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a great South Park episode about this, titled &quot;Human CentiPad.&quot; Not for the squeamish.</div><br/></div></div></div></div><div id="39897440" class="c"><input type="checkbox" id="c-39897440" checked=""/><div class="controls bullet"><span class="by">gghffguhvc</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39897267">parent</a><span>|</span><a href="#39899028">prev</a><span>|</span><a href="#39898651">next</a><span>|</span><label class="collapse" for="c-39897440">[-]</label><label class="expand" for="c-39897440">[1 more]</label></div><br/><div class="children"><div class="content">THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div><br/></div></div><div id="39898651" class="c"><input type="checkbox" id="c-39898651" checked=""/><div class="controls bullet"><span class="by">gowld</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39897267">parent</a><span>|</span><a href="#39897440">prev</a><span>|</span><a href="#39899963">next</a><span>|</span><label class="collapse" for="c-39898651">[-]</label><label class="expand" for="c-39898651">[1 more]</label></div><br/><div class="children"><div class="content">A software license has never been a protection against malicious criminal activity.  They&#x27;d have to prove that the &quot;feature&quot; had a legitimate non-nefarious purpose, or was accidental, neither of which apply here.</div><br/></div></div></div></div></div></div><div id="39899963" class="c"><input type="checkbox" id="c-39899963" checked=""/><div class="controls bullet"><span class="by">pama</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39896926">prev</a><span>|</span><a href="#39897050">next</a><span>|</span><label class="collapse" for="c-39899963">[-]</label><label class="expand" for="c-39899963">[3 more]</label></div><br/><div class="children"><div class="content">You are talking about the greatest exposed hack of the computer supply chain so far by a big margin.  Laws can be made retroactively for this type of thing. It has implications that are beyond the legal system, as the threat level is way beyond what is typically required as a sniff test for justifying military actions.  This was not an RCE based on identifying negligent code; this was a carefully designed trap that could reverse the power dynamics during military conflict.</div><br/><div id="39900020" class="c"><input type="checkbox" id="c-39900020" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39899963">parent</a><span>|</span><a href="#39897050">next</a><span>|</span><label class="collapse" for="c-39900020">[-]</label><label class="expand" for="c-39900020">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Laws can be made retroactively<p>Not in the United States.  <a href="https:&#x2F;&#x2F;constitution.congress.gov&#x2F;browse&#x2F;article-1&#x2F;section-9&#x2F;clause-3&#x2F;" rel="nofollow">https:&#x2F;&#x2F;constitution.congress.gov&#x2F;browse&#x2F;article-1&#x2F;section-9...</a></div><br/><div id="39900731" class="c"><input type="checkbox" id="c-39900731" checked=""/><div class="controls bullet"><span class="by">KeplerBoy</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39900020">parent</a><span>|</span><a href="#39897050">next</a><span>|</span><label class="collapse" for="c-39900731">[-]</label><label class="expand" for="c-39900731">[1 more]</label></div><br/><div class="children"><div class="content">Meh, these are potentially the kind of crimes where laws don&#x27;t apply.</div><br/></div></div></div></div></div></div><div id="39897050" class="c"><input type="checkbox" id="c-39897050" checked=""/><div class="controls bullet"><span class="by">alfanick</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39899963">prev</a><span>|</span><a href="#39903090">next</a><span>|</span><label class="collapse" for="c-39897050">[-]</label><label class="expand" for="c-39897050">[1 more]</label></div><br/><div class="children"><div class="content">Legality things, depends on jurisdiction, which may or may not depend on:<p>* where were the authors of the code,
* where the code is stored,
* who is attacked,
* where are their servers,
* who is attacking,
* where are they based,
* where did they attack from,
* ...<p>IANAL but it seems very complicated from law perspective (we, humanity, don&#x27;t have a global law)<p>Edit2: making a bullet point list is hard</div><br/></div></div><div id="39903090" class="c"><input type="checkbox" id="c-39903090" checked=""/><div class="controls bullet"><span class="by">vikramkr</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39897050">prev</a><span>|</span><a href="#39902244">next</a><span>|</span><label class="collapse" for="c-39903090">[-]</label><label class="expand" for="c-39903090">[1 more]</label></div><br/><div class="children"><div class="content">As a sanity check, attempted crime is still crime, so not a lawyer but part B isn&#x27;t exactly ambiguous here: <a href="https:&#x2F;&#x2F;www.law.cornell.edu&#x2F;uscode&#x2F;text&#x2F;18&#x2F;1030" rel="nofollow">https:&#x2F;&#x2F;www.law.cornell.edu&#x2F;uscode&#x2F;text&#x2F;18&#x2F;1030</a><p>In terms of a plausible business model - I mean that&#x27;s conspiracy to commit crime, like of course that&#x27;s illegal? And depending on the state actor and the target system - literally treason if it&#x27;s a cyber attack as a part of a war? You can put whatever you want into a license or contract but obviously that doesn&#x27;t let you override the actual law</div><br/></div></div><div id="39902244" class="c"><input type="checkbox" id="c-39902244" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39903090">prev</a><span>|</span><a href="#39901602">next</a><span>|</span><label class="collapse" for="c-39902244">[-]</label><label class="expand" for="c-39902244">[1 more]</label></div><br/><div class="children"><div class="content">I’m no lawyer, but it is at minimum tortuous interference.</div><br/></div></div><div id="39901602" class="c"><input type="checkbox" id="c-39901602" checked=""/><div class="controls bullet"><span class="by">vikramkr</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39902244">prev</a><span>|</span><a href="#39899264">next</a><span>|</span><label class="collapse" for="c-39901602">[-]</label><label class="expand" for="c-39901602">[4 more]</label></div><br/><div class="children"><div class="content">Is there some weird loophole or something I&#x27;m missing here? Otherwise, I&#x27;m not exactly sure how hacking <i>wouldn&#x27;t</i> be illegal.</div><br/><div id="39901683" class="c"><input type="checkbox" id="c-39901683" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39901602">parent</a><span>|</span><a href="#39899264">next</a><span>|</span><label class="collapse" for="c-39901683">[-]</label><label class="expand" for="c-39901683">[3 more]</label></div><br/><div class="children"><div class="content">Hacking statues cover unauthorized access, and there&#x27;s no evidence that unauthorized access has occurred, unless we see someone actually making use of the backdoor in the wild.  Accessing a system without authorization is a crime, but distributing code that contains a backdoor is not a crime.  The attacker was authorized to publish changes to xz.</div><br/><div id="39903059" class="c"><input type="checkbox" id="c-39903059" checked=""/><div class="controls bullet"><span class="by">vikramkr</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39901683">parent</a><span>|</span><a href="#39899264">next</a><span>|</span><label class="collapse" for="c-39903059">[-]</label><label class="expand" for="c-39903059">[2 more]</label></div><br/><div class="children"><div class="content">Do you have a source for the claim that this isn&#x27;t a crime because it didn&#x27;t succeed? As a sanity check, checking the plain text of the CFAA, it covers attempted hacking as you&#x27;d expect. So distributing a system with a backdoor, introducing a backdoor, etc all seem quite comfortably covered by existing statues. Which makes sense since like, I don&#x27;t want to say &#x27;duh&#x27; because I think that probably wouldn&#x27;t meet HN guidelines for discourse but I&#x27;m not sure what else to say. Even American politicians, as notoriously incompetent as our leaders can be sometimes, wouldn&#x27;t miss a crime <i>that</i> obvious. <a href="https:&#x2F;&#x2F;www.law.cornell.edu&#x2F;uscode&#x2F;text&#x2F;18&#x2F;1030" rel="nofollow">https:&#x2F;&#x2F;www.law.cornell.edu&#x2F;uscode&#x2F;text&#x2F;18&#x2F;1030</a></div><br/><div id="39903361" class="c"><input type="checkbox" id="c-39903361" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39896664">root</a><span>|</span><a href="#39903059">parent</a><span>|</span><a href="#39899264">next</a><span>|</span><label class="collapse" for="c-39903361">[-]</label><label class="expand" for="c-39903361">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not claiming the attempt didn&#x27;t succeed.  I&#x27;m claiming that the attempt didn&#x27;t occur, and that distributing the backdoor more widely would only have created the preconditions for an attempt.  We don&#x27;t know who the intended target was, or what the intended payload was.<p>Yes, subsection (b) of the CFAA covers attempts at acts described in subsection (a) of the CFAA.  Which specific act under subsection (a) do you claim has been attempted?</div><br/></div></div></div></div></div></div></div></div><div id="39899264" class="c"><input type="checkbox" id="c-39899264" checked=""/><div class="controls bullet"><span class="by">greyface-</span><span>|</span><a href="#39896664">parent</a><span>|</span><a href="#39901602">prev</a><span>|</span><a href="#39902183">next</a><span>|</span><label class="collapse" for="c-39899264">[-]</label><label class="expand" for="c-39899264">[1 more]</label></div><br/><div class="children"><div class="content">I brought this up in an earlier thread and got heavily downvoted.  <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39878227">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39878227</a></div><br/></div></div></div></div><div id="39902183" class="c"><input type="checkbox" id="c-39902183" checked=""/><div class="controls bullet"><span class="by">cgh</span><span>|</span><a href="#39896664">prev</a><span>|</span><a href="#39897091">next</a><span>|</span><label class="collapse" for="c-39902183">[-]</label><label class="expand" for="c-39902183">[5 more]</label></div><br/><div class="children"><div class="content">Comment I saw on Ars:<p>&gt;Interestingly enough, &quot;Jia Tan&quot; is very close to 加蛋 in Mandarin, meaning &quot;to add an egg&quot;. Unlikely to be a real name or a coincidence.</div><br/><div id="39902478" class="c"><input type="checkbox" id="c-39902478" checked=""/><div class="controls bullet"><span class="by">picture</span><span>|</span><a href="#39902183">parent</a><span>|</span><a href="#39902767">next</a><span>|</span><label class="collapse" for="c-39902478">[-]</label><label class="expand" for="c-39902478">[3 more]</label></div><br/><div class="children"><div class="content">Jia Tan could mean literally anything as pinyin since it doesn&#x27;t have diacritics for tone. 嘉坛 (Jiā tán) could be a totally plausible name, and so could 佳檀 (also Jiā tán). Chinese names can largely use any character that doesn&#x27;t come with a really bad meaning</div><br/><div id="39902740" class="c"><input type="checkbox" id="c-39902740" checked=""/><div class="controls bullet"><span class="by">AnotherGoodName</span><span>|</span><a href="#39902183">root</a><span>|</span><a href="#39902478">parent</a><span>|</span><a href="#39902767">next</a><span>|</span><label class="collapse" for="c-39902740">[-]</label><label class="expand" for="c-39902740">[2 more]</label></div><br/><div class="children"><div class="content">Yeah a quick Google brings up lots of real Jia Tans who clearly aren&#x27;t behind this and hopefully aren&#x27;t being wrongly accused here. But it is clearly a real and common name.</div><br/><div id="39902771" class="c"><input type="checkbox" id="c-39902771" checked=""/><div class="controls bullet"><span class="by">shp0ngle</span><span>|</span><a href="#39902183">root</a><span>|</span><a href="#39902740">parent</a><span>|</span><a href="#39902767">next</a><span>|</span><label class="collapse" for="c-39902771">[-]</label><label class="expand" for="c-39902771">[1 more]</label></div><br/><div class="children"><div class="content">As other poster said, Chinese has diacritics that got usually removed when put into English websites</div><br/></div></div></div></div></div></div><div id="39902767" class="c"><input type="checkbox" id="c-39902767" checked=""/><div class="controls bullet"><span class="by">shp0ngle</span><span>|</span><a href="#39902183">parent</a><span>|</span><a href="#39902478">prev</a><span>|</span><a href="#39897091">next</a><span>|</span><label class="collapse" for="c-39902767">[-]</label><label class="expand" for="c-39902767">[1 more]</label></div><br/><div class="children"><div class="content">There are many real Jia Tans on LinkedIn</div><br/></div></div></div></div><div id="39897091" class="c"><input type="checkbox" id="c-39897091" checked=""/><div class="controls bullet"><span class="by">declan_roberts</span><span>|</span><a href="#39902183">prev</a><span>|</span><a href="#39897883">next</a><span>|</span><label class="collapse" for="c-39897091">[-]</label><label class="expand" for="c-39897091">[31 more]</label></div><br/><div class="children"><div class="content">One thing I notice about state-level espionage and backdoors. The USA seems to have an affinity for hardware interdiction as opposed to software backdoors. Hardware backdoors make sense since much of it passes through the USA.<p>Other countries such as Israel are playing the long-con with very well engineered, multi-year software backdoors. A much harder game to play.</div><br/><div id="39900477" class="c"><input type="checkbox" id="c-39900477" checked=""/><div class="controls bullet"><span class="by">croemer</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39898851">next</a><span>|</span><label class="collapse" for="c-39900477">[-]</label><label class="expand" for="c-39900477">[5 more]</label></div><br/><div class="children"><div class="content">Jia Tan&#x27;s GitHub activity was mostly 10-18@UTC, consistent with Europe&#x2F;Israel&#x2F;Russia</div><br/><div id="39901005" class="c"><input type="checkbox" id="c-39901005" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39900477">parent</a><span>|</span><a href="#39901124">next</a><span>|</span><label class="collapse" for="c-39901005">[-]</label><label class="expand" for="c-39901005">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s rather trivial to fake git commits.<p>Basing this stuff on email times (especially replies to emails sent that same day) would be more relevant. However. if this operation was pulled off with the precision and opsec that it seems to have been, I wouldn&#x27;t be too surprised if whatever group is behind this attack would&#x27;ve sent over + funded a developer somewhere in a time zone of their choice.<p>No doubt any nation state is able to station someone in Russia&#x2F;Israel&#x2F;one of the n-eyes countries.<p>I doubt OSINT will figure out who is really behind this, but I&#x27;m sure governments will, soon enough. Whether or not they report the truth of their findings, and if one should trust the official reporting, is yet another tough question.</div><br/><div id="39902308" class="c"><input type="checkbox" id="c-39902308" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39901005">parent</a><span>|</span><a href="#39901124">next</a><span>|</span><label class="collapse" for="c-39902308">[-]</label><label class="expand" for="c-39902308">[1 more]</label></div><br/><div class="children"><div class="content">The git timestamps in the git commits probably were faked, but they implicate China. There were a handful of apparent slippups though, and if we take those timestamps to be correct then it looks like they were in eastern Europe (or possibly Finland, the Baltics, or the Mediterranean coast all the way down to Egypt). And if we instead assume that these timestamps are a second–level misdirection then there is a huge complexity penalty; my money is on the simpler answer (but not all my money; it’s not a sure bet).</div><br/></div></div></div></div><div id="39901124" class="c"><input type="checkbox" id="c-39901124" checked=""/><div class="controls bullet"><span class="by">Culonavirus</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39900477">parent</a><span>|</span><a href="#39901005">prev</a><span>|</span><a href="#39902498">next</a><span>|</span><label class="collapse" for="c-39901124">[-]</label><label class="expand" for="c-39901124">[1 more]</label></div><br/><div class="children"><div class="content">I like to think that the performance issue in the exploit was actually an exploit of an exploit, a counterintelligence act,  by some &quot;good samaritan&quot; :D</div><br/></div></div><div id="39902498" class="c"><input type="checkbox" id="c-39902498" checked=""/><div class="controls bullet"><span class="by">klabb3</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39900477">parent</a><span>|</span><a href="#39901124">prev</a><span>|</span><a href="#39898851">next</a><span>|</span><label class="collapse" for="c-39902498">[-]</label><label class="expand" for="c-39902498">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, i was wondering about this since day 0 and was too lazy to look it up. Yes it can be spoofed, but I imagine a good chunk of day-to-day is work is semi-interactive, which would make it preferable to have the attacker be in the same tz as the victims. Anyone know what tz Lasse was at? If not (eg he’s in the US), then I’d say Occam’s razor that the attacker is working those UTC 10-18 office hours without extra steps. Tz proves nothing and for a 3y low-intensity operation I’d just assume the attacker won’t introduce that much friction only to mislead. I’m sure there are much stronger signals in the investigation work that’s going on now. Unfortunately, given the hush-hush-by-default nature of our beloved intel agencies, we’ll probably never know.</div><br/></div></div></div></div><div id="39898851" class="c"><input type="checkbox" id="c-39898851" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39900477">prev</a><span>|</span><a href="#39897316">next</a><span>|</span><label class="collapse" for="c-39898851">[-]</label><label class="expand" for="c-39898851">[12 more]</label></div><br/><div class="children"><div class="content">&gt; Other countries such as Israel are playing the long-con with very well engineered, multi-year software backdoors<p>What is this in reference to?</div><br/><div id="39899253" class="c"><input type="checkbox" id="c-39899253" checked=""/><div class="controls bullet"><span class="by">Voultapher</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898851">parent</a><span>|</span><a href="#39899141">next</a><span>|</span><label class="collapse" for="c-39899253">[-]</label><label class="expand" for="c-39899253">[6 more]</label></div><br/><div class="children"><div class="content">NSO Group<p>They are an Israel based company, that sell zero-click RCEs for phones and more. Such malicious software was involved in the murder of journalist Jamal Khashoggi.<p>Their exploits, developed in-house as well as presumably partially bought on the black market, are some of the most sophisticated exploits found in the wild, e.g. <a href="https:&#x2F;&#x2F;googleprojectzero.blogspot.com&#x2F;2021&#x2F;12&#x2F;a-deep-dive-into-nso-zero-click.html" rel="nofollow">https:&#x2F;&#x2F;googleprojectzero.blogspot.com&#x2F;2021&#x2F;12&#x2F;a-deep-dive-i...</a><p>&gt; JBIG2 doesn&#x27;t have scripting capabilities, but when combined with a vulnerability, it does have the ability to emulate circuits of arbitrary logic gates operating on arbitrary memory. So why not just use that to build your own computer architecture and script that!? That&#x27;s exactly what this exploit does. Using over 70,000 segment commands defining logical bit operations, they define a small computer architecture with features such as registers and a full 64-bit adder and comparator which they use to search memory and perform arithmetic operations. It&#x27;s not as fast as Javascript, but it&#x27;s fundamentally computationally equivalent.</div><br/><div id="39899846" class="c"><input type="checkbox" id="c-39899846" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899253">parent</a><span>|</span><a href="#39899141">next</a><span>|</span><label class="collapse" for="c-39899846">[-]</label><label class="expand" for="c-39899846">[5 more]</label></div><br/><div class="children"><div class="content">&gt; that sell zero-click RCEs<p>Exactly my point. They do not sell backdoors.<p>Don&#x27;t get me wrong, still icky, but definitely not a &quot;very well engineered, multi-year software backdoors&quot;</div><br/><div id="39902315" class="c"><input type="checkbox" id="c-39902315" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899846">parent</a><span>|</span><a href="#39899886">next</a><span>|</span><label class="collapse" for="c-39902315">[-]</label><label class="expand" for="c-39902315">[2 more]</label></div><br/><div class="children"><div class="content">I’m not sure why you’re making that point; the exploit we are talking about _is_ an RCE.</div><br/><div id="39902431" class="c"><input type="checkbox" id="c-39902431" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39902315">parent</a><span>|</span><a href="#39899886">next</a><span>|</span><label class="collapse" for="c-39902431">[-]</label><label class="expand" for="c-39902431">[1 more]</label></div><br/><div class="children"><div class="content">The person i was replying to claimed that countries like usa rely on hardware modification while countries like israel rely on back-doors. This does not seem to be the case. Israel doesn&#x27;t (or at least hasn&#x27;t been caught) making backdoors, while the usa actually has (e.g. Dual_EG).<p>RCE is a broad category and includes many things. That said, while technically the liblzma thing is an RCE, supply chain attacks aren&#x27;t really what most people mean when they talk about an RCE vulnerability.</div><br/></div></div></div></div><div id="39899886" class="c"><input type="checkbox" id="c-39899886" checked=""/><div class="controls bullet"><span class="by">xvector</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899846">parent</a><span>|</span><a href="#39902315">prev</a><span>|</span><a href="#39899141">next</a><span>|</span><label class="collapse" for="c-39899886">[-]</label><label class="expand" for="c-39899886">[2 more]</label></div><br/><div class="children"><div class="content">They implant backdoors and sell zero-click RCEs that exploit those backdoors.</div><br/><div id="39901166" class="c"><input type="checkbox" id="c-39901166" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899886">parent</a><span>|</span><a href="#39899141">next</a><span>|</span><label class="collapse" for="c-39901166">[-]</label><label class="expand" for="c-39901166">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a pretty strong claim. Do you have any evidence they have done this?<p>And i mean, i&#x27;m genuinely curious. I don&#x27;t think they would be above doing so if they had the opportunity, i just haven&#x27;t heard of any instances where they were caught doing so.</div><br/></div></div></div></div></div></div></div></div><div id="39899141" class="c"><input type="checkbox" id="c-39899141" checked=""/><div class="controls bullet"><span class="by">hammock</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898851">parent</a><span>|</span><a href="#39899253">prev</a><span>|</span><a href="#39899135">next</a><span>|</span><label class="collapse" for="c-39899141">[-]</label><label class="expand" for="c-39899141">[1 more]</label></div><br/><div class="children"><div class="content">Bob Maxwell (Ghislaine&#x27;s father) sold backdoored software to corporations and governments all around the world, including US targets, on behalf of Israel&#x27;s Mossad.<p>&quot;The Maxwell-Mossad team steals spy software PROMIS from the United States, Mossad puts an undetectable trap door in it so Mossad can track the activities of anyone using it, then Maxwell sells it around the world (including back to the U.S. -- with the trap door).&quot;<p><a href="https:&#x2F;&#x2F;kclibrary.bibliocommons.com&#x2F;v2&#x2F;record&#x2F;S120C257904" rel="nofollow">https:&#x2F;&#x2F;kclibrary.bibliocommons.com&#x2F;v2&#x2F;record&#x2F;S120C257904</a></div><br/></div></div><div id="39899118" class="c"><input type="checkbox" id="c-39899118" checked=""/><div class="controls bullet"><span class="by">ginko</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898851">parent</a><span>|</span><a href="#39899135">prev</a><span>|</span><a href="#39899112">next</a><span>|</span><label class="collapse" for="c-39899118">[-]</label><label class="expand" for="c-39899118">[2 more]</label></div><br/><div class="children"><div class="content">Probably Stuxnet.</div><br/><div id="39899851" class="c"><input type="checkbox" id="c-39899851" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899118">parent</a><span>|</span><a href="#39899112">next</a><span>|</span><label class="collapse" for="c-39899851">[-]</label><label class="expand" for="c-39899851">[1 more]</label></div><br/><div class="children"><div class="content">Stuxnet was not a backdoor.</div><br/></div></div></div></div><div id="39899112" class="c"><input type="checkbox" id="c-39899112" checked=""/><div class="controls bullet"><span class="by">markus92</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898851">parent</a><span>|</span><a href="#39899118">prev</a><span>|</span><a href="#39897316">next</a><span>|</span><label class="collapse" for="c-39899112">[-]</label><label class="expand" for="c-39899112">[1 more]</label></div><br/><div class="children"><div class="content">Stuxnet?</div><br/></div></div></div></div><div id="39897316" class="c"><input type="checkbox" id="c-39897316" checked=""/><div class="controls bullet"><span class="by">wolverine876</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39898851">prev</a><span>|</span><a href="#39899336">next</a><span>|</span><label class="collapse" for="c-39897316">[-]</label><label class="expand" for="c-39897316">[5 more]</label></div><br/><div class="children"><div class="content">&gt; The USA seems to have an affinity for hardware interdiction as opposed to software backdoors.<p>What are some examples?</div><br/><div id="39897524" class="c"><input type="checkbox" id="c-39897524" checked=""/><div class="controls bullet"><span class="by">AlexCoventry</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39897316">parent</a><span>|</span><a href="#39897421">next</a><span>|</span><label class="collapse" for="c-39897524">[-]</label><label class="expand" for="c-39897524">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Tailored_Access_Operations" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Tailored_Access_Operations</a></div><br/><div id="39900357" class="c"><input type="checkbox" id="c-39900357" checked=""/><div class="controls bullet"><span class="by">acid__</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39897524">parent</a><span>|</span><a href="#39897421">next</a><span>|</span><label class="collapse" for="c-39900357">[-]</label><label class="expand" for="c-39900357">[2 more]</label></div><br/><div class="children"><div class="content">Be sure to check out the mentioned catalog. [1]<p>The NSA&#x27;s capabilities back in 2008 were pretty astonishing: &quot;RAGEMASTER&quot; A $30 device that taps a VGA cable and transmits the contents of your screen to the NSA van sitting outside! Crazy stuff. Makes you wonder what they&#x27;ve built in the last 15 years.<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ANT_catalog" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ANT_catalog</a></div><br/><div id="39902581" class="c"><input type="checkbox" id="c-39902581" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39900357">parent</a><span>|</span><a href="#39897421">next</a><span>|</span><label class="collapse" for="c-39902581">[-]</label><label class="expand" for="c-39902581">[1 more]</label></div><br/><div class="children"><div class="content">Today you’ve got open access USB cable which can stream your shit out on WiFi, no doubt the NSA has worse.</div><br/></div></div></div></div></div></div><div id="39897421" class="c"><input type="checkbox" id="c-39897421" checked=""/><div class="controls bullet"><span class="by">nick238</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39897316">parent</a><span>|</span><a href="#39897524">prev</a><span>|</span><a href="#39899336">next</a><span>|</span><label class="collapse" for="c-39897421">[-]</label><label class="expand" for="c-39897421">[1 more]</label></div><br/><div class="children"><div class="content">The Clipper chip? Not sure if that&#x27;s what they had in mind. Nowadays it&#x27;s maybe just how the NSA has rooms attached to backbone providers like <a href="https:&#x2F;&#x2F;theintercept.com&#x2F;2018&#x2F;06&#x2F;25&#x2F;att-internet-nsa-spy-hubs&#x2F;" rel="nofollow">https:&#x2F;&#x2F;theintercept.com&#x2F;2018&#x2F;06&#x2F;25&#x2F;att-internet-nsa-spy-hub...</a></div><br/></div></div></div></div><div id="39899336" class="c"><input type="checkbox" id="c-39899336" checked=""/><div class="controls bullet"><span class="by">greggsy</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39897316">prev</a><span>|</span><a href="#39898596">next</a><span>|</span><label class="collapse" for="c-39899336">[-]</label><label class="expand" for="c-39899336">[1 more]</label></div><br/><div class="children"><div class="content">I mean, they’re just the high profile ones. 
China makes and ships a lot of hardware, and the US makes and ships a lot of software.</div><br/></div></div><div id="39898596" class="c"><input type="checkbox" id="c-39898596" checked=""/><div class="controls bullet"><span class="by">gowld</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39899336">prev</a><span>|</span><a href="#39899403">next</a><span>|</span><label class="collapse" for="c-39898596">[-]</label><label class="expand" for="c-39898596">[5 more]</label></div><br/><div class="children"><div class="content">This goes back to WWII. USA solves problems with manufacturing and money. Europeans relatively lack both, so they solve problems with their brains.</div><br/><div id="39898756" class="c"><input type="checkbox" id="c-39898756" checked=""/><div class="controls bullet"><span class="by">hybridtupel</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898596">parent</a><span>|</span><a href="#39899403">next</a><span>|</span><label class="collapse" for="c-39898756">[-]</label><label class="expand" for="c-39898756">[4 more]</label></div><br/><div class="children"><div class="content">Israel is not in Europe</div><br/><div id="39899401" class="c"><input type="checkbox" id="c-39899401" checked=""/><div class="controls bullet"><span class="by">Alezz</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39898756">parent</a><span>|</span><a href="#39899403">next</a><span>|</span><label class="collapse" for="c-39899401">[-]</label><label class="expand" for="c-39899401">[3 more]</label></div><br/><div class="children"><div class="content">The perfect definition of Europe is if they took part in the Eurovision Song Contest.</div><br/><div id="39899625" class="c"><input type="checkbox" id="c-39899625" checked=""/><div class="controls bullet"><span class="by">nmat</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899401">parent</a><span>|</span><a href="#39899403">next</a><span>|</span><label class="collapse" for="c-39899625">[-]</label><label class="expand" for="c-39899625">[2 more]</label></div><br/><div class="children"><div class="content">Australia participates in the Eurovision Song Contest.</div><br/><div id="39900669" class="c"><input type="checkbox" id="c-39900669" checked=""/><div class="controls bullet"><span class="by">willsmith72</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899625">parent</a><span>|</span><a href="#39899403">next</a><span>|</span><label class="collapse" for="c-39900669">[-]</label><label class="expand" for="c-39900669">[1 more]</label></div><br/><div class="children"><div class="content">and now i get to identify as european in heated internet debates</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39899403" class="c"><input type="checkbox" id="c-39899403" checked=""/><div class="controls bullet"><span class="by">fpgaminer</span><span>|</span><a href="#39897091">parent</a><span>|</span><a href="#39898596">prev</a><span>|</span><a href="#39897883">next</a><span>|</span><label class="collapse" for="c-39899403">[-]</label><label class="expand" for="c-39899403">[2 more]</label></div><br/><div class="children"><div class="content">My completely unexpert opinion, informed by listening to all the episodes of Darknet Diaries, agrees with this.  US intelligence likes to just bully&#x2F;bribe&#x2F;blackmail the supply chain.  They&#x27;ve got crypto chops, but I don&#x27;t recall any terribly sophisticated implants like this one (except Stuxnet, which was likely Israel&#x27;s work funded&#x2F;assisted by the US).  NK isn&#x27;t terribly sophisticated, and their goal is money, so that doesn&#x27;t match either.  Russia is all over the place in terms of targets&#x2F;sophistication&#x2F;etc because of their laws (AFAIK it&#x27;s legal for any citizen to wage cyberwarfare on anything and everything except domestically), but this feels a bit beyond anything I recall them accomplishing at a state level.  Israeli organizations have a long history of highly sophisticated cyberwarfare (Stuxnet, NSO group, etc), and they&#x27;re good about protecting their access to exploits.  That seems to fit the best.  That said, saying &quot;Israeli organization&quot; casts a wide net since it&#x27;s such a boiling hotspot for cybersecurity professionals.  Could be the work of the government, could be co-sponsored by the US, or could just be a group of smart people building another NSO group.</div><br/><div id="39900034" class="c"><input type="checkbox" id="c-39900034" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39897091">root</a><span>|</span><a href="#39899403">parent</a><span>|</span><a href="#39897883">next</a><span>|</span><label class="collapse" for="c-39900034">[-]</label><label class="expand" for="c-39900034">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Russia is all over the place in terms of targets&#x2F;sophistication&#x2F;etc ... but this feels a bit beyond anything I recall them accomplishing at a state level.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Triton_(malware)" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Triton_(malware)</a> (<a href="https:&#x2F;&#x2F;www.justice.gov&#x2F;opa&#x2F;pr&#x2F;four-russian-government-employees-charged-two-historical-hacking-campaigns-targeting-critical" rel="nofollow">https:&#x2F;&#x2F;www.justice.gov&#x2F;opa&#x2F;pr&#x2F;four-russian-government-emplo...</a>)</div><br/></div></div></div></div></div></div><div id="39897883" class="c"><input type="checkbox" id="c-39897883" checked=""/><div class="controls bullet"><span class="by">aborsy</span><span>|</span><a href="#39897091">prev</a><span>|</span><a href="#39897372">next</a><span>|</span><label class="collapse" for="c-39897883">[-]</label><label class="expand" for="c-39897883">[4 more]</label></div><br/><div class="children"><div class="content">Why ED448?<p>It’s almost never recommended, in favor of curve 25519.</div><br/><div id="39898311" class="c"><input type="checkbox" id="c-39898311" checked=""/><div class="controls bullet"><span class="by">throitallaway</span><span>|</span><a href="#39897883">parent</a><span>|</span><a href="#39898280">next</a><span>|</span><label class="collapse" for="c-39898311">[-]</label><label class="expand" for="c-39898311">[2 more]</label></div><br/><div class="children"><div class="content">As I understand it Ed448 was only recently added to openssh, so maybe it was chosen in order to evade detection by analysis tools that scan for keys (if such a thing is possible.)</div><br/><div id="39900375" class="c"><input type="checkbox" id="c-39900375" checked=""/><div class="controls bullet"><span class="by">juitpykyk</span><span>|</span><a href="#39897883">root</a><span>|</span><a href="#39898311">parent</a><span>|</span><a href="#39898280">next</a><span>|</span><label class="collapse" for="c-39900375">[-]</label><label class="expand" for="c-39900375">[1 more]</label></div><br/><div class="children"><div class="content">Some tools scan for crypto algorithms, typically by searching for the magic numbers, Ed448 is so new many tools probably don&#x27;t recognize it.<p>Malware authors frequently change the crypto magic numbers to prevent detection.</div><br/></div></div></div></div><div id="39898280" class="c"><input type="checkbox" id="c-39898280" checked=""/><div class="controls bullet"><span class="by">stock_toaster</span><span>|</span><a href="#39897883">parent</a><span>|</span><a href="#39898311">prev</a><span>|</span><a href="#39897372">next</a><span>|</span><label class="collapse" for="c-39898280">[-]</label><label class="expand" for="c-39898280">[1 more]</label></div><br/><div class="children"><div class="content">I believe ed25519 offers 128 bits of security, while ed448 offers 224 bits of security. ed448 has larger key sizes too, which does seem like an odd choice in this case.
Maybe it was chosen for obscurity sake (being less commonly used)?</div><br/></div></div></div></div><div id="39897372" class="c"><input type="checkbox" id="c-39897372" checked=""/><div class="controls bullet"><span class="by">wolverine876</span><span>|</span><a href="#39897883">prev</a><span>|</span><a href="#39896168">next</a><span>|</span><label class="collapse" for="c-39897372">[-]</label><label class="expand" for="c-39897372">[8 more]</label></div><br/><div class="children"><div class="content">Have the heads of the targeted projects - including  xz (Lasse Collin?), OpenSSH (Theo?), and Linux (Linus) - commented on it?<p>I&#x27;m especially interested in how such exploits can be prevented in the future.</div><br/><div id="39898084" class="c"><input type="checkbox" id="c-39898084" checked=""/><div class="controls bullet"><span class="by">strunz</span><span>|</span><a href="#39897372">parent</a><span>|</span><a href="#39898617">next</a><span>|</span><label class="collapse" for="c-39898084">[-]</label><label class="expand" for="c-39898084">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;thesamesam&#x2F;223949d5a074ebc3dce9ee78baad9e27" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;thesamesam&#x2F;223949d5a074ebc3dce9ee78b...</a>:<p>&gt;Lasse regularly has internet breaks and is on one at the moment, started before this all kicked off. He has posted an update at <a href="https:&#x2F;&#x2F;tukaani.org&#x2F;xz-backdoor&#x2F;" rel="nofollow">https:&#x2F;&#x2F;tukaani.org&#x2F;xz-backdoor&#x2F;</a> and is working with the community.</div><br/></div></div><div id="39898617" class="c"><input type="checkbox" id="c-39898617" checked=""/><div class="controls bullet"><span class="by">gowld</span><span>|</span><a href="#39897372">parent</a><span>|</span><a href="#39898084">prev</a><span>|</span><a href="#39896168">next</a><span>|</span><label class="collapse" for="c-39898617">[-]</label><label class="expand" for="c-39898617">[6 more]</label></div><br/><div class="children"><div class="content">OpenSSH and Linux were not targeted&#x2F;affected.<p>xz and the Debian distribtion of OpenSSH were targeted.</div><br/><div id="39899878" class="c"><input type="checkbox" id="c-39899878" checked=""/><div class="controls bullet"><span class="by">pama</span><span>|</span><a href="#39897372">root</a><span>|</span><a href="#39898617">parent</a><span>|</span><a href="#39899501">next</a><span>|</span><label class="collapse" for="c-39899878">[-]</label><label class="expand" for="c-39899878">[4 more]</label></div><br/><div class="children"><div class="content">The core source of the vulnerability (symbol lookup order allowing a dependency to preempt a function) might theoretically be fixed at the Linux+OpenSSH level.</div><br/><div id="39900019" class="c"><input type="checkbox" id="c-39900019" checked=""/><div class="controls bullet"><span class="by">wolverine876</span><span>|</span><a href="#39897372">root</a><span>|</span><a href="#39899878">parent</a><span>|</span><a href="#39900123">next</a><span>|</span><label class="collapse" for="c-39900019">[-]</label><label class="expand" for="c-39900019">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s in their ecosystem; they should be concerned about other similar attacks and about addressing the fears of many users, developers, etc.</div><br/></div></div><div id="39900123" class="c"><input type="checkbox" id="c-39900123" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#39897372">root</a><span>|</span><a href="#39899878">parent</a><span>|</span><a href="#39900019">prev</a><span>|</span><a href="#39899501">next</a><span>|</span><label class="collapse" for="c-39900123">[-]</label><label class="expand" for="c-39900123">[2 more]</label></div><br/><div class="children"><div class="content">Damien Miller (OpenSSH maintainer, OpenBSD committer) has written a patch that implements the relevant libsystemd functionality without libsystemd: <a href="https:&#x2F;&#x2F;bugzilla.mindrot.org&#x2F;show_bug.cgi?id=2641#c13" rel="nofollow">https:&#x2F;&#x2F;bugzilla.mindrot.org&#x2F;show_bug.cgi?id=2641#c13</a></div><br/></div></div></div></div><div id="39899501" class="c"><input type="checkbox" id="c-39899501" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#39897372">root</a><span>|</span><a href="#39898617">parent</a><span>|</span><a href="#39899878">prev</a><span>|</span><a href="#39896168">next</a><span>|</span><label class="collapse" for="c-39899501">[-]</label><label class="expand" for="c-39899501">[1 more]</label></div><br/><div class="children"><div class="content">Fedora too.</div><br/></div></div></div></div></div></div><div id="39896168" class="c"><input type="checkbox" id="c-39896168" checked=""/><div class="controls bullet"><span class="by">arnaudsm</span><span>|</span><a href="#39897372">prev</a><span>|</span><a href="#39902192">next</a><span>|</span><label class="collapse" for="c-39896168">[-]</label><label class="expand" for="c-39896168">[5 more]</label></div><br/><div class="children"><div class="content">Have we seen exploitation in the wild yet?</div><br/><div id="39896286" class="c"><input type="checkbox" id="c-39896286" checked=""/><div class="controls bullet"><span class="by">winkelmann</span><span>|</span><a href="#39896168">parent</a><span>|</span><a href="#39896518">next</a><span>|</span><label class="collapse" for="c-39896286">[-]</label><label class="expand" for="c-39896286">[1 more]</label></div><br/><div class="children"><div class="content">I assume the operation has most likely been called off. Their goal was probably to wait until it got into stable distros. I doubt there is a large number of unstable Debian or Fedora Rawhide servers with open SSH in the wild.</div><br/></div></div><div id="39896518" class="c"><input type="checkbox" id="c-39896518" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#39896168">parent</a><span>|</span><a href="#39896286">prev</a><span>|</span><a href="#39902192">next</a><span>|</span><label class="collapse" for="c-39896518">[-]</label><label class="expand" for="c-39896518">[3 more]</label></div><br/><div class="children"><div class="content">If it hadn&#x27;t been discovered for another month or so, then it would have appeared in stable Fedora 40, Ubuntu 24.4 and Debian, and then it definitely would have been exploited.  Another year it would have been in RHEL 10.  Very luck escape.</div><br/><div id="39901892" class="c"><input type="checkbox" id="c-39901892" checked=""/><div class="controls bullet"><span class="by">bclemens</span><span>|</span><a href="#39896168">root</a><span>|</span><a href="#39896518">parent</a><span>|</span><a href="#39902192">next</a><span>|</span><label class="collapse" for="c-39901892">[-]</label><label class="expand" for="c-39901892">[2 more]</label></div><br/><div class="children"><div class="content">Nope, it wouldn&#x27;t have been in RHEL 10 or any of the rebuilds. CentOS Stream 10 already branched from Fedora &#x2F; ELN. The closest it would have gotten is a Fedora ELN compose, and it&#x27;s doubtful it would have remained undiscovered long enough to end up in CentOS Stream 11.</div><br/><div id="39903168" class="c"><input type="checkbox" id="c-39903168" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#39896168">root</a><span>|</span><a href="#39901892">parent</a><span>|</span><a href="#39902192">next</a><span>|</span><label class="collapse" for="c-39903168">[-]</label><label class="expand" for="c-39903168">[1 more]</label></div><br/><div class="children"><div class="content">We likely would have backported the change.  I&#x27;m already planning a big rebase of packages that missed the Fedora 40 &#x2F; C10S branch (related to RISC-V in that case).</div><br/></div></div></div></div></div></div></div></div><div id="39902192" class="c"><input type="checkbox" id="c-39902192" checked=""/><div class="controls bullet"><span class="by">AlexanderTheGr8</span><span>|</span><a href="#39896168">prev</a><span>|</span><a href="#39896409">next</a><span>|</span><label class="collapse" for="c-39902192">[-]</label><label class="expand" for="c-39902192">[1 more]</label></div><br/><div class="children"><div class="content">Is there any progress on identifying the attacker? This would make it much easier to find out it this was really a state-sponsored attack.<p>If this backdoor can be classified as a crime, github logs can identify the IP&#x2F;location&#x2F;other details of the attacker which is more than enough to identify them, unless their OPSEC is perfect, which it almost never is (e.g. Ross Ulbricht).</div><br/></div></div><div id="39896409" class="c"><input type="checkbox" id="c-39896409" checked=""/><div class="controls bullet"><span class="by">jobs_throwaway</span><span>|</span><a href="#39902192">prev</a><span>|</span><a href="#39897340">next</a><span>|</span><label class="collapse" for="c-39896409">[-]</label><label class="expand" for="c-39896409">[28 more]</label></div><br/><div class="children"><div class="content">Imagine how frustrating it has to be for the attacker to meticulously plan and execute this and get foiled so late in the game, and so publicly</div><br/><div id="39896528" class="c"><input type="checkbox" id="c-39896528" checked=""/><div class="controls bullet"><span class="by">pixl97</span><span>|</span><a href="#39896409">parent</a><span>|</span><a href="#39896428">next</a><span>|</span><label class="collapse" for="c-39896528">[-]</label><label class="expand" for="c-39896528">[9 more]</label></div><br/><div class="children"><div class="content">So who&#x27;s started scanning open source lib test cases for more stuff like this?</div><br/><div id="39898460" class="c"><input type="checkbox" id="c-39898460" checked=""/><div class="controls bullet"><span class="by">beefnugs</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896528">parent</a><span>|</span><a href="#39898942">next</a><span>|</span><label class="collapse" for="c-39898460">[-]</label><label class="expand" for="c-39898460">[1 more]</label></div><br/><div class="children"><div class="content">Like everything else in this world, its utterly and completely unfixably broken: There is no way you can have complex huge dependencies properly.<p>The best most paranoid thing is to have multiple networking layers hoping they have to exploit multiple things at once, and whitelist only networking for exactly what you are expecting to happen. (which is completely incompatible with the idea of ssl, we would need a new type of firewall that sits between ALL applications before encryption, like a firewall between applications and the crypto library itself, which breaks a bunch of other things people want to do)</div><br/></div></div><div id="39898942" class="c"><input type="checkbox" id="c-39898942" checked=""/><div class="controls bullet"><span class="by">slaymaker1907</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896528">parent</a><span>|</span><a href="#39898460">prev</a><span>|</span><a href="#39896428">next</a><span>|</span><label class="collapse" for="c-39898942">[-]</label><label class="expand" for="c-39898942">[7 more]</label></div><br/><div class="children"><div class="content">I think it would help to try and secure signing infrastructure as much as possible. First of all, try to have 3 devs for any given project (this is the most difficult step). Make sure logging into or changing any of the signing stuff requires at least 2 of the devs, one to initiate the JIT and one to monitor.<p>Additionally, take supply chain steps like requiring independent approval for PRs and requiring the signing process to only work with automated builds. Don&#x27;t allow for signing bits that were built on a dev machine.<p>Finally, I think it would help to start implementing signing executables and scripts which get checked at runtime. Windows obviously does executable signing, but it largely doesn&#x27;t sign stuff like Python scripts. JS in the browser is kind of signed given that the whole site is signed via https. It&#x27;s not perfect, but it would help in preventing one program from modifying another for very sensitive contexts like web servers.</div><br/><div id="39899002" class="c"><input type="checkbox" id="c-39899002" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39898942">parent</a><span>|</span><a href="#39900114">next</a><span>|</span><label class="collapse" for="c-39899002">[-]</label><label class="expand" for="c-39899002">[5 more]</label></div><br/><div class="children"><div class="content">I do not think any of that would have prevented this situation.</div><br/><div id="39899871" class="c"><input type="checkbox" id="c-39899871" checked=""/><div class="controls bullet"><span class="by">slaymaker1907</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39899002">parent</a><span>|</span><a href="#39900114">next</a><span>|</span><label class="collapse" for="c-39899871">[-]</label><label class="expand" for="c-39899871">[4 more]</label></div><br/><div class="children"><div class="content">Upon further reading, I think you might be correct. I initially thought a good signing process would be sufficient since it sounded like this malicious blob was secretly being included in the tarball by the build server, but it instead seems to be the case that the malicious binary was included in the repo as a test file.<p>You could probably still protect against this sort of attack using signing, but it would be much more laborious and annoying to get working. The idea is that you would somehow declare that OpenSSH binaries must be signed by a *particular* key&#x2F;authority, that VS Code is signed by Microsoft, Chrome signed by Google, etc. Additionally, the config declaring all of this obviously needs to be secured so you&#x27;d need to lock down access to those files (changing key associations would need to require more permissions than just updating old software or installing new software to be useful).</div><br/><div id="39900255" class="c"><input type="checkbox" id="c-39900255" checked=""/><div class="controls bullet"><span class="by">Aloisius</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39899871">parent</a><span>|</span><a href="#39900114">next</a><span>|</span><label class="collapse" for="c-39900255">[-]</label><label class="expand" for="c-39900255">[3 more]</label></div><br/><div class="children"><div class="content">It was both. The binary object file was obfuscated in two &quot;test&quot; xz files in the repo itself. The code to extract the object file and inject it into the build process was only in the GitHub release tarball.<p>The code in the tarball could have been prevented if only automated tarballs were permitted (for instance, GitHub&#x27;s branch&#x2F;tag source tarballs) or caught after the fact by verifying the file hashes in the tarball against those in the repo.</div><br/><div id="39901159" class="c"><input type="checkbox" id="c-39901159" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39900255">parent</a><span>|</span><a href="#39900114">next</a><span>|</span><label class="collapse" for="c-39901159">[-]</label><label class="expand" for="c-39901159">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The code to extract the object file and inject it into the build process was only in the GitHub release tarball.<p>I thought it was in both, however the backdoor wasn&#x27;t inserted with the default build time options, so it ended up in the tarball, but not if you just did make unless you set things up the same as the build server.</div><br/><div id="39901564" class="c"><input type="checkbox" id="c-39901564" checked=""/><div class="controls bullet"><span class="by">Aloisius</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39901159">parent</a><span>|</span><a href="#39900114">next</a><span>|</span><label class="collapse" for="c-39901564">[-]</label><label class="expand" for="c-39901564">[1 more]</label></div><br/><div class="children"><div class="content">The release tarball contained code that can&#x27;t be generated from the repo, no matter what settings you use.<p>JiaT75 created the release on GitHub which involves creating a description and  uploading tarballs. Their PGP key has been used to sign them since May 2023.<p>1. The repo contained two test xz files which contained the obfuscated exploit .o file<p>2. JiaT75 created the release on GitHub which allows you to upload your own tarball for the release.<p>3. The release tarball contained a modified build-to-host.m4 that extracted the exploit .o so it would be linked into the library if building on a Linux x86-64 machine.<p>4. Fedora&#x2F;Debian&#x2F;whoever pulled the release source tarball from GitHub and ran their builds for x86-64 Linux which caused the exploit .o file to be linked into the binary they then packaged up for release</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39900114" class="c"><input type="checkbox" id="c-39900114" checked=""/><div class="controls bullet"><span class="by">j-krieger</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39898942">parent</a><span>|</span><a href="#39899002">prev</a><span>|</span><a href="#39896428">next</a><span>|</span><label class="collapse" for="c-39900114">[-]</label><label class="expand" for="c-39900114">[1 more]</label></div><br/><div class="children"><div class="content">All this riffraff and OSS maintainers basically work for free.</div><br/></div></div></div></div></div></div><div id="39896428" class="c"><input type="checkbox" id="c-39896428" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#39896409">parent</a><span>|</span><a href="#39896528">prev</a><span>|</span><a href="#39897442">next</a><span>|</span><label class="collapse" for="c-39896428">[-]</label><label class="expand" for="c-39896428">[17 more]</label></div><br/><div class="children"><div class="content">Must be punching the air right now</div><br/><div id="39896498" class="c"><input type="checkbox" id="c-39896498" checked=""/><div class="controls bullet"><span class="by">cellis</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896428">parent</a><span>|</span><a href="#39896510">next</a><span>|</span><label class="collapse" for="c-39896498">[-]</label><label class="expand" for="c-39896498">[5 more]</label></div><br/><div class="children"><div class="content">Or...falling back on less noticed contingency plans...</div><br/><div id="39896646" class="c"><input type="checkbox" id="c-39896646" checked=""/><div class="controls bullet"><span class="by">Ekaros</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896498">parent</a><span>|</span><a href="#39896510">next</a><span>|</span><label class="collapse" for="c-39896646">[-]</label><label class="expand" for="c-39896646">[4 more]</label></div><br/><div class="children"><div class="content">My pet theory is that this was just one project they have been running for years. They are likely doing many more at same time. Slowly inserting parts in various projects and getting their contributors inside the projects.</div><br/><div id="39899681" class="c"><input type="checkbox" id="c-39899681" checked=""/><div class="controls bullet"><span class="by">SAI_Peregrinus</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896646">parent</a><span>|</span><a href="#39897294">next</a><span>|</span><label class="collapse" for="c-39899681">[-]</label><label class="expand" for="c-39899681">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s an intelligence agency exploit, this is nearly certain. Getting agents hired as employees of foreign companies to provide intelligence is an ancient practice. Getting agents to be open source maintainers is a continuation of the same thing.</div><br/></div></div><div id="39897294" class="c"><input type="checkbox" id="c-39897294" checked=""/><div class="controls bullet"><span class="by">0cf8612b2e1e</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896646">parent</a><span>|</span><a href="#39899681">prev</a><span>|</span><a href="#39898019">next</a><span>|</span><label class="collapse" for="c-39897294">[-]</label><label class="expand" for="c-39897294">[1 more]</label></div><br/><div class="children"><div class="content">That seems like a safe bet. If you are planning a multi year operation, it would be silly to do it all under a single account. Best to minimize the blast radius if any single exploit gets discovered.</div><br/></div></div><div id="39898019" class="c"><input type="checkbox" id="c-39898019" checked=""/><div class="controls bullet"><span class="by">guyomes</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896646">parent</a><span>|</span><a href="#39897294">prev</a><span>|</span><a href="#39896510">next</a><span>|</span><label class="collapse" for="c-39898019">[-]</label><label class="expand" for="c-39898019">[1 more]</label></div><br/><div class="children"><div class="content">Some of this activity was actually documented through the alleged data breach of a hacking company [1].<p>[1]: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hacking_Team" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hacking_Team</a></div><br/></div></div></div></div></div></div><div id="39896510" class="c"><input type="checkbox" id="c-39896510" checked=""/><div class="controls bullet"><span class="by">noobermin</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896428">parent</a><span>|</span><a href="#39896498">prev</a><span>|</span><a href="#39896588">next</a><span>|</span><label class="collapse" for="c-39896510">[-]</label><label class="expand" for="c-39896510">[1 more]</label></div><br/><div class="children"><div class="content">Or, they must be strapped into a chair having teeth being pulled out by whoever directed them.</div><br/></div></div><div id="39896588" class="c"><input type="checkbox" id="c-39896588" checked=""/><div class="controls bullet"><span class="by">TechDebtDevin</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896428">parent</a><span>|</span><a href="#39896510">prev</a><span>|</span><a href="#39897442">next</a><span>|</span><label class="collapse" for="c-39896588">[-]</label><label class="expand" for="c-39896588">[10 more]</label></div><br/><div class="children"><div class="content">Likely a team of people at a three letter agency.</div><br/><div id="39896754" class="c"><input type="checkbox" id="c-39896754" checked=""/><div class="controls bullet"><span class="by">morkalork</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896588">parent</a><span>|</span><a href="#39896877">next</a><span>|</span><label class="collapse" for="c-39896754">[-]</label><label class="expand" for="c-39896754">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if they have OKRs too.</div><br/></div></div><div id="39896877" class="c"><input type="checkbox" id="c-39896877" checked=""/><div class="controls bullet"><span class="by">TheBlight</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896588">parent</a><span>|</span><a href="#39896754">prev</a><span>|</span><a href="#39897442">next</a><span>|</span><label class="collapse" for="c-39896877">[-]</label><label class="expand" for="c-39896877">[8 more]</label></div><br/><div class="children"><div class="content">Everyone keeps saying this but it seems unlikely to me that they&#x27;d do this for a relatively short window of opportunity and leave their methods for all to see.</div><br/><div id="39897170" class="c"><input type="checkbox" id="c-39897170" checked=""/><div class="controls bullet"><span class="by">avidiax</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896877">parent</a><span>|</span><a href="#39897554">next</a><span>|</span><label class="collapse" for="c-39897170">[-]</label><label class="expand" for="c-39897170">[5 more]</label></div><br/><div class="children"><div class="content">You are judging this by the outcome, as though it were pre-ordained, and also assuming that this is the only method this agency has.<p>It is much more likely that this backdoor would have gone unnoticed for months or years. The access this backdoor provides would be used only once per system, to install other APT (advanced persistent threats), probably layers of them. Use a typical software RAT or rootkit as the first layer. If that is discovered, fallback to the private keys you stole, or the social engineer the company directory you copied. If that fails, rely on the firmware rootkit that only runs if it&#x27;s timer hasn&#x27;t been reset in 6 months. Failing that, re-use this backdoor if it&#x27;s still available.</div><br/><div id="39898248" class="c"><input type="checkbox" id="c-39898248" checked=""/><div class="controls bullet"><span class="by">TheBlight</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39897170">parent</a><span>|</span><a href="#39897554">next</a><span>|</span><label class="collapse" for="c-39898248">[-]</label><label class="expand" for="c-39898248">[4 more]</label></div><br/><div class="children"><div class="content">It was found in a few weeks so why is it more likely it wouldn&#x27;t have been noticed for months&#x2F;years with more people running the backdoored version of the code?</div><br/><div id="39898682" class="c"><input type="checkbox" id="c-39898682" checked=""/><div class="controls bullet"><span class="by">ufo</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39898248">parent</a><span>|</span><a href="#39897554">next</a><span>|</span><label class="collapse" for="c-39898682">[-]</label><label class="expand" for="c-39898682">[3 more]</label></div><br/><div class="children"><div class="content">We were lucky that the backdoor called attention to itself, because it impacted the performance off ssh and introduced valgrind warnings.</div><br/><div id="39900260" class="c"><input type="checkbox" id="c-39900260" checked=""/><div class="controls bullet"><span class="by">TheBlight</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39898682">parent</a><span>|</span><a href="#39897554">next</a><span>|</span><label class="collapse" for="c-39900260">[-]</label><label class="expand" for="c-39900260">[2 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t that further suggest non-state actor(s)?</div><br/><div id="39901453" class="c"><input type="checkbox" id="c-39901453" checked=""/><div class="controls bullet"><span class="by">ufo</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39900260">parent</a><span>|</span><a href="#39897554">next</a><span>|</span><label class="collapse" for="c-39901453">[-]</label><label class="expand" for="c-39901453">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve heard that it was only detected because the developer that found it was using different compiler flags than the default. Under default settings, the backdoor was stealthier.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39897554" class="c"><input type="checkbox" id="c-39897554" checked=""/><div class="controls bullet"><span class="by">AtNightWeCode</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39896877">parent</a><span>|</span><a href="#39897170">prev</a><span>|</span><a href="#39897442">next</a><span>|</span><label class="collapse" for="c-39897554">[-]</label><label class="expand" for="c-39897554">[2 more]</label></div><br/><div class="children"><div class="content">My guess is that a ransomware group is behind this. Even if the backdoor had gone into production servers it would have been found fairly quickly if used at some scale.</div><br/><div id="39898226" class="c"><input type="checkbox" id="c-39898226" checked=""/><div class="controls bullet"><span class="by">TheBlight</span><span>|</span><a href="#39896409">root</a><span>|</span><a href="#39897554">parent</a><span>|</span><a href="#39897442">next</a><span>|</span><label class="collapse" for="c-39898226">[-]</label><label class="expand" for="c-39898226">[1 more]</label></div><br/><div class="children"><div class="content">&gt;My guess is that a ransomware group is behind this.<p>My bet would be that they were after a crypto exchange(s) where they&#x27;ve already compromised some level of access and want to get deeper into the backend.<p>&gt;Even if the backdoor had gone into production servers it would have been found fairly quickly if used at some scale.<p>I agree. Yes it&#x27;s possible the backdoor could&#x27;ve gone unnoticed for months&#x2F;years but I think the perp would&#x27;ve had to assume not.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39897442" class="c"><input type="checkbox" id="c-39897442" checked=""/><div class="controls bullet"><span class="by">zoeysmithe</span><span>|</span><a href="#39896409">parent</a><span>|</span><a href="#39896428">prev</a><span>|</span><a href="#39897340">next</a><span>|</span><label class="collapse" for="c-39897442">[-]</label><label class="expand" for="c-39897442">[1 more]</label></div><br/><div class="children"><div class="content">This actor, and others like them, may have dozens or hundreds of these things out there. We don&#x27;t know. This was only found accidentally, not via code review.</div><br/></div></div></div></div><div id="39896577" class="c"><input type="checkbox" id="c-39896577" checked=""/><div class="controls bullet"><span class="by">yodsanklai</span><span>|</span><a href="#39897340">prev</a><span>|</span><a href="#39901829">next</a><span>|</span><label class="collapse" for="c-39896577">[-]</label><label class="expand" for="c-39896577">[12 more]</label></div><br/><div class="children"><div class="content">Do we know who&#x27;s the attacker?</div><br/><div id="39896854" class="c"><input type="checkbox" id="c-39896854" checked=""/><div class="controls bullet"><span class="by">toasteros</span><span>|</span><a href="#39896577">parent</a><span>|</span><a href="#39897451">next</a><span>|</span><label class="collapse" for="c-39896854">[-]</label><label class="expand" for="c-39896854">[8 more]</label></div><br/><div class="children"><div class="content">The name that keeps coming up is Jia Tan (<a href="https:&#x2F;&#x2F;github.com&#x2F;JiaT75&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;JiaT75&#x2F;</a>) but we have no way of knowing if this is a real name, pseudonym, or even a collective of people.</div><br/><div id="39897813" class="c"><input type="checkbox" id="c-39897813" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39896854">parent</a><span>|</span><a href="#39897263">next</a><span>|</span><label class="collapse" for="c-39897813">[-]</label><label class="expand" for="c-39897813">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s also worth pointing out, given the almost two years of seemingly valuable contribution, that this could be a real person who was compromised or coerced into pushing the exploit.</div><br/><div id="39899718" class="c"><input type="checkbox" id="c-39899718" checked=""/><div class="controls bullet"><span class="by">stefan_</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39897813">parent</a><span>|</span><a href="#39897263">next</a><span>|</span><label class="collapse" for="c-39899718">[-]</label><label class="expand" for="c-39899718">[2 more]</label></div><br/><div class="children"><div class="content">It’s also worth pointing out that parts of the RCE were prepared almost two years ago which makes this entirely implausible.</div><br/><div id="39900228" class="c"><input type="checkbox" id="c-39900228" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39899718">parent</a><span>|</span><a href="#39897263">next</a><span>|</span><label class="collapse" for="c-39900228">[-]</label><label class="expand" for="c-39900228">[1 more]</label></div><br/><div class="children"><div class="content">Were they?  The attacker has had commit rights for 1.5 years or so, but my understanding is that all the exploit components were recent commits.  Is that wrong?</div><br/></div></div></div></div></div></div><div id="39897263" class="c"><input type="checkbox" id="c-39897263" checked=""/><div class="controls bullet"><span class="by">pphysch</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39896854">parent</a><span>|</span><a href="#39897813">prev</a><span>|</span><a href="#39897451">next</a><span>|</span><label class="collapse" for="c-39897263">[-]</label><label class="expand" for="c-39897263">[4 more]</label></div><br/><div class="children"><div class="content">Given the sophistication of this attack it would indeed be downright negligent to presume that it&#x27;s the attackers&#x27; legal name and that they have zero OPSEC.</div><br/><div id="39899985" class="c"><input type="checkbox" id="c-39899985" checked=""/><div class="controls bullet"><span class="by">xvector</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39897263">parent</a><span>|</span><a href="#39897451">next</a><span>|</span><label class="collapse" for="c-39899985">[-]</label><label class="expand" for="c-39899985">[3 more]</label></div><br/><div class="children"><div class="content">He used ProtonMail. I wonder if ProtonMail can pull IP logs for this guy and share them.</div><br/><div id="39900297" class="c"><input type="checkbox" id="c-39900297" checked=""/><div class="controls bullet"><span class="by">eklitzke</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39899985">parent</a><span>|</span><a href="#39897451">next</a><span>|</span><label class="collapse" for="c-39900297">[-]</label><label class="expand" for="c-39900297">[2 more]</label></div><br/><div class="children"><div class="content">It might be worth looking into, but:<p>1) Probably by design protonmail doesn&#x27;t keep these kinds of logs around for very long<p>2) Hacking groups pretty much always proxy their connection through multiple layers of machines they&#x27;ve rooted, making it very difficult or impossible to actually trace back to the original IP</div><br/><div id="39903381" class="c"><input type="checkbox" id="c-39903381" checked=""/><div class="controls bullet"><span class="by">xvector</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39900297">parent</a><span>|</span><a href="#39897451">next</a><span>|</span><label class="collapse" for="c-39903381">[-]</label><label class="expand" for="c-39903381">[1 more]</label></div><br/><div class="children"><div class="content">For [1], unfortunately it does.<p>True regarding the second point.<p>[1]: <a href="https:&#x2F;&#x2F;techcrunch.com&#x2F;2021&#x2F;09&#x2F;06&#x2F;protonmail-logged-ip-address-of-french-activist-after-order-by-swiss-authorities&#x2F;" rel="nofollow">https:&#x2F;&#x2F;techcrunch.com&#x2F;2021&#x2F;09&#x2F;06&#x2F;protonmail-logged-ip-addre...</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="39897451" class="c"><input type="checkbox" id="c-39897451" checked=""/><div class="controls bullet"><span class="by">cellis</span><span>|</span><a href="#39896577">parent</a><span>|</span><a href="#39896854">prev</a><span>|</span><a href="#39897493">next</a><span>|</span><label class="collapse" for="c-39897451">[-]</label><label class="expand" for="c-39897451">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d say Ned Stark Associates, Fancy Bear, etc.</div><br/></div></div><div id="39897493" class="c"><input type="checkbox" id="c-39897493" checked=""/><div class="controls bullet"><span class="by">FergusArgyll</span><span>|</span><a href="#39896577">parent</a><span>|</span><a href="#39897451">prev</a><span>|</span><a href="#39901829">next</a><span>|</span><label class="collapse" for="c-39897493">[-]</label><label class="expand" for="c-39897493">[2 more]</label></div><br/><div class="children"><div class="content">This Guy<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39877604">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39877604</a></div><br/><div id="39900485" class="c"><input type="checkbox" id="c-39900485" checked=""/><div class="controls bullet"><span class="by">blah-yeah</span><span>|</span><a href="#39896577">root</a><span>|</span><a href="#39897493">parent</a><span>|</span><a href="#39901829">next</a><span>|</span><label class="collapse" for="c-39900485">[-]</label><label class="expand" for="c-39900485">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s alleged to be <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;user?id=dang">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;user?id=dang</a></div><br/></div></div></div></div></div></div><div id="39901829" class="c"><input type="checkbox" id="c-39901829" checked=""/><div class="controls bullet"><span class="by">mkeymaker</span><span>|</span><a href="#39896577">prev</a><span>|</span><a href="#39897558">next</a><span>|</span><label class="collapse" for="c-39901829">[-]</label><label class="expand" for="c-39901829">[1 more]</label></div><br/><div class="children"><div class="content">these things are why focus on assuming compromise should be the default. Stop focusing all the effort on identifying the exploit instead focus on the behaviour of the attacker after exploit.</div><br/></div></div><div id="39897558" class="c"><input type="checkbox" id="c-39897558" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#39901829">prev</a><span>|</span><a href="#39903220">next</a><span>|</span><label class="collapse" for="c-39897558">[-]</label><label class="expand" for="c-39897558">[8 more]</label></div><br/><div class="children"><div class="content">&gt; The ciphertext is encrypted with chacha20 using the first 32 bytes of the ED448 public key as a symmetric key. As a result, we can decrypt any exploit attempt using the following key:<p>Isn&#x27;t this wild?  Shouldn&#x27;t the ciphertext be encrypted with an ephemeral symmetric key signed by the privkey?  I guess anyone with the public key can still read any payload, so what&#x27;s the point?</div><br/><div id="39899923" class="c"><input type="checkbox" id="c-39899923" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#39897558">parent</a><span>|</span><a href="#39899601">next</a><span>|</span><label class="collapse" for="c-39899923">[-]</label><label class="expand" for="c-39899923">[2 more]</label></div><br/><div class="children"><div class="content">Encrypting the payload will allow you to get by more scanners and in general make the traffic harder to notice. Since the publicly available server code needs to be able to decrypt the payload there is no way to make it completely secure, so this seems like a good tradeoff that prevents passive naive monitoring from triggering while not being more complicated than necessary.<p>The only real improvement that I can see being made would be adding perfect forward secrecy so that a logged session couldn&#x27;t be decrypted after the fact. But that would likely add a lot of complexity (I think you need bidirectional communication?)</div><br/><div id="39900937" class="c"><input type="checkbox" id="c-39900937" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#39897558">root</a><span>|</span><a href="#39899923">parent</a><span>|</span><a href="#39899601">next</a><span>|</span><label class="collapse" for="c-39900937">[-]</label><label class="expand" for="c-39900937">[1 more]</label></div><br/><div class="children"><div class="content">Seems like single-byte XOR would be almost as good for obfuscation purposes, but I guess using chacha20 from the public key as a pseudo-OTP doesn&#x27;t hurt.<p>&gt; The only real improvement that I can see being made would be adding perfect forward secrecy so that a logged session couldn&#x27;t be decrypted after the fact. But that would likely add a lot of complexity (I think you need bidirectional communication?)<p>Yeah.</div><br/></div></div></div></div><div id="39899601" class="c"><input type="checkbox" id="c-39899601" checked=""/><div class="controls bullet"><span class="by">thenewwazoo</span><span>|</span><a href="#39897558">parent</a><span>|</span><a href="#39899923">prev</a><span>|</span><a href="#39898142">next</a><span>|</span><label class="collapse" for="c-39899601">[-]</label><label class="expand" for="c-39899601">[4 more]</label></div><br/><div class="children"><div class="content">This is a NOBUS attack - Nobody But Us.<p>By tying it to a particular key owned by the attacker, no other party can trigger the exploit.</div><br/><div id="39899743" class="c"><input type="checkbox" id="c-39899743" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#39897558">root</a><span>|</span><a href="#39899601">parent</a><span>|</span><a href="#39898142">next</a><span>|</span><label class="collapse" for="c-39899743">[-]</label><label class="expand" for="c-39899743">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think this is responsive to my comment.</div><br/><div id="39900322" class="c"><input type="checkbox" id="c-39900322" checked=""/><div class="controls bullet"><span class="by">jhugo</span><span>|</span><a href="#39897558">root</a><span>|</span><a href="#39899743">parent</a><span>|</span><a href="#39898142">next</a><span>|</span><label class="collapse" for="c-39900322">[-]</label><label class="expand" for="c-39900322">[2 more]</label></div><br/><div class="children"><div class="content">I think it is? They were not trying to hide the content, but rather to ensure that nobody else could encrypt valid payloads.</div><br/><div id="39900934" class="c"><input type="checkbox" id="c-39900934" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#39897558">root</a><span>|</span><a href="#39900322">parent</a><span>|</span><a href="#39898142">next</a><span>|</span><label class="collapse" for="c-39900934">[-]</label><label class="expand" for="c-39900934">[1 more]</label></div><br/><div class="children"><div class="content">The <i>signing</i> accomplishes that.  The chacha20 <i>encryption</i> with part of a public key, which is what I&#x27;m discussing above, is just obfuscation.</div><br/></div></div></div></div></div></div></div></div><div id="39898142" class="c"><input type="checkbox" id="c-39898142" checked=""/><div class="controls bullet"><span class="by">rcaught</span><span>|</span><a href="#39897558">parent</a><span>|</span><a href="#39899601">prev</a><span>|</span><a href="#39903220">next</a><span>|</span><label class="collapse" for="c-39898142">[-]</label><label class="expand" for="c-39898142">[1 more]</label></div><br/><div class="children"><div class="content">That action would create extra noise.</div><br/></div></div></div></div><div id="39903220" class="c"><input type="checkbox" id="c-39903220" checked=""/><div class="controls bullet"><span class="by">duckyoufan</span><span>|</span><a href="#39897558">prev</a><span>|</span><a href="#39896572">next</a><span>|</span><label class="collapse" for="c-39903220">[-]</label><label class="expand" for="c-39903220">[1 more]</label></div><br/><div class="children"><div class="content">So many important points in dead and downvoted comments. Who the hell runs this site?</div><br/></div></div><div id="39896572" class="c"><input type="checkbox" id="c-39896572" checked=""/><div class="controls bullet"><span class="by">dec0dedab0de</span><span>|</span><a href="#39903220">prev</a><span>|</span><a href="#39901326">next</a><span>|</span><label class="collapse" for="c-39896572">[-]</label><label class="expand" for="c-39896572">[90 more]</label></div><br/><div class="children"><div class="content">Stuff like this is why I like port knocking, and limiting access to specific client IPs&#x2F;networks when possible.<p>20 years ago, I was working at an ISP&#x2F;Telco and one of our vendors had a permanent admin account hardcoded on their gear, you couldn&#x27;t change the password and it didn&#x27;t log access, or show up as an active user session.<p>Always limit traffic to just what is necessary, does the entire internet really need to be able to SSH to your box?</div><br/><div id="39896606" class="c"><input type="checkbox" id="c-39896606" checked=""/><div class="controls bullet"><span class="by">herpderperator</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39898061">next</a><span>|</span><label class="collapse" for="c-39896606">[-]</label><label class="expand" for="c-39896606">[50 more]</label></div><br/><div class="children"><div class="content">The thing about port knocking is that if you&#x27;re on a host where you don&#x27;t have the ability to port-knock, then you&#x27;re not able to connect.<p>This can turn into a footgun: you&#x27;re away from your usual device, something happens and you desperately need to connect, but now you can&#x27;t because all the devices in your vicinity don&#x27;t have the ability to perform $SECURITY_FEATURE_X so that you can connect, and you&#x27;re screaming at yourself for adding so much security at the expense of convenience.<p>This could happen as easily as restricting logins to SSH keys only, and not being able to use your SSH key on whatever host you have available at the time, wishing you&#x27;d have enabled password authentication.</div><br/><div id="39896782" class="c"><input type="checkbox" id="c-39896782" checked=""/><div class="controls bullet"><span class="by">jolmg</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39897169">next</a><span>|</span><label class="collapse" for="c-39896782">[-]</label><label class="expand" for="c-39896782">[19 more]</label></div><br/><div class="children"><div class="content">&gt; The thing about port knocking is that if you&#x27;re on a host where you don&#x27;t have the ability to port-knock, then you&#x27;re not able to connect.<p>If that&#x27;s important, one should be able to set up port knocking such that you&#x27;re able to do the knocks even by changing the port in a sequence by hand on e.g. a web browser address bar.</div><br/><div id="39897082" class="c"><input type="checkbox" id="c-39897082" checked=""/><div class="controls bullet"><span class="by">mr_mitm</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896782">parent</a><span>|</span><a href="#39897169">next</a><span>|</span><label class="collapse" for="c-39897082">[-]</label><label class="expand" for="c-39897082">[18 more]</label></div><br/><div class="children"><div class="content">Note that port knocking is vulnerable to replay attacks. Single Packet Authentication is better, but requires a private key (can be your SSH key).<p><a href="https:&#x2F;&#x2F;www.cipherdyne.org&#x2F;fwknop&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.cipherdyne.org&#x2F;fwknop&#x2F;</a></div><br/><div id="39897945" class="c"><input type="checkbox" id="c-39897945" checked=""/><div class="controls bullet"><span class="by">mlyle</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897082">parent</a><span>|</span><a href="#39897229">next</a><span>|</span><label class="collapse" for="c-39897945">[-]</label><label class="expand" for="c-39897945">[4 more]</label></div><br/><div class="children"><div class="content">Naive knocking isn&#x27;t good as a primary security mechanism, but it lowers your attack surface and adds defense in depth.<p>It means that people who can&#x27;t intercept traffic can&#x27;t talk to the ssh server-- and that&#x27;s most attackers at the beginning phases of an attack.  And even someone who can intercept traffic needs to wait for actual administrative activity.</div><br/><div id="39898894" class="c"><input type="checkbox" id="c-39898894" checked=""/><div class="controls bullet"><span class="by">gnramires</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897945">parent</a><span>|</span><a href="#39897229">next</a><span>|</span><label class="collapse" for="c-39898894">[-]</label><label class="expand" for="c-39898894">[3 more]</label></div><br/><div class="children"><div class="content">Defense in depth has value I agree, but I think it can also be counterproductive in some cases. Every layer can also be buggy and have vulnerabilities, which can often leak (e.g. into code execution) and compromise the whole system (bypassing layers). What happened in this case seems to be a case of maintained hijacking and introducing vulnerabilities. Adding an additional dependency (of say a port-knocking library) doesn&#x27;t look great in that regard, if the dependency can be hijacked to add remote code execution capabilities. And that library is likely a lot less scrutinized than OpenSSH!<p>Also underrated I think is security by simplicity. OpenSSH should be extremely simple and easy to understand, such that every proposal and change could be easily scrutinized. Cryptographic constructions themselves are almost mathematically proven invulnerable, then a small codebase can go most of the way to mathematically provable security (bonus points for formal verification).<p>But for this kind of system there&#x27;s usually some kind of human vulnerability (e.g. system updates for your distro) in the loop such that the community needs to remain watchful. (It&#x27;s fun to consider an application that&#x27;s proven correct and doesn&#x27;t need updating every again, but usually that&#x27;s not practical)</div><br/><div id="39899429" class="c"><input type="checkbox" id="c-39899429" checked=""/><div class="controls bullet"><span class="by">mlyle</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898894">parent</a><span>|</span><a href="#39897229">next</a><span>|</span><label class="collapse" for="c-39899429">[-]</label><label class="expand" for="c-39899429">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Adding an additional dependency (of say a port-knocking library) doesn&#x27;t look great in that regard, if the dependency can be hijacked to add remote code execution capabilities.<p>Port knocking infrastructure can be <i>minimal</i>, knowing nothing but addresses knocking.  It can also be completely outside the protected service on a gateway.<p>Indeed, it can even be no-code, e.g. <a href="https:&#x2F;&#x2F;www.digitalocean.com&#x2F;community&#x2F;tutorials&#x2F;how-to-configure-port-knocking-using-only-iptables-on-an-ubuntu-vps" rel="nofollow">https:&#x2F;&#x2F;www.digitalocean.com&#x2F;community&#x2F;tutorials&#x2F;how-to-conf...</a><p>&gt; OpenSSH should be extremely simple and easy to understand, such that every proposal and change could be easily scrutinized.<p>But OpenSSH intrinsically is going to have a much larger attack surface.<p>&gt; then a small codebase can go most of the way to mathematically provable security (bonus points for formal verification).<p>It&#x27;s worth noting this would not have helped against this attack:<p>* It was against another dependency, not openssh<p>* The actual vulnerability didn&#x27;t occur in the code you&#x27;d inspect as part of verification processes today.  (I don&#x27;t think anyone is formally verifying build process).</div><br/><div id="39900561" class="c"><input type="checkbox" id="c-39900561" checked=""/><div class="controls bullet"><span class="by">gnramires</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39899429">parent</a><span>|</span><a href="#39897229">next</a><span>|</span><label class="collapse" for="c-39900561">[-]</label><label class="expand" for="c-39900561">[1 more]</label></div><br/><div class="children"><div class="content">Good points, I would say that defense in depth is useful when the layers of defense need to all be broken (more or less) independently for a successful attack (this fails only if you add layers that expose vulnerabities compromising your system). E.g. usually a sandbox satisfies this criterion.<p>Also, whenever some layers may allow compromising everything, the supply chains of the layers should be minimal or correlated (same supplier), to avoid increasing such supply chain risks.</div><br/></div></div></div></div></div></div></div></div><div id="39897229" class="c"><input type="checkbox" id="c-39897229" checked=""/><div class="controls bullet"><span class="by">ulrikrasmussen</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897082">parent</a><span>|</span><a href="#39897945">prev</a><span>|</span><a href="#39897110">next</a><span>|</span><label class="collapse" for="c-39897229">[-]</label><label class="expand" for="c-39897229">[7 more]</label></div><br/><div class="children"><div class="content">What if the knocking sequence was derived from a TOTP secret?</div><br/><div id="39898717" class="c"><input type="checkbox" id="c-39898717" checked=""/><div class="controls bullet"><span class="by">deepbreath</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897229">parent</a><span>|</span><a href="#39897922">next</a><span>|</span><label class="collapse" for="c-39898717">[-]</label><label class="expand" for="c-39898717">[4 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t have to do anything too complicated. Here&#x27;s the knocker code in a short Bash script, produced by GPT4:<p>~ % gpt4 &#x27;write a very short bash script that takes the number stored in ~&#x2F;.ssh&#x2F;knock_seq, increments it by 1 and saves it to the file. It then takes the new number and concatenates it with the value stored in the file ~&#x2F;.ssh&#x2F;secret. It pipes the resulting string to sha1sum, spitting out binary. It then takes both the resulting sha1sum and the number used and pipes their concatenation to &quot;nc -u $host $(cat ~&#x2F;.ssh&#x2F;knocking_port)&quot;. be brief&#x27;<p><pre><code>  knock_seq=$(cat ~&#x2F;.ssh&#x2F;knock_seq)
  let knock_seq++
  echo $knock_seq &gt; ~&#x2F;.ssh&#x2F;knock_seq
  concat_seq_secret=$(echo -n &quot;${knock_seq}$(cat ~&#x2F;.ssh&#x2F;secret)&quot;)
  sha1_output=$(echo -n $concat_seq_secret | sha1sum -b | awk &#x27;{print $1}&#x27;)
  final_output=&quot;${sha1_output}${knock_seq}&quot;
  host=localhost
  knocking_port=$(cat ~&#x2F;.ssh&#x2F;knocking_port)
  echo -n $final_output | nc -u $host $knocking_port</code></pre></div><br/><div id="39898912" class="c"><input type="checkbox" id="c-39898912" checked=""/><div class="controls bullet"><span class="by">deepbreath</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898717">parent</a><span>|</span><a href="#39899031">next</a><span>|</span><label class="collapse" for="c-39898912">[-]</label><label class="expand" for="c-39898912">[2 more]</label></div><br/><div class="children"><div class="content">The knockee PoC should also be straightforward, can use socat + udp-listen + fork with a script that checks that input matches `sha1sum(secret||num)||num` and `num&gt;previously_seen_num`, and if so, adds an iptables rule.<p>This should prevent against replays. Throw in some rate limits somewhere maybe to not get DDoSed, especially if you let socat `fork`.</div><br/></div></div></div></div><div id="39897922" class="c"><input type="checkbox" id="c-39897922" checked=""/><div class="controls bullet"><span class="by">discite</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897229">parent</a><span>|</span><a href="#39898717">prev</a><span>|</span><a href="#39897292">next</a><span>|</span><label class="collapse" for="c-39897922">[-]</label><label class="expand" for="c-39897922">[1 more]</label></div><br/><div class="children"><div class="content">Definitely some fun project to try</div><br/></div></div><div id="39897292" class="c"><input type="checkbox" id="c-39897292" checked=""/><div class="controls bullet"><span class="by">swsieber</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897229">parent</a><span>|</span><a href="#39897922">prev</a><span>|</span><a href="#39897110">next</a><span>|</span><label class="collapse" for="c-39897292">[-]</label><label class="expand" for="c-39897292">[1 more]</label></div><br/><div class="children"><div class="content">Ooo, that&#x27;s a fun idea</div><br/></div></div></div></div><div id="39897110" class="c"><input type="checkbox" id="c-39897110" checked=""/><div class="controls bullet"><span class="by">jolmg</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897082">parent</a><span>|</span><a href="#39897229">prev</a><span>|</span><a href="#39897450">next</a><span>|</span><label class="collapse" for="c-39897110">[-]</label><label class="expand" for="c-39897110">[5 more]</label></div><br/><div class="children"><div class="content">Not if you set it up such that each knocking sequence can only be used once. Port knocking is a flexible concept.</div><br/><div id="39897155" class="c"><input type="checkbox" id="c-39897155" checked=""/><div class="controls bullet"><span class="by">squigz</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897110">parent</a><span>|</span><a href="#39897450">next</a><span>|</span><label class="collapse" for="c-39897155">[-]</label><label class="expand" for="c-39897155">[4 more]</label></div><br/><div class="children"><div class="content">I wonder if one could combine port knocking and TOTP in some way, so the sequence is determined by the TOTP?<p>(Security is not my thing; don&#x27;t judge me!)</div><br/><div id="39897237" class="c"><input type="checkbox" id="c-39897237" checked=""/><div class="controls bullet"><span class="by">noman-land</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897155">parent</a><span>|</span><a href="#39897788">next</a><span>|</span><label class="collapse" for="c-39897237">[-]</label><label class="expand" for="c-39897237">[1 more]</label></div><br/><div class="children"><div class="content">Was just having the same thought reading this thread.</div><br/></div></div><div id="39897788" class="c"><input type="checkbox" id="c-39897788" checked=""/><div class="controls bullet"><span class="by">ametrau</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897155">parent</a><span>|</span><a href="#39897237">prev</a><span>|</span><a href="#39897450">next</a><span>|</span><label class="collapse" for="c-39897788">[-]</label><label class="expand" for="c-39897788">[2 more]</label></div><br/><div class="children"><div class="content">Yeah you could but wouldn’t it defeat the purpose of being basically a secret knock before you can give the password? The password should be the ssh password.</div><br/><div id="39897998" class="c"><input type="checkbox" id="c-39897998" checked=""/><div class="controls bullet"><span class="by">cesnja</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897788">parent</a><span>|</span><a href="#39897450">next</a><span>|</span><label class="collapse" for="c-39897998">[-]</label><label class="expand" for="c-39897998">[1 more]</label></div><br/><div class="children"><div class="content">This would be just to allow you to connect to the server. If there was a vulnerable sshd on port 22, an adversary would have to know the port knocking sequence to connect to sshd and run the exploit.</div><br/></div></div></div></div></div></div></div></div><div id="39897450" class="c"><input type="checkbox" id="c-39897450" checked=""/><div class="controls bullet"><span class="by">vikarti</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897082">parent</a><span>|</span><a href="#39897110">prev</a><span>|</span><a href="#39897169">next</a><span>|</span><label class="collapse" for="c-39897450">[-]</label><label class="expand" for="c-39897450">[1 more]</label></div><br/><div class="children"><div class="content">This looks related to some other problem:
- There is Alice&#x27;s server which provide service X
- There are clients like Bob who needs this service.
- There is Mallory who thinks clients doesn&#x27;t need such service. Mallory have significant resources (more than Alice or Bob).
- Mallory thinks it&#x27;s ok to block access to Alice&#x27; server IF it&#x27;s known that it&#x27;s Alice&#x27;s server and not some random site. Mallory sometimes also thinks it&#x27;s ok to block if protocol is unknown.<p>This problem solved by XRay in all of it&#x27;s versions. It could be possible (if overkill) to use mostly same methods to authenticate correct user and provide eir access.</div><br/></div></div></div></div></div></div><div id="39897169" class="c"><input type="checkbox" id="c-39897169" checked=""/><div class="controls bullet"><span class="by">mlyle</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39896782">prev</a><span>|</span><a href="#39896780">next</a><span>|</span><label class="collapse" for="c-39897169">[-]</label><label class="expand" for="c-39897169">[12 more]</label></div><br/><div class="children"><div class="content">&gt; The thing about port knocking is that if you&#x27;re on a host where you don&#x27;t have the ability to port-knock, then you&#x27;re not able to connect.<p>You can type <a href="http:&#x2F;&#x2F;hostname:porttoknock" rel="nofollow">http:&#x2F;&#x2F;hostname:porttoknock</a> in a browser.<p>As long as you&#x27;re not behind a super restrictive gateway that doesn&#x27;t let you connect to arbitrary ports, you&#x27;re golden.</div><br/><div id="39897364" class="c"><input type="checkbox" id="c-39897364" checked=""/><div class="controls bullet"><span class="by">Dwedit</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39897403">next</a><span>|</span><label class="collapse" for="c-39897364">[-]</label><label class="expand" for="c-39897364">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve actually been behind a firewall that blocked outgoing connections except on several well-known ports.  Had to run my SSH server over the port usually used for HTTPS just to get it unblocked.</div><br/></div></div><div id="39897403" class="c"><input type="checkbox" id="c-39897403" checked=""/><div class="controls bullet"><span class="by">AlexCoventry</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39897364">prev</a><span>|</span><a href="#39899772">next</a><span>|</span><label class="collapse" for="c-39897403">[-]</label><label class="expand" for="c-39897403">[1 more]</label></div><br/><div class="children"><div class="content">Some versions of port knocking require a specific type of packet.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock">https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock</a></div><br/></div></div><div id="39899772" class="c"><input type="checkbox" id="c-39899772" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39897403">prev</a><span>|</span><a href="#39897226">next</a><span>|</span><label class="collapse" for="c-39899772">[-]</label><label class="expand" for="c-39899772">[2 more]</label></div><br/><div class="children"><div class="content">Likely won&#x27;t be enough if you&#x27;re behind CGNAT and you get a different public IP on different connections.</div><br/><div id="39901324" class="c"><input type="checkbox" id="c-39901324" checked=""/><div class="controls bullet"><span class="by">mlyle</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39899772">parent</a><span>|</span><a href="#39897226">next</a><span>|</span><label class="collapse" for="c-39901324">[-]</label><label class="expand" for="c-39901324">[1 more]</label></div><br/><div class="children"><div class="content">Most decent CGNAT will give you the same source IP when you connect to the same dest IP repeatedly.</div><br/></div></div></div></div><div id="39897226" class="c"><input type="checkbox" id="c-39897226" checked=""/><div class="controls bullet"><span class="by">bee_rider</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39899772">prev</a><span>|</span><a href="#39897228">next</a><span>|</span><label class="collapse" for="c-39897226">[-]</label><label class="expand" for="c-39897226">[1 more]</label></div><br/><div class="children"><div class="content">It seems like there’d be a pretty big overlap between those kinds of hosts.</div><br/></div></div><div id="39897228" class="c"><input type="checkbox" id="c-39897228" checked=""/><div class="controls bullet"><span class="by">noman-land</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39897226">prev</a><span>|</span><a href="#39897205">next</a><span>|</span><label class="collapse" for="c-39897228">[-]</label><label class="expand" for="c-39897228">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a bit of a noob about this. Can you explain what this means?</div><br/><div id="39897341" class="c"><input type="checkbox" id="c-39897341" checked=""/><div class="controls bullet"><span class="by">shanemhansen</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897228">parent</a><span>|</span><a href="#39897205">next</a><span>|</span><label class="collapse" for="c-39897341">[-]</label><label class="expand" for="c-39897341">[2 more]</label></div><br/><div class="children"><div class="content">Port knocking involves sending a packet to certain ports on a host. It&#x27;s overkill but typing <a href="http:&#x2F;&#x2F;host:port&#x2F;" rel="nofollow">http:&#x2F;&#x2F;host:port&#x2F;</a> in your browser will, as part of trying to make a TCP connection, send a packet to that port.</div><br/><div id="39897920" class="c"><input type="checkbox" id="c-39897920" checked=""/><div class="controls bullet"><span class="by">noman-land</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897341">parent</a><span>|</span><a href="#39897205">next</a><span>|</span><label class="collapse" for="c-39897920">[-]</label><label class="expand" for="c-39897920">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, I didn&#x27;t realize port knocking could be done manually like this as a way to &quot;unlock&quot; an eventual regular ssh attempt outside the browser. This makes sense now and is super clever!</div><br/></div></div></div></div></div></div><div id="39897205" class="c"><input type="checkbox" id="c-39897205" checked=""/><div class="controls bullet"><span class="by">webmaven</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897169">parent</a><span>|</span><a href="#39897228">prev</a><span>|</span><a href="#39896780">next</a><span>|</span><label class="collapse" for="c-39897205">[-]</label><label class="expand" for="c-39897205">[3 more]</label></div><br/><div class="children"><div class="content">TIL another interesting browser feature. Thank you.</div><br/><div id="39897381" class="c"><input type="checkbox" id="c-39897381" checked=""/><div class="controls bullet"><span class="by">Dwedit</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897205">parent</a><span>|</span><a href="#39896780">next</a><span>|</span><label class="collapse" for="c-39897381">[-]</label><label class="expand" for="c-39897381">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s just the usual way of attempting to connect to an HTTP server running on a different port.  Sometimes you see websites hosted on port 8080 or something like that.</div><br/><div id="39897526" class="c"><input type="checkbox" id="c-39897526" checked=""/><div class="controls bullet"><span class="by">webmaven</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897381">parent</a><span>|</span><a href="#39896780">next</a><span>|</span><label class="collapse" for="c-39897526">[-]</label><label class="expand" for="c-39897526">[1 more]</label></div><br/><div class="children"><div class="content">Oh. Duh.<p>I suppose I should have said it was a new-to-me use case for that feature.</div><br/></div></div></div></div></div></div></div></div><div id="39896780" class="c"><input type="checkbox" id="c-39896780" checked=""/><div class="controls bullet"><span class="by">dec0dedab0de</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39897169">prev</a><span>|</span><a href="#39898228">next</a><span>|</span><label class="collapse" for="c-39896780">[-]</label><label class="expand" for="c-39896780">[1 more]</label></div><br/><div class="children"><div class="content">Absolutely, everything in security is a tradeoff. I guess the real point is that there should be layers, and even though you should never rely on security through obscurity,  you should still probably have a bit of obscurity in the mix.</div><br/></div></div><div id="39898228" class="c"><input type="checkbox" id="c-39898228" checked=""/><div class="controls bullet"><span class="by">GabeIsko</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39896780">prev</a><span>|</span><a href="#39896818">next</a><span>|</span><label class="collapse" for="c-39898228">[-]</label><label class="expand" for="c-39898228">[3 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t really consider port knocking to be that effective of a way to block connections. It is really only obscure, but port knocking software is very accessible. So if you know a port needs to be knocked, it&#x27;s not hard for an attacker to get to it.<p>The main benefit of port knocking is that it allows you to present your ports as normally closed. If you have a system and you are worried about it getting port scanned for whatever reason, it makes sense to have a scheme where the ports are closed unless it receives a knock. So if someone gets access they shouldn&#x27;t for whatever reason and pulls a portscan off, the information they get about your system is somewhat limited.<p>In this scheme, it would be much better to have an access point you authenticate with and then that handles the port knocking for the other devices. So it is a kind of obscure method that is really only useful in a specific use case.<p>As far as SSH keys go, I would argue that SSH support is so ubiquitous, and SSH access is so powerful that it is a reasonable security tradeoff. I also don&#x27;t think that SSH ports should be exposed to the internet, unless it is a specific use case where that is the whole point, like GitHub. I&#x27;m very down on connecting directly through SSH without network access. The xz situation has validated this opinion.<p>I personally don&#x27;t know any application where you really need supreme admin access to every device, from any device, from anywhere in the world, while at the same time it has extreme security requirements. That&#x27;s a pretty big task. At that point, constructing a dedicated, hardened access point that faces the internet and grants access to other devices is probably the way to go.</div><br/><div id="39898444" class="c"><input type="checkbox" id="c-39898444" checked=""/><div class="controls bullet"><span class="by">delusional</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898228">parent</a><span>|</span><a href="#39896818">next</a><span>|</span><label class="collapse" for="c-39898444">[-]</label><label class="expand" for="c-39898444">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;m very down on connecting directly through SSH without network access. The xz situation has validated this opinion.<p>Did it? At the point an attacker has remote code execution, couldn&#x27;t they just as easily pivot into an outgoing connection to some command and control server? I don&#x27;t see how some intermediary access point would have alleviated this problem. If the call is coming from inside the house, the gig is already up.</div><br/><div id="39898534" class="c"><input type="checkbox" id="c-39898534" checked=""/><div class="controls bullet"><span class="by">deepbreath</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898444">parent</a><span>|</span><a href="#39896818">next</a><span>|</span><label class="collapse" for="c-39898534">[-]</label><label class="expand" for="c-39898534">[1 more]</label></div><br/><div class="children"><div class="content">&gt; At the point an attacker has remote code execution<p>The attacker doesn&#x27;t have remote code execution in the xz case unless they can speak to your port 22. Port knocking prevents them from doing so, provided they don&#x27;t know how to knock.</div><br/></div></div></div></div></div></div><div id="39896818" class="c"><input type="checkbox" id="c-39896818" checked=""/><div class="controls bullet"><span class="by">nottorp</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39898228">prev</a><span>|</span><a href="#39898081">next</a><span>|</span><label class="collapse" for="c-39896818">[-]</label><label class="expand" for="c-39896818">[2 more]</label></div><br/><div class="children"><div class="content">You just described the problem with using keys for any login, like the latest fad is?<p>And generally with depending on a device (phone, xxxkey or whatever) for access.</div><br/><div id="39897406" class="c"><input type="checkbox" id="c-39897406" checked=""/><div class="controls bullet"><span class="by">Dwedit</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896818">parent</a><span>|</span><a href="#39898081">next</a><span>|</span><label class="collapse" for="c-39897406">[-]</label><label class="expand" for="c-39897406">[1 more]</label></div><br/><div class="children"><div class="content">At least TOTP is just a long, random, server-assigned password, where you you don&#x27;t type the whole thing into during login attempts.<p>You can write down the full TOTP secret, and make new &#x27;TOTP keys&#x27; whenever you want.  Suggested apps: Firefox Extension named &quot;TOTP&quot;, and Android App named &quot;Secur&quot;.  You don&#x27;t need the heavier apps that want you to create accounts with their company.<p>Using a TOTP key only provides a little more protection than any other complex password, since you&#x27;re not typing in the whole thing during a login attempt.</div><br/></div></div></div></div><div id="39898081" class="c"><input type="checkbox" id="c-39898081" checked=""/><div class="controls bullet"><span class="by">godman_8</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39896818">prev</a><span>|</span><a href="#39897025">next</a><span>|</span><label class="collapse" for="c-39898081">[-]</label><label class="expand" for="c-39898081">[2 more]</label></div><br/><div class="children"><div class="content">My solution to this has been creating a public bastion server and use Wireguard. Wireguard listens on a random UDP port (port knocking is more difficult here.) This client is set up to have a dynamic endpoint so I don&#x27;t need to worry about whitelisting. The key and port information are stored in a password manager like Vaultwarden with the appropriate documentation to connect. Firewall rules are set to reject on all other ports and it doesn&#x27;t respond to ICMP packets either. A lot of that is security through obscurity but I found this to be a good balance of security and practicality.</div><br/><div id="39898562" class="c"><input type="checkbox" id="c-39898562" checked=""/><div class="controls bullet"><span class="by">trelane</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898081">parent</a><span>|</span><a href="#39897025">next</a><span>|</span><label class="collapse" for="c-39898562">[-]</label><label class="expand" for="c-39898562">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve seen this discussed a fair bit, and always the recommendation is to use wire guard and expose ssh only to the &quot;local network&quot; e.g. <a href="https:&#x2F;&#x2F;bugs.gentoo.org&#x2F;928134#c38" rel="nofollow">https:&#x2F;&#x2F;bugs.gentoo.org&#x2F;928134#c38</a><p>First, I don&#x27;t see how this works where there&#x27;s a single server (e.g. colocation).<p>Second, doesn&#x27;t that just make Wireguard the new hack target? How does this actually mitigate the risk?</div><br/></div></div></div></div><div id="39897025" class="c"><input type="checkbox" id="c-39897025" checked=""/><div class="controls bullet"><span class="by">tamimio</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39898081">prev</a><span>|</span><a href="#39897577">next</a><span>|</span><label class="collapse" for="c-39897025">[-]</label><label class="expand" for="c-39897025">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The thing about port knocking is that if you&#x27;re on a host where you don&#x27;t have the ability to port-knock, then you&#x27;re not able to connect.<p>Then you attach a device that can have port knocking to that unsupported host. Also, I remember it was called port punching not knocking.</div><br/></div></div><div id="39897577" class="c"><input type="checkbox" id="c-39897577" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39897025">prev</a><span>|</span><a href="#39896693">next</a><span>|</span><label class="collapse" for="c-39897577">[-]</label><label class="expand" for="c-39897577">[1 more]</label></div><br/><div class="children"><div class="content">You can as well find yourself on a host that doesn&#x27;t have SSH or network that filters SSH traffic for security reasons.</div><br/></div></div><div id="39896693" class="c"><input type="checkbox" id="c-39896693" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39897577">prev</a><span>|</span><a href="#39896636">next</a><span>|</span><label class="collapse" for="c-39896693">[-]</label><label class="expand" for="c-39896693">[5 more]</label></div><br/><div class="children"><div class="content">Port knocking with ssh over https using client certs.<p>And port knocking is one of the few effective methods against the standard distributed brute forcing slow attacks.<p>Note if you blanket-ban IN&#x2F;RU&#x2F;UK&#x2F;CN&#x2F;HK&#x2F;TW&#x2F;IR&#x2F;MX&#x2F;BZ&#x2F;BA + tor&#x2F;proxies lists, than 99.998% of your nuisance traffic issues disappear overnight. =)</div><br/><div id="39897473" class="c"><input type="checkbox" id="c-39897473" checked=""/><div class="controls bullet"><span class="by">oarsinsync</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896693">parent</a><span>|</span><a href="#39896781">next</a><span>|</span><label class="collapse" for="c-39897473">[-]</label><label class="expand" for="c-39897473">[2 more]</label></div><br/><div class="children"><div class="content">&gt; if you blanket-ban IN&#x2F;RU&#x2F;UK&#x2F;CN&#x2F;HK&#x2F;TW&#x2F;IR&#x2F;MX&#x2F;BZ&#x2F;BA<p>The list of countries there: India, Russia, United Kingdom, China, Hong Kong, Taiwan, Iran, Mexico, Belize, Bosnia and Herzegovina<p>I’m amused that the UK is in that group.</div><br/><div id="39897572" class="c"><input type="checkbox" id="c-39897572" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897473">parent</a><span>|</span><a href="#39896781">next</a><span>|</span><label class="collapse" for="c-39897572">[-]</label><label class="expand" for="c-39897572">[1 more]</label></div><br/><div class="children"><div class="content">I was too, but the past few years their government server blocks have been pen-testing servers without authorization.<p>It is apparently a free service they offer people even when told to get stuffed.<p>=)<p>My spastic ban-hammer active-response list i.e. the entire  block gets temporarily black-holed with a single violation: 
AU
BG
BR
BZ
CN
ES
EE
FR
GB
HR
IL
IN
ID
IR
IQ
JP
KG
KR
KP
KW
LV
MM
MX
NI
NL
PA
PE
PK
PL
RO
RU
RS
SE
SG
TW
TH
TR
YE
VN
UA
ZA
ZZ</div><br/></div></div></div></div><div id="39896781" class="c"><input type="checkbox" id="c-39896781" checked=""/><div class="controls bullet"><span class="by">deknos</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896693">parent</a><span>|</span><a href="#39897473">prev</a><span>|</span><a href="#39896636">next</a><span>|</span><label class="collapse" for="c-39896781">[-]</label><label class="expand" for="c-39896781">[2 more]</label></div><br/><div class="children"><div class="content">can you give an example for an implementation of portnocking&#x2F;ssh&#x2F;over https and client certs?</div><br/><div id="39897168" class="c"><input type="checkbox" id="c-39897168" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896781">parent</a><span>|</span><a href="#39896636">next</a><span>|</span><label class="collapse" for="c-39897168">[-]</label><label class="expand" for="c-39897168">[1 more]</label></div><br/><div class="children"><div class="content">In general, it is a standard shore-wall firewall rule in perl, and the standard ssh protocol wrapper mod.<p>These are very well documented tricks, and when combined with a standard port 22 and interleaved knock ports tripwire 5 day ban rules... are quite effective against scanners too.<p>I am currently on the clock, so can&#x27;t write up a detailed tutorial right now.<p>Best regards, =)</div><br/></div></div></div></div></div></div><div id="39896636" class="c"><input type="checkbox" id="c-39896636" checked=""/><div class="controls bullet"><span class="by">pajko</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896606">parent</a><span>|</span><a href="#39896693">prev</a><span>|</span><a href="#39898061">next</a><span>|</span><label class="collapse" for="c-39896636">[-]</label><label class="expand" for="c-39896636">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;CERN-CERT&#x2F;pam_2fa">https:&#x2F;&#x2F;github.com&#x2F;CERN-CERT&#x2F;pam_2fa</a></div><br/><div id="39898281" class="c"><input type="checkbox" id="c-39898281" checked=""/><div class="controls bullet"><span class="by">nequo</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896636">parent</a><span>|</span><a href="#39896648">next</a><span>|</span><label class="collapse" for="c-39898281">[-]</label><label class="expand" for="c-39898281">[1 more]</label></div><br/><div class="children"><div class="content">This is great but would this neutralize the xz backdoor? The backdoor circumvents authentication, doesn&#x27;t it?</div><br/></div></div><div id="39896648" class="c"><input type="checkbox" id="c-39896648" checked=""/><div class="controls bullet"><span class="by">herpderperator</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39896636">parent</a><span>|</span><a href="#39898281">prev</a><span>|</span><a href="#39898061">next</a><span>|</span><label class="collapse" for="c-39896648">[-]</label><label class="expand" for="c-39896648">[1 more]</label></div><br/><div class="children"><div class="content">What does this have to do with port knocking?</div><br/></div></div></div></div></div></div><div id="39898061" class="c"><input type="checkbox" id="c-39898061" checked=""/><div class="controls bullet"><span class="by">teddyh</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39896606">prev</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898061">[-]</label><label class="expand" for="c-39898061">[13 more]</label></div><br/><div class="children"><div class="content">Port knocking is stupid.  It violates Kerckhoffs’s principle¹. If you want more secret bits which users need to know in order to access your system, increase your password lengths, or cryptographic key sizes.  If you want to keep log sizes manageable, adjust your logging levels.<p>The security of port knocking is also woefully inadequate:<p>• It adds <i>very little</i> security. How many bits are in a “secret knock”?<p>• The security it <i>does</i> add is <i>bad</i>: It’s sent in cleartext, and easily brute-forced.<p>• It complicates access, since it’s non-standard.<p>1. &lt;<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;w&#x2F;index.php?title=Kerckhoffs%27s_principle&amp;oldid=1214547066" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;w&#x2F;index.php?title=Kerckhoffs%27s_pr...</a>&gt;</div><br/><div id="39898139" class="c"><input type="checkbox" id="c-39898139" checked=""/><div class="controls bullet"><span class="by">reaperman</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898061">parent</a><span>|</span><a href="#39898127">next</a><span>|</span><label class="collapse" for="c-39898139">[-]</label><label class="expand" for="c-39898139">[3 more]</label></div><br/><div class="children"><div class="content">Security-by-obscurity is dumb, yes. But in the context of supply-chain exploits in the theme of this xz backdoor, this statement is also myopic:<p>&gt; <i>If you want more secret bits which users need to know in order to access your system, increase your password lengths, or cryptographic key sizes.</i><p>If your <i>sshd</i> (or <i>any other</i> exposed service) is backdoored, then the &quot;effective bits&quot; of any cryptographic key size is reduced to nil. You personally cannot know whether or not your exposed service is backdoored.<p>Bottom-line is: adding a defense-in-depth like port knocking is unlikely to cause harm <i>unless</i> you use it as justification for not following best-practices in the rest of your security posture.</div><br/><div id="39898334" class="c"><input type="checkbox" id="c-39898334" checked=""/><div class="controls bullet"><span class="by">belorn</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898139">parent</a><span>|</span><a href="#39898127">next</a><span>|</span><label class="collapse" for="c-39898334">[-]</label><label class="expand" for="c-39898334">[2 more]</label></div><br/><div class="children"><div class="content">Chaining multiple different login system can make sense. A more sensible solution over port knocking would be an alternative sshd implementation with a tunnel to the second sshd implementation. Naturally the first one should not run as root (similar to the port knocking daemon).<p>That way it would not be in clear text, and the number of bits of security will be order of magnitude larger even with very simple password. The public facing sshd can also run more lightweight algorithms and disable loggings for lower resource usage.<p>Regardless if one uses two sshd or port knocking software, the public facing daemon can have backdoors and security bugs. If we want to avoid Xz-like problems then this first layer need to be significant hardened (With SELinux as one solution). Their only capability should be to open the second layer.</div><br/><div id="39901489" class="c"><input type="checkbox" id="c-39901489" checked=""/><div class="controls bullet"><span class="by">ufo</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898334">parent</a><span>|</span><a href="#39898127">next</a><span>|</span><label class="collapse" for="c-39901489">[-]</label><label class="expand" for="c-39901489">[1 more]</label></div><br/><div class="children"><div class="content">Chaining login methods would not help if the outermost login method is backdoored with an RCE.</div><br/></div></div></div></div></div></div><div id="39898127" class="c"><input type="checkbox" id="c-39898127" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898061">parent</a><span>|</span><a href="#39898139">prev</a><span>|</span><a href="#39898536">next</a><span>|</span><label class="collapse" for="c-39898127">[-]</label><label class="expand" for="c-39898127">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think I agree.  This backdoor means that it doesn&#x27;t matter how long your key lengths or cryptographic key sizes are; that&#x27;s kinda the point of a backdoor.  But an automated attempt to find servers to exploit is not going to attempt something like port knocking, or likely even looking for a sshd on a non-standard port.<p>Kerckhoff&#x27;s law goes (from your link):<p>&gt; <i>The principle holds that a cryptosystem should be secure, even if everything about the system, except the key, is public knowledge.</i><p>With this backdoor, that principle does not hold; it&#x27;s utterly irrelevant.  Obscuring the fact that there even is a ssh server to exploit increases safety.<p>(I dislike port knocking because of your third point, that it complicates access.  But I don&#x27;t think your assertions about its security principles hold water, at least not in this case.)<p>(Ultimately, though, instead of something like port knocking or even running sshd on a non-standard port, if I wanted to protect against attacks like these, I would just keep sshd on a private network only accessible via a VPN.)</div><br/><div id="39898368" class="c"><input type="checkbox" id="c-39898368" checked=""/><div class="controls bullet"><span class="by">teddyh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898127">parent</a><span>|</span><a href="#39898536">next</a><span>|</span><label class="collapse" for="c-39898368">[-]</label><label class="expand" for="c-39898368">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>This backdoor means that it doesn&#x27;t matter how long your key lengths or cryptographic key sizes are; that&#x27;s kinda the point of a backdoor.</i><p>If we’re talkning about this specific backdoor, consider this:  If the attacker had successfully identified a target SSH server they could reasonably assume had the backdoor, would they be completely halted by a port knocker?  No, they would brute-force it easily.<p>Port knocking is very bad security.<p>(It’s “Kerckhoffs’s &lt;law&#x2F;principle&#x2F;etc.&gt;”, by the way.)</div><br/></div></div></div></div><div id="39898536" class="c"><input type="checkbox" id="c-39898536" checked=""/><div class="controls bullet"><span class="by">e_y_</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898061">parent</a><span>|</span><a href="#39898127">prev</a><span>|</span><a href="#39898125">next</a><span>|</span><label class="collapse" for="c-39898536">[-]</label><label class="expand" for="c-39898536">[1 more]</label></div><br/><div class="children"><div class="content">Security through obscurity is only a problem if obscurity is the <i>main</i> defense mechanism. It&#x27;s perfectly fine as a defense-in-depth. This would only be an issue if someone did something stupid like set up a passwordless rlogin or database server expecting port knocking alone to handle security.<p>Also as pointed out elsewhere, modern port knocking uses Single Packet Authorization which allows for more bits. It&#x27;s also <i>simpler</i> and uses a <i>different</i> mechanism than ssh (which due to its age, has historically supported a bunch of different login and cryptography techniques), which reduces the chance that an attacker would be able to break both.</div><br/></div></div><div id="39898125" class="c"><input type="checkbox" id="c-39898125" checked=""/><div class="controls bullet"><span class="by">VWWHFSfQ</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898061">parent</a><span>|</span><a href="#39898536">prev</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898125">[-]</label><label class="expand" for="c-39898125">[6 more]</label></div><br/><div class="children"><div class="content">Port knocking is definitely dumb, but &quot;increase your password lengths, or cryptographic key sizes&quot; does nothing if your ssh binary is compromised and anyone can send a magic packet to let themselves in.<p>Strict firewalls, VPNs, and defense-in-depth is really the only answer here.<p>Of course, those things all go out the window too if your TCP stack itself is also compromised.  Better to just air-gap.</div><br/><div id="39898251" class="c"><input type="checkbox" id="c-39898251" checked=""/><div class="controls bullet"><span class="by">teddyh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898125">parent</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898251">[-]</label><label class="expand" for="c-39898251">[5 more]</label></div><br/><div class="children"><div class="content">Many people argue that a VPN+SSH is a reasonable solution, since it uses two separate implementations, where both are unlikely to be compromised at the same time.  I would argue that the more reasonable option would be to split the SSH project in two; both of which validates the credentials of an incoming connection.  This would be the same as a VPN+SSH but would not convolute the network topography, and would eliminate the need for two keys to be used by every connecting user.<p><i>However</i>, in this case, the two-layer approach would not be a protection.  Sure, in this case the SSH daemon was compromised, and a VPN before SSH would have protected SSH.  But what if the VPN server itself was compromised?  Remember that the SSH server was altered, not to allow normal logins, but to call system() directly.  What if a VPN server had been similarly altered?  This would not have protected SSH, since a direct system() call by the VPN daemon would have ignored SSH completely.<p>It is a mistake to look at this case and assume that since SSH was compromised this time, SSH must always be protected by another layer.  That other layer might be the next thing to be compromised.</div><br/><div id="39898739" class="c"><input type="checkbox" id="c-39898739" checked=""/><div class="controls bullet"><span class="by">mikeocool</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898251">parent</a><span>|</span><a href="#39898392">next</a><span>|</span><label class="collapse" for="c-39898739">[-]</label><label class="expand" for="c-39898739">[1 more]</label></div><br/><div class="children"><div class="content">Best practice would have your internet exposed daemon (vpn or ssh) running a fairly locked down box that doesn’t also have your valuable “stuff” (whatever that is) on it.<p>So if someone cracks that box, their access is limited, and they still need to make a lateral move to access actual data.<p>In the case of this backdoor, if you have SSH exposed to the internet on a locked down jump box, AND use it as your internal mechanism for accessing your valuable boxes, you are owned, since the attacker can access your jump box and then immediately use the same vulnerability to move to an internal box.<p>In the case of a hypothetical VPN daemon vulnerability, they can use that to crack your jump box, but then still need another vulnerability to move beyond that. Not great, but a lot better than being fully owned.<p>You could certainly also accomplish a similar topology with two different SSH implementations.</div><br/></div></div><div id="39898392" class="c"><input type="checkbox" id="c-39898392" checked=""/><div class="controls bullet"><span class="by">PhilipRoman</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898251">parent</a><span>|</span><a href="#39898739">prev</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898392">[-]</label><label class="expand" for="c-39898392">[3 more]</label></div><br/><div class="children"><div class="content">&gt;This would not have protected SSH, since a direct system() call by the VPN daemon would have ignored SSH completely.<p>I don&#x27;t know how VPNs are implemented on Linux, but in principle it should be possible to sandbox a VPN server to the point where it can only make connections but nothing else. If capabilities are not enough, ebpf should be able to contain it. I suspect it will have full control over networking but that&#x27;s still very different from arbitrary code execution.</div><br/><div id="39898466" class="c"><input type="checkbox" id="c-39898466" checked=""/><div class="controls bullet"><span class="by">teddyh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898392">parent</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898466">[-]</label><label class="expand" for="c-39898466">[2 more]</label></div><br/><div class="children"><div class="content">That would be possible, yes, but it’s not the current situation.  And since we can choose how we proceed, I would prefer my proposal, i.e. that the SSH daemon be split into two separate projects, one daemon handling the initial connection, locked-down like you describe, then handing off the authenticated connection to the second, “inner”, SSH daemon, which <i>also does the authentication</i>, using the same credentials as submitted by the connecting user.  This way, the connecting user only has to have one key, and the network topology does not become unduly twisted.</div><br/><div id="39898537" class="c"><input type="checkbox" id="c-39898537" checked=""/><div class="controls bullet"><span class="by">PhilipRoman</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898466">parent</a><span>|</span><a href="#39897086">next</a><span>|</span><label class="collapse" for="c-39898537">[-]</label><label class="expand" for="c-39898537">[1 more]</label></div><br/><div class="children"><div class="content">Huh, I briefly looked at the documentation for UsePrivilegeSeparation option and it looks very similar to what you&#x27;re describing. Interesting why it didn&#x27;t prevent this attack.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="39897086" class="c"><input type="checkbox" id="c-39897086" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39898061">prev</a><span>|</span><a href="#39897376">next</a><span>|</span><label class="collapse" for="c-39897086">[-]</label><label class="expand" for="c-39897086">[13 more]</label></div><br/><div class="children"><div class="content">&gt; Stuff like this is why I like port knocking, and limiting access to specific client IPs&#x2F;networks when possible.<p>Indeed: I whitelist hosts&#x2F;IP blocks allowed to SSH in. I don&#x27;t use port-knocking but I never ever <i>criticized</i> those using port knocking.<p>I do really wonder if people are still going to say that port knocking is pointless and security theatre: we now have a clear example where people who were using port-knocking were protected while those who didn&#x27;t were potentially wide open to the biggest backdoor discovered to date (even if it&#x27;s wasn&#x27;t yet in all the major distros).<p>&gt; ...  does the entire internet really need to be able to SSH to your box?<p>Nope and I never ever understood the argument saying: <i>&quot;Port-knocking is security theatre, it doesn&#x27;t bring any added security&quot;</i>.<p>To me port-knocking didn&#x27;t <i>lower</i> the security of a system.<p>It seems that we now have a clear proof that it&#x27;s actually helping versus certain type of attacks (including source-code supply chain attacks).</div><br/><div id="39897571" class="c"><input type="checkbox" id="c-39897571" checked=""/><div class="controls bullet"><span class="by">bpfrh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897086">parent</a><span>|</span><a href="#39898275">next</a><span>|</span><label class="collapse" for="c-39897571">[-]</label><label class="expand" for="c-39897571">[7 more]</label></div><br/><div class="children"><div class="content">&gt;It seems that we now have a clear proof that it&#x27;s actually helping versus certain type of attacks (including source-code supply chain attacks).<p>So would have a vpn or using a bastion host with a custom non standard ssh implementation...<p>At some point you have to make the choice to not implement a security measure and I would argue that should stop at vpn+standard software for secure access.<p>If you are a bigger company, probably add SSO and network segmentation with bastion hosts and good logging.<p>Port Knocking doesn&#x27;t add any security benefit in the sense that there are known non avoidable security risk aka your transmit your password(knocking) in clear text over the network.<p>You also add another program with potential vulnerabilities, and as port knocking is not as popular as e.g. sshd, wireguard, maybe it gets less scrutiny and it leads to a supply chain attack?<p>Security measures are also not free in the sense that somebody has to distribute them and keep the configuration up to date, even if that person is you, that means syncing that connect-to-server-script and keeping it in a secure location on your devices.</div><br/><div id="39897634" class="c"><input type="checkbox" id="c-39897634" checked=""/><div class="controls bullet"><span class="by">tredre3</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897571">parent</a><span>|</span><a href="#39898338">next</a><span>|</span><label class="collapse" for="c-39897634">[-]</label><label class="expand" for="c-39897634">[4 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    You also add another program with potential vulnerabilities, and as port knocking is not as popular as e.g. sshd, wireguard, maybe it gets less scrutiny and it leads to a supply chain attack?
</code></pre>
That other program is just a stateful firewall, aka the Linux Kernel itself. If you can&#x27;t trust your kernel then nothing you do matters.</div><br/><div id="39897728" class="c"><input type="checkbox" id="c-39897728" checked=""/><div class="controls bullet"><span class="by">bpfrh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897634">parent</a><span>|</span><a href="#39898338">next</a><span>|</span><label class="collapse" for="c-39897728">[-]</label><label class="expand" for="c-39897728">[3 more]</label></div><br/><div class="children"><div class="content">That other programm is knockd, which needs to listen to all traffic and look for the specified packets.<p>Granted, that program is really small and could be easily audited, but that same time could have been spent on trying apparmor&#x2F;seclinux + a good vpn and 2fa</div><br/><div id="39898293" class="c"><input type="checkbox" id="c-39898293" checked=""/><div class="controls bullet"><span class="by">rhaps0dy</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897728">parent</a><span>|</span><a href="#39898338">next</a><span>|</span><label class="collapse" for="c-39898293">[-]</label><label class="expand" for="c-39898293">[2 more]</label></div><br/><div class="children"><div class="content">I much prefer the approach I read about in <a href="https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock">https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock</a> (use a safe language, trust basically only the program you write and the language), to a random port daemon written in C which pulls libpcap to sniff everything.<p>To some extent knockknock also trusts the Python interpreter which is not ideal (but maybe OK)</div><br/><div id="39899899" class="c"><input type="checkbox" id="c-39899899" checked=""/><div class="controls bullet"><span class="by">Aloisius</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898293">parent</a><span>|</span><a href="#39898338">next</a><span>|</span><label class="collapse" for="c-39899899">[-]</label><label class="expand" for="c-39899899">[1 more]</label></div><br/><div class="children"><div class="content">In Linux, simple knocking (fixed sequences of ports) can be done entirely in the kernel with nftables rules. Probably could even have different knock ports based on day of the week or hour or source IP.<p><a href="https:&#x2F;&#x2F;wiki.nftables.org&#x2F;wiki-nftables&#x2F;index.php&#x2F;Port_knocking_example" rel="nofollow">https:&#x2F;&#x2F;wiki.nftables.org&#x2F;wiki-nftables&#x2F;index.php&#x2F;Port_knock...</a></div><br/></div></div></div></div></div></div></div></div><div id="39898338" class="c"><input type="checkbox" id="c-39898338" checked=""/><div class="controls bullet"><span class="by">marcus0x62</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897571">parent</a><span>|</span><a href="#39897634">prev</a><span>|</span><a href="#39898275">next</a><span>|</span><label class="collapse" for="c-39898338">[-]</label><label class="expand" for="c-39898338">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Port Knocking doesn&#x27;t add any security benefit in the sense that there are known non avoidable security risk aka your transmit your password(knocking) in clear text over the network.<p>This take is bordering on not even wrong territory.  The point of port knocking isn&#x27;t to increase entropy of your password or authentication keys per se, it is to control who can send packets to your SSH daemon, either to limit the noise in your logs or to mitigate an RCE in the SSH daemon.  The vast majority of potential attackers in the real world are off-path and aren&#x27;t going to be in a position to observe someone&#x27;s port-knocking sequence.<p>Is VPN a better solution?  Maybe, but VPNs, especially commercial VPNs have their own set of challenges with regard to auditability and attack surface.</div><br/><div id="39898551" class="c"><input type="checkbox" id="c-39898551" checked=""/><div class="controls bullet"><span class="by">bpfrh</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39898338">parent</a><span>|</span><a href="#39898275">next</a><span>|</span><label class="collapse" for="c-39898551">[-]</label><label class="expand" for="c-39898551">[1 more]</label></div><br/><div class="children"><div class="content">&gt;This take is bordering on not even wrong territory. The point of port knocking isn&#x27;t to increase entropy of your password or authentication keys per se, it is to control who can send packets to your SSH daemon, either to limit the noise in your logs or to mitigate an RCE in the SSH daemon. The vast majority of potential attackers in the real world are off-path and aren&#x27;t going to be in a position to observe someone&#x27;s port-knocking sequence.<p>If you read my full sentence in the context it stands, I argue that authorizing access to your openssh instance is done by sending an authentication code in cleartext.<p>It does not matter if that authentication code is in the form of bits, tcp pakets, colors or horoscopes as long as your transmit that in clear text it is in fact no a secure mechanism.<p>Yeah but now you basically have to always run an vpn that only exists between your server and your client, because otherwise your clear text authentication code is visible and at that point just use wireguard and make a 1-1 tunnel only for ssh with no known attacks, even if the attacker is in the same network.<p>Yes a vpn that has no known reliably attack vector is definitely better than a protocol with a known working attack vector</div><br/></div></div></div></div></div></div><div id="39898275" class="c"><input type="checkbox" id="c-39898275" checked=""/><div class="controls bullet"><span class="by">nick238</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897086">parent</a><span>|</span><a href="#39897571">prev</a><span>|</span><a href="#39897366">next</a><span>|</span><label class="collapse" for="c-39898275">[-]</label><label class="expand" for="c-39898275">[1 more]</label></div><br/><div class="children"><div class="content">The advantage of port knocking to me is just reducing the amount of garbage script-kiddie scans. IMHO the design of `sshd` needs to just assume it will be slammed by garbage attempts and minimize the logging. I&#x27;ve heard of `fail2ban`, but banning does nothing as the bots have an unlimited number of IPs.</div><br/></div></div><div id="39897366" class="c"><input type="checkbox" id="c-39897366" checked=""/><div class="controls bullet"><span class="by">AlexCoventry</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897086">parent</a><span>|</span><a href="#39898275">prev</a><span>|</span><a href="#39897376">next</a><span>|</span><label class="collapse" for="c-39897366">[-]</label><label class="expand" for="c-39897366">[4 more]</label></div><br/><div class="children"><div class="content">&gt; say that port knocking is pointless and security theatre<p>Who was saying that?</div><br/><div id="39897467" class="c"><input type="checkbox" id="c-39897467" checked=""/><div class="controls bullet"><span class="by">password4321</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897366">parent</a><span>|</span><a href="#39897612">next</a><span>|</span><label class="collapse" for="c-39897467">[-]</label><label class="expand" for="c-39897467">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;hn.algolia.com&#x2F;?query=port%20knocking%20obscurity&amp;type=comment" rel="nofollow">https:&#x2F;&#x2F;hn.algolia.com&#x2F;?query=port%20knocking%20obscurity&amp;ty...</a><p>20200515 <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23187662">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=23187662</a><p>etc.</div><br/><div id="39898091" class="c"><input type="checkbox" id="c-39898091" checked=""/><div class="controls bullet"><span class="by">AlexCoventry</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897467">parent</a><span>|</span><a href="#39897612">next</a><span>|</span><label class="collapse" for="c-39898091">[-]</label><label class="expand" for="c-39898091">[1 more]</label></div><br/><div class="children"><div class="content">Thanks.</div><br/></div></div></div></div><div id="39897612" class="c"><input type="checkbox" id="c-39897612" checked=""/><div class="controls bullet"><span class="by">rdtsc</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897366">parent</a><span>|</span><a href="#39897467">prev</a><span>|</span><a href="#39897376">next</a><span>|</span><label class="collapse" for="c-39897612">[-]</label><label class="expand" for="c-39897612">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve heard it many times in the form of &quot;security through obscurity, lol! you obviously, don&#x27;t know what you&#x27;re doing&quot;.<p>Yeah, it&#x27;s a &quot;straw man&quot; pretending the person they are addressing was just planning on running telnet with port knocking.</div><br/></div></div></div></div></div></div><div id="39897376" class="c"><input type="checkbox" id="c-39897376" checked=""/><div class="controls bullet"><span class="by">k8svet</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897086">prev</a><span>|</span><a href="#39896969">next</a><span>|</span><label class="collapse" for="c-39897376">[-]</label><label class="expand" for="c-39897376">[1 more]</label></div><br/><div class="children"><div class="content">Over the weekend, I added this to a common bit included in all my NixOS systems:<p><pre><code>    -networking.firewall.allowedTCPPorts = [ 22 ];
    +networking.firewall.interfaces.&quot;tailscale0&quot;.allowedTCPPorts = [ 22 ];
</code></pre>
I probably should have done this ages ago.</div><br/></div></div><div id="39896969" class="c"><input type="checkbox" id="c-39896969" checked=""/><div class="controls bullet"><span class="by">nijave</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897376">prev</a><span>|</span><a href="#39897047">next</a><span>|</span><label class="collapse" for="c-39896969">[-]</label><label class="expand" for="c-39896969">[1 more]</label></div><br/><div class="children"><div class="content">Jump host running a different SSH server implementation or SSH over VPN seems a little more reliable.<p>There&#x27;s a lot of solutions now where the host has an agent that reaches out instead of allowing incoming connections which can be useful (assuming you trust that proxy service&#x2F;software).<p>One place I worked, we ran our jumphost on GCP with Identity Aware Proxy and on AWS with SSM sessions so had to authenticate to the cloud provider API and the hosts weren&#x27;t directly listening for connections from the internet. Similar setup to ZeroTier&#x2F;TailScale+SSH</div><br/></div></div><div id="39897047" class="c"><input type="checkbox" id="c-39897047" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39896969">prev</a><span>|</span><a href="#39897315">next</a><span>|</span><label class="collapse" for="c-39897047">[-]</label><label class="expand" for="c-39897047">[3 more]</label></div><br/><div class="children"><div class="content">My gut-feel is that it rides near the line between &quot;defense in depth&quot; versus &quot;security through obscurity&quot;.</div><br/><div id="39897621" class="c"><input type="checkbox" id="c-39897621" checked=""/><div class="controls bullet"><span class="by">Attummm</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897047">parent</a><span>|</span><a href="#39897303">next</a><span>|</span><label class="collapse" for="c-39897621">[-]</label><label class="expand" for="c-39897621">[1 more]</label></div><br/><div class="children"><div class="content">While &#x27;security through obscurity&#x27; shouldn&#x27;t be your only defense, it still plays a crucial role within &#x27;defense in depth&#x27; strategies.<p>In the past, sensitive networks relied heavily on obscurity alone. Just dialing the right phone number could grant access to highly sensitive networks. However, there&#x27;s a cautionary tale of a security researcher who took the phrase &#x27;don&#x27;t do security through obscurity&#x27; to heart and dared hackers, leading to disastrous consequences.<p>Obscurity, when used appropriately, complements broader security measures. Take SSH, for example. Most bots target its default port. Simply changing that port removes the easy targets, forcing attackers to use more sophisticated methods, which in turn, leaves your logs with more concerning activity.</div><br/></div></div><div id="39897303" class="c"><input type="checkbox" id="c-39897303" checked=""/><div class="controls bullet"><span class="by">mrguyorama</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897047">parent</a><span>|</span><a href="#39897621">prev</a><span>|</span><a href="#39897315">next</a><span>|</span><label class="collapse" for="c-39897303">[-]</label><label class="expand" for="c-39897303">[1 more]</label></div><br/><div class="children"><div class="content">The reality is that security through obscurity works really well as a layer in an otherwise already good security model. You make sure to test it with some red teaming, and if they fail to get through, you give them all the details about your tricks so they can also test the actual security.<p>The &quot;obscurity&quot; part mostly serves to limit the noise of drive by and bot&#x27;d attacks, such that each attack attempt that you end up stopping and catching is a more serious signal, and more likely to be directed. It&#x27;s about short circuiting much of the &quot;chaff&quot; in the signal such that you are less warning fatigued and more likely to seriously respond to incidents.<p>The obscurity is not meant to prevent targeted attacks.</div><br/></div></div></div></div><div id="39897315" class="c"><input type="checkbox" id="c-39897315" checked=""/><div class="controls bullet"><span class="by">Dwedit</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897047">prev</a><span>|</span><a href="#39897208">next</a><span>|</span><label class="collapse" for="c-39897315">[-]</label><label class="expand" for="c-39897315">[1 more]</label></div><br/><div class="children"><div class="content">Going in through the main Internet connection might not be the only way in.  Someone surfing on Wifi who visits the wrong website can also become a second way into your internal network.</div><br/></div></div><div id="39897208" class="c"><input type="checkbox" id="c-39897208" checked=""/><div class="controls bullet"><span class="by">noman-land</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897315">prev</a><span>|</span><a href="#39897395">next</a><span>|</span><label class="collapse" for="c-39897208">[-]</label><label class="expand" for="c-39897208">[2 more]</label></div><br/><div class="children"><div class="content">Got any advice to easily set up port knocking?</div><br/><div id="39897447" class="c"><input type="checkbox" id="c-39897447" checked=""/><div class="controls bullet"><span class="by">AlexCoventry</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897208">parent</a><span>|</span><a href="#39897395">next</a><span>|</span><label class="collapse" for="c-39897447">[-]</label><label class="expand" for="c-39897447">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s old and there are probably friendlier options out there now, but<p><a href="https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock&#x2F;blob&#x2F;master&#x2F;INSTALL">https:&#x2F;&#x2F;github.com&#x2F;moxie0&#x2F;knockknock&#x2F;blob&#x2F;master&#x2F;INSTALL</a></div><br/></div></div></div></div><div id="39897395" class="c"><input type="checkbox" id="c-39897395" checked=""/><div class="controls bullet"><span class="by">zoeysmithe</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897208">prev</a><span>|</span><a href="#39897992">next</a><span>|</span><label class="collapse" for="c-39897395">[-]</label><label class="expand" for="c-39897395">[2 more]</label></div><br/><div class="children"><div class="content">Port knocking is bit like a lazy person&#x27;s VPN. You might as well get off your butt and install a vpn solution and use ssh via vpn. The time and effort is almost the same nowadays anyway. The chances of both vpn and ssh being exploited like this must be zero.<p>Worse, most corporate, public wifi, etc networks block all sorts of ports. So at home sure you can open random ports but near everywhere else its just 80 and 443. Now you can&#x27;t knock. But your https vpn works fine.<p>Also a lot of scary stuff here about identity and code checkins. If someone is some contributor, how do we know if their creds havent been stolen or they&#x27;ve been forced via blackmail or whatever to do this? Or how many contributors are actually intelligence agents? Then who is validating their code? This persons code went through just fine, and this was only caught because someone noticed a lag in logins, which by then, is a running binary.<p>FOSS works on the concept of x amount of developer trust, both in code and identity. You can&#x27;t verify everyone all the time (creds and certs get stolen, blackmail, etc), nor can you audit every line of code all the time. Especially if the exploit is submitted piecemeal over the years or months. That trust is now being exploited it seems. Scary times. I wonder if how FOSS works will change after this. I assume the radio silence for Theo and Linus and others means there&#x27;s a lot of brainstroming to get to the root of this problem. Addressing the symptom of this one attack probably won&#x27;t be enough. I imagine some very powerful people want some clarity and fixes here and this is probably going to be a big deal.<p>I wouldn&#x27;t be surprised if a big identity trust initiative comes out of this and some AI stuff to go over an entire submitter&#x27;s history to spot any potentially malicious pattern like this that&#x27;s hard for human beings to detect.</div><br/><div id="39897645" class="c"><input type="checkbox" id="c-39897645" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897395">parent</a><span>|</span><a href="#39897992">next</a><span>|</span><label class="collapse" for="c-39897645">[-]</label><label class="expand" for="c-39897645">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  nor can you audit every line of code all the time<p>You can if you distribute this job among volunteers or hire people to do that. There are millions of developers around the world capable to do this. But reality is that nobody wants to contribute time or pay for free software.</div><br/></div></div></div></div><div id="39897992" class="c"><input type="checkbox" id="c-39897992" checked=""/><div class="controls bullet"><span class="by">belorn</span><span>|</span><a href="#39896572">parent</a><span>|</span><a href="#39897395">prev</a><span>|</span><a href="#39898523">next</a><span>|</span><label class="collapse" for="c-39897992">[-]</label><label class="expand" for="c-39897992">[2 more]</label></div><br/><div class="children"><div class="content">Rather than port knocking, I prefer IP knocking. The server has several ip addresses and once a correct sequence of connection is made, the ssh port opens. Since so few know about IP knocking, it much safer than port knocking.<p>&#x2F;s</div><br/><div id="39900737" class="c"><input type="checkbox" id="c-39900737" checked=""/><div class="controls bullet"><span class="by">drpixie</span><span>|</span><a href="#39896572">root</a><span>|</span><a href="#39897992">parent</a><span>|</span><a href="#39898523">next</a><span>|</span><label class="collapse" for="c-39900737">[-]</label><label class="expand" for="c-39900737">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like (another) good reason for IPv6 - your box can have many, very obscure addresses :)</div><br/></div></div></div></div></div></div><div id="39896549" class="c"><input type="checkbox" id="c-39896549" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#39900274">prev</a><span>|</span><a href="#39897287">next</a><span>|</span><label class="collapse" for="c-39896549">[-]</label><label class="expand" for="c-39896549">[1 more]</label></div><br/><div class="children"><div class="content">Too bad, for a minute I thought it was something useful like adding a rule to clamav to find the private key-pair signature ID of the servers&#x2F;users that up-streamed the exploit.<p>&quot;Play stupid games, win stupid prizes&quot;</div><br/></div></div><div id="39897287" class="c"><input type="checkbox" id="c-39897287" checked=""/><div class="controls bullet"><span class="by">nix0n</span><span>|</span><a href="#39896549">prev</a><span>|</span><label class="collapse" for="c-39897287">[-]</label><label class="expand" for="c-39897287">[1 more]</label></div><br/><div class="children"><div class="content">&quot;Yo dawg, I heard you like exploits, so I exploited your exploit&quot; -Xzibit</div><br/></div></div></div></div></div></div></div></body></html>