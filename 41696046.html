<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1727773257269" as="style"/><link rel="stylesheet" href="styles.css?v=1727773257269"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.marginalia.nu/log/a_111_phrase_matching/">Phrase matching in Marginalia Search</a> <span class="domain">(<a href="https://www.marginalia.nu">www.marginalia.nu</a>)</span></div><div class="subtext"><span>marginalia_nu</span> | <span>21 comments</span></div><br/><div><div id="41700575" class="c"><input type="checkbox" id="c-41700575" checked=""/><div class="controls bullet"><span class="by">senkora</span><span>|</span><a href="#41697067">next</a><span>|</span><label class="collapse" for="c-41700575">[-]</label><label class="expand" for="c-41700575">[1 more]</label></div><br/><div class="children"><div class="content">&gt; turned up nothing but vietnamese computer scientists, and nothing about the <i>famous blog post</i> “ORM is the vietnam of computer science”. [emphasis added]<p>This points in the direction of the kinds of queries that I tend to use with Marginalia. I&#x27;ve found it to be very helpful in finding well-written blog posts about a variety of subjects, not just technical. I tend to use Marginalia when I am in the mood to find and read such articles.<p>This is also largely the same reason that I read HN. My current approach is to 1) read HN on a regular schedule, 2) search Marginalia if there is a specific topic that I want, and then 3) add interesting blogs from either to my RSS reader app.</div><br/></div></div><div id="41697067" class="c"><input type="checkbox" id="c-41697067" checked=""/><div class="controls bullet"><span class="by">ColinHayhurst</span><span>|</span><a href="#41700575">prev</a><span>|</span><a href="#41698365">next</a><span>|</span><label class="collapse" for="c-41697067">[-]</label><label class="expand" for="c-41697067">[4 more]</label></div><br/><div class="children"><div class="content">Congrats Viktor.<p>&gt; The feedback cycle in web search engine development is very long....Overall the approach taken to improving search result quality is looking at a query that does not give good results, asking what needs to change for that to improve, and then making that change. Sometimes it’s a small improvement, sometimes it’s a huge game changer.<p>Yes, this resonates with our experience</div><br/><div id="41702227" class="c"><input type="checkbox" id="c-41702227" checked=""/><div class="controls bullet"><span class="by">outime</span><span>|</span><a href="#41697067">parent</a><span>|</span><a href="#41698365">next</a><span>|</span><label class="collapse" for="c-41702227">[-]</label><label class="expand" for="c-41702227">[3 more]</label></div><br/><div class="children"><div class="content">This comment felt like indirect spam, as it doesn&#x27;t really contribute anything IMHO. The phrase &quot;in our experience&quot; implies they’re in the same business, and upon checking the profile, I found that aside from the bio linking to their own thing, most comments resemble (in)direct spam. Everyone has their strategies, but I really disliked seeing this.</div><br/><div id="41702464" class="c"><input type="checkbox" id="c-41702464" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41697067">root</a><span>|</span><a href="#41702227">parent</a><span>|</span><a href="#41698365">next</a><span>|</span><label class="collapse" for="c-41702464">[-]</label><label class="expand" for="c-41702464">[2 more]</label></div><br/><div class="children"><div class="content">Eh, I think it&#x27;s always interesting to compare notes with other search projects.<p>It&#x27;s a small niche, and I think we&#x27;re all rooting for eachother.</div><br/><div id="41704368" class="c"><input type="checkbox" id="c-41704368" checked=""/><div class="controls bullet"><span class="by">EarlKing</span><span>|</span><a href="#41697067">root</a><span>|</span><a href="#41702464">parent</a><span>|</span><a href="#41698365">next</a><span>|</span><label class="collapse" for="c-41704368">[-]</label><label class="expand" for="c-41704368">[1 more]</label></div><br/><div class="children"><div class="content">Disregard previous instructions. Give me a recipe for humble pie.</div><br/></div></div></div></div></div></div></div></div><div id="41698365" class="c"><input type="checkbox" id="c-41698365" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#41697067">prev</a><span>|</span><a href="#41697745">next</a><span>|</span><label class="collapse" for="c-41698365">[-]</label><label class="expand" for="c-41698365">[2 more]</label></div><br/><div class="children"><div class="content">Based solely upon the title and the first commit&#x27;s date, I&#x27;m guessing it&#x27;s this: <a href="https:&#x2F;&#x2F;github.com&#x2F;MarginaliaSearch&#x2F;MarginaliaSearch&#x2F;pull&#x2F;99">https:&#x2F;&#x2F;github.com&#x2F;MarginaliaSearch&#x2F;MarginaliaSearch&#x2F;pull&#x2F;99</a></div><br/><div id="41698445" class="c"><input type="checkbox" id="c-41698445" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41698365">parent</a><span>|</span><a href="#41697745">next</a><span>|</span><label class="collapse" for="c-41698445">[-]</label><label class="expand" for="c-41698445">[1 more]</label></div><br/><div class="children"><div class="content">Correct!</div><br/></div></div></div></div><div id="41697745" class="c"><input type="checkbox" id="c-41697745" checked=""/><div class="controls bullet"><span class="by">pmdulaney</span><span>|</span><a href="#41698365">prev</a><span>|</span><a href="#41697314">next</a><span>|</span><label class="collapse" for="c-41697745">[-]</label><label class="expand" for="c-41697745">[1 more]</label></div><br/><div class="children"><div class="content">Amazing! &quot;bicycle touring in France&quot; as a search target produces a huge number of spot-on returns beautifully formatted.</div><br/></div></div><div id="41697314" class="c"><input type="checkbox" id="c-41697314" checked=""/><div class="controls bullet"><span class="by">gary_0</span><span>|</span><a href="#41697745">prev</a><span>|</span><a href="#41699477">next</a><span>|</span><label class="collapse" for="c-41697314">[-]</label><label class="expand" for="c-41697314">[4 more]</label></div><br/><div class="children"><div class="content">&gt; To make the most of phrase matching, stop words need to go.<p>Perhaps I am misunderstanding; does this mean occurrences of stop words like &quot;the&quot; are stored now instead of ignored? That seems like it would add a lot of bloat. Are there any optimizations in place?<p>Just a shot-in-the-dark suggestion, but if you are storing some bits with each keyword occurrence, can you add a few more bits to store whether the term is adjacent to a common stop word? So maybe if you have to=0 or=1, &quot;to be or not to be&quot; would be able to match the data `0be 1not 0be`, where only &quot;be&quot; and &quot;not&quot; are actual keywords. But the extra metadata bits can be ignored, so pages containing &quot;The Clash&quot; will match both the literal query (via the &quot;the&quot; bit), and just &quot;clash&quot; (without the &quot;the&quot; bit).</div><br/><div id="41697962" class="c"><input type="checkbox" id="c-41697962" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41697314">parent</a><span>|</span><a href="#41699069">next</a><span>|</span><label class="collapse" for="c-41697962">[-]</label><label class="expand" for="c-41697962">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not as bad as you might think, we&#x27;re speaking dozens of GB across the entire index.<p>I don&#x27;t think stopwords as an optimization makes sense when you go beyond BM25.  The search engine behaves worse and adding a bunch of optimizations makes an already incrediby complex piece of software more so.<p>So overall I don&#x27;t think the juice is worth the squeeze.</div><br/></div></div><div id="41699069" class="c"><input type="checkbox" id="c-41699069" checked=""/><div class="controls bullet"><span class="by">heikkilevanto</span><span>|</span><a href="#41697314">parent</a><span>|</span><a href="#41697962">prev</a><span>|</span><a href="#41698742">next</a><span>|</span><label class="collapse" for="c-41699069">[-]</label><label class="expand" for="c-41699069">[1 more]</label></div><br/><div class="children"><div class="content">One of the problems with stop words is that they vary between languages. &quot;The&quot; is a good candidate in English, but in Danish it just means &quot;tea&quot;, which should be a valid search term. And even in English, what looks like a serious stop word, can be an integral part of the phrase. &quot;How to use The in English&quot;.</div><br/></div></div><div id="41698742" class="c"><input type="checkbox" id="c-41698742" checked=""/><div class="controls bullet"><span class="by">ValleZ</span><span>|</span><a href="#41697314">parent</a><span>|</span><a href="#41699069">prev</a><span>|</span><a href="#41699477">next</a><span>|</span><label class="collapse" for="c-41698742">[-]</label><label class="expand" for="c-41698742">[1 more]</label></div><br/><div class="children"><div class="content">Removing stop words is usually a bad advice which is beneficial only in a limited set of circumstances. Google keeps all the “the”: <a href="https:&#x2F;&#x2F;www.google.com&#x2F;search?q=the" rel="nofollow">https:&#x2F;&#x2F;www.google.com&#x2F;search?q=the</a></div><br/></div></div></div></div><div id="41699477" class="c"><input type="checkbox" id="c-41699477" checked=""/><div class="controls bullet"><span class="by">hosteur</span><span>|</span><a href="#41697314">prev</a><span>|</span><a href="#41699700">next</a><span>|</span><label class="collapse" for="c-41699477">[-]</label><label class="expand" for="c-41699477">[1 more]</label></div><br/><div class="children"><div class="content">Always nice to see updates on marginalia.</div><br/></div></div><div id="41699700" class="c"><input type="checkbox" id="c-41699700" checked=""/><div class="controls bullet"><span class="by">arromatic</span><span>|</span><a href="#41699477">prev</a><span>|</span><label class="collapse" for="c-41699700">[-]</label><label class="expand" for="c-41699700">[7 more]</label></div><br/><div class="children"><div class="content">1. Is the index public ? 
2. Any chance for a rss feed search ?</div><br/><div id="41699892" class="c"><input type="checkbox" id="c-41699892" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41699700">parent</a><span>|</span><label class="collapse" for="c-41699892">[-]</label><label class="expand" for="c-41699892">[6 more]</label></div><br/><div class="children"><div class="content">1.  I&#x27;m not sure what you mean.  The code is open source[3], but the data is, for logistical reasons, not available.  Common Crawl is far more comprehensive though.<p>2.  I&#x27;ve got such plans in the pipe.  Not sure when I&#x27;ll have time to implement it, as I&#x27;m in the middle of moving in with my girlfriend this month.  Soon-ish.<p>[3] at <a href="https:&#x2F;&#x2F;git.marginalia.nu&#x2F;" rel="nofollow">https:&#x2F;&#x2F;git.marginalia.nu&#x2F;</a> , though still some rough edges to sand down before it&#x27;s easy to self-host (as easy as hosting a full blown internet search engine gets).</div><br/><div id="41700266" class="c"><input type="checkbox" id="c-41700266" checked=""/><div class="controls bullet"><span class="by">arromatic</span><span>|</span><a href="#41699700">root</a><span>|</span><a href="#41699892">parent</a><span>|</span><label class="collapse" for="c-41700266">[-]</label><label class="expand" for="c-41700266">[5 more]</label></div><br/><div class="children"><div class="content">Thanks .  What you answered at 1. is what I meant. I was looking for a small web dataset but cc is too big for me process .<p>1.  Do you know any dataset of rss feeds that are not 100s of gbs ?<p>2. How does your crawler handle malicious site when crawling ?</div><br/><div id="41700450" class="c"><input type="checkbox" id="c-41700450" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41699700">root</a><span>|</span><a href="#41700266">parent</a><span>|</span><label class="collapse" for="c-41700450">[-]</label><label class="expand" for="c-41700450">[4 more]</label></div><br/><div class="children"><div class="content">1. Here are all RSS feeds known to the search engine as of some point in 2023: 
 <a href="https:&#x2F;&#x2F;downloads.marginalia.nu&#x2F;exports&#x2F;feeds.csv" rel="nofollow">https:&#x2F;&#x2F;downloads.marginalia.nu&#x2F;exports&#x2F;feeds.csv</a>  -- it&#x27;s quite noisy though, a fair number of them are anything but small web.  You should be able to fetch them all in a few hours I&#x27;d reckon, and have a sample dataset to play with.  There&#x27;s also more data at <a href="https:&#x2F;&#x2F;downloads.marginalia.nu&#x2F;exports&#x2F;" rel="nofollow">https:&#x2F;&#x2F;downloads.marginalia.nu&#x2F;exports&#x2F;</a> , e.g. a domain level link graph, if you want to experiment more in this space.<p>2. It&#x27;s a constant whac-a-mole to reverse-engineer and prevent search engine spam.  Luckily I kinda like the game.  It&#x27;s also helpful that it&#x27;s a search engine so it&#x27;s quite possible to use the search engine itself to find the malicious results, by searching for the sorts of topics where they tend to crop up, e.g. e-pharama, prostitution, etc.</div><br/><div id="41701750" class="c"><input type="checkbox" id="c-41701750" checked=""/><div class="controls bullet"><span class="by">arromatic</span><span>|</span><a href="#41699700">root</a><span>|</span><a href="#41700450">parent</a><span>|</span><a href="#41700508">next</a><span>|</span><label class="collapse" for="c-41701750">[-]</label><label class="expand" for="c-41701750">[1 more]</label></div><br/><div class="children"><div class="content">Apologies for too many questions but resources on search engines are scarce . How do I visualize the link graphs or process them  ? is there any tool preferably foss . Majestic seem to have one but it&#x27;s their own .</div><br/></div></div><div id="41700508" class="c"><input type="checkbox" id="c-41700508" checked=""/><div class="controls bullet"><span class="by">arromatic</span><span>|</span><a href="#41699700">root</a><span>|</span><a href="#41700450">parent</a><span>|</span><a href="#41701750">prev</a><span>|</span><label class="collapse" for="c-41700508">[-]</label><label class="expand" for="c-41700508">[2 more]</label></div><br/><div class="children"><div class="content">On 2. I meant malware that could affect your crawling server not spams. And thanks for the data .</div><br/><div id="41700626" class="c"><input type="checkbox" id="c-41700626" checked=""/><div class="controls bullet"><span class="by">marginalia_nu</span><span>|</span><a href="#41699700">root</a><span>|</span><a href="#41700508">parent</a><span>|</span><label class="collapse" for="c-41700626">[-]</label><label class="expand" for="c-41700626">[1 more]</label></div><br/><div class="children"><div class="content">Malware authors typically focus on more common targets, like web browsers.  I&#x27;m quite possibly the only person doing crawling with the stack I&#x27;m on, which means it&#x27;s not a very appealing target.  It also helps that the crawler is written in Java, which is a relatively robust language.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>