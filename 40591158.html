<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717664465038" as="style"/><link rel="stylesheet" href="styles.css?v=1717664465038"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sha256.net/dhcpv6-pd-first-steps.html">DHCPv6-PD – First Steps</a> <span class="domain">(<a href="https://sha256.net">sha256.net</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>56 comments</span></div><br/><div><div id="40593143" class="c"><input type="checkbox" id="c-40593143" checked=""/><div class="controls bullet"><span class="by">ninkendo</span><span>|</span><a href="#40591781">next</a><span>|</span><label class="collapse" for="c-40593143">[-]</label><label class="expand" for="c-40593143">[23 more]</label></div><br/><div class="children"><div class="content">This article hints at what I consider to be the biggest technical drawback to IPv6 for residential use, which is that dynamic prefixes mean your internal LAN IPs are never stable.<p>The answer to this is usually something like “duh, use DNS”, but how are you going to configure that DNS server if your whole network’s IP address range could change at any time? Yes, multicast DNS is a thing, but it’s not supported in all software (I’m looking at you, OpenBSD, which has no out of the box support for it and I’ve not figured out how to configure it.)<p>So the real answer is to create a ULA prefix on the side that you generate randomly (or make an easy to remember one because this is residential use, who cares about collisions, it’s a private space) and use that for any use case that involves hardcoded IPs, like DNS server configuration.<p>But it still feels like a compromise to me. I wish more software was “prefixless”, including DNS server indication and even DNS zone files, such that a lack of prefix means “prepend the prefix you are already communicating on”… Firewall configuration would be simpler, DNS zone files could survive re-prefixing, all sorts of configuration could be made to work this way, but instead you’re left with either a ton of automation to reconfigure things when the prefix changes, a bunch of manual work, or just bite the bullet and use ULA.<p>Oh, and did I mention that in my particular setup, all my devices would keep trying to communicate on their old addresses even after a new prefix gets assigned and the new RA’s are sent? Meaning they essentially lose all connectivity if you’re using an IPv6-mostly setup like I have? Oh sure, they grab addresses on the new prefix, but they don’t drop the old one until the lifetime expires, which defaults to 4 hours in the environment I’m in (I <i>think</i> the rad daemon in OpenBSD inherits the lifetimes from its upstream router’s lifetimes, which makes the duration Comcast’s fault, but the proper thing to do is rescind the old RA’s when the interface changes addresses, and rad does not do this out of the box for me, or if it does it doesn’t work right.)<p>Ok rant over. I want to like IPv6 but dynamic prefixes are really the Achilles heel for me.</div><br/><div id="40593570" class="c"><input type="checkbox" id="c-40593570" checked=""/><div class="controls bullet"><span class="by">hairyplanter</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40594296">next</a><span>|</span><label class="collapse" for="c-40593570">[-]</label><label class="expand" for="c-40593570">[6 more]</label></div><br/><div class="children"><div class="content">&gt; or just bite the bullet and use ULA.<p>This is the proper ipv6 solution.<p>With ipv6, one ethernet interface is _supposed_ to have multiple addresses. You wouldn&#x27;t want your lan routing to stop working when your ISP goes down, right? So configure your internal DNS with ULA (which should be stable for each machine for a given prefix, even with SLAAC) and be done with it, much like internal DNS using private addresses in ipv4.<p>For externally visible servers, do the normal thing, that is, those servers dynamically update global dns, much the same way with ipv4 dyndns.<p>Another learning curve for ipv6 is that people get frustrated by dynamic prefixes, but it&#x27;s the nature of residential networks: the ISPs want a stateless solution, so customers get a dynamic prefix. Maintaining the same prefix across power outages needs a stateful solution, so only business plans offer them for an extra fee, much like static ipv4 addresses.<p>And we&#x27;ve had dyndns for decades now for exactly that use case. Just keep using that.</div><br/><div id="40595088" class="c"><input type="checkbox" id="c-40595088" checked=""/><div class="controls bullet"><span class="by">OJFord</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593570">parent</a><span>|</span><a href="#40594955">next</a><span>|</span><label class="collapse" for="c-40595088">[-]</label><label class="expand" for="c-40595088">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the point of using IPv6 at all on a home network if you use ULA though? If you continued to use an IPv4 setup you were familiar with but allowed your router to talk both or v6 only, wouldn&#x27;t it be the same?<p>Is it that you&#x27;d still have the globally addressable addresses on NICs with a ULA too, just that&#x27;s not what you&#x27;d use for routing internally? (Not that I&#x27;m really sure of the benefit of that residentially either?)</div><br/></div></div><div id="40594955" class="c"><input type="checkbox" id="c-40594955" checked=""/><div class="controls bullet"><span class="by">krylon</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593570">parent</a><span>|</span><a href="#40595088">prev</a><span>|</span><a href="#40593879">next</a><span>|</span><label class="collapse" for="c-40594955">[-]</label><label class="expand" for="c-40594955">[2 more]</label></div><br/><div class="children"><div class="content">I never heard of ULA before, and it sounded a bit overwhelming at first. But on a Fritz!Box with recent firmware, it&#x27;s very easy to enable, and voila! - just works.</div><br/><div id="40595094" class="c"><input type="checkbox" id="c-40595094" checked=""/><div class="controls bullet"><span class="by">simoncion</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40594955">parent</a><span>|</span><a href="#40593879">next</a><span>|</span><label class="collapse" for="c-40595094">[-]</label><label class="expand" for="c-40595094">[1 more]</label></div><br/><div class="children"><div class="content">Yep! ULA should be thought of as the IPv6 equivalent of RFC 1918 space... with the added bonus that -unlike with IPv4- ULA prefixes are very unlikely to collide, so merging internal networks will very rarely require renumbering.</div><br/></div></div></div></div><div id="40593879" class="c"><input type="checkbox" id="c-40593879" checked=""/><div class="controls bullet"><span class="by">lloeki</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593570">parent</a><span>|</span><a href="#40594955">prev</a><span>|</span><a href="#40594296">next</a><span>|</span><label class="collapse" for="c-40593879">[-]</label><label class="expand" for="c-40593879">[2 more]</label></div><br/><div class="children"><div class="content">&gt; the ISPs want a stateless solution, so customers get a dynamic prefix. Maintaining the same prefix across power outages needs a stateful solution, so only business plans offer them for an extra fee, much like static ipv4 addresses.<p>I&#x27;m surprised based on my experience: in 15 years of residential IPv6 usage I&#x27;ve always had the same IPv6 prefix (for a given ISP contract of course), even for those ISPs that insisted on handing out dynamic IPv4 with no option for a static one plus had no qualms renewing the IP at any moment, not just power down.<p>&gt; stateful solution<p>I&#x27;m seeing this the other way around: dynamic needs lease tracking while static just needs a permanent record attached to the already present auth mechanism.</div><br/><div id="40593914" class="c"><input type="checkbox" id="c-40593914" checked=""/><div class="controls bullet"><span class="by">hairyplanter</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593879">parent</a><span>|</span><a href="#40594296">next</a><span>|</span><label class="collapse" for="c-40593914">[-]</label><label class="expand" for="c-40593914">[1 more]</label></div><br/><div class="children"><div class="content">My experience is the opposite!</div><br/></div></div></div></div></div></div><div id="40594296" class="c"><input type="checkbox" id="c-40594296" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40593570">prev</a><span>|</span><a href="#40593399">next</a><span>|</span><label class="collapse" for="c-40594296">[-]</label><label class="expand" for="c-40594296">[1 more]</label></div><br/><div class="children"><div class="content">My IPv6 address is perfectly stable. It&#x27;s up to the ISP to decide if they bully you into paying extra for a static network or not, but it&#x27;s an implementation problem. Same with IPv4 assignment, necessitating hacks like DynDNS.<p>If you want stable local addressing, announce a ULA on your LAN. Not all routers support it, unfortunately, but you can announce a ULA from any device. Just don&#x27;t announce your raspberry Pi as an outbound router.<p>ULAs use SLAAC and will derive at least one IP address from your devices&#x27; MAC address. There&#x27;s a chance of instability if you have devices with the same MAC addresses (there&#x27;s detection for that problem but you end up with a race condition after a network reboot), but your network will probably break in other ways if you have such a setup.</div><br/></div></div><div id="40593399" class="c"><input type="checkbox" id="c-40593399" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40594296">prev</a><span>|</span><a href="#40594888">next</a><span>|</span><label class="collapse" for="c-40593399">[-]</label><label class="expand" for="c-40593399">[3 more]</label></div><br/><div class="children"><div class="content">For those with flatter home network needs but still wanting a few things internal to be reachable by IP I&#x27;ll throw in you can also use static link locals on  fe80:: instead of a random ULA prefix. You&#x27;ll still need the ULA method if you have multiple subnets and want static services reachable via routing though.<p>Unless the router says the old prefix now has a valid lifetime of 0 the proper thing to do is actually to wait for the prefix to expire like it seems to be doing. I never had this missing lifetime change problem with Comcast but it&#x27;s very possible they do things differently in different service areas&#x2F;for different service types.</div><br/><div id="40593685" class="c"><input type="checkbox" id="c-40593685" checked=""/><div class="controls bullet"><span class="by">hairyplanter</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593399">parent</a><span>|</span><a href="#40594888">next</a><span>|</span><label class="collapse" for="c-40593685">[-]</label><label class="expand" for="c-40593685">[2 more]</label></div><br/><div class="children"><div class="content">As browsers don&#x27;t like link local addresses in the address bar, ULA is still better.</div><br/><div id="40594553" class="c"><input type="checkbox" id="c-40594553" checked=""/><div class="controls bullet"><span class="by">pantalaimon</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593685">parent</a><span>|</span><a href="#40594888">next</a><span>|</span><label class="collapse" for="c-40594553">[-]</label><label class="expand" for="c-40594553">[1 more]</label></div><br/><div class="children"><div class="content">You always have to specify the interface that goes with them since they are only guaranteed to be unique on the link.</div><br/></div></div></div></div></div></div><div id="40594888" class="c"><input type="checkbox" id="c-40594888" checked=""/><div class="controls bullet"><span class="by">derkades</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40593399">prev</a><span>|</span><a href="#40593480">next</a><span>|</span><label class="collapse" for="c-40594888">[-]</label><label class="expand" for="c-40594888">[2 more]</label></div><br/><div class="children"><div class="content">Unfortunately, it seems that support for automatically configuring multiple addresses is quite poor. Linux it can be done with NetworkConfiguration or Netplan: use SLAAC to get a GUA and DHCPv6 for a ULA. NetworkManager also seems to use both by default. Android does not support DHCPv6 at all. I don&#x27;t know about Windows, iOS, or macOS.</div><br/><div id="40595076" class="c"><input type="checkbox" id="c-40595076" checked=""/><div class="controls bullet"><span class="by">simoncion</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40594888">parent</a><span>|</span><a href="#40593480">next</a><span>|</span><label class="collapse" for="c-40595076">[-]</label><label class="expand" for="c-40595076">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Unfortunately, it seems that support for automatically configuring multiple addresses is quite poor.<p>What? SLAAC configures addresses on all -er- not-expired prefixes advertised on the link. So, if the border router advertises a ULA prefix and a globally-routeable prefix, SLAAC assigns two addresses to the computer.<p>If whatever network-configuration tooling you&#x27;re using causes your computer to not generate an address for every advertised prefix (and you&#x27;ve not told the tooling to behave in this way) then it&#x27;s broken.</div><br/></div></div></div></div><div id="40593480" class="c"><input type="checkbox" id="c-40593480" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40594888">prev</a><span>|</span><a href="#40594664">next</a><span>|</span><label class="collapse" for="c-40593480">[-]</label><label class="expand" for="c-40593480">[1 more]</label></div><br/><div class="children"><div class="content">Your rant doesn&#x27;t make sense. The solution is already known and you mention it: ULA. It&#x27;s not a compromise. You don&#x27;t need to bite the bullet. Just use it. It&#x27;s designed for this use case. Fixed IP address for every single device.</div><br/></div></div><div id="40594664" class="c"><input type="checkbox" id="c-40594664" checked=""/><div class="controls bullet"><span class="by">f_devd</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40593480">prev</a><span>|</span><a href="#40593260">next</a><span>|</span><label class="collapse" for="c-40594664">[-]</label><label class="expand" for="c-40594664">[2 more]</label></div><br/><div class="children"><div class="content">My only gripe with IPv6 is that clients use an entire &#x2F;64, I get it&#x27;s useful for SLAAC, but I wish I could make clients receive a &#x2F;68 or more with DHCPv6 so that the address space can be subdivided even when you are already behind a &#x2F;64 prefix.</div><br/><div id="40594830" class="c"><input type="checkbox" id="c-40594830" checked=""/><div class="controls bullet"><span class="by">greenicon</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40594664">parent</a><span>|</span><a href="#40593260">next</a><span>|</span><label class="collapse" for="c-40594830">[-]</label><label class="expand" for="c-40594830">[1 more]</label></div><br/><div class="children"><div class="content">That’s exactly what prefix delegation is for. Your ISP ought to give an &#x2F;56 or more, so you can then have multiple &#x2F;64.<p>I get an &#x2F;56 by my ISP and have 6 or so different &#x2F;64 in my residence.</div><br/></div></div></div></div><div id="40593260" class="c"><input type="checkbox" id="c-40593260" checked=""/><div class="controls bullet"><span class="by">justahuman74</span><span>|</span><a href="#40593143">parent</a><span>|</span><a href="#40594664">prev</a><span>|</span><a href="#40591781">next</a><span>|</span><label class="collapse" for="c-40593260">[-]</label><label class="expand" for="c-40593260">[7 more]</label></div><br/><div class="children"><div class="content">I wish getting and using an IPv6 subnet was like buying a domain name, and that residential ISPs would be required to use your subnet for your service, a bit like portable phone numbers.<p>The current IP allocation&#x2F;usage procedures are a bit beyond most people</div><br/><div id="40593466" class="c"><input type="checkbox" id="c-40593466" checked=""/><div class="controls bullet"><span class="by">zamadatix</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593260">parent</a><span>|</span><a href="#40593400">next</a><span>|</span><label class="collapse" for="c-40593466">[-]</label><label class="expand" for="c-40593466">[5 more]</label></div><br/><div class="children"><div class="content">A good compromise between this (lots of routing work on the internet) and random prefixes all the time (lots of work on the end user networks) is setting DHCP-PD to do consistent PD assignments. Sure, you&#x27;re space isn&#x27;t portable between carriers if you move&#x2F;have redundant internet but you can also rely on a static address in your assigned range working 3 years from now even if your router is offline for a month. ATT fiber does this. I haven&#x27;t done a survey of who else.</div><br/><div id="40593722" class="c"><input type="checkbox" id="c-40593722" checked=""/><div class="controls bullet"><span class="by">hairyplanter</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593466">parent</a><span>|</span><a href="#40593400">next</a><span>|</span><label class="collapse" for="c-40593722">[-]</label><label class="expand" for="c-40593722">[4 more]</label></div><br/><div class="children"><div class="content">ULA is still the right solution here.<p>ULA would let you maintain your internal lan with custom subnets and DNS even if you switch carriers or use multiple carriers. No need to update your internal DNS servers for ULA.<p>If you&#x27;re running a server on your dynamic residential service, you must be using dyndns for ipv4. So do the same with ipv6.<p>Residential random prefixes is the nature of residential networks, as ISPs don&#x27;t want to preserve state. With a business grade service, you&#x27;d get a static prefix, much like static ipv4. Then the only time you need to update anything is when you switch your ISP and need to update global DNS addresses for your servers.</div><br/><div id="40593934" class="c"><input type="checkbox" id="c-40593934" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593722">parent</a><span>|</span><a href="#40593400">next</a><span>|</span><label class="collapse" for="c-40593934">[-]</label><label class="expand" for="c-40593934">[3 more]</label></div><br/><div class="children"><div class="content">I guess I&#x27;ll ask here... How do I learn this? I&#x27;m comfortable with IPv4, including DHCP, DNS, VPNs, NAT, whatever. I&#x27;d like to be able to set up a v6 network[0] in whatever is the Correct and sane way. Is there a good end-to-end tutorial to set it all up by hand and explain what all these things (RA&#x2F;DHCPv6&#x2F;fe80::&#x2F;ULA&#x2F;etc.) are and how to use them or why not to use them?<p>[0] Ideally <i>pure</i> v6 if possible; I <i>think</i> there&#x27;s some way to encapsulate&#x2F;NAT v4 traffic out from a pure v6 network so I don&#x27;t actually need dual stack.</div><br/><div id="40594814" class="c"><input type="checkbox" id="c-40594814" checked=""/><div class="controls bullet"><span class="by">thwarted</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593934">parent</a><span>|</span><a href="#40594308">next</a><span>|</span><label class="collapse" for="c-40594814">[-]</label><label class="expand" for="c-40594814">[1 more]</label></div><br/><div class="children"><div class="content">Hurricane Electric has a pretty decent IPv6 self-study certification program.<p><a href="https:&#x2F;&#x2F;ipv6.he.net&#x2F;certification&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ipv6.he.net&#x2F;certification&#x2F;</a></div><br/></div></div><div id="40594308" class="c"><input type="checkbox" id="c-40594308" checked=""/><div class="controls bullet"><span class="by">hairyplanter</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593934">parent</a><span>|</span><a href="#40594814">prev</a><span>|</span><a href="#40593400">next</a><span>|</span><label class="collapse" for="c-40594308">[-]</label><label class="expand" for="c-40594308">[1 more]</label></div><br/><div class="children"><div class="content">I haven’t seen one. Openwrt seems to do the right thing out of the box, but that’s not that helpful in setting up your own and learning on the way.<p>Maybe I will write one this weekend and make a hn post.</div><br/></div></div></div></div></div></div></div></div><div id="40593400" class="c"><input type="checkbox" id="c-40593400" checked=""/><div class="controls bullet"><span class="by">stephen_g</span><span>|</span><a href="#40593143">root</a><span>|</span><a href="#40593260">parent</a><span>|</span><a href="#40593466">prev</a><span>|</span><a href="#40591781">next</a><span>|</span><label class="collapse" for="c-40593400">[-]</label><label class="expand" for="c-40593400">[1 more]</label></div><br/><div class="children"><div class="content">That would make the routing table exponentially larger though, which would become unworkable… That’s why they mostly only do it for networks big enough to need it.</div><br/></div></div></div></div></div></div><div id="40591781" class="c"><input type="checkbox" id="c-40591781" checked=""/><div class="controls bullet"><span class="by">candiddevmike</span><span>|</span><a href="#40593143">prev</a><span>|</span><a href="#40592216">next</a><span>|</span><label class="collapse" for="c-40591781">[-]</label><label class="expand" for="c-40591781">[4 more]</label></div><br/><div class="children"><div class="content">While the article is focused on OpenBSD, implementing DHCPv6 with systemd-networkd is really slick and typically a 1-2 line config for your interfaces:<p>Upstream:<p><pre><code>  [DHCPv6]
  PrefixDelegationHint=::&#x2F;56
</code></pre>
Downstream:<p><pre><code>  [DHCPv6PrefixDelegation]
  Token=::1</code></pre></div><br/><div id="40592073" class="c"><input type="checkbox" id="c-40592073" checked=""/><div class="controls bullet"><span class="by">tssva</span><span>|</span><a href="#40591781">parent</a><span>|</span><a href="#40592808">next</a><span>|</span><label class="collapse" for="c-40592073">[-]</label><label class="expand" for="c-40592073">[2 more]</label></div><br/><div class="children"><div class="content">I have never been able to get DHCPv6PD working with systemd-networkd on my Verizon Fios connection at home. I have using other software.</div><br/><div id="40593100" class="c"><input type="checkbox" id="c-40593100" checked=""/><div class="controls bullet"><span class="by">robhlt</span><span>|</span><a href="#40591781">root</a><span>|</span><a href="#40592073">parent</a><span>|</span><a href="#40592808">next</a><span>|</span><label class="collapse" for="c-40593100">[-]</label><label class="expand" for="c-40593100">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s working on my fios connection, but I remember that wasn&#x27;t always the case. Verizon may have changed something recently or the issue was fixed in a recent systemd release.<p>My config looks like this with systemd 255:<p><pre><code>  wan.network:
  [Network]
  DHCP=yes
  IPv6AcceptRA=yes
  IPForward=yes

  [IPv6AcceptRA]
  UseDNS=no
  DHCPv6Client=yes

  [DHCPv6]
  UseDNS=no
  UseHostname=no
  UseDomains=no
  PrefixDelegationHint=::&#x2F;56

  [Link]
  RequiredForOnline=routable


  lan.network:
  [Network]
  Address=xx.xx.xx.1&#x2F;24
  IPForward=yes
  DHCPv6PrefixDelegation=yes

  [DHCPv6PrefixDelegation]
  SubnetId=0
  Token=static:::1
</code></pre>
That lan config can be re-used on other vlan interfaces too, to take full advantage of the &#x2F;56 prefix. Just increment the SubnetID (hex only for some reason, so the next is 0x1).</div><br/></div></div></div></div></div></div><div id="40592216" class="c"><input type="checkbox" id="c-40592216" checked=""/><div class="controls bullet"><span class="by">bastard_op</span><span>|</span><a href="#40591781">prev</a><span>|</span><a href="#40592115">next</a><span>|</span><label class="collapse" for="c-40592216">[-]</label><label class="expand" for="c-40592216">[17 more]</label></div><br/><div class="children"><div class="content">&quot;3 Because of android refusing to implement it.&quot;<p>So, some interesting history for the not-network-engineers out there on ipv6 fun.  <a href="https:&#x2F;&#x2F;issuetracker.google.com&#x2F;issues&#x2F;36949085" rel="nofollow">https:&#x2F;&#x2F;issuetracker.google.com&#x2F;issues&#x2F;36949085</a><p>Why do people hate ipv6? Google comes to mind as one place to start.</div><br/><div id="40592288" class="c"><input type="checkbox" id="c-40592288" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#40592216">parent</a><span>|</span><a href="#40592372">next</a><span>|</span><label class="collapse" for="c-40592288">[-]</label><label class="expand" for="c-40592288">[14 more]</label></div><br/><div class="children"><div class="content">No.<p>In IPv6, you can get an address using RA. DHCPv6 only if you want to smuggle some unrelated metadata as options (which, of course, not widely used outside enterprise).
DHCPv6-PD are used only when you need a whole prefix.<p>If everybody implement all the specs out there, we will have two different DNS record type, 4 or 5 address allocation schemes, a handful of IPv6-over-IPv4 protocol, whole a lots of incomplete and incompatible IPv4-ovr-IPv6 protocol.... Etc... while telling everybody ipv6 is simple and ask why we haven&#x27;t got there yet</div><br/><div id="40592835" class="c"><input type="checkbox" id="c-40592835" checked=""/><div class="controls bullet"><span class="by">Tigress8780</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592288">parent</a><span>|</span><a href="#40592348">next</a><span>|</span><label class="collapse" for="c-40592835">[-]</label><label class="expand" for="c-40592835">[7 more]</label></div><br/><div class="children"><div class="content">SLAAC is fine, until you somehow get a subnet smaller than &#x2F;64 on your router, in which case SLAAC completely breaks. I understand why SLAAC has such a limitation, but this is what we get.<p>It&#x27;s not optimal, but the upstream network provider does not budge, and now everything except Android devices get IPv6 address via DHCPv6.</div><br/><div id="40594582" class="c"><input type="checkbox" id="c-40594582" checked=""/><div class="controls bullet"><span class="by">pantalaimon</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592835">parent</a><span>|</span><a href="#40593022">next</a><span>|</span><label class="collapse" for="c-40594582">[-]</label><label class="expand" for="c-40594582">[1 more]</label></div><br/><div class="children"><div class="content">There was a proposal for variable length SLAAC, but it went nowhere<p><a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-mishra-6man-variable-slaac-08" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-mishra-6man-vari...</a></div><br/></div></div><div id="40593022" class="c"><input type="checkbox" id="c-40593022" checked=""/><div class="controls bullet"><span class="by">devman0</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592835">parent</a><span>|</span><a href="#40594582">prev</a><span>|</span><a href="#40592879">next</a><span>|</span><label class="collapse" for="c-40593022">[-]</label><label class="expand" for="c-40593022">[2 more]</label></div><br/><div class="children"><div class="content">Unicast IPv6 addresses are required to have a 64 bit interface identifier and a 64 bit network identifier (e.g. &#x2F;64), handing out subnets lower than &#x2F;64 is not spec compliant.<p>Network operators can do crazy things, but if you color outside the lines things may break.</div><br/><div id="40594621" class="c"><input type="checkbox" id="c-40594621" checked=""/><div class="controls bullet"><span class="by">jodersky</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40593022">parent</a><span>|</span><a href="#40592879">next</a><span>|</span><label class="collapse" for="c-40594621">[-]</label><label class="expand" for="c-40594621">[1 more]</label></div><br/><div class="children"><div class="content">AFAIK, it&#x27;s not strictly true that unicast addresses are <i>required</i> to use a &#x2F;64 network identifier.<p>It&#x27;s common, almost necessary even, for environments with dynamic clients to use &#x2F;64 subnets (precisely so that SLAAC works), but in a static environment it&#x27;s perfectly fine to use prefixes larger than &#x2F;64 (e.g. delegate a &#x2F;80 to each individual host in a datacenter, for virtualization applications etc).<p>Hence, I&#x27;m wondering what the spec is you mention that is broken?</div><br/></div></div></div></div><div id="40592879" class="c"><input type="checkbox" id="c-40592879" checked=""/><div class="controls bullet"><span class="by">Dylan16807</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592835">parent</a><span>|</span><a href="#40593022">prev</a><span>|</span><a href="#40592348">next</a><span>|</span><label class="collapse" for="c-40592879">[-]</label><label class="expand" for="c-40592879">[3 more]</label></div><br/><div class="children"><div class="content">Who&#x27;s out there being so crazily stingy?  Allocating a subnet that small is making things more complicated for no benefit.</div><br/><div id="40592977" class="c"><input type="checkbox" id="c-40592977" checked=""/><div class="controls bullet"><span class="by">mathsmath</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592879">parent</a><span>|</span><a href="#40592348">next</a><span>|</span><label class="collapse" for="c-40592977">[-]</label><label class="expand" for="c-40592977">[2 more]</label></div><br/><div class="children"><div class="content">Someone should double check me, but I think PD less than a &#x2F;64 also just breaks (and probably is against the spec).<p>A lot of the complaints I have seen in the last decade is from ISPs doing silly things and cutting their teeth on fresh IPv6 deployments. My ISP seems to have their collective ducks in a row now, and it has been rock solid for years.<p>I actually had a case recently where a misbehaving IPv4 IoT device consumed my entire DHCP pool. IPv6 devices kept chugging along without any problem.</div><br/><div id="40594225" class="c"><input type="checkbox" id="c-40594225" checked=""/><div class="controls bullet"><span class="by">Tigress8780</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592977">parent</a><span>|</span><a href="#40592348">next</a><span>|</span><label class="collapse" for="c-40594225">[-]</label><label class="expand" for="c-40594225">[1 more]</label></div><br/><div class="children"><div class="content">It probably is. I remember that putting a &#x2F;72 into OpenWRT&#x27;s `ip6prefix` field actually breaks the whole network stack (including IPv4, the interface no longer has any address assigned to it).</div><br/></div></div></div></div></div></div></div></div><div id="40592348" class="c"><input type="checkbox" id="c-40592348" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592288">parent</a><span>|</span><a href="#40592835">prev</a><span>|</span><a href="#40592372">next</a><span>|</span><label class="collapse" for="c-40592348">[-]</label><label class="expand" for="c-40592348">[6 more]</label></div><br/><div class="children"><div class="content">I meant.... I love DHCPv6.<p>If only RA wasn&#x27;t mandatory part of IPv6, I am all for DHCPv6.<p>It&#x27;s the fault of early IPv6 designers with NIH syndrome created this mess.</div><br/><div id="40592519" class="c"><input type="checkbox" id="c-40592519" checked=""/><div class="controls bullet"><span class="by">kiwijamo</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592348">parent</a><span>|</span><a href="#40592804">next</a><span>|</span><label class="collapse" for="c-40592519">[-]</label><label class="expand" for="c-40592519">[4 more]</label></div><br/><div class="children"><div class="content">Out of interest as I have found IPv6 RA to work flawlessly for my home network (alongside legacy IPv4 DHCP), what advantage (if any) is there in deploying DHCPv6 within the home LAN? Or were you meaning to say DHCPv6 is great for certain (enterprise?) use cases?</div><br/><div id="40592571" class="c"><input type="checkbox" id="c-40592571" checked=""/><div class="controls bullet"><span class="by">hamandcheese</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592519">parent</a><span>|</span><a href="#40592804">next</a><span>|</span><label class="collapse" for="c-40592571">[-]</label><label class="expand" for="c-40592571">[3 more]</label></div><br/><div class="children"><div class="content">When I was experimenting with IPv6 on my lan, router advertisements indeed worked great!<p>But the big loss was that I had no control to reserve a particular IPv6 address for a particular MAC address inside the DHCP server, or assign DNS names automatically, etc. since it&#x27;s basically 1 way - device receives a RA then configures itself with a random address.</div><br/><div id="40594598" class="c"><input type="checkbox" id="c-40594598" checked=""/><div class="controls bullet"><span class="by">pantalaimon</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592571">parent</a><span>|</span><a href="#40592781">next</a><span>|</span><label class="collapse" for="c-40594598">[-]</label><label class="expand" for="c-40594598">[1 more]</label></div><br/><div class="children"><div class="content">You could give the device a static address and let duplicate address detection do it’s thing</div><br/></div></div></div></div></div></div><div id="40592804" class="c"><input type="checkbox" id="c-40592804" checked=""/><div class="controls bullet"><span class="by">Spivak</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592348">parent</a><span>|</span><a href="#40592519">prev</a><span>|</span><a href="#40592372">next</a><span>|</span><label class="collapse" for="c-40592804">[-]</label><label class="expand" for="c-40592804">[1 more]</label></div><br/><div class="children"><div class="content">And also really optimistic that client-client connections are allowed to perform the auto-configuration.<p>Probably true in a home network, probably not at the office. I hope not at the office.</div><br/></div></div></div></div></div></div><div id="40592372" class="c"><input type="checkbox" id="c-40592372" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#40592216">parent</a><span>|</span><a href="#40592288">prev</a><span>|</span><a href="#40592115">next</a><span>|</span><label class="collapse" for="c-40592372">[-]</label><label class="expand" for="c-40592372">[2 more]</label></div><br/><div class="children"><div class="content">Google doesn&#x27;t hate IPv6; they&#x27;ve put huge effort into it. This particular issue is just weird.</div><br/><div id="40592994" class="c"><input type="checkbox" id="c-40592994" checked=""/><div class="controls bullet"><span class="by">bastard_op</span><span>|</span><a href="#40592216">root</a><span>|</span><a href="#40592372">parent</a><span>|</span><a href="#40592115">next</a><span>|</span><label class="collapse" for="c-40592994">[-]</label><label class="expand" for="c-40592994">[1 more]</label></div><br/><div class="children"><div class="content">Weird indeed. It&#x27;s sort of fun to see updates as you still get some random personal lashing out at one member in particular for a feud no one remembers but them, but either way it&#x27;s like... why this mess we still can&#x27;t have dhcpv6 on android for enterprise?</div><br/></div></div></div></div></div></div><div id="40592115" class="c"><input type="checkbox" id="c-40592115" checked=""/><div class="controls bullet"><span class="by">miller_joe</span><span>|</span><a href="#40592216">prev</a><span>|</span><a href="#40593862">next</a><span>|</span><label class="collapse" for="c-40592115">[-]</label><label class="expand" for="c-40592115">[4 more]</label></div><br/><div class="children"><div class="content">This is great! I’ve been using ipv6 on openbsd for a while now, starting with a hurricane electric tunnel years ago then to native v6 on Comcast and now Sonic. Configuring ipv6 PD has not been supported in base this whole time. I recall using wide-dhcp6c years ago and then switching to the dhcpcd in the article. The situation has improved, slowly, but it will be great to have this in the base system<p>*EDIT*: dhcp6leased landed in base yesterday: <a href="https:&#x2F;&#x2F;www.undeadly.org&#x2F;cgi?action=article;sid=20240604085042" rel="nofollow">https:&#x2F;&#x2F;www.undeadly.org&#x2F;cgi?action=article;sid=202406040850...</a></div><br/><div id="40592635" class="c"><input type="checkbox" id="c-40592635" checked=""/><div class="controls bullet"><span class="by">hamandcheese</span><span>|</span><a href="#40592115">parent</a><span>|</span><a href="#40592981">next</a><span>|</span><label class="collapse" for="c-40592635">[-]</label><label class="expand" for="c-40592635">[2 more]</label></div><br/><div class="children"><div class="content">Did Sonic start offering native IPv6? Last I looked, it was only covered via tunnel only.</div><br/><div id="40593256" class="c"><input type="checkbox" id="c-40593256" checked=""/><div class="controls bullet"><span class="by">mikepavone</span><span>|</span><a href="#40592115">root</a><span>|</span><a href="#40592635">parent</a><span>|</span><a href="#40592981">next</a><span>|</span><label class="collapse" for="c-40593256">[-]</label><label class="expand" for="c-40593256">[1 more]</label></div><br/><div class="children"><div class="content">They turned on native IPv6 end of last year, at least in some areas (including Berkeley where I live). You wouldn&#x27;t know it from their help pages, but there are some post in the forum to that effect.</div><br/></div></div></div></div></div></div><div id="40593862" class="c"><input type="checkbox" id="c-40593862" checked=""/><div class="controls bullet"><span class="by">paul_funyun</span><span>|</span><a href="#40592115">prev</a><span>|</span><a href="#40592000">next</a><span>|</span><label class="collapse" for="c-40593862">[-]</label><label class="expand" for="c-40593862">[1 more]</label></div><br/><div class="children"><div class="content">If you don&#x27;t need ipv6, best just to turn it off and forget about it.</div><br/></div></div><div id="40592000" class="c"><input type="checkbox" id="c-40592000" checked=""/><div class="controls bullet"><span class="by">Havoc</span><span>|</span><a href="#40593862">prev</a><span>|</span><a href="#40593728">next</a><span>|</span><label class="collapse" for="c-40592000">[-]</label><label class="expand" for="c-40592000">[4 more]</label></div><br/><div class="children"><div class="content">Curious why the FRITZ!Box is necessary? I know they popular in Germany but isn’t it like just a router OS?</div><br/><div id="40594605" class="c"><input type="checkbox" id="c-40594605" checked=""/><div class="controls bullet"><span class="by">pantalaimon</span><span>|</span><a href="#40592000">parent</a><span>|</span><a href="#40594697">next</a><span>|</span><label class="collapse" for="c-40594605">[-]</label><label class="expand" for="c-40594605">[1 more]</label></div><br/><div class="children"><div class="content">It’s one of the few home routers that implement DHCPv6 IA_PD</div><br/></div></div><div id="40594204" class="c"><input type="checkbox" id="c-40594204" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#40592000">parent</a><span>|</span><a href="#40594697">prev</a><span>|</span><a href="#40593728">next</a><span>|</span><label class="collapse" for="c-40594204">[-]</label><label class="expand" for="c-40594204">[1 more]</label></div><br/><div class="children"><div class="content">They frequently are also the DSL “modem” so you’re kinda stuck with them.</div><br/></div></div></div></div><div id="40593728" class="c"><input type="checkbox" id="c-40593728" checked=""/><div class="controls bullet"><span class="by">Uptrenda</span><span>|</span><a href="#40592000">prev</a><span>|</span><label class="collapse" for="c-40593728">[-]</label><label class="expand" for="c-40593728">[2 more]</label></div><br/><div class="children"><div class="content">People who advocate for IPv6 are always like &#x27;ahhhh just plug it in and its ready to go!!!&#x27; There&#x27;s even twitter accounts that shame people for how they approach IPv6. But after doing a crap load of network programming I can tell you its really not simple at all.<p>- IPv6 has many different address types.<p>- Depending on the type you want to bind to it needs to be handled different.<p>- Some types need an interface ID appended to them.<p>- This is conditional on the type of the OS.<p>- Windows has no easy way to get the ID programmatically.<p>- Some address types need additional bind info like the &#x27;scope id.&#x27;<p>- Whether you can reach a specific addr type in a con depend on the addr you bind to.<p>- IPv6 was designed to have plenty of addresses so that NAT isn&#x27;t needed. Guess what: IPv6 can still do NAT like NAT6. In which case you won&#x27;t have any nice global scope addresses to bind to.<p>Writing good network code depends on being able to list the interfaces on a machine and the addresses that they have. With IPv6 this is desirable since it lets you know if you have any global scope addresses, what your local-scope addresses are, and other kinds. But from what I&#x27;ve seen seen most programming languages fall back to using default routes for everything. This means that the programmer literally can&#x27;t lookup the addresses and interfaces for their software.<p>Also lastly: getting a modern router that properly supports IPv6 isn&#x27;t easy at all. I literally have a cupboard filled with PoS routers that can&#x27;t do IPv6 properly. Everything that Telstra and Optus tend to give customers; most Dovado routers; GL inet routers (can do NAT6 but who wants that); &#x27;netgear nighthawk&#x27; (I found a security vuln in netgears router when testing v6); and so on. People will say &#x27;just slap Open-wrt on something and call it a day.&#x27; But these are the kinds of people who will spend 120+ hours reading the open-wrt wiki and learning electronic basics to setup a custom router. What they think is &#x27;easy&#x27; doesn&#x27;t take into account all the time they&#x27;ve already spent learning such niche BS. I have better things to do than (((just waste 1 billion hours with open-wrt and end up with someone that still doesn&#x27;t work.)))<p>&#x27;IPv6 is easy. It just works.&#x27;</div><br/><div id="40594797" class="c"><input type="checkbox" id="c-40594797" checked=""/><div class="controls bullet"><span class="by">dcow</span><span>|</span><a href="#40593728">parent</a><span>|</span><label class="collapse" for="c-40594797">[-]</label><label class="expand" for="c-40594797">[1 more]</label></div><br/><div class="children"><div class="content">scopes are deprecated and link-local is only a thing so that the network can bootstrap itself. if you’re deploying ipv6 all you care about are global and ula, which are scope-less</div><br/></div></div></div></div></div></div></div></div></div></body></html>