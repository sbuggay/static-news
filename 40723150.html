<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1718787673584" as="style"/><link rel="stylesheet" href="styles.css?v=1718787673584"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.apnic.net/2024/06/18/off-path-tcp-hijacking-in-nat-enabled-wi-fi-networks/">Off-path TCP hijacking in NAT-enabled Wi-Fi networks</a> <span class="domain">(<a href="https://blog.apnic.net">blog.apnic.net</a>)</span></div><div class="subtext"><span>gtirloni</span> | <span>49 comments</span></div><br/><div><div id="40724468" class="c"><input type="checkbox" id="c-40724468" checked=""/><div class="controls bullet"><span class="by">egberts1</span><span>|</span><a href="#40726104">next</a><span>|</span><label class="collapse" for="c-40724468">[-]</label><label class="expand" for="c-40724468">[1 more]</label></div><br/><div class="children"><div class="content">A whitepaper detailing this CVE-2022-32296 attack.<p>Vulnerability is in Double-Hash Port Selection (DHPS, IETF RFC 6056)<p>Fixed in Linux 5.17.9 and above using a variant of DHPS.<p>Linux sysctl:<p>net.ipv4.conf.all.rp_filter = 1<p>net.ipv4.conf.default.rp_filter = 1<p>Also Firefox Only HTTPS must be enabled to prevent JavaScript from performing dwell on hidden unsecure HTTP DOM frame.<p>----<p><a href="https:&#x2F;&#x2F;support.mozilla.org&#x2F;mk&#x2F;questions&#x2F;1359401" rel="nofollow">https:&#x2F;&#x2F;support.mozilla.org&#x2F;mk&#x2F;questions&#x2F;1359401</a><p><a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2209.12993" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2209.12993</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;0xkol&#x2F;rfc6056-device-tracker">https:&#x2F;&#x2F;github.com&#x2F;0xkol&#x2F;rfc6056-device-tracker</a><p><a href="https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc6056.html" rel="nofollow">https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc6056.html</a></div><br/></div></div><div id="40726104" class="c"><input type="checkbox" id="c-40726104" checked=""/><div class="controls bullet"><span class="by">the8472</span><span>|</span><a href="#40724468">prev</a><span>|</span><a href="#40724573">next</a><span>|</span><label class="collapse" for="c-40726104">[-]</label><label class="expand" for="c-40726104">[2 more]</label></div><br/><div class="children"><div class="content">Since this is caused by many-to-one NATs IPv6 should be immune to this. Migrating to ipv6 should be listed as one of the mitigations.</div><br/><div id="40726241" class="c"><input type="checkbox" id="c-40726241" checked=""/><div class="controls bullet"><span class="by">suprjami</span><span>|</span><a href="#40726104">parent</a><span>|</span><a href="#40724573">next</a><span>|</span><label class="collapse" for="c-40726241">[-]</label><label class="expand" for="c-40726241">[1 more]</label></div><br/><div class="children"><div class="content">Good thing the IEEE recommended against implementing IPv6 NAT and everyone followed that rec- oh, wait.</div><br/></div></div></div></div><div id="40724573" class="c"><input type="checkbox" id="c-40724573" checked=""/><div class="controls bullet"><span class="by">blahgeek</span><span>|</span><a href="#40726104">prev</a><span>|</span><a href="#40725913">next</a><span>|</span><label class="collapse" for="c-40724573">[-]</label><label class="expand" for="c-40724573">[7 more]</label></div><br/><div class="children"><div class="content">Is it common for routers to create a new mapping for TCP packets that is NOT SYN (in figure 3 in this article)? Is there a legit use case for this behavior? Wouldn&#x27;t it be simpler and more secure not to do that?</div><br/><div id="40725165" class="c"><input type="checkbox" id="c-40725165" checked=""/><div class="controls bullet"><span class="by">ytch</span><span>|</span><a href="#40724573">parent</a><span>|</span><a href="#40725934">next</a><span>|</span><label class="collapse" for="c-40725165">[-]</label><label class="expand" for="c-40725165">[3 more]</label></div><br/><div class="children"><div class="content">T̶a̶i̶l̶s̶c̶a̶l̶e̶: <a href="https:&#x2F;&#x2F;tailscale.com&#x2F;blog&#x2F;how-nat-traversal-works" rel="nofollow">https:&#x2F;&#x2F;tailscale.com&#x2F;blog&#x2F;how-nat-traversal-works</a><p>Libp2p: <a href="https:&#x2F;&#x2F;docs.libp2p.io&#x2F;concepts&#x2F;nat&#x2F;hole-punching&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.libp2p.io&#x2F;concepts&#x2F;nat&#x2F;hole-punching&#x2F;</a><p>B̶o̶t̶h̶ (update: Only Libp2p works with TCP) use similar method for hold-punching. Libp2p can use such method for establishing direct connection between hosts behind different NAT networks.</div><br/><div id="40725306" class="c"><input type="checkbox" id="c-40725306" checked=""/><div class="controls bullet"><span class="by">mkj</span><span>|</span><a href="#40724573">root</a><span>|</span><a href="#40725165">parent</a><span>|</span><a href="#40725934">next</a><span>|</span><label class="collapse" for="c-40725306">[-]</label><label class="expand" for="c-40725306">[2 more]</label></div><br/><div class="children"><div class="content">The tailscale one at least isn&#x27;t TCP, it&#x27;s UDP</div><br/><div id="40725349" class="c"><input type="checkbox" id="c-40725349" checked=""/><div class="controls bullet"><span class="by">ytch</span><span>|</span><a href="#40724573">root</a><span>|</span><a href="#40725306">parent</a><span>|</span><a href="#40725934">next</a><span>|</span><label class="collapse" for="c-40725349">[-]</label><label class="expand" for="c-40725349">[1 more]</label></div><br/><div class="children"><div class="content">My bad, I forget about this.</div><br/></div></div></div></div></div></div><div id="40725934" class="c"><input type="checkbox" id="c-40725934" checked=""/><div class="controls bullet"><span class="by">patrakov</span><span>|</span><a href="#40724573">parent</a><span>|</span><a href="#40725165">prev</a><span>|</span><a href="#40725775">next</a><span>|</span><label class="collapse" for="c-40725934">[-]</label><label class="expand" for="c-40725934">[2 more]</label></div><br/><div class="children"><div class="content">The legit use case is to pick up connections that were established before the router reboot.</div><br/><div id="40726223" class="c"><input type="checkbox" id="c-40726223" checked=""/><div class="controls bullet"><span class="by">blahgeek</span><span>|</span><a href="#40724573">root</a><span>|</span><a href="#40725934">parent</a><span>|</span><a href="#40725775">next</a><span>|</span><label class="collapse" for="c-40726223">[-]</label><label class="expand" for="c-40726223">[1 more]</label></div><br/><div class="children"><div class="content">If the router reboots, it cannot remember the correct mapping of the last connection, right? (The mapped port may not be the original source port)</div><br/></div></div></div></div><div id="40725775" class="c"><input type="checkbox" id="c-40725775" checked=""/><div class="controls bullet"><span class="by">damsalor</span><span>|</span><a href="#40724573">parent</a><span>|</span><a href="#40725934">prev</a><span>|</span><a href="#40725913">next</a><span>|</span><label class="collapse" for="c-40725775">[-]</label><label class="expand" for="c-40725775">[1 more]</label></div><br/><div class="children"><div class="content">The answer to this might be severely unsettling</div><br/></div></div></div></div><div id="40725913" class="c"><input type="checkbox" id="c-40725913" checked=""/><div class="controls bullet"><span class="by">hamilyon2</span><span>|</span><a href="#40724573">prev</a><span>|</span><a href="#40724627">next</a><span>|</span><label class="collapse" for="c-40725913">[-]</label><label class="expand" for="c-40725913">[3 more]</label></div><br/><div class="children"><div class="content">I always found it astonishing that security and integrity of the internet often rests upon “but TCP sequence numbers are unguessable”</div><br/><div id="40726272" class="c"><input type="checkbox" id="c-40726272" checked=""/><div class="controls bullet"><span class="by">suprjami</span><span>|</span><a href="#40725913">parent</a><span>|</span><a href="#40724627">next</a><span>|</span><label class="collapse" for="c-40726272">[-]</label><label class="expand" for="c-40726272">[2 more]</label></div><br/><div class="children"><div class="content">TCP sequence numbers are not a security mechanism, they are a data ordering mechanism. If you want security, use encryption like IPSec or TLS. This has been the state of things since TCP was invented in 1980. Someone new discovers it all the time.</div><br/><div id="40726326" class="c"><input type="checkbox" id="c-40726326" checked=""/><div class="controls bullet"><span class="by">sambazi</span><span>|</span><a href="#40725913">root</a><span>|</span><a href="#40726272">parent</a><span>|</span><a href="#40724627">next</a><span>|</span><label class="collapse" for="c-40726326">[-]</label><label class="expand" for="c-40726326">[1 more]</label></div><br/><div class="children"><div class="content">security is never perfect and the bar is rising.<p>sequence numbers were once considered &#x27;good enough&#x27; as prime-factors are today</div><br/></div></div></div></div></div></div><div id="40724627" class="c"><input type="checkbox" id="c-40724627" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#40725913">prev</a><span>|</span><a href="#40723824">next</a><span>|</span><label class="collapse" for="c-40724627">[-]</label><label class="expand" for="c-40724627">[1 more]</label></div><br/><div class="children"><div class="content">Always nice to have more security arguments against NAT.</div><br/></div></div><div id="40723824" class="c"><input type="checkbox" id="c-40723824" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#40724627">prev</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40723824">[-]</label><label class="expand" for="c-40723824">[16 more]</label></div><br/><div class="children"><div class="content">Feels much less scary in 2024.. when was the last time you used HTTP for anything important?</div><br/><div id="40723965" class="c"><input type="checkbox" id="c-40723965" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#40723824">parent</a><span>|</span><a href="#40724184">next</a><span>|</span><label class="collapse" for="c-40723965">[-]</label><label class="expand" for="c-40723965">[7 more]</label></div><br/><div class="children"><div class="content">These are not theoretical concerns though. For example, since SSH uses a trust on first use model as opposed to a central trust&#x2F;web of trust model, they can direct the victim to a different SSH server if they&#x27;re connecting to a new one, and intercept all traffic.<p>(Edit: Even with HTTPS, there are other ways to MITM a connection because each trusted CA is considered an equal. For example, instead of doing a full-on MITM on a service which is likely to be detected[1], a better solution may be to obtain a certificate and target the specific user.)<p>[1] <a href="http:&#x2F;&#x2F;notes.valdikss.org.ru&#x2F;jabber.ru-mitm&#x2F;" rel="nofollow">http:&#x2F;&#x2F;notes.valdikss.org.ru&#x2F;jabber.ru-mitm&#x2F;</a></div><br/><div id="40724848" class="c"><input type="checkbox" id="c-40724848" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723965">parent</a><span>|</span><a href="#40724251">next</a><span>|</span><label class="collapse" for="c-40724848">[-]</label><label class="expand" for="c-40724848">[3 more]</label></div><br/><div class="children"><div class="content">Re SSH: sure, it can happen, but in practice I&#x27;d rate this pretty low with most SSH users...<p>(1) You need new host which hasn&#x27;t been TOFU&#x27;d yet, and you need it to be exposed to internet with no VPN&#x2F;mesh inbetween.<p>(2) You need password-based authentication _or_ agent forwarding, otherwise you won&#x27;t be able to intercept traffic (with key-based auth, you can pretend to be the server, but that won&#x27;t likely to last long). While I would not say that everyone uses key-based ssh, they should! It&#x27;s an easy way to significantly increase your SSH security level.<p>As for HTTPs MITM, I don&#x27;t see how this applies. They had to intercept traffic next to a server to be able to issue certificate - and I am pretty sure no one runs servers from the untrusted coffee shop connection! And you already have access to the server&#x27;s datacenter, then there is no need to exploit public WiFi, you can intercept the server&#x27;s traffic directly.</div><br/><div id="40725556" class="c"><input type="checkbox" id="c-40725556" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724848">parent</a><span>|</span><a href="#40725487">next</a><span>|</span><label class="collapse" for="c-40725556">[-]</label><label class="expand" for="c-40725556">[1 more]</label></div><br/><div class="children"><div class="content">The HTTPS MITM case doesn&#x27;t need to intercept close to the server, it just needs to know that Victim is trying to talk to a particular server. Then, they obtain a forged certificate, and use the same mechanism shown here to intercept the TLS ClientHello and pretend to be the TLS server, with the legitimate certificate. The reason this works is because in a targetted attack, it&#x27;s much less likely that the improperly issued certificate would become public and (1) be revoked, and (2) cause problems for the CA that issued it.</div><br/></div></div><div id="40725487" class="c"><input type="checkbox" id="c-40725487" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724848">parent</a><span>|</span><a href="#40725556">prev</a><span>|</span><a href="#40724251">next</a><span>|</span><label class="collapse" for="c-40725487">[-]</label><label class="expand" for="c-40725487">[1 more]</label></div><br/><div class="children"><div class="content">2: key based ssh won&#x27;t really help and isn&#x27;t the magic bullet people seem to believe. Especially nonencrypted ssh keys which is what the majority uses.</div><br/></div></div></div></div><div id="40724251" class="c"><input type="checkbox" id="c-40724251" checked=""/><div class="controls bullet"><span class="by">foobiekr</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723965">parent</a><span>|</span><a href="#40724848">prev</a><span>|</span><a href="#40726044">next</a><span>|</span><label class="collapse" for="c-40724251">[-]</label><label class="expand" for="c-40724251">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;files&#x2F;login&#x2F;articles&#x2F;105484-Gutmann.pdf" rel="nofollow">https:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;files&#x2F;login&#x2F;articles&#x2F;105484-Gu...</a><p>Abstract: No.</div><br/></div></div><div id="40726044" class="c"><input type="checkbox" id="c-40726044" checked=""/><div class="controls bullet"><span class="by">megous</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723965">parent</a><span>|</span><a href="#40724251">prev</a><span>|</span><a href="#40723974">next</a><span>|</span><label class="collapse" for="c-40726044">[-]</label><label class="expand" for="c-40726044">[1 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;since SSH uses a trust on first use model&quot;<p>...can use...</div><br/></div></div><div id="40723974" class="c"><input type="checkbox" id="c-40723974" checked=""/><div class="controls bullet"><span class="by">SebFender</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723965">parent</a><span>|</span><a href="#40726044">prev</a><span>|</span><a href="#40724184">next</a><span>|</span><label class="collapse" for="c-40723974">[-]</label><label class="expand" for="c-40723974">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s another great example - perfect comment.</div><br/></div></div></div></div><div id="40724184" class="c"><input type="checkbox" id="c-40724184" checked=""/><div class="controls bullet"><span class="by">fullspectrumdev</span><span>|</span><a href="#40723824">parent</a><span>|</span><a href="#40723965">prev</a><span>|</span><a href="#40723969">next</a><span>|</span><label class="collapse" for="c-40724184">[-]</label><label class="expand" for="c-40724184">[1 more]</label></div><br/><div class="children"><div class="content">From recent efforts sniffing packets in public areas to specifically try answer this question: there’s still an assload of plaintext HTTP.</div><br/></div></div><div id="40723969" class="c"><input type="checkbox" id="c-40723969" checked=""/><div class="controls bullet"><span class="by">SebFender</span><span>|</span><a href="#40723824">parent</a><span>|</span><a href="#40724184">prev</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40723969">[-]</label><label class="expand" for="c-40723969">[7 more]</label></div><br/><div class="children"><div class="content">Never think HTTPS will save you from proxies built by attackers... This may make it much simpler...</div><br/><div id="40724872" class="c"><input type="checkbox" id="c-40724872" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723969">parent</a><span>|</span><a href="#40724346">next</a><span>|</span><label class="collapse" for="c-40724872">[-]</label><label class="expand" for="c-40724872">[1 more]</label></div><br/><div class="children"><div class="content">Sure they will, given Chrome&#x27;s requirement for CT logs, any attacker-issued certificates will be logged, someone will find the suspicious record, and the method will likely be burned from all the publicity.<p>I have no doubt that there maybe a few dozen people in the entire world who would get attacked this way, but the chances it would be me are pretty much zero.</div><br/></div></div><div id="40724346" class="c"><input type="checkbox" id="c-40724346" checked=""/><div class="controls bullet"><span class="by">SteveNuts</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40723969">parent</a><span>|</span><a href="#40724872">prev</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40724346">[-]</label><label class="expand" for="c-40724346">[5 more]</label></div><br/><div class="children"><div class="content">Wouldn’t there still need to be a major vulnerability with the TLS library your client is using?</div><br/><div id="40724392" class="c"><input type="checkbox" id="c-40724392" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724346">parent</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40724392">[-]</label><label class="expand" for="c-40724392">[4 more]</label></div><br/><div class="children"><div class="content">You can obtain a certificate for the domain in question (easier if you are a nation-state) and MITM that specific user.</div><br/><div id="40725235" class="c"><input type="checkbox" id="c-40725235" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724392">parent</a><span>|</span><a href="#40724876">next</a><span>|</span><label class="collapse" for="c-40725235">[-]</label><label class="expand" for="c-40725235">[1 more]</label></div><br/><div class="children"><div class="content">How does one bypass certificate transparency? I tend to exclude state actors from my threat models (1. they tend to be the all-powerful boogeyman that bypasses all threat models anyways, and 2. I doubt that the NSA is going to get you by way of coffee shop wifi) but I&#x27;m actually struggling to see how even they would bypass this particular protection; if Chrome only trusts CT-logged certs, even a targeted one-off is likely to be discovered (albeit, AIUI, after the fact).</div><br/></div></div><div id="40724876" class="c"><input type="checkbox" id="c-40724876" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724392">parent</a><span>|</span><a href="#40725235">prev</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40724876">[-]</label><label class="expand" for="c-40724876">[2 more]</label></div><br/><div class="children"><div class="content">... but you need to MITM server to obtain certificate, and if you can MITM server, why bother with user&#x27;s wifi?</div><br/><div id="40725130" class="c"><input type="checkbox" id="c-40725130" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#40723824">root</a><span>|</span><a href="#40724876">parent</a><span>|</span><a href="#40724012">next</a><span>|</span><label class="collapse" for="c-40725130">[-]</label><label class="expand" for="c-40725130">[1 more]</label></div><br/><div class="children"><div class="content">Because it’s easier that the server be MITMed for a shorter duration to prevent discovery[1]. It’s also easier if you can just strong arm the CA to issue a certificate or have the shady CA issue it[2][3].<p>[1] <a href="http:&#x2F;&#x2F;notes.valdikss.org.ru&#x2F;jabber.ru-mitm&#x2F;" rel="nofollow">http:&#x2F;&#x2F;notes.valdikss.org.ru&#x2F;jabber.ru-mitm&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;www.wired.com&#x2F;2010&#x2F;03&#x2F;packet-forensics&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.wired.com&#x2F;2010&#x2F;03&#x2F;packet-forensics&#x2F;</a><p>[3] <a href="https:&#x2F;&#x2F;bugzilla.mozilla.org&#x2F;show_bug.cgi?id=1391063" rel="nofollow">https:&#x2F;&#x2F;bugzilla.mozilla.org&#x2F;show_bug.cgi?id=1391063</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40724012" class="c"><input type="checkbox" id="c-40724012" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#40723824">prev</a><span>|</span><a href="#40723984">next</a><span>|</span><label class="collapse" for="c-40724012">[-]</label><label class="expand" for="c-40724012">[5 more]</label></div><br/><div class="children"><div class="content">Anyone know if the MASQUERADE support in Linux iptables is affected by this?  Or how I could tell?</div><br/><div id="40724222" class="c"><input type="checkbox" id="c-40724222" checked=""/><div class="controls bullet"><span class="by">zootboy</span><span>|</span><a href="#40724012">parent</a><span>|</span><a href="#40724198">next</a><span>|</span><label class="collapse" for="c-40724222">[-]</label><label class="expand" for="c-40724222">[1 more]</label></div><br/><div class="children"><div class="content">Well, of the three mitigations suggested in the article:<p>1 - Random NAT port allocation<p>Seems like the answer is &quot;not by default.&quot; According to iptables(8), SNAT defaults to using the pre-translated ports whenever possible, so it&#x27;s up to the connecting client (victim&#x27;s TCP stack) to randomly select source ports. There is a &quot;--to-ports&quot; option that lets you limit the usable source ports, but it&#x27;s not mentioned how the ports are selected in that case.<p>2 - Reverse Path Validation<p>I&#x27;m not really sure how this helps in the described situation. If the attacker and the victim are on the same wifi access point, then both of their traffic will be sourced from the same network interface, so even strict RFC 3704 validation will pass for spoofed packets from the attacker. But for completeness, you can turn that on by setting a sysctl (rp_filter = 1).<p>3 - TCP window checking<p>I _believe_ that the vanilla linux kernel does check this by default, as the mentioned adjustments to OpenWRT seem to be removing a non-standard option to disable the TCP window checking<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openwrt&#x2F;openwrt&#x2F;commit&#x2F;75e78bcaab847557ce1782eb2dea9dff9a029171">https:&#x2F;&#x2F;github.com&#x2F;openwrt&#x2F;openwrt&#x2F;commit&#x2F;75e78bcaab847557ce...</a></div><br/></div></div><div id="40724198" class="c"><input type="checkbox" id="c-40724198" checked=""/><div class="controls bullet"><span class="by">lathiat</span><span>|</span><a href="#40724012">parent</a><span>|</span><a href="#40724222">prev</a><span>|</span><a href="#40724249">next</a><span>|</span><label class="collapse" for="c-40724198">[-]</label><label class="expand" for="c-40724198">[2 more]</label></div><br/><div class="children"><div class="content">I would have assumed linux conntrack to do more rigorous &quot;tcp window checking&quot; as an assumption, however the article also notes they received a positive response from OpenWRT who implemented a mitigation, so I am curious to see the details of that mitigation.</div><br/><div id="40725230" class="c"><input type="checkbox" id="c-40725230" checked=""/><div class="controls bullet"><span class="by">taneliv</span><span>|</span><a href="#40724012">root</a><span>|</span><a href="#40724198">parent</a><span>|</span><a href="#40724249">next</a><span>|</span><label class="collapse" for="c-40725230">[-]</label><label class="expand" for="c-40725230">[1 more]</label></div><br/><div class="children"><div class="content">As user zootboy above comments, OpenWRT removed a patch from their kernels that introduced a &quot;no window checking&quot; option for TCP processing,[1] which I suppose was enabled by default.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;openwrt&#x2F;openwrt&#x2F;commit&#x2F;75e78bcaab847557ce1782eb2dea9dff9a029171">https:&#x2F;&#x2F;github.com&#x2F;openwrt&#x2F;openwrt&#x2F;commit&#x2F;75e78bcaab847557ce...</a></div><br/></div></div></div></div><div id="40724249" class="c"><input type="checkbox" id="c-40724249" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#40724012">parent</a><span>|</span><a href="#40724198">prev</a><span>|</span><a href="#40723984">next</a><span>|</span><label class="collapse" for="c-40724249">[-]</label><label class="expand" for="c-40724249">[1 more]</label></div><br/><div class="children"><div class="content">In general there are usually rules that prevent cross-forwarding traffic, and thus traffic over wifi is isolated from each client (unless you need to share a home NAS&#x2F;printer this should remain enabled.)<p>Most if not all modern routers have this feature, and also the ability to turn off the dumpster-fire that is UPnP and flaky port-trigger mods. Additionally, some add packet marking rules, which is often also used to enforce fair bandwidth sharing. Yet note this can be a nonstandard controversial gray-area.<p>One could also use a private cert based VPN + Kerberos with firewall client pre-set rules on any un-trusted&#x2F;open access points.<p>YMMV, =3</div><br/></div></div></div></div><div id="40723984" class="c"><input type="checkbox" id="c-40723984" checked=""/><div class="controls bullet"><span class="by">binkHN</span><span>|</span><a href="#40724012">prev</a><span>|</span><a href="#40724037">next</a><span>|</span><label class="collapse" for="c-40723984">[-]</label><label class="expand" for="c-40723984">[2 more]</label></div><br/><div class="children"><div class="content">Ouch. I bet the majority of coffee shops are affected.</div><br/><div id="40724080" class="c"><input type="checkbox" id="c-40724080" checked=""/><div class="controls bullet"><span class="by">hackernudes</span><span>|</span><a href="#40723984">parent</a><span>|</span><a href="#40724037">next</a><span>|</span><label class="collapse" for="c-40724080">[-]</label><label class="expand" for="c-40724080">[1 more]</label></div><br/><div class="children"><div class="content">Would client isolation prevent the attacker at the layer 2 level?</div><br/></div></div></div></div><div id="40724037" class="c"><input type="checkbox" id="c-40724037" checked=""/><div class="controls bullet"><span class="by">vzaliva</span><span>|</span><a href="#40723984">prev</a><span>|</span><a href="#40724099">next</a><span>|</span><label class="collapse" for="c-40724037">[-]</label><label class="expand" for="c-40724037">[6 more]</label></div><br/><div class="children"><div class="content">I assume a VPN should mitigate these attacks?</div><br/><div id="40724205" class="c"><input type="checkbox" id="c-40724205" checked=""/><div class="controls bullet"><span class="by">bustling-noose</span><span>|</span><a href="#40724037">parent</a><span>|</span><a href="#40724257">next</a><span>|</span><label class="collapse" for="c-40724205">[-]</label><label class="expand" for="c-40724205">[3 more]</label></div><br/><div class="children"><div class="content">You might still experience DOS attacks.</div><br/><div id="40724438" class="c"><input type="checkbox" id="c-40724438" checked=""/><div class="controls bullet"><span class="by">vzaliva</span><span>|</span><a href="#40724037">root</a><span>|</span><a href="#40724205">parent</a><span>|</span><a href="#40724257">next</a><span>|</span><label class="collapse" for="c-40724438">[-]</label><label class="expand" for="c-40724438">[2 more]</label></div><br/><div class="children"><div class="content">But only if my VPN is using TCP transport, right?</div><br/><div id="40726090" class="c"><input type="checkbox" id="c-40726090" checked=""/><div class="controls bullet"><span class="by">bustling-noose</span><span>|</span><a href="#40724037">root</a><span>|</span><a href="#40724438">parent</a><span>|</span><a href="#40724257">next</a><span>|</span><label class="collapse" for="c-40726090">[-]</label><label class="expand" for="c-40726090">[1 more]</label></div><br/><div class="children"><div class="content">Yes. With UDP VPN this shouldn’t be a problem I guess.</div><br/></div></div></div></div></div></div><div id="40724257" class="c"><input type="checkbox" id="c-40724257" checked=""/><div class="controls bullet"><span class="by">johnklos</span><span>|</span><a href="#40724037">parent</a><span>|</span><a href="#40724205">prev</a><span>|</span><a href="#40724099">next</a><span>|</span><label class="collapse" for="c-40724257">[-]</label><label class="expand" for="c-40724257">[2 more]</label></div><br/><div class="children"><div class="content">No.</div><br/><div id="40724312" class="c"><input type="checkbox" id="c-40724312" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#40724037">root</a><span>|</span><a href="#40724257">parent</a><span>|</span><a href="#40724099">next</a><span>|</span><label class="collapse" for="c-40724312">[-]</label><label class="expand" for="c-40724312">[1 more]</label></div><br/><div class="children"><div class="content">Kerberos</div><br/></div></div></div></div></div></div><div id="40724099" class="c"><input type="checkbox" id="c-40724099" checked=""/><div class="controls bullet"><span class="by">MacrohardDoors</span><span>|</span><a href="#40724037">prev</a><span>|</span><label class="collapse" for="c-40724099">[-]</label><label class="expand" for="c-40724099">[5 more]</label></div><br/><div class="children"><div class="content">If only my iPhone had an ethernet port, I’d be able to go completely wifi free.</div><br/><div id="40724120" class="c"><input type="checkbox" id="c-40724120" checked=""/><div class="controls bullet"><span class="by">khrbtxyz</span><span>|</span><a href="#40724099">parent</a><span>|</span><a href="#40724250">next</a><span>|</span><label class="collapse" for="c-40724120">[-]</label><label class="expand" for="c-40724120">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.apple.com&#x2F;shop&#x2F;product&#x2F;HMJU2ZM&#x2F;A&#x2F;belkin-ethernet-power-adapter-with-lightning-connector" rel="nofollow">https:&#x2F;&#x2F;www.apple.com&#x2F;shop&#x2F;product&#x2F;HMJU2ZM&#x2F;A&#x2F;belkin-ethernet...</a></div><br/><div id="40724158" class="c"><input type="checkbox" id="c-40724158" checked=""/><div class="controls bullet"><span class="by">bustling-noose</span><span>|</span><a href="#40724099">root</a><span>|</span><a href="#40724120">parent</a><span>|</span><a href="#40724250">next</a><span>|</span><label class="collapse" for="c-40724158">[-]</label><label class="expand" for="c-40724158">[2 more]</label></div><br/><div class="children"><div class="content">With usb c this is even cheaper and easier.</div><br/><div id="40726096" class="c"><input type="checkbox" id="c-40726096" checked=""/><div class="controls bullet"><span class="by">tichiian</span><span>|</span><a href="#40724099">root</a><span>|</span><a href="#40724158">parent</a><span>|</span><a href="#40724250">next</a><span>|</span><label class="collapse" for="c-40726096">[-]</label><label class="expand" for="c-40726096">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d guess apple would invent some &quot;made for iCrap&quot; certification plus parts authentication to keep prices up and skim off some money for themselves.</div><br/></div></div></div></div></div></div><div id="40724250" class="c"><input type="checkbox" id="c-40724250" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#40724099">parent</a><span>|</span><a href="#40724120">prev</a><span>|</span><label class="collapse" for="c-40724250">[-]</label><label class="expand" for="c-40724250">[1 more]</label></div><br/><div class="children"><div class="content">You can make a local bluetooth network, too.</div><br/></div></div></div></div></div></div></div></div></div></body></html>