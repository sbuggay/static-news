<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1694682063342" as="style"/><link rel="stylesheet" href="styles.css?v=1694682063342"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.masteringemacs.org/article/lets-write-a-treesitter-major-mode">Let&#x27;s write a treesitter major mode for Emacs</a>Â <span class="domain">(<a href="https://www.masteringemacs.org">www.masteringemacs.org</a>)</span></div><div class="subtext"><span>nanna</span> | <span>11 comments</span></div><br/><div><div id="37506107" class="c"><input type="checkbox" id="c-37506107" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><label class="collapse" for="c-37506107">[-]</label><label class="expand" for="c-37506107">[10 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not trying to bash Emacs or treesitter or anyone. But I find it mildly amusing that after so many decades, parsing and syntax highlighting aren&#x27;t a perfectly solved problem, considering programming languages are the most used tools for developers.</div><br/><div id="37506470" class="c"><input type="checkbox" id="c-37506470" checked=""/><div class="controls bullet"><span class="by">petepete</span><span>|</span><a href="#37506107">parent</a><span>|</span><a href="#37506414">next</a><span>|</span><label class="collapse" for="c-37506470">[-]</label><label class="expand" for="c-37506470">[1 more]</label></div><br/><div class="children"><div class="content">Until TreeSitter came along the effort to add support for new languages to your editor would be gargantuan.<p>Now it&#x27;s much, much easier providing there&#x27;s a TreeSitter parser for your language.<p>I don&#x27;t know of anything else that bridges the gap like this.</div><br/></div></div><div id="37506414" class="c"><input type="checkbox" id="c-37506414" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#37506107">parent</a><span>|</span><a href="#37506470">prev</a><span>|</span><a href="#37506175">next</a><span>|</span><label class="collapse" for="c-37506414">[-]</label><label class="expand" for="c-37506414">[1 more]</label></div><br/><div class="children"><div class="content">The languages extension strategies for CSS pretifiers are usually pretty reasonable.<p>In editors this always seems extremely esoteric comparatively : I&#x27;ve tried doing it in a few.<p>I&#x27;m sure brilliant people find it easy, but I&#x27;m merely average on a good day.</div><br/></div></div><div id="37506175" class="c"><input type="checkbox" id="c-37506175" checked=""/><div class="controls bullet"><span class="by">thih9</span><span>|</span><a href="#37506107">parent</a><span>|</span><a href="#37506414">prev</a><span>|</span><a href="#37506301">next</a><span>|</span><label class="collapse" for="c-37506175">[-]</label><label class="expand" for="c-37506175">[6 more]</label></div><br/><div class="children"><div class="content">What would you consider a perfectly solved problem in this case? I.e. how is current development experience bad and how it could be better?</div><br/><div id="37506442" class="c"><input type="checkbox" id="c-37506442" checked=""/><div class="controls bullet"><span class="by">craftkiller</span><span>|</span><a href="#37506107">root</a><span>|</span><a href="#37506175">parent</a><span>|</span><a href="#37506309">next</a><span>|</span><label class="collapse" for="c-37506442">[-]</label><label class="expand" for="c-37506442">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not the GP, but personally I&#x27;d consider syntax highlighting perfectly solved if it was handled in the language server. That way we could have highlighting performed by 100% accurate parsers instead of approximations. It wouldn&#x27;t be as fast as in-editor simple tree-sitter highlighting, but I don&#x27;t see any issue with my text appearing uncolored at first and gaining color as my editor polls the language server as I type.<p>Currently language servers support semantic highlighting which is close, but as far as I can tell, it seems meant to be supplemental to in-editor local highlighting rather than a full replacement.</div><br/><div id="37506500" class="c"><input type="checkbox" id="c-37506500" checked=""/><div class="controls bullet"><span class="by">pawelmurias</span><span>|</span><a href="#37506107">root</a><span>|</span><a href="#37506442">parent</a><span>|</span><a href="#37506480">next</a><span>|</span><label class="collapse" for="c-37506500">[-]</label><label class="expand" for="c-37506500">[1 more]</label></div><br/><div class="children"><div class="content">You would only get the top half of your code highlighted because a compiler doesnt usually continue when encountering syntax errors due to partial code</div><br/></div></div><div id="37506480" class="c"><input type="checkbox" id="c-37506480" checked=""/><div class="controls bullet"><span class="by">morelisp</span><span>|</span><a href="#37506107">root</a><span>|</span><a href="#37506442">parent</a><span>|</span><a href="#37506500">prev</a><span>|</span><a href="#37506309">next</a><span>|</span><label class="collapse" for="c-37506480">[-]</label><label class="expand" for="c-37506480">[1 more]</label></div><br/><div class="children"><div class="content">But you want syntax highlighting performed by approximations, because when editing your code is only approximately valid.</div><br/></div></div></div></div><div id="37506309" class="c"><input type="checkbox" id="c-37506309" checked=""/><div class="controls bullet"><span class="by">raincole</span><span>|</span><a href="#37506107">root</a><span>|</span><a href="#37506175">parent</a><span>|</span><a href="#37506442">prev</a><span>|</span><a href="#37506301">next</a><span>|</span><label class="collapse" for="c-37506309">[-]</label><label class="expand" for="c-37506309">[2 more]</label></div><br/><div class="children"><div class="content">In a perfect world of emacs&#x2F;tree-sitter, I would imagine tree-sitter to be a single minor mode. You don&#x27;t need &#x27;java-ts-mode&#x27; and &#x27;c-ts-mode&#x27;. Just a single &#x27;treesitter-mode&#x27; toggle and it will call the treesitter binary to do the hard lifting.<p>I guess the reality just isn&#x27;t so rosy.</div><br/><div id="37506433" class="c"><input type="checkbox" id="c-37506433" checked=""/><div class="controls bullet"><span class="by">roenxi</span><span>|</span><a href="#37506107">root</a><span>|</span><a href="#37506309">parent</a><span>|</span><a href="#37506301">next</a><span>|</span><label class="collapse" for="c-37506433">[-]</label><label class="expand" for="c-37506433">[1 more]</label></div><br/><div class="children"><div class="content">A `treesitter-mode` is a so-so idea, because the way different languages are interacted with is different. The way lisp sexp handle in an IDE is different from Python&#x27;s syntax. It doesn&#x27;t make sense to try and have one mode that handles both - it is better to have many modes that interact with the common data structures that treesitter provides and then starts to provide specific convenience functions.<p>Even if all it was supposed to do is syntax highlighting, different languages are usually highlighted differently and presumably the person maintianing the bindings would need to be a language expert with strong opinions. The options are they either maintain their own mode or a module in `treesitter-mode` which is basically 2 ways of describing the same situation.<p>Although to address your other point it is quite funny that after 40 years and 29 versions of experimenting in OS design, GNU Emacs is starting to implement syntax highlighting properly for its system text editor.</div><br/></div></div></div></div></div></div><div id="37506301" class="c"><input type="checkbox" id="c-37506301" checked=""/><div class="controls bullet"><span class="by">troupo</span><span>|</span><a href="#37506107">parent</a><span>|</span><a href="#37506175">prev</a><span>|</span><label class="collapse" for="c-37506301">[-]</label><label class="expand" for="c-37506301">[1 more]</label></div><br/><div class="children"><div class="content">The problem is that a good editor-compatible tool for parsing and syntax highlighting is at cross-purposes with what you want from a compiler.<p>A good overview here: <a href="https:&#x2F;&#x2F;matklad.github.io&#x2F;2022&#x2F;04&#x2F;25&#x2F;why-lsp.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;matklad.github.io&#x2F;2022&#x2F;04&#x2F;25&#x2F;why-lsp.html</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>