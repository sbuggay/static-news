<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1724058071688" as="style"/><link rel="stylesheet" href="styles.css?v=1724058071688"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.nelhage.com/post/stripe-dev-environment/">Stripe&#x27;s Monorepo Developer Environment</a> <span class="domain">(<a href="https://blog.nelhage.com">blog.nelhage.com</a>)</span></div><div class="subtext"><span>edran</span> | <span>8 comments</span></div><br/><div><div id="41288845" class="c"><input type="checkbox" id="c-41288845" checked=""/><div class="controls bullet"><span class="by">domenkozar</span><span>|</span><a href="#41289063">next</a><span>|</span><label class="collapse" for="c-41288845">[-]</label><label class="expand" for="c-41288845">[3 more]</label></div><br/><div class="children"><div class="content">We&#x27;ve been building <a href="https:&#x2F;&#x2F;devenv.sh" rel="nofollow">https:&#x2F;&#x2F;devenv.sh</a> for that reason, I expect more companies to go back to local development once they see DX has improved locally.</div><br/><div id="41289067" class="c"><input type="checkbox" id="c-41289067" checked=""/><div class="controls bullet"><span class="by">evnix</span><span>|</span><a href="#41288845">parent</a><span>|</span><a href="#41289063">next</a><span>|</span><label class="collapse" for="c-41289067">[-]</label><label class="expand" for="c-41289067">[2 more]</label></div><br/><div class="children"><div class="content">How is this better or different from tools like dev which use docker</div><br/><div id="41289158" class="c"><input type="checkbox" id="c-41289158" checked=""/><div class="controls bullet"><span class="by">drakerossman</span><span>|</span><a href="#41288845">root</a><span>|</span><a href="#41289067">parent</a><span>|</span><a href="#41289063">next</a><span>|</span><label class="collapse" for="c-41289158">[-]</label><label class="expand" for="c-41289158">[1 more]</label></div><br/><div class="children"><div class="content">It (obviously) leverages Nix, which in turn means the environment is declarative and fully reproducible (not &quot;reproducible&quot; as in docker). Now, you can use just Nix&#x27;s devShells, but with devenv you have a middleground between just Nix package manager and a full fledged NixOS module system. Basically, write out one line of code - and you&#x27;ve got your Postgres, another one - full linter set up for whatever language you&#x27;re using, etc.</div><br/></div></div></div></div></div></div><div id="41289063" class="c"><input type="checkbox" id="c-41289063" checked=""/><div class="controls bullet"><span class="by">KolmogorovComp</span><span>|</span><a href="#41288845">prev</a><span>|</span><a href="#41288917">next</a><span>|</span><label class="collapse" for="c-41289063">[-]</label><label class="expand" for="c-41289063">[2 more]</label></div><br/><div class="children"><div class="content">&gt; In addition, Stripe’s monorepo was (to our knowledge) the largest Ruby codebase in existence<p>Bigger than shoppify&#x27;s?</div><br/><div id="41289191" class="c"><input type="checkbox" id="c-41289191" checked=""/><div class="controls bullet"><span class="by">Macha</span><span>|</span><a href="#41289063">parent</a><span>|</span><a href="#41288917">next</a><span>|</span><label class="collapse" for="c-41289191">[-]</label><label class="expand" for="c-41289191">[1 more]</label></div><br/><div class="children"><div class="content">So from a gut feeling that sounds right, finance is a pretty complicated domain with a lot of per vendor interactions, and Shopify outsources their payment stuff to Stripe.<p>Also on a headcount level, Google tells me Shopify has 3,500 employees to Stripe&#x27;s 9,500. Obviously neither company is compromised entirely of engineers, so this is a ballpark estimate.<p>GitHub feels like the real case where there might be a larger codebase. It&#x27;s in the middle for employees (6,500), but it&#x27;s existed longer than Stripe (though not as much longer as my gut feeling told me, interestingly)</div><br/></div></div></div></div><div id="41288917" class="c"><input type="checkbox" id="c-41288917" checked=""/><div class="controls bullet"><span class="by">reillys</span><span>|</span><a href="#41289063">prev</a><span>|</span><label class="collapse" for="c-41288917">[-]</label><label class="expand" for="c-41288917">[2 more]</label></div><br/><div class="children"><div class="content">I chatted to Nelson when I was designing brisk (<a href="https:&#x2F;&#x2F;github.com&#x2F;brisktest&#x2F;brisk">https:&#x2F;&#x2F;github.com&#x2F;brisktest&#x2F;brisk</a>) and his insight informed the development of it.<p>Among other things, Brisk allows you to run tests for your local code changes in the cloud (basically the pay mini test piece but for any test runner)<p>We also have a sync step much like the one described here and allow users to run one off commands (linters, tsc etc)</div><br/><div id="41289078" class="c"><input type="checkbox" id="c-41289078" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41288917">parent</a><span>|</span><label class="collapse" for="c-41289078">[-]</label><label class="expand" for="c-41289078">[1 more]</label></div><br/><div class="children"><div class="content">Can&#x27;t you achieve all that just using a build system with reliable remote builds &amp; caching e.g. Bazel, Buck, Please, etc?<p>That also avoids hacky sync scripts.</div><br/></div></div></div></div></div></div></div></div></div></body></html>