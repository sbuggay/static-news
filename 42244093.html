<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732698075277" as="style"/><link rel="stylesheet" href="styles.css?v=1732698075277"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.agwa.name/projects/git-crypt/">Git-crypt – transparent file encryption in Git</a> <span class="domain">(<a href="https://www.agwa.name">www.agwa.name</a>)</span></div><div class="subtext"><span>yamrzou</span> | <span>28 comments</span></div><br/><div><div id="42252243" class="c"><input type="checkbox" id="c-42252243" checked=""/><div class="controls bullet"><span class="by">visualphoenix</span><span>|</span><a href="#42254269">next</a><span>|</span><label class="collapse" for="c-42252243">[-]</label><label class="expand" for="c-42252243">[4 more]</label></div><br/><div class="children"><div class="content">Git-crypt is a dead product with numerous unresolved issues and drawbacks.<p>Newer versions of git cause git to crash when invoking git-crypt[0].<p>It doesn’t scale with users: Off-boarding a key is a commit in git. Since it is trivially easy to rewind a git repo before the revocation commit and then decrypt with the revoked key, this means you need to rotate every key under management when any revoke is performed.<p>It provides the illusion of asymmetric key encryption, but your asymmetric key wraps a shared symmetric key used to encrypt the entire repository. This also means a user could roll the repository back before a key was revoked and steal the symmetric key used to protect the repository and then use that key to decrypt the repository any time in the future.<p>It doesn’t scale with the number of files under management. As a result of how it’s implemented, every invocation is a separate process launch. This means every file triggers an asymmetric unwrap of the symmetric key. If you’re protecting your GPG key with hardware keyfob, decrypting the repository will take a long time.<p>This product seemed like a cool idea for a while but it’s implementation leave much to be desired and has not stood the test of time…<p>Password-store[1] does a better job than git-crypt for single user git based gpg encrypted password management.<p>For multi-user git repo encryption I prefer Mozilla SOPS[2], especially when coupled with something like AWS KMS…<p>But then you might consider stepping up to something like Hashicorp Vault[3] or Infisical[4].<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;AGWA&#x2F;git-crypt&#x2F;issues&#x2F;273">https:&#x2F;&#x2F;github.com&#x2F;AGWA&#x2F;git-crypt&#x2F;issues&#x2F;273</a><p>[1] <a href="https:&#x2F;&#x2F;www.passwordstore.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.passwordstore.org&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;getsops&#x2F;sops">https:&#x2F;&#x2F;github.com&#x2F;getsops&#x2F;sops</a><p>[3] <a href="https:&#x2F;&#x2F;www.vaultproject.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.vaultproject.io&#x2F;</a><p>[4] <a href="https:&#x2F;&#x2F;infisical.com&#x2F;">https:&#x2F;&#x2F;infisical.com&#x2F;</a></div><br/><div id="42252292" class="c"><input type="checkbox" id="c-42252292" checked=""/><div class="controls bullet"><span class="by">peterldowns</span><span>|</span><a href="#42252243">parent</a><span>|</span><a href="#42253807">next</a><span>|</span><label class="collapse" for="c-42252292">[-]</label><label class="expand" for="c-42252292">[1 more]</label></div><br/><div class="children"><div class="content">This is entirely correct. SOPS+kms, or similarly Berglas + GCP Secret Manager, is the right way.<p>Secrets belong in secrets stores, accessible via auditable IAM role grants.</div><br/></div></div><div id="42253807" class="c"><input type="checkbox" id="c-42253807" checked=""/><div class="controls bullet"><span class="by">ozim</span><span>|</span><a href="#42252243">parent</a><span>|</span><a href="#42252292">prev</a><span>|</span><a href="#42254269">next</a><span>|</span><label class="collapse" for="c-42253807">[-]</label><label class="expand" for="c-42253807">[2 more]</label></div><br/><div class="children"><div class="content">Encryption in git repo from start sounds like an antipattern.</div><br/><div id="42254209" class="c"><input type="checkbox" id="c-42254209" checked=""/><div class="controls bullet"><span class="by">wolletd</span><span>|</span><a href="#42252243">root</a><span>|</span><a href="#42253807">parent</a><span>|</span><a href="#42254269">next</a><span>|</span><label class="collapse" for="c-42254209">[-]</label><label class="expand" for="c-42254209">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. What kind of data would one want to store encrypted in a git repo besides unencrypted files in the same repo? And why?</div><br/></div></div></div></div></div></div><div id="42254269" class="c"><input type="checkbox" id="c-42254269" checked=""/><div class="controls bullet"><span class="by">eisbaw</span><span>|</span><a href="#42252243">prev</a><span>|</span><a href="#42251971">next</a><span>|</span><label class="collapse" for="c-42254269">[-]</label><label class="expand" for="c-42254269">[1 more]</label></div><br/><div class="children"><div class="content">git-secrets</div><br/></div></div><div id="42251971" class="c"><input type="checkbox" id="c-42251971" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#42254269">prev</a><span>|</span><a href="#42251502">next</a><span>|</span><label class="collapse" for="c-42251971">[-]</label><label class="expand" for="c-42251971">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re interested in E2EE git repos, you might be interested in a project I&#x27;ve been maintaining for a few years now: git-remote-restic. It stores the git repository in a restic repository hosted on any untrusted storage. It is designed for secure archival, but it does support multi-user access (no web UI because, of course, it&#x27;s E2EE).<p><a href="https:&#x2F;&#x2F;github.com&#x2F;CGamesPlay&#x2F;git-remote-restic">https:&#x2F;&#x2F;github.com&#x2F;CGamesPlay&#x2F;git-remote-restic</a></div><br/></div></div><div id="42251502" class="c"><input type="checkbox" id="c-42251502" checked=""/><div class="controls bullet"><span class="by">zaptheimpaler</span><span>|</span><a href="#42251971">prev</a><span>|</span><a href="#42251552">next</a><span>|</span><label class="collapse" for="c-42251502">[-]</label><label class="expand" for="c-42251502">[1 more]</label></div><br/><div class="children"><div class="content">How does this compare to mozilla&#x27;s sops[1]. I&#x27;ve heard sops is also used for this kind of usecase, although it seems to do much more.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;getsops&#x2F;sops">https:&#x2F;&#x2F;github.com&#x2F;getsops&#x2F;sops</a></div><br/></div></div><div id="42251552" class="c"><input type="checkbox" id="c-42251552" checked=""/><div class="controls bullet"><span class="by">nikeee</span><span>|</span><a href="#42251502">prev</a><span>|</span><a href="#42251230">next</a><span>|</span><label class="collapse" for="c-42251552">[-]</label><label class="expand" for="c-42251552">[1 more]</label></div><br/><div class="children"><div class="content">There is also git-agecrypt [1], which is the same but uses age instead of gpg. I&#x27;ve used both, they work pretty well.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;vlaci&#x2F;git-agecrypt">https:&#x2F;&#x2F;github.com&#x2F;vlaci&#x2F;git-agecrypt</a></div><br/></div></div><div id="42251230" class="c"><input type="checkbox" id="c-42251230" checked=""/><div class="controls bullet"><span class="by">asymmetric</span><span>|</span><a href="#42251552">prev</a><span>|</span><a href="#42252072">next</a><span>|</span><label class="collapse" for="c-42251230">[-]</label><label class="expand" for="c-42251230">[3 more]</label></div><br/><div class="children"><div class="content">Is there anything comparable&#x2F;support for this in jujutsu? The files git-crypt handles are not added to .gitignore — they’re instead added to .gitattributes.<p>The result is that jj commits them, which is not what you want.</div><br/><div id="42251407" class="c"><input type="checkbox" id="c-42251407" checked=""/><div class="controls bullet"><span class="by">dontdoxxme</span><span>|</span><a href="#42251230">parent</a><span>|</span><a href="#42252072">next</a><span>|</span><label class="collapse" for="c-42251407">[-]</label><label class="expand" for="c-42251407">[2 more]</label></div><br/><div class="children"><div class="content">It sounds like jujutsu is not honoring the filter option, see man gitattributes, it even lists encryption as a possible use.</div><br/><div id="42251492" class="c"><input type="checkbox" id="c-42251492" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#42251230">root</a><span>|</span><a href="#42251407">parent</a><span>|</span><a href="#42252072">next</a><span>|</span><label class="collapse" for="c-42251492">[-]</label><label class="expand" for="c-42251492">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;martinvonz&#x2F;jj&#x2F;issues&#x2F;53">https:&#x2F;&#x2F;github.com&#x2F;martinvonz&#x2F;jj&#x2F;issues&#x2F;53</a><p>open since 2022</div><br/></div></div></div></div></div></div><div id="42252072" class="c"><input type="checkbox" id="c-42252072" checked=""/><div class="controls bullet"><span class="by">TheCraiggers</span><span>|</span><a href="#42251230">prev</a><span>|</span><a href="#42251602">next</a><span>|</span><label class="collapse" for="c-42252072">[-]</label><label class="expand" for="c-42252072">[2 more]</label></div><br/><div class="children"><div class="content">I could see this being used to create an interesting password storage system. I already use Pass but the one thing I wish it could do is use different keys for different folders, so that I could setup family accounts. This looks to solve that issue, albeit without the Pass ecosystem.</div><br/><div id="42253276" class="c"><input type="checkbox" id="c-42253276" checked=""/><div class="controls bullet"><span class="by">dontdoxxme</span><span>|</span><a href="#42252072">parent</a><span>|</span><a href="#42251602">next</a><span>|</span><label class="collapse" for="c-42253276">[-]</label><label class="expand" for="c-42253276">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;d be better off with passage[0] -- it&#x27;s a fork of pass but uses age for encryption. You can just make a directory hierarchy with appropriate .age-recipients files at the right levels.<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;passage">https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;passage</a></div><br/></div></div></div></div><div id="42251602" class="c"><input type="checkbox" id="c-42251602" checked=""/><div class="controls bullet"><span class="by">er4hn</span><span>|</span><a href="#42252072">prev</a><span>|</span><a href="#42253278">next</a><span>|</span><label class="collapse" for="c-42251602">[-]</label><label class="expand" for="c-42251602">[8 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing that because this is encrypting the files to be stored, this means that you cannot view the files via Git forge web UIs, cannot merge conflicting encrypted files, etc. Is that right?</div><br/><div id="42251764" class="c"><input type="checkbox" id="c-42251764" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#42251602">parent</a><span>|</span><a href="#42251751">next</a><span>|</span><label class="collapse" for="c-42251764">[-]</label><label class="expand" for="c-42251764">[4 more]</label></div><br/><div class="children"><div class="content">Only someone who has the keys can display the cleartext. I don&#x27;t think any forge has support for that and it don&#x27;t see the use case for first encrypting and then giving the key to the forge.<p>I store only secrets in encrypted form, so I never had to merge anything. But I&#x27;d assume merging should be unaffected because it happens in the work area, i.e. in decrypted form. That it&#x27;s a different storage format in the repo should not matter.</div><br/><div id="42251904" class="c"><input type="checkbox" id="c-42251904" checked=""/><div class="controls bullet"><span class="by">ratorx</span><span>|</span><a href="#42251602">root</a><span>|</span><a href="#42251764">parent</a><span>|</span><a href="#42251751">next</a><span>|</span><label class="collapse" for="c-42251904">[-]</label><label class="expand" for="c-42251904">[3 more]</label></div><br/><div class="children"><div class="content">&gt; don’t see the use case for first encrypting and then giving the key to the forge<p>You might only want to keep the files secret from the broader internet, rather than a (trusted) forge, which can make the unencrypted secrets available via an UI for eg. authenticated maintainers.<p>These cases would benefit from being able to see the secrets transparently in the UI when logged in.<p>Also, forges having access to e.g. deployment secrets is not that uncommon (e.g. GitHub with deployments via GitHub actions).</div><br/><div id="42251926" class="c"><input type="checkbox" id="c-42251926" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#42251602">root</a><span>|</span><a href="#42251904">parent</a><span>|</span><a href="#42251751">next</a><span>|</span><label class="collapse" for="c-42251926">[-]</label><label class="expand" for="c-42251926">[2 more]</label></div><br/><div class="children"><div class="content">You&#x27;re describing a private repo. GitHub&#x2F;GitLab&#x2F;... have that.</div><br/><div id="42252020" class="c"><input type="checkbox" id="c-42252020" checked=""/><div class="controls bullet"><span class="by">ratorx</span><span>|</span><a href="#42251602">root</a><span>|</span><a href="#42251926">parent</a><span>|</span><a href="#42251751">next</a><span>|</span><label class="collapse" for="c-42252020">[-]</label><label class="expand" for="c-42252020">[1 more]</label></div><br/><div class="children"><div class="content">Not exactly. A private repo is entirely private. You might have an open source project which has some deployment secrets etc that you want to check in to git. All the code and config is perfectly safe to expose to the internet, but you want to hide a specific file.<p>I think this pattern was common for things like Ansible and Terraform configs and dotfiles.</div><br/></div></div></div></div></div></div></div></div><div id="42251751" class="c"><input type="checkbox" id="c-42251751" checked=""/><div class="controls bullet"><span class="by">cube2222</span><span>|</span><a href="#42251602">parent</a><span>|</span><a href="#42251764">prev</a><span>|</span><a href="#42251920">next</a><span>|</span><label class="collapse" for="c-42251751">[-]</label><label class="expand" for="c-42251751">[1 more]</label></div><br/><div class="children"><div class="content">It’s pretty transparent when used with local tooling that uses the git cli under the hood (i.e. editor integrations).<p>Web UIs get a bunch of blobs of course, by design.</div><br/></div></div><div id="42251920" class="c"><input type="checkbox" id="c-42251920" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#42251602">parent</a><span>|</span><a href="#42251751">prev</a><span>|</span><a href="#42251816">next</a><span>|</span><label class="collapse" for="c-42251920">[-]</label><label class="expand" for="c-42251920">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s right. This is the entire point of an end-to-end encryption scheme, of you are ok with the forge having the key then you have regular private repos.</div><br/></div></div><div id="42251816" class="c"><input type="checkbox" id="c-42251816" checked=""/><div class="controls bullet"><span class="by">arccy</span><span>|</span><a href="#42251602">parent</a><span>|</span><a href="#42251920">prev</a><span>|</span><a href="#42253278">next</a><span>|</span><label class="collapse" for="c-42251816">[-]</label><label class="expand" for="c-42251816">[1 more]</label></div><br/><div class="children"><div class="content">diffs and merges can use textconv to operate on the decrypted file</div><br/></div></div></div></div><div id="42253278" class="c"><input type="checkbox" id="c-42253278" checked=""/><div class="controls bullet"><span class="by">tripdout</span><span>|</span><a href="#42251602">prev</a><span>|</span><a href="#42251481">next</a><span>|</span><label class="collapse" for="c-42253278">[-]</label><label class="expand" for="c-42253278">[1 more]</label></div><br/><div class="children"><div class="content">I much prefer sops or age.</div><br/></div></div><div id="42251481" class="c"><input type="checkbox" id="c-42251481" checked=""/><div class="controls bullet"><span class="by">siroma</span><span>|</span><a href="#42253278">prev</a><span>|</span><a href="#42251790">next</a><span>|</span><label class="collapse" for="c-42251481">[-]</label><label class="expand" for="c-42251481">[2 more]</label></div><br/><div class="children"><div class="content">git-crypt is great. I use it on a daily basis to encrypt code of some of my repositories. 
Some of the software I write contains industry secrets I don&#x27;t want GitHub to know or train AI with. I don&#x27;t trust them in keeping my private repos safe, so I use git-crypt.
Honestly works way better than I expected initially. Once you configure it it&#x27;s pretty seamless.</div><br/><div id="42251569" class="c"><input type="checkbox" id="c-42251569" checked=""/><div class="controls bullet"><span class="by">FredPret</span><span>|</span><a href="#42251481">parent</a><span>|</span><a href="#42251790">next</a><span>|</span><label class="collapse" for="c-42251569">[-]</label><label class="expand" for="c-42251569">[1 more]</label></div><br/><div class="children"><div class="content">In your usecase, is a self-rolled Gitea not even more secure and also easier to use?<p>Who knows if your trade secrets get decrypted by an AI years from now</div><br/></div></div></div></div><div id="42251790" class="c"><input type="checkbox" id="c-42251790" checked=""/><div class="controls bullet"><span class="by">TheRealPomax</span><span>|</span><a href="#42251481">prev</a><span>|</span><a href="#42251868">next</a><span>|</span><label class="collapse" for="c-42251790">[-]</label><label class="expand" for="c-42251790">[2 more]</label></div><br/><div class="children"><div class="content">Now if only it worked on Windows.</div><br/><div id="42253813" class="c"><input type="checkbox" id="c-42253813" checked=""/><div class="controls bullet"><span class="by">gotimo</span><span>|</span><a href="#42251790">parent</a><span>|</span><a href="#42251868">next</a><span>|</span><label class="collapse" for="c-42253813">[-]</label><label class="expand" for="c-42253813">[1 more]</label></div><br/><div class="children"><div class="content">i just downloaded the windows release and that worked fine for me</div><br/></div></div></div></div><div id="42251868" class="c"><input type="checkbox" id="c-42251868" checked=""/><div class="controls bullet"><span class="by">dheera</span><span>|</span><a href="#42251790">prev</a><span>|</span><label class="collapse" for="c-42251868">[-]</label><label class="expand" for="c-42251868">[1 more]</label></div><br/><div class="children"><div class="content">The only thing I don&#x27;t like about this is if you&#x27;re not careful it&#x27;s very easy to accidentally commit a cleartext file. And then goddamn github doesn&#x27;t let you delete a commit, you can only commit another commit that undiffs the diff. Then you go &quot;fuck it&quot; and rebase, and then find out even that didn&#x27;t work, then you go delete and recreate the repo. Bleh.<p>And they don&#x27;t give you the server logs to know if someone has accessed the cleartext file during that time.<p>At this point I just commit .tar.gz.gpg files for things that need to be encrypted, it&#x27;s easier to not fuck up.</div><br/></div></div></div></div></div></div></div></body></html>