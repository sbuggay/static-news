<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1727082072545" as="style"/><link rel="stylesheet" href="styles.css?v=1727082072545"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="http://rachelbythebay.com/w/2024/09/22/colo/">A terrible way to jump into colocating your own stuff</a>Â <span class="domain">(<a href="http://rachelbythebay.com">rachelbythebay.com</a>)</span></div><div class="subtext"><span>ingve</span> | <span>26 comments</span></div><br/><div><div id="41622809" class="c"><input type="checkbox" id="c-41622809" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#41623080">next</a><span>|</span><label class="collapse" for="c-41622809">[-]</label><label class="expand" for="c-41622809">[2 more]</label></div><br/><div class="children"><div class="content">&gt; 1. Install Linux on the box. Turn everything off but sshd. Turn off password access to sshd.<p>Also, <i>test</i> that it&#x27;s properly disabled with something like `ssh -v yourserver : 2&gt;&amp;1 | grep continue`, because there are a surprising number of ways for that to go wrong (did you know that sshd lets you Include multiple config files together in a way that can override the main one? <i>I  know that now.</i>)</div><br/><div id="41623309" class="c"><input type="checkbox" id="c-41623309" checked=""/><div class="controls bullet"><span class="by">Maledictus</span><span>|</span><a href="#41622809">parent</a><span>|</span><a href="#41623080">next</a><span>|</span><label class="collapse" for="c-41623309">[-]</label><label class="expand" for="c-41623309">[1 more]</label></div><br/><div class="children"><div class="content">and `sshd -T | grep -i password`</div><br/></div></div></div></div><div id="41623080" class="c"><input type="checkbox" id="c-41623080" checked=""/><div class="controls bullet"><span class="by">krab</span><span>|</span><a href="#41622809">prev</a><span>|</span><a href="#41623384">next</a><span>|</span><label class="collapse" for="c-41623080">[-]</label><label class="expand" for="c-41623080">[7 more]</label></div><br/><div class="children"><div class="content">A bit less terrible way in my opinion:<p>Find a dedicated server provider and rent the hardware. These companies rent some part of the datacenter (or sometimes build their own). Bonus points if they offer KVM - as in remote console, not the Linux hypervisor. Also ask if they do hardware monitoring and proactively replace the failed parts. All of this is still way cheaper than cloud. Usually with unmetered networking.<p>Way less hassle. They&#x27;ll even take your existing stuff and put it into the same rack with the rented hardware.<p>The difference from cloud, apart from the price, is mainly that they have a sales rep instead of an API. And getting a server may take a from few hours to a few days. But in the end you get the same SSH login details you would get from a cloud provider.<p>Or, if you really want to just collocate your boxes, the providers offer &quot;remote hands&quot; service, so you can have geo-redundancy or just choose a better deal instead of one that&#x27;s physically close to your place.</div><br/><div id="41623354" class="c"><input type="checkbox" id="c-41623354" checked=""/><div class="controls bullet"><span class="by">rsanheim</span><span>|</span><a href="#41623080">parent</a><span>|</span><a href="#41623502">next</a><span>|</span><label class="collapse" for="c-41623354">[-]</label><label class="expand" for="c-41623354">[5 more]</label></div><br/><div class="children"><div class="content">One hurdle that many companies who have only known cloud hosting will face here is significant: how do you find a reliable, trustworthy datacenter? One who actually monitors the hardware and also has a real human if your networking access gets screwed or if you need a critical component swapped at 2 am on a Saturday.<p>I used to have a short list of trustworthy companies like this I&#x27;d recommend to clients ~20 years ago when doing consulting. I think 3&#x2F;4 of them have been gobbled up by private equity chop shops or are just gone.<p>Nowadays noone gets fired for going with AWS, or resold AWS with a 100% markup from a &#x27;private enterprise cloud&#x27; provider.</div><br/><div id="41623441" class="c"><input type="checkbox" id="c-41623441" checked=""/><div class="controls bullet"><span class="by">krab</span><span>|</span><a href="#41623080">root</a><span>|</span><a href="#41623354">parent</a><span>|</span><a href="#41623502">next</a><span>|</span><label class="collapse" for="c-41623441">[-]</label><label class="expand" for="c-41623441">[4 more]</label></div><br/><div class="children"><div class="content">You&#x27;re right you need to find a company you can trust.<p>And for a lot of startups it really makes sense to use AWS. But if you do something resource or bandwidth intensive (and I&#x27;m not even talking about Llama now), the costs add up quickly. In our case, switching to AWS would increase our costs by an equivalent of 4 - 8 devs salaries. After AWS discounts. That&#x27;s a hard sell in a 15-person team even though half of our infra costs already are with AWS (S3).</div><br/><div id="41623557" class="c"><input type="checkbox" id="c-41623557" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#41623080">root</a><span>|</span><a href="#41623441">parent</a><span>|</span><a href="#41623502">next</a><span>|</span><label class="collapse" for="c-41623557">[-]</label><label class="expand" for="c-41623557">[3 more]</label></div><br/><div class="children"><div class="content">I often recommend a &quot;embrace, extend, extinguish&quot; approach to AWS: Starting there for simplicity is fine, then &quot;wrap&quot; anything bandwidth intensive with caches elsewhere (every 1TB in egress from AWS will pay for a fleet of Hetzner instances with 5TB included, or one or more dedicated servers).<p>Gradually shift workloads, leaving anything requiring super-high durability last (optionally keeping S3, or competitors, as a backup storage option) as getting durability right is one of the more difficult things to get confidence in and most dangerous ones to get wrong.<p>Wrapping S3 with a write-through cache setup can often be <i>the</i> biggest cost win if your egress costs are high. Sometimes caching the entire dataset is worth it, sometimes just a small portion.</div><br/><div id="41623593" class="c"><input type="checkbox" id="c-41623593" checked=""/><div class="controls bullet"><span class="by">krab</span><span>|</span><a href="#41623080">root</a><span>|</span><a href="#41623557">parent</a><span>|</span><a href="#41623502">next</a><span>|</span><label class="collapse" for="c-41623593">[-]</label><label class="expand" for="c-41623593">[2 more]</label></div><br/><div class="children"><div class="content">Well, S3 is hard to beat for our use case. We make a heavy use of their various tires, we store a somewhat large amount of data but only a minor part ever goes out.<p>The compute and network heavy stuff we do is still out of AWS.</div><br/><div id="41623637" class="c"><input type="checkbox" id="c-41623637" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#41623080">root</a><span>|</span><a href="#41623593">parent</a><span>|</span><a href="#41623502">next</a><span>|</span><label class="collapse" for="c-41623637">[-]</label><label class="expand" for="c-41623637">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s pretty much the one situation where they&#x27;re competitive, so sounds very reasonable. Some of their competitors (Cloudflare, Backblaze) might compete, but the biggest cost issue with S3 by far is the egress so if not much goes out it might still be best for you to stay there.<p>Sounds like (unlike most people who use AWS) you&#x27;ve done your homework. It&#x27;s great to see. I&#x27;ve used AWS a lot, and will again, because it&#x27;s often convenient, but so often I see people doing it uncritically without modeling their costs even as it skyrockets with scale.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41623502" class="c"><input type="checkbox" id="c-41623502" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#41623080">parent</a><span>|</span><a href="#41623354">prev</a><span>|</span><a href="#41623384">next</a><span>|</span><label class="collapse" for="c-41623502">[-]</label><label class="expand" for="c-41623502">[1 more]</label></div><br/><div class="children"><div class="content">This. I used to colo lots of stuff, but now mostly use Hetzner. But there are many in this space, and some of them even offer an API. And some of them (like Hetzner) <i>also</i> offer at least basic cloud services, so you can mix and match (which allows for even steeper cost cuts - instead of loading your dedicated hardware to 60% or whatever you&#x27;re comfortable with to have headroom, you can load it higher and scale into their cloud offering to handle spikes).<p>The boundary where colo and dedicated server offerings intersect in price tend to be down to land and power costs - Hetzner finally became the cheaper option for me as London land values skyrocketed relative to their locations in Germany, and colo prices with them. (We could have looked at coko somewhere remote, but the savings would&#x27;ve been too low to be worth it)</div><br/></div></div></div></div><div id="41623384" class="c"><input type="checkbox" id="c-41623384" checked=""/><div class="controls bullet"><span class="by">mjevans</span><span>|</span><a href="#41623080">prev</a><span>|</span><a href="#41623723">next</a><span>|</span><label class="collapse" for="c-41623384">[-]</label><label class="expand" for="c-41623384">[3 more]</label></div><br/><div class="children"><div class="content">They&#x27;re absolutely correct:<p>&quot; 1. Install Linux on the box. Turn everything off but sshd. Turn off password access to sshd. If you just locked yourself out of sshd because you didn&#x27;t install ssh keys first, STOP HERE. You are not ready for this. &quot;<p>If you blindly followed the directions and got locked out, you can do exactly the same thing with other directions.  You were not ready.</div><br/><div id="41623720" class="c"><input type="checkbox" id="c-41623720" checked=""/><div class="controls bullet"><span class="by">nasretdinov</span><span>|</span><a href="#41623384">parent</a><span>|</span><a href="#41623677">next</a><span>|</span><label class="collapse" for="c-41623720">[-]</label><label class="expand" for="c-41623720">[1 more]</label></div><br/><div class="children"><div class="content">At least it doesn&#x27;t say to set PermitRootLogon and remove the root password :)</div><br/></div></div><div id="41623677" class="c"><input type="checkbox" id="c-41623677" checked=""/><div class="controls bullet"><span class="by">kijin</span><span>|</span><a href="#41623384">parent</a><span>|</span><a href="#41623720">prev</a><span>|</span><a href="#41623723">next</a><span>|</span><label class="collapse" for="c-41623677">[-]</label><label class="expand" for="c-41623677">[1 more]</label></div><br/><div class="children"><div class="content">The great thing about having unfettered physical access to hardware is that you can easily recover from mistakes like this. No need to rebuild that EC2 instance. No need to beg a hosting company for IPMI access. You can just pull the plug and try again as if were your own PC.</div><br/></div></div></div></div><div id="41623723" class="c"><input type="checkbox" id="c-41623723" checked=""/><div class="controls bullet"><span class="by">seszett</span><span>|</span><a href="#41623384">prev</a><span>|</span><a href="#41622998">next</a><span>|</span><label class="collapse" for="c-41623723">[-]</label><label class="expand" for="c-41623723">[1 more]</label></div><br/><div class="children"><div class="content">The most difficult step I find is just barely mentioned, finding colocation space at reasonable price is difficult these days.</div><br/></div></div><div id="41622998" class="c"><input type="checkbox" id="c-41622998" checked=""/><div class="controls bullet"><span class="by">moandcompany</span><span>|</span><a href="#41623723">prev</a><span>|</span><a href="#41623325">next</a><span>|</span><label class="collapse" for="c-41622998">[-]</label><label class="expand" for="c-41622998">[3 more]</label></div><br/><div class="children"><div class="content">Documenting and testing the hard reset&#x2F;reboot procedure, as well as any expectations, for your colocated gear sounds like a good thing to add to this list.</div><br/><div id="41623096" class="c"><input type="checkbox" id="c-41623096" checked=""/><div class="controls bullet"><span class="by">bigfatkitten</span><span>|</span><a href="#41622998">parent</a><span>|</span><a href="#41623325">next</a><span>|</span><label class="collapse" for="c-41623096">[-]</label><label class="expand" for="c-41623096">[2 more]</label></div><br/><div class="children"><div class="content">Test to make sure it&#x27;ll actually come back after a hard reset.<p>Don&#x27;t do what I did and put a Cisco router on a remote mountaintop radio site with the config register still set to 0x2142, and then go home.</div><br/><div id="41623718" class="c"><input type="checkbox" id="c-41623718" checked=""/><div class="controls bullet"><span class="by">pferde</span><span>|</span><a href="#41622998">root</a><span>|</span><a href="#41623096">parent</a><span>|</span><a href="#41623325">next</a><span>|</span><label class="collapse" for="c-41623718">[-]</label><label class="expand" for="c-41623718">[1 more]</label></div><br/><div class="children"><div class="content">Hey, that&#x27;s just an excuse to go for another hike! :)</div><br/></div></div></div></div></div></div><div id="41623325" class="c"><input type="checkbox" id="c-41623325" checked=""/><div class="controls bullet"><span class="by">ggm</span><span>|</span><a href="#41622998">prev</a><span>|</span><a href="#41622869">next</a><span>|</span><label class="collapse" for="c-41623325">[-]</label><label class="expand" for="c-41623325">[3 more]</label></div><br/><div class="children"><div class="content">Remote power management can be a godsend. If you can get an ipmi console in, you want it.</div><br/><div id="41623767" class="c"><input type="checkbox" id="c-41623767" checked=""/><div class="controls bullet"><span class="by">qhwudbebd</span><span>|</span><a href="#41623325">parent</a><span>|</span><a href="#41623480">next</a><span>|</span><label class="collapse" for="c-41623767">[-]</label><label class="expand" for="c-41623767">[1 more]</label></div><br/><div class="children"><div class="content">Ipmi is a bit of a double-edged sword. Network-connected access to a serial console (including uefi&#x2F;bios console redirection) and the reset button can be a total lifesaver, I agree. I wouldn&#x27;t want to be without a serial console and remote reset button either.<p>But ipmi cards are little network-attached linux boxes which run prehistoric kernels and userspace, exposing as many services as the half-wits who put together the firmware image can shovel in, and are rarely if ever patched by the vendor unless there&#x27;s some really public scandal.<p>The standard thing to do is to isolate them on some kind of private management network in an attempt to shield the wider internet from the full majesty of the firmware engineers&#x27; dazzling skills, but that might be harder to do in the simple &#x27;beginner&#x27; scenario Rachel describes.<p>One good simple version when you get up to two servers instead of just one is to cross-connect so each machine has ipmi access to the other, but neither ipmi service is exposed to the wider world.</div><br/></div></div><div id="41623480" class="c"><input type="checkbox" id="c-41623480" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><a href="#41623325">parent</a><span>|</span><a href="#41623767">prev</a><span>|</span><a href="#41622869">next</a><span>|</span><label class="collapse" for="c-41623480">[-]</label><label class="expand" for="c-41623480">[1 more]</label></div><br/><div class="children"><div class="content">It is indeed very helpful when it&#x27;s needed - but most IPMI is horrifically insecure, so usually it&#x27;s not connected directly to the public internet. Instead it&#x27;s on a separate network with special VPN access.<p>As this document focuses on keeping things simple, they don&#x27;t have the isolated network &#x2F; VPN needed to use IPMI.</div><br/></div></div></div></div><div id="41622869" class="c"><input type="checkbox" id="c-41622869" checked=""/><div class="controls bullet"><span class="by">cuu508</span><span>|</span><a href="#41623325">prev</a><span>|</span><a href="#41623753">next</a><span>|</span><label class="collapse" for="c-41622869">[-]</label><label class="expand" for="c-41622869">[4 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the importance of having a switch&#x2F;hub? Is it because you may want to add more servers later, but the colo host only provides one port in their router?</div><br/><div id="41623198" class="c"><input type="checkbox" id="c-41623198" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#41622869">parent</a><span>|</span><a href="#41622945">next</a><span>|</span><label class="collapse" for="c-41623198">[-]</label><label class="expand" for="c-41623198">[1 more]</label></div><br/><div class="children"><div class="content">So you can plug your laptop into it at the colo when you set it up so you can verify that the server is working right and can get to the internet <i>while you are still there</i>.  And if it isn&#x27;t working right, it&#x27;ll be a lot easier to keep everything plugged into the switch, rather than swapping between your laptop and the colo&#x27;s network every time you try something to fix it.<p>But yes, if you think you might want to add other machines later, preemptively putting a switch in there will make it tons easier.</div><br/></div></div><div id="41622945" class="c"><input type="checkbox" id="c-41622945" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#41622869">parent</a><span>|</span><a href="#41623198">prev</a><span>|</span><a href="#41622937">next</a><span>|</span><label class="collapse" for="c-41622945">[-]</label><label class="expand" for="c-41622945">[1 more]</label></div><br/><div class="children"><div class="content">Basically. Need to pay for a bigger pipe. Same applies to power as well, gotta pay to get more capacity.</div><br/></div></div><div id="41622937" class="c"><input type="checkbox" id="c-41622937" checked=""/><div class="controls bullet"><span class="by">re-thc</span><span>|</span><a href="#41622869">parent</a><span>|</span><a href="#41622945">prev</a><span>|</span><a href="#41623753">next</a><span>|</span><label class="collapse" for="c-41622937">[-]</label><label class="expand" for="c-41622937">[1 more]</label></div><br/><div class="children"><div class="content">Also if you want to manage the IP ranges provided amongst &gt;1 server.</div><br/></div></div></div></div><div id="41623753" class="c"><input type="checkbox" id="c-41623753" checked=""/><div class="controls bullet"><span class="by">emptiestplace</span><span>|</span><a href="#41622869">prev</a><span>|</span><a href="#41623452">next</a><span>|</span><label class="collapse" for="c-41623753">[-]</label><label class="expand" for="c-41623753">[1 more]</label></div><br/><div class="children"><div class="content">What audience was this written for?</div><br/></div></div><div id="41623452" class="c"><input type="checkbox" id="c-41623452" checked=""/><div class="controls bullet"><span class="by">behringer</span><span>|</span><a href="#41623753">prev</a><span>|</span><label class="collapse" for="c-41623452">[-]</label><label class="expand" for="c-41623452">[1 more]</label></div><br/><div class="children"><div class="content">Forget the switch and pi and get a ubiquity router. Much more powerful and simple to setup. Does require some knowhow.<p>Also you could see if your local hackers space has a server rack</div><br/></div></div></div></div></div></div></div></body></html>