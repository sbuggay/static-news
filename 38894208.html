<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704618054741" as="style"/><link rel="stylesheet" href="styles.css?v=1704618054741"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://media.ccc.de/v/all-systems-go-2023-193-adventures-of-linux-userspace-at-meta">Adventures of Linux Userspace at Meta [video]</a> <span class="domain">(<a href="https://media.ccc.de">media.ccc.de</a>)</span></div><div class="subtext"><span>iso8859-1</span> | <span>27 comments</span></div><br/><div><div id="38896170" class="c"><input type="checkbox" id="c-38896170" checked=""/><div class="controls bullet"><span class="by">pixelbeat__</span><span>|</span><a href="#38896059">next</a><span>|</span><label class="collapse" for="c-38896170">[-]</label><label class="expand" for="c-38896170">[8 more]</label></div><br/><div class="children"><div class="content">It&#x27;s worth noting that this discusses the centos based provisioning and hardware management platform.<p>The actual distribution used to _run_ all Meta backend services is completely separate and built from source
(it does share the (non centos) kernel). This is done for flexibility, performance, service isolation  reasons</div><br/><div id="38896566" class="c"><input type="checkbox" id="c-38896566" checked=""/><div class="controls bullet"><span class="by">ot</span><span>|</span><a href="#38896170">parent</a><span>|</span><a href="#38896476">next</a><span>|</span><label class="collapse" for="c-38896566">[-]</label><label class="expand" for="c-38896566">[4 more]</label></div><br/><div class="children"><div class="content">This is not accurate, the system packages are from the CentOS binary distribution. You might be thinking of C&#x2F;C++ runtime libraries, which are distributed as separate packages used by the internal (&quot;fbcode&quot;) binaries, but system binaries link to the standard distribution.</div><br/><div id="38896661" class="c"><input type="checkbox" id="c-38896661" checked=""/><div class="controls bullet"><span class="by">pixelbeat__</span><span>|</span><a href="#38896170">root</a><span>|</span><a href="#38896566">parent</a><span>|</span><a href="#38896476">next</a><span>|</span><label class="collapse" for="c-38896661">[-]</label><label class="expand" for="c-38896661">[3 more]</label></div><br/><div class="children"><div class="content">(Hi Giuseppe!)<p>Right, the standard centos system binaries are used to provision services and manage hardware.<p>The internal services linking against the runtime libs you mention, are actually linking against about 2000 built from source packages, and are essentially a separate distro (with a distro in this sense being an ABI compatible set of libs running on a kernel)</div><br/><div id="38896731" class="c"><input type="checkbox" id="c-38896731" checked=""/><div class="controls bullet"><span class="by">ot</span><span>|</span><a href="#38896170">root</a><span>|</span><a href="#38896661">parent</a><span>|</span><a href="#38896750">next</a><span>|</span><label class="collapse" for="c-38896731">[-]</label><label class="expand" for="c-38896731">[1 more]</label></div><br/><div class="children"><div class="content">I think that&#x27;s not what people would normally call &quot;the distribution&quot; :) systemd, coreutils, ssh, shell, ... come from CentOS.<p>(Hi Pádraig!)</div><br/></div></div></div></div></div></div><div id="38896476" class="c"><input type="checkbox" id="c-38896476" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#38896170">parent</a><span>|</span><a href="#38896566">prev</a><span>|</span><a href="#38896059">next</a><span>|</span><label class="collapse" for="c-38896476">[-]</label><label class="expand" for="c-38896476">[3 more]</label></div><br/><div class="children"><div class="content">&gt; The actual distribution used to _run_ all Meta backend services is completely separate and built from source (it does share the kernel).<p>That does not seem to be true.  The hosts I&#x27;m looking at have systemd and glibc RPMs that were built on centos.org hosts, with coreutils from redhat.com.  The kernel was built on a Facebook host, but that&#x27;s it (of the handful of components I&#x27;ve spot-checked).</div><br/><div id="38896540" class="c"><input type="checkbox" id="c-38896540" checked=""/><div class="controls bullet"><span class="by">pixelbeat__</span><span>|</span><a href="#38896170">root</a><span>|</span><a href="#38896476">parent</a><span>|</span><a href="#38896529">next</a><span>|</span><label class="collapse" for="c-38896540">[-]</label><label class="expand" for="c-38896540">[1 more]</label></div><br/><div class="children"><div class="content">Use ldd on any service binary to see that it&#x27;s linked against a separate distro.
(It&#x27;s best to use the ldd from the corresponding platform).<p>There are actually three distros on each host. Current runtime platform, previous runtime platform, centos platform.</div><br/></div></div><div id="38896529" class="c"><input type="checkbox" id="c-38896529" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#38896170">root</a><span>|</span><a href="#38896476">parent</a><span>|</span><a href="#38896540">prev</a><span>|</span><a href="#38896059">next</a><span>|</span><label class="collapse" for="c-38896529">[-]</label><label class="expand" for="c-38896529">[1 more]</label></div><br/><div class="children"><div class="content">Maybe they just don’t trust you enough and all of the machines you think are physical hosts that you ssh into are in fact nothing but containers, and there is a whole other team of people at said company controlling the real servers :thinking_face:</div><br/></div></div></div></div></div></div><div id="38896059" class="c"><input type="checkbox" id="c-38896059" checked=""/><div class="controls bullet"><span class="by">JustAPerson</span><span>|</span><a href="#38896170">prev</a><span>|</span><a href="#38896201">next</a><span>|</span><label class="collapse" for="c-38896059">[-]</label><label class="expand" for="c-38896059">[1 more]</label></div><br/><div class="children"><div class="content">Slides: 
<a href="https:&#x2F;&#x2F;cfp.all-systems-go.io&#x2F;media&#x2F;all-systems-go-2023&#x2F;submissions&#x2F;YAHVZG&#x2F;resources&#x2F;ASG_2023_Adventures_of_Linux_Userspace__lLHnm5Y.pdf" rel="nofollow">https:&#x2F;&#x2F;cfp.all-systems-go.io&#x2F;media&#x2F;all-systems-go-2023&#x2F;subm...</a></div><br/></div></div><div id="38896201" class="c"><input type="checkbox" id="c-38896201" checked=""/><div class="controls bullet"><span class="by">otterley</span><span>|</span><a href="#38896059">prev</a><span>|</span><a href="#38896301">next</a><span>|</span><label class="collapse" for="c-38896201">[-]</label><label class="expand" for="c-38896201">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious as to why Meta settled on CentOS Stream. Isn&#x27;t that unstable by design? How do they manage change in such a system? What are its benefits and drawbacks vis-a-vis the alternatives?</div><br/><div id="38896328" class="c"><input type="checkbox" id="c-38896328" checked=""/><div class="controls bullet"><span class="by">matthews2</span><span>|</span><a href="#38896201">parent</a><span>|</span><a href="#38896250">next</a><span>|</span><label class="collapse" for="c-38896328">[-]</label><label class="expand" for="c-38896328">[5 more]</label></div><br/><div class="children"><div class="content">CentOS Stream isn’t unstable in the way that something like Arch Linux or Debian Sid is.<p>They effectively only got rid of point releases. Instead of going from CentOS 7 to 7.1, you just regularly get updates. Since they’re a part of the same major release, they don’t contain breaking changes.<p>It’s no different from running Debian Stable with the -updates repository enabled.</div><br/><div id="38896372" class="c"><input type="checkbox" id="c-38896372" checked=""/><div class="controls bullet"><span class="by">elromulous</span><span>|</span><a href="#38896201">root</a><span>|</span><a href="#38896328">parent</a><span>|</span><a href="#38896927">next</a><span>|</span><label class="collapse" for="c-38896372">[-]</label><label class="expand" for="c-38896372">[1 more]</label></div><br/><div class="children"><div class="content">Just to add to this. It&#x27;s basically a way to get a rolling release.<p>Google did the same thing with Debian and rodete (ROlling DEbian TEsting).<p><a href="https:&#x2F;&#x2F;cloud.google.com&#x2F;blog&#x2F;topics&#x2F;developers-practitioners&#x2F;how-google-got-to-rolling-linux-releases-for-desktops" rel="nofollow">https:&#x2F;&#x2F;cloud.google.com&#x2F;blog&#x2F;topics&#x2F;developers-practitioner...</a></div><br/></div></div><div id="38896927" class="c"><input type="checkbox" id="c-38896927" checked=""/><div class="controls bullet"><span class="by">softirq</span><span>|</span><a href="#38896201">root</a><span>|</span><a href="#38896328">parent</a><span>|</span><a href="#38896372">prev</a><span>|</span><a href="#38896938">next</a><span>|</span><label class="collapse" for="c-38896927">[-]</label><label class="expand" for="c-38896927">[1 more]</label></div><br/><div class="children"><div class="content">But it does mean that the kernel ABI is never stable for kernel modules. In RHEL, the ABI is frozen for point releases.</div><br/></div></div><div id="38896938" class="c"><input type="checkbox" id="c-38896938" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38896201">root</a><span>|</span><a href="#38896328">parent</a><span>|</span><a href="#38896927">prev</a><span>|</span><a href="#38897389">next</a><span>|</span><label class="collapse" for="c-38896938">[-]</label><label class="expand" for="c-38896938">[1 more]</label></div><br/><div class="children"><div class="content">Er, CentOS already rolled over minor versions without user intervention.<p>Stream is more like Debian Testing</div><br/></div></div><div id="38897389" class="c"><input type="checkbox" id="c-38897389" checked=""/><div class="controls bullet"><span class="by">attentive</span><span>|</span><a href="#38896201">root</a><span>|</span><a href="#38896328">parent</a><span>|</span><a href="#38896938">prev</a><span>|</span><a href="#38896250">next</a><span>|</span><label class="collapse" for="c-38897389">[-]</label><label class="expand" for="c-38897389">[1 more]</label></div><br/><div class="children"><div class="content">That was my take on it. But CentOS Stream didn&#x27;t get a fix in time for last major CVE before RHEL&#x2F;Oracle or ubuntu&#x2F;debian for that matter. That killed it for me.</div><br/></div></div></div></div><div id="38896250" class="c"><input type="checkbox" id="c-38896250" checked=""/><div class="controls bullet"><span class="by">leoh</span><span>|</span><a href="#38896201">parent</a><span>|</span><a href="#38896328">prev</a><span>|</span><a href="#38896301">next</a><span>|</span><label class="collapse" for="c-38896250">[-]</label><label class="expand" for="c-38896250">[1 more]</label></div><br/><div class="children"><div class="content">It may be due to them testing fairly rigorously before deployment and thereby benefitting from the latest kernel security patches, for example. Google does something similar with Debian internally on workstations.</div><br/></div></div></div></div><div id="38896301" class="c"><input type="checkbox" id="c-38896301" checked=""/><div class="controls bullet"><span class="by">brcmthrowaway</span><span>|</span><a href="#38896201">prev</a><span>|</span><a href="#38895230">next</a><span>|</span><label class="collapse" for="c-38896301">[-]</label><label class="expand" for="c-38896301">[5 more]</label></div><br/><div class="children"><div class="content">Out of 1 million standard LAMP stack machines, how many will randomly fail?</div><br/><div id="38896651" class="c"><input type="checkbox" id="c-38896651" checked=""/><div class="controls bullet"><span class="by">dijit</span><span>|</span><a href="#38896301">parent</a><span>|</span><a href="#38895230">next</a><span>|</span><label class="collapse" for="c-38896651">[-]</label><label class="expand" for="c-38896651">[4 more]</label></div><br/><div class="children"><div class="content">On a long enough timeline? All of them.</div><br/><div id="38896734" class="c"><input type="checkbox" id="c-38896734" checked=""/><div class="controls bullet"><span class="by">pi-e-sigma</span><span>|</span><a href="#38896301">root</a><span>|</span><a href="#38896651">parent</a><span>|</span><a href="#38896943">next</a><span>|</span><label class="collapse" for="c-38896734">[-]</label><label class="expand" for="c-38896734">[1 more]</label></div><br/><div class="children"><div class="content">Only if you assume they would be kept up and running until they fail instead of simply being decommissioned at some point and turned into e-junk.</div><br/></div></div><div id="38896943" class="c"><input type="checkbox" id="c-38896943" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38896301">root</a><span>|</span><a href="#38896651">parent</a><span>|</span><a href="#38896734">prev</a><span>|</span><a href="#38895230">next</a><span>|</span><label class="collapse" for="c-38896943">[-]</label><label class="expand" for="c-38896943">[2 more]</label></div><br/><div class="children"><div class="content">For that to be true requires a <i>really</i> long timeline.</div><br/><div id="38899531" class="c"><input type="checkbox" id="c-38899531" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#38896301">root</a><span>|</span><a href="#38896943">parent</a><span>|</span><a href="#38895230">next</a><span>|</span><label class="collapse" for="c-38899531">[-]</label><label class="expand" for="c-38899531">[1 more]</label></div><br/><div class="children"><div class="content">If the failures are independent random events, yes.</div><br/></div></div></div></div></div></div></div></div><div id="38895230" class="c"><input type="checkbox" id="c-38895230" checked=""/><div class="controls bullet"><span class="by">theyinwhy</span><span>|</span><a href="#38896301">prev</a><span>|</span><label class="collapse" for="c-38895230">[-]</label><label class="expand" for="c-38895230">[5 more]</label></div><br/><div class="children"><div class="content">Meta at CCC, I did not think that was possible.</div><br/><div id="38895495" class="c"><input type="checkbox" id="c-38895495" checked=""/><div class="controls bullet"><span class="by">jaeckel</span><span>|</span><a href="#38895230">parent</a><span>|</span><a href="#38895754">next</a><span>|</span><label class="collapse" for="c-38895495">[-]</label><label class="expand" for="c-38895495">[1 more]</label></div><br/><div class="children"><div class="content">Their media hosting platform is used by many conferences. That&#x27;s a video of a non-CCC conference, called asg, earlier in 2023, not to be confused with the recently held congress or other CCC headlined events.</div><br/></div></div><div id="38895754" class="c"><input type="checkbox" id="c-38895754" checked=""/><div class="controls bullet"><span class="by">pengaru</span><span>|</span><a href="#38895230">parent</a><span>|</span><a href="#38895495">prev</a><span>|</span><a href="#38896709">next</a><span>|</span><label class="collapse" for="c-38895754">[-]</label><label class="expand" for="c-38895754">[1 more]</label></div><br/><div class="children"><div class="content">Meta was a primary sponsor for the most recent All-Systems-Go, and employs several folks contributing upstream to systemd.<p>Also note Lennart is no longer even at RedHat, he&#x27;s at Microsoft nowadays.  I&#x27;m surprised Microsoft wasn&#x27;t a major All-Systems-Go sponsor alongside Meta...<p>There&#x27;s been a lot of earth shifting under these projects, for better or worse.</div><br/></div></div><div id="38896709" class="c"><input type="checkbox" id="c-38896709" checked=""/><div class="controls bullet"><span class="by">dfc</span><span>|</span><a href="#38895230">parent</a><span>|</span><a href="#38895754">prev</a><span>|</span><a href="#38895606">next</a><span>|</span><label class="collapse" for="c-38896709">[-]</label><label class="expand" for="c-38896709">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;all-systems-go.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;all-systems-go.io&#x2F;</a></div><br/></div></div><div id="38895606" class="c"><input type="checkbox" id="c-38895606" checked=""/><div class="controls bullet"><span class="by">dontupvoteme</span><span>|</span><a href="#38895230">parent</a><span>|</span><a href="#38896709">prev</a><span>|</span><label class="collapse" for="c-38895606">[-]</label><label class="expand" for="c-38895606">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s changed a lot in the last few years.<p>Rather captured one might say.</div><br/></div></div></div></div></div></div></div></div></div></body></html>