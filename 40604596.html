<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717750850254" as="style"/><link rel="stylesheet" href="styles.css?v=1717750850254"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/sosy-lab/cpu-energy-meter">CPU Energy Meter: A tool for measuring energy consumption of Intel CPUs</a>Â <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>20 comments</span></div><br/><div><div id="40605402" class="c"><input type="checkbox" id="c-40605402" checked=""/><div class="controls bullet"><span class="by">sirn</span><span>|</span><a href="#40606428">next</a><span>|</span><label class="collapse" for="c-40605402">[-]</label><label class="expand" for="c-40605402">[5 more]</label></div><br/><div class="children"><div class="content">Since kernel 3.3 or so, RAPL is also exposed through `&#x2F;sys&#x2F;devices&#x2F;virtual&#x2F;powercap&#x2F;intel-rapl&#x2F;*&#x2F;energy_uj` in micro-joules (if not, `modprobe intel_rapl`). So if you want to do a quick power measurement, it can be done using just POSIX sh (root required):<p><pre><code>    # in milli-watt (1000 = 1W) because shell arithmetic doesn&#x27;t do floating point 
    while true; do
        LAST_MJ=$MJ
        MJ=$(cat &#x2F;sys&#x2F;devices&#x2F;virtual&#x2F;powercap&#x2F;intel-rapl&#x2F;intel-rapl:0&#x2F;energy_uj)
        echo $(((MJ - LAST_MJ) &#x2F; 1000))
        sleep 1
    done
</code></pre>
Despite the powercap name being intel-rapl, the powercap interface is also available on AMD machines.<p>For a more detailed reading on several more metrics about the CPU, I think pcm[1] may be a better tool (it&#x27;s a successor to the Intel Power Gadget the project was forked from). Though, it only works on Intel CPU.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;intel&#x2F;pcm">https:&#x2F;&#x2F;github.com&#x2F;intel&#x2F;pcm</a></div><br/><div id="40605958" class="c"><input type="checkbox" id="c-40605958" checked=""/><div class="controls bullet"><span class="by">149765</span><span>|</span><a href="#40605402">parent</a><span>|</span><a href="#40605702">next</a><span>|</span><label class="collapse" for="c-40605958">[-]</label><label class="expand" for="c-40605958">[1 more]</label></div><br/><div class="children"><div class="content">There is also perf:<p><pre><code>  perf stat -e &#x27;power&#x2F;energy-pkg&#x2F;&#x27; -I 1000 --interval-count 3 
  #           time             counts   unit events
       1.001064377              11.00 Joules power&#x2F;energy-pkg&#x2F;                                                     
       2.002605466              10.98 Joules power&#x2F;energy-pkg&#x2F;                                                     
       3.003726824              11.01 Joules power&#x2F;energy-pkg&#x2F;</code></pre></div><br/></div></div><div id="40605702" class="c"><input type="checkbox" id="c-40605702" checked=""/><div class="controls bullet"><span class="by">lathiat</span><span>|</span><a href="#40605402">parent</a><span>|</span><a href="#40605958">prev</a><span>|</span><a href="#40605653">next</a><span>|</span><label class="collapse" for="c-40605702">[-]</label><label class="expand" for="c-40605702">[2 more]</label></div><br/><div class="children"><div class="content">AMD have an equivalent in uProf:
<a href="https:&#x2F;&#x2F;www.amd.com&#x2F;en&#x2F;developer&#x2F;uprof.html" rel="nofollow">https:&#x2F;&#x2F;www.amd.com&#x2F;en&#x2F;developer&#x2F;uprof.html</a><p>Power profiling is listed as supported on all CPUs though a bunch of features (including memory bandwidth, one that I had wanted) are limited to EPYC CPUs and don&#x27;t exist in Ryzen or Threadripper.</div><br/><div id="40606575" class="c"><input type="checkbox" id="c-40606575" checked=""/><div class="controls bullet"><span class="by">3abiton</span><span>|</span><a href="#40605402">root</a><span>|</span><a href="#40605702">parent</a><span>|</span><a href="#40605653">next</a><span>|</span><label class="collapse" for="c-40606575">[-]</label><label class="expand" for="c-40606575">[1 more]</label></div><br/><div class="children"><div class="content">How to do so with pn Ryzen? RAPL?</div><br/></div></div></div></div><div id="40605653" class="c"><input type="checkbox" id="c-40605653" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#40605402">parent</a><span>|</span><a href="#40605702">prev</a><span>|</span><a href="#40606428">next</a><span>|</span><label class="collapse" for="c-40605653">[-]</label><label class="expand" for="c-40605653">[1 more]</label></div><br/><div class="children"><div class="content">Another easy tool that may already be on your system is &quot;turbostat&quot;.</div><br/></div></div></div></div><div id="40605847" class="c"><input type="checkbox" id="c-40605847" checked=""/><div class="controls bullet"><span class="by">speedgoose</span><span>|</span><a href="#40606428">prev</a><span>|</span><a href="#40606189">next</a><span>|</span><label class="collapse" for="c-40605847">[-]</label><label class="expand" for="c-40605847">[2 more]</label></div><br/><div class="children"><div class="content">Are the energy consumption values reported by Intel CPUs accurate? Measuring energy consumption for cheap is hard, so I wonder whether they are big approximations or they have some magic tricks.</div><br/><div id="40606664" class="c"><input type="checkbox" id="c-40606664" checked=""/><div class="controls bullet"><span class="by">lastgeniusua</span><span>|</span><a href="#40605847">parent</a><span>|</span><a href="#40606189">next</a><span>|</span><label class="collapse" for="c-40606664">[-]</label><label class="expand" for="c-40606664">[1 more]</label></div><br/><div class="children"><div class="content">They&#x27;ve been verified to be fairly accurate:<p><a href="https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;2989081.2989088" rel="nofollow">https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;2989081.2989088</a><p><a href="https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3177754" rel="nofollow">https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3177754</a></div><br/></div></div></div></div><div id="40606189" class="c"><input type="checkbox" id="c-40606189" checked=""/><div class="controls bullet"><span class="by">wiz21c</span><span>|</span><a href="#40605847">prev</a><span>|</span><a href="#40605004">next</a><span>|</span><label class="collapse" for="c-40606189">[-]</label><label class="expand" for="c-40606189">[1 more]</label></div><br/><div class="children"><div class="content">Could help to combine with this ?<p>&quot;Identifying Compiler Options to Minimise Energy Consumption for Embedded platforms&quot;<p><a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;1303.6485" rel="nofollow">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;1303.6485</a></div><br/></div></div><div id="40605004" class="c"><input type="checkbox" id="c-40605004" checked=""/><div class="controls bullet"><span class="by">petermcneeley</span><span>|</span><a href="#40606189">prev</a><span>|</span><a href="#40605059">next</a><span>|</span><label class="collapse" for="c-40605004">[-]</label><label class="expand" for="c-40605004">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;manpages.debian.org&#x2F;testing&#x2F;linux-cpupower&#x2F;turbostat.8.en.html" rel="nofollow">https:&#x2F;&#x2F;manpages.debian.org&#x2F;testing&#x2F;linux-cpupower&#x2F;turbostat...</a></div><br/></div></div><div id="40605059" class="c"><input type="checkbox" id="c-40605059" checked=""/><div class="controls bullet"><span class="by">iAm25626</span><span>|</span><a href="#40605004">prev</a><span>|</span><a href="#40605835">next</a><span>|</span><label class="collapse" for="c-40605059">[-]</label><label class="expand" for="c-40605059">[1 more]</label></div><br/><div class="children"><div class="content">check out Kepler from CNCF
<a href="https:&#x2F;&#x2F;sustainable-computing.io&#x2F;design&#x2F;architecture&#x2F;" rel="nofollow">https:&#x2F;&#x2F;sustainable-computing.io&#x2F;design&#x2F;architecture&#x2F;</a></div><br/></div></div><div id="40605835" class="c"><input type="checkbox" id="c-40605835" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#40605059">prev</a><span>|</span><a href="#40606012">next</a><span>|</span><label class="collapse" for="c-40605835">[-]</label><label class="expand" for="c-40605835">[1 more]</label></div><br/><div class="children"><div class="content">As far as I know RAPL is implemented entirely in the CPU and is an estimate of CPU power using a complex model of CPU state, temperature and such. I don&#x27;t believe it&#x27;s an actual power measurement like e.g. SVI telemetry is.</div><br/></div></div><div id="40606012" class="c"><input type="checkbox" id="c-40606012" checked=""/><div class="controls bullet"><span class="by">imvetri</span><span>|</span><a href="#40605835">prev</a><span>|</span><a href="#40604812">next</a><span>|</span><label class="collapse" for="c-40606012">[-]</label><label class="expand" for="c-40606012">[2 more]</label></div><br/><div class="children"><div class="content">wouldnt the meter also consume excess energy?</div><br/><div id="40606688" class="c"><input type="checkbox" id="c-40606688" checked=""/><div class="controls bullet"><span class="by">chickenchase-rd</span><span>|</span><a href="#40606012">parent</a><span>|</span><a href="#40604812">next</a><span>|</span><label class="collapse" for="c-40606688">[-]</label><label class="expand" for="c-40606688">[1 more]</label></div><br/><div class="children"><div class="content">Someone should make a monitor for the monitor</div><br/></div></div></div></div></div></div></div></div></div></body></html>