<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1721898068683" as="style"/><link rel="stylesheet" href="styles.css?v=1721898068683"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sysdig.com/blog/ebpf-offensive-capabilities/">eBPF Offensive Capabilities – Get Ready for Next-Gen Malware (2023)</a> <span class="domain">(<a href="https://sysdig.com">sysdig.com</a>)</span></div><div class="subtext"><span>password4321</span> | <span>9 comments</span></div><br/><div><div id="41066342" class="c"><input type="checkbox" id="c-41066342" checked=""/><div class="controls bullet"><span class="by">miggol</span><span>|</span><a href="#41066023">next</a><span>|</span><label class="collapse" for="c-41066342">[-]</label><label class="expand" for="c-41066342">[2 more]</label></div><br/><div class="children"><div class="content">The sudoers example to me was the most illustrative.<p>Though it&#x27;s still not exactly clear to me what the verifier intends to prevent. I can understand that it limits how far you can look up into the stack and what memory your eBPF program can read. But can we otherwise just run any random code in eBPF? The register value tracking and DAG stuff kind of goes over my head.<p>In short, could I write a Scheme in eBPF and pass it a program at runtime, through a map?</div><br/><div id="41066399" class="c"><input type="checkbox" id="c-41066399" checked=""/><div class="controls bullet"><span class="by">dwattttt</span><span>|</span><a href="#41066342">parent</a><span>|</span><a href="#41066023">next</a><span>|</span><label class="collapse" for="c-41066399">[-]</label><label class="expand" for="c-41066399">[1 more]</label></div><br/><div class="children"><div class="content">It also prevents backwards edges in the control flow graph; no loops (unless entirely unrolled)</div><br/></div></div></div></div><div id="41066023" class="c"><input type="checkbox" id="c-41066023" checked=""/><div class="controls bullet"><span class="by">red_admiral</span><span>|</span><a href="#41066342">prev</a><span>|</span><a href="#41065218">next</a><span>|</span><label class="collapse" for="c-41066023">[-]</label><label class="expand" for="c-41066023">[5 more]</label></div><br/><div class="children"><div class="content">Am I reading this wrong, or is it a variant of &quot;If you have kernel access you can mess with userland&quot;?</div><br/><div id="41066393" class="c"><input type="checkbox" id="c-41066393" checked=""/><div class="controls bullet"><span class="by">s4mw1se</span><span>|</span><a href="#41066023">parent</a><span>|</span><a href="#41066325">next</a><span>|</span><label class="collapse" for="c-41066393">[-]</label><label class="expand" for="c-41066393">[1 more]</label></div><br/><div class="children"><div class="content">not a ebpf expert, just been on my radar lately because i’m going through a sysdig poc.<p>To me It feels more like a reverse proxy for intercepting traffic going between user land and kernel space.<p>As we move to k8s and classic EDR isn’t feasible i 100% understand the need. It still feels like a dumb thing humanity has done and will blow up in our face after having the kernel &#x2F; user space security boundary beat into our heads for so long.</div><br/></div></div><div id="41066325" class="c"><input type="checkbox" id="c-41066325" checked=""/><div class="controls bullet"><span class="by">tanelpoder</span><span>|</span><a href="#41066023">parent</a><span>|</span><a href="#41066393">prev</a><span>|</span><a href="#41066099">next</a><span>|</span><label class="collapse" for="c-41066325">[-]</label><label class="expand" for="c-41066325">[1 more]</label></div><br/><div class="children"><div class="content">I guess one point of the article is that eBPF-injected programs are another place where malware can hide. But then again, it&#x27;s easy to list all currently loaded eBPF programs (well, unless there&#x27;s a way to somehow hide&#x2F;disconnect them, but keep them running).</div><br/></div></div><div id="41066099" class="c"><input type="checkbox" id="c-41066099" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#41066023">parent</a><span>|</span><a href="#41066325">prev</a><span>|</span><a href="#41066101">next</a><span>|</span><label class="collapse" for="c-41066099">[-]</label><label class="expand" for="c-41066099">[1 more]</label></div><br/><div class="children"><div class="content">Do you mean having malware code  already running in kernel space, or having system permissions to install new kernels?<p>For the latter case, there are now mechanisms that aim to prevent root from modifying the kernel or otherwise getting ring 0 access, see eg <a href="https:&#x2F;&#x2F;www.man7.org&#x2F;linux&#x2F;man-pages&#x2F;man7&#x2F;kernel_lockdown.7.html" rel="nofollow">https:&#x2F;&#x2F;www.man7.org&#x2F;linux&#x2F;man-pages&#x2F;man7&#x2F;kernel_lockdown.7....</a><p>But even in a non locked down mode, there are practical advantages for the adversary in using officially supported interfaces vs their own kernel module or leveraging some i&#x2F;o path to access kernel memory.</div><br/></div></div><div id="41066101" class="c"><input type="checkbox" id="c-41066101" checked=""/><div class="controls bullet"><span class="by">cwillu</span><span>|</span><a href="#41066023">parent</a><span>|</span><a href="#41066099">prev</a><span>|</span><a href="#41065218">next</a><span>|</span><label class="collapse" for="c-41066101">[-]</label><label class="expand" for="c-41066101">[1 more]</label></div><br/><div class="children"><div class="content">No, you&#x27;re reading it right.</div><br/></div></div></div></div></div></div></div></div></div></body></html>