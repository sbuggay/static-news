<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1722416514608" as="style"/><link rel="stylesheet" href="styles.css?v=1722416514608"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://trayce.dev">Show HN: Trayce – Network tab for Docker containers</a> <span class="domain">(<a href="https://trayce.dev">trayce.dev</a>)</span></div><div class="subtext"><span>ev_dev3</span> | <span>19 comments</span></div><br/><div><div id="41117201" class="c"><input type="checkbox" id="c-41117201" checked=""/><div class="controls bullet"><span class="by">gyre007</span><span>|</span><a href="#41116023">next</a><span>|</span><label class="collapse" for="c-41117201">[-]</label><label class="expand" for="c-41117201">[1 more]</label></div><br/><div class="children"><div class="content">Looks very cool. I think you should write a docker extension <a href="https:&#x2F;&#x2F;www.docker.com&#x2F;products&#x2F;extensions&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.docker.com&#x2F;products&#x2F;extensions&#x2F;</a></div><br/></div></div><div id="41116458" class="c"><input type="checkbox" id="c-41116458" checked=""/><div class="controls bullet"><span class="by">inyorgroove</span><span>|</span><a href="#41116023">prev</a><span>|</span><a href="#41115795">next</a><span>|</span><label class="collapse" for="c-41116458">[-]</label><label class="expand" for="c-41116458">[3 more]</label></div><br/><div class="children"><div class="content">This tool has really cool potential!<p>Just one problem I noticed imminently that prevents me from using this, the docker agent container[1] isn&#x27;t multi-architecture, this will be an issue on Apple Silicon devices. This is something I have some experience setting up if you are looking for help, though will take some research to figure out how to get going in github actions etc.<p>1: <a href="https:&#x2F;&#x2F;github.com&#x2F;evanrolfe&#x2F;trayce_agent&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;evanrolfe&#x2F;trayce_agent&#x2F;</a><p>EDIT: quick search found this post, tested on a side project repo it works great: <a href="https:&#x2F;&#x2F;depot.dev&#x2F;blog&#x2F;multi-platform-docker-images-in-github-actions">https:&#x2F;&#x2F;depot.dev&#x2F;blog&#x2F;multi-platform-docker-images-in-githu...</a></div><br/><div id="41116583" class="c"><input type="checkbox" id="c-41116583" checked=""/><div class="controls bullet"><span class="by">ev_dev3</span><span>|</span><a href="#41116458">parent</a><span>|</span><a href="#41116561">next</a><span>|</span><label class="collapse" for="c-41116583">[-]</label><label class="expand" for="c-41116583">[1 more]</label></div><br/><div class="children"><div class="content">Good point, thanks. Its only ever been tested on a Mac with an Intel chip. I will try and sort this out ASAP!</div><br/></div></div></div></div><div id="41115795" class="c"><input type="checkbox" id="c-41115795" checked=""/><div class="controls bullet"><span class="by">upon_drumhead</span><span>|</span><a href="#41116458">prev</a><span>|</span><a href="#41117120">next</a><span>|</span><label class="collapse" for="c-41115795">[-]</label><label class="expand" for="c-41115795">[1 more]</label></div><br/><div class="children"><div class="content">This is super cool! I&#x27;m gonna give this a try shortly.<p>One thing that we&#x27;ve been craving for our infrastructure is something like Little Snitch for containers. We make extensive use of third party containers and have been very concerned about any sort of data exfiltration attempts via supply chain attacks. We have a pile of iptable rules right now, but they&#x27;re error prone and difficult to rationalize about. If we had something like Little Snitch where we would get the feed of connections and allow us to approve&#x2F;reject them, it would make us all sleep a lot better.<p>Best of luck with your endeavors!</div><br/></div></div><div id="41117120" class="c"><input type="checkbox" id="c-41117120" checked=""/><div class="controls bullet"><span class="by">piyushtechsavy</span><span>|</span><a href="#41115795">prev</a><span>|</span><a href="#41116240">next</a><span>|</span><label class="collapse" for="c-41117120">[-]</label><label class="expand" for="c-41117120">[1 more]</label></div><br/><div class="children"><div class="content">This seems super cool debugging tool. Is this purely for dockerized applications or can also be used with simple microservices.</div><br/></div></div><div id="41116240" class="c"><input type="checkbox" id="c-41116240" checked=""/><div class="controls bullet"><span class="by">thomasfromcdnjs</span><span>|</span><a href="#41117120">prev</a><span>|</span><a href="#41116410">next</a><span>|</span><label class="collapse" for="c-41116240">[-]</label><label class="expand" for="c-41116240">[3 more]</label></div><br/><div class="children"><div class="content">I wanted to have a play but crashed when running the container command<p><pre><code>    libbpf: sec &#x27;.reluprobe&#x2F;gotls_exit_read_register&#x27;: relo #5: insn #148 against &#x27;active_go_read_args_map&#x27;
    libbpf: prog &#x27;probe_exit_go_tls_read&#x27;: found map 17 (active_go_read_args_map, sec 30, off 528) for insn #148
    libbpf: Error in bpf_object__probe_loading():Function not implemented(38). Couldn&#x27;t load trivial BPF program. Make sure your kernel supports BPF (CONFIG_BPF_SYSCALL=y) and&#x2F;or that RLIMIT_MEMLOCK is set to big enough value.
    libbpf: failed to load object &#x27;main.bpf.o&#x27;</code></pre>
failed to load BPF object: function not implemented</div><br/><div id="41116581" class="c"><input type="checkbox" id="c-41116581" checked=""/><div class="controls bullet"><span class="by">ev_dev3</span><span>|</span><a href="#41116240">parent</a><span>|</span><a href="#41116549">next</a><span>|</span><label class="collapse" for="c-41116581">[-]</label><label class="expand" for="c-41116581">[1 more]</label></div><br/><div class="children"><div class="content">Are you running on Mac or Linux? What linux kernel version do you have in docker, run: `uname -r`. If you are using Mac with Docker Desktop then the first thing I would do is make sure thats on the latest version.<p>This is a common problem however when trying to run ebpf programs in docker, see &quot;CONFIG_BPF_SYSCALL and RLIMIT_MEMLOCK issues&quot; here: <a href="http:&#x2F;&#x2F;andreybleme.com&#x2F;2022-05-22&#x2F;running-ebpf-programs-on-docker-containers&#x2F;" rel="nofollow">http:&#x2F;&#x2F;andreybleme.com&#x2F;2022-05-22&#x2F;running-ebpf-programs-on-d...</a><p>Also see &quot;Configuring limits in the container&quot; here too: <a href="https:&#x2F;&#x2F;blog.bitsofnetworks.org&#x2F;debug-bpf-docker-l2tpns&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.bitsofnetworks.org&#x2F;debug-bpf-docker-l2tpns&#x2F;</a></div><br/></div></div></div></div><div id="41116410" class="c"><input type="checkbox" id="c-41116410" checked=""/><div class="controls bullet"><span class="by">iamcreasy</span><span>|</span><a href="#41116240">prev</a><span>|</span><a href="#41116986">next</a><span>|</span><label class="collapse" for="c-41116410">[-]</label><label class="expand" for="c-41116410">[6 more]</label></div><br/><div class="children"><div class="content">Cool!<p>&gt; It uses EBPF to achieve zero-configuration sniffing of TLS-encrypted traffic.<p>Can someone ELI5 this?</div><br/><div id="41116585" class="c"><input type="checkbox" id="c-41116585" checked=""/><div class="controls bullet"><span class="by">ev_dev3</span><span>|</span><a href="#41116410">parent</a><span>|</span><a href="#41116576">next</a><span>|</span><label class="collapse" for="c-41116585">[-]</label><label class="expand" for="c-41116585">[3 more]</label></div><br/><div class="children"><div class="content">I won&#x27;t explain what ebpf is because google can do a better job of that than me but essentially this program hooks into the low-level system calls being made by your programs, so its able to grab un-encrypted network traffic before its encrypted and sent over the network. &quot;zero-configuration&quot; here mean you dont have to do much manual configuration to get this working.</div><br/><div id="41117028" class="c"><input type="checkbox" id="c-41117028" checked=""/><div class="controls bullet"><span class="by">Varriount</span><span>|</span><a href="#41116410">root</a><span>|</span><a href="#41116585">parent</a><span>|</span><a href="#41116576">next</a><span>|</span><label class="collapse" for="c-41117028">[-]</label><label class="expand" for="c-41117028">[2 more]</label></div><br/><div class="children"><div class="content">Huh, is TLS being handled in the kernel these days? I thought most systems still used usermode libraries.</div><br/><div id="41117078" class="c"><input type="checkbox" id="c-41117078" checked=""/><div class="controls bullet"><span class="by">ev_dev3</span><span>|</span><a href="#41116410">root</a><span>|</span><a href="#41117028">parent</a><span>|</span><a href="#41116576">next</a><span>|</span><label class="collapse" for="c-41117078">[-]</label><label class="expand" for="c-41117078">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m using the term &quot;low level system calls&quot; loosely here since the poster asked for ELI5. Trayce actually uses a combination of kprobes for system calls and uprobes to monitor calls to OpenSSL or the Go crypto&#x2F;tls package. More details are here: <a href="https:&#x2F;&#x2F;github.com&#x2F;evanrolfe&#x2F;trayce_agent&#x2F;blob&#x2F;main&#x2F;docs&#x2F;README.md">https:&#x2F;&#x2F;github.com&#x2F;evanrolfe&#x2F;trayce_agent&#x2F;blob&#x2F;main&#x2F;docs&#x2F;REA...</a></div><br/></div></div></div></div></div></div><div id="41116444" class="c"><input type="checkbox" id="c-41116444" checked=""/><div class="controls bullet"><span class="by">ThaDood</span><span>|</span><a href="#41116410">parent</a><span>|</span><a href="#41116576">prev</a><span>|</span><a href="#41116986">next</a><span>|</span><label class="collapse" for="c-41116444">[-]</label><label class="expand" for="c-41116444">[1 more]</label></div><br/><div class="children"><div class="content">IIRC EBPF is an enhanced version of the Berkeley Packet filter. In this scenario I believe it is being used for sandboxing a low level process to allow for TLS &quot;decryption&quot; on network connections related to Docker.</div><br/></div></div></div></div><div id="41116986" class="c"><input type="checkbox" id="c-41116986" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#41116410">prev</a><span>|</span><label class="collapse" for="c-41116986">[-]</label><label class="expand" for="c-41116986">[2 more]</label></div><br/><div class="children"><div class="content">Licence? Assuming GPL if it&#x27;s using Qt?</div><br/><div id="41117285" class="c"><input type="checkbox" id="c-41117285" checked=""/><div class="controls bullet"><span class="by">ev_dev3</span><span>|</span><a href="#41116986">parent</a><span>|</span><label class="collapse" for="c-41117285">[-]</label><label class="expand" for="c-41117285">[1 more]</label></div><br/><div class="children"><div class="content">Yes, GPL3. I&#x27;ve added the license to the repo.</div><br/></div></div></div></div></div></div></div></div></div></body></html>