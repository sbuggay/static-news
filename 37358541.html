<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1693645255709" as="style"/><link rel="stylesheet" href="styles.css?v=1693645255709"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://brooker.co.za/blog/2023/07/28/ds-testing.html">Invariants: A Better Debugger?</a>Â <span class="domain">(<a href="https://brooker.co.za">brooker.co.za</a>)</span></div><div class="subtext"><span>r4um</span> | <span>11 comments</span></div><br/><div><div id="37359039" class="c"><input type="checkbox" id="c-37359039" checked=""/><div class="controls bullet"><span class="by">kstrauser</span><span>|</span><a href="#37359270">next</a><span>|</span><label class="collapse" for="c-37359039">[-]</label><label class="expand" for="c-37359039">[2 more]</label></div><br/><div class="children"><div class="content">I find the general point interesting, but want to nitpick:<p>&gt; &quot;items in the deleted state must have a deleted time&quot;<p>I much prefer making it impossible to represent bad state, like rephrasing at as &quot;items are deleted if their deleted_time property is set&quot;. In this case, that makes the deletion atomic: there&#x27;s never an instant where it&#x27;s ambiguous if the object was deleted.<p>That doesn&#x27;t disagree with his premise. It&#x27;s an additional recommendation.</div><br/><div id="37359196" class="c"><input type="checkbox" id="c-37359196" checked=""/><div class="controls bullet"><span class="by">kartoshechka</span><span>|</span><a href="#37359039">parent</a><span>|</span><a href="#37359270">next</a><span>|</span><label class="collapse" for="c-37359196">[-]</label><label class="expand" for="c-37359196">[1 more]</label></div><br/><div class="children"><div class="content">sometimes it&#x27;s not easily achievable, when code is owned by other team or data comes from external source. I guess forbidding invalid state is the best option, and checking invariants is viable choice when you can&#x27;t avoid invalid states</div><br/></div></div></div></div><div id="37359270" class="c"><input type="checkbox" id="c-37359270" checked=""/><div class="controls bullet"><span class="by">qazxcvbnm</span><span>|</span><a href="#37359039">prev</a><span>|</span><a href="#37359213">next</a><span>|</span><label class="collapse" for="c-37359270">[-]</label><label class="expand" for="c-37359270">[2 more]</label></div><br/><div class="children"><div class="content">In your experience, what properties makes a good invariant, and how does one find them in practice for a new system?</div><br/><div id="37359522" class="c"><input type="checkbox" id="c-37359522" checked=""/><div class="controls bullet"><span class="by">_a_a_a_</span><span>|</span><a href="#37359270">parent</a><span>|</span><a href="#37359213">next</a><span>|</span><label class="collapse" for="c-37359522">[-]</label><label class="expand" for="c-37359522">[1 more]</label></div><br/><div class="children"><div class="content">Anything that must be true. Taking a sqrt of a float f? Assert f is positive.<p>Can&#x27;t read from a closed file? Assert the file is open.<p>The classic, transferring cash from account a to account b? Assert that a+b before = a+b after.<p>Object should be in a given state after a certain method is invoked? Assert it.<p>It is possible to assert some invariants at compile time using strong typing, that&#x27;s pretty useful too and I&#x27;m learning to do that myself (nothing clever, it&#x27;s just thinking of 2 different classes to represent 2 different states, or use phantom types). More complex compile-time assertions are possible using dependent types, but that&#x27;s out of my pay grade at the moment.</div><br/></div></div></div></div><div id="37359213" class="c"><input type="checkbox" id="c-37359213" checked=""/><div class="controls bullet"><span class="by">nottheengineer</span><span>|</span><a href="#37359270">prev</a><span>|</span><a href="#37359437">next</a><span>|</span><label class="collapse" for="c-37359213">[-]</label><label class="expand" for="c-37359213">[3 more]</label></div><br/><div class="children"><div class="content">As an ABAP developer looking to get back into the normal world I&#x27;m a little scared about how debugging will be like.<p>After playing around with a bit of C and trying gdb, I asked myself if this is really what people use. The display constantly breaks and there&#x27;s not a lot of stuff to quickly walk through code and visualize what it&#x27;s doing.<p>If there&#x27;s something I don&#x27;t understand within 15 seconds in ABAP, I fire up the debugger.<p>ABAP is a ridiculously complicated language that&#x27;s been getting more and more features tacked on for 30 years and there are now about 1000 instructions in it. I firmly believe that there are some instructions in there that not a single person on earth understands, so it needs a good debugger to make it usable.<p>I jump into the debugger before even trying to look at the code because it shows me everything in the usual editor component and I can navigate through it as fast as I can read, so it&#x27;s basically assisted reading.<p>I couldn&#x27;t imagine doing anything like that with GDB.
Am I just too stupid to go fast and quickly get information in GDB? Is there a better alternative that I completely missed. Is non-ABAP code just more abstract to a point where debugging in general doesn&#x27;t make much sense anymore?<p>Tying that back to the article: I agree that making all important assumptions explicit with assertions helps a lot with not shooting yourself in the foot. I can usually test the result and use my trusty debugger to find problems without assertions as well, but that requires remembering all my assumptions and knowing exactly what I want my code to do. If I write the assumptions down, I don&#x27;t have to remember them and the next dev will be able to see what I thought. I also don&#x27;t need to check if they still hold true since the runtime does that for me and hands a short dump to anyone who violates them.</div><br/><div id="37359630" class="c"><input type="checkbox" id="c-37359630" checked=""/><div class="controls bullet"><span class="by">eloisius</span><span>|</span><a href="#37359213">parent</a><span>|</span><a href="#37359339">next</a><span>|</span><label class="collapse" for="c-37359630">[-]</label><label class="expand" for="c-37359630">[1 more]</label></div><br/><div class="children"><div class="content">Seer is a decent front end for gdb<p><a href="https:&#x2F;&#x2F;github.com&#x2F;epasveer&#x2F;seer">https:&#x2F;&#x2F;github.com&#x2F;epasveer&#x2F;seer</a></div><br/></div></div><div id="37359339" class="c"><input type="checkbox" id="c-37359339" checked=""/><div class="controls bullet"><span class="by">matthews2</span><span>|</span><a href="#37359213">parent</a><span>|</span><a href="#37359630">prev</a><span>|</span><a href="#37359437">next</a><span>|</span><label class="collapse" for="c-37359339">[-]</label><label class="expand" for="c-37359339">[1 more]</label></div><br/><div class="children"><div class="content">&gt; trying gdb, I asked myself if this is really what people use. The display constantly breaks and there&#x27;s not a lot of stuff to quickly walk through code and visualize what it&#x27;s doing<p>gdb has a tui that can show you multiple panes of information at a time, e.g. the source code, disassembly, and registers.<p>Other tools like Emacs, Eclipse, and CLion can use gdb as a backend and provide a friendlier interface on top.</div><br/></div></div></div></div><div id="37359437" class="c"><input type="checkbox" id="c-37359437" checked=""/><div class="controls bullet"><span class="by">voz_</span><span>|</span><a href="#37359213">prev</a><span>|</span><a href="#37359221">next</a><span>|</span><label class="collapse" for="c-37359437">[-]</label><label class="expand" for="c-37359437">[2 more]</label></div><br/><div class="children"><div class="content">Invariants are for sanity. Debuggers are for when the invariants are found to have been violated.</div><br/><div id="37359541" class="c"><input type="checkbox" id="c-37359541" checked=""/><div class="controls bullet"><span class="by">_a_a_a_</span><span>|</span><a href="#37359437">parent</a><span>|</span><a href="#37359221">next</a><span>|</span><label class="collapse" for="c-37359541">[-]</label><label class="expand" for="c-37359541">[1 more]</label></div><br/><div class="children"><div class="content">Interesting. That makes sense but in my experience if an assertion is triggered because something went wrong, I tend to add more assertions &#x27;higher up&#x27; the call chain to try to catch the cause of the assertion being triggered. Basically, to fail earlier.</div><br/></div></div></div></div><div id="37359221" class="c"><input type="checkbox" id="c-37359221" checked=""/><div class="controls bullet"><span class="by">_a_a_a_</span><span>|</span><a href="#37359437">prev</a><span>|</span><label class="collapse" for="c-37359221">[-]</label><label class="expand" for="c-37359221">[1 more]</label></div><br/><div class="children"><div class="content">I use assertions heavily in my own code and they work extremely well.<p>I don&#x27;t buy the distinction between assertions and invariants as made in the blog post though, as if one was a higher level variety of the other. You can assert anything (though it may get expensive!). I consider invariants to be the logical statement of what should be true, and an assertion to be a program statement that actually performs the check.<p>Terminology, terminology, it doesn&#x27;t matter. I agree with the author, it&#x27;s an incredibly valuable tool.</div><br/></div></div></div></div></div></div></div></body></html>