<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1735981259235" as="style"/><link rel="stylesheet" href="styles.css?v=1735981259235"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://lewiscampbell.tech/blog/250104.html">Do Files want to be Actors?</a> <span class="domain">(<a href="https://lewiscampbell.tech">lewiscampbell.tech</a>)</span></div><div class="subtext"><span>LAC-Tech</span> | <span>19 comments</span></div><br/><div><div id="42593272" class="c"><input type="checkbox" id="c-42593272" checked=""/><div class="controls bullet"><span class="by">ilaksh</span><span>|</span><a href="#42593465">next</a><span>|</span><label class="collapse" for="c-42593272">[-]</label><label class="expand" for="c-42593272">[2 more]</label></div><br/><div class="children"><div class="content">There are a lot of ways to skin a cat. I doubt that most of how Linux works is really ideal at this point. (Which is not to say it&#x27;s easy to replace or impractical).<p>But that structure&#x2F;API is very similar to many similar patterns in computing. Look at Smalltalk or OOP to some degree. Maybe extend it with operational transforms.<p>I think there are a lot of interesting alternative ways to look at operating systems and many developments over the years. Such as Plan 9, MirageOS, and several other projects.<p>Also just to clarify I love cats and need a better metaphor.</div><br/><div id="42593429" class="c"><input type="checkbox" id="c-42593429" checked=""/><div class="controls bullet"><span class="by">deepsun</span><span>|</span><a href="#42593272">parent</a><span>|</span><a href="#42593465">next</a><span>|</span><label class="collapse" for="c-42593429">[-]</label><label class="expand" for="c-42593429">[1 more]</label></div><br/><div class="children"><div class="content">This reminds me of modern mathematics -- a lot of interesting and useful stuff comes from looking at old concepts from another viewpoint (different way to skin a cat). E.g. &quot;what if we look at our stuffs in hand as elements of group XXX -- we get the whole group theory applicable now&quot; etc. The trick is to note similarities.<p>So now we can study Actor problems and apply it to io_uring to avoid pitfalls earlier.</div><br/></div></div></div></div><div id="42593465" class="c"><input type="checkbox" id="c-42593465" checked=""/><div class="controls bullet"><span class="by">RossBencina</span><span>|</span><a href="#42593272">prev</a><span>|</span><a href="#42593506">next</a><span>|</span><label class="collapse" for="c-42593465">[-]</label><label class="expand" for="c-42593465">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not really sure what the point of this post is. As soon as you introduce asynchronous queueing of operation descriptors and completions the analogy to Actors is present. IO completion ports are not a new concept in operating systems, nor is inter-process messaging. Hell classic MacOS has async IO command objects, with an API to queue them, most likely you&#x27;re going to put them in a queue when you get the completion callback too.</div><br/></div></div><div id="42593506" class="c"><input type="checkbox" id="c-42593506" checked=""/><div class="controls bullet"><span class="by">benatkin</span><span>|</span><a href="#42593465">prev</a><span>|</span><a href="#42593441">next</a><span>|</span><label class="collapse" for="c-42593506">[-]</label><label class="expand" for="c-42593506">[1 more]</label></div><br/><div class="children"><div class="content">In wasm or hyperlight it seems that libc can be whatever you want it to be. So using files like this could be powerful. It’s like FUSE is the default.</div><br/></div></div><div id="42593441" class="c"><input type="checkbox" id="c-42593441" checked=""/><div class="controls bullet"><span class="by">deepsun</span><span>|</span><a href="#42593506">prev</a><span>|</span><a href="#42593225">next</a><span>|</span><label class="collapse" for="c-42593441">[-]</label><label class="expand" for="c-42593441">[2 more]</label></div><br/><div class="children"><div class="content">The main benefit with Actors for me was that each Actor is single-threaded and stateful. That simplifies a lot (but moves the complexity to cross-actor communication). Not sure each file IO and state is guaranteed to be single-threaded.</div><br/><div id="42593482" class="c"><input type="checkbox" id="c-42593482" checked=""/><div class="controls bullet"><span class="by">RossBencina</span><span>|</span><a href="#42593441">parent</a><span>|</span><a href="#42593225">next</a><span>|</span><label class="collapse" for="c-42593482">[-]</label><label class="expand" for="c-42593482">[1 more]</label></div><br/><div class="children"><div class="content">Another characteristic of Actors is that Actors can spawn other Actors.<p>Also, &quot;the mail system&quot; (queues, message dispatch) is not part of the definition of the Actor Model. It&#x27;s an implementation detail.</div><br/></div></div></div></div><div id="42593225" class="c"><input type="checkbox" id="c-42593225" checked=""/><div class="controls bullet"><span class="by">accrual</span><span>|</span><a href="#42593441">prev</a><span>|</span><a href="#42593241">next</a><span>|</span><label class="collapse" for="c-42593225">[-]</label><label class="expand" for="c-42593225">[1 more]</label></div><br/><div class="children"><div class="content">Maybe it&#x27;s a bad analogy, but this reminded me of how the &quot;actors&quot; in Sims 1 were implemented. Rather than having a massive Sim class that knows how to interact with every object, the Sims ask each object what it can do, and it&#x27;s up to the object (kernel) to handle the implementation details (IO in this case), do its work, and return later when it&#x27;s done.</div><br/></div></div><div id="42593241" class="c"><input type="checkbox" id="c-42593241" checked=""/><div class="controls bullet"><span class="by">dsp_person</span><span>|</span><a href="#42593225">prev</a><span>|</span><a href="#42593211">next</a><span>|</span><label class="collapse" for="c-42593241">[-]</label><label class="expand" for="c-42593241">[2 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t we only have 2 actors, the kernel and our program &#x2F; event loop? But &quot;actors&quot; plural makes it sound like a system of many independent nodes &quot;sends new messages to other actors and computes a new local state for itself.&quot;</div><br/><div id="42593400" class="c"><input type="checkbox" id="c-42593400" checked=""/><div class="controls bullet"><span class="by">LAC-Tech</span><span>|</span><a href="#42593241">parent</a><span>|</span><a href="#42593211">next</a><span>|</span><label class="collapse" for="c-42593400">[-]</label><label class="expand" for="c-42593400">[1 more]</label></div><br/><div class="children"><div class="content">You know I&#x27;m not sure how many io_uring loops you&#x27;d need. If any wandering systems programmers around, could you tell us if there&#x27;s any advantage to having more than one per process?</div><br/></div></div></div></div><div id="42593211" class="c"><input type="checkbox" id="c-42593211" checked=""/><div class="controls bullet"><span class="by">rednafi</span><span>|</span><a href="#42593241">prev</a><span>|</span><a href="#42592837">next</a><span>|</span><label class="collapse" for="c-42593211">[-]</label><label class="expand" for="c-42593211">[3 more]</label></div><br/><div class="children"><div class="content">I wonder how the stdlibs of existing languages will take advantage of io_uring and async syscalls. Does this mean we won’t have to spin up a subprocess for the most trivial things?</div><br/><div id="42593412" class="c"><input type="checkbox" id="c-42593412" checked=""/><div class="controls bullet"><span class="by">LAC-Tech</span><span>|</span><a href="#42593211">parent</a><span>|</span><a href="#42592837">next</a><span>|</span><label class="collapse" for="c-42593412">[-]</label><label class="expand" for="c-42593412">[2 more]</label></div><br/><div class="children"><div class="content">The node.js std lib has had async versions of some of their modules for a while, eg fs&#x2F;promise[1] I know node.js uses epoll but I am pretty sure bun uses io_uring.<p>Also worth mentioning Zig has a realy great iouring library[2] right in the stdlib, which without looking up the source code I am guessing is what bun uses under the hood:<p>[1] <a href="https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;fs.html#promises-api" rel="nofollow">https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;fs.html#promises-api</a><p>[2] <a href="https:&#x2F;&#x2F;ziglang.org&#x2F;documentation&#x2F;0.13.0&#x2F;std&#x2F;#std.os.linux.IoUring" rel="nofollow">https:&#x2F;&#x2F;ziglang.org&#x2F;documentation&#x2F;0.13.0&#x2F;std&#x2F;#std.os.linux.I...</a> - (give it a minute to load, the zig people are great system programmers but webdevs they are not lol)</div><br/><div id="42593521" class="c"><input type="checkbox" id="c-42593521" checked=""/><div class="controls bullet"><span class="by">rednafi</span><span>|</span><a href="#42593211">root</a><span>|</span><a href="#42593412">parent</a><span>|</span><a href="#42592837">next</a><span>|</span><label class="collapse" for="c-42593521">[-]</label><label class="expand" for="c-42593521">[1 more]</label></div><br/><div class="children"><div class="content">Wow, the Zig lib is as close to raw io_uring as it gets. It directly accepts an fd, a submission, and a result queue.</div><br/></div></div></div></div></div></div><div id="42592837" class="c"><input type="checkbox" id="c-42592837" checked=""/><div class="controls bullet"><span class="by">crabmusket</span><span>|</span><a href="#42593211">prev</a><span>|</span><a href="#42593013">next</a><span>|</span><label class="collapse" for="c-42592837">[-]</label><label class="expand" for="c-42592837">[3 more]</label></div><br/><div class="children"><div class="content">Is this Greenspun&#x27;s tenth rule but for the BEAM? Is everything a distributed system?<p>(Trick question! A computer has for a long time been a distributed system, we just don&#x27;t like to worry about that usually.)</div><br/><div id="42592865" class="c"><input type="checkbox" id="c-42592865" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#42592837">parent</a><span>|</span><a href="#42593389">next</a><span>|</span><label class="collapse" for="c-42592865">[-]</label><label class="expand" for="c-42592865">[1 more]</label></div><br/><div class="children"><div class="content">I may be too far into the BEAM, but it&#x27;s definitely the case that a modern computer is a distributed system at so many levels.</div><br/></div></div><div id="42593389" class="c"><input type="checkbox" id="c-42593389" checked=""/><div class="controls bullet"><span class="by">LAC-Tech</span><span>|</span><a href="#42592837">parent</a><span>|</span><a href="#42592865">prev</a><span>|</span><a href="#42593013">next</a><span>|</span><label class="collapse" for="c-42593389">[-]</label><label class="expand" for="c-42593389">[1 more]</label></div><br/><div class="children"><div class="content">The fact I even got into this is Joe Armstrong&#x27;s fault. I was listening to his talk about programming multicores and thought &quot;you know I&#x27;m on-board with the actor model across the network, but what&#x27;s the point of having multiple actors on one machine?&quot; Which lead me down the async rabbithole, which through io_uring ends up reminding me of actors!</div><br/></div></div></div></div><div id="42593013" class="c"><input type="checkbox" id="c-42593013" checked=""/><div class="controls bullet"><span class="by">01HNNWZ0MV43FF</span><span>|</span><a href="#42592837">prev</a><span>|</span><label class="collapse" for="c-42593013">[-]</label><label class="expand" for="c-42593013">[3 more]</label></div><br/><div class="children"><div class="content">Oh, file descriptors, yeah. Not files themselves, that would be weird.</div><br/><div id="42593109" class="c"><input type="checkbox" id="c-42593109" checked=""/><div class="controls bullet"><span class="by">louthy</span><span>|</span><a href="#42593013">parent</a><span>|</span><a href="#42593087">next</a><span>|</span><label class="collapse" for="c-42593109">[-]</label><label class="expand" for="c-42593109">[1 more]</label></div><br/><div class="children"><div class="content">The file itself would be the state of the actor. So it makes sense to me (if I were to implement a file-system with actors).</div><br/></div></div><div id="42593087" class="c"><input type="checkbox" id="c-42593087" checked=""/><div class="controls bullet"><span class="by">immibis</span><span>|</span><a href="#42593013">parent</a><span>|</span><a href="#42593109">prev</a><span>|</span><label class="collapse" for="c-42593087">[-]</label><label class="expand" for="c-42593087">[1 more]</label></div><br/><div class="children"><div class="content">Files and directories are actors in KeyKOS, which is one of those experiments someone did once that&#x27;s worth reading about for new ideas.</div><br/></div></div></div></div></div></div></div></div></div></body></html>