<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717923671388" as="style"/><link rel="stylesheet" href="styles.css?v=1717923671388"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://mas-bandwidth.com/creating-a-matchmaker-for-your-multiplayer-game/">Creating a matchmaker for your multiplayer game</a> <span class="domain">(<a href="https://mas-bandwidth.com">mas-bandwidth.com</a>)</span></div><div class="subtext"><span>gafferongames</span> | <span>25 comments</span></div><br/><div><div id="40621626" class="c"><input type="checkbox" id="c-40621626" checked=""/><div class="controls bullet"><span class="by">smarkov</span><span>|</span><a href="#40620672">next</a><span>|</span><label class="collapse" for="c-40621626">[-]</label><label class="expand" for="c-40621626">[2 more]</label></div><br/><div class="children"><div class="content">&gt; the matchmaker shuffles the queue to avoid the same players being matched together repeatedly<p>This is actually something I hate about multiplayer games with matchmaking nowadays. I made the majority of my childhood friends only because we stayed on the same server and played together for hours on end. I don&#x27;t think it&#x27;s a stretch to say that a key reason for why we play multiplayer rather than single player games is to socialize. This has become increasingly more difficult when you just get a new set of people every 10-30 minutes.</div><br/><div id="40621649" class="c"><input type="checkbox" id="c-40621649" checked=""/><div class="controls bullet"><span class="by">hlfshell</span><span>|</span><a href="#40621626">parent</a><span>|</span><a href="#40620672">next</a><span>|</span><label class="collapse" for="c-40621649">[-]</label><label class="expand" for="c-40621649">[1 more]</label></div><br/><div class="children"><div class="content">This is why smaller AA games still keep this alive - to build community. For instance: Squad, a 80-100 player multiplayer game which primarily depends upon privately hosted servers ran by communities that actually care about the community and game. You&#x27;ll still run into jerks like any online game, but it&#x27;s a world of difference to the one-match&#x2F;single-serving strangers you usually play with in other games.</div><br/></div></div></div></div><div id="40620672" class="c"><input type="checkbox" id="c-40620672" checked=""/><div class="controls bullet"><span class="by">nightowl_games</span><span>|</span><a href="#40621626">prev</a><span>|</span><a href="#40621052">next</a><span>|</span><label class="collapse" for="c-40620672">[-]</label><label class="expand" for="c-40620672">[10 more]</label></div><br/><div class="children"><div class="content">Glenn Fiedler is the best blogger on game networking. We used your stuff to guide our netcode development ~6 years ago. We now have a great stack on top of Godot for multiplayer games on the web over webrtc or websocket and enet on mobile and native.
We&#x27;re a small time company (3 people) and we have several multiplayer games..our netcode is a serious competitive advantage largely due to unity&#x27;s failure to provide a system to our competitors.<p>Thanks for helping us, Glenn.<p>Our matchmaker needs a rewrite, and these posts are nice.</div><br/><div id="40620722" class="c"><input type="checkbox" id="c-40620722" checked=""/><div class="controls bullet"><span class="by">gafferongames</span><span>|</span><a href="#40620672">parent</a><span>|</span><a href="#40621451">next</a><span>|</span><label class="collapse" for="c-40620722">[-]</label><label class="expand" for="c-40620722">[1 more]</label></div><br/><div class="children"><div class="content">&gt; We now have a great stack on top of Godot for multiplayer games on the web over webrtc or websocket and enet on mobile and native. We&#x27;re a small time company (3 people) and we have several multiplayer games..our netcode is a serious competitive advantage<p>That&#x27;s awesome! Well done</div><br/></div></div><div id="40620785" class="c"><input type="checkbox" id="c-40620785" checked=""/><div class="controls bullet"><span class="by">lostmsu</span><span>|</span><a href="#40620672">parent</a><span>|</span><a href="#40620766">prev</a><span>|</span><a href="#40620903">next</a><span>|</span><label class="collapse" for="c-40620785">[-]</label><label class="expand" for="c-40620785">[2 more]</label></div><br/><div class="children"><div class="content">What library do you use for WebRTC? The native libwebrtc?</div><br/><div id="40620814" class="c"><input type="checkbox" id="c-40620814" checked=""/><div class="controls bullet"><span class="by">Sean-Der</span><span>|</span><a href="#40620672">root</a><span>|</span><a href="#40620785">parent</a><span>|</span><a href="#40620903">next</a><span>|</span><label class="collapse" for="c-40620814">[-]</label><label class="expand" for="c-40620814">[1 more]</label></div><br/><div class="children"><div class="content">Godot uses libdatachannel. I remember them asking for mbedtls support</div><br/></div></div></div></div><div id="40620903" class="c"><input type="checkbox" id="c-40620903" checked=""/><div class="controls bullet"><span class="by">intelVISA</span><span>|</span><a href="#40620672">parent</a><span>|</span><a href="#40620785">prev</a><span>|</span><a href="#40621052">next</a><span>|</span><label class="collapse" for="c-40620903">[-]</label><label class="expand" for="c-40620903">[4 more]</label></div><br/><div class="children"><div class="content">&gt; our netcode is a serious competitive advantage<p>What do you sell that isn&#x27;t already solved by XDP?</div><br/><div id="40621145" class="c"><input type="checkbox" id="c-40621145" checked=""/><div class="controls bullet"><span class="by">nightowl_games</span><span>|</span><a href="#40620672">root</a><span>|</span><a href="#40620903">parent</a><span>|</span><a href="#40621052">next</a><span>|</span><label class="collapse" for="c-40621145">[-]</label><label class="expand" for="c-40621145">[3 more]</label></div><br/><div class="children"><div class="content">Googling XDP tells me it&#x27;s extreme diesel performance. I&#x27;m sure theyre engines are great but we make videogames.</div><br/><div id="40622258" class="c"><input type="checkbox" id="c-40622258" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#40620672">root</a><span>|</span><a href="#40621145">parent</a><span>|</span><a href="#40621052">next</a><span>|</span><label class="collapse" for="c-40622258">[-]</label><label class="expand" for="c-40622258">[2 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Express_Data_Path" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Express_Data_Path</a> is a feature of recent Linux kernels allowing you to bypass&#x2F;replace most of the normal Linux networking code, allowing for higher performance. Some network cards will even run your network code directly on their hardware.<p>(not sure what GP meant, just providing the reference)</div><br/><div id="40622424" class="c"><input type="checkbox" id="c-40622424" checked=""/><div class="controls bullet"><span class="by">zarzavat</span><span>|</span><a href="#40620672">root</a><span>|</span><a href="#40622258">parent</a><span>|</span><a href="#40621052">next</a><span>|</span><label class="collapse" for="c-40622424">[-]</label><label class="expand" for="c-40622424">[1 more]</label></div><br/><div class="children"><div class="content">I think they were confused by the term “netcode”, which in game developer parlance means “code which implements networked gameplay in a multiplayer game”, rather than “code that implements networking in an OS”.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40621052" class="c"><input type="checkbox" id="c-40621052" checked=""/><div class="controls bullet"><span class="by">Aachen</span><span>|</span><a href="#40620672">prev</a><span>|</span><a href="#40621441">next</a><span>|</span><label class="collapse" for="c-40621052">[-]</label><label class="expand" for="c-40621052">[4 more]</label></div><br/><div class="children"><div class="content">My understanding of the post:<p>1. Let the game client apply to servers in datacenters where they will get low latency if that&#x27;s relevant for your game<p>2. Wait 1 second on the server, then shuffle the list of clients and group every set of 4 into a match.<p>3. If no match is found after 10 seconds, add the client to servers in suboptimal datacenters<p>4. If still no match after another 10 seconds, put them in all the queues and join them to the first game it finds so they can at least play at all, even if they&#x27;ll have lag no matter where they go<p>5. Determine latency either using the same IP:port as the game server will have because the route might differ from another port (citation needed imo. The author links another blog post for further info which is mainly a statistics lecture about averages hiding outliers and doesn&#x27;t back up this claim that the port number makes a significant difference for latency in any but the most exceptional of situations where you&#x27;re sent eastward instead of westward around the globe or so) or by collecting statistics to find which server was best for a given location and ISP over the past 30 days (seems over-engineered with extra downsides, like that you will have gaps in the data and that it might have changed)<p>Did I miss anything? The whole thing seems somewhere between &quot;do the most naïve implication&quot; (1–4) and doubtful (5). It&#x27;s useful for devs to confirm the intuition they might have for the simplest implementation is correct but other comments saying this is a great blog surprise me when looking at these two posts<p>The hardest part about matchmaking seems to me finding players well-matched in skill without making them wait long, especially during off-peak hours, or having off-putting loss streaks because they (50% chance for each game) got matched against a slightly stronger or equal team and lost. The article doesn&#x27;t even mention these aspects exist, let alone offer advice on tackling them</div><br/><div id="40622232" class="c"><input type="checkbox" id="c-40622232" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#40621052">parent</a><span>|</span><a href="#40621102">next</a><span>|</span><label class="collapse" for="c-40622232">[-]</label><label class="expand" for="c-40622232">[1 more]</label></div><br/><div class="children"><div class="content">Players are coming in and out all the time, you can&#x27;t &quot;wait 1 second and shuffle the list&quot;. 1 second after what?</div><br/></div></div><div id="40621102" class="c"><input type="checkbox" id="c-40621102" checked=""/><div class="controls bullet"><span class="by">gafferongames</span><span>|</span><a href="#40621052">parent</a><span>|</span><a href="#40622232">prev</a><span>|</span><a href="#40621441">next</a><span>|</span><label class="collapse" for="c-40621102">[-]</label><label class="expand" for="c-40621102">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a shame that you missed the key point of the article in #5. Many games today have suboptimal inputs to their matchmaker, because like you, they refuse to believe that the internet can route a significant percentage of players incorrectly.<p>Source: Ran a network accelerator with more than 50 million unique players for 5 years. Bad network performance is much more pervasive than you think. <a href="https:&#x2F;&#x2F;networknext.com" rel="nofollow">https:&#x2F;&#x2F;networknext.com</a></div><br/><div id="40622268" class="c"><input type="checkbox" id="c-40622268" checked=""/><div class="controls bullet"><span class="by">remram</span><span>|</span><a href="#40621052">root</a><span>|</span><a href="#40621102">parent</a><span>|</span><a href="#40621441">next</a><span>|</span><label class="collapse" for="c-40622268">[-]</label><label class="expand" for="c-40622268">[1 more]</label></div><br/><div class="children"><div class="content">If it can route incorrectly, that seems like a strong signal not to rely on your maps. It doesn&#x27;t matter if you know what the correct latency is, if the users only experience the incorrect one.</div><br/></div></div></div></div></div></div><div id="40621441" class="c"><input type="checkbox" id="c-40621441" checked=""/><div class="controls bullet"><span class="by">bit_flipper</span><span>|</span><a href="#40621052">prev</a><span>|</span><a href="#40622585">next</a><span>|</span><label class="collapse" for="c-40621441">[-]</label><label class="expand" for="c-40621441">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve written game matchmaking before for games and found it far more challenging to do the portions related to matchmaking groups by skill. If you&#x27;re hyper latency sensitive then perhaps this blog post is really useful? But for the games I worked on we would trade 10ms worse average ping for 10% better skill pairings without question. If you have any advice on improving skill matchmaking I would be quite interested.</div><br/><div id="40621464" class="c"><input type="checkbox" id="c-40621464" checked=""/><div class="controls bullet"><span class="by">gafferongames</span><span>|</span><a href="#40621441">parent</a><span>|</span><a href="#40622585">next</a><span>|</span><label class="collapse" for="c-40621464">[-]</label><label class="expand" for="c-40621464">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If you have any advice on improving skill matchmaking I would be quite interested.<p>Samy Duc wrote a really good deep dive into Apex Legends matchmaking that covers skill and team balancing: <a href="https:&#x2F;&#x2F;www.ea.com&#x2F;games&#x2F;apex-legends&#x2F;news&#x2F;matchmaking-2023" rel="nofollow">https:&#x2F;&#x2F;www.ea.com&#x2F;games&#x2F;apex-legends&#x2F;news&#x2F;matchmaking-2023</a></div><br/><div id="40621651" class="c"><input type="checkbox" id="c-40621651" checked=""/><div class="controls bullet"><span class="by">bit_flipper</span><span>|</span><a href="#40621441">root</a><span>|</span><a href="#40621464">parent</a><span>|</span><a href="#40622585">next</a><span>|</span><label class="collapse" for="c-40621651">[-]</label><label class="expand" for="c-40621651">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the link, I hadn&#x27;t read this one yet. Very interesting. I feel like as an industry we&#x27;re still in the stone ages on how we do skill matching systems. A lot of the current and even future system they describe is really not great, and these flaws are definitely not unique to them (the systems I worked on are even more flawed)! Trying to matchmake dozens of players at a time is such a cool, challenging problem.</div><br/></div></div></div></div></div></div><div id="40622585" class="c"><input type="checkbox" id="c-40622585" checked=""/><div class="controls bullet"><span class="by">szundi</span><span>|</span><a href="#40621441">prev</a><span>|</span><a href="#40620998">next</a><span>|</span><label class="collapse" for="c-40622585">[-]</label><label class="expand" for="c-40622585">[1 more]</label></div><br/><div class="children"><div class="content">An option for not shuffling would be nice</div><br/></div></div><div id="40620998" class="c"><input type="checkbox" id="c-40620998" checked=""/><div class="controls bullet"><span class="by">tithe</span><span>|</span><a href="#40622585">prev</a><span>|</span><a href="#40621414">next</a><span>|</span><label class="collapse" for="c-40620998">[-]</label><label class="expand" for="c-40620998">[2 more]</label></div><br/><div class="children"><div class="content">Is matchmaking the process of players &quot;always [being] sent to the datacenters with the best chance of having low latency&quot;?<p>EDIT: No, it seems that it&#x27;s literally grouping players together in multiplayer games (but doing so in a way where latency between players is minimized.)</div><br/><div id="40621018" class="c"><input type="checkbox" id="c-40621018" checked=""/><div class="controls bullet"><span class="by">gafferongames</span><span>|</span><a href="#40620998">parent</a><span>|</span><a href="#40621414">next</a><span>|</span><label class="collapse" for="c-40621018">[-]</label><label class="expand" for="c-40621018">[1 more]</label></div><br/><div class="children"><div class="content">Yes, but much more too.<p>The example here is really simplified to focus mostly on the finding datacenters with low latency problem, but it could also include things like matching players of similar skill together, finding a set of players that would make balanced teams, making sure that players who are partied up together play in the same match and so on.<p>Basically, just like matchmaking in real life. It&#x27;s the thing that works out groups of players who should play together in a match.</div><br/></div></div></div></div><div id="40620919" class="c"><input type="checkbox" id="c-40620919" checked=""/><div class="controls bullet"><span class="by">roes9627</span><span>|</span><a href="#40621414">prev</a><span>|</span><label class="collapse" for="c-40620919">[-]</label><label class="expand" for="c-40620919">[1 more]</label></div><br/><div class="children"><div class="content">Great stuff!</div><br/></div></div></div></div></div></div></div></body></html>