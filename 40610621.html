<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717837263418" as="style"/><link rel="stylesheet" href="styles.css?v=1717837263418"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://undeadly.org/cgi?action=article;sid=20240607042157">OpenSSH introduces options to penalize undesirable behavior</a> <span class="domain">(<a href="https://undeadly.org">undeadly.org</a>)</span></div><div class="subtext"><span>zdw</span> | <span>227 comments</span></div><br/><div><div id="40611450" class="c"><input type="checkbox" id="c-40611450" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40610902">next</a><span>|</span><label class="collapse" for="c-40611450">[-]</label><label class="expand" for="c-40611450">[125 more]</label></div><br/><div class="children"><div class="content">Having written an SSH server that is used in a few larger places, I find the perspective of enabling these features on a per-address basis by default in the future troubling. First, with IPv4 this will have the potential to increasingly penalize innocent bystanders as CGNs are deployed. Worst case, this will give bad actors the option to lock the original owner out of their own server if they have a botnet host in the same network. With IPv6 on the other hand, it is trivially easy to get a new IP, so the protection method described here will be completely ineffective.<p>From my experiments with several honeypots over a longer period of time, most of these attacks are dumb dictionary attacks. Unless you are using default everything (user, port, password), these attacks don&#x27;t represent a significant threat and more targeted attacks won&#x27;t be caught by this. (Please use SSH keys.)<p>I have seen experienced sysadmins create the test user with the password of &quot;test&quot; on a live server on port 22 because they were having an &quot;autopilot moment&quot;. It got hacked within 20 minutes of going online and these mechanisms wouldn&#x27;t have saved it, the attacker got in on the second or third try.<p>If you want to have a read about unsolved problems around SSH that should be addressed, Tatu Ylonen (the inventor of SSH) has written a paper about it in 2019: <a href="https:&#x2F;&#x2F;helda.helsinki.fi&#x2F;server&#x2F;api&#x2F;core&#x2F;bitstreams&#x2F;471f0ffe-2626-4d12-8725-2147232d849f&#x2F;content" rel="nofollow">https:&#x2F;&#x2F;helda.helsinki.fi&#x2F;server&#x2F;api&#x2F;core&#x2F;bitstreams&#x2F;471f0ff...</a></div><br/><div id="40611960" class="c"><input type="checkbox" id="c-40611960" checked=""/><div class="controls bullet"><span class="by">crote</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40611960">[-]</label><label class="expand" for="c-40611960">[23 more]</label></div><br/><div class="children"><div class="content">&gt; With IPv6 on the other hand, it is trivially easy to get a new IP<p>OpenSSH already seems to take that into account by allowing you to penalize not just a single IP, but also an <i>entire subnet</i>. Enable that to penalize an entire &#x2F;64 for IPv6, and you&#x27;re in pretty much the same scenario as &quot;single IPv4 address&quot;.<p>I think there&#x27;s some limited value in it. It could be a neat alternative to allowlisting your own IP which doesn&#x27;t completely block you from accessing it from other locations. Block larger subnets at once if you don&#x27;t care about access from residential connections, and it would act as a <i>very</i> basic filter to make annoying attacks stop. Not providing any real security, but at least you&#x27;re not spending any CPU cycles on them.<p>On the other hand, I can definitely see CGNAT resulting in accidental or intentional lockouts for the real owner. Enabling it by default on all installations probably isn&#x27;t the best choice.</div><br/><div id="40612234" class="c"><input type="checkbox" id="c-40612234" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611960">parent</a><span>|</span><a href="#40612086">next</a><span>|</span><label class="collapse" for="c-40612234">[-]</label><label class="expand" for="c-40612234">[1 more]</label></div><br/><div class="children"><div class="content">IPv6 has the potential to be even worse. You could be knocking an entire provider offline. At any rate, this behavior should not become default.</div><br/></div></div><div id="40612086" class="c"><input type="checkbox" id="c-40612086" checked=""/><div class="controls bullet"><span class="by">aftbit</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611960">parent</a><span>|</span><a href="#40612234">prev</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612086">[-]</label><label class="expand" for="c-40612086">[21 more]</label></div><br/><div class="children"><div class="content">FYI it&#x27;s pretty common to get a &#x2F;48 or a &#x2F;56 from a data center, or &#x2F;60 from Comcast.</div><br/><div id="40616281" class="c"><input type="checkbox" id="c-40616281" checked=""/><div class="controls bullet"><span class="by">dheera</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612086">parent</a><span>|</span><a href="#40612192">next</a><span>|</span><label class="collapse" for="c-40616281">[-]</label><label class="expand" for="c-40616281">[1 more]</label></div><br/><div class="children"><div class="content">I can never remember whether &#x2F;x means &quot;the last x bits are 0&quot; or &quot;the first x bits are 1&quot;</div><br/></div></div><div id="40612192" class="c"><input type="checkbox" id="c-40612192" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612086">parent</a><span>|</span><a href="#40616281">prev</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612192">[-]</label><label class="expand" for="c-40612192">[19 more]</label></div><br/><div class="children"><div class="content">Maybe the only equivalent is to penalize a &#x2F;32, since there are roughly as many of those as there are ipv4 addresses.</div><br/><div id="40612425" class="c"><input type="checkbox" id="c-40612425" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612192">parent</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612425">[-]</label><label class="expand" for="c-40612425">[18 more]</label></div><br/><div class="children"><div class="content">That may be true mathematically, but there are no guarantees that a small provider won&#x27;t end up having only a single &#x2F;64, which would likely be the default unit of range-based blocking. Yes, it &quot;shouldn&#x27;t&quot; happen.</div><br/><div id="40612650" class="c"><input type="checkbox" id="c-40612650" checked=""/><div class="controls bullet"><span class="by">dfox</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612425">parent</a><span>|</span><a href="#40612687">next</a><span>|</span><label class="collapse" for="c-40612650">[-]</label><label class="expand" for="c-40612650">[5 more]</label></div><br/><div class="children"><div class="content">You cannot reasonably build an ISP network with single &#x2F;64. RIPE assigns &#x2F;32s to LIRs and LIRs are supposed to assign &#x2F;48s downstream (which is somewhat wasteful for most of kinds of mass-market customers, so you get things like &#x2F;56s and &#x2F;60s).</div><br/><div id="40612750" class="c"><input type="checkbox" id="c-40612750" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612650">parent</a><span>|</span><a href="#40612703">next</a><span>|</span><label class="collapse" for="c-40612750">[-]</label><label class="expand" for="c-40612750">[1 more]</label></div><br/><div class="children"><div class="content">As I said, &quot;should&quot;. In some places there will be enough people in the chain that won&#x27;t be bothered to go to the LIR directly. Think small rural ISPs in small countries.</div><br/></div></div><div id="40612703" class="c"><input type="checkbox" id="c-40612703" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612650">parent</a><span>|</span><a href="#40612750">prev</a><span>|</span><a href="#40612687">next</a><span>|</span><label class="collapse" for="c-40612703">[-]</label><label class="expand" for="c-40612703">[3 more]</label></div><br/><div class="children"><div class="content">What if it uses NAT v6 :D</div><br/><div id="40614306" class="c"><input type="checkbox" id="c-40614306" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612703">parent</a><span>|</span><a href="#40612687">next</a><span>|</span><label class="collapse" for="c-40614306">[-]</label><label class="expand" for="c-40614306">[2 more]</label></div><br/><div class="children"><div class="content">i cannot tell if facetious or business genius.</div><br/><div id="40614462" class="c"><input type="checkbox" id="c-40614462" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614306">parent</a><span>|</span><a href="#40612687">next</a><span>|</span><label class="collapse" for="c-40614462">[-]</label><label class="expand" for="c-40614462">[1 more]</label></div><br/><div class="children"><div class="content">Well seriously, I remember AT&amp;T cellular giving me an ipv6 behind a cgnat (and also an ipv4). Don&#x27;t quote me on that though.</div><br/></div></div></div></div></div></div></div></div><div id="40614188" class="c"><input type="checkbox" id="c-40614188" checked=""/><div class="controls bullet"><span class="by">Sanzig</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612425">parent</a><span>|</span><a href="#40612687">prev</a><span>|</span><a href="#40612441">next</a><span>|</span><label class="collapse" for="c-40614188">[-]</label><label class="expand" for="c-40614188">[2 more]</label></div><br/><div class="children"><div class="content">Well, allocating anything smaller than a &#x2F;64 to a customer breaks SLAAC, so even a really small provider wouldn&#x27;t do that as it would completely bork their customers&#x27; networks. Yes, DHCPv6 technically exists as an alternative to SLAAC, but some operating systems (most notably Android) don&#x27;t support it it all.</div><br/><div id="40615513" class="c"><input type="checkbox" id="c-40615513" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614188">parent</a><span>|</span><a href="#40612441">next</a><span>|</span><label class="collapse" for="c-40615513">[-]</label><label class="expand" for="c-40615513">[1 more]</label></div><br/><div class="children"><div class="content">There are plenty of ISPs that assign &#x2F;64s and even smaller subnet to their customers. There are even ISPs that assign a single &#x2F;128, IPv4 style.</div><br/></div></div></div></div><div id="40612441" class="c"><input type="checkbox" id="c-40612441" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612425">parent</a><span>|</span><a href="#40614188">prev</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612441">[-]</label><label class="expand" for="c-40612441">[9 more]</label></div><br/><div class="children"><div class="content">Right. It&#x27;s analogous to how blocking an ipv4 is unfair to smaller providers using cgnat. But if someone wants to connect to your server, you might want them to have skin in the game.</div><br/><div id="40612559" class="c"><input type="checkbox" id="c-40612559" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612441">parent</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612559">[-]</label><label class="expand" for="c-40612559">[8 more]</label></div><br/><div class="children"><div class="content">The provider doesn&#x27;t care, the owner of the server who needs to log in from their home internet at 2AM in an emergency cares. Bad actors have access to botnets, the server admin doesn&#x27;t.</div><br/><div id="40612574" class="c"><input type="checkbox" id="c-40612574" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612559">parent</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40612574">[-]</label><label class="expand" for="c-40612574">[7 more]</label></div><br/><div class="children"><div class="content">Unfortunately the only answer is &quot;pay to play.&quot; If you&#x27;re a server admin needing emergency access, you or your employer should pay for an ISP that isn&#x27;t using cgnat (and has reliable connectivity). Same as how you probably have a real phone sim instead of a cheap voip number that&#x27;s banned in tons of places.<p>Or better yet, a corp VPN with good security practices so you don&#x27;t need this fail2ban-type setup. It&#x27;s also weird to connect from home using password-based SSH in the first place.</div><br/><div id="40614204" class="c"><input type="checkbox" id="c-40614204" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612574">parent</a><span>|</span><a href="#40615312">next</a><span>|</span><label class="collapse" for="c-40614204">[-]</label><label class="expand" for="c-40614204">[5 more]</label></div><br/><div class="children"><div class="content">The better answer is to just ignore dull password guessing attempts which will never get in because you&#x27;re using strong passwords or public key authentication (right?).<p>Sometimes it&#x27;s not a matter of price. If you&#x27;re traveling your only option for a network connection could be whatever dreck the hotel deigns to provide.</div><br/><div id="40614311" class="c"><input type="checkbox" id="c-40614311" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614204">parent</a><span>|</span><a href="#40615312">next</a><span>|</span><label class="collapse" for="c-40614311">[-]</label><label class="expand" for="c-40614311">[4 more]</label></div><br/><div class="children"><div class="content">Even with strong passwords, maybe you don&#x27;t want someone attempting to authenticate so quickly. Could be DoS or trying to exploit sshd. If you&#x27;re traveling, cellular and VPN are both options. VPN could have a similar auth dilemma, but there&#x27;s defense in depth.<p>Also it&#x27;s unlikely that your hotel&#x27;s IP address is spamming the particular SSH server you need to connect to.</div><br/><div id="40614341" class="c"><input type="checkbox" id="c-40614341" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614311">parent</a><span>|</span><a href="#40615312">next</a><span>|</span><label class="collapse" for="c-40614341">[-]</label><label class="expand" for="c-40614341">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Even with strong passwords, maybe you don&#x27;t want someone attempting to authenticate so quickly. Could be DoS or trying to exploit sshd.<p>DoS in this context is generally pretty boring. Your CPU would end up at 100% and the service would be slower to respond but still would. Also, responding to a DoS attempt by blocking access is a DoS vector for anyone who can share or spoof your IP address, so that seems like a bad idea.<p>If someone is trying to exploit sshd, they&#x27;ll typically do it on the first attempt and this does nothing.<p>&gt; Also it&#x27;s unlikely that your hotel&#x27;s IP address is spamming the particular SSH server you need to connect to.<p>It is when the hotel is using the cheapest available ISP with CGNAT.</div><br/><div id="40614428" class="c"><input type="checkbox" id="c-40614428" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614341">parent</a><span>|</span><a href="#40615312">next</a><span>|</span><label class="collapse" for="c-40614428">[-]</label><label class="expand" for="c-40614428">[2 more]</label></div><br/><div class="children"><div class="content">Good point on the DoS. Exploit on first attempt, maybe, I wouldn&#x27;t count on that. Can&#x27;t say how likely a timing exploit is.<p>If the hotel is using such a dirty shared IP that it&#x27;s also being used to spam random SSH servers, that connection is probably impractical for several other reasons, e.g. flagged on Cloudflare. At that point I&#x27;d go straight to a VPN or hotspot.</div><br/><div id="40614933" class="c"><input type="checkbox" id="c-40614933" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614428">parent</a><span>|</span><a href="#40615312">next</a><span>|</span><label class="collapse" for="c-40614933">[-]</label><label class="expand" for="c-40614933">[1 more]</label></div><br/><div class="children"><div class="content">Novel timing attacks like that are pretty unlikely, basically someone with a 0-day, because otherwise they quickly get patched. If the adversary is someone with access to 0-day vulnerabilities, you&#x27;re pretty screwed in general and it isn&#x27;t worth a lot of inconvenience to try to prevent something inevitable.<p>And there is no guarantee you <i>can</i> use another network connection. Hotspots only work if there&#x27;s coverage.<p>Plus, &quot;just use a hotspot or a VPN&quot; assumes you were expecting the problem. This change is going to catch a lot of people out because the first time they realize it exists is during the emergency when they try to remote in.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40615312" class="c"><input type="checkbox" id="c-40615312" checked=""/><div class="controls bullet"><span class="by">thayne</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612574">parent</a><span>|</span><a href="#40614204">prev</a><span>|</span><a href="#40616023">next</a><span>|</span><label class="collapse" for="c-40615312">[-]</label><label class="expand" for="c-40615312">[1 more]</label></div><br/><div class="children"><div class="content">&gt; you or your employer should pay for an ISP that isn&#x27;t using cgna<p>That may not be an option at all, especially with working from home or while traveling.<p>For example at my home all ISPs i have available use cgnat.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="40616023" class="c"><input type="checkbox" id="c-40616023" checked=""/><div class="controls bullet"><span class="by">solatic</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40611960">prev</a><span>|</span><a href="#40615963">next</a><span>|</span><label class="collapse" for="c-40616023">[-]</label><label class="expand" for="c-40616023">[2 more]</label></div><br/><div class="children"><div class="content">Serious question: why doesn&#x27;t OpenSSH declare, with about a year&#x27;s notice ahead of time, the intent to cut a new major release that drops support for password-based authentication?</div><br/><div id="40616065" class="c"><input type="checkbox" id="c-40616065" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40616023">parent</a><span>|</span><a href="#40615963">next</a><span>|</span><label class="collapse" for="c-40616065">[-]</label><label class="expand" for="c-40616065">[1 more]</label></div><br/><div class="children"><div class="content">There are very legit reasons to use passwords, for example in conjunction with a second factor. Authentication methods can also be chained.</div><br/></div></div></div></div><div id="40615963" class="c"><input type="checkbox" id="c-40615963" checked=""/><div class="controls bullet"><span class="by">Too</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40616023">prev</a><span>|</span><a href="#40614717">next</a><span>|</span><label class="collapse" for="c-40615963">[-]</label><label class="expand" for="c-40615963">[2 more]</label></div><br/><div class="children"><div class="content">Interesting paper from Tatu Ylonen. He seem to be quick on throwing out the idea of certificates only because there is no hardened CA available today? Wouldn’t it be better to solve that problem, rather than going in circles and making up new novel ways of using keys? Call it what you want, reduced to their bare essentials, in the end you either have delegated trust through a CA or a key administration problem. Whichever path you choose, it must be backed by a robust and widely adopted implementation to be successful.</div><br/><div id="40616035" class="c"><input type="checkbox" id="c-40616035" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40615963">parent</a><span>|</span><a href="#40614717">next</a><span>|</span><label class="collapse" for="c-40616035">[-]</label><label class="expand" for="c-40616035">[1 more]</label></div><br/><div class="children"><div class="content">As far as OpenSSH is concerned, I believe the main problem is that there is no centralized revocation functionality. You have to distribute your revocation lists via an external mechanism and ensure that all your servers are up to date. There is no built-in mechanism like OCSP, or better yet, OCSP stapling in SSH. You could use Kerberos, but it&#x27;s a royal pain to set up and OpenSSH is pretty much the defacto standard when it comes to SSH servers.</div><br/></div></div></div></div><div id="40614717" class="c"><input type="checkbox" id="c-40614717" checked=""/><div class="controls bullet"><span class="by">skissane</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40615963">prev</a><span>|</span><a href="#40611571">next</a><span>|</span><label class="collapse" for="c-40614717">[-]</label><label class="expand" for="c-40614717">[4 more]</label></div><br/><div class="children"><div class="content">&gt; I have seen experienced sysadmins create the test user with the password of &quot;test&quot; on a live server on port 22 because they were having an &quot;autopilot moment&quot;. It got hacked within 20 minutes of going online and these mechanisms wouldn&#x27;t have saved it, the attacker got in on the second or third try.<p>Is it possible to create some kind of reverse proxy for SSH which blocks password-based authentication, and furthermore only allows authentication by a known list of public keys?<p>The idea would be SSH to the reverse proxy, if you authenticate with an authorised public key (or certificate or whatever) it forwards your connection to the backend SSH server; all attempts to authenticate with a password are automatically rejected and never reach the backend.<p>In some ways what I&#x27;m describing here is a &quot;bastion&quot; or &quot;jumphost&quot;, but in implementations of that idea I&#x27;ve seen, you SSH to the bastion&#x2F;jumphost, get a shell, and then SSH again to the backend SSH – whereas I am talking about a proxy which automatically connects to the backend SSH using the same credentials once you have authenticated to it.<p>Furthermore, using a generic Linux box as a bastion&#x2F;jumphost, you run the same risk that someone might create a weak password account–you can disable password authentication in the sshd config but what if someone turns it on? With this &quot;intercepting proxy&quot; idea, the proxy wouldn&#x27;t even have any code to support password authentication, so you couldn&#x27;t ever turn it on.</div><br/><div id="40615889" class="c"><input type="checkbox" id="c-40615889" checked=""/><div class="controls bullet"><span class="by">Too</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614717">parent</a><span>|</span><a href="#40615144">next</a><span>|</span><label class="collapse" for="c-40615889">[-]</label><label class="expand" for="c-40615889">[1 more]</label></div><br/><div class="children"><div class="content">Check out the ProxyJump and ProxyCommand option in ssh config. They let you skip the intermediate shell.</div><br/></div></div><div id="40615144" class="c"><input type="checkbox" id="c-40615144" checked=""/><div class="controls bullet"><span class="by">lcampbell</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614717">parent</a><span>|</span><a href="#40615889">prev</a><span>|</span><a href="#40611571">next</a><span>|</span><label class="collapse" for="c-40615144">[-]</label><label class="expand" for="c-40615144">[2 more]</label></div><br/><div class="children"><div class="content">&gt; what if someone turns [password authentication back] on<p>sshd_config requires root to modify, so you&#x27;ve got bigger problems than weak passwords at this point.</div><br/><div id="40615254" class="c"><input type="checkbox" id="c-40615254" checked=""/><div class="controls bullet"><span class="by">skissane</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40615144">parent</a><span>|</span><a href="#40611571">next</a><span>|</span><label class="collapse" for="c-40615254">[-]</label><label class="expand" for="c-40615254">[1 more]</label></div><br/><div class="children"><div class="content">It is a lot more likely for some random admin to inappropriately change a single boolean config setting as root, than for them to replace an entire software package which (by design) doesn&#x27;t have code for a certain feature with one that does.</div><br/></div></div></div></div></div></div><div id="40611571" class="c"><input type="checkbox" id="c-40611571" checked=""/><div class="controls bullet"><span class="by">overstay8930</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40614717">prev</a><span>|</span><a href="#40612569">next</a><span>|</span><label class="collapse" for="c-40611571">[-]</label><label class="expand" for="c-40611571">[3 more]</label></div><br/><div class="children"><div class="content">&gt; With IPv6 on the other hand, it is trivially easy to get a new IP, so the protection method described here will be completely ineffective.<p>I’m sure this will be fixed by just telling everyone to disable IPv6, par for the course.</div><br/><div id="40612049" class="c"><input type="checkbox" id="c-40612049" checked=""/><div class="controls bullet"><span class="by">dmm</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611571">parent</a><span>|</span><a href="#40612958">next</a><span>|</span><label class="collapse" for="c-40612049">[-]</label><label class="expand" for="c-40612049">[1 more]</label></div><br/><div class="children"><div class="content">The alternative to ipv6 is ipv4 over cgnat, which arguable has the same problem.</div><br/></div></div></div></div><div id="40612569" class="c"><input type="checkbox" id="c-40612569" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40611571">prev</a><span>|</span><a href="#40611547">next</a><span>|</span><label class="collapse" for="c-40612569">[-]</label><label class="expand" for="c-40612569">[10 more]</label></div><br/><div class="children"><div class="content">Wait, how often do you connect to a ssh remote that isn&#x27;t controlled by you or say, your workplace? Genuinely asking, I have not seen a use case for something like that in recent years so I&#x27;m curious!</div><br/><div id="40613882" class="c"><input type="checkbox" id="c-40613882" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612569">parent</a><span>|</span><a href="#40612849">next</a><span>|</span><label class="collapse" for="c-40613882">[-]</label><label class="expand" for="c-40613882">[4 more]</label></div><br/><div class="children"><div class="content">GitHub is an example of a service that would want to disable this option. They get lots of legit ssh connections from all over the world including people who may be behind large NATs.</div><br/><div id="40614038" class="c"><input type="checkbox" id="c-40614038" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613882">parent</a><span>|</span><a href="#40612849">next</a><span>|</span><label class="collapse" for="c-40614038">[-]</label><label class="expand" for="c-40614038">[3 more]</label></div><br/><div class="children"><div class="content">I somehow didn&#x27;t think about that, even if I used that feature just a few hours ago! Now I&#x27;m curious about how GitHub handles the ssh infra at that scale...</div><br/><div id="40615521" class="c"><input type="checkbox" id="c-40615521" checked=""/><div class="controls bullet"><span class="by">jkrejcha</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614038">parent</a><span>|</span><a href="#40614827">next</a><span>|</span><label class="collapse" for="c-40615521">[-]</label><label class="expand" for="c-40615521">[1 more]</label></div><br/><div class="children"><div class="content">GitHub, as I&#x27;ve read[1], uses a different implementation of SSH which is tailored for their use case.<p>The benefits is that it is probably much lighter weight than OpenSSH (which supports a lot of different things just because it is so general[2]) and can more easily integrate with their services, while also providing the benefit of not having to spin up a shell and deal with the potential security risks that contains.<p>And even if somehow a major flaw is found in OpenSSH, GitHub (at least their public servers) wouldn&#x27;t be affected in this case since there&#x27;s no shell to escape to.<p>[1]: I read it on HN somewhere that I don&#x27;t remember now, however you can kinda confirm this yourself if you open up a raw TCP connection to github.com, where the connection string says<p>SSH-2.0-babeld-9102804c<p>According to an HN user[2], they were using libssh in 2015.<p>[2]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39978089">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39978089</a><p>[3]: This isn&#x27;t a value judgement on OpenSSH, I think it is downright amazing. However, GitHub has a much more narrow and specific use case, especially for an intentionally public SSH server.</div><br/></div></div><div id="40614827" class="c"><input type="checkbox" id="c-40614827" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614038">parent</a><span>|</span><a href="#40615521">prev</a><span>|</span><a href="#40612849">next</a><span>|</span><label class="collapse" for="c-40614827">[-]</label><label class="expand" for="c-40614827">[1 more]</label></div><br/><div class="children"><div class="content">Even the amount of SSH authorized_keys they would need to process is a little mind boggling, they probably have some super custom stuff.</div><br/></div></div></div></div></div></div><div id="40612849" class="c"><input type="checkbox" id="c-40612849" checked=""/><div class="controls bullet"><span class="by">omoikane</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612569">parent</a><span>|</span><a href="#40613882">prev</a><span>|</span><a href="#40614386">next</a><span>|</span><label class="collapse" for="c-40612849">[-]</label><label class="expand" for="c-40612849">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps at a university where all students in the same class need to SSH to the same place, possibly from the same set of lab machines.  A poorly configured sshd could allow some students to DoS other students.<p>This might be similar to the workplace scenario that you have in mind, but some students are more bold in trying dodgy things with their class accounts, because they know they probably won&#x27;t get in big trouble at an university.</div><br/></div></div><div id="40614386" class="c"><input type="checkbox" id="c-40614386" checked=""/><div class="controls bullet"><span class="by">nerdbert</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612569">parent</a><span>|</span><a href="#40612849">prev</a><span>|</span><a href="#40612595">next</a><span>|</span><label class="collapse" for="c-40614386">[-]</label><label class="expand" for="c-40614386">[1 more]</label></div><br/><div class="children"><div class="content">One of my clients has a setup for their clients - some of which connect from arbitrary locations, and others of which need to be able to scripted automated uploads - to connect via sftp to upload files.<p>Nobody is ever getting in, because they require ed25519 keys, but it is pounded nonstop all day long with brute force attempts. It wastes log space and IDS resources.<p>This is a case that could benefit from something like the new OpenSSH feature (which seems less hinky than fail2ban).<p>Another common case would be university students, so long as it&#x27;s not applied to campus and local ISP IPs.</div><br/></div></div><div id="40612807" class="c"><input type="checkbox" id="c-40612807" checked=""/><div class="controls bullet"><span class="by">palata</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612569">parent</a><span>|</span><a href="#40612595">prev</a><span>|</span><a href="#40613537">next</a><span>|</span><label class="collapse" for="c-40612807">[-]</label><label class="expand" for="c-40612807">[1 more]</label></div><br/><div class="children"><div class="content">I sometimes use this: <a href="https:&#x2F;&#x2F;pico.sh&#x2F;" rel="nofollow">https:&#x2F;&#x2F;pico.sh&#x2F;</a></div><br/></div></div><div id="40613537" class="c"><input type="checkbox" id="c-40613537" checked=""/><div class="controls bullet"><span class="by">heavyset_go</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612569">parent</a><span>|</span><a href="#40612807">prev</a><span>|</span><a href="#40611547">next</a><span>|</span><label class="collapse" for="c-40613537">[-]</label><label class="expand" for="c-40613537">[1 more]</label></div><br/><div class="children"><div class="content">Git over SSH</div><br/></div></div></div></div><div id="40611547" class="c"><input type="checkbox" id="c-40611547" checked=""/><div class="controls bullet"><span class="by">Latty</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612569">prev</a><span>|</span><a href="#40611548">next</a><span>|</span><label class="collapse" for="c-40611547">[-]</label><label class="expand" for="c-40611547">[12 more]</label></div><br/><div class="children"><div class="content">And even with IPv4, botnets are a common attack source, so hitting from many endpoints isn&#x27;t <i>that</i> hard.<p>I&#x27;d say &quot;well, it might catch the lowest effort attacks&quot;, but when SSH keys exist and solve many more problems in a much better way, it really does feel pointless.<p>Maybe in an era where USB keys weren&#x27;t so trivial, I&#x27;d buy the argument of &quot;what if I need to access from another machine&quot;, but if you really worry about that, put your (password protected) keys on a USB stick and shove it in your wallet or on your keyring or whatever. (Are there security concerns there? Of course, but no more than typing your password in on some random machine.)</div><br/><div id="40611599" class="c"><input type="checkbox" id="c-40611599" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611547">parent</a><span>|</span><a href="#40611548">next</a><span>|</span><label class="collapse" for="c-40611599">[-]</label><label class="expand" for="c-40611599">[11 more]</label></div><br/><div class="children"><div class="content">You can use SSH certificate authorities (not x509) with OpenSSH to authorize a new key without needing to deploy a new key on the server. Also, Yubikeys are useful for this.</div><br/><div id="40611753" class="c"><input type="checkbox" id="c-40611753" checked=""/><div class="controls bullet"><span class="by">tonyarkles</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611599">parent</a><span>|</span><a href="#40612044">next</a><span>|</span><label class="collapse" for="c-40611753">[-]</label><label class="expand" for="c-40611753">[9 more]</label></div><br/><div class="children"><div class="content">Just a warning for people who are planning on doing this: it works amazingly well but if you&#x27;re using it in a shared environment where you may end up wanting to revoke a key (e.g. terminating an employee) the key revocation problem can be a hassle. In one environment I worked in we solved it by issuing short-term pseudo-ephemeral keys (e.g. someone could get a prod key for an hour) and side-stepped the problem.<p>The problem is that you can issue keys without having to deploy them to a fleet of servers (you sign the user&#x27;s pubkey using your SSH CA key), but you have no way of revoking them without pushing an updated revocation list to the whole fleet. We did have a few long-term keys that were issued, generally for build machines and dev environments, and had a procedure in place to push CRLs if necessary, but luckily we didn&#x27;t ever end up in a situation where we had to use it.</div><br/><div id="40615908" class="c"><input type="checkbox" id="c-40615908" checked=""/><div class="controls bullet"><span class="by">Too</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611753">parent</a><span>|</span><a href="#40612032">next</a><span>|</span><label class="collapse" for="c-40615908">[-]</label><label class="expand" for="c-40615908">[1 more]</label></div><br/><div class="children"><div class="content">With normal keys you have a similar issue of removing the key from all servers. If you can do this, you can also deploy a revocation list.</div><br/></div></div><div id="40612032" class="c"><input type="checkbox" id="c-40612032" checked=""/><div class="controls bullet"><span class="by">tiberious726</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611753">parent</a><span>|</span><a href="#40615908">prev</a><span>|</span><a href="#40613146">next</a><span>|</span><label class="collapse" for="c-40612032">[-]</label><label class="expand" for="c-40612032">[5 more]</label></div><br/><div class="children"><div class="content">Setting up regular publishing of CRLs is just part of setting up a CA. Is there some extra complexity with ssh here, or are you (rightfully) just complaining about what a mess CRLs are?<p>Fun fact: it was just a few months ago that Heimdall Kerberos started respecting CRLs at all, that was a crazy bug to discover</div><br/><div id="40612359" class="c"><input type="checkbox" id="c-40612359" checked=""/><div class="controls bullet"><span class="by">semi</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612032">parent</a><span>|</span><a href="#40612396">next</a><span>|</span><label class="collapse" for="c-40612359">[-]</label><label class="expand" for="c-40612359">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s extra complexity with ssh, it has its own file of revoked keys in RevokedKeys and you&#x27;ll have to update that everywhere.<p>see <a href="https:&#x2F;&#x2F;man.openbsd.org&#x2F;ssh-keygen.1#KEY_REVOCATION_LISTS" rel="nofollow">https:&#x2F;&#x2F;man.openbsd.org&#x2F;ssh-keygen.1#KEY_REVOCATION_LISTS</a> for more info<p>And unlike some other sshd directives that have a &#x27;Command&#x27; alternative to specify a command to run instead of reading a file, this one doesn&#x27;t, so you can&#x27;t just DIY distribution by having it curl a shared revocation list.</div><br/></div></div><div id="40612396" class="c"><input type="checkbox" id="c-40612396" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612032">parent</a><span>|</span><a href="#40612359">prev</a><span>|</span><a href="#40613146">next</a><span>|</span><label class="collapse" for="c-40612396">[-]</label><label class="expand" for="c-40612396">[3 more]</label></div><br/><div class="children"><div class="content">The hard part is making sure every one of your servers got the CRL update. Since last I checked OpenSSH doesn&#x27;t have a mechanism to remotely check CRLs (like OCSP), nor does SSH have anything akin to OCSP stapling, it&#x27;s a little bit of a footgun waiting to happen.</div><br/><div id="40613554" class="c"><input type="checkbox" id="c-40613554" checked=""/><div class="controls bullet"><span class="by">tiberious726</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612396">parent</a><span>|</span><a href="#40613146">next</a><span>|</span><label class="collapse" for="c-40613554">[-]</label><label class="expand" for="c-40613554">[2 more]</label></div><br/><div class="children"><div class="content">Oh wow... That&#x27;s pretty nuts. I guess the reason is to make it harder for people to lock themselves out of all their servers if OSCP or whatever is being used to distribute the CRL is down.</div><br/><div id="40615485" class="c"><input type="checkbox" id="c-40615485" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613554">parent</a><span>|</span><a href="#40613146">next</a><span>|</span><label class="collapse" for="c-40615485">[-]</label><label class="expand" for="c-40615485">[1 more]</label></div><br/><div class="children"><div class="content">Not necessarily. There is a fork of OpenSSH that supports x509, but I remember reading somewhere that it&#x27;s too complex and that&#x27;s why it doesn&#x27;t make it into mainline.</div><br/></div></div></div></div></div></div></div></div><div id="40613146" class="c"><input type="checkbox" id="c-40613146" checked=""/><div class="controls bullet"><span class="by">EthanHeilman</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611753">parent</a><span>|</span><a href="#40612032">prev</a><span>|</span><a href="#40612044">next</a><span>|</span><label class="collapse" for="c-40613146">[-]</label><label class="expand" for="c-40613146">[2 more]</label></div><br/><div class="children"><div class="content">You might want to check out my project OpenPubkey[0] with uses OIDC ID Tokens inside SSH certs. For instance this let&#x27;s you SSH with your gmail account. The ID token in SSH certificate expires after a few hours which makes the SSH certificate expire. You can also do something similar with SSH3 [1].<p>[0] OpenPubkey - <a href="https:&#x2F;&#x2F;github.com&#x2F;openpubkey&#x2F;openpubkey&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;openpubkey&#x2F;openpubkey&#x2F;</a><p>[1] SSH3 - <a href="https:&#x2F;&#x2F;github.com&#x2F;francoismichel&#x2F;ssh3">https:&#x2F;&#x2F;github.com&#x2F;francoismichel&#x2F;ssh3</a></div><br/><div id="40615327" class="c"><input type="checkbox" id="c-40615327" checked=""/><div class="controls bullet"><span class="by">lmz</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613146">parent</a><span>|</span><a href="#40612044">next</a><span>|</span><label class="collapse" for="c-40615327">[-]</label><label class="expand" for="c-40615327">[1 more]</label></div><br/><div class="children"><div class="content">Why not just make the certificate short-lived instead of having a certificate with shorter-lived claims inside?</div><br/></div></div></div></div></div></div><div id="40612044" class="c"><input type="checkbox" id="c-40612044" checked=""/><div class="controls bullet"><span class="by">tiberious726</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611599">parent</a><span>|</span><a href="#40611753">prev</a><span>|</span><a href="#40611548">next</a><span>|</span><label class="collapse" for="c-40612044">[-]</label><label class="expand" for="c-40612044">[1 more]</label></div><br/><div class="children"><div class="content">Moneysphere lets you do this with tsigs on gpg keys. I find the web of trust marginally less painful than X509</div><br/></div></div></div></div></div></div><div id="40611548" class="c"><input type="checkbox" id="c-40611548" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40611547">prev</a><span>|</span><a href="#40612839">next</a><span>|</span><label class="collapse" for="c-40611548">[-]</label><label class="expand" for="c-40611548">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I have seen experienced sysadmins create the test user with the password of &quot;test&quot; on a live server on port 22 because they were having an &quot;autopilot moment&quot;.<p>pam_pwnd[1], testing passwords against the Pwned Passwords database, is a(n unfortunately abandoned but credibly feature complete) thing. (It uses the HTTP service, though, not a local dump.)<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;skx&#x2F;pam_pwnd">https:&#x2F;&#x2F;github.com&#x2F;skx&#x2F;pam_pwnd</a></div><br/><div id="40614336" class="c"><input type="checkbox" id="c-40614336" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611548">parent</a><span>|</span><a href="#40612839">next</a><span>|</span><label class="collapse" for="c-40614336">[-]</label><label class="expand" for="c-40614336">[1 more]</label></div><br/><div class="children"><div class="content">meh. enabling any of the (fully local) complexity rules pretty much had the same practical effect of checking against a leak.<p>if the password have decent entropy, it won&#x27;t be in the top 1000 of the leaks so not used in blond brute force like this.</div><br/></div></div></div></div><div id="40612839" class="c"><input type="checkbox" id="c-40612839" checked=""/><div class="controls bullet"><span class="by">chuckadams</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40611548">prev</a><span>|</span><a href="#40611768">next</a><span>|</span><label class="collapse" for="c-40612839">[-]</label><label class="expand" for="c-40612839">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;d love to penalize any attempt at password auth.  Not the IP addresses, just if you&#x27;re dumb enough to try sending a password to my ssh server, you&#x27;re going to wait a good long time for the failure response.<p>Actually I might even want to let them into a &quot;shell&quot; that <i>really</i> screws with them, but that&#x27;s far outside of ssh&#x27;s scope.</div><br/><div id="40614004" class="c"><input type="checkbox" id="c-40614004" checked=""/><div class="controls bullet"><span class="by">mike_hock</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612839">parent</a><span>|</span><a href="#40611768">next</a><span>|</span><label class="collapse" for="c-40614004">[-]</label><label class="expand" for="c-40614004">[2 more]</label></div><br/><div class="children"><div class="content">I certainly don&#x27;t want to expose any more surface area than necessary to potential exploits by an attacker who hasn&#x27;t authenticated successfully.</div><br/><div id="40614214" class="c"><input type="checkbox" id="c-40614214" checked=""/><div class="controls bullet"><span class="by">chuckadams</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614004">parent</a><span>|</span><a href="#40611768">next</a><span>|</span><label class="collapse" for="c-40614214">[-]</label><label class="expand" for="c-40614214">[1 more]</label></div><br/><div class="children"><div class="content">Yeah you&#x27;re right, the screw-with-them-shell would have to be strictly a honeypot thing, with a custom-compiled ssh and all the usual guard rails around a honeypot.  The password tarpit could stay, though script kiddie tools probably scale well enough now that it&#x27;s not costing them much of anything.</div><br/></div></div></div></div></div></div><div id="40611768" class="c"><input type="checkbox" id="c-40611768" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612839">prev</a><span>|</span><a href="#40612267">next</a><span>|</span><label class="collapse" for="c-40611768">[-]</label><label class="expand" for="c-40611768">[39 more]</label></div><br/><div class="children"><div class="content">&gt; First, with IPv4 this will have the potential to increasingly penalize innocent bystanders... Worst case, this will give bad actors the option to lock the original owner out of their own server if they have a botnet host in the same network.<p>So instead of looking, like the author of these new options, for ways to make life for the bad guys harder we do nothing?<p>Your concerned are addressed in TFA:<p>&gt; ... and to shield specific clients from penalty<p>&gt; A PerSourcePenaltyExemptList option allows certain address ranges to be exempt from all penalties.<p>It&#x27;s easy for the original owner to find the list of all the IP blocks the three or four ISPs he&#x27;s legitimately be connecting from to that exemption list.<p>I don&#x27;t buy your argument nor all the variation on the same theme: <i>&quot;There&#x27;s a minuscule risk of X, so we absolutely nothing but saying there&#x27;s nothing to do and we let bad guys roam free!&quot;</i>.<p>There&#x27;s nothing more depressing than that approach.<p>Kudos to the author of that new functionality: there may be issues, it may not be the panacea, but at least he&#x27;s <i>trying</i>.</div><br/><div id="40612449" class="c"><input type="checkbox" id="c-40612449" checked=""/><div class="controls bullet"><span class="by">benchaney</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611768">parent</a><span>|</span><a href="#40611906">next</a><span>|</span><label class="collapse" for="c-40612449">[-]</label><label class="expand" for="c-40612449">[1 more]</label></div><br/><div class="children"><div class="content">&gt; So instead of looking, like the author of these new options, for ways to make life for the bad guys harder we do nothing?<p>Random brute force attempts against SSH are already a 100% solved problem, so doing nothing beyond maintaining the status quo seems pretty reasonable IMO.<p>&gt; I don&#x27;t buy your argument nor all the variation on the same theme: &quot;There&#x27;s a minuscule risk of X, so we absolutely nothing but saying there&#x27;s nothing to do and we let bad guys roam free!&quot;.<p>Setting this up by default (as is being proposed) would definitely break a lot of existing use cases. The only risk that is minuscule here is the risk from not making this change.<p>I don&#x27;t see any particularly reason to applaud making software worse just because someone is &quot;trying&quot;.</div><br/></div></div><div id="40611906" class="c"><input type="checkbox" id="c-40611906" checked=""/><div class="controls bullet"><span class="by">usrbinbash</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611768">parent</a><span>|</span><a href="#40612449">prev</a><span>|</span><a href="#40612132">next</a><span>|</span><label class="collapse" for="c-40611906">[-]</label><label class="expand" for="c-40611906">[13 more]</label></div><br/><div class="children"><div class="content">&gt; So instead of looking, like the author of these new options, for ways to make life for the bad guys harder we do nothing?<p>The thing is, we have tools to implement this without changing sshd&#x27;s behavior. `fail2ban` et. al. exist for a reason.</div><br/><div id="40612689" class="c"><input type="checkbox" id="c-40612689" checked=""/><div class="controls bullet"><span class="by">dfox</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611906">parent</a><span>|</span><a href="#40613217">next</a><span>|</span><label class="collapse" for="c-40612689">[-]</label><label class="expand" for="c-40612689">[1 more]</label></div><br/><div class="children"><div class="content">The issue is that the log parsing things like fail2ban work asynchronously. It is probably of only theoretical importance, but on the other hand the meaningful threat actors are usually surprisingly fast.</div><br/></div></div><div id="40613217" class="c"><input type="checkbox" id="c-40613217" checked=""/><div class="controls bullet"><span class="by">hnlmorg</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611906">parent</a><span>|</span><a href="#40612689">prev</a><span>|</span><a href="#40612351">next</a><span>|</span><label class="collapse" for="c-40613217">[-]</label><label class="expand" for="c-40613217">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, they exist because nothing better was available at that time.<p>It doesn’t hurt to have this functionality in openssh too. If you still need to use fail2ban, denyhosts, or whatever, then don’t enable the openssh behaviour feature. It’s really that simple.</div><br/><div id="40616008" class="c"><input type="checkbox" id="c-40616008" checked=""/><div class="controls bullet"><span class="by">usrbinbash</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613217">parent</a><span>|</span><a href="#40612351">next</a><span>|</span><label class="collapse" for="c-40616008">[-]</label><label class="expand" for="c-40616008">[1 more]</label></div><br/><div class="children"><div class="content">How is baking this into sshd &quot;better&quot;?<p>UNIX Philosophy: &quot;Do one thing, and do it well&quot;. An encrypted remote shell protocol server should not be responsible for fending off attackers. That&#x27;s the job of IDS and IPS daemons.<p>Password-based ssh is an anachronism anyway. For an internet-facing server, people should REALLY use ssh keys instead (and preferably use a non-standard port, and maybe even port knocking).</div><br/></div></div></div></div><div id="40612351" class="c"><input type="checkbox" id="c-40612351" checked=""/><div class="controls bullet"><span class="by">sleepybrett</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611906">parent</a><span>|</span><a href="#40613217">prev</a><span>|</span><a href="#40612132">next</a><span>|</span><label class="collapse" for="c-40612351">[-]</label><label class="expand" for="c-40612351">[9 more]</label></div><br/><div class="children"><div class="content">Sure but if I only used fail2ban for sshd why should I install two separate pieces of software to handle the problem which the actual software I want to run has it built in?</div><br/><div id="40616042" class="c"><input type="checkbox" id="c-40616042" checked=""/><div class="controls bullet"><span class="by">usrbinbash</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612351">parent</a><span>|</span><a href="#40612711">next</a><span>|</span><label class="collapse" for="c-40616042">[-]</label><label class="expand" for="c-40616042">[1 more]</label></div><br/><div class="children"><div class="content">&gt; why should I install two separate pieces of software to handle the problem<p><a href="https:&#x2F;&#x2F;alanj.medium.com&#x2F;do-one-thing-and-do-it-well-a-unix-philosophy-8f56ed4c29ae" rel="nofollow">https:&#x2F;&#x2F;alanj.medium.com&#x2F;do-one-thing-and-do-it-well-a-unix-...</a></div><br/></div></div><div id="40612711" class="c"><input type="checkbox" id="c-40612711" checked=""/><div class="controls bullet"><span class="by">pixl97</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612351">parent</a><span>|</span><a href="#40616042">prev</a><span>|</span><a href="#40612132">next</a><span>|</span><label class="collapse" for="c-40612711">[-]</label><label class="expand" for="c-40612711">[7 more]</label></div><br/><div class="children"><div class="content">Turning every piece of software into a kitchen sink increases its security exposure in other ways.</div><br/><div id="40613276" class="c"><input type="checkbox" id="c-40613276" checked=""/><div class="controls bullet"><span class="by">hnlmorg</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612711">parent</a><span>|</span><a href="#40613013">next</a><span>|</span><label class="collapse" for="c-40613276">[-]</label><label class="expand" for="c-40613276">[4 more]</label></div><br/><div class="children"><div class="content">Normally I would agree with you, but fail2ban is a Python routine which forks processes based on outcomes from log parsing via regex. There’s so many ways that can go wrong…and has gone wrong, from one or two experiences I’ve had in the past.<p>This is exactly the sort of thing that should be part of the server. In exactly the same way that some protocol clients have waits between retries to avoid artificial rate limiting from the server.</div><br/><div id="40616233" class="c"><input type="checkbox" id="c-40616233" checked=""/><div class="controls bullet"><span class="by">usrbinbash</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613276">parent</a><span>|</span><a href="#40614364">next</a><span>|</span><label class="collapse" for="c-40616233">[-]</label><label class="expand" for="c-40616233">[1 more]</label></div><br/><div class="children"><div class="content">&gt; There’s so many ways that can go wrong<p>There are a lot of ways a builtin facility of one service can go wrong, especially if it ends up being active by default on a distro.<p>`fail2ban` is common, well known, battle-tested. And its also [not without alternatives][1].<p>[1]: <a href="https:&#x2F;&#x2F;alternativeto.net&#x2F;software&#x2F;fail2ban&#x2F;" rel="nofollow">https:&#x2F;&#x2F;alternativeto.net&#x2F;software&#x2F;fail2ban&#x2F;</a></div><br/></div></div><div id="40614364" class="c"><input type="checkbox" id="c-40614364" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613276">parent</a><span>|</span><a href="#40616233">prev</a><span>|</span><a href="#40613013">next</a><span>|</span><label class="collapse" for="c-40614364">[-]</label><label class="expand" for="c-40614364">[2 more]</label></div><br/><div class="children"><div class="content">still better trying to improve fail2ban than to add a (yet another) kitchen sink on sshd</div><br/><div id="40614482" class="c"><input type="checkbox" id="c-40614482" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614364">parent</a><span>|</span><a href="#40613013">next</a><span>|</span><label class="collapse" for="c-40614482">[-]</label><label class="expand" for="c-40614482">[1 more]</label></div><br/><div class="children"><div class="content">fail2ban has been around for so long, people get impatient at some point</div><br/></div></div></div></div></div></div><div id="40613013" class="c"><input type="checkbox" id="c-40613013" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612711">parent</a><span>|</span><a href="#40613276">prev</a><span>|</span><a href="#40614401">next</a><span>|</span><label class="collapse" for="c-40613013">[-]</label><label class="expand" for="c-40613013">[1 more]</label></div><br/><div class="children"><div class="content">a system where sshd outputs to a log file then someone else picks it up and then pokes at iptables, seems much more of hacky than having sshd supporting that natively, imo. Sshd is already tracking connection status, having it set the status to deny seems like less of a kitchen sink and more just about security. the S in ssh for secure, and this is just improving that.</div><br/></div></div><div id="40614401" class="c"><input type="checkbox" id="c-40614401" checked=""/><div class="controls bullet"><span class="by">nerdbert</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612711">parent</a><span>|</span><a href="#40613013">prev</a><span>|</span><a href="#40612132">next</a><span>|</span><label class="collapse" for="c-40614401">[-]</label><label class="expand" for="c-40614401">[1 more]</label></div><br/><div class="children"><div class="content">fail2ban has a lot of moving parts, I don&#x27;t think that&#x27;s necessarily more secure.<p>I would trust the OpenSSH developers to do a better job with the much simpler requirements associated with handling it within their own software.</div><br/></div></div></div></div></div></div></div></div><div id="40612132" class="c"><input type="checkbox" id="c-40612132" checked=""/><div class="controls bullet"><span class="by">hartator</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611768">parent</a><span>|</span><a href="#40611906">prev</a><span>|</span><a href="#40612293">next</a><span>|</span><label class="collapse" for="c-40612132">[-]</label><label class="expand" for="c-40612132">[17 more]</label></div><br/><div class="children"><div class="content">It would be frustrating to be denied access to your own servers because you are traveling and are on a bad IP for some reason.<p>Picture the amount of Captchas you already getting from a legitimate Chrome instance, but instead of by-passable annoying captchas, you are just locked out.</div><br/><div id="40612149" class="c"><input type="checkbox" id="c-40612149" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612132">parent</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40612149">[-]</label><label class="expand" for="c-40612149">[8 more]</label></div><br/><div class="children"><div class="content">I have fail2ban configured on one of my servers for port 22 (a hidden port does not have any such protections on it) and I regularly lock out my remote address because I fat finger the password. I would not suggest doing this for a management interface unless you have secondary access</div><br/><div id="40612793" class="c"><input type="checkbox" id="c-40612793" checked=""/><div class="controls bullet"><span class="by">bartekrutkowski</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612149">parent</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40612793">[-]</label><label class="expand" for="c-40612793">[7 more]</label></div><br/><div class="children"><div class="content">Why would you use password based auth instead of priv&#x2F;pub key auth? You&#x27;d avoid this and many other security risks.</div><br/><div id="40613030" class="c"><input type="checkbox" id="c-40613030" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612793">parent</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40613030">[-]</label><label class="expand" for="c-40613030">[6 more]</label></div><br/><div class="children"><div class="content">what do you if you get mugged and you laptop and phone and keys are taken or stolen from you? or lost?<p>After this party, this guy needed help, he lost his wallet and his phone, his sister also went to the party and gave him a ride there but had left. he didn&#x27;t know her number to call her, and she&#x27;d locked down her socials so we couldn&#x27;t use my phone to contact her. we were lucky that his socials weren&#x27;t super locked down and managed to find someone that way, but priv keys are only good so long as you have them.</div><br/><div id="40616191" class="c"><input type="checkbox" id="c-40616191" checked=""/><div class="controls bullet"><span class="by">bartekrutkowski</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613030">parent</a><span>|</span><a href="#40616054">next</a><span>|</span><label class="collapse" for="c-40616191">[-]</label><label class="expand" for="c-40616191">[1 more]</label></div><br/><div class="children"><div class="content">You can and you should back up your keys. There isn&#x27;t a 100% safe, secure and easy method that shields you from everything that can possibly happen, but there are enough safe, secure and easy ones to cover vast majority of cases other than a sheer catastrophe, which is good enough not to use outdated and security prone mechanisms like passwords on network exposed service.</div><br/></div></div><div id="40616054" class="c"><input type="checkbox" id="c-40616054" checked=""/><div class="controls bullet"><span class="by">usrbinbash</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613030">parent</a><span>|</span><a href="#40616191">prev</a><span>|</span><a href="#40613202">next</a><span>|</span><label class="collapse" for="c-40616054">[-]</label><label class="expand" for="c-40616054">[1 more]</label></div><br/><div class="children"><div class="content">&gt; what do you if you get mugged and you laptop and phone and keys are taken or stolen from you? or lost?<p>My ssh keys are encrypted. They need a password, or they are worthless.<p>Sure, I can mistype that password as well, but doing so has no effect on the remote system, as the ssh client already fails locally.</div><br/></div></div><div id="40613202" class="c"><input type="checkbox" id="c-40613202" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613030">parent</a><span>|</span><a href="#40616054">prev</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40613202">[-]</label><label class="expand" for="c-40613202">[3 more]</label></div><br/><div class="children"><div class="content">I use a yubikey.  You need a password to use the key.  It has it&#x27;s own brute force management that is far less punishing than a remote SSH server deciding to not talk to me anymore.</div><br/><div id="40613236" class="c"><input type="checkbox" id="c-40613236" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613202">parent</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40613236">[-]</label><label class="expand" for="c-40613236">[2 more]</label></div><br/><div class="children"><div class="content">but what do  you do if you don&#x27;t have the key? unless it&#x27;s implanted (which, <a href="https:&#x2F;&#x2F;dangerousthings.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;dangerousthings.com&#x2F;</a>), I don&#x27;t know that I won&#x27;t lose it somehow.</div><br/><div id="40613297" class="c"><input type="checkbox" id="c-40613297" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613236">parent</a><span>|</span><a href="#40612332">next</a><span>|</span><label class="collapse" for="c-40613297">[-]</label><label class="expand" for="c-40613297">[1 more]</label></div><br/><div class="children"><div class="content">My keyboard has a built in USB hub and ports.  They key lives there.  They keyboard travels with me.  It&#x27;s hard to lose.<p>I have a backup key in storage.  I have escrow mechanisms.  These would be inconvenient,  but,  it&#x27;s been 40 years since I&#x27;ve lost any keys or my wallet,  so I feel pretty good about my odds.<p>Which is what the game here is.  The odds.  Famously humans do poorly when it comes to this.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40612332" class="c"><input type="checkbox" id="c-40612332" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612132">parent</a><span>|</span><a href="#40612149">prev</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40612332">[-]</label><label class="expand" for="c-40612332">[6 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the alternative? If you get onto a bad IP today, you&#x27;re essentially blocked from the entire Internet. Combined with geolocks and national firewalls, we&#x27;re already well past the point where you need a home VPN if you want reliable connectivity while traveling abroad.</div><br/><div id="40614248" class="c"><input type="checkbox" id="c-40614248" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612332">parent</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40614248">[-]</label><label class="expand" for="c-40614248">[5 more]</label></div><br/><div class="children"><div class="content">What happens when your home VPN is inaccessible from your crappy network connection? There are plenty of badly administered networks that block arbitrary VPN&#x2F;UDP traffic but not ssh. Common case is the admin starts with default deny and creates exceptions for HTTP and whatever they use themselves, which includes ssh but not necessarily whatever VPN you use.</div><br/><div id="40614320" class="c"><input type="checkbox" id="c-40614320" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614248">parent</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40614320">[-]</label><label class="expand" for="c-40614320">[4 more]</label></div><br/><div class="children"><div class="content">Same as when a crappy network blocks SSH, you get better internet. Or if SSH is allowed, use a VPN over TCP port 22.</div><br/><div id="40614362" class="c"><input type="checkbox" id="c-40614362" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614320">parent</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40614362">[-]</label><label class="expand" for="c-40614362">[3 more]</label></div><br/><div class="children"><div class="content">Better internet isn&#x27;t always available. A VPN on the ssh port isn&#x27;t going to do you much good if someone sharing your IP address is doing brute force attempts against the ssh port on every IP address and your system uses that as a signal to block the IP address.<p>Unless you&#x27;re only blocking connection attempts to ssh and not the VPN, but what good is that? There is no reason to expect the VPN to be any more secure than OpenSSH.</div><br/><div id="40614391" class="c"><input type="checkbox" id="c-40614391" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614362">parent</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40614391">[-]</label><label class="expand" for="c-40614391">[2 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re using an IP address that&#x27;s being used to brute force the entire Internet, it&#x27;s likely that lots of websites are blocking it. If that doesn&#x27;t matter to you and all you need is to get into a particular SSH server, and also the network blocks VPNs, you&#x27;re still fine if the SSH is on port 9022 and VPN is port 22. If it&#x27;s not your own SSH server and it&#x27;s port 22, then you&#x27;re still fine if your own VPN is port 22 (on a different host).<p>Hacking into the VPN doesn&#x27;t get the attacker into the SSH server too, so there&#x27;s defense in depth, if your concern is that sshd might have a vulnerability that can be exploited with repeated attempts. If your concern is that your keys might be stolen, this feature doesn&#x27;t make sense to begin with.</div><br/><div id="40614882" class="c"><input type="checkbox" id="c-40614882" checked=""/><div class="controls bullet"><span class="by">AnthonyMouse</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40614391">parent</a><span>|</span><a href="#40612273">next</a><span>|</span><label class="collapse" for="c-40614882">[-]</label><label class="expand" for="c-40614882">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If you&#x27;re using an IP address that&#x27;s being used to brute force the entire Internet, it&#x27;s likely that lots of websites are blocking it.<p>Websites usually don&#x27;t care about ssh brute force attempts because they don&#x27;t listen on ssh. But the issue isn&#x27;t websites anyway. The problem is that <i>your</i> server is blocking you, regardless of what websites are doing.<p>&gt; If that doesn&#x27;t matter to you and all you need is to get into a particular SSH server, and also the network blocks VPNs, you&#x27;re still fine if the SSH is on port 9022 and VPN is port 22. If it&#x27;s not your own SSH server and it&#x27;s port 22, then you&#x27;re still fine if your own VPN is port 22 (on a different host).<p>Then you have a VPN exposed to the internet <i>in addition</i> to SSH, and if you&#x27;re not rate limiting connections to that then you should be just as concerned that the VPN &quot;might have a vulnerability that can be exploited with repeated attempts.&quot; Whereas if the SSH server is <i>only</i> accessible via the VPN then having the SSH server rate limiting anything is only going to give you the opportunity to lock yourself out through fat fingering or a misconfigured script, since nobody else can access it.<p>Also notably, the most sensible way to run a VPN over TCP port 22 is generally to use the VPN which is built into OpenSSH. But now this change would have you getting locked out of the VPN too.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40612273" class="c"><input type="checkbox" id="c-40612273" checked=""/><div class="controls bullet"><span class="by">semi</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612132">parent</a><span>|</span><a href="#40612332">prev</a><span>|</span><a href="#40614373">next</a><span>|</span><label class="collapse" for="c-40612273">[-]</label><label class="expand" for="c-40612273">[1 more]</label></div><br/><div class="children"><div class="content">It would also be very rare. The penalties described here start at 30s, I don&#x27;t know the max, but presumably whatever is issuing the bad behavior from that IP range will give up at some point when the sshd stops responding rather than continuing to brute force at 1 attempt per some amount of hours.<p>And that&#x27;s still assuming you end up in a range that is actively attacking your sshd. It&#x27;s definitely possible but really doesn&#x27;t seem like a bad tradeoff</div><br/></div></div><div id="40614373" class="c"><input type="checkbox" id="c-40614373" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612132">parent</a><span>|</span><a href="#40612273">prev</a><span>|</span><a href="#40612293">next</a><span>|</span><label class="collapse" for="c-40614373">[-]</label><label class="expand" for="c-40614373">[1 more]</label></div><br/><div class="children"><div class="content">lol. depending were you travel the whole continent is already blanket banned anyway. but that only happens because nobody travels there. so it is never a problem.</div><br/></div></div></div></div><div id="40612293" class="c"><input type="checkbox" id="c-40612293" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611768">parent</a><span>|</span><a href="#40612132">prev</a><span>|</span><a href="#40614654">next</a><span>|</span><label class="collapse" for="c-40612293">[-]</label><label class="expand" for="c-40612293">[1 more]</label></div><br/><div class="children"><div class="content">There is nothing wrong with this approach if enabled as an informed decision. It&#x27;s the part where they want to enable this by default I have a problem with.<p>Things that could be done is making password auth harder to configure to encourage key use instead, or invest time into making SSH CAs less of a pain to use. (See the linked paper, it&#x27;s not a long read.)</div><br/></div></div><div id="40614654" class="c"><input type="checkbox" id="c-40614654" checked=""/><div class="controls bullet"><span class="by">linuxftw</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40611768">parent</a><span>|</span><a href="#40612293">prev</a><span>|</span><a href="#40611972">next</a><span>|</span><label class="collapse" for="c-40614654">[-]</label><label class="expand" for="c-40614654">[1 more]</label></div><br/><div class="children"><div class="content">&gt; So instead of looking, like the author of these new options, for ways to make life for the bad guys harder we do nothing?<p>Yes, because as soon as the security clowns find out about these features, we have to start turning it on to check their clown boxes.</div><br/></div></div></div></div><div id="40612267" class="c"><input type="checkbox" id="c-40612267" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40611768">prev</a><span>|</span><a href="#40612089">next</a><span>|</span><label class="collapse" for="c-40612267">[-]</label><label class="expand" for="c-40612267">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not quite fair, but if you want the best service, you have to pay for your own ipv4 or, in theory, a larger ipv6 block. Only alternative is for the ISP deploying the CGN to penalize users for suspicious behavior. Classic ip-based abuse fighter, Wikipedia banned T-Mobile USA&#x27;s entire ipv6 range: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=32038215">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=32038215</a> where someone said they will typically block a &#x2F;64, and Wikipedia says they&#x27;ll block up to a &#x2F;19.<p>Unfortunately there&#x27;s no other way. Security always goes back to economics; you must make the abuse cost more than it&#x27;s worth. Phone-based 2FA is also an anti-spam measure, cause clean phone numbers cost $. When trying to purchase sketchy proxies or VPNs, it basically costs more to have a cleaner ip.</div><br/></div></div><div id="40612089" class="c"><input type="checkbox" id="c-40612089" checked=""/><div class="controls bullet"><span class="by">andix</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612267">prev</a><span>|</span><a href="#40612295">next</a><span>|</span><label class="collapse" for="c-40612089">[-]</label><label class="expand" for="c-40612089">[6 more]</label></div><br/><div class="children"><div class="content">I had a similar experience with a Postgres database once. It only mirrored some publicly available statistical data, and it was still in early development, so I didn&#x27;t give security of the database any attention. My intention was anyway to only expose it to localhost.<p>Then I started noticing that the database was randomly &quot;getting stuck&quot; on the test system. This went on for a few times until I noticed that I exposed the database to the internet with postgres&#x2F;postgres as credentials.<p>It might have been even some &quot;friendly&quot; attackers that changed the password when they were able to log in, to protect the server, maybe even the hosting provider. I should totally try that again once and observe what commands the attackers actually run. A bad actor probably wouldn&#x27;t change the password, to stay unnoticed.</div><br/><div id="40612228" class="c"><input type="checkbox" id="c-40612228" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612089">parent</a><span>|</span><a href="#40612295">next</a><span>|</span><label class="collapse" for="c-40612228">[-]</label><label class="expand" for="c-40612228">[5 more]</label></div><br/><div class="children"><div class="content">How did you accidentally expose it to the Internet, was your host DMZ?</div><br/><div id="40612463" class="c"><input type="checkbox" id="c-40612463" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612228">parent</a><span>|</span><a href="#40614974">next</a><span>|</span><label class="collapse" for="c-40612463">[-]</label><label class="expand" for="c-40612463">[3 more]</label></div><br/><div class="children"><div class="content">I saw a Postgres story like this one. Badly managed AWS org with way too wide permissions, a data scientist sort of person set it up and promptly reconfigured the security group to be open to the entire internet because they needed to access it from home. And this was a rather large IT company.</div><br/><div id="40612474" class="c"><input type="checkbox" id="c-40612474" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612463">parent</a><span>|</span><a href="#40614974">next</a><span>|</span><label class="collapse" for="c-40612474">[-]</label><label class="expand" for="c-40612474">[2 more]</label></div><br/><div class="children"><div class="content">Yeah on some cloud provider, the virtual networks can be all too confusing. But this story sounded like a home machine.</div><br/><div id="40612725" class="c"><input type="checkbox" id="c-40612725" checked=""/><div class="controls bullet"><span class="by">pixl97</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612474">parent</a><span>|</span><a href="#40614974">next</a><span>|</span><label class="collapse" for="c-40612725">[-]</label><label class="expand" for="c-40612725">[1 more]</label></div><br/><div class="children"><div class="content">DMZ setting on a router makes this pretty easy.<p>I&#x27;ve faced the DMZ at an IP on DHCP. Later when the host changed I had noticed traffic from the internet getting blocked on the new host and realized my mistake.</div><br/></div></div></div></div></div></div><div id="40614974" class="c"><input type="checkbox" id="c-40614974" checked=""/><div class="controls bullet"><span class="by">andix</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612228">parent</a><span>|</span><a href="#40612463">prev</a><span>|</span><a href="#40612295">next</a><span>|</span><label class="collapse" for="c-40614974">[-]</label><label class="expand" for="c-40614974">[1 more]</label></div><br/><div class="children"><div class="content">docker compose, I accidentially commited the port mappings I set up during local development.</div><br/></div></div></div></div></div></div><div id="40612295" class="c"><input type="checkbox" id="c-40612295" checked=""/><div class="controls bullet"><span class="by">jimmaswell</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612089">prev</a><span>|</span><a href="#40613697">next</a><span>|</span><label class="collapse" for="c-40612295">[-]</label><label class="expand" for="c-40612295">[11 more]</label></div><br/><div class="children"><div class="content">I like being able to log into my server from anywhere without having to scrounge for my key file, so I end up enabling both methods. Never quite saw how a password you save on your disk and call a key is so much more secure than another password.</div><br/><div id="40612377" class="c"><input type="checkbox" id="c-40612377" checked=""/><div class="controls bullet"><span class="by">cubesnooper</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612956">next</a><span>|</span><label class="collapse" for="c-40612377">[-]</label><label class="expand" for="c-40612377">[3 more]</label></div><br/><div class="children"><div class="content">I’ve seen lots of passwords accidentally typed into an IRC window. Never seen that happen with an SSH key.</div><br/><div id="40613140" class="c"><input type="checkbox" id="c-40613140" checked=""/><div class="controls bullet"><span class="by">arp242</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612377">parent</a><span>|</span><a href="#40612956">next</a><span>|</span><label class="collapse" for="c-40613140">[-]</label><label class="expand" for="c-40613140">[2 more]</label></div><br/><div class="children"><div class="content">I heard that if you type your password in HN it will automatically get replaced by all stars.<p>My password is **********<p>See: it works! Try it!</div><br/><div id="40614417" class="c"><input type="checkbox" id="c-40614417" checked=""/><div class="controls bullet"><span class="by">julesallen</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613140">parent</a><span>|</span><a href="#40612956">next</a><span>|</span><label class="collapse" for="c-40614417">[-]</label><label class="expand" for="c-40614417">[1 more]</label></div><br/><div class="children"><div class="content">So if I type hunter2 you see ****?</div><br/></div></div></div></div></div></div><div id="40612956" class="c"><input type="checkbox" id="c-40612956" checked=""/><div class="controls bullet"><span class="by">belthesar</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612377">prev</a><span>|</span><a href="#40612426">next</a><span>|</span><label class="collapse" for="c-40612956">[-]</label><label class="expand" for="c-40612956">[1 more]</label></div><br/><div class="children"><div class="content">This is definitely a common fallacy. While passwords and keys function similarly via the SSH protocol, there&#x27;s two key things that are different. 1, your password is likely to have much lower entropy as a cryptographic secret (ie: you&#x27;re shooting for 128 bits of entropy, which takes a pretty gnarly-sized password to replicate), and 2. SSH keys introduce a second layer of trust by virtue of you needing to add your key ID to the system before you even begin the authentication challenge.<p>Password authentication, which only uses your password to establish you are authentically you, does not establish the same level of cryptographic trust, and also does not allow the SSH server to bail out as quickly, instead needing to perform more crypto operations to discover that an unauthorized authentication attempt is being made.<p>To your point, you are storing the secret on your filesystem, and you should treat it accordingly. This is why folks generally advocate for the use of SSH Agents with password or other systems protecting your SSH key from being simply lifted. Even with requiring a password to unlock your key though, there&#x27;s a pretty significant difference between key based and password based auth.</div><br/></div></div><div id="40612426" class="c"><input type="checkbox" id="c-40612426" checked=""/><div class="controls bullet"><span class="by">cubesnooper</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612956">prev</a><span>|</span><a href="#40612519">next</a><span>|</span><label class="collapse" for="c-40612426">[-]</label><label class="expand" for="c-40612426">[1 more]</label></div><br/><div class="children"><div class="content">A few more things:<p>An SSH key can be freely reused to log in to multiple SSH servers without compromise. Passwords should never be reused between multiple servers, because the other end could log it.<p>An SSH key can be stored in an agent, which provides some minor security benefits, and more importantly, adds a whole lot of convenience.<p>An SSH key can be tied to a Yubikey out of the box, providing strong 2FA.</div><br/></div></div><div id="40612519" class="c"><input type="checkbox" id="c-40612519" checked=""/><div class="controls bullet"><span class="by">swinglock</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612426">prev</a><span>|</span><a href="#40612356">next</a><span>|</span><label class="collapse" for="c-40612519">[-]</label><label class="expand" for="c-40612519">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s more secure because it&#x27;s resistant to MITM attacks or a compromised host. Because the password is sent, the private key isn&#x27;t.</div><br/></div></div><div id="40612356" class="c"><input type="checkbox" id="c-40612356" checked=""/><div class="controls bullet"><span class="by">marcrosoft</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612519">prev</a><span>|</span><a href="#40612333">next</a><span>|</span><label class="collapse" for="c-40612356">[-]</label><label class="expand" for="c-40612356">[1 more]</label></div><br/><div class="children"><div class="content">My home IP doesn’t change much so I just open ssh port only to my own IP. If I travel I’ll add another IP if I need to ssh in. I don’t get locked out because I use VPS or cloud provider firewall that can be changed through console after auth&#x2F;MFA. This way SSH is never exposed to the wider internet.</div><br/></div></div><div id="40612333" class="c"><input type="checkbox" id="c-40612333" checked=""/><div class="controls bullet"><span class="by">sleepybrett</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612356">prev</a><span>|</span><a href="#40612489">next</a><span>|</span><label class="collapse" for="c-40612333">[-]</label><label class="expand" for="c-40612333">[2 more]</label></div><br/><div class="children"><div class="content">Putting aside everything else. How long is your password vs how long is your key?</div><br/><div id="40612392" class="c"><input type="checkbox" id="c-40612392" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612333">parent</a><span>|</span><a href="#40612489">next</a><span>|</span><label class="collapse" for="c-40612392">[-]</label><label class="expand" for="c-40612392">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s this, plus the potential that you&#x27;ve reused your password, or that it&#x27;s been keylogged.</div><br/></div></div></div></div><div id="40612489" class="c"><input type="checkbox" id="c-40612489" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612295">parent</a><span>|</span><a href="#40612333">prev</a><span>|</span><a href="#40613697">next</a><span>|</span><label class="collapse" for="c-40612489">[-]</label><label class="expand" for="c-40612489">[1 more]</label></div><br/><div class="children"><div class="content">Use TOTP (keyboard-interactive) and password away!</div><br/></div></div></div></div><div id="40613697" class="c"><input type="checkbox" id="c-40613697" checked=""/><div class="controls bullet"><span class="by">yardstick</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612295">prev</a><span>|</span><a href="#40612104">next</a><span>|</span><label class="collapse" for="c-40613697">[-]</label><label class="expand" for="c-40613697">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Worst case, this will give bad actors the option to lock the original owner out of their own server if they have a botnet host in the same network.<p>According to to the article, you can exempt IPs from being blocked. So it won’t impact those coming from known IPs (statics, jump hosts, etc).</div><br/><div id="40614318" class="c"><input type="checkbox" id="c-40614318" checked=""/><div class="controls bullet"><span class="by">1oooqooq</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40613697">parent</a><span>|</span><a href="#40612104">next</a><span>|</span><label class="collapse" for="c-40614318">[-]</label><label class="expand" for="c-40614318">[1 more]</label></div><br/><div class="children"><div class="content">most places barely even have the essential monthly email with essential services&#x27; ip in case of dns outage.<p>nobody cares about ips.</div><br/></div></div></div></div><div id="40612104" class="c"><input type="checkbox" id="c-40612104" checked=""/><div class="controls bullet"><span class="by">hartator</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40613697">prev</a><span>|</span><a href="#40612779">next</a><span>|</span><label class="collapse" for="c-40612104">[-]</label><label class="expand" for="c-40612104">[2 more]</label></div><br/><div class="children"><div class="content">Yes, I agree. This seems a naive fix.<p>Just silencing all the failed attempts may be better. So much noise in these logs anyway.</div><br/><div id="40612140" class="c"><input type="checkbox" id="c-40612140" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#40611450">root</a><span>|</span><a href="#40612104">parent</a><span>|</span><a href="#40612779">next</a><span>|</span><label class="collapse" for="c-40612140">[-]</label><label class="expand" for="c-40612140">[1 more]</label></div><br/><div class="children"><div class="content">Fail2ban can help with that</div><br/></div></div></div></div><div id="40612779" class="c"><input type="checkbox" id="c-40612779" checked=""/><div class="controls bullet"><span class="by">Grimeton</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612104">prev</a><span>|</span><a href="#40611715">next</a><span>|</span><label class="collapse" for="c-40612779">[-]</label><label class="expand" for="c-40612779">[1 more]</label></div><br/><div class="children"><div class="content">Just throw away that document and switch to kerberos.<p>All the problems in this document are solved immediately.</div><br/></div></div><div id="40611715" class="c"><input type="checkbox" id="c-40611715" checked=""/><div class="controls bullet"><span class="by">waihtis</span><span>|</span><a href="#40611450">parent</a><span>|</span><a href="#40612779">prev</a><span>|</span><a href="#40610902">next</a><span>|</span><label class="collapse" for="c-40611715">[-]</label><label class="expand" for="c-40611715">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. In addition to the problems you mentioned, this could also cause people to drop usage of SSH keys and go with a password instead, since it&#x27;s now a &quot;protected&quot; authentication vector.</div><br/></div></div></div></div><div id="40610902" class="c"><input type="checkbox" id="c-40610902" checked=""/><div class="controls bullet"><span class="by">Someone1234</span><span>|</span><a href="#40611450">prev</a><span>|</span><a href="#40611806">next</a><span>|</span><label class="collapse" for="c-40610902">[-]</label><label class="expand" for="c-40610902">[50 more]</label></div><br/><div class="children"><div class="content">This is great, and helps solve several problems at once.<p>I would like to remind everyone that an internet facing SSH with a password is very unwise. I would argue you need to be able to articulate the justification for it, using keys is actually more convenient and significantly more secure.<p>Aside from initial boot, I cannot think of the last time I used a password for SSH instead of a key even on a LAN. Support for keys is universal and has been for most of my lifespan.</div><br/><div id="40610987" class="c"><input type="checkbox" id="c-40610987" checked=""/><div class="controls bullet"><span class="by">securam</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40611369">next</a><span>|</span><label class="collapse" for="c-40610987">[-]</label><label class="expand" for="c-40610987">[19 more]</label></div><br/><div class="children"><div class="content">Some might argue SSH certificates are even better:
<a href="https:&#x2F;&#x2F;smallstep.com&#x2F;blog&#x2F;use-ssh-certificates&#x2F;" rel="nofollow">https:&#x2F;&#x2F;smallstep.com&#x2F;blog&#x2F;use-ssh-certificates&#x2F;</a></div><br/><div id="40611049" class="c"><input type="checkbox" id="c-40611049" checked=""/><div class="controls bullet"><span class="by">mianosm</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610987">parent</a><span>|</span><a href="#40612524">next</a><span>|</span><label class="collapse" for="c-40611049">[-]</label><label class="expand" for="c-40611049">[14 more]</label></div><br/><div class="children"><div class="content">There&#x27;s a high bar to set for most organizations. Leveraging certificates is excellent if the supporting and engineering actors are all in accordance with how to manage and train the users and workforce how to use them (think root authorities, and revoking issued certificates from an authority).<p>I&#x27;ve seen a few attempts to leverage certificates, or GPG; and keys nearly always are an &#x27;easier&#x27; process with less burden to teach (which smart(er) people at times hate to do).</div><br/><div id="40611160" class="c"><input type="checkbox" id="c-40611160" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611049">parent</a><span>|</span><a href="#40611217">next</a><span>|</span><label class="collapse" for="c-40611160">[-]</label><label class="expand" for="c-40611160">[5 more]</label></div><br/><div class="children"><div class="content">You can store your regular keys in gpg, it&#x27;s a nice middle ground especially if you store them on a yubikey with openpgp.<p>Of course OpenSSH also supports fido2 now but it&#x27;s pretty new and many embedded servers don&#x27;t support it. So I&#x27;m ignoring it for now. I need an openpgp setup for my password manager anyway.</div><br/><div id="40611227" class="c"><input type="checkbox" id="c-40611227" checked=""/><div class="controls bullet"><span class="by">KAMSPioneer</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611160">parent</a><span>|</span><a href="#40611217">next</a><span>|</span><label class="collapse" for="c-40611227">[-]</label><label class="expand" for="c-40611227">[4 more]</label></div><br/><div class="children"><div class="content">I use both PKCS#11 and OpenPGP SSH keys and in my opinion, PKCS#11 is a better user experience if you don&#x27;t also require PGP functionality. Especially if you&#x27;re supporting MaxOS clients as you can just use Secretive[0]. As you say, FIDO is even better but comes with limitations on both client and server, which makes life tough.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;maxgoedjen&#x2F;secretive">https:&#x2F;&#x2F;github.com&#x2F;maxgoedjen&#x2F;secretive</a></div><br/><div id="40612312" class="c"><input type="checkbox" id="c-40612312" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611227">parent</a><span>|</span><a href="#40611217">next</a><span>|</span><label class="collapse" for="c-40612312">[-]</label><label class="expand" for="c-40612312">[3 more]</label></div><br/><div class="children"><div class="content">Oh yeah I don&#x27;t really use macOS anymore. And I do really need PGP functionality for my password manager.<p>I used pkcs11 before with openct and opensc (on OpenHSM PIV cards) and the problem I had with it was that I always needed to runtime-link a library to the SSH binary to make it work which was often causing problems on different platforms.<p>The nice thing about using PGP&#x2F;GPG is that it can simulate an SSH agent so none of this is necessary, it will just communicate with the agent over a local socket.</div><br/><div id="40612866" class="c"><input type="checkbox" id="c-40612866" checked=""/><div class="controls bullet"><span class="by">palata</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612312">parent</a><span>|</span><a href="#40611217">next</a><span>|</span><label class="collapse" for="c-40612866">[-]</label><label class="expand" for="c-40612866">[2 more]</label></div><br/><div class="children"><div class="content">&gt; And I do really need PGP functionality for my password manager.<p>Just curious: is it <a href="https:&#x2F;&#x2F;www.passwordstore.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.passwordstore.org&#x2F;</a>?</div><br/><div id="40614999" class="c"><input type="checkbox" id="c-40614999" checked=""/><div class="controls bullet"><span class="by">wkat4242</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612866">parent</a><span>|</span><a href="#40611217">next</a><span>|</span><label class="collapse" for="c-40614999">[-]</label><label class="expand" for="c-40614999">[1 more]</label></div><br/><div class="children"><div class="content">Yes it is! It&#x27;s great!</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40611217" class="c"><input type="checkbox" id="c-40611217" checked=""/><div class="controls bullet"><span class="by">upon_drumhead</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611049">parent</a><span>|</span><a href="#40611160">prev</a><span>|</span><a href="#40613176">next</a><span>|</span><label class="collapse" for="c-40611217">[-]</label><label class="expand" for="c-40611217">[6 more]</label></div><br/><div class="children"><div class="content">SSH Certificates are vastly different then the certificates you are referencing.<p>SSH Certificates are actually just a SSH Key attested by another SSH Key. There&#x27;s no revocation system in place, nor anything more advanced then &quot;I trust key x and so any keys signed by X I will trust&quot;</div><br/><div id="40611396" class="c"><input type="checkbox" id="c-40611396" checked=""/><div class="controls bullet"><span class="by">magmastonealex</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611217">parent</a><span>|</span><a href="#40611306">next</a><span>|</span><label class="collapse" for="c-40611396">[-]</label><label class="expand" for="c-40611396">[1 more]</label></div><br/><div class="children"><div class="content">There is a revocation system in place (the RevokedKeys directive in the sshd configuration file, which seems to be system-wide rather than configured at the user-level. At least, that’s the only way I’ve used it)<p>I agree with the sentiment though, it is far less extensive than traditional X.509 certificate infrastructure.</div><br/></div></div><div id="40611306" class="c"><input type="checkbox" id="c-40611306" checked=""/><div class="controls bullet"><span class="by">karmarepellent</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611217">parent</a><span>|</span><a href="#40611396">prev</a><span>|</span><a href="#40612558">next</a><span>|</span><label class="collapse" for="c-40611306">[-]</label><label class="expand" for="c-40611306">[3 more]</label></div><br/><div class="children"><div class="content">I am no familiar with SSH certificates either. But if there is no revocation system in place, how can I be sure access from a person can be revoked?<p>At our org we simply distribute SSH public keys via Puppet. So if some leaves, switches teams (without access to our servers) or their key must be renewed, we simply update a line in a config file and call it a day.<p>That way we also have full control over what types of keys are supported and older, broken kex and signature algorithms are disabled.</div><br/><div id="40611592" class="c"><input type="checkbox" id="c-40611592" checked=""/><div class="controls bullet"><span class="by">hotdogs</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611306">parent</a><span>|</span><a href="#40612558">next</a><span>|</span><label class="collapse" for="c-40611592">[-]</label><label class="expand" for="c-40611592">[2 more]</label></div><br/><div class="children"><div class="content">The certificates have a validity window that sshd also checks. So the CA can sign a certificate for a short window (hours), until the user has to request a new one.</div><br/><div id="40612552" class="c"><input type="checkbox" id="c-40612552" checked=""/><div class="controls bullet"><span class="by">chgs</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611592">parent</a><span>|</span><a href="#40612558">next</a><span>|</span><label class="collapse" for="c-40612552">[-]</label><label class="expand" for="c-40612552">[1 more]</label></div><br/><div class="children"><div class="content">One department in my cops y does this - you authenticate once with your standard company wide oidc integration (which has instant JML), and you get a key for 20 hours (enough for even the longest shift but not enough that you don’t need to reauth the next day).</div><br/></div></div></div></div></div></div><div id="40612558" class="c"><input type="checkbox" id="c-40612558" checked=""/><div class="controls bullet"><span class="by">gnufx</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611217">parent</a><span>|</span><a href="#40611306">prev</a><span>|</span><a href="#40613176">next</a><span>|</span><label class="collapse" for="c-40612558">[-]</label><label class="expand" for="c-40612558">[1 more]</label></div><br/><div class="children"><div class="content">&gt; SSH Certificates are vastly different then the certificates you are referencing.<p>And the SSH maintainers will refuse offers of X.509 support, with a justification.</div><br/></div></div></div></div><div id="40613176" class="c"><input type="checkbox" id="c-40613176" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611049">parent</a><span>|</span><a href="#40611217">prev</a><span>|</span><a href="#40612524">next</a><span>|</span><label class="collapse" for="c-40613176">[-]</label><label class="expand" for="c-40613176">[2 more]</label></div><br/><div class="children"><div class="content">I like SSH certificates, and I use them on my own servers, but for organizations there&#x27;s a nasty downside: SSH certificates lack good revocation logic. OCSP&#x2F;CRL checks and certificate transparency protect browsers from this, but SSH doesn&#x27;t have that good a solution for that.<p>Unless you regenerate them every day or have some kind of elaborate synchronisation process set up on the server side, a malicious ex-employee could abuse the old credentials post-termination.<p>This could be worked around leveraging TPMs, which would allow storing the keys themselves on hardware that can be confiscated, but standard user-based auth has a lot more (user-friendly) tooling and integration options.</div><br/><div id="40614728" class="c"><input type="checkbox" id="c-40614728" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40613176">parent</a><span>|</span><a href="#40612524">next</a><span>|</span><label class="collapse" for="c-40614728">[-]</label><label class="expand" for="c-40614728">[1 more]</label></div><br/><div class="children"><div class="content">It seems to me like short-lived certificates are the way to go, which would require tooling. I am actually a little surprised to hear that you&#x27;re using long-lived certificates on your own servers (I&#x27;m imagining a homelab setup). What benefit does that provide you over distributing keys? Who&#x27;s the CA?</div><br/></div></div></div></div></div></div><div id="40612524" class="c"><input type="checkbox" id="c-40612524" checked=""/><div class="controls bullet"><span class="by">gnufx</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610987">parent</a><span>|</span><a href="#40611049">prev</a><span>|</span><a href="#40611082">next</a><span>|</span><label class="collapse" for="c-40612524">[-]</label><label class="expand" for="c-40612524">[1 more]</label></div><br/><div class="children"><div class="content">Some would argue that in an organization where you&#x27;d consider SSH certificates, it&#x27;s best to use Kerberos and have general SSO. (Some of the GSSAPI functionality is patched in by most distributions, and isn&#x27;t in vanilla OpenSSH.)</div><br/></div></div><div id="40611082" class="c"><input type="checkbox" id="c-40611082" checked=""/><div class="controls bullet"><span class="by">GordonS</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610987">parent</a><span>|</span><a href="#40612524">prev</a><span>|</span><a href="#40612417">next</a><span>|</span><label class="collapse" for="c-40611082">[-]</label><label class="expand" for="c-40611082">[1 more]</label></div><br/><div class="children"><div class="content">I setup a test smallstep instance recently, and it works really well. Setup is... complicated though, and the CLI has a few quirks.</div><br/></div></div><div id="40612417" class="c"><input type="checkbox" id="c-40612417" checked=""/><div class="controls bullet"><span class="by">hot_gril</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610987">parent</a><span>|</span><a href="#40611082">prev</a><span>|</span><a href="#40611261">next</a><span>|</span><label class="collapse" for="c-40612417">[-]</label><label class="expand" for="c-40612417">[1 more]</label></div><br/><div class="children"><div class="content">The more complicated something is, the higher chance I screw it up.</div><br/></div></div><div id="40611261" class="c"><input type="checkbox" id="c-40611261" checked=""/><div class="controls bullet"><span class="by">jppittma</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610987">parent</a><span>|</span><a href="#40612417">prev</a><span>|</span><a href="#40611369">next</a><span>|</span><label class="collapse" for="c-40611261">[-]</label><label class="expand" for="c-40611261">[1 more]</label></div><br/><div class="children"><div class="content">Holy shit. I wondered if this was possible a few weeks ago and couldn&#x27;t find anything on it. Thanks for the link!</div><br/></div></div></div></div><div id="40611369" class="c"><input type="checkbox" id="c-40611369" checked=""/><div class="controls bullet"><span class="by">_JamesA_</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40610987">prev</a><span>|</span><a href="#40611800">next</a><span>|</span><label class="collapse" for="c-40611369">[-]</label><label class="expand" for="c-40611369">[1 more]</label></div><br/><div class="children"><div class="content">The number of expect scripts I find in production that are used to automate ssh password authentication is ridiculous.</div><br/></div></div><div id="40611800" class="c"><input type="checkbox" id="c-40611800" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40611369">prev</a><span>|</span><a href="#40612612">next</a><span>|</span><label class="collapse" for="c-40611800">[-]</label><label class="expand" for="c-40611800">[1 more]</label></div><br/><div class="children"><div class="content">&gt; ... using keys is actually more convenient and significantly more secure.<p>And for those for whom it&#x27;s an option, using U2F keys (like Yubikeys) is now easily doable with SSH.<p>So unless the attacker can hack the HSM inside your Yubikey, he&#x27;s simply not getting your private SSH keys.</div><br/></div></div><div id="40612612" class="c"><input type="checkbox" id="c-40612612" checked=""/><div class="controls bullet"><span class="by">joelthelion</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40611800">prev</a><span>|</span><a href="#40612270">next</a><span>|</span><label class="collapse" for="c-40612612">[-]</label><label class="expand" for="c-40612612">[6 more]</label></div><br/><div class="children"><div class="content">&gt; internet facing SSH with a password is very unwise<p>If your password is strong, it&#x27;s not.</div><br/><div id="40614747" class="c"><input type="checkbox" id="c-40614747" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612612">parent</a><span>|</span><a href="#40614838">next</a><span>|</span><label class="collapse" for="c-40614747">[-]</label><label class="expand" for="c-40614747">[1 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t forget to use a different strong password on each server! <a href="https:&#x2F;&#x2F;security.stackexchange.com&#x2F;a&#x2F;152132" rel="nofollow">https:&#x2F;&#x2F;security.stackexchange.com&#x2F;a&#x2F;152132</a></div><br/></div></div><div id="40614838" class="c"><input type="checkbox" id="c-40614838" checked=""/><div class="controls bullet"><span class="by">oofabz</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612612">parent</a><span>|</span><a href="#40614747">prev</a><span>|</span><a href="#40615329">next</a><span>|</span><label class="collapse" for="c-40614838">[-]</label><label class="expand" for="c-40614838">[1 more]</label></div><br/><div class="children"><div class="content">A strong username also helps! Most SSH brute force attempts are for root, admin, or ubnt.</div><br/></div></div><div id="40615329" class="c"><input type="checkbox" id="c-40615329" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612612">parent</a><span>|</span><a href="#40614838">prev</a><span>|</span><a href="#40612270">next</a><span>|</span><label class="collapse" for="c-40615329">[-]</label><label class="expand" for="c-40615329">[3 more]</label></div><br/><div class="children"><div class="content">Nope, still unwise.  Easy to steal, easy to clone, hard to script. Keys stored in hardware is simple and easy on most platforms these days.  Yubikeys or Mac SEP is ideal.</div><br/><div id="40615512" class="c"><input type="checkbox" id="c-40615512" checked=""/><div class="controls bullet"><span class="by">joelthelion</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40615329">parent</a><span>|</span><a href="#40612270">next</a><span>|</span><label class="collapse" for="c-40615512">[-]</label><label class="expand" for="c-40615512">[2 more]</label></div><br/><div class="children"><div class="content">It depends on your use case. I have a personal server only I use use. In this use case, being able to access it from anywhere without any device trumps other considerations. The password is ideal.<p>In a corporate setting, things are of course different.</div><br/><div id="40615720" class="c"><input type="checkbox" id="c-40615720" checked=""/><div class="controls bullet"><span class="by">sneak</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40615512">parent</a><span>|</span><a href="#40612270">next</a><span>|</span><label class="collapse" for="c-40615720">[-]</label><label class="expand" for="c-40615720">[1 more]</label></div><br/><div class="children"><div class="content">My use case is the same as yours. Malware can steal your credentials, it cannot steal mine.  I also don&#x27;t need fail2ban or to configure any of these new OpenSSH features.  Users added to the server can&#x27;t get compromised due to use of weak passwords.<p>Passwords are obsolete in 2024, and using them is very nearly universally bad.</div><br/></div></div></div></div></div></div></div></div><div id="40612270" class="c"><input type="checkbox" id="c-40612270" checked=""/><div class="controls bullet"><span class="by">im3w1l</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40612612">prev</a><span>|</span><a href="#40611096">next</a><span>|</span><label class="collapse" for="c-40612270">[-]</label><label class="expand" for="c-40612270">[1 more]</label></div><br/><div class="children"><div class="content">I resent that every application needs its own special snowflake auth method. One uses a certain 2fa app. Another uses another 2fa app. Another uses emailed code. Another uses text code. Another uses special ssh keys. Another opens a prompt in the browser where I have to confirm. Another uses special scoped tokens.<p>Yes there are good reasons. But it is quite a hassle to manage too.</div><br/></div></div><div id="40611096" class="c"><input type="checkbox" id="c-40611096" checked=""/><div class="controls bullet"><span class="by">GordonS</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40612270">prev</a><span>|</span><a href="#40612276">next</a><span>|</span><label class="collapse" for="c-40611096">[-]</label><label class="expand" for="c-40611096">[5 more]</label></div><br/><div class="children"><div class="content">Another good option is making SSH only accessible over Tailscale or a VPN.</div><br/><div id="40611244" class="c"><input type="checkbox" id="c-40611244" checked=""/><div class="controls bullet"><span class="by">Someone1234</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611096">parent</a><span>|</span><a href="#40611179">next</a><span>|</span><label class="collapse" for="c-40611244">[-]</label><label class="expand" for="c-40611244">[1 more]</label></div><br/><div class="children"><div class="content">The two aren&#x27;t exclusive of one another. We&#x27;ve also witnessed situations, with major companies, wherein an SSH &quot;leaks&quot; outside the VPN due to network misconfiguration or misconfiguring interfaces on the server.<p>As I said above, keys are actually more convenient than passwords. Only reason people still use passwords is because they believe keys are difficult to use or manage.</div><br/></div></div><div id="40611179" class="c"><input type="checkbox" id="c-40611179" checked=""/><div class="controls bullet"><span class="by">nativeit</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611096">parent</a><span>|</span><a href="#40611244">prev</a><span>|</span><a href="#40612360">next</a><span>|</span><label class="collapse" for="c-40611179">[-]</label><label class="expand" for="c-40611179">[1 more]</label></div><br/><div class="children"><div class="content">This, with key pairs, is the best blend of security and convenience. I use ZeroTier and UFW on the server and it’s really very simple and extremely reliable. On the very rare occasion that ZeroTier encounters a problem, or my login fails, I still have IPMI access through Proxmox&#x2F;VMWare and&#x2F;or my server provider.</div><br/></div></div><div id="40612360" class="c"><input type="checkbox" id="c-40612360" checked=""/><div class="controls bullet"><span class="by">vaylian</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611096">parent</a><span>|</span><a href="#40611179">prev</a><span>|</span><a href="#40612276">next</a><span>|</span><label class="collapse" for="c-40612360">[-]</label><label class="expand" for="c-40612360">[2 more]</label></div><br/><div class="children"><div class="content">How do you protect the access to the VPN&#x2F;Tailscale? I suppose you are not using a password?</div><br/><div id="40612903" class="c"><input type="checkbox" id="c-40612903" checked=""/><div class="controls bullet"><span class="by">GordonS</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612360">parent</a><span>|</span><a href="#40612276">next</a><span>|</span><label class="collapse" for="c-40612903">[-]</label><label class="expand" for="c-40612903">[1 more]</label></div><br/><div class="children"><div class="content">SSO and MFA, with a Microsoft account.</div><br/></div></div></div></div></div></div><div id="40612276" class="c"><input type="checkbox" id="c-40612276" checked=""/><div class="controls bullet"><span class="by">KennyBlanken</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40611096">prev</a><span>|</span><a href="#40610950">next</a><span>|</span><label class="collapse" for="c-40612276">[-]</label><label class="expand" for="c-40612276">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I would like to remind everyone that an internet facing SSH with a password is very unwise.<p>Bullshit. You can have a terrible password and your system will still be nearly impossible to get into. Also, these attackers are usually looking for already exploited systems that have backdoor account&#x2F;password combos, unless they are specifically attacking your organization.<p>Repeat after me: dictionary attack concerns have nothing to do with remote access authentication concerns.<p>Let&#x27;s say my password is two common-use English words (100k-200k.) That&#x27;s ten billion possibilities. Assume you hit on my password half-way through. That would be <i>fifteen years</i> of continuous, 24x7x365 testing at 10 password attempts per second....and then there&#x27;s the small matter of you not knowing what my username is, or even whether you&#x27;ve got the right username or not, unless the ssh server has a timing-based detection attack.<p>The only argument for putting this functionality in the daemon itself is that by locating it in the daemon, it can offer advanced application-layer capabilities, such as failing auth attempts <i>no matter what</i> after the limit is tripped so that brute-forcing becomes more pointless - unless you get it right within the first few attempts, you could hit the right password and never know it. If they intend to implement features like that in the future, great - but if it&#x27;s just going to do what fail2ban does, then...just run fail2ban.<p>Fail2ban has a higher overview of auth on the system, is completely disconnected from the ssh daemon in terms of monitoring and blocking, and the blocking it does happens at the kernel level in the networking stack instead of in userspace with much more overhead and in a proprietary system specific to SSH.<p>As a sysadmin, this is &#x27;yet another place you have to look&#x27; to see why something isn&#x27;t working.</div><br/><div id="40612894" class="c"><input type="checkbox" id="c-40612894" checked=""/><div class="controls bullet"><span class="by">palata</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612276">parent</a><span>|</span><a href="#40610950">next</a><span>|</span><label class="collapse" for="c-40612894">[-]</label><label class="expand" for="c-40612894">[1 more]</label></div><br/><div class="children"><div class="content">&gt; You can have a terrible password and your system will still be nearly impossible to get into.<p>Ok, let&#x27;s try an example of a terrible password for the user &quot;root&quot;: &quot;password&quot;. Is that nearly impossible to get into? Or does that not qualify as a &quot;terrible password&quot; per your definition?</div><br/></div></div></div></div><div id="40610950" class="c"><input type="checkbox" id="c-40610950" checked=""/><div class="controls bullet"><span class="by">timw4mail</span><span>|</span><a href="#40610902">parent</a><span>|</span><a href="#40612276">prev</a><span>|</span><a href="#40611806">next</a><span>|</span><label class="collapse" for="c-40610950">[-]</label><label class="expand" for="c-40610950">[14 more]</label></div><br/><div class="children"><div class="content">Any time you access an SSH connection from a different computer, you basically need the password.</div><br/><div id="40610988" class="c"><input type="checkbox" id="c-40610988" checked=""/><div class="controls bullet"><span class="by">krisoft</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610950">parent</a><span>|</span><a href="#40611729">next</a><span>|</span><label class="collapse" for="c-40610988">[-]</label><label class="expand" for="c-40610988">[10 more]</label></div><br/><div class="children"><div class="content">This is not true. SSH keys are a viable alternative.</div><br/><div id="40611147" class="c"><input type="checkbox" id="c-40611147" checked=""/><div class="controls bullet"><span class="by">sseagull</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610988">parent</a><span>|</span><a href="#40611403">next</a><span>|</span><label class="collapse" for="c-40611147">[-]</label><label class="expand" for="c-40611147">[8 more]</label></div><br/><div class="children"><div class="content">If I can be charitable, I think they mean a different computer than one you usually use (that doesn’t have the SSH key already in authorized_keys). Spouses computer, etc.</div><br/><div id="40614433" class="c"><input type="checkbox" id="c-40614433" checked=""/><div class="controls bullet"><span class="by">nerdbert</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611147">parent</a><span>|</span><a href="#40611393">next</a><span>|</span><label class="collapse" for="c-40614433">[-]</label><label class="expand" for="c-40614433">[1 more]</label></div><br/><div class="children"><div class="content">Why would you ever do that? How do you know it is not compromised?<p>Carry your phone (many people already do this on a daily or near-daily basis in 2024) and use that in an emergency.</div><br/></div></div><div id="40611393" class="c"><input type="checkbox" id="c-40611393" checked=""/><div class="controls bullet"><span class="by">traceroute66</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611147">parent</a><span>|</span><a href="#40614433">prev</a><span>|</span><a href="#40611403">next</a><span>|</span><label class="collapse" for="c-40611393">[-]</label><label class="expand" for="c-40611393">[6 more]</label></div><br/><div class="children"><div class="content">&gt; If I can be charitable, I think they mean a different computer than one you usually use<p>If I can be charitable ....<p>What the hell are you doing storing your SSH keys on-disk anyway ?  :)<p>Put your keys on a Yubikey, take your keys with you.</div><br/><div id="40612039" class="c"><input type="checkbox" id="c-40612039" checked=""/><div class="controls bullet"><span class="by">doublepg23</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611393">parent</a><span>|</span><a href="#40611479">next</a><span>|</span><label class="collapse" for="c-40612039">[-]</label><label class="expand" for="c-40612039">[2 more]</label></div><br/><div class="children"><div class="content">Does that work with macOS? 
I’m currently using 1Password as my ssh key agent.</div><br/><div id="40612685" class="c"><input type="checkbox" id="c-40612685" checked=""/><div class="controls bullet"><span class="by">koito17</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612039">parent</a><span>|</span><a href="#40611479">next</a><span>|</span><label class="collapse" for="c-40612685">[-]</label><label class="expand" for="c-40612685">[1 more]</label></div><br/><div class="children"><div class="content">It indeed works on Mac OS. I have been using SoloKeys with ed25519-sk keys for about three years now. It should be sufficient to run<p><pre><code>  ssh-keygen -t ed25519-sk
</code></pre>
while a FIDO2 key is connected. You may need to touch the key to confirm user presence. (At least SoloKeys do).<p>If I recall correctly, the SSH binaries provided by Apple don&#x27;t have built-in support for signing keys, but if you install OpenSSH from Nix, MacPorts, etc., then you don&#x27;t have to worry about this.<p>Another thing to be mindful of is that some programs have a very low timeout for waiting on SSH authentication, particularly git. SSH itself will wait quite a long time for user presence when using a signing key, whereas Git requires me to confirm presence within about 5 seconds or else operations fail with a timeout.</div><br/></div></div></div></div><div id="40611479" class="c"><input type="checkbox" id="c-40611479" checked=""/><div class="controls bullet"><span class="by">unethical_ban</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611393">parent</a><span>|</span><a href="#40612039">prev</a><span>|</span><a href="#40611403">next</a><span>|</span><label class="collapse" for="c-40611479">[-]</label><label class="expand" for="c-40611479">[3 more]</label></div><br/><div class="children"><div class="content">Right, much easier than a password! And so easy to backup!<p>I&#x27;m not arguing it isn&#x27;t more secure. The point of this subthread is that SSH keys are not as easy to do ad-hoc as passwords, especially when moving workstations.</div><br/><div id="40612037" class="c"><input type="checkbox" id="c-40612037" checked=""/><div class="controls bullet"><span class="by">nottorp</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40611479">parent</a><span>|</span><a href="#40611403">next</a><span>|</span><label class="collapse" for="c-40612037">[-]</label><label class="expand" for="c-40612037">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Right, much easier than a password! And so easy to backup!<p>Extremely easy to recover from when the device you rely on to authenticate for everything gets lost or stolen too!</div><br/><div id="40614030" class="c"><input type="checkbox" id="c-40614030" checked=""/><div class="controls bullet"><span class="by">unethical_ban</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40612037">parent</a><span>|</span><a href="#40611403">next</a><span>|</span><label class="collapse" for="c-40614030">[-]</label><label class="expand" for="c-40614030">[1 more]</label></div><br/><div class="children"><div class="content">Exactly.<p>If I can&#x27;t use TOTP with backup codes, I&#x27;m not using MFA.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40611403" class="c"><input type="checkbox" id="c-40611403" checked=""/><div class="controls bullet"><span class="by">Rucadi</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610988">parent</a><span>|</span><a href="#40611147">prev</a><span>|</span><a href="#40611729">next</a><span>|</span><label class="collapse" for="c-40611403">[-]</label><label class="expand" for="c-40611403">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s just an usually bigger password.</div><br/></div></div></div></div><div id="40610980" class="c"><input type="checkbox" id="c-40610980" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#40610902">root</a><span>|</span><a href="#40610950">parent</a><span>|</span><a href="#40611012">prev</a><span>|</span><a href="#40611806">next</a><span>|</span><label class="collapse" for="c-40610980">[-]</label><label class="expand" for="c-40610980">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s in the cloud, you pass the public key when creating the vm. If it&#x27;s a real machine, ask the data center person to do it.</div><br/></div></div></div></div></div></div><div id="40611806" class="c"><input type="checkbox" id="c-40611806" checked=""/><div class="controls bullet"><span class="by">kelnos</span><span>|</span><a href="#40610902">prev</a><span>|</span><a href="#40611318">next</a><span>|</span><label class="collapse" for="c-40611806">[-]</label><label class="expand" for="c-40611806">[3 more]</label></div><br/><div class="children"><div class="content">This seems like something I wouldn&#x27;t want.  I already use fail2ban, which does exactly the same thing, in a more generic manner.  sshd is a security-sensitive piece of software, so ideally I want <i>less</i> code running in that process, not more.</div><br/><div id="40613080" class="c"><input type="checkbox" id="c-40613080" checked=""/><div class="controls bullet"><span class="by">akvadrako</span><span>|</span><a href="#40611806">parent</a><span>|</span><a href="#40613317">next</a><span>|</span><label class="collapse" for="c-40613080">[-]</label><label class="expand" for="c-40613080">[1 more]</label></div><br/><div class="children"><div class="content">The security sensitive parts of SSH run in a separate process. I would assume that most of the new code would be in the unprivileged part.</div><br/></div></div><div id="40613317" class="c"><input type="checkbox" id="c-40613317" checked=""/><div class="controls bullet"><span class="by">3abiton</span><span>|</span><a href="#40611806">parent</a><span>|</span><a href="#40613080">prev</a><span>|</span><a href="#40611318">next</a><span>|</span><label class="collapse" for="c-40613317">[-]</label><label class="expand" for="c-40613317">[1 more]</label></div><br/><div class="children"><div class="content">There is also endlessh, a very fun project to deploy</div><br/></div></div></div></div><div id="40611318" class="c"><input type="checkbox" id="c-40611318" checked=""/><div class="controls bullet"><span class="by">idoubtit</span><span>|</span><a href="#40611806">prev</a><span>|</span><a href="#40610760">next</a><span>|</span><label class="collapse" for="c-40611318">[-]</label><label class="expand" for="c-40611318">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve read the commit message in the post, and read it again, but I did not understand how it would be configured. The penalty system seems complex but only 2 parameters are mentioned.<p>From the documentation, one of these parameters is in fact a group of 8 parameters. I guess the separator is space, so one could write:<p><pre><code>    PerSourcePenalties authfail:1m noauth:5m grace-exceeded:5m min:2m
</code></pre>
See <a href="https:&#x2F;&#x2F;man.openbsd.org&#x2F;sshd_config.5#PerSourcePenalties" rel="nofollow">https:&#x2F;&#x2F;man.openbsd.org&#x2F;sshd_config.5#PerSourcePenalties</a><p>Unfortunately, the default values are undocumented. So `PerSourcePenalties yes` (which will be the default value, according to the blog post) will apply <i>some</i> penalties. I did attempt to read the source code, but I&#x27;m reluctant to install a CVS client, two decades after dropping that versioning system.</div><br/><div id="40611422" class="c"><input type="checkbox" id="c-40611422" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#40611318">parent</a><span>|</span><a href="#40611437">next</a><span>|</span><label class="collapse" for="c-40611422">[-]</label><label class="expand" for="c-40611422">[1 more]</label></div><br/><div class="children"><div class="content">The OpenBSD project provides a CVSWeb interface[1] and a GitHub mirror[2]. The portable OpenSSH project[2] that most of the world gets their OpenSSH from uses a Git repo[4] that also has a Web interface (at the same address) and a GitHub mirror[5]. Per the code there[6], the default configuration seems to be<p><pre><code>  PerSourcePenalties crash:90 authfail:5 noauth:1 grace-exceeded:20 max:600 min:15 max-sources:65536 overflow:permissive
</code></pre>
[1] <a href="https:&#x2F;&#x2F;cvsweb.openbsd.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;cvsweb.openbsd.org&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;openbsd&#x2F;src">https:&#x2F;&#x2F;github.com&#x2F;openbsd&#x2F;src</a><p>[3] <a href="https:&#x2F;&#x2F;www.openssh.com&#x2F;portable.html" rel="nofollow">https:&#x2F;&#x2F;www.openssh.com&#x2F;portable.html</a><p>[4] <a href="https:&#x2F;&#x2F;anongit.mindrot.org&#x2F;openssh.git" rel="nofollow">https:&#x2F;&#x2F;anongit.mindrot.org&#x2F;openssh.git</a><p>[5] <a href="https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable">https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable</a><p>[6] <a href="https:&#x2F;&#x2F;anongit.mindrot.org&#x2F;openssh.git&#x2F;tree&#x2F;servconf.c?id=0e0c69761a4c33ccd4a256560f522784a753d1a8#n443" rel="nofollow">https:&#x2F;&#x2F;anongit.mindrot.org&#x2F;openssh.git&#x2F;tree&#x2F;servconf.c?id=0...</a></div><br/></div></div><div id="40611437" class="c"><input type="checkbox" id="c-40611437" checked=""/><div class="controls bullet"><span class="by">jiripospisil</span><span>|</span><a href="#40611318">parent</a><span>|</span><a href="#40611422">prev</a><span>|</span><a href="#40610760">next</a><span>|</span><label class="collapse" for="c-40611437">[-]</label><label class="expand" for="c-40611437">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable&#x2F;commit&#x2F;81c1099d22b81ebfd20a334ce986c4f753b0db29#diff-06a27ce3ec94735e1b3de76e872c9a5a3643d87eb63f4b9dd688d27095abbf2aR415-R432">https:&#x2F;&#x2F;github.com&#x2F;openssh&#x2F;openssh-portable&#x2F;commit&#x2F;81c1099d2...</a></div><br/></div></div></div></div><div id="40610760" class="c"><input type="checkbox" id="c-40610760" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40611318">prev</a><span>|</span><a href="#40611169">next</a><span>|</span><label class="collapse" for="c-40610760">[-]</label><label class="expand" for="c-40610760">[13 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve seen MaxAuthTries used for similar reasons, and of course fail2ban, but this seems like a nice improvement and it&#x27;s built in which is probably a win in this case.</div><br/><div id="40611436" class="c"><input type="checkbox" id="c-40611436" checked=""/><div class="controls bullet"><span class="by">tomxor</span><span>|</span><a href="#40610760">parent</a><span>|</span><a href="#40610803">next</a><span>|</span><label class="collapse" for="c-40611436">[-]</label><label class="expand" for="c-40611436">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve used fail2ban in production for many years but eventually removed it due to causing very large iptables leading high memory use and ultimately a source of instability for other services (i.e it turns into a DDoS vulnerability for the whole server). I know the usual advice then is to reduce ban time and just not have permabanning, but that seems to kind of defeat the purpose.<p>I wonder how this SSH feature differs since it&#x27;s implemented at the SSH level.<p>So long as the SSH and or PAM config requires more than a password (I use hardware keys), the main concern to me is log noise (making it hard to identify targeted security threats) and SSH DDoS. I know tarpits and alternative ports are another way of dealing with that, but when SSH is used for many things having to change the port is kind of annoying.<p>I think I&#x27;m probably just going to end up layering it like everyone else and stick everything behind a wireguard gateway, although that concept makes me slightly anxious about that single point of access failure.</div><br/><div id="40611491" class="c"><input type="checkbox" id="c-40611491" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40611436">parent</a><span>|</span><a href="#40613739">next</a><span>|</span><label class="collapse" for="c-40611491">[-]</label><label class="expand" for="c-40611491">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;ve used fail2ban in production for many years but eventually removed it due to causing very large iptables leading high memory use and ultimately a source of instability for other services (i.e it turns into a DDoS vulnerability for the whole server). I know the usual advice then is to reduce ban time and just not have permabanning, but that seems to kind of defeat the purpose.<p>Didn&#x27;t the advice switch to using ipset a while back, precisely in the name of efficiency?</div><br/><div id="40611542" class="c"><input type="checkbox" id="c-40611542" checked=""/><div class="controls bullet"><span class="by">tomxor</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40611491">parent</a><span>|</span><a href="#40611524">next</a><span>|</span><label class="collapse" for="c-40611542">[-]</label><label class="expand" for="c-40611542">[1 more]</label></div><br/><div class="children"><div class="content">Interesting thanks, I hadn&#x27;t heard of that option.</div><br/></div></div></div></div><div id="40613739" class="c"><input type="checkbox" id="c-40613739" checked=""/><div class="controls bullet"><span class="by">yardstick</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40611436">parent</a><span>|</span><a href="#40611491">prev</a><span>|</span><a href="#40612537">next</a><span>|</span><label class="collapse" for="c-40613739">[-]</label><label class="expand" for="c-40613739">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like you were running SSH on the default port tcp&#x2F;22? I would expect attacks to exponentially drop off as soon as you move to a custom port.</div><br/></div></div><div id="40612537" class="c"><input type="checkbox" id="c-40612537" checked=""/><div class="controls bullet"><span class="by">KennyBlanken</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40611436">parent</a><span>|</span><a href="#40613739">prev</a><span>|</span><a href="#40610803">next</a><span>|</span><label class="collapse" for="c-40612537">[-]</label><label class="expand" for="c-40612537">[2 more]</label></div><br/><div class="children"><div class="content">&gt; causing very large iptables leading high memory use<p>&gt; I know the usual advice then is to reduce ban time and just not have permabanning, but that seems to kind of defeat the purpose.<p>The purpose is to make random password attempts even more impractical. With even fairly lax fail2ban rules, it&#x27;ll take multiple lifetimes to find a password made up of just two <i>common use</i> english words.<p>However, that&#x27;s not really their goal. I think that these SSH probes are mostly intended to find systems that have been compromised and have common backdoor passwords, though. ...and they use networks of zombie machines to do it.<p>That&#x27;s where stuff like Crowdsec and IP ban lists come in, with the side benefit of your IP addresses becoming less &#x27;visible&#x27;</div><br/><div id="40614910" class="c"><input type="checkbox" id="c-40614910" checked=""/><div class="controls bullet"><span class="by">tomxor</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40612537">parent</a><span>|</span><a href="#40610803">next</a><span>|</span><label class="collapse" for="c-40614910">[-]</label><label class="expand" for="c-40614910">[1 more]</label></div><br/><div class="children"><div class="content">&gt;&gt; I know the usual advice then is to reduce ban time and just not have permabanning, but that seems to kind of defeat the purpose.<p>&gt; The purpose is to make random password attempts even more impractical. With even fairly lax fail2ban rules, it&#x27;ll take multiple lifetimes to find a password made up of just two common use english words.<p>True, but the other reason to use such a measure is layered security. For instance I systematically disable all password only access, which kind of makes fail2ban seem a little pointless, but if there were to be some obscure bug in PAM, or SSH, or more likely a misconfiguration, then there is another layer that makes it more difficult.</div><br/></div></div></div></div></div></div><div id="40610803" class="c"><input type="checkbox" id="c-40610803" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#40610760">parent</a><span>|</span><a href="#40611436">prev</a><span>|</span><a href="#40611301">next</a><span>|</span><label class="collapse" for="c-40610803">[-]</label><label class="expand" for="c-40610803">[4 more]</label></div><br/><div class="children"><div class="content">It does seem to be very similar in spirit and implementation:<p>&gt; PerSourceNetBlockSize
&gt; Specifies the number of bits of source address that are grouped together for the purposes of applying PerSourceMaxStartups limits. Values for IPv4 and optionally IPv6 may be specified, separated by a colon. The default is 32:128, which means each address is considered individually.<p>Just like fail2ban, this seems like it can be equal parts helpful, a false sense of security, and a giant footgun.<p>For example, allowing n invalid login attempts per time interval and (v4) &#x2F;24 is not a big problem for botnet-based brute force attacks, while it&#x27;s very easy for somebody to get unintentionally locked out when connecting from behind a CG-NAT.</div><br/><div id="40610977" class="c"><input type="checkbox" id="c-40610977" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40610803">parent</a><span>|</span><a href="#40611301">next</a><span>|</span><label class="collapse" for="c-40610977">[-]</label><label class="expand" for="c-40610977">[3 more]</label></div><br/><div class="children"><div class="content">ufw&#x2F;iptables and other firewalls can also throttle repeated connection attempts, which is almost always fine but could be something you don&#x27;t want if you have a legitmate need to support many rapid ssh connections from the same source (CM tools, maybe?)</div><br/><div id="40611152" class="c"><input type="checkbox" id="c-40611152" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40610977">parent</a><span>|</span><a href="#40611301">next</a><span>|</span><label class="collapse" for="c-40611152">[-]</label><label class="expand" for="c-40611152">[2 more]</label></div><br/><div class="children"><div class="content">&gt; if you have a legitmate need to support many rapid ssh connections from the same source (CM tools, maybe?)<p>If you&#x27;re doing that, I strongly suggest using ControlMaster to reuse the connections; it makes security tools like this less grumpy, but it&#x27;s also a nice performance win.</div><br/><div id="40616029" class="c"><input type="checkbox" id="c-40616029" checked=""/><div class="controls bullet"><span class="by">aflukasz</span><span>|</span><a href="#40610760">root</a><span>|</span><a href="#40611152">parent</a><span>|</span><a href="#40611301">next</a><span>|</span><label class="collapse" for="c-40616029">[-]</label><label class="expand" for="c-40616029">[1 more]</label></div><br/><div class="children"><div class="content">Just remember that only first connection, the one creating ControlMaster socket, is being authenticated, subsequent ones are not.</div><br/></div></div></div></div></div></div></div></div><div id="40611301" class="c"><input type="checkbox" id="c-40611301" checked=""/><div class="controls bullet"><span class="by">tgv</span><span>|</span><a href="#40610760">parent</a><span>|</span><a href="#40610803">prev</a><span>|</span><a href="#40611169">next</a><span>|</span><label class="collapse" for="c-40611301">[-]</label><label class="expand" for="c-40611301">[1 more]</label></div><br/><div class="children"><div class="content">I managed one machine with such a mechanism, and I had to remove it, because it basically took all resources. I can&#x27;t remember which daemon it was, but now the machine is only accessible from a limited set of ip addresses.</div><br/></div></div></div></div><div id="40611169" class="c"><input type="checkbox" id="c-40611169" checked=""/><div class="controls bullet"><span class="by">ComodoHacker</span><span>|</span><a href="#40610760">prev</a><span>|</span><a href="#40612309">next</a><span>|</span><label class="collapse" for="c-40611169">[-]</label><label class="expand" for="c-40611169">[2 more]</label></div><br/><div class="children"><div class="content">Will it really help today, when anyone with any serious intent doesn&#x27;t launch their attacks from one or two standalone hosts, but buys botnet capacity?</div><br/><div id="40611846" class="c"><input type="checkbox" id="c-40611846" checked=""/><div class="controls bullet"><span class="by">verandaguy</span><span>|</span><a href="#40611169">parent</a><span>|</span><a href="#40612309">next</a><span>|</span><label class="collapse" for="c-40611846">[-]</label><label class="expand" for="c-40611846">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think this attempts to address botnet attacks, but to be fair, there are very few tools that you can just run on a single physical or VPS host that can effectively defend against a botnet. Frankly, most things that aren&#x27;t Cloudflare (or in the same ballpark) will be ineffective against well-crafted botnet attacks.<p>This is useful in a defence-in-depth scenario, same as fail2ban. You might be able to defeat the odd hacker or researcher doing recon on your host, and sometimes that&#x27;s good enough for you.<p>If you need botnet protection, you shop around for botnet protection providers, and you get a botnet protection solution. Easy as.</div><br/></div></div></div></div><div id="40612309" class="c"><input type="checkbox" id="c-40612309" checked=""/><div class="controls bullet"><span class="by">sleepydog</span><span>|</span><a href="#40611169">prev</a><span>|</span><a href="#40612878">next</a><span>|</span><label class="collapse" for="c-40612309">[-]</label><label class="expand" for="c-40612309">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not a fan of this feature. First, I don&#x27;t think it&#x27;s going to help all that much for the reasons other people have stated (it&#x27;s easy to obtain a new IP, and using ssh key-only remote login nullifies most attacks anyway).<p>More importantly, though, is that it is difficult to debug why you can&#x27;t login to a remote system, unless you&#x27;ve been diligent enough to setup remote logging and some kind of backdoor you can use in a pinch. I imagine many companies have some unimportant script running in the background that logs into a remote system over ssh, and the person who set it up left the company years ago. One password change&#x2F;key rotation later, and suddenly 25% of employees cannot login to that remote system because the script got one of the office&#x27;s 4 public IPv4 addresses blocked on the remote server.<p>It&#x27;s very easy to say &quot;you should manage your systems better, you should separate your networks better&quot;, and so on. But in my line of work (customer support), I only hear about the issue after people are already locked out. And I&#x27;ve been on many phone calls where users locked themselves out of their server that had fail2ban setup (ubuntu setup fail2ban by default in one of its releases).</div><br/></div></div><div id="40612878" class="c"><input type="checkbox" id="c-40612878" checked=""/><div class="controls bullet"><span class="by">enasterosophes</span><span>|</span><a href="#40612309">prev</a><span>|</span><a href="#40611930">next</a><span>|</span><label class="collapse" for="c-40612878">[-]</label><label class="expand" for="c-40612878">[3 more]</label></div><br/><div class="children"><div class="content">People keep mentioning fail2ban. I claim that both this new behavior in sshd, and fail2ban, are unprincipled approaches to security. Now, I know fail2ban is a crowd favorite, so let me explain what I mean by unprincipled.<p>This is the problem fail2ban (and now sshd) try to solve: I want a few people to log into my computer, so I open my computer to billions of other computers around the world and allow anyone to make a login attempt, and then I want to stop all the illegitimate attempts, after they were already able to access port 22.<p>It&#x27;s simple Bayesian probability that any attempt to head off all those illegitimate accesses will routinely result in situations where legitimate users are blocked just due to random mistakes rather than malicious intent. Meanwhile, illegitimate attempts continue to come en masse thanks to botnets, allowing anyone with an ssh exploit the chance to try their luck against your server.<p>A more principled approach to security is to not roll out the welcome mat in the first place. Instead of opening up sshd to the world, allowing anyone to try, and then blocking them, instead <i>don&#x27;t open up sshd to the world in the first place.</i><p>1. If possible, only permit logins from known and (relatively) trusted networks, or at least networks where you have some recourse if someone on the same network tries to attack you.<p>2. If access is needed from an untrusted network, use wireguard or similar, so sshd only needs to trust the wireguard connection. Any attempt at illegitimate access needs to crack both wireguard and ssh.<p>With those one or two simple measures in place, have another look at your sshd auth logs and marvel at the silence of no one trying to attack you a million times per day, while also having confidence that you will never accidentally lock yourself out.</div><br/><div id="40615705" class="c"><input type="checkbox" id="c-40615705" checked=""/><div class="controls bullet"><span class="by">marshray</span><span>|</span><a href="#40612878">parent</a><span>|</span><a href="#40611930">next</a><span>|</span><label class="collapse" for="c-40615705">[-]</label><label class="expand" for="c-40615705">[2 more]</label></div><br/><div class="children"><div class="content">1. Sure, there may be cases where you already know the source IP or network block. But there are many scenarios where your legitimate users may be traveling, or using a mobile provider that won&#x27;t guarantee much about the source IP. If you open your firewall too wide, a sophisticated attacker can find some box they can proxy through.<p>2. Doesn&#x27;t wireguard then have the same challenge as SSH? Isn&#x27;t that just pushing the problem around?<p>Another way to cut down on the log spam is by configuring sshd to listen on a nonstandard port.</div><br/><div id="40616086" class="c"><input type="checkbox" id="c-40616086" checked=""/><div class="controls bullet"><span class="by">aflukasz</span><span>|</span><a href="#40612878">root</a><span>|</span><a href="#40615705">parent</a><span>|</span><a href="#40611930">next</a><span>|</span><label class="collapse" for="c-40616086">[-]</label><label class="expand" for="c-40616086">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Doesn&#x27;t wireguard then have the same challenge as SSH? Isn&#x27;t that just pushing the problem around?<p>Yeah, it&#x27;s actually weird how frequently in those discussions people say some version of &quot;just use vpn&quot;. I guess they really mean &quot;just make someone else responsible&quot;.</div><br/></div></div></div></div></div></div><div id="40611930" class="c"><input type="checkbox" id="c-40611930" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#40612878">prev</a><span>|</span><a href="#40614746">next</a><span>|</span><label class="collapse" for="c-40611930">[-]</label><label class="expand" for="c-40611930">[2 more]</label></div><br/><div class="children"><div class="content">If these people don&#x27;t know what to do with themselves next that much, they should so something useful, like learn git, instead of implementing fail2ban-style features that nobody needs or wants in the software itself.<p>People who want this sort of thing and already have a single solution that handles multiple services have to complicate their setup in order to integrate this. They keep their existing solution for monitoring their web and mail server logs or whatever and then have this separate config to deal with for OpenSSH.<p>What if you don&#x27;t want to refuse connections that exhibit &quot;undesirable behavior&quot; but do something else, like become a black hole to that IP address, and perhaps others in the IP range?<p>You want the flexibility to script arbitrary actions when arbitrary events are observed.<p>In my log monitoring system (home grown), the rules are sensitive to whether the account being targeted is the superuser or not.</div><br/><div id="40612144" class="c"><input type="checkbox" id="c-40612144" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#40611930">parent</a><span>|</span><a href="#40614746">next</a><span>|</span><label class="collapse" for="c-40612144">[-]</label><label class="expand" for="c-40612144">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What if you don&#x27;t want to refuse connections that exhibit &quot;undesirable behavior&quot;<p>Then you disable the behavior by turning it off in &#x2F;etc&#x2F;ssh&#x2F;sshd_config.</div><br/></div></div></div></div><div id="40614746" class="c"><input type="checkbox" id="c-40614746" checked=""/><div class="controls bullet"><span class="by">password4321</span><span>|</span><a href="#40611930">prev</a><span>|</span><a href="#40612539">next</a><span>|</span><label class="collapse" for="c-40614746">[-]</label><label class="expand" for="c-40614746">[1 more]</label></div><br/><div class="children"><div class="content">I would like to see support for blocking by client identifier, though if it were a default all the bots would recompile libssh.<p>Until then this has been a great differentiator for Bitvise SSH.</div><br/></div></div><div id="40612539" class="c"><input type="checkbox" id="c-40612539" checked=""/><div class="controls bullet"><span class="by">nazgu1</span><span>|</span><a href="#40614746">prev</a><span>|</span><a href="#40612591">next</a><span>|</span><label class="collapse" for="c-40612539">[-]</label><label class="expand" for="c-40612539">[1 more]</label></div><br/><div class="children"><div class="content">Is it something that can replace fail2ban or sshguard?</div><br/></div></div><div id="40612591" class="c"><input type="checkbox" id="c-40612591" checked=""/><div class="controls bullet"><span class="by">gnufx</span><span>|</span><a href="#40612539">prev</a><span>|</span><a href="#40612625">next</a><span>|</span><label class="collapse" for="c-40612591">[-]</label><label class="expand" for="c-40612591">[2 more]</label></div><br/><div class="children"><div class="content">Do the people who are going on about fail2ban know whether that&#x27;s even ported to, and included in, OpenBSD? I suspect not.</div><br/><div id="40613688" class="c"><input type="checkbox" id="c-40613688" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#40612591">parent</a><span>|</span><a href="#40612625">next</a><span>|</span><label class="collapse" for="c-40613688">[-]</label><label class="expand" for="c-40613688">[1 more]</label></div><br/><div class="children"><div class="content">Nobody seems to have noticed that fail2ban is GPL, either.</div><br/></div></div></div></div><div id="40612625" class="c"><input type="checkbox" id="c-40612625" checked=""/><div class="controls bullet"><span class="by">textninja</span><span>|</span><a href="#40612591">prev</a><span>|</span><a href="#40612419">next</a><span>|</span><label class="collapse" for="c-40612625">[-]</label><label class="expand" for="c-40612625">[1 more]</label></div><br/><div class="children"><div class="content">A “SSHal credit score” tied to a pooled resource, yes, that will work out well! Kind of like how a used car purchase should come with all its tickets!<p>EDIT: To this feature’s credit, it’s not federated centrally, so a DDOS to nuke IP reputation would have its blast radius limited to the server(s) under attack.</div><br/></div></div><div id="40612419" class="c"><input type="checkbox" id="c-40612419" checked=""/><div class="controls bullet"><span class="by">semi</span><span>|</span><a href="#40612625">prev</a><span>|</span><a href="#40612343">next</a><span>|</span><label class="collapse" for="c-40612419">[-]</label><label class="expand" for="c-40612419">[1 more]</label></div><br/><div class="children"><div class="content">This is interesting but something i feel like id disable on most of my ssh servers as they are only exposed through a shared jump host, and I don&#x27;t want users that have too many keys in their agent to cause the jump host IP to be penalized.<p>On the jump host itself it makes sense though</div><br/></div></div><div id="40612343" class="c"><input type="checkbox" id="c-40612343" checked=""/><div class="controls bullet"><span class="by">a-dub</span><span>|</span><a href="#40612419">prev</a><span>|</span><a href="#40610882">next</a><span>|</span><label class="collapse" for="c-40612343">[-]</label><label class="expand" for="c-40612343">[1 more]</label></div><br/><div class="children"><div class="content">ip addresses are kinda meaningless these days, and address based accounting and penalization can penalize legitimate users.  (bitcoind has a banscore system, it&#x27;s kinda cute but these kinds of things tend to be bandaidy)<p>it&#x27;s a hard problem. wireguard has a pretty good attempt at it built into its handshaking protocol, but like all of these things, it&#x27;s not perfect.<p>could maybe do something interesting with hashcash stamps for client identity assertion (with some kind of temporal validity window).  so a client creates a hashcash stamped cookie that identifies itself for 30 minutes, and servers can do ban accounting based on said cookie.</div><br/></div></div><div id="40610882" class="c"><input type="checkbox" id="c-40610882" checked=""/><div class="controls bullet"><span class="by">Grimeton</span><span>|</span><a href="#40612343">prev</a><span>|</span><a href="#40614972">next</a><span>|</span><label class="collapse" for="c-40610882">[-]</label><label class="expand" for="c-40610882">[1 more]</label></div><br/><div class="children"><div class="content">pam-script with xt_recent works just fine.<p>Everytime when an authentication fails, you add the ip address to the xt_recent list in &#x2F;proc and in iptables you just check via --hits and --seconds and then reject the connection attempt the next time.</div><br/></div></div><div id="40614972" class="c"><input type="checkbox" id="c-40614972" checked=""/><div class="controls bullet"><span class="by">est</span><span>|</span><a href="#40610882">prev</a><span>|</span><a href="#40612702">next</a><span>|</span><label class="collapse" for="c-40614972">[-]</label><label class="expand" for="c-40614972">[1 more]</label></div><br/><div class="children"><div class="content">no penalize, just forward the tty to a honeypot and waste the attacker&#x27;s time. Any login would pass, but you have to figure out if the shell is real.</div><br/></div></div><div id="40612702" class="c"><input type="checkbox" id="c-40612702" checked=""/><div class="controls bullet"><span class="by">tonymet</span><span>|</span><a href="#40614972">prev</a><span>|</span><a href="#40610958">next</a><span>|</span><label class="collapse" for="c-40612702">[-]</label><label class="expand" for="c-40612702">[1 more]</label></div><br/><div class="children"><div class="content">Can you trigger a command when they are in the &quot;penalty box&quot; ? it would be nice to firewall those sources so they stop consuming sshd cpu</div><br/></div></div><div id="40610958" class="c"><input type="checkbox" id="c-40610958" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#40612702">prev</a><span>|</span><a href="#40614804">next</a><span>|</span><label class="collapse" for="c-40610958">[-]</label><label class="expand" for="c-40610958">[1 more]</label></div><br/><div class="children"><div class="content">Also here, didn&#x27;t gain much notice for some reason.<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40605449">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40605449</a></div><br/></div></div><div id="40614804" class="c"><input type="checkbox" id="c-40614804" checked=""/><div class="controls bullet"><span class="by">WhackyIdeas</span><span>|</span><a href="#40610958">prev</a><span>|</span><a href="#40611956">next</a><span>|</span><label class="collapse" for="c-40614804">[-]</label><label class="expand" for="c-40614804">[1 more]</label></div><br/><div class="children"><div class="content">Love it. Now I don’t even need to change the default port numbers to stop all of those damn log entries.<p>Wonder if this is related to why Fail2Ban wasn’t in the pkg repos when I last tried to install it on OpenBSD?<p>There is only one thing on my wish list from the OpenBSD devs out there - that you’ll figure out Nvidia drivers.</div><br/></div></div><div id="40611956" class="c"><input type="checkbox" id="c-40611956" checked=""/><div class="controls bullet"><span class="by">olooney</span><span>|</span><a href="#40614804">prev</a><span>|</span><a href="#40611995">next</a><span>|</span><label class="collapse" for="c-40611956">[-]</label><label class="expand" for="c-40611956">[1 more]</label></div><br/><div class="children"><div class="content">This reminds me of Zed Shaw&#x27;s Utu protocol from back in the day:<p><a href="https:&#x2F;&#x2F;weblog.masukomi.org&#x2F;2018&#x2F;03&#x2F;25&#x2F;zed-shaws-utu-saving-the-internet-with-hate&#x2F;" rel="nofollow">https:&#x2F;&#x2F;weblog.masukomi.org&#x2F;2018&#x2F;03&#x2F;25&#x2F;zed-shaws-utu-saving-...</a><p>I am not a crypto guy, but my understanding is that users can downvote each other, and the more downvotes a user gets the harder the proof-of-work problem they had to solve before they post. If you received enough hate, your CPU would spike for a couple of minutes each time you tried to post, thus disincentivizing bad behavior.<p>I see on github the project is officially dead now:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;zedshaw&#x2F;utu">https:&#x2F;&#x2F;github.com&#x2F;zedshaw&#x2F;utu</a></div><br/></div></div><div id="40611995" class="c"><input type="checkbox" id="c-40611995" checked=""/><div class="controls bullet"><span class="by">WhatIsDukkha</span><span>|</span><a href="#40611956">prev</a><span>|</span><a href="#40611661">next</a><span>|</span><label class="collapse" for="c-40611995">[-]</label><label class="expand" for="c-40611995">[1 more]</label></div><br/><div class="children"><div class="content">This seems like a bad fix to the problem of insisting that ssh continue to only use TCP.<p>Wireguard only responds to a complete useful key from incoming UDP (as I understand). Probe resistant.<p>I get the legacy argument here but it seems like almost two decades of &quot;this tcp thing has some downsides for this job&quot;?</div><br/></div></div><div id="40611661" class="c"><input type="checkbox" id="c-40611661" checked=""/><div class="controls bullet"><span class="by">gweinberg</span><span>|</span><a href="#40611995">prev</a><span>|</span><a href="#40611193">next</a><span>|</span><label class="collapse" for="c-40611661">[-]</label><label class="expand" for="c-40611661">[1 more]</label></div><br/><div class="children"><div class="content">If a client &quot;causes&quot; sshd to crash, isn&#x27;t that a server error?</div><br/></div></div><div id="40611193" class="c"><input type="checkbox" id="c-40611193" checked=""/><div class="controls bullet"><span class="by">juancn</span><span>|</span><a href="#40611661">prev</a><span>|</span><a href="#40611679">next</a><span>|</span><label class="collapse" for="c-40611193">[-]</label><label class="expand" for="c-40611193">[1 more]</label></div><br/><div class="children"><div class="content">This looks like an easy DDoS exploit waiting to happen.</div><br/></div></div><div id="40611679" class="c"><input type="checkbox" id="c-40611679" checked=""/><div class="controls bullet"><span class="by">pluc</span><span>|</span><a href="#40611193">prev</a><span>|</span><a href="#40612199">next</a><span>|</span><label class="collapse" for="c-40611679">[-]</label><label class="expand" for="c-40611679">[1 more]</label></div><br/><div class="children"><div class="content">So fail2ban?</div><br/></div></div><div id="40612199" class="c"><input type="checkbox" id="c-40612199" checked=""/><div class="controls bullet"><span class="by">opentokix</span><span>|</span><a href="#40611679">prev</a><span>|</span><a href="#40612548">next</a><span>|</span><label class="collapse" for="c-40612199">[-]</label><label class="expand" for="c-40612199">[1 more]</label></div><br/><div class="children"><div class="content">Chocker :D</div><br/></div></div><div id="40612548" class="c"><input type="checkbox" id="c-40612548" checked=""/><div class="controls bullet"><span class="by">cess11</span><span>|</span><a href="#40612199">prev</a><span>|</span><a href="#40611731">next</a><span>|</span><label class="collapse" for="c-40612548">[-]</label><label class="expand" for="c-40612548">[1 more]</label></div><br/><div class="children"><div class="content">So, like a crude fail2ban service?</div><br/></div></div><div id="40610907" class="c"><input type="checkbox" id="c-40610907" checked=""/><div class="controls bullet"><span class="by">idunnoman1222</span><span>|</span><a href="#40611731">prev</a><span>|</span><a href="#40612462">next</a><span>|</span><label class="collapse" for="c-40610907">[-]</label><label class="expand" for="c-40610907">[3 more]</label></div><br/><div class="children"><div class="content">It’s just fail2ban, should have been in core years ago</div><br/><div id="40610949" class="c"><input type="checkbox" id="c-40610949" checked=""/><div class="controls bullet"><span class="by">RockRobotRock</span><span>|</span><a href="#40610907">parent</a><span>|</span><a href="#40610913">next</a><span>|</span><label class="collapse" for="c-40610949">[-]</label><label class="expand" for="c-40610949">[1 more]</label></div><br/><div class="children"><div class="content">Did you forget to submit a patch for it?</div><br/></div></div></div></div><div id="40612462" class="c"><input type="checkbox" id="c-40612462" checked=""/><div class="controls bullet"><span class="by">kyrofa</span><span>|</span><a href="#40610907">prev</a><span>|</span><label class="collapse" for="c-40612462">[-]</label><label class="expand" for="c-40612462">[1 more]</label></div><br/><div class="children"><div class="content">Why are we building this into SSH itself? Isn&#x27;t this what things like fail2ban are for?</div><br/></div></div></div></div></div></div></div></body></html>