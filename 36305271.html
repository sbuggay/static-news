<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1686646858271" as="style"/><link rel="stylesheet" href="styles.css?v=1686646858271"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://hackcompute.com/hacking-epp-servers/">Hacking root EPP servers to take control of zones</a>Â <span class="domain">(<a href="https://hackcompute.com">hackcompute.com</a>)</span></div><div class="subtext"><span>iancarroll</span> | <span>13 comments</span></div><br/><div><div id="36306379" class="c"><input type="checkbox" id="c-36306379" checked=""/><div class="controls bullet"><span class="by">captn3m0</span><span>|</span><a href="#36306027">next</a><span>|</span><label class="collapse" for="c-36306379">[-]</label><label class="expand" for="c-36306379">[1 more]</label></div><br/><div class="children"><div class="content">This feels like it should be submitted to <a href="https:&#x2F;&#x2F;www.hackerone.com&#x2F;internet-bug-bounty" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.hackerone.com&#x2F;internet-bug-bounty</a>.</div><br/></div></div><div id="36306027" class="c"><input type="checkbox" id="c-36306027" checked=""/><div class="controls bullet"><span class="by">silisili</span><span>|</span><a href="#36306379">prev</a><span>|</span><a href="#36305639">next</a><span>|</span><label class="collapse" for="c-36306027">[-]</label><label class="expand" for="c-36306027">[4 more]</label></div><br/><div class="children"><div class="content">When I did EPP work at a registry, we did both mutual TLS(mentioned in passing) and strict firewalling.<p>Apologies if I missed it, but were they testing from a trusted source, or are some registries that wide open?</div><br/><div id="36306638" class="c"><input type="checkbox" id="c-36306638" checked=""/><div class="controls bullet"><span class="by">mike_d</span><span>|</span><a href="#36306027">parent</a><span>|</span><a href="#36306642">next</a><span>|</span><label class="collapse" for="c-36306638">[-]</label><label class="expand" for="c-36306638">[1 more]</label></div><br/><div class="children"><div class="content">I helped the authors with a little bit of background info on EPP.<p>Some registries are leaving their management systems open to the internet.</div><br/></div></div><div id="36306642" class="c"><input type="checkbox" id="c-36306642" checked=""/><div class="controls bullet"><span class="by">_notreallyme_</span><span>|</span><a href="#36306027">parent</a><span>|</span><a href="#36306638">prev</a><span>|</span><a href="#36305639">next</a><span>|</span><label class="collapse" for="c-36306642">[-]</label><label class="expand" for="c-36306642">[2 more]</label></div><br/><div class="children"><div class="content">Note that the command they use, poll, requires to login first, which means they also had some valid credentials somehow.<p>In addition, they seemed to have access to the source code, whereas the opensource version hasn&#x27;t been updated in more than 8 years.<p>Maybe this is the result of a whitebox security audit?</div><br/><div id="36307139" class="c"><input type="checkbox" id="c-36307139" checked=""/><div class="controls bullet"><span class="by">elp</span><span>|</span><a href="#36306027">root</a><span>|</span><a href="#36306642">parent</a><span>|</span><a href="#36305639">next</a><span>|</span><label class="collapse" for="c-36307139">[-]</label><label class="expand" for="c-36307139">[1 more]</label></div><br/><div class="children"><div class="content">Login is itself an XML command so in theory that could also be hacked.<p>Like @silisili said most of the registry operators require client certs and ips to go with the usernames but it is very possible that they are only checking that after getting a login.<p>CoCCA run by the tiny zones with no budgets. They are likely to be VERY vulnerable to this.</div><br/></div></div></div></div></div></div><div id="36305639" class="c"><input type="checkbox" id="c-36305639" checked=""/><div class="controls bullet"><span class="by">a5withtrrs</span><span>|</span><a href="#36306027">prev</a><span>|</span><a href="#36305604">next</a><span>|</span><label class="collapse" for="c-36305639">[-]</label><label class="expand" for="c-36305639">[3 more]</label></div><br/><div class="children"><div class="content">This is huge! You could control entire ccTLDs?</div><br/><div id="36305699" class="c"><input type="checkbox" id="c-36305699" checked=""/><div class="controls bullet"><span class="by">infosecau</span><span>|</span><a href="#36305639">parent</a><span>|</span><a href="#36305604">next</a><span>|</span><label class="collapse" for="c-36305699">[-]</label><label class="expand" for="c-36305699">[2 more]</label></div><br/><div class="children"><div class="content">Yes, as we were able to download the database for CoCCA&#x27;s web application (from the box.com backups) for any of the ccTLDs managed by CoCCA, we could decrypt the admin hash and then login to the CoCCA administration panel and modify&#x2F;transfer any domain inside a ccTLD&#x27;s zone.</div><br/><div id="36305806" class="c"><input type="checkbox" id="c-36305806" checked=""/><div class="controls bullet"><span class="by">qingcharles</span><span>|</span><a href="#36305639">root</a><span>|</span><a href="#36305699">parent</a><span>|</span><a href="#36305604">next</a><span>|</span><label class="collapse" for="c-36305806">[-]</label><label class="expand" for="c-36305806">[1 more]</label></div><br/><div class="children"><div class="content">The scale of possibilities with this hack are enormous. You could easily redirect entire domains, generate valid SSL certs for those domains, then capture all the data including all login credentials for all users on those domains.<p>With exploitation of the right domains you would probably be able to extend this hack using stolen authentication information to take over basically the entire Internet.<p>Funny hack of my own once: a major web hosting company had a forum which failed to check uploaded profile pics were images, so I used it to upload a script so I could browse their entire filesystem. I eventually came across their root password stored in plaintext in a configuration file. The password? &quot;internet&quot; - all lowercase, just like that.</div><br/></div></div></div></div></div></div><div id="36305604" class="c"><input type="checkbox" id="c-36305604" checked=""/><div class="controls bullet"><span class="by">gittiam</span><span>|</span><a href="#36305639">prev</a><span>|</span><label class="collapse" for="c-36305604">[-]</label><label class="expand" for="c-36305604">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve read through this article several times, and I am failing to see how this could possibly be used to form an attack.<p>Sure - taking the provider down is bad - but that happens due to unscheduled downtime every other day?</div><br/><div id="36305670" class="c"><input type="checkbox" id="c-36305670" checked=""/><div class="controls bullet"><span class="by">a5withtrrs</span><span>|</span><a href="#36305604">parent</a><span>|</span><a href="#36305703">next</a><span>|</span><label class="collapse" for="c-36305670">[-]</label><label class="expand" for="c-36305670">[1 more]</label></div><br/><div class="children"><div class="content">From the article:<p>&gt;&gt; Speaking with Vince (the administrator of the .ai zone) over WhatsApp, we confirmed that compromising this server would give us full control over any .ai domain:<p>&gt;&gt;  Once administrative access is gained to the CoCCA application, it is possible to control the nameservers for every domain for that ccTLD.<p>The point is to control domains in a ccTLD. Arbitrary domain hijacking is bad...</div><br/></div></div><div id="36305703" class="c"><input type="checkbox" id="c-36305703" checked=""/><div class="controls bullet"><span class="by">opello</span><span>|</span><a href="#36305604">parent</a><span>|</span><a href="#36305670">prev</a><span>|</span><a href="#36306042">next</a><span>|</span><label class="collapse" for="c-36305703">[-]</label><label class="expand" for="c-36305703">[1 more]</label></div><br/><div class="children"><div class="content">The screenshot of the WhatsApp conversation says they&#x27;d need admin on the web application. I agree it wasn&#x27;t clear if they&#x27;d gotten that.<p>Looks like it was via the backup files:<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36305699">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36305699</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>