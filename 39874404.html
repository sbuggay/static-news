<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711875653635" as="style"/><link rel="stylesheet" href="styles.css?v=1711875653635"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://git.tukaani.org/?p=xz.git;a=blobdiff;f=CMakeLists.txt;h=d2b1af7ab0ab759b6805ced3dff2555e2a4b3f8e;hp=76700591059711e3a4da5b45cf58474dac4e12a7;hb=328c52da8a2bbb81307644efdb58db2c422d9ba7;hpb=eb8ad59e9bab32a8d655796afd39597ea6dcc64d">Xz: Can you spot the single character that disabled Linux landlock?</a> <span class="domain">(<a href="https://git.tukaani.org">git.tukaani.org</a>)</span></div><div class="subtext"><span>dhx</span> | <span>196 comments</span></div><br/><div><div id="39874406" class="c"><input type="checkbox" id="c-39874406" checked=""/><div class="controls bullet"><span class="by">dhx</span><span>|</span><a href="#39880057">next</a><span>|</span><label class="collapse" for="c-39874406">[-]</label><label class="expand" for="c-39874406">[93 more]</label></div><br/><div class="children"><div class="content">Answer: <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=f9cf4c05edd...</a><p>Description of Linux&#x27;s Landlock access control system if you are not familiar with it: <a href="https:&#x2F;&#x2F;docs.kernel.org&#x2F;userspace-api&#x2F;landlock.html" rel="nofollow">https:&#x2F;&#x2F;docs.kernel.org&#x2F;userspace-api&#x2F;landlock.html</a><p>xz official (maybe...) incident response page: <a href="https:&#x2F;&#x2F;tukaani.org&#x2F;xz-backdoor&#x2F;" rel="nofollow">https:&#x2F;&#x2F;tukaani.org&#x2F;xz-backdoor&#x2F;</a></div><br/><div id="39874736" class="c"><input type="checkbox" id="c-39874736" checked=""/><div class="controls bullet"><span class="by">phoe-krk</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39880701">next</a><span>|</span><label class="collapse" for="c-39874736">[-]</label><label class="expand" for="c-39874736">[53 more]</label></div><br/><div class="children"><div class="content">So that function checked if the following C code compiled, and only in that situation enabled the landlock?<p>Except that lone period, hard to recognize because of its small size and proximity to the left edge of the diff, caused the C code to become always invalid, hence keeping the landlock always disabled?<p>That&#x27;s both vilely impressive and impressively vile. I didn&#x27;t even spot it on my first read-through.</div><br/><div id="39882532" class="c"><input type="checkbox" id="c-39882532" checked=""/><div class="controls bullet"><span class="by">dathinab</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874736">parent</a><span>|</span><a href="#39881006">next</a><span>|</span><label class="collapse" for="c-39882532">[-]</label><label class="expand" for="c-39882532">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s also iffy tbh. that the compilation check functionality:<p>- doesn&#x27;t force users to differentiate between syntax errors and other errors (e.g. symbols not found). Partially you can&#x27;t even make it work properly if you want due to C macros.<p>- it seems sensible, tbh. if &quot;does compile&quot; checks for compatibility seems sensible then there is so much wrong with the ecosystem in so many ways</div><br/></div></div><div id="39881006" class="c"><input type="checkbox" id="c-39881006" checked=""/><div class="controls bullet"><span class="by">patrakov</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874736">parent</a><span>|</span><a href="#39882532">prev</a><span>|</span><a href="#39875087">next</a><span>|</span><label class="collapse" for="c-39881006">[-]</label><label class="expand" for="c-39881006">[15 more]</label></div><br/><div class="children"><div class="content">Even more evil would have been to replace this line<p><pre><code>    (void)SYS_landlock_create_ruleset;
</code></pre>
with this:<p><pre><code>    (void)SYS_landloсk_create_ruleset;</code></pre></div><br/><div id="39882552" class="c"><input type="checkbox" id="c-39882552" checked=""/><div class="controls bullet"><span class="by">dathinab</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881006">parent</a><span>|</span><a href="#39881472">next</a><span>|</span><label class="collapse" for="c-39882552">[-]</label><label class="expand" for="c-39882552">[1 more]</label></div><br/><div class="children"><div class="content">After the concept of such attacks had blow up idk. 1?2?3? years ago a lot of places now warn at least when mixing &quot;languages&quot;&#x2F;ranges or sometimes on any usage of non us-ascii printable characters.<p>So stuff like that is increasingly more reliable caught.<p>Including by 3rd parties doing any ad-hoc scanning.<p>Through adding `compiles check` fail with syntax errors definitely should be added tot he list of auto scan checks, at least in C&#x2F;C++ (it&#x27;s not something you would do in most languages tbh. even in C it seems to be an antipatters).</div><br/></div></div><div id="39881472" class="c"><input type="checkbox" id="c-39881472" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881006">parent</a><span>|</span><a href="#39882552">prev</a><span>|</span><a href="#39881073">next</a><span>|</span><label class="collapse" for="c-39881472">[-]</label><label class="expand" for="c-39881472">[1 more]</label></div><br/><div class="children"><div class="content">Putting random Unicode confusables in source code would be far easier to consider malicious</div><br/></div></div><div id="39881073" class="c"><input type="checkbox" id="c-39881073" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881006">parent</a><span>|</span><a href="#39881472">prev</a><span>|</span><a href="#39881065">next</a><span>|</span><label class="collapse" for="c-39881073">[-]</label><label class="expand" for="c-39881073">[8 more]</label></div><br/><div class="children"><div class="content">For those squinting, the &quot;landlock&quot; regular &quot;c&quot; is replaced with a Cyrillic U+0441.</div><br/><div id="39881276" class="c"><input type="checkbox" id="c-39881276" checked=""/><div class="controls bullet"><span class="by">SV_BubbleTime</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881073">parent</a><span>|</span><a href="#39881065">next</a><span>|</span><label class="collapse" for="c-39881276">[-]</label><label class="expand" for="c-39881276">[7 more]</label></div><br/><div class="children"><div class="content">Is there a GCC option to error on non-standard English characters?</div><br/><div id="39881382" class="c"><input type="checkbox" id="c-39881382" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881276">parent</a><span>|</span><a href="#39882231">next</a><span>|</span><label class="collapse" for="c-39881382">[-]</label><label class="expand" for="c-39881382">[1 more]</label></div><br/><div class="children"><div class="content">Disclosure: I&#x27;ve got zero C&#x2F;C++ on my resume. I was asked to diagnose a kernel panic and backport kernel security patches once, but it was very uncomfortable. (&quot;Hey, Terr knows the build system, that&#x27;s close enough, right?&quot;)<p>That said, perhaps something like disabling the default -fextended-identifiers [0], and enabling the -Wbidi-chars [1] warning.<p>[0] <a href="https:&#x2F;&#x2F;gcc.gnu.org&#x2F;onlinedocs&#x2F;gcc&#x2F;Preprocessor-Options.html#index-fextended-identifiers" rel="nofollow">https:&#x2F;&#x2F;gcc.gnu.org&#x2F;onlinedocs&#x2F;gcc&#x2F;Preprocessor-Options.html...</a><p>[1] <a href="https:&#x2F;&#x2F;gcc.gnu.org&#x2F;onlinedocs&#x2F;gcc&#x2F;Warning-Options.html#index-Wbidi-chars_003d" rel="nofollow">https:&#x2F;&#x2F;gcc.gnu.org&#x2F;onlinedocs&#x2F;gcc&#x2F;Warning-Options.html#inde...</a></div><br/></div></div><div id="39882231" class="c"><input type="checkbox" id="c-39882231" checked=""/><div class="controls bullet"><span class="by">rurban</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881276">parent</a><span>|</span><a href="#39881382">prev</a><span>|</span><a href="#39882503">next</a><span>|</span><label class="collapse" for="c-39882231">[-]</label><label class="expand" for="c-39882231">[1 more]</label></div><br/><div class="children"><div class="content">Not yet. I was working on the standardization for C23, but this was postponed to C26, and has not much support. MSVC and SDCC liked it, CLANG and GC not so much.<p>Here is my bad variant of the feature, via confusables: <a href="https:&#x2F;&#x2F;github.com&#x2F;rurban&#x2F;gcc&#x2F;tree&#x2F;homoglyph-pr103027">https:&#x2F;&#x2F;github.com&#x2F;rurban&#x2F;gcc&#x2F;tree&#x2F;homoglyph-pr103027</a><p>The better variant would be to use my libu8ident, following UTR 39. I only did that for binutils.</div><br/></div></div><div id="39882503" class="c"><input type="checkbox" id="c-39882503" checked=""/><div class="controls bullet"><span class="by">fweimer</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881276">parent</a><span>|</span><a href="#39882231">prev</a><span>|</span><a href="#39881906">next</a><span>|</span><label class="collapse" for="c-39882503">[-]</label><label class="expand" for="c-39882503">[1 more]</label></div><br/><div class="children"><div class="content">The -fno-extended-identifiers option seems to do something in this area, but I don&#x27;t know if it is sufficient. But it may block some characters which are used in standard English (for some values of standard).</div><br/></div></div><div id="39881906" class="c"><input type="checkbox" id="c-39881906" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881276">parent</a><span>|</span><a href="#39882503">prev</a><span>|</span><a href="#39881065">next</a><span>|</span><label class="collapse" for="c-39881906">[-]</label><label class="expand" for="c-39881906">[3 more]</label></div><br/><div class="children"><div class="content">Error-ing is the point here and what the period achieved. It’s a feature detection snippet so if it fails to compile the feature is disabled.</div><br/><div id="39882056" class="c"><input type="checkbox" id="c-39882056" checked=""/><div class="controls bullet"><span class="by">rmast</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881906">parent</a><span>|</span><a href="#39881065">next</a><span>|</span><label class="collapse" for="c-39882056">[-]</label><label class="expand" for="c-39882056">[2 more]</label></div><br/><div class="children"><div class="content">It seems like there should be a way to catch these types of “bugs” - some form of dynamic analysis tool that extracts the feature detection code snippets and tries to compile them; if they fail for something like a syntax error, flag it as a broken check.<p>Expanding macros on different OSes could complicate things though, and determining what flags to build the feature check code with — so perhaps filtering based on the type of error would be best done as part of the build system functionality for doing the feature checking.</div><br/><div id="39882159" class="c"><input type="checkbox" id="c-39882159" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39882056">parent</a><span>|</span><a href="#39881065">next</a><span>|</span><label class="collapse" for="c-39882159">[-]</label><label class="expand" for="c-39882159">[1 more]</label></div><br/><div class="children"><div class="content">&gt; if they fail for something like a syntax error, flag it as a broken check.<p>A syntax error might be exactly what they’re looking for e.g. they’re feature testing a new bit of syntax or a compiler extension.<p>&gt; so perhaps filtering based on the type of error would be best done as part of the build system functionality for doing the feature checking.<p>Which would require every compiler to have detailed, consistent, and machine-readable failure reporting.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39881065" class="c"><input type="checkbox" id="c-39881065" checked=""/><div class="controls bullet"><span class="by">signa11</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881006">parent</a><span>|</span><a href="#39881073">prev</a><span>|</span><a href="#39875087">next</a><span>|</span><label class="collapse" for="c-39881065">[-]</label><label class="expand" for="c-39881065">[4 more]</label></div><br/><div class="children"><div class="content">compiler would perhaps &quot;see&quot; it ?</div><br/><div id="39881334" class="c"><input type="checkbox" id="c-39881334" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881065">parent</a><span>|</span><a href="#39875087">next</a><span>|</span><label class="collapse" for="c-39881334">[-]</label><label class="expand" for="c-39881334">[3 more]</label></div><br/><div class="children"><div class="content">Sure; but so long as the compiler error is silently discarded (as it is here), the configure script will assume landlock isn&#x27;t available and never use it.</div><br/><div id="39881677" class="c"><input type="checkbox" id="c-39881677" checked=""/><div class="controls bullet"><span class="by">smashed</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881334">parent</a><span>|</span><a href="#39875087">next</a><span>|</span><label class="collapse" for="c-39881677">[-]</label><label class="expand" for="c-39881677">[2 more]</label></div><br/><div class="children"><div class="content">A misplaced punctuation has some plausible deniability. Like the author could say he was distracted and fat fingered nonsense, honest mistake.<p>A utf character from a language that has zero chance of being mapped to your programmer&#x27;s keyboard in the middle of a code line, that would be obvious intentional tampering or at the very least raise some eyebrows.</div><br/><div id="39882544" class="c"><input type="checkbox" id="c-39882544" checked=""/><div class="controls bullet"><span class="by">yeputons</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881677">parent</a><span>|</span><a href="#39875087">next</a><span>|</span><label class="collapse" for="c-39882544">[-]</label><label class="expand" for="c-39882544">[1 more]</label></div><br/><div class="children"><div class="content">&gt; A utf character from a language that has zero chance of being mapped to your programmer&#x27;s keyboard in the middle of a code line, that would be obvious intentional tampering or at the very least raise some eyebrows.<p>I accidentally get Cyrillic &quot;с&quot; in my code few times a year. It&#x27;s on the same key as Latin &quot;c&quot;, so if I switch keyboard layout, I don&#x27;t notice until the compiler warns me.  Easy to do if I switch between chats and coding.  Now my habit is to always type a few characters in addition to &quot;c&quot; to check what layout I&#x27;m _really_ using.<p>Granted, it&#x27;s easier with a one-letter variable called &quot;c&quot;, but with longer names I can easily see myself not typing &quot;c&quot; the first time (e.g. not pressing hard enough), starting build, chatting in some windows, getting back, facepalming, &quot;fixing&quot; the error by adding &quot;c&quot; or &quot;с&quot; depending on my keyboard layout.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39875087" class="c"><input type="checkbox" id="c-39875087" checked=""/><div class="controls bullet"><span class="by">082349872349872</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874736">parent</a><span>|</span><a href="#39881006">prev</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39875087">[-]</label><label class="expand" for="c-39875087">[34 more]</label></div><br/><div class="children"><div class="content">I just got a little more respect for pythonic whitespace-sensitivity<p>EDIT: come to think of it, even that might not have done much here, where well-formedness <i>is</i> the issue :(</div><br/><div id="39875495" class="c"><input type="checkbox" id="c-39875495" checked=""/><div class="controls bullet"><span class="by">capitainenemo</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875087">parent</a><span>|</span><a href="#39879581">next</a><span>|</span><label class="collapse" for="c-39875495">[-]</label><label class="expand" for="c-39875495">[18 more]</label></div><br/><div class="children"><div class="content">Yeah, if anything, python worsens the situation.
I had a friend DOS our server because he accidentally inserted a tab, causing the illusion that one statement was inside a block but was actually outside it.
He swore off python at that point.
I personally avoid the language, but I understand due to issues like that these days mixing tabs and spaces is an error (or is it just a warning?) by default.  Regardless, still pretty silly to me to have whitespace play such a major significant role, besides the fact that I find it visually harder to read, like text without punctuation or capitalisation.</div><br/><div id="39875988" class="c"><input type="checkbox" id="c-39875988" checked=""/><div class="controls bullet"><span class="by">secstate</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875495">parent</a><span>|</span><a href="#39879515">next</a><span>|</span><label class="collapse" for="c-39875988">[-]</label><label class="expand" for="c-39875988">[7 more]</label></div><br/><div class="children"><div class="content">Mixing tabs and spaces usually throws a runtime exception. I&#x27;m not gonna make a value judgement about that, but your story doesn&#x27;t make sense based on how I understand py3<p>Edit, sorry, shoulda read your whole commebt before replying</div><br/><div id="39876104" class="c"><input type="checkbox" id="c-39876104" checked=""/><div class="controls bullet"><span class="by">capitainenemo</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875988">parent</a><span>|</span><a href="#39879515">next</a><span>|</span><label class="collapse" for="c-39876104">[-]</label><label class="expand" for="c-39876104">[6 more]</label></div><br/><div class="children"><div class="content">Yep. It was a few years ago while that was stilled allowed (as I&#x27;d noted ;) )  but regardless. Significant whitespace is just annoying.. There&#x27;s a lot of things that render as whitespace, and source code one might be reviewing could be printed wrapped or copied and pasted in odd ways.  Other languages are more robust to this.</div><br/><div id="39879634" class="c"><input type="checkbox" id="c-39879634" checked=""/><div class="controls bullet"><span class="by">_visgean</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39876104">parent</a><span>|</span><a href="#39880726">next</a><span>|</span><label class="collapse" for="c-39879634">[-]</label><label class="expand" for="c-39879634">[4 more]</label></div><br/><div class="children"><div class="content">Never had this happen, this is largely eliminated by using tools like black or other autoformatters.</div><br/><div id="39882312" class="c"><input type="checkbox" id="c-39882312" checked=""/><div class="controls bullet"><span class="by">MrDresden</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879634">parent</a><span>|</span><a href="#39880743">next</a><span>|</span><label class="collapse" for="c-39882312">[-]</label><label class="expand" for="c-39882312">[2 more]</label></div><br/><div class="children"><div class="content">The point still stands that this is an inherit possibility in the language it self.</div><br/><div id="39882425" class="c"><input type="checkbox" id="c-39882425" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39882312">parent</a><span>|</span><a href="#39880743">next</a><span>|</span><label class="collapse" for="c-39882425">[-]</label><label class="expand" for="c-39882425">[1 more]</label></div><br/><div class="children"><div class="content">Well, in C the visual indentation and the meaning of the code (given by {}) can diverge.  That&#x27;s even worse, and happens in practice.  Many style guidelines for C have evolved specifically to address that problem with &#x27;the language itself&#x27;.</div><br/></div></div></div></div><div id="39880743" class="c"><input type="checkbox" id="c-39880743" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879634">parent</a><span>|</span><a href="#39882312">prev</a><span>|</span><a href="#39880726">next</a><span>|</span><label class="collapse" for="c-39880743">[-]</label><label class="expand" for="c-39880743">[1 more]</label></div><br/><div class="children"><div class="content">And&#x2F;or linters.<p>This issue is no worse that having multiple different variables that look the same and only in their obscure same-looking unicode symbols.<p>A linter can handle this.  As can a decent font, or editor settings.</div><br/></div></div></div></div><div id="39880726" class="c"><input type="checkbox" id="c-39880726" checked=""/><div class="controls bullet"><span class="by">heavenlyblue</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39876104">parent</a><span>|</span><a href="#39879634">prev</a><span>|</span><a href="#39879515">next</a><span>|</span><label class="collapse" for="c-39880726">[-]</label><label class="expand" for="c-39880726">[1 more]</label></div><br/><div class="children"><div class="content">You can enable showing whitespace characters in your editor, in PyCharm they are visualised perfectly well as to not distract from the non-whitespace.</div><br/></div></div></div></div></div></div><div id="39879515" class="c"><input type="checkbox" id="c-39879515" checked=""/><div class="controls bullet"><span class="by">katbyte</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875495">parent</a><span>|</span><a href="#39875988">prev</a><span>|</span><a href="#39880986">next</a><span>|</span><label class="collapse" for="c-39879515">[-]</label><label class="expand" for="c-39879515">[8 more]</label></div><br/><div class="children"><div class="content">white space as a delimiter is why i never use python.</div><br/><div id="39879542" class="c"><input type="checkbox" id="c-39879542" checked=""/><div class="controls bullet"><span class="by">naikrovek</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879515">parent</a><span>|</span><a href="#39880986">next</a><span>|</span><label class="collapse" for="c-39879542">[-]</label><label class="expand" for="c-39879542">[7 more]</label></div><br/><div class="children"><div class="content">&gt; white space as a delimiter is why i never use python.<p>Whitespace is a delimiter in (almost?) all languages humans use.<p>Whitespace determining which scope you’re in is one of the many problems of making whitespace <i>significant</i>, which might be what you meant.</div><br/><div id="39879692" class="c"><input type="checkbox" id="c-39879692" checked=""/><div class="controls bullet"><span class="by">tomoyoirl</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879542">parent</a><span>|</span><a href="#39879910">next</a><span>|</span><label class="collapse" for="c-39879692">[-]</label><label class="expand" for="c-39879692">[3 more]</label></div><br/><div class="children"><div class="content">“The thing that controls scope is the count of certain nonprinting characters, which happen to come in multiple widths” is reasonably insane, yes</div><br/><div id="39880734" class="c"><input type="checkbox" id="c-39880734" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879692">parent</a><span>|</span><a href="#39879910">next</a><span>|</span><label class="collapse" for="c-39880734">[-]</label><label class="expand" for="c-39880734">[2 more]</label></div><br/><div class="children"><div class="content">Which non-printing characters are you talking about?  Whitespace characters are very much printable.<p>Yes, I agree that Python should just forbid tabs.  As a second best, you can tell your linter (and&#x2F;or formatter) to forbid tabs (and any weird unicode whitespace).  That&#x27;s basically the equivalent of compiling your C with -Wall.</div><br/><div id="39881994" class="c"><input type="checkbox" id="c-39881994" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880734">parent</a><span>|</span><a href="#39879910">next</a><span>|</span><label class="collapse" for="c-39881994">[-]</label><label class="expand" for="c-39881994">[1 more]</label></div><br/><div class="children"><div class="content">This was an issue in Python 2, where for some dumb reason it allowed mixing tabs and spaces and equated tab to 8 spaces (I think). Python 3 doesn&#x27;t have that issue.</div><br/></div></div></div></div></div></div><div id="39879910" class="c"><input type="checkbox" id="c-39879910" checked=""/><div class="controls bullet"><span class="by">ratmice</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879542">parent</a><span>|</span><a href="#39879692">prev</a><span>|</span><a href="#39881027">next</a><span>|</span><label class="collapse" for="c-39879910">[-]</label><label class="expand" for="c-39879910">[2 more]</label></div><br/><div class="children"><div class="content">Regarding your almost query. There was a debate over Ogham space mark in unicode.
It is considered whitespace though, with the rationale that it is sometimes visible, but sometimes invisible.  Depending upon whether the text has a stem-line.
That doesn&#x27;t make the set of non-whitespace delimited languages empty.
Perhaps there is one with an always-visible delimiter that didn&#x27;t get the whitespace justification, but does at least give one human language delimited by a printable character (which happens to be whitespace).</div><br/><div id="39880741" class="c"><input type="checkbox" id="c-39880741" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879910">parent</a><span>|</span><a href="#39881027">next</a><span>|</span><label class="collapse" for="c-39880741">[-]</label><label class="expand" for="c-39880741">[1 more]</label></div><br/><div class="children"><div class="content">&gt; That doesn&#x27;t make the set of non-whitespace delimited languages empty.<p>Well, there&#x27;s also the opposite: Goldman Sachs&#x27;s Slang allows space as part of identifiers.</div><br/></div></div></div></div><div id="39881027" class="c"><input type="checkbox" id="c-39881027" checked=""/><div class="controls bullet"><span class="by">WirelessGigabit</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879542">parent</a><span>|</span><a href="#39879910">prev</a><span>|</span><a href="#39880986">next</a><span>|</span><label class="collapse" for="c-39881027">[-]</label><label class="expand" for="c-39881027">[1 more]</label></div><br/><div class="children"><div class="content">Human language is also way more ambiguous. One of the reasons I love coding is a massively reduced vocabulary and a way more strict grammer.</div><br/></div></div></div></div></div></div><div id="39880986" class="c"><input type="checkbox" id="c-39880986" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875495">parent</a><span>|</span><a href="#39879515">prev</a><span>|</span><a href="#39879698">next</a><span>|</span><label class="collapse" for="c-39880986">[-]</label><label class="expand" for="c-39880986">[1 more]</label></div><br/><div class="children"><div class="content">humans are weird creatures sometimes. there was this bad thing that happened that won&#x27;t happen again now, but now I can&#x27;t use the thing forever because Reasons.</div><br/></div></div><div id="39879698" class="c"><input type="checkbox" id="c-39879698" checked=""/><div class="controls bullet"><span class="by">raverbashing</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875495">parent</a><span>|</span><a href="#39880986">prev</a><span>|</span><a href="#39879581">next</a><span>|</span><label class="collapse" for="c-39879698">[-]</label><label class="expand" for="c-39879698">[1 more]</label></div><br/><div class="children"><div class="content">Yes mixing tabs and spaces is a big no no and rightfully throws an error now</div><br/></div></div></div></div><div id="39879581" class="c"><input type="checkbox" id="c-39879581" checked=""/><div class="controls bullet"><span class="by">yegle</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875087">parent</a><span>|</span><a href="#39875495">prev</a><span>|</span><a href="#39879631">next</a><span>|</span><label class="collapse" for="c-39879581">[-]</label><label class="expand" for="c-39879581">[4 more]</label></div><br/><div class="children"><div class="content">In Python, you only need to indent the `def test_foo` by an additional whitespace, to make it a locally scoped function instead of a proper test function.</div><br/><div id="39880729" class="c"><input type="checkbox" id="c-39880729" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879581">parent</a><span>|</span><a href="#39879631">next</a><span>|</span><label class="collapse" for="c-39880729">[-]</label><label class="expand" for="c-39880729">[3 more]</label></div><br/><div class="children"><div class="content">No, not if you have any sane linter or formatter involved.  They wouldn&#x27;t let you get away with indenting by a single space, but only by multiples of whatever you normally use in the rest of your program.</div><br/><div id="39881162" class="c"><input type="checkbox" id="c-39881162" checked=""/><div class="controls bullet"><span class="by">jrockway</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880729">parent</a><span>|</span><a href="#39879631">next</a><span>|</span><label class="collapse" for="c-39881162">[-]</label><label class="expand" for="c-39881162">[2 more]</label></div><br/><div class="children"><div class="content">I mean, some CI system should be checking that &quot;if_code_compiles()&quot; blocks compile somewhere.  It should be an error until the CI system has that header and can test both variants.<p>People are really quick to add optionality like this without understanding the maintenance cost.  (Every boolean feature flag increases the number of variants you need to test by 2!)  Either make a decision, or check that both sides work.  Don&#x27;t let people check in dead code.</div><br/><div id="39882235" class="c"><input type="checkbox" id="c-39882235" checked=""/><div class="controls bullet"><span class="by">asddubs</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881162">parent</a><span>|</span><a href="#39879631">next</a><span>|</span><label class="collapse" for="c-39882235">[-]</label><label class="expand" for="c-39882235">[1 more]</label></div><br/><div class="children"><div class="content">multiplies it by 2, not increases</div><br/></div></div></div></div></div></div></div></div><div id="39879631" class="c"><input type="checkbox" id="c-39879631" checked=""/><div class="controls bullet"><span class="by">philsnow</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39875087">parent</a><span>|</span><a href="#39879581">prev</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39879631">[-]</label><label class="expand" for="c-39879631">[11 more]</label></div><br/><div class="children"><div class="content">AST diffs instead of textual diffs might have helped here (to spot the `.` making the code un-compilable).<p><i>Edit: oof, though the stray character in question is inside a perfectly legitimate C string, so to catch this, any such diffs would need to Matroyshka down and that seems unsolvable &#x2F; intractable.</i></div><br/><div id="39880757" class="c"><input type="checkbox" id="c-39880757" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879631">parent</a><span>|</span><a href="#39880656">next</a><span>|</span><label class="collapse" for="c-39880757">[-]</label><label class="expand" for="c-39880757">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Edit: oof, though the stray character in question is inside a perfectly legitimate C string, so to catch this, any such diffs would need to Matroyshka down and that seems unsolvable &#x2F; intractable.<p>Not sure, you could also just forbid code that&#x27;s too complex to analyse without going down a rabbit hole.  Instead of trying to go down the rabbit hole.<p>In general, it&#x27;s hard to analyse arbitrary code.  But we don&#x27;t have to allow arbitrarily complex code when doing code review.</div><br/></div></div><div id="39880656" class="c"><input type="checkbox" id="c-39880656" checked=""/><div class="controls bullet"><span class="by">mewpmewp2</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879631">parent</a><span>|</span><a href="#39880757">prev</a><span>|</span><a href="#39879679">next</a><span>|</span><label class="collapse" for="c-39880656">[-]</label><label class="expand" for="c-39880656">[2 more]</label></div><br/><div class="children"><div class="content">I think main issue was that it was embedded in the file itself like that. Would have preferred to have it in a separate valid C file with syntax highlighting etc and being parsed from that file.</div><br/><div id="39882173" class="c"><input type="checkbox" id="c-39882173" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880656">parent</a><span>|</span><a href="#39879679">next</a><span>|</span><label class="collapse" for="c-39882173">[-]</label><label class="expand" for="c-39882173">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps, but given how most build systems work, that would complicate things in other ways (since build systems often try to compile all .c files).</div><br/></div></div></div></div><div id="39879679" class="c"><input type="checkbox" id="c-39879679" checked=""/><div class="controls bullet"><span class="by">raverbashing</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879631">parent</a><span>|</span><a href="#39880656">prev</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39879679">[-]</label><label class="expand" for="c-39879679">[7 more]</label></div><br/><div class="children"><div class="content">Ah yes but thanks to C being cursed due to includes and macros this is harder to do</div><br/><div id="39879723" class="c"><input type="checkbox" id="c-39879723" checked=""/><div class="controls bullet"><span class="by">uecker</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879679">parent</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39879723">[-]</label><label class="expand" for="c-39879723">[6 more]</label></div><br/><div class="children"><div class="content">Huh, the code with a dot is not legal C. It is CMake issue that the test breaks here.</div><br/><div id="39880359" class="c"><input type="checkbox" id="c-39880359" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879723">parent</a><span>|</span><a href="#39880897">next</a><span>|</span><label class="collapse" for="c-39880359">[-]</label><label class="expand" for="c-39880359">[2 more]</label></div><br/><div class="children"><div class="content">That’s what makes this so clever: these systems were born in the era where you couldn’t trust anything - compilers sometimes emitted buggy code, operating systems would claim to be Unix but had weird inconsistencies on everything from system calls to command line tool arguments, etc. - so they just try to compile a test script and if it fails assume that the feature isn’t supported. This is extremely easy to miss since the tool is working as it’s designed and since it’s running tons of stuff there’s a ton of noise to sort through to realize that something which failed was supposed to have worked.</div><br/><div id="39882573" class="c"><input type="checkbox" id="c-39882573" checked=""/><div class="controls bullet"><span class="by">josefx</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880359">parent</a><span>|</span><a href="#39880897">next</a><span>|</span><label class="collapse" for="c-39882573">[-]</label><label class="expand" for="c-39882573">[1 more]</label></div><br/><div class="children"><div class="content">You could just run tests for the feature detection on a known system or a dozen(VMs are cheap). The big problem is that most code is not tested at all or test errors are flat out ignored.</div><br/></div></div></div></div><div id="39880897" class="c"><input type="checkbox" id="c-39880897" checked=""/><div class="controls bullet"><span class="by">hermitdev</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879723">parent</a><span>|</span><a href="#39880359">prev</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39880897">[-]</label><label class="expand" for="c-39880897">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s kind of the point. It&#x27;s feature detection code. If the code cleanly compiles, the feature is assumed supported, otherwise, it&#x27;s assumed not present&#x2F;functional. This pretty common with autotools. The gotcha here is this innocuous period is not supposed to be syntactically valid. It&#x27;s meant to be subtle and always disable the feature.</div><br/><div id="39881215" class="c"><input type="checkbox" id="c-39881215" checked=""/><div class="controls bullet"><span class="by">asvitkine</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880897">parent</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39881215">[-]</label><label class="expand" for="c-39881215">[2 more]</label></div><br/><div class="children"><div class="content">Shouldn&#x27;t whatever is depending on xz supporting landlock be verifying that it&#x27;s the case through blackbox tests or something? Otherwise a check like this even without the bug could end up disabling landlock if e.g. the compiler environment was such that a given header wasn&#x27;t available...</div><br/><div id="39881474" class="c"><input type="checkbox" id="c-39881474" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881215">parent</a><span>|</span><a href="#39875054">next</a><span>|</span><label class="collapse" for="c-39881474">[-]</label><label class="expand" for="c-39881474">[1 more]</label></div><br/><div class="children"><div class="content">Yes, this is intentionally how autoconf is supposed to work.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39875054" class="c"><input type="checkbox" id="c-39875054" checked=""/><div class="controls bullet"><span class="by">sidewndr46</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874736">parent</a><span>|</span><a href="#39875087">prev</a><span>|</span><a href="#39875620">next</a><span>|</span><label class="collapse" for="c-39875054">[-]</label><label class="expand" for="c-39875054">[1 more]</label></div><br/><div class="children"><div class="content">I agree. The way I read this, I missed it completely until I searched for it. I was looking too closely at the rest of the code around defines</div><br/></div></div></div></div><div id="39880701" class="c"><input type="checkbox" id="c-39880701" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39874736">prev</a><span>|</span><a href="#39875472">next</a><span>|</span><label class="collapse" for="c-39880701">[-]</label><label class="expand" for="c-39880701">[15 more]</label></div><br/><div class="children"><div class="content">This has plausible deniability on it.<p>There&#x27;s better ways to hide by swapping in Unicode lookalike characters. Some of them even pixel match depending on the font.<p>Maybe I&#x27;m out of the loop but is intentionality settled here?</div><br/><div id="39880742" class="c"><input type="checkbox" id="c-39880742" checked=""/><div class="controls bullet"><span class="by">n2d4</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880701">parent</a><span>|</span><a href="#39880737">next</a><span>|</span><label class="collapse" for="c-39880742">[-]</label><label class="expand" for="c-39880742">[11 more]</label></div><br/><div class="children"><div class="content">Unicode lookalikes would be detected by IDEs and other tools.<p>There would be plausible deniability in a different situation, but this is the same author who implemented the backdoor and several similar changes that disable security features. I don&#x27;t think the benefit of doubt is deserved here.</div><br/><div id="39880962" class="c"><input type="checkbox" id="c-39880962" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880742">parent</a><span>|</span><a href="#39881003">next</a><span>|</span><label class="collapse" for="c-39880962">[-]</label><label class="expand" for="c-39880962">[7 more]</label></div><br/><div class="children"><div class="content">Ok there&#x27;s a larger question here about the bazaar software development method.<p>How can we ensure say, that Microsoft doesn&#x27;t pay someone to throw a wrench in libre office development or Adobe to sabotage Gimp?<p>There&#x27;s lots of deception strategies for bad faith actors and given the paucity of people who actually do the work, it&#x27;s really really hard to be picky.<p>Especially with the complexity of library dependencies. Defect-at-a-distance may actually be a common strategy and this is the first that was caught</div><br/><div id="39881159" class="c"><input type="checkbox" id="c-39881159" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880962">parent</a><span>|</span><a href="#39881003">next</a><span>|</span><label class="collapse" for="c-39881159">[-]</label><label class="expand" for="c-39881159">[6 more]</label></div><br/><div class="children"><div class="content">&gt;How can we ensure say, that Microsoft doesn&#x27;t pay someone to throw a wrench in libre office development or Adobe to sabotage Gimp?<p>Microsoft and Adobe have reputations to uphold long into the future.<p>Is that infallible? Hell no it isn&#x27;t, but consider that Jia Tan only needed to uphold his reputation insofar as getting his backdoor onto everyone&#x27;s systems. Once that is done, his reputation or the lack thereof becomes a non-issue because his work is done. We&#x27;re lucky we caught him <i>just</i> before the finish line.<p>The likelihood of demonstrably reputable parties like Microsoft and Adobe poisoning the well is practically nil because they don&#x27;t have a finish line.</div><br/><div id="39881304" class="c"><input type="checkbox" id="c-39881304" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881159">parent</a><span>|</span><a href="#39881603">next</a><span>|</span><label class="collapse" for="c-39881304">[-]</label><label class="expand" for="c-39881304">[3 more]</label></div><br/><div class="children"><div class="content">Those companies are famous for skullduggery.<p>They can secure the dominance of their offering against the open source competition for well under 500k a year. It&#x27;s a no brainer.<p>What this might look like would be say, poorly discernable icons, clumsy UI design, or an unstable API that makes plugins constantly break. Large volumes of documentation that are inadequate or inaccurate in critical places, etc.<p>If I was malicious I&#x27;d pay someone to write otherwise functional code and bug fixes but make really user hostile decisions whenever possible.<p>We should be diligent for this in a few key projects. Tech companies could easily be doing this already.</div><br/><div id="39881623" class="c"><input type="checkbox" id="c-39881623" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881304">parent</a><span>|</span><a href="#39882001">next</a><span>|</span><label class="collapse" for="c-39881623">[-]</label><label class="expand" for="c-39881623">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Those companies are famous for skullduggery<p>There are levels of skull duggery. Hiring someone to pretend to work for a competitor while secretly sabotaging them is a whole other level of skullduggery with a lot of liability attached. I don&#x27;t think that would be worth it to them.</div><br/></div></div><div id="39882001" class="c"><input type="checkbox" id="c-39882001" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881304">parent</a><span>|</span><a href="#39881623">prev</a><span>|</span><a href="#39881603">next</a><span>|</span><label class="collapse" for="c-39882001">[-]</label><label class="expand" for="c-39882001">[1 more]</label></div><br/><div class="children"><div class="content">Well since you seemingly want to paint Microsoft and other such companies in a bad light, let me point out to you that it&#x27;s actually Microsoft who brought awareness to this very problem: Andres Freund works at Microsoft.[1][2]<p>It is probably prudent for you (and other like-minded individuals) to be more careful who you think your enemies really are. Infighting against friends and allies, or even neutral parties, is exactly what your real enemies would want you to do.<p>[1]: <a href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;andres-freund" rel="nofollow">https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;andres-freund</a><p>[2]: <a href="https:&#x2F;&#x2F;twitter.com&#x2F;AndresFreundTec" rel="nofollow">https:&#x2F;&#x2F;twitter.com&#x2F;AndresFreundTec</a></div><br/></div></div></div></div><div id="39881603" class="c"><input type="checkbox" id="c-39881603" checked=""/><div class="controls bullet"><span class="by">deckard1</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881159">parent</a><span>|</span><a href="#39881304">prev</a><span>|</span><a href="#39881003">next</a><span>|</span><label class="collapse" for="c-39881603">[-]</label><label class="expand" for="c-39881603">[2 more]</label></div><br/><div class="children"><div class="content">You say all this after recent documents were revealed about Facebook intercepting and analyzing Snapchat encrypted traffic via a man-in-the-middle conspiracy.</div><br/><div id="39881624" class="c"><input type="checkbox" id="c-39881624" checked=""/><div class="controls bullet"><span class="by">esafak</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881603">parent</a><span>|</span><a href="#39881003">next</a><span>|</span><label class="collapse" for="c-39881624">[-]</label><label class="expand" for="c-39881624">[1 more]</label></div><br/><div class="children"><div class="content">What kind of a reputation do you think Facebook has?</div><br/></div></div></div></div></div></div></div></div><div id="39881003" class="c"><input type="checkbox" id="c-39881003" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880742">parent</a><span>|</span><a href="#39880962">prev</a><span>|</span><a href="#39880737">next</a><span>|</span><label class="collapse" for="c-39881003">[-]</label><label class="expand" for="c-39881003">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure that an IDE will catch a syntax error in C code quoted inside a cmake script trying to test if things compile.</div><br/><div id="39881120" class="c"><input type="checkbox" id="c-39881120" checked=""/><div class="controls bullet"><span class="by">n2d4</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881003">parent</a><span>|</span><a href="#39881077">next</a><span>|</span><label class="collapse" for="c-39881120">[-]</label><label class="expand" for="c-39881120">[1 more]</label></div><br/><div class="children"><div class="content">A lot of IDE configurations, such as VSCode on the default config, highlight Unicode characters that are invisible&#x2F;look like others (eg. cyrillic characters or non-breaking space) or even all non-ASCII characters, regardless of whether they&#x27;re in a string or not.<p>Try pasting any of these into your IDE and see if it catches it. <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;StevenACoffman&#x2F;a5f6f682d94e38ed804182dc2693ed4b" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;StevenACoffman&#x2F;a5f6f682d94e38ed80418...</a></div><br/></div></div><div id="39881077" class="c"><input type="checkbox" id="c-39881077" checked=""/><div class="controls bullet"><span class="by">brailsafe</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881003">parent</a><span>|</span><a href="#39881120">prev</a><span>|</span><a href="#39880737">next</a><span>|</span><label class="collapse" for="c-39881077">[-]</label><label class="expand" for="c-39881077">[1 more]</label></div><br/><div class="children"><div class="content">In either case, it would appear as added code, not different characters in the same code, so maybe about the same. If someone changed one character in an existing string though, I think it would be more likely caught visually by someone used to seeing accidental garbage show up</div><br/></div></div></div></div></div></div><div id="39880737" class="c"><input type="checkbox" id="c-39880737" checked=""/><div class="controls bullet"><span class="by">zzzeek</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880701">parent</a><span>|</span><a href="#39880742">prev</a><span>|</span><a href="#39875472">next</a><span>|</span><label class="collapse" for="c-39880737">[-]</label><label class="expand" for="c-39880737">[3 more]</label></div><br/><div class="children"><div class="content">the period right there on the left edge?    if I saw that in a patch I&#x27;d be through the roof, that looks completely intentional</div><br/><div id="39880870" class="c"><input type="checkbox" id="c-39880870" checked=""/><div class="controls bullet"><span class="by">aeyes</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880737">parent</a><span>|</span><a href="#39880929">next</a><span>|</span><label class="collapse" for="c-39880870">[-]</label><label class="expand" for="c-39880870">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d never suspect this to be intentional if I&#x27;d spot it in a patch, even given the consequences in this particular case.
I have written and committed things into code instead of writing it into some other window several times. Without a linter I probably wouldn&#x27;t spot an extra dot when reviewing my own change before sending it out.</div><br/></div></div><div id="39880929" class="c"><input type="checkbox" id="c-39880929" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880737">parent</a><span>|</span><a href="#39880870">prev</a><span>|</span><a href="#39875472">next</a><span>|</span><label class="collapse" for="c-39880929">[-]</label><label class="expand" for="c-39880929">[1 more]</label></div><br/><div class="children"><div class="content">Not me. Maybe someone is using an editor with a . key mapped to something. It&#x27;s in a pretty convenient place.<p>:wq!</div><br/></div></div></div></div></div></div><div id="39875472" class="c"><input type="checkbox" id="c-39875472" checked=""/><div class="controls bullet"><span class="by">undebuggable</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39880701">prev</a><span>|</span><a href="#39880148">next</a><span>|</span><label class="collapse" for="c-39875472">[-]</label><label class="expand" for="c-39875472">[1 more]</label></div><br/><div class="children"><div class="content">This is so vile that even if caught red-handed during PR one could shrug off &quot;oh, my IDE&#x27;s auto formatting did this&quot;.</div><br/></div></div><div id="39880148" class="c"><input type="checkbox" id="c-39880148" checked=""/><div class="controls bullet"><span class="by">Aeolun</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39875472">prev</a><span>|</span><a href="#39879636">next</a><span>|</span><label class="collapse" for="c-39880148">[-]</label><label class="expand" for="c-39880148">[6 more]</label></div><br/><div class="children"><div class="content">I feel like my version control system is better about highlighting the changed characters than these solid green or red strings.</div><br/><div id="39881919" class="c"><input type="checkbox" id="c-39881919" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880148">parent</a><span>|</span><a href="#39880259">next</a><span>|</span><label class="collapse" for="c-39881919">[-]</label><label class="expand" for="c-39881919">[1 more]</label></div><br/><div class="children"><div class="content">It’s a giant block of new code, what is it supposed to do beyond tell you it’s a giant block of new code?<p>Note that this is C code inside if a cmake string, even if your diff can do highlighting the odds it would highlight that are low, and if it did highlighting is generally just lexing so there wouldn’t be much to show.</div><br/></div></div><div id="39880259" class="c"><input type="checkbox" id="c-39880259" checked=""/><div class="controls bullet"><span class="by">XorNot</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880148">parent</a><span>|</span><a href="#39881919">prev</a><span>|</span><a href="#39880165">next</a><span>|</span><label class="collapse" for="c-39880259">[-]</label><label class="expand" for="c-39880259">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t love unified diffs as a rule either. They&#x27;re very noisy to read in general.<p>A side by side in something like &quot;meld&quot; will highlight changes but also means you&#x27;re reading the full context as it will exist in the code base.<p>My number one complaint about &quot;code review&quot; is the number of people who simply run their eyes over the diff (in private orgs) because management says &quot;code review&quot; and that&#x27;s as far as they ever take that in terms of defining outcomes.</div><br/><div id="39880771" class="c"><input type="checkbox" id="c-39880771" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880259">parent</a><span>|</span><a href="#39880165">next</a><span>|</span><label class="collapse" for="c-39880771">[-]</label><label class="expand" for="c-39880771">[1 more]</label></div><br/><div class="children"><div class="content">I love unified diffs for many applications.  You are right that side by side diffs have their uses, too.</div><br/></div></div></div></div><div id="39880165" class="c"><input type="checkbox" id="c-39880165" checked=""/><div class="controls bullet"><span class="by">TheRealPomax</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880148">parent</a><span>|</span><a href="#39880259">prev</a><span>|</span><a href="#39879636">next</a><span>|</span><label class="collapse" for="c-39880165">[-]</label><label class="expand" for="c-39880165">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s git, so it <i>can</i> show a vastly better diff, just not from a URL with hardcoded diff settings.</div><br/><div id="39880253" class="c"><input type="checkbox" id="c-39880253" checked=""/><div class="controls bullet"><span class="by">Aeolun</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880165">parent</a><span>|</span><a href="#39879636">next</a><span>|</span><label class="collapse" for="c-39880253">[-]</label><label class="expand" for="c-39880253">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, but I’m wondering where the code review was done. In a different context, would this be easier to spot?</div><br/></div></div></div></div></div></div><div id="39879636" class="c"><input type="checkbox" id="c-39879636" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39880148">prev</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39879636">[-]</label><label class="expand" for="c-39879636">[8 more]</label></div><br/><div class="children"><div class="content">It seems like Lasse Collin is back on the scene and maybe pissed?</div><br/><div id="39882172" class="c"><input type="checkbox" id="c-39882172" checked=""/><div class="controls bullet"><span class="by">TLLtchvL8KZ</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879636">parent</a><span>|</span><a href="#39880347">next</a><span>|</span><label class="collapse" for="c-39882172">[-]</label><label class="expand" for="c-39882172">[1 more]</label></div><br/><div class="children"><div class="content">I worry about his home&#x2F;personal system, this guy seems to have befriended Lasse in order to get the position, is it possible Lasse himself has been compromised?<p>I&#x27;d be nuking everything, possibly even disposing of hardware and setting up a new verifiable online identity on a clean system&#x2F;hardware.</div><br/></div></div><div id="39880347" class="c"><input type="checkbox" id="c-39880347" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39879636">parent</a><span>|</span><a href="#39882172">prev</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39880347">[-]</label><label class="expand" for="c-39880347">[6 more]</label></div><br/><div class="children"><div class="content">If he is innocent and a victim as much as everyone else in all this, I won&#x27;t blame him for wanting blood.<p>Most of us are humans after all, and being social creatures we tend to take violations of trust quite deeply.</div><br/><div id="39880424" class="c"><input type="checkbox" id="c-39880424" checked=""/><div class="controls bullet"><span class="by">danielhlockard</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880347">parent</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39880424">[-]</label><label class="expand" for="c-39880424">[5 more]</label></div><br/><div class="children"><div class="content">Truly seems that way currently. He said he&#x27;d really dig in starting next week and just checked his email on vacation and saw this whole mess.</div><br/><div id="39880452" class="c"><input type="checkbox" id="c-39880452" checked=""/><div class="controls bullet"><span class="by">asveikau</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880424">parent</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39880452">[-]</label><label class="expand" for="c-39880452">[4 more]</label></div><br/><div class="children"><div class="content">It may be hard for him to re-establish trust. Maintaining xz for more than a decade then doing this would be quite a &quot;long con&quot; but if HN threads are any indication, many will still be suspicious.<p>His commits on these links look legit to me. It&#x27;s a sad situation for him if he wasn&#x27;t involved.</div><br/><div id="39882041" class="c"><input type="checkbox" id="c-39882041" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39880452">parent</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39882041">[-]</label><label class="expand" for="c-39882041">[3 more]</label></div><br/><div class="children"><div class="content">The fact GitHub suspended his account too suggests that they might have info saying he is involved.</div><br/><div id="39882580" class="c"><input type="checkbox" id="c-39882580" checked=""/><div class="controls bullet"><span class="by">sReinwald</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39882041">parent</a><span>|</span><a href="#39882214">next</a><span>|</span><label class="collapse" for="c-39882580">[-]</label><label class="expand" for="c-39882580">[1 more]</label></div><br/><div class="children"><div class="content">Personally, I doubt that. I would assume that GitHub just banned all accounts that were directly associated with the project as a precaution.</div><br/></div></div><div id="39882214" class="c"><input type="checkbox" id="c-39882214" checked=""/><div class="controls bullet"><span class="by">cricalix</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39882041">parent</a><span>|</span><a href="#39882580">prev</a><span>|</span><a href="#39874705">next</a><span>|</span><label class="collapse" for="c-39882214">[-]</label><label class="expand" for="c-39882214">[1 more]</label></div><br/><div class="children"><div class="content">Or you know, they just reacted with a ban hammer on all accounts related to xz and to heck with innocence.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="39874705" class="c"><input type="checkbox" id="c-39874705" checked=""/><div class="controls bullet"><span class="by">jstanley</span><span>|</span><a href="#39874406">parent</a><span>|</span><a href="#39879636">prev</a><span>|</span><a href="#39880057">next</a><span>|</span><label class="collapse" for="c-39874705">[-]</label><label class="expand" for="c-39874705">[9 more]</label></div><br/><div class="children"><div class="content">What does the dot do?</div><br/><div id="39874720" class="c"><input type="checkbox" id="c-39874720" checked=""/><div class="controls bullet"><span class="by">Aurornis</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874705">parent</a><span>|</span><a href="#39874723">next</a><span>|</span><label class="collapse" for="c-39874720">[-]</label><label class="expand" for="c-39874720">[5 more]</label></div><br/><div class="children"><div class="content">The function is “check_c_source_compiles”. The comment indicates that the intention is to confirm that the Landlock functionality can be compiled on the system, in which case it will be enabled.<p>The stray dot isn’t valid C, so it will never compile. By ensuring it can never compile, Landlock will never be enabled.</div><br/><div id="39881564" class="c"><input type="checkbox" id="c-39881564" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874720">parent</a><span>|</span><a href="#39874723">next</a><span>|</span><label class="collapse" for="c-39881564">[-]</label><label class="expand" for="c-39881564">[4 more]</label></div><br/><div class="children"><div class="content">configure would print that it&#x27;s not enabled, so it seems like the kind of thing people would eventually notice.</div><br/><div id="39882086" class="c"><input type="checkbox" id="c-39882086" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881564">parent</a><span>|</span><a href="#39881939">next</a><span>|</span><label class="collapse" for="c-39882086">[-]</label><label class="expand" for="c-39882086">[1 more]</label></div><br/><div class="children"><div class="content">Looks like he only introduced that &quot;bug&quot; in CMake. Was there migration in progress from autoconf to cmake?</div><br/></div></div><div id="39881939" class="c"><input type="checkbox" id="c-39881939" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881564">parent</a><span>|</span><a href="#39882086">prev</a><span>|</span><a href="#39874723">next</a><span>|</span><label class="collapse" for="c-39881939">[-]</label><label class="expand" for="c-39881939">[2 more]</label></div><br/><div class="children"><div class="content">Maybe, eventually, but how many people read the reams of garbage autoconf spouts out until the feature they wanted fails to materialize?</div><br/><div id="39882435" class="c"><input type="checkbox" id="c-39882435" checked=""/><div class="controls bullet"><span class="by">astrange</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881939">parent</a><span>|</span><a href="#39874723">next</a><span>|</span><label class="collapse" for="c-39882435">[-]</label><label class="expand" for="c-39882435">[1 more]</label></div><br/><div class="children"><div class="content">I used to and it&#x27;s actually how I got a large part of my computer skills, but unfortunately I got medicated for ADHD and became normal and can&#x27;t do it anymore.<p>But I still think reading boring logs is a great way to understand a system. Turning on all the intermediates for a compiler (llvm ghc etc) is very educational too.</div><br/></div></div></div></div></div></div></div></div><div id="39874723" class="c"><input type="checkbox" id="c-39874723" checked=""/><div class="controls bullet"><span class="by">thrtythreeforty</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874705">parent</a><span>|</span><a href="#39874720">prev</a><span>|</span><a href="#39880057">next</a><span>|</span><label class="collapse" for="c-39874723">[-]</label><label class="expand" for="c-39874723">[3 more]</label></div><br/><div class="children"><div class="content">Fails the build, so that Landlock support is never enabled.</div><br/><div id="39881575" class="c"><input type="checkbox" id="c-39881575" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39874723">parent</a><span>|</span><a href="#39880057">next</a><span>|</span><label class="collapse" for="c-39881575">[-]</label><label class="expand" for="c-39881575">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think it fails the build. It&#x27;s part of a test, trying to compile a bit of code. If it compiles the test is true and a certain feature is enabled. If the compilation fails the the feature is disabled.<p>This is quite common in build systems. I had such a test produce incorrect results in the kernel build system recently. The problem is that the tests should really look carefully for an expected error message. If the compilation fails with the expected message the test result is false. If the compilation fails for some other reason the build should fail so the developer is forced to investigate.<p>Disclaimer: I have not studied the xz build system in detail, just what I saw from the diff plus a bit of extrapolation.</div><br/><div id="39881854" class="c"><input type="checkbox" id="c-39881854" checked=""/><div class="controls bullet"><span class="by">akdev1l</span><span>|</span><a href="#39874406">root</a><span>|</span><a href="#39881575">parent</a><span>|</span><a href="#39880057">next</a><span>|</span><label class="collapse" for="c-39881854">[-]</label><label class="expand" for="c-39881854">[1 more]</label></div><br/><div class="children"><div class="content">It fails that small build that is testing for landlock functionality. Hence it doesn’t build the support for it.<p>It doesn’t fail the overall build.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39880057" class="c"><input type="checkbox" id="c-39880057" checked=""/><div class="controls bullet"><span class="by">rossjudson</span><span>|</span><a href="#39874406">prev</a><span>|</span><a href="#39880804">next</a><span>|</span><label class="collapse" for="c-39880057">[-]</label><label class="expand" for="c-39880057">[1 more]</label></div><br/><div class="children"><div class="content">There I am, scanning carefully, and I see a period where one clearly should not be. &quot;This wasn&#x27;t so hard&quot;, I said to myself.
I poked my screen, and the period moved.
Curse you, monitor dust particle.</div><br/></div></div><div id="39880804" class="c"><input type="checkbox" id="c-39880804" checked=""/><div class="controls bullet"><span class="by">fcanesin</span><span>|</span><a href="#39880057">prev</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880804">[-]</label><label class="expand" for="c-39880804">[16 more]</label></div><br/><div class="children"><div class="content">Geez, his last commit is making security reports worse: <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=af071ef7702debef4f1d324616a0137a5001c14c;hp=0b99783d63f27606936bb79a16c52d0d70c0b56f" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commitdiff;h=af071ef7702...</a></div><br/><div id="39880878" class="c"><input type="checkbox" id="c-39880878" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880804">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880878">[-]</label><label class="expand" for="c-39880878">[15 more]</label></div><br/><div class="children"><div class="content">Why is that accepted? Serious question</div><br/><div id="39882031" class="c"><input type="checkbox" id="c-39882031" checked=""/><div class="controls bullet"><span class="by">maxdamantus</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880878">parent</a><span>|</span><a href="#39881046">next</a><span>|</span><label class="collapse" for="c-39882031">[-]</label><label class="expand" for="c-39882031">[1 more]</label></div><br/><div class="children"><div class="content">Presumably because they&#x27;re one of the two maintainers: <a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20240329182607&#x2F;https:&#x2F;&#x2F;xz.tukaani.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20240329182607&#x2F;https:&#x2F;&#x2F;xz.tukaan...</a></div><br/></div></div><div id="39881046" class="c"><input type="checkbox" id="c-39881046" checked=""/><div class="controls bullet"><span class="by">kristjansson</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880878">parent</a><span>|</span><a href="#39882031">prev</a><span>|</span><a href="#39880900">next</a><span>|</span><label class="collapse" for="c-39881046">[-]</label><label class="expand" for="c-39881046">[7 more]</label></div><br/><div class="children"><div class="content">He had unfettered access to xz’s git?</div><br/><div id="39881082" class="c"><input type="checkbox" id="c-39881082" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881046">parent</a><span>|</span><a href="#39880900">next</a><span>|</span><label class="collapse" for="c-39881082">[-]</label><label class="expand" for="c-39881082">[6 more]</label></div><br/><div class="children"><div class="content">Isn’t it a bit ironic with how much code everyone depends on that can freely be altered by some unknown party, while so much time goes into code reviews to verify internal changes at most companies.</div><br/><div id="39881670" class="c"><input type="checkbox" id="c-39881670" checked=""/><div class="controls bullet"><span class="by">deckard1</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881082">parent</a><span>|</span><a href="#39882546">next</a><span>|</span><label class="collapse" for="c-39881670">[-]</label><label class="expand" for="c-39881670">[1 more]</label></div><br/><div class="children"><div class="content">you can have ten comments about the name of a variable, but no one bats an eye at a new npm package introduced. Also, devs that wrote code that Google depends on can&#x27;t pass the leetcode gate check to get a job there.<p>Our industry is a laughingstock.</div><br/></div></div><div id="39882546" class="c"><input type="checkbox" id="c-39882546" checked=""/><div class="controls bullet"><span class="by">2pEXgD0fZ5cF</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881082">parent</a><span>|</span><a href="#39881670">prev</a><span>|</span><a href="#39881468">next</a><span>|</span><label class="collapse" for="c-39882546">[-]</label><label class="expand" for="c-39882546">[1 more]</label></div><br/><div class="children"><div class="content">&gt; while so much time goes into code reviews to verify internal changes at most companies<p>Very easy claim to make. Difficult to verify.</div><br/></div></div><div id="39881468" class="c"><input type="checkbox" id="c-39881468" checked=""/><div class="controls bullet"><span class="by">cookiengineer</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881082">parent</a><span>|</span><a href="#39882546">prev</a><span>|</span><a href="#39882112">next</a><span>|</span><label class="collapse" for="c-39881468">[-]</label><label class="expand" for="c-39881468">[1 more]</label></div><br/><div class="children"><div class="content">Some might say RMS was right all along.</div><br/></div></div><div id="39882112" class="c"><input type="checkbox" id="c-39882112" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881082">parent</a><span>|</span><a href="#39881468">prev</a><span>|</span><a href="#39881743">next</a><span>|</span><label class="collapse" for="c-39882112">[-]</label><label class="expand" for="c-39882112">[1 more]</label></div><br/><div class="children"><div class="content">And he was in the project for just 2 years.</div><br/></div></div><div id="39881743" class="c"><input type="checkbox" id="c-39881743" checked=""/><div class="controls bullet"><span class="by">HideousKojima</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881082">parent</a><span>|</span><a href="#39882112">prev</a><span>|</span><a href="#39880900">next</a><span>|</span><label class="collapse" for="c-39881743">[-]</label><label class="expand" for="c-39881743">[1 more]</label></div><br/><div class="children"><div class="content">&gt;while so much time goes into code reviews to verify internal changes at most companies<p>Maybe at FAANGs, but I work at a massive company and code review is non-existent.</div><br/></div></div></div></div></div></div><div id="39880900" class="c"><input type="checkbox" id="c-39880900" checked=""/><div class="controls bullet"><span class="by">foooorsyth</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880878">parent</a><span>|</span><a href="#39881046">prev</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880900">[-]</label><label class="expand" for="c-39880900">[6 more]</label></div><br/><div class="children"><div class="content">Because nobody’s really paying attention.<p>“LGTM!”</div><br/><div id="39880923" class="c"><input type="checkbox" id="c-39880923" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880900">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880923">[-]</label><label class="expand" for="c-39880923">[5 more]</label></div><br/><div class="children"><div class="content">Generally yes, but ripping all conditions out of SECURITY.md should at least raise an eyebrow?</div><br/><div id="39880943" class="c"><input type="checkbox" id="c-39880943" checked=""/><div class="controls bullet"><span class="by">indrora</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880923">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880943">[-]</label><label class="expand" for="c-39880943">[4 more]</label></div><br/><div class="children"><div class="content">Nobody was watching. Plain and simple.<p>If you have commit access to it, and nobody is there to see, nothing stops you.</div><br/><div id="39880968" class="c"><input type="checkbox" id="c-39880968" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880943">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39880968">[-]</label><label class="expand" for="c-39880968">[3 more]</label></div><br/><div class="children"><div class="content">Yes but if that’s the sentiment how is this not as problematic as the npm ecosystem.</div><br/><div id="39881024" class="c"><input type="checkbox" id="c-39881024" checked=""/><div class="controls bullet"><span class="by">snazz</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39880968">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39881024">[-]</label><label class="expand" for="c-39881024">[2 more]</label></div><br/><div class="children"><div class="content">It’s similarly problematic but on a somewhat smaller scale and with fewer levels of nested dependencies.</div><br/><div id="39881109" class="c"><input type="checkbox" id="c-39881109" checked=""/><div class="controls bullet"><span class="by">eacapeisfutuile</span><span>|</span><a href="#39880804">root</a><span>|</span><a href="#39881024">parent</a><span>|</span><a href="#39875417">next</a><span>|</span><label class="collapse" for="c-39881109">[-]</label><label class="expand" for="c-39881109">[1 more]</label></div><br/><div class="children"><div class="content">I’m not sure this would be smaller scale? At least probably too early to tell?</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39875417" class="c"><input type="checkbox" id="c-39875417" checked=""/><div class="controls bullet"><span class="by">karmakaze</span><span>|</span><a href="#39880804">prev</a><span>|</span><a href="#39879726">next</a><span>|</span><label class="collapse" for="c-39875417">[-]</label><label class="expand" for="c-39875417">[10 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t believe that system security is dependent on such a loose chain of correctness. Any number of things could have stopped this.<p><pre><code>  +   # A compile check is done here because some systems have
  +   # linux&#x2F;landlock.h, but do not have the syscalls defined
  +   # in order to actually use Linux Landlock.
</code></pre>
Fix those headers on those systems to explicitly opt-out. What&#x27;s the point of headers if they don&#x27;t declare their capabilities?<p>Also why isn&#x27;t there a single test after a binary blob (even when compiled from open source) is made to ensure security is in-tact?<p>I wouldn&#x27;t even ship a website checkout without end-to-end tests for core capabilities. There must be a priority misalignment of adding features &gt; stability.<p>Edit: I hope the &#x27;fix&#x27; isn&#x27;t to remove the &#x27;.&#x27;--<i>I just saw the other post on HN that shows removing the &#x27;.&#x27;</i></div><br/><div id="39880845" class="c"><input type="checkbox" id="c-39880845" checked=""/><div class="controls bullet"><span class="by">Randalthorro</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39880436">next</a><span>|</span><label class="collapse" for="c-39880845">[-]</label><label class="expand" for="c-39880845">[1 more]</label></div><br/><div class="children"><div class="content">He introduced a whole new testing framework then slowly put a backdoor in it over 2 years</div><br/></div></div><div id="39880436" class="c"><input type="checkbox" id="c-39880436" checked=""/><div class="controls bullet"><span class="by">missblit</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39880845">prev</a><span>|</span><a href="#39880147">next</a><span>|</span><label class="collapse" for="c-39880436">[-]</label><label class="expand" for="c-39880436">[2 more]</label></div><br/><div class="children"><div class="content">You are quoting Jia Tan [1]. The malicious actor wrote that comment when deliberately breaking the check in the first place.<p>Fixing headers or extra tests would not have prevented this, as there is no indication the headers were broken in the first place, and extra tests could have been compromised (or ignored for release tarball) some other way.<p>[1] <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commit;h=328c52da8a2bbb81307644efdb58db2c422d9ba7" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commit;h=328c52da8a2bbb8...</a></div><br/><div id="39881360" class="c"><input type="checkbox" id="c-39881360" checked=""/><div class="controls bullet"><span class="by">manwe150</span><span>|</span><a href="#39875417">root</a><span>|</span><a href="#39880436">parent</a><span>|</span><a href="#39880147">next</a><span>|</span><label class="collapse" for="c-39881360">[-]</label><label class="expand" for="c-39881360">[1 more]</label></div><br/><div class="children"><div class="content">Should the better fix then to have been to revert the bad commit with the malicious commit message, rather than just deleting the dot (as was done)?</div><br/></div></div></div></div><div id="39880147" class="c"><input type="checkbox" id="c-39880147" checked=""/><div class="controls bullet"><span class="by">Hnrobert42</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39880436">prev</a><span>|</span><a href="#39881259">next</a><span>|</span><label class="collapse" for="c-39880147">[-]</label><label class="expand" for="c-39880147">[1 more]</label></div><br/><div class="children"><div class="content">As a user of open source who doesn’t know enough to make those suggestions, I would be grateful if you would develop and contribute them.</div><br/></div></div><div id="39881259" class="c"><input type="checkbox" id="c-39881259" checked=""/><div class="controls bullet"><span class="by">deathanatos</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39880147">prev</a><span>|</span><a href="#39876339">next</a><span>|</span><label class="collapse" for="c-39881259">[-]</label><label class="expand" for="c-39881259">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m pretty certain the comment isn&#x27;t accurate, and is just more subterfuge.</div><br/></div></div><div id="39876339" class="c"><input type="checkbox" id="c-39876339" checked=""/><div class="controls bullet"><span class="by">kardos</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39881259">prev</a><span>|</span><a href="#39880145">next</a><span>|</span><label class="collapse" for="c-39876339">[-]</label><label class="expand" for="c-39876339">[3 more]</label></div><br/><div class="children"><div class="content">Well, do we know if that commented code you quoted is accurate?</div><br/><div id="39877657" class="c"><input type="checkbox" id="c-39877657" checked=""/><div class="controls bullet"><span class="by">karmakaze</span><span>|</span><a href="#39875417">root</a><span>|</span><a href="#39876339">parent</a><span>|</span><a href="#39880145">next</a><span>|</span><label class="collapse" for="c-39877657">[-]</label><label class="expand" for="c-39877657">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s the content of TFA, so flag it if you believe it isn&#x27;t.</div><br/><div id="39878362" class="c"><input type="checkbox" id="c-39878362" checked=""/><div class="controls bullet"><span class="by">kardos</span><span>|</span><a href="#39875417">root</a><span>|</span><a href="#39877657">parent</a><span>|</span><a href="#39880145">next</a><span>|</span><label class="collapse" for="c-39878362">[-]</label><label class="expand" for="c-39878362">[1 more]</label></div><br/><div class="children"><div class="content">Yes that is what I mean -- the commit in TFA is from the bad actor -- so the quoted comment is suspect..</div><br/></div></div></div></div></div></div><div id="39880145" class="c"><input type="checkbox" id="c-39880145" checked=""/><div class="controls bullet"><span class="by">pas</span><span>|</span><a href="#39875417">parent</a><span>|</span><a href="#39876339">prev</a><span>|</span><a href="#39879726">next</a><span>|</span><label class="collapse" for="c-39880145">[-]</label><label class="expand" for="c-39880145">[1 more]</label></div><br/><div class="children"><div class="content">... there&#x27;s a huge bias in things that get tested (and how they get tested). easy to test things get tested. there&#x27;s a lot more developer, committer, maintainer for web stuff. there&#x27;s a cultural issue, it&#x27;s hard to improve on old ossified processes&#x2F;projects, etc.</div><br/></div></div></div></div><div id="39879726" class="c"><input type="checkbox" id="c-39879726" checked=""/><div class="controls bullet"><span class="by">trelane</span><span>|</span><a href="#39875417">prev</a><span>|</span><a href="#39881632">next</a><span>|</span><label class="collapse" for="c-39879726">[-]</label><label class="expand" for="c-39879726">[5 more]</label></div><br/><div class="children"><div class="content">I wonder why it was useful to prevent Landlock from being enabled in xz. Perhaps a later stage was to inject malicious content into xz archives? But then why not just inject malicious activity in xz itself?</div><br/><div id="39879921" class="c"><input type="checkbox" id="c-39879921" checked=""/><div class="controls bullet"><span class="by">ColonelPhantom</span><span>|</span><a href="#39879726">parent</a><span>|</span><a href="#39880102">next</a><span>|</span><label class="collapse" for="c-39879921">[-]</label><label class="expand" for="c-39879921">[3 more]</label></div><br/><div class="children"><div class="content">Because a deliberate vulnerability is much easier to hide than actual malicious content.<p>One could probably sneak a buffer overflow or use-after-free into a C project they maintain without being noticed. Actually shipping a trojan is much harder, as observed with the xz-to-sshd backdoor.</div><br/><div id="39880238" class="c"><input type="checkbox" id="c-39880238" checked=""/><div class="controls bullet"><span class="by">trelane</span><span>|</span><a href="#39879726">root</a><span>|</span><a href="#39879921">parent</a><span>|</span><a href="#39880102">next</a><span>|</span><label class="collapse" for="c-39880238">[-]</label><label class="expand" for="c-39880238">[2 more]</label></div><br/><div class="children"><div class="content">Ah, so the next stage would have been to add a &quot;bug&quot; in xz that would trigger during the supposedly sandboxed execution, when presented with certain input files. Clever.</div><br/><div id="39880867" class="c"><input type="checkbox" id="c-39880867" checked=""/><div class="controls bullet"><span class="by">puetzk</span><span>|</span><a href="#39879726">root</a><span>|</span><a href="#39880238">parent</a><span>|</span><a href="#39880102">next</a><span>|</span><label class="collapse" for="c-39880867">[-]</label><label class="expand" for="c-39880867">[1 more]</label></div><br/><div class="children"><div class="content">Well, is also quite possible that adding such a bug was the previous stage. Or even just having found one that you didn&#x27;t report&#x2F;fix...</div><br/></div></div></div></div></div></div><div id="39880102" class="c"><input type="checkbox" id="c-39880102" checked=""/><div class="controls bullet"><span class="by">A1kmm</span><span>|</span><a href="#39879726">parent</a><span>|</span><a href="#39879921">prev</a><span>|</span><a href="#39881632">next</a><span>|</span><label class="collapse" for="c-39880102">[-]</label><label class="expand" for="c-39880102">[1 more]</label></div><br/><div class="children"><div class="content">Unless there are more subtle backdoors that target xz itself beyond the targeting of ssh. Clearly the aim was to be subtle.</div><br/></div></div></div></div><div id="39881632" class="c"><input type="checkbox" id="c-39881632" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#39879726">prev</a><span>|</span><a href="#39880740">next</a><span>|</span><label class="collapse" for="c-39881632">[-]</label><label class="expand" for="c-39881632">[7 more]</label></div><br/><div class="children"><div class="content">Where&#x2F;how was landlock supposed to be used?<p>I guess you cannot really use it in a generic library like compression&#x2F;decompression. The library has no clue what the program is supposed to do and what should be restricted.<p>For a program it might be clearer.<p>The sshd attack was using liblzma as a library. So disabling landlock seems unrelated? A sign that there is more bad code waiting to be detected &#x2F; had been planned to be inserted???</div><br/><div id="39881866" class="c"><input type="checkbox" id="c-39881866" checked=""/><div class="controls bullet"><span class="by">akdev1l</span><span>|</span><a href="#39881632">parent</a><span>|</span><a href="#39881668">next</a><span>|</span><label class="collapse" for="c-39881866">[-]</label><label class="expand" for="c-39881866">[4 more]</label></div><br/><div class="children"><div class="content">Presumably sshd itself used to lock down its own capabilities after a certain point of execution.<p>Removing the landlock means the daemon doesn’t lock itself down and will allow for better payload execution when they get to the exploitation stage.<p>I don’t think these two things are unrelated. I think they already had payloads in mind and realized this would be a hurdle.</div><br/><div id="39882319" class="c"><input type="checkbox" id="c-39882319" checked=""/><div class="controls bullet"><span class="by">usr1106</span><span>|</span><a href="#39881632">root</a><span>|</span><a href="#39881866">parent</a><span>|</span><a href="#39882054">next</a><span>|</span><label class="collapse" for="c-39882319">[-]</label><label class="expand" for="c-39882319">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s pretty impossible to lock down sshd. The restrictions are inherited by all ancestors. What would the sysadmin say if they find themselves in a restricted shell?</div><br/></div></div><div id="39882054" class="c"><input type="checkbox" id="c-39882054" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#39881632">root</a><span>|</span><a href="#39881866">parent</a><span>|</span><a href="#39882319">prev</a><span>|</span><a href="#39881978">next</a><span>|</span><label class="collapse" for="c-39882054">[-]</label><label class="expand" for="c-39882054">[1 more]</label></div><br/><div class="children"><div class="content">No. OpenSSH doesn&#x27;t use Landlock, and even if it did, this patch wouldn&#x27;t affect it.</div><br/></div></div></div></div><div id="39881668" class="c"><input type="checkbox" id="c-39881668" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39881632">parent</a><span>|</span><a href="#39881866">prev</a><span>|</span><a href="#39880740">next</a><span>|</span><label class="collapse" for="c-39881668">[-]</label><label class="expand" for="c-39881668">[2 more]</label></div><br/><div class="children"><div class="content">Its weird. Like i would consider doing two unrelated backdoor-esque things in the same project really sloopy. Seems like it just significantly increases the risk of being discovered for minimal gain.<p>Its very confusing. Parts of this sega seem incredibly sophisticated while other parts seem kind of sloppy.</div><br/><div id="39882153" class="c"><input type="checkbox" id="c-39882153" checked=""/><div class="controls bullet"><span class="by">kijin</span><span>|</span><a href="#39881632">root</a><span>|</span><a href="#39881668">parent</a><span>|</span><a href="#39880740">next</a><span>|</span><label class="collapse" for="c-39882153">[-]</label><label class="expand" for="c-39882153">[1 more]</label></div><br/><div class="children"><div class="content">Dude is a developer just like the rest of us. We all try to write clever code from time to time, but at other times write sloppy crap. Especially if there&#x27;s a boss insisting on a tight deadline.</div><br/></div></div></div></div></div></div><div id="39880740" class="c"><input type="checkbox" id="c-39880740" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#39881632">prev</a><span>|</span><a href="#39879879">next</a><span>|</span><label class="collapse" for="c-39880740">[-]</label><label class="expand" for="c-39880740">[6 more]</label></div><br/><div class="children"><div class="content">On an unrelated note, this malware team has assembled a great dataset for training AIs on identifying security problems. Every commit has some security problem, and the open source community will be going through and identifying them. (Thanks, maintainers, for the cleanup work; definitely not fun!)</div><br/><div id="39881647" class="c"><input type="checkbox" id="c-39881647" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39880740">parent</a><span>|</span><a href="#39880848">next</a><span>|</span><label class="collapse" for="c-39881647">[-]</label><label class="expand" for="c-39881647">[1 more]</label></div><br/><div class="children"><div class="content">I doubt it will generalize well. At best its just an arms race.</div><br/></div></div><div id="39880848" class="c"><input type="checkbox" id="c-39880848" checked=""/><div class="controls bullet"><span class="by">luyu_wu</span><span>|</span><a href="#39880740">parent</a><span>|</span><a href="#39881647">prev</a><span>|</span><a href="#39881442">next</a><span>|</span><label class="collapse" for="c-39880848">[-]</label><label class="expand" for="c-39880848">[2 more]</label></div><br/><div class="children"><div class="content">One of the cooler uses of AI I&#x27;ve seen!</div><br/><div id="39881075" class="c"><input type="checkbox" id="c-39881075" checked=""/><div class="controls bullet"><span class="by">wizzwizz4</span><span>|</span><a href="#39880740">root</a><span>|</span><a href="#39880848">parent</a><span>|</span><a href="#39881442">next</a><span>|</span><label class="collapse" for="c-39881075">[-]</label><label class="expand" for="c-39881075">[1 more]</label></div><br/><div class="children"><div class="content">Currently it doesn&#x27;t work, but yeah, it&#x27;ll be really cool when we have tech like that! (It&#x27;ll still only be able to detect <i>known</i> vulnerabilities, but we don&#x27;t often invent new ones.)</div><br/></div></div></div></div><div id="39881442" class="c"><input type="checkbox" id="c-39881442" checked=""/><div class="controls bullet"><span class="by">chilling</span><span>|</span><a href="#39880740">parent</a><span>|</span><a href="#39880848">prev</a><span>|</span><a href="#39879879">next</a><span>|</span><label class="collapse" for="c-39881442">[-]</label><label class="expand" for="c-39881442">[2 more]</label></div><br/><div class="children"><div class="content">I hear this stuff for the first time, can you post some info about that?</div><br/><div id="39882310" class="c"><input type="checkbox" id="c-39882310" checked=""/><div class="controls bullet"><span class="by">CGamesPlay</span><span>|</span><a href="#39880740">root</a><span>|</span><a href="#39881442">parent</a><span>|</span><a href="#39879879">next</a><span>|</span><label class="collapse" for="c-39882310">[-]</label><label class="expand" for="c-39882310">[1 more]</label></div><br/><div class="children"><div class="content">Like in this article, we have a patch that introduces a security flaw (disabling landlock). We later have a patch that fixes it, specifically. The job of the LLM is to reproduce the fixing patch given the problem patch. Or at the very least, explain that this patch results in landlock always being disabled. To be clear, this problem is much, much harder than the problems LLMs are solving now, requiring knowledge of autotools behavior that isn’t included in the context (identifying that a failed build disables the feature, and that this build always fails).<p>There was another example where this team submitted a patch that swapped safe_fprintf for fprintf while adding some additional behavior. It was later pointed out that this allows printing invisible characters to the stream, which allows hiding some of the files that are placed when decompressing.</div><br/></div></div></div></div></div></div><div id="39879879" class="c"><input type="checkbox" id="c-39879879" checked=""/><div class="controls bullet"><span class="by">clnhlzmn</span><span>|</span><a href="#39880740">prev</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39879879">[-]</label><label class="expand" for="c-39879879">[9 more]</label></div><br/><div class="children"><div class="content">Would it be reasonable to expect that this MR comes along with a test that shows that it does the thing it’s claiming to do? I’m not sure how that would work in this case.. have a test that is run on a system that is known to have landlock that does something to ensure that it’s enabled? Even that could be subverted, but it seems like demanding that kind of thing before merging “features” is a good step.</div><br/><div id="39879998" class="c"><input type="checkbox" id="c-39879998" checked=""/><div class="controls bullet"><span class="by">masspro</span><span>|</span><a href="#39879879">parent</a><span>|</span><a href="#39879981">next</a><span>|</span><label class="collapse" for="c-39879998">[-]</label><label class="expand" for="c-39879998">[2 more]</label></div><br/><div class="children"><div class="content">I like the idea of testing build-system behaviors like this, and I don’t think it’s ever really done in practice. Scriptable build systems, for lack of a better name for them, exist at a bad intersection of Turing complete, hard to test different cases, hard to reason about, hard to read the build script code, and most of us treating them as “ugh I hope all this stuff works” and if it does “thank god I get to ignore all this stuff for another 6 months”.</div><br/><div id="39881355" class="c"><input type="checkbox" id="c-39881355" checked=""/><div class="controls bullet"><span class="by">azakai</span><span>|</span><a href="#39879879">root</a><span>|</span><a href="#39879998">parent</a><span>|</span><a href="#39879981">next</a><span>|</span><label class="collapse" for="c-39881355">[-]</label><label class="expand" for="c-39881355">[1 more]</label></div><br/><div class="children"><div class="content">If you mean testing the &quot;disable Landlock if the headers and syscalls are out of sync&quot; functionality then I agree, workarounds for such corner cases are often not fully tested.<p>But it would have been enough here to have a test just to see that Landlock works in general. That test would have broken with this commit, because that&#x27;s what the commit actually does - break all Landlock support.<p>Based on that it sounds like there wasn&#x27;t a test for Landlock integration, if I&#x27;ve understood things correctly.</div><br/></div></div></div></div><div id="39879981" class="c"><input type="checkbox" id="c-39879981" checked=""/><div class="controls bullet"><span class="by">adrianmonk</span><span>|</span><a href="#39879879">parent</a><span>|</span><a href="#39879998">prev</a><span>|</span><a href="#39880030">next</a><span>|</span><label class="collapse" for="c-39879981">[-]</label><label class="expand" for="c-39879981">[1 more]</label></div><br/><div class="children"><div class="content">Create a tiny fake version of landlock with just the features you&#x27;re testing for. Since it&#x27;s only checking for 4 #defines in 3 header files, that&#x27;s easy.<p>Then compile your test program against your fake header files (with -Imy-fake-includes). It should compile without errors even if landlock is missing from your actual system.<p>Then build your test program a second time, this time against the real system headers, to test whether landlock is supported on your system.</div><br/></div></div><div id="39880030" class="c"><input type="checkbox" id="c-39880030" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39879879">parent</a><span>|</span><a href="#39879981">prev</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39880030">[-]</label><label class="expand" for="c-39880030">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;d say this MR is a bad approach in general. The headers say what interfaces are known, not what features are available. You should be able to compile with landlock support on a system which doesn&#x27;t enable it. Same situation as seccomp and others. Your build machine doesn&#x27;t have to match the capabilities of the target runner.<p>But yeah, to test it, you can have a mock version of landlock which responds with the error&#x2F;success as you want, regardless of what the system would normally do. It relies on the test not being sabotaged too though...</div><br/><div id="39880117" class="c"><input type="checkbox" id="c-39880117" checked=""/><div class="controls bullet"><span class="by">raimue</span><span>|</span><a href="#39879879">root</a><span>|</span><a href="#39880030">parent</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39880117">[-]</label><label class="expand" for="c-39880117">[4 more]</label></div><br/><div class="children"><div class="content">Read the code of the check again. It mostly checks that the required SYS_* constants are defined to be able to use the syscalls. You can compile this on a system that does not have landlock enabled in the running kernel, but the libc (which imports the kernel system call interface) has to provide the syscall numbers.</div><br/><div id="39880173" class="c"><input type="checkbox" id="c-39880173" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39879879">root</a><span>|</span><a href="#39880117">parent</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39880173">[-]</label><label class="expand" for="c-39880173">[3 more]</label></div><br/><div class="children"><div class="content">You&#x27;re right. I didn&#x27;t see SYS... symbols being actually used, but they are: <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=blob;f=src&#x2F;xz&#x2F;sandbox.c;h=9e30a07a2cbce353456b9475d038af0034624c53;hb=de4337fd89ca7db5feb97b5c40143404f6e22986#l218" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=blob;f=src&#x2F;xz&#x2F;sandbox.c;...</a><p>This doesn&#x27;t change my opinion in general - that version should be exposed through a library call and knowing about the specific syscalls shouldn&#x27;t be needed in xv.</div><br/><div id="39880529" class="c"><input type="checkbox" id="c-39880529" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39879879">root</a><span>|</span><a href="#39880173">parent</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39880529">[-]</label><label class="expand" for="c-39880529">[2 more]</label></div><br/><div class="children"><div class="content">I see your point, but suggesting adding an additional library dependency while we&#x27;re discussing a supply chain attack is quite ironic.</div><br/><div id="39880685" class="c"><input type="checkbox" id="c-39880685" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#39879879">root</a><span>|</span><a href="#39880529">parent</a><span>|</span><a href="#39875140">next</a><span>|</span><label class="collapse" for="c-39880685">[-]</label><label class="expand" for="c-39880685">[1 more]</label></div><br/><div class="children"><div class="content">Should&#x27;ve said function call not library call. My bad. Basically if you already have the linux&#x2F;landlock.h, that should provide everything you need to do without explicit references to SYS...</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="39875140" class="c"><input type="checkbox" id="c-39875140" checked=""/><div class="controls bullet"><span class="by">pxx</span><span>|</span><a href="#39879879">prev</a><span>|</span><a href="#39882364">next</a><span>|</span><label class="collapse" for="c-39875140">[-]</label><label class="expand" for="c-39875140">[4 more]</label></div><br/><div class="children"><div class="content">What was even the game here? Eventually even more backdoors, ones that would have more plausible deniability? Afaict neither the oss-fuzz nor this change would actually discover the found backdoor.<p>But why put your backdoor eggs into one basket (library)?</div><br/><div id="39875404" class="c"><input type="checkbox" id="c-39875404" checked=""/><div class="controls bullet"><span class="by">bayindirh</span><span>|</span><a href="#39875140">parent</a><span>|</span><a href="#39879550">next</a><span>|</span><label class="collapse" for="c-39875404">[-]</label><label class="expand" for="c-39875404">[1 more]</label></div><br/><div class="children"><div class="content">The library is entrenched enough, trusted enough, and its main developer has long internet breaks because of mental health problems.<p>Plus, you do not backdoor the library itself, but the tools using it. &quot;Reflections on trusting trust&quot; style.<p>Sounds like a perfect plan, until it isn&#x27;t.</div><br/></div></div><div id="39879550" class="c"><input type="checkbox" id="c-39879550" checked=""/><div class="controls bullet"><span class="by">dagmx</span><span>|</span><a href="#39875140">parent</a><span>|</span><a href="#39875404">prev</a><span>|</span><a href="#39882364">next</a><span>|</span><label class="collapse" for="c-39879550">[-]</label><label class="expand" for="c-39879550">[2 more]</label></div><br/><div class="children"><div class="content">Who says it was just the one library though?</div><br/><div id="39879739" class="c"><input type="checkbox" id="c-39879739" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#39875140">root</a><span>|</span><a href="#39879550">parent</a><span>|</span><a href="#39882364">next</a><span>|</span><label class="collapse" for="c-39879739">[-]</label><label class="expand" for="c-39879739">[1 more]</label></div><br/><div class="children"><div class="content">waiting for a new bot to scan everyone&#x27;s repos to find &quot;.&quot; and then spam every repo with false positives</div><br/></div></div></div></div></div></div><div id="39882364" class="c"><input type="checkbox" id="c-39882364" checked=""/><div class="controls bullet"><span class="by">leni536</span><span>|</span><a href="#39875140">prev</a><span>|</span><a href="#39879905">next</a><span>|</span><label class="collapse" for="c-39882364">[-]</label><label class="expand" for="c-39882364">[1 more]</label></div><br/><div class="children"><div class="content">Optional features should not depend on feature detection, ever. Feature detection for a security feature should be suspicious, even if it works as intended.<p>Optional features should always be configured by whoever tries to compile the code. There can be defaults, but they shouldn&#x27;t depend on the environment.</div><br/></div></div><div id="39879905" class="c"><input type="checkbox" id="c-39879905" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#39882364">prev</a><span>|</span><a href="#39875710">next</a><span>|</span><label class="collapse" for="c-39879905">[-]</label><label class="expand" for="c-39879905">[4 more]</label></div><br/><div class="children"><div class="content">So for each optional feature we may need three build options:<p>1. Force enable
2. Enable if available
3. Force disable<p>Like,<p><pre><code>   --enable_landlock=always
   --enable_landlock
   --disable_landlock</code></pre></div><br/><div id="39880091" class="c"><input type="checkbox" id="c-39880091" checked=""/><div class="controls bullet"><span class="by">glandium</span><span>|</span><a href="#39879905">parent</a><span>|</span><a href="#39875710">next</a><span>|</span><label class="collapse" for="c-39880091">[-]</label><label class="expand" for="c-39880091">[3 more]</label></div><br/><div class="children"><div class="content">My rule of thumb is that things should never be disabled automatically. Make the test hard fail and print a message that the feature can be disabled.</div><br/><div id="39881117" class="c"><input type="checkbox" id="c-39881117" checked=""/><div class="controls bullet"><span class="by">cperciva</span><span>|</span><a href="#39879905">root</a><span>|</span><a href="#39880091">parent</a><span>|</span><a href="#39880660">next</a><span>|</span><label class="collapse" for="c-39881117">[-]</label><label class="expand" for="c-39881117">[1 more]</label></div><br/><div class="children"><div class="content">In my code I have a bunch of routines optimized for different platforms, e.g. using x86 AESNI instructions.  Not all compilers support them, and they don&#x27;t even make sense when compiling for a different CPU architecture.<p>It&#x27;s much simpler to say &quot;enable this if we can compile it&quot; rather than detecting the compiler and target platform and throwing a mess of conditional compilation into an autoconf script.</div><br/></div></div><div id="39880660" class="c"><input type="checkbox" id="c-39880660" checked=""/><div class="controls bullet"><span class="by">ComputerGuru</span><span>|</span><a href="#39879905">root</a><span>|</span><a href="#39880091">parent</a><span>|</span><a href="#39881117">prev</a><span>|</span><a href="#39875710">next</a><span>|</span><label class="collapse" for="c-39880660">[-]</label><label class="expand" for="c-39880660">[1 more]</label></div><br/><div class="children"><div class="content">That’s how you make unusable&#x2F;uncompilable software. It might be a good rule for something security critical like ssh but not as a general rule.</div><br/></div></div></div></div></div></div><div id="39875710" class="c"><input type="checkbox" id="c-39875710" checked=""/><div class="controls bullet"><span class="by">jijijijij</span><span>|</span><a href="#39879905">prev</a><span>|</span><a href="#39875482">next</a><span>|</span><label class="collapse" for="c-39875710">[-]</label><label class="expand" for="c-39875710">[24 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know enough about C and complex builds, but the proposed change appears to be kind of a red flag, even without the breaking dot.<p><pre><code>    -    check_include_file(linux&#x2F;landlock.h HAVE_LINUX_LANDLOCK_H)
    ...
    +    check_c_source_compiles(&quot;
    +        #include &lt;linux&#x2F;landlock.h
</code></pre>
Is a compilation-test a legitimate&#x2F;common&#x2F;typical method to go about this?<p>Independently, of the breaking code, to me it seems accidental failing, or even accidentally not failing, would be in the nature of such an assessment... So, this commit seems to raise the question of &quot;why?&quot;, even if you missed the dot, doesn&#x27;t it? If a feature is formally available, but effectively broken somehow, wouldn&#x27;t you want the compiler to complain, instead of the feature dropped silently? Is the reasoning in the code comment sound? Can you test, if syscalls are defined in another way?</div><br/><div id="39876295" class="c"><input type="checkbox" id="c-39876295" checked=""/><div class="controls bullet"><span class="by">ronsor</span><span>|</span><a href="#39875710">parent</a><span>|</span><a href="#39875482">next</a><span>|</span><label class="collapse" for="c-39876295">[-]</label><label class="expand" for="c-39876295">[23 more]</label></div><br/><div class="children"><div class="content">&gt; Is a compilation-test a legitimate&#x2F;common&#x2F;typical method to go about this?<p>Yes—in fact, compilation tests are often the only way you can tell if a feature actually works. It&#x27;s extremely common for C build systems to detect and work around weird systems.</div><br/><div id="39882533" class="c"><input type="checkbox" id="c-39882533" checked=""/><div class="controls bullet"><span class="by">Nezghul</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876295">parent</a><span>|</span><a href="#39876326">next</a><span>|</span><label class="collapse" for="c-39882533">[-]</label><label class="expand" for="c-39882533">[1 more]</label></div><br/><div class="children"><div class="content">That &quot;check_c_source_compiles&quot; function should first test if the provided code snipped is &quot;valid C code in general&quot; and only then check if it compiles in given system.</div><br/></div></div><div id="39876326" class="c"><input type="checkbox" id="c-39876326" checked=""/><div class="controls bullet"><span class="by">jijijijij</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876295">parent</a><span>|</span><a href="#39882533">prev</a><span>|</span><a href="#39875482">next</a><span>|</span><label class="collapse" for="c-39876326">[-]</label><label class="expand" for="c-39876326">[21 more]</label></div><br/><div class="children"><div class="content">Is this by design, or by legacy? I mean, is there a better way to do this? Seems really flawed to me.</div><br/><div id="39879536" class="c"><input type="checkbox" id="c-39879536" checked=""/><div class="controls bullet"><span class="by">ninkendo</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876326">parent</a><span>|</span><a href="#39880246">next</a><span>|</span><label class="collapse" for="c-39879536">[-]</label><label class="expand" for="c-39879536">[8 more]</label></div><br/><div class="children"><div class="content">It’s by design. The job of autotools is to find “ground truth” about whatever environment you’re compiling against. It’s meant to discover if you can use a feature by actually seeing whether it works, not just by allow-listing a known set of compiler or library versions. This is because the whole point is to allow porting code to <i>any environment where it’ll work</i>, even on compilers you don’t know about. Think back to a time when there were several dozen Unix vendors, and just as many compilers. You don’t want your build script to report it can’t compile something just because it isn’t aware of your particular Unix vendor… you want it to only fail if the thing it’s trying to do actually doesn’t work. The only way to do this is by just testing if certain code compiles and produces the expected result.</div><br/><div id="39880189" class="c"><input type="checkbox" id="c-39880189" checked=""/><div class="controls bullet"><span class="by">Aeolun</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39879536">parent</a><span>|</span><a href="#39880246">next</a><span>|</span><label class="collapse" for="c-39880189">[-]</label><label class="expand" for="c-39880189">[7 more]</label></div><br/><div class="children"><div class="content">I don’t know. In my code I’d always compile and check at runtime?</div><br/><div id="39880369" class="c"><input type="checkbox" id="c-39880369" checked=""/><div class="controls bullet"><span class="by">ninkendo</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880189">parent</a><span>|</span><a href="#39880412">next</a><span>|</span><label class="collapse" for="c-39880369">[-]</label><label class="expand" for="c-39880369">[3 more]</label></div><br/><div class="children"><div class="content">Some of the checks are there to tell whether or not the compiler even supports your code.  You may not be able to compile your code at all, and the job of the build system is sometimes to just emit useful errors to help the person <i>building</i> the code to understand that they need a compiler which supports [language feature X].<p>Again, this is intended to be portable software. It is designed to work on lots of OS’s, with lots of compilers, in a lot of future environments that don’t even exist yet.<p>If you have a security feature for example, which uses the pledge() syscall on OpenBSD, but you can only use that feature on OpenBSD systems, you have two choices:<p>- Conditionally compile it based on whether you’ve detected that this is an OpenBSD target at build time, or,<p>- Conditionally compile it based on whether some sample code that uses pledge() builds successfully.<p>You can’t defer this decision until runtime, because it would require linking to pledge() symbols even though they may not exist on this system, which would cause the executable to fail to link at runtime, unless you completely rearchitected to use a plugin model, which is overkill.<p>So given the above are your main two options, the latter is preferred mainly because it allows new systems to come in and be compatible with old ones (maybe someone adds pledge() support to Linux one day) without having to fudge the uname command or something. This was super important in the early Unix days… perhaps less so now, but it’s still a good way to write portable software that still can take advantage of platform-specific features.</div><br/><div id="39881653" class="c"><input type="checkbox" id="c-39881653" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880369">parent</a><span>|</span><a href="#39880412">next</a><span>|</span><label class="collapse" for="c-39881653">[-]</label><label class="expand" for="c-39881653">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Again, this is intended to be portable software.<p>A scathing criticism of the OpenSSL library by the BSD team was that it was <i>too portable</i> in a (very real) sense that it wasn&#x27;t even written in &quot;C&quot; any more, or targeting &quot;libc&quot; as the standard library. It would be more accurate to say that it was &quot;Autotools&#x2F;C&quot; instead. By rewriting OpenSSL to target an actual full-featured libc, they found dozens of other bugs, including a bunch of memory issues other than the famous Heartbleed bug.<p>Platform standards like the C++ std library, libc, etc... are supposed to be the interface against which we write software. Giving that up and programming against megabytes of macros and Autotools scripts is basically saying that C isn&#x27;t a standard at all, <i>but Autotools is</i>.<p>Then just admit it, and say that you&#x27;re programming in the Autotools standard framework. Be honest about it, because you&#x27;ll then see the world in a different way. For example, you&#x27;ll suddenly understand why it&#x27;s <i>so hard to get away from Autotools</i>. It&#x27;s not because &quot;stuff is broken&quot;, but because it&#x27;s the programming language framework you and everyone else is using. It&#x27;s like a C++ guy lamenting that he needs gcc everywhere and can&#x27;t go back to a pure C compiler.<p>Job ads should be saying: &quot;Autotools programmer with 5 years experience&quot; instead of &quot;C programmer&quot;. It would be more accurate.<p>PS: I judge languages by the weight of their build overhead in relation to useful code. I&#x27;ve seen C libraries with <i>two functions</i> that had on the order of 50kb macros to enable them to build and interface with other things.</div><br/><div id="39882329" class="c"><input type="checkbox" id="c-39882329" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39881653">parent</a><span>|</span><a href="#39880412">next</a><span>|</span><label class="collapse" for="c-39882329">[-]</label><label class="expand" for="c-39882329">[1 more]</label></div><br/><div class="children"><div class="content">C basically has no standard library. It&#x27;s no surprise to anyone who has ever used it more than in passing that you depend on the chosen build system to replace that. Building portable C libraries is very different because of this from any other commonly used programming language - even C++.</div><br/></div></div></div></div></div></div><div id="39880412" class="c"><input type="checkbox" id="c-39880412" checked=""/><div class="controls bullet"><span class="by">ksherlock</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880189">parent</a><span>|</span><a href="#39880369">prev</a><span>|</span><a href="#39880243">next</a><span>|</span><label class="collapse" for="c-39880412">[-]</label><label class="expand" for="c-39880412">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;ll never make it to runtime if you try to include headers that don&#x27;t exist.  You&#x27;ll never make it to runtime if you try to link in libraries that don&#x27;t exist.</div><br/></div></div><div id="39880243" class="c"><input type="checkbox" id="c-39880243" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880189">parent</a><span>|</span><a href="#39880412">prev</a><span>|</span><a href="#39880246">next</a><span>|</span><label class="collapse" for="c-39880243">[-]</label><label class="expand" for="c-39880243">[2 more]</label></div><br/><div class="children"><div class="content">Not everything is detectable at runtime, such as syscall numbers (which is what&#x27;s being tested for here).</div><br/><div id="39881401" class="c"><input type="checkbox" id="c-39881401" checked=""/><div class="controls bullet"><span class="by">manwe150</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880243">parent</a><span>|</span><a href="#39880246">next</a><span>|</span><label class="collapse" for="c-39881401">[-]</label><label class="expand" for="c-39881401">[1 more]</label></div><br/><div class="children"><div class="content">Runtime syscall number detection is very common in practice, since the kernel returns ENOSYS to enable that exact ability for glibc and other shim libraries</div><br/></div></div></div></div></div></div></div></div><div id="39880246" class="c"><input type="checkbox" id="c-39880246" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876326">parent</a><span>|</span><a href="#39879536">prev</a><span>|</span><a href="#39879651">next</a><span>|</span><label class="collapse" for="c-39880246">[-]</label><label class="expand" for="c-39880246">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not by design, unlike what siblings say.  It&#x27;s by accident (so, &quot;legacy&quot;, as you put it).<p>The problem is that already in the 80s there was tons of variability from on Unix system (or version of it) to the next, but there was no standard way of representing what features&#x2F;standards&#x2F;APIs&#x2F;libraries a system supported or had installed.  When faced with such a mess people wrote code to detect features are present <i>on the target host</i>.<p>This then got made into tools with libraries of detection code.  Think autoconf&#x2F;autotools.<p>Now we also have pkgconfig, but it&#x27;s too late and it was not enough anyways.<p>Some things you might only detect at run-time, provided that their ABIs are stable enough that you can copy their headers into your application.</div><br/></div></div><div id="39879651" class="c"><input type="checkbox" id="c-39879651" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876326">parent</a><span>|</span><a href="#39880246">prev</a><span>|</span><a href="#39879608">next</a><span>|</span><label class="collapse" for="c-39879651">[-]</label><label class="expand" for="c-39879651">[9 more]</label></div><br/><div class="children"><div class="content">It’s by “design”, in the sense that C and C++ provide no better way to really know for sure that the functions you want to call really exist. In more modern languages we rely on metadata and semver, but none of that exists for C and C++.</div><br/><div id="39880284" class="c"><input type="checkbox" id="c-39880284" checked=""/><div class="controls bullet"><span class="by">kllrnohj</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39879651">parent</a><span>|</span><a href="#39879741">next</a><span>|</span><label class="collapse" for="c-39880284">[-]</label><label class="expand" for="c-39880284">[4 more]</label></div><br/><div class="children"><div class="content">Hey, leave C++ out of this. This is a C problem.<p><a href="https:&#x2F;&#x2F;en.cppreference.com&#x2F;w&#x2F;cpp&#x2F;feature_test" rel="nofollow">https:&#x2F;&#x2F;en.cppreference.com&#x2F;w&#x2F;cpp&#x2F;feature_test</a></div><br/><div id="39880523" class="c"><input type="checkbox" id="c-39880523" checked=""/><div class="controls bullet"><span class="by">Denvercoder9</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880284">parent</a><span>|</span><a href="#39879741">next</a><span>|</span><label class="collapse" for="c-39880523">[-]</label><label class="expand" for="c-39880523">[3 more]</label></div><br/><div class="children"><div class="content">That only works for language features though, it doesn&#x27;t allow detecting OS&#x2F;library features.</div><br/><div id="39881615" class="c"><input type="checkbox" id="c-39881615" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880523">parent</a><span>|</span><a href="#39879741">next</a><span>|</span><label class="collapse" for="c-39881615">[-]</label><label class="expand" for="c-39881615">[2 more]</label></div><br/><div class="children"><div class="content">Very true, but don’t forget that Autoconf checks for “interesting” compiler choices as well as library and OS features. And then there is libtool, which abstracts out the differences between how compilers generate shared libraries so that you only have to understand one way of doing it and it will work on all of them.</div><br/><div id="39881664" class="c"><input type="checkbox" id="c-39881664" checked=""/><div class="controls bullet"><span class="by">cryptonector</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39881615">parent</a><span>|</span><a href="#39879741">next</a><span>|</span><label class="collapse" for="c-39881664">[-]</label><label class="expand" for="c-39881664">[1 more]</label></div><br/><div class="children"><div class="content">Autoconf lets you check for all sorts of things:<p><pre><code>  - instruction set architecture
  - OS versions
  - ABIs
  - libraries (whether they are installed)
    - and what functionality they provide
  - commands&#x2F;executables
  - anything you can write a macro to check
</code></pre>
All stuff too disparate to reliably have the OS be able to answer every question you might have about it and the stuff installed on it.  You can&#x27;t wait for any such system to learn how to answer the questions you might have about it, so some things you can only detect, either at build configuration time, build time, or run time.</div><br/></div></div></div></div></div></div></div></div><div id="39879741" class="c"><input type="checkbox" id="c-39879741" checked=""/><div class="controls bullet"><span class="by">uecker</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39879651">parent</a><span>|</span><a href="#39880284">prev</a><span>|</span><a href="#39879608">next</a><span>|</span><label class="collapse" for="c-39879741">[-]</label><label class="expand" for="c-39879741">[4 more]</label></div><br/><div class="children"><div class="content">I never test for this in this way in my C projects. I also rely on version tests only.</div><br/><div id="39880031" class="c"><input type="checkbox" id="c-39880031" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39879741">parent</a><span>|</span><a href="#39879608">next</a><span>|</span><label class="collapse" for="c-39880031">[-]</label><label class="expand" for="c-39880031">[3 more]</label></div><br/><div class="children"><div class="content">Yea, it’s not impossible to do, just not standardized. If you use a library and it provides useful version information, then definitely use it. It’s just that the language or the tooling doesn’t force libraries to have that kind of metadata. Compare that with Rust, where every library you use must come with a standardized manifest that includes a version number, and where they tell library authors up front that they are expected to follow the semver convention.<p>The fact is that things have good easier over the last 10 or 20 years. It used to be the case that any program targeting Unix had to either spend a lot of time and energy tracking the precise differences between dozens of different commercial Unices, or use autoconf. Autoconf was the project that combined all of that lore into a single place, so that most people didn’t have to know every single detail. But these days most of the Unices are dead and buried, and 99% of all new projects just target Linux. Kinda sucks if you prefer one of the BSDs, or OpenSolaris&#x2F;Illumos&#x2F;SmartOS, but it does mean that new Linux developers never have to jump through those hoops and simply never learn about autoconf. And while on the one hand that represents a loss of knowledge and competency for the community (making this type of supply–chain attack much easier), on the other hand autoconf is in practice an abomination. It is (or at least was) extremely useful, but it was implemented in M4 and reading the source code will literally damage your brain.</div><br/><div id="39880602" class="c"><input type="checkbox" id="c-39880602" checked=""/><div class="controls bullet"><span class="by">acdha</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880031">parent</a><span>|</span><a href="#39879608">next</a><span>|</span><label class="collapse" for="c-39880602">[-]</label><label class="expand" for="c-39880602">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It used to be the case that any program targeting Unix had to either spend a lot of time and energy tracking the precise differences between dozens of different commercial Unices, or use autoconf. Autoconf was the project that combined all of that lore into a single place, so that most people didn’t have to know every single detail.<p>As a data point, the place I worked for in the mid-90s had a single codebase with something over 600 permutations of supported OS and compiler when you included the different versions. One thing we take for granted now is how easy it is to get and install updates – back then you might find that, say, a common API was simply broken on one particular operating system version but your customers would have to wait for a patch to be released, sometimes purchased, put onto floppy disks or CD-ROM, and then manually installed in a way which had enough risk involved that people often put it off as long as they could. Some vendors also did individual patches which could be combined by the sysadmin so you had to test for that specific feature rather than just saying “is it greater than 1.2.3?”, and it wasn’t uncommon to find cases where they’d compiled a common library with some weird patches so you had to test whether the specific features you needed functioned.<p>Part of why Linux annihilated them was cost but much of it was having package managers designed by grownups - I remember as late as the mid-2000s bricking brand new Sun servers by running the new Solaris updater, which left them in an unbootable state.</div><br/><div id="39881652" class="c"><input type="checkbox" id="c-39881652" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39880602">parent</a><span>|</span><a href="#39879608">next</a><span>|</span><label class="collapse" for="c-39881652">[-]</label><label class="expand" for="c-39881652">[1 more]</label></div><br/><div class="children"><div class="content">Ah, wacky fun. <a href="https:&#x2F;&#x2F;youtu.be&#x2F;yHPvOeahQnc?t=87" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;yHPvOeahQnc?t=87</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="39879608" class="c"><input type="checkbox" id="c-39879608" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876326">parent</a><span>|</span><a href="#39879651">prev</a><span>|</span><a href="#39879592">next</a><span>|</span><label class="collapse" for="c-39879608">[-]</label><label class="expand" for="c-39879608">[1 more]</label></div><br/><div class="children"><div class="content">Have you ever tried to manually build something from a release tarball by starting with .&#x2F;configure? If so, have you observed how many times the compiler is invoked in this configure phase before you even run make?</div><br/></div></div><div id="39879592" class="c"><input type="checkbox" id="c-39879592" checked=""/><div class="controls bullet"><span class="by">secondcoming</span><span>|</span><a href="#39875710">root</a><span>|</span><a href="#39876326">parent</a><span>|</span><a href="#39879608">prev</a><span>|</span><a href="#39875482">next</a><span>|</span><label class="collapse" for="c-39879592">[-]</label><label class="expand" for="c-39879592">[1 more]</label></div><br/><div class="children"><div class="content">Back in the day when people compiled source from tarballs on their personal machines, the autoconf script would query your system to see what functionality it supported. It did this by trying to compile small programs for each feature. If the compilation failed it assumes the feature is unavailable on your system and a flag is set&#x2F;unset for the rest of the build.</div><br/></div></div></div></div></div></div></div></div><div id="39875482" class="c"><input type="checkbox" id="c-39875482" checked=""/><div class="controls bullet"><span class="by">legobmw99</span><span>|</span><a href="#39875710">prev</a><span>|</span><a href="#39882137">next</a><span>|</span><label class="collapse" for="c-39875482">[-]</label><label class="expand" for="c-39875482">[4 more]</label></div><br/><div class="children"><div class="content">I’m not quite following what the diff here is suggesting - was this some cmake magic to detect if a feature was enabled, but the file had an intentional syntax error?</div><br/><div id="39879639" class="c"><input type="checkbox" id="c-39879639" checked=""/><div class="controls bullet"><span class="by">db48x</span><span>|</span><a href="#39875482">parent</a><span>|</span><a href="#39875520">next</a><span>|</span><label class="collapse" for="c-39879639">[-]</label><label class="expand" for="c-39879639">[1 more]</label></div><br/><div class="children"><div class="content">Autoconf and CMake both compile small test programs to verify that the feature in question actually works. The test programs almost never actually do anything; the just refer to the feature of function that they rely on. If there is a compile or linker error then the feature isn’t available. In this case the compiler always outputs an error because the test program doesn’t have valid C syntax.<p>Of course in practice you shouldn’t be writing each test program by hand. Autoconf has macros that generate them; you would only need to supply an identifier or at most a single line of code and the rest would be created correctly. I’m sure CMake is similar in that regard, so the first red flag is that they wrote a whole test program.</div><br/></div></div><div id="39875520" class="c"><input type="checkbox" id="c-39875520" checked=""/><div class="controls bullet"><span class="by">bean-weevil</span><span>|</span><a href="#39875482">parent</a><span>|</span><a href="#39879639">prev</a><span>|</span><a href="#39875535">next</a><span>|</span><label class="collapse" for="c-39875520">[-]</label><label class="expand" for="c-39875520">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s exactly right. It was checking if the c code compiled to detect the landlock feature, and there was a single period in the middle of the code that made it always fail to compile and thus silently leave the feature disabled.</div><br/></div></div></div></div><div id="39882137" class="c"><input type="checkbox" id="c-39882137" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#39875482">prev</a><span>|</span><a href="#39875363">next</a><span>|</span><label class="collapse" for="c-39882137">[-]</label><label class="expand" for="c-39882137">[1 more]</label></div><br/><div class="children"><div class="content">This is surprisingly obvious. I mean it&#x27;s a clever technique to disable the feature and a really plausible commit. But then why did they go with an obvious syntax error instead of just misspelling something. E.g. would you have spotted it if the mistake was `PR_SET_NO_NEW_PRIV`?<p>More plausibly deniable too.</div><br/></div></div><div id="39875363" class="c"><input type="checkbox" id="c-39875363" checked=""/><div class="controls bullet"><span class="by">danieldk</span><span>|</span><a href="#39882137">prev</a><span>|</span><a href="#39882538">next</a><span>|</span><label class="collapse" for="c-39875363">[-]</label><label class="expand" for="c-39875363">[1 more]</label></div><br/><div class="children"><div class="content">Commit that introduced this:<p><a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commit;h=328c52da8a2bbb81307644efdb58db2c422d9ba7" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=commit;h=328c52da8a2bbb8...</a></div><br/></div></div><div id="39882538" class="c"><input type="checkbox" id="c-39882538" checked=""/><div class="controls bullet"><span class="by">acqq</span><span>|</span><a href="#39875363">prev</a><span>|</span><a href="#39875696">next</a><span>|</span><label class="collapse" for="c-39882538">[-]</label><label class="expand" for="c-39882538">[1 more]</label></div><br/><div class="children"><div class="content">Now I&#x27;d like to have a link to that patch in code used by Apple that also appeared as a typo. Anybody remembers?</div><br/></div></div><div id="39875696" class="c"><input type="checkbox" id="c-39875696" checked=""/><div class="controls bullet"><span class="by">JSDevOps</span><span>|</span><a href="#39882538">prev</a><span>|</span><a href="#39875128">next</a><span>|</span><label class="collapse" for="c-39875696">[-]</label><label class="expand" for="c-39875696">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, I wasn&#x27;t sure what the diff is alluding to here but I assume &quot;mysandbox&quot; could remain undetected (enabled&#x2F;disabled) for whatever reason.</div><br/></div></div><div id="39875128" class="c"><input type="checkbox" id="c-39875128" checked=""/><div class="controls bullet"><span class="by">GrayShade</span><span>|</span><a href="#39875696">prev</a><span>|</span><a href="#39874687">next</a><span>|</span><label class="collapse" for="c-39875128">[-]</label><label class="expand" for="c-39875128">[5 more]</label></div><br/><div class="children"><div class="content">Only in CMake, this time. Not in the autotools version.</div><br/><div id="39880458" class="c"><input type="checkbox" id="c-39880458" checked=""/><div class="controls bullet"><span class="by">almostnormal</span><span>|</span><a href="#39875128">parent</a><span>|</span><a href="#39874687">next</a><span>|</span><label class="collapse" for="c-39880458">[-]</label><label class="expand" for="c-39880458">[4 more]</label></div><br/><div class="children"><div class="content">Does autotools compile only, or try to link? There&#x27;s no main().</div><br/><div id="39882002" class="c"><input type="checkbox" id="c-39882002" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#39875128">root</a><span>|</span><a href="#39880458">parent</a><span>|</span><a href="#39881121">next</a><span>|</span><label class="collapse" for="c-39882002">[-]</label><label class="expand" for="c-39882002">[1 more]</label></div><br/><div class="children"><div class="content">AC_COMPILE_IFELSE indeed only compiles, so there&#x27;s no need for main().<p>There&#x27;s AC_LINK_IFELSE if you want to test linking too.</div><br/></div></div><div id="39881121" class="c"><input type="checkbox" id="c-39881121" checked=""/><div class="controls bullet"><span class="by">jan3000</span><span>|</span><a href="#39875128">root</a><span>|</span><a href="#39880458">parent</a><span>|</span><a href="#39882002">prev</a><span>|</span><a href="#39874687">next</a><span>|</span><label class="collapse" for="c-39881121">[-]</label><label class="expand" for="c-39881121">[2 more]</label></div><br/><div class="children"><div class="content">There is a main()...[0]<p>[0] <a href="https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=blob;f=CMakeLists.txt;h=d2b1af7ab0ab759b6805ced3dff2555e2a4b3f8e;hb=d2b1af7ab0ab759b6805ced3dff2555e2a4b3f8e#l921" rel="nofollow">https:&#x2F;&#x2F;git.tukaani.org&#x2F;?p=xz.git;a=blob;f=CMakeLists.txt;h=...</a></div><br/><div id="39881997" class="c"><input type="checkbox" id="c-39881997" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#39875128">root</a><span>|</span><a href="#39881121">parent</a><span>|</span><a href="#39874687">next</a><span>|</span><label class="collapse" for="c-39881997">[-]</label><label class="expand" for="c-39881997">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s not autotools.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>