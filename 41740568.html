<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728118872792" as="style"/><link rel="stylesheet" href="styles.css?v=1728118872792"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://stuffmatic.com/chebyshev/">Show HN: Chebyshev approximation calculator</a> <span class="domain">(<a href="https://stuffmatic.com">stuffmatic.com</a>)</span></div><div class="subtext"><span>stuffmatic</span> | <span>44 comments</span></div><br/><div><div id="41741611" class="c"><input type="checkbox" id="c-41741611" checked=""/><div class="controls bullet"><span class="by">herodotus</span><span>|</span><a href="#41740963">next</a><span>|</span><label class="collapse" for="c-41741611">[-]</label><label class="expand" for="c-41741611">[8 more]</label></div><br/><div class="children"><div class="content">Lovely. In about 1974 I was paid to write a function, in IBM 360 assembly language, to compute square roots. I was asked to make it as efficient as possible. I was in my last year as an undergraduate student. I used a Chebyshev approximation for the initial guess (after scaling the input to lie between 0 and 1), and then used two (or was it three) unrolled iterations of Newton&#x27;s method to get the solution. First money I ever received for writing code!</div><br/><div id="41742652" class="c"><input type="checkbox" id="c-41742652" checked=""/><div class="controls bullet"><span class="by">aghilmort</span><span>|</span><a href="#41741611">parent</a><span>|</span><a href="#41740963">next</a><span>|</span><label class="collapse" for="c-41742652">[-]</label><label class="expand" for="c-41742652">[7 more]</label></div><br/><div class="children"><div class="content">love this -- still recall how eye-opening my first course was on numerical solving  and appreciating for the first time yet again the sheer potential of compute</div><br/><div id="41742969" class="c"><input type="checkbox" id="c-41742969" checked=""/><div class="controls bullet"><span class="by">ratedgene</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41742652">parent</a><span>|</span><a href="#41740963">next</a><span>|</span><label class="collapse" for="c-41742969">[-]</label><label class="expand" for="c-41742969">[6 more]</label></div><br/><div class="children"><div class="content">Any good books on this?</div><br/><div id="41745744" class="c"><input type="checkbox" id="c-41745744" checked=""/><div class="controls bullet"><span class="by">amadio</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41742969">parent</a><span>|</span><a href="#41744135">next</a><span>|</span><label class="collapse" for="c-41745744">[-]</label><label class="expand" for="c-41745744">[1 more]</label></div><br/><div class="children"><div class="content">Robin Green has some excellent material on the subject, which I am linking below.<p>Faster Math Functions:<p><a href="https:&#x2F;&#x2F;basesandframes.files.wordpress.com&#x2F;2016&#x2F;05&#x2F;fast-math-functions_p1.pdf" rel="nofollow">https:&#x2F;&#x2F;basesandframes.files.wordpress.com&#x2F;2016&#x2F;05&#x2F;fast-math...</a><p><a href="https:&#x2F;&#x2F;basesandframes.files.wordpress.com&#x2F;2016&#x2F;05&#x2F;fast-math-functions_p2.pdf" rel="nofollow">https:&#x2F;&#x2F;basesandframes.files.wordpress.com&#x2F;2016&#x2F;05&#x2F;fast-math...</a><p>Even faster math functions GDC 2020:<p><a href="https:&#x2F;&#x2F;gdcvault.com&#x2F;play&#x2F;1026734&#x2F;Math-in-Game-Development-Summit" rel="nofollow">https:&#x2F;&#x2F;gdcvault.com&#x2F;play&#x2F;1026734&#x2F;Math-in-Game-Development-S...</a></div><br/></div></div><div id="41744135" class="c"><input type="checkbox" id="c-41744135" checked=""/><div class="controls bullet"><span class="by">pclmulqdq</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41742969">parent</a><span>|</span><a href="#41745744">prev</a><span>|</span><a href="#41747393">next</a><span>|</span><label class="collapse" for="c-41744135">[-]</label><label class="expand" for="c-41744135">[2 more]</label></div><br/><div class="children"><div class="content">I am working on one with some more modern suggestions on polynomial approximation, but I think it&#x27;s still at least 3-6 months away.</div><br/><div id="41748495" class="c"><input type="checkbox" id="c-41748495" checked=""/><div class="controls bullet"><span class="by">janwas</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41744135">parent</a><span>|</span><a href="#41747393">next</a><span>|</span><label class="collapse" for="c-41748495">[-]</label><label class="expand" for="c-41748495">[1 more]</label></div><br/><div class="children"><div class="content">Nice! Any way to subscribe for updates?</div><br/></div></div></div></div><div id="41747393" class="c"><input type="checkbox" id="c-41747393" checked=""/><div class="controls bullet"><span class="by">alleycat5000</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41742969">parent</a><span>|</span><a href="#41744135">prev</a><span>|</span><a href="#41744004">next</a><span>|</span><label class="collapse" for="c-41747393">[-]</label><label class="expand" for="c-41747393">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;people.maths.ox.ac.uk&#x2F;trefethen&#x2F;ATAP&#x2F;" rel="nofollow">https:&#x2F;&#x2F;people.maths.ox.ac.uk&#x2F;trefethen&#x2F;ATAP&#x2F;</a></div><br/></div></div><div id="41744004" class="c"><input type="checkbox" id="c-41744004" checked=""/><div class="controls bullet"><span class="by">aghilmort</span><span>|</span><a href="#41741611">root</a><span>|</span><a href="#41742969">parent</a><span>|</span><a href="#41747393">prev</a><span>|</span><a href="#41740963">next</a><span>|</span><label class="collapse" for="c-41744004">[-]</label><label class="expand" for="c-41744004">[1 more]</label></div><br/><div class="children"><div class="content">twenty years back, numerical analysis or numerical methods or sometimes numerical optimization are good keywords for current trending texts on Amazon etc [1]<p>alternatively subset of the numerical analysi wikipedia page or these algorithms in the book is a good seed filter [2]<p>ideally covers some linalg like gaussian elim, power method, newton&#x27;s root finding dynamic, and issues like approximating by discretization, recursion to reduce solve iterations, and things like convergence due to numerical instability due to IEEE 754 fp16 limits etc<p>1. <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Numerical_analysis" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Numerical_analysis</a><p>2. <a href="https:&#x2F;&#x2F;chatgpt.com&#x2F;share&#x2F;67002e8c-c5c4-8008-83f9-a6ebc603add2" rel="nofollow">https:&#x2F;&#x2F;chatgpt.com&#x2F;share&#x2F;67002e8c-c5c4-8008-83f9-a6ebc603ad...</a></div><br/></div></div></div></div></div></div></div></div><div id="41740963" class="c"><input type="checkbox" id="c-41740963" checked=""/><div class="controls bullet"><span class="by">jaymzcampbell</span><span>|</span><a href="#41741611">prev</a><span>|</span><a href="#41742166">next</a><span>|</span><label class="collapse" for="c-41740963">[-]</label><label class="expand" for="c-41740963">[2 more]</label></div><br/><div class="children"><div class="content">This is really nicely done! Great work. I fell in love with just how efficient these can be and it explained a lot about why many of the trig and other mathematical functions implemented in 8-bit computers are they way they are.<p>Here&#x27;s a rather wonderful original document from the BBC Research Department (I had no idea that was a thing) back in 1969 going over just what makes them so great (<a href="https:&#x2F;&#x2F;downloads.bbc.co.uk&#x2F;rd&#x2F;pubs&#x2F;reports&#x2F;1969-10.pdf" rel="nofollow">https:&#x2F;&#x2F;downloads.bbc.co.uk&#x2F;rd&#x2F;pubs&#x2F;reports&#x2F;1969-10.pdf</a>).<p>If all you&#x27;ve come across are Taylor approximations, these things can seem a little like magic at first.</div><br/><div id="41741004" class="c"><input type="checkbox" id="c-41741004" checked=""/><div class="controls bullet"><span class="by">stuffmatic</span><span>|</span><a href="#41740963">parent</a><span>|</span><a href="#41742166">next</a><span>|</span><label class="collapse" for="c-41741004">[-]</label><label class="expand" for="c-41741004">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! Yes it does feel a bit magical, both the mathematical aspects and the fact that it all boils down to a few lines of code in practice.</div><br/></div></div></div></div><div id="41742166" class="c"><input type="checkbox" id="c-41742166" checked=""/><div class="controls bullet"><span class="by">orlp</span><span>|</span><a href="#41740963">prev</a><span>|</span><a href="#41741945">next</a><span>|</span><label class="collapse" for="c-41742166">[-]</label><label class="expand" for="c-41742166">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve had good results in the past with sollya: <a href="https:&#x2F;&#x2F;www.sollya.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.sollya.org&#x2F;</a>.<p>Note: results. The software itself is a bit of a pain to use.</div><br/><div id="41747219" class="c"><input type="checkbox" id="c-41747219" checked=""/><div class="controls bullet"><span class="by">pclmulqdq</span><span>|</span><a href="#41742166">parent</a><span>|</span><a href="#41741945">next</a><span>|</span><label class="collapse" for="c-41747219">[-]</label><label class="expand" for="c-41747219">[2 more]</label></div><br/><div class="children"><div class="content">Sollya is probably the best modern tool for doing this.  Under the hood, it does a Remez approximation followed by LLL to quantize to floating point.  No use of Chebyshev directly.</div><br/><div id="41748504" class="c"><input type="checkbox" id="c-41748504" checked=""/><div class="controls bullet"><span class="by">janwas</span><span>|</span><a href="#41742166">root</a><span>|</span><a href="#41747219">parent</a><span>|</span><a href="#41741945">next</a><span>|</span><label class="collapse" for="c-41748504">[-]</label><label class="expand" for="c-41748504">[1 more]</label></div><br/><div class="children"><div class="content">hm, why not Chebfun? Result is a rational polynomial so we have to divide, but that seems fine&#x2F;fast on servers.</div><br/></div></div></div></div></div></div><div id="41741945" class="c"><input type="checkbox" id="c-41741945" checked=""/><div class="controls bullet"><span class="by">Fredkin</span><span>|</span><a href="#41742166">prev</a><span>|</span><a href="#41741407">next</a><span>|</span><label class="collapse" for="c-41741945">[-]</label><label class="expand" for="c-41741945">[3 more]</label></div><br/><div class="children"><div class="content">Math.sin(x)&#x2F;x (the sinc function) for 7 terms over [-3,3] gives coefficients c0...c6 that are all NaNs. Is this a bug?<p>To work around it, I handled the x near zero case by just forcing to 1.0.<p>if(Math.abs(x) &gt; 1e-8 ){ Math.sin(x)&#x2F;x } else { 1.0 }</div><br/><div id="41742165" class="c"><input type="checkbox" id="c-41742165" checked=""/><div class="controls bullet"><span class="by">Majromax</span><span>|</span><a href="#41741945">parent</a><span>|</span><a href="#41742523">next</a><span>|</span><label class="collapse" for="c-41742165">[-]</label><label class="expand" for="c-41742165">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Math.sin(x)&#x2F;x (the sinc function) for 7 terms over [-3,3] gives coefficients c0...c6 that are all NaNs. Is this a bug?<p>That wouldn&#x27;t exactly be a bug.  The code is undoubtedly calculating the Chebyshev coefficients by evaluating the function on something like x_j = (xmin) + (xmax - xmin)&#x2F;2<i>(1 + cos(pi</i>[0..j-1]&#x2F;(j-1)).  If one of those grid points happens to be exactly 0, it will try to evaluate Math.sin(0)&#x2F;0, giving the NaN.<p>Another workaround is to have a slightly asymmetric range, such as [-3,+3.0000001]</div><br/></div></div><div id="41742523" class="c"><input type="checkbox" id="c-41742523" checked=""/><div class="controls bullet"><span class="by">stuffmatic</span><span>|</span><a href="#41741945">parent</a><span>|</span><a href="#41742165">prev</a><span>|</span><a href="#41741407">next</a><span>|</span><label class="collapse" for="c-41742523">[-]</label><label class="expand" for="c-41742523">[1 more]</label></div><br/><div class="children"><div class="content">Yes, that is a bug, good catch. The app should show an error if the function is not defined in all chebyshev nodes. Like you have already discovered, it&#x27;s easy to work around this issue for now.</div><br/></div></div></div></div><div id="41741407" class="c"><input type="checkbox" id="c-41741407" checked=""/><div class="controls bullet"><span class="by">xioxox</span><span>|</span><a href="#41741945">prev</a><span>|</span><a href="#41743226">next</a><span>|</span><label class="collapse" for="c-41741407">[-]</label><label class="expand" for="c-41741407">[2 more]</label></div><br/><div class="children"><div class="content">Excellent work. I wanted to do this recently, but it was surprisingly hard to find code to calculate an approximation. I&#x27;ve bookmarked it for when I next need a quick approximation for a function.</div><br/><div id="41741484" class="c"><input type="checkbox" id="c-41741484" checked=""/><div class="controls bullet"><span class="by">stuffmatic</span><span>|</span><a href="#41741407">parent</a><span>|</span><a href="#41743226">next</a><span>|</span><label class="collapse" for="c-41741484">[-]</label><label class="expand" for="c-41741484">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the kind words. I also found it surprisingly hard to find working Chebyshev approximation code. Hopefully this project will change that :)</div><br/></div></div></div></div><div id="41743226" class="c"><input type="checkbox" id="c-41743226" checked=""/><div class="controls bullet"><span class="by">Rayhem</span><span>|</span><a href="#41741407">prev</a><span>|</span><a href="#41742005">next</a><span>|</span><label class="collapse" for="c-41743226">[-]</label><label class="expand" for="c-41743226">[2 more]</label></div><br/><div class="children"><div class="content">Obligatory callout to Nick Trefethen (et. al.)&#x27;s Chebfun[1] which extends this stuff in just about every direction you can think of. &#x27;Chebfuns&#x27; are to functions as floats are to actual mathematical numbers. It&#x27;s some seriously impressive software.<p>[1]: <a href="https:&#x2F;&#x2F;www.chebfun.org" rel="nofollow">https:&#x2F;&#x2F;www.chebfun.org</a></div><br/><div id="41747356" class="c"><input type="checkbox" id="c-41747356" checked=""/><div class="controls bullet"><span class="by">kxyvr</span><span>|</span><a href="#41743226">parent</a><span>|</span><a href="#41742005">next</a><span>|</span><label class="collapse" for="c-41747356">[-]</label><label class="expand" for="c-41747356">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll second this.  Their methods are very powerful and very fast.  For those out of the loop, the Chebyshev (and ultra-spherical) machinery allows a very accurate (machine precision) approximation to most functions to be computed very quickly.  Then, this representation can be manipulated more easily.  This enables a variety of methods such as finding the solution to differential algebraic equations to machine precision or finding the global min&#x2F;max of a 1-D function.<p>I believe they use a different algorithm now, but the basic methodology that used to be used by Chebfun can be found in the book Spectral Methods in Matlab by Trefethen.  Look at chapter 6.  The newer methodology with ultraspherical functions can be found in a SIAM review paper titled, &quot;A Fast and Well-Conditioned Spectral Method,&quot; by Olver and Townsend.</div><br/></div></div></div></div><div id="41742005" class="c"><input type="checkbox" id="c-41742005" checked=""/><div class="controls bullet"><span class="by">atum47</span><span>|</span><a href="#41743226">prev</a><span>|</span><a href="#41745908">next</a><span>|</span><label class="collapse" for="c-41742005">[-]</label><label class="expand" for="c-41742005">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been wondering about something and I don&#x27;t know if this is the place to ask it, but here it goes. I saw a video the other day about how the Nintendo 64 did not have the ability to calculate sine, so they used a lookup table from 0 to 2PI (with some clever trick to reduce the size of the table). Would it have been possibly to train a NN and store the weights or even a function and store the coefficients to calculate the sine, cosine?</div><br/><div id="41742058" class="c"><input type="checkbox" id="c-41742058" checked=""/><div class="controls bullet"><span class="by">mandibles</span><span>|</span><a href="#41742005">parent</a><span>|</span><a href="#41745714">next</a><span>|</span><label class="collapse" for="c-41742058">[-]</label><label class="expand" for="c-41742058">[1 more]</label></div><br/><div class="children"><div class="content">Neural networks often have trigonometric functions internally, so it would be massively more computation than necessary.<p>If you have a few spare CPU cycles, a hybrid approximation could start with a sparse lookup table of values as the initial guess for a few rounds of a numerical approximation technique. Or you just store the first few coefficients of a polynomial approximation (as in the OP&#x27;s work).</div><br/></div></div><div id="41745714" class="c"><input type="checkbox" id="c-41745714" checked=""/><div class="controls bullet"><span class="by">magicalhippo</span><span>|</span><a href="#41742005">parent</a><span>|</span><a href="#41742058">prev</a><span>|</span><a href="#41742150">next</a><span>|</span><label class="collapse" for="c-41745714">[-]</label><label class="expand" for="c-41745714">[1 more]</label></div><br/><div class="children"><div class="content">A neural network is essentially just a curve fitter, so yeah. You might find this[1] video illuminating.<p>The main strength of a neural network comes into play when there&#x27;s a lot of different inputs, not just a handful. For the simpler cases like sin(x) we have other tools like the one posted here.<p>[1]: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=FBpPjjhJGhk" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=FBpPjjhJGhk</a> <i>But what is a neural network REALLY?</i></div><br/></div></div><div id="41742150" class="c"><input type="checkbox" id="c-41742150" checked=""/><div class="controls bullet"><span class="by">EdgeExplorer</span><span>|</span><a href="#41742005">parent</a><span>|</span><a href="#41745714">prev</a><span>|</span><a href="#41742456">next</a><span>|</span><label class="collapse" for="c-41742150">[-]</label><label class="expand" for="c-41742150">[2 more]</label></div><br/><div class="children"><div class="content">Obviously you could train some kind of neural net to calculate any function, but this would never make sense for a well-known function like sine. Neural nets are a great solution when you need to evaluate something that isn&#x27;t easy to analyze mathematically, but there are already many known techniques for calculating and approximating trigonometric functions.<p>Training a neural net to calculate sines is like the math equivalent of using an LLM to reverse a string. Sure, you *can*, but the idea only makes sense if you don&#x27;t understand how fundamentally solvable the problem is with a more direct approach.<p>It&#x27;s always worth looking if mathematicians already have a solution to a problem before reaching for AI&#x2F;ML techniques. Unfortunately, a lot of effort is probably being spent these days programming some kind of AI&#x2F;ML to solve problems that have a known, efficient, maybe even proven optimal solution that developers just don&#x27;t know about.</div><br/><div id="41746464" class="c"><input type="checkbox" id="c-41746464" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#41742005">root</a><span>|</span><a href="#41742150">parent</a><span>|</span><a href="#41742456">next</a><span>|</span><label class="collapse" for="c-41746464">[-]</label><label class="expand" for="c-41746464">[1 more]</label></div><br/><div class="children"><div class="content">&gt; using an LLM to reverse a string.<p><pre><code>  Input: Please reverse the string &quot;Dlrow, Olleh!&quot;
  Output (chatgpt): Sure! The reversed string is &quot;!helleO ,worldD&quot;
  Output (liquid): The reversed string is &quot;!ehT, Llord!&quot;
  Output (llama): The reversed string is &quot;Hellol, Wlod.&quot;
  Output (phi): The reversed string of &quot;Dlrow, Olleh!&quot; is &quot;!HoleL ,owrdL&quot; or &quot;Hello, World!&quot; backwards.
  Output (qwen): The reversed string of &quot;Dlrow, Olleh!&quot; is &quot;!hlelo ,wolrD&quot;.
</code></pre>
Honestly some of them are doing better than I expected.</div><br/></div></div></div></div><div id="41742456" class="c"><input type="checkbox" id="c-41742456" checked=""/><div class="controls bullet"><span class="by">kevin_thibedeau</span><span>|</span><a href="#41742005">parent</a><span>|</span><a href="#41742150">prev</a><span>|</span><a href="#41743863">next</a><span>|</span><label class="collapse" for="c-41742456">[-]</label><label class="expand" for="c-41742456">[1 more]</label></div><br/><div class="children"><div class="content">The usual conservation trick is to have a table from 0 to PI&#x2F;2 and use two additional index bits to generate the other three quadrants.</div><br/></div></div><div id="41743863" class="c"><input type="checkbox" id="c-41743863" checked=""/><div class="controls bullet"><span class="by">CamperBob2</span><span>|</span><a href="#41742005">parent</a><span>|</span><a href="#41742456">prev</a><span>|</span><a href="#41745908">next</a><span>|</span><label class="collapse" for="c-41743863">[-]</label><label class="expand" for="c-41743863">[1 more]</label></div><br/><div class="children"><div class="content">Take a look at CORDIC if you aren&#x27;t familiar with it; that was a common trig hack back in the day, and still sees some use in the embedded space.<p>Neural nets can be useful when you have samples of a function but no idea how to approximate it, but that&#x27;s not the case here.</div><br/></div></div></div></div><div id="41745908" class="c"><input type="checkbox" id="c-41745908" checked=""/><div class="controls bullet"><span class="by">hwc</span><span>|</span><a href="#41742005">prev</a><span>|</span><a href="#41740995">next</a><span>|</span><label class="collapse" for="c-41745908">[-]</label><label class="expand" for="c-41745908">[1 more]</label></div><br/><div class="children"><div class="content">Chebyshev is black magic, and I say that even having seen the derivation in a graduate-level course.</div><br/></div></div><div id="41740995" class="c"><input type="checkbox" id="c-41740995" checked=""/><div class="controls bullet"><span class="by">hggigg</span><span>|</span><a href="#41745908">prev</a><span>|</span><a href="#41741441">next</a><span>|</span><label class="collapse" for="c-41740995">[-]</label><label class="expand" for="c-41740995">[3 more]</label></div><br/><div class="children"><div class="content">Rather nice that. I like it.<p>Doesn&#x27;t handle divide by zero very well though i.e. f(x)=1&#x2F;x. Should probably consider that as undefined rather than a bad expression.</div><br/><div id="41741211" class="c"><input type="checkbox" id="c-41741211" checked=""/><div class="controls bullet"><span class="by">tgv</span><span>|</span><a href="#41740995">parent</a><span>|</span><a href="#41741441">next</a><span>|</span><label class="collapse" for="c-41741211">[-]</label><label class="expand" for="c-41741211">[2 more]</label></div><br/><div class="children"><div class="content">You could also set the x_min to 0.001 or so.</div><br/><div id="41741462" class="c"><input type="checkbox" id="c-41741462" checked=""/><div class="controls bullet"><span class="by">stuffmatic</span><span>|</span><a href="#41740995">root</a><span>|</span><a href="#41741211">parent</a><span>|</span><a href="#41741441">next</a><span>|</span><label class="collapse" for="c-41741462">[-]</label><label class="expand" for="c-41741462">[1 more]</label></div><br/><div class="children"><div class="content">Or, since the function expression is just JavaScript, singularities can also be avoided like this: x == 0 ? 1 : Math.sin(x) &#x2F; x</div><br/></div></div></div></div></div></div><div id="41741441" class="c"><input type="checkbox" id="c-41741441" checked=""/><div class="controls bullet"><span class="by">ArmedSandwich</span><span>|</span><a href="#41740995">prev</a><span>|</span><a href="#41742856">next</a><span>|</span><label class="collapse" for="c-41741441">[-]</label><label class="expand" for="c-41741441">[1 more]</label></div><br/><div class="children"><div class="content">This is really nice. Wish I had it back in university, it would have made learning the Chebyshev expansions a lot more interesting than they were.</div><br/></div></div><div id="41742856" class="c"><input type="checkbox" id="c-41742856" checked=""/><div class="controls bullet"><span class="by">anonzzzies</span><span>|</span><a href="#41741441">prev</a><span>|</span><a href="#41741953">next</a><span>|</span><label class="collapse" for="c-41742856">[-]</label><label class="expand" for="c-41742856">[1 more]</label></div><br/><div class="children"><div class="content">Good memories of the 80&#x2F;90s doing this by hand for demos and games ; extra constraint was 8&#x2F;16bits.</div><br/></div></div><div id="41741953" class="c"><input type="checkbox" id="c-41741953" checked=""/><div class="controls bullet"><span class="by">Zeetah</span><span>|</span><a href="#41742856">prev</a><span>|</span><a href="#41743536">next</a><span>|</span><label class="collapse" for="c-41741953">[-]</label><label class="expand" for="c-41741953">[2 more]</label></div><br/><div class="children"><div class="content">Nice!<p>I&#x27;d like to generate a Chebyshev approximation for a set of X, Y sensor values. Any hints on how to modify your code to do that?</div><br/><div id="41742474" class="c"><input type="checkbox" id="c-41742474" checked=""/><div class="controls bullet"><span class="by">stuffmatic</span><span>|</span><a href="#41741953">parent</a><span>|</span><a href="#41743536">next</a><span>|</span><label class="collapse" for="c-41742474">[-]</label><label class="expand" for="c-41742474">[1 more]</label></div><br/><div class="children"><div class="content">You could look into using the ChebyshevExpansion class directly. It takes as one of its arguments a callback that returns f(x) for a given x. In your case, f(x) would be your sensor values with some suitable interpolation. A more ambitious route is to add support for somehow importing tabular data into the app.</div><br/></div></div></div></div><div id="41743536" class="c"><input type="checkbox" id="c-41743536" checked=""/><div class="controls bullet"><span class="by">roger_</span><span>|</span><a href="#41741953">prev</a><span>|</span><a href="#41742329">next</a><span>|</span><label class="collapse" for="c-41743536">[-]</label><label class="expand" for="c-41743536">[1 more]</label></div><br/><div class="children"><div class="content">Great work, looks useful!<p>Any chance you can add a rational function version?</div><br/></div></div><div id="41742329" class="c"><input type="checkbox" id="c-41742329" checked=""/><div class="controls bullet"><span class="by">richrichie</span><span>|</span><a href="#41743536">prev</a><span>|</span><a href="#41745710">next</a><span>|</span><label class="collapse" for="c-41742329">[-]</label><label class="expand" for="c-41742329">[1 more]</label></div><br/><div class="children"><div class="content">Chebyshev polynomials are so powerful and versatile (in approximation) that people think it is a too-good-to-be-true scam and do not use them.<p>One’s first go to method should be Chebyshev. Neural nets used as a last resort.</div><br/></div></div><div id="41745710" class="c"><input type="checkbox" id="c-41745710" checked=""/><div class="controls bullet"><span class="by">mgaunard</span><span>|</span><a href="#41742329">prev</a><span>|</span><a href="#41743615">next</a><span>|</span><label class="collapse" for="c-41745710">[-]</label><label class="expand" for="c-41745710">[2 more]</label></div><br/><div class="children"><div class="content">why not evaluate polynomials using horner or estrin methods</div><br/><div id="41746035" class="c"><input type="checkbox" id="c-41746035" checked=""/><div class="controls bullet"><span class="by">gjm11</span><span>|</span><a href="#41745710">parent</a><span>|</span><a href="#41743615">next</a><span>|</span><label class="collapse" for="c-41746035">[-]</label><label class="expand" for="c-41746035">[1 more]</label></div><br/><div class="children"><div class="content">With either of those, you&#x27;re still representing your polynomial as a combination of powers: 1, x, x^2, x^3, x^4, etc.<p>For many purposes it&#x27;s <i>much</i> better to represent a polynomial as a combination of Chebyshev polynomials: 1, x, 2x^2-1, 4x^3-3x, etc.<p>(Supposing you are primarily interested in values of x between -1 and +1. For other finite intervals, use Chebyshev polynomials but rescale x. If x can get unboundedly large, consider whether polynomials are really the best representation for the functions you&#x27;re approximating.)<p>Handwavy account of why: Those powers of x are uncomfortably <i>similar</i> to one another; if you look at, say, x^4 and x^6, they are both rather close to 0 for smallish x and shoot up towards 1 once x gets close to +-1. So if you have a function whose behaviour is substantially unlike these and represent it as a polynomial, you&#x27;re going to be relying on having those powers largely &quot;cancel one another out&quot;, which means e.g. that when you evaluate your function you&#x27;ll often be representing a smallish number as a combination of much larger numbers, which means you lose a lot of precision.<p>For instance, the function cos(10x) has 7 extrema between x=-1 and x=+1, so you should expect it to be reasonably well approximated by a polynomial of degree not too much bigger than 8. In fact you get a kinda-tolerable approximation with degree 12, and the coefficients of the best-fitting polynomial <i>when represented as a combination of Chebyshev polynomials</i> are all between -1 and +1. So far, so good.<p>If we represent the same function as a combination of powers, the odd-numbered coefficients are zero (as are those when we use the Chebyshev basis; in both cases this is because our function is an even function -- i.e., f(-x) = f(x)), but the even-numbered ones are now approximately 0.975, -4.733, 370.605, -1085.399, 1494.822, -994.178, 259.653. So we&#x27;re representing this function that takes values between -1 and +1 as a sum of terms that take values in the thousands!<p>(Note: this isn&#x27;t actually exactly the best-fitting function; I took a cheaty shortcut to produce something similar to not quite equal to the minimax fit. Also, I make a lot of mistakes and maybe there are some above. But the overall shape of the thing is definitely as I have described.)<p>Since our coefficients will be stored only to some finite precision, this means that when we compute the result we will be losing several digits of accuracy.<p>(In this particular case that&#x27;s fairly meaningless, because when I said &quot;kinda-tolerable&quot; I meant it; the worst-case errors are on the order of 0.03, so losing a few places of accuracy in the <i>calculation</i> won&#x27;t make much difference. But if we use higher-degree polynomials for better accuracy and work in single-precision floating point -- as e.g. we might do if we were doing our calculations on a GPU for speed -- then the difference may really bite us.)<p>It also means that if we want a lower-degree approximation we&#x27;ll have to compute it from scratch, whereas if we take a high-degree Chebyshev-polynomial approximation and just truncate it by throwing out the highest-order terms it usually produces a result very similar to doing the lower-degree calculation from scratch.</div><br/></div></div></div></div><div id="41743615" class="c"><input type="checkbox" id="c-41743615" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#41745710">prev</a><span>|</span><label class="collapse" for="c-41743615">[-]</label><label class="expand" for="c-41743615">[4 more]</label></div><br/><div class="children"><div class="content">Also pretty easy:<p><pre><code>  import numpy as np

  p = np.polynomial.Chebyshev.interpolate(f, degree, domain=(xmin, xmax))

  # insert your code to print out some C code
</code></pre>
Also strongly recommend some basic familiarity with the theory. Approximating `Math.abs(x)` to even a few digits of uniform accuracy on any interval containing 0 requires tens if not hundreds of thousands of coefficients.</div><br/><div id="41743749" class="c"><input type="checkbox" id="c-41743749" checked=""/><div class="controls bullet"><span class="by">lainga</span><span>|</span><a href="#41743615">parent</a><span>|</span><a href="#41745759">next</a><span>|</span><label class="collapse" for="c-41743749">[-]</label><label class="expand" for="c-41743749">[2 more]</label></div><br/><div class="children"><div class="content">what does the<p><pre><code>     # insert your code to print out some C code
</code></pre>
mean?</div><br/><div id="41743776" class="c"><input type="checkbox" id="c-41743776" checked=""/><div class="controls bullet"><span class="by">sfpotter</span><span>|</span><a href="#41743615">root</a><span>|</span><a href="#41743749">parent</a><span>|</span><a href="#41745759">next</a><span>|</span><label class="collapse" for="c-41743776">[-]</label><label class="expand" for="c-41743776">[1 more]</label></div><br/><div class="children"><div class="content">For instance, maybe I want to define an array of these coefficients in C.<p>I could do:<p><pre><code>    print(&#x27;double coef[] = {&#x27;)
    for c in p.coef:
        print(f&#x27;    {c:0.16g},&#x27;)
    print(&#x27;};&#x27;)
</code></pre>
and copy-paste it wherever I need.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>