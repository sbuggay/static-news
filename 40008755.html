<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1712912459811" as="style"/><link rel="stylesheet" href="styles.css?v=1712912459811"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/mhx/dwarfs">DwarFS – Deduplicating Warp-Speed Advanced Read-Only File System</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>pyinstallwoes</span> | <span>21 comments</span></div><br/><div><div id="40010115" class="c"><input type="checkbox" id="c-40010115" checked=""/><div class="controls bullet"><span class="by">mnw21cam</span><span>|</span><a href="#40009443">next</a><span>|</span><label class="collapse" for="c-40010115">[-]</label><label class="expand" for="c-40010115">[2 more]</label></div><br/><div class="children"><div class="content">This is really neat.<p>Feature request: Add a &quot;library&quot; option to give mkdwarfs a list of files that should be loaded into the dedup mechanism first, <i>but not stored</i>, allowing the image to be even smaller if the contents of the file can be retrieved from that library instead. Bonus points if you can specify a dwarfs image as a library and have it sensibly use the files contained in it.<p>Then you have the basis for a deduplicating incremental backup system. Currently, I have a system I wrote that will take a single file and a list of library files and produce a compressed deduplicated file that can re-create that single file using the library, which is great if you use tar to create that single file, but a little unwieldy when coming to decompress and restore everything. The bonus of making it a proper mountable filesystem instead is that then it&#x27;s a proper mountable filesystem and retrieving single files is a doddle.<p>My use case is that I have students, and I have given them coursework, which involves them logging in to a Linux machine and hacking away. I want to store regular snapshots of their work so that I can keep a backup for their sake but also so I can see a progression of development to try to work out if they are cheating (yes, I have had to deal with this), but I don&#x27;t want to store 100 copies of the same fairly large files.</div><br/><div id="40010562" class="c"><input type="checkbox" id="c-40010562" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#40010115">parent</a><span>|</span><a href="#40009443">next</a><span>|</span><label class="collapse" for="c-40010562">[-]</label><label class="expand" for="c-40010562">[1 more]</label></div><br/><div class="children"><div class="content">borg and restic&#x2F;rustic are alternatives that do this multi layered backup thing. they can be mounted as a filesystem as well (the rustic reimplementation of restic however doesn&#x27;t support this yet)<p><a href="https:&#x2F;&#x2F;www.borgbackup.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.borgbackup.org&#x2F;</a><p><a href="https:&#x2F;&#x2F;restic.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;restic.net&#x2F;</a><p><a href="https:&#x2F;&#x2F;github.com&#x2F;rustic-rs&#x2F;rustic">https:&#x2F;&#x2F;github.com&#x2F;rustic-rs&#x2F;rustic</a></div><br/></div></div></div></div><div id="40009443" class="c"><input type="checkbox" id="c-40009443" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#40010115">prev</a><span>|</span><a href="#40009217">next</a><span>|</span><label class="collapse" for="c-40009443">[-]</label><label class="expand" for="c-40009443">[1 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>DwarFS: A fast high compression read-only file system</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=32216275">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=32216275</a> - July 2022 (64 comments)<p><i>DwarFS: A fast high compression read-only file system</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=25246050">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=25246050</a> - Nov 2020 (111 comments)</div><br/></div></div><div id="40009217" class="c"><input type="checkbox" id="c-40009217" checked=""/><div class="controls bullet"><span class="by">m463</span><span>|</span><a href="#40009443">prev</a><span>|</span><a href="#40009086">next</a><span>|</span><label class="collapse" for="c-40009217">[-]</label><label class="expand" for="c-40009217">[2 more]</label></div><br/><div class="children"><div class="content">I always thought a deduplicating squashfs might be really cool for a read-only MAME system.  Since most of the rom files seem to be variants of each other, instead of having zip archives for each game, just put all the raw files in a directory and create a deduplicated squashfs-type filesystem with all of them.</div><br/><div id="40009710" class="c"><input type="checkbox" id="c-40009710" checked=""/><div class="controls bullet"><span class="by">flomo</span><span>|</span><a href="#40009217">parent</a><span>|</span><a href="#40009086">next</a><span>|</span><label class="collapse" for="c-40009710">[-]</label><label class="expand" for="c-40009710">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, the original rationale is kinda perversely interesting:<p>&gt;  my main use case and major motivation was that I had several hundred different versions of Perl<p>okay... The question is if you want to trust a github filesystem or just spend the $dough to deal with it.</div><br/></div></div></div></div><div id="40009086" class="c"><input type="checkbox" id="c-40009086" checked=""/><div class="controls bullet"><span class="by">qwerty456127</span><span>|</span><a href="#40009217">prev</a><span>|</span><a href="#40009975">next</a><span>|</span><label class="collapse" for="c-40009086">[-]</label><label class="expand" for="c-40009086">[4 more]</label></div><br/><div class="children"><div class="content">How do you put the files in it if it&#x27;s read-only?<p>To me it seems such an fs should be immutable-first rather than read-only, i.e. let you create (by copying from another fs) files which just can&#x27;t be changed (can be moved though) ever after. And such would be what I actually need as I have a lot of big and relatively redundant files which aren&#x27;t meant to change (e.g. video files, picture originals, distro and backup disk images etc.).</div><br/><div id="40009633" class="c"><input type="checkbox" id="c-40009633" checked=""/><div class="controls bullet"><span class="by">claudex</span><span>|</span><a href="#40009086">parent</a><span>|</span><a href="#40009107">next</a><span>|</span><label class="collapse" for="c-40009633">[-]</label><label class="expand" for="c-40009633">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s in the man page[1], you put the file at the filesystem creation:<p>$ mkdwarfs -i &#x2F;path&#x2F;dir -o image.dwarfs<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;mhx&#x2F;dwarfs&#x2F;blob&#x2F;main&#x2F;doc&#x2F;mkdwarfs.md">https:&#x2F;&#x2F;github.com&#x2F;mhx&#x2F;dwarfs&#x2F;blob&#x2F;main&#x2F;doc&#x2F;mkdwarfs.md</a></div><br/></div></div><div id="40009107" class="c"><input type="checkbox" id="c-40009107" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#40009086">parent</a><span>|</span><a href="#40009633">prev</a><span>|</span><a href="#40010083">next</a><span>|</span><label class="collapse" for="c-40009107">[-]</label><label class="expand" for="c-40009107">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s meant as squashfs replacement. That is image used for rootfs on live-boot system with overlayfs on top for writable tempfs for example. But I imagine this being useful for many embedded applications in general where you need to save space.</div><br/></div></div><div id="40010083" class="c"><input type="checkbox" id="c-40010083" checked=""/><div class="controls bullet"><span class="by">thesnide</span><span>|</span><a href="#40009086">parent</a><span>|</span><a href="#40009107">prev</a><span>|</span><a href="#40009975">next</a><span>|</span><label class="collapse" for="c-40010083">[-]</label><label class="expand" for="c-40010083">[1 more]</label></div><br/><div class="children"><div class="content">Append only files might be enough to be fair. And still very useful.<p>As then, you can dedup per block, even with a sliding window. Nicest is that you can do it fully asynchronously, so real time appends are not slowed down.</div><br/></div></div></div></div><div id="40009975" class="c"><input type="checkbox" id="c-40009975" checked=""/><div class="controls bullet"><span class="by">kseistrup</span><span>|</span><a href="#40009086">prev</a><span>|</span><a href="#40010248">next</a><span>|</span><label class="collapse" for="c-40009975">[-]</label><label class="expand" for="c-40009975">[1 more]</label></div><br/><div class="children"><div class="content">So how much space would the entire english wikipedia take up on this filesystem, I wonder.</div><br/></div></div><div id="40010248" class="c"><input type="checkbox" id="c-40010248" checked=""/><div class="controls bullet"><span class="by">planetis</span><span>|</span><a href="#40009975">prev</a><span>|</span><a href="#40010169">next</a><span>|</span><label class="collapse" for="c-40010248">[-]</label><label class="expand" for="c-40010248">[2 more]</label></div><br/><div class="children"><div class="content">Neat. This FS is used predominantly in torrents of pirated steam games by a certain group that advertises their work with &quot;play without extracting&quot;.</div><br/><div id="40010618" class="c"><input type="checkbox" id="c-40010618" checked=""/><div class="controls bullet"><span class="by">nextaccountic</span><span>|</span><a href="#40010248">parent</a><span>|</span><a href="#40010169">next</a><span>|</span><label class="collapse" for="c-40010618">[-]</label><label class="expand" for="c-40010618">[1 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;play without extracting&quot;.<p>This kind of feature is really important if you to encourage people to seed even after their download is completed.</div><br/></div></div></div></div><div id="40010169" class="c"><input type="checkbox" id="c-40010169" checked=""/><div class="controls bullet"><span class="by">ku1ik</span><span>|</span><a href="#40010248">prev</a><span>|</span><a href="#40009031">next</a><span>|</span><label class="collapse" for="c-40010169">[-]</label><label class="expand" for="c-40010169">[1 more]</label></div><br/><div class="children"><div class="content">All tech aside, this is the best name for a filesystem, period.</div><br/></div></div><div id="40009031" class="c"><input type="checkbox" id="c-40009031" checked=""/><div class="controls bullet"><span class="by">nrdvana</span><span>|</span><a href="#40010169">prev</a><span>|</span><a href="#40009533">next</a><span>|</span><label class="collapse" for="c-40009031">[-]</label><label class="expand" for="c-40009031">[2 more]</label></div><br/><div class="children"><div class="content">This looks really cool!  though its a bit limited since it is a FUSE module and not a kernel driver, and unlikely to become a kernel module since it is written in C++ with large dependencies :-\<p>Would it be possible to take the core design changes here and apply them to squashfs, and maybe propose a next major version of the squashfs internal format to make all these things possible?</div><br/><div id="40009207" class="c"><input type="checkbox" id="c-40009207" checked=""/><div class="controls bullet"><span class="by">dgfitz</span><span>|</span><a href="#40009031">parent</a><span>|</span><a href="#40009533">next</a><span>|</span><label class="collapse" for="c-40009207">[-]</label><label class="expand" for="c-40009207">[1 more]</label></div><br/><div class="children"><div class="content">Given the prose in the README I don’t get the impression the author has much interest in that.</div><br/></div></div></div></div><div id="40009533" class="c"><input type="checkbox" id="c-40009533" checked=""/><div class="controls bullet"><span class="by">donatj</span><span>|</span><a href="#40009031">prev</a><span>|</span><a href="#40009558">next</a><span>|</span><label class="collapse" for="c-40009533">[-]</label><label class="expand" for="c-40009533">[2 more]</label></div><br/><div class="children"><div class="content">Can someone explain what this is and when I would use it in layman’s terms? I understand it’s a fuse filesystem but don’t understand quite what it does?</div><br/><div id="40009781" class="c"><input type="checkbox" id="c-40009781" checked=""/><div class="controls bullet"><span class="by">taneliv</span><span>|</span><a href="#40009533">parent</a><span>|</span><a href="#40009558">next</a><span>|</span><label class="collapse" for="c-40009781">[-]</label><label class="expand" for="c-40009781">[1 more]</label></div><br/><div class="children"><div class="content">It fills a similar niche as <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;SquashFS" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;SquashFS</a> but has different data compression characteristics.<p>However, since it&#x27;s a FUSE only file system, it&#x27;s difficult to see how it would be used on embedded system firmware, so it could perhaps see use as a distribution mechanism. Similar to tar or zip files, but possibly with (much) better performance for random access, should you need only smaller portion of the whole archive.<p>The author indicates need for keeping multiple similar copies of sets of unchanging files on their computer, and made this to reduce the space needed for them, while retaining the access through the file system. So that is also a use case.</div><br/></div></div></div></div><div id="40009558" class="c"><input type="checkbox" id="c-40009558" checked=""/><div class="controls bullet"><span class="by">tambourine_man</span><span>|</span><a href="#40009533">prev</a><span>|</span><a href="#40009818">next</a><span>|</span><label class="collapse" for="c-40009558">[-]</label><label class="expand" for="c-40009558">[2 more]</label></div><br/><div class="children"><div class="content">This is quite interesting for the similarity hash function alone.<p>But the self-congratulatory tone from description is… unusual, to say the least.</div><br/></div></div><div id="40009818" class="c"><input type="checkbox" id="c-40009818" checked=""/><div class="controls bullet"><span class="by">eigengrau</span><span>|</span><a href="#40009558">prev</a><span>|</span><label class="collapse" for="c-40009818">[-]</label><label class="expand" for="c-40009818">[1 more]</label></div><br/><div class="children"><div class="content">Not to be confused with dwarffs – <a href="https:&#x2F;&#x2F;github.com&#x2F;edolstra&#x2F;dwarffs">https:&#x2F;&#x2F;github.com&#x2F;edolstra&#x2F;dwarffs</a>.</div><br/></div></div></div></div></div></div></div></body></html>