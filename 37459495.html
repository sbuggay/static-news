<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1694422870094" as="style"/><link rel="stylesheet" href="styles.css?v=1694422870094"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://dougseven.com/2014/04/17/knightmare-a-devops-cautionary-tale/">Knightmare: A DevOps Cautionary Tale (2014)</a> <span class="domain">(<a href="https://dougseven.com">dougseven.com</a>)</span></div><div class="subtext"><span>sathishmanohar</span> | <span>183 comments</span></div><br/><div><div id="37459786" class="c"><input type="checkbox" id="c-37459786" checked=""/><div class="controls bullet"><span class="by">lopkeny12ko</span><span>|</span><a href="#37461828">next</a><span>|</span><label class="collapse" for="c-37459786">[-]</label><label class="expand" for="c-37459786">[57 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure how automated deployments would have solved this problem. In fact, if anything, it would have magnified the impact and fallout of the problem.<p>Substitute &quot;a developer forgot to upload the code to one of the servers&quot; for &quot;the deployment agent errored while downloading the new binary&#x2F;code onto the server and a bug in the agent prevented the error from being surfaced.&quot; Now you have the same failure mode, and the impact happens even faster.<p>The blame here lies squarely with the developers--the code was written in a non-backwards-compatible way.</div><br/><div id="37459878" class="c"><input type="checkbox" id="c-37459878" checked=""/><div class="controls bullet"><span class="by">dmurray</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460967">next</a><span>|</span><label class="collapse" for="c-37459878">[-]</label><label class="expand" for="c-37459878">[14 more]</label></div><br/><div class="children"><div class="content">&gt; The blame here lies squarely with the developers--the code was written in a non-backwards-compatible way.<p>The blame completely lies with the risk management team.<p>The market knew there was a terrible problem, Knight knew there was a problem, yet it took 45 minutes of trying various hotfixes before they ceased trading. Either because they didn&#x27;t have a kill switch, or because no one was empowered to pull the kill switch because of the opportunity cost (perhaps pulling the switch at the wrong time costs $500k in opportunity).<p>I worked for a competitor to Knight at the time, and we deployed terrible bugs to production all the time, and during post mortems we couldn&#x27;t fathom the same thing happening to us. A dozen automated systems would have kicked in to stop individual trades, and any senior trader or operations person could have got a kill switch pulled with 60 seconds of dialogue, and not feared the repercussions. Actually, we made way less of Knight&#x27;s $400m than we could have because our risk systems kept shutting strategies down because what was happening was &quot;too good to be true&quot;.</div><br/><div id="37460102" class="c"><input type="checkbox" id="c-37460102" checked=""/><div class="controls bullet"><span class="by">mpeg</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459878">parent</a><span>|</span><a href="#37464046">next</a><span>|</span><label class="collapse" for="c-37460102">[-]</label><label class="expand" for="c-37460102">[1 more]</label></div><br/><div class="children"><div class="content">It’s nice to see your perspective as someone familiar with better systems.<p>I have always found this story fascinating; in my junior days I worked at a relatively big adtech platform (ie billions of impressions per day) and as cowboy as we were about lots of things, all our systems always had kill switches that could stop spending money and I could have pulled them with minimal red tape if I suspected something was wrong.<p>And this was for a platform where our max loss for an hour would have hurt but not killed the business (maybe a six figure loss), I can’t imagine not having layers of risk management systems in HFT software.</div><br/></div></div><div id="37464046" class="c"><input type="checkbox" id="c-37464046" checked=""/><div class="controls bullet"><span class="by">blitzar</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459878">parent</a><span>|</span><a href="#37460102">prev</a><span>|</span><a href="#37461701">next</a><span>|</span><label class="collapse" for="c-37464046">[-]</label><label class="expand" for="c-37464046">[1 more]</label></div><br/><div class="children"><div class="content">I messed around with the idea of a physical big red button kill switch to shut down market making; the IT people thought I was joking - the trading desk just assumed that it was in the design from day 1.</div><br/></div></div><div id="37461701" class="c"><input type="checkbox" id="c-37461701" checked=""/><div class="controls bullet"><span class="by">pxmpxm</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459878">parent</a><span>|</span><a href="#37464046">prev</a><span>|</span><a href="#37463380">next</a><span>|</span><label class="collapse" for="c-37461701">[-]</label><label class="expand" for="c-37461701">[5 more]</label></div><br/><div class="children"><div class="content">They were asleep at the wheel, not unlike all the random brokerages that blew up when swiss central bank pulled the CHF peg in 2015.<p>This is a culture problem - as soon as you load up your trading firm with a bunch of software industry hires, you end up with jiras and change management workflows instead of people on deck that have context for what they&#x27;re doing. That&#x27;s the only way to explain reverse scalping for 45 mins straight.</div><br/><div id="37464529" class="c"><input type="checkbox" id="c-37464529" checked=""/><div class="controls bullet"><span class="by">jwestbury</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461701">parent</a><span>|</span><a href="#37462485">next</a><span>|</span><label class="collapse" for="c-37464529">[-]</label><label class="expand" for="c-37464529">[1 more]</label></div><br/><div class="children"><div class="content">&gt; as soon as you load up your trading firm with a bunch of software industry hires<p>As a software industry hire at a hedge fund right now... I&#x27;d love to see more cross-pollination, because there are so many good things happening on both sides, and so many terrible things happening through just a sheer lack of knowledge.<p>Change management workflows are great and should be used more in finance. But software companies should implement andon cord systems more often (Amazon does; nowhere else I&#x27;ve worked gives that power to anybody at the company).</div><br/></div></div><div id="37462485" class="c"><input type="checkbox" id="c-37462485" checked=""/><div class="controls bullet"><span class="by">ycombobreaker</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461701">parent</a><span>|</span><a href="#37464529">prev</a><span>|</span><a href="#37463380">next</a><span>|</span><label class="collapse" for="c-37462485">[-]</label><label class="expand" for="c-37462485">[3 more]</label></div><br/><div class="children"><div class="content">The CHF de-peg wasn&#x27;t really technology risk.  Brokers lost money because they undervalued CHF&#x2F;EUR risk, undervalued liquidity risk (stop orders were executing FAR worse than expected, or simply failing to execute at all), and didn&#x27;t pay attention to the legal protections afforded to their customers (customer balances went negative but there was no way to recover that money from the customers).  These brokers would have had the same problems even if using pen &amp; paper, they failed to plan (or alternatively, made a conscious bet and lost).</div><br/><div id="37463590" class="c"><input type="checkbox" id="c-37463590" checked=""/><div class="controls bullet"><span class="by">throwaway2037</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37462485">parent</a><span>|</span><a href="#37463380">next</a><span>|</span><label class="collapse" for="c-37463590">[-]</label><label class="expand" for="c-37463590">[2 more]</label></div><br/><div class="children"><div class="content">I think it is worth saying that no one saw that de-peg coming.  Absolutely no one.  Sure there are some crazies who saw it coming, but that same camp is still taking for the HKD-USD de-peg.  It was a shock to everyone on Wall Street.  I am a bit surprised that the Swiss National Bank didn&#x27;t tip off their own banks before doing it.  Both UBS and Credit Suisse were seriously caught off guard when it happened.</div><br/></div></div></div></div></div></div><div id="37463380" class="c"><input type="checkbox" id="c-37463380" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459878">parent</a><span>|</span><a href="#37461701">prev</a><span>|</span><a href="#37460112">next</a><span>|</span><label class="collapse" for="c-37463380">[-]</label><label class="expand" for="c-37463380">[5 more]</label></div><br/><div class="children"><div class="content">&gt; Actually, we made way less of Knight&#x27;s $400m than we could have because our risk systems kept shutting strategies down because what was happening was &quot;too good to be true&quot;.<p>Aren&#x27;t a lot of trades undone anyway by the authorities after such severe market hiccups?</div><br/><div id="37464054" class="c"><input type="checkbox" id="c-37464054" checked=""/><div class="controls bullet"><span class="by">dmurray</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37463380">parent</a><span>|</span><a href="#37463567">next</a><span>|</span><label class="collapse" for="c-37464054">[-]</label><label class="expand" for="c-37464054">[1 more]</label></div><br/><div class="children"><div class="content">Normally trades are undone or amended in price if they are executed far away (say 10%+) from what is determined to be reasonable market prices. And when amended, they get amended to a price that&#x27;s still in the same direction, so the market taker still loses a little bit compared to the fair price.<p>KCG traded in such liquid instruments and in such a way that it didn&#x27;t move the market  that much. They lost a hundred dollars a trade on 4 million trades.<p>The article says some stocks were moved by more than 10%, but as I recall that was a small fraction of them.</div><br/></div></div><div id="37463567" class="c"><input type="checkbox" id="c-37463567" checked=""/><div class="controls bullet"><span class="by">throwaway2037</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37463380">parent</a><span>|</span><a href="#37464054">prev</a><span>|</span><a href="#37460112">next</a><span>|</span><label class="collapse" for="c-37463567">[-]</label><label class="expand" for="c-37463567">[3 more]</label></div><br/><div class="children"><div class="content">This is a good question.  In my experience, I have only see exchange trades reversed when there was a major bug in exchange software.  If the bug is on the client side, tough luck.  And reversing trades done on an exchange is usually a decision for the exchange regulator.  It is a major event that only happens every few years -- at most -- for highly developed exchanges.</div><br/><div id="37464136" class="c"><input type="checkbox" id="c-37464136" checked=""/><div class="controls bullet"><span class="by">dmurray</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37463567">parent</a><span>|</span><a href="#37460112">next</a><span>|</span><label class="collapse" for="c-37464136">[-]</label><label class="expand" for="c-37464136">[2 more]</label></div><br/><div class="children"><div class="content">Reversing or amending a single &quot;fat finger&quot; trade happens all the time and the exchange generally has procedures for this that don&#x27;t involve a regulator.<p>Even in the most controversial recent example - LME cancelling a day&#x27;s worth of nickel trades [0]- I understand it was their call and not any external regulator. That said, while I&#x27;d count LME as a &quot;highly developed exchange&quot;, it&#x27;s the Wild West compared to the US NMS.<p>[0] <a href="https:&#x2F;&#x2F;www.bloomberg.com&#x2F;news&#x2F;articles&#x2F;2022-03-14&#x2F;inside-nickel-s-short-squeeze-how-price-surges-halted-lme-trading#xj4y7vzkg" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.bloomberg.com&#x2F;news&#x2F;articles&#x2F;2022-03-14&#x2F;inside-ni...</a></div><br/><div id="37464349" class="c"><input type="checkbox" id="c-37464349" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37464136">parent</a><span>|</span><a href="#37460112">next</a><span>|</span><label class="collapse" for="c-37464349">[-]</label><label class="expand" for="c-37464349">[1 more]</label></div><br/><div class="children"><div class="content">&gt; [...] the exchange generally has procedures for this that don&#x27;t involve a regulator.<p>That&#x27;s part of why I vaguely referred to &#x27;the authorities&#x27; in my original comment.  I wasn&#x27;t quite sure who&#x27;s doing the amending and reversing, and it wasn&#x27;t too important.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37460967" class="c"><input type="checkbox" id="c-37460967" checked=""/><div class="controls bullet"><span class="by">movedx</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37459878">prev</a><span>|</span><a href="#37459808">next</a><span>|</span><label class="collapse" for="c-37460967">[-]</label><label class="expand" for="c-37460967">[8 more]</label></div><br/><div class="children"><div class="content">CI&#x2F;CD would have have solved this 100%:<p>&gt; ... one of Knight’s technicians did not copy the new code to one of the eight SMARS computer servers. Knight did not have a second technician review this deployment and no one at Knight realized that the Power Peg code had not been removed from the eighth server, nor the new RLP code added.<p>Read this part again:<p>&gt; ... one of Knight’s technicians did not *copy the new code to one of the eight SMARS computer servers*.<p>Yes, of course a CI&#x2F;CD pipeline can fail midway through and only partially deploy the code to a partial number of servers, but I doubt it. And even if that were the case, just off the top of my head I can guarantee an Ansible Playbook would have not only stopped the moment that particular transfer failed, the whole Playbook would have therefore failed, and none of the services would have been restarted (because that would be a final step that wouldn&#x27;t be reached.)<p>This was due to human error and is the very reason CI&#x2F;CD&#x2F;automation is a thing.<p>&gt; Knight did not have a second technician review this deployment and no one at Knight realized that the Power Peg code had not been removed from the eighth server<p>CI&#x2F;CD would have have solved this 100%. A &quot;Pull Request&quot; made against a repository of Ansible code (or whatever you flavour is) would have *PREVENTED* the first technician from ever being able to merge the code into master&#x2F;main (because you have master&#x2F;main protected right... right?), completely preventing the entire process from ever rolling out without a review, which would have hopefully caught the misaligned configuration.<p>DevOps, which is mostly underpinned by CI&#x2F;CD, would have solved this 100%. I&#x27;m very certain of this.</div><br/><div id="37461322" class="c"><input type="checkbox" id="c-37461322" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460967">parent</a><span>|</span><a href="#37462168">next</a><span>|</span><label class="collapse" for="c-37461322">[-]</label><label class="expand" for="c-37461322">[6 more]</label></div><br/><div class="children"><div class="content">Ansible in my experience will stop trying to run subsequent tasks on a server once one of them fails, but it will go ahead with other servers that match the inventory pattern. So it very well could have successfully updated 7 out of 8 hosts.<p>Maybe there is a switch that will stop everything if any task on any host fails but it&#x27;s not the default behavior.<p>At least it would have logged an error that hopefully would have been looked at.</div><br/><div id="37463174" class="c"><input type="checkbox" id="c-37463174" checked=""/><div class="controls bullet"><span class="by">dfinninger</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461322">parent</a><span>|</span><a href="#37463908">next</a><span>|</span><label class="collapse" for="c-37463174">[-]</label><label class="expand" for="c-37463174">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, it’s a runbook config: <a href="https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;2.8&#x2F;user_guide&#x2F;playbooks_error_handling.html#aborting-the-play" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;2.8&#x2F;user_guide&#x2F;playbooks_er...</a></div><br/></div></div><div id="37463908" class="c"><input type="checkbox" id="c-37463908" checked=""/><div class="controls bullet"><span class="by">dtech</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461322">parent</a><span>|</span><a href="#37463174">prev</a><span>|</span><a href="#37461408">next</a><span>|</span><label class="collapse" for="c-37463908">[-]</label><label class="expand" for="c-37463908">[1 more]</label></div><br/><div class="children"><div class="content">&gt; So it very well could have successfully updated 7 out of 8 hosts.<p>The problem was that the feature flag was manually enabled on the host with old code. Presumably with automated deployment the feature flag would never have been toggled if the deployment failed, either because the deployment didn&#x27;t get that far or because the human spotted the failed deployment.</div><br/></div></div><div id="37461408" class="c"><input type="checkbox" id="c-37461408" checked=""/><div class="controls bullet"><span class="by">BoorishBears</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461322">parent</a><span>|</span><a href="#37463908">prev</a><span>|</span><a href="#37462168">next</a><span>|</span><label class="collapse" for="c-37461408">[-]</label><label class="expand" for="c-37461408">[3 more]</label></div><br/><div class="children"><div class="content">I think this is an example of hindsight not always being 20&#x2F;20<p>If you replace each step of the post mortem with a CI&#x2F;CD based alternative, you miss out on the fact CI&#x2F;CD trivializes designs where this wouldn&#x27;t have happened.<p>The &quot;easy default&quot; wouldn&#x27;t be to run a play against 8 hosts manually in your terminal, it&#x27;d be run a playbook with them all baked in, and that would fail correctly by default: <a href="https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;latest&#x2F;playbook_guide&#x2F;playbooks_strategies.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;latest&#x2F;playbook_guide&#x2F;playb...</a><p>The key here is CI&#x2F;CD makes it so its actually <i>less work</i> to run that one play than it is to shoot yourself in the foot with 8 separate invocations.<p>Even in the fact of incompetence&#x2F;laziness&#x2F;oversight, the general framework makes the right choice</div><br/><div id="37463228" class="c"><input type="checkbox" id="c-37463228" checked=""/><div class="controls bullet"><span class="by">dfinninger</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461408">parent</a><span>|</span><a href="#37462168">next</a><span>|</span><label class="collapse" for="c-37463228">[-]</label><label class="expand" for="c-37463228">[2 more]</label></div><br/><div class="children"><div class="content">The easy default here would be to have a runbook that executed on a particular inventory group.<p>The “linear” execution strategy is the default (which you linked to). By default, if there is an error on one host it will continue executing on all other hosts. You need to set a flag to stop executing on all hosts[1].<p>The parent process would not be notified of any failures until the end of the run, unless you supplied a custom callback plugin[2].<p>[1] <a href="https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;2.8&#x2F;user_guide&#x2F;playbooks_error_handling.html#aborting-the-play" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;2.8&#x2F;user_guide&#x2F;playbooks_er...</a><p>[2] <a href="https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;latest&#x2F;plugins&#x2F;callback.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.ansible.com&#x2F;ansible&#x2F;latest&#x2F;plugins&#x2F;callback.htm...</a></div><br/><div id="37464261" class="c"><input type="checkbox" id="c-37464261" checked=""/><div class="controls bullet"><span class="by">BoorishBears</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37463228">parent</a><span>|</span><a href="#37462168">next</a><span>|</span><label class="collapse" for="c-37464261">[-]</label><label class="expand" for="c-37464261">[1 more]</label></div><br/><div class="children"><div class="content">The problem was a human forgot to run a step and no one noticed: The playbook would have failed and the server wouldn&#x27;t have been online to make orders.<p>If you read the article, the other servers were fine and did not contribute to the issue.</div><br/></div></div></div></div></div></div></div></div><div id="37462168" class="c"><input type="checkbox" id="c-37462168" checked=""/><div class="controls bullet"><span class="by">piyh</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460967">parent</a><span>|</span><a href="#37461322">prev</a><span>|</span><a href="#37459808">next</a><span>|</span><label class="collapse" for="c-37462168">[-]</label><label class="expand" for="c-37462168">[1 more]</label></div><br/><div class="children"><div class="content">Tree, meet forest.</div><br/></div></div></div></div><div id="37459808" class="c"><input type="checkbox" id="c-37459808" checked=""/><div class="controls bullet"><span class="by">ledauphin</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460967">prev</a><span>|</span><a href="#37460269">next</a><span>|</span><label class="collapse" for="c-37459808">[-]</label><label class="expand" for="c-37459808">[14 more]</label></div><br/><div class="children"><div class="content">The blame here may indeed lie with whoever decided that reusing an old flag was a good idea. As anyone who has been in software development for any time can attest, this decision was not necessarily - and perhaps not even likely - made by a &quot;developer.&quot;</div><br/><div id="37460439" class="c"><input type="checkbox" id="c-37460439" checked=""/><div class="controls bullet"><span class="by">manicennui</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37459892">next</a><span>|</span><label class="collapse" for="c-37460439">[-]</label><label class="expand" for="c-37460439">[3 more]</label></div><br/><div class="children"><div class="content">9 times out of 10, I see developers making the mistakes that everyone seems to want to blame on non-technical people. There is a massive amount of software being written by people with a wide range of capabilities, and a large number of developers never master the basics. It doesn&#x27;t help that some of the worst tools &quot;win&quot; and offer little protection against many basic mistakes.</div><br/><div id="37461192" class="c"><input type="checkbox" id="c-37461192" checked=""/><div class="controls bullet"><span class="by">xupybd</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460439">parent</a><span>|</span><a href="#37460632">next</a><span>|</span><label class="collapse" for="c-37461192">[-]</label><label class="expand" for="c-37461192">[1 more]</label></div><br/><div class="children"><div class="content">You have to assume people will make mistakes.<p>A great book on that is this <a href="https:&#x2F;&#x2F;www.thenile.co.nz&#x2F;books&#x2F;sidney-dekker&#x2F;the-field-guide-to-understanding-human-error&#x2F;9781472439055?gad=1&amp;gclid=Cj0KCQjw0vWnBhC6ARIsAJpJM6fCSM35CckKh3lq15AyUpaXP-APy_buuxkJnszBeiFagUzbtDugVWUaAoUzEALw_wcB" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.thenile.co.nz&#x2F;books&#x2F;sidney-dekker&#x2F;the-field-guid...</a></div><br/></div></div><div id="37460632" class="c"><input type="checkbox" id="c-37460632" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460439">parent</a><span>|</span><a href="#37461192">prev</a><span>|</span><a href="#37459892">next</a><span>|</span><label class="collapse" for="c-37460632">[-]</label><label class="expand" for="c-37460632">[1 more]</label></div><br/><div class="children"><div class="content">For a group who so thoroughly despises bosses that operate on &#x27;blame allocation&#x27;, we spend a lot of time shopping around for permission to engage in reckless behavior. Most people would call that being a hypocrite.<p>Whereas I would call it... no, hypocrite works just fine.</div><br/></div></div></div></div><div id="37459892" class="c"><input type="checkbox" id="c-37459892" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37460439">prev</a><span>|</span><a href="#37459921">next</a><span>|</span><label class="collapse" for="c-37459892">[-]</label><label class="expand" for="c-37459892">[1 more]</label></div><br/><div class="children"><div class="content">Or at least not by a developer who has made that sort of mistake in the past.<p>I don&#x27;t know what software engineering programs teach these days, but in the 1980s there was very little inclusion of case studies of things that went wrong. This was unlike the courses in the business school (my undergrad was CS major + business minor) nor I would presume what real engineering disciplines teach.<p>My first exposure to a fuckup in production was a fuckup in production on my first job.</div><br/></div></div><div id="37459921" class="c"><input type="checkbox" id="c-37459921" checked=""/><div class="controls bullet"><span class="by">andersa</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37459892">prev</a><span>|</span><a href="#37460476">next</a><span>|</span><label class="collapse" for="c-37459921">[-]</label><label class="expand" for="c-37459921">[4 more]</label></div><br/><div class="children"><div class="content">I wonder if this code was written in c++ or similar, the flags were actually a bitfield, and they repurposed it because they ran out of bits.<p>Need a space here? Oh, let&#x27;s throw out this junk nobody used in 8 years and there we go...</div><br/><div id="37460573" class="c"><input type="checkbox" id="c-37460573" checked=""/><div class="controls bullet"><span class="by">CraigRo</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459921">parent</a><span>|</span><a href="#37460986">next</a><span>|</span><label class="collapse" for="c-37460573">[-]</label><label class="expand" for="c-37460573">[1 more]</label></div><br/><div class="children"><div class="content">It is very hard to change the overall size of the messages, and there&#x27;s a lot of pressure to keep them short.  So it could have been a bitfield or several similar things... e.g a value in a char field</div><br/></div></div><div id="37460986" class="c"><input type="checkbox" id="c-37460986" checked=""/><div class="controls bullet"><span class="by">bluelightning2k</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459921">parent</a><span>|</span><a href="#37460573">prev</a><span>|</span><a href="#37462882">next</a><span>|</span><label class="collapse" for="c-37460986">[-]</label><label class="expand" for="c-37460986">[1 more]</label></div><br/><div class="children"><div class="content">This sounds particularly plausible with it being high frequency trading. Those presumably have optimisations few other applications have</div><br/></div></div><div id="37462882" class="c"><input type="checkbox" id="c-37462882" checked=""/><div class="controls bullet"><span class="by">paradox242</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459921">parent</a><span>|</span><a href="#37460986">prev</a><span>|</span><a href="#37460476">next</a><span>|</span><label class="collapse" for="c-37462882">[-]</label><label class="expand" for="c-37462882">[1 more]</label></div><br/><div class="children"><div class="content">This is the first thing I thought of because otherwise this story doesn&#x27;t make a lot of sense.</div><br/></div></div></div></div><div id="37460476" class="c"><input type="checkbox" id="c-37460476" checked=""/><div class="controls bullet"><span class="by">mijoharas</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37459921">prev</a><span>|</span><a href="#37460243">next</a><span>|</span><label class="collapse" for="c-37460476">[-]</label><label class="expand" for="c-37460476">[2 more]</label></div><br/><div class="children"><div class="content">At the very least have a two deploys - actually removing the old code that relies on it and then repurposing it. Giant foot gun to do it all in one especially without any automated deploys.</div><br/><div id="37460999" class="c"><input type="checkbox" id="c-37460999" checked=""/><div class="controls bullet"><span class="by">bluelightning2k</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460476">parent</a><span>|</span><a href="#37460243">next</a><span>|</span><label class="collapse" for="c-37460999">[-]</label><label class="expand" for="c-37460999">[1 more]</label></div><br/><div class="children"><div class="content">Good point. Actually I think I&#x27;ll treat this as a best practice in general when there&#x27;s a transition</div><br/></div></div></div></div><div id="37460243" class="c"><input type="checkbox" id="c-37460243" checked=""/><div class="controls bullet"><span class="by">Nekhrimah</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37460476">prev</a><span>|</span><a href="#37459918">next</a><span>|</span><label class="collapse" for="c-37460243">[-]</label><label class="expand" for="c-37460243">[1 more]</label></div><br/><div class="children"><div class="content">&gt;whoever decided that reusing an old flag was a good idea.<p>My understanding is that in high frequency trading, minimizing the size of the transmission is paramount. Hence re-purposing an existing flag, rather than adding size to the packet makes some sense.</div><br/></div></div><div id="37459918" class="c"><input type="checkbox" id="c-37459918" checked=""/><div class="controls bullet"><span class="by">lopkeny12ko</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37460243">prev</a><span>|</span><a href="#37460611">next</a><span>|</span><label class="collapse" for="c-37459918">[-]</label><label class="expand" for="c-37459918">[1 more]</label></div><br/><div class="children"><div class="content">I doubt any manager or VP cares or knows enough about the technical details of the code to dictate the name that should be used for a feature flag, of all things.</div><br/></div></div><div id="37460611" class="c"><input type="checkbox" id="c-37460611" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37459808">parent</a><span>|</span><a href="#37459918">prev</a><span>|</span><a href="#37460269">next</a><span>|</span><label class="collapse" for="c-37460611">[-]</label><label class="expand" for="c-37460611">[1 more]</label></div><br/><div class="children"><div class="content">Flag recycling is a task that should be measured in months to quarters, and from what I recall of the postmortem they tried to achieve it in weeks, which is just criminally stupid.<p>It&#x27;s this detail of the story which flips me from sympathy to schadenfreude. You dumb motherfuckers fucked around and found out.</div><br/></div></div></div></div><div id="37460269" class="c"><input type="checkbox" id="c-37460269" checked=""/><div class="controls bullet"><span class="by">schneems</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37459808">prev</a><span>|</span><a href="#37460559">next</a><span>|</span><label class="collapse" for="c-37460269">[-]</label><label class="expand" for="c-37460269">[6 more]</label></div><br/><div class="children"><div class="content">I see this as a problem of not investing enough in the deploy process. (Disclosure: I maintain an open source deploy tool for a living).<p>Charity Majors gave a talk in Euruko that talked a lot about this. Deploy tooling shouldn’t be a bunch of bash scripts in a trench coat, it should be fully staffed, fully tested, and automated within an inch of its life.<p>If you have a deploy process that has some king of immutable architecture, tooling to monitor (failed&#x2F;stuck&#x2F;incomplete) rollouts, and the ability to quickly rollback to a prior known good stage then you have layers of protection and an easy course of action for when things do go sideways. It might not have made this problem impossible, but it would have made it harder to happen.</div><br/><div id="37460589" class="c"><input type="checkbox" id="c-37460589" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460269">parent</a><span>|</span><a href="#37460971">next</a><span>|</span><label class="collapse" for="c-37460589">[-]</label><label class="expand" for="c-37460589">[1 more]</label></div><br/><div class="children"><div class="content">I wrote a tool to automate our hotfix process, and people were somewhat surprised that you could kill the process at any step and start over and it would almost always do the right thing. Like how did you expect it to work? Why replace an error prone process with an error prone and opaque one that you can&#x27;t restart?</div><br/></div></div><div id="37460971" class="c"><input type="checkbox" id="c-37460971" checked=""/><div class="controls bullet"><span class="by">bluelightning2k</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460269">parent</a><span>|</span><a href="#37460589">prev</a><span>|</span><a href="#37460333">next</a><span>|</span><label class="collapse" for="c-37460971">[-]</label><label class="expand" for="c-37460971">[3 more]</label></div><br/><div class="children"><div class="content">Great reply.<p>Counterpoint though: that automation in and of itself is more failure area.<p>I can imagine a similar story where the deployment pipeline incorrectly rolled back due to some change in metric format and caused the infinite loss, for example.<p>The thing with these being a 1 in a million chance is that there&#x27;s thousands of different hypothetical causes. The more parts the harder to predict an interaction and we&#x27;ve all been blindsided by something.<p>I would personally hate the stress of working on such high stakes releases.</div><br/><div id="37461360" class="c"><input type="checkbox" id="c-37461360" checked=""/><div class="controls bullet"><span class="by">schneems</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460971">parent</a><span>|</span><a href="#37460333">next</a><span>|</span><label class="collapse" for="c-37461360">[-]</label><label class="expand" for="c-37461360">[2 more]</label></div><br/><div class="children"><div class="content">Test test test. If that’s not enough, pick better tools. I’m rewriting bash scripts in rust at work because it gives me the ability to make many invalid states impossible to represent in code. Is it overkill? Maybe, but it is such a huge quality of life improvement.<p>Automated things can fail. Sure. But consider that playbooks are just crappy automation run by unreliable meat computers.<p>Also you can take an iterative approach to automation:<p>- manual playbook only<p>- automate one step of the playbook<p>- if it goes well, move to another. If not, run a retro to figure out out how you can improve it and try again.<p>Stress of failure at a job responsible for deployment architecture is manageable if you have a team and culture built around respecting that stress. There are some areas of code people are more careful around, but largely we make safety a product of our tools and processes and not some heroic “try harder not to screw up” attitude.<p>I find the impact of helping so many developers and their companies rewarding.</div><br/><div id="37461584" class="c"><input type="checkbox" id="c-37461584" checked=""/><div class="controls bullet"><span class="by">BoorishBears</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37461360">parent</a><span>|</span><a href="#37460333">next</a><span>|</span><label class="collapse" for="c-37461584">[-]</label><label class="expand" for="c-37461584">[1 more]</label></div><br/><div class="children"><div class="content">Part of the solution is at the level of attitude, just one more productive than &quot;don&#x27;t fuck up&quot;<p>To create a contrived example, say someone reads your note on replacing bash scripts and decides they agree with the principle.<p>They go into work tomorrow, their fellow engineer agrees on the technical merit, and they reimplement a bunch of bash scripts in Rust with a suite of tests bigger than anyone imagined, and life is great.<p>... fast forward a few months from now and suddenly a state the bash scripts were hiding flares up and everyone is lost, and type safety didn&#x27;t help.<p>A shared culture of &quot;conservation of value&quot; can help in a lot of ways there. That&#x27;s the attitude that creation of value is always uncertain, so you prioritize potential future value lower than currently provided value:<p>- instead of looking at technical merit of the new, we prioritize asking: What specific shortcomings the old way have? What can we improve downstream so that the value those systems provide is protected from invalid states we&#x27;re worried about this tool generating?<p>- does switching the language reduce the number of people who can work on it? Do we reduce the effect surface area of the team providing value to it?  When hair is on fire do we know the sysops guy won&#x27;t balk?<p>- when it goes down, with a culture of &quot;conservation of value&quot;, your plan A is always rolling back, there&#x27;s no back and forth on if we can just roll this one fix. If you cause the company to lose a million dollar trade, it&#x27;s already codified that you made the right decision<p>Obviously these are all extensions of a contrived example, but to me culture is heavily utilized as a way to guide better engineering.<p>I think these days people tend to think in terms of culture that affirms, as a reaction to cultures that block anyone from accomplishing anything: to me a good engineering culture is one that clashes with what people want to do just enough to be mildly annoying.</div><br/></div></div></div></div></div></div><div id="37460333" class="c"><input type="checkbox" id="c-37460333" checked=""/><div class="controls bullet"><span class="by">hooverd</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460269">parent</a><span>|</span><a href="#37460971">prev</a><span>|</span><a href="#37460559">next</a><span>|</span><label class="collapse" for="c-37460333">[-]</label><label class="expand" for="c-37460333">[1 more]</label></div><br/><div class="children"><div class="content">&gt; bash scripts in a trench coat
That&#x27;s an amazing turn of phrase.</div><br/></div></div></div></div><div id="37460559" class="c"><input type="checkbox" id="c-37460559" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460269">prev</a><span>|</span><a href="#37461832">next</a><span>|</span><label class="collapse" for="c-37460559">[-]</label><label class="expand" for="c-37460559">[2 more]</label></div><br/><div class="children"><div class="content">The goal with automation is that the number of unidentified corner cases reduces over time.<p>A manual runbook is a game of, &quot;I did step 12, I think I did step 13, so the next step is 14.&quot; that plays out every single time you do server work. The thing with the human brain is that when you interrupt a task you&#x27;ve done a million times in the middle, most people can&#x27;t reliably discern between this iteration and false memories from the last time they did it.<p>So unless there are interlocks that prevent skipping a step, it&#x27;s a gamble every single time. And the effort involved in creating interlocks is a large fraction of the cost of automating.</div><br/><div id="37464543" class="c"><input type="checkbox" id="c-37464543" checked=""/><div class="controls bullet"><span class="by">WJW</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460559">parent</a><span>|</span><a href="#37461832">next</a><span>|</span><label class="collapse" for="c-37464543">[-]</label><label class="expand" for="c-37464543">[1 more]</label></div><br/><div class="children"><div class="content">1. Print the checklist&#x2F;runbook out on paper with actual empty boxes next to the steps.<p>2. Laminate the printed checklist and put it in a big folder.<p>3. Every time you run the checklist, use a sharpie to mark the checkbox after you&#x27;ve done the step.<p>4. When you are done with the entire process, use whiteboard cleaner to wipe out the checks again and put the checklist back in the big folder with all the other checklists.<p>This is how every safety critical profession (aviation, shipping, medical, power generation, etc) has worked for decades and unless people are willingly being obtuse it is extremely hard to do it wrong. You just need people to turn off their ego and follow the process instead of trying to show off by doing it from memory. This last part might be more difficult in software settings.</div><br/></div></div></div></div><div id="37461832" class="c"><input type="checkbox" id="c-37461832" checked=""/><div class="controls bullet"><span class="by">emmelaich</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460559">prev</a><span>|</span><a href="#37463383">next</a><span>|</span><label class="collapse" for="c-37461832">[-]</label><label class="expand" for="c-37461832">[1 more]</label></div><br/><div class="children"><div class="content">Technically, a flag re-use was the most impactful error, code wise.<p>A flag of such importance should not be just on&#x2F;off; the ON should require a positive response &#x2F; receipt containing the name and version of the code being turned on.<p>[edit -  don&#x27;t mean for each trade, I mean validation on startup]</div><br/></div></div><div id="37463383" class="c"><input type="checkbox" id="c-37463383" checked=""/><div class="controls bullet"><span class="by">devjab</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37461832">prev</a><span>|</span><a href="#37460900">next</a><span>|</span><label class="collapse" for="c-37463383">[-]</label><label class="expand" for="c-37463383">[1 more]</label></div><br/><div class="children"><div class="content">&gt; the deployment agent errored while downloading the new binary&#x2F;code onto the server<p>In that case the build would never be pushed to production. The worst it would accomplish, and this is if your systems fail, is that it will break your staging area.<p>Sure this is in the the ideal world where people actually know how to set up their deployment pipelines correctly, so you’re likely still right in many cases, but you shouldn’t be.</div><br/></div></div><div id="37460900" class="c"><input type="checkbox" id="c-37460900" checked=""/><div class="controls bullet"><span class="by">thrashh</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37463383">prev</a><span>|</span><a href="#37460148">next</a><span>|</span><label class="collapse" for="c-37460900">[-]</label><label class="expand" for="c-37460900">[2 more]</label></div><br/><div class="children"><div class="content">I agree. It doesn’t matter if you give an inexperienced person a hammer or a saw — they’ll still screw it up.<p>My biggest pet peeve is they NO ONE ever does failure modeling.<p>I swear everyone builds things assuming it will work perfectly. Then when you mention if one part fails, it will completely bring down everything, they’ll say that it’s a 1 in a million chance. Yeah, the problem isn’t that it’s unlikely, it’s that when it does happen, you’ve perfectly designed your system to destroy itself.</div><br/><div id="37461729" class="c"><input type="checkbox" id="c-37461729" checked=""/><div class="controls bullet"><span class="by">TheAlchemist</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460900">parent</a><span>|</span><a href="#37460148">next</a><span>|</span><label class="collapse" for="c-37461729">[-]</label><label class="expand" for="c-37461729">[1 more]</label></div><br/><div class="children"><div class="content">No one, is quite a bold assumption !<p>It&#x27;s actually quite routine stuff now in finance at least - to perform some kind of &#x27;fire test&#x27; on a regular basis - you shut down some components during the day, and switch to backups solutions, to test everything works smoothly.</div><br/></div></div></div></div><div id="37460148" class="c"><input type="checkbox" id="c-37460148" checked=""/><div class="controls bullet"><span class="by">stusmall</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460900">prev</a><span>|</span><a href="#37460147">next</a><span>|</span><label class="collapse" for="c-37460148">[-]</label><label class="expand" for="c-37460148">[1 more]</label></div><br/><div class="children"><div class="content">I think the big improvement would be consistency.  Either all servers would be correct or all servers would be incorrect.  The step where &quot;Since they were unable to determine what was causing the erroneous orders they reacted by uninstalling the new code from the servers it was deployed to correctly&quot; wouldn&#x27;t have had a negative impact.  They could have even instantly rolled back.  Also if they were using the same automated deployment processes for their test environment they might have even caught this in QA.</div><br/></div></div><div id="37460147" class="c"><input type="checkbox" id="c-37460147" checked=""/><div class="controls bullet"><span class="by">moeris</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460148">prev</a><span>|</span><a href="#37460278">next</a><span>|</span><label class="collapse" for="c-37460147">[-]</label><label class="expand" for="c-37460147">[1 more]</label></div><br/><div class="children"><div class="content">Automated deployments would have allowed you to review the deployment before it happened.  A failed deployment could be configured to allow automatic rollbacks.  Automated deployments should also handle experiment flags, which could have been toggled to reduce impact.  There are a bunch of places where it could have intervened and mitigated&#x2F;prevented this whole situation.</div><br/></div></div><div id="37460278" class="c"><input type="checkbox" id="c-37460278" checked=""/><div class="controls bullet"><span class="by">Waterluvian</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460147">prev</a><span>|</span><a href="#37460225">next</a><span>|</span><label class="collapse" for="c-37460278">[-]</label><label class="expand" for="c-37460278">[1 more]</label></div><br/><div class="children"><div class="content">Which really means is a failure of leadership for being so incompetent as to allow such an intensely risky situation to exist.</div><br/></div></div><div id="37460225" class="c"><input type="checkbox" id="c-37460225" checked=""/><div class="controls bullet"><span class="by">lwhi</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460278">prev</a><span>|</span><a href="#37460718">next</a><span>|</span><label class="collapse" for="c-37460225">[-]</label><label class="expand" for="c-37460225">[3 more]</label></div><br/><div class="children"><div class="content">Automated deployments require planning before the time they&#x27;re executed.<p>If code is involved, someone likely reviews and approves it.<p>There are naturally far more safeguards in place than there would be for a manual deployment.</div><br/><div id="37460274" class="c"><input type="checkbox" id="c-37460274" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460225">parent</a><span>|</span><a href="#37460718">next</a><span>|</span><label class="collapse" for="c-37460274">[-]</label><label class="expand" for="c-37460274">[2 more]</label></div><br/><div class="children"><div class="content">In an ideal world, sure.<p>In the current one, we have Facebook&#x27;s &quot;Move fast and break things&quot; being applied to many things where it has no business being.<p>Banking and communications infrastructure comes to my mind, but there are definitely others. :)</div><br/><div id="37460394" class="c"><input type="checkbox" id="c-37460394" checked=""/><div class="controls bullet"><span class="by">lwhi</span><span>|</span><a href="#37459786">root</a><span>|</span><a href="#37460274">parent</a><span>|</span><a href="#37460718">next</a><span>|</span><label class="collapse" for="c-37460394">[-]</label><label class="expand" for="c-37460394">[1 more]</label></div><br/><div class="children"><div class="content">I think the benefits from automated deployments are things that are just par for the course to be honest.<p>Sure, you can mess these things up .. but doing so would involve willful negligence rather than someone&#x27;s absent mindedness.<p>Basically, I think the takeaway from the article is probably worth taking.</div><br/></div></div></div></div></div></div><div id="37460718" class="c"><input type="checkbox" id="c-37460718" checked=""/><div class="controls bullet"><span class="by">rcpt</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460225">prev</a><span>|</span><a href="#37461247">next</a><span>|</span><label class="collapse" for="c-37460718">[-]</label><label class="expand" for="c-37460718">[1 more]</label></div><br/><div class="children"><div class="content">It seems like the kind of thing that would be canaried which is the kind of thing that you&#x27;d typically build alongside automated deployment</div><br/></div></div><div id="37461247" class="c"><input type="checkbox" id="c-37461247" checked=""/><div class="controls bullet"><span class="by">itsthecourier</span><span>|</span><a href="#37459786">parent</a><span>|</span><a href="#37460718">prev</a><span>|</span><a href="#37461828">next</a><span>|</span><label class="collapse" for="c-37461247">[-]</label><label class="expand" for="c-37461247">[1 more]</label></div><br/><div class="children"><div class="content">Also, api versioning. They weren&#x27;t running api versioning on it, they called an old method with a new set of parameters, that shouldn&#x27;t have been possible in first place</div><br/></div></div></div></div><div id="37461828" class="c"><input type="checkbox" id="c-37461828" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#37459786">prev</a><span>|</span><a href="#37464616">next</a><span>|</span><label class="collapse" for="c-37461828">[-]</label><label class="expand" for="c-37461828">[16 more]</label></div><br/><div class="children"><div class="content">&gt; why code that had been dead for 8-years was still present in the code base is a mystery, but that’s not the point<p>This seems to be exactly the point! For 8 years they left unused code in place, seemingly only bothering to remove it because they wanted to repurpose a flag. If they&#x27;d done the right thing 8 years prior and removed code they weren&#x27;t using, this story plays out very differently. No ancient routines get resurrected, no rogue server.<p>Maybe Knight Capital wasn&#x27;t using version control and held onto this code &quot;just in case&quot;, but I&#x27;ve seen this same resistance to deleting code in programmers working in repos that are completely under VCS, and it&#x27;s flabbergasting. If you need it again, you can always bring it back from version control. If you need it again but forget it&#x27;s there, you&#x27;d do the same with the dead code path. Leaving it in the source tree is pure liability.<p>EDIT: Kevlin Henney gave an excellent talk at GOTO about software reliability and he touches on this, using Knight Capital as the example—he actually cites this very blog post [0]. The whole talk is excellent, but I&#x27;ve linked the three minutes where he talks about Knight Capital.<p>&gt; The problem is there is no code that is truly dead. It turns out all you need to do is make a small assumption, a change of an assumption and then suddenly it&#x27;s no longer dead, it&#x27;s zombie code. It has come back to life and the zombie apocalypse costs money.<p>[0] <a href="https:&#x2F;&#x2F;youtu.be&#x2F;IiGXq3yY70o?si=hZ9HB2dlfj0vHvNK&amp;t=463" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;IiGXq3yY70o?si=hZ9HB2dlfj0vHvNK&amp;t=463</a></div><br/><div id="37462711" class="c"><input type="checkbox" id="c-37462711" checked=""/><div class="controls bullet"><span class="by">TheDong</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37462663">next</a><span>|</span><label class="collapse" for="c-37462711">[-]</label><label class="expand" for="c-37462711">[4 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;ve seen this same resistance to deleting code in programmers working in repos that are completely under VCS, and it&#x27;s flabbergasting<p>I think a lot of developers only know the basics of git. They can check in changes, they can look at history with git log, and maybe they know how to use git blame.<p>They often don&#x27;t know how to filter git history. They often don&#x27;t know about the git pickaxe, or about exclude patterns, and don&#x27;t even think to question if you can do something like &quot;git log -G&#x27;int.*foo\(&#x27; -- &#x27;:(exclude)directory&#x27;&quot; to search for &#x27;foo&#x27; in the git log, excluding some directory.<p>They know how to &quot;grep&quot; within the existing code tree though, so they know if it&#x27;s not deleted they can find it again with the right grep. If it&#x27;s deleted, they might not know how to find it in git history.<p>I sympathize with this to a degree actually. Code in the git log is invisible to a lot of tooling, so for example it won&#x27;t show up in autocomplete if your text editor might have otherwise suggested it, it won&#x27;t show up in your library documentation, etc.<p>If you truly think the code will be used again, I think it&#x27;s at least defensible to leave it in the tree so that it comes along for refactors, and ends up being found when it&#x27;s needed.<p>For cases like Knight capital, where it&#x27;s obviously never going to be useful again, it&#x27;s not defensible of course.</div><br/><div id="37464242" class="c"><input type="checkbox" id="c-37464242" checked=""/><div class="controls bullet"><span class="by">jve</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37462711">parent</a><span>|</span><a href="#37462767">next</a><span>|</span><label class="collapse" for="c-37464242">[-]</label><label class="expand" for="c-37464242">[1 more]</label></div><br/><div class="children"><div class="content">&gt; and don&#x27;t even think to question if you can do something like &quot;git log -G&#x27;int.*foo\(&#x27; -- &#x27;:(exclude)directory&#x27;&quot;<p>I do question it, but I know the answer is hard (as you demonstrated), so I don&#x27;t bother. And I&#x27;m now looking at git log docs - I fail to parse how the exclude works even looking at the docs - I don&#x27;t find anything about `:(` contstruct which houses exclude keyword. But thanks for -G - that will be useful.<p>&gt; Code in the git log is invisible to a lot of tooling<p>This is the issue. I expect when searching code to have a way to search older commits. But azure devops won&#x27;t do it. There is no checkbox &quot;Include all commits&quot;</div><br/></div></div><div id="37462767" class="c"><input type="checkbox" id="c-37462767" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37462711">parent</a><span>|</span><a href="#37464242">prev</a><span>|</span><a href="#37463593">next</a><span>|</span><label class="collapse" for="c-37462767">[-]</label><label class="expand" for="c-37462767">[1 more]</label></div><br/><div class="children"><div class="content">I can understand that argument for small, standalone functions. Where it really gets at me is when people insist on leaving whole use cases or subsystems in place, which seems to be what happened here.<p>You don&#x27;t <i>want</i> these to be visible to autocomplete, because they&#x27;re outdated and would need major modification to be correct again. If you do need to resurrect them, they&#x27;re trivial to find in the git history—just search for the commit named &quot;remove foo&quot;—and they should pass through code review as if they were brand new code, because a lot of stuff will have changed around them in the intervening time.</div><br/></div></div><div id="37463593" class="c"><input type="checkbox" id="c-37463593" checked=""/><div class="controls bullet"><span class="by">bhasi</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37462711">parent</a><span>|</span><a href="#37462767">prev</a><span>|</span><a href="#37462663">next</a><span>|</span><label class="collapse" for="c-37463593">[-]</label><label class="expand" for="c-37463593">[1 more]</label></div><br/><div class="children"><div class="content">&gt; git pickaxe, or about exclude patterns, and don&#x27;t even think to question if you can do something like &quot;git log -G&#x27;int.*foo\(&#x27; -- &#x27;:(exclude)directory&#x27;&quot; to search for &#x27;foo&#x27; in the git log, excluding some directory<p>Learned something new today, thank you! Will find ways to use these in my daily workflow.</div><br/></div></div></div></div><div id="37462663" class="c"><input type="checkbox" id="c-37462663" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37462711">prev</a><span>|</span><a href="#37462692">next</a><span>|</span><label class="collapse" for="c-37462663">[-]</label><label class="expand" for="c-37462663">[1 more]</label></div><br/><div class="children"><div class="content">&quot;If it works, don&#x27;t touch it&quot; is something I&#x27;ve heard a lot, especially said by managers who don&#x27;t understand what they are talking about.<p>An update to simply &quot;remove old code&quot; might be difficult if someone sees <i>any</i> change as creating a risk of something going wrong. And to be fair, any change <i>is</i> a risk, but so is leaving old code around.<p>At least now we have this case to point to as a clear example of the risk.</div><br/></div></div><div id="37462692" class="c"><input type="checkbox" id="c-37462692" checked=""/><div class="controls bullet"><span class="by">asalahli</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37462663">prev</a><span>|</span><a href="#37463557">next</a><span>|</span><label class="collapse" for="c-37462692">[-]</label><label class="expand" for="c-37462692">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m less surprised by them leaving dead code around, honestly. I&#x27;ve seen that happen at virtually every company I&#x27;ve worked for.<p>What completely baffles me everytime I come across their story is that they repurposed an existing flag instead of making a new one! Why?</div><br/></div></div><div id="37463557" class="c"><input type="checkbox" id="c-37463557" checked=""/><div class="controls bullet"><span class="by">philjohn</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37462692">prev</a><span>|</span><a href="#37461974">next</a><span>|</span><label class="collapse" for="c-37463557">[-]</label><label class="expand" for="c-37463557">[1 more]</label></div><br/><div class="children"><div class="content">I always remember the Codeless Code on comments when I read about this: <a href="http:&#x2F;&#x2F;thecodelesscode.com&#x2F;case&#x2F;41?topic=comments" rel="nofollow noreferrer">http:&#x2F;&#x2F;thecodelesscode.com&#x2F;case&#x2F;41?topic=comments</a></div><br/></div></div><div id="37461974" class="c"><input type="checkbox" id="c-37461974" checked=""/><div class="controls bullet"><span class="by">SamuelAdams</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37463557">prev</a><span>|</span><a href="#37464290">next</a><span>|</span><label class="collapse" for="c-37461974">[-]</label><label class="expand" for="c-37461974">[6 more]</label></div><br/><div class="children"><div class="content">Version control isn’t bulletproof either. All your code history is one git rebase away from being abolished forever.<p>I hope most orgs have processes around their main branches so this does not occur, but I’ve also been in smaller orgs and accidentally screwed up prod database tables, so the accidental git rebase isn’t impossible to consider…</div><br/><div id="37462029" class="c"><input type="checkbox" id="c-37462029" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37461974">parent</a><span>|</span><a href="#37461992">next</a><span>|</span><label class="collapse" for="c-37462029">[-]</label><label class="expand" for="c-37462029">[1 more]</label></div><br/><div class="children"><div class="content">Yes, you should definitely have branch protection turned on on main, I kind of assumed that went without saying. But to actually lose your entire git history would require both having no branch protection <i>and</i> having every single developer on your staff be in the regular habit of force rebasing their own branches on main. If a single developer does a double take when they&#x27;re told that their branch has a different history than origin&#x2F;main, then you probably didn&#x27;t lose more than a week of work.<p>Also, it&#x27;s worth noting that this dead code will <i>almost certainly</i> not get reused wherever you decide to store it, so it&#x27;s best to keep it as far away from zombification as possible, even if it&#x27;s not the safest place.</div><br/></div></div><div id="37461992" class="c"><input type="checkbox" id="c-37461992" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37461974">parent</a><span>|</span><a href="#37462029">prev</a><span>|</span><a href="#37463262">next</a><span>|</span><label class="collapse" for="c-37461992">[-]</label><label class="expand" for="c-37461992">[3 more]</label></div><br/><div class="children"><div class="content">&gt; All your code history is one git rebase away from being abolished forever<p>unless you also GC right away, it&#x27;s not gone.</div><br/><div id="37462030" class="c"><input type="checkbox" id="c-37462030" checked=""/><div class="controls bullet"><span class="by">Terr_</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37461992">parent</a><span>|</span><a href="#37463262">next</a><span>|</span><label class="collapse" for="c-37462030">[-]</label><label class="expand" for="c-37462030">[2 more]</label></div><br/><div class="children"><div class="content">Yep, and also:<p>1. You shouldn&#x27;t be allowing anybody to force-push rebased stuff onto major branches in your main repo (the one builds come from) <i>anyway.</i> This is especially important to support auditing and trace-ability.<p>2. Just because the folder is a git-repo isn&#x27;t an excuse not to have it part of your regular offsite backup set.</div><br/><div id="37462970" class="c"><input type="checkbox" id="c-37462970" checked=""/><div class="controls bullet"><span class="by">gorgoiler</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37462030">parent</a><span>|</span><a href="#37463262">next</a><span>|</span><label class="collapse" for="c-37462970">[-]</label><label class="expand" for="c-37462970">[1 more]</label></div><br/><div class="children"><div class="content">There are reasons to want branch protection but audit isn’t one of them.  An auditable system would be keeping an immutable log of the git repo actions in a separate, append-only location.  It wouldn’t rely on the thing being written to all the time, by users, to never get broken.  In your model, your audit history only needs one bug in the branch-protection tool for it to be destroyed.<p>Think of it like syslog.  It’s good to keep a log of events but it’s bad to rely on the &#x2F;var&#x2F;log&#x2F;syslog on your web server.  You should be logging to a remote, append-only system.<p>(However I would concede that if we are talking about lawyer-proof-audit — SOC2, ISO etc — rather than actual security auditing, then branch protection is probably just fine.)</div><br/></div></div></div></div></div></div><div id="37463262" class="c"><input type="checkbox" id="c-37463262" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#37461828">root</a><span>|</span><a href="#37461974">parent</a><span>|</span><a href="#37461992">prev</a><span>|</span><a href="#37464290">next</a><span>|</span><label class="collapse" for="c-37463262">[-]</label><label class="expand" for="c-37463262">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re very unlikely to lose your version history like that.<p>Everywhere I&#x27;ve worked has branch protection turned on, <i>and</i> backups. Even if those both fail somehow it&#x27;s very likely the complete history is on lots of engineers&#x27; laptops.</div><br/></div></div></div></div><div id="37464290" class="c"><input type="checkbox" id="c-37464290" checked=""/><div class="controls bullet"><span class="by">pnt12</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37461974">prev</a><span>|</span><a href="#37463085">next</a><span>|</span><label class="collapse" for="c-37464290">[-]</label><label class="expand" for="c-37464290">[1 more]</label></div><br/><div class="children"><div class="content">nitpick: git is enough to keep the history of old code, but it&#x27;s not great at letting you find it.</div><br/></div></div><div id="37463085" class="c"><input type="checkbox" id="c-37463085" checked=""/><div class="controls bullet"><span class="by">mirekrusin</span><span>|</span><a href="#37461828">parent</a><span>|</span><a href="#37464290">prev</a><span>|</span><a href="#37464616">next</a><span>|</span><label class="collapse" for="c-37463085">[-]</label><label class="expand" for="c-37463085">[1 more]</label></div><br/><div class="children"><div class="content">The morale should be &quot;don&#x27;t reuse feature flags kids&quot;.</div><br/></div></div></div></div><div id="37464616" class="c"><input type="checkbox" id="c-37464616" checked=""/><div class="controls bullet"><span class="by">mariusmg</span><span>|</span><a href="#37461828">prev</a><span>|</span><a href="#37461664">next</a><span>|</span><label class="collapse" for="c-37464616">[-]</label><label class="expand" for="c-37464616">[1 more]</label></div><br/><div class="children"><div class="content">First problem was repurposing flags used in the past for different functionality. Just dont do that.</div><br/></div></div><div id="37461664" class="c"><input type="checkbox" id="c-37461664" checked=""/><div class="controls bullet"><span class="by">TheAlchemist</span><span>|</span><a href="#37464616">prev</a><span>|</span><a href="#37459721">next</a><span>|</span><label class="collapse" for="c-37461664">[-]</label><label class="expand" for="c-37461664">[1 more]</label></div><br/><div class="children"><div class="content">Wild west times ! It&#x27;s worth noting, that things changed a lot in trading systems since then.<p>When I started working in this domain (2009), it was pretty crazy how unreliable those systems were, on all sides - banks, brokers, exchanges. Frequently you needed to make sure over the phone, what quantities got executed etc.<p>I remember when the Italian exchange was rolling out their systems, at some point we did &quot;tests&quot; on a mix of production and UAT - if my memory is correct, we were just changing IPs to which to connect for order passing to test for the upcoming release, after the market closed. We couldn&#x27;t just test in their UAT environment, since it was so bugged and half down most of the time.<p>And let&#x27;s not even talk about Excel spreadsheets with some VBA code that would make chatGPT swear, that were pricing instruments  with volumes traded with a lot of zeros.<p>It&#x27;s very different nowadays, in part thanks to stories like this one. Most things are automated, and there is much less cowboy&#x27;s attitude.<p>There are mandatory kill switches, a lot of layers of risk &#x2F; trading activity monitorings (on your side, on exchange side), and really a lot of hard learned lessons incorporated into the systems. That&#x27;s also part of the reason why people sometime tend to be naive about how hard it is to build a good trading system - the strategies are sometimes now really smart - it&#x27;s mostly about how to avoid getting killed by something that&#x27;s outside of usual conditions.</div><br/></div></div><div id="37459721" class="c"><input type="checkbox" id="c-37459721" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#37461664">prev</a><span>|</span><a href="#37459884">next</a><span>|</span><label class="collapse" for="c-37459721">[-]</label><label class="expand" for="c-37459721">[4 more]</label></div><br/><div class="children"><div class="content">No continuous deployment system I have worked with would have blocked this particular bug.<p>They were in a situation where they were incrementally rolling out, but the code had a logic bug where the failure of one install within an incremental rollout step bankrupted the company.<p>I’d guard against this with runtime checks that the software version (e.g. git sha) matches, and also add fault injection into tests that invoke the software rollout infrastructure.</div><br/><div id="37461881" class="c"><input type="checkbox" id="c-37461881" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#37459721">parent</a><span>|</span><a href="#37459884">next</a><span>|</span><label class="collapse" for="c-37461881">[-]</label><label class="expand" for="c-37461881">[3 more]</label></div><br/><div class="children"><div class="content">No continuous deployment system worth its salt would allow configuration and code to be out of sync. They had a configuration change to turn on a flag that used to enable Power Peg but now enabled something else, plus a code change to reinterpret that flag differently.</div><br/><div id="37462042" class="c"><input type="checkbox" id="c-37462042" checked=""/><div class="controls bullet"><span class="by">chii</span><span>|</span><a href="#37459721">root</a><span>|</span><a href="#37461881">parent</a><span>|</span><a href="#37459884">next</a><span>|</span><label class="collapse" for="c-37462042">[-]</label><label class="expand" for="c-37462042">[2 more]</label></div><br/><div class="children"><div class="content">the situation is caused by a confluence of multiple issues.<p>The biggest red-flag is that they chose to repurpose a flag! Why? Is it really difficult to add a new flag for a new feature?<p>Even if the technician was careful not to let prod be out of sync, it is possible that the deployment isn&#x27;t instantaneous, and that the old code could&#x27;ve ran when the repurposed flag was turned on.</div><br/><div id="37462948" class="c"><input type="checkbox" id="c-37462948" checked=""/><div class="controls bullet"><span class="by">atomicnumber3</span><span>|</span><a href="#37459721">root</a><span>|</span><a href="#37462042">parent</a><span>|</span><a href="#37459884">next</a><span>|</span><label class="collapse" for="c-37462948">[-]</label><label class="expand" for="c-37462948">[1 more]</label></div><br/><div class="children"><div class="content">Some of the trickiness that comes from HFT and adjacent things like this is you can be working on tremendously powerful hardware but still be miserly about bits because every extra byte you have to cram into a packet is extra latency. The HFT firm I worked for would &quot;re-use flags&quot; in the sense that each packet literally had an 8-bit section called &quot;flags&quot; (and further down in the message, another 8 bit section called flags2 because of course) and each bit in there was a Boolean that could be on or off - a flag. So we weren&#x27;t reusing flags as much as we were re-allocating what a high bit at that index in flags meant.<p>We were very conscious of this kind of error though and we managed them like Scrooge counting his farthings.</div><br/></div></div></div></div></div></div></div></div><div id="37459884" class="c"><input type="checkbox" id="c-37459884" checked=""/><div class="controls bullet"><span class="by">valdiorn</span><span>|</span><a href="#37459721">prev</a><span>|</span><a href="#37459995">next</a><span>|</span><label class="collapse" for="c-37459884">[-]</label><label class="expand" for="c-37459884">[4 more]</label></div><br/><div class="children"><div class="content">Literally everyone in quant finance knows about knight capital. It even has its own phrase; &quot;pulling a knight capital&quot; (meaning; cutting corners on mission critical systems, even ones that can bankrupt the company in an instant, and experiencing the consequences)</div><br/><div id="37460223" class="c"><input type="checkbox" id="c-37460223" checked=""/><div class="controls bullet"><span class="by">shric</span><span>|</span><a href="#37459884">parent</a><span>|</span><a href="#37459995">next</a><span>|</span><label class="collapse" for="c-37460223">[-]</label><label class="expand" for="c-37460223">[3 more]</label></div><br/><div class="children"><div class="content">Indeed, it&#x27;s used in onboarding material at my employer.</div><br/><div id="37460582" class="c"><input type="checkbox" id="c-37460582" checked=""/><div class="controls bullet"><span class="by">mxz3000</span><span>|</span><a href="#37459884">root</a><span>|</span><a href="#37460223">parent</a><span>|</span><a href="#37462952">next</a><span>|</span><label class="collapse" for="c-37460582">[-]</label><label class="expand" for="c-37460582">[1 more]</label></div><br/><div class="children"><div class="content">Yeap, it&#x27;s used as a case study for us as to the worst case scenario in trading incidents. Definitely humbling.</div><br/></div></div><div id="37462952" class="c"><input type="checkbox" id="c-37462952" checked=""/><div class="controls bullet"><span class="by">atomicnumber3</span><span>|</span><a href="#37459884">root</a><span>|</span><a href="#37460223">parent</a><span>|</span><a href="#37460582">prev</a><span>|</span><a href="#37459995">next</a><span>|</span><label class="collapse" for="c-37462952">[-]</label><label class="expand" for="c-37462952">[1 more]</label></div><br/><div class="children"><div class="content">Same, we knew of it as the Knightmare too.</div><br/></div></div></div></div></div></div><div id="37459995" class="c"><input type="checkbox" id="c-37459995" checked=""/><div class="controls bullet"><span class="by">pavas</span><span>|</span><a href="#37459884">prev</a><span>|</span><a href="#37461261">next</a><span>|</span><label class="collapse" for="c-37459995">[-]</label><label class="expand" for="c-37459995">[8 more]</label></div><br/><div class="children"><div class="content">My team&#x27;s systems play a critical role for several $100M of sales per day, such that if our systems go down for long enough, these sales will be lost. Long enough means at least several hours and in this time frame we can get things back to a good state, often without much external impact.<p>We too have manual processes in place, but for any manual process we document the rollback steps (before starting) and monitor the deployment. We also separate deployment of code with deployment of features (which is done gradually behind feature flags). We insist that any new features (or modification of code) requires a new feature flag; while this is painful and slow, it has helped us avoid risky situations and panic and alleviated our ops and on-call burden considerably.<p>For something to go horribly wrong, it would have to fail many &quot;filters&quot; of defects: 1. code review--accidentally introducing a behavioral change without a feature flag (this can happen, e.g. updating dependencies), 2. manual and devo testing (which is hit or miss), 3. something in our deployment fails (luckily this is mostly automated, though as with all distributed systems there are edge cases), 4. Rollback fails or is done incorrectly 5. Missing monitoring to alert us that issue still hasn&#x27;t been fixed. 5. Fail to escalate the issue in time to higher-levels. 6. Enough time passes that we miss out on ability to meet our SLA, etc.<p>For any riskier manual changes we can also require two people to make the change (one points out what&#x27;s being changed over a video call, the other verifies).<p>If you&#x27;re dealing with a system where your SLA is in minutes, and changes are irreversible, you need to know how to practically monitor and rollback within minutes, and if you&#x27;re doing something new and manually, you need to quadruple check everything and have someone else watching you make the change, or its only a matter of time before enough things go wrong in a row and you can&#x27;t fix it. It doesn&#x27;t matter how good or smart you are, mistakes will always happen when people have to manually make or initiate a change, and that chance of making mistakes needs to be built into your change management process.</div><br/><div id="37460051" class="c"><input type="checkbox" id="c-37460051" checked=""/><div class="controls bullet"><span class="by">coldtea</span><span>|</span><a href="#37459995">parent</a><span>|</span><a href="#37461261">next</a><span>|</span><label class="collapse" for="c-37460051">[-]</label><label class="expand" for="c-37460051">[7 more]</label></div><br/><div class="children"><div class="content">&gt;<i>My team&#x27;s systems play a critical role for several $100M of sales per day, such that if our systems go down for long enough, these sales will be lost.</i><p>Would they? Or would they just happen later? In a lot of cases in regular commerce, or even B2B, the same sales can often be attempted again by the client for a little later, it&#x27;s not &quot;now or never&quot;. As a user I have retried things I wanted to buy when a vendor was down (usually because of a new announcement and big demand breaking their servers) or when my bank had some maintainance issue, and so on.</div><br/><div id="37460140" class="c"><input type="checkbox" id="c-37460140" checked=""/><div class="controls bullet"><span class="by">pavas</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460051">parent</a><span>|</span><a href="#37460302">next</a><span>|</span><label class="collapse" for="c-37460140">[-]</label><label class="expand" for="c-37460140">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s both (though I would lean towards lost for a majority of them). It&#x27;s also true that the longer the outage, the greater the impact, and you have to take into account knock-on effects such as loss of customer trust. Since these are elastic customer-goods, and ours isn&#x27;t the only marketplace, customers have choice. Customers will typically compare price, then speed.<p>It&#x27;s also probably true that a one-day outage would have a negative net present value (taking into account all future sales) far exceeding the daily loss in sales, due to loss of customer goodwill.</div><br/></div></div><div id="37460302" class="c"><input type="checkbox" id="c-37460302" checked=""/><div class="controls bullet"><span class="by">yardstick</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460051">parent</a><span>|</span><a href="#37460140">prev</a><span>|</span><a href="#37461261">next</a><span>|</span><label class="collapse" for="c-37460302">[-]</label><label class="expand" for="c-37460302">[5 more]</label></div><br/><div class="children"><div class="content">It would be a serious issue for in person transactions like shops, supermarkets, gas stations, etc<p>Imagine Walmart or Costco or Chevron centralised payment services went down for 30+ mins. You would get a lot of lost sales from those who don’t carry enough cash to cover it otherwise. Maybe a retailer might have a zapzap machine but lots of cards aren’t imprinted these days so that’s a non starter too.</div><br/><div id="37461133" class="c"><input type="checkbox" id="c-37461133" checked=""/><div class="controls bullet"><span class="by">squeaky-clean</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460302">parent</a><span>|</span><a href="#37460543">next</a><span>|</span><label class="collapse" for="c-37461133">[-]</label><label class="expand" for="c-37461133">[1 more]</label></div><br/><div class="children"><div class="content">Not just lost sales. I&#x27;ve seen a Walmart lose all ability to do credit card sales and after about 5 minutes maybe 10% of people waiting just started leaving with their groceries in their cart and a middle finger raised to the security telling them to stop.</div><br/></div></div><div id="37460543" class="c"><input type="checkbox" id="c-37460543" checked=""/><div class="controls bullet"><span class="by">kaashif</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460302">parent</a><span>|</span><a href="#37461133">prev</a><span>|</span><a href="#37461261">next</a><span>|</span><label class="collapse" for="c-37460543">[-]</label><label class="expand" for="c-37460543">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Maybe a retailer might have a zapzap machine but lots of cards aren’t imprinted these days so that’s a non starter too.<p>When I Google &quot;zapzap machine&quot; this comment is the only result, but after looking around on Wikipedia, I see this is a typo for &quot;zipzap&quot;.<p>Is this really the only time in history someone has typoed zipzap as zapzap? I guess so.</div><br/><div id="37461018" class="c"><input type="checkbox" id="c-37461018" checked=""/><div class="controls bullet"><span class="by">HellsMaddy</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460543">parent</a><span>|</span><a href="#37461028">next</a><span>|</span><label class="collapse" for="c-37461018">[-]</label><label class="expand" for="c-37461018">[1 more]</label></div><br/><div class="children"><div class="content">For anyone who is still confused: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Credit_card_imprinter" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Credit_card_imprinter</a></div><br/></div></div><div id="37461028" class="c"><input type="checkbox" id="c-37461028" checked=""/><div class="controls bullet"><span class="by">yardstick</span><span>|</span><a href="#37459995">root</a><span>|</span><a href="#37460543">parent</a><span>|</span><a href="#37461018">prev</a><span>|</span><a href="#37461261">next</a><span>|</span><label class="collapse" for="c-37461028">[-]</label><label class="expand" for="c-37461028">[1 more]</label></div><br/><div class="children"><div class="content">Haha yeah I guess so! Last time I used one was in the previous millennium.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37461261" class="c"><input type="checkbox" id="c-37461261" checked=""/><div class="controls bullet"><span class="by">skizm</span><span>|</span><a href="#37459995">prev</a><span>|</span><a href="#37460123">next</a><span>|</span><label class="collapse" for="c-37461261">[-]</label><label class="expand" for="c-37461261">[3 more]</label></div><br/><div class="children"><div class="content">I feel like the first thing I would build into any automated trading system is a kill switch? then every single diff or pull request I add would have some sort of automated testing to ensure the kill switch still works. Also I&#x27;d manually flip it on&#x2F;off once a day to make sure it works for real. That seems like the single most important thing to build and make sure works. Or is the system too complex for something like this and I don&#x27;t understand the domain well enough?</div><br/><div id="37462629" class="c"><input type="checkbox" id="c-37462629" checked=""/><div class="controls bullet"><span class="by">slavboj</span><span>|</span><a href="#37461261">parent</a><span>|</span><a href="#37462976">next</a><span>|</span><label class="collapse" for="c-37462629">[-]</label><label class="expand" for="c-37462629">[1 more]</label></div><br/><div class="children"><div class="content">Depending on what you&#x27;re doing, a straight &quot;pull the plug and stop trading&quot; could leave you with eg unhedged positions that blow through your risk limits.  But when your ability to actually execute those trades sensibly is broken regardless, yeah, you&#x27;re still going to want to hit that button.</div><br/></div></div><div id="37462976" class="c"><input type="checkbox" id="c-37462976" checked=""/><div class="controls bullet"><span class="by">atomicnumber3</span><span>|</span><a href="#37461261">parent</a><span>|</span><a href="#37462629">prev</a><span>|</span><a href="#37460123">next</a><span>|</span><label class="collapse" for="c-37462976">[-]</label><label class="expand" for="c-37462976">[1 more]</label></div><br/><div class="children"><div class="content">Most systems do. At pastjob we had a few different levels:<p>- halt - just stop trading<p>- exit-only - only exit positions (but do so according to our alphas, no hurry)<p>- flatten - exit in a hurry but obey certain limits (often if liquidity was thin we would just &quot;journal&quot; the shares - move them to a long-term-hold (meaning more than the current day) account to exit in the opening auction the next day<p>- market exit - get the fuck out, now, no matter what the cost.<p>I never saw us use that last one.</div><br/></div></div></div></div><div id="37460123" class="c"><input type="checkbox" id="c-37460123" checked=""/><div class="controls bullet"><span class="by">foota</span><span>|</span><a href="#37461261">prev</a><span>|</span><a href="#37463253">next</a><span>|</span><label class="collapse" for="c-37460123">[-]</label><label class="expand" for="c-37460123">[1 more]</label></div><br/><div class="children"><div class="content">The real issue here (sorry for true Scotsman-ing) is that they were using an untested combination of configuration and binary release. Configuration and binaries can be rolled out in lockstep, preventing this class of issues.<p>Of course there were other mistakes here etc., but the issue wouldn&#x27;t have been possible if this weren&#x27;t the case.</div><br/></div></div><div id="37463253" class="c"><input type="checkbox" id="c-37463253" checked=""/><div class="controls bullet"><span class="by">stevage</span><span>|</span><a href="#37460123">prev</a><span>|</span><a href="#37460661">next</a><span>|</span><label class="collapse" for="c-37463253">[-]</label><label class="expand" for="c-37463253">[1 more]</label></div><br/><div class="children"><div class="content">&gt;They had 48-hours to raise the capital necessary to cover their losses (which they managed to do with a $400 million investment from around a half-dozen investors).<p>I&#x27;m very curious about this bit. How exactly do you raise $400m of &quot;investment&quot; to cover such a massive footgun, in 48 hours, when you haven&#x27;t even had time to understand what happened or whether it would happen again?<p>Why are people stumping up hundreds of millions of cash here?</div><br/></div></div><div id="37460661" class="c"><input type="checkbox" id="c-37460661" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#37463253">prev</a><span>|</span><a href="#37460111">next</a><span>|</span><label class="collapse" for="c-37460661">[-]</label><label class="expand" for="c-37460661">[2 more]</label></div><br/><div class="children"><div class="content">Related:<p><i>Knightmare: A DevOps Cautionary Tale (2014)</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=22250847">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=22250847</a> - Feb 2020 (33 comments)<p><i>Knightmare: A DevOps Cautionary Tale (2014)</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=8994701">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=8994701</a> - Feb 2015 (85 comments)<p><i>Knightmare: A DevOps Cautionary Tale</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=7652036">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=7652036</a> - April 2014 (60 comments)<p>Also:<p><i>The $440M software error at Knight Capital (2019)</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=31239033">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=31239033</a> - May 2022 (172 comments)<p><i>Bugs in trading software cost Knight Capital $440M</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4329495">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4329495</a> - Aug 2012 (1 comment)<p><i>Knight Capital Says Trading Glitch Cost It $440 Million</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4329101">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4329101</a> - Aug 2012 (90 comments)<p>Others?</div><br/><div id="37461685" class="c"><input type="checkbox" id="c-37461685" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37460661">parent</a><span>|</span><a href="#37460111">next</a><span>|</span><label class="collapse" for="c-37461685">[-]</label><label class="expand" for="c-37461685">[1 more]</label></div><br/><div class="children"><div class="content">Early theory about the cause (incorrect, as it turns out):<p><i>Nanex ~ 03-Aug-2012 ~ The Knightmare Explaned</i> - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4337359">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=4337359</a> (no comments)</div><br/></div></div></div></div><div id="37460111" class="c"><input type="checkbox" id="c-37460111" checked=""/><div class="controls bullet"><span class="by">dkarl</span><span>|</span><a href="#37460661">prev</a><span>|</span><a href="#37461586">next</a><span>|</span><label class="collapse" for="c-37460111">[-]</label><label class="expand" for="c-37460111">[1 more]</label></div><br/><div class="children"><div class="content">&gt; why code that had been dead for 8-years was still present in the code base is a mystery, but that’s not the point<p>It&#x27;s not the worst mistake in the story, but it&#x27;s not &quot;not the point.&quot; A proactive approach to pruning dead functionality would have resulted in a less complex, better-understood piece of software with less potential to go haywire. Driving relentlessly forward without doing this kind of maintenance work is a risk, calculated or otherwise.</div><br/></div></div><div id="37461586" class="c"><input type="checkbox" id="c-37461586" checked=""/><div class="controls bullet"><span class="by">quickthrower2</span><span>|</span><a href="#37460111">prev</a><span>|</span><a href="#37459963">next</a><span>|</span><label class="collapse" for="c-37461586">[-]</label><label class="expand" for="c-37461586">[1 more]</label></div><br/><div class="children"><div class="content">Hold on. Are we blaming the plane crash on the pilot here? It seems there is so much other stuff wrong with this company first that such a deployment would tank it.<p>No kill switch. Literally needs to be a power switch and a trader who runs to the room and flips it. Ridiculously small amount of cash for the trading volume, and no way to borrow more to stay in business (but that borrowing requiring manual intervention no accessible to the trading system). Obviously the decision to leave that code in there, and for there to be config setting to bring it back.<p>Then the devops stuff - rollback plans, approvals, pairing on deployments, etc.</div><br/></div></div><div id="37459963" class="c"><input type="checkbox" id="c-37459963" checked=""/><div class="controls bullet"><span class="by">daft_pink</span><span>|</span><a href="#37461586">prev</a><span>|</span><a href="#37459761">next</a><span>|</span><label class="collapse" for="c-37459963">[-]</label><label class="expand" for="c-37459963">[19 more]</label></div><br/><div class="children"><div class="content">I&#x27;m so glad I don&#x27;t write code that automatically routes millions of dollars with no human intervention.<p>It&#x27;s like writing code that flies a jumbo jet.<p>Who wants that kind of responsibility.</div><br/><div id="37460361" class="c"><input type="checkbox" id="c-37460361" checked=""/><div class="controls bullet"><span class="by">Waterluvian</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37460190">next</a><span>|</span><label class="collapse" for="c-37460361">[-]</label><label class="expand" for="c-37460361">[1 more]</label></div><br/><div class="children"><div class="content">It’s not scary when it’s done properly.  And done properly can look like an incredibly tedious job. I think it’s for a certain kind of person who loves the process and the tests and the simulators and the redundancy. Where only 1% of the engineering is the code that flies the plane.</div><br/></div></div><div id="37460190" class="c"><input type="checkbox" id="c-37460190" checked=""/><div class="controls bullet"><span class="by">callalex</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37460361">prev</a><span>|</span><a href="#37460862">next</a><span>|</span><label class="collapse" for="c-37460190">[-]</label><label class="expand" for="c-37460190">[3 more]</label></div><br/><div class="children"><div class="content">It’s fine to have that kind of responsibility, but it has to actually be your responsibility. Which means you have to be empowered to say “no, we aren’t shipping this until XYZ is fixed” even if XYZ will take another two years to build and the boss wants to ship tomorrow.</div><br/><div id="37460675" class="c"><input type="checkbox" id="c-37460675" checked=""/><div class="controls bullet"><span class="by">salawat</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37460190">parent</a><span>|</span><a href="#37460862">next</a><span>|</span><label class="collapse" for="c-37460675">[-]</label><label class="expand" for="c-37460675">[2 more]</label></div><br/><div class="children"><div class="content">Yep. Until the capacity to say unoverridably &quot;No&quot; materializes, there&#x27;s a lot of code I refuse to have responsibility for delegated to me.</div><br/><div id="37460948" class="c"><input type="checkbox" id="c-37460948" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37460675">parent</a><span>|</span><a href="#37460862">next</a><span>|</span><label class="collapse" for="c-37460948">[-]</label><label class="expand" for="c-37460948">[1 more]</label></div><br/><div class="children"><div class="content">As a profit non-taker, which responsibility a worker can even have? Realistically it lies in range of their monthly paycheck and pending bonuses and in a moral obligation to operate a failing system until it lands somewhere. Everything above it is a systemic risk for a profit taker which if left unaddressed is absolutely on them. There’s no way you can take responsibility for $400M unless you have that money.</div><br/></div></div></div></div></div></div><div id="37460862" class="c"><input type="checkbox" id="c-37460862" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37460190">prev</a><span>|</span><a href="#37461790">next</a><span>|</span><label class="collapse" for="c-37460862">[-]</label><label class="expand" for="c-37460862">[1 more]</label></div><br/><div class="children"><div class="content">It feels anxiety inducing at first, but if you have good controls and monitoring in place, it becomes daily routine. You basically address the points you naturally have and the more reasonably anxious you are, the better for the business. From my experience with finance, I’d wager that problem at Knight was 10% tech issues, 90% CTO-ish person feeling ballsy. In general, not exactly that day or week.</div><br/></div></div><div id="37461790" class="c"><input type="checkbox" id="c-37461790" checked=""/><div class="controls bullet"><span class="by">shric</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37460862">prev</a><span>|</span><a href="#37459990">next</a><span>|</span><label class="collapse" for="c-37461790">[-]</label><label class="expand" for="c-37461790">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know if it&#x27;s like this at every company, but typically there are plenty of humans keeping a close eye on what&#x27;s going on whenever the software is placing orders on an exchange.<p>I suspect we can thank this incident in part.</div><br/></div></div><div id="37459990" class="c"><input type="checkbox" id="c-37459990" checked=""/><div class="controls bullet"><span class="by">hgomersall</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37461790">prev</a><span>|</span><a href="#37460270">next</a><span>|</span><label class="collapse" for="c-37459990">[-]</label><label class="expand" for="c-37459990">[10 more]</label></div><br/><div class="children"><div class="content">I&#x27;m so glad I&#x27;m not wasting my life working in finance.</div><br/><div id="37460262" class="c"><input type="checkbox" id="c-37460262" checked=""/><div class="controls bullet"><span class="by">shric</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37459990">parent</a><span>|</span><a href="#37461742">next</a><span>|</span><label class="collapse" for="c-37460262">[-]</label><label class="expand" for="c-37460262">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve worked in various small to medium IT companies, a FAANG and another fortune 500 tech company. 6 months ago I moved to a proprietary trading company&#x2F;market maker and it&#x27;s the most interesting and satisfying place I&#x27;ve worked so far.<p>I hope to continue to &quot;waste my life&quot; for many years to come.</div><br/><div id="37460824" class="c"><input type="checkbox" id="c-37460824" checked=""/><div class="controls bullet"><span class="by">hammeiam</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37460262">parent</a><span>|</span><a href="#37461742">next</a><span>|</span><label class="collapse" for="c-37460824">[-]</label><label class="expand" for="c-37460824">[1 more]</label></div><br/><div class="children"><div class="content">May I ask which one, and what your process was that led you to them?</div><br/></div></div></div></div><div id="37461742" class="c"><input type="checkbox" id="c-37461742" checked=""/><div class="controls bullet"><span class="by">pxmpxm</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37459990">parent</a><span>|</span><a href="#37460262">prev</a><span>|</span><a href="#37461350">next</a><span>|</span><label class="collapse" for="c-37461742">[-]</label><label class="expand" for="c-37461742">[2 more]</label></div><br/><div class="children"><div class="content">Actually it&#x27;s one of the few truly intellectually-pure endeavors. Everything else is the same pursuit with extra steps:<p>Make a trading strategy to <i>make money</i><p>vs<p>Make a cutting edge machine learning classifier to back out latent meaning in search queries to produce better search results to drive more traffic to google to sell ads to <i>make money</i></div><br/><div id="37463548" class="c"><input type="checkbox" id="c-37463548" checked=""/><div class="controls bullet"><span class="by">hgomersall</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37461742">parent</a><span>|</span><a href="#37461350">next</a><span>|</span><label class="collapse" for="c-37463548">[-]</label><label class="expand" for="c-37463548">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re not wrong, but the problem is those steps are also the steps that produce food, or improve health, or solve climate change or solve any of the innumerable problems we face as a society. As you identify, there are plenty of pursuits other than finance that are not particularly socially useful - it&#x27;s not a very exclusive club.</div><br/></div></div></div></div><div id="37461350" class="c"><input type="checkbox" id="c-37461350" checked=""/><div class="controls bullet"><span class="by">TheAlchemist</span><span>|</span><a href="#37459963">root</a><span>|</span><a href="#37459990">parent</a><span>|</span><a href="#37461742">prev</a><span>|</span><a href="#37460171">next</a><span>|</span><label class="collapse" for="c-37461350">[-]</label><label class="expand" for="c-37461350">[1 more]</label></div><br/><div class="children"><div class="content">Out of curiosity - in what domain do you work ?<p>I find the work in finance &#x2F; tech very interesting. Societally useful ? Almost certainly not. But probably still more than most good-paying tech jobs.</div><br/></div></div></div></div><div id="37460270" class="c"><input type="checkbox" id="c-37460270" checked=""/><div class="controls bullet"><span class="by">m463</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37459990">prev</a><span>|</span><a href="#37463402">next</a><span>|</span><label class="collapse" for="c-37460270">[-]</label><label class="expand" for="c-37460270">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s like writing code that flies a jumbo jet.<p>and upgrading it from a coach seat</div><br/></div></div><div id="37463402" class="c"><input type="checkbox" id="c-37463402" checked=""/><div class="controls bullet"><span class="by">Galanwe</span><span>|</span><a href="#37459963">parent</a><span>|</span><a href="#37460270">prev</a><span>|</span><a href="#37459761">next</a><span>|</span><label class="collapse" for="c-37463402">[-]</label><label class="expand" for="c-37463402">[1 more]</label></div><br/><div class="children"><div class="content">Things are somewhat different now than 5, 10, 20 years ago.<p>There has been a wave of &quot;individual accountability regimes&quot; released by pretty much every regulator.<p>I have worked with the SFC the most, so that&#x27;s what I will describe here, but all these regulations are pretty much copy&#x2F;paste of each other anyway.<p>I was MIC under the SFC (HK) for various operational and financial resps for approx 8 years responsible for close to $3B exposure across equities, IRS &amp; FX, and am now licensed with the FCA (UK) since approx 1 year.<p>Basically, on top of the usual regulatory framework defining a top level Operating Officer (MOO) and subordinate Responsible Officers (RO), the new individual accountability regime creates the notion of Managers In Charge (MIC).<p>The MICs fill the gap that, increasingly, a considerable amount of operational responsibility lie in the hands of non licensed individuals (i. e. tech people).<p>The SFC defines a number of responsabilites (e.g. DRP&#x2F;BCP, kill switches, backups, fail overs, rollbacks, load testing, etc) and these responsibilites need to be allocated to one or more of the allocated MIC.<p>The SFC has a right to reject an appointment of MIC if the individual is not seen as fit and proper (that is assessed generally on an annual basis by a compliance officer, but can be re-assessed on the spot if you end up displaying unfit traits). The SFC also mandates a track record of experience and expertise on the assigned responsibilities, as well as a direct capability by the MIC to have control on his responsibilities. In clear terms, that means you need to have the actual power of saying &quot;no&quot;, you need to have the power to hire someone if that is necessary for the safety of the operations, etc.<p>Once you get appointed as MIC, most of your responsibilities are based on _means_, not _end results_:<p>If Karen breaks production, that&#x27;s not much of your problem (regulatorily speaking) as long as you can demonstrate that you had Karen attend 6h of training this year on how not to break production.<p>In terms of actual developer experience, the _means_ often take the form of trainings, code review, pre prod impact assessment, incident reporting procedures, etc.<p>So on one hand you have a very heavy personal and professional responsibility. But on the other end you are at fault only if you did not setup a proper framework for things to work.<p>In terms of the professional responsibility, there is not much to do if you are deemed guilty. You will most likely be temporarily or permanently barred from having a licensed position. Nobody will hire you anyway.<p>For the personal responsibility, it is usually limited to single digit millions, and most big asset managers have an insurance to protect you (otherwise noone would accept the role).<p>If you are interested in the actual additional responsibilities that were added after KC, then I suggest you have a look at MiFID II (the European régulation, well written and understandable), especially segment RTS 6 &quot;Technical standards specifying the organisational requirements of investment firms engaged in algorithmic trading&quot;:<p><a href="https:&#x2F;&#x2F;ec.europa.eu&#x2F;finance&#x2F;securities&#x2F;docs&#x2F;isd&#x2F;mifid&#x2F;rts&#x2F;160719-rts-6_en.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;ec.europa.eu&#x2F;finance&#x2F;securities&#x2F;docs&#x2F;isd&#x2F;mifid&#x2F;rts&#x2F;1...</a></div><br/></div></div></div></div><div id="37459761" class="c"><input type="checkbox" id="c-37459761" checked=""/><div class="controls bullet"><span class="by">hyperhopper</span><span>|</span><a href="#37459963">prev</a><span>|</span><a href="#37460230">next</a><span>|</span><label class="collapse" for="c-37459761">[-]</label><label class="expand" for="c-37459761">[19 more]</label></div><br/><div class="children"><div class="content">Yes, the deployment practices were bad, but they still would have had an issue even with proper practices.<p>The real issue was re-using an old flag. That should have never been thought of or approved.</div><br/><div id="37460004" class="c"><input type="checkbox" id="c-37460004" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#37459761">parent</a><span>|</span><a href="#37460484">next</a><span>|</span><label class="collapse" for="c-37460004">[-]</label><label class="expand" for="c-37460004">[13 more]</label></div><br/><div class="children"><div class="content">I would argue the real issue was the lack of an automated system (or multiple automated systems) that would hit the kill switch if the trading activity didn’t look right.</div><br/><div id="37463152" class="c"><input type="checkbox" id="c-37463152" checked=""/><div class="controls bullet"><span class="by">leaflets2</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460004">parent</a><span>|</span><a href="#37460364">next</a><span>|</span><label class="collapse" for="c-37463152">[-]</label><label class="expand" for="c-37463152">[1 more]</label></div><br/><div class="children"><div class="content">Yes definitely, one has to assume that from time to time, bugs will reach the prod servers, no amount of tests and code review can completely prevent that.<p>Hopefully the kill switch system is reasonably easy to code review and test :-)</div><br/></div></div><div id="37460364" class="c"><input type="checkbox" id="c-37460364" checked=""/><div class="controls bullet"><span class="by">distortionfield</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460004">parent</a><span>|</span><a href="#37463152">prev</a><span>|</span><a href="#37460484">next</a><span>|</span><label class="collapse" for="c-37460364">[-]</label><label class="expand" for="c-37460364">[11 more]</label></div><br/><div class="children"><div class="content">But how would you even start to define something as stochastic as trading activity as “not looking right”?</div><br/><div id="37460913" class="c"><input type="checkbox" id="c-37460913" checked=""/><div class="controls bullet"><span class="by">Jorge1o1</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460364">parent</a><span>|</span><a href="#37462250">next</a><span>|</span><label class="collapse" for="c-37460913">[-]</label><label class="expand" for="c-37460913">[7 more]</label></div><br/><div class="children"><div class="content">I’ve had to fill out forms for new algorithms &#x2F; quant strategies with questions like:<p>- how many orders per minute do you expect to create?<p>- how many orders per minute do you expect to cancel&#x2F;amend?<p>- what’s your max per-ticker position?<p>- what’s your max strategy-level GMV&#x2F;NMV?<p>Etc.<p>Any one of those questions can be used to set up killswitches.<p>[edited for formatting]</div><br/><div id="37460988" class="c"><input type="checkbox" id="c-37460988" checked=""/><div class="controls bullet"><span class="by">distortionfield</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460913">parent</a><span>|</span><a href="#37462250">next</a><span>|</span><label class="collapse" for="c-37460988">[-]</label><label class="expand" for="c-37460988">[6 more]</label></div><br/><div class="children"><div class="content">Sure, but there is always the possibility that then you shut down trading when things _arent_ broken.<p>There are always two error rates.<p>Defining behavior is great for retrospective analysis but would you really feel comfortable putting hard cuts into production based on the answers to those questions? I’m genuinely asking, because IME I wouldn’t be.</div><br/><div id="37463234" class="c"><input type="checkbox" id="c-37463234" checked=""/><div class="controls bullet"><span class="by">leaflets2</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460988">parent</a><span>|</span><a href="#37461655">next</a><span>|</span><label class="collapse" for="c-37463234">[-]</label><label class="expand" for="c-37463234">[1 more]</label></div><br/><div class="children"><div class="content">A way to add limits when being clueless:<p>Estimate what a real human can do in a day, and use that as the limits. Verify that the system behaves ok for some time, then scale up the desired trading volume and limits, observe, scale, repeat.<p>But you don&#x27;t do it by making a (bad) guess up front and then just leaving it at that.</div><br/></div></div><div id="37461655" class="c"><input type="checkbox" id="c-37461655" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460988">parent</a><span>|</span><a href="#37463234">prev</a><span>|</span><a href="#37462250">next</a><span>|</span><label class="collapse" for="c-37461655">[-]</label><label class="expand" for="c-37461655">[4 more]</label></div><br/><div class="children"><div class="content">That last nine in a trading system uptime has exponentially low value unless you have customers who care quite a lot.<p>Seriously, suppose you have a truly awesome system making $100B per year of revenue. If you unnecessarily shut down 0.1% of the time, that’s only $100M per year lost, and an 0.1% unnecessary shutdown rate seems pretty high.</div><br/><div id="37461868" class="c"><input type="checkbox" id="c-37461868" checked=""/><div class="controls bullet"><span class="by">distortionfield</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37461655">parent</a><span>|</span><a href="#37462250">next</a><span>|</span><label class="collapse" for="c-37461868">[-]</label><label class="expand" for="c-37461868">[3 more]</label></div><br/><div class="children"><div class="content">&gt; That last nine in a trading system uptime has exponentially low value<p>IME that last 9 is where all the action happens<p>&gt; unless you have customers who care quite a lot<p>All customers care about their trades. I’ve worked with these systems. You can’t treat smaller traders as less-than.<p>&gt; only $100M<p>How far removed from the problem do you have to be to think one hundred million dollars is not going to effect anyone?</div><br/><div id="37463016" class="c"><input type="checkbox" id="c-37463016" checked=""/><div class="controls bullet"><span class="by">Narkov</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37461868">parent</a><span>|</span><a href="#37463042">next</a><span>|</span><label class="collapse" for="c-37463016">[-]</label><label class="expand" for="c-37463016">[1 more]</label></div><br/><div class="children"><div class="content">&gt; How far removed from the problem do you have to be to think one hundred million dollars is not going to effect anyone?<p>If $10b is at risk, $100m is not a lot for an insurance policy.</div><br/></div></div><div id="37463042" class="c"><input type="checkbox" id="c-37463042" checked=""/><div class="controls bullet"><span class="by">amluto</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37461868">parent</a><span>|</span><a href="#37463016">prev</a><span>|</span><a href="#37462250">next</a><span>|</span><label class="collapse" for="c-37463042">[-]</label><label class="expand" for="c-37463042">[1 more]</label></div><br/><div class="children"><div class="content">Not all automated trading systems <i>have</i> customers.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37462250" class="c"><input type="checkbox" id="c-37462250" checked=""/><div class="controls bullet"><span class="by">piyh</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460364">parent</a><span>|</span><a href="#37460913">prev</a><span>|</span><a href="#37460529">next</a><span>|</span><label class="collapse" for="c-37462250">[-]</label><label class="expand" for="c-37462250">[1 more]</label></div><br/><div class="children"><div class="content">&quot;If we lose 100 million dollars in 20 minutes&quot; seems like a good one.</div><br/></div></div><div id="37460529" class="c"><input type="checkbox" id="c-37460529" checked=""/><div class="controls bullet"><span class="by">mxz3000</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460364">parent</a><span>|</span><a href="#37462250">prev</a><span>|</span><a href="#37460484">next</a><span>|</span><label class="collapse" for="c-37460529">[-]</label><label class="expand" for="c-37460529">[2 more]</label></div><br/><div class="children"><div class="content">spamming the market with orders for one</div><br/><div id="37460997" class="c"><input type="checkbox" id="c-37460997" checked=""/><div class="controls bullet"><span class="by">distortionfield</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37460529">parent</a><span>|</span><a href="#37460484">next</a><span>|</span><label class="collapse" for="c-37460997">[-]</label><label class="expand" for="c-37460997">[1 more]</label></div><br/><div class="children"><div class="content">Define “spamming”, then? High frequency traders would probably look a lot like spammers.<p>There are always two error rates.</div><br/></div></div></div></div></div></div></div></div><div id="37460484" class="c"><input type="checkbox" id="c-37460484" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#37459761">parent</a><span>|</span><a href="#37460004">prev</a><span>|</span><a href="#37459948">next</a><span>|</span><label class="collapse" for="c-37460484">[-]</label><label class="expand" for="c-37460484">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s definitely more to this story.  Why was there a fixed number of &quot;flags&quot; so that they needed to be reused?  I wish there was a true technical explanation.</div><br/></div></div><div id="37459948" class="c"><input type="checkbox" id="c-37459948" checked=""/><div class="controls bullet"><span class="by">Neil44</span><span>|</span><a href="#37459761">parent</a><span>|</span><a href="#37460484">prev</a><span>|</span><a href="#37459845">next</a><span>|</span><label class="collapse" for="c-37459948">[-]</label><label class="expand" for="c-37459948">[1 more]</label></div><br/><div class="children"><div class="content">I can only think that it was some kind of fixed binary blob of 1&#x2F;0 flags where all the positions had been used umpteen times over the years and nobody wanted to mess with the system to replace it with something better.</div><br/></div></div><div id="37459845" class="c"><input type="checkbox" id="c-37459845" checked=""/><div class="controls bullet"><span class="by">notnmeyer</span><span>|</span><a href="#37459761">parent</a><span>|</span><a href="#37459948">prev</a><span>|</span><a href="#37460230">next</a><span>|</span><label class="collapse" for="c-37459845">[-]</label><label class="expand" for="c-37459845">[3 more]</label></div><br/><div class="children"><div class="content">this is what stood out to me reading the story. i wonder if there was a reason why they opted for this, however half-baked.<p>it reads less to me like a case for devops as it does a case for better practices at every stage of development. how arrogant or willfully ignorant do you have to be to operate like this considering  what’s at stake?</div><br/><div id="37459933" class="c"><input type="checkbox" id="c-37459933" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37459845">parent</a><span>|</span><a href="#37460230">next</a><span>|</span><label class="collapse" for="c-37459933">[-]</label><label class="expand" for="c-37459933">[2 more]</label></div><br/><div class="children"><div class="content">They probably already had a bitfield of feature flags, maybe it was a 16-bit integer and full, and someone notices &quot;hey this one is old, we can reuse it and not have to change the datatype&quot;</div><br/><div id="37459955" class="c"><input type="checkbox" id="c-37459955" checked=""/><div class="controls bullet"><span class="by">notnmeyer</span><span>|</span><a href="#37459761">root</a><span>|</span><a href="#37459933">parent</a><span>|</span><a href="#37460230">next</a><span>|</span><label class="collapse" for="c-37459955">[-]</label><label class="expand" for="c-37459955">[1 more]</label></div><br/><div class="children"><div class="content">ah, yeah—hadn’t considered that!</div><br/></div></div></div></div></div></div></div></div><div id="37460230" class="c"><input type="checkbox" id="c-37460230" checked=""/><div class="controls bullet"><span class="by">xyst</span><span>|</span><a href="#37459761">prev</a><span>|</span><a href="#37461421">next</a><span>|</span><label class="collapse" for="c-37460230">[-]</label><label class="expand" for="c-37460230">[13 more]</label></div><br/><div class="children"><div class="content">Having worked in some Fortune 500 financial firms and low rent “fintech” upstarts, I am not surprised this happened. Decades of bandaid fixes, years of rotating out different consultants&#x2F;contractors, and software rot. Plus years of emphasizing mid level management over software quality.<p>As other have mentioned, I don’t think “automation of deployment” would have prevented this company’s inevitable downfall. If it wasn’t this one incident in 2014, then it would have been another incident later on.</div><br/><div id="37460287" class="c"><input type="checkbox" id="c-37460287" checked=""/><div class="controls bullet"><span class="by">jonplackett</span><span>|</span><a href="#37460230">parent</a><span>|</span><a href="#37460534">next</a><span>|</span><label class="collapse" for="c-37460287">[-]</label><label class="expand" for="c-37460287">[9 more]</label></div><br/><div class="children"><div class="content">The thing I was surprised about is that they survived!<p>After all that they still got a $400 million cash bailout!</div><br/><div id="37460414" class="c"><input type="checkbox" id="c-37460414" checked=""/><div class="controls bullet"><span class="by">xcv123</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460287">parent</a><span>|</span><a href="#37460383">next</a><span>|</span><label class="collapse" for="c-37460414">[-]</label><label class="expand" for="c-37460414">[2 more]</label></div><br/><div class="children"><div class="content">They were probably worth much more than $400M before the failure so it was a good investment opportunity. They would have been a money printing machine aside from this one major fuckup.</div><br/><div id="37460752" class="c"><input type="checkbox" id="c-37460752" checked=""/><div class="controls bullet"><span class="by">nly</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460414">parent</a><span>|</span><a href="#37460383">next</a><span>|</span><label class="collapse" for="c-37460752">[-]</label><label class="expand" for="c-37460752">[1 more]</label></div><br/><div class="children"><div class="content">Their IP (proprietary trading algos) etc were probably worth a lot at the time.<p>These days probably not so. I wouldn&#x27;t imagine there are any market makers left in NYSE and NASDAQ who aren&#x27;t deploying FPGAs to gain a speed edge.</div><br/></div></div></div></div><div id="37460383" class="c"><input type="checkbox" id="c-37460383" checked=""/><div class="controls bullet"><span class="by">m_0x</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460287">parent</a><span>|</span><a href="#37460414">prev</a><span>|</span><a href="#37460404">next</a><span>|</span><label class="collapse" for="c-37460383">[-]</label><label class="expand" for="c-37460383">[3 more]</label></div><br/><div class="children"><div class="content">It wasn&#x27;t a bailout, it was investment money.<p>Bailout could imply government throwing a lifeguard</div><br/><div id="37460481" class="c"><input type="checkbox" id="c-37460481" checked=""/><div class="controls bullet"><span class="by">kaashif</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460383">parent</a><span>|</span><a href="#37460404">next</a><span>|</span><label class="collapse" for="c-37460481">[-]</label><label class="expand" for="c-37460481">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It wasn&#x27;t a bailout, it was investment money.<p>Almost all bailouts are investments, whether it&#x27;s a government or private bailout.<p>The investments are questionable sometimes, but they&#x27;re still investments.</div><br/><div id="37460528" class="c"><input type="checkbox" id="c-37460528" checked=""/><div class="controls bullet"><span class="by">leoqa</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460481">parent</a><span>|</span><a href="#37460404">next</a><span>|</span><label class="collapse" for="c-37460528">[-]</label><label class="expand" for="c-37460528">[1 more]</label></div><br/><div class="children"><div class="content">The nuance is a) what happens to existing equity stakeholders and b) does the bailout have to be repaid.<p>If the answer is nothing and no, then it’s a bailout philosophically. If the existing investors get diluted then they’re in part paying for the new capital injection.</div><br/></div></div></div></div></div></div><div id="37460404" class="c"><input type="checkbox" id="c-37460404" checked=""/><div class="controls bullet"><span class="by">ben-gy</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460287">parent</a><span>|</span><a href="#37460383">prev</a><span>|</span><a href="#37460389">next</a><span>|</span><label class="collapse" for="c-37460404">[-]</label><label class="expand" for="c-37460404">[2 more]</label></div><br/><div class="children"><div class="content">It wasn’t a bail out, it was an opportunity for investors to get great terms on equity at a crucial juncture for the company.</div><br/><div id="37460433" class="c"><input type="checkbox" id="c-37460433" checked=""/><div class="controls bullet"><span class="by">swores</span><span>|</span><a href="#37460230">root</a><span>|</span><a href="#37460404">parent</a><span>|</span><a href="#37460389">next</a><span>|</span><label class="collapse" for="c-37460433">[-]</label><label class="expand" for="c-37460433">[1 more]</label></div><br/><div class="children"><div class="content">A government bail out isn&#x27;t the exclusive use of the phrase &quot;bail out&quot;, it was both a bail out and an opportunity for investors to get great terms on equity.</div><br/></div></div></div></div></div></div><div id="37460534" class="c"><input type="checkbox" id="c-37460534" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#37460230">parent</a><span>|</span><a href="#37460287">prev</a><span>|</span><a href="#37460735">next</a><span>|</span><label class="collapse" for="c-37460534">[-]</label><label class="expand" for="c-37460534">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s an entire industry built on adrenaline, bravado, and let&#x27;s be honest: testosterone. How could their IT discipline be described as anything other than &quot;YOLO&quot;?<p>Trading is mostly based on a book that, like the waterfall model, was meant to be a cautionary tale on how <i>not</i> to do things. Liars&#x27; Poker had the exact opposite effect of Silent Spring. Imagine if Rachel Carson&#x27;s book came out and people decided that a career in pesticides was more glamorous than being a doctor or a laywer, we made movies glorifying spraying pesticides everywhere and on everything, and telling anyone who thought you were crazy that they&#x27;re a jealous loser and to fuck off.</div><br/></div></div></div></div><div id="37461421" class="c"><input type="checkbox" id="c-37461421" checked=""/><div class="controls bullet"><span class="by">brundolf</span><span>|</span><a href="#37460230">prev</a><span>|</span><a href="#37459846">next</a><span>|</span><label class="collapse" for="c-37461421">[-]</label><label class="expand" for="c-37461421">[1 more]</label></div><br/><div class="children"><div class="content">Much as I enjoy articles that reinforce my existing beliefs, high-frequency trading is a pretty extreme example when it comes to how how badly things can go in a short time</div><br/></div></div><div id="37459846" class="c"><input type="checkbox" id="c-37459846" checked=""/><div class="controls bullet"><span class="by">gumballindie</span><span>|</span><a href="#37461421">prev</a><span>|</span><a href="#37461080">next</a><span>|</span><label class="collapse" for="c-37459846">[-]</label><label class="expand" for="c-37459846">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Had Knight implemented an automated deployment system – complete with configuration, deployment and test automation – the error that cause the Knightmare would have been avoided.<p>Would it have been avoided though? Configuration, deployment and test automation mean nothing if they don&#x27;t do what they are supposed to do. Regardless of how many tests you have, if you don&#x27;t test for the right stuff it&#x27;s all useless.</div><br/><div id="37461095" class="c"><input type="checkbox" id="c-37461095" checked=""/><div class="controls bullet"><span class="by">bluelightning2k</span><span>|</span><a href="#37459846">parent</a><span>|</span><a href="#37461080">next</a><span>|</span><label class="collapse" for="c-37461095">[-]</label><label class="expand" for="c-37461095">[1 more]</label></div><br/><div class="children"><div class="content">Yes. It would have.<p>The specific part is configuration as code. So the config change (flag activation) and code change (flag calling) would have been synchronized.<p>And there wouldn&#x27;t have been one server of 8 with a different build for a meaningful time and also if it did fail to deploy on that one server it would have been obvious.</div><br/></div></div></div></div><div id="37461080" class="c"><input type="checkbox" id="c-37461080" checked=""/><div class="controls bullet"><span class="by">dilyevsky</span><span>|</span><a href="#37459846">prev</a><span>|</span><a href="#37461171">next</a><span>|</span><label class="collapse" for="c-37461080">[-]</label><label class="expand" for="c-37461080">[1 more]</label></div><br/><div class="children"><div class="content">Their issue was neglecting an automated SCRAM system that would halt all the trading or any alerting with manual intervention. The article touches on that. There was no excuse why the system wasn’t halted by 9:32 which would’ve avoided most of the kerfuffle</div><br/></div></div><div id="37461171" class="c"><input type="checkbox" id="c-37461171" checked=""/><div class="controls bullet"><span class="by">civilized</span><span>|</span><a href="#37461080">prev</a><span>|</span><a href="#37462849">next</a><span>|</span><label class="collapse" for="c-37461171">[-]</label><label class="expand" for="c-37461171">[2 more]</label></div><br/><div class="children"><div class="content">I see a lot of criticism of the deployment, but why did the developers &quot;repurpose an old flag&quot; that activates 8 years dead code that you haven&#x27;t deleted and that has completely unknown current functionality? That seems like the strangest decision made in this debacle.</div><br/><div id="37463315" class="c"><input type="checkbox" id="c-37463315" checked=""/><div class="controls bullet"><span class="by">leaflets2</span><span>|</span><a href="#37461171">parent</a><span>|</span><a href="#37462849">next</a><span>|</span><label class="collapse" for="c-37463315">[-]</label><label class="expand" for="c-37463315">[1 more]</label></div><br/><div class="children"><div class="content">To save time, I guess.  They deleted the inactive code, so, why not, they thought. But then they forgot to deploy that change (to one server).<p>Bugs and configuration errors will happen from time to time, and might look silly in retrospect. But the real problem was, I think, that there was no kill switch (managers and tech leads should have decided to add long ago)</div><br/></div></div></div></div><div id="37462849" class="c"><input type="checkbox" id="c-37462849" checked=""/><div class="controls bullet"><span class="by">zsoltkacsandi</span><span>|</span><a href="#37461171">prev</a><span>|</span><a href="#37459637">next</a><span>|</span><label class="collapse" for="c-37462849">[-]</label><label class="expand" for="c-37462849">[1 more]</label></div><br/><div class="children"><div class="content">This has nothing to do with “DevOps”, and I am getting tired of this word.
This mistake could have been prevented on multiple levels, and in my experience, deployments that involves major architectural changes rarely repeatable or can be fully automated.</div><br/></div></div><div id="37459637" class="c"><input type="checkbox" id="c-37459637" checked=""/><div class="controls bullet"><span class="by">supportengineer</span><span>|</span><a href="#37462849">prev</a><span>|</span><a href="#37462762">next</a><span>|</span><label class="collapse" for="c-37459637">[-]</label><label class="expand" for="c-37459637">[4 more]</label></div><br/><div class="children"><div class="content">They were missing any kind of risk mitigation steps, in their deployment practice.</div><br/><div id="37459674" class="c"><input type="checkbox" id="c-37459674" checked=""/><div class="controls bullet"><span class="by">hyperhello</span><span>|</span><a href="#37459637">parent</a><span>|</span><a href="#37460478">next</a><span>|</span><label class="collapse" for="c-37459674">[-]</label><label class="expand" for="c-37459674">[2 more]</label></div><br/><div class="children"><div class="content">There’s no money for that.</div><br/><div id="37459705" class="c"><input type="checkbox" id="c-37459705" checked=""/><div class="controls bullet"><span class="by">earnesti</span><span>|</span><a href="#37459637">root</a><span>|</span><a href="#37459674">parent</a><span>|</span><a href="#37460478">next</a><span>|</span><label class="collapse" for="c-37459705">[-]</label><label class="expand" for="c-37459705">[1 more]</label></div><br/><div class="children"><div class="content">It is funny, but in one company I was working for, the more people they added the more they neglected all basics, such as backups. There were heavy processes for many things and they were followed very well, but for whatever reasons some really basic things went unnoticed for many years.</div><br/></div></div></div></div><div id="37460478" class="c"><input type="checkbox" id="c-37460478" checked=""/><div class="controls bullet"><span class="by">Gibbon1</span><span>|</span><a href="#37459637">parent</a><span>|</span><a href="#37459674">prev</a><span>|</span><a href="#37462762">next</a><span>|</span><label class="collapse" for="c-37460478">[-]</label><label class="expand" for="c-37460478">[1 more]</label></div><br/><div class="children"><div class="content">I think Goldman Sachs or someone big like that had a similar oopsie. And what happened was the exchange reversed all their bad trades.</div><br/></div></div></div></div><div id="37462762" class="c"><input type="checkbox" id="c-37462762" checked=""/><div class="controls bullet"><span class="by">KnuthIsGod</span><span>|</span><a href="#37459637">prev</a><span>|</span><a href="#37460601">next</a><span>|</span><label class="collapse" for="c-37462762">[-]</label><label class="expand" for="c-37462762">[1 more]</label></div><br/><div class="children"><div class="content">Not so simple.
The company was then used as a building block to to create another entity, which was then acquired for over a billion dollars.<p>&quot;The company agreed to be acquired by Getco LLC in December 2012 after an August 2012 trading error lost $460 million. The merger was completed in July 2013, forming KCG Holdings.<p>...On April 20, 2017, KCG announced that it had agreed to be acquired by Virtu Financial for $20 per share in cash in a deal valued at approximately $1.4 billion.&quot;</div><br/></div></div><div id="37460601" class="c"><input type="checkbox" id="c-37460601" checked=""/><div class="controls bullet"><span class="by">motoboi</span><span>|</span><a href="#37462762">prev</a><span>|</span><a href="#37459872">next</a><span>|</span><label class="collapse" for="c-37460601">[-]</label><label class="expand" for="c-37460601">[1 more]</label></div><br/><div class="children"><div class="content">Changes we make to software and hardware infrastructure are essentially hypotheses. They&#x27;re backed by evidence suggesting that these modifications will achieve our intended objectives.<p>What&#x27;s crucial is to assess how accurately your hypothesis reflects the reality once it&#x27;s been implemented. Above all, it&#x27;s important to establish an instance that would definitively disprove your hypothesis - an event that wouldn&#x27;t occur if your hypothesis holds true.<p>Harnessing this viewpoint can help you sidestep a multitude of issues.</div><br/></div></div><div id="37459872" class="c"><input type="checkbox" id="c-37459872" checked=""/><div class="controls bullet"><span class="by">nickdothutton</span><span>|</span><a href="#37460601">prev</a><span>|</span><a href="#37459645">next</a><span>|</span><label class="collapse" for="c-37459872">[-]</label><label class="expand" for="c-37459872">[1 more]</label></div><br/><div class="children"><div class="content">“The code that that was updated repurposed an old flag…”
Was as far as I needed to read. Never do this.</div><br/></div></div><div id="37459645" class="c"><input type="checkbox" id="c-37459645" checked=""/><div class="controls bullet"><span class="by">taspeotis</span><span>|</span><a href="#37459872">prev</a><span>|</span><a href="#37461719">next</a><span>|</span><label class="collapse" for="c-37459645">[-]</label><label class="expand" for="c-37459645">[1 more]</label></div><br/><div class="children"><div class="content">Needs (2014) in the title.</div><br/></div></div><div id="37461719" class="c"><input type="checkbox" id="c-37461719" checked=""/><div class="controls bullet"><span class="by">danielvaughn</span><span>|</span><a href="#37459645">prev</a><span>|</span><a href="#37461015">next</a><span>|</span><label class="collapse" for="c-37461719">[-]</label><label class="expand" for="c-37461719">[2 more]</label></div><br/><div class="children"><div class="content">I worked in fintech for a few years. I&#x27;ll never again work on software that&#x27;s responsible for trading, you could offer $1M&#x2F;year and I wouldn&#x27;t take it. By far the most stress I&#x27;ve ever experienced at a job.</div><br/><div id="37462791" class="c"><input type="checkbox" id="c-37462791" checked=""/><div class="controls bullet"><span class="by">CraigRo</span><span>|</span><a href="#37461719">parent</a><span>|</span><a href="#37461015">next</a><span>|</span><label class="collapse" for="c-37462791">[-]</label><label class="expand" for="c-37462791">[1 more]</label></div><br/><div class="children"><div class="content">We used to tell each other what stall we were going to. It is fun, like playing video games, but also super stressful.</div><br/></div></div></div></div><div id="37461015" class="c"><input type="checkbox" id="c-37461015" checked=""/><div class="controls bullet"><span class="by">0xFEE1DEAD</span><span>|</span><a href="#37461719">prev</a><span>|</span><a href="#37461560">next</a><span>|</span><label class="collapse" for="c-37461015">[-]</label><label class="expand" for="c-37461015">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t exactly understand what this has to do with continuous delivery, but maybe I just don&#x27;t know enough about this topic.<p>Wouldn&#x27;t it have been best to set up a &#x27;shadow infrastructure&#x27; and route every trade into it for several weeks&#x2F;months to verify the correctness of the system?</div><br/></div></div><div id="37461560" class="c"><input type="checkbox" id="c-37461560" checked=""/><div class="controls bullet"><span class="by">siliconc0w</span><span>|</span><a href="#37461015">prev</a><span>|</span><a href="#37460089">next</a><span>|</span><label class="collapse" for="c-37461560">[-]</label><label class="expand" for="c-37461560">[3 more]</label></div><br/><div class="children"><div class="content">While nice automated deployment is the wrong lesson here, it&#x27;s really not anticipating backwards incompatibility and poor altering and incident training.<p>Flags should never be reused and should be retired after they&#x27;re no longer useful.</div><br/><div id="37461677" class="c"><input type="checkbox" id="c-37461677" checked=""/><div class="controls bullet"><span class="by">ChrisMarshallNY</span><span>|</span><a href="#37461560">parent</a><span>|</span><a href="#37460089">next</a><span>|</span><label class="collapse" for="c-37461677">[-]</label><label class="expand" for="c-37461677">[2 more]</label></div><br/><div class="children"><div class="content"><i>&gt; Flags should never be reused and should be retired after they&#x27;re no longer useful.</i><p>That&#x27;s such a &quot;no-brainer,&quot; that I don&#x27;t think it&#x27;s even written down, anywhere.<p>When I read that, I was like, &quot;Whut?&quot;<p>In the Days of Yore, when we hammered programs directly into the iron as Machine Code, we would do stuff like that, but I can&#x27;t even imagine doing that with any halfway modern language. They don&#x27;t say, but it&#x27;s probably C++. I know that&#x27;s popular for HFT.</div><br/><div id="37462812" class="c"><input type="checkbox" id="c-37462812" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#37461560">root</a><span>|</span><a href="#37461677">parent</a><span>|</span><a href="#37460089">next</a><span>|</span><label class="collapse" for="c-37462812">[-]</label><label class="expand" for="c-37462812">[1 more]</label></div><br/><div class="children"><div class="content">Possibly Fortran.</div><br/></div></div></div></div></div></div><div id="37460089" class="c"><input type="checkbox" id="c-37460089" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37461560">prev</a><span>|</span><label class="collapse" for="c-37460089">[-]</label><label class="expand" for="c-37460089">[10 more]</label></div><br/><div class="children"><div class="content">&gt; (why code that had been dead for 8-years was still present in the code base is a mystery, but that’s not the point).<p>Actually it&#x27;s a big part of the point: they have a system that works with dead code in it.  If you remove that dead code perhaps it unwittingly breaks something else.<p>That kinds of chesterson&#x27;s fence is a good practice.</div><br/><div id="37460135" class="c"><input type="checkbox" id="c-37460135" checked=""/><div class="controls bullet"><span class="by">rkuykendall-com</span><span>|</span><a href="#37460089">parent</a><span>|</span><a href="#37460220">next</a><span>|</span><label class="collapse" for="c-37460135">[-]</label><label class="expand" for="c-37460135">[8 more]</label></div><br/><div class="children"><div class="content">Leaving dead code in is not good practice?? I would love more explanation here because that sounds like crazy talk to me.</div><br/><div id="37460209" class="c"><input type="checkbox" id="c-37460209" checked=""/><div class="controls bullet"><span class="by">OtherShrezzing</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460135">parent</a><span>|</span><a href="#37460199">next</a><span>|</span><label class="collapse" for="c-37460209">[-]</label><label class="expand" for="c-37460209">[2 more]</label></div><br/><div class="children"><div class="content">Chesterton&#x27;s Fence states that you shouldn&#x27;t make a change until you understand something&#x27;s current state. Removing code because it&#x27;s dead is folly, if you don&#x27;t understand 1) why it&#x27;s there, and 2) why nobody else removed it yet.</div><br/><div id="37460387" class="c"><input type="checkbox" id="c-37460387" checked=""/><div class="controls bullet"><span class="by">meiraleal</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460209">parent</a><span>|</span><a href="#37460199">next</a><span>|</span><label class="collapse" for="c-37460387">[-]</label><label class="expand" for="c-37460387">[1 more]</label></div><br/><div class="children"><div class="content">As this is a postmortem, it was proven dead code. There is nothing in the text that mentions that they didn&#x27;t know what the code did (which then wouldn&#x27;t be dead code).</div><br/></div></div></div></div><div id="37460199" class="c"><input type="checkbox" id="c-37460199" checked=""/><div class="controls bullet"><span class="by">lionkor</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460135">parent</a><span>|</span><a href="#37460209">prev</a><span>|</span><a href="#37460184">next</a><span>|</span><label class="collapse" for="c-37460199">[-]</label><label class="expand" for="c-37460199">[1 more]</label></div><br/><div class="children"><div class="content">It may not be obvious that it&#x27;s dead code - in a lot of popular interpreted languages, it&#x27;s impossible to tell if a given function can be called or not</div><br/></div></div><div id="37460159" class="c"><input type="checkbox" id="c-37460159" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460135">parent</a><span>|</span><a href="#37460184">prev</a><span>|</span><a href="#37460220">next</a><span>|</span><label class="collapse" for="c-37460159">[-]</label><label class="expand" for="c-37460159">[3 more]</label></div><br/><div class="children"><div class="content">You&#x27;ll have to ask the author of the article.</div><br/><div id="37460185" class="c"><input type="checkbox" id="c-37460185" checked=""/><div class="controls bullet"><span class="by">fphhotchips</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460159">parent</a><span>|</span><a href="#37460220">next</a><span>|</span><label class="collapse" for="c-37460185">[-]</label><label class="expand" for="c-37460185">[2 more]</label></div><br/><div class="children"><div class="content">Your original comment is somewhat unclear. Are you advocating for leaving old code in because the system works and it&#x27;s more stable that way, or taking it out to force the necessary refactoring steps and understanding that will bring?</div><br/><div id="37460399" class="c"><input type="checkbox" id="c-37460399" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37460089">root</a><span>|</span><a href="#37460185">parent</a><span>|</span><a href="#37460220">next</a><span>|</span><label class="collapse" for="c-37460399">[-]</label><label class="expand" for="c-37460399">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m sorry I wasn&#x27;t clear: I re-read my comment and couldn&#x27;t think of a decent edit.<p>It was the author whom I was quoting as saying &quot;why would someone have old code lying around.&quot;  It seems obvious why that&#x27;s a good idea and it seems commenters in this thread (including you) agree with me and not the author.<p>Sorry again if I was unclear.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>