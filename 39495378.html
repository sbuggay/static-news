<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1708938059326" as="style"/><link rel="stylesheet" href="styles.css?v=1708938059326"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://jpmens.net/2024/02/23/totp-codes-in-the-terminal/">TOTP Codes in the Terminal</a> <span class="domain">(<a href="https://jpmens.net">jpmens.net</a>)</span></div><div class="subtext"><span>sea-gold</span> | <span>50 comments</span></div><br/><div><div id="39505721" class="c"><input type="checkbox" id="c-39505721" checked=""/><div class="controls bullet"><span class="by">evanb</span><span>|</span><a href="#39506106">next</a><span>|</span><label class="collapse" for="c-39505721">[-]</label><label class="expand" for="c-39505721">[4 more]</label></div><br/><div class="children"><div class="content">A pass[0] extension called pass-otp[1] can produce otp codes from the command line<p><pre><code>    &gt; pass edit git&#x2F;hub
    [... put in your totp ...]
    otpauth:&#x2F;&#x2F;totp&#x2F;GitHub&#x2F;...
</code></pre>
then you can<p><pre><code>    &gt; pass otp -c git&#x2F;hub
    Copied OTP code for git&#x2F;hub to clipboard. Will clear in 45 seconds.
</code></pre>
pass-otp is also compatible with the passff firefox plugin; not sure beyond that.<p>[0]: <a href="https:&#x2F;&#x2F;www.passwordstore.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.passwordstore.org&#x2F;</a><p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;tadfisher&#x2F;pass-otp">https:&#x2F;&#x2F;github.com&#x2F;tadfisher&#x2F;pass-otp</a></div><br/><div id="39506358" class="c"><input type="checkbox" id="c-39506358" checked=""/><div class="controls bullet"><span class="by">Tmpod</span><span>|</span><a href="#39505721">parent</a><span>|</span><a href="#39506194">next</a><span>|</span><label class="collapse" for="c-39506358">[-]</label><label class="expand" for="c-39506358">[1 more]</label></div><br/><div class="children"><div class="content">I use it almost every single day, it&#x27;s pretty simple and neat, haven&#x27;t had the need for anything fancier.</div><br/></div></div><div id="39506194" class="c"><input type="checkbox" id="c-39506194" checked=""/><div class="controls bullet"><span class="by">crtasm</span><span>|</span><a href="#39505721">parent</a><span>|</span><a href="#39506358">prev</a><span>|</span><a href="#39506106">next</a><span>|</span><label class="collapse" for="c-39506194">[-]</label><label class="expand" for="c-39506194">[2 more]</label></div><br/><div class="children"><div class="content">If you copy something else to the clipboard afterwards does it know not to clear it?</div><br/><div id="39506684" class="c"><input type="checkbox" id="c-39506684" checked=""/><div class="controls bullet"><span class="by">Xophmeister</span><span>|</span><a href="#39505721">root</a><span>|</span><a href="#39506194">parent</a><span>|</span><a href="#39506106">next</a><span>|</span><label class="collapse" for="c-39506684">[-]</label><label class="expand" for="c-39506684">[1 more]</label></div><br/><div class="children"><div class="content">I wrote a CLI password manager as a personal project a few years ago and it would only clear the clipboard if the hash of the contents matched the hash of what was originally copied. I presume `pass` does something similar.</div><br/></div></div></div></div></div></div><div id="39506106" class="c"><input type="checkbox" id="c-39506106" checked=""/><div class="controls bullet"><span class="by">coppsilgold</span><span>|</span><a href="#39505721">prev</a><span>|</span><a href="#39508820">next</a><span>|</span><label class="collapse" for="c-39506106">[-]</label><label class="expand" for="c-39506106">[13 more]</label></div><br/><div class="children"><div class="content">KeePassXC[1] password manager supports TOTP and I use it for that purpose in addition to storing passwords. It never made sense to me to use an app like Authy.<p>I suspect most people make the assumption that an Authenticator app is something special that needs to talk to the service that issued the QR code&#x2F;secret string.<p>It&#x27;s nothing more than a SHA1 hash of a secret string and an adjusted current time.<p>[1] &lt;<a href="https:&#x2F;&#x2F;keepassxc.org" rel="nofollow">https:&#x2F;&#x2F;keepassxc.org</a>&gt;</div><br/><div id="39506515" class="c"><input type="checkbox" id="c-39506515" checked=""/><div class="controls bullet"><span class="by">mksybr</span><span>|</span><a href="#39506106">parent</a><span>|</span><a href="#39506197">next</a><span>|</span><label class="collapse" for="c-39506515">[-]</label><label class="expand" for="c-39506515">[3 more]</label></div><br/><div class="children"><div class="content">KeePassXC also has a cli interface suitably named keepassxc-cli, so for TOTP in the terminal its something like:<p><pre><code>   keepassxc-cli show -q &quot;$KEEPASS_DB_FILE&quot; &quot;$ENTRY_NAME&quot; --totp
   &lt;type password&gt;
   &lt;prints totp&gt;
</code></pre>
edit: doubly so specifically regarding Authy since theyre discontinuing it on the desktop in a few months.</div><br/><div id="39507903" class="c"><input type="checkbox" id="c-39507903" checked=""/><div class="controls bullet"><span class="by">mook</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506515">parent</a><span>|</span><a href="#39506829">next</a><span>|</span><label class="collapse" for="c-39507903">[-]</label><label class="expand" for="c-39507903">[1 more]</label></div><br/><div class="children"><div class="content">The keepassxc CLI reopens the database separately; it&#x27;s actually possible to use git-credential-keepassxc† to do the scripting instead because it acts more like a browser (so it interacts with the already running instance of KeepassXC).<p>† <a href="https:&#x2F;&#x2F;github.com&#x2F;frederick888&#x2F;git-credential-keepassxc">https:&#x2F;&#x2F;github.com&#x2F;frederick888&#x2F;git-credential-keepassxc</a></div><br/></div></div><div id="39506829" class="c"><input type="checkbox" id="c-39506829" checked=""/><div class="controls bullet"><span class="by">imrehg</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506515">parent</a><span>|</span><a href="#39507903">prev</a><span>|</span><a href="#39506197">next</a><span>|</span><label class="collapse" for="c-39506829">[-]</label><label class="expand" for="c-39506829">[1 more]</label></div><br/><div class="children"><div class="content">They are discontinuing Authy Desktop in 3 weeks (March 19th), brought forward (!) from August. <a href="https:&#x2F;&#x2F;help.twilio.com&#x2F;articles&#x2F;19753631228315" rel="nofollow">https:&#x2F;&#x2F;help.twilio.com&#x2F;articles&#x2F;19753631228315</a></div><br/></div></div></div></div><div id="39506197" class="c"><input type="checkbox" id="c-39506197" checked=""/><div class="controls bullet"><span class="by">sodality2</span><span>|</span><a href="#39506106">parent</a><span>|</span><a href="#39506515">prev</a><span>|</span><a href="#39506307">next</a><span>|</span><label class="collapse" for="c-39506197">[-]</label><label class="expand" for="c-39506197">[8 more]</label></div><br/><div class="children"><div class="content">For me it’s separation of secrets. If my vault is exposed they won’t be able to log in without the codes. Putting it all in one place is a bad idea, some may think.</div><br/><div id="39506356" class="c"><input type="checkbox" id="c-39506356" checked=""/><div class="controls bullet"><span class="by">pseufaux</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506197">parent</a><span>|</span><a href="#39506327">next</a><span>|</span><label class="collapse" for="c-39506356">[-]</label><label class="expand" for="c-39506356">[2 more]</label></div><br/><div class="children"><div class="content">1Password wrote a blog post stating something similar. Basically it comes down to if you&#x27;re using TOTP as a true second factor. If you are it really shouldn&#x27;t even be accessible from the same device.<p><a href="https:&#x2F;&#x2F;blog.1password.com&#x2F;totp-and-1password&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.1password.com&#x2F;totp-and-1password&#x2F;</a></div><br/><div id="39506376" class="c"><input type="checkbox" id="c-39506376" checked=""/><div class="controls bullet"><span class="by">alwayslikethis</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506356">parent</a><span>|</span><a href="#39506327">next</a><span>|</span><label class="collapse" for="c-39506376">[-]</label><label class="expand" for="c-39506376">[1 more]</label></div><br/><div class="children"><div class="content">I suspect most people aren&#x27;t though. Most people are just being forced or nudged to using it. The main purpose for platform providers to push TOTP is probably consumers reusing passwords leading to account compromise, but if you are using a password manager, you can generate high entropy single-use passwords which don&#x27;t really have that problem.</div><br/></div></div></div></div><div id="39506327" class="c"><input type="checkbox" id="c-39506327" checked=""/><div class="controls bullet"><span class="by">alwayslikethis</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506197">parent</a><span>|</span><a href="#39506356">prev</a><span>|</span><a href="#39506373">next</a><span>|</span><label class="collapse" for="c-39506327">[-]</label><label class="expand" for="c-39506327">[2 more]</label></div><br/><div class="children"><div class="content">What if you lost or somehow broke the phone? You&#x27;ll be locked out your stuff faster than you&#x27;d expect. If you back it up to a cloud service, are you sure you can recover it without the TOTP? If you are backing it up to your computer, then it&#x27;s already on your computer and will probably be compromised when your vault is, so you might as well use your vault anyways.</div><br/><div id="39507075" class="c"><input type="checkbox" id="c-39507075" checked=""/><div class="controls bullet"><span class="by">sodality2</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506327">parent</a><span>|</span><a href="#39506373">next</a><span>|</span><label class="collapse" for="c-39507075">[-]</label><label class="expand" for="c-39507075">[1 more]</label></div><br/><div class="children"><div class="content">I load my TOTP tokens into two phones, one that stays at home fully charged. If I lose them, I can easily reset my TOTP with any reasonable provider - I have the account login and password, and can authenticate with my email&#x2F;provide proof of identity.</div><br/></div></div></div></div><div id="39506373" class="c"><input type="checkbox" id="c-39506373" checked=""/><div class="controls bullet"><span class="by">Tmpod</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506197">parent</a><span>|</span><a href="#39506327">prev</a><span>|</span><a href="#39508581">next</a><span>|</span><label class="collapse" for="c-39506373">[-]</label><label class="expand" for="c-39506373">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that&#x27;s why I also don&#x27;t use the OTP features in Bitwarden (Premium), despite using the software as my password manager.<p>On my computer, I also use a distinct password to protect my pass-otp secrets.</div><br/></div></div><div id="39508581" class="c"><input type="checkbox" id="c-39508581" checked=""/><div class="controls bullet"><span class="by">DinaCoder99</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506197">parent</a><span>|</span><a href="#39506373">prev</a><span>|</span><a href="#39506265">next</a><span>|</span><label class="collapse" for="c-39508581">[-]</label><label class="expand" for="c-39508581">[1 more]</label></div><br/><div class="children"><div class="content">The conflict between single point of authentication and single point of failure is intractable. Just pick a poison based on which is less likely to fuck you over.</div><br/></div></div><div id="39506265" class="c"><input type="checkbox" id="c-39506265" checked=""/><div class="controls bullet"><span class="by">nerdponx</span><span>|</span><a href="#39506106">root</a><span>|</span><a href="#39506197">parent</a><span>|</span><a href="#39508581">prev</a><span>|</span><a href="#39506307">next</a><span>|</span><label class="collapse" for="c-39506265">[-]</label><label class="expand" for="c-39506265">[1 more]</label></div><br/><div class="children"><div class="content">You can have one database for passwords and another for OTP.</div><br/></div></div></div></div><div id="39506307" class="c"><input type="checkbox" id="c-39506307" checked=""/><div class="controls bullet"><span class="by">alwayslikethis</span><span>|</span><a href="#39506106">parent</a><span>|</span><a href="#39506197">prev</a><span>|</span><a href="#39508820">next</a><span>|</span><label class="collapse" for="c-39506307">[-]</label><label class="expand" for="c-39506307">[1 more]</label></div><br/><div class="children"><div class="content">I only use KeePassXC for TOTPs now. Note it can work on Android too. There is often no good way to back up phone authentication apps without a cloud service, which is a problem if I ever lost or broke my phone, and it requires me to use a separate device when using my computer, which I&#x27;d rather not do.<p>Autofill can save you a lot of time if you prefer to usually stay logged out of websites (auto-deleting cookies, for example) but need to log in sometimes.</div><br/></div></div></div></div><div id="39508820" class="c"><input type="checkbox" id="c-39508820" checked=""/><div class="controls bullet"><span class="by">markuman123</span><span>|</span><a href="#39506106">prev</a><span>|</span><a href="#39507825">next</a><span>|</span><label class="collapse" for="c-39508820">[-]</label><label class="expand" for="c-39508820">[2 more]</label></div><br/><div class="children"><div class="content">I store my TOTP secrets in the Gnome Keyring<p><pre><code>      totp() {
        TOKEN=$(keyring get totp $1)
        oathtool -b --totp $TOKEN | xclip
      }
</code></pre>
and my TOTP secrets are saved via ansible-vault<p><pre><code>    - name: set TOTP in keyring
      with_items: &quot;{{ TOTP }}&quot;
      community.general.keyring:
        service: totp
        username: &quot;{{ item }}&quot;
        password: &quot;{{ TOTP[item] }}&quot;
        keyring_password: &quot;{{ keyring_password }}&quot;</code></pre></div><br/><div id="39508864" class="c"><input type="checkbox" id="c-39508864" checked=""/><div class="controls bullet"><span class="by">teddyh</span><span>|</span><a href="#39508820">parent</a><span>|</span><a href="#39507825">next</a><span>|</span><label class="collapse" for="c-39508864">[-]</label><label class="expand" for="c-39508864">[1 more]</label></div><br/><div class="children"><div class="content">Beware: That shell function will use the secret on a command line, leaking the secret to the process list, available to every user on the system.  The oathtool manual page even warns about this.<p>I would instead recommend something like:<p><pre><code>  totp() {
    oathtool --base32 --totp -- @&lt;(keyring get totp &quot;$1&quot;) | xclip
  }
</code></pre>
(Bash required.)</div><br/></div></div></div></div><div id="39507825" class="c"><input type="checkbox" id="c-39507825" checked=""/><div class="controls bullet"><span class="by">cypherpunks01</span><span>|</span><a href="#39508820">prev</a><span>|</span><a href="#39507114">next</a><span>|</span><label class="collapse" for="c-39507825">[-]</label><label class="expand" for="c-39507825">[1 more]</label></div><br/><div class="children"><div class="content">PSA: Authy Desktop is being killed off this year, which could mean the last opportunity to export your tokens out of Authy (for migration, or for external backup)<p>There are a few gists floating around regarding how to export by remote chrome debugging an older version of Authy desktop app, which still worked for me recently. This page explains too:<p><a href="https:&#x2F;&#x2F;jaketrent.com&#x2F;post&#x2F;export-authy-desktop-data&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jaketrent.com&#x2F;post&#x2F;export-authy-desktop-data&#x2F;</a></div><br/></div></div><div id="39507114" class="c"><input type="checkbox" id="c-39507114" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><a href="#39507825">prev</a><span>|</span><a href="#39508981">next</a><span>|</span><label class="collapse" for="c-39507114">[-]</label><label class="expand" for="c-39507114">[5 more]</label></div><br/><div class="children"><div class="content">Several comments here suggesting that using password managers for TOTP defeats the purpose of TOTP as a second factor. I don&#x27;t agree.<p>I strongly prefer other factors (U2F&#x2F;FIDO(2)&#x2F;WebAuthn&#x2F;Passkeys&#x2F;whatever) but unfortunately TOTP is still extremely prevalent. Worse is when only a single secondary factor can be registered, in which case even if something other than SMS or TOTP is available, I slightly bias away from hardware security tokens in order to have a clear recovery path. I can at least back up most TOTP keys.<p>I agree that having a second vault for TOTP seems superior but from a UX and recovery perspective it&#x27;s not so clear. Are both vaults available on all devices? Are they usually unlocked simultaneously? Is it likely that one vault but not the other would be stolen? Or you have a separate device or air-gap and now the usability adds friction. It seems like diminishing returns.<p>Conversely a single vault still offers significant protection from many attack vectors, including keyloggers and phishing. Even if access is obtained via MITM&#x27;ing a TOTP, the blast radius is often limited to a single session. Many services have poor session security, once established, but many do not. And in my experience it&#x27;s still nearly impossible to get rid of SMS 2FA.<p>TOTP is almost always strictly better than SMS 2FA, and storing your TOTP keys alongside your passwords doesn&#x27;t really diminish the effectiveness of TOTP very much at all. Unless you have the keys themselves exposed, they&#x27;re still closer to &quot;something you have&quot; than &quot;something you know&quot;, at least from where I&#x27;m sitting.<p>Their main weakness is that they can be backed up or copied at all, as well as MITM&#x27;d. How I securely store them doesn&#x27;t have much impact.</div><br/><div id="39507680" class="c"><input type="checkbox" id="c-39507680" checked=""/><div class="controls bullet"><span class="by">JoshTriplett</span><span>|</span><a href="#39507114">parent</a><span>|</span><a href="#39507678">next</a><span>|</span><label class="collapse" for="c-39507680">[-]</label><label class="expand" for="c-39507680">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Their main weakness is that they can be backed up or copied at all<p>Which is also a major strength. I&#x27;ve had the experience of a phone app losing all of my TOTP information, and spending a long while having to use the recovery paths of various websites. After that experience, I <i>want</i> my second factor to be something I can back up and restore.<p>That&#x27;ll continue to be true until either all websites reliably accept <i>multiple</i> 2FA devices (e.g. register multiple hardware keys) <i>or</i> I can buy multiple redundant hardware devices that produce the same TOTP codes so I can register &quot;one&quot; device with a site and still have a backup.<p>I wish the Firefox password manager had builtin TOTP support.</div><br/></div></div><div id="39507678" class="c"><input type="checkbox" id="c-39507678" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#39507114">parent</a><span>|</span><a href="#39507680">prev</a><span>|</span><a href="#39508104">next</a><span>|</span><label class="collapse" for="c-39507678">[-]</label><label class="expand" for="c-39507678">[1 more]</label></div><br/><div class="children"><div class="content">Most of the security benefits of TOTP is really for the service providers. Service providers get blamed when users are hacked because they used the same weak password across multiple websites. With TOTP service provider chooses the key the codes are derrived from, so user cannot choose a stupid one.<p>Most of the other threats that people talk about TOTP fixing are movie plot threats and not ones that happen in the real world to ordinary people. The only major exception is that webauthn prevents phishing, but TOTP cannot help with that.</div><br/></div></div><div id="39508104" class="c"><input type="checkbox" id="c-39508104" checked=""/><div class="controls bullet"><span class="by">Ferret7446</span><span>|</span><a href="#39507114">parent</a><span>|</span><a href="#39507678">prev</a><span>|</span><a href="#39507394">next</a><span>|</span><label class="collapse" for="c-39508104">[-]</label><label class="expand" for="c-39508104">[1 more]</label></div><br/><div class="children"><div class="content">1. using password managers for TOTP defeats the purpose of TOTP as a second factor<p>2. using password managers for TOTP is useful<p>Both can be true simultaneously.<p>The point of &quot;something you have&quot; is that it is &quot;literally infeasible&quot; to compromise your account without physically robbing you of your yubikey-equivalent.  That automatically excludes &gt;99% of the population that aren&#x27;t within X miles of you from being able to potentially attack you.<p>Using this definition, both SMS and TOTP already fail, but at least one can approximate it by storing the TOTP on a physical device in a way that blocks casual export.<p>If you store it in a (non-local&#x2F;backed up) password manager, you completely give up the pretense that &quot;it is impossible to compromise your account without physically robbing you of your yubikey-equivalent&quot;.  Someone from across the world can now compromise you without leaving their room.<p>Now again, just because it doesn&#x27;t meet the &quot;2FA threshold&quot;, doesn&#x27;t make it useless.  But it is also true that it doesn&#x27;t provide the level of security that 2FA is supposed to provide.</div><br/></div></div><div id="39507394" class="c"><input type="checkbox" id="c-39507394" checked=""/><div class="controls bullet"><span class="by">mcoliver</span><span>|</span><a href="#39507114">parent</a><span>|</span><a href="#39508104">prev</a><span>|</span><a href="#39508981">next</a><span>|</span><label class="collapse" for="c-39507394">[-]</label><label class="expand" for="c-39507394">[1 more]</label></div><br/><div class="children"><div class="content">Unless you were using LastPass and their Authenticator app. When they admitted that there had been unauthorized access to their storage and databases that had users vaults, what they failed to mention publicly (but which they finally told me after persistent questioning) was that the TOTP seeds were also part of the breach.</div><br/></div></div></div></div><div id="39508981" class="c"><input type="checkbox" id="c-39508981" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#39507114">prev</a><span>|</span><a href="#39506478">next</a><span>|</span><label class="collapse" for="c-39508981">[-]</label><label class="expand" for="c-39508981">[1 more]</label></div><br/><div class="children"><div class="content">tetripin does that too, but you have to pip install it.</div><br/></div></div><div id="39506478" class="c"><input type="checkbox" id="c-39506478" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39508981">prev</a><span>|</span><a href="#39508188">next</a><span>|</span><label class="collapse" for="c-39506478">[-]</label><label class="expand" for="c-39506478">[2 more]</label></div><br/><div class="children"><div class="content">I wrote once many years ago, showing me all my TOTP codes in a terminal. I&#x27;d run it on a text-only offline&#x2F;airgapped Raspberry Pi (an old one, with not even WiFi capabilities).<p>I was also pissed off by the clock issue, so I&#x27;d show both the previous, present and next code to come: because it&#x27;s really a PITA when you see 213987 but you&#x27;ve got only two seconds left before it rolls. So I may as well start entering the next code (what the server accept is something not in my control).<p>And I always, always, always have a known, public, 2FA which I can use to double-check that everything is smooth (for example by entering it on some online computer and verifying that I get the same tokens generated).<p>I just reused whatever 2FA&#x2F;TOTP Java library I found and wrapped that in a little CLI utility.<p>My secrets were unlocked by entering a password when I&#x27;d start the app.</div><br/><div id="39506527" class="c"><input type="checkbox" id="c-39506527" checked=""/><div class="controls bullet"><span class="by">AlexanderTheGr8</span><span>|</span><a href="#39506478">parent</a><span>|</span><a href="#39508188">next</a><span>|</span><label class="collapse" for="c-39506527">[-]</label><label class="expand" for="c-39506527">[1 more]</label></div><br/><div class="children"><div class="content">You don&#x27;t need to use the previous, present, and next code. Most decently implemented TOTP servers take time-sync-issues into account and accept codes a few seconds here and there. They do this also bec the time for a packet to move around the earth can also sometimes take a couple seconds.<p>Your setup on raspberry Pi sounds complicated. Mine was simpler. Just a  CLI showing totp. Less secure but more convenient.</div><br/></div></div></div></div><div id="39508188" class="c"><input type="checkbox" id="c-39508188" checked=""/><div class="controls bullet"><span class="by">lloeki</span><span>|</span><a href="#39506478">prev</a><span>|</span><a href="#39506333">next</a><span>|</span><label class="collapse" for="c-39508188">[-]</label><label class="expand" for="c-39508188">[1 more]</label></div><br/><div class="children"><div class="content">A few years back, on a limb, as a quick experiment a coworker of mine (github.com&#x2F;jkirsteins) wrote `twofa`.<p>Surprisingly usable for a few day&#x27;s worth of hacking around!<p><a href="https:&#x2F;&#x2F;github.com&#x2F;sqreen&#x2F;twofa">https:&#x2F;&#x2F;github.com&#x2F;sqreen&#x2F;twofa</a></div><br/></div></div><div id="39506333" class="c"><input type="checkbox" id="c-39506333" checked=""/><div class="controls bullet"><span class="by">timenova</span><span>|</span><a href="#39508188">prev</a><span>|</span><a href="#39507559">next</a><span>|</span><label class="collapse" for="c-39506333">[-]</label><label class="expand" for="c-39506333">[2 more]</label></div><br/><div class="children"><div class="content">For people storing One-Time Passwords in 1Password, you can access them in the terminal too:<p><pre><code>    op item get &lt;item_name&gt; --otp
</code></pre>
To copy to clipboard just use pbcopy or xclip:<p><pre><code>    op item get &lt;item_name&gt; --otp | pbcopy        # MacOS
    op item get &lt;item_name&gt; --otp | xclip -sel c  # Linux</code></pre></div><br/><div id="39506873" class="c"><input type="checkbox" id="c-39506873" checked=""/><div class="controls bullet"><span class="by">Jakob</span><span>|</span><a href="#39506333">parent</a><span>|</span><a href="#39507559">next</a><span>|</span><label class="collapse" for="c-39506873">[-]</label><label class="expand" for="c-39506873">[1 more]</label></div><br/><div class="children"><div class="content">I like 1Password `op run` which works without copying. You put environment variables in your code, and when run with `op run` these variables are replaced on runtime with the actual credentials:<p><a href="https:&#x2F;&#x2F;developer.1password.com&#x2F;docs&#x2F;cli&#x2F;secret-references&#x2F;#with-op-run" rel="nofollow">https:&#x2F;&#x2F;developer.1password.com&#x2F;docs&#x2F;cli&#x2F;secret-references&#x2F;#...</a></div><br/></div></div></div></div><div id="39507559" class="c"><input type="checkbox" id="c-39507559" checked=""/><div class="controls bullet"><span class="by">normaler</span><span>|</span><a href="#39506333">prev</a><span>|</span><a href="#39507096">next</a><span>|</span><label class="collapse" for="c-39507559">[-]</label><label class="expand" for="c-39507559">[1 more]</label></div><br/><div class="children"><div class="content">I use aegis (previously i used andotp) and backup to a folder shared via syncthing.
This allows me to usw OT via andotp -cli in emergency vor to use it in a new phone. For some i also use keepassxc (my credential&#x2F;information store.) but the important ones.
I prefer yubikeys, but keep totp AS a backup mechanism when i can add two methods.</div><br/></div></div><div id="39507096" class="c"><input type="checkbox" id="c-39507096" checked=""/><div class="controls bullet"><span class="by">forgetm3</span><span>|</span><a href="#39507559">prev</a><span>|</span><a href="#39508099">next</a><span>|</span><label class="collapse" for="c-39507096">[-]</label><label class="expand" for="c-39507096">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t like having TOTP codes available on any connected devices so I got one of these little offline authenticators.<p><a href="https:&#x2F;&#x2F;shop.reiner-sct.com&#x2F;authenticator&#x2F;reiner-sct-authenticator-mini" rel="nofollow">https:&#x2F;&#x2F;shop.reiner-sct.com&#x2F;authenticator&#x2F;reiner-sct-authent...</a></div><br/></div></div><div id="39508099" class="c"><input type="checkbox" id="c-39508099" checked=""/><div class="controls bullet"><span class="by">macropin</span><span>|</span><a href="#39507096">prev</a><span>|</span><a href="#39506230">next</a><span>|</span><label class="collapse" for="c-39508099">[-]</label><label class="expand" for="c-39508099">[1 more]</label></div><br/><div class="children"><div class="content">YubiKeys support cli access with the benefit of being hardware backed, and optionally requiring a physical touch:<p><pre><code>  $ ykman oath accounts code &lt;slot&gt;
  Touch your YubiKey...</code></pre></div><br/></div></div><div id="39506230" class="c"><input type="checkbox" id="c-39506230" checked=""/><div class="controls bullet"><span class="by">iamawacko</span><span>|</span><a href="#39508099">prev</a><span>|</span><a href="#39506589">next</a><span>|</span><label class="collapse" for="c-39506230">[-]</label><label class="expand" for="c-39506230">[6 more]</label></div><br/><div class="children"><div class="content">rbw (a terminal client for Bitwarden) can also generate totp codes.</div><br/><div id="39506298" class="c"><input type="checkbox" id="c-39506298" checked=""/><div class="controls bullet"><span class="by">Scion9066</span><span>|</span><a href="#39506230">parent</a><span>|</span><a href="#39506406">next</a><span>|</span><label class="collapse" for="c-39506298">[-]</label><label class="expand" for="c-39506298">[3 more]</label></div><br/><div class="children"><div class="content">And the official CLI client for Bitwarden is here:
<a href="https:&#x2F;&#x2F;bitwarden.com&#x2F;help&#x2F;cli&#x2F;" rel="nofollow">https:&#x2F;&#x2F;bitwarden.com&#x2F;help&#x2F;cli&#x2F;</a></div><br/><div id="39507410" class="c"><input type="checkbox" id="c-39507410" checked=""/><div class="controls bullet"><span class="by">iamawacko</span><span>|</span><a href="#39506230">root</a><span>|</span><a href="#39506298">parent</a><span>|</span><a href="#39506406">next</a><span>|</span><label class="collapse" for="c-39507410">[-]</label><label class="expand" for="c-39507410">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, it&#x27;s nice and all, but it&#x27;s a node application and requires premium for TOTP.<p>rbw is written in Rust and doesn&#x27;t need premium for TOTP.</div><br/><div id="39508284" class="c"><input type="checkbox" id="c-39508284" checked=""/><div class="controls bullet"><span class="by">Scion9066</span><span>|</span><a href="#39506230">root</a><span>|</span><a href="#39507410">parent</a><span>|</span><a href="#39506406">next</a><span>|</span><label class="collapse" for="c-39508284">[-]</label><label class="expand" for="c-39508284">[1 more]</label></div><br/><div class="children"><div class="content">For me it comes down to trust. I&#x27;m already trusting Bitwarden with the desktop&#x2F;mobile apps and the browser extension. Using rbw would require me to trust someone else with arguably my most important digital data.<p>As for the cost, it&#x27;s both reasonable at the yearly rate and I want to support them so they can continue improving the software (still waiting for Passkeys on mobile for example).<p>I can&#x27;t really speak to the node part, but it seems to perform well enough in my experience.</div><br/></div></div></div></div></div></div><div id="39506406" class="c"><input type="checkbox" id="c-39506406" checked=""/><div class="controls bullet"><span class="by">Tmpod</span><span>|</span><a href="#39506230">parent</a><span>|</span><a href="#39506298">prev</a><span>|</span><a href="#39506589">next</a><span>|</span><label class="collapse" for="c-39506406">[-]</label><label class="expand" for="c-39506406">[2 more]</label></div><br/><div class="children"><div class="content">Just be careful not to use the same account&#x2F;database&#x2F;vault for OTPs and passwords, when using a manager like Bitwarden or KeePass, otherwise they no longer contribute a second factor to your authentication.<p>To be honest, password managers that support TOTPs should always come with a very clear disclaimier that keeping all your eggs in the same basket is a detriment to your safety, and that you should either use a different software for these codes or a separate account.
I don&#x27;t believe they do, but correct me if I&#x27;m wrong.</div><br/><div id="39507003" class="c"><input type="checkbox" id="c-39507003" checked=""/><div class="controls bullet"><span class="by">jclulow</span><span>|</span><a href="#39506230">root</a><span>|</span><a href="#39506406">parent</a><span>|</span><a href="#39506589">next</a><span>|</span><label class="collapse" for="c-39507003">[-]</label><label class="expand" for="c-39507003">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve thought about this a lot, and I feel that it&#x27;s not really as big a detriment to safety as you might expect.  It&#x27;s not exactly the same as an air gapped token generator, obviously, but:<p>- It&#x27;s still something you have, and don&#x27;t know: the TOTP secret.  What you transmit is a short term generated code, but unlike your password, you don&#x27;t send the secret key at any point.<p>- The downside of air gapped tokens is that when they break or are lost or stolen, you have to somehow re-enroll with a new device.  The security properties of this process are deeply variable between authorities, and there&#x27;s always the risk of just total loss of access.  If you have the TOTP secrets backed up in Bitwarden, you can avoid this.<p>- Vault software can keep all of these secrets encrypted using keys protected by biometrics on a phone, or an external device like a Yubikey, that are only unwrapped by a particular physical interaction.  Usually the vault software does a better job than the average person of determining whether you&#x27;re looking at a legitimate authentication prompt or a phishing site, and I suspect it&#x27;s less likely to automatically enter your TOTP code into the wrong than a person is when transcribing it by hand or copy pasting.</div><br/></div></div></div></div></div></div><div id="39506589" class="c"><input type="checkbox" id="c-39506589" checked=""/><div class="controls bullet"><span class="by">tyingq</span><span>|</span><a href="#39506230">prev</a><span>|</span><a href="#39506087">next</a><span>|</span><label class="collapse" for="c-39506589">[-]</label><label class="expand" for="c-39506589">[1 more]</label></div><br/><div class="children"><div class="content">Python includes libraries that match up with the needs well, so a python TOTP generator can be pretty small, 30 lines in this case...and not too golfed:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;susam&#x2F;mintotp&#x2F;blob&#x2F;main&#x2F;mintotp.py">https:&#x2F;&#x2F;github.com&#x2F;susam&#x2F;mintotp&#x2F;blob&#x2F;main&#x2F;mintotp.py</a></div><br/></div></div><div id="39506087" class="c"><input type="checkbox" id="c-39506087" checked=""/><div class="controls bullet"><span class="by">4hg4ufxhy</span><span>|</span><a href="#39506589">prev</a><span>|</span><a href="#39508317">next</a><span>|</span><label class="collapse" for="c-39506087">[-]</label><label class="expand" for="c-39506087">[2 more]</label></div><br/><div class="children"><div class="content">Implementing TOTP is a fun exercise to learn crypto. But key storage is a bit more interesting as it has so many different approaches and trade offs.</div><br/><div id="39506411" class="c"><input type="checkbox" id="c-39506411" checked=""/><div class="controls bullet"><span class="by">Tmpod</span><span>|</span><a href="#39506087">parent</a><span>|</span><a href="#39508317">next</a><span>|</span><label class="collapse" for="c-39506411">[-]</label><label class="expand" for="c-39506411">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, seems like a small enough thing to get your hands dirty. Might give it a shot soon, thank you for the suggestion!</div><br/></div></div></div></div><div id="39508317" class="c"><input type="checkbox" id="c-39508317" checked=""/><div class="controls bullet"><span class="by">Sarkie</span><span>|</span><a href="#39506087">prev</a><span>|</span><a href="#39507548">next</a><span>|</span><label class="collapse" for="c-39508317">[-]</label><label class="expand" for="c-39508317">[2 more]</label></div><br/><div class="children"><div class="content">Sadly nothing to do with Top Of The Pops</div><br/><div id="39508808" class="c"><input type="checkbox" id="c-39508808" checked=""/><div class="controls bullet"><span class="by">roydivision</span><span>|</span><a href="#39508317">parent</a><span>|</span><a href="#39507548">next</a><span>|</span><label class="collapse" for="c-39508808">[-]</label><label class="expand" for="c-39508808">[1 more]</label></div><br/><div class="children"><div class="content">TOTP will forever mean Top Of The Pops[0] for me first. I&#x27;m reassured that I&#x27;m not the only one. Thursday nights have never been the same.<p>[0] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Top_of_the_Pops" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Top_of_the_Pops</a></div><br/></div></div></div></div><div id="39507548" class="c"><input type="checkbox" id="c-39507548" checked=""/><div class="controls bullet"><span class="by">phyzome</span><span>|</span><a href="#39508317">prev</a><span>|</span><a href="#39505919">next</a><span>|</span><label class="collapse" for="c-39507548">[-]</label><label class="expand" for="c-39507548">[1 more]</label></div><br/><div class="children"><div class="content">Frankly, I&#x27;m glad Authy Desktop is dead. It didn&#x27;t allow exporting of TOTP secrets, so migrating off of it was a pain. I&#x27;ve been much, much happier with a tiny shell alias to oathtool and gpg.<p>For extra benefit, bind a keyboard shortcut and use xsel (Linux) or pbcopy (Mac) to drop the TOTP code into the clipboard. Now entering a frequent TOTP code is as simple as two keyboard chords.<p>(I only do this because my employer offers very limited options for MFA and I don&#x27;t have a smartphone. I&#x27;d much rather use the Yubikeys I already have...)</div><br/></div></div><div id="39505919" class="c"><input type="checkbox" id="c-39505919" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#39507548">prev</a><span>|</span><a href="#39506018">next</a><span>|</span><label class="collapse" for="c-39505919">[-]</label><label class="expand" for="c-39505919">[2 more]</label></div><br/><div class="children"><div class="content">TOTP codes acceptable to Github etc. can be generated via<p><pre><code>    oathtool - Open AuTHentication (OATH) one-time password tool

     OATH Toolkit provide components to build one-time password
     authentication systems.  It contains shared C libraries, command line
     tools and a PAM module.  Supported technologies include the
     event-based HOTP algorithm (RFC 4226), the time-based TOTP algorithm
     (RFC 6238), and Portable Symmetric Key Container (PSKC, RFC 6030) to
     manage secret key data.  OATH stands for Open AuTHentication, which is
     the organization that specify the algorithms.</code></pre></div><br/><div id="39507271" class="c"><input type="checkbox" id="c-39507271" checked=""/><div class="controls bullet"><span class="by">22c</span><span>|</span><a href="#39505919">parent</a><span>|</span><a href="#39506018">next</a><span>|</span><label class="collapse" for="c-39507271">[-]</label><label class="expand" for="c-39507271">[1 more]</label></div><br/><div class="children"><div class="content">I use an alias to oathtool to generate OTPs.<p>It seems like this method at least keeps the secret key inside 2FAS backups, so it&#x27;s probably slightly better opsec.</div><br/></div></div></div></div><div id="39506018" class="c"><input type="checkbox" id="c-39506018" checked=""/><div class="controls bullet"><span class="by">jeffrallen</span><span>|</span><a href="#39505919">prev</a><span>|</span><label class="collapse" for="c-39506018">[-]</label><label class="expand" for="c-39506018">[1 more]</label></div><br/><div class="children"><div class="content">Users of 1Password with Dropbox sync can get TOTP in a terminal window with GitHub.com&#x2F;jeffallen&#x2F;1pw<p>It is a crude hack, but it works for me.</div><br/></div></div></div></div></div></div></div></body></html>