<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719824481844" as="style"/><link rel="stylesheet" href="styles.css?v=1719824481844"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://carbon-steel.github.io/jekyll/update/2024/06/19/abstractions.html">Programmers Should Never Trust Anyone, Not Even Themselves</a>Â <span class="domain">(<a href="https://carbon-steel.github.io">carbon-steel.github.io</a>)</span></div><div class="subtext"><span>kiyanwang</span> | <span>31 comments</span></div><br/><div><div id="40843510" class="c"><input type="checkbox" id="c-40843510" checked=""/><div class="controls bullet"><span class="by">mulmboy</span><span>|</span><a href="#40843411">next</a><span>|</span><label class="collapse" for="c-40843510">[-]</label><label class="expand" for="c-40843510">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Failing tests indicate the presence of bugs, but passing tests do not promise their absence.<p>If only :)<p>Far too often I find myself working with tests that patch one too many implementation details, putting me in a refactoring pickle</div><br/><div id="40843602" class="c"><input type="checkbox" id="c-40843602" checked=""/><div class="controls bullet"><span class="by">yxhuvud</span><span>|</span><a href="#40843510">parent</a><span>|</span><a href="#40843411">next</a><span>|</span><label class="collapse" for="c-40843602">[-]</label><label class="expand" for="c-40843602">[3 more]</label></div><br/><div class="children"><div class="content">Or even worse, tests that test implementation details that doesn&#x27;t matter for the actual outcome.</div><br/><div id="40843626" class="c"><input type="checkbox" id="c-40843626" checked=""/><div class="controls bullet"><span class="by">hyfgfh</span><span>|</span><a href="#40843510">root</a><span>|</span><a href="#40843602">parent</a><span>|</span><a href="#40843411">next</a><span>|</span><label class="collapse" for="c-40843626">[-]</label><label class="expand" for="c-40843626">[2 more]</label></div><br/><div class="children"><div class="content">If I had a dollar for each frontend test that actually don&#x27;t actually test anything I would be able to retire by now!</div><br/><div id="40843870" class="c"><input type="checkbox" id="c-40843870" checked=""/><div class="controls bullet"><span class="by">bdjsiqoocwk</span><span>|</span><a href="#40843510">root</a><span>|</span><a href="#40843626">parent</a><span>|</span><a href="#40843411">next</a><span>|</span><label class="collapse" for="c-40843870">[-]</label><label class="expand" for="c-40843870">[1 more]</label></div><br/><div class="children"><div class="content">Cargo cult testing. Some people don&#x27;t understand the point of testing so they just go thru the motions and end up with something that makes no sense.</div><br/></div></div></div></div></div></div></div></div><div id="40843411" class="c"><input type="checkbox" id="c-40843411" checked=""/><div class="controls bullet"><span class="by">bruce511</span><span>|</span><a href="#40843510">prev</a><span>|</span><a href="#40843810">next</a><span>|</span><label class="collapse" for="c-40843411">[-]</label><label class="expand" for="c-40843411">[3 more]</label></div><br/><div class="children"><div class="content">&gt;&gt; Random access of a character in a text buffer could take constant time (for ASCII) or linear time (for UTF-8) depending on the character encoding<p>This is true, but incomplete. All unicode encodings take linear time, not just utf-8.<p>That&#x27;s because a character can contain multiple code points. Utf-32 allows for random access of code points in constant time, but not characters.<p>Utf-16 has variable length code points so it is the same as utf-8 in that regard.</div><br/><div id="40843780" class="c"><input type="checkbox" id="c-40843780" checked=""/><div class="controls bullet"><span class="by">mjevans</span><span>|</span><a href="#40843411">parent</a><span>|</span><a href="#40843431">next</a><span>|</span><label class="collapse" for="c-40843780">[-]</label><label class="expand" for="c-40843780">[1 more]</label></div><br/><div class="children"><div class="content">IMO within a small range iterating isn&#x27;t too painful.<p>It&#x27;s probably safe, maybe even close enough to optimal for typical use, to have an array or list of bytestrings for each line.  Or maybe more complex Line (of text) objects that record the byte-length, &#x27;codepoint&#x27;-length, and &#x27;(display)character&#x27;-length.  There might even be special cases built in for typical and massive documents (number of lines) and overly long lines.</div><br/></div></div><div id="40843431" class="c"><input type="checkbox" id="c-40843431" checked=""/><div class="controls bullet"><span class="by">myworkinisgood</span><span>|</span><a href="#40843411">parent</a><span>|</span><a href="#40843780">prev</a><span>|</span><a href="#40843810">next</a><span>|</span><label class="collapse" for="c-40843431">[-]</label><label class="expand" for="c-40843431">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, but the author was talking about ASCII. ASCII takes constant time.</div><br/></div></div></div></div><div id="40843810" class="c"><input type="checkbox" id="c-40843810" checked=""/><div class="controls bullet"><span class="by">tm11zz</span><span>|</span><a href="#40843411">prev</a><span>|</span><a href="#40843441">next</a><span>|</span><label class="collapse" for="c-40843810">[-]</label><label class="expand" for="c-40843810">[2 more]</label></div><br/><div class="children"><div class="content">This is a really useful mindset as a programmer, but backfires in real-life as it makes you an anxious person.</div><br/><div id="40843853" class="c"><input type="checkbox" id="c-40843853" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#40843810">parent</a><span>|</span><a href="#40843441">next</a><span>|</span><label class="collapse" for="c-40843853">[-]</label><label class="expand" for="c-40843853">[1 more]</label></div><br/><div class="children"><div class="content">I guess you need to compartmentalise into different kinds of &#x27;trust&#x27;.  The not &#x27;trusting&#x27; you do with a computer is different from the trusting you do with fellow humans in daily life.  They just happen to use the same word in English.</div><br/></div></div></div></div><div id="40843441" class="c"><input type="checkbox" id="c-40843441" checked=""/><div class="controls bullet"><span class="by">pcwelder</span><span>|</span><a href="#40843810">prev</a><span>|</span><a href="#40843634">next</a><span>|</span><label class="collapse" for="c-40843441">[-]</label><label class="expand" for="c-40843441">[1 more]</label></div><br/><div class="children"><div class="content">High quality article with some new advices.<p>&gt; Read more documentation than just the bare minimum you need<p>I wish I practiced this before, I&#x27;d be as good and quick as some of my brilliant colleagues.</div><br/></div></div><div id="40843634" class="c"><input type="checkbox" id="c-40843634" checked=""/><div class="controls bullet"><span class="by">leecommamichael</span><span>|</span><a href="#40843441">prev</a><span>|</span><a href="#40843823">next</a><span>|</span><label class="collapse" for="c-40843634">[-]</label><label class="expand" for="c-40843634">[2 more]</label></div><br/><div class="children"><div class="content">What does it do to the psyche, to not be able to trust anyone?</div><br/><div id="40843803" class="c"><input type="checkbox" id="c-40843803" checked=""/><div class="controls bullet"><span class="by">amelius</span><span>|</span><a href="#40843634">parent</a><span>|</span><a href="#40843823">next</a><span>|</span><label class="collapse" for="c-40843803">[-]</label><label class="expand" for="c-40843803">[1 more]</label></div><br/><div class="children"><div class="content">Programmer syndrome.</div><br/></div></div></div></div><div id="40843823" class="c"><input type="checkbox" id="c-40843823" checked=""/><div class="controls bullet"><span class="by">m0llusk</span><span>|</span><a href="#40843634">prev</a><span>|</span><a href="#40843635">next</a><span>|</span><label class="collapse" for="c-40843823">[-]</label><label class="expand" for="c-40843823">[1 more]</label></div><br/><div class="children"><div class="content">Also from 8 days ago <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40764826">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40764826</a> and 9 days ago <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40760885">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40760885</a>.<p>The &quot;A Python script should be able to run on any machine with a Python interpreter.&quot; remark is amusing.  Recently ended up installing a whole new distribution version just to get Python 3.11 and the new library versions that the script I was running depended upon.<p>Giving a program finish and polish does have this kind of unlimited depth, but it is critical to remember that comes after the initial coding which is always rough with many gaps since that is always where things start.  And then we make many choices.  Hearing people commit to strong typing because docs are always out of date is another chuckle.  Maybe if the docs were kept right from the start, maybe with some use of automatically generated reference pages, then there wouldn&#x27;t be such frequent problems getting types right in the first place?  To each their own, but strong typing hype is just another currently popular method among many.  Strong typing has its value, but like every other methodology cannot be absolutely trusted to save programmers from error.</div><br/></div></div><div id="40843635" class="c"><input type="checkbox" id="c-40843635" checked=""/><div class="controls bullet"><span class="by">Joel_Mckay</span><span>|</span><a href="#40843823">prev</a><span>|</span><a href="#40843397">next</a><span>|</span><label class="collapse" for="c-40843635">[-]</label><label class="expand" for="c-40843635">[1 more]</label></div><br/><div class="children"><div class="content">After many years, I settled on a constraint based design philosophy:<p>1. type checking, data marshaling, sanity checks, and object signatures<p>2. user rate-limits and quota enforcement for access, actions, and API interfaces<p>3. expected runtime limit-check with watchdog timers (every thread has a time limit check, and failure mode handler)<p>4. controlled runtime periodic restarts (prevents slow leaks from shared libs, or python pinning all your cores because reasons etc.)<p>5. regression testing boundary conditions becomes the system auditor post-deployment<p>6. disable multi-core support in favor of n core-bound instances of programs consuming the same queue&#x2F;channel  (there is a long explanation why this makes sense for our use-cases)<p>7. Documentation is often out of date, but if the v.r.x.y API is still permuting on x or y than avoid the project like old fish left in the hot sun.  Bloat is one thing, but chaotic interfaces are a huge warning sign to avoid the chaos.<p>8. The &quot;small modular programs that do one thing well&quot; advice from the *nix crowd also makes absolute sense for large infrastructure.   Sure a monolith will be easier in the beginning, but no one person can keep track of millions of lines of commits.<p>9. Never trust the user (including yourself), and automate as much as possible.<p>10. &quot;Dead man&#x27;s switch&quot; that temporarily locks interfaces if certain rules are violated (i.e. host health, code health, or unexpected reboot in a colo.)<p>As a side note, assuming one could cover the ecosystem of library changes in a large monolith is silly.<p>Good code in my opinion, is something so reliable you don&#x27;t have to touch it again for 5 years. Such designs should not require human maintenance to remain operational.<p>There is a strange beauty in simple efficient designs. Rather than staring at something that obviously forgot its original purpose:<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;File:Giant_Knife_1.jpg" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;File:Giant_Knife_1.jpg</a><p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Second-system_effect" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Second-system_effect</a><p>Good luck, and have a wonderful day =3</div><br/></div></div><div id="40843641" class="c"><input type="checkbox" id="c-40843641" checked=""/><div class="controls bullet"><span class="by">psychoslave</span><span>|</span><a href="#40843397">prev</a><span>|</span><a href="#40843338">next</a><span>|</span><label class="collapse" for="c-40843641">[-]</label><label class="expand" for="c-40843641">[2 more]</label></div><br/><div class="children"><div class="content">&gt; verifying code correctness is impossible<p>Somehow, taking into account the state of our industry, yes. But this is not an absolute truth.<p>I mean, we do have the theoretical frameworks and even tools to come with solutions that allow to proof that code is correct. Itâs just that mapping this &quot;know how&quot; with the &quot;how to deal with the  expected flow rate feature&quot; is very uncommon.</div><br/><div id="40843752" class="c"><input type="checkbox" id="c-40843752" checked=""/><div class="controls bullet"><span class="by">tpm</span><span>|</span><a href="#40843641">parent</a><span>|</span><a href="#40843338">next</a><span>|</span><label class="collapse" for="c-40843752">[-]</label><label class="expand" for="c-40843752">[1 more]</label></div><br/><div class="children"><div class="content">It is an absolute truth in the sense that it is true for all code that was not specifically written to be formally proven correct. So, given an arbitrary piece of code, it&#x27;s impossible to verify it (because of the halting problem).</div><br/></div></div></div></div><div id="40843338" class="c"><input type="checkbox" id="c-40843338" checked=""/><div class="controls bullet"><span class="by">mewpmewp2</span><span>|</span><a href="#40843641">prev</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843338">[-]</label><label class="expand" for="c-40843338">[6 more]</label></div><br/><div class="children"><div class="content">But then you say &quot;trust, but verify&quot; in the post.</div><br/><div id="40843451" class="c"><input type="checkbox" id="c-40843451" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40843338">parent</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843451">[-]</label><label class="expand" for="c-40843451">[5 more]</label></div><br/><div class="children"><div class="content">trust but verify translates to trust no one but don&#x27;t be a dick about it</div><br/><div id="40843465" class="c"><input type="checkbox" id="c-40843465" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#40843338">root</a><span>|</span><a href="#40843451">parent</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843465">[-]</label><label class="expand" for="c-40843465">[4 more]</label></div><br/><div class="children"><div class="content">To me, it&#x27;s rather a postcondition instead of precondition.<p>Trust that a person will do the right thing, but verify that the right thing has actually been done.</div><br/><div id="40843633" class="c"><input type="checkbox" id="c-40843633" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#40843338">root</a><span>|</span><a href="#40843465">parent</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843633">[-]</label><label class="expand" for="c-40843633">[3 more]</label></div><br/><div class="children"><div class="content">Which is a contradiction, because trusting someone means not needing to verify what they say or do.</div><br/><div id="40843781" class="c"><input type="checkbox" id="c-40843781" checked=""/><div class="controls bullet"><span class="by">laserlight</span><span>|</span><a href="#40843338">root</a><span>|</span><a href="#40843633">parent</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843781">[-]</label><label class="expand" for="c-40843781">[2 more]</label></div><br/><div class="children"><div class="content">To the contrary, trust arises from being able to verify. Otherwise, you never know whether a failure is because of ill intentions or errors. That&#x27;s why I very much dislike âtrust, but verifyâ. I prefer âtrust, and verifyâ.</div><br/><div id="40843804" class="c"><input type="checkbox" id="c-40843804" checked=""/><div class="controls bullet"><span class="by">stavros</span><span>|</span><a href="#40843338">root</a><span>|</span><a href="#40843781">parent</a><span>|</span><a href="#40843525">next</a><span>|</span><label class="collapse" for="c-40843804">[-]</label><label class="expand" for="c-40843804">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the meaning of &quot;I trust you that the amount of cash you&#x27;ve given me is correct&quot; when you then proceed to count it? If you&#x27;re verifying, why do you need to say &quot;I trust you&quot;? A trustworthy and an untrustworthy person will get equally verified.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40843525" class="c"><input type="checkbox" id="c-40843525" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#40843338">prev</a><span>|</span><label class="collapse" for="c-40843525">[-]</label><label class="expand" for="c-40843525">[7 more]</label></div><br/><div class="children"><div class="content">&gt; In reality, the bank does not just store the money we deposit. It loans away&#x2F;invests most of the money that people deposit. Our money does not sit idle in a large pile in a vault.<p>Nope. In reality the money doesn&#x27;t exist. Amazing how many people think that somewhere a cartload of money is physically moving every month when they get paid. When was the last time you deposited anything in a bank? The abstraction is even higher than that. It&#x27;s just numbers in a computer system. The abstractions work because banks are &quot;too big to fail&quot;.</div><br/><div id="40843793" class="c"><input type="checkbox" id="c-40843793" checked=""/><div class="controls bullet"><span class="by">xyzzy123</span><span>|</span><a href="#40843525">parent</a><span>|</span><a href="#40843876">next</a><span>|</span><label class="collapse" for="c-40843793">[-]</label><label class="expand" for="c-40843793">[2 more]</label></div><br/><div class="children"><div class="content">This is going to sound weird but even if it was actual coins (say) would that make the whole thing any more &quot;real&quot;?<p>Either way it&#x27;s a symbolic system and it doesn&#x27;t really matter if you execute it on an abacus, or in a digital computer, or by writing in a book and carting bags of coins around.<p>I think the parts that are missing from most people&#x27;s mental model are things like the role of the central bank, and the fact that lending limits are influenced but not determined by deposits.</div><br/><div id="40843883" class="c"><input type="checkbox" id="c-40843883" checked=""/><div class="controls bullet"><span class="by">JonChesterfield</span><span>|</span><a href="#40843525">root</a><span>|</span><a href="#40843793">parent</a><span>|</span><a href="#40843876">next</a><span>|</span><label class="collapse" for="c-40843883">[-]</label><label class="expand" for="c-40843883">[1 more]</label></div><br/><div class="children"><div class="content">Yes, physical coins or grams of gold or whatever are more real. Primarily because they add inertia to changing the float, it takes time to find more gold or make more coins. You can&#x27;t 10x the supply overnight. Things changing more slowly damps out oscillations.</div><br/></div></div></div></div><div id="40843876" class="c"><input type="checkbox" id="c-40843876" checked=""/><div class="controls bullet"><span class="by">Vecr</span><span>|</span><a href="#40843525">parent</a><span>|</span><a href="#40843793">prev</a><span>|</span><a href="#40843822">next</a><span>|</span><label class="collapse" for="c-40843876">[-]</label><label class="expand" for="c-40843876">[1 more]</label></div><br/><div class="children"><div class="content">Fractional reserve backing is old school, zero reserve banking is where it&#x27;s at.</div><br/></div></div><div id="40843822" class="c"><input type="checkbox" id="c-40843822" checked=""/><div class="controls bullet"><span class="by">jampekka</span><span>|</span><a href="#40843525">parent</a><span>|</span><a href="#40843876">prev</a><span>|</span><a href="#40843644">next</a><span>|</span><label class="collapse" for="c-40843822">[-]</label><label class="expand" for="c-40843822">[1 more]</label></div><br/><div class="children"><div class="content">Indeed banks don&#x27;t loan&#x2F;invest deposits. Banks conjure money out of thin air when a loan is made. Some amount of deposits (a small fraction of the loans) is sometimes needed, although e.g. USA has scrapped fractional reserve demands.<p>I guess people have hard time accepting this because it seems too absurd to be true. Also it&#x27;s common to confuse money to be a scarce resource&#x2F;commodity because that&#x27;s how it looks like for most individuals (and that&#x27;s the story usually pushed for us plebs).</div><br/></div></div><div id="40843644" class="c"><input type="checkbox" id="c-40843644" checked=""/><div class="controls bullet"><span class="by">ttoinou</span><span>|</span><a href="#40843525">parent</a><span>|</span><a href="#40843822">prev</a><span>|</span><a href="#40843735">next</a><span>|</span><label class="collapse" for="c-40843644">[-]</label><label class="expand" for="c-40843644">[1 more]</label></div><br/><div class="children"><div class="content">Agreed. But a bank failing doesnât mean the financial system would be down though. We need to get rid of bad apples. Free banking</div><br/></div></div><div id="40843735" class="c"><input type="checkbox" id="c-40843735" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#40843525">parent</a><span>|</span><a href="#40843644">prev</a><span>|</span><label class="collapse" for="c-40843735">[-]</label><label class="expand" for="c-40843735">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think the author was under the impression that banks physically store money. They meant the digital currency does not sit idle on the bank&#x27;s asset list. They&#x27;re just using normal human language.</div><br/></div></div></div></div></div></div></div></div></div></body></html>