<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1688720460405" as="style"/><link rel="stylesheet" href="styles.css?v=1688720460405"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.bartoszsypytkowski.com/wasm-replayable-functions/">WebAssembly and Replayable Functions</a>Â <span class="domain">(<a href="https://www.bartoszsypytkowski.com">www.bartoszsypytkowski.com</a>)</span></div><div class="subtext"><span>samwillis</span> | <span>3 comments</span></div><br/><div><div id="36629007" class="c"><input type="checkbox" id="c-36629007" checked=""/><div class="controls bullet"><span class="by">kodablah</span><span>|</span><a href="#36628398">next</a><span>|</span><label class="collapse" for="c-36629007">[-]</label><label class="expand" for="c-36629007">[1 more]</label></div><br/><div class="children"><div class="content">At Temporal we&#x27;ve done a lot of research on WASM-based deterministic workflows. While they make sense in a general way, they suffer a similar problem as deterministic OS environments (e.g. hermit) - safe updates. People often need to apply code changes and know they will be deterministic changes with regards to past executions.<p>When determinism is clearly defined at the language level, you can easily see when an alteration would be compatible with existing long running executions when replaying old history. However when it&#x27;s at a low level, it&#x27;s less clear.<p>For example, Go WASM includes its coroutine scheduler inside the WASM blob. A slight change in an unrelated part of the code can change the order of coroutines causing it to be an unsafe non-deterministic change when deployed for running workflows. Similarly, Go may make an external call to a seeded deterministic random for map iteration (yes, Go explicitly randomizes map iteration order). One other call to that random will make that map iteration order possibly different breaking replay.<p>So WASM is great unless you need to alter code for existing workflows that run for years. Then it becomes less clear, whereas language level determinism can have clear semantics to code authors and static analyzers with explicit versioning&#x2F;patching if needed. Of course using lower-level languages can help here too since they are more predicably compiled with a smaller runtime, but they still require authors to be careful on code changes.</div><br/></div></div><div id="36628398" class="c"><input type="checkbox" id="c-36628398" checked=""/><div class="controls bullet"><span class="by">evacchi</span><span>|</span><a href="#36629007">prev</a><span>|</span><label class="collapse" for="c-36628398">[-]</label><label class="expand" for="c-36628398">[1 more]</label></div><br/><div class="children"><div class="content">worth mentioning: <a href="https:&#x2F;&#x2F;github.com&#x2F;stealthrocket&#x2F;timecraft">https:&#x2F;&#x2F;github.com&#x2F;stealthrocket&#x2F;timecraft</a><p>full disclosure: I don&#x27;t work on it, but the devs are committers&#x2F;contributors to <a href="https:&#x2F;&#x2F;wazero.io" rel="nofollow noreferrer">https:&#x2F;&#x2F;wazero.io</a> (I am a wazero committer) :)</div><br/></div></div></div></div></div></div></div></body></html>