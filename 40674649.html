<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1718355654680" as="style"/><link rel="stylesheet" href="styles.css?v=1718355654680"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://cr.openjdk.org/~jrose/values/flattened-values.html">Encodings for flattened heap values</a>Â <span class="domain">(<a href="https://cr.openjdk.org">cr.openjdk.org</a>)</span></div><div class="subtext"><span>lichtenberger</span> | <span>5 comments</span></div><br/><div><div id="40676328" class="c"><input type="checkbox" id="c-40676328" checked=""/><div class="controls bullet"><span class="by">malkia</span><span>|</span><a href="#40677002">next</a><span>|</span><label class="collapse" for="c-40676328">[-]</label><label class="expand" for="c-40676328">[1 more]</label></div><br/><div class="children"><div class="content">Without reading the whole thing, and with modern C# in mind - would that be &quot;auto-struct&quot; of a Java-class, without say so explicitly?</div><br/></div></div><div id="40677002" class="c"><input type="checkbox" id="c-40677002" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#40676328">prev</a><span>|</span><a href="#40676229">next</a><span>|</span><label class="collapse" for="c-40677002">[-]</label><label class="expand" for="c-40677002">[1 more]</label></div><br/><div class="children"><div class="content">Whenever I read about Project Valhalla, I&#x27;m always struck by how many of the usual approaches are somehow excluded due to ... the way the JVM has historically worked? Why is that even a concern when you&#x27;re adding new features entirely?<p>The one that jumps out most in this post is that apparently it&#x27;s considered impossible to write to just-allocated memory before transferring control to user code. Preserving the all-zero-means-null rule means that `T`, `Optional&lt;T&gt;`, `Optional&lt;Optional&lt;T&gt;&gt;`, etc. cannot just use a nop conversion when the value (at any level!) is present.<p>Some discussion of `cmpxchg16b` really should be in there. <i>I</i> know why it&#x27;s not suitable but it&#x27;s wrong to claim that only vector registers support wide atomics.</div><br/></div></div><div id="40676229" class="c"><input type="checkbox" id="c-40676229" checked=""/><div class="controls bullet"><span class="by">neonsunset</span><span>|</span><a href="#40677002">prev</a><span>|</span><a href="#40675226">next</a><span>|</span><label class="collapse" for="c-40676229">[-]</label><label class="expand" for="c-40676229">[1 more]</label></div><br/><div class="children"><div class="content">Structs. These are called structs. Or value types if you really insist.</div><br/></div></div><div id="40675226" class="c"><input type="checkbox" id="c-40675226" checked=""/><div class="controls bullet"><span class="by">secondcoming</span><span>|</span><a href="#40676229">prev</a><span>|</span><label class="collapse" for="c-40675226">[-]</label><label class="expand" for="c-40675226">[1 more]</label></div><br/><div class="children"><div class="content">Why is the header text flattened?</div><br/></div></div></div></div></div></div></div></body></html>