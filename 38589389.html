<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1702198857130" as="style"/><link rel="stylesheet" href="styles.css?v=1702198857130"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1057843">Linux: Ext4 data corruption in 6.1.64-1</a>Â <span class="domain">(<a href="https://bugs.debian.org">bugs.debian.org</a>)</span></div><div class="subtext"><span>zdw</span> | <span>36 comments</span></div><br/><div><div id="38589658" class="c"><input type="checkbox" id="c-38589658" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#38589671">next</a><span>|</span><label class="collapse" for="c-38589658">[-]</label><label class="expand" for="c-38589658">[7 more]</label></div><br/><div class="children"><div class="content">&quot;Causes non-serious data loss&quot;. What does that mean. Only affects cat videos?</div><br/><div id="38589806" class="c"><input type="checkbox" id="c-38589806" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#38589658">parent</a><span>|</span><a href="#38589762">next</a><span>|</span><label class="collapse" for="c-38589806">[-]</label><label class="expand" for="c-38589806">[4 more]</label></div><br/><div class="children"><div class="content">I believe the Debian policy for reports says that for corruption you can recover from. Serious data loss would be losing your metadata and not being able to figure out where any of the files are, or corrupting all copies of the disk encryption key.</div><br/><div id="38589843" class="c"><input type="checkbox" id="c-38589843" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#38589658">root</a><span>|</span><a href="#38589806">parent</a><span>|</span><a href="#38589762">next</a><span>|</span><label class="collapse" for="c-38589843">[-]</label><label class="expand" for="c-38589843">[3 more]</label></div><br/><div class="children"><div class="content">I think &quot;corruption you can recover from&quot; seems far too vague; you can recover from any corruption with backups.</div><br/><div id="38590042" class="c"><input type="checkbox" id="c-38590042" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#38589658">root</a><span>|</span><a href="#38589843">parent</a><span>|</span><a href="#38589905">next</a><span>|</span><label class="collapse" for="c-38590042">[-]</label><label class="expand" for="c-38590042">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re trying to be padantic and missing forest for the trees... Sure.</div><br/></div></div><div id="38589905" class="c"><input type="checkbox" id="c-38589905" checked=""/><div class="controls bullet"><span class="by">piperswe</span><span>|</span><a href="#38589658">root</a><span>|</span><a href="#38589843">parent</a><span>|</span><a href="#38590042">prev</a><span>|</span><a href="#38589762">next</a><span>|</span><label class="collapse" for="c-38589905">[-]</label><label class="expand" for="c-38589905">[1 more]</label></div><br/><div class="children"><div class="content">The way I&#x27;d interpret it is that it&#x27;s non-serious if fsck can repair it. Not sure if that&#x27;s accurate though, just the way it sounds to me.</div><br/></div></div></div></div></div></div><div id="38589762" class="c"><input type="checkbox" id="c-38589762" checked=""/><div class="controls bullet"><span class="by">minikomi</span><span>|</span><a href="#38589658">parent</a><span>|</span><a href="#38589806">prev</a><span>|</span><a href="#38589671">next</a><span>|</span><label class="collapse" for="c-38589762">[-]</label><label class="expand" for="c-38589762">[2 more]</label></div><br/><div class="children"><div class="content">You lose your data but, like, it&#x27;s just a prank man.</div><br/><div id="38589952" class="c"><input type="checkbox" id="c-38589952" checked=""/><div class="controls bullet"><span class="by">pestatije</span><span>|</span><a href="#38589658">root</a><span>|</span><a href="#38589762">parent</a><span>|</span><a href="#38589671">next</a><span>|</span><label class="collapse" for="c-38589952">[-]</label><label class="expand" for="c-38589952">[1 more]</label></div><br/><div class="children"><div class="content">yeah, practical joke for using Linux...have a laugh and deal with it</div><br/></div></div></div></div></div></div><div id="38589671" class="c"><input type="checkbox" id="c-38589671" checked=""/><div class="controls bullet"><span class="by">esbeeb</span><span>|</span><a href="#38589658">prev</a><span>|</span><a href="#38589617">next</a><span>|</span><label class="collapse" for="c-38589671">[-]</label><label class="expand" for="c-38589671">[6 more]</label></div><br/><div class="children"><div class="content">In Debian bookworm:<p>&quot;sudo systemctl stop unattended-upgrades.service&quot;
...<i>wasn&#x27;t</i> able to prevent unattended-upgrades from going on ahead and just upgrading (to this problematic kernel) anyway.<p>Unintuitively, the &quot;right&quot; way to disable unattended-upgrades is:<p>&quot;sudo dpkg-reconfigure unattended-upgrades&quot;
...and choose &quot;No&quot; when asked.</div><br/><div id="38589692" class="c"><input type="checkbox" id="c-38589692" checked=""/><div class="controls bullet"><span class="by">megous</span><span>|</span><a href="#38589671">parent</a><span>|</span><a href="#38589617">next</a><span>|</span><label class="collapse" for="c-38589692">[-]</label><label class="expand" for="c-38589692">[5 more]</label></div><br/><div class="children"><div class="content">Most likley because you stopped the wrong service. You should have stopped the relevant timer service, not the service that the timer starts.</div><br/><div id="38589984" class="c"><input type="checkbox" id="c-38589984" checked=""/><div class="controls bullet"><span class="by">esbeeb</span><span>|</span><a href="#38589671">root</a><span>|</span><a href="#38589692">parent</a><span>|</span><a href="#38589699">next</a><span>|</span><label class="collapse" for="c-38589984">[-]</label><label class="expand" for="c-38589984">[3 more]</label></div><br/><div class="children"><div class="content">Can you give example code to stop that timer?</div><br/><div id="38590119" class="c"><input type="checkbox" id="c-38590119" checked=""/><div class="controls bullet"><span class="by">KAMSPioneer</span><span>|</span><a href="#38589671">root</a><span>|</span><a href="#38589984">parent</a><span>|</span><a href="#38590116">next</a><span>|</span><label class="collapse" for="c-38590119">[-]</label><label class="expand" for="c-38590119">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s the same, but you disable the timer instead of the service. `sudo systemctl stop unattended-upgrades.timer`</div><br/></div></div><div id="38590116" class="c"><input type="checkbox" id="c-38590116" checked=""/><div class="controls bullet"><span class="by">Timber-6539</span><span>|</span><a href="#38589671">root</a><span>|</span><a href="#38589984">parent</a><span>|</span><a href="#38590119">prev</a><span>|</span><a href="#38589699">next</a><span>|</span><label class="collapse" for="c-38590116">[-]</label><label class="expand" for="c-38590116">[1 more]</label></div><br/><div class="children"><div class="content">Usually, it&#x27;s the same service name but with .timer at the end instead of .service.</div><br/></div></div></div></div></div></div></div></div><div id="38589617" class="c"><input type="checkbox" id="c-38589617" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#38589671">prev</a><span>|</span><a href="#38590065">next</a><span>|</span><label class="collapse" for="c-38589617">[-]</label><label class="expand" for="c-38589617">[4 more]</label></div><br/><div class="children"><div class="content"><i>Severity: grave</i><p>I&#x27;m not sure if that&#x27;s a standard value, but it made me chuckle a little.</div><br/><div id="38589791" class="c"><input type="checkbox" id="c-38589791" checked=""/><div class="controls bullet"><span class="by">arglebargle123</span><span>|</span><a href="#38589617">parent</a><span>|</span><a href="#38590065">next</a><span>|</span><label class="collapse" for="c-38589791">[-]</label><label class="expand" for="c-38589791">[3 more]</label></div><br/><div class="children"><div class="content">It would have been really funny if they reported that one as:<p>Severity: `</div><br/><div id="38589945" class="c"><input type="checkbox" id="c-38589945" checked=""/><div class="controls bullet"><span class="by">orhmeh09</span><span>|</span><a href="#38589617">root</a><span>|</span><a href="#38589791">parent</a><span>|</span><a href="#38589803">next</a><span>|</span><label class="collapse" for="c-38589945">[-]</label><label class="expand" for="c-38589945">[1 more]</label></div><br/><div class="children"><div class="content">This might start executing a subshell in some ancient script. Avoid!</div><br/></div></div><div id="38589803" class="c"><input type="checkbox" id="c-38589803" checked=""/><div class="controls bullet"><span class="by">Sesse__</span><span>|</span><a href="#38589617">root</a><span>|</span><a href="#38589791">parent</a><span>|</span><a href="#38589945">prev</a><span>|</span><a href="#38590065">next</a><span>|</span><label class="collapse" for="c-38589803">[-]</label><label class="expand" for="c-38589803">[1 more]</label></div><br/><div class="children"><div class="content">The bug system has a list of predetermined severities, so that would just be rejected. :-)</div><br/></div></div></div></div></div></div><div id="38590065" class="c"><input type="checkbox" id="c-38590065" checked=""/><div class="controls bullet"><span class="by">n3storm</span><span>|</span><a href="#38589617">prev</a><span>|</span><a href="#38589579">next</a><span>|</span><label class="collapse" for="c-38590065">[-]</label><label class="expand" for="c-38590065">[1 more]</label></div><br/><div class="children"><div class="content">Three months using kernel 6.6.5 from Zabbly (for hardware support) and having no issues:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;zabbly&#x2F;linux">https:&#x2F;&#x2F;github.com&#x2F;zabbly&#x2F;linux</a><p>Quote &quot;As those kernels aren&#x27;t signed by a trusted distribution key, you may need to turn off Secure Boot on your system in order to boot this kernel.&quot;</div><br/></div></div><div id="38589579" class="c"><input type="checkbox" id="c-38589579" checked=""/><div class="controls bullet"><span class="by">neilv</span><span>|</span><a href="#38590065">prev</a><span>|</span><a href="#38589733">next</a><span>|</span><label class="collapse" for="c-38589579">[-]</label><label class="expand" for="c-38589579">[1 more]</label></div><br/><div class="children"><div class="content">Mirror:  <a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20231210053348&#x2F;https:&#x2F;&#x2F;bugs.debian.org&#x2F;cgi-bin&#x2F;bugreport.cgi?bug=1057843" rel="nofollow noreferrer">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20231210053348&#x2F;https:&#x2F;&#x2F;bugs.debi...</a><p>Related: &quot;Debian 12.3 image release delayed&quot;  <a href="https:&#x2F;&#x2F;lists.debian.org&#x2F;debian-announce&#x2F;2023&#x2F;msg00005.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;lists.debian.org&#x2F;debian-announce&#x2F;2023&#x2F;msg00005.html</a></div><br/></div></div><div id="38589733" class="c"><input type="checkbox" id="c-38589733" checked=""/><div class="controls bullet"><span class="by">sampa</span><span>|</span><a href="#38589579">prev</a><span>|</span><a href="#38589603">next</a><span>|</span><label class="collapse" for="c-38589733">[-]</label><label class="expand" for="c-38589733">[1 more]</label></div><br/><div class="children"><div class="content">HWE kernel (currently 6.2.0-37-generic #38~22.04.1-Ubuntu) on LTS Ubuntu 22.04 is not affected</div><br/></div></div><div id="38589603" class="c"><input type="checkbox" id="c-38589603" checked=""/><div class="controls bullet"><span class="by">GauntletWizard</span><span>|</span><a href="#38589733">prev</a><span>|</span><a href="#38589750">next</a><span>|</span><label class="collapse" for="c-38589603">[-]</label><label class="expand" for="c-38589603">[14 more]</label></div><br/><div class="children"><div class="content">As someone who is heavily dependent on zfs, this is a little bit of reassurance. Sad that data corruption exists in any file system that is shipped too many people, but reassuring that it happens to the most stable and least &quot;interesting&quot; in the newness sense file systems.<p>ZFS&#x27;s own recent file system corruption issue is in roughly the same category of edge case, but accessible to reasonable if niche workloads.</div><br/><div id="38589858" class="c"><input type="checkbox" id="c-38589858" checked=""/><div class="controls bullet"><span class="by">Lt_Riza_Hawkeye</span><span>|</span><a href="#38589603">parent</a><span>|</span><a href="#38589650">next</a><span>|</span><label class="collapse" for="c-38589858">[-]</label><label class="expand" for="c-38589858">[7 more]</label></div><br/><div class="children"><div class="content">The problem here was Debian&#x27;s distribution process. Any distro compiling linux from the releases on kernel.org was not affected.</div><br/><div id="38590048" class="c"><input type="checkbox" id="c-38590048" checked=""/><div class="controls bullet"><span class="by">peppermint_gum</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589858">parent</a><span>|</span><a href="#38590047">next</a><span>|</span><label class="collapse" for="c-38590048">[-]</label><label class="expand" for="c-38590048">[1 more]</label></div><br/><div class="children"><div class="content">This is not accurate. As you can see in the changelogs, the problematic commit made it to 6.1.64 and the fix was merged in 6.1.66:<p>&quot;properly sync file size update after O_SYNC direct IO&quot;: <a href="https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v6.x&#x2F;ChangeLog-6.1.64" rel="nofollow noreferrer">https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v6.x&#x2F;ChangeLog-6.1.6...</a><p>&quot;update ki_pos a little later in iomap_dio_complete&quot;: <a href="https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v6.x&#x2F;ChangeLog-6.1.66" rel="nofollow noreferrer">https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v6.x&#x2F;ChangeLog-6.1.6...</a><p>This post explains the relationship between the two commits: <a href="https:&#x2F;&#x2F;lore.kernel.org&#x2F;stable&#x2F;20231205122122.dfhhoaswsfscuhc3@quack3&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;lore.kernel.org&#x2F;stable&#x2F;20231205122122.dfhhoaswsfscuh...</a></div><br/></div></div><div id="38590047" class="c"><input type="checkbox" id="c-38590047" checked=""/><div class="controls bullet"><span class="by">burtness</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589858">parent</a><span>|</span><a href="#38590048">prev</a><span>|</span><a href="#38589985">next</a><span>|</span><label class="collapse" for="c-38590047">[-]</label><label class="expand" for="c-38590047">[1 more]</label></div><br/><div class="children"><div class="content">This is a misreading of the bug. It is from <i>upstream</i> stable kernels before 6.5 that include commit 91562895f803 but not 936e114a245b6[1].<p>In this case Debian&#x27;s current process is good - it&#x27;s kernels track kernel.org stable releases. This debian bug is responsibly flagging &quot;for visibility&quot; that a serious bug has been discussed and fixed upstream.<p>[1] <a href="https:&#x2F;&#x2F;lore.kernel.org&#x2F;stable&#x2F;20231205122122.dfhhoaswsfscuhc3@quack3&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;lore.kernel.org&#x2F;stable&#x2F;20231205122122.dfhhoaswsfscuh...</a></div><br/></div></div><div id="38589985" class="c"><input type="checkbox" id="c-38589985" checked=""/><div class="controls bullet"><span class="by">uselpa</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589858">parent</a><span>|</span><a href="#38590047">prev</a><span>|</span><a href="#38589912">next</a><span>|</span><label class="collapse" for="c-38589985">[-]</label><label class="expand" for="c-38589985">[2 more]</label></div><br/><div class="children"><div class="content">Are you sure about that (genuine question)? The linked discussion involves a Suse engineer and a request to the kernel maintainer directly, not to a Debian packager-</div><br/><div id="38590050" class="c"><input type="checkbox" id="c-38590050" checked=""/><div class="controls bullet"><span class="by">burtness</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589985">parent</a><span>|</span><a href="#38589912">next</a><span>|</span><label class="collapse" for="c-38590050">[-]</label><label class="expand" for="c-38590050">[1 more]</label></div><br/><div class="children"><div class="content">No, its an upstream bug being discussed in the debian bug tracker</div><br/></div></div></div></div><div id="38589912" class="c"><input type="checkbox" id="c-38589912" checked=""/><div class="controls bullet"><span class="by">Blikkentrekker</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589858">parent</a><span>|</span><a href="#38589985">prev</a><span>|</span><a href="#38589918">next</a><span>|</span><label class="collapse" for="c-38589912">[-]</label><label class="expand" for="c-38589912">[1 more]</label></div><br/><div class="children"><div class="content">So this is another bug introduced by Debian itself by patching things?<p>I remember that there was a fairly severe one which was caused by patching OpenSSL I think? But I remember the change they made being fairly weird and no one understood why but it was easy to see that it would introduce a vulnerability.</div><br/></div></div></div></div><div id="38589650" class="c"><input type="checkbox" id="c-38589650" checked=""/><div class="controls bullet"><span class="by">upon_drumhead</span><span>|</span><a href="#38589603">parent</a><span>|</span><a href="#38589858">prev</a><span>|</span><a href="#38589750">next</a><span>|</span><label class="collapse" for="c-38589650">[-]</label><label class="expand" for="c-38589650">[6 more]</label></div><br/><div class="children"><div class="content">Yeah, all the threads full of folks bashing on ZFS because their trusty ext wonât corrupt data should be eating crow right about now, but Iâm sure theyâll hop in and explain why this bug is different.</div><br/><div id="38589714" class="c"><input type="checkbox" id="c-38589714" checked=""/><div class="controls bullet"><span class="by">uxp8u61q</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589650">parent</a><span>|</span><a href="#38589678">next</a><span>|</span><label class="collapse" for="c-38589714">[-]</label><label class="expand" for="c-38589714">[3 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t a sports tournament, nobody is cheering or bashing &quot;teams&quot;. If ZFS has bugs and caveats, they should be called out. Same for ext4.</div><br/><div id="38589884" class="c"><input type="checkbox" id="c-38589884" checked=""/><div class="controls bullet"><span class="by">GauntletWizard</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589714">parent</a><span>|</span><a href="#38589678">next</a><span>|</span><label class="collapse" for="c-38589884">[-]</label><label class="expand" for="c-38589884">[2 more]</label></div><br/><div class="children"><div class="content">Yes, it really is. People have irrational attachments and team-lime cheering for whatever they feel attached to. When ZFS has issues, you see it&#x27;s detractors out in mass. Whenever there&#x27;s a issue in a C coreutil, there&#x27;s a ton of rusticles out to complain that about writing in a &quot;memory unsafe&quot; language. When there&#x27;s a compiler bug in Rust of the same severity, you can expect down votes. When a core rust developer is exposed as a psychotic pedophile, there&#x27;s crickets - it&#x27;s not news because it happens every month.<p>I wouldn&#x27;t even bother to mention it if it weren&#x27;t for the 15-ish votes on my comment, a total score of 0</div><br/><div id="38589971" class="c"><input type="checkbox" id="c-38589971" checked=""/><div class="controls bullet"><span class="by">baz00</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589884">parent</a><span>|</span><a href="#38589678">next</a><span>|</span><label class="collapse" for="c-38589971">[-]</label><label class="expand" for="c-38589971">[1 more]</label></div><br/><div class="children"><div class="content">Well said. Twisted partisanism.<p>Iâm the middle ground. It all sucks in one way or another but weâre generally trying to our best.</div><br/></div></div></div></div></div></div><div id="38589678" class="c"><input type="checkbox" id="c-38589678" checked=""/><div class="controls bullet"><span class="by">megous</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589650">parent</a><span>|</span><a href="#38589714">prev</a><span>|</span><a href="#38589750">next</a><span>|</span><label class="collapse" for="c-38589678">[-]</label><label class="expand" for="c-38589678">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not an extfs bug, it&#x27;s a &quot;stable kernel&quot; process bug. Linux master branch&#x2F;mainline was never affected by this bug. Someone cherry-picked a wrong patch into stable without realizing the consequences, and it was caught too late.<p>Stable process is cherry pincking thousands to tens of thousands of patches from the current master kernel branch into years old kernel branches, spraying tens of thousands of emails at original patch authors, hoping (With some limited testing on top) that the resulting frankenkernels will still work and all these patches will have satisfied dependencies applied, too.<p>I don&#x27;t trust this process very much, and just run the latest stable branch for the latest kernel release, only. Staying with older stable release branch for too long seems too risky, unless you&#x27;re some bigcorp that can afford the testing required, or you&#x27;re running some highly mainstream setup that is probably covered by tests done by the stable team, and testing teams they cooperate with.</div><br/><div id="38590004" class="c"><input type="checkbox" id="c-38590004" checked=""/><div class="controls bullet"><span class="by">uselpa</span><span>|</span><a href="#38589603">root</a><span>|</span><a href="#38589678">parent</a><span>|</span><a href="#38589750">next</a><span>|</span><label class="collapse" for="c-38590004">[-]</label><label class="expand" for="c-38590004">[1 more]</label></div><br/><div class="children"><div class="content">I understand your reasoning, but running a popular Â« stable Â» distro in a popular configuration will help detect bugs much faster. Iâm not sure this would be the case for the very latest kernel.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>