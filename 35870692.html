<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1683622856911" as="style"/><link rel="stylesheet" href="styles.css?v=1683622856911"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/srpeck/kchat">Kchat: Persistent group chat in &lt;50 lines using kdb+/k/q web sockets, JavaScript</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>telotortium</span> | <span>41 comments</span></div><br/><div><div id="35871646" class="c"><input type="checkbox" id="c-35871646" checked=""/><div class="controls bullet"><span class="by">Avshalom</span><span>|</span><a href="#35871483">next</a><span>|</span><label class="collapse" for="c-35871646">[-]</label><label class="expand" for="c-35871646">[2 more]</label></div><br/><div class="children"><div class="content">N.B. <a href="https:&#x2F;&#x2F;code.kx.com&#x2F;q&#x2F;ref&#x2F;dotz&#x2F;" rel="nofollow">https:&#x2F;&#x2F;code.kx.com&#x2F;q&#x2F;ref&#x2F;dotz&#x2F;</a> is doing the heavy lifting here.</div><br/><div id="35871708" class="c"><input type="checkbox" id="c-35871708" checked=""/><div class="controls bullet"><span class="by">bshimmin</span><span>|</span><a href="#35871646">parent</a><span>|</span><a href="#35871483">next</a><span>|</span><label class="collapse" for="c-35871708">[-]</label><label class="expand" for="c-35871708">[1 more]</label></div><br/><div class="children"><div class="content">This is such a helpful comment - what looks, to the uninitiated, like line noise actually starts to make some sense now!</div><br/></div></div></div></div><div id="35871483" class="c"><input type="checkbox" id="c-35871483" checked=""/><div class="controls bullet"><span class="by">samwillis</span><span>|</span><a href="#35871646">prev</a><span>|</span><a href="#35871044">next</a><span>|</span><label class="collapse" for="c-35871483">[-]</label><label class="expand" for="c-35871483">[1 more]</label></div><br/><div class="children"><div class="content">Previous thread from 2015: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=9120246" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=9120246</a></div><br/></div></div><div id="35871044" class="c"><input type="checkbox" id="c-35871044" checked=""/><div class="controls bullet"><span class="by">BozeWolf</span><span>|</span><a href="#35871483">prev</a><span>|</span><a href="#35871106">next</a><span>|</span><label class="collapse" for="c-35871044">[-]</label><label class="expand" for="c-35871044">[2 more]</label></div><br/><div class="children"><div class="content">Fun! Combine it with ios notifications for web apps and  rename the title of this post to “&lt;60 lines”.<p><a href="https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;usernotifications&#x2F;sending_web_push_notifications_in_web_apps_safari_and_other_browsers" rel="nofollow">https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;usernotifications&#x2F;...</a></div><br/></div></div><div id="35871106" class="c"><input type="checkbox" id="c-35871106" checked=""/><div class="controls bullet"><span class="by">toastal</span><span>|</span><a href="#35871044">prev</a><span>|</span><a href="#35871676">next</a><span>|</span><label class="collapse" for="c-35871106">[-]</label><label class="expand" for="c-35871106">[8 more]</label></div><br/><div class="children"><div class="content">This reminds me that XMPP needs to make a comeback. Its push-oriented nature is efficient, was largely built in a time when we didn’t expect users to have unlimited data, and the eXtensible part has allowed it to modernize with multi-device encryption, loading chat history, etc.</div><br/><div id="35871311" class="c"><input type="checkbox" id="c-35871311" checked=""/><div class="controls bullet"><span class="by">srgpqt</span><span>|</span><a href="#35871106">parent</a><span>|</span><a href="#35871639">next</a><span>|</span><label class="collapse" for="c-35871311">[-]</label><label class="expand" for="c-35871311">[6 more]</label></div><br/><div class="children"><div class="content">Matrix is arguably the modern successor to XMPP.</div><br/><div id="35871419" class="c"><input type="checkbox" id="c-35871419" checked=""/><div class="controls bullet"><span class="by">Jiejeing</span><span>|</span><a href="#35871106">root</a><span>|</span><a href="#35871311">parent</a><span>|</span><a href="#35871420">next</a><span>|</span><label class="collapse" for="c-35871419">[-]</label><label class="expand" for="c-35871419">[3 more]</label></div><br/><div class="children"><div class="content">It is a bit weird to frame one of two competing protocols as the successor of the other, when the only data point for this assertion is that one is older.</div><br/><div id="35871562" class="c"><input type="checkbox" id="c-35871562" checked=""/><div class="controls bullet"><span class="by">tcfhgj</span><span>|</span><a href="#35871106">root</a><span>|</span><a href="#35871419">parent</a><span>|</span><a href="#35871420">next</a><span>|</span><label class="collapse" for="c-35871562">[-]</label><label class="expand" for="c-35871562">[2 more]</label></div><br/><div class="children"><div class="content">Matrix basically solves problems of XMPP:<p>- resilience against servers going down<p>- resilience against malicious federation<p>- Json instead of XML<p>- unified specification<p>- handling of E2EE with multiple devices and message history<p>- not need to rely on other servers for media access<p>Probably more, this was just off the top of my head</div><br/><div id="35871603" class="c"><input type="checkbox" id="c-35871603" checked=""/><div class="controls bullet"><span class="by">toastal</span><span>|</span><a href="#35871106">root</a><span>|</span><a href="#35871562">parent</a><span>|</span><a href="#35871420">next</a><span>|</span><label class="collapse" for="c-35871603">[-]</label><label class="expand" for="c-35871603">[1 more]</label></div><br/><div class="children"><div class="content">Matrix has its de facto centralized server in Matrix.org where almost all rooms will have its data sent through because of accounts joining rooms. The servers have been too heavy&#x2F;expensive for self-hosting that many end up relying on the big servers to use (maybe the Rust server will help, Dendrite?), but the “resilience” mentioned is a big cause for this expense (similar issues with Mastodon). JSON isn’t superior to XML--it can be in some cases but it’s not without drawbacks; experimental EXI could help with the size. XEPs are an ad hoc unified spec, and the buy-into-or-not nature has some advantages where it’s easier to experiment and fallbacks are common even with fragmentation. OMEMO isn’t perfect, but it does cover multi-device encryption and carbons work to get message history.<p>I like Matrix. But I don’t think it’s the only or best solution; the XMPP solution should be looked at more often. XMPP offers additional flexibility as well not being limited to just a chat&#x2F;communications platform where folks use it for presence, UnifiedPush, etc.</div><br/></div></div></div></div></div></div><div id="35871420" class="c"><input type="checkbox" id="c-35871420" checked=""/><div class="controls bullet"><span class="by">f1refly</span><span>|</span><a href="#35871106">root</a><span>|</span><a href="#35871311">parent</a><span>|</span><a href="#35871419">prev</a><span>|</span><a href="#35871639">next</a><span>|</span><label class="collapse" for="c-35871420">[-]</label><label class="expand" for="c-35871420">[2 more]</label></div><br/><div class="children"><div class="content">Matrix is not even close to the lightweight nature of xmpp.</div><br/><div id="35871574" class="c"><input type="checkbox" id="c-35871574" checked=""/><div class="controls bullet"><span class="by">toastal</span><span>|</span><a href="#35871106">root</a><span>|</span><a href="#35871420">parent</a><span>|</span><a href="#35871639">next</a><span>|</span><label class="collapse" for="c-35871574">[-]</label><label class="expand" for="c-35871574">[1 more]</label></div><br/><div class="children"><div class="content">But you <i>can</i> use your XMPP server to deliver notifications from Element via UnifiedPush because push is XMPP’s nature.</div><br/></div></div></div></div></div></div><div id="35871639" class="c"><input type="checkbox" id="c-35871639" checked=""/><div class="controls bullet"><span class="by">huttt</span><span>|</span><a href="#35871106">parent</a><span>|</span><a href="#35871311">prev</a><span>|</span><a href="#35871676">next</a><span>|</span><label class="collapse" for="c-35871639">[-]</label><label class="expand" for="c-35871639">[1 more]</label></div><br/><div class="children"><div class="content">XMPP hasn&#x27;t gone away, it&#x27;s incredibly popular: WhatsApp is built upon it, with over a billion users.</div><br/></div></div></div></div><div id="35871676" class="c"><input type="checkbox" id="c-35871676" checked=""/><div class="controls bullet"><span class="by">foul</span><span>|</span><a href="#35871106">prev</a><span>|</span><a href="#35871616">next</a><span>|</span><label class="collapse" for="c-35871676">[-]</label><label class="expand" for="c-35871676">[1 more]</label></div><br/><div class="children"><div class="content">Such an incredible stack.</div><br/></div></div><div id="35871616" class="c"><input type="checkbox" id="c-35871616" checked=""/><div class="controls bullet"><span class="by">swyx</span><span>|</span><a href="#35871676">prev</a><span>|</span><a href="#35871051">next</a><span>|</span><label class="collapse" for="c-35871616">[-]</label><label class="expand" for="c-35871616">[1 more]</label></div><br/><div class="children"><div class="content">a more scalable and readable version of this today would prolly use something like a partykit.io</div><br/></div></div><div id="35871051" class="c"><input type="checkbox" id="c-35871051" checked=""/><div class="controls bullet"><span class="by">asim</span><span>|</span><a href="#35871616">prev</a><span>|</span><a href="#35871182">next</a><span>|</span><label class="collapse" for="c-35871051">[-]</label><label class="expand" for="c-35871051">[1 more]</label></div><br/><div class="children"><div class="content">Something about the simplicity of the UI is so refreshing. Thanks for sharing.</div><br/></div></div><div id="35871182" class="c"><input type="checkbox" id="c-35871182" checked=""/><div class="controls bullet"><span class="by">ddoolin</span><span>|</span><a href="#35871051">prev</a><span>|</span><a href="#35871339">next</a><span>|</span><label class="collapse" for="c-35871182">[-]</label><label class="expand" for="c-35871182">[2 more]</label></div><br/><div class="children"><div class="content">I forget about k&#x2F;q every time until it shows up here. It seems like something fun to learn but that I&#x27;d have no practical use for personally.</div><br/><div id="35871662" class="c"><input type="checkbox" id="c-35871662" checked=""/><div class="controls bullet"><span class="by">leprechaun1066</span><span>|</span><a href="#35871182">parent</a><span>|</span><a href="#35871339">next</a><span>|</span><label class="collapse" for="c-35871662">[-]</label><label class="expand" for="c-35871662">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;spacetraders.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;spacetraders.io&#x2F;</a> is API based. Considering that q is used for trading and analysis in the real world seems like it&#x27;s a good way to go on an adventure.</div><br/></div></div></div></div><div id="35871339" class="c"><input type="checkbox" id="c-35871339" checked=""/><div class="controls bullet"><span class="by">Kiro</span><span>|</span><a href="#35871182">prev</a><span>|</span><a href="#35871586">next</a><span>|</span><label class="collapse" for="c-35871339">[-]</label><label class="expand" for="c-35871339">[4 more]</label></div><br/><div class="children"><div class="content">What is kdb+&#x2F;k&#x2F;q? The link to kx.com didn&#x27;t tell me much.</div><br/><div id="35871381" class="c"><input type="checkbox" id="c-35871381" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#35871339">parent</a><span>|</span><a href="#35871371">next</a><span>|</span><label class="collapse" for="c-35871381">[-]</label><label class="expand" for="c-35871381">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a somewhat esoteric, and extremely terse, language used by some financial modeling firms. Influenced heavily by APL, but (thankfully!) without the non-ASCII characters.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;K_(programming_language)" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;K_(programming_language)</a></div><br/></div></div><div id="35871371" class="c"><input type="checkbox" id="c-35871371" checked=""/><div class="controls bullet"><span class="by">jpfr</span><span>|</span><a href="#35871339">parent</a><span>|</span><a href="#35871381">prev</a><span>|</span><a href="#35871393">next</a><span>|</span><label class="collapse" for="c-35871371">[-]</label><label class="expand" for="c-35871371">[1 more]</label></div><br/><div class="children"><div class="content">k and q are array languages in the APL tradition.
APL is one the &quot;ur programming languges&quot;.
<a href="https:&#x2F;&#x2F;madhadron.com&#x2F;programming&#x2F;seven_ur_languages.html" rel="nofollow">https:&#x2F;&#x2F;madhadron.com&#x2F;programming&#x2F;seven_ur_languages.html</a><p>Here&#x27;s an open source implementation of k: <a href="https:&#x2F;&#x2F;codeberg.org&#x2F;ngn&#x2F;k&#x2F;" rel="nofollow">https:&#x2F;&#x2F;codeberg.org&#x2F;ngn&#x2F;k&#x2F;</a><p>kdb is a time-series database with deep integration to k.
It is famously used in the financial industry.</div><br/></div></div><div id="35871393" class="c"><input type="checkbox" id="c-35871393" checked=""/><div class="controls bullet"><span class="by">LukaD</span><span>|</span><a href="#35871339">parent</a><span>|</span><a href="#35871371">prev</a><span>|</span><a href="#35871586">next</a><span>|</span><label class="collapse" for="c-35871393">[-]</label><label class="expand" for="c-35871393">[1 more]</label></div><br/><div class="children"><div class="content">Came here to ask the same. kx.com is just some marketing page. I still have no idea what kdb+&#x2F;k&#x2F;q is.</div><br/></div></div></div></div><div id="35870866" class="c"><input type="checkbox" id="c-35870866" checked=""/><div class="controls bullet"><span class="by">1vuio0pswjnm7</span><span>|</span><a href="#35871586">prev</a><span>|</span><a href="#35871198">next</a><span>|</span><label class="collapse" for="c-35870866">[-]</label><label class="expand" for="c-35870866">[16 more]</label></div><br/><div class="children"><div class="content">Why use Javascript?</div><br/><div id="35870973" class="c"><input type="checkbox" id="c-35870973" checked=""/><div class="controls bullet"><span class="by">kindawinda</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35871061">next</a><span>|</span><label class="collapse" for="c-35870973">[-]</label><label class="expand" for="c-35870973">[1 more]</label></div><br/><div class="children"><div class="content">Why ask a question that will spawn a comment thread about language superiority without testing or acknowledge what the author provided?<p>Setup stress testing and worked flawlessly. Impressive work author.</div><br/></div></div><div id="35871061" class="c"><input type="checkbox" id="c-35871061" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35870973">prev</a><span>|</span><a href="#35871167">next</a><span>|</span><label class="collapse" for="c-35871061">[-]</label><label class="expand" for="c-35871061">[6 more]</label></div><br/><div class="children"><div class="content">On the server? As an example of equivalent (to the k and q versions) code.<p>On the client? Because endlessly refreshing the page to refresh chat messages is an <i>awful</i> design that we had enough of already in the 90&#x27;s.</div><br/><div id="35871147" class="c"><input type="checkbox" id="c-35871147" checked=""/><div class="controls bullet"><span class="by">HotGarbage</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871061">parent</a><span>|</span><a href="#35871167">next</a><span>|</span><label class="collapse" for="c-35871147">[-]</label><label class="expand" for="c-35871147">[5 more]</label></div><br/><div class="children"><div class="content">Could be done with long polling or a never-closing HTTP response.<p>POST to an iframe to keep the page from reloading on send.</div><br/><div id="35871224" class="c"><input type="checkbox" id="c-35871224" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871147">parent</a><span>|</span><a href="#35871216">next</a><span>|</span><label class="collapse" for="c-35871224">[-]</label><label class="expand" for="c-35871224">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s true, and those options are also awful options we used in the 90&#x27;s and promptly abandoned once better options became available, though they wouldn&#x27;t make <i>that</i> much difference here. The alternatives are all brittle and limited in different ways.</div><br/><div id="35871261" class="c"><input type="checkbox" id="c-35871261" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871224">parent</a><span>|</span><a href="#35871216">next</a><span>|</span><label class="collapse" for="c-35871261">[-]</label><label class="expand" for="c-35871261">[2 more]</label></div><br/><div class="children"><div class="content">Well sort of. Server Sent Events is basically &quot;official long polling&quot; and it works very well. Way simpler than websockets in many cases. Websockets is obviously better here though.</div><br/><div id="35871439" class="c"><input type="checkbox" id="c-35871439" checked=""/><div class="controls bullet"><span class="by">vidarh</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871261">parent</a><span>|</span><a href="#35871216">next</a><span>|</span><label class="collapse" for="c-35871439">[-]</label><label class="expand" for="c-35871439">[1 more]</label></div><br/><div class="children"><div class="content">The point isn&#x27;t that the way the data is sent from the server matters much, but that using javascript to handle the retrieval is beneficial. The first Javascript enabled chats still relied on the same methods of retrieval for a long time, but still significantly improved usability.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="35871167" class="c"><input type="checkbox" id="c-35871167" checked=""/><div class="controls bullet"><span class="by">holoduke</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35871061">prev</a><span>|</span><a href="#35871030">next</a><span>|</span><label class="collapse" for="c-35871167">[-]</label><label class="expand" for="c-35871167">[1 more]</label></div><br/><div class="children"><div class="content">Because its the most convenient language on the client there is.</div><br/></div></div><div id="35871030" class="c"><input type="checkbox" id="c-35871030" checked=""/><div class="controls bullet"><span class="by">Sosh101</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35871167">prev</a><span>|</span><a href="#35871017">next</a><span>|</span><label class="collapse" for="c-35871030">[-]</label><label class="expand" for="c-35871030">[1 more]</label></div><br/><div class="children"><div class="content">Why use anything?</div><br/></div></div><div id="35871017" class="c"><input type="checkbox" id="c-35871017" checked=""/><div class="controls bullet"><span class="by">croes</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35871030">prev</a><span>|</span><a href="#35870903">next</a><span>|</span><label class="collapse" for="c-35871017">[-]</label><label class="expand" for="c-35871017">[1 more]</label></div><br/><div class="children"><div class="content">Critique or honest question?<p>For the former, because the developer wanted to use Javascript.</div><br/></div></div><div id="35870903" class="c"><input type="checkbox" id="c-35870903" checked=""/><div class="controls bullet"><span class="by">revskill</span><span>|</span><a href="#35870866">parent</a><span>|</span><a href="#35871017">prev</a><span>|</span><a href="#35871198">next</a><span>|</span><label class="collapse" for="c-35870903">[-]</label><label class="expand" for="c-35870903">[5 more]</label></div><br/><div class="children"><div class="content">It&#x27;s fast.</div><br/><div id="35870942" class="c"><input type="checkbox" id="c-35870942" checked=""/><div class="controls bullet"><span class="by">tcfhgj</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35870903">parent</a><span>|</span><a href="#35871198">next</a><span>|</span><label class="collapse" for="c-35870942">[-]</label><label class="expand" for="c-35870942">[4 more]</label></div><br/><div class="children"><div class="content">Not really</div><br/><div id="35871181" class="c"><input type="checkbox" id="c-35871181" checked=""/><div class="controls bullet"><span class="by">sgtnoodle</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35870942">parent</a><span>|</span><a href="#35871198">next</a><span>|</span><label class="collapse" for="c-35871181">[-]</label><label class="expand" for="c-35871181">[3 more]</label></div><br/><div class="children"><div class="content">Reminds me of an interview I conducted years ago. I asked the candidate what they would do to make their code run faster. They suggested using the V8 JavaScript engine so that it would be JIT compiled. We were talking about code written in C++, intended to be run on an embedded microcontroller...<p>Also reminds me of many years ago in college, when somebody gave a presentation claiming that java was unquestionably more efficient than C++. I had a lot of questions...</div><br/><div id="35871406" class="c"><input type="checkbox" id="c-35871406" checked=""/><div class="controls bullet"><span class="by">samwillis</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871181">parent</a><span>|</span><a href="#35871333">next</a><span>|</span><label class="collapse" for="c-35871406">[-]</label><label class="expand" for="c-35871406">[1 more]</label></div><br/><div class="children"><div class="content">&gt; more efficient<p>I was going to make a quip about efficiency being more than execution, with development efficiency also being important. But then with it being a comment about C++ vs Java I decide not to...</div><br/></div></div><div id="35871333" class="c"><input type="checkbox" id="c-35871333" checked=""/><div class="controls bullet"><span class="by">lynx23</span><span>|</span><a href="#35870866">root</a><span>|</span><a href="#35871181">parent</a><span>|</span><a href="#35871406">prev</a><span>|</span><a href="#35871198">next</a><span>|</span><label class="collapse" for="c-35871333">[-]</label><label class="expand" for="c-35871333">[1 more]</label></div><br/><div class="children"><div class="content">Only tangentially related, but this reminds me of a MCSE training I once attended in the 90s, where the trainer claimed Microsoft Passwords are so secure that they can not be cracked in a reasonable amount of time.  I couldn&#x27;t hide my amusment.  Since this got him fired up, he went as far as saying &quot;If you believe otherwise, find my password!&quot; to which I replied &quot;No need for that, already done.&quot;  Thanks l0phtCrack, you made my day.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="35871198" class="c"><input type="checkbox" id="c-35871198" checked=""/><div class="controls bullet"><span class="by">huhtenberg</span><span>|</span><a href="#35870866">prev</a><span>|</span><label class="collapse" for="c-35871198">[-]</label><label class="expand" for="c-35871198">[1 more]</label></div><br/><div class="children"><div class="content">Pfft, chat.k is still just way too verbose compared to the good old<p><pre><code>   # cat &gt; a.out</code></pre></div><br/></div></div></div></div></div></div></div></body></html>