<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1718528458055" as="style"/><link rel="stylesheet" href="styles.css?v=1718528458055"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://k3xec.com/td158/">Reverse engineering a restaurant pager system</a> <span class="domain">(<a href="https://k3xec.com">k3xec.com</a>)</span></div><div class="subtext"><span>edward</span> | <span>16 comments</span></div><br/><div><div id="40692669" class="c"><input type="checkbox" id="c-40692669" checked=""/><div class="controls bullet"><span class="by">perth</span><span>|</span><a href="#40693456">next</a><span>|</span><label class="collapse" for="c-40692669">[-]</label><label class="expand" for="c-40692669">[2 more]</label></div><br/><div class="children"><div class="content">Noticed this person didn’t want people to access the code for fear of misuse. Thankfully, someone else has already made this for flipper zero before them and released the code!<p><a href="https:&#x2F;&#x2F;github.com&#x2F;leedave&#x2F;flipper-zero-meal-pager">https:&#x2F;&#x2F;github.com&#x2F;leedave&#x2F;flipper-zero-meal-pager</a></div><br/><div id="40692813" class="c"><input type="checkbox" id="c-40692813" checked=""/><div class="controls bullet"><span class="by">thedrexster</span><span>|</span><a href="#40692669">parent</a><span>|</span><a href="#40693456">next</a><span>|</span><label class="collapse" for="c-40692813">[-]</label><label class="expand" for="c-40692813">[1 more]</label></div><br/><div class="children"><div class="content">&lt;&lt; 
Does this even work:
I don&#x27;t know. It&#x27;s based on intel collected from other people. The Flipper sends data, I checked that with a second flipper. I&#x27;ve also heard rumors that it works in Australia. I&#x27;m sure it doesn&#x27;t work in the US, as they use different frequencies.
&gt;&gt;<p>I mean, that&#x27;s helpful, but....</div><br/></div></div></div></div><div id="40693456" class="c"><input type="checkbox" id="c-40693456" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#40692669">prev</a><span>|</span><a href="#40693058">next</a><span>|</span><label class="collapse" for="c-40693456">[-]</label><label class="expand" for="c-40693456">[2 more]</label></div><br/><div class="children"><div class="content">&gt; around 858 microseconds (0.000858 seconds per symbol), which is a weird number, but maybe I’m slightly off or there’s some larger math I’m missing that makes this number satisfyingly round<p>1&#x2F;858e-6 sec = 1165 Hz. They were likely trying for 1200 Hz, but the crystal was a bit off.</div><br/><div id="40694810" class="c"><input type="checkbox" id="c-40694810" checked=""/><div class="controls bullet"><span class="by">kragen</span><span>|</span><a href="#40693456">parent</a><span>|</span><a href="#40693058">next</a><span>|</span><label class="collapse" for="c-40694810">[-]</label><label class="expand" for="c-40694810">[1 more]</label></div><br/><div class="children"><div class="content">1200 baud is a standard baud rate and I think 3% is within tolerance. probably not a crystal though or it would be much closer</div><br/></div></div></div></div><div id="40693058" class="c"><input type="checkbox" id="c-40693058" checked=""/><div class="controls bullet"><span class="by">whartung</span><span>|</span><a href="#40693456">prev</a><span>|</span><a href="#40694875">next</a><span>|</span><label class="collapse" for="c-40693058">[-]</label><label class="expand" for="c-40693058">[9 more]</label></div><br/><div class="children"><div class="content">I want to know how when you see a stack of pager, each one knows its position in the stack so that when the stack decides to go into &quot;attract&quot; mode, it animates them one by one, like an elevator going up.<p>Somehow when they stack, they know where they are relative to the other pagers (at least something does).</div><br/><div id="40693096" class="c"><input type="checkbox" id="c-40693096" checked=""/><div class="controls bullet"><span class="by">jrussino</span><span>|</span><a href="#40693058">parent</a><span>|</span><a href="#40693744">next</a><span>|</span><label class="collapse" for="c-40693096">[-]</label><label class="expand" for="c-40693096">[2 more]</label></div><br/><div class="children"><div class="content">If I recall, they have female port connectors on the bottom and little male prong connectors that mate with them on top. I assume that is mainly for power connection, so you can put a whole stack on a charger and charge them all simultaneously. But if they can sense a signal on the female pins then that&#x27;s sufficient to enable the behavior you&#x27;re describing without directly knowing the positions of each pager, right? Pager on the bottom sees a signal on its female pins, blinks its light, send the signal on its male pins, then the next pager above sees the signal on its female pins, blinks its light, sends the signal on its male pins, etc...</div><br/><div id="40693596" class="c"><input type="checkbox" id="c-40693596" checked=""/><div class="controls bullet"><span class="by">Cerium</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40693096">parent</a><span>|</span><a href="#40693744">next</a><span>|</span><label class="collapse" for="c-40693596">[-]</label><label class="expand" for="c-40693596">[1 more]</label></div><br/><div class="children"><div class="content">I think that is the whole trick - they look like they are all in parallel on four wires, but really two of the wires are daisy chained through each device (like serial LEDs). In this configuration you can do the light tricks without knowing the order, but you can also enumerate the order. I have seen addressing based on hop counting, or by appending your ID to &quot;who are you&quot; message.<p>Eg: Host sends &quot;who are you&quot; first device appends an ID number and then propagates the message forward in the chain. Each device does the same, until the last device in the chain (which detects electrically or via a timeout that there are no more devices) decides to loop the message back to the host.</div><br/></div></div></div></div><div id="40693744" class="c"><input type="checkbox" id="c-40693744" checked=""/><div class="controls bullet"><span class="by">ssl-3</span><span>|</span><a href="#40693058">parent</a><span>|</span><a href="#40693096">prev</a><span>|</span><a href="#40694875">next</a><span>|</span><label class="collapse" for="c-40693744">[-]</label><label class="expand" for="c-40693744">[6 more]</label></div><br/><div class="children"><div class="content">Looking at photos on Google Images, it looks like the pagers in question have just two pins on the top, and two more mating pins on the bottom.<p>Obviously, that&#x27;s for power delivery: They stack to charge.<p>But it seems like data must be sent (in one direction) through the stack at the same time that charging happens -- to set IDs, and to let attract mode work.<p>One way I can conceive of to allow this to happen is by reversing polarity: Send power with one polarity for a 0, and in the opposite polarity for a 1.<p>Once a pager has some data, it can pass it along to the one stacked above it by doing the same thing -- in a manner not dissimilar to how things like RGB LED strings do.<p>Charging can happen at the same time as this data is received (and potentially modified) and then retransmitted by using a bridge rectifier in each unit for the charging circuit, so that (as far as the battery bits can see) the polarity remains constant.<p>(This sounds complex and slow, but using things like diodes and MOSFETs is cheap at mass production PCB stuffing scales, and the data rate needn&#x27;t be fast.  It may even be cheaper to do it this way than a more complex assembly with dedicated data pins.)</div><br/><div id="40694889" class="c"><input type="checkbox" id="c-40694889" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40693744">parent</a><span>|</span><a href="#40694826">next</a><span>|</span><label class="collapse" for="c-40694889">[-]</label><label class="expand" for="c-40694889">[2 more]</label></div><br/><div class="children"><div class="content">Or you could have a fixed clock and sample based on that, so no having to deal with reverse polarity. This is the restaurant industry though, so assume they&#x27;ll get wet and the the worst possible combination of pins get shorted, so design the circuit to be as tolerant of that as possible. Also consider the 4 pins getting into conductive fluid electrified with AC.</div><br/><div id="40695101" class="c"><input type="checkbox" id="c-40695101" checked=""/><div class="controls bullet"><span class="by">ssl-3</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40694889">parent</a><span>|</span><a href="#40694826">next</a><span>|</span><label class="collapse" for="c-40695101">[-]</label><label class="expand" for="c-40695101">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps.  Can you elaborate on how your own idea works?  I think I know what you mean, but I&#x27;d like for it to be explained.<p>My own idea implies a potential of ~100% charging duty cycle even as low-speed data is being transferred, and that&#x27;s good because charging seems to be the primary goal here in this application.<p>(My other idea, that I have not yet espoused, involves a waveform on top of a fairly-constant charging voltage.  It can perform asynchronously, and might even be just amplitude modulation.  But it probably means more parts and complexity than my first idea involves:  Functional analog filters always seem to take a handful of parts to get the it right, whereas my polarity-swap idea only uses a couple of high-tolerance jellybean MOSFETs and some parts-bin diodes.)</div><br/></div></div></div></div><div id="40694826" class="c"><input type="checkbox" id="c-40694826" checked=""/><div class="controls bullet"><span class="by">kragen</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40693744">parent</a><span>|</span><a href="#40694889">prev</a><span>|</span><a href="#40694875">next</a><span>|</span><label class="collapse" for="c-40694826">[-]</label><label class="expand" for="c-40694826">[3 more]</label></div><br/><div class="children"><div class="content">this is a great idea. you don&#x27;t even need a bipolarity driver, just an h-bridge. though if you do have plus and minus rails plus ground, you only need two transistors</div><br/><div id="40695112" class="c"><input type="checkbox" id="c-40695112" checked=""/><div class="controls bullet"><span class="by">ssl-3</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40694826">parent</a><span>|</span><a href="#40694875">next</a><span>|</span><label class="collapse" for="c-40695112">[-]</label><label class="expand" for="c-40695112">[2 more]</label></div><br/><div class="children"><div class="content">How do you mean?<p>There are only two contacts between any device and the device below it, according to the photos.  This trend continues upward for all subsequently-connected devices.<p>An interface with +, -, and ground implies three contacts.</div><br/><div id="40695633" class="c"><input type="checkbox" id="c-40695633" checked=""/><div class="controls bullet"><span class="by">kragen</span><span>|</span><a href="#40693058">root</a><span>|</span><a href="#40695112">parent</a><span>|</span><a href="#40694875">next</a><span>|</span><label class="collapse" for="c-40695633">[-]</label><label class="expand" for="c-40695633">[1 more]</label></div><br/><div class="children"><div class="content">i mean you connect one wire to ground and switch the other wire between - and + with two transistors, thus reversing polarity on it in a way that can be used to signal information while also efficiently transferring power<p>basically rs232 signaling with just tx and ground</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40694875" class="c"><input type="checkbox" id="c-40694875" checked=""/><div class="controls bullet"><span class="by">tgsovlerkhgsel</span><span>|</span><a href="#40693058">prev</a><span>|</span><a href="#40694765">next</a><span>|</span><label class="collapse" for="c-40694875">[-]</label><label class="expand" for="c-40694875">[1 more]</label></div><br/><div class="children"><div class="content">I honestly appreciate the decision to not release the code (&quot;I’m not going to be publishing this code since I can’t think of a good use anyone would have for this besides folks using a low cost SDR and annoying local resturants&quot;). All too often have I seen security researchers release fully weaponized attack tools that then promptly get used by attackers (and not the pranking kind of attackers either).<p>Could the attacker write it themselves? Probably. Will reducing the cost by providing ready-made code increase attacks? Almost certainly. I wish that more people would consider whether releasing the code will be a net benefit (by enabling legitimate research, education, proof-of-concept demonstrations of vulnerability) or harm (by enabling malicious attacks). Even if the underlying exploit&#x2F;vuln&#x2F;feature is the same, form matters: A ready-to-use attack toolkit with multi-client management capability is much more likely to be useful to attackers than defenders, where a simple proof of concept that is hardcoded to show a pre-defined message with no <i>easy</i> way to change that is much less likely to be reused maliciously.<p>And pranking a pager system sounds pretty harmless, until you realize that a restaurant is likely quite strongly relying on it and essentially DoS&#x27;ing it has the potential to affect their business.</div><br/></div></div><div id="40694765" class="c"><input type="checkbox" id="c-40694765" checked=""/><div class="controls bullet"><span class="by">bragr</span><span>|</span><a href="#40694875">prev</a><span>|</span><label class="collapse" for="c-40694765">[-]</label><label class="expand" for="c-40694765">[1 more]</label></div><br/><div class="children"><div class="content">Looking at the system for sale [1] now, the lack of security seems to be one of their selling points:<p>&gt;Multiple keyboards call the same pager. The pager system long range supports multiple keyboard call the same restaurant pagers.<p>As an aside, all the church nursery references stand out to me. Are pager systems common for that and am I just out of touch?<p>[1] <a href="https:&#x2F;&#x2F;www.amazon.com&#x2F;Retekess-Restaurant-Adjustable-Reminder-Restaurants&#x2F;dp&#x2F;B087F61B3F" rel="nofollow">https:&#x2F;&#x2F;www.amazon.com&#x2F;Retekess-Restaurant-Adjustable-Remind...</a></div><br/></div></div></div></div></div></div></div></body></html>