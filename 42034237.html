<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730710881540" as="style"/><link rel="stylesheet" href="styles.css?v=1730710881540"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.pgflo.io/">pg_flo – Stream, transform, and re-route PostgreSQL data in real-time</a> <span class="domain">(<a href="https://www.pgflo.io">www.pgflo.io</a>)</span></div><div class="subtext"><span>shayonj</span> | <span>25 comments</span></div><br/><div><div id="42039366" class="c"><input type="checkbox" id="c-42039366" checked=""/><div class="controls bullet"><span class="by">2000swebgeek</span><span>|</span><a href="#42036901">next</a><span>|</span><label class="collapse" for="c-42039366">[-]</label><label class="expand" for="c-42039366">[2 more]</label></div><br/><div class="children"><div class="content">pg_flo looks like a very interesting project we might end up using. I like the archival to s3 and cheap versions of tools that get done at lower scale like GBs instead of TBs worth of data (Which is what I think Debezium does and something I can easily test locally)<p>The work&#x2F;effort I need to put in with kafka etc., w&#x2F; Debezium is a short term effort, but evaluating the hassle.<p>Other solutions being evaluated by my team is peerdb - <a href="https:&#x2F;&#x2F;docs.peerdb.io&#x2F;why-peerdb" rel="nofollow">https:&#x2F;&#x2F;docs.peerdb.io&#x2F;why-peerdb</a></div><br/><div id="42039518" class="c"><input type="checkbox" id="c-42039518" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42039366">parent</a><span>|</span><a href="#42036901">next</a><span>|</span><label class="collapse" for="c-42039518">[-]</label><label class="expand" for="c-42039518">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for checking it out - Curious are you syncing&#x2F;storing the data in some specific format in s3?</div><br/></div></div></div></div><div id="42036901" class="c"><input type="checkbox" id="c-42036901" checked=""/><div class="controls bullet"><span class="by">iyn</span><span>|</span><a href="#42039366">prev</a><span>|</span><a href="#42035579">next</a><span>|</span><label class="collapse" for="c-42036901">[-]</label><label class="expand" for="c-42036901">[3 more]</label></div><br/><div class="children"><div class="content">Looks interesting, I’ve been investigating Postgres CDC solutions for a while, so I’m curious if this could help my use-case.<p>Can you elaborate on failure modes? What happens if e.g. NATS server (or worker&#x2F;replicator) node dies?<p>In principle, how hard is it move data from Postgres not to another PG but e.g. ElasticSearch&#x2F;ClickHouse?</div><br/><div id="42037572" class="c"><input type="checkbox" id="c-42037572" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42036901">parent</a><span>|</span><a href="#42038820">next</a><span>|</span><label class="collapse" for="c-42037572">[-]</label><label class="expand" for="c-42037572">[1 more]</label></div><br/><div class="children"><div class="content">re: worker&#x2F;replicator dying, if the worker dies, nothing is basically reading from subject&#x2F;queue (NATS), so the changes aren&#x27;t reaching the destination. The default config is to have one worker. If the replicator dies, the changes from the replication slot isn&#x27;t getting delivered to NATS, so the WAL size will grow on the source DB.<p>There are some plans to introduce metrics&#x2F;instrumentation to stay on top of these things, to make it more production ready.<p>Replicator and worker can pause&#x2F;resume the stream when say shutting down, say during a deploy.<p>re: moving data, I haven&#x27;t attempted it, but I have seen PeerDB mentioned for moving data to Clickhouse and it seems quite nice.<p>I am starting w&#x2F; PostgreSQL &lt;&gt; PostgreSQL to mostly get the fundamentals right first. Would love to hear any use cases you have in mind.</div><br/></div></div><div id="42038820" class="c"><input type="checkbox" id="c-42038820" checked=""/><div class="controls bullet"><span class="by">Onavo</span><span>|</span><a href="#42036901">parent</a><span>|</span><a href="#42037572">prev</a><span>|</span><a href="#42035579">next</a><span>|</span><label class="collapse" for="c-42038820">[-]</label><label class="expand" for="c-42038820">[1 more]</label></div><br/><div class="children"><div class="content">You can always use Supabase&#x27;s realtime CDC tool, it&#x27;s open source.</div><br/></div></div></div></div><div id="42035579" class="c"><input type="checkbox" id="c-42035579" checked=""/><div class="controls bullet"><span class="by">scirob</span><span>|</span><a href="#42036901">prev</a><span>|</span><a href="#42035613">next</a><span>|</span><label class="collapse" for="c-42035579">[-]</label><label class="expand" for="c-42035579">[3 more]</label></div><br/><div class="children"><div class="content">Cool,  Hope it can give an alterantive to Debezium. I never liked Debezium  how it first must copy the whole CDC state to kafka. And you must set the kafka retnetion time to infinity, which many kafka as a service systems don&#x27;t allow anyway.</div><br/><div id="42036130" class="c"><input type="checkbox" id="c-42036130" checked=""/><div class="controls bullet"><span class="by">FridgeSeal</span><span>|</span><a href="#42035579">parent</a><span>|</span><a href="#42037571">next</a><span>|</span><label class="collapse" for="c-42036130">[-]</label><label class="expand" for="c-42036130">[1 more]</label></div><br/><div class="children"><div class="content">&gt; how it first must copy the whole CDC state to kafka<p>There’s a setting that controls whether it will do a snapshot first. Turn it off and it will just start sending through new cdc entries.<p>&gt; you must set the kafka retention time to infinity<p>Is this a new retirement? I’ve never had to do this.</div><br/></div></div><div id="42037571" class="c"><input type="checkbox" id="c-42037571" checked=""/><div class="controls bullet"><span class="by">jitl</span><span>|</span><a href="#42035579">parent</a><span>|</span><a href="#42036130">prev</a><span>|</span><a href="#42035613">next</a><span>|</span><label class="collapse" for="c-42037571">[-]</label><label class="expand" for="c-42037571">[1 more]</label></div><br/><div class="children"><div class="content">I recently set up a Debezium &#x2F; Kafka Connect cluster and didn’t need to do either of these things. I have some topics with 7 day retention, and some with 0 second retention. No full scan at all, not necessary for my use case.</div><br/></div></div></div></div><div id="42035613" class="c"><input type="checkbox" id="c-42035613" checked=""/><div class="controls bullet"><span class="by">scirob</span><span>|</span><a href="#42035579">prev</a><span>|</span><a href="#42036936">next</a><span>|</span><label class="collapse" for="c-42035613">[-]</label><label class="expand" for="c-42035613">[2 more]</label></div><br/><div class="children"><div class="content">pglogical can live inside postgres,  looks like pg_flo  is an external service not an extension.<p>Maybe a benefit actually. Do you think we could use pg_flo  with Postgres as a service instances  like  Azure postgres,  Supabase,  Neon  etc?  Like you just read the WAL without needing to install an extension that is not approved by the vendor.</div><br/><div id="42035761" class="c"><input type="checkbox" id="c-42035761" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42035613">parent</a><span>|</span><a href="#42036936">next</a><span>|</span><label class="collapse" for="c-42035761">[-]</label><label class="expand" for="c-42035761">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, absolutely! There are other benefits of being an extension, and yes you can use pg_flo with any PostgreSQL database or service since it uses logical replication to listen on changes and CTIDs for bulk copies.</div><br/></div></div></div></div><div id="42036936" class="c"><input type="checkbox" id="c-42036936" checked=""/><div class="controls bullet"><span class="by">gkhartman</span><span>|</span><a href="#42035613">prev</a><span>|</span><a href="#42037247">next</a><span>|</span><label class="collapse" for="c-42036936">[-]</label><label class="expand" for="c-42036936">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m really looking forward to taking this for a spin.  Thanks for sharing.<p>Question:  Can this handle network disconnection&#x2F;instability mid copy?</div><br/><div id="42037005" class="c"><input type="checkbox" id="c-42037005" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42036936">parent</a><span>|</span><a href="#42037247">next</a><span>|</span><label class="collapse" for="c-42037005">[-]</label><label class="expand" for="c-42037005">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! Today, an active stream is resumeable, say in case a shutdown &#x2F; SIGTERM come up. It also stores some state every flush. However, as for copy-and-stream, it’s not quite resumable today, but that&#x27;s coming soon.<p>Some more guardrails around network disruption and retries is on the way too.</div><br/></div></div></div></div><div id="42037247" class="c"><input type="checkbox" id="c-42037247" checked=""/><div class="controls bullet"><span class="by">davidarenas</span><span>|</span><a href="#42036936">prev</a><span>|</span><a href="#42035526">next</a><span>|</span><label class="collapse" for="c-42037247">[-]</label><label class="expand" for="c-42037247">[2 more]</label></div><br/><div class="children"><div class="content">How does it compare against something like Sequin? Looking into something that will allow a cdc event driven workflow but also arbitrarily replaying the event stream on demand.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;sequinstream&#x2F;sequin">https:&#x2F;&#x2F;github.com&#x2F;sequinstream&#x2F;sequin</a></div><br/><div id="42037583" class="c"><input type="checkbox" id="c-42037583" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42037247">parent</a><span>|</span><a href="#42035526">next</a><span>|</span><label class="collapse" for="c-42037583">[-]</label><label class="expand" for="c-42037583">[1 more]</label></div><br/><div class="children"><div class="content">Sequin sounds like a nice fit for that. I like it and yeah it does have replay.<p>With pg_flo, I am looking for the tool to be fairly hands off, while declarative at the same time for data filtering, transformation and re-routing like tasks, starting with PostgreSQL as the destination for now. The less time you can spend on cleaning, moving &#x2F; syncing your data the better. Also quite curious to see what other use cases folks find it useful for.<p>Replay&#x2F;reusability has been on my mind and have a sort of an old PR open. Will give it a shot soon.<p>Open to any suggestions and feedback.</div><br/></div></div></div></div><div id="42035526" class="c"><input type="checkbox" id="c-42035526" checked=""/><div class="controls bullet"><span class="by">rileymichael</span><span>|</span><a href="#42037247">prev</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035526">[-]</label><label class="expand" for="c-42035526">[7 more]</label></div><br/><div class="children"><div class="content">Perfect timing — I was just looking into similar tools.<p>If I want to do a bulk copy (say, nightly) with various transformations but not continually stream after, is that supported &#x2F; a use case that’d be a good fit for your tool?</div><br/><div id="42035588" class="c"><input type="checkbox" id="c-42035588" checked=""/><div class="controls bullet"><span class="by">zorgmonkey</span><span>|</span><a href="#42035526">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035588">[-]</label><label class="expand" for="c-42035588">[6 more]</label></div><br/><div class="children"><div class="content">It looks with what is currently implemented you&#x27;d have to drop the tables from the destination if you want repeated copies, probably not quite what you want. Close enough to your use case that it still might be worth testing it out though.</div><br/><div id="42035647" class="c"><input type="checkbox" id="c-42035647" checked=""/><div class="controls bullet"><span class="by">rileymichael</span><span>|</span><a href="#42035526">root</a><span>|</span><a href="#42035588">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035647">[-]</label><label class="expand" for="c-42035647">[5 more]</label></div><br/><div class="children"><div class="content">yeah that’s not an immediate deal breaker for me, I’m essentially looking for pgdump&#x2F;restore + transformations. I’ll give it a look and see how it performs</div><br/><div id="42035767" class="c"><input type="checkbox" id="c-42035767" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42035526">root</a><span>|</span><a href="#42035647">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035767">[-]</label><label class="expand" for="c-42035767">[4 more]</label></div><br/><div class="children"><div class="content">Thank you for giving this a spin. That&#x27;s correct, today you&#x27;d need to drop the table before another sync with pg_flo. That said, I have given delta syncs some thought, and also looking into a control plane that can make some of these things easier. Would love to hear your feedback.</div><br/><div id="42035801" class="c"><input type="checkbox" id="c-42035801" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42035526">root</a><span>|</span><a href="#42035767">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035801">[-]</label><label class="expand" for="c-42035801">[3 more]</label></div><br/><div class="children"><div class="content">I think this also might be of interest to you - just one time copies and apply transformations - <a href="https:&#x2F;&#x2F;github.com&#x2F;shayonj&#x2F;pg_flo&#x2F;issues&#x2F;6">https:&#x2F;&#x2F;github.com&#x2F;shayonj&#x2F;pg_flo&#x2F;issues&#x2F;6</a>. I will look into shipping that very soon.</div><br/><div id="42035882" class="c"><input type="checkbox" id="c-42035882" checked=""/><div class="controls bullet"><span class="by">rileymichael</span><span>|</span><a href="#42035526">root</a><span>|</span><a href="#42035801">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42035882">[-]</label><label class="expand" for="c-42035882">[2 more]</label></div><br/><div class="children"><div class="content">Oh awesome, yeah that’d work perfect then. I’d just prep beforehand and run the one-time copy.</div><br/><div id="42036209" class="c"><input type="checkbox" id="c-42036209" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42035526">root</a><span>|</span><a href="#42035882">parent</a><span>|</span><a href="#42036405">next</a><span>|</span><label class="collapse" for="c-42036209">[-]</label><label class="expand" for="c-42036209">[1 more]</label></div><br/><div class="children"><div class="content">amazing! Will plan a release by Tuesday latest. You can experiment with `--copy-and-stream ` in the meantime [1]<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;shayonj&#x2F;pg_flo?tab=readme-ov-file#streaming-modes">https:&#x2F;&#x2F;github.com&#x2F;shayonj&#x2F;pg_flo?tab=readme-ov-file#streami...</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="42036405" class="c"><input type="checkbox" id="c-42036405" checked=""/><div class="controls bullet"><span class="by">oulipo</span><span>|</span><a href="#42035526">prev</a><span>|</span><a href="#42035301">next</a><span>|</span><label class="collapse" for="c-42036405">[-]</label><label class="expand" for="c-42036405">[1 more]</label></div><br/><div class="children"><div class="content">Would it be better to use replication rather than a backup on S3?</div><br/></div></div><div id="42035301" class="c"><input type="checkbox" id="c-42035301" checked=""/><div class="controls bullet"><span class="by">ibgeek</span><span>|</span><a href="#42036405">prev</a><span>|</span><label class="collapse" for="c-42035301">[-]</label><label class="expand" for="c-42035301">[2 more]</label></div><br/><div class="children"><div class="content">This is very cool!</div><br/><div id="42035444" class="c"><input type="checkbox" id="c-42035444" checked=""/><div class="controls bullet"><span class="by">shayonj</span><span>|</span><a href="#42035301">parent</a><span>|</span><label class="collapse" for="c-42035444">[-]</label><label class="expand" for="c-42035444">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! Still very early days, would love to hear any feedback.</div><br/></div></div></div></div></div></div></div></div></div></body></html>