<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1715936463905" as="style"/><link rel="stylesheet" href="styles.css?v=1715936463905"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.potaroo.net/ispcol/2024-05/starlink-tcp.html">A transport protocol&#x27;s view of Starlink</a> <span class="domain">(<a href="https://www.potaroo.net">www.potaroo.net</a>)</span></div><div class="subtext"><span>fanf2</span> | <span>19 comments</span></div><br/><div><div id="40386267" class="c"><input type="checkbox" id="c-40386267" checked=""/><div class="controls bullet"><span class="by">CaliforniaKarl</span><span>|</span><a href="#40386960">next</a><span>|</span><label class="collapse" for="c-40386267">[-]</label><label class="expand" for="c-40386267">[13 more]</label></div><br/><div class="children"><div class="content">One comment about the analysis of ping times in the section &quot;Low Earth Orbit Systems&quot;.  Specifically, the analysis of ping times &quot;within each 15s satellite tracking interval&quot;.<p>Most routers do not put ping-processing in the &quot;fast path&quot;.  That is, instead of having the ping be processed by an ASIC, the ping gets processed by the router&#x27;s CPU.  And ping-processing is typically a lower-priority task.  Because of that, you can&#x27;t assume that the high variation in latency is because of Starlink.</div><br/><div id="40386630" class="c"><input type="checkbox" id="c-40386630" checked=""/><div class="controls bullet"><span class="by">alfons_foobar</span><span>|</span><a href="#40386267">parent</a><span>|</span><a href="#40386990">next</a><span>|</span><label class="collapse" for="c-40386630">[-]</label><label class="expand" for="c-40386630">[4 more]</label></div><br/><div class="children"><div class="content">That is true for ICMP packets directed at the router itself.<p>Pretty sure that is the reason why he used<p>&gt; ping across a Starlink connection from the customer side terminal to the first IP end point behind the Starlink earth station<p>instead of pinging the terminal itself.<p>(ICMP packets passing _through_ a router are handled just like any other traffic and are therefore OK for an analysis like this)</div><br/><div id="40386708" class="c"><input type="checkbox" id="c-40386708" checked=""/><div class="controls bullet"><span class="by">maxmouchet</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386630">parent</a><span>|</span><a href="#40386759">next</a><span>|</span><label class="collapse" for="c-40386708">[-]</label><label class="expand" for="c-40386708">[1 more]</label></div><br/><div class="children"><div class="content">Additionally, I would not expect such “baseline” changes in the minimum RTT to be due to variation in CPU processing time.<p>These changes are more typical of a physical path change, as suggested by the author.<p>CPU&#x2F;soft processing latency would look more like additive noise.<p>I give some examples of RTT patterns in this talk: <a href="https:&#x2F;&#x2F;ripe77.ripe.net&#x2F;archives&#x2F;video&#x2F;2250&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ripe77.ripe.net&#x2F;archives&#x2F;video&#x2F;2250&#x2F;</a></div><br/></div></div><div id="40386759" class="c"><input type="checkbox" id="c-40386759" checked=""/><div class="controls bullet"><span class="by">CaliforniaKarl</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386630">parent</a><span>|</span><a href="#40386708">prev</a><span>|</span><a href="#40386990">next</a><span>|</span><label class="collapse" for="c-40386759">[-]</label><label class="expand" for="c-40386759">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s unclear to me.  `traceroute` typically just returns router IPs, so I&#x27;m assuming that &quot;the first IP end point behind the Starlink earth station&quot; is the IP address of a router of some sort.</div><br/><div id="40386958" class="c"><input type="checkbox" id="c-40386958" checked=""/><div class="controls bullet"><span class="by">alfons_foobar</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386759">parent</a><span>|</span><a href="#40386990">next</a><span>|</span><label class="collapse" for="c-40386958">[-]</label><label class="expand" for="c-40386958">[1 more]</label></div><br/><div class="children"><div class="content">Hm, I understood &quot;ip endpoint&quot; to mean something else than a router (because I am very sure that Geoff is aware of the &quot;ICMP is not handled on the ASIC&quot;-issue).</div><br/></div></div></div></div></div></div><div id="40386990" class="c"><input type="checkbox" id="c-40386990" checked=""/><div class="controls bullet"><span class="by">chgs</span><span>|</span><a href="#40386267">parent</a><span>|</span><a href="#40386630">prev</a><span>|</span><a href="#40386341">next</a><span>|</span><label class="collapse" for="c-40386990">[-]</label><label class="expand" for="c-40386990">[2 more]</label></div><br/><div class="children"><div class="content">I ping routers around the world all the time and rarely see any significant (&gt;1ms) change</div><br/><div id="40387116" class="c"><input type="checkbox" id="c-40387116" checked=""/><div class="controls bullet"><span class="by">damsalor</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386990">parent</a><span>|</span><a href="#40386341">next</a><span>|</span><label class="collapse" for="c-40387116">[-]</label><label class="expand" for="c-40387116">[1 more]</label></div><br/><div class="children"><div class="content">Most ppl do not enjoy that privilege</div><br/></div></div></div></div><div id="40386341" class="c"><input type="checkbox" id="c-40386341" checked=""/><div class="controls bullet"><span class="by">simoncion</span><span>|</span><a href="#40386267">parent</a><span>|</span><a href="#40386990">prev</a><span>|</span><a href="#40386424">next</a><span>|</span><label class="collapse" for="c-40386341">[-]</label><label class="expand" for="c-40386341">[4 more]</label></div><br/><div class="children"><div class="content">&gt; That is, instead of having the ping be processed by an ASIC, the ping gets processed by the router&#x27;s CPU.<p>I wonder how true that is anymore, with ICMPv6 processing being a mandatory part of IPv6. I could totally see ICMP processing being a low-priority task, but am far less certain that it would not be done by dedicated hardware these days.<p>On top of that, I&#x27;ve never, ever, ever noticed the behavior he&#x27;s observing with either my cable ISP connection, or the terrestrial microwave link provided by my local WISP. I don&#x27;t have enough data to say that I&#x27;d <i>never</i> see that behavior if I happened to ping some router powered by a potato... but I&#x27;ve pinged a whole bunch of systems over the years, and have never seen variation like what he describes.</div><br/><div id="40387194" class="c"><input type="checkbox" id="c-40387194" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386341">parent</a><span>|</span><a href="#40386367">next</a><span>|</span><label class="collapse" for="c-40387194">[-]</label><label class="expand" for="c-40387194">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I wonder how true that is anymore, with ICMPv6 processing being a mandatory part of IPv6.<p>ICMPv6 may be mandatory according to specs, but you can still drop most of it with no ill effects. You probably shouldn&#x27;t drop needs fragmentation packets, but everyone has adapted to those being dropped sometimes, so...<p>If you ignore neighbor discovery, you&#x27;ll have trouble reaching your neighbors, though.<p>But neighbor discovery is low volume mostly, and can be handled by the cpu, not the asic. Needs frag likely won&#x27;t be directed at the router ip, the asic can forward them just fine though.<p>I&#x27;ve certainly seen much more variable ping times for routers than for the hosts behind them. If the router&#x27;s cpu is less busy, ping times are usually a bit more than a host that&#x27;s right there, and as the router&#x27;s cpu gets more busy, the rtt increases or pings get dropped. It&#x27;s not usually a factor of how busy the links are either; routers tend to have a pretty limited amount of cpu and if they&#x27;re getting a lot of traffic, it&#x27;s easy to overload them.<p>I haven&#x27;t seen it happen quite in the bands like in the article, but sometimes it varies quite a bit. The results tend to be much more consistent if you can get a rtt from full host and not a router.</div><br/></div></div><div id="40386367" class="c"><input type="checkbox" id="c-40386367" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386341">parent</a><span>|</span><a href="#40387194">prev</a><span>|</span><a href="#40386424">next</a><span>|</span><label class="collapse" for="c-40386367">[-]</label><label class="expand" for="c-40386367">[2 more]</label></div><br/><div class="children"><div class="content">I’ve seen ping latencies of up to 30 seconds (yes, 30 000 milliseconds!) with a certain cable ISP, while at the same time VoIP (RDP over regular Internet IP, not “cable voice” or ISP-provided SIP, which often has its own QoS class) was borderline usable.<p>Could have been traffic shaping or prioritization (their network was in complete shambles after all), but ICMP was definitely taking some lower priority queue or path.</div><br/><div id="40386691" class="c"><input type="checkbox" id="c-40386691" checked=""/><div class="controls bullet"><span class="by">kkielhofner</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386367">parent</a><span>|</span><a href="#40386424">next</a><span>|</span><label class="collapse" for="c-40386691">[-]</label><label class="expand" for="c-40386691">[1 more]</label></div><br/><div class="children"><div class="content">*RTP</div><br/></div></div></div></div></div></div><div id="40386424" class="c"><input type="checkbox" id="c-40386424" checked=""/><div class="controls bullet"><span class="by">jiveturkey</span><span>|</span><a href="#40386267">parent</a><span>|</span><a href="#40386341">prev</a><span>|</span><a href="#40386960">next</a><span>|</span><label class="collapse" for="c-40386424">[-]</label><label class="expand" for="c-40386424">[2 more]</label></div><br/><div class="children"><div class="content">Indeed. Surprising that such a technical article from a supremely technical and knowledgeable person would not at least have a disclaimer about it. I would also be interested to know how much a Starlink satellite is an ASIC router vs pure CPU.<p>I believe a better technique would be to ping _through_ the router to another endpoint under ones own control, on the same network as the origin client, and where processing latency can be controlled. Basically ping yourself but via starlink and back.<p>That said, in practical terms he&#x27;s quite right about the jitter problem. I maintain 2 networks myself at my remote home. One my microwave WISP for tight latency and jitter, and then Starlink for much better bandwidth&#x2F;throughput.</div><br/><div id="40386635" class="c"><input type="checkbox" id="c-40386635" checked=""/><div class="controls bullet"><span class="by">alfons_foobar</span><span>|</span><a href="#40386267">root</a><span>|</span><a href="#40386424">parent</a><span>|</span><a href="#40386960">next</a><span>|</span><label class="collapse" for="c-40386635">[-]</label><label class="expand" for="c-40386635">[1 more]</label></div><br/><div class="children"><div class="content">He does ping through the starlink terminal:<p>&gt; ping across a Starlink connection from the customer side terminal to the first IP end point behind the Starlink earth station</div><br/></div></div></div></div></div></div><div id="40386960" class="c"><input type="checkbox" id="c-40386960" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#40386267">prev</a><span>|</span><a href="#40387122">next</a><span>|</span><label class="collapse" for="c-40386960">[-]</label><label class="expand" for="c-40386960">[2 more]</label></div><br/><div class="children"><div class="content">&gt; This orbital velocity at the surface of the earth is some 40,320 km&#x2F;sec.<p>Huh?  Is this right?  That&#x27;s really fast, like 24,800 miles per second, which is a significant fraction of c (the speed of light, 186,000 miles&#x2F;sec).  &gt;10% of c, is this a typo?</div><br/><div id="40386998" class="c"><input type="checkbox" id="c-40386998" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#40386960">parent</a><span>|</span><a href="#40387122">next</a><span>|</span><label class="collapse" for="c-40386998">[-]</label><label class="expand" for="c-40386998">[1 more]</label></div><br/><div class="children"><div class="content">They probably meant km&#x2F;h - that&#x27;s in the right ballpark for the oft cited 7.5 km&#x2F;sec for LEO.</div><br/></div></div></div></div><div id="40387122" class="c"><input type="checkbox" id="c-40387122" checked=""/><div class="controls bullet"><span class="by">pingpong250</span><span>|</span><a href="#40386960">prev</a><span>|</span><a href="#40386625">next</a><span>|</span><label class="collapse" for="c-40387122">[-]</label><label class="expand" for="c-40387122">[1 more]</label></div><br/><div class="children"><div class="content">Is this scenario not what TCP Peach was created for?</div><br/></div></div><div id="40386625" class="c"><input type="checkbox" id="c-40386625" checked=""/><div class="controls bullet"><span class="by">justsomehnguy</span><span>|</span><a href="#40387122">prev</a><span>|</span><label class="collapse" for="c-40386625">[-]</label><label class="expand" for="c-40386625">[2 more]</label></div><br/><div class="children"><div class="content">&gt; A “flooding” ping sends a new ping packet each time a packet is received from the remote end<p>Uhm, no:<p><pre><code>    -f
       Flood ping. For every ECHO_REQUEST sent a period “.” is
       printed, while for every ECHO_REPLY received a backspace is
       printed. This provides a rapid display of how many packets
       are being dropped. If interval is not given, it sets interval
       to zero and outputs packets as fast as they come back or one
       hundred times per second, whichever is more. Only the
       super-user may use this option with zero interval.</code></pre></div><br/><div id="40387290" class="c"><input type="checkbox" id="c-40387290" checked=""/><div class="controls bullet"><span class="by">londons_explore</span><span>|</span><a href="#40386625">parent</a><span>|</span><label class="collapse" for="c-40387290">[-]</label><label class="expand" for="c-40387290">[1 more]</label></div><br/><div class="children"><div class="content">&gt; outputs packets as fast as they come back<p><i>If</i> the latency is under 10 ms, then what op said is correct .</div><br/></div></div></div></div></div></div></div></div></div></body></html>