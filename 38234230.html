<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1699779654698" as="style"/><link rel="stylesheet" href="styles.css?v=1699779654698"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.petefreitag.com/item/1005.cfm">The Newline Cat Mystery</a> <span class="domain">(<a href="https://www.petefreitag.com">www.petefreitag.com</a>)</span></div><div class="subtext"><span>rmason</span> | <span>28 comments</span></div><br/><div><div id="38237601" class="c"><input type="checkbox" id="c-38237601" checked=""/><div class="controls bullet"><span class="by">xelxebar</span><span>|</span><a href="#38234354">next</a><span>|</span><label class="collapse" for="c-38237601">[-]</label><label class="expand" for="c-38237601">[2 more]</label></div><br/><div class="children"><div class="content">Output that doesn&#x27;t end in LF is pretty annoying in general, since the shell prompt gets visually tacked on to the end. I have this as part of my PROMPT_COMMAND:<p><pre><code>    printf &quot;%%%$((COLUMNS - 1))s\\r%1s\\r&quot;
</code></pre>
Effectively, it adds the missing newline in those cases and puts a &#x27;%&#x27; at the end of the output to let you know. The implementation is tad bit of printf trickery that leverages your bash&#x27;s line wrapping.</div><br/></div></div><div id="38234354" class="c"><input type="checkbox" id="c-38234354" checked=""/><div class="controls bullet"><span class="by">h2odragon</span><span>|</span><a href="#38237601">prev</a><span>|</span><a href="#38238474">next</a><span>|</span><label class="collapse" for="c-38234354">[-]</label><label class="expand" for="c-38234354">[6 more]</label></div><br/><div class="children"><div class="content">&quot;cat wasn&#x27;t displaying anything&quot; ?<p>perhaps: &quot;the terminal correctly displayed the file, overwriting the printed line at each CR, with the last line blank&quot;<p><a href="https:&#x2F;&#x2F;unix.stackexchange.com&#x2F;questions&#x2F;355559&#x2F;bash-and-carriage-return-behavior" rel="nofollow noreferrer">https:&#x2F;&#x2F;unix.stackexchange.com&#x2F;questions&#x2F;355559&#x2F;bash-and-car...</a></div><br/><div id="38234623" class="c"><input type="checkbox" id="c-38234623" checked=""/><div class="controls bullet"><span class="by">benj111</span><span>|</span><a href="#38234354">parent</a><span>|</span><a href="#38236199">next</a><span>|</span><label class="collapse" for="c-38234623">[-]</label><label class="expand" for="c-38234623">[4 more]</label></div><br/><div class="children"><div class="content">That over writes though. It doesn&#x27;t delete.<p>Foofoo\rbar\r<p>Should show as<p>barfoo<p>With the cursor over the start of that line.</div><br/><div id="38235940" class="c"><input type="checkbox" id="c-38235940" checked=""/><div class="controls bullet"><span class="by">dan-robertson</span><span>|</span><a href="#38234354">root</a><span>|</span><a href="#38234623">parent</a><span>|</span><a href="#38234684">next</a><span>|</span><label class="collapse" for="c-38235940">[-]</label><label class="expand" for="c-38235940">[1 more]</label></div><br/><div class="children"><div class="content">Yeah except the file ends in \r so the OP may have had their prompt longer than any of the lines (e.g. [user@hostname cwd] $) such that they couldn’t tell.</div><br/></div></div><div id="38234684" class="c"><input type="checkbox" id="c-38234684" checked=""/><div class="controls bullet"><span class="by">h2odragon</span><span>|</span><a href="#38234354">root</a><span>|</span><a href="#38234623">parent</a><span>|</span><a href="#38235940">prev</a><span>|</span><a href="#38236199">next</a><span>|</span><label class="collapse" for="c-38234684">[-]</label><label class="expand" for="c-38234684">[2 more]</label></div><br/><div class="children"><div class="content">depends on the terminal</div><br/><div id="38238413" class="c"><input type="checkbox" id="c-38238413" checked=""/><div class="controls bullet"><span class="by">jstanley</span><span>|</span><a href="#38234354">root</a><span>|</span><a href="#38234684">parent</a><span>|</span><a href="#38236199">next</a><span>|</span><label class="collapse" for="c-38238413">[-]</label><label class="expand" for="c-38238413">[1 more]</label></div><br/><div class="children"><div class="content">What terminal interprets &quot;\r&quot; as &quot;clear the line&quot;? I would have thought that is considered a bug.</div><br/></div></div></div></div></div></div></div></div><div id="38238474" class="c"><input type="checkbox" id="c-38238474" checked=""/><div class="controls bullet"><span class="by">andrelaszlo</span><span>|</span><a href="#38234354">prev</a><span>|</span><a href="#38237987">next</a><span>|</span><label class="collapse" for="c-38238474">[-]</label><label class="expand" for="c-38238474">[1 more]</label></div><br/><div class="children"><div class="content">I usually pipe to od (od -c) whenever I&#x27;m not sure about stuff like that.</div><br/></div></div><div id="38237987" class="c"><input type="checkbox" id="c-38237987" checked=""/><div class="controls bullet"><span class="by">jolmg</span><span>|</span><a href="#38238474">prev</a><span>|</span><a href="#38236534">next</a><span>|</span><label class="collapse" for="c-38237987">[-]</label><label class="expand" for="c-38237987">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Still I find it very odd that cat didn&#x27;t show anything, perhaps it is because the carriage return, brings the cursor back to the beginning of the line, effectively erasing the line that was just output.<p>Bringing the cursor back doesn&#x27;t delete what was output. It&#x27;s writing over it with the second line and the shell prompt that deletes it.<p>If you set `PS1=&#x27;$ &#x27;`, one should be able to see part of both lines:<p><pre><code>  $ printf &#x27;&quot;order_id&quot;,&quot;date&quot;\r&quot;1&quot;,&quot;2023-01-01&quot;\r&#x27;
  $ &quot;,&quot;2023-01-01&quot;&quot;</code></pre></div><br/></div></div><div id="38236534" class="c"><input type="checkbox" id="c-38236534" checked=""/><div class="controls bullet"><span class="by">h2odragon</span><span>|</span><a href="#38237987">prev</a><span>|</span><a href="#38236079">next</a><span>|</span><label class="collapse" for="c-38236534">[-]</label><label class="expand" for="c-38236534">[1 more]</label></div><br/><div class="children"><div class="content">This awakened dim memories of trying to duplicate curses functionality and reading sources for that and termcap.<p>share and enjoy<p><a href="https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;termutils&#x2F;manual&#x2F;termcap-1.3&#x2F;html_chapter&#x2F;termcap_2.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;termutils&#x2F;manual&#x2F;termcap-1.3&#x2F;ht...</a></div><br/></div></div><div id="38236079" class="c"><input type="checkbox" id="c-38236079" checked=""/><div class="controls bullet"><span class="by">thequux</span><span>|</span><a href="#38236534">prev</a><span>|</span><a href="#38236522">next</a><span>|</span><label class="collapse" for="c-38236079">[-]</label><label class="expand" for="c-38236079">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m a big fan of `sed -nel` for an unambiguous listing of the contents of a file. The only case that sed doesn&#x27;t show is a missing trailing linefeed.</div><br/><div id="38237565" class="c"><input type="checkbox" id="c-38237565" checked=""/><div class="controls bullet"><span class="by">fsckboy</span><span>|</span><a href="#38236079">parent</a><span>|</span><a href="#38237035">next</a><span>|</span><label class="collapse" for="c-38237565">[-]</label><label class="expand" for="c-38237565">[1 more]</label></div><br/><div class="children"><div class="content">why would you show a missing trailing linefeed? it&#x27;s missing... do you mean it will do a single CR-LF whether there was a NL there or not?</div><br/></div></div><div id="38237035" class="c"><input type="checkbox" id="c-38237035" checked=""/><div class="controls bullet"><span class="by">ramses0</span><span>|</span><a href="#38236079">parent</a><span>|</span><a href="#38237565">prev</a><span>|</span><a href="#38236522">next</a><span>|</span><label class="collapse" for="c-38237035">[-]</label><label class="expand" for="c-38237035">[1 more]</label></div><br/><div class="children"><div class="content">hexdump -C<p>...this is the only way.</div><br/></div></div></div></div><div id="38236522" class="c"><input type="checkbox" id="c-38236522" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#38236079">prev</a><span>|</span><a href="#38237608">next</a><span>|</span><label class="collapse" for="c-38236522">[-]</label><label class="expand" for="c-38236522">[4 more]</label></div><br/><div class="children"><div class="content">I don’t understand this part:<p>&gt; Now one thing that I should have noticed was that the file size was 9 bytes<p>The file contains more than 9 characters.  What was the author trying to say?</div><br/><div id="38237002" class="c"><input type="checkbox" id="c-38237002" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#38236522">parent</a><span>|</span><a href="#38237079">next</a><span>|</span><label class="collapse" for="c-38237002">[-]</label><label class="expand" for="c-38237002">[2 more]</label></div><br/><div class="children"><div class="content">He saw nothing print when he used &#x27;cat&#x27; on the file. Seeing it be 9 bytes was strange because it just printed out nothing.</div><br/><div id="38237211" class="c"><input type="checkbox" id="c-38237211" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#38236522">root</a><span>|</span><a href="#38237002">parent</a><span>|</span><a href="#38237079">next</a><span>|</span><label class="collapse" for="c-38237211">[-]</label><label class="expand" for="c-38237211">[1 more]</label></div><br/><div class="children"><div class="content">But it contained more than 9 bytes if you look at his example.</div><br/></div></div></div></div><div id="38237079" class="c"><input type="checkbox" id="c-38237079" checked=""/><div class="controls bullet"><span class="by">fourthark</span><span>|</span><a href="#38236522">parent</a><span>|</span><a href="#38237002">prev</a><span>|</span><a href="#38237608">next</a><span>|</span><label class="collapse" for="c-38237079">[-]</label><label class="expand" for="c-38237079">[1 more]</label></div><br/><div class="children"><div class="content">Probably not this simplified example.</div><br/></div></div></div></div><div id="38237608" class="c"><input type="checkbox" id="c-38237608" checked=""/><div class="controls bullet"><span class="by">dmarinus</span><span>|</span><a href="#38236522">prev</a><span>|</span><a href="#38236408">next</a><span>|</span><label class="collapse" for="c-38237608">[-]</label><label class="expand" for="c-38237608">[2 more]</label></div><br/><div class="children"><div class="content">cat does have parameters to show nonprinting characters.</div><br/><div id="38238059" class="c"><input type="checkbox" id="c-38238059" checked=""/><div class="controls bullet"><span class="by">pronoiac</span><span>|</span><a href="#38237608">parent</a><span>|</span><a href="#38236408">next</a><span>|</span><label class="collapse" for="c-38238059">[-]</label><label class="expand" for="c-38238059">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  cat -v
</code></pre>
For a very short file, I might reach for hexdump -C</div><br/></div></div></div></div><div id="38236408" class="c"><input type="checkbox" id="c-38236408" checked=""/><div class="controls bullet"><span class="by">okanat</span><span>|</span><a href="#38237608">prev</a><span>|</span><label class="collapse" for="c-38236408">[-]</label><label class="expand" for="c-38236408">[7 more]</label></div><br/><div class="children"><div class="content">This is one of the places that &quot;do one thing&quot; principle breaks down. Or a bad habit became a bad definition for the use case of a command and it stuck for newbies.<p>`cat` usually does one thing: concatenate the contents of the inputs you give in the order you give them. Of course, if the user gives only one input, it will only print that.<p>It is not a text viewer even though many *nix users use it that way because they learned it that way, because a series of tutorials taught the wrong thing to generations. The very first one probably came from a very limited and very bad Unix environment like a server that is hostile to active development. So the tutorial used whatever core utility that&#x27;s available: cat, beginning the multi-generational bad habit.</div><br/><div id="38236806" class="c"><input type="checkbox" id="c-38236806" checked=""/><div class="controls bullet"><span class="by">Qwertious</span><span>|</span><a href="#38236408">parent</a><span>|</span><a href="#38236794">next</a><span>|</span><label class="collapse" for="c-38236806">[-]</label><label class="expand" for="c-38236806">[3 more]</label></div><br/><div class="children"><div class="content">The &quot;do one thing&quot; is failed by text itself - text encodes backspacing and such. It even has a <i>bell character</i>. This has no reason to be built into our text format.<p>Saying &quot;cat is not a text viewer&quot; is absurd, though - the history of Unix is that the &quot;print&quot; command was removed when the Unix devs realized that cat did the same thing already, and so told their users to just use cat with a single argument.<p>I&#x27;m not saying it was good design, but it was <i>intended</i> design.</div><br/><div id="38237546" class="c"><input type="checkbox" id="c-38237546" checked=""/><div class="controls bullet"><span class="by">fsckboy</span><span>|</span><a href="#38236408">root</a><span>|</span><a href="#38236806">parent</a><span>|</span><a href="#38236794">next</a><span>|</span><label class="collapse" for="c-38237546">[-]</label><label class="expand" for="c-38237546">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <i>It even has a bell character. This has no reason to be built into our text format.</i><p>it&#x27;s <i>not</i> built into our text format (our being us,-unix-before-unicode). It&#x27;s built into the terminal.<p>The file format is 8-bit clean as it should be, any other values are going to have to be out-of-band. The unix stream format follows the file format, with the exception of<p>the terminal format (and the comms format) is 7-bit ascii with varying amounts of ANSI control, but that&#x27;s on you, you bought the terminal...</div><br/><div id="38238421" class="c"><input type="checkbox" id="c-38238421" checked=""/><div class="controls bullet"><span class="by">SuchAnonMuchWow</span><span>|</span><a href="#38236408">root</a><span>|</span><a href="#38237546">parent</a><span>|</span><a href="#38236794">next</a><span>|</span><label class="collapse" for="c-38238421">[-]</label><label class="expand" for="c-38238421">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure what you mean: ASCII text encoding is full of controls characters, most of them being only historical and not used by anything, including terminals.</div><br/></div></div></div></div></div></div><div id="38236794" class="c"><input type="checkbox" id="c-38236794" checked=""/><div class="controls bullet"><span class="by">probably_wrong</span><span>|</span><a href="#38236408">parent</a><span>|</span><a href="#38236806">prev</a><span>|</span><label class="collapse" for="c-38236794">[-]</label><label class="expand" for="c-38236794">[3 more]</label></div><br/><div class="children"><div class="content">I would like to counter-argue that it&#x27;s the author&#x27;s fault for doing things the wrong way.<p>While I&#x27;m sure the actual code looked different, the &quot;spirit&quot; of the code builds a CSV file by concatenating strings and specifying raw ASCII codes. Building a CSV file like this on 2023 is guaranteed to cause bugs down the line.<p>Had the code used the Python CSV primitives, or at least had the author let Python convert the &quot;\n&quot; character to the OS-dependent representation, the bug would have been avoided entirely. The author just happened to run into it with `cat` instead of, say, a CSV parser confused about the unusual choice.</div><br/><div id="38237044" class="c"><input type="checkbox" id="c-38237044" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#38236408">root</a><span>|</span><a href="#38236794">parent</a><span>|</span><a href="#38237476">next</a><span>|</span><label class="collapse" for="c-38237044">[-]</label><label class="expand" for="c-38237044">[1 more]</label></div><br/><div class="children"><div class="content">The author says it was a simplified example. They may will have implement a fully features CSV emitter but got the liver separator wrong. Either way whether or not their CSV was valid is irrelevant to the story. The point is that some characters in a file may obscure the contents of that file in surprising ways.</div><br/></div></div><div id="38237476" class="c"><input type="checkbox" id="c-38237476" checked=""/><div class="controls bullet"><span class="by">kevin_thibedeau</span><span>|</span><a href="#38236408">root</a><span>|</span><a href="#38236794">parent</a><span>|</span><a href="#38237044">prev</a><span>|</span><label class="collapse" for="c-38237476">[-]</label><label class="expand" for="c-38237476">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s ColdFusion, not Python. A language that forces you to program like it&#x27;s the 60s because character escapes are too advanced a concept to implement.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>