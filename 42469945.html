<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1734944451746" as="style"/><link rel="stylesheet" href="styles.css?v=1734944451746"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/libriscv/multi_tenant_drogon">Show HN: Ephemeral VMs in 1 Microsecond</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>fwsgonzo</span> | <span>19 comments</span></div><br/><div><div id="42491720" class="c"><input type="checkbox" id="c-42491720" checked=""/><div class="controls bullet"><span class="by">jumploops</span><span>|</span><a href="#42492496">next</a><span>|</span><label class="collapse" for="c-42491720">[-]</label><label class="expand" for="c-42491720">[5 more]</label></div><br/><div class="children"><div class="content">What do VMs mean in this context?<p>I did a pass of the codebase and it seems they’re just forking processes?<p>It’s unclear to me where the safety guarantees come from (compared to using e.g. KVM).<p>Edit: it appears the safety guarantees come from libriscv[0]. As far as I can tell, these sandboxes are essentially RISC-V programs running in an isolated context (“machine”) where all the Linux syscalls are emulated and thus “safe.” Still curious what potential attack vectors may exist?<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;libriscv&#x2F;libriscv&#x2F;tree&#x2F;dfb7c85d01f01cb38fb34b529894a2baaa902d04">https:&#x2F;&#x2F;github.com&#x2F;libriscv&#x2F;libriscv&#x2F;tree&#x2F;dfb7c85d01f01cb38f...</a></div><br/><div id="42492321" class="c"><input type="checkbox" id="c-42492321" checked=""/><div class="controls bullet"><span class="by">fwsgonzo</span><span>|</span><a href="#42491720">parent</a><span>|</span><a href="#42491928">next</a><span>|</span><label class="collapse" for="c-42492321">[-]</label><label class="expand" for="c-42492321">[3 more]</label></div><br/><div class="children"><div class="content">Well, the boundary between the host and the guest, the system call API, is always going to be the biggest vector of attacks no matter what the solution used is. But, if you find a problem and fix it, you&#x27;re back to being safe again, unlike if you don&#x27;t have any sandboxing at all. You can also put the whole solution in a jail, which is very common nowadays.</div><br/><div id="42492366" class="c"><input type="checkbox" id="c-42492366" checked=""/><div class="controls bullet"><span class="by">jumploops</span><span>|</span><a href="#42491720">root</a><span>|</span><a href="#42492321">parent</a><span>|</span><a href="#42491928">next</a><span>|</span><label class="collapse" for="c-42492366">[-]</label><label class="expand" for="c-42492366">[2 more]</label></div><br/><div class="children"><div class="content">Can you expand on “put the whole solution in a jail”?</div><br/><div id="42492412" class="c"><input type="checkbox" id="c-42492412" checked=""/><div class="controls bullet"><span class="by">fwsgonzo</span><span>|</span><a href="#42491720">root</a><span>|</span><a href="#42492366">parent</a><span>|</span><a href="#42491928">next</a><span>|</span><label class="collapse" for="c-42492412">[-]</label><label class="expand" for="c-42492412">[1 more]</label></div><br/><div class="children"><div class="content">FireCracker has a jailer: <a href="https:&#x2F;&#x2F;github.com&#x2F;firecracker-microvm&#x2F;firecracker&#x2F;blob&#x2F;main&#x2F;docs&#x2F;jailer.md">https:&#x2F;&#x2F;github.com&#x2F;firecracker-microvm&#x2F;firecracker&#x2F;blob&#x2F;main...</a></div><br/></div></div></div></div></div></div><div id="42491928" class="c"><input type="checkbox" id="c-42491928" checked=""/><div class="controls bullet"><span class="by">RainyDayTmrw</span><span>|</span><a href="#42491720">parent</a><span>|</span><a href="#42492321">prev</a><span>|</span><a href="#42492496">next</a><span>|</span><label class="collapse" for="c-42491928">[-]</label><label class="expand" for="c-42491928">[1 more]</label></div><br/><div class="children"><div class="content">See also: Google&#x27;s GVisor [1], which was used in Google App Engine.<p>[1]: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;GVisor" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;GVisor</a></div><br/></div></div></div></div><div id="42492496" class="c"><input type="checkbox" id="c-42492496" checked=""/><div class="controls bullet"><span class="by">ilaksh</span><span>|</span><a href="#42491720">prev</a><span>|</span><a href="#42492389">next</a><span>|</span><label class="collapse" for="c-42492496">[-]</label><label class="expand" for="c-42492496">[3 more]</label></div><br/><div class="children"><div class="content">Is this better than Firecracker? I was thinking about using that but it needs nested virtualization and the servers that support that aren&#x27;t as good of a value. Anyone know a good option for nested virtualization that is inexpensive?<p>Hetzner is really cheap but not sure about the cost effectiveness for the dedicated servers. Actually I think what I saw was that I couldn&#x27;t get the one I wanted in a US datacenter.</div><br/><div id="42492573" class="c"><input type="checkbox" id="c-42492573" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#42492496">parent</a><span>|</span><a href="#42492759">next</a><span>|</span><label class="collapse" for="c-42492573">[-]</label><label class="expand" for="c-42492573">[1 more]</label></div><br/><div class="children"><div class="content">The cited startup time is better than Firecracker but it&#x27;s not a better tool than Firecracker (for a start only claims to be a PoC, &quot;contains only the necessary parts for realistic benchmarking&quot;). Looks like it&#x27;s based on RISC-V emulation so the approach seems unlikely to get performance comparable to Firecracker.<p>You might look into gVisor if you&#x27;re running containerized workloads on a host without virt support (such as a vm without nested virtualization support).</div><br/></div></div><div id="42492759" class="c"><input type="checkbox" id="c-42492759" checked=""/><div class="controls bullet"><span class="by">fwsgonzo</span><span>|</span><a href="#42492496">parent</a><span>|</span><a href="#42492573">prev</a><span>|</span><a href="#42492389">next</a><span>|</span><label class="collapse" for="c-42492759">[-]</label><label class="expand" for="c-42492759">[1 more]</label></div><br/><div class="children"><div class="content">Absolutely not! It&#x27;s better to use something backed by KVM, so that you can use all the features of the CPU. This is just a proof-of-concept that was fun to make.</div><br/></div></div></div></div><div id="42492389" class="c"><input type="checkbox" id="c-42492389" checked=""/><div class="controls bullet"><span class="by">EgoIncarnate</span><span>|</span><a href="#42492496">prev</a><span>|</span><a href="#42491148">next</a><span>|</span><label class="collapse" for="c-42492389">[-]</label><label class="expand" for="c-42492389">[1 more]</label></div><br/><div class="children"><div class="content">The use of the term VM without further qualification in the title is unfortunate. Emulated VM would have been nicer to avoid confusion with hypervisor style virtual machines.<p>Staring emphermial hypervisor VMs quickly is more noteworthy (since they are often slow to start) than an emulator VM where it&#x27;s expected to be fast since it&#x27;s usually not much more than setting up a datastructure and executing a call to an interpreter. I clicked hoping for the former, only to find out the project is the latter.</div><br/></div></div><div id="42491148" class="c"><input type="checkbox" id="c-42491148" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#42492389">prev</a><span>|</span><a href="#42492314">next</a><span>|</span><label class="collapse" for="c-42491148">[-]</label><label class="expand" for="c-42491148">[1 more]</label></div><br/><div class="children"><div class="content">This GitHub org was cited several times in the recent &quot;source available&quot; annoucement for MoonBit, if one wishes to see more &quot;in the wild&quot; usage <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42450274">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=42450274</a></div><br/></div></div><div id="42492314" class="c"><input type="checkbox" id="c-42492314" checked=""/><div class="controls bullet"><span class="by">mattclarkdotnet</span><span>|</span><a href="#42491148">prev</a><span>|</span><a href="#42491161">next</a><span>|</span><label class="collapse" for="c-42492314">[-]</label><label class="expand" for="c-42492314">[1 more]</label></div><br/><div class="children"><div class="content">Having scanned the codebase, I think this is about quickly and safely launching and managing risc-v binaries as sandboxed processes?  Which is useful, but has nothing to do with virtual machines in the usual sense of there being a hypervisor with hardware support for isolation.</div><br/></div></div><div id="42491161" class="c"><input type="checkbox" id="c-42491161" checked=""/><div class="controls bullet"><span class="by">thornewolf</span><span>|</span><a href="#42492314">prev</a><span>|</span><a href="#42490755">next</a><span>|</span><label class="collapse" for="c-42491161">[-]</label><label class="expand" for="c-42491161">[2 more]</label></div><br/><div class="children"><div class="content">to check my understanding on what this is offering, I could build something on top of this that offers remote code execution for people without needing to worry about my system being compromised? or other people&#x27;s processes interacting with one another, but the VM will still be able to make web requests itself?</div><br/><div id="42492334" class="c"><input type="checkbox" id="c-42492334" checked=""/><div class="controls bullet"><span class="by">fwsgonzo</span><span>|</span><a href="#42491161">parent</a><span>|</span><a href="#42490755">next</a><span>|</span><label class="collapse" for="c-42492334">[-]</label><label class="expand" for="c-42492334">[1 more]</label></div><br/><div class="children"><div class="content">The VM could only make requests if you add a system call specifically for that purpose. Eg. if you add something like sys_request that takes a URL as argument and some input and output arguments. It&#x27;s not that the VM couldn&#x27;t open a socket and handle connections by itself, but it&#x27;s all closed down.<p>I think when it comes to being integrated into a web server, you ideally want to use the web servers pipeline to make requests, so that you can benefit from the same logging and observability that Drogon (or other solutions) already have.<p>If you allow the VM to make requests on its own, you just have the IP and an open socket. Not much to debug with if (let&#x27;s say) you have a customer asking about something.</div><br/></div></div></div></div><div id="42490755" class="c"><input type="checkbox" id="c-42490755" checked=""/><div class="controls bullet"><span class="by">kjok</span><span>|</span><a href="#42491161">prev</a><span>|</span><a href="#42490771">next</a><span>|</span><label class="collapse" for="c-42490755">[-]</label><label class="expand" for="c-42490755">[2 more]</label></div><br/><div class="children"><div class="content">What are the use cases?</div><br/><div id="42490767" class="c"><input type="checkbox" id="c-42490767" checked=""/><div class="controls bullet"><span class="by">selcuka</span><span>|</span><a href="#42490755">parent</a><span>|</span><a href="#42490771">next</a><span>|</span><label class="collapse" for="c-42490767">[-]</label><label class="expand" for="c-42490767">[1 more]</label></div><br/><div class="children"><div class="content">Explained in the first and second paragraphs of the README:<p>&gt; Multi-tenancy allows one server to be safely shared among many users, each of which cannot access each others or negatively affect the HTTP service.<p>&gt; Specialized sandboxes are instantiated for each request and immediately destroyed after the request, all within a single microsecond.</div><br/></div></div></div></div><div id="42490771" class="c"><input type="checkbox" id="c-42490771" checked=""/><div class="controls bullet"><span class="by">pyaamb</span><span>|</span><a href="#42490755">prev</a><span>|</span><label class="collapse" for="c-42490771">[-]</label><label class="expand" for="c-42490771">[3 more]</label></div><br/><div class="children"><div class="content">Whatever happened to Unikernels?</div><br/><div id="42490918" class="c"><input type="checkbox" id="c-42490918" checked=""/><div class="controls bullet"><span class="by">yla92</span><span>|</span><a href="#42490771">parent</a><span>|</span><a href="#42490816">next</a><span>|</span><label class="collapse" for="c-42490918">[-]</label><label class="expand" for="c-42490918">[1 more]</label></div><br/><div class="children"><div class="content">Still around. Recently, Prisma launched their managed Postgres offering built on top of Unikernels<p><a href="https:&#x2F;&#x2F;www.prisma.io&#x2F;blog&#x2F;announcing-prisma-postgres-early-access" rel="nofollow">https:&#x2F;&#x2F;www.prisma.io&#x2F;blog&#x2F;announcing-prisma-postgres-early-...</a></div><br/></div></div><div id="42490816" class="c"><input type="checkbox" id="c-42490816" checked=""/><div class="controls bullet"><span class="by">lgas</span><span>|</span><a href="#42490771">parent</a><span>|</span><a href="#42490918">prev</a><span>|</span><label class="collapse" for="c-42490816">[-]</label><label class="expand" for="c-42490816">[1 more]</label></div><br/><div class="children"><div class="content">Nothing.</div><br/></div></div></div></div></div></div></div></div></div></body></html>