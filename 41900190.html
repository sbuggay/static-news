<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1729674074069" as="style"/><link rel="stylesheet" href="styles.css?v=1729674074069"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/konstin/sudoku-in-python-packaging">Solving Sudoku in Python Packaging</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>Yenrabbit</span> | <span>30 comments</span></div><br/><div><div id="41921114" class="c"><input type="checkbox" id="c-41921114" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#41921739">next</a><span>|</span><label class="collapse" for="c-41921114">[-]</label><label class="expand" for="c-41921114">[9 more]</label></div><br/><div class="children"><div class="content">I love this so much. I dug around a bit and figured out how it works - I have an explanation (with an illustrative diagram) here: <a href="https:&#x2F;&#x2F;simonwillison.net&#x2F;2024&#x2F;Oct&#x2F;21&#x2F;sudoku-in-python-packaging&#x2F;" rel="nofollow">https:&#x2F;&#x2F;simonwillison.net&#x2F;2024&#x2F;Oct&#x2F;21&#x2F;sudoku-in-python-packa...</a><p>Figuring out how it works is a great way to learn a bit more about how Python packaging works under the hood. I learned that .whl files contain a METADATA file listing dependency constraints as &quot;Requires-Dist&quot; rules.<p>I ran a speed comparison too. Using the uv pip resolver it took 0.24s - with the older pip-compile tool it took 17s.</div><br/><div id="41922459" class="c"><input type="checkbox" id="c-41922459" checked=""/><div class="controls bullet"><span class="by">zahlman</span><span>|</span><a href="#41921114">parent</a><span>|</span><a href="#41921952">next</a><span>|</span><label class="collapse" for="c-41922459">[-]</label><label class="expand" for="c-41922459">[3 more]</label></div><br/><div class="children"><div class="content">People keep trying to sell the speed of such solutions as a killer feature for uv, but I think I must not be anywhere near the target audience. The constraint-solving required for the sorts of projects I would typically work on is not even remotely as complex, while I&#x27;m bottlenecked by a slow, unreliable Internet connection (and the lack of a good way to tell Pip <i>not</i> to check PyPI for new versions and <i>only</i> consider what&#x27;s currently in the wheel cache).</div><br/><div id="41922842" class="c"><input type="checkbox" id="c-41922842" checked=""/><div class="controls bullet"><span class="by">kvdveer</span><span>|</span><a href="#41921114">root</a><span>|</span><a href="#41922459">parent</a><span>|</span><a href="#41922721">next</a><span>|</span><label class="collapse" for="c-41922842">[-]</label><label class="expand" for="c-41922842">[1 more]</label></div><br/><div class="children"><div class="content">Our CI took 2 minutes to install the requirements. Adding UV dropped that to seconds. Now most time is spent on running tests, instead of installing requirements.<p>Of course we could&#x27;ve cached the venv, but cache invalidation is hard, and this is a very cheap way to avoid it.</div><br/></div></div><div id="41922721" class="c"><input type="checkbox" id="c-41922721" checked=""/><div class="controls bullet"><span class="by">itsbjoern</span><span>|</span><a href="#41921114">root</a><span>|</span><a href="#41922459">parent</a><span>|</span><a href="#41922842">prev</a><span>|</span><a href="#41921952">next</a><span>|</span><label class="collapse" for="c-41922721">[-]</label><label class="expand" for="c-41922721">[1 more]</label></div><br/><div class="children"><div class="content">Personally I’m just a fan of people improving dev tooling, regardless of it ultimately making a huge difference to my workflow. I haven’t used uv yet, but I’m still tangentially following it because despite pip and poetry being great tools I have had my fair share of grievances with them.</div><br/></div></div></div></div><div id="41921952" class="c"><input type="checkbox" id="c-41921952" checked=""/><div class="controls bullet"><span class="by">seanw444</span><span>|</span><a href="#41921114">parent</a><span>|</span><a href="#41922459">prev</a><span>|</span><a href="#41922023">next</a><span>|</span><label class="collapse" for="c-41921952">[-]</label><label class="expand" for="c-41921952">[4 more]</label></div><br/><div class="children"><div class="content">Wow, uv really is fast.</div><br/><div id="41922385" class="c"><input type="checkbox" id="c-41922385" checked=""/><div class="controls bullet"><span class="by">jebebeebehhe</span><span>|</span><a href="#41921114">root</a><span>|</span><a href="#41921952">parent</a><span>|</span><a href="#41922023">next</a><span>|</span><label class="collapse" for="c-41922385">[-]</label><label class="expand" for="c-41922385">[3 more]</label></div><br/><div class="children"><div class="content">As is simonw writing that post in under 60m assuming he first saw the concept here on HN.</div><br/><div id="41923179" class="c"><input type="checkbox" id="c-41923179" checked=""/><div class="controls bullet"><span class="by">Medox</span><span>|</span><a href="#41921114">root</a><span>|</span><a href="#41922385">parent</a><span>|</span><a href="#41922935">next</a><span>|</span><label class="collapse" for="c-41923179">[-]</label><label class="expand" for="c-41923179">[1 more]</label></div><br/><div class="children"><div class="content">Using the simonw resolver is took under 3600s *</div><br/></div></div></div></div></div></div></div></div><div id="41921739" class="c"><input type="checkbox" id="c-41921739" checked=""/><div class="controls bullet"><span class="by">visarga</span><span>|</span><a href="#41921114">prev</a><span>|</span><a href="#41921755">next</a><span>|</span><label class="collapse" for="c-41921739">[-]</label><label class="expand" for="c-41921739">[5 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why it feels like installing a ML repo is like sudoku. You install everything and at the last step you realize your neural net uses FlashAttention2 which only works on NVIDIA compute version that is not deployed in your cloud VM and you need to start over from scratch.</div><br/><div id="41923178" class="c"><input type="checkbox" id="c-41923178" checked=""/><div class="controls bullet"><span class="by">pjc50</span><span>|</span><a href="#41921739">parent</a><span>|</span><a href="#41923163">next</a><span>|</span><label class="collapse" for="c-41923178">[-]</label><label class="expand" for="c-41923178">[1 more]</label></div><br/><div class="children"><div class="content">See the discussion on why sqlite insists on vendoring its build dependencies as far as possible and not using, say, CMake.</div><br/></div></div><div id="41923163" class="c"><input type="checkbox" id="c-41923163" checked=""/><div class="controls bullet"><span class="by">austinjp</span><span>|</span><a href="#41921739">parent</a><span>|</span><a href="#41923178">prev</a><span>|</span><a href="#41922591">next</a><span>|</span><label class="collapse" for="c-41923163">[-]</label><label class="expand" for="c-41923163">[1 more]</label></div><br/><div class="children"><div class="content">This describes the day I wasted on Monday before I gave up and wrote some damn deterministic code instead of using some damn AI.</div><br/></div></div><div id="41922591" class="c"><input type="checkbox" id="c-41922591" checked=""/><div class="controls bullet"><span class="by">hskalin</span><span>|</span><a href="#41921739">parent</a><span>|</span><a href="#41923163">prev</a><span>|</span><a href="#41922634">next</a><span>|</span><label class="collapse" for="c-41922591">[-]</label><label class="expand" for="c-41922591">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes I just change the version of the package in requirements to fit with others and pray that it works out (a few times it does)</div><br/></div></div><div id="41922634" class="c"><input type="checkbox" id="c-41922634" checked=""/><div class="controls bullet"><span class="by">nicman23</span><span>|</span><a href="#41921739">parent</a><span>|</span><a href="#41922591">prev</a><span>|</span><a href="#41921755">next</a><span>|</span><label class="collapse" for="c-41922634">[-]</label><label class="expand" for="c-41922634">[1 more]</label></div><br/><div class="children"><div class="content">honestly if the ml does not have a docker image - not compose no build an image- i do not even bother any more</div><br/></div></div></div></div><div id="41921755" class="c"><input type="checkbox" id="c-41921755" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#41921739">prev</a><span>|</span><a href="#41921936">next</a><span>|</span><label class="collapse" for="c-41921755">[-]</label><label class="expand" for="c-41921755">[2 more]</label></div><br/><div class="children"><div class="content">Here’s the same thing in Poetry (2022): <a href="https:&#x2F;&#x2F;www.splitgraph.com&#x2F;blog&#x2F;poetry-dependency-resolver-sudoku" rel="nofollow">https:&#x2F;&#x2F;www.splitgraph.com&#x2F;blog&#x2F;poetry-dependency-resolver-s...</a></div><br/><div id="41922317" class="c"><input type="checkbox" id="c-41922317" checked=""/><div class="controls bullet"><span class="by">teschmitt</span><span>|</span><a href="#41921755">parent</a><span>|</span><a href="#41921936">next</a><span>|</span><label class="collapse" for="c-41922317">[-]</label><label class="expand" for="c-41922317">[1 more]</label></div><br/><div class="children"><div class="content">Was just about to say: I&#x27;ve seen this before but building it with a universally usable requirements.txt is even cooler.</div><br/></div></div></div></div><div id="41921936" class="c"><input type="checkbox" id="c-41921936" checked=""/><div class="controls bullet"><span class="by">echoangle</span><span>|</span><a href="#41921755">prev</a><span>|</span><a href="#41922973">next</a><span>|</span><label class="collapse" for="c-41921936">[-]</label><label class="expand" for="c-41921936">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Solving the versions of python package from your requirements is NP-complete, in the worst case it runs exponentially slow. Sudokus are also NP-complete, which means we can solve sudokus with python packaging.<p>Is that actually sufficient? Can every system that’s solving something that’s NP-complete solve every other NP-complete problem?</div><br/><div id="41921973" class="c"><input type="checkbox" id="c-41921973" checked=""/><div class="controls bullet"><span class="by">rolisz</span><span>|</span><a href="#41921936">parent</a><span>|</span><a href="#41922438">next</a><span>|</span><label class="collapse" for="c-41921973">[-]</label><label class="expand" for="c-41921973">[1 more]</label></div><br/><div class="children"><div class="content">Yes, NP complete means that every other NP problem is reducible to it.</div><br/></div></div><div id="41922438" class="c"><input type="checkbox" id="c-41922438" checked=""/><div class="controls bullet"><span class="by">zahlman</span><span>|</span><a href="#41921936">parent</a><span>|</span><a href="#41921973">prev</a><span>|</span><a href="#41922706">next</a><span>|</span><label class="collapse" for="c-41922438">[-]</label><label class="expand" for="c-41922438">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Can every system that’s solving something that’s NP-complete solve every other NP-complete problem?<p>Yes, by definition (<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NP-completeness" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;NP-completeness</a> , point 4).</div><br/></div></div><div id="41922706" class="c"><input type="checkbox" id="c-41922706" checked=""/><div class="controls bullet"><span class="by">arjvik</span><span>|</span><a href="#41921936">parent</a><span>|</span><a href="#41922438">prev</a><span>|</span><a href="#41922973">next</a><span>|</span><label class="collapse" for="c-41922706">[-]</label><label class="expand" for="c-41922706">[1 more]</label></div><br/><div class="children"><div class="content">I think for Sudoku to be NP-Complete, it needs to be generalized to arbitrary board sizes (at the very least)</div><br/></div></div></div></div><div id="41922973" class="c"><input type="checkbox" id="c-41922973" checked=""/><div class="controls bullet"><span class="by">mi_lk</span><span>|</span><a href="#41921936">prev</a><span>|</span><a href="#41904383">next</a><span>|</span><label class="collapse" for="c-41922973">[-]</label><label class="expand" for="c-41922973">[1 more]</label></div><br/><div class="children"><div class="content">See also this 2008 post using Debian package system to solve Sudoku:<p><a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20160326062818&#x2F;http:&#x2F;&#x2F;algebraicthunk.net&#x2F;~dburrows&#x2F;blog&#x2F;entry&#x2F;package-management-sudoku&#x2F;" rel="nofollow">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20160326062818&#x2F;http:&#x2F;&#x2F;algebraict...</a></div><br/></div></div><div id="41904383" class="c"><input type="checkbox" id="c-41904383" checked=""/><div class="controls bullet"><span class="by">yochem</span><span>|</span><a href="#41922973">prev</a><span>|</span><a href="#41920704">next</a><span>|</span><label class="collapse" for="c-41904383">[-]</label><label class="expand" for="c-41904383">[2 more]</label></div><br/><div class="children"><div class="content">No way pip actually is a really inefficient SAT solver!</div><br/><div id="41923093" class="c"><input type="checkbox" id="c-41923093" checked=""/><div class="controls bullet"><span class="by">stabbles</span><span>|</span><a href="#41904383">parent</a><span>|</span><a href="#41920704">next</a><span>|</span><label class="collapse" for="c-41923093">[-]</label><label class="expand" for="c-41923093">[1 more]</label></div><br/><div class="children"><div class="content">For a long time it was not because there was no backtracking.<p>Now it is just an exhaustive, recursive search: for the current package try using versions from newest to oldest, enqueue its dependencies, if satisfied return, if conflict continue.</div><br/></div></div></div></div><div id="41920704" class="c"><input type="checkbox" id="c-41920704" checked=""/><div class="controls bullet"><span class="by">ziofill</span><span>|</span><a href="#41904383">prev</a><span>|</span><a href="#41900227">next</a><span>|</span><label class="collapse" for="c-41920704">[-]</label><label class="expand" for="c-41920704">[5 more]</label></div><br/><div class="children"><div class="content">but how does it know the constraints?</div><br/><div id="41921022" class="c"><input type="checkbox" id="c-41921022" checked=""/><div class="controls bullet"><span class="by">thangngoc89</span><span>|</span><a href="#41920704">parent</a><span>|</span><a href="#41920779">next</a><span>|</span><label class="collapse" for="c-41921022">[-]</label><label class="expand" for="c-41921022">[1 more]</label></div><br/><div class="children"><div class="content">This is the content of sudoku_0_0-1-py3-none-any.whl.
So when the (0,0) cell is 1, none of the cells in the same row, column and subgrid should be 1.<p><pre><code>    Requires-Dist: sudoku_0_1 != 1
    Requires-Dist: sudoku_0_2 != 1
    Requires-Dist: sudoku_0_3 != 1
    Requires-Dist: sudoku_0_4 != 1
    Requires-Dist: sudoku_0_5 != 1
    Requires-Dist: sudoku_0_6 != 1
    Requires-Dist: sudoku_0_7 != 1
    Requires-Dist: sudoku_0_8 != 1
    Requires-Dist: sudoku_1_0 != 1
    Requires-Dist: sudoku_2_0 != 1
    Requires-Dist: sudoku_3_0 != 1
    Requires-Dist: sudoku_4_0 != 1
    Requires-Dist: sudoku_5_0 != 1
    Requires-Dist: sudoku_6_0 != 1
    Requires-Dist: sudoku_7_0 != 1
    Requires-Dist: sudoku_8_0 != 1
    Requires-Dist: sudoku_0_1 != 1
    Requires-Dist: sudoku_0_2 != 1
    Requires-Dist: sudoku_1_0 != 1
    Requires-Dist: sudoku_1_1 != 1
    Requires-Dist: sudoku_1_2 != 1
    Requires-Dist: sudoku_2_0 != 1
    Requires-Dist: sudoku_2_1 != 1
    Requires-Dist: sudoku_2_2 != 1</code></pre></div><br/></div></div><div id="41920779" class="c"><input type="checkbox" id="c-41920779" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#41920704">parent</a><span>|</span><a href="#41921022">prev</a><span>|</span><a href="#41921695">next</a><span>|</span><label class="collapse" for="c-41920779">[-]</label><label class="expand" for="c-41920779">[2 more]</label></div><br/><div class="children"><div class="content">The constraints are going to be static and independent of the puzzle. So I expect they&#x27;re encoded in the package dependencies. So for example version 1 of the package sudoku_0_0 will conflict with all of: version 1 of sudoku_[0-8]_0; version 1 of sudoku_0_[0-8]; version 1 of [012]_ [012].</div><br/><div id="41921797" class="c"><input type="checkbox" id="c-41921797" checked=""/><div class="controls bullet"><span class="by">roywiggins</span><span>|</span><a href="#41920704">root</a><span>|</span><a href="#41920779">parent</a><span>|</span><a href="#41921695">next</a><span>|</span><label class="collapse" for="c-41921797">[-]</label><label class="expand" for="c-41921797">[1 more]</label></div><br/><div class="children"><div class="content">generate_packages makes it moderately clear:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;konstin&#x2F;sudoku-in-python-packaging&#x2F;blob&#x2F;main&#x2F;generate_packages.py">https:&#x2F;&#x2F;github.com&#x2F;konstin&#x2F;sudoku-in-python-packaging&#x2F;blob&#x2F;m...</a></div><br/></div></div></div></div><div id="41921695" class="c"><input type="checkbox" id="c-41921695" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41920704">parent</a><span>|</span><a href="#41920779">prev</a><span>|</span><a href="#41900227">next</a><span>|</span><label class="collapse" for="c-41921695">[-]</label><label class="expand" for="c-41921695">[1 more]</label></div><br/><div class="children"><div class="content">Yeah they missed out the actual interesting bit from the readme...</div><br/></div></div></div></div><div id="41900227" class="c"><input type="checkbox" id="c-41900227" checked=""/><div class="controls bullet"><span class="by">niyonx</span><span>|</span><a href="#41920704">prev</a><span>|</span><label class="collapse" for="c-41900227">[-]</label><label class="expand" for="c-41900227">[1 more]</label></div><br/><div class="children"><div class="content">How did you even think of that? Nice!</div><br/></div></div></div></div></div></div></div></body></html>