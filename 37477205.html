<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1694509266329" as="style"/><link rel="stylesheet" href="styles.css?v=1694509266329"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a>Ask HN: How is Rust used in the Linux kernel today?</a> </div><div class="subtext"><span>nequo</span> | <span>17 comments</span></div><br/><div><div id="37477847" class="c"><input type="checkbox" id="c-37477847" checked=""/><div class="controls bullet"><span class="by">broodbucket</span><span>|</span><a href="#37477544">next</a><span>|</span><label class="collapse" for="c-37477847">[-]</label><label class="expand" for="c-37477847">[7 more]</label></div><br/><div class="children"><div class="content">The basic infrastructure for writing drivers in Rust is upstream but there&#x27;s nothing upstream using it yet.  Others have mentioned stuff that may eventually make its way upstream, but from what I&#x27;ve seen there&#x27;s pretty heavy resistance from maintainers whenever (re)writing something in Rust gets brought up.<p>Before Rust starts getting used &quot;for real&quot; in the kernel there&#x27;s a lot of barriers to overcome.  Most maintainers aren&#x27;t hugely proficient in Rust and absolutely do not have the time to learn.  Needing yet another toolchain is annoying (especially when you need bits that aren&#x27;t in stable yet), anything you write in Rust probably won&#x27;t get built in distro kernels for a long time, and anything you work on today is hugely uncharted territory since it&#x27;s all so new.<p>I think one thing a lot of people don&#x27;t understand from &quot;outside&quot; the kernel development sphere is that standards for getting stuff upstream are typically pretty high for most subsystems, a lot higher than most open source projects.  There are a lot of open questions about Rust in Linux that don&#x27;t have clear answers, and Linux <i>really</i> struggles with consensus.  Yes it has a dictator, but that dictator very rarely dictates anything that hugely moves the needle.<p>I do think &quot;real&quot; kernel bits written in Rust will get upstream and will get used, but it will be a very slow burn.</div><br/><div id="37478035" class="c"><input type="checkbox" id="c-37478035" checked=""/><div class="controls bullet"><span class="by">phdstudent</span><span>|</span><a href="#37477847">parent</a><span>|</span><a href="#37477544">next</a><span>|</span><label class="collapse" for="c-37478035">[-]</label><label class="expand" for="c-37478035">[6 more]</label></div><br/><div class="children"><div class="content">&gt; Most maintainers aren&#x27;t hugely proficient in Rust and absolutely do not have the time to learn.<p>Can LLMs help here with code (re)writing?</div><br/><div id="37478381" class="c"><input type="checkbox" id="c-37478381" checked=""/><div class="controls bullet"><span class="by">cpach</span><span>|</span><a href="#37477847">root</a><span>|</span><a href="#37478035">parent</a><span>|</span><a href="#37478104">next</a><span>|</span><label class="collapse" for="c-37478381">[-]</label><label class="expand" for="c-37478381">[1 more]</label></div><br/><div class="children"><div class="content">I’m just a layman when it comes to these kind of things. But here’s my take anyway: AFAICT, the issue isn’t so much about rewriting the code. However, if we would use automation for that, we would probably need <i>proofs</i> that the new code is better than the old one. And creating suchs proofs seems incredibly hard as soon as we walk out of “hello world” territory. People has spent years on trying to make suchs systems, but it’s still not widely used. So until then, we need people who read and analyze the code, and also have wast knowledge of the kernel’s inner workings, and today that seems to be the bottleneck. Those people doesn’t really grow on trees.</div><br/></div></div><div id="37478104" class="c"><input type="checkbox" id="c-37478104" checked=""/><div class="controls bullet"><span class="by">sundarurfriend</span><span>|</span><a href="#37477847">root</a><span>|</span><a href="#37478035">parent</a><span>|</span><a href="#37478381">prev</a><span>|</span><a href="#37478107">next</a><span>|</span><label class="collapse" for="c-37478104">[-]</label><label class="expand" for="c-37478104">[3 more]</label></div><br/><div class="children"><div class="content">The proficiency required to make sure the LLM is not screwing up the code in some subtle way, is probably even higher than the proficiency required to rewrite the code yourself. So probably not.</div><br/><div id="37478376" class="c"><input type="checkbox" id="c-37478376" checked=""/><div class="controls bullet"><span class="by">WiSaGaN</span><span>|</span><a href="#37477847">root</a><span>|</span><a href="#37478104">parent</a><span>|</span><a href="#37478249">next</a><span>|</span><label class="collapse" for="c-37478376">[-]</label><label class="expand" for="c-37478376">[1 more]</label></div><br/><div class="children"><div class="content">Code written in Rust for LLM would likely be easier to review than C code due to its strong type system and the inclusion of the borrow checker. However, I anticipate there might be more &#x27;unsafe&#x27; code, especially at the language boundaries, compared to typical Rust application code. Thus, the benefits might be somewhat diminished.</div><br/></div></div><div id="37478249" class="c"><input type="checkbox" id="c-37478249" checked=""/><div class="controls bullet"><span class="by">rob74</span><span>|</span><a href="#37477847">root</a><span>|</span><a href="#37478104">parent</a><span>|</span><a href="#37478376">prev</a><span>|</span><a href="#37478107">next</a><span>|</span><label class="collapse" for="c-37478249">[-]</label><label class="expand" for="c-37478249">[1 more]</label></div><br/><div class="children"><div class="content">Basically, you have to review code generated by an LLM the same way that you would review code written by a human programmer, which requires (at least) the same level of proficiency as writing code yourself - if not, as you wrote, higher proficiency.</div><br/></div></div></div></div><div id="37478107" class="c"><input type="checkbox" id="c-37478107" checked=""/><div class="controls bullet"><span class="by">speed_spread</span><span>|</span><a href="#37477847">root</a><span>|</span><a href="#37478035">parent</a><span>|</span><a href="#37478104">prev</a><span>|</span><a href="#37477544">next</a><span>|</span><label class="collapse" for="c-37478107">[-]</label><label class="expand" for="c-37478107">[1 more]</label></div><br/><div class="children"><div class="content">LLMs rewriting what? A) Rust modules to C so that it can be reviewed and merged by old school kernel hackers? B) C to unsafe Rust so that you lose any advantage of using Rust and get the worst of both world? C) Or rewrite the kernel maintainer&#x27;s brains while they sleep so they become magically proficient in Rust when they wake up?<p>If you&#x27;re talking about option A) or B), we already have things like mrustc and c2rust. These are though problems, LLMs aren&#x27;t _that_ smart yet.</div><br/></div></div></div></div></div></div><div id="37477544" class="c"><input type="checkbox" id="c-37477544" checked=""/><div class="controls bullet"><span class="by">gregkh</span><span>|</span><a href="#37477847">prev</a><span>|</span><a href="#37477668">next</a><span>|</span><label class="collapse" for="c-37477544">[-]</label><label class="expand" for="c-37477544">[1 more]</label></div><br/><div class="children"><div class="content">No, the only rust code accepted into any released kernels is basic framework infrastructure so that someday, maybe, in the future, real functionality could be written in rust.<p>There are many out-of-tree examples of rust kernel code, but as of right now, none have been merged.</div><br/></div></div><div id="37477668" class="c"><input type="checkbox" id="c-37477668" checked=""/><div class="controls bullet"><span class="by">dharmab</span><span>|</span><a href="#37477544">prev</a><span>|</span><a href="#37477507">next</a><span>|</span><label class="collapse" for="c-37477668">[-]</label><label class="expand" for="c-37477668">[1 more]</label></div><br/><div class="children"><div class="content">Asahi&#x27;s M1 GPU driver is the most notable example, although it is still alpha-quality and has not yet been upstreamed. <a href="https:&#x2F;&#x2F;asahilinux.org&#x2F;2022&#x2F;11&#x2F;tales-of-the-m1-gpu&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;asahilinux.org&#x2F;2022&#x2F;11&#x2F;tales-of-the-m1-gpu&#x2F;</a></div><br/></div></div><div id="37477507" class="c"><input type="checkbox" id="c-37477507" checked=""/><div class="controls bullet"><span class="by">unrealhoang</span><span>|</span><a href="#37477668">prev</a><span>|</span><a href="#37477277">next</a><span>|</span><label class="collapse" for="c-37477507">[-]</label><label class="expand" for="c-37477507">[1 more]</label></div><br/><div class="children"><div class="content">You can check out asahi linux GPU driver.</div><br/></div></div><div id="37477277" class="c"><input type="checkbox" id="c-37477277" checked=""/><div class="controls bullet"><span class="by">KingLancelot</span><span>|</span><a href="#37477507">prev</a><span>|</span><a href="#37478120">next</a><span>|</span><label class="collapse" for="c-37477277">[-]</label><label class="expand" for="c-37477277">[2 more]</label></div><br/><div class="children"><div class="content">I hear that Akashi uses it for Apple Mx graphics drivers, but I’m not aware of any widespread real world use.</div><br/><div id="37477960" class="c"><input type="checkbox" id="c-37477960" checked=""/><div class="controls bullet"><span class="by">snakey</span><span>|</span><a href="#37477277">parent</a><span>|</span><a href="#37478120">next</a><span>|</span><label class="collapse" for="c-37477960">[-]</label><label class="expand" for="c-37477960">[1 more]</label></div><br/><div class="children"><div class="content">They did! They wrote an excellent blog post about it too:<p><a href="https:&#x2F;&#x2F;asahilinux.org&#x2F;2022&#x2F;11&#x2F;tales-of-the-m1-gpu&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;asahilinux.org&#x2F;2022&#x2F;11&#x2F;tales-of-the-m1-gpu&#x2F;</a></div><br/></div></div></div></div><div id="37478120" class="c"><input type="checkbox" id="c-37478120" checked=""/><div class="controls bullet"><span class="by">raybb</span><span>|</span><a href="#37477277">prev</a><span>|</span><label class="collapse" for="c-37478120">[-]</label><label class="expand" for="c-37478120">[4 more]</label></div><br/><div class="children"><div class="content">Heres to hoping that one day maybe someone writes a Bluetooth driver in rust to improve the reliability a bit.<p>But then again as I understand it the spec is so massive and has plenty of problems it may not be something that is improved by rust.</div><br/><div id="37478245" class="c"><input type="checkbox" id="c-37478245" checked=""/><div class="controls bullet"><span class="by">sheepz</span><span>|</span><a href="#37478120">parent</a><span>|</span><label class="collapse" for="c-37478245">[-]</label><label class="expand" for="c-37478245">[3 more]</label></div><br/><div class="children"><div class="content">Why do you think rewriting it in Rust would improve its reliability?</div><br/><div id="37478312" class="c"><input type="checkbox" id="c-37478312" checked=""/><div class="controls bullet"><span class="by">sakex</span><span>|</span><a href="#37478120">root</a><span>|</span><a href="#37478245">parent</a><span>|</span><label class="collapse" for="c-37478312">[-]</label><label class="expand" for="c-37478312">[2 more]</label></div><br/><div class="children"><div class="content">Simply rewriting it in any language would improve reliability</div><br/><div id="37478349" class="c"><input type="checkbox" id="c-37478349" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#37478120">root</a><span>|</span><a href="#37478312">parent</a><span>|</span><label class="collapse" for="c-37478349">[-]</label><label class="expand" for="c-37478349">[1 more]</label></div><br/><div class="children"><div class="content">The problems with Bluetooth have nothing to do with the programming language used to write the stack.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>