<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732179670512" as="style"/><link rel="stylesheet" href="styles.css?v=1732179670512"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.denormalized.io/blog/building-databases">Building Databases over a Weekend</a> <span class="domain">(<a href="https://www.denormalized.io">www.denormalized.io</a>)</span></div><div class="subtext"><span>ambrood</span> | <span>12 comments</span></div><br/><div><div id="42200833" class="c"><input type="checkbox" id="c-42200833" checked=""/><div class="controls bullet"><span class="by">01HNNWZ0MV43FF</span><span>|</span><a href="#42201022">next</a><span>|</span><label class="collapse" for="c-42200833">[-]</label><label class="expand" for="c-42200833">[1 more]</label></div><br/><div class="children"><div class="content">&gt; In this post we take you on a walkthrough on how you can use DataFusion<p>Thought it was gonna be a &quot;build your own SQLite&quot; or something</div><br/></div></div><div id="42201022" class="c"><input type="checkbox" id="c-42201022" checked=""/><div class="controls bullet"><span class="by">Gepsens</span><span>|</span><a href="#42200833">prev</a><span>|</span><a href="#42201004">next</a><span>|</span><label class="collapse" for="c-42201022">[-]</label><label class="expand" for="c-42201022">[5 more]</label></div><br/><div class="children"><div class="content">I remember 2 years ago someone proposed adding stream processing in datafusion and PRs followed. But IMO stream processing is an entirely different beast, some people could use the sql engine of df for it though. There are rust projects like Arroyo</div><br/><div id="42201573" class="c"><input type="checkbox" id="c-42201573" checked=""/><div class="controls bullet"><span class="by">knuckleheads</span><span>|</span><a href="#42201022">parent</a><span>|</span><a href="#42201199">next</a><span>|</span><label class="collapse" for="c-42201573">[-]</label><label class="expand" for="c-42201573">[3 more]</label></div><br/><div class="children"><div class="content">I’ve been messing around with sql and stream processing off and on the last few months via <a href="https:&#x2F;&#x2F;github.com&#x2F;zmaril&#x2F;bpfquery">https:&#x2F;&#x2F;github.com&#x2F;zmaril&#x2F;bpfquery</a> and then <a href="https:&#x2F;&#x2F;github.com&#x2F;zmaril&#x2F;zquery">https:&#x2F;&#x2F;github.com&#x2F;zmaril&#x2F;zquery</a>, so I very much feel this comment. I didn’t want to build out my own stream processing architecture in bpfquery, it was getting pretty tough pretty fast, so I switched over to a datafusion backend in zquery in the hopes that it could do stream processing well. It can handle static data really well, much better the home grown half engine I made in bpfquery, but streaming sql isn’t easily possible at the moment, everybody is building their own implementations and trying to upstream what they need, no coherent whole from data fusion. I was looking into making an attempt with arroyo sometime, but I think the authors want that code to be used as a standalone binary and not as a library in something else, based on my last impression of it a while back. So, maybe in a few years it’ll be as easy to make a streaming database as it is now to make a normal one, but that’s not the case currently.</div><br/><div id="42201889" class="c"><input type="checkbox" id="c-42201889" checked=""/><div class="controls bullet"><span class="by">hantusk</span><span>|</span><a href="#42201022">root</a><span>|</span><a href="#42201573">parent</a><span>|</span><a href="#42201199">next</a><span>|</span><label class="collapse" for="c-42201889">[-]</label><label class="expand" for="c-42201889">[2 more]</label></div><br/><div class="children"><div class="content">I agree. So many disparate solutions. The streaming sql primitives are by themselves good enough (e.g. `tumble`, `hop` or `session` windows), but the infrastructural components are always rough in real life use cases.<p>crossing fingers for solutions like `<a href="https:&#x2F;&#x2F;github.com&#x2F;feldera&#x2F;feldera">https:&#x2F;&#x2F;github.com&#x2F;feldera&#x2F;feldera</a>` to be wrapped in a nice database, `<a href="https:&#x2F;&#x2F;materialize.com&#x2F;" rel="nofollow">https:&#x2F;&#x2F;materialize.com&#x2F;</a>` to solve their memory issues, or `<a href="https:&#x2F;&#x2F;clickhouse.com&#x2F;docs&#x2F;en&#x2F;materialized-view" rel="nofollow">https:&#x2F;&#x2F;clickhouse.com&#x2F;docs&#x2F;en&#x2F;materialized-view</a>` to solve reliable streaming consumption.<p>Various streaming processing frameworks often have domain specific languages with a lot of limitations of how to express aggregations and transformations.</div><br/><div id="42201968" class="c"><input type="checkbox" id="c-42201968" checked=""/><div class="controls bullet"><span class="by">knuckleheads</span><span>|</span><a href="#42201022">root</a><span>|</span><a href="#42201889">parent</a><span>|</span><a href="#42201199">next</a><span>|</span><label class="collapse" for="c-42201968">[-]</label><label class="expand" for="c-42201968">[1 more]</label></div><br/><div class="children"><div class="content">Yeah I have a feeling something like polars for streaming would be super popular and useful, but it just hasn&#x27;t happened yet. It&#x27;s much easier to just do say kafka and a long running python script and write out the transformations by hand, than it is to use anything on the market right now. None of the current streaming processors want to be embedded as far as I can tell, that&#x27;s not where the money is. They all want to be paid to run it in the cloud for you and follow that vc playbook model. Which, fair! I do think there&#x27;s a lot of space out that isn&#x27;t being occupied though and I hope somebody tries to fill it soon.<p>(As an aside, feldera doesn&#x27;t want to be embedded into your app, materialize either, and clickhouse might just pull a great streaming library out from nowhere, they seem to be good at just doing stuff like that).</div><br/></div></div></div></div></div></div><div id="42201199" class="c"><input type="checkbox" id="c-42201199" checked=""/><div class="controls bullet"><span class="by">necubi</span><span>|</span><a href="#42201022">parent</a><span>|</span><a href="#42201573">prev</a><span>|</span><a href="#42201004">next</a><span>|</span><label class="collapse" for="c-42201199">[-]</label><label class="expand" for="c-42201199">[1 more]</label></div><br/><div class="children"><div class="content">Creator of Arroyo here—we agree that stream processing is a different beast and needs different infrastructure from a batch engine like DataFusion.<p>Our approach has been to take pieces of DF (including the SQL frontend and expression engine) but embedding them in our own dataflow and operators. This allows us to support low latency, distribution, watermark processing, and consistent checkpointing.<p>But the great thing about DF is that it’s designed as a toolkit for SQL-oriented data processing, so it’s relatively easy to pick and use just the pieces you need.</div><br/></div></div></div></div><div id="42200994" class="c"><input type="checkbox" id="c-42200994" checked=""/><div class="controls bullet"><span class="by">dangoodmanUT</span><span>|</span><a href="#42201004">prev</a><span>|</span><label class="collapse" for="c-42200994">[-]</label><label class="expand" for="c-42200994">[4 more]</label></div><br/><div class="children"><div class="content">this post feels like it&#x27;s skipping over a lot of code that could be included</div><br/><div id="42201233" class="c"><input type="checkbox" id="c-42201233" checked=""/><div class="controls bullet"><span class="by">JoeOfTexas</span><span>|</span><a href="#42200994">parent</a><span>|</span><a href="#42201265">next</a><span>|</span><label class="collapse" for="c-42201233">[-]</label><label class="expand" for="c-42201233">[1 more]</label></div><br/><div class="children"><div class="content">Step 1. Choose a color
Step 2. Finish the database</div><br/></div></div><div id="42201265" class="c"><input type="checkbox" id="c-42201265" checked=""/><div class="controls bullet"><span class="by">ambrood</span><span>|</span><a href="#42200994">parent</a><span>|</span><a href="#42201233">prev</a><span>|</span><a href="#42201254">next</a><span>|</span><label class="collapse" for="c-42201265">[-]</label><label class="expand" for="c-42201265">[1 more]</label></div><br/><div class="children"><div class="content">thanks for the feedback! the first version had a lot more detailed code but decided to go with linking to our GitHub than copying all the code. Wanted to illustrate the core touch points involved in extending DF.</div><br/></div></div><div id="42201254" class="c"><input type="checkbox" id="c-42201254" checked=""/><div class="controls bullet"><span class="by">ztratar</span><span>|</span><a href="#42200994">parent</a><span>|</span><a href="#42201265">prev</a><span>|</span><label class="collapse" for="c-42201254">[-]</label><label class="expand" for="c-42201254">[1 more]</label></div><br/><div class="children"><div class="content">I almost thought the opposite, but im no db guy.</div><br/></div></div></div></div></div></div></div></div></div></body></html>