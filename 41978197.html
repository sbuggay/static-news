<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730192458014" as="style"/><link rel="stylesheet" href="styles.css?v=1730192458014"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.toast.cafe/posix2024-xcu">What&#x27;s New in POSIX 2024</a> <span class="domain">(<a href="https://blog.toast.cafe">blog.toast.cafe</a>)</span></div><div class="subtext"><span>signa11</span> | <span>36 comments</span></div><br/><div><div id="41980339" class="c"><input type="checkbox" id="c-41980339" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#41980129">next</a><span>|</span><label class="collapse" for="c-41980339">[-]</label><label class="expand" for="c-41980339">[15 more]</label></div><br/><div class="children"><div class="content">&gt; We’ve established that, yes, pathnames can include newlines. We have not established why they can do that. After some deliberation, the Austin Group could not find a single use-case for newlines in pathnames besides breaking naive scripts. Wouldn’t it be nice if the naive scripts were just correct now? Ok, that might be a bit much all at once. We’re heading there though!<p>Oh my god.  This makes me so happy.  This is the most lovely think I&#x27;ve read in the world of computing since the unix gods decided that newlines were to be a single character.<p>The philosophy underlying the sentence &quot;Wouldn’t it be nice if the naive scripts were just correct now?&quot; is incredibly positive.  We are surrounded by arrogant jerks who break old code by aggressively enforcing stricter compliance of some stupid rules.  But here come these posix heros who do the exact opposite: make old code correct! There is hope in mankind after all.</div><br/><div id="41980425" class="c"><input type="checkbox" id="c-41980425" checked=""/><div class="controls bullet"><span class="by">anal_reactor</span><span>|</span><a href="#41980339">parent</a><span>|</span><a href="#41980129">next</a><span>|</span><label class="collapse" for="c-41980425">[-]</label><label class="expand" for="c-41980425">[14 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a bandaid on a wider problem: the design of Unix shell is bonkers and the whole thing should be deleted. Why? Because I haven&#x27;t seen any other tool ever have so many pitfalls. Take n random languages and m random developers and tell them to loop over a string array and print its contents, and count how many correct programs you get on average per language. There will be easy languages, then difficult languages, then a huge gap, then Unix shell because in your random sample you managed to get one guy who has PhD in bash.</div><br/><div id="41980938" class="c"><input type="checkbox" id="c-41980938" checked=""/><div class="controls bullet"><span class="by">vbezhenar</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980909">next</a><span>|</span><label class="collapse" for="c-41980938">[-]</label><label class="expand" for="c-41980938">[2 more]</label></div><br/><div class="children"><div class="content">The main problem is using text as a common format between different applications.<p>First: text is not well defined. Is it ASCII? Is it UTF-8? Some programs can spew UTF-32 with proper locale configured, it&#x27;s a mess.<p>Second: encoding and decoding of objects to text is not defined at all. Those problems with filenames is just one example. Using newline as a separator is a natural thing that is easy to implement, yet it is wrong.<p>In my opinion two things should be done:<p>1. Standardise on UTF-8. No other encodings allowed.<p>2. Standardise on JSON. It is good enough to serve as universal exchange format, tools like `jq` exist for some time now.<p>So any utility must read and write JSON objects with some standard env set. And shells can be developed with better syntax to deal with JSON. This way you can write something like<p>`ps aux | while read row; do echo ${row.user} ${row.pid}; done`</div><br/><div id="41980974" class="c"><input type="checkbox" id="c-41980974" checked=""/><div class="controls bullet"><span class="by">anal_reactor</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980938">parent</a><span>|</span><a href="#41980909">next</a><span>|</span><label class="collapse" for="c-41980974">[-]</label><label class="expand" for="c-41980974">[1 more]</label></div><br/><div class="children"><div class="content">True, but this would be immensely difficult to pull off, because how do you convince other people to write programs that produce actual working JSON?</div><br/></div></div></div></div><div id="41980909" class="c"><input type="checkbox" id="c-41980909" checked=""/><div class="controls bullet"><span class="by">akira2501</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980938">prev</a><span>|</span><a href="#41980798">next</a><span>|</span><label class="collapse" for="c-41980909">[-]</label><label class="expand" for="c-41980909">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I haven&#x27;t seen any other tool ever have so many pitfalls.<p>I haven&#x27;t seen any other tool with so much general utility and availability.<p>&gt; to loop over a string array and print its contents<p>Is incredibly easy in bash and bash like shells.  As highlighted the issue is that tools like &#x27;ls&#x27; don&#x27;t create &quot;a string array.&quot;  They create one giant string that has to be parsed.  The rules in the shell are different than in other languages but it &#x2F;will&#x2F; do most of the parsing for you,  or all of it,  if you do it carefully.<p>This is a fine tradeoff.  As evidenced by it&#x27;s wide usage and lack of convincing replacements.</div><br/><div id="41980985" class="c"><input type="checkbox" id="c-41980985" checked=""/><div class="controls bullet"><span class="by">anal_reactor</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980909">parent</a><span>|</span><a href="#41980798">next</a><span>|</span><label class="collapse" for="c-41980985">[-]</label><label class="expand" for="c-41980985">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I haven&#x27;t seen any other tool with so much general utility and availability.<p>&gt; availability<p>That&#x27;s the real reason why we use Unix shell. It&#x27;s not good, but it&#x27;s available. Like a cheap hooker.<p>&gt; but it &#x2F;will&#x2F; do most of the parsing for you, or all of it, if you do it carefully.<p>&quot;It mostly works if you&#x27;re careful&quot; doesn&#x27;t sound very convincing to me.</div><br/></div></div></div></div><div id="41980798" class="c"><input type="checkbox" id="c-41980798" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980909">prev</a><span>|</span><a href="#41980893">next</a><span>|</span><label class="collapse" for="c-41980798">[-]</label><label class="expand" for="c-41980798">[5 more]</label></div><br/><div class="children"><div class="content">Someone needs to come up with a interactive shell first, one that is comparable in usability. Then we can think about replacing the unix shell.<p>I tried both python and lua interactively, but they are a pain when it comes to handling files. You have to type much more to get the same things done.</div><br/><div id="41980952" class="c"><input type="checkbox" id="c-41980952" checked=""/><div class="controls bullet"><span class="by">anal_reactor</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980798">parent</a><span>|</span><a href="#41980893">next</a><span>|</span><label class="collapse" for="c-41980952">[-]</label><label class="expand" for="c-41980952">[4 more]</label></div><br/><div class="children"><div class="content">The bigger issue is the sheer momentum of Unix shell. Even if you come up with an alternative that is better by every objectively measurable metric, it&#x27;s still going to be a monumental task to have it packages with commonly used distros. Kinda like the &quot;why can&#x27;t the US switch to the metric system&quot; problem.</div><br/><div id="41980987" class="c"><input type="checkbox" id="c-41980987" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980952">parent</a><span>|</span><a href="#41980893">next</a><span>|</span><label class="collapse" for="c-41980987">[-]</label><label class="expand" for="c-41980987">[3 more]</label></div><br/><div class="children"><div class="content">People already use different shells, mksh, fish, and so on. With fish there is a non-posix shell in wide use.</div><br/><div id="41980999" class="c"><input type="checkbox" id="c-41980999" checked=""/><div class="controls bullet"><span class="by">oguz-ismail</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980987">parent</a><span>|</span><a href="#41980893">next</a><span>|</span><label class="collapse" for="c-41980999">[-]</label><label class="expand" for="c-41980999">[2 more]</label></div><br/><div class="children"><div class="content">&gt;wide use<p>Five people around the globe isn&#x27;t wide use.</div><br/><div id="41981016" class="c"><input type="checkbox" id="c-41981016" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980999">parent</a><span>|</span><a href="#41980893">next</a><span>|</span><label class="collapse" for="c-41981016">[-]</label><label class="expand" for="c-41981016">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m sure you might get more than 5 people on HN replying to you that they are using fish right now. Say something discrediting about fish and they show up.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41980893" class="c"><input type="checkbox" id="c-41980893" checked=""/><div class="controls bullet"><span class="by">dailykoder</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980798">prev</a><span>|</span><a href="#41980818">next</a><span>|</span><label class="collapse" for="c-41980893">[-]</label><label class="expand" for="c-41980893">[1 more]</label></div><br/><div class="children"><div class="content">Works on my machine!</div><br/></div></div><div id="41980818" class="c"><input type="checkbox" id="c-41980818" checked=""/><div class="controls bullet"><span class="by">throwaway19972</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980893">prev</a><span>|</span><a href="#41980828">next</a><span>|</span><label class="collapse" for="c-41980818">[-]</label><label class="expand" for="c-41980818">[1 more]</label></div><br/><div class="children"><div class="content">&gt; the design of Unix shell is bonkers<p>Compared to what?</div><br/></div></div><div id="41980828" class="c"><input type="checkbox" id="c-41980828" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980425">parent</a><span>|</span><a href="#41980818">prev</a><span>|</span><a href="#41980129">next</a><span>|</span><label class="collapse" for="c-41980828">[-]</label><label class="expand" for="c-41980828">[2 more]</label></div><br/><div class="children"><div class="content">&gt; loop over a string array<p>Dear anal_reactor, what is a &quot;string array&quot;?  I have used unix shells since nearly 30 years and never heard about them.  And I consider myself a script-fu master!<p>There are two array-like constructions in the shell: list of words (separated by spaces) and list of lines (separated by newlines).  Both cases are implemented as a single string, and the shell makes it trivial to iterate through its components.</div><br/><div id="41980902" class="c"><input type="checkbox" id="c-41980902" checked=""/><div class="controls bullet"><span class="by">ManBeardPc</span><span>|</span><a href="#41980339">root</a><span>|</span><a href="#41980828">parent</a><span>|</span><a href="#41980129">next</a><span>|</span><label class="collapse" for="c-41980902">[-]</label><label class="expand" for="c-41980902">[1 more]</label></div><br/><div class="children"><div class="content">That is exactly the problem many people have with it. Encoding „arrays“ this way is foreign to everyone who comes from „normal“ programming languages. Both variants lead to problems because either character can occur in elements, worst case scenario they contain both at the same time. I can see why this leads to confusion and bugs.</div><br/></div></div></div></div></div></div></div></div><div id="41980129" class="c"><input type="checkbox" id="c-41980129" checked=""/><div class="controls bullet"><span class="by">imrejonk</span><span>|</span><a href="#41980339">prev</a><span>|</span><a href="#41980505">next</a><span>|</span><label class="collapse" for="c-41980129">[-]</label><label class="expand" for="c-41980129">[2 more]</label></div><br/><div class="children"><div class="content">This adds `set -o pipefail` to POSIX sh, which causes a whole pipeline to fail (non-zero exit code) if one or more of the commands in the pipeline fail.</div><br/></div></div><div id="41980505" class="c"><input type="checkbox" id="c-41980505" checked=""/><div class="controls bullet"><span class="by">relistan</span><span>|</span><a href="#41980129">prev</a><span>|</span><a href="#41980083">next</a><span>|</span><label class="collapse" for="c-41980505">[-]</label><label class="expand" for="c-41980505">[3 more]</label></div><br/><div class="children"><div class="content">The history at the beginning of this is not correct. Two examples: the assertion that there was one compatible UNIX prior to United States vs AT&amp;T,  the statement that GNU and BSD started that same year. Very, very off.</div><br/><div id="41980518" class="c"><input type="checkbox" id="c-41980518" checked=""/><div class="controls bullet"><span class="by">unixhero</span><span>|</span><a href="#41980505">parent</a><span>|</span><a href="#41980083">next</a><span>|</span><label class="collapse" for="c-41980518">[-]</label><label class="expand" for="c-41980518">[2 more]</label></div><br/><div class="children"><div class="content">Okay, but you would add more value if you could also state what is the correct order if things.</div><br/><div id="41980743" class="c"><input type="checkbox" id="c-41980743" checked=""/><div class="controls bullet"><span class="by">relistan</span><span>|</span><a href="#41980505">root</a><span>|</span><a href="#41980518">parent</a><span>|</span><a href="#41980083">next</a><span>|</span><label class="collapse" for="c-41980743">[-]</label><label class="expand" for="c-41980743">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;History_of_Unix#&#x2F;media&#x2F;File%3AUnix_history-simple.svg" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;History_of_Unix#&#x2F;media&#x2F;File%...</a> is a good visual of (many of, not all) the various versions of UNIX and when they were released. BSD was first released in 1978. United States v. AT&amp;T was implemented in 1984 (judgment 1982) GNU was first created in 1983.</div><br/></div></div></div></div></div></div><div id="41980083" class="c"><input type="checkbox" id="c-41980083" checked=""/><div class="controls bullet"><span class="by">Flimm</span><span>|</span><a href="#41980505">prev</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980083">[-]</label><label class="expand" for="c-41980083">[9 more]</label></div><br/><div class="children"><div class="content">Yes! Finally! Let&#x27;s treat filenames with new lines as errors! I&#x27;m so delighted with this decision.</div><br/><div id="41980336" class="c"><input type="checkbox" id="c-41980336" checked=""/><div class="controls bullet"><span class="by">skissane</span><span>|</span><a href="#41980083">parent</a><span>|</span><a href="#41980355">next</a><span>|</span><label class="collapse" for="c-41980336">[-]</label><label class="expand" for="c-41980336">[1 more]</label></div><br/><div class="children"><div class="content">The original request was to ban all bytes between 1 and 31.<p><a href="https:&#x2F;&#x2F;www.austingroupbugs.net&#x2F;view.php?id=251" rel="nofollow">https:&#x2F;&#x2F;www.austingroupbugs.net&#x2F;view.php?id=251</a><p>At some point they decided to narrow the change to just ban the newline character.<p>Which I personally think is a pity. Allowing escape in file names is a security risk because it enables you to embed ECMA-48 escape sequences in file names. Secure terminal emulators shouldn’t be made vulnerable by arbitrary escape sequences, but there are “too smart for their own good” terminal emulators out there that have escape sequences that let you do crazy things like run arbitrary executables.</div><br/></div></div><div id="41980355" class="c"><input type="checkbox" id="c-41980355" checked=""/><div class="controls bullet"><span class="by">IshKebab</span><span>|</span><a href="#41980083">parent</a><span>|</span><a href="#41980336">prev</a><span>|</span><a href="#41980156">next</a><span>|</span><label class="collapse" for="c-41980355">[-]</label><label class="expand" for="c-41980355">[2 more]</label></div><br/><div class="children"><div class="content">Why is that an issue?</div><br/><div id="41980432" class="c"><input type="checkbox" id="c-41980432" checked=""/><div class="controls bullet"><span class="by">shakna</span><span>|</span><a href="#41980083">root</a><span>|</span><a href="#41980355">parent</a><span>|</span><a href="#41980156">next</a><span>|</span><label class="collapse" for="c-41980432">[-]</label><label class="expand" for="c-41980432">[1 more]</label></div><br/><div class="children"><div class="content">Run a program to list a directory. Everything that interfaces with that, will assume newline delimiters. Similar assumptions are baked into a lot of software.<p>Enforcing that a newline isn&#x27;t part of a path, ensures the security of those systems that are commonly relied on.</div><br/></div></div></div></div><div id="41980156" class="c"><input type="checkbox" id="c-41980156" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#41980083">parent</a><span>|</span><a href="#41980355">prev</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980156">[-]</label><label class="expand" for="c-41980156">[5 more]</label></div><br/><div class="children"><div class="content">Next: spaces</div><br/><div id="41980204" class="c"><input type="checkbox" id="c-41980204" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#41980083">root</a><span>|</span><a href="#41980156">parent</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980204">[-]</label><label class="expand" for="c-41980204">[4 more]</label></div><br/><div class="children"><div class="content">Still much better than mojibaked names.</div><br/><div id="41980299" class="c"><input type="checkbox" id="c-41980299" checked=""/><div class="controls bullet"><span class="by">enriquto</span><span>|</span><a href="#41980083">root</a><span>|</span><a href="#41980204">parent</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980299">[-]</label><label class="expand" for="c-41980299">[3 more]</label></div><br/><div class="children"><div class="content">What do you mean?</div><br/><div id="41980498" class="c"><input type="checkbox" id="c-41980498" checked=""/><div class="controls bullet"><span class="by">_ZeD_</span><span>|</span><a href="#41980083">root</a><span>|</span><a href="#41980299">parent</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980498">[-]</label><label class="expand" for="c-41980498">[2 more]</label></div><br/><div class="children"><div class="content">What is the encoding of the filenames?</div><br/><div id="41980990" class="c"><input type="checkbox" id="c-41980990" checked=""/><div class="controls bullet"><span class="by">Joker_vD</span><span>|</span><a href="#41980083">root</a><span>|</span><a href="#41980498">parent</a><span>|</span><a href="#41980032">next</a><span>|</span><label class="collapse" for="c-41980990">[-]</label><label class="expand" for="c-41980990">[1 more]</label></div><br/><div class="children"><div class="content">I am personally not aware of any MBCS that could have a 0x20 or 0x0D as a valid trailing byte. Are you?</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41979927" class="c"><input type="checkbox" id="c-41979927" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#41980032">prev</a><span>|</span><a href="#41980229">next</a><span>|</span><label class="collapse" for="c-41979927">[-]</label><label class="expand" for="c-41979927">[2 more]</label></div><br/><div class="children"><div class="content">This is a surprisingly greedy POSIX update.</div><br/><div id="41980318" class="c"><input type="checkbox" id="c-41980318" checked=""/><div class="controls bullet"><span class="by">BoingBoomTschak</span><span>|</span><a href="#41979927">parent</a><span>|</span><a href="#41980229">next</a><span>|</span><label class="collapse" for="c-41980318">[-]</label><label class="expand" for="c-41980318">[1 more]</label></div><br/><div class="children"><div class="content">As someone who truly limits himself to POSIX when he can, I think they needed to push it forward to not become completely obsolete. I&#x27;m really sad `mktemp -d` and `set -o nullglob` didn&#x27;t make the cut, but that&#x27;s how it is, I guess.</div><br/></div></div></div></div><div id="41980035" class="c"><input type="checkbox" id="c-41980035" checked=""/><div class="controls bullet"><span class="by">somat</span><span>|</span><a href="#41980229">prev</a><span>|</span><label class="collapse" for="c-41980035">[-]</label><label class="expand" for="c-41980035">[2 more]</label></div><br/><div class="children"><div class="content">Hopefully nothing, posix is, or at least it should be, a descriptive standard. This is why posix is so terrible, and why posix is so great.<p>The way I feel posix, and other descriptive standards work best is when they describe what every one is already doing. This is opposed to prescriptive standards which try focus on how the &quot;correct&quot; way to do somthing, prescriptive standards tend to be over engineered and may or may not actually work.<p>see also: descriptive and prescriptive dictionaries. <a href="http:&#x2F;&#x2F;www.englishplus.com&#x2F;news&#x2F;news1100.htm" rel="nofollow">http:&#x2F;&#x2F;www.englishplus.com&#x2F;news&#x2F;news1100.htm</a></div><br/><div id="41980500" class="c"><input type="checkbox" id="c-41980500" checked=""/><div class="controls bullet"><span class="by">Flimm</span><span>|</span><a href="#41980035">parent</a><span>|</span><label class="collapse" for="c-41980500">[-]</label><label class="expand" for="c-41980500">[1 more]</label></div><br/><div class="children"><div class="content">Both prescriptive standards and descriptive standards have their uses. If POSIX is a prescriptive standard, then maybe another standard should exist that is descriptive.</div><br/></div></div></div></div></div></div></div></div></div></body></html>