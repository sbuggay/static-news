<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728291677326" as="style"/><link rel="stylesheet" href="styles.css?v=1728291677326"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://backreference.org/2010/02/10/idiomatic-awk/">Idiomatic Awk (2010)</a> <span class="domain">(<a href="https://backreference.org">backreference.org</a>)</span></div><div class="subtext"><span>StefanBatory</span> | <span>26 comments</span></div><br/><div><div id="41756401" class="c"><input type="checkbox" id="c-41756401" checked=""/><div class="controls bullet"><span class="by">Elfener</span><span>|</span><a href="#41756829">next</a><span>|</span><label class="collapse" for="c-41756401">[-]</label><label class="expand" for="c-41756401">[1 more]</label></div><br/><div class="children"><div class="content">Technically an empty awk program is an implementation of cat(1) (before it came back from berkeley waving flags, anyway).<p>Of course no awk will run an empty program, so the article&#x27;s &#x27;1&#x27; or &#x27;&quot;a&quot;&#x27; or other truthy value is required.</div><br/></div></div><div id="41756829" class="c"><input type="checkbox" id="c-41756829" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41756401">prev</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41756829">[-]</label><label class="expand" for="c-41756829">[11 more]</label></div><br/><div class="children"><div class="content">Funny how exploiting uninitialized variables is evil in (nonstrict) JavaScript but good in Awk. I agree that’s true, mind you, I just can’t pinpoint what about the languages’ designs makes it work in one case but not the other.</div><br/><div id="41762420" class="c"><input type="checkbox" id="c-41762420" checked=""/><div class="controls bullet"><span class="by">AdieuToLogic</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41763749">next</a><span>|</span><label class="collapse" for="c-41762420">[-]</label><label class="expand" for="c-41762420">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Funny how exploiting uninitialized variables is evil in (nonstrict) JavaScript but good in Awk. I agree that’s true, mind you, I just can’t pinpoint what about the languages’ designs makes it work in one case but not the other.<p>I believe Awk&#x27;s semantic behaviour is a kindred spirit of Perl&#x27;s autovivication[0].<p>It is often handy and sometimes can bite one in the proverbial backside.<p>0 - <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Autovivification" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Autovivification</a></div><br/></div></div><div id="41763749" class="c"><input type="checkbox" id="c-41763749" checked=""/><div class="controls bullet"><span class="by">rakoo</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41762420">prev</a><span>|</span><a href="#41762646">next</a><span>|</span><label class="collapse" for="c-41763749">[-]</label><label class="expand" for="c-41763749">[1 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;s ok in awk because awk is seen as a scripting language, where brevity matters and there aren&#x27;t many variables anyway</div><br/></div></div><div id="41762646" class="c"><input type="checkbox" id="c-41762646" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41763749">prev</a><span>|</span><a href="#41757171">next</a><span>|</span><label class="collapse" for="c-41762646">[-]</label><label class="expand" for="c-41762646">[1 more]</label></div><br/><div class="children"><div class="content">A lot of things are good in language designed for one-liners, but will be considered evil in languages which are used for longer programs.<p>For an opposite example, consider: a 1000 statement JS program is perfectly fine. A 1000 statement AWK script is very evil, most people would be saying it should be replaced with real language ASAP.</div><br/></div></div><div id="41757171" class="c"><input type="checkbox" id="c-41757171" checked=""/><div class="controls bullet"><span class="by">asicsp</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41762646">prev</a><span>|</span><a href="#41757068">next</a><span>|</span><label class="collapse" for="c-41757171">[-]</label><label class="expand" for="c-41757171">[1 more]</label></div><br/><div class="children"><div class="content">Not sure if it was intended, but it helps to keep CLI one-liners concise. For example:<p><pre><code>    awk &#x27;!a[$0]++&#x27;

    awk &#x27;&#x2F;search&#x2F;{n=2} n &amp;&amp; n--&#x27;</code></pre></div><br/></div></div><div id="41757068" class="c"><input type="checkbox" id="c-41757068" checked=""/><div class="controls bullet"><span class="by">hi41</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41757171">prev</a><span>|</span><a href="#41756913">next</a><span>|</span><label class="collapse" for="c-41757068">[-]</label><label class="expand" for="c-41757068">[1 more]</label></div><br/><div class="children"><div class="content">Doesn’t awk set null for all uninitialized  variables. Does that solve the problem for you? We can use that feature to find lines with same values which form a group.</div><br/></div></div><div id="41756913" class="c"><input type="checkbox" id="c-41756913" checked=""/><div class="controls bullet"><span class="by">rusk</span><span>|</span><a href="#41756829">parent</a><span>|</span><a href="#41757068">prev</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41756913">[-]</label><label class="expand" for="c-41756913">[5 more]</label></div><br/><div class="children"><div class="content">Guaranteed  initialisation rules I would imagine. A lot of languages don’t do this, or assign null or something. For a language with a narrow scope of application you can this but in more general purpose languages it makes less sense.</div><br/><div id="41756958" class="c"><input type="checkbox" id="c-41756958" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41756829">root</a><span>|</span><a href="#41756913">parent</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41756958">[-]</label><label class="expand" for="c-41756958">[4 more]</label></div><br/><div class="children"><div class="content">Note Awk does have a special value for uninitialized variables—its distinguishing feature is that it compares equal to both zero and empty string simultaneously. (No official way to spell that value, but you can spell it e.g. “undefined” if you never initialize a variable called “undefined”.) It’s really really close to old JS in that respect, and no wonder, given that Awk was an explicit inspiration for JS. But somehow it works for Awk and not for JS, even at the hundred-line scale that’s common and reasonable for both languages.</div><br/><div id="41758854" class="c"><input type="checkbox" id="c-41758854" checked=""/><div class="controls bullet"><span class="by">rusk</span><span>|</span><a href="#41756829">root</a><span>|</span><a href="#41756958">parent</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41758854">[-]</label><label class="expand" for="c-41758854">[3 more]</label></div><br/><div class="children"><div class="content">I never considered that awk was a precursor to JavaScript but I can certainly see that</div><br/><div id="41759191" class="c"><input type="checkbox" id="c-41759191" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41756829">root</a><span>|</span><a href="#41758854">parent</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41759191">[-]</label><label class="expand" for="c-41759191">[2 more]</label></div><br/><div class="children"><div class="content">Found it! Wirfs-Brock &amp; Eich, “JavaScript: the first 20 years” (HOPL ’20) [1], §3.1:<p>&gt; The syntax of JavaScript 1.0 was directly modeled after the statement syntax of the C programming language with some AWK inspired embellishments.<p>(the rest of the section is also interesting in that respect).<p>[1] <a href="https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3386327" rel="nofollow">https:&#x2F;&#x2F;dl.acm.org&#x2F;doi&#x2F;10.1145&#x2F;3386327</a> (CC-BY open access)</div><br/><div id="41760315" class="c"><input type="checkbox" id="c-41760315" checked=""/><div class="controls bullet"><span class="by">rusk</span><span>|</span><a href="#41756829">root</a><span>|</span><a href="#41759191">parent</a><span>|</span><a href="#41756879">next</a><span>|</span><label class="collapse" for="c-41760315">[-]</label><label class="expand" for="c-41760315">[1 more]</label></div><br/><div class="children"><div class="content">I could feel it all along!</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41756879" class="c"><input type="checkbox" id="c-41756879" checked=""/><div class="controls bullet"><span class="by">rusk</span><span>|</span><a href="#41756829">prev</a><span>|</span><a href="#41756778">next</a><span>|</span><label class="collapse" for="c-41756879">[-]</label><label class="expand" for="c-41756879">[2 more]</label></div><br/><div class="children"><div class="content">I love awk as a language &#x2F; framework. If it got an uplift to make it useful for more complex problems it would be an absolute winner for lots of basic data processing tasks.<p>I’ve often written incantations many lines long and even broken out to actually writing awk scripts from time to time.<p>Once the penny drops with it it’s great fun but it’s absolutely useless once your problems get to any degree of sophistication.<p>I typically move into Python at this stage. Perl and Ruby are probably a more elegant fit here but those aren’t rows I want to have.<p>In this day and age, awk really needs CSV (RFC-4180) support and better semantic scoping and library support.<p>I’d also think it would be neat as an embedded language for various data processing platforms but if we haven’t seen it yet I doubt we will ever see it.<p>EDIT support for file formats beyond plain text would also be a winner.</div><br/><div id="41757169" class="c"><input type="checkbox" id="c-41757169" checked=""/><div class="controls bullet"><span class="by">Rotundo</span><span>|</span><a href="#41756879">parent</a><span>|</span><a href="#41756778">next</a><span>|</span><label class="collapse" for="c-41757169">[-]</label><label class="expand" for="c-41757169">[1 more]</label></div><br/><div class="children"><div class="content">Good news! Not only are there AWK implementations (for instance GoAWK) that can use CSV, but even the one true AWK does do CSV and Unicode nowadays!<p><a href="https:&#x2F;&#x2F;arstechnica.com&#x2F;gadgets&#x2F;2022&#x2F;08&#x2F;unix-legend-who-owes-us-nothing-keeps-fixing-foundational-awk-code&#x2F;" rel="nofollow">https:&#x2F;&#x2F;arstechnica.com&#x2F;gadgets&#x2F;2022&#x2F;08&#x2F;unix-legend-who-owes...</a></div><br/></div></div></div></div><div id="41756778" class="c"><input type="checkbox" id="c-41756778" checked=""/><div class="controls bullet"><span class="by">elteto</span><span>|</span><a href="#41756879">prev</a><span>|</span><a href="#41756354">next</a><span>|</span><label class="collapse" for="c-41756778">[-]</label><label class="expand" for="c-41756778">[2 more]</label></div><br/><div class="children"><div class="content">I wanted to like awk and tried really hard but in the end was disappointed by what I see as unnecessary complications or limitations in the language. For example, it has first class support for regexes but only for matching. You can’t do ‘s&#x2F;foo&#x2F;bar’. I also found string manipulation to be cumbersome with the string functions. I would have expected a string processing language to have better primitives for this. And function arguments&#x2F;variables are just a mess, it’s hard to understand how they came up with that design. It’s also quirky and unintuitive in some places you would not expect. Take the non-working example from the article:<p><pre><code>    awk -v FS=&#x27;;&#x27; -v OFS=&#x27;,&#x27; 1
</code></pre>
I expect this to change the change the separator in the output. Period. The “efficiency” argument for why it doesn’t work just doesn’t cut it for me. First, it’s very simple to do a one time comparison of FS and OFS, if they are different then you know you know you _have_ to perform the change, because the user is asking you! If I do this in reality and it doesn’t work I just switch over to sed or perl and call it a day.<p>All in all, perl -eP is a better awk. And for data processing I switched to miller. It has it’s idiosyncrasies as well but it’s much better for working with structured records.</div><br/><div id="41757054" class="c"><input type="checkbox" id="c-41757054" checked=""/><div class="controls bullet"><span class="by">shakna</span><span>|</span><a href="#41756778">parent</a><span>|</span><a href="#41756354">next</a><span>|</span><label class="collapse" for="c-41757054">[-]</label><label class="expand" for="c-41757054">[1 more]</label></div><br/><div class="children"><div class="content">Awk does support that kind of pattern matching for replacement...?<p><pre><code>    { gsub(&#x2F;\;&#x2F;, &quot;,&quot;); print }</code></pre></div><br/></div></div></div></div><div id="41756354" class="c"><input type="checkbox" id="c-41756354" checked=""/><div class="controls bullet"><span class="by">asicsp</span><span>|</span><a href="#41756778">prev</a><span>|</span><a href="#41761847">next</a><span>|</span><label class="collapse" for="c-41756354">[-]</label><label class="expand" for="c-41756354">[7 more]</label></div><br/><div class="children"><div class="content">Seems like the link should be <a href="https:&#x2F;&#x2F;backreference.org&#x2F;2010&#x2F;02&#x2F;10&#x2F;idiomatic-awk&#x2F;" rel="nofollow">https:&#x2F;&#x2F;backreference.org&#x2F;2010&#x2F;02&#x2F;10&#x2F;idiomatic-awk&#x2F;</a> instead of <a href="https:&#x2F;&#x2F;backreference.org&#x2F;index.html" rel="nofollow">https:&#x2F;&#x2F;backreference.org&#x2F;index.html</a></div><br/><div id="41762263" class="c"><input type="checkbox" id="c-41762263" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#41756354">parent</a><span>|</span><a href="#41756814">next</a><span>|</span><label class="collapse" for="c-41762263">[-]</label><label class="expand" for="c-41762263">[1 more]</label></div><br/><div class="children"><div class="content">Fixed now. Thanks!</div><br/></div></div><div id="41756814" class="c"><input type="checkbox" id="c-41756814" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#41756354">parent</a><span>|</span><a href="#41762263">prev</a><span>|</span><a href="#41756368">next</a><span>|</span><label class="collapse" for="c-41756814">[-]</label><label class="expand" for="c-41756814">[2 more]</label></div><br/><div class="children"><div class="content">Also, (2010).</div><br/><div id="41758973" class="c"><input type="checkbox" id="c-41758973" checked=""/><div class="controls bullet"><span class="by">Lammy</span><span>|</span><a href="#41756354">root</a><span>|</span><a href="#41756814">parent</a><span>|</span><a href="#41756368">next</a><span>|</span><label class="collapse" for="c-41758973">[-]</label><label class="expand" for="c-41758973">[1 more]</label></div><br/><div class="children"><div class="content">Wait until you find out how old AWK is</div><br/></div></div></div></div><div id="41756368" class="c"><input type="checkbox" id="c-41756368" checked=""/><div class="controls bullet"><span class="by">StefanBatory</span><span>|</span><a href="#41756354">parent</a><span>|</span><a href="#41756814">prev</a><span>|</span><a href="#41761847">next</a><span>|</span><label class="collapse" for="c-41756368">[-]</label><label class="expand" for="c-41756368">[3 more]</label></div><br/><div class="children"><div class="content">Yes - but I am <i>sure</i> I sent the first link.<p>I&#x27;m not sure what has happened then.</div><br/><div id="41758622" class="c"><input type="checkbox" id="c-41758622" checked=""/><div class="controls bullet"><span class="by">kencausey</span><span>|</span><a href="#41756354">root</a><span>|</span><a href="#41756368">parent</a><span>|</span><a href="#41761847">next</a><span>|</span><label class="collapse" for="c-41758622">[-]</label><label class="expand" for="c-41758622">[2 more]</label></div><br/><div class="children"><div class="content">I think that it is this in the head:<p><pre><code>  &lt;link rel=&quot;canonical&quot; href=&quot;index.html&quot;&gt;
</code></pre>
I had to stop submitting ISC SANS posts because they similarly have a canonical link in their head which HN, for reasons I&#x27;m not sure about, use to &#x27;correct&#x27; the URL, errantly.</div><br/><div id="41762262" class="c"><input type="checkbox" id="c-41762262" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#41756354">root</a><span>|</span><a href="#41758622">parent</a><span>|</span><a href="#41761847">next</a><span>|</span><label class="collapse" for="c-41762262">[-]</label><label class="expand" for="c-41762262">[1 more]</label></div><br/><div class="children"><div class="content">Right you are!<p>I can turn that off for specific domains - if you email the relevant info to hn@ycombinator.com I&#x27;ll take a look.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>