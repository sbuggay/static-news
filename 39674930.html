<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1710234066489" as="style"/><link rel="stylesheet" href="styles.css?v=1710234066489"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.frankel.ch/raspberry-pi-github-action/">Using my new Raspberry Pi to run an existing GitHub Action</a> <span class="domain">(<a href="https://blog.frankel.ch">blog.frankel.ch</a>)</span></div><div class="subtext"><span>nfrankel</span> | <span>11 comments</span></div><br/><div><div id="39676918" class="c"><input type="checkbox" id="c-39676918" checked=""/><div class="controls bullet"><span class="by">justinclift</span><span>|</span><a href="#39675325">next</a><span>|</span><label class="collapse" for="c-39676918">[-]</label><label class="expand" for="c-39676918">[1 more]</label></div><br/><div class="children"><div class="content">Self-hosted runners are also useful when debugging weird behaviour in a GitHub Action.<p>I do it by spinning up a VM on my local pc, then running the GitHub Actions software in the VM.<p>This gives a fully working GitHub Actions runner which I can ssh into directly and muck around with to investigate and get things working.<p>It&#x27;s also easy to ensure only the right jobs end up on my runner.<p>The installer for the GitHub Actions runner asks for optional tag names to use, so I add &quot;jc&quot; (my initials) to the tags.<p>Then I add a matching &quot;jc&quot; to the &quot;runs-on&quot; clause in the workflow in my fork or PR:<p><pre><code>    runs-on: [self-hosted, linux, x64, jc]
</code></pre>
With that, the GitHub Actions for that workflow only run on my local VM.<p>Works pretty well. :)<p>---<p>Official docs for the labelling bit: <a href="https:&#x2F;&#x2F;docs.github.com&#x2F;en&#x2F;actions&#x2F;hosting-your-own-runners&#x2F;managing-self-hosted-runners&#x2F;using-self-hosted-runners-in-a-workflow#using-custom-labels-to-route-jobs" rel="nofollow">https:&#x2F;&#x2F;docs.github.com&#x2F;en&#x2F;actions&#x2F;hosting-your-own-runners&#x2F;...</a></div><br/></div></div><div id="39675325" class="c"><input type="checkbox" id="c-39675325" checked=""/><div class="controls bullet"><span class="by">mmastrac</span><span>|</span><a href="#39676918">prev</a><span>|</span><a href="#39676617">next</a><span>|</span><label class="collapse" for="c-39675325">[-]</label><label class="expand" for="c-39675325">[1 more]</label></div><br/><div class="children"><div class="content">I have a setup on a Pi for deploying progscrape.com that has a systemd task to boot a new runner in a container. I really need to turn it into a bare-metal deployment script so I can recover from an SD card crash.<p>Basically this service:<p><pre><code>  [Unit]
  Description=%N Container
  After=docker.service
  Requires=docker.service
  [Service]
  TimeoutSec=3600
  Restart=always
  WorkingDirectory=&#x2F;srv&#x2F;progscrape&#x2F;progscrape-deploy&#x2F;github-runners
  ExecStartPre=-&#x2F;usr&#x2F;bin&#x2F;docker compose -f %N.yml -p %N stop
  ExecStartPre=-&#x2F;usr&#x2F;bin&#x2F;docker compose -f %N.yml -p %N pull
  ExecStart=&#x2F;usr&#x2F;bin&#x2F;docker compose -f %N.yml -p %N up
  ExecStopPost=-&#x2F;usr&#x2F;bin&#x2F;docker compose -f %N.yml -p %N rm -f
  [Install]
  WantedBy=multi-user.target
</code></pre>
Boots this docker compose definition:<p><pre><code>  services:
    github-docker-runner:
      image: myoung34&#x2F;github-runner:latest
      restart: &quot;no&quot;
      environment:
        RUNNER_NAME: progscrape-docker-compose
        RUNNER_WORKDIR: &#x2F;tmp&#x2F;work
        EPHEMERAL: 1
        LABELS: management,linux,ARM64
        DISABLE_AUTO_UPDATE: 1
      env_file:
        - github-runner.env
      configs:
        - github-runner-start
      entrypoint: &#x2F;bin&#x2F;sh
      command: &#x2F;github-runner-start
      security_opt:
        # needed on SELinux systems to allow docker container to manage other docker containers
        - label:disable
      volumes:
        - &#x27;&#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock&#x27;

  configs:
    github-runner-start:
      file: runner-start.sh</code></pre></div><br/></div></div><div id="39676617" class="c"><input type="checkbox" id="c-39676617" checked=""/><div class="controls bullet"><span class="by">donatj</span><span>|</span><a href="#39675325">prev</a><span>|</span><a href="#39675450">next</a><span>|</span><label class="collapse" for="c-39676617">[-]</label><label class="expand" for="c-39676617">[2 more]</label></div><br/><div class="children"><div class="content">I am kind of surprised that the Action runner isn’t just some sort of Container or VM manager like Drone?<p>The runs actually occur on your real OS? That seems strange and dangerous.</div><br/><div id="39676956" class="c"><input type="checkbox" id="c-39676956" checked=""/><div class="controls bullet"><span class="by">krab</span><span>|</span><a href="#39676617">parent</a><span>|</span><a href="#39675450">next</a><span>|</span><label class="collapse" for="c-39676956">[-]</label><label class="expand" for="c-39676956">[1 more]</label></div><br/><div class="children"><div class="content">It lets you manage containers in your actions. Nesting containers is not straightforward in many cases.</div><br/></div></div></div></div><div id="39675450" class="c"><input type="checkbox" id="c-39675450" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#39676617">prev</a><span>|</span><a href="#39676744">next</a><span>|</span><label class="collapse" for="c-39675450">[-]</label><label class="expand" for="c-39675450">[5 more]</label></div><br/><div class="children"><div class="content">How do you guys run Github Actions locally?</div><br/><div id="39677272" class="c"><input type="checkbox" id="c-39677272" checked=""/><div class="controls bullet"><span class="by">djthorpe</span><span>|</span><a href="#39675450">parent</a><span>|</span><a href="#39675785">next</a><span>|</span><label class="collapse" for="c-39677272">[-]</label><label class="expand" for="c-39677272">[1 more]</label></div><br/><div class="children"><div class="content">This is my attempt at running Github Actions locally on arm and arm64:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;mutablelogic&#x2F;docker-action-runner">https:&#x2F;&#x2F;github.com&#x2F;mutablelogic&#x2F;docker-action-runner</a><p>Running the actions in a docker container is not ideal by any means. The authors of Github Actions do not have a stable API between the actions runner and whatever triggers them on their server side; you need to keep the docker container up-to-date every few months, it&#x27;s not a &quot;fire and forget&quot; thing.</div><br/></div></div><div id="39675785" class="c"><input type="checkbox" id="c-39675785" checked=""/><div class="controls bullet"><span class="by">weikju</span><span>|</span><a href="#39675450">parent</a><span>|</span><a href="#39677272">prev</a><span>|</span><a href="#39675590">next</a><span>|</span><label class="collapse" for="c-39675785">[-]</label><label class="expand" for="c-39675785">[1 more]</label></div><br/><div class="children"><div class="content">GitHub provides an agent that you can run. It polls GitHub for tasks and runs them locally. They also provide docker images and even a Kubernetes controller for auto scaling runners. Some people do it with lambda functions or plain ec2 launched on the fly.<p>If you meant to ask how to run the GitHub actions code without GitHub then the sibling comment would help for most tasks but has limitations.</div><br/></div></div><div id="39675590" class="c"><input type="checkbox" id="c-39675590" checked=""/><div class="controls bullet"><span class="by">pjot</span><span>|</span><a href="#39675450">parent</a><span>|</span><a href="#39675785">prev</a><span>|</span><a href="#39676744">next</a><span>|</span><label class="collapse" for="c-39675590">[-]</label><label class="expand" for="c-39675590">[2 more]</label></div><br/><div class="children"><div class="content">Not sure if this is what they are using, but this is a way.<p><pre><code>  https:&#x2F;&#x2F;github.com&#x2F;nektos&#x2F;act</code></pre></div><br/><div id="39675960" class="c"><input type="checkbox" id="c-39675960" checked=""/><div class="controls bullet"><span class="by">ivanjermakov</span><span>|</span><a href="#39675450">root</a><span>|</span><a href="#39675590">parent</a><span>|</span><a href="#39676744">next</a><span>|</span><label class="collapse" for="c-39675960">[-]</label><label class="expand" for="c-39675960">[1 more]</label></div><br/><div class="children"><div class="content">Link: <a href="https:&#x2F;&#x2F;github.com&#x2F;nektos&#x2F;act">https:&#x2F;&#x2F;github.com&#x2F;nektos&#x2F;act</a></div><br/></div></div></div></div></div></div><div id="39676744" class="c"><input type="checkbox" id="c-39676744" checked=""/><div class="controls bullet"><span class="by">lostmsu</span><span>|</span><a href="#39675450">prev</a><span>|</span><label class="collapse" for="c-39676744">[-]</label><label class="expand" for="c-39676744">[1 more]</label></div><br/><div class="children"><div class="content">BTW if you came here to get your GitHub actions run on ARM64, you don&#x27;t need RPi for that. You can get a free VM from Oracle.</div><br/></div></div></div></div></div></div></div></body></html>