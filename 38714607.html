<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1703149258625" as="style"/><link rel="stylesheet" href="styles.css?v=1703149258625"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.panoptica.app/research/7-ways-to-escape-a-container">How to Escape a Container</a> <span class="domain">(<a href="https://www.panoptica.app">www.panoptica.app</a>)</span></div><div class="subtext"><span>chuckhend</span> | <span>95 comments</span></div><br/><div><div id="38717835" class="c"><input type="checkbox" id="c-38717835" checked=""/><div class="controls bullet"><span class="by">tpetry</span><span>|</span><a href="#38717910">next</a><span>|</span><label class="collapse" for="c-38717835">[-]</label><label class="expand" for="c-38717835">[2 more]</label></div><br/><div class="children"><div class="content">Any of the capabilities needed by the exploits is in linux only available to root users. And are now granted to a container.<p>So these ”escapes“ are basically giving a container full access to the host and using that. None of them are enabled by default.</div><br/><div id="38718315" class="c"><input type="checkbox" id="c-38718315" checked=""/><div class="controls bullet"><span class="by">t8sr</span><span>|</span><a href="#38717835">parent</a><span>|</span><a href="#38717910">next</a><span>|</span><label class="collapse" for="c-38718315">[-]</label><label class="expand" for="c-38718315">[1 more]</label></div><br/><div class="children"><div class="content">In practice, though, containers are given these capabilities all the time, and in infosec people do refer to these as escapes.<p>Generally, it’s not the stuff the container is intended to run that’s doing the escape, though. This is usually the second step, after getting local execution through a vulnerability in the application running in the container.</div><br/></div></div></div></div><div id="38717910" class="c"><input type="checkbox" id="c-38717910" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#38717835">prev</a><span>|</span><a href="#38714797">next</a><span>|</span><label class="collapse" for="c-38717910">[-]</label><label class="expand" for="c-38717910">[2 more]</label></div><br/><div class="children"><div class="content">This post seems confused and misleading. It only lists ways to escape containers with various non-default capabilities added, but doesn&#x27;t address the other more realistic and seen in the wild ways (eg from uid=0 confusion due to disuse of user namespaces, kernel privilege escalation bugs, etc).</div><br/><div id="38718341" class="c"><input type="checkbox" id="c-38718341" checked=""/><div class="controls bullet"><span class="by">t8sr</span><span>|</span><a href="#38717910">parent</a><span>|</span><a href="#38714797">next</a><span>|</span><label class="collapse" for="c-38718341">[-]</label><label class="expand" for="c-38718341">[1 more]</label></div><br/><div class="children"><div class="content">I don’t think it’s misleading - working in security, I can tell you that containers are misconfigured with too many privileges everywhere you look. SWEs like focusing on cool stuff, like kernel exploits, to the detriment of basic production security. From the point of view, this is an article I think many SWEs could benefit from reading, especially on teams that do their own deployments.</div><br/></div></div></div></div><div id="38714797" class="c"><input type="checkbox" id="c-38714797" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38717910">prev</a><span>|</span><a href="#38717545">next</a><span>|</span><label class="collapse" for="c-38714797">[-]</label><label class="expand" for="c-38714797">[3 more]</label></div><br/><div class="children"><div class="content">I find it relatively comforting that every single one of these requires disabling security features, though it is a good reminder of why certain things are dangerous to give containers and should be avoided.</div><br/><div id="38716365" class="c"><input type="checkbox" id="c-38716365" checked=""/><div class="controls bullet"><span class="by">Retric</span><span>|</span><a href="#38714797">parent</a><span>|</span><a href="#38716926">next</a><span>|</span><label class="collapse" for="c-38716365">[-]</label><label class="expand" for="c-38716365">[1 more]</label></div><br/><div class="children"><div class="content">It doesn’t mention zero day exploits, but those still occur.</div><br/></div></div><div id="38716926" class="c"><input type="checkbox" id="c-38716926" checked=""/><div class="controls bullet"><span class="by">luma</span><span>|</span><a href="#38714797">parent</a><span>|</span><a href="#38716365">prev</a><span>|</span><a href="#38717545">next</a><span>|</span><label class="collapse" for="c-38716926">[-]</label><label class="expand" for="c-38716926">[1 more]</label></div><br/><div class="children"><div class="content">Step 1: already be root.</div><br/></div></div></div></div><div id="38717545" class="c"><input type="checkbox" id="c-38717545" checked=""/><div class="controls bullet"><span class="by">rompledorph</span><span>|</span><a href="#38714797">prev</a><span>|</span><a href="#38714765">next</a><span>|</span><label class="collapse" for="c-38717545">[-]</label><label class="expand" for="c-38717545">[5 more]</label></div><br/><div class="children"><div class="content">Whats the state of lightweight VMs? Can they replace containers yet?<p>Not sharing the kernel with the host os (or other containers) is a huge security boundary.</div><br/><div id="38717770" class="c"><input type="checkbox" id="c-38717770" checked=""/><div class="controls bullet"><span class="by">munawwar</span><span>|</span><a href="#38717545">parent</a><span>|</span><a href="#38717781">next</a><span>|</span><label class="collapse" for="c-38717770">[-]</label><label class="expand" for="c-38717770">[1 more]</label></div><br/><div class="children"><div class="content">AWS lambda and fly.io uses firecracker VMs internally. So I think it can replace containers to some extent.</div><br/></div></div><div id="38717781" class="c"><input type="checkbox" id="c-38717781" checked=""/><div class="controls bullet"><span class="by">bbarnett</span><span>|</span><a href="#38717545">parent</a><span>|</span><a href="#38717770">prev</a><span>|</span><a href="#38714765">next</a><span>|</span><label class="collapse" for="c-38717781">[-]</label><label class="expand" for="c-38717781">[3 more]</label></div><br/><div class="children"><div class="content">To me, a guy that&#x27;s been doing this for decades, this is a weird thing to say.<p>A bit of debootstrap, a few apt-get commands, and copying in config files, and you have a lightweight VM, minimal image.<p>Something people have been doing for 20 years.<p>There are also sorts of tricks, such as having two images, one for the app layer, one for the OS, which makes the deploy for app updates faster.<p>I&#x27;m not even sure why people care about image size all that much.  You copy it to your local cluster, then deploy from there.</div><br/><div id="38718353" class="c"><input type="checkbox" id="c-38718353" checked=""/><div class="controls bullet"><span class="by">lifty</span><span>|</span><a href="#38717545">root</a><span>|</span><a href="#38717781">parent</a><span>|</span><a href="#38718194">next</a><span>|</span><label class="collapse" for="c-38718353">[-]</label><label class="expand" for="c-38718353">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s managing them at a bigger scale that is the challenge. Besides that, the container ecosystem gives you APIs to do all this management with established tools, in an automatic way.</div><br/></div></div><div id="38718194" class="c"><input type="checkbox" id="c-38718194" checked=""/><div class="controls bullet"><span class="by">nicoburns</span><span>|</span><a href="#38717545">root</a><span>|</span><a href="#38717781">parent</a><span>|</span><a href="#38718353">prev</a><span>|</span><a href="#38714765">next</a><span>|</span><label class="collapse" for="c-38718194">[-]</label><label class="expand" for="c-38718194">[1 more]</label></div><br/><div class="children"><div class="content">Do those lightweight VMs startup (cold start) in milliseconds? Because I think that&#x27;s a key thing that people are looking for from containers and VMs that might be used in their stead.</div><br/></div></div></div></div></div></div><div id="38714765" class="c"><input type="checkbox" id="c-38714765" checked=""/><div class="controls bullet"><span class="by">arkadiyt</span><span>|</span><a href="#38717545">prev</a><span>|</span><a href="#38716967">next</a><span>|</span><label class="collapse" for="c-38714765">[-]</label><label class="expand" for="c-38714765">[2 more]</label></div><br/><div class="children"><div class="content">Not mentioned: use a kernel N-day, of which there are many. Patch your hosts folks</div><br/><div id="38717993" class="c"><input type="checkbox" id="c-38717993" checked=""/><div class="controls bullet"><span class="by">insanitybit</span><span>|</span><a href="#38714765">parent</a><span>|</span><a href="#38716967">next</a><span>|</span><label class="collapse" for="c-38717993">[-]</label><label class="expand" for="c-38717993">[1 more]</label></div><br/><div class="children"><div class="content">For many, many services, requiring an entire separate exploit against the kernel is a huge win. So many services can just be dropped into a container with roughly 0 effort. If you want a higher level of security it&#x27;s going to take significantly more effort.</div><br/></div></div></div></div><div id="38716967" class="c"><input type="checkbox" id="c-38716967" checked=""/><div class="controls bullet"><span class="by">adriangrigore</span><span>|</span><a href="#38714765">prev</a><span>|</span><a href="#38715075">next</a><span>|</span><label class="collapse" for="c-38716967">[-]</label><label class="expand" for="c-38716967">[3 more]</label></div><br/><div class="children"><div class="content">Why escape?</div><br/><div id="38717363" class="c"><input type="checkbox" id="c-38717363" checked=""/><div class="controls bullet"><span class="by">c0pium</span><span>|</span><a href="#38716967">parent</a><span>|</span><a href="#38716996">next</a><span>|</span><label class="collapse" for="c-38717363">[-]</label><label class="expand" for="c-38717363">[1 more]</label></div><br/><div class="children"><div class="content">You are being downvoted right now, but this is a great point. If you have execution control in someone’s container, use the containers existing secrets to achieve your goals. I don’t need to escape your web apps container to steal all of the contents of the backend database.</div><br/></div></div><div id="38716996" class="c"><input type="checkbox" id="c-38716996" checked=""/><div class="controls bullet"><span class="by">heyoni</span><span>|</span><a href="#38716967">parent</a><span>|</span><a href="#38717363">prev</a><span>|</span><a href="#38715075">next</a><span>|</span><label class="collapse" for="c-38716996">[-]</label><label class="expand" for="c-38716996">[1 more]</label></div><br/><div class="children"><div class="content">All those processes living in our containers are going to want the red pill eventually. Haven’t you seen the matrix?<p>But seriously though, it’s so you can write exploits or satisfy that curious itch when working with a cloud service.</div><br/></div></div></div></div><div id="38714927" class="c"><input type="checkbox" id="c-38714927" checked=""/><div class="controls bullet"><span class="by">Mtinie</span><span>|</span><a href="#38714842">prev</a><span>|</span><a href="#38715498">next</a><span>|</span><label class="collapse" for="c-38714927">[-]</label><label class="expand" for="c-38714927">[9 more]</label></div><br/><div class="children"><div class="content">I found the content to be of interest and gave me new things to think about.<p>But honestly, I was hoping before I clicked it that this was going to be about how to escape from the inside of a shipping container.</div><br/><div id="38715482" class="c"><input type="checkbox" id="c-38715482" checked=""/><div class="controls bullet"><span class="by">itishappy</span><span>|</span><a href="#38714927">parent</a><span>|</span><a href="#38715334">next</a><span>|</span><label class="collapse" for="c-38715482">[-]</label><label class="expand" for="c-38715482">[4 more]</label></div><br/><div class="children"><div class="content">Apparently the answer to escaping from a shipping container is...<p>You don&#x27;t, they cannot be opened from inside once locked. Also they&#x27;re airtight, so bang on the walls and hope help arrives before you suffocate.<p>That&#x27;s more nightmare inducing than I was hoping.</div><br/><div id="38717031" class="c"><input type="checkbox" id="c-38717031" checked=""/><div class="controls bullet"><span class="by">knodi123</span><span>|</span><a href="#38714927">root</a><span>|</span><a href="#38715482">parent</a><span>|</span><a href="#38717446">next</a><span>|</span><label class="collapse" for="c-38717031">[-]</label><label class="expand" for="c-38717031">[2 more]</label></div><br/><div class="children"><div class="content">carry a pocket angle grinder.</div><br/><div id="38718247" class="c"><input type="checkbox" id="c-38718247" checked=""/><div class="controls bullet"><span class="by">pmontra</span><span>|</span><a href="#38714927">root</a><span>|</span><a href="#38717031">parent</a><span>|</span><a href="#38717446">next</a><span>|</span><label class="collapse" for="c-38718247">[-]</label><label class="expand" for="c-38718247">[1 more]</label></div><br/><div class="children"><div class="content">And hope your container is not buried deep between hundreds of other containers. You&#x27;ll need a lot of battery packs.</div><br/></div></div></div></div></div></div><div id="38715334" class="c"><input type="checkbox" id="c-38715334" checked=""/><div class="controls bullet"><span class="by">phero_cnstrcts</span><span>|</span><a href="#38714927">parent</a><span>|</span><a href="#38715482">prev</a><span>|</span><a href="#38715585">next</a><span>|</span><label class="collapse" for="c-38715334">[-]</label><label class="expand" for="c-38715334">[1 more]</label></div><br/><div class="children"><div class="content">Me too, that skill could come in handy one day.</div><br/></div></div><div id="38715585" class="c"><input type="checkbox" id="c-38715585" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38714927">parent</a><span>|</span><a href="#38715334">prev</a><span>|</span><a href="#38715443">next</a><span>|</span><label class="collapse" for="c-38715585">[-]</label><label class="expand" for="c-38715585">[1 more]</label></div><br/><div class="children"><div class="content">I think the only answer is you fire up the sawzall your captor neglected to remove before they locked you inside. Also hope there are some earplugs, because you are going to be deaf before you can cut an escape hatch.</div><br/></div></div><div id="38715443" class="c"><input type="checkbox" id="c-38715443" checked=""/><div class="controls bullet"><span class="by">lurquer</span><span>|</span><a href="#38714927">parent</a><span>|</span><a href="#38715585">prev</a><span>|</span><a href="#38716323">next</a><span>|</span><label class="collapse" for="c-38715443">[-]</label><label class="expand" for="c-38715443">[1 more]</label></div><br/><div class="children"><div class="content">Likewise. Damn. I guess I’ll stay stuck in here for a while longer.</div><br/></div></div></div></div><div id="38715498" class="c"><input type="checkbox" id="c-38715498" checked=""/><div class="controls bullet"><span class="by">AndyMcConachie</span><span>|</span><a href="#38714927">prev</a><span>|</span><a href="#38714758">next</a><span>|</span><label class="collapse" for="c-38715498">[-]</label><label class="expand" for="c-38715498">[3 more]</label></div><br/><div class="children"><div class="content">I clicked on this thinking I would learn how to escape a shipping container if I ever got trapped in one ;)</div><br/><div id="38715564" class="c"><input type="checkbox" id="c-38715564" checked=""/><div class="controls bullet"><span class="by">shepherdjerred</span><span>|</span><a href="#38715498">parent</a><span>|</span><a href="#38716324">next</a><span>|</span><label class="collapse" for="c-38715564">[-]</label><label class="expand" for="c-38715564">[1 more]</label></div><br/><div class="children"><div class="content">I had the exact same thought! That would make a very interesting article.<p>Related video :) <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=-trd_f6j3eI" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=-trd_f6j3eI</a></div><br/></div></div></div></div><div id="38714758" class="c"><input type="checkbox" id="c-38714758" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#38715498">prev</a><span>|</span><label class="collapse" for="c-38714758">[-]</label><label class="expand" for="c-38714758">[63 more]</label></div><br/><div class="children"><div class="content">Containers are not a security boundary.<p>Containers are not a security boundary.<p>Containers are not a security boundary.<p>Any system that treats them as such is inherently compromised.</div><br/><div id="38715278" class="c"><input type="checkbox" id="c-38715278" checked=""/><div class="controls bullet"><span class="by">harporoeder</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38714787">next</a><span>|</span><label class="collapse" for="c-38715278">[-]</label><label class="expand" for="c-38715278">[10 more]</label></div><br/><div class="children"><div class="content">All of these escapes rely on some obvious explicit reduction of the isolation guarantees. If you know how to escape a simple docker container invoked with default parameters such as `docker run --rm -it ubuntu &#x2F;bin&#x2F;bash` I&#x27;m sure many people would be interested.</div><br/><div id="38717495" class="c"><input type="checkbox" id="c-38717495" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715278">parent</a><span>|</span><a href="#38715558">next</a><span>|</span><label class="collapse" for="c-38717495">[-]</label><label class="expand" for="c-38717495">[1 more]</label></div><br/><div class="children"><div class="content">The standard way to escape a simple Docker container with default privileges is to use a kernel LPE vulnerability. Kernel LPEs are common enough that they&#x27;re found and patched without major news stories written about them.</div><br/></div></div><div id="38715558" class="c"><input type="checkbox" id="c-38715558" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715278">parent</a><span>|</span><a href="#38717495">prev</a><span>|</span><a href="#38714787">next</a><span>|</span><label class="collapse" for="c-38715558">[-]</label><label class="expand" for="c-38715558">[8 more]</label></div><br/><div class="children"><div class="content">&quot;Escapes&quot; is a vaguely defined term, but considering basic escalation of privilege:<p>- Networking is the obvious one in this scenario. By default (on Docker&#x2F;LXC&#x2F;others) all containers are on the same virtual bridge and can communicate with each other. Even with some additional configuration and isolation it is possible to MITM attack other containers on the same host.<p>- It is very easy to DDoS adjacent containers e.g. by spamming signals, forking new processes, creating files. There is again no default safeguard against this.</div><br/><div id="38717287" class="c"><input type="checkbox" id="c-38717287" checked=""/><div class="controls bullet"><span class="by">cangeroo</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715558">parent</a><span>|</span><a href="#38715712">next</a><span>|</span><label class="collapse" for="c-38717287">[-]</label><label class="expand" for="c-38717287">[2 more]</label></div><br/><div class="children"><div class="content">Can you provide more details on how a container can MITM other containers?<p>Does that also apply to Kubernetes workloads? And does that then require an encrypted service mesh (e.g. Linkerd) or TLS between services?</div><br/><div id="38717760" class="c"><input type="checkbox" id="c-38717760" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38717287">parent</a><span>|</span><a href="#38715712">next</a><span>|</span><label class="collapse" for="c-38717760">[-]</label><label class="expand" for="c-38717760">[1 more]</label></div><br/><div class="children"><div class="content">You have to give your container NET_RAW capability to allow MITM attacks.<p>Still a good idea to use tls.</div><br/></div></div></div></div><div id="38715712" class="c"><input type="checkbox" id="c-38715712" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715558">parent</a><span>|</span><a href="#38717287">prev</a><span>|</span><a href="#38714787">next</a><span>|</span><label class="collapse" for="c-38715712">[-]</label><label class="expand" for="c-38715712">[5 more]</label></div><br/><div class="children"><div class="content">If you give a container access to the network, then yes it will have access to the network. That isn&#x27;t an escape.<p>cgroups can prevent containers from using too much memory or cpu</div><br/><div id="38717765" class="c"><input type="checkbox" id="c-38717765" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715712">parent</a><span>|</span><a href="#38717468">next</a><span>|</span><label class="collapse" for="c-38717765">[-]</label><label class="expand" for="c-38717765">[2 more]</label></div><br/><div class="children"><div class="content">If one container is OOM’ing incessantly, it can disrupt other containers as the system tries to page out read only pages furiously.</div><br/></div></div><div id="38717468" class="c"><input type="checkbox" id="c-38717468" checked=""/><div class="controls bullet"><span class="by">im3w1l</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715712">parent</a><span>|</span><a href="#38717765">prev</a><span>|</span><a href="#38714787">next</a><span>|</span><label class="collapse" for="c-38717468">[-]</label><label class="expand" for="c-38717468">[2 more]</label></div><br/><div class="children"><div class="content">I think we must be careful not to use no-true-scotsman here. Imo, an attack should be considered valid if it works against a typical config - one you would arrive at following a popular tutorial, rather than requiring that it must work against an ideal config.</div><br/><div id="38717780" class="c"><input type="checkbox" id="c-38717780" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38717468">parent</a><span>|</span><a href="#38714787">next</a><span>|</span><label class="collapse" for="c-38717780">[-]</label><label class="expand" for="c-38717780">[1 more]</label></div><br/><div class="children"><div class="content">The definition of escaping a container (namespace) is being able to interact with resources not in the namespaces of the process.<p>If a process&#x27;s network namespace contains a network device then it is not an escape to use it by definition. If the network namespace for a process contains no devices then being able to use a network device would be an escape.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38714787" class="c"><input type="checkbox" id="c-38714787" checked=""/><div class="controls bullet"><span class="by">carbotaniuman</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38715278">prev</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38714787">[-]</label><label class="expand" for="c-38714787">[42 more]</label></div><br/><div class="children"><div class="content">What is the security boundary then? Everywhere I read treats them as a security boundary for say, untrusted code.</div><br/><div id="38714901" class="c"><input type="checkbox" id="c-38714901" checked=""/><div class="controls bullet"><span class="by">maxmcd</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714787">parent</a><span>|</span><a href="#38714848">next</a><span>|</span><label class="collapse" for="c-38714901">[-]</label><label class="expand" for="c-38714901">[1 more]</label></div><br/><div class="children"><div class="content">See Google&#x27;s gvisor as an attempt at reducing the attack-surface of a container to make things more secure.<p>I think the general advice is that a single container can never be a robust security boundary because the OS surface area they involve is so large that the isolation layer is ripe for possible vulnerabilities. You also really have to avoid screwing up, there are lot of fiddly little security mistakes you can make when attempting to use a container to run untrusted code.<p>Typically you might use something like gvisor, or a VM. Systems where isolation is simpler to reason about and the attack surface is smaller.<p>In any case a single isolation boundary can have a vulnerability and my understanding is that more advanced systems typically involve multiple layers of isolation to sandbox untrusted code.</div><br/></div></div><div id="38714848" class="c"><input type="checkbox" id="c-38714848" checked=""/><div class="controls bullet"><span class="by">type0</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714787">parent</a><span>|</span><a href="#38714901">prev</a><span>|</span><a href="#38714850">next</a><span>|</span><label class="collapse" for="c-38714848">[-]</label><label class="expand" for="c-38714848">[4 more]</label></div><br/><div class="children"><div class="content">&gt;  Everywhere I read treats them as a security boundary for say, untrusted code.<p>who&#x27;s everybody? There&#x27;s special kind of VM hosts for that, containers is like your kitchen jars, if someone is vomiting with Ebola in your kitchen - your jars will not help you</div><br/><div id="38715071" class="c"><input type="checkbox" id="c-38715071" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714848">parent</a><span>|</span><a href="#38714850">next</a><span>|</span><label class="collapse" for="c-38715071">[-]</label><label class="expand" for="c-38715071">[3 more]</label></div><br/><div class="children"><div class="content">I think that&#x27;s a great analogy, because <i>yes</i>, if you have a live sample of Ebola in a sealed glass jar then that will very much help you. (I would not recommend leaving the lid open by giving it SYS_ADMIN, but that doesn&#x27;t mean that glass isn&#x27;t a fine material for containing pathogens.)</div><br/><div id="38716818" class="c"><input type="checkbox" id="c-38716818" checked=""/><div class="controls bullet"><span class="by">icedchai</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715071">parent</a><span>|</span><a href="#38714850">next</a><span>|</span><label class="collapse" for="c-38716818">[-]</label><label class="expand" for="c-38716818">[2 more]</label></div><br/><div class="children"><div class="content">Perhaps not a good analogy, given Ebola is generally handled in a level 4 biosafety facility. Do you want to risk carrying it around in a glass jar?</div><br/><div id="38717091" class="c"><input type="checkbox" id="c-38717091" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716818">parent</a><span>|</span><a href="#38714850">next</a><span>|</span><label class="collapse" for="c-38717091">[-]</label><label class="expand" for="c-38717091">[1 more]</label></div><br/><div class="children"><div class="content">Do &quot;level 4 biosafety facility&quot; not use glass vials? I imagine the security isn&#x27;t provided by the choice of containers itself (plastic?), but rather the entire lab design.</div><br/></div></div></div></div></div></div></div></div><div id="38714850" class="c"><input type="checkbox" id="c-38714850" checked=""/><div class="controls bullet"><span class="by">paxys</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714787">parent</a><span>|</span><a href="#38714848">prev</a><span>|</span><a href="#38714800">next</a><span>|</span><label class="collapse" for="c-38714850">[-]</label><label class="expand" for="c-38714850">[4 more]</label></div><br/><div class="children"><div class="content">Containers should never run untrusted code, at least not without other layers of protection added on top. Otherwise stuff like <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;gvisor">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;gvisor</a> would not need to exist. And even then as long as processes are sharing a host kernel they are always vulnerable. A full VM is really the minimum acceptable boundary.</div><br/></div></div><div id="38714800" class="c"><input type="checkbox" id="c-38714800" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714787">parent</a><span>|</span><a href="#38714850">prev</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38714800">[-]</label><label class="expand" for="c-38714800">[32 more]</label></div><br/><div class="children"><div class="content">Virtual machines can be considered a security boundary. Containers are absolutely not.</div><br/><div id="38718132" class="c"><input type="checkbox" id="c-38718132" checked=""/><div class="controls bullet"><span class="by">vaylian</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714800">parent</a><span>|</span><a href="#38714825">next</a><span>|</span><label class="collapse" for="c-38718132">[-]</label><label class="expand" for="c-38718132">[1 more]</label></div><br/><div class="children"><div class="content">What disqualifies containers as a security boundary?</div><br/></div></div><div id="38714825" class="c"><input type="checkbox" id="c-38714825" checked=""/><div class="controls bullet"><span class="by">dvt</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714800">parent</a><span>|</span><a href="#38718132">prev</a><span>|</span><a href="#38714881">next</a><span>|</span><label class="collapse" for="c-38714825">[-]</label><label class="expand" for="c-38714825">[10 more]</label></div><br/><div class="children"><div class="content">The distinction is getting more and more fuzzy, so this is almost a meaningless point (as is GGP). It&#x27;s very vendor-specific, let alone that I&#x27;m pretty sure Spectre attacks can work across VMs.</div><br/><div id="38714878" class="c"><input type="checkbox" id="c-38714878" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714825">parent</a><span>|</span><a href="#38717500">next</a><span>|</span><label class="collapse" for="c-38714878">[-]</label><label class="expand" for="c-38714878">[8 more]</label></div><br/><div class="children"><div class="content">I wouldn’t consider the distinction “fuzzy”. Assuming we’re talking Linux (I don’t know about the Mac and Windows world) containers are implemented using namespaces and cgroups, and always have been. Whether you are talking docker, containerd, some more minimalistic thing built on runc, it’s all Linux namespaces and cgroups. And those things were explicitly not designed to act as security boundaries when running untrusted code.</div><br/><div id="38715074" class="c"><input type="checkbox" id="c-38715074" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714878">parent</a><span>|</span><a href="#38715000">next</a><span>|</span><label class="collapse" for="c-38715074">[-]</label><label class="expand" for="c-38715074">[6 more]</label></div><br/><div class="children"><div class="content">Kata containers would like a word</div><br/><div id="38715163" class="c"><input type="checkbox" id="c-38715163" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715074">parent</a><span>|</span><a href="#38716951">next</a><span>|</span><label class="collapse" for="c-38715163">[-]</label><label class="expand" for="c-38715163">[1 more]</label></div><br/><div class="children"><div class="content">Now in fairness, that is very specifically using a VM to add an even stronger boundry; it&#x27;s not really the same thing.</div><br/></div></div><div id="38716951" class="c"><input type="checkbox" id="c-38716951" checked=""/><div class="controls bullet"><span class="by">Kluggy</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715074">parent</a><span>|</span><a href="#38715163">prev</a><span>|</span><a href="#38715000">next</a><span>|</span><label class="collapse" for="c-38716951">[-]</label><label class="expand" for="c-38716951">[4 more]</label></div><br/><div class="children"><div class="content">Does anyone actually use Kata containers? I&#x27;ve tried recently to run them on a current Ubuntu platform and couldn&#x27;t get it working at all after a few days of work.</div><br/><div id="38717913" class="c"><input type="checkbox" id="c-38717913" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716951">parent</a><span>|</span><a href="#38717848">next</a><span>|</span><label class="collapse" for="c-38717913">[-]</label><label class="expand" for="c-38717913">[1 more]</label></div><br/><div class="children"><div class="content">Azure does, <a href="https:&#x2F;&#x2F;thenewstack.io&#x2F;microsoft-adopts-openinfra-kata-containers-security-on-azure&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;thenewstack.io&#x2F;microsoft-adopts-openinfra-kata-conta...</a><p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;confidential-computing&#x2F;confidential-containers" rel="nofollow noreferrer">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;azure&#x2F;confidential-computi...</a></div><br/></div></div><div id="38717848" class="c"><input type="checkbox" id="c-38717848" checked=""/><div class="controls bullet"><span class="by">k1r1ka</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716951">parent</a><span>|</span><a href="#38717913">prev</a><span>|</span><a href="#38717364">next</a><span>|</span><label class="collapse" for="c-38717848">[-]</label><label class="expand" for="c-38717848">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s Ubuntu, possible you had docker inside snap unintentionally and issues because of that? I had a bit trouble getting it integrated with certain versions of Podman, but that aside setting up kata was pretty straightforward.<p>I have so far only used it for 
hosting some gameservers which I don&#x27;t trust, i.e some simple containers, but I really want to try it in a new k3s cluster once I get it setup and move some services there. I like the idea of putting internet facing ones into it as an additional layer of separation  and could imagine it being useful in production.</div><br/></div></div><div id="38717364" class="c"><input type="checkbox" id="c-38717364" checked=""/><div class="controls bullet"><span class="by">dharmab</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716951">parent</a><span>|</span><a href="#38717848">prev</a><span>|</span><a href="#38715000">next</a><span>|</span><label class="collapse" for="c-38717364">[-]</label><label class="expand" for="c-38717364">[1 more]</label></div><br/><div class="children"><div class="content">Yes, I worked for a very large tech company that used Kata.</div><br/></div></div></div></div></div></div></div></div><div id="38717500" class="c"><input type="checkbox" id="c-38717500" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714825">parent</a><span>|</span><a href="#38714878">prev</a><span>|</span><a href="#38714881">next</a><span>|</span><label class="collapse" for="c-38717500">[-]</label><label class="expand" for="c-38717500">[1 more]</label></div><br/><div class="children"><div class="content">The distinction is in fact pretty clear. Conventional container runtimes are shared-kernel isolation. Virtual machines aren&#x27;t: every tenant has their own running kernel.</div><br/></div></div></div></div><div id="38714881" class="c"><input type="checkbox" id="c-38714881" checked=""/><div class="controls bullet"><span class="by">redserk</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714800">parent</a><span>|</span><a href="#38714825">prev</a><span>|</span><a href="#38714862">next</a><span>|</span><label class="collapse" for="c-38714881">[-]</label><label class="expand" for="c-38714881">[4 more]</label></div><br/><div class="children"><div class="content">Misconfiguring or granting something unnecessary privileges is enough to eliminate anything as a security boundary.<p>VMs easily give a false sense of security especially with any kind of network-based trust.</div><br/><div id="38714907" class="c"><input type="checkbox" id="c-38714907" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714881">parent</a><span>|</span><a href="#38717504">next</a><span>|</span><label class="collapse" for="c-38714907">[-]</label><label class="expand" for="c-38714907">[2 more]</label></div><br/><div class="children"><div class="content">Sure, anything that is misconfigured could eliminate a security boundary. That doesn’t mean that containers are even in the same ballpark as VMs in terms of providing a security boundary.</div><br/><div id="38714999" class="c"><input type="checkbox" id="c-38714999" checked=""/><div class="controls bullet"><span class="by">zekrioca</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714907">parent</a><span>|</span><a href="#38717504">next</a><span>|</span><label class="collapse" for="c-38714999">[-]</label><label class="expand" for="c-38714999">[1 more]</label></div><br/><div class="children"><div class="content">Why not?</div><br/></div></div></div></div><div id="38717504" class="c"><input type="checkbox" id="c-38717504" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714881">parent</a><span>|</span><a href="#38714907">prev</a><span>|</span><a href="#38714862">next</a><span>|</span><label class="collapse" for="c-38717504">[-]</label><label class="expand" for="c-38717504">[1 more]</label></div><br/><div class="children"><div class="content">Everything has the &quot;network-based trust&quot; problem, including isolated hardware.</div><br/></div></div></div></div><div id="38714862" class="c"><input type="checkbox" id="c-38714862" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714800">parent</a><span>|</span><a href="#38714881">prev</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38714862">[-]</label><label class="expand" for="c-38714862">[16 more]</label></div><br/><div class="children"><div class="content">Why? Both are supposed to keep whatever is inside trapped unless you poke holes in that protection (say, using virtio or even just 9P to hand it real storage)</div><br/><div id="38714891" class="c"><input type="checkbox" id="c-38714891" checked=""/><div class="controls bullet"><span class="by">lmm</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714862">parent</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38714891">[-]</label><label class="expand" for="c-38714891">[15 more]</label></div><br/><div class="children"><div class="content">Because virtual machines were designed from the start to run untrusted code, and containers were not?<p>&gt; supposed to keep whatever is inside trapped unless you poke holes in that protection<p>As far as I know that was never a design decision for containers on Linux; certainly not in the early days.</div><br/><div id="38714970" class="c"><input type="checkbox" id="c-38714970" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714891">parent</a><span>|</span><a href="#38717779">next</a><span>|</span><label class="collapse" for="c-38714970">[-]</label><label class="expand" for="c-38714970">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;m willing to believe that Linux containers were not initially designed to be a security boundary, but I struggle to see why that means they aren&#x27;t now; it&#x27;s been over a decade and they have an awful lot of security features for something that doesn&#x27;t care about security.<p>EDIT: For that matter, they&#x27;re clearly being <i>used</i> for security; the features in Linux that are used by runc et al. are the same features used by eg. Chrome to isolate components in order to contain vulnerabilities.</div><br/><div id="38715115" class="c"><input type="checkbox" id="c-38715115" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714970">parent</a><span>|</span><a href="#38717374">next</a><span>|</span><label class="collapse" for="c-38715115">[-]</label><label class="expand" for="c-38715115">[4 more]</label></div><br/><div class="children"><div class="content">As far as I know, Docker still punches through your firewall by default. I consider that a pretty big negative against assuming secure-by-design.</div><br/><div id="38715139" class="c"><input type="checkbox" id="c-38715139" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715115">parent</a><span>|</span><a href="#38717374">next</a><span>|</span><label class="collapse" for="c-38715139">[-]</label><label class="expand" for="c-38715139">[3 more]</label></div><br/><div class="children"><div class="content">What attack are you envisioning that is aided by docker bypassing firewall rules?</div><br/><div id="38717145" class="c"><input type="checkbox" id="c-38717145" checked=""/><div class="controls bullet"><span class="by">pella</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715139">parent</a><span>|</span><a href="#38715353">next</a><span>|</span><label class="collapse" for="c-38717145">[-]</label><label class="expand" for="c-38717145">[1 more]</label></div><br/><div class="children"><div class="content">Weak password + Open ports ---&gt; Malware attack ( kinsing , etc )<p>so use &quot;-p 127.0.0.1:5432:5432&quot;<p>- <a href="https:&#x2F;&#x2F;github.com&#x2F;docker-library&#x2F;postgres&#x2F;issues&#x2F;770">https:&#x2F;&#x2F;github.com&#x2F;docker-library&#x2F;postgres&#x2F;issues&#x2F;770</a><p>- <a href="https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;zoom-into-kinsing-kdevtmpfsi" rel="nofollow noreferrer">https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;zoom-into-kinsing-kdevtmpfsi</a><p>- <a href="https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;cloud-defense-in-depth&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;sysdig.com&#x2F;blog&#x2F;cloud-defense-in-depth&#x2F;</a><p>- <a href="https:&#x2F;&#x2F;thenewstack.io&#x2F;kinsing-malware-targets-kubernetes&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;thenewstack.io&#x2F;kinsing-malware-targets-kubernetes&#x2F;</a><p>- <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;search?q=kinsing" rel="nofollow noreferrer">https:&#x2F;&#x2F;stackoverflow.com&#x2F;search?q=kinsing</a><p>- <a href="https:&#x2F;&#x2F;github.com&#x2F;search?q=repo%3Adocker-library%2Fpostgres+malware&amp;type=issues">https:&#x2F;&#x2F;github.com&#x2F;search?q=repo%3Adocker-library%2Fpostgres...</a><p>-----------<p><a href="https:&#x2F;&#x2F;docs.docker.com&#x2F;network&#x2F;packet-filtering-firewalls&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.docker.com&#x2F;network&#x2F;packet-filtering-firewalls&#x2F;</a><p><i>&quot;On Linux, Docker manipulates iptables rules to provide network isolation. While this is an implementation detail and you should not modify the rules Docker inserts into your iptables policies, it does have some implications on what you need to do if you want to have your own policies in addition to those managed by Docker.<p>If you&#x27;re running Docker on a host that is exposed to the Internet, you will probably want to have iptables policies in place that prevent unauthorized access to containers or other services running on your host. This page describes how to achieve that, and what caveats you need to be aware of.&quot;</i></div><br/></div></div><div id="38715353" class="c"><input type="checkbox" id="c-38715353" checked=""/><div class="controls bullet"><span class="by">fbdab103</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38715139">parent</a><span>|</span><a href="#38717145">prev</a><span>|</span><a href="#38717374">next</a><span>|</span><label class="collapse" for="c-38715353">[-]</label><label class="expand" for="c-38715353">[1 more]</label></div><br/><div class="children"><div class="content">I mean, there was this story[0] (&quot;How a Docker footgun led to a vandal deleting NewsBlur&#x27;s MongoDB database&quot;) about how the Docker rules allowed a hacker to delete someone&#x27;s database.<p>&gt;Turns out the ufw firewall I enabled and diligently kept on a strict allowlist with only my internal servers didn’t work on a new server because of Docker. When I containerized MongoDB, Docker helpfully inserted an allow rule into iptables, opening up MongoDB to the world. So while my firewall was “active”, doing a sudo iptables -L | grep 27017 showed that MongoDB was open the world. This has been a Docker footgun since 2014.<p>Story was previously discussed on HN[1]. Sure, you could argue the author should have done more to secure the endpoint, but this was 100% a failure mode due to how Docker prioritizes convenience over security.<p>[0] <a href="https:&#x2F;&#x2F;blog.newsblur.com&#x2F;2021&#x2F;06&#x2F;28&#x2F;story-of-a-hacking&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.newsblur.com&#x2F;2021&#x2F;06&#x2F;28&#x2F;story-of-a-hacking&#x2F;</a><p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=27670058">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=27670058</a></div><br/></div></div></div></div></div></div><div id="38717374" class="c"><input type="checkbox" id="c-38717374" checked=""/><div class="controls bullet"><span class="by">dharmab</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714970">parent</a><span>|</span><a href="#38715115">prev</a><span>|</span><a href="#38716412">next</a><span>|</span><label class="collapse" for="c-38717374">[-]</label><label class="expand" for="c-38717374">[1 more]</label></div><br/><div class="children"><div class="content">Most containers do not switch the CPU VM context when the CPU switches between containers. VMs do. This is necessary to prevent attacks which can leak data through the CPU cache.</div><br/></div></div><div id="38716412" class="c"><input type="checkbox" id="c-38716412" checked=""/><div class="controls bullet"><span class="by">lmm</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714970">parent</a><span>|</span><a href="#38717374">prev</a><span>|</span><a href="#38717779">next</a><span>|</span><label class="collapse" for="c-38716412">[-]</label><label class="expand" for="c-38716412">[1 more]</label></div><br/><div class="children"><div class="content">I agree that they have a bunch of security features, because they&#x27;ve been playing security whack-a-mole for a decade. Retrofitting a security boundary onto an existing system is very difficult. Personally Linux containers are still not at a level where I&#x27;d trust them for something that was meant to be a hard security boundary rather than a damage mitigation exercise, though obviously that&#x27;s a subjective judgement.</div><br/></div></div></div></div><div id="38717779" class="c"><input type="checkbox" id="c-38717779" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714891">parent</a><span>|</span><a href="#38714970">prev</a><span>|</span><a href="#38715300">next</a><span>|</span><label class="collapse" for="c-38717779">[-]</label><label class="expand" for="c-38717779">[1 more]</label></div><br/><div class="children"><div class="content">Linux was designed as a multi-user operating system from the get go. By definition, programs from different users are supposed to run without access to data that they shouldn’t have access to.<p>That said, it’s hard to get right at all times.</div><br/></div></div><div id="38715300" class="c"><input type="checkbox" id="c-38715300" checked=""/><div class="controls bullet"><span class="by">fouc</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714891">parent</a><span>|</span><a href="#38717779">prev</a><span>|</span><a href="#38714989">next</a><span>|</span><label class="collapse" for="c-38715300">[-]</label><label class="expand" for="c-38715300">[1 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t say &quot;designed from the start&quot;, I would just say virtual machines are naturally more isolated than containers.  Since virtual machines are simulating hardware, compared to containers which are isolated user space instances.<p>But I guess that doesn&#x27;t mean virtual machines aren&#x27;t easily escapable without extra work, same as containers.</div><br/></div></div><div id="38714989" class="c"><input type="checkbox" id="c-38714989" checked=""/><div class="controls bullet"><span class="by">zekrioca</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714891">parent</a><span>|</span><a href="#38715300">prev</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38714989">[-]</label><label class="expand" for="c-38714989">[5 more]</label></div><br/><div class="children"><div class="content">This doesn’t answer the question. How were VMs designed with security in mind and not with host emulation? Untrusted code? I’m confused, people are talking about vulnerabilities.</div><br/><div id="38717379" class="c"><input type="checkbox" id="c-38717379" checked=""/><div class="controls bullet"><span class="by">dharmab</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714989">parent</a><span>|</span><a href="#38716891">next</a><span>|</span><label class="collapse" for="c-38717379">[-]</label><label class="expand" for="c-38717379">[2 more]</label></div><br/><div class="children"><div class="content">When you switch between VMs and the host the CPU executes an instruction to isolate the data of each VMs entirely (flushing caches). This doesn&#x27;t happen with containers.</div><br/><div id="38717601" class="c"><input type="checkbox" id="c-38717601" checked=""/><div class="controls bullet"><span class="by">zekrioca</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38717379">parent</a><span>|</span><a href="#38716891">next</a><span>|</span><label class="collapse" for="c-38717601">[-]</label><label class="expand" for="c-38717601">[1 more]</label></div><br/><div class="children"><div class="content">Although this feature does improve security, it is due to the CPU, the VM and the main idea was to reduce performance overheads. I do not see adding layers and layers of abstractions the same as more secure. In fact, meltdown and spectre serve as counter-examples.<p>Also, one can achieve similar effects with containers as well, just think AppArmor, capabilities, permissions, etc., all layers of administrative privileges between some untrusted code and the host.</div><br/></div></div></div></div><div id="38716891" class="c"><input type="checkbox" id="c-38716891" checked=""/><div class="controls bullet"><span class="by">icedchai</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38714989">parent</a><span>|</span><a href="#38717379">prev</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38716891">[-]</label><label class="expand" for="c-38716891">[2 more]</label></div><br/><div class="children"><div class="content">VMs don’t share the kernel with the host. Any host escape would need to happen through a device driver exposed to the guest (virtio, etc.) Containers use the same kernel, obviously a much larger set of code. More code means a greater chance of vulnerabilities.</div><br/><div id="38717652" class="c"><input type="checkbox" id="c-38717652" checked=""/><div class="controls bullet"><span class="by">zekrioca</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716891">parent</a><span>|</span><a href="#38715133">next</a><span>|</span><label class="collapse" for="c-38717652">[-]</label><label class="expand" for="c-38717652">[1 more]</label></div><br/><div class="children"><div class="content">How do you think the VM itself is spawned? Something in the host instantiate it. 
But even if we ignore that, I would argue that concentrating in one location only (e.g., some exposed driver) to escape is also easier, since an attacker would need to spend time trying to find only one vulnerability rather than several.<p>I think the hardware can help bridging the gap between containers and VMs by enabling userspace processes behave as VMs, which is more or less what QEMU+KVM try to do, except that it still comes with some overheads and less flexibility.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="38715133" class="c"><input type="checkbox" id="c-38715133" checked=""/><div class="controls bullet"><span class="by">johncolanduoni</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38714787">prev</a><span>|</span><a href="#38715268">next</a><span>|</span><label class="collapse" for="c-38715133">[-]</label><label class="expand" for="c-38715133">[1 more]</label></div><br/><div class="children"><div class="content">This is true, but the exploits listed in this article are poor evidence of this. If it was as simple as not giving Linux containers any capabilities or host sockets they would be a decent security boundary.<p>I find it super frustrating that we&#x27;re stuck with kernels with inherent weaknesses to their security approach that we have to re-implement them in userspace in one way or another (gVisor, Firecracker, etc.) just to get the hardware-provided userspace&#x2F;kernel boundary to work properly.</div><br/></div></div><div id="38715268" class="c"><input type="checkbox" id="c-38715268" checked=""/><div class="controls bullet"><span class="by">brutal_chaos_</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38715133">prev</a><span>|</span><a href="#38717929">next</a><span>|</span><label class="collapse" for="c-38715268">[-]</label><label class="expand" for="c-38715268">[1 more]</label></div><br/><div class="children"><div class="content">A container is a security boundry. However, no security boundry is perfect and more boundries must be put in place as well, depending on your threat model.<p>edit: typo</div><br/></div></div><div id="38717929" class="c"><input type="checkbox" id="c-38717929" checked=""/><div class="controls bullet"><span class="by">insanitybit</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38715268">prev</a><span>|</span><a href="#38716906">next</a><span>|</span><label class="collapse" for="c-38717929">[-]</label><label class="expand" for="c-38717929">[1 more]</label></div><br/><div class="children"><div class="content">Containers are absolutely a security boundary, and an excellent one at that - at least, Docker containers are.<p>1. You get file, process, and network namespaces, which are a security boundary<p>2. You get a seccomp filter, which is a security boundary<p>The &quot;containers are not a security boundary&quot; meme needs to die.<p>Elsewhere you mention that &quot;containers are not sufficient for untrusted code&quot; but that&#x27;s a very specific <i>and very niche</i> threat model. Most people don&#x27;t say &quot;send me a binary and I&#x27;ll execute it&quot;, or have arbitrary RCE + multitenancy concerns.<p>Containers aren&#x27;t sufficient for multi-tenant RCE because the RCE is <i>by design</i> so 100% of your security pressure is on the container at that point. In the vast majority of cases you&#x27;re dealing with servers that don&#x27;t <i>intend</i> to allow arbitrary code execution, and containers are an extremely easy way to drive up the cost of an attack given that the attacker has already spent a lot of time and money on the RCE.<p>SELinux is <i>also</i> not sufficient for the &quot;RCE by design&quot; threat model - is SELinux not a security boundary?<p>Further, containers can limit the impact of remote vulnerabilities like path traversal attacks, since they have file isolation by default.<p>edit: I see elsewhere that there&#x27;s a real lack of clarity here.<p>First off, a security boundary can be meaningfully defined as a limitation on an attacker that does not have a way around it without additional exploitation.<p>So the main reason why people have said &quot;containers are not a security boundary&quot; is because:<p>a) Very, very early on, escaping a container was <i>trivial</i> - like you could just ask to leave and you&#x27;d be out.<p>b) There were some blog posts basically saying &quot;containers aren&#x27;t sufficient for multi-tenancy&quot; where arbitrary users can run arbitrary code on the same host. This is still the case today - but it&#x27;s also an extremely rare threat model.<p><i>Why</i> would containers not be sufficient for (b) ? Because the majority of the Linux kernel is still exposed to the attacker within a container - the vast majority of system call interfaces are exposed (but seccomp removes a number of these, which is nice). The Linux kernel is not at all sufficiently hardened against attackers who can make arbitrary system calls, therefor containers are not sufficient against those attackers. If you give the attacker RCE by default (ie: your service is &quot;Send me a binary and i&#x27;ll run it&quot;) then an attacker can spend all of their time and money just on a local privesc, which isn&#x27;t crazy difficult.<p>Since the cost of RCE in an RCE-aaS is 0 the consensus is that containers aren&#x27;t strong enough for RCE-aaS threat models. In that case use Firecracker or gVisor or a dedicated host.<p>Otherwise, RCE costs tend to be pretty high and having to develop an additional LPE on top of one is, at minimum, quite a pain for many attackers.<p>Containers are <i>extremely</i> easy to deploy software into, something like a Firecracker VM is not. Containers are basically just processes, so you can monitor them and manage them trivially. Monitoring and managing VMs with processes inside of them is obviously harder. So I think the &#x27;bang for your buck&#x27; with containers is extremely solid.</div><br/></div></div><div id="38716906" class="c"><input type="checkbox" id="c-38716906" checked=""/><div class="controls bullet"><span class="by">SoftTalker</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38717929">prev</a><span>|</span><a href="#38715141">next</a><span>|</span><label class="collapse" for="c-38716906">[-]</label><label class="expand" for="c-38716906">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Containers are not a security boundary.<p>The name is at least misleading if not wrong, then? What do they &quot;contain&quot;?</div><br/><div id="38716938" class="c"><input type="checkbox" id="c-38716938" checked=""/><div class="controls bullet"><span class="by">Kluggy</span><span>|</span><a href="#38714758">root</a><span>|</span><a href="#38716906">parent</a><span>|</span><a href="#38715141">next</a><span>|</span><label class="collapse" for="c-38716938">[-]</label><label class="expand" for="c-38716938">[1 more]</label></div><br/><div class="children"><div class="content">They contain the transitive closure of software and libraries to run a binary.<p>Under the hood, they&#x27;re a fancy wrapper around a pile of tar files.<p>Tar files certainly contain other files and are also not a security boundary.</div><br/></div></div></div></div><div id="38715141" class="c"><input type="checkbox" id="c-38715141" checked=""/><div class="controls bullet"><span class="by">10000truths</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38716906">prev</a><span>|</span><a href="#38716989">next</a><span>|</span><label class="collapse" for="c-38715141">[-]</label><label class="expand" for="c-38715141">[1 more]</label></div><br/><div class="children"><div class="content">This kind of reductive dogma is meaningless FUD. A container is as secure as its underlying implementation.</div><br/></div></div><div id="38716989" class="c"><input type="checkbox" id="c-38716989" checked=""/><div class="controls bullet"><span class="by">rjzzleep</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38715141">prev</a><span>|</span><a href="#38715224">next</a><span>|</span><label class="collapse" for="c-38716989">[-]</label><label class="expand" for="c-38716989">[1 more]</label></div><br/><div class="children"><div class="content">They were on Solaris no?</div><br/></div></div><div id="38715224" class="c"><input type="checkbox" id="c-38715224" checked=""/><div class="controls bullet"><span class="by">imetatroll</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38716989">prev</a><span>|</span><a href="#38716406">next</a><span>|</span><label class="collapse" for="c-38715224">[-]</label><label class="expand" for="c-38715224">[1 more]</label></div><br/><div class="children"><div class="content">Is gvisor considered sufficient when running 3rd-party code?  Are there other measures that should be taken in addition to using gvisor?</div><br/></div></div><div id="38716406" class="c"><input type="checkbox" id="c-38716406" checked=""/><div class="controls bullet"><span class="by">ajross</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38715224">prev</a><span>|</span><a href="#38714873">next</a><span>|</span><label class="collapse" for="c-38716406">[-]</label><label class="expand" for="c-38716406">[1 more]</label></div><br/><div class="children"><div class="content">Is putting processes in separate memory spaces not a security boundary to you?  Isolating separate app responsibilities in separate UIDs?  Filesystem permission bits?  All those are &quot;weaker&quot; boundaries than containers.  Do you really claim that these have <i>ZERO</i> security value?<p>That&#x27;s silly.  Of course containers are a security boundary.  They have advantages and disadvantages.  Treat them as tools and not slogans.</div><br/></div></div><div id="38714873" class="c"><input type="checkbox" id="c-38714873" checked=""/><div class="controls bullet"><span class="by">2OEH8eoCRo0</span><span>|</span><a href="#38714758">parent</a><span>|</span><a href="#38716406">prev</a><span>|</span><label class="collapse" for="c-38714873">[-]</label><label class="expand" for="c-38714873">[1 more]</label></div><br/><div class="children"><div class="content">Of course they are. There is debate over how good of a boundary they are but even caution tape is a security boundary.</div><br/></div></div></div></div></div></div></div></div></div></body></html>