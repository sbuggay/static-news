<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1700038872302" as="style"/><link rel="stylesheet" href="styles.css?v=1700038872302"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/github/scientist">Scientist: A Ruby library for carefully refactoring critical paths</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>thunderbong</span> | <span>15 comments</span></div><br/><div><div id="38273162" class="c"><input type="checkbox" id="c-38273162" checked=""/><div class="controls bullet"><span class="by">nickspain</span><span>|</span><a href="#38272958">next</a><span>|</span><label class="collapse" for="c-38273162">[-]</label><label class="expand" for="c-38273162">[1 more]</label></div><br/><div class="children"><div class="content">We&#x27;ve used this extensively at my work and it has been great. As someone else pointed out it&#x27;s a bit tricky if the code isn&#x27;t idempotent. We used this as part of a data migration project and for writing we ran the experiment 100% of the time and read back the result to check it was correct - a bit of a performance impact but nothing that was noticeable. One super useful extension we&#x27;ve made to the gem is to have it update Prometheus metrics so you can easily see how often your experiment is showing that the candidate is different from the control.</div><br/></div></div><div id="38272958" class="c"><input type="checkbox" id="c-38272958" checked=""/><div class="controls bullet"><span class="by">drwl</span><span>|</span><a href="#38273162">prev</a><span>|</span><a href="#38272669">next</a><span>|</span><label class="collapse" for="c-38272958">[-]</label><label class="expand" for="c-38272958">[1 more]</label></div><br/><div class="children"><div class="content">I’ve used this gem to remove a Rails Model that was heavily tangled and used in production. It had a bit of a learning curve, such as seeing how errors get handled in try {} blocks, but really nice otherwise when doing the equivalent of open heart surgery.</div><br/></div></div><div id="38272669" class="c"><input type="checkbox" id="c-38272669" checked=""/><div class="controls bullet"><span class="by">techplex</span><span>|</span><a href="#38272958">prev</a><span>|</span><a href="#38273541">next</a><span>|</span><label class="collapse" for="c-38272669">[-]</label><label class="expand" for="c-38272669">[2 more]</label></div><br/><div class="children"><div class="content">This is fantastic! Do folks do this manually in other languages or are there proven packages folks use?</div><br/><div id="38272707" class="c"><input type="checkbox" id="c-38272707" checked=""/><div class="controls bullet"><span class="by">sanxiyn</span><span>|</span><a href="#38272669">parent</a><span>|</span><a href="#38273541">next</a><span>|</span><label class="collapse" for="c-38272707">[-]</label><label class="expand" for="c-38272707">[1 more]</label></div><br/><div class="children"><div class="content">There is a list of packages in other languages at the bottom of the README.</div><br/></div></div></div></div><div id="38273541" class="c"><input type="checkbox" id="c-38273541" checked=""/><div class="controls bullet"><span class="by">aeontech</span><span>|</span><a href="#38272669">prev</a><span>|</span><a href="#38273441">next</a><span>|</span><label class="collapse" for="c-38273541">[-]</label><label class="expand" for="c-38273541">[3 more]</label></div><br/><div class="children"><div class="content">Dear lazyweb, is there a similar library for python? :)</div><br/><div id="38274206" class="c"><input type="checkbox" id="c-38274206" checked=""/><div class="controls bullet"><span class="by">boxed</span><span>|</span><a href="#38273541">parent</a><span>|</span><a href="#38273641">next</a><span>|</span><label class="collapse" for="c-38274206">[-]</label><label class="expand" for="c-38274206">[1 more]</label></div><br/><div class="children"><div class="content">I wrote one (<a href="https:&#x2F;&#x2F;github.com&#x2F;boxed&#x2F;scientist">https:&#x2F;&#x2F;github.com&#x2F;boxed&#x2F;scientist</a>) as I found the existing ones very complicated and that just gives me a bad feeling. Since I&#x27;m the author of mutmut (<a href="https:&#x2F;&#x2F;github.com&#x2F;boxed&#x2F;mutmut">https:&#x2F;&#x2F;github.com&#x2F;boxed&#x2F;mutmut</a>), I also made sure my implementation was 100% mutation tested before I used it in production.<p>I used my implementation to replace number parsing in my work project: <a href="https:&#x2F;&#x2F;kodare.net&#x2F;2021&#x2F;04&#x2F;04&#x2F;safe_number_parsing.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;kodare.net&#x2F;2021&#x2F;04&#x2F;04&#x2F;safe_number_parsing.html</a></div><br/></div></div><div id="38273641" class="c"><input type="checkbox" id="c-38273641" checked=""/><div class="controls bullet"><span class="by">joshmanders</span><span>|</span><a href="#38273541">parent</a><span>|</span><a href="#38274206">prev</a><span>|</span><a href="#38273441">next</a><span>|</span><label class="collapse" for="c-38273641">[-]</label><label class="expand" for="c-38273641">[1 more]</label></div><br/><div class="children"><div class="content">Yes, at the bottom it lists all similar libraries in other languages. Python has <a href="https:&#x2F;&#x2F;github.com&#x2F;joealcorn&#x2F;laboratory">https:&#x2F;&#x2F;github.com&#x2F;joealcorn&#x2F;laboratory</a></div><br/></div></div></div></div><div id="38273441" class="c"><input type="checkbox" id="c-38273441" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#38273541">prev</a><span>|</span><a href="#38272706">next</a><span>|</span><label class="collapse" for="c-38273441">[-]</label><label class="expand" for="c-38273441">[1 more]</label></div><br/><div class="children"><div class="content">previously: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=21489877">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=21489877</a> (178 pt, 19 comments)</div><br/></div></div><div id="38272706" class="c"><input type="checkbox" id="c-38272706" checked=""/><div class="controls bullet"><span class="by">mberning</span><span>|</span><a href="#38273441">prev</a><span>|</span><a href="#38274014">next</a><span>|</span><label class="collapse" for="c-38272706">[-]</label><label class="expand" for="c-38272706">[4 more]</label></div><br/><div class="children"><div class="content">This is pretty cool, but in my experience critical path code generally has side effects and most code is not idempotent. That is to say it may not be safe or feasible to run the old and new code in parallel, without some special considerations. Think bidding on a auction item or transferring a bank balance.</div><br/><div id="38272810" class="c"><input type="checkbox" id="c-38272810" checked=""/><div class="controls bullet"><span class="by">rockwotj</span><span>|</span><a href="#38272706">parent</a><span>|</span><a href="#38273626">next</a><span>|</span><label class="collapse" for="c-38272810">[-]</label><label class="expand" for="c-38272810">[2 more]</label></div><br/><div class="children"><div class="content">Sure but IMO most code can and should be structured to decouple the side effect from the logic that is being replaced.<p>Example in the transferring a bank balance, you have some storage DB you interact with, but that is an abstraction and when you run the dry run of the new code you can have an implementation that just does verification on the data from the real implementation.<p>Anyways, it does take discipline and effort, but you can still safely make changes in this manner.</div><br/><div id="38274678" class="c"><input type="checkbox" id="c-38274678" checked=""/><div class="controls bullet"><span class="by">Manfred</span><span>|</span><a href="#38272706">root</a><span>|</span><a href="#38272810">parent</a><span>|</span><a href="#38273626">next</a><span>|</span><label class="collapse" for="c-38274678">[-]</label><label class="expand" for="c-38274678">[1 more]</label></div><br/><div class="children"><div class="content">The library is specifically meant for safely replacing legacy implementations and they generally aren&#x27;t that well structured.</div><br/></div></div></div></div><div id="38273626" class="c"><input type="checkbox" id="c-38273626" checked=""/><div class="controls bullet"><span class="by">runako</span><span>|</span><a href="#38272706">parent</a><span>|</span><a href="#38272810">prev</a><span>|</span><a href="#38274014">next</a><span>|</span><label class="collapse" for="c-38273626">[-]</label><label class="expand" for="c-38273626">[1 more]</label></div><br/><div class="children"><div class="content">I would imagine that applications that use a relational database could use transactions to reduce the impact of non-idempotent code.</div><br/></div></div></div></div><div id="38274014" class="c"><input type="checkbox" id="c-38274014" checked=""/><div class="controls bullet"><span class="by">dieselgate</span><span>|</span><a href="#38272706">prev</a><span>|</span><label class="collapse" for="c-38274014">[-]</label><label class="expand" for="c-38274014">[2 more]</label></div><br/><div class="children"><div class="content">Pretty cool to see the github of Github, never occurred to me but makes total sense.</div><br/></div></div></div></div></div></div></div></body></html>