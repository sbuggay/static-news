<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1734512460715" as="style"/><link rel="stylesheet" href="styles.css?v=1734512460715"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://openauth.js.org/">OpenAUTH: Universal, standards-based auth provider</a> <span class="domain">(<a href="https://openauth.js.org">openauth.js.org</a>)</span></div><div class="subtext"><span>jacobrussell</span> | <span>46 comments</span></div><br/><div><div id="42446357" class="c"><input type="checkbox" id="c-42446357" checked=""/><div class="controls bullet"><span class="by">chowells</span><span>|</span><a href="#42447089">next</a><span>|</span><label class="collapse" for="c-42446357">[-]</label><label class="expand" for="c-42446357">[9 more]</label></div><br/><div class="children"><div class="content">&gt; While OpenAuth tries to be mostly stateless, it does need to store a minimal amount of data (refresh tokens, password hashes, etc). However this has been reduced to a simple KV store with various implementations for zero overhead systems like Cloudflare KV and DynamoDB. You should never need to directly access any data that is stored in there.<p>Written like someone who&#x27;s never actually maintained an identify provider used in B2B contract work. You will inevitably come into contact with people who cannot make things work on their side and are doing things so unexpectedly that logging is insufficient to track down the error. Sooner or later you will need to look at the data actually in storage to figure out what your customers who are threatening to cancel their contract are doing wrong.<p>I&#x27;ve been there. Many times.</div><br/><div id="42446395" class="c"><input type="checkbox" id="c-42446395" checked=""/><div class="controls bullet"><span class="by">Alupis</span><span>|</span><a href="#42446357">parent</a><span>|</span><a href="#42448048">next</a><span>|</span><label class="collapse" for="c-42446395">[-]</label><label class="expand" for="c-42446395">[7 more]</label></div><br/><div class="children"><div class="content">KV Stores aren&#x27;t magical... and you do need to store this data <i>somewhere</i>.<p>So what&#x27;s different between this (or any of these new-aged Auth services) and something else more traditional? If anything, these new-age services make it easier to access your data if you need to, since you often control the backing database unlike auth0, etc.<p>Both DynamoDB and Cloudflare KV are queriable.<p>I guess I don&#x27;t understand the negativity in your comment. If anything, your complaint sounds like an issue you and your team cooked up on your own.</div><br/><div id="42447703" class="c"><input type="checkbox" id="c-42447703" checked=""/><div class="controls bullet"><span class="by">victor106</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42446395">parent</a><span>|</span><a href="#42446766">next</a><span>|</span><label class="collapse" for="c-42447703">[-]</label><label class="expand" for="c-42447703">[1 more]</label></div><br/><div class="children"><div class="content">&gt; since you often control the backing database unlike auth0, etc.<p>Auth0 has an option where you can use your own database for identities</div><br/></div></div><div id="42446766" class="c"><input type="checkbox" id="c-42446766" checked=""/><div class="controls bullet"><span class="by">skywhopper</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42446395">parent</a><span>|</span><a href="#42447703">prev</a><span>|</span><a href="#42448048">next</a><span>|</span><label class="collapse" for="c-42446766">[-]</label><label class="expand" for="c-42446766">[5 more]</label></div><br/><div class="children"><div class="content">I don’t think it’s the architecture or technology the commenter is reacting to, it’s this line: “You should never need to directly access any data that is stored in there.”<p>Statements like that are a <i>huge</i> red flag that the designers of the product are not particularly experienced with operating this type of system at meaningful scale.</div><br/><div id="42446856" class="c"><input type="checkbox" id="c-42446856" checked=""/><div class="controls bullet"><span class="by">Alupis</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42446766">parent</a><span>|</span><a href="#42448048">next</a><span>|</span><label class="collapse" for="c-42446856">[-]</label><label class="expand" for="c-42446856">[4 more]</label></div><br/><div class="children"><div class="content">Eh, the technology stack they discuss is directly accessible, though.<p>I read this as an advertisement, meaning if everything it working well you don&#x27;t need to manage the database. Which is probably how it works 99% of the time in fairness.</div><br/><div id="42447245" class="c"><input type="checkbox" id="c-42447245" checked=""/><div class="controls bullet"><span class="by">inopinatus</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42446856">parent</a><span>|</span><a href="#42448014">next</a><span>|</span><label class="collapse" for="c-42447245">[-]</label><label class="expand" for="c-42447245">[2 more]</label></div><br/><div class="children"><div class="content">The circumstances are immaterial; if the creators of a system are blasé enough to imagine you’ll neither need nor want to manage or query the underlying data storage, then they’re telegraphing naiveté and inexperience. Capacity, throughput, latency, consistency concerns exist in any nontrivial system and the pointy end&#x2F;bottleneck of these is very often at the level of persistence. Auth services can add privacy and integrity to that pile. And so on. Consequently, glossing over it with a handwave is a bright red flag.</div><br/><div id="42448302" class="c"><input type="checkbox" id="c-42448302" checked=""/><div class="controls bullet"><span class="by">IgorPartola</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42447245">parent</a><span>|</span><a href="#42448014">next</a><span>|</span><label class="collapse" for="c-42448302">[-]</label><label class="expand" for="c-42448302">[1 more]</label></div><br/><div class="children"><div class="content">To me this statement read very differently. I read it as saying that the amount of state is small and portable enough that I wouldn’t have to worry about scalability issues or be married to a particular database product. I think the original complaint about it is overly critical and nit picking.</div><br/></div></div></div></div><div id="42448014" class="c"><input type="checkbox" id="c-42448014" checked=""/><div class="controls bullet"><span class="by">pixl97</span><span>|</span><a href="#42446357">root</a><span>|</span><a href="#42446856">parent</a><span>|</span><a href="#42447245">prev</a><span>|</span><a href="#42448048">next</a><span>|</span><label class="collapse" for="c-42448014">[-]</label><label class="expand" for="c-42448014">[1 more]</label></div><br/><div class="children"><div class="content">99% of the time is a rather high rate of failure
.. 1% of a year is still over 3 days. 1% of a million is still a lot of incidents</div><br/></div></div></div></div></div></div></div></div><div id="42448048" class="c"><input type="checkbox" id="c-42448048" checked=""/><div class="controls bullet"><span class="by">pluto_modadic</span><span>|</span><a href="#42446357">parent</a><span>|</span><a href="#42446395">prev</a><span>|</span><a href="#42447089">next</a><span>|</span><label class="collapse" for="c-42448048">[-]</label><label class="expand" for="c-42448048">[1 more]</label></div><br/><div class="children"><div class="content">ah. you&#x27;ve had to maintain awful code for an overly complex provider because corporate required extra bells and whistles on their legacy codebase.<p>I think the difference is &#x2F;this intends to be simple&#x2F;, which means they&#x27;ll prioritize reliability over.... whatever the heck your company prioritized.<p>I&#x27;m sorry for your loss, but architectural constraints will help force the project to be simple and effective.<p>You must be so smart. The DB being a KV store does not preclude OpenAuth itself having logging lol.</div><br/></div></div></div></div><div id="42447089" class="c"><input type="checkbox" id="c-42447089" checked=""/><div class="controls bullet"><span class="by">ash</span><span>|</span><a href="#42446357">prev</a><span>|</span><a href="#42446951">next</a><span>|</span><label class="collapse" for="c-42447089">[-]</label><label class="expand" for="c-42447089">[3 more]</label></div><br/><div class="children"><div class="content">Cool project!<p>OAuth-based auth providers are nice, but they can have a weakness. When you have just one app, OAuth can be overkill: protocol is complex, and users suffer jarring redirects¹.<p>This is not surprising, because OAuth &#x2F; OIDC is fundamentally designed for (at least) three parties that don&#x27;t fully trust each other: user, account provider and an app². But in a single app there are only two parties: user and app itself. Auth and app can fully trust each other, protocol can be simpler, and redirects can be avoided.<p>I&#x27;m curious what OpenAUTH authors think about it.<p>¹ Except for Resource Owner Password Credentials (ROPC) grant type, but it&#x27;s no longer recommended: <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-ietf-oauth-security-topics#section-2.4" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-ietf-oauth-secur...</a><p>² In addition, OAuth is mostly designed for and by account providers, and follows their interests more than interests of app developers.</div><br/><div id="42447902" class="c"><input type="checkbox" id="c-42447902" checked=""/><div class="controls bullet"><span class="by">lstamour</span><span>|</span><a href="#42447089">parent</a><span>|</span><a href="#42446951">next</a><span>|</span><label class="collapse" for="c-42447902">[-]</label><label class="expand" for="c-42447902">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s fair to say that with OAuth the resource owner can choose to display a consent screen or not. For example, when consent is granted already, it can be skipped if the resource owner does not need it. Likewise, Google Workspace and other enterprise services that use OAuth can configure in advance which apps are trusted and thus skip permission grants.<p>Not to say the concern about redirects isn&#x27;t legitimate, but there are other ways of handling this. Even redirects aren&#x27;t necessary if OAuth is implemented in a browser-less or embedded browser fashion, e.g. SFAuthenticationSession for one non-standard example. I haven&#x27;t looked this up in awhile but I believe the OAuth protocol was being extended more and more to other contexts beyond the browser - e.g. code flow or new app-based flows and even QR auth flows for TV or sharing prompts.<p>(Note I am not commenting on OpenAUTH, just OAuth in general. It&#x27;s complex, yes, but not as bad as it might seem at first glance. It&#x27;s just not implemented in a standard way across every provider. Something like PassKeys might one day replace it.)</div><br/><div id="42448765" class="c"><input type="checkbox" id="c-42448765" checked=""/><div class="controls bullet"><span class="by">portaouflop</span><span>|</span><a href="#42447089">root</a><span>|</span><a href="#42447902">parent</a><span>|</span><a href="#42446951">next</a><span>|</span><label class="collapse" for="c-42448765">[-]</label><label class="expand" for="c-42448765">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Even redirects aren&#x27;t necessary if OAuth is implemented in a browser-less or embedded browser fashion, e.g. SFAuthenticationSession<p>Can you please expand on that or give me some hints what to look at? I have never heard of this before and I work with Oauth2 a lot.<p>When I look for SFAuthenticationSession it seems to be specific to Safari and also deprecated.<p>I always share this article because people overimplement OAuth2 for everything, it’s not a hammer: <a href="https:&#x2F;&#x2F;www.ory.sh&#x2F;oauth2-openid-connect-do-you-need-use-cases-examples&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.ory.sh&#x2F;oauth2-openid-connect-do-you-need-use-cas...</a></div><br/></div></div></div></div></div></div><div id="42446951" class="c"><input type="checkbox" id="c-42446951" checked=""/><div class="controls bullet"><span class="by">sedatk</span><span>|</span><a href="#42447089">prev</a><span>|</span><a href="#42446784">next</a><span>|</span><label class="collapse" for="c-42446951">[-]</label><label class="expand" for="c-42446951">[3 more]</label></div><br/><div class="children"><div class="content">Can we not call any authentication scheme&#x2F;protocol&#x2F;service starting with &quot;Open&quot; and even &quot;O&quot; anymore? We already have OAuth, OATH, OpenID, OpenIDConnect, and Okta; it&#x27;s getting out of hand.</div><br/><div id="42447008" class="c"><input type="checkbox" id="c-42447008" checked=""/><div class="controls bullet"><span class="by">jzelinskie</span><span>|</span><a href="#42446951">parent</a><span>|</span><a href="#42446784">next</a><span>|</span><label class="collapse" for="c-42447008">[-]</label><label class="expand" for="c-42447008">[2 more]</label></div><br/><div class="children"><div class="content">&quot;Auth&quot; is also super overloaded. OP is an authentication or AuthN tool which is not the same nor does it encompass authorization or AuthZ. I&#x27;m partial to using the terms &quot;identity&quot; and &quot;permissions&quot; instead.</div><br/><div id="42447269" class="c"><input type="checkbox" id="c-42447269" checked=""/><div class="controls bullet"><span class="by">mstade</span><span>|</span><a href="#42446951">root</a><span>|</span><a href="#42447008">parent</a><span>|</span><a href="#42446784">next</a><span>|</span><label class="collapse" for="c-42447269">[-]</label><label class="expand" for="c-42447269">[1 more]</label></div><br/><div class="children"><div class="content">The example in the video even has the name `authorizer` in the default export, but really it&#x27;s an `authenticator` or `identifyer` or `isThisUserWhoTheySayTheyArer` – not a `shouldTheyHaveAccessizer`.<p>I&#x27;m in total agreement with you but I guess the AuthN&#x2F;AuthZ train left the station ages ago and no one outside of the business of selling these tools actually care. Oh well.. :o)</div><br/></div></div></div></div></div></div><div id="42446784" class="c"><input type="checkbox" id="c-42446784" checked=""/><div class="controls bullet"><span class="by">mooreds</span><span>|</span><a href="#42446951">prev</a><span>|</span><a href="#42446985">next</a><span>|</span><label class="collapse" for="c-42446784">[-]</label><label class="expand" for="c-42446784">[10 more]</label></div><br/><div class="children"><div class="content">Good for them for trying! I&#x27;ve been in the auth space for a few years and am surprised that a stateless AWS lambda for doing the exchange. (At least I haven&#x27;t seen any.) So it is nice to see some serverless innovation.<p>Thoughts from a quick scan:<p>- They support PKCE (yay!)<p>- They suggest storing access tokens in localstorage (boo!)<p>- They support JWKS (yay!)</div><br/><div id="42447735" class="c"><input type="checkbox" id="c-42447735" checked=""/><div class="controls bullet"><span class="by">unscaled</span><span>|</span><a href="#42446784">parent</a><span>|</span><a href="#42447036">next</a><span>|</span><label class="collapse" for="c-42447735">[-]</label><label class="expand" for="c-42447735">[2 more]</label></div><br/><div class="children"><div class="content">- JWT algorithm is not configurable: good!<p>- JWT Algorithm is RS512: uggh.<p>Huge access tokens, slow validation AND bad security at the same time, boy we must be lucky.<p>- Encrypted JWT when saving sensitive information in cookie? Good start...<p>- ... Using Asymmetric encryption? Oh no...<p>- RSA-OAEP: At least it&#x27;s not PKCS#1.5 amirite?<p>- Same RSA key is used for encryption and signature(?) Not great.<p>- Stateful Access Tokens: well...<p>I&#x27;m not sure how I feel about using stateful access tokens here at all. Since there is already a KV dependency, there are some advantages to storing stateful access tokens in the KV, most importantly you can easily revoke the tokens directly by deleting them. Revoking stateless tokens, on the other hand, is quite hard and not something that most web applications would care to implement.<p>The most common trade-off (and indeed, half of the raison d&#x27;être for OAuth 2.0 refresh tokens) is to have a very short-lived (e.g. 5 minutes) stateless access token and a long-lived stateful refresh token (which OpenAUTH already does). Revocation would still come with some delay, but you won&#x27;t be able to use an outdated token for a long time after the user logs out or changes password. This is an acceptable trade-off for many applications, but I&#x27;m not sure if it&#x27;s right to offer it as the only solution in a software package that wants to be generic: many applications will have compliance requirements that could rule out accepting logged out session tokens for such a period.<p>- JWT in any form or manner<p>The elephant in the room. Since JWT allows you to choose your own algorithm and offers some some rather bad options, using JWT can be considered as &quot;Rolling your own crypto Lite&quot;. You have a lot of choices here and if you are not an expert you&#x27;re bound to make some wrong choices: such as the ones I&#x27;ve listed above. If OpenAUTH had used PASETO for its tokens, it wouldn&#x27;t be running into these issues at least since no clearly insecure options are available.<p>If you do use JWT, for the love of all that is good, never stray away from this path:<p>1. For symmetric tokens, use the HS* family of algorithms. That&#x27;s the only available option anyway.<p>2. When using HS256&#x2F;384&#x2F;512, you should use randomly generated secrets from &#x2F;dev&#x2F;urandom [1]. The secret size in bits should be the same size as the HS algorithm bits (i.e. 32 bytes for HS256, 48 bytes for HS384 and 64 bytes for HS512). In any case, you should NEVER use passwords as the HS256&#x2F;384&#x2F;512 algorithm secret.<p>3. Do not use asymmetric tokens unless the there are are multiple token verifying parties which are separate from the token issuer. If the token issuer is the same as the verifier, you should use a symmetric token. If you&#x27;ve got one issuer and one verifier, you should probably still use a symmetric token with a shared secret, since there is no issue of trust. Asymmetric cryptography is always an order of magnitude easier to screw up than symmetric cryptography.<p>4. If you do use asymmetric cryptography, always use Ed25519. If you are forced to use something else for compatibility, use ES256&#x2F;384&#x2F;512. It still has some issues (especially if your random number generator is unreliable), but it&#x27;s still better than RSA. You really want to use Ed25519 though.<p>5. If you want to encrypt JWT, don&#x27;t. JWE is too hard to use correctly, and the only reliably secure option that is usually implemented by libraries (A256GCMKW) is slow and it&#x27;s not very popular so I&#x27;m not sure how much analysis the algorithm (AES Key Wrap) has seen.<p>6. The best and easiest option for encryption if you really must use JWT (and can&#x27;t use PASETO): Just take your payload, encrypt it with NaCl&#x2F;Libsodium (secretbox[2]), base64 encode the result and stuff it inside a JWT claim. This will be faster, easier and more secure than anything JWE can offer.<p>[1] <a href="https:&#x2F;&#x2F;www.latacora.com&#x2F;blog&#x2F;2018&#x2F;04&#x2F;03&#x2F;cryptographic-right-answers&#x2F;#random-ids" rel="nofollow">https:&#x2F;&#x2F;www.latacora.com&#x2F;blog&#x2F;2018&#x2F;04&#x2F;03&#x2F;cryptographic-right...</a><p>[2] <a href="https:&#x2F;&#x2F;libsodium.gitbook.io&#x2F;doc&#x2F;secret-key_cryptography&#x2F;secretbox" rel="nofollow">https:&#x2F;&#x2F;libsodium.gitbook.io&#x2F;doc&#x2F;secret-key_cryptography&#x2F;sec...</a></div><br/><div id="42447877" class="c"><input type="checkbox" id="c-42447877" checked=""/><div class="controls bullet"><span class="by">unscaled</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447735">parent</a><span>|</span><a href="#42447036">next</a><span>|</span><label class="collapse" for="c-42447877">[-]</label><label class="expand" for="c-42447877">[1 more]</label></div><br/><div class="children"><div class="content">There is already a closed ticket about JWT usage. Unfortunately the ticket author did not point at any specific weaknesses besides revocation to which the app author answered:<p>&quot;JWTs aren&#x27;t innately problematic - they come with the tradeoff of not being able to be revoked. The ideal setup is setting a short expiry time on the access_token (eg 5min) and setting a long expiry on the refresh token (which is not a JWT and can be revoked).&quot;<p>The fact that this tradeoff is acceptable to some apps is correct. But I disagree that JWT tokens aren&#x27;t innately problematic. Stateless tokens aren&#x27;t innately problematic. Even stateless access tokens aren&#x27;t innately problematic if you&#x27;re willing to live with the tradeoffs (revocation delay or a centralized&#x2F;propagated revocation list). But JWT <i>is</i> innately problematic, in the most literal sense possibly: the very nature of the JWT specification is to permit the largest amount of cryptographic flexibility including supporting (and even recommending) insecure cryptographic algorithms, that may cause security problems if chosen. In other words: it is innately (= in its very nature) problematic (= has the potential of causing problems). JWT is the poster child of being &quot;innately problematic&quot;.<p>I think the app author confuses &quot;innately problematic&quot; with &quot;impossible to implement securely&quot;. JWT is not impossible to implement securely. After all, even SAML with the nefarious XMLdsig is possible to implement securely and we do, in fact, have secure implementations of SAML. The real problem is that JWT is <i>hard</i> to implement securely if you do not have the right expertise. And OpenAUTH is giving us (yet another) clear example where the JWT implementation is less than ideal.<p>I will be the first to admit that I am not expert enough to know how to hack this kind of cryptography, but I am also not good enough to prove that it is safe to use.</div><br/></div></div></div></div><div id="42447036" class="c"><input type="checkbox" id="c-42447036" checked=""/><div class="controls bullet"><span class="by">igor47</span><span>|</span><a href="#42446784">parent</a><span>|</span><a href="#42447735">prev</a><span>|</span><a href="#42446985">next</a><span>|</span><label class="collapse" for="c-42447036">[-]</label><label class="expand" for="c-42447036">[7 more]</label></div><br/><div class="children"><div class="content">What&#x27;s wrong with tokens in local storage?</div><br/><div id="42447130" class="c"><input type="checkbox" id="c-42447130" checked=""/><div class="controls bullet"><span class="by">ash</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447036">parent</a><span>|</span><a href="#42447136">next</a><span>|</span><label class="collapse" for="c-42447130">[-]</label><label class="expand" for="c-42447130">[5 more]</label></div><br/><div class="children"><div class="content">Less secure that HttpOnly cookies, which are not accessible by third-party JavaScript. LocalStorage also doesn&#x27;t have automatic expiration.</div><br/><div id="42447300" class="c"><input type="checkbox" id="c-42447300" checked=""/><div class="controls bullet"><span class="by">zsims</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447130">parent</a><span>|</span><a href="#42447136">next</a><span>|</span><label class="collapse" for="c-42447300">[-]</label><label class="expand" for="c-42447300">[4 more]</label></div><br/><div class="children"><div class="content">Tradeoff is all the edge cases of cookies, CSRF etc. It&#x27;s not a simple &quot;cookies are better&quot;</div><br/><div id="42447782" class="c"><input type="checkbox" id="c-42447782" checked=""/><div class="controls bullet"><span class="by">mooreds</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447300">parent</a><span>|</span><a href="#42447397">next</a><span>|</span><label class="collapse" for="c-42447782">[-]</label><label class="expand" for="c-42447782">[1 more]</label></div><br/><div class="children"><div class="content">But when you can use them, cookies are demonstrably better. XSS is the main argument against localstorage. Even this article[0], which pillories cookies, starts off with:<p><pre><code>   ...if your website is vulnerable to XSS attacks, where a third party can run arbitrary scripts, your users’ tokens can be easily stolen [when stored in localstorage].
</code></pre>
The reasons to avoid cookies:<p>* APIs might require an authorization header in the browser fetch call.<p>* APIs might live on a different domain, rendering cookies useless.<p>CSRF is a danger, that&#x27;s true. can be worked around. My understanding is that XSS has a wider scope and that many modern frameworks come with CSRF protection built in[1]. Whereas XSS is a risk any time you (or anyone in the future) includes any JS code on your website.<p>0: <a href="https:&#x2F;&#x2F;pilcrowonpaper.com&#x2F;blog&#x2F;local-storage-cookies&#x2F;" rel="nofollow">https:&#x2F;&#x2F;pilcrowonpaper.com&#x2F;blog&#x2F;local-storage-cookies&#x2F;</a><p>1: <a href="https:&#x2F;&#x2F;cheatsheetseries.owasp.org&#x2F;cheatsheets&#x2F;Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" rel="nofollow">https:&#x2F;&#x2F;cheatsheetseries.owasp.org&#x2F;cheatsheets&#x2F;Cross-Site_Re...</a></div><br/></div></div><div id="42447397" class="c"><input type="checkbox" id="c-42447397" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447300">parent</a><span>|</span><a href="#42447782">prev</a><span>|</span><a href="#42447974">next</a><span>|</span><label class="collapse" for="c-42447397">[-]</label><label class="expand" for="c-42447397">[1 more]</label></div><br/><div class="children"><div class="content">enable same-site??<p>if you&#x27;re doing things not from same-site, I&#x27;d posit you&#x27;re doing something I want blocked anyways.</div><br/></div></div><div id="42447974" class="c"><input type="checkbox" id="c-42447974" checked=""/><div class="controls bullet"><span class="by">unscaled</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447300">parent</a><span>|</span><a href="#42447397">prev</a><span>|</span><a href="#42447136">next</a><span>|</span><label class="collapse" for="c-42447974">[-]</label><label class="expand" for="c-42447974">[1 more]</label></div><br/><div class="children"><div class="content">CSRF is not as big of an issue as it used to be, and when it is an issue it can be solved more easily and comprehensively than XSS:<p>1. The default value for SameSite attribute is now &quot;Lax&quot; in most browsers. This means that unless you explicitly set your authentication cookies to SameSite=None (and why would you?), you are generally not vulnerable to cookie-based CSRF (other forms of CSRF are still possible, but not relevant to the issue of storing tokens in local storage or cookies).<p>2. Most modern SSR and hybrid frameworks have built-in CSRF protection for forms and you have to explicitly disable that protection in order to be vulnerable to CSRF.<p>3. APIs which support cookie authentication for SPAs can be deployed on another domain and use CORS headers to prevent CSRF, even with SameSite=None cookies.<p>On the other hand, there are no mechanisms which offer comprehensive protection from XSS. It&#x27;s enough for a single JavaScript dependency that you use to have a bug and it&#x27;s game over.<p>For this reason, OAuth 2.0 for Browser-Based Applications (draft)[1] strongly recommends using a HttpOnly cookie to store the access token:<p>&quot;This architecture (using a BFF with HttpOnly cookies) is strongly recommended for business applications, sensitive applications, and applications that handle personal data.&quot;<p>With regards to storing access tokens and refresh tokens on local storage without any protection it says:<p>&quot;To summarize, the architecture of a browser-based OAuth client application is straightforward, but results in a significant increase in the attack surface of the application. The attacker is not only able to hijack the client, but also to extract a full-featured set of tokens from the browser-based application.This architecture is not recommended for business applications, sensitive applications, and applications that handle personal data.&quot;<p>And this is what it has to say about storing the refresh token in a cookie, while keeping the access token accessible to JavaScript:<p>&quot;When considering a token-mediating backend architecture (= storing only access token in local storage), it is strongly recommended to evaluate if adopting a full BFF (storing all tokens in a cookie) as discussed in Section 6.1 is a viable alternative. Only when the use cases or system requirements would prevent the use of a proxying BFF should the token-mediating backend be considered over a full BFF.&quot;<p>In short, the official OAuth WG stance is very clear:<p>1. HttpOnly cookies ARE better in terms of security.
2. Storing Refresh Tokens in local storage is only recommended for low-security use cases (no personal data, no enterprise compliance requirements).
3. Storing short-lived Access Tokens in local storage should only be considered if there are technical complexities that prevent you from using only cookies.<p>[1] <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-ietf-oauth-browser-based-apps#name-summary" rel="nofollow">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;draft-ietf-oauth-brows...</a></div><br/></div></div></div></div></div></div><div id="42447136" class="c"><input type="checkbox" id="c-42447136" checked=""/><div class="controls bullet"><span class="by">rcaught</span><span>|</span><a href="#42446784">root</a><span>|</span><a href="#42447036">parent</a><span>|</span><a href="#42447130">prev</a><span>|</span><a href="#42446985">next</a><span>|</span><label class="collapse" for="c-42447136">[-]</label><label class="expand" for="c-42447136">[1 more]</label></div><br/><div class="children"><div class="content">Malicious access to these tokens is malicious access to the service.</div><br/></div></div></div></div></div></div><div id="42446985" class="c"><input type="checkbox" id="c-42446985" checked=""/><div class="controls bullet"><span class="by">ptcrash</span><span>|</span><a href="#42446784">prev</a><span>|</span><a href="#42447202">next</a><span>|</span><label class="collapse" for="c-42446985">[-]</label><label class="expand" for="c-42446985">[1 more]</label></div><br/><div class="children"><div class="content">Happy to see the effort! Fresh blood in the authn space is always welcomed.<p>Without rehashing the other good points commenters have made already, I’ll just say that every project starts out immature. What makes a project great is how willing the maintainers will be to grow along with the project and incorporate feedback. I’m excited to see future evolutions of this one.</div><br/></div></div><div id="42447202" class="c"><input type="checkbox" id="c-42447202" checked=""/><div class="controls bullet"><span class="by">xupybd</span><span>|</span><a href="#42446985">prev</a><span>|</span><a href="#42447082">next</a><span>|</span><label class="collapse" for="c-42447202">[-]</label><label class="expand" for="c-42447202">[5 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;www.keycloak.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.keycloak.org&#x2F;</a> is pretty great too, if you need a little more.</div><br/><div id="42447266" class="c"><input type="checkbox" id="c-42447266" checked=""/><div class="controls bullet"><span class="by">pestaa</span><span>|</span><a href="#42447202">parent</a><span>|</span><a href="#42447082">next</a><span>|</span><label class="collapse" for="c-42447266">[-]</label><label class="expand" for="c-42447266">[4 more]</label></div><br/><div class="children"><div class="content">What do you mean a little more? More like several truckloads more. :) Keycloak is great, but it&#x27;s a beast.</div><br/><div id="42448063" class="c"><input type="checkbox" id="c-42448063" checked=""/><div class="controls bullet"><span class="by">Aeolun</span><span>|</span><a href="#42447202">root</a><span>|</span><a href="#42447266">parent</a><span>|</span><a href="#42447313">next</a><span>|</span><label class="collapse" for="c-42448063">[-]</label><label class="expand" for="c-42448063">[2 more]</label></div><br/><div class="children"><div class="content">Keycloak is a lot less than some other OAuth servers though.</div><br/><div id="42448191" class="c"><input type="checkbox" id="c-42448191" checked=""/><div class="controls bullet"><span class="by">xupybd</span><span>|</span><a href="#42447202">root</a><span>|</span><a href="#42448063">parent</a><span>|</span><a href="#42447313">next</a><span>|</span><label class="collapse" for="c-42448191">[-]</label><label class="expand" for="c-42448191">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s it missing?</div><br/></div></div></div></div><div id="42447313" class="c"><input type="checkbox" id="c-42447313" checked=""/><div class="controls bullet"><span class="by">xupybd</span><span>|</span><a href="#42447202">root</a><span>|</span><a href="#42447266">parent</a><span>|</span><a href="#42448063">prev</a><span>|</span><a href="#42447082">next</a><span>|</span><label class="collapse" for="c-42447313">[-]</label><label class="expand" for="c-42447313">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a typical speech pattern here in NZ. A little more when you mean a lot. Sorry I forget to translate for international audiences. :)</div><br/></div></div></div></div></div></div><div id="42447082" class="c"><input type="checkbox" id="c-42447082" checked=""/><div class="controls bullet"><span class="by">XCSme</span><span>|</span><a href="#42447202">prev</a><span>|</span><a href="#42446364">next</a><span>|</span><label class="collapse" for="c-42447082">[-]</label><label class="expand" for="c-42447082">[1 more]</label></div><br/><div class="children"><div class="content">Is this like a Passport.js alternative?<p><a href="https:&#x2F;&#x2F;www.passportjs.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.passportjs.org&#x2F;</a></div><br/></div></div><div id="42446364" class="c"><input type="checkbox" id="c-42446364" checked=""/><div class="controls bullet"><span class="by">sontek</span><span>|</span><a href="#42447082">prev</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446364">[-]</label><label class="expand" for="c-42446364">[8 more]</label></div><br/><div class="children"><div class="content">Does it only support username&#x2F;password + OAuth?   I didn&#x27;t see much information on if it supports SAML.   I&#x27;m interested in how it compares to things like <a href="https:&#x2F;&#x2F;github.com&#x2F;zitadel&#x2F;zitadel">https:&#x2F;&#x2F;github.com&#x2F;zitadel&#x2F;zitadel</a> and <a href="https:&#x2F;&#x2F;github.com&#x2F;ory&#x2F;kratos">https:&#x2F;&#x2F;github.com&#x2F;ory&#x2F;kratos</a></div><br/><div id="42446436" class="c"><input type="checkbox" id="c-42446436" checked=""/><div class="controls bullet"><span class="by">reactordev</span><span>|</span><a href="#42446364">parent</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446436">[-]</label><label class="expand" for="c-42446436">[7 more]</label></div><br/><div class="children"><div class="content">It looks like it’s strictly for OAuth 2.0 flows. No SAML, no ldap, no Kerberos, so it’s just a basic key exchange for those who can’t be bothered. Auth is hard and consumes too much sprint cycles, as is, so anything is welcome in this space. I personally will stick to keycloak.</div><br/><div id="42446488" class="c"><input type="checkbox" id="c-42446488" checked=""/><div class="controls bullet"><span class="by">Alupis</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446436">parent</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446488">[-]</label><label class="expand" for="c-42446488">[6 more]</label></div><br/><div class="children"><div class="content">The people who require SAML, LDAP and Kerberos are often catering towards a specific userbase (ie. internal business customers).<p>The needs for Auth &amp; Auth are different for public-facing apps&#x2F;services. It&#x27;s not entirely unsurprising many newer Auth solutions don&#x27;t even attempt to implement SAML et al.<p>With all of the recent <i>steep</i> price hikes in the Auth SaaS space, it seems it&#x27;s becoming increasingly important to actually <i>own</i> your user account data. By own, I mean have access to the database and be capable of migrating it somewhere else (even at a large inconvenience) if necessary.<p>KeyCloak seems awesome for this - but I am liking the &quot;explosion&quot; of new Auth providers that seem to be popping up everywhere these days.</div><br/><div id="42446649" class="c"><input type="checkbox" id="c-42446649" checked=""/><div class="controls bullet"><span class="by">mooreds</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446488">parent</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446649">[-]</label><label class="expand" for="c-42446649">[5 more]</label></div><br/><div class="children"><div class="content">Disclosure: I work for FusionAuth.<p>You should check out FusionAuth if you are looking at KeyCloak. We play in a similar same space (self-hostable, support for SAML, OIDC, OAuth2). I&#x27;d say KeyCloak has wider coverage for some of the more esoteric standards and is open source while we have a more modern API, dev-friendly docs, and great (paid) support.<p>FusionAuth is not open source, but you can self-host it for free and own your data[0]. Or let us run it for you. In the latter case, you still own your data--get it all from our cloud if you want to migrate.<p>I&#x27;m proud that the team wrote an offboarding doc[1]. It&#x27;s your darn customer data, and every provider should support out-migration.<p>0: <a href="https:&#x2F;&#x2F;fusionauth.io&#x2F;download" rel="nofollow">https:&#x2F;&#x2F;fusionauth.io&#x2F;download</a><p>1: <a href="https:&#x2F;&#x2F;fusionauth.io&#x2F;docs&#x2F;lifecycle&#x2F;migrate-users&#x2F;offboard" rel="nofollow">https:&#x2F;&#x2F;fusionauth.io&#x2F;docs&#x2F;lifecycle&#x2F;migrate-users&#x2F;offboard</a></div><br/><div id="42446813" class="c"><input type="checkbox" id="c-42446813" checked=""/><div class="controls bullet"><span class="by">efitz</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446649">parent</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446813">[-]</label><label class="expand" for="c-42446813">[4 more]</label></div><br/><div class="children"><div class="content">Maybe I’m not your target audience but Yikes! Your pricing was unexpectedly high.<p>Also it’s not clear what premium features were or why MFA is a premium feature but only available at top tiers.</div><br/><div id="42447833" class="c"><input type="checkbox" id="c-42447833" checked=""/><div class="controls bullet"><span class="by">mooreds</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446813">parent</a><span>|</span><a href="#42446914">next</a><span>|</span><label class="collapse" for="c-42447833">[-]</label><label class="expand" for="c-42447833">[1 more]</label></div><br/><div class="children"><div class="content">Hiya, thanks for the response.<p>Our pricing is kinda complicated as discussed before[0]. We&#x27;re working on simplifying things.<p>Here&#x27;s a list of features[1] which hopefully are clearer about what you get on what plans.<p>Where things get complex is that we sell both features&#x2F;support and hosting, and you can buy both, either or neither from us. Our hosting isn&#x27;t multi-tenant SaaS, but rather dedicated infrastructure providing network and database level isolation. That means what we offer is different than say a Stytch that offers a multi-tenant logical isolation.<p>Most folks that are price conscious run it themselves on EC2 or Render or elsewhere[2].<p>0: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41269197">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=41269197</a><p>1: <a href="https:&#x2F;&#x2F;fusionauth.io&#x2F;feature-list" rel="nofollow">https:&#x2F;&#x2F;fusionauth.io&#x2F;feature-list</a><p>2: Here&#x27;s render instructions: <a href="https:&#x2F;&#x2F;fusionauth.io&#x2F;blog&#x2F;fusionauth-on-render" rel="nofollow">https:&#x2F;&#x2F;fusionauth.io&#x2F;blog&#x2F;fusionauth-on-render</a></div><br/></div></div><div id="42446914" class="c"><input type="checkbox" id="c-42446914" checked=""/><div class="controls bullet"><span class="by">Alupis</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446813">parent</a><span>|</span><a href="#42447833">prev</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42446914">[-]</label><label class="expand" for="c-42446914">[2 more]</label></div><br/><div class="children"><div class="content">To be fair, the pricing there is not out of line with other hosted SaaS auth services. The segmentation is also not out of line either.<p>However, the paywall (for all of these auth services) ends up being quite steep for the couple features that matter for a non-hobby app, such as custom domain name and MFA (totp or hooking up to an external SMS service). Unfortunately it makes these features expensive when you are starting out (paying ~$40 a month for only a handful of users, sort of thing...).<p>It is nice to see more and more of these services allow you to take out your data and migrate though - including the self-hosted options. Being vendor-locked for your user account data is a really big deal in my opinion. It often means having zero good options if the vendor decides to rake you over the coals one day.</div><br/><div id="42447854" class="c"><input type="checkbox" id="c-42447854" checked=""/><div class="controls bullet"><span class="by">mooreds</span><span>|</span><a href="#42446364">root</a><span>|</span><a href="#42446914">parent</a><span>|</span><a href="#42448125">next</a><span>|</span><label class="collapse" for="c-42447854">[-]</label><label class="expand" for="c-42447854">[1 more]</label></div><br/><div class="children"><div class="content">Hiya, thanks for the feedback.<p>TOTP based MFA is included in the free, community plan.<p>As I mentioned elsewhere, for folks who are price conscious, self-hosting is the better option.<p>But I get it! The story I tell internally all the time is that when I was working at a startup, our entirely hosting bill was on the order of $200&#x2F;month (on Heroku; it was a while ago). There&#x27;s no way we would have paid $350 just for an identity solution. But we would probably have chosen to host FusionAuth community on heroku for much much less and operated it ourselves.<p>Anyway, thanks for your feedback.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="42448125" class="c"><input type="checkbox" id="c-42448125" checked=""/><div class="controls bullet"><span class="by">vivzkestrel</span><span>|</span><a href="#42446364">prev</a><span>|</span><a href="#42448341">next</a><span>|</span><label class="collapse" for="c-42448125">[-]</label><label class="expand" for="c-42448125">[1 more]</label></div><br/><div class="children"><div class="content">How does this compare to supertokens <a href="https:&#x2F;&#x2F;supertokens.com&#x2F;">https:&#x2F;&#x2F;supertokens.com&#x2F;</a> that supports fastify express, hono, bun, koa, nuxt, react, vue, angular with email password + social login + OTP based login + single sign on all wrapped in a self hostable nice package?</div><br/></div></div><div id="42448341" class="c"><input type="checkbox" id="c-42448341" checked=""/><div class="controls bullet"><span class="by">thayne</span><span>|</span><a href="#42448125">prev</a><span>|</span><a href="#42447768">next</a><span>|</span><label class="collapse" for="c-42448341">[-]</label><label class="expand" for="c-42448341">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m guessing this is for service providers and not identity providers. Just a suggestion, but that could be more clear in the description.</div><br/></div></div><div id="42447768" class="c"><input type="checkbox" id="c-42447768" checked=""/><div class="controls bullet"><span class="by">harrisi</span><span>|</span><a href="#42448341">prev</a><span>|</span><a href="#42446967">next</a><span>|</span><label class="collapse" for="c-42447768">[-]</label><label class="expand" for="c-42447768">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;youtu.be&#x2F;mKKx8uXw5ak" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;mKKx8uXw5ak</a></div><br/></div></div></div></div></div></div></div></body></html>