<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1738400470282" as="style"/><link rel="stylesheet" href="styles.css?v=1738400470282"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://noelrappin.com/blog/2025/01/better-know-a-ruby-thing-singleton-classes/">Better Know a Ruby Thing: Singleton Classes</a> <span class="domain">(<a href="https://noelrappin.com">noelrappin.com</a>)</span></div><div class="subtext"><span>mooreds</span> | <span>19 comments</span></div><br/><div><div id="42891335" class="c"><input type="checkbox" id="c-42891335" checked=""/><div class="controls bullet"><span class="by">empw</span><span>|</span><a href="#42891493">next</a><span>|</span><label class="collapse" for="c-42891335">[-]</label><label class="expand" for="c-42891335">[8 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t written any ruby for over a decade and a half, when ruby 2.x was still on the horizon. But I  do know the source of &quot;eigenclass&quot;. It was first jokingly used in an odd instructional programming book &#x2F; web comic &#x2F; experimental art piece by &quot;why the lucky stiff&quot; who was briefly prominent in ruby-land then erased himself from the internet. It&#x27;s funny that it has now become an established term of art for Ruby people.</div><br/><div id="42896684" class="c"><input type="checkbox" id="c-42896684" checked=""/><div class="controls bullet"><span class="by">lloeki</span><span>|</span><a href="#42891335">parent</a><span>|</span><a href="#42896646">next</a><span>|</span><label class="collapse" for="c-42896684">[-]</label><label class="expand" for="c-42896684">[1 more]</label></div><br/><div class="children"><div class="content">Sunny Ripert paid a wonderful tribute to _why as a talk at ParisRB 2020.<p><a href="https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=njr39cVU7d0" rel="nofollow">https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?v=njr39cVU7d0</a><p>It was not so much aimed at the &quot;old guard&quot; (those that knew about _why) as the &quot;next generation&quot; (those that never heard of him).<p>At some point Sunny asked to raise hands if one knew about _why, maybe half did, tops.<p>By the end of the talk the emotion in the room was <i>palpable</i>.</div><br/></div></div><div id="42896646" class="c"><input type="checkbox" id="c-42896646" checked=""/><div class="controls bullet"><span class="by">Lio</span><span>|</span><a href="#42891335">parent</a><span>|</span><a href="#42896684">prev</a><span>|</span><a href="#42893337">next</a><span>|</span><label class="collapse" for="c-42896646">[-]</label><label class="expand" for="c-42896646">[2 more]</label></div><br/><div class="children"><div class="content">I still refer to the * operator as “splat” after a presentation I saw him give in London in 2007.<p>_why is most definitely gone but not forgotten.</div><br/><div id="42896813" class="c"><input type="checkbox" id="c-42896813" checked=""/><div class="controls bullet"><span class="by">riffraff</span><span>|</span><a href="#42891335">root</a><span>|</span><a href="#42896646">parent</a><span>|</span><a href="#42893337">next</a><span>|</span><label class="collapse" for="c-42896813">[-]</label><label class="expand" for="c-42896813">[1 more]</label></div><br/><div class="children"><div class="content">I thought <i>splat was actually the &quot;official&quot; usage these days, tho I think some people call it </i>spread</div><br/></div></div></div></div><div id="42893337" class="c"><input type="checkbox" id="c-42893337" checked=""/><div class="controls bullet"><span class="by">nixpulvis</span><span>|</span><a href="#42891335">parent</a><span>|</span><a href="#42896646">prev</a><span>|</span><a href="#42895482">next</a><span>|</span><label class="collapse" for="c-42893337">[-]</label><label class="expand" for="c-42893337">[2 more]</label></div><br/><div class="children"><div class="content">I remember reading WPGTR in college. Really inspired me to play around and learn the language. I&#x27;ve always kept my printed copy in a safe place.</div><br/><div id="42895725" class="c"><input type="checkbox" id="c-42895725" checked=""/><div class="controls bullet"><span class="by">adriand</span><span>|</span><a href="#42891335">root</a><span>|</span><a href="#42893337">parent</a><span>|</span><a href="#42895482">next</a><span>|</span><label class="collapse" for="c-42895725">[-]</label><label class="expand" for="c-42895725">[1 more]</label></div><br/><div class="children"><div class="content">I read it after college when I first started working with Rails 1 after I joined a friend’s company. Funny to think that was almost two decades ago. I still remember the quirky art style, although I will admit to preferring a more prosaic book when I  learned the language. But it was a fun community and the sense of creativity was really apparent.</div><br/></div></div></div></div><div id="42895482" class="c"><input type="checkbox" id="c-42895482" checked=""/><div class="controls bullet"><span class="by">insane_dreamer</span><span>|</span><a href="#42891335">parent</a><span>|</span><a href="#42893337">prev</a><span>|</span><a href="#42893952">next</a><span>|</span><label class="collapse" for="c-42895482">[-]</label><label class="expand" for="c-42895482">[1 more]</label></div><br/><div class="children"><div class="content">loved _why’s stuff back when he was still around.</div><br/></div></div><div id="42893952" class="c"><input type="checkbox" id="c-42893952" checked=""/><div class="controls bullet"><span class="by">KerrAvon</span><span>|</span><a href="#42891335">parent</a><span>|</span><a href="#42895482">prev</a><span>|</span><a href="#42891493">next</a><span>|</span><label class="collapse" for="c-42893952">[-]</label><label class="expand" for="c-42893952">[1 more]</label></div><br/><div class="children"><div class="content">_why&#x27;s influence is indelible.</div><br/></div></div></div></div><div id="42891493" class="c"><input type="checkbox" id="c-42891493" checked=""/><div class="controls bullet"><span class="by">lcnPylGDnU4H9OF</span><span>|</span><a href="#42891335">prev</a><span>|</span><a href="#42890956">next</a><span>|</span><label class="collapse" for="c-42891493">[-]</label><label class="expand" for="c-42891493">[2 more]</label></div><br/><div class="children"><div class="content">&gt; There are at least three ways to define a method in a Ruby singleton class.<p>It&#x27;s worth noting that two of such ways will, perhaps unintuitively, ignore the `private` keyword.<p><pre><code>  private
  def self.foo
    # ...
  end

  def x.foo
    # ...
  end
</code></pre>
That will define a public method `:foo` on each of `self`&#x27;s and `x`&#x27;s singleton classes. If you want the method to be private, either 1) explicitly make the method private using `Class#private` or `Class#private_class_method` or 2) use the `class &lt;&lt; self` (or `class &lt;&lt; x`) syntax in order for the `private` keyword to work as expected.<p><pre><code>  private_class_method def self.foo
    # ...
  end

  def self.foo
    # ...
  end
  private_class_method :foo # `def` will return a symbol of the defined method name so the above syntax is usually sufficient.

  def x.foo
    # ...
  end
  x.singleton_class.send :private, :foo # Class#private is a private method(!) so must be called using Object#send.

  class &lt;&lt; x
  private
    def foo
      # ...
    end
  end
</code></pre>
&gt; The eternal question… Why is Ruby like this?<p>Joy! :) I&#x27;m pretty sure matz would agree.</div><br/><div id="42895801" class="c"><input type="checkbox" id="c-42895801" checked=""/><div class="controls bullet"><span class="by">dragonwriter</span><span>|</span><a href="#42891493">parent</a><span>|</span><a href="#42890956">next</a><span>|</span><label class="collapse" for="c-42895801">[-]</label><label class="expand" for="c-42895801">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s worth noting that two of such ways will, perhaps unintuitively, ignore the `private` keyword.<p>No, this explanation is wrong, because <i>there isn&#x27;t actually a `private` keyword</i>, only the Module#private method [0] which, when called with no arguments, changes the visibility of future methods defined in the target module.<p>Those examples call the `Module#private` method with no arguments in one context changing the visibility of future methods defined in that context, and then use an explicit prefix to <i>define methods in a different context</i>.<p>When you don&#x27;t forget that `private` is a private instance method on Module and <i>not</i> a keyword, the behavior is much simpler to understand.<p>[0] <a href="https:&#x2F;&#x2F;ruby-doc.org&#x2F;3.4.1&#x2F;Module.html#method-i-private" rel="nofollow">https:&#x2F;&#x2F;ruby-doc.org&#x2F;3.4.1&#x2F;Module.html#method-i-private</a></div><br/></div></div></div></div><div id="42890956" class="c"><input type="checkbox" id="c-42890956" checked=""/><div class="controls bullet"><span class="by">xutopia</span><span>|</span><a href="#42891493">prev</a><span>|</span><a href="#42893313">next</a><span>|</span><label class="collapse" for="c-42890956">[-]</label><label class="expand" for="c-42890956">[1 more]</label></div><br/><div class="children"><div class="content">I love it when someone dives a bit deeper behind something pretty common for most Ruby devs.  It&#x27;s actually a really elegant pattern that is used and it&#x27;s everywhere in Ruby.</div><br/></div></div><div id="42893313" class="c"><input type="checkbox" id="c-42893313" checked=""/><div class="controls bullet"><span class="by">Lammy</span><span>|</span><a href="#42890956">prev</a><span>|</span><a href="#42893495">next</a><span>|</span><label class="collapse" for="c-42893313">[-]</label><label class="expand" for="c-42893313">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What we’ve been calling “class methods” are actually instance methods of the metaclass.<p>This also shows up if you ever want to use a Refinement on a “class method”. The thing you must `refine` is the `singleton_class`.<p>Here&#x27;s a live example from my UUID library where I refine `Time::now` and one of my own utility class&#x27; methods to test the time-went-backwards and network-card-changed cases for incrementing the sequence value while generating time-based UUIDs: <a href="https:&#x2F;&#x2F;github.com&#x2F;okeeblow&#x2F;DistorteD&#x2F;blob&#x2F;3e9bbc744479afd3eb27c37933d78721b0887c77&#x2F;Globe%20Glitter&#x2F;lib&#x2F;globeglitter&#x2F;chrono_seeker.rb#L9-L26">https:&#x2F;&#x2F;github.com&#x2F;okeeblow&#x2F;DistorteD&#x2F;blob&#x2F;3e9bbc744479afd3e...</a></div><br/></div></div><div id="42893495" class="c"><input type="checkbox" id="c-42893495" checked=""/><div class="controls bullet"><span class="by">mrinterweb</span><span>|</span><a href="#42893313">prev</a><span>|</span><a href="#42895742">next</a><span>|</span><label class="collapse" for="c-42893495">[-]</label><label class="expand" for="c-42893495">[1 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t forget about the Singleton module (&quot;include Singleton&quot;). This one trips me up in terms of what is being referred to as a &quot;singleton&quot;. This is more of an singleton class instance where there can only be only one class instance per-class. <a href="https:&#x2F;&#x2F;ruby-doc.org&#x2F;3.4.1&#x2F;stdlibs&#x2F;singleton&#x2F;Singleton.html" rel="nofollow">https:&#x2F;&#x2F;ruby-doc.org&#x2F;3.4.1&#x2F;stdlibs&#x2F;singleton&#x2F;Singleton.html</a></div><br/></div></div><div id="42895742" class="c"><input type="checkbox" id="c-42895742" checked=""/><div class="controls bullet"><span class="by">andrekandre</span><span>|</span><a href="#42893495">prev</a><span>|</span><a href="#42893100">next</a><span>|</span><label class="collapse" for="c-42895742">[-]</label><label class="expand" for="c-42895742">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  &gt; In Smalltal, you interact with your code through an code browser that is part of the system.
</code></pre>
small spelling mistake: Smalltal → Smalltalk</div><br/></div></div><div id="42893100" class="c"><input type="checkbox" id="c-42893100" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#42895742">prev</a><span>|</span><a href="#42893653">next</a><span>|</span><label class="collapse" for="c-42893100">[-]</label><label class="expand" for="c-42893100">[1 more]</label></div><br/><div class="children"><div class="content">I have to admit, years back when I learned Ruby I found this syntax to be very bizzare<p><pre><code>  class User
    class &lt;&lt; self
      def create_from_data
      end
    end
  end
</code></pre>
Specifically, this: class &lt;&lt; self<p>But when reading about it, it made sense</div><br/></div></div><div id="42893653" class="c"><input type="checkbox" id="c-42893653" checked=""/><div class="controls bullet"><span class="by">rubyfan</span><span>|</span><a href="#42893100">prev</a><span>|</span><a href="#42890297">next</a><span>|</span><label class="collapse" for="c-42893653">[-]</label><label class="expand" for="c-42893653">[1 more]</label></div><br/><div class="children"><div class="content">Great read, I’ve written several ruby extensions in c and this write up made total sense.</div><br/></div></div><div id="42891974" class="c"><input type="checkbox" id="c-42891974" checked=""/><div class="controls bullet"><span class="by">corytheboyd</span><span>|</span><a href="#42890297">prev</a><span>|</span><label class="collapse" for="c-42891974">[-]</label><label class="expand" for="c-42891974">[1 more]</label></div><br/><div class="children"><div class="content">Went in expecting a basic how-to about the Singleton module, but this is so much more, you clearly know your shit, and I love deep dives like this!</div><br/></div></div></div></div></div></div></div></body></html>