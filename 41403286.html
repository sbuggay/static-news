<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1725094866376" as="style"/><link rel="stylesheet" href="styles.css?v=1725094866376"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://izzys.casa/2024/08/463-python-interpreters/">500 Python Interpreters</a> <span class="domain">(<a href="https://izzys.casa">izzys.casa</a>)</span></div><div class="subtext"><span>SAHChandler</span> | <span>21 comments</span></div><br/><div><div id="41406689" class="c"><input type="checkbox" id="c-41406689" checked=""/><div class="controls bullet"><span class="by">jiggunjer</span><span>|</span><a href="#41404452">next</a><span>|</span><label class="collapse" for="c-41406689">[-]</label><label class="expand" for="c-41406689">[1 more]</label></div><br/><div class="children"><div class="content">So this means modules like concurrent.futures can create a thread pool object (as opposed to processpool) and run in parallel?<p>Or is the functionality as of 3.13 still limited to low level python embedding applications?</div><br/></div></div><div id="41404452" class="c"><input type="checkbox" id="c-41404452" checked=""/><div class="controls bullet"><span class="by">curious_cat_163</span><span>|</span><a href="#41406689">prev</a><span>|</span><a href="#41406242">next</a><span>|</span><label class="collapse" for="c-41404452">[-]</label><label class="expand" for="c-41404452">[1 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;No matter what happens there is going to be a lock occurring. No two PyThreadStates can execute Python bytecode at the same time. However, they can execute multiple C calls at the same time which is why for long running pure C operations extension and embedding developers are encouraged to release the GIL temporarily.&quot;<p>Very exciting!  I wonder what the first set of motivating applications are and what kind of performance gains are they expecting.</div><br/></div></div><div id="41406242" class="c"><input type="checkbox" id="c-41406242" checked=""/><div class="controls bullet"><span class="by">vintagedave</span><span>|</span><a href="#41404452">prev</a><span>|</span><a href="#41405414">next</a><span>|</span><label class="collapse" for="c-41406242">[-]</label><label class="expand" for="c-41406242">[3 more]</label></div><br/><div class="children"><div class="content">&gt; &#x2F;&#x2F; 500 interpreter states<p>&gt; static constexpr auto MAXIMUM_STATES = 463;<p>There is a joke here that I’m missing. Does anyone understand what it is?</div><br/><div id="41406434" class="c"><input type="checkbox" id="c-41406434" checked=""/><div class="controls bullet"><span class="by">SAHChandler</span><span>|</span><a href="#41406242">parent</a><span>|</span><a href="#41405414">next</a><span>|</span><label class="collapse" for="c-41406434">[-]</label><label class="expand" for="c-41406434">[2 more]</label></div><br/><div class="children"><div class="content">In the TV show &quot;The Orville&quot; a character has their matter replicator create &quot;500 cigarettes&quot;, but it only created 463 after someone counted them all. This is a meme that&#x27;s been making the rounds for a few weeks in some circles now.</div><br/><div id="41406881" class="c"><input type="checkbox" id="c-41406881" checked=""/><div class="controls bullet"><span class="by">vintagedave</span><span>|</span><a href="#41406242">root</a><span>|</span><a href="#41406434">parent</a><span>|</span><a href="#41405414">next</a><span>|</span><label class="collapse" for="c-41406881">[-]</label><label class="expand" for="c-41406881">[1 more]</label></div><br/><div class="children"><div class="content">Thanks!</div><br/></div></div></div></div></div></div><div id="41405414" class="c"><input type="checkbox" id="c-41405414" checked=""/><div class="controls bullet"><span class="by">jacob019</span><span>|</span><a href="#41406242">prev</a><span>|</span><a href="#41406234">next</a><span>|</span><label class="collapse" for="c-41405414">[-]</label><label class="expand" for="c-41405414">[5 more]</label></div><br/><div class="children"><div class="content">When they say per interpreter GIL in PEP 684, is that per thread?  I wasn&#x27;t aware of multiple interpreters in one process.</div><br/><div id="41405454" class="c"><input type="checkbox" id="c-41405454" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#41405414">parent</a><span>|</span><a href="#41405563">next</a><span>|</span><label class="collapse" for="c-41405454">[-]</label><label class="expand" for="c-41405454">[3 more]</label></div><br/><div class="children"><div class="content">Afaik, you could have multiple CPython interpreters per process before, but the GIL was global to the address space, not a per interpreter instance. I believe the GIL work also put interpreter state behind a single struct instead of a handful of global variables.<p>This could be totes wrong, all from memory, too tired to fact check.</div><br/><div id="41405583" class="c"><input type="checkbox" id="c-41405583" checked=""/><div class="controls bullet"><span class="by">gyrovagueGeist</span><span>|</span><a href="#41405414">root</a><span>|</span><a href="#41405454">parent</a><span>|</span><a href="#41405563">next</a><span>|</span><label class="collapse" for="c-41405583">[-]</label><label class="expand" for="c-41405583">[2 more]</label></div><br/><div class="children"><div class="content">These were two separate and mostly unrelated PEPs but otherwise that&#x27;s correct.</div><br/><div id="41405606" class="c"><input type="checkbox" id="c-41405606" checked=""/><div class="controls bullet"><span class="by">sitkack</span><span>|</span><a href="#41405414">root</a><span>|</span><a href="#41405583">parent</a><span>|</span><a href="#41405563">next</a><span>|</span><label class="collapse" for="c-41405606">[-]</label><label class="expand" for="c-41405606">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for corroborating, I&#x27;ll have to trust you.<p>Putting interpreter state behind a struct allows for multiple CPython instances per address space and each can no run on their own thread independently, they all get their own GI(L) lock. These interpreter instances would still have their own Global to This interpreter Lock, but not a Global lock for all CPython interpreters running in a process (like it was before with interpreter state in globals).<p>Unrelated but complementary. We could remove the GIL, making Python multithreaded, but if interpreter state was still in a handful globals, you could have only one interpreter per process.<p>Again, could be totes wrong.</div><br/></div></div></div></div></div></div><div id="41405563" class="c"><input type="checkbox" id="c-41405563" checked=""/><div class="controls bullet"><span class="by">mkoubaa</span><span>|</span><a href="#41405414">parent</a><span>|</span><a href="#41405454">prev</a><span>|</span><a href="#41406234">next</a><span>|</span><label class="collapse" for="c-41405563">[-]</label><label class="expand" for="c-41405563">[1 more]</label></div><br/><div class="children"><div class="content">No not per thread. Each interpreter is capable of spawning threads, all of which share that interpreter&#x27;s gil</div><br/></div></div></div></div><div id="41406234" class="c"><input type="checkbox" id="c-41406234" checked=""/><div class="controls bullet"><span class="by">quasarj</span><span>|</span><a href="#41405414">prev</a><span>|</span><a href="#41404889">next</a><span>|</span><label class="collapse" for="c-41406234">[-]</label><label class="expand" for="c-41406234">[3 more]</label></div><br/><div class="children"><div class="content">Is 463 some joke I&#x27;m not getting?</div><br/><div id="41407160" class="c"><input type="checkbox" id="c-41407160" checked=""/><div class="controls bullet"><span class="by">takeda</span><span>|</span><a href="#41406234">parent</a><span>|</span><a href="#41407203">prev</a><span>|</span><a href="#41404889">next</a><span>|</span><label class="collapse" for="c-41407160">[-]</label><label class="expand" for="c-41407160">[1 more]</label></div><br/><div class="children"><div class="content">yes: <a href="https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;TheOrville&#x2F;comments&#x2F;b6yk52&#x2F;replicators_busted_maybe_something_to_do_with_the&#x2F;ejpd78j&#x2F;" rel="nofollow">https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;TheOrville&#x2F;comments&#x2F;b6yk52&#x2F;replicat...</a></div><br/></div></div></div></div><div id="41404889" class="c"><input type="checkbox" id="c-41404889" checked=""/><div class="controls bullet"><span class="by">layer8</span><span>|</span><a href="#41406234">prev</a><span>|</span><a href="#41404495">next</a><span>|</span><label class="collapse" for="c-41404889">[-]</label><label class="expand" for="c-41404889">[1 more]</label></div><br/><div class="children"><div class="content">I was hoping for it to be an HTTP status code.</div><br/></div></div><div id="41404495" class="c"><input type="checkbox" id="c-41404495" checked=""/><div class="controls bullet"><span class="by">surfingdino</span><span>|</span><a href="#41404889">prev</a><span>|</span><a href="#41404692">next</a><span>|</span><label class="collapse" for="c-41404495">[-]</label><label class="expand" for="c-41404495">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m lo0king forward to it, but debugging this stuff is going to be another level of hard.</div><br/></div></div><div id="41404692" class="c"><input type="checkbox" id="c-41404692" checked=""/><div class="controls bullet"><span class="by">zahlman</span><span>|</span><a href="#41404495">prev</a><span>|</span><label class="collapse" for="c-41404692">[-]</label><label class="expand" for="c-41404692">[5 more]</label></div><br/><div class="children"><div class="content">You posted this 11 days ago and it&#x27;s been posted by two other people in the interim. (Why is this version of the post more popular?)</div><br/><div id="41404726" class="c"><input type="checkbox" id="c-41404726" checked=""/><div class="controls bullet"><span class="by">Jtsummers</span><span>|</span><a href="#41404692">parent</a><span>|</span><a href="#41404753">next</a><span>|</span><label class="collapse" for="c-41404726">[-]</label><label class="expand" for="c-41404726">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes articles just don&#x27;t get traction and then they&#x27;re invited to resubmit (by dang, the moderator). Since the submitter submitted it twice, that was probably what happened here.<p>As to why it&#x27;s &quot;more popular&quot;, I guess you mean is getting more upvotes, that&#x27;s part of the trick with submissions. Post it on a slow Friday work day before a holiday and you&#x27;ll get more clicks than some other days or times.</div><br/></div></div><div id="41404753" class="c"><input type="checkbox" id="c-41404753" checked=""/><div class="controls bullet"><span class="by">SAHChandler</span><span>|</span><a href="#41404692">parent</a><span>|</span><a href="#41404726">prev</a><span>|</span><label class="collapse" for="c-41404753">[-]</label><label class="expand" for="c-41404753">[3 more]</label></div><br/><div class="children"><div class="content">It was entered into the second chance pool[1]. Interim posts were probably not as popular because I accidentally broke my site&#x27;s CSS briefly that wasn&#x27;t obvious in the preview deployments, but was present on the actual site. I only noticed about an hour ago<p>[1]: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=26998308">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=26998308</a></div><br/><div id="41405260" class="c"><input type="checkbox" id="c-41405260" checked=""/><div class="controls bullet"><span class="by">MarkusQ</span><span>|</span><a href="#41404692">root</a><span>|</span><a href="#41404753">parent</a><span>|</span><label class="collapse" for="c-41405260">[-]</label><label class="expand" for="c-41405260">[2 more]</label></div><br/><div class="children"><div class="content">CSS may still be broken.  At least, I&#x27;m getting some really obnoxious color combinations (magenta on salmon, etc.)</div><br/><div id="41405383" class="c"><input type="checkbox" id="c-41405383" checked=""/><div class="controls bullet"><span class="by">SAHChandler</span><span>|</span><a href="#41404692">root</a><span>|</span><a href="#41405260">parent</a><span>|</span><label class="collapse" for="c-41405383">[-]</label><label class="expand" for="c-41405383">[1 more]</label></div><br/><div class="children"><div class="content">It should be a brighter orange closer to what you see on HN&#x27;s top bar. I&#x27;ve been waffling on the magenta. It works &quot;fine&quot; in low usage. This is the first post where I used it a great deal. I&#x27;m gonna be spending some time working with the colors over the weekend, as you&#x27;re the 5th person to say something to me about it.<p>It could be worse, however. My last design would flashbang you, even if you used darkreader</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>