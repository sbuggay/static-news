<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1691744463831" as="style"/><link rel="stylesheet" href="styles.css?v=1691744463831"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.evilsocket.net/2022/10/20/Reverse-Engineering-the-Apple-MultiPeer-Connectivity-Framework/">Reverse Engineering the Apple Multipeer Connectivity Framework (2022)</a> <span class="domain">(<a href="https://www.evilsocket.net">www.evilsocket.net</a>)</span></div><div class="subtext"><span>wslh</span> | <span>16 comments</span></div><br/><div><div id="37085227" class="c"><input type="checkbox" id="c-37085227" checked=""/><div class="controls bullet"><span class="by">fisherjeff</span><span>|</span><a href="#37085434">next</a><span>|</span><label class="collapse" for="c-37085227">[-]</label><label class="expand" for="c-37085227">[4 more]</label></div><br/><div class="children"><div class="content">“Moreover, while sending crafted packets and attempting all sorts of things, I’ve discovered several vulnerabilities in the Apple custom made parsers. I will not discuss them here (exception made for the session spoofing) but at the same time I’m not interested in reporting them to Apple…”<p>Erm, hope they’re not super serious I guess?</div><br/><div id="37085601" class="c"><input type="checkbox" id="c-37085601" checked=""/><div class="controls bullet"><span class="by">ithkuil</span><span>|</span><a href="#37085227">parent</a><span>|</span><a href="#37085798">next</a><span>|</span><label class="collapse" for="c-37085601">[-]</label><label class="expand" for="c-37085601">[1 more]</label></div><br/><div class="children"><div class="content">Taken out of context it looks a bit weird, but it does explain the motivation:<p>&quot;I’ve heard way too many negative stories about their disclosure program and in general how they mistreat researchers.&quot;</div><br/></div></div><div id="37085798" class="c"><input type="checkbox" id="c-37085798" checked=""/><div class="controls bullet"><span class="by">isodev</span><span>|</span><a href="#37085227">parent</a><span>|</span><a href="#37085601">prev</a><span>|</span><a href="#37085434">next</a><span>|</span><label class="collapse" for="c-37085798">[-]</label><label class="expand" for="c-37085798">[2 more]</label></div><br/><div class="children"><div class="content">The author’s comment about not reporting really feels like a tantrum.<p>Regarding Multipeer Connectivity, this framework is used by apps and what data gets exchanged is entirely up to the app developer. The API allows developers to secure the data (e.g. MCSession security identity) but that’s up to them since the use case doesn’t always require it.<p>Even if Continuity (what Apple devices use to share intents, clipboard etc) is built on a similar mechanism, I seriously doubt it’s that easy to penetrate (it’s also been around for almost a decade now too). Continuity also comes with a much stricter set of requirements (e.g. only works between unlocked devices of the same user). By contrast, Multipeer Connectivity is there to make it easy to quickly discover any nearby device of interest.<p>Regardless, we know there is no such thing as perfect security, so if a vulnerability is found, it’s only responsible to report it so it can be addressed.</div><br/><div id="37086053" class="c"><input type="checkbox" id="c-37086053" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#37085227">root</a><span>|</span><a href="#37085798">parent</a><span>|</span><a href="#37085434">next</a><span>|</span><label class="collapse" for="c-37086053">[-]</label><label class="expand" for="c-37086053">[1 more]</label></div><br/><div class="children"><div class="content">So the question is whether those bugs are in the framework part provided by Apple, or the application specific code handing the individual messages.</div><br/></div></div></div></div></div></div><div id="37085434" class="c"><input type="checkbox" id="c-37085434" checked=""/><div class="controls bullet"><span class="by">mannyv</span><span>|</span><a href="#37085227">prev</a><span>|</span><a href="#37085222">next</a><span>|</span><label class="collapse" for="c-37085434">[-]</label><label class="expand" for="c-37085434">[3 more]</label></div><br/><div class="children"><div class="content">&quot;custom (and as typical of Apple, undocumented) TCP protocol&quot;<p>Pretty much all custom protocols are undocumented. Not sure why he feels the need to shit on Apple.<p>And any custom protocol parser will be riddled with errors, because they always expect values to be in range.</div><br/><div id="37086062" class="c"><input type="checkbox" id="c-37086062" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#37085434">parent</a><span>|</span><a href="#37085485">next</a><span>|</span><label class="collapse" for="c-37086062">[-]</label><label class="expand" for="c-37086062">[1 more]</label></div><br/><div class="children"><div class="content">&gt; And any custom protocol parser will be riddled with errors, because they always expect values to be in range.<p>I hope you&#x27;re not working on any products I rely on.</div><br/></div></div><div id="37085485" class="c"><input type="checkbox" id="c-37085485" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#37085434">parent</a><span>|</span><a href="#37086062">prev</a><span>|</span><a href="#37085222">next</a><span>|</span><label class="collapse" for="c-37085485">[-]</label><label class="expand" for="c-37085485">[1 more]</label></div><br/><div class="children"><div class="content">Because when apple does it you can assume it only works on apple devices, such a bore. How people can get excited about vendor lock-in beyond me.</div><br/></div></div></div></div><div id="37085222" class="c"><input type="checkbox" id="c-37085222" checked=""/><div class="controls bullet"><span class="by">xpe</span><span>|</span><a href="#37085434">prev</a><span>|</span><a href="#37085210">next</a><span>|</span><label class="collapse" for="c-37085222">[-]</label><label class="expand" for="c-37085222">[5 more]</label></div><br/><div class="children"><div class="content">From a comment in the article:<p>&gt; This gives me chills, the shared clipboard also uses this protocol, right? This means that everything we copy goes through the network via Bluetooth without encryption and can be captured by any Bluetooth sniffer?<p>The shared clipboard uses this protocol?... on what basis is this claim plausible?</div><br/><div id="37086266" class="c"><input type="checkbox" id="c-37086266" checked=""/><div class="controls bullet"><span class="by">dalbin</span><span>|</span><a href="#37085222">parent</a><span>|</span><a href="#37085548">next</a><span>|</span><label class="collapse" for="c-37086266">[-]</label><label class="expand" for="c-37086266">[1 more]</label></div><br/><div class="children"><div class="content">From Apple Platform Security Guide [0] :<p>&gt; The individual messages are encrypted much like messages in iMessage are. After the devices are paired, each device generates a symmetric 256-bit AES key that gets stored in the device’s keychain. This key can encrypt and authenticate the BLE advertisements that communicate the device’s current activity to other iCloud-paired devices using AES256 in GCM mode, with replay protection measures.<p>[1]: <a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-gb&#x2F;guide&#x2F;security&#x2F;secf78dbe639&#x2F;web" rel="nofollow noreferrer">https:&#x2F;&#x2F;support.apple.com&#x2F;en-gb&#x2F;guide&#x2F;security&#x2F;secf78dbe639&#x2F;...</a></div><br/></div></div><div id="37085548" class="c"><input type="checkbox" id="c-37085548" checked=""/><div class="controls bullet"><span class="by">NathanWilliams</span><span>|</span><a href="#37085222">parent</a><span>|</span><a href="#37086266">prev</a><span>|</span><a href="#37085810">next</a><span>|</span><label class="collapse" for="c-37085548">[-]</label><label class="expand" for="c-37085548">[2 more]</label></div><br/><div class="children"><div class="content">I thought it was clear it ran through iCloud: <a href="https:&#x2F;&#x2F;support.apple.com&#x2F;en-au&#x2F;HT209460" rel="nofollow noreferrer">https:&#x2F;&#x2F;support.apple.com&#x2F;en-au&#x2F;HT209460</a><p>It only works between devices signed in with the same Apple ID</div><br/><div id="37086438" class="c"><input type="checkbox" id="c-37086438" checked=""/><div class="controls bullet"><span class="by">jdsnape</span><span>|</span><a href="#37085222">root</a><span>|</span><a href="#37085548">parent</a><span>|</span><a href="#37085810">next</a><span>|</span><label class="collapse" for="c-37086438">[-]</label><label class="expand" for="c-37086438">[1 more]</label></div><br/><div class="children"><div class="content">The encryption keys are shared via the iCloud keychain, but I think the actual sharing happens over a protocol called Companion Link.</div><br/></div></div></div></div><div id="37085810" class="c"><input type="checkbox" id="c-37085810" checked=""/><div class="controls bullet"><span class="by">unglaublich</span><span>|</span><a href="#37085222">parent</a><span>|</span><a href="#37085548">prev</a><span>|</span><a href="#37085210">next</a><span>|</span><label class="collapse" for="c-37085810">[-]</label><label class="expand" for="c-37085810">[1 more]</label></div><br/><div class="children"><div class="content">&gt; on what basis is this claim plausible?<p>The article shows the author holds some grudges against Apple.
Those grudges probably influence their judgement.</div><br/></div></div></div></div><div id="37085210" class="c"><input type="checkbox" id="c-37085210" checked=""/><div class="controls bullet"><span class="by">xpe</span><span>|</span><a href="#37085222">prev</a><span>|</span><label class="collapse" for="c-37085210">[-]</label><label class="expand" for="c-37085210">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I’ve heard way too many negative stories about [Apple&#x27;s] disclosure program and in general how they mistreat researchers.<p>Links?</div><br/><div id="37085375" class="c"><input type="checkbox" id="c-37085375" checked=""/><div class="controls bullet"><span class="by">acheong08</span><span>|</span><a href="#37085210">parent</a><span>|</span><a href="#37085322">next</a><span>|</span><label class="collapse" for="c-37085375">[-]</label><label class="expand" for="c-37085375">[1 more]</label></div><br/><div class="children"><div class="content">Wait times over 8 months and they refused to give credit (but gave $).<p>Personal experience so I can’t say for others. They pay well though. My first year of college has been completely covered by them so no complaints.</div><br/></div></div><div id="37085322" class="c"><input type="checkbox" id="c-37085322" checked=""/><div class="controls bullet"><span class="by">deedree</span><span>|</span><a href="#37085210">parent</a><span>|</span><a href="#37085375">prev</a><span>|</span><label class="collapse" for="c-37085322">[-]</label><label class="expand" for="c-37085322">[1 more]</label></div><br/><div class="children"><div class="content">I did some lazy searching and it seems it&#x27;s a well known fact. I don&#x27;t think the author has to back it up in this case.<p>Infosec researchers say Apple’s bug-bounty program needs work[0]<p>[0] <a href="https:&#x2F;&#x2F;arstechnica.com&#x2F;information-technology&#x2F;2021&#x2F;09&#x2F;infosec-researchers-say-apples-bug-bounty-program-needs-work&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;arstechnica.com&#x2F;information-technology&#x2F;2021&#x2F;09&#x2F;infos...</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>