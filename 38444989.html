<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1701248458725" as="style"/><link rel="stylesheet" href="styles.css?v=1701248458725"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://j11y.io/cool-stuff/double-bitwise-not/">JavaScript: Double Bitwise Not (~~)</a> <span class="domain">(<a href="https://j11y.io">j11y.io</a>)</span></div><div class="subtext"><span>xkcd1963</span> | <span>14 comments</span></div><br/><div><div id="38457140" class="c"><input type="checkbox" id="c-38457140" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#38456974">next</a><span>|</span><label class="collapse" for="c-38457140">[-]</label><label class="expand" for="c-38457140">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve mentioned in other comments, but it should be noted that `~~x` or `x | 0` is not same as `Math.floor(x)`. It is rather a shorthand for `Math.trunc(x)` that is almost correct for x between -2^31 to 2^31 - 1. (Almost, because `Math.trunc(-0.5)` should return -0 while `~~(-0.5)` is +0.) There is also a variant `x &gt;&gt;&gt; 0` which works for x between 0 to 2^32 - 1.<p>Essentially this trick exploits how JS initially implemented bitwise operations while having no integer-only types. It is safe to use---ECMAScript is unlikely to change bitwise operators in future versions---but only useful for limited cases. Those limited cases, like low-level emulations, happen to be cases where such tricks are very convenient though. As long as you don&#x27;t naively convert `Math.floor(x)` with `x | 0` or `x &gt;&gt;&gt; 0` I&#x27;m fine with them, but this article seems to encourgate that.</div><br/></div></div><div id="38456974" class="c"><input type="checkbox" id="c-38456974" checked=""/><div class="controls bullet"><span class="by">s4i</span><span>|</span><a href="#38457140">prev</a><span>|</span><a href="#38457043">next</a><span>|</span><label class="collapse" for="c-38456974">[-]</label><label class="expand" for="c-38456974">[3 more]</label></div><br/><div class="children"><div class="content">&gt; it’s faster and takes up less characters. It’s not quite as readable though, but I’m hoping that ~~ will slowly become a very well-known technique in the JS arena, so we can all use it without fearing accusations.<p>Yeah, no thanks. I&#x27;ll take well named functions over these kind of syntax tricks any day.</div><br/><div id="38457012" class="c"><input type="checkbox" id="c-38457012" checked=""/><div class="controls bullet"><span class="by">CookiesOnMyDesk</span><span>|</span><a href="#38456974">parent</a><span>|</span><a href="#38457043">next</a><span>|</span><label class="collapse" for="c-38457012">[-]</label><label class="expand" for="c-38457012">[2 more]</label></div><br/><div class="children"><div class="content">Do you use a well named function like and(), or do you use the double ampersand (&amp;&amp;) syntax trick? What about a not() function, or the exclamation mark syntax trick (!)? :)<p>Every use of operators can be considered a syntax trick until it becomes common, which is what the author hopes will happen to ~~</div><br/><div id="38457072" class="c"><input type="checkbox" id="c-38457072" checked=""/><div class="controls bullet"><span class="by">golergka</span><span>|</span><a href="#38456974">root</a><span>|</span><a href="#38457012">parent</a><span>|</span><a href="#38457043">next</a><span>|</span><label class="collapse" for="c-38457072">[-]</label><label class="expand" for="c-38457072">[1 more]</label></div><br/><div class="children"><div class="content">This operator is not currently common for intended audience of my code. And also, it&#x27;s intended meaning is so much less often useful than meaning of other operators, that I don&#x27;t think it ever becomes common.</div><br/></div></div></div></div></div></div><div id="38457043" class="c"><input type="checkbox" id="c-38457043" checked=""/><div class="controls bullet"><span class="by">krackers</span><span>|</span><a href="#38456974">prev</a><span>|</span><a href="#38457130">next</a><span>|</span><label class="collapse" for="c-38457043">[-]</label><label class="expand" for="c-38457043">[3 more]</label></div><br/><div class="children"><div class="content">If implementation of ~~ is supposedly faster than Math.floor() for positives, shouldn&#x27;t the JIT pick up on this with a guard&#x2F;deopt block?</div><br/><div id="38457053" class="c"><input type="checkbox" id="c-38457053" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#38457043">parent</a><span>|</span><a href="#38457062">next</a><span>|</span><label class="collapse" for="c-38457053">[-]</label><label class="expand" for="c-38457053">[1 more]</label></div><br/><div class="children"><div class="content">Because `Math.floor` is correct for all numbers but `~~` will be incorrect outside of int32 ranges and non-numbers (`Math.floor(&quot;asdf&quot;)` is NaN but `~~&quot;asdf&quot;` is 0). Basically it is a shorthand for limited cases, but it is so convenient for those cases that I think it is a worthy trick to know with caveats.</div><br/></div></div><div id="38457062" class="c"><input type="checkbox" id="c-38457062" checked=""/><div class="controls bullet"><span class="by">mpixel</span><span>|</span><a href="#38457043">parent</a><span>|</span><a href="#38457053">prev</a><span>|</span><a href="#38457130">next</a><span>|</span><label class="collapse" for="c-38457062">[-]</label><label class="expand" for="c-38457062">[1 more]</label></div><br/><div class="children"><div class="content">Bitwise operators only work on the first 32-bits, so it isn&#x27;t as easy as `instead of doing the Math.floor operations, check for edge cases and just the same operation as ~~`</div><br/></div></div></div></div><div id="38457130" class="c"><input type="checkbox" id="c-38457130" checked=""/><div class="controls bullet"><span class="by">anon23432343</span><span>|</span><a href="#38457043">prev</a><span>|</span><a href="#38457015">next</a><span>|</span><label class="collapse" for="c-38457130">[-]</label><label class="expand" for="c-38457130">[1 more]</label></div><br/><div class="children"><div class="content">1) Add the year! This is ~~2010! Is this even still valid today? Is it really faster in 2023?<p>2) this &quot;trick&quot; has problems if you don&#x27;t understand the caveats it has.<p>3) This kind of micro optimisation isn&#x27;t usually were your code is slow. Any css shift will be more expensive then this.<p>4) IF you want to use this &quot;trick&quot; then make sure everybody who will need to read your code really understands what you are doing here. Dont be that smart pants coder were no body else then you can read your code! This does not make you a good programer!</div><br/></div></div><div id="38457015" class="c"><input type="checkbox" id="c-38457015" checked=""/><div class="controls bullet"><span class="by">Asraelite</span><span>|</span><a href="#38457130">prev</a><span>|</span><a href="#38456992">next</a><span>|</span><label class="collapse" for="c-38457015">[-]</label><label class="expand" for="c-38457015">[2 more]</label></div><br/><div class="children"><div class="content">I thought `| 0` was the de facto way to do this in JavaScript. It was even made part of the asm.js standard iirc.<p>Is there a difference between `| 0` and `~~`?</div><br/><div id="38457059" class="c"><input type="checkbox" id="c-38457059" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#38457015">parent</a><span>|</span><a href="#38456992">next</a><span>|</span><label class="collapse" for="c-38457059">[-]</label><label class="expand" for="c-38457059">[1 more]</label></div><br/><div class="children"><div class="content">No [1]. Their difference only matters for code golfing (because `~~` binds much tighter than `|0`).<p>[1] <a href="https:&#x2F;&#x2F;tc39.es&#x2F;ecma262&#x2F;#sec-numeric-types-number-bitwiseNOT" rel="nofollow noreferrer">https:&#x2F;&#x2F;tc39.es&#x2F;ecma262&#x2F;#sec-numeric-types-number-bitwiseNOT</a> vs. <a href="https:&#x2F;&#x2F;tc39.es&#x2F;ecma262&#x2F;#sec-numberbitwiseop" rel="nofollow noreferrer">https:&#x2F;&#x2F;tc39.es&#x2F;ecma262&#x2F;#sec-numberbitwiseop</a></div><br/></div></div></div></div><div id="38456992" class="c"><input type="checkbox" id="c-38456992" checked=""/><div class="controls bullet"><span class="by">ahofmann</span><span>|</span><a href="#38457015">prev</a><span>|</span><a href="#38457010">next</a><span>|</span><label class="collapse" for="c-38456992">[-]</label><label class="expand" for="c-38456992">[1 more]</label></div><br/><div class="children"><div class="content">I would hate reading code that uses stuff like this. Give things readable names, please! I&#x27;m a dumb programmer, don&#x27;t make my job even harder.<p>Edit: I just realized that the post is from 2010. This makes the post even more horrible. In 2010 you had to deal with internet explorer and other very ugly compatibility stuff on the client side. Javascript was an absolute pain and if someone would write code like this on the frontend, I would run as far away as I could.</div><br/></div></div><div id="38457010" class="c"><input type="checkbox" id="c-38457010" checked=""/><div class="controls bullet"><span class="by">bmo-at</span><span>|</span><a href="#38456992">prev</a><span>|</span><a href="#38457066">next</a><span>|</span><label class="collapse" for="c-38457010">[-]</label><label class="expand" for="c-38457010">[1 more]</label></div><br/><div class="children"><div class="content">I actually think this is a bad idea. Sure, it looks cool and is interesting.
I always prefer making code explicit, as it keeps the code more readable.</div><br/></div></div><div id="38457066" class="c"><input type="checkbox" id="c-38457066" checked=""/><div class="controls bullet"><span class="by">oytis</span><span>|</span><a href="#38457010">prev</a><span>|</span><label class="collapse" for="c-38457066">[-]</label><label class="expand" for="c-38457066">[1 more]</label></div><br/><div class="children"><div class="content">This is awful.</div><br/></div></div></div></div></div></div></div></body></html>