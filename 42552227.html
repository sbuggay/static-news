<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1735635663378" as="style"/><link rel="stylesheet" href="styles.css?v=1735635663378"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://noinitrd.github.io/Memory-Dump-UEFI/">Dumping Memory to Bypass BitLocker on Windows 11</a> <span class="domain">(<a href="https://noinitrd.github.io">noinitrd.github.io</a>)</span></div><div class="subtext"><span>supermatou</span> | <span>153 comments</span></div><br/><div><div id="42557460" class="c"><input type="checkbox" id="c-42557460" checked=""/><div class="controls bullet"><span class="by">jpalomaki</span><span>|</span><a href="#42553275">next</a><span>|</span><label class="collapse" for="c-42557460">[-]</label><label class="expand" for="c-42557460">[1 more]</label></div><br/><div class="children"><div class="content">You can make things a bit harder by locking the boot order in bios and password protecting the bios settings.<p>Not sure how much this helps against a determined attacker, but it&#x27;s easy and inconvenience is minimal in most cases.</div><br/></div></div><div id="42553275" class="c"><input type="checkbox" id="c-42553275" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42557460">prev</a><span>|</span><a href="#42552911">next</a><span>|</span><label class="collapse" for="c-42553275">[-]</label><label class="expand" for="c-42553275">[41 more]</label></div><br/><div class="children"><div class="content">I think you get the biggest advantage from BitLocker when you use TPM (PCR 7+11) with a PIN. That should mitigate the exploit because the FVEK should never be read without the PIN, and if BitLocker does it right (which I think it does) too many wrong PIN&#x27;s results in the TPM going into dictionary attack lockout mode.<p>Now I&#x27;ve been trying for months to do the same for Linux. There&#x27;s systemd-cryptsetup&#x2F;cryptenroll, but it&#x27;s only for LUKS and I&#x27;m trying to encrypt a few sensitive directories on a super slow internal eMMC with fscrypt (keys for secure boot and &#x2F;home). The TPM is _EXTREMELY_ hard to code for when things go beyond the basics:<p>1. Bind to PCR 7<p>2. Bind to changing PCR 11 (changes whenever the kernel, init, cmdline etc. is updated)<p>3. Use a PIN - but not the AuthValue, because I want to use the same authorization policy for resetting the DA lockout counter on login, and also have a long password&#x2F;AuthValue for resetting the counter manually.<p>4. Make it all work with PCR 11 signatures and public keys provided by systemd-stub.<p>Maybe this isn&#x27;t the right place to ask, but there&#x27;s almost nothing but basic TPM guides out there, so if you&#x27;re an expert I could really use your help. It&#x27;s just for a personal project, but I&#x27;ll write about it once I&#x27;m done - if I ever figure it out!</div><br/><div id="42553619" class="c"><input type="checkbox" id="c-42553619" checked=""/><div class="controls bullet"><span class="by">tchebb</span><span>|</span><a href="#42553275">parent</a><span>|</span><a href="#42554157">next</a><span>|</span><label class="collapse" for="c-42553619">[-]</label><label class="expand" for="c-42553619">[13 more]</label></div><br/><div class="children"><div class="content">Surely Windows keeps the FVEK in RAM regardless of whether the TPM requires a PIN to initially obtain it. Otherwise, wouldn&#x27;t you need to enter your PIN every time a block from the disk needs decrypting? Not to mention the performance impact of calling the TPM on every disk operation.<p>This attack reads the key from RAM, so I don&#x27;t see how a TPM PIN would mitigate it.</div><br/><div id="42555078" class="c"><input type="checkbox" id="c-42555078" checked=""/><div class="controls bullet"><span class="by">indigo945</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553619">parent</a><span>|</span><a href="#42553971">next</a><span>|</span><label class="collapse" for="c-42555078">[-]</label><label class="expand" for="c-42555078">[4 more]</label></div><br/><div class="children"><div class="content">The point is that the TPM PIN prevents the attack <i>if the system is powered off when the attacker obtains it</i>.<p>If the TPM doesn&#x27;t have a PIN, this attack works even if the attacker obtains the system when it&#x27;s powered off. They can start the computer, proceed to the Windows logon screen (that they can&#x27;t get past and that hence prevents them from exfiltrating data from the running system), then just reset the computer and perform this attack to obtain the encryption key. This obviously doesn&#x27;t work if the PIN prevents Windows from ever even starting.</div><br/><div id="42556419" class="c"><input type="checkbox" id="c-42556419" checked=""/><div class="controls bullet"><span class="by">0xDEADFED5</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42555078">parent</a><span>|</span><a href="#42557360">prev</a><span>|</span><a href="#42553971">next</a><span>|</span><label class="collapse" for="c-42556419">[-]</label><label class="expand" for="c-42556419">[2 more]</label></div><br/><div class="children"><div class="content">I know this is besides the point, but still kinda relevant:<p>Even on Win11 it&#x27;s still possible to do the old utilman (or other suitable module) replacement hack from Windows repair (trigger by interrupting boot), from there you can change account passwords at will.</div><br/><div id="42557439" class="c"><input type="checkbox" id="c-42557439" checked=""/><div class="controls bullet"><span class="by">Neil44</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42556419">parent</a><span>|</span><a href="#42553971">next</a><span>|</span><label class="collapse" for="c-42557439">[-]</label><label class="expand" for="c-42557439">[1 more]</label></div><br/><div class="children"><div class="content">I think Windows repair prompts for an admin login and the bitlocker key before allowing you to proceed. Assuming the windows install is intact enough to read the security sam.</div><br/></div></div></div></div></div></div><div id="42553971" class="c"><input type="checkbox" id="c-42553971" checked=""/><div class="controls bullet"><span class="by">derekerdmann</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553619">parent</a><span>|</span><a href="#42555078">prev</a><span>|</span><a href="#42553688">next</a><span>|</span><label class="collapse" for="c-42553971">[-]</label><label class="expand" for="c-42553971">[4 more]</label></div><br/><div class="children"><div class="content">Correct, unless you&#x27;re using a self-encrypting drive the FVEK sits in RAM once it&#x27;s been released by the TPM during boot. The TPM is only a root of trust; for fast crypto operations without keeping the key in kernel memory you would need something like Intel SGX or ARM TrustZone.</div><br/><div id="42554225" class="c"><input type="checkbox" id="c-42554225" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553971">parent</a><span>|</span><a href="#42553688">next</a><span>|</span><label class="collapse" for="c-42554225">[-]</label><label class="expand" for="c-42554225">[3 more]</label></div><br/><div class="children"><div class="content">BitLocker no longer leverages SED by default due to vulnerabilities in drive manufactures firmware as of Sept 2019.<p>&gt; Changes the default setting for BitLocker when encrypting a self-encrypting hard drive. Now, the default is to use software encryption for newly encrypted drives. For existing drives, the type of encryption will not change.<p><a href="https:&#x2F;&#x2F;support.microsoft.com&#x2F;en-us&#x2F;topic&#x2F;september-24-2019-kb4516071-os-build-16299-1420-5648029d-8d1c-ed9e-b72c-63c6fee30bff" rel="nofollow">https:&#x2F;&#x2F;support.microsoft.com&#x2F;en-us&#x2F;topic&#x2F;september-24-2019-...</a><p><a href="https:&#x2F;&#x2F;nvd.nist.gov&#x2F;vuln&#x2F;detail&#x2F;CVE-2018-12037" rel="nofollow">https:&#x2F;&#x2F;nvd.nist.gov&#x2F;vuln&#x2F;detail&#x2F;CVE-2018-12037</a></div><br/><div id="42554278" class="c"><input type="checkbox" id="c-42554278" checked=""/><div class="controls bullet"><span class="by">MoreMoore</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554225">parent</a><span>|</span><a href="#42553688">next</a><span>|</span><label class="collapse" for="c-42554278">[-]</label><label class="expand" for="c-42554278">[2 more]</label></div><br/><div class="children"><div class="content">Holy crap.<p><a href="https:&#x2F;&#x2F;threadreaderapp.com&#x2F;thread&#x2F;1059435094421712896.html" rel="nofollow">https:&#x2F;&#x2F;threadreaderapp.com&#x2F;thread&#x2F;1059435094421712896.html</a><p>This is amazing.<p>&gt; The encrypted SSD has a master password that’s set to “”<p>HN discussion here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=18382975">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=18382975</a><p>Original paper here: <a href="https:&#x2F;&#x2F;cs.ru.nl&#x2F;~cmeijer&#x2F;publications&#x2F;Self_Encrypting_Deception_Weaknesses_in_the_Encryption_of_Solid_State_Drives.pdf" rel="nofollow">https:&#x2F;&#x2F;cs.ru.nl&#x2F;~cmeijer&#x2F;publications&#x2F;Self_Encrypting_Decep...</a></div><br/></div></div></div></div></div></div><div id="42553688" class="c"><input type="checkbox" id="c-42553688" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553619">parent</a><span>|</span><a href="#42553971">prev</a><span>|</span><a href="#42554157">next</a><span>|</span><label class="collapse" for="c-42553688">[-]</label><label class="expand" for="c-42553688">[4 more]</label></div><br/><div class="children"><div class="content">If you can short the reset pins while the computer is running and make it restart without losing power, then yes, I agree. But if you have to shut down to make your modifications, then you won&#x27;t get past the PIN prompt.</div><br/><div id="42554858" class="c"><input type="checkbox" id="c-42554858" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553688">parent</a><span>|</span><a href="#42554157">next</a><span>|</span><label class="collapse" for="c-42554858">[-]</label><label class="expand" for="c-42554858">[3 more]</label></div><br/><div class="children"><div class="content">Why? It means you&#x27;ll only get one shot at the attack, but nothing here is intrinsically prevented by using a TPM PIN (or even a non-TPM password, the attack doesn&#x27;t depend on TPM-based Bitlocker in any way other than if the target machine is powered off or your first attempt fails)</div><br/><div id="42557374" class="c"><input type="checkbox" id="c-42557374" checked=""/><div class="controls bullet"><span class="by">prmoustache</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554858">parent</a><span>|</span><a href="#42554983">next</a><span>|</span><label class="collapse" for="c-42557374">[-]</label><label class="expand" for="c-42557374">[1 more]</label></div><br/><div class="children"><div class="content">It might make it super hard to do an a laptop where you can&#x27;t usually force reset easily from the power button.<p>Having said that a number of laptops can still be opened without being powered-off if you do it carefully.</div><br/></div></div><div id="42554983" class="c"><input type="checkbox" id="c-42554983" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554858">parent</a><span>|</span><a href="#42557374">prev</a><span>|</span><a href="#42554157">next</a><span>|</span><label class="collapse" for="c-42554983">[-]</label><label class="expand" for="c-42554983">[1 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t underestimate that a PIN prevents this attack on machines that are powered off.<p>You can then go further up the chain with a UEFI settings password and no usb booting. If the password is hard to decrypt, then that&#x27;s a pretty good approach.<p>Then there&#x27;s custom Secure Boot certificates that replaces the ones from MS. It&#x27;ll work for Linux, not sure about BitLocker. But my Surface tablet doesn&#x27;t even support custom sb certs.</div><br/></div></div></div></div></div></div></div></div><div id="42554157" class="c"><input type="checkbox" id="c-42554157" checked=""/><div class="controls bullet"><span class="by">BobbyTables2</span><span>|</span><a href="#42553275">parent</a><span>|</span><a href="#42553619">prev</a><span>|</span><a href="#42553363">next</a><span>|</span><label class="collapse" for="c-42554157">[-]</label><label class="expand" for="c-42554157">[3 more]</label></div><br/><div class="children"><div class="content">Might need most of PCRs 0-7.  Isn’t PCR 4  used to measure the EFI executable booted by UEFI?<p>Avoid GRUB, difficult to secure with it.<p>Kernel updates will also be painful…</div><br/><div id="42554516" class="c"><input type="checkbox" id="c-42554516" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554157">parent</a><span>|</span><a href="#42553363">next</a><span>|</span><label class="collapse" for="c-42554516">[-]</label><label class="expand" for="c-42554516">[2 more]</label></div><br/><div class="children"><div class="content">7+11 is default for BitLocker as far as I know. Binding to other values will bite you later if you update UEFI firmware or change some settings.<p>GRUB and all other boot loaders are unecessary with UEFI. See my comment history for more.<p>Kernel updates + Secure Boot is easy with a Debian hook.<p>The hard part is making it work with TPM when you want to add encryption...</div><br/><div id="42555658" class="c"><input type="checkbox" id="c-42555658" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554516">parent</a><span>|</span><a href="#42553363">next</a><span>|</span><label class="collapse" for="c-42555658">[-]</label><label class="expand" for="c-42555658">[1 more]</label></div><br/><div class="children"><div class="content">Found the article where I read about PCR 7+11 being the default [1]. The reason I looked it up is because if this is actually true, and the TPM is built into the cpu, what prevents someone from placing the cpu and disk on another motherboard?<p>Say that you have disabled usb booting and secured UEFI settings with a password. If you extract the cpu (and thereby its tpm) and the disk, then you&#x27;d still be able to boot, right? Meaning that without a TPM pin, you&#x27;d be able to do OP&#x27;s attack on a different motherboard even when the original machine was off and UEFI settings secured.<p>What am I missing? Is it that easy to circumvent UEFI settings protection and maintain the PCR 7 value?<p>[1] <a href="https:&#x2F;&#x2F;blog.scrt.ch&#x2F;2023&#x2F;09&#x2F;15&#x2F;a-deep-dive-into-tpm-based-bitlocker-drive-encryption&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.scrt.ch&#x2F;2023&#x2F;09&#x2F;15&#x2F;a-deep-dive-into-tpm-based-b...</a></div><br/></div></div></div></div></div></div><div id="42553363" class="c"><input type="checkbox" id="c-42553363" checked=""/><div class="controls bullet"><span class="by">varispeed</span><span>|</span><a href="#42553275">parent</a><span>|</span><a href="#42554157">prev</a><span>|</span><a href="#42552911">next</a><span>|</span><label class="collapse" for="c-42553363">[-]</label><label class="expand" for="c-42553363">[24 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t TPM just a honeypot of sorts? It seems strange to me that after successful open source encryption software, there was a shift to TPM, like you&#x27;ll have a notion of super secure storage provided by big corporations and you should just not worry about it and not question.<p>Surely there must be a backdoor access for three letter agencies to just download all the pins and passwords and then take a dip in the data, no worries.</div><br/><div id="42553558" class="c"><input type="checkbox" id="c-42553558" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553363">parent</a><span>|</span><a href="#42553505">next</a><span>|</span><label class="collapse" for="c-42553558">[-]</label><label class="expand" for="c-42553558">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not a honeypot, and it does have value when used properly.<p>Their main purpose is to generate and store keys that cannot leave the device, instead performing signing operations as needed internally and only returning the result, and only if attestation passed. This is a lot better than just having private keys on disk.<p>People just forget that security isn&#x27;t absolute, and each solution has a threat model it is appropriate for. In case of full disk encryption, neither a TPM nor user input can protect against evil maid on its own for example - the TPM will unlock for anyone, while user input might be collected by a modified and malicious bootloader. Having both, however, works well.<p>&quot;TPM&quot; is a bit dated as a term as it&#x27;s all directly built into the processor nowadays, including for smartphones and such. Another modern feature in that catalogue is memory encryption, which rules out the attack described by OP as the rebooted machine would be unable to read old memory content.</div><br/></div></div><div id="42553505" class="c"><input type="checkbox" id="c-42553505" checked=""/><div class="controls bullet"><span class="by">eddythompson80</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553363">parent</a><span>|</span><a href="#42553558">prev</a><span>|</span><a href="#42553519">next</a><span>|</span><label class="collapse" for="c-42553505">[-]</label><label class="expand" for="c-42553505">[18 more]</label></div><br/><div class="children"><div class="content">I encourage you to read what a TPM is. A TPM isn&#x27;t an &quot;encryption&quot; software&#x2F;hardware. It&#x27;s completely orthogonal to &quot;successful open source encryption software&quot;.<p>&quot;successful open source encryption software&quot; don&#x27;t solve the main usability problem with encryption: &quot;Where do I store my super secure 4096-bit private key so it&#x27;s both secure and convenient to use&quot;</div><br/><div id="42557468" class="c"><input type="checkbox" id="c-42557468" checked=""/><div class="controls bullet"><span class="by">adrian_b</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553505">parent</a><span>|</span><a href="#42553563">next</a><span>|</span><label class="collapse" for="c-42557468">[-]</label><label class="expand" for="c-42557468">[1 more]</label></div><br/><div class="children"><div class="content">You can store it encrypted with a password on a USB memory that you insert when booting the computer, like you would use a key for starting a car.<p>This is what I actually do. I also store the OS kernel on the USB memory and I boot from there, with the root file system set to mount an internal SSD. The SSDs in the computer are completely encrypted with such long &quot;super secure&quot; keys (distinct for each SSD and selected automatically based on their serial number), and they do not store any information about the keys.<p>I have used this system for years and I find it very convenient. My computers cannot be booted without inserting the bootable USB memory and also giving the correct password. I have multiple bootable keys stored in different places, for the case when one becomes defective or lost.</div><br/></div></div><div id="42553563" class="c"><input type="checkbox" id="c-42553563" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553505">parent</a><span>|</span><a href="#42557468">prev</a><span>|</span><a href="#42554366">next</a><span>|</span><label class="collapse" for="c-42553563">[-]</label><label class="expand" for="c-42553563">[13 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t see why a TPM couldn&#x27;t be open? Nobody makes open-source TPMs (because they&#x27;re put inside CPUs or attached to motherboards with specific pins and protocols) but in theory you could just do it. All you need to do is make sure any secrets stored get wiped permanently whenever you flash new firmware.<p>It&#x27;d be similar to secure boot: usable by default, but reconfigurable so that you can bring your own keys and signatures, putting you in complete control of your hardware, to the point where even the manufacturer no longer has a say in what&#x27;s running and what isn&#x27;t.</div><br/><div id="42553767" class="c"><input type="checkbox" id="c-42553767" checked=""/><div class="controls bullet"><span class="by">eddythompson80</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553563">parent</a><span>|</span><a href="#42554207">next</a><span>|</span><label class="collapse" for="c-42553767">[-]</label><label class="expand" for="c-42553767">[1 more]</label></div><br/><div class="children"><div class="content">You can make your own HSM using a raspberry pi pico <a href="https:&#x2F;&#x2F;www.picokeys.com&#x2F;pico-hsm&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.picokeys.com&#x2F;pico-hsm&#x2F;</a><p>&gt;  usable by default, but reconfigurable so that you can bring your own keys and signatures, putting you in complete control of your hardware, to the point where even the manufacturer no longer has a say in what&#x27;s running and what isn&#x27;t.<p>You can control what&#x27;s your TPM. That&#x27;s how they work today. Sure their software isn&#x27;t &quot;open source&quot; but there aren&#x27;t that many 100% &quot;open source hardware&quot; options around. If you want to be able to flash it, build your own HSM. I don&#x27;t know if there is a market for a prebuilt microcontroller with something like picokeys preinstalled. I know that the market for &quot;open&quot; hardware is tough.</div><br/></div></div><div id="42554207" class="c"><input type="checkbox" id="c-42554207" checked=""/><div class="controls bullet"><span class="by">tremon</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553563">parent</a><span>|</span><a href="#42553767">prev</a><span>|</span><a href="#42553909">next</a><span>|</span><label class="collapse" for="c-42554207">[-]</label><label class="expand" for="c-42554207">[1 more]</label></div><br/><div class="children"><div class="content">An open TPM does exist: <a href="https:&#x2F;&#x2F;www.qemu.org&#x2F;docs&#x2F;master&#x2F;specs&#x2F;tpm.html#the-qemu-tpm-emulator-device" rel="nofollow">https:&#x2F;&#x2F;www.qemu.org&#x2F;docs&#x2F;master&#x2F;specs&#x2F;tpm.html#the-qemu-tpm...</a><p>The TPM emulation offers a full TPM implementation in software, for providing TPM functionality to a virtual machine when the host doesn&#x27;t have one (or, when the TPM needs to be virtualized for other reasons, e.g. migration).</div><br/></div></div><div id="42553909" class="c"><input type="checkbox" id="c-42553909" checked=""/><div class="controls bullet"><span class="by">raron</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553563">parent</a><span>|</span><a href="#42554207">prev</a><span>|</span><a href="#42555454">next</a><span>|</span><label class="collapse" for="c-42553909">[-]</label><label class="expand" for="c-42553909">[9 more]</label></div><br/><div class="children"><div class="content">&gt; I don&#x27;t see why a TPM couldn&#x27;t be open? Nobody makes open-source TPMs<p>The main advantage of the TPM is how it is made physically. It should be designed to make it hard or impossible to read the secrets out of it and those things depends on how the components are manufactured on the silicon wafer.<p>Maybe the manufacturing process could be published, but I don&#x27;t think it would help much.<p>You could probably write your own TPM emulator or modify swtpm a bit and compile it to any microcontroller, but in that case the chip could be easily decapped to make all the secrets readable.</div><br/><div id="42554381" class="c"><input type="checkbox" id="c-42554381" checked=""/><div class="controls bullet"><span class="by">varispeed</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553909">parent</a><span>|</span><a href="#42555454">next</a><span>|</span><label class="collapse" for="c-42554381">[-]</label><label class="expand" for="c-42554381">[8 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a definition of security by obscurity.</div><br/><div id="42554833" class="c"><input type="checkbox" id="c-42554833" checked=""/><div class="controls bullet"><span class="by">PhilipRoman</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554381">parent</a><span>|</span><a href="#42554854">next</a><span>|</span><label class="collapse" for="c-42554833">[-]</label><label class="expand" for="c-42554833">[1 more]</label></div><br/><div class="children"><div class="content">Unlike with cryptography, there is no rigorous notion of physical security. Doors, locks and even security systems can all be overcome with sufficient effort, skill and resources. They work because physical attacks require proximity and are very hard to keep anonymous. I seriously doubt that any TPM implementation would last a week against government funded researchers with state of the art technology, but that doesn&#x27;t mean the TPM is useless.</div><br/></div></div><div id="42554854" class="c"><input type="checkbox" id="c-42554854" checked=""/><div class="controls bullet"><span class="by">raron</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554381">parent</a><span>|</span><a href="#42554833">prev</a><span>|</span><a href="#42555432">next</a><span>|</span><label class="collapse" for="c-42554854">[-]</label><label class="expand" for="c-42554854">[1 more]</label></div><br/><div class="children"><div class="content">Some of these features makes it harder to (physically) probe the internal parts of the chip and read out secret values:<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Secure_cryptoprocessor#Features" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Secure_cryptoprocessor#Feature...</a><p>These things make it harder to break into the internals of the chip regardless of they being kept secret, so I wouldn&#x27;t call it security by obscurity. I&#x27;m not even sure you can apply that principle to physical security.</div><br/></div></div><div id="42555432" class="c"><input type="checkbox" id="c-42555432" checked=""/><div class="controls bullet"><span class="by">rcxdude</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554381">parent</a><span>|</span><a href="#42554854">prev</a><span>|</span><a href="#42555236">next</a><span>|</span><label class="collapse" for="c-42555432">[-]</label><label class="expand" for="c-42555432">[1 more]</label></div><br/><div class="children"><div class="content">No, it&#x27;s security by intrusion detection, generally. HSMs are designed to be boxes that it&#x27;s very hard to get a secret out of with physical access. TPMs generally aren&#x27;t the most paranoid version, but it gets more expensive and less practical as you go further (e.g. a large box which has a battery backup, keeps the secrets in RAM, and will wipe them as soon at it detects any funny business. These are DIYable, but the list of tricks by attackers is long and it&#x27;s hard to cover all of them at once). A TPM is generally somewhere in between that and a regular micro with no particular effort to prevent readout of internal storage, in that they are small, can persist secrets without power, but are still difficult to attack physically (~maybe at the level of advanced criminal organisations, ~probably at state level if they&#x27;re willing to spend some money on it, even absent a backdoor).</div><br/></div></div><div id="42555236" class="c"><input type="checkbox" id="c-42555236" checked=""/><div class="controls bullet"><span class="by">okanat</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554381">parent</a><span>|</span><a href="#42555432">prev</a><span>|</span><a href="#42554508">next</a><span>|</span><label class="collapse" for="c-42555236">[-]</label><label class="expand" for="c-42555236">[1 more]</label></div><br/><div class="children"><div class="content">Printing out your 2FA recovery keys and storing them in a safe also is.</div><br/></div></div><div id="42554508" class="c"><input type="checkbox" id="c-42554508" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554381">parent</a><span>|</span><a href="#42555236">prev</a><span>|</span><a href="#42555454">next</a><span>|</span><label class="collapse" for="c-42554508">[-]</label><label class="expand" for="c-42554508">[3 more]</label></div><br/><div class="children"><div class="content">Is a yubikey then employing security by obscurity?</div><br/><div id="42555142" class="c"><input type="checkbox" id="c-42555142" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554508">parent</a><span>|</span><a href="#42555454">next</a><span>|</span><label class="collapse" for="c-42555142">[-]</label><label class="expand" for="c-42555142">[2 more]</label></div><br/><div class="children"><div class="content">100%<p>They’re built from essentially the same secure MCUs as traditional TPMs and both the hardware and the proprietary crypto libraries used on them have been exploited many times over.</div><br/><div id="42557329" class="c"><input type="checkbox" id="c-42557329" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42555142">parent</a><span>|</span><a href="#42555454">next</a><span>|</span><label class="collapse" for="c-42557329">[-]</label><label class="expand" for="c-42557329">[1 more]</label></div><br/><div class="children"><div class="content">But would you not agree that using a yubikey can improve security?
If you chose to label TPMs as security by obscurity, so be it, but it doesn’t make them less useful conceptually. Shitty implementations and complexities of UEFI do that.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42555454" class="c"><input type="checkbox" id="c-42555454" checked=""/><div class="controls bullet"><span class="by">yx827ha</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553563">parent</a><span>|</span><a href="#42553909">prev</a><span>|</span><a href="#42554366">next</a><span>|</span><label class="collapse" for="c-42555454">[-]</label><label class="expand" for="c-42555454">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s in the works.
<a href="https:&#x2F;&#x2F;opentitan.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;opentitan.org&#x2F;</a></div><br/></div></div></div></div><div id="42554366" class="c"><input type="checkbox" id="c-42554366" checked=""/><div class="controls bullet"><span class="by">varispeed</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553505">parent</a><span>|</span><a href="#42553563">prev</a><span>|</span><a href="#42553519">next</a><span>|</span><label class="collapse" for="c-42554366">[-]</label><label class="expand" for="c-42554366">[3 more]</label></div><br/><div class="children"><div class="content">I am sorry I wasn&#x27;t clear. I am aware that TPM is a key storage. Just I am not convinced they keys it stores are secure. It smells of security by obscurity and all big corporations are happy clappy to use it and government is silent about it, which likely means they have a backdoor.</div><br/><div id="42554756" class="c"><input type="checkbox" id="c-42554756" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554366">parent</a><span>|</span><a href="#42554499">next</a><span>|</span><label class="collapse" for="c-42554756">[-]</label><label class="expand" for="c-42554756">[1 more]</label></div><br/><div class="children"><div class="content">&gt;It smells of security by obscurity and all big corporations are happy clappy to use it and government is silent about it, which likely means they have a backdoor.<p>The government is also pretty silent about AES. Does it mean that&#x27;s backdoored as well? More to the point, I&#x27;m not sure what the proposed alternative is. Not using TPM, and exposing yourself to bootkits and evil maid attacks?</div><br/></div></div><div id="42554499" class="c"><input type="checkbox" id="c-42554499" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42554366">parent</a><span>|</span><a href="#42554756">prev</a><span>|</span><a href="#42553519">next</a><span>|</span><label class="collapse" for="c-42554499">[-]</label><label class="expand" for="c-42554499">[1 more]</label></div><br/><div class="children"><div class="content">Lest one forget NSAKey! &#x2F;s<p>This type of &#x2F;r&#x2F;ufos|&#x2F;r&#x2F;aliens speculation isn&#x27;t particularly useful. It comes with no evidence of TPMs being backdoor&#x27;ed. Have they been compromised [at least pre-2.0]? Yes, in as much as Apple&#x27;s Secure Enclave has as an example.<p>Gut feelings aren&#x27;t always correct and for topics which have a sort of &#x27;correctness&#x27; about them, they&#x27;re not useful.<p>Otherwise we&#x27;re debating to prove a negative.</div><br/></div></div></div></div></div></div><div id="42553519" class="c"><input type="checkbox" id="c-42553519" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553363">parent</a><span>|</span><a href="#42553505">prev</a><span>|</span><a href="#42553432">next</a><span>|</span><label class="collapse" for="c-42553519">[-]</label><label class="expand" for="c-42553519">[1 more]</label></div><br/><div class="children"><div class="content">Maybe it&#x27;s different for you, but I don&#x27;t think any three letter agencies have some kind of TPM backdoor (they don&#x27;t need to with how often TPM chips end up being vulnerable to common software exploits, the firmware being written in unsafe languages and all). If a government was going after me with enough force to use their TPM bypass trick, I&#x27;d probably be in jail for years on fake allegations regardless of encryption status.<p>TPMs work great against things like common thieves and probably corporate espionage, if set up well. When implemented well, they provide no additional friction (except for having to store a recovery key somewhere) but all the security against a laptop being stolen at the airport you could wish for.</div><br/></div></div><div id="42553432" class="c"><input type="checkbox" id="c-42553432" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553363">parent</a><span>|</span><a href="#42553519">prev</a><span>|</span><a href="#42553452">next</a><span>|</span><label class="collapse" for="c-42553432">[-]</label><label class="expand" for="c-42553432">[1 more]</label></div><br/><div class="children"><div class="content">Should be good enough for a personal tablet used for mail and browsing. If I drop it and someone curious finds it, I&#x27;d like to make it impossible for them to extract anything useful.</div><br/></div></div><div id="42553452" class="c"><input type="checkbox" id="c-42553452" checked=""/><div class="controls bullet"><span class="by">cheschire</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553363">parent</a><span>|</span><a href="#42553432">prev</a><span>|</span><a href="#42552911">next</a><span>|</span><label class="collapse" for="c-42553452">[-]</label><label class="expand" for="c-42553452">[2 more]</label></div><br/><div class="children"><div class="content">I prefer to think of TPM as equivalent to the chip in a smart card.</div><br/><div id="42556452" class="c"><input type="checkbox" id="c-42556452" checked=""/><div class="controls bullet"><span class="by">mikepurvis</span><span>|</span><a href="#42553275">root</a><span>|</span><a href="#42553452">parent</a><span>|</span><a href="#42552911">next</a><span>|</span><label class="collapse" for="c-42556452">[-]</label><label class="expand" for="c-42556452">[1 more]</label></div><br/><div class="children"><div class="content">I think this is a good analogue. A smart card is a challenge-response system where sure you could extract the inner key, but doing so would take time and require destroying the card, which would alert the user— we all learned years ago about skimming and now the payment terminal comes to our table rather than the card being carried off elsewhere.<p>TPM is one piece of a larger puzzle and provides a middle ground where among other things you can get full disk encryption without needing to input a memorized key on every boot.</div><br/></div></div></div></div></div></div></div></div><div id="42552911" class="c"><input type="checkbox" id="c-42552911" checked=""/><div class="controls bullet"><span class="by">jandrese</span><span>|</span><a href="#42553275">prev</a><span>|</span><a href="#42557262">next</a><span>|</span><label class="collapse" for="c-42552911">[-]</label><label class="expand" for="c-42552911">[27 more]</label></div><br/><div class="children"><div class="content">Fundamentally I don&#x27;t understand BitLocker&#x27;s security model.  In most installs it seems like you power on the machine by pressing the power button and it boots into Windows.<p>So if someone steals you machine with an encrypted hard drive they need to...just turn it on?  That can&#x27;t be right, but at the same time I have no idea how this particular attack is defeated.  I have to assume the traffic over the SPI bus is encrypted so the key can&#x27;t just be dumped like that, but it seems like the machine is going to give up the key pretty easily regardless.<p>With LUKS it at least has a password prompt to unlock the drive.</div><br/><div id="42552955" class="c"><input type="checkbox" id="c-42552955" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42553629">next</a><span>|</span><label class="collapse" for="c-42552955">[-]</label><label class="expand" for="c-42552955">[14 more]</label></div><br/><div class="children"><div class="content">&gt; I have to assume the traffic over the SPI bus is encrypted so the key can&#x27;t just be dumped like that<p>It&#x27;s not. For some reason, Microsoft don&#x27;t use TPM parameter encryption, even though every year or two some security researcher or another comes up with another stunt TPM-sniffing device to parade around.<p>&gt; With LUKS it at least has a password prompt to unlock the drive.<p>Configuration dependent. You can set up Linux to do the same thing as Windows here (I have my home video-security server set up this way, as it needs to reboot silently - I know that I&#x27;m vulnerable to warm&#x2F;coldboot attack and software attack surface, but at least if someone yoinks the drive I&#x27;m safe), and Windows can also be configured to prompt for a password or use PIN-authenticated TPM sealed keys.<p>&gt; Fundamentally I don&#x27;t understand BitLocker&#x27;s security model.<p>Minus the parameter encryption &#x2F; bus-sniffing issue, it moves the boundary from &quot;anyone can read your drive&quot; to &quot;someone needs to either perform a platform-level attack to access the contents of memory, or hack whatever services are running at the login screen to read your drive.&quot; It&#x27;s a decent security improvement, actually, because it protects very well against stuff like &quot;someone stole our financial data off of a random recycled hard drive.&quot;</div><br/><div id="42553588" class="c"><input type="checkbox" id="c-42553588" checked=""/><div class="controls bullet"><span class="by">raron</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42552955">parent</a><span>|</span><a href="#42553629">next</a><span>|</span><label class="collapse" for="c-42553588">[-]</label><label class="expand" for="c-42553588">[13 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s not. For some reason, Microsoft don&#x27;t use TPM parameter encryption, even though every year or two some security researcher or another comes up with another stunt TPM-sniffing device to parade around.<p>AFAIK it is useless, there is no way the TPM could authenticate the CPU. You could always desolder the TPM chip, send the correct data for updating PCRs and get the sealed key.</div><br/><div id="42556023" class="c"><input type="checkbox" id="c-42556023" checked=""/><div class="controls bullet"><span class="by">kryogen1c</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553588">parent</a><span>|</span><a href="#42554328">next</a><span>|</span><label class="collapse" for="c-42556023">[-]</label><label class="expand" for="c-42556023">[1 more]</label></div><br/><div class="children"><div class="content">&gt; AFAIK it is useless<p>&quot;Useless&quot; is grossly incorrect. Bitlocker is not invincible, but it lowers your threat surface by a huge %.<p>In real terms: if i get your unbitlockered hard drive, i own your shit. It&#x27;s not a hack you pay crypto for on the dark web, it&#x27;s a trivial compromise that every person in IT has known for at least a decade. If you google it, you&#x27;ll find it. Ring 0 access to all nonbitlockered windows installs. Takes like 2 minutes and a usb or cd.<p>With bitlocker, at least every idiot on the planet can&#x27;t login to your profile; that&#x27;s not nothing</div><br/></div></div><div id="42554328" class="c"><input type="checkbox" id="c-42554328" checked=""/><div class="controls bullet"><span class="by">tremon</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553588">parent</a><span>|</span><a href="#42556023">prev</a><span>|</span><a href="#42553634">next</a><span>|</span><label class="collapse" for="c-42554328">[-]</label><label class="expand" for="c-42554328">[2 more]</label></div><br/><div class="children"><div class="content">That&#x27;s the same kind of useless as &quot;I don&#x27;t have a front door. You could always drive through it with your car and get inside that way&quot;, right?</div><br/><div id="42555752" class="c"><input type="checkbox" id="c-42555752" checked=""/><div class="controls bullet"><span class="by">Dalewyn</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42554328">parent</a><span>|</span><a href="#42553634">next</a><span>|</span><label class="collapse" for="c-42555752">[-]</label><label class="expand" for="c-42555752">[1 more]</label></div><br/><div class="children"><div class="content">Considering security &quot;researchers&quot; absolutely love to make cataclysmic mountains out of vulnerabilities that require local, physical access as the first step?<p>Yes, it&#x27;s the same kind of useless.</div><br/></div></div></div></div><div id="42553634" class="c"><input type="checkbox" id="c-42553634" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553588">parent</a><span>|</span><a href="#42554328">prev</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42553634">[-]</label><label class="expand" for="c-42553634">[7 more]</label></div><br/><div class="children"><div class="content">It&#x27;s one of those &quot;useless in theory but extremely meaningful in practicality&quot; things, IMO. Getting the correct PCRs is going to be a whole lot harder than putting a sniffer on the LPC. It takes the attack from something that random TikTok security &quot;influencers&quot; sell devices for to something which requires meaningful effort.</div><br/><div id="42553827" class="c"><input type="checkbox" id="c-42553827" checked=""/><div class="controls bullet"><span class="by">raron</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553634">parent</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42553827">[-]</label><label class="expand" for="c-42553827">[6 more]</label></div><br/><div class="children"><div class="content">Using Bitlocker with a PIN solves that.<p>Anyways on many modern system the TPM is often just part of the firmware running on a secure part of the CPU and probing the signals in the chip is probably outsider of the budget of TikTok influencers.</div><br/><div id="42553976" class="c"><input type="checkbox" id="c-42553976" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553827">parent</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42553976">[-]</label><label class="expand" for="c-42553976">[5 more]</label></div><br/><div class="children"><div class="content">&gt; Using Bitlocker with a PIN solves that.<p>At an enormous cost of having to remember and enter a PIN - not practical for corporate IT due to the propensity for forgetting and not practical for offline server use.<p>&gt; Anyways on many modern system the TPM is often just part of the firmware running on a secure part of the CPU<p>On AMD this is almost 100% prevalent, yes.<p>On Intel platforms a physical TPM is still common and PTT (firmware TPM) is usually disabled by default for some reason - a user&#x2F;manager would usually have to re-select it in the BIOS. On desktop platforms I think PTT runs externally in the PCH, too, which is off-package and connected over DMI (I think on most mobile parts PCH is a separate on-package die). I don&#x27;t think anyone has done research on how the fTPM part of PCH &lt;-&gt; CPU comms work on modern Intel platforms; this has always seemed like a fun topic for a deep dive and talk to me, but I&#x27;ve never had the time.<p>I don&#x27;t think either of these things excuses the lack of encrypted parameter support from BitLocker, though. I&#x27;d love to know why Microsoft continue not to use it. The only reason I&#x27;ve ever seen given is &quot;it was deemed too complex &#x2F; has an attack surface,&quot; which is an interesting idea but quite bunk when UEFI is already in the picture IMO.</div><br/><div id="42554307" class="c"><input type="checkbox" id="c-42554307" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553976">parent</a><span>|</span><a href="#42555563">next</a><span>|</span><label class="collapse" for="c-42554307">[-]</label><label class="expand" for="c-42554307">[1 more]</label></div><br/><div class="children"><div class="content">The Intel PCH is on-package exposed via [DMI] PCIe lane while AMD&#x27;s fTPM is on-die.<p>It would be unusual for any current device to have a discrete TPM, at least in the consumer space given current x86 processors have an fTPM.</div><br/></div></div><div id="42555563" class="c"><input type="checkbox" id="c-42555563" checked=""/><div class="controls bullet"><span class="by">wat10000</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553976">parent</a><span>|</span><a href="#42554307">prev</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42555563">[-]</label><label class="expand" for="c-42555563">[3 more]</label></div><br/><div class="children"><div class="content">I haven’t used Windows since the XP days. Does Windows not have a login password? Or does something make it require a separate disk PIN and not just encrypt the drive with the login password? macOS does the latter and it seems like an obvious approach.</div><br/><div id="42556178" class="c"><input type="checkbox" id="c-42556178" checked=""/><div class="controls bullet"><span class="by">briHass</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42555563">parent</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42556178">[-]</label><label class="expand" for="c-42556178">[2 more]</label></div><br/><div class="children"><div class="content">In this case, they&#x27;re talking about the Bitlocker disk encryption PIN, which is in _addition_ to the Windows password, or more common now, PIN. You can set them both to the same thing if you choose.<p>The disk PIN on boot is uncommon&#x2F;harder to do for home users, but it&#x27;s a common setup in the corpo world. Enforced by AD, or Intune.</div><br/><div id="42556442" class="c"><input type="checkbox" id="c-42556442" checked=""/><div class="controls bullet"><span class="by">wat10000</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42556178">parent</a><span>|</span><a href="#42554555">next</a><span>|</span><label class="collapse" for="c-42556442">[-]</label><label class="expand" for="c-42556442">[1 more]</label></div><br/><div class="children"><div class="content">A disk PIN shouldn’t add much extra security, though, unless the login password isn’t actually used to key the encryption.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="42554555" class="c"><input type="checkbox" id="c-42554555" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553588">parent</a><span>|</span><a href="#42553634">prev</a><span>|</span><a href="#42556462">next</a><span>|</span><label class="collapse" for="c-42554555">[-]</label><label class="expand" for="c-42554555">[1 more]</label></div><br/><div class="children"><div class="content">TPM is now in firmware and has been for quite a few years on Intel and AMD processors; Intel&#x27;s on the PCH which is on-package and AMD&#x27;s on-die.<p>This isn&#x27;t true for all implementations of TPM, but for AMD&#x2F;Intel&#x2F;Qualcomm where BitLocker is relevant, fTPM is used.</div><br/></div></div><div id="42556462" class="c"><input type="checkbox" id="c-42556462" checked=""/><div class="controls bullet"><span class="by">mikepurvis</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553588">parent</a><span>|</span><a href="#42554555">prev</a><span>|</span><a href="#42553629">next</a><span>|</span><label class="collapse" for="c-42556462">[-]</label><label class="expand" for="c-42556462">[1 more]</label></div><br/><div class="children"><div class="content">All modern CPUs now have it on-die, so doing a replay attack against desoldered TPMs is no longer a thing.</div><br/></div></div></div></div></div></div><div id="42553629" class="c"><input type="checkbox" id="c-42553629" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42552955">prev</a><span>|</span><a href="#42552956">next</a><span>|</span><label class="collapse" for="c-42553629">[-]</label><label class="expand" for="c-42553629">[1 more]</label></div><br/><div class="children"><div class="content">&gt; So if someone steals you machine with an encrypted hard drive they need to...just turn it on?<p>That&#x27;d bring them to a login screen. Without your password or biometrics, they&#x27;re not getting past that. They&#x27;ll have to figure out some kind of workaround (like a RCE exploit, or booting an old, vulnerable Windows bootloader somehow) because they can&#x27;t do the usual &quot;replace the software keyboard with cmd.exe&quot; workaround as the drive remains locked.<p>Without Bitlocker, you can plug a Windows drive into your PC and browse all the files. With Bitlocker, you need to faff about with exploits and vulnerable Microsoft software and dumped memory, and even that doesn&#x27;t always work.<p>With Bitlocker configured in TPM+PIN mode, you can&#x27;t even do that, as you don&#x27;t have the password to unlock the TPM. You could also put Bitlocker in password-only mode, but that&#x27;s much easier to brute-force. Same goes for LUKS, by the way, which also supports TPM and TPM+PIN in most Linux distros these days.</div><br/></div></div><div id="42552956" class="c"><input type="checkbox" id="c-42552956" checked=""/><div class="controls bullet"><span class="by">sebazzz</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42553629">prev</a><span>|</span><a href="#42553031">next</a><span>|</span><label class="collapse" for="c-42552956">[-]</label><label class="expand" for="c-42552956">[2 more]</label></div><br/><div class="children"><div class="content">&gt; So if someone steals you machine with an encrypted hard drive they need to...just turn it on? That can&#x27;t be right, but at the same time I have no idea how this particular attack is defeated.<p>Yes, but the idea is that from the login screen (winlogon) you really can&#x27;t do much unless you actually have account credentials on the computer - or are bio-metrically enrolled into the computer* - and if you attempt to reboot to safe mode, or reboot to a different OS (or firmware update utility, etc) you do need to enter the Bitlocker recovery key.<p>* I&#x27;m not sure how it works in terms of &quot;hacking&quot; fingerprint sensors or face recognition webcams.</div><br/><div id="42553063" class="c"><input type="checkbox" id="c-42553063" checked=""/><div class="controls bullet"><span class="by">rzzzt</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42552956">parent</a><span>|</span><a href="#42553031">next</a><span>|</span><label class="collapse" for="c-42553063">[-]</label><label class="expand" for="c-42553063">[1 more]</label></div><br/><div class="children"><div class="content">You also can&#x27;t look at the encrypted drive&#x27;s contents if you connect it to a different machine.</div><br/></div></div></div></div><div id="42553031" class="c"><input type="checkbox" id="c-42553031" checked=""/><div class="controls bullet"><span class="by">bangaladore</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42552956">prev</a><span>|</span><a href="#42553040">next</a><span>|</span><label class="collapse" for="c-42553031">[-]</label><label class="expand" for="c-42553031">[1 more]</label></div><br/><div class="children"><div class="content">The primary purpose of Bitlocker (when used with a PIN + TPM) is it makes a powered off computer or a drive itself as good as a brick. Assuming the TPM doesn&#x27;t have any key extraction vulnerabilities.<p>Keyword is powered off.<p>With any general purpose drive encryption, the TPM doesn&#x27;t actually decrypt the bulk of the data as its too slow so the OS eventually ends up with a key that is extractable.</div><br/></div></div><div id="42553040" class="c"><input type="checkbox" id="c-42553040" checked=""/><div class="controls bullet"><span class="by">rzzzt</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42553031">prev</a><span>|</span><a href="#42553229">next</a><span>|</span><label class="collapse" for="c-42553040">[-]</label><label class="expand" for="c-42553040">[5 more]</label></div><br/><div class="children"><div class="content">BitLocker volumes can have multiple protectors; you can use a key file, a passphrase, PIN or TPM storage: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows-server&#x2F;administration&#x2F;windows-commands&#x2F;manage-bde-protectors" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows-server&#x2F;administrat...</a><p>In Pro editions it is also possible to require an interactive step at boot time via group policy (this also works if you have no TPM available), then it will ask for a password on each startup.</div><br/><div id="42553137" class="c"><input type="checkbox" id="c-42553137" checked=""/><div class="controls bullet"><span class="by">tonetegeatinst</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553040">parent</a><span>|</span><a href="#42553229">next</a><span>|</span><label class="collapse" for="c-42553137">[-]</label><label class="expand" for="c-42553137">[4 more]</label></div><br/><div class="children"><div class="content">While I am aware of bitlocker in general, I don&#x27;t have a full grasp of it.  Just how secure is it from a software of hardware attack?<p>It was my understanding that veracrypt was considered more tested than bitlocker due to the lack of backdoors or workarounds. Can anoyone point me at some good resources regarding this?</div><br/><div id="42553194" class="c"><input type="checkbox" id="c-42553194" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553137">parent</a><span>|</span><a href="#42553229">next</a><span>|</span><label class="collapse" for="c-42553194">[-]</label><label class="expand" for="c-42553194">[3 more]</label></div><br/><div class="children"><div class="content">It depends on the mode you&#x27;re using. If you use the transparent unlock functionality (the default) then it&#x27;s vulnerable to hardware key extraction. If you use anything else (PIN, password, whatever) then I&#x27;m not aware of any weaknesses or workarounds. I&#x27;m certainly not aware of any backdoors.</div><br/><div id="42554719" class="c"><input type="checkbox" id="c-42554719" checked=""/><div class="controls bullet"><span class="by">aspenmayer</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42553194">parent</a><span>|</span><a href="#42553229">next</a><span>|</span><label class="collapse" for="c-42554719">[-]</label><label class="expand" for="c-42554719">[2 more]</label></div><br/><div class="children"><div class="content">I think with a Microsoft account login on Windows 10&#x2F;11, BitLocker recovery keys are synced to your Microsoft account and can be viewed from your Microsoft account device settings. They may also be present on Active Directory so there may be some vulnerabilities on any of those avenues which may be easier to circumvent than BitLocker itself.</div><br/><div id="42555248" class="c"><input type="checkbox" id="c-42555248" checked=""/><div class="controls bullet"><span class="by">vel0city</span><span>|</span><a href="#42552911">root</a><span>|</span><a href="#42554719">parent</a><span>|</span><a href="#42553229">next</a><span>|</span><label class="collapse" for="c-42555248">[-]</label><label class="expand" for="c-42555248">[1 more]</label></div><br/><div class="children"><div class="content">Syncing keys to OneDrive is optional, at least on the Pro versions of Windows.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42553229" class="c"><input type="checkbox" id="c-42553229" checked=""/><div class="controls bullet"><span class="by">buran77</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42553040">prev</a><span>|</span><a href="#42554930">next</a><span>|</span><label class="collapse" for="c-42553229">[-]</label><label class="expand" for="c-42553229">[1 more]</label></div><br/><div class="children"><div class="content">&gt; With LUKS it at least has a password prompt to unlock the drive.<p>BitLocker should ideally be used with a PIN&#x2F;password too. This means the key isn&#x27;t decrypted until the correct PIN is entered. No SPI sniffing, UEFI exploits, or memory dump would help the attacker in this preboot state. BitLocker with TPM and PIN is a pretty powerful combination.<p>But by default, without any second factor, BitLocker is two parts convenience and one part security. Probably the price of user adoption.</div><br/></div></div><div id="42554930" class="c"><input type="checkbox" id="c-42554930" checked=""/><div class="controls bullet"><span class="by">arzig</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42553229">prev</a><span>|</span><a href="#42555327">next</a><span>|</span><label class="collapse" for="c-42554930">[-]</label><label class="expand" for="c-42554930">[1 more]</label></div><br/><div class="children"><div class="content">The threat model is getting the decrypted data.<p>If someone steals the device and removes the drive the data is encrypted.<p>If someone steals the device and powers it on, the os that wrote the encrypted data (and is presumably secured) can enforce login authorization which the thieves presumably cannot bypass.<p>Both of these are big ifs, but the installed os won’t just divulge the contents of the disk so the trick is locking down the disk so  that it’s easy for the installed os to access but becomes useless if the disk is removed from the computer.<p>All of this depends on the TPM implementation not being trash, which integrated instances help with. Ultimately this is a trade off for convenience. I don’t worry about random thieves probing the buses in my computer to get my tax info, so I don’t use luks’ other stuff.</div><br/></div></div><div id="42555327" class="c"><input type="checkbox" id="c-42555327" checked=""/><div class="controls bullet"><span class="by">okanat</span><span>|</span><a href="#42552911">parent</a><span>|</span><a href="#42554930">prev</a><span>|</span><a href="#42557262">next</a><span>|</span><label class="collapse" for="c-42555327">[-]</label><label class="expand" for="c-42555327">[1 more]</label></div><br/><div class="children"><div class="content">Auto unlock only happens with a TPM. You couple TPM with encrypted RAM, Secure Boot and tamper-detecting erase. So if they remove the bottom cover, TPM is cleared and you need to enter the recovery key. Encrypted RAM prevents extracting secrets from sleep state. All corporate laptops have these features (and also remote erase &#x2F; destroy with Intel ME &#x2F; AMT). A correctly setup system will cover almost all of the attacks in physical nature.  Of course they can still find exploits in logon screen. It is good enough security combined with convenience. It is more secure than letting normies (and lazy techies) use 12345678 as the pin.</div><br/></div></div></div></div><div id="42557262" class="c"><input type="checkbox" id="c-42557262" checked=""/><div class="controls bullet"><span class="by">ibbtown</span><span>|</span><a href="#42552911">prev</a><span>|</span><a href="#42552703">next</a><span>|</span><label class="collapse" for="c-42557262">[-]</label><label class="expand" for="c-42557262">[1 more]</label></div><br/><div class="children"><div class="content">Having a surface 5 pro laying around here, with a bitlocker encrypted disk, which turns quickly into a BSOD during boot. 
Do you think it could work in auch situation? I&#x27;m still waiting for an exploit to the tom to extract some pictures from the disk</div><br/></div></div><div id="42552703" class="c"><input type="checkbox" id="c-42552703" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42557262">prev</a><span>|</span><a href="#42556972">next</a><span>|</span><label class="collapse" for="c-42552703">[-]</label><label class="expand" for="c-42552703">[22 more]</label></div><br/><div class="children"><div class="content">This is entirely defeated by <a href="https:&#x2F;&#x2F;trustedcomputinggroup.org&#x2F;resource&#x2F;pc-client-work-group-platform-reset-attack-mitigation-specification&#x2F;" rel="nofollow">https:&#x2F;&#x2F;trustedcomputinggroup.org&#x2F;resource&#x2F;pc-client-work-gr...</a> - if enabled, if the OS isn&#x27;t cleanly shut down (giving it an opportunity to wipe encryption keys) the firmware will pause to wipe RAM before booting anything else on next boot. Does Windows not make use of this, or did the tested system not implement it?</div><br/><div id="42552977" class="c"><input type="checkbox" id="c-42552977" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552703">parent</a><span>|</span><a href="#42553622">next</a><span>|</span><label class="collapse" for="c-42552977">[-]</label><label class="expand" for="c-42552977">[5 more]</label></div><br/><div class="children"><div class="content">Purportedly Windows makes use of this, FWIW: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating-system-security&#x2F;data-protection&#x2F;bitlocker&#x2F;countermeasures" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating...</a><p>&quot;BitLocker uses the TCG Reset Attack Mitigation, also known as MOR bit (Memory Overwrite Request), before extracting keys into memory.&quot;<p>I would extremely not trust most platform implementation of TCG Reset Attack Mitigation, though. I&#x27;ve never seen a UEFI platform that is even close to correctly implemented in any form. It would be interesting to know which platform this researcher was working with, and whether it purports to support the MOR bit or not.</div><br/><div id="42554863" class="c"><input type="checkbox" id="c-42554863" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42552977">parent</a><span>|</span><a href="#42553084">next</a><span>|</span><label class="collapse" for="c-42554863">[-]</label><label class="expand" for="c-42554863">[1 more]</label></div><br/><div class="children"><div class="content">&gt;However, this measure can still be circumvented by removing the memory module from the system and reading it back on another system under the attacker&#x27;s control that does not support these measures<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cold_boot_attack" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cold_boot_attack</a></div><br/></div></div><div id="42553084" class="c"><input type="checkbox" id="c-42553084" checked=""/><div class="controls bullet"><span class="by">bangaladore</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42552977">parent</a><span>|</span><a href="#42554863">prev</a><span>|</span><a href="#42553622">next</a><span>|</span><label class="collapse" for="c-42553084">[-]</label><label class="expand" for="c-42553084">[3 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;BitLocker uses the TCG Reset Attack Mitigation, also known as MOR bit (Memory Overwrite Request), before extracting keys into memory.&quot;<p>(Edit: No this is a UEFI request to clear memory. Below is incorrect.)<p>I don&#x27;t think this is what the commenter was mentioning. I think this essentially makes it only possible to extract the key from the TPM once and then the TPM needs to be powered off and back on to get it again.<p>The TPM has no control over whats in the system memory, so if they key is in system memory, no TPM mitigations are going to help.<p>UEFI firmware must support clearing the keys from RAM.</div><br/><div id="42553140" class="c"><input type="checkbox" id="c-42553140" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553084">parent</a><span>|</span><a href="#42553622">next</a><span>|</span><label class="collapse" for="c-42553140">[-]</label><label class="expand" for="c-42553140">[2 more]</label></div><br/><div class="children"><div class="content">This is exactly what I was mentioning. Despite being a TCG spec, it&#x27;s implemented in firmware and has no hard requirement on a TPM at all.</div><br/><div id="42553364" class="c"><input type="checkbox" id="c-42553364" checked=""/><div class="controls bullet"><span class="by">bangaladore</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553140">parent</a><span>|</span><a href="#42553622">next</a><span>|</span><label class="collapse" for="c-42553364">[-]</label><label class="expand" for="c-42553364">[1 more]</label></div><br/><div class="children"><div class="content">Okay, thanks for the correction.<p>The naming there is definitely confusing. Particularly as it sounds like a key attribute bit.</div><br/></div></div></div></div></div></div></div></div><div id="42553622" class="c"><input type="checkbox" id="c-42553622" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42552703">parent</a><span>|</span><a href="#42552977">prev</a><span>|</span><a href="#42552785">next</a><span>|</span><label class="collapse" for="c-42553622">[-]</label><label class="expand" for="c-42553622">[9 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a very stupid mitigation as you can mess with RAM during the overwrite. Heck, see how Team Tweezers originally exploited the Wii.<p>The real mitigation is the memory encryption feature of modern CPUs. Being on-die means tweezers won&#x27;t reach, and being just a key means the wipe is instant and very difficult to mess with even if it survived a power cycle.</div><br/><div id="42554413" class="c"><input type="checkbox" id="c-42554413" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553622">parent</a><span>|</span><a href="#42552785">next</a><span>|</span><label class="collapse" for="c-42554413">[-]</label><label class="expand" for="c-42554413">[8 more]</label></div><br/><div class="children"><div class="content">It would entirely prevent the described attack. Related attacks may still be possible, but are also significantly harder than simply booting off USB.</div><br/><div id="42554483" class="c"><input type="checkbox" id="c-42554483" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42554413">parent</a><span>|</span><a href="#42555733">next</a><span>|</span><label class="collapse" for="c-42554483">[-]</label><label class="expand" for="c-42554483">[5 more]</label></div><br/><div class="children"><div class="content">After reading the article again, I think this might be an actual interesting Windows vulnerability - rather than a platform issue with MOR, I think this might be bad Windows code where the key is left over in places that aren&#x27;t protected by MOR. It&#x27;s quite unclear the more I think about it what&#x27;s going on here, and the article lacks detail. It&#x27;s very suspicious to me that the key has disappeared from the `ksecdd` pool but remains in the `dumpfve` pool, and this has my bug spidey-sense tingling.<p>I&#x27;m surprised given that the article mentions stepping into the boot process and `SymCryptSessionDestroy` that they didn&#x27;t look more deeply into this; it&#x27;s not how I really intended to spend my new years but I might have a new debugging project now...</div><br/><div id="42555438" class="c"><input type="checkbox" id="c-42555438" checked=""/><div class="controls bullet"><span class="by">NoInitRD</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42554483">parent</a><span>|</span><a href="#42556300">next</a><span>|</span><label class="collapse" for="c-42555438">[-]</label><label class="expand" for="c-42555438">[2 more]</label></div><br/><div class="children"><div class="content">Hello! I&#x27;m the author of the article and I actually did look into that. I used windbg and stepped through the process of windows booting up to the point of expecting a password. I also looked at what happens when you trigger bitlocker in a way where it requests a recovery key.<p>I really only did this so I could verify when&#x2F;whereish the key ends up in memory, so I didn&#x27;t follow along every single step of the way. I can tell you that SymCrypt succeeds in zeroing out the key multiple times in several places. Thats why I was shocked to find the key left over completely intact in ExAllocatePool allocations, but what I&#x27;m guessing is that Microsoft is not accounting for every possible place the key can end up when they&#x27;re destroying secrets.<p>Based on previous attacks like this I suspect that Microsoft also employs some &quot;security through obscurity&quot; tactics when they modify BitLocker. What I mean by that is I think there is a lot of just moving the key around so its a little harder to find...</div><br/><div id="42555463" class="c"><input type="checkbox" id="c-42555463" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42555438">parent</a><span>|</span><a href="#42556300">next</a><span>|</span><label class="collapse" for="c-42555463">[-]</label><label class="expand" for="c-42555463">[1 more]</label></div><br/><div class="children"><div class="content">Nice. This might be eligible for a bug bounty for you (if you want to deal with it). I think it’s not by design.</div><br/></div></div></div></div><div id="42556300" class="c"><input type="checkbox" id="c-42556300" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42554483">parent</a><span>|</span><a href="#42555438">prev</a><span>|</span><a href="#42555733">next</a><span>|</span><label class="collapse" for="c-42556300">[-]</label><label class="expand" for="c-42556300">[2 more]</label></div><br/><div class="children"><div class="content">MOR should be wiping everything, especially since after a cold boot the firmware has no idea what the previous memory map was. But I can imagine a universe where it doesn&#x27;t wipe the boot services heap space (because some of that is obviously in use) and maybe a copy is hanging out there in a predictable way?</div><br/><div id="42556701" class="c"><input type="checkbox" id="c-42556701" checked=""/><div class="controls bullet"><span class="by">NoInitRD</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42556300">parent</a><span>|</span><a href="#42555733">next</a><span>|</span><label class="collapse" for="c-42556701">[-]</label><label class="expand" for="c-42556701">[1 more]</label></div><br/><div class="children"><div class="content">This is my understanding of whats going on.</div><br/></div></div></div></div></div></div><div id="42555733" class="c"><input type="checkbox" id="c-42555733" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42554413">parent</a><span>|</span><a href="#42554483">prev</a><span>|</span><a href="#42552785">next</a><span>|</span><label class="collapse" for="c-42555733">[-]</label><label class="expand" for="c-42555733">[2 more]</label></div><br/><div class="children"><div class="content">Fair enough, but I&#x27;ll still hold that wiping all system RAM is a comparatively dumb and slow solution even in this specific scenario. :)</div><br/><div id="42556310" class="c"><input type="checkbox" id="c-42556310" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42555733">parent</a><span>|</span><a href="#42552785">next</a><span>|</span><label class="collapse" for="c-42556310">[-]</label><label class="expand" for="c-42556310">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s something that&#x27;s only triggered in the event of an unclean reboot so under normal circumstances it should be irrelevant and trying to be more elegant potentially increases risk?</div><br/></div></div></div></div></div></div></div></div><div id="42552785" class="c"><input type="checkbox" id="c-42552785" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42552703">parent</a><span>|</span><a href="#42553622">prev</a><span>|</span><a href="#42556972">next</a><span>|</span><label class="collapse" for="c-42552785">[-]</label><label class="expand" for="c-42552785">[7 more]</label></div><br/><div class="children"><div class="content">This still won&#x27;t prevent yoinking the entire RAM modules and dumping them offline.<p>Ideally, the keys should just remain inside the SRAM cache on the CPU, never even going outside of the CPU die.</div><br/><div id="42553113" class="c"><input type="checkbox" id="c-42553113" checked=""/><div class="controls bullet"><span class="by">bangaladore</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42552785">parent</a><span>|</span><a href="#42553968">next</a><span>|</span><label class="collapse" for="c-42553113">[-]</label><label class="expand" for="c-42553113">[3 more]</label></div><br/><div class="children"><div class="content">&gt; This still won&#x27;t prevent yoinking the entire RAM modules and dumping them offline.<p>Theoretically no, but realistically I doubt even intel agencies can pull this off.<p>&gt; Ideally, the keys should just remain inside the SRAM cache on the CPU, never even going outside of the CPU die.<p>The real solution is putting the keys somewhere with a guarantee they will be gone prior to possibly executing untrusted code. In my mind the only real solution is UEFI APIs to support this (or wiping the ram as shown here). But then you have to trust the UEFI vendors which don&#x27;t exactly have stellar track records.</div><br/><div id="42553242" class="c"><input type="checkbox" id="c-42553242" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553113">parent</a><span>|</span><a href="#42553968">next</a><span>|</span><label class="collapse" for="c-42553242">[-]</label><label class="expand" for="c-42553242">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Theoretically no, but realistically I doubt even intel agencies can pull this off.<p>For older LPDDR3 it&#x27;s completely practical, see <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=nTvIQDe0rQU" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=nTvIQDe0rQU</a> . It definitely gets harder with newer systems, though.<p>&gt; In my mind the only real solution is UEFI APIs to support this (or wiping the ram as shown here). But then you have to trust the UEFI vendors which don&#x27;t exactly have stellar track records.<p>This already exists: it&#x27;s the MOR bit and it&#x27;s supposed to be in play here.<p>I actually think that having a CPU scratchpad key area which is guaranteed to be wiped across any reset action is a much better idea than trusting any dumpster fire UEFI implementation of anything, ever. At least you&#x27;re trusting a few CPU vendors with something you can audit that way, rather than a million different cobbled-together junky firmware blobs.</div><br/><div id="42553406" class="c"><input type="checkbox" id="c-42553406" checked=""/><div class="controls bullet"><span class="by">bangaladore</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553242">parent</a><span>|</span><a href="#42553968">next</a><span>|</span><label class="collapse" for="c-42553406">[-]</label><label class="expand" for="c-42553406">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I actually think that having a CPU scratchpad key area which is guaranteed to be wiped across any reset action is a much better idea than trusting any dumpster fire UEFI implementation of anything, ever. At least you&#x27;re trusting a few CPU vendors with something you can audit that way, rather than a million different cobbled-together junky firmware blobs.<p>True. Given that the CPU is what&#x27;s resetting and running the UEFI code, you better hope it could recognize and clear a scratchpad reliably.</div><br/></div></div></div></div></div></div><div id="42553968" class="c"><input type="checkbox" id="c-42553968" checked=""/><div class="controls bullet"><span class="by">zebra_bong3</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42552785">parent</a><span>|</span><a href="#42553113">prev</a><span>|</span><a href="#42556972">next</a><span>|</span><label class="collapse" for="c-42553968">[-]</label><label class="expand" for="c-42553968">[3 more]</label></div><br/><div class="children"><div class="content">The issue is that any memory readable by a software directly has some kind of risks, including SRAM. Here is something something you might find interesting: <a href="https:&#x2F;&#x2F;forte-research.com&#x2F;UnTrustZone&#x2F;" rel="nofollow">https:&#x2F;&#x2F;forte-research.com&#x2F;UnTrustZone&#x2F;</a> There is no absolute security, but keeping secure memory away from software provides much better solution.</div><br/><div id="42554423" class="c"><input type="checkbox" id="c-42554423" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553968">parent</a><span>|</span><a href="#42554889">next</a><span>|</span><label class="collapse" for="c-42554423">[-]</label><label class="expand" for="c-42554423">[1 more]</label></div><br/><div class="children"><div class="content">Just have the CPU microcode clear SRAM whenever the CPU is booted</div><br/></div></div><div id="42554889" class="c"><input type="checkbox" id="c-42554889" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#42552703">root</a><span>|</span><a href="#42553968">parent</a><span>|</span><a href="#42554423">prev</a><span>|</span><a href="#42556972">next</a><span>|</span><label class="collapse" for="c-42554889">[-]</label><label class="expand" for="c-42554889">[1 more]</label></div><br/><div class="children"><div class="content">TrustZone is not a great solution here, the decryption needs to be fast, and this  really means that the key should be directly accessible to the kernel.<p>Having it only inside the cache SRAM mitigates all the offline attacks. SRAM immediately loses content on power disruption (its state is encoded in the current path, not in a capacitor charge). And it&#x27;s trivial to completely and unconditionally erase on boot.</div><br/></div></div></div></div></div></div></div></div><div id="42556972" class="c"><input type="checkbox" id="c-42556972" checked=""/><div class="controls bullet"><span class="by">ivraatiems</span><span>|</span><a href="#42552703">prev</a><span>|</span><a href="#42553407">next</a><span>|</span><label class="collapse" for="c-42556972">[-]</label><label class="expand" for="c-42556972">[2 more]</label></div><br/><div class="children"><div class="content">For any exploit which relies on reading a dump of the target machine&#x27;s memory, if you have physical access to said machine: How feasible is an &quot;interposer&quot; device that copies off or modifies data as it goes in and out of RAM?<p>I&#x27;m thinking of something like the old &quot;Action Replay&quot; devices for Gameboys, which modified memory from the game cartridge as it went into the system to be loaded (or executed in the case of code) in order to cheat in games. You slotted the cartridge into the Action Replay, then slotted the Action Replay into the Gameboy.<p>Could you do something similar between the RAM and the motherboard? Slot your ram into the device, slot the device into the motherboard, and capture the state of memory at any moment by simply watching how memory is read&#x2F;written? That way, you&#x27;d save yourself the hassle of manually powering off the machine and hoping the data you need is available?<p>I&#x27;m not an electrical engineer so maybe what I am proposing is completely infeasible - physical space and bandwidth limitations certainly seem likely. But is it possible?</div><br/><div id="42557302" class="c"><input type="checkbox" id="c-42557302" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42556972">parent</a><span>|</span><a href="#42553407">next</a><span>|</span><label class="collapse" for="c-42557302">[-]</label><label class="expand" for="c-42557302">[1 more]</label></div><br/><div class="children"><div class="content">In theory? Sure. In practice? Establishing DDR links involves a lot of negotiation between the memory controller and the RAM and being in a situation where you can maintain the same timings while also dumping data isn&#x27;t going to be easy. I wouldn&#x27;t expect this to be an off the shelf solution.</div><br/></div></div></div></div><div id="42553407" class="c"><input type="checkbox" id="c-42553407" checked=""/><div class="controls bullet"><span class="by">PhilippGille</span><span>|</span><a href="#42556972">prev</a><span>|</span><a href="#42557325">next</a><span>|</span><label class="collapse" for="c-42553407">[-]</label><label class="expand" for="c-42553407">[1 more]</label></div><br/><div class="children"><div class="content">Related 38C3 talk about Windows 11 BitLocker bypass: <a href="https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;38c3-windows-bitlocker-screwed-without-a-screwdriver" rel="nofollow">https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;38c3-windows-bitlocker-screwed-withou...</a></div><br/></div></div><div id="42557325" class="c"><input type="checkbox" id="c-42557325" checked=""/><div class="controls bullet"><span class="by">EVa5I7bHFq9mnYK</span><span>|</span><a href="#42553407">prev</a><span>|</span><a href="#42554763">next</a><span>|</span><label class="collapse" for="c-42557325">[-]</label><label class="expand" for="c-42557325">[1 more]</label></div><br/><div class="children"><div class="content">Why bitlocker specifically? Will GPG encryption survive if an attacker can dump the RAM at any moment while it encrypts a file?</div><br/></div></div><div id="42554763" class="c"><input type="checkbox" id="c-42554763" checked=""/><div class="controls bullet"><span class="by">NoInitRD</span><span>|</span><a href="#42557325">prev</a><span>|</span><a href="#42554112">next</a><span>|</span><label class="collapse" for="c-42554763">[-]</label><label class="expand" for="c-42554763">[3 more]</label></div><br/><div class="children"><div class="content">Hello everybody, I&#x27;m the author of the article. If you have any questions, please feel free to message me on this account. I had a lot of fun working on this and I really appreciate all of the engagement.</div><br/><div id="42555006" class="c"><input type="checkbox" id="c-42555006" checked=""/><div class="controls bullet"><span class="by">1970-01-01</span><span>|</span><a href="#42554763">parent</a><span>|</span><a href="#42554112">next</a><span>|</span><label class="collapse" for="c-42555006">[-]</label><label class="expand" for="c-42555006">[2 more]</label></div><br/><div class="children"><div class="content">This is an excellent write-up. It&#x27;s short and to the point, with links right where I would want them.</div><br/><div id="42555107" class="c"><input type="checkbox" id="c-42555107" checked=""/><div class="controls bullet"><span class="by">NoInitRD</span><span>|</span><a href="#42554763">root</a><span>|</span><a href="#42555006">parent</a><span>|</span><a href="#42554112">next</a><span>|</span><label class="collapse" for="c-42555107">[-]</label><label class="expand" for="c-42555107">[1 more]</label></div><br/><div class="children"><div class="content">Thank you so much for your compliment, and for reading it. I tried to make it as thorough and informative as possible.</div><br/></div></div></div></div></div></div><div id="42554112" class="c"><input type="checkbox" id="c-42554112" checked=""/><div class="controls bullet"><span class="by">layer8</span><span>|</span><a href="#42554763">prev</a><span>|</span><a href="#42556090">next</a><span>|</span><label class="collapse" for="c-42554112">[-]</label><label class="expand" for="c-42554112">[1 more]</label></div><br/><div class="children"><div class="content">It’s fairly well known that BitLocker only really protects a computer that is turned off, and also only if you configure BitLocker to require a boot password [0].<p>[0] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;BitLocker#TPM_alone_is_not_enough" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;BitLocker#TPM_alone_is_not_eno...</a></div><br/></div></div><div id="42556090" class="c"><input type="checkbox" id="c-42556090" checked=""/><div class="controls bullet"><span class="by">0xml</span><span>|</span><a href="#42554112">prev</a><span>|</span><a href="#42554303">next</a><span>|</span><label class="collapse" for="c-42556090">[-]</label><label class="expand" for="c-42556090">[1 more]</label></div><br/><div class="children"><div class="content">Related: Bypassing Bitlocker using a cheap logic analyzer on a Lenovo laptop
<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37249623">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37249623</a></div><br/></div></div><div id="42554303" class="c"><input type="checkbox" id="c-42554303" checked=""/><div class="controls bullet"><span class="by">RachelF</span><span>|</span><a href="#42556090">prev</a><span>|</span><a href="#42555377">next</a><span>|</span><label class="collapse" for="c-42554303">[-]</label><label class="expand" for="c-42554303">[3 more]</label></div><br/><div class="children"><div class="content">Windows has a proposed memory encryption option along with memory compression.<p>Both Intel and AMD are working on embedding this into their CPUs.<p>However, the target use appears to be servers with multiple VMs, not laptops.</div><br/><div id="42555020" class="c"><input type="checkbox" id="c-42555020" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42554303">parent</a><span>|</span><a href="#42554434">next</a><span>|</span><label class="collapse" for="c-42555020">[-]</label><label class="expand" for="c-42555020">[1 more]</label></div><br/><div class="children"><div class="content">Microsoft is moving more and more to virtualisation based security, including the ability to run “enclaves” for protecting specific pieces of software: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;win32&#x2F;trusted-execution&#x2F;vbs-enclaves" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;win32&#x2F;trusted-exec...</a>. I wouldn&#x27;t be surprised if they&#x27;ll soon leverage encrypted “VMs” as a means of storing secrets like these. All we need is wide general hardware availability on consumer platforms.<p>That said, previous side-channel attacks on CPUs have shown it possible to attack encrypted memory (<a href="https:&#x2F;&#x2F;www.usenix.org&#x2F;conference&#x2F;usenixsecurity21&#x2F;presentation&#x2F;li-mengyuan" rel="nofollow">https:&#x2F;&#x2F;www.usenix.org&#x2F;conference&#x2F;usenixsecurity21&#x2F;presentat...</a>), targetting the cache as the CPU decrypts memory for normal operation. While it&#x27;ll stop memory dumps from being effective, encrypted RAM won&#x27;t be the end of dumping keys from memory, especially for patient or highly-skilled attackers.</div><br/></div></div><div id="42554434" class="c"><input type="checkbox" id="c-42554434" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42554303">parent</a><span>|</span><a href="#42555020">prev</a><span>|</span><a href="#42555377">next</a><span>|</span><label class="collapse" for="c-42554434">[-]</label><label class="expand" for="c-42554434">[1 more]</label></div><br/><div class="children"><div class="content">Intel has this via their Total Memory Encryption feature today. Yes, geared towards VMs in the Windows ecosystem.<p><a href="https:&#x2F;&#x2F;techcommunity.microsoft.com&#x2F;blog&#x2F;windowsosplatform&#x2F;multi-key-total-memory-encryption-on-windows-11-22h2&#x2F;3683043" rel="nofollow">https:&#x2F;&#x2F;techcommunity.microsoft.com&#x2F;blog&#x2F;windowsosplatform&#x2F;m...</a><p>Memory compression has been around for ages, at least since Windows 10 RTM. All major operating systems have implemented this feature -- it has no relation to security, though.</div><br/></div></div></div></div><div id="42555377" class="c"><input type="checkbox" id="c-42555377" checked=""/><div class="controls bullet"><span class="by">shortsunblack</span><span>|</span><a href="#42554303">prev</a><span>|</span><a href="#42556994">next</a><span>|</span><label class="collapse" for="c-42555377">[-]</label><label class="expand" for="c-42555377">[1 more]</label></div><br/><div class="children"><div class="content">See the talk &quot;Recent TPM Security Enhancements to the Linux Kernel&quot; by a Microsoft engineer (I find this ironic) for recent Linux TPM security enhancements. New features add some transport security.<p><a href="https:&#x2F;&#x2F;youtu.be&#x2F;WK7NERQXh4I" rel="nofollow">https:&#x2F;&#x2F;youtu.be&#x2F;WK7NERQXh4I</a></div><br/></div></div><div id="42556994" class="c"><input type="checkbox" id="c-42556994" checked=""/><div class="controls bullet"><span class="by">wh_123</span><span>|</span><a href="#42555377">prev</a><span>|</span><a href="#42553316">next</a><span>|</span><label class="collapse" for="c-42556994">[-]</label><label class="expand" for="c-42556994">[1 more]</label></div><br/><div class="children"><div class="content">Reminds me the cold boot attack....</div><br/></div></div><div id="42553316" class="c"><input type="checkbox" id="c-42553316" checked=""/><div class="controls bullet"><span class="by">slicktux</span><span>|</span><a href="#42556994">prev</a><span>|</span><a href="#42552582">next</a><span>|</span><label class="collapse" for="c-42553316">[-]</label><label class="expand" for="c-42553316">[12 more]</label></div><br/><div class="children"><div class="content">Why are more people not using self encrypting drives?</div><br/><div id="42553607" class="c"><input type="checkbox" id="c-42553607" checked=""/><div class="controls bullet"><span class="by">vel0city</span><span>|</span><a href="#42553316">parent</a><span>|</span><a href="#42553603">next</a><span>|</span><label class="collapse" for="c-42553607">[-]</label><label class="expand" for="c-42553607">[3 more]</label></div><br/><div class="children"><div class="content">Seems like most of the big drive makers had pretty poor quality on the whole self encrypting part of it, at least last I saw a few years ago.</div><br/><div id="42553786" class="c"><input type="checkbox" id="c-42553786" checked=""/><div class="controls bullet"><span class="by">kotaKat</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553607">parent</a><span>|</span><a href="#42554709">next</a><span>|</span><label class="collapse" for="c-42553786">[-]</label><label class="expand" for="c-42553786">[1 more]</label></div><br/><div class="children"><div class="content">I blame the mess that was Wave Systems and the shitty meddlingware they built to try to manage it all.<p>The support experience was one of the absolute worst I’ve ever seen — and I was the guy on the end of the phone that had to say “thank you for calling Wave Systems Gold Support” having been given <i>zero documentation into what the product even did</i>, but being told we had to log tickets into MS Dynamics and pray that a Wave engineer would call a panicked locked out user back “soon”.</div><br/></div></div><div id="42554709" class="c"><input type="checkbox" id="c-42554709" checked=""/><div class="controls bullet"><span class="by">slicktux</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553607">parent</a><span>|</span><a href="#42553786">prev</a><span>|</span><a href="#42553603">next</a><span>|</span><label class="collapse" for="c-42554709">[-]</label><label class="expand" for="c-42554709">[1 more]</label></div><br/><div class="children"><div class="content">There are standards and a lot of the stigma comes for AT Password enclosures…</div><br/></div></div></div></div><div id="42553603" class="c"><input type="checkbox" id="c-42553603" checked=""/><div class="controls bullet"><span class="by">TiredOfLife</span><span>|</span><a href="#42553316">parent</a><span>|</span><a href="#42553607">prev</a><span>|</span><a href="#42553415">next</a><span>|</span><label class="collapse" for="c-42553603">[-]</label><label class="expand" for="c-42553603">[6 more]</label></div><br/><div class="children"><div class="content">After this <a href="https:&#x2F;&#x2F;borncity.com&#x2F;win&#x2F;2018&#x2F;11&#x2F;06&#x2F;ssd-vulnerability-breaks-bitlocker-encryption&#x2F;" rel="nofollow">https:&#x2F;&#x2F;borncity.com&#x2F;win&#x2F;2018&#x2F;11&#x2F;06&#x2F;ssd-vulnerability-breaks...</a><p>Microsoft patched out support for self encrypting drives.</div><br/><div id="42553662" class="c"><input type="checkbox" id="c-42553662" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553603">parent</a><span>|</span><a href="#42554003">next</a><span>|</span><label class="collapse" for="c-42553662">[-]</label><label class="expand" for="c-42553662">[4 more]</label></div><br/><div class="children"><div class="content">Quite dumb considering this was an issue with pretty much a single, low-cost consumer vendor (Crucial?).<p>If nothing else, use it in combination - the encryption of OPAL drives is always active anyway, all that changes when the feature is &quot;active&quot; is whether the key is stored as-is on the controller or whether its protected by a passphrase.</div><br/><div id="42556275" class="c"><input type="checkbox" id="c-42556275" checked=""/><div class="controls bullet"><span class="by">briHass</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553662">parent</a><span>|</span><a href="#42554647">next</a><span>|</span><label class="collapse" for="c-42556275">[-]</label><label class="expand" for="c-42556275">[1 more]</label></div><br/><div class="children"><div class="content">I like using OPAL on my low powered laptop (8th gen i3), since Bitlocker eats some of that prescious CPU. Testing showed the impact of BL to be about 20% worse for the write speed and somewhere around a few percent read.<p>Not earth shattering, but for SATA3 era SSDs, it&#x27;s not nothing either. The old 850 EVOs work well, and they&#x27;re quality disks IME.</div><br/></div></div><div id="42554647" class="c"><input type="checkbox" id="c-42554647" checked=""/><div class="controls bullet"><span class="by">p_ing</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553662">parent</a><span>|</span><a href="#42556275">prev</a><span>|</span><a href="#42554003">next</a><span>|</span><label class="collapse" for="c-42554647">[-]</label><label class="expand" for="c-42554647">[2 more]</label></div><br/><div class="children"><div class="content">Both Crucial and Samsung, which produce a significant number of OEM drives for the likes of Dell, HP, etc.</div><br/><div id="42555714" class="c"><input type="checkbox" id="c-42555714" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42554647">parent</a><span>|</span><a href="#42554003">next</a><span>|</span><label class="collapse" for="c-42555714">[-]</label><label class="expand" for="c-42555714">[1 more]</label></div><br/><div class="children"><div class="content">It was two entirely seperate vulnerabilities.<p>The Crucial drive did not have any association between the encryption key and the passphrase, making it possible to bypass encryption.<p>The Samsung drive had an issue where when setting a passphrase, wear leveling could cause the old unprotected key to still exist on a flash bank (not normally accessible) until that bank got reused.<p>Only one of them is horrible incompetence - the other is bad but fixable and expires on its own after a bit of use.</div><br/></div></div></div></div></div></div><div id="42554003" class="c"><input type="checkbox" id="c-42554003" checked=""/><div class="controls bullet"><span class="by">OptionOfT</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553603">parent</a><span>|</span><a href="#42553662">prev</a><span>|</span><a href="#42553415">next</a><span>|</span><label class="collapse" for="c-42554003">[-]</label><label class="expand" for="c-42554003">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s actually still in there.<p>Now, drives with eDrive, as MS calls it, are becoming harder to find. It is no longer advertised (as native 4k sectors aren&#x27;t either...). Soon it&#x27;ll be dropped all together.</div><br/></div></div></div></div><div id="42553415" class="c"><input type="checkbox" id="c-42553415" checked=""/><div class="controls bullet"><span class="by">varispeed</span><span>|</span><a href="#42553316">parent</a><span>|</span><a href="#42553603">prev</a><span>|</span><a href="#42552582">next</a><span>|</span><label class="collapse" for="c-42553415">[-]</label><label class="expand" for="c-42553415">[2 more]</label></div><br/><div class="children"><div class="content">Ages ago I had an external drive that had a controller with built in keys that encrypted the data in and out. Problem was that the controller was poorly made and one time upon connecting to the PC, the controller chip died and so the keys with it. It was impossible to recover the data, but the disk itself was perfectly fine. I bought a damaged drive with working controller and swapped it out and my drive worked again, however I had to format it, because new board had different keys. 
Since then I preferred to use software encryption and steered clear of drives that use any sort of hardware encryption. The risk of losing data was not worth it.</div><br/><div id="42553680" class="c"><input type="checkbox" id="c-42553680" checked=""/><div class="controls bullet"><span class="by">arghwhat</span><span>|</span><a href="#42553316">root</a><span>|</span><a href="#42553415">parent</a><span>|</span><a href="#42552582">next</a><span>|</span><label class="collapse" for="c-42553680">[-]</label><label class="expand" for="c-42553680">[1 more]</label></div><br/><div class="children"><div class="content">All SSD&#x27;s with OPAL are <i>always</i> encrypting your data. &quot;Enabling&quot; the feature just means that you change from a random on-device key to a key encrypted with your passphrase.<p>(Whenever you wipe the drive through OPAL, you&#x27;re just overwriting the key.)</div><br/></div></div></div></div></div></div><div id="42552582" class="c"><input type="checkbox" id="c-42552582" checked=""/><div class="controls bullet"><span class="by">3eb7988a1663</span><span>|</span><a href="#42553316">prev</a><span>|</span><a href="#42554245">next</a><span>|</span><label class="collapse" for="c-42552582">[-]</label><label class="expand" for="c-42552582">[12 more]</label></div><br/><div class="children"><div class="content">What was the hardware on which this was running? I thought DDR5 would be more resistant to this type of RAM attack.</div><br/><div id="42552668" class="c"><input type="checkbox" id="c-42552668" checked=""/><div class="controls bullet"><span class="by">Arnavion</span><span>|</span><a href="#42552582">parent</a><span>|</span><a href="#42554245">next</a><span>|</span><label class="collapse" for="c-42552668">[-]</label><label class="expand" for="c-42552668">[11 more]</label></div><br/><div class="children"><div class="content">This is not &quot;attacking&quot; RAM. A UEFI binary (or Linux kernel in the CCC demo which uses a different method to retain the key in memory) already has access to all the extents of physical memory. It just has to search it for the scribble leftover from the bootloader.<p>See <a href="https:&#x2F;&#x2F;github.com&#x2F;NoInitRD&#x2F;Memory-Dump-UEFI&#x2F;blob&#x2F;db4888dc056f9d9e10d34ca3541a55e325a8211d&#x2F;app&#x2F;Application.c#L119-L131">https:&#x2F;&#x2F;github.com&#x2F;NoInitRD&#x2F;Memory-Dump-UEFI&#x2F;blob&#x2F;db4888dc05...</a> and onwards.<p>Edit: Ah, I guess you&#x27;re referring to the fact that the reboot preserves RAM contents? DDR5 doesn&#x27;t change anything about that AFAIK.</div><br/><div id="42552868" class="c"><input type="checkbox" id="c-42552868" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552668">parent</a><span>|</span><a href="#42554245">next</a><span>|</span><label class="collapse" for="c-42552868">[-]</label><label class="expand" for="c-42552868">[10 more]</label></div><br/><div class="children"><div class="content">Indeed, however it should be noted that this is only a single attempt attack and which will trigger the tamper protection.<p>Changing the boot order, making changes to the BIOS or booting from an unsigned bootloader would trigger a bitlocker lockout.<p>This means that if you don’t get the keys on the first attempt you can’t just pass the machine back to the user and try again later since the next time it will boot it would boot into bitlocker recovery.<p>And even if the attack is successful the user will still be aware that something did happen so you are still better off with other physical attacks if they are still possible.</div><br/><div id="42552894" class="c"><input type="checkbox" id="c-42552894" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552868">parent</a><span>|</span><a href="#42554245">next</a><span>|</span><label class="collapse" for="c-42552894">[-]</label><label class="expand" for="c-42552894">[9 more]</label></div><br/><div class="children"><div class="content">Why? You&#x27;re not booting Windows again, and restoring the secure boot state and boot order to the original values will result in the PCR values being what they were before, so what&#x27;s changing that would force recovery mode?</div><br/><div id="42552969" class="c"><input type="checkbox" id="c-42552969" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552894">parent</a><span>|</span><a href="#42552998">next</a><span>|</span><label class="collapse" for="c-42552969">[-]</label><label class="expand" for="c-42552969">[7 more]</label></div><br/><div class="children"><div class="content">The TPM tracks the state of the secure boot and the bios, that log is stored in the TPM itself the next time you’ll try to boot into windows it will see that something happened and bitlocker will lock itself out.<p>Do this experiment.<p>Boot into any Linux live CD on a machine with bitlocker enabled.<p>Reboot and see what happens.</div><br/><div id="42553637" class="c"><input type="checkbox" id="c-42553637" checked=""/><div class="controls bullet"><span class="by">vel0city</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552969">parent</a><span>|</span><a href="#42553177">next</a><span>|</span><label class="collapse" for="c-42553637">[-]</label><label class="expand" for="c-42553637">[4 more]</label></div><br/><div class="children"><div class="content">I did that last night. It didn&#x27;t have any issues booting back into Windows after booting to a live USB.<p>I didn&#x27;t change any parameters of the Windows boot option or the rest of the system.</div><br/><div id="42554891" class="c"><input type="checkbox" id="c-42554891" checked=""/><div class="controls bullet"><span class="by">aspenmayer</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42553637">parent</a><span>|</span><a href="#42553177">next</a><span>|</span><label class="collapse" for="c-42554891">[-]</label><label class="expand" for="c-42554891">[3 more]</label></div><br/><div class="children"><div class="content">It seems that this is a property of TPM 1.2.<p>&gt; On devices with TPM 1.2, changing the BIOS or firmware boot device order<p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating-system-security&#x2F;data-protection&#x2F;bitlocker&#x2F;recovery-overview" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating...</a></div><br/><div id="42556283" class="c"><input type="checkbox" id="c-42556283" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42554891">parent</a><span>|</span><a href="#42555125">next</a><span>|</span><label class="collapse" for="c-42556283">[-]</label><label class="expand" for="c-42556283">[1 more]</label></div><br/><div class="children"><div class="content">Changing it will trigger recovery, changing it back to the original won&#x27;t</div><br/></div></div><div id="42555125" class="c"><input type="checkbox" id="c-42555125" checked=""/><div class="controls bullet"><span class="by">vel0city</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42554891">parent</a><span>|</span><a href="#42556283">prev</a><span>|</span><a href="#42553177">next</a><span>|</span><label class="collapse" for="c-42555125">[-]</label><label class="expand" for="c-42555125">[1 more]</label></div><br/><div class="children"><div class="content">Yeah I seem to recall every time I&#x27;ve done that it seems to auto boot fine when I change it back to what it was before.<p>And as mentioned it&#x27;s never had issues if I did a one off choice from the boot menu.</div><br/></div></div></div></div></div></div><div id="42553177" class="c"><input type="checkbox" id="c-42553177" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552969">parent</a><span>|</span><a href="#42553637">prev</a><span>|</span><a href="#42552998">next</a><span>|</span><label class="collapse" for="c-42553177">[-]</label><label class="expand" for="c-42553177">[2 more]</label></div><br/><div class="children"><div class="content">No, the TPM doesn&#x27;t retain PCR measurements over reboots, and the log (rather than the composite PCR value) is handled by the firmware and the OS and the TPM has no idea it exists.</div><br/><div id="42554794" class="c"><input type="checkbox" id="c-42554794" checked=""/><div class="controls bullet"><span class="by">aspenmayer</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42553177">parent</a><span>|</span><a href="#42552998">next</a><span>|</span><label class="collapse" for="c-42554794">[-]</label><label class="expand" for="c-42554794">[1 more]</label></div><br/><div class="children"><div class="content">It seems that this is a property of TPM 1.2.<p>&gt; On devices with TPM 1.2, changing the BIOS or firmware boot device order<p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating-system-security&#x2F;data-protection&#x2F;bitlocker&#x2F;recovery-overview" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;security&#x2F;operating...</a></div><br/></div></div></div></div></div></div><div id="42552998" class="c"><input type="checkbox" id="c-42552998" checked=""/><div class="controls bullet"><span class="by">MoreMoore</span><span>|</span><a href="#42552582">root</a><span>|</span><a href="#42552894">parent</a><span>|</span><a href="#42552969">prev</a><span>|</span><a href="#42554245">next</a><span>|</span><label class="collapse" for="c-42552998">[-]</label><label class="expand" for="c-42552998">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t matter if you change the settings back. I don&#x27;t know how it works, but something non-user configurable is changed that prompts Windows to require a reset of the TPM keys.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42554245" class="c"><input type="checkbox" id="c-42554245" checked=""/><div class="controls bullet"><span class="by">medlazik</span><span>|</span><a href="#42552582">prev</a><span>|</span><a href="#42553654">next</a><span>|</span><label class="collapse" for="c-42554245">[-]</label><label class="expand" for="c-42554245">[1 more]</label></div><br/><div class="children"><div class="content">Step 3: Boot from the USB Device<p>Game over, any laptop with data worth stealing will have this disabled in bios</div><br/></div></div><div id="42552992" class="c"><input type="checkbox" id="c-42552992" checked=""/><div class="controls bullet"><span class="by">maxo133</span><span>|</span><a href="#42553654">prev</a><span>|</span><a href="#42552487">next</a><span>|</span><label class="collapse" for="c-42552992">[-]</label><label class="expand" for="c-42552992">[8 more]</label></div><br/><div class="children"><div class="content">Too bad the author did not provide hardware specs. Such attack is even harder on DDR4 and DDR5 memory and most publications refer to legacy ram such as DDR3<p>&gt; In my experience I have had the most success restarting the system while Windows is loading but before the login screen has appeared, at least in the case of finding FVEK keys.<p>So what is this? It was supposed to be memory attack and he&#x27;s dumping the keys after someone unlocked it and it&#x27;s booting?<p>So this is just another theoretical attack where perfect conditions must be met.</div><br/><div id="42554061" class="c"><input type="checkbox" id="c-42554061" checked=""/><div class="controls bullet"><span class="by">tsimionescu</span><span>|</span><a href="#42552992">parent</a><span>|</span><a href="#42553012">next</a><span>|</span><label class="collapse" for="c-42554061">[-]</label><label class="expand" for="c-42554061">[1 more]</label></div><br/><div class="children"><div class="content">You seem to think it&#x27;s common to require a separate BitLocker unlock step. In reality, this is extremely rare: the vast majority of users have no idea about any of this and have BitLocker set to automatically unlock during system power on.<p>So this is a viable attack on many, many real-world systems. Adding a BitLocker password&#x2F;PIN is a mitigation that prevents this attack.<p>Note that BitLocker is still very useful even in this mode: it guarantees that someone who steals your laptop can&#x27;t just connect the disk to another system and read everything on it, unless they can actually extract the keys from RAM, or bypass Windows authentication - this attack allows them to do the former relatively easily.</div><br/></div></div><div id="42553012" class="c"><input type="checkbox" id="c-42553012" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552992">parent</a><span>|</span><a href="#42554061">prev</a><span>|</span><a href="#42554660">next</a><span>|</span><label class="collapse" for="c-42553012">[-]</label><label class="expand" for="c-42553012">[5 more]</label></div><br/><div class="children"><div class="content">This attack has nothing to do with the memory type; memory is never made cold or allowed to decay. The system is hot-restarted into UEFI. Ideally no memory refreshes are skipped.<p>I do wish they provided the hardware specs too, though, as this reflects an incorrect UEFI platform implementation of MOR.</div><br/><div id="42553043" class="c"><input type="checkbox" id="c-42553043" checked=""/><div class="controls bullet"><span class="by">maxo133</span><span>|</span><a href="#42552992">root</a><span>|</span><a href="#42553012">parent</a><span>|</span><a href="#42554660">next</a><span>|</span><label class="collapse" for="c-42553043">[-]</label><label class="expand" for="c-42553043">[4 more]</label></div><br/><div class="children"><div class="content">You are right, but i still have no idea what is the point of this article.<p>The guy unlocked the bitlocker, then restarted PC just before login screen appeared. He said that&#x27;s when he had most success. What sense does it make to restart and start looking for key in memory, when bitlocker has been just unlocked.</div><br/><div id="42553159" class="c"><input type="checkbox" id="c-42553159" checked=""/><div class="controls bullet"><span class="by">mjg59</span><span>|</span><a href="#42552992">root</a><span>|</span><a href="#42553043">parent</a><span>|</span><a href="#42553074">next</a><span>|</span><label class="collapse" for="c-42553159">[-]</label><label class="expand" for="c-42553159">[1 more]</label></div><br/><div class="children"><div class="content">I steal your Windows laptop. I want your data. I don&#x27;t have your credentials, so can&#x27;t login to Windows. I let your laptop boot to the point where Bitlocker is automatically unlocked, perform a hard reboot, dump the RAM, extract the keys, and can now decrypt your drive and extract your data.</div><br/></div></div><div id="42553074" class="c"><input type="checkbox" id="c-42553074" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42552992">root</a><span>|</span><a href="#42553043">parent</a><span>|</span><a href="#42553159">prev</a><span>|</span><a href="#42553304">next</a><span>|</span><label class="collapse" for="c-42553074">[-]</label><label class="expand" for="c-42553074">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What sense does it make to restart when bitlocker has been just unlocked.<p>You steal a laptop. You turn on the laptop. You reboot it into UEFI and steal the keys. This is bad for BitLocker. Ideally this is not possible because the MOR bit should cause the keys to be erased by the platform initialization before boot-from-USB is possible.</div><br/></div></div><div id="42553304" class="c"><input type="checkbox" id="c-42553304" checked=""/><div class="controls bullet"><span class="by">watermelon0</span><span>|</span><a href="#42552992">root</a><span>|</span><a href="#42553043">parent</a><span>|</span><a href="#42553074">prev</a><span>|</span><a href="#42554660">next</a><span>|</span><label class="collapse" for="c-42553304">[-]</label><label class="expand" for="c-42553304">[1 more]</label></div><br/><div class="children"><div class="content">Bitlocker is unlocked before you reach the login screen.<p>If I understand correctly, you need to start the PC, reboot just before the login screen appears, and boot to an USB application, which will copy the memory content.</div><br/></div></div></div></div></div></div><div id="42554660" class="c"><input type="checkbox" id="c-42554660" checked=""/><div class="controls bullet"><span class="by">NoInitRD</span><span>|</span><a href="#42552992">parent</a><span>|</span><a href="#42553012">prev</a><span>|</span><a href="#42552487">next</a><span>|</span><label class="collapse" for="c-42554660">[-]</label><label class="expand" for="c-42554660">[1 more]</label></div><br/><div class="children"><div class="content">Hey I&#x27;m the author. I did this on DDR4 RAM. Specifically, it was F4-3600C18D-32GVK in two slots and MD16GK2D4320016AXR in the other two.</div><br/></div></div></div></div><div id="42552487" class="c"><input type="checkbox" id="c-42552487" checked=""/><div class="controls bullet"><span class="by">tnetenbaa</span><span>|</span><a href="#42552992">prev</a><span>|</span><label class="collapse" for="c-42552487">[-]</label><label class="expand" for="c-42552487">[12 more]</label></div><br/><div class="children"><div class="content">BitLocker is crazy easy to bypass if you have physical access to the device. I work IT, and had to demonstrate to our head of security, that if you just pop in a Linux USB and boot from it, the drive is completely open.</div><br/><div id="42552528" class="c"><input type="checkbox" id="c-42552528" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552487">parent</a><span>|</span><a href="#42552504">next</a><span>|</span><label class="collapse" for="c-42552528">[-]</label><label class="expand" for="c-42552528">[3 more]</label></div><br/><div class="children"><div class="content">You should’ve enabled bitlocker first then…<p>The only thing that would be unencrypted is the system restore partition.</div><br/><div id="42552613" class="c"><input type="checkbox" id="c-42552613" checked=""/><div class="controls bullet"><span class="by">simondanerd</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552528">parent</a><span>|</span><a href="#42552504">next</a><span>|</span><label class="collapse" for="c-42552613">[-]</label><label class="expand" for="c-42552613">[2 more]</label></div><br/><div class="children"><div class="content">Correct, ran into this last night. Dislocker works though: <a href="https:&#x2F;&#x2F;github.com&#x2F;Aorimn&#x2F;dislocker">https:&#x2F;&#x2F;github.com&#x2F;Aorimn&#x2F;dislocker</a></div><br/><div id="42552777" class="c"><input type="checkbox" id="c-42552777" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552613">parent</a><span>|</span><a href="#42552504">next</a><span>|</span><label class="collapse" for="c-42552777">[-]</label><label class="expand" for="c-42552777">[1 more]</label></div><br/><div class="children"><div class="content">Dislocker does require you to have the keys tho it’s not a bypass.</div><br/></div></div></div></div></div></div><div id="42552504" class="c"><input type="checkbox" id="c-42552504" checked=""/><div class="controls bullet"><span class="by">Grazester</span><span>|</span><a href="#42552487">parent</a><span>|</span><a href="#42552528">prev</a><span>|</span><a href="#42553285">next</a><span>|</span><label class="collapse" for="c-42552504">[-]</label><label class="expand" for="c-42552504">[5 more]</label></div><br/><div class="children"><div class="content">Then the drive wasn&#x27;t encrypted!</div><br/><div id="42552537" class="c"><input type="checkbox" id="c-42552537" checked=""/><div class="controls bullet"><span class="by">connicpu</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552504">parent</a><span>|</span><a href="#42553285">next</a><span>|</span><label class="collapse" for="c-42552537">[-]</label><label class="expand" for="c-42552537">[4 more]</label></div><br/><div class="children"><div class="content">Presumably they chose the weakest option where it can boot without a pin&#x2F;password just using a key stored in the TPM.</div><br/><div id="42552587" class="c"><input type="checkbox" id="c-42552587" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552537">parent</a><span>|</span><a href="#42553285">next</a><span>|</span><label class="collapse" for="c-42552587">[-]</label><label class="expand" for="c-42552587">[3 more]</label></div><br/><div class="children"><div class="content">Even if you are using Transparent Operation Mode then it still will not work as bitlocker will not decrypt the drive and lock itself into recovery mode if you make changes to the boot order or any other BIOS &#x2F; UEFI changes.<p>It uses secure boot and it’s pretty darn decent at detecting any form of tampering.<p>TPM 2.0 isn’t particularly resilient against physical key extraction attacks but believe it or Microsoft did threat model this…</div><br/><div id="42552718" class="c"><input type="checkbox" id="c-42552718" checked=""/><div class="controls bullet"><span class="by">BuyMyBitcoins</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552587">parent</a><span>|</span><a href="#42553285">next</a><span>|</span><label class="collapse" for="c-42552718">[-]</label><label class="expand" for="c-42552718">[2 more]</label></div><br/><div class="children"><div class="content">This happened to me once. Sadly I had wiped the flash drive containing the recovery key months before the lockout without realizing it. Chide me if you must, but I certainly learned my lesson.<p>I tried a few non-hardware exploits, even CVE-2022-41099 about WinRE but to no avail.<p>I’m not a security pro, but I assume once it is in recovery mode lockout you’re pretty much out of luck. From what I can tell most other exploits require it to be unlocked in the first place. Even the hardware hacks seem to require a drive being in a non-lockdown state in order to sniff things during boot.<p>That NVMe drive is just a keepsake now. I plan to frame it and put it on my wall as a memento.</div><br/><div id="42552913" class="c"><input type="checkbox" id="c-42552913" checked=""/><div class="controls bullet"><span class="by">dogma1138</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42552718">parent</a><span>|</span><a href="#42553285">next</a><span>|</span><label class="collapse" for="c-42552913">[-]</label><label class="expand" for="c-42552913">[1 more]</label></div><br/><div class="children"><div class="content">This is why i use the key backup to OneDrive option.<p>My threat model is a lost or stolen device or RMA&#x2F;repair.<p>If someone wants my data so badly that they’ll be able get into my OneDrive account that is protected with a passkey or a 32 char password + MFA and also have physical access to my devices let them have it.<p>Anyone who is that determined and capable can always resort to rubber hose cryptography and I want none of that in my life.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42553285" class="c"><input type="checkbox" id="c-42553285" checked=""/><div class="controls bullet"><span class="by">davemtl</span><span>|</span><a href="#42552487">parent</a><span>|</span><a href="#42552504">prev</a><span>|</span><a href="#42552520">next</a><span>|</span><label class="collapse" for="c-42553285">[-]</label><label class="expand" for="c-42553285">[2 more]</label></div><br/><div class="children"><div class="content">This sounds like BitLocker wasn&#x27;t enabled on the drive. All of the laptops I&#x27;ve deployed with BitLocker are very good at detecting tampering and will immediately go into lockdown mode. A Linux USB most likely requires Secure Boot to be turned off to boot, if so, the TPM tamper will trigger and BitLocker will require the recovery key at next boot.</div><br/><div id="42556638" class="c"><input type="checkbox" id="c-42556638" checked=""/><div class="controls bullet"><span class="by">doodlesdev</span><span>|</span><a href="#42552487">root</a><span>|</span><a href="#42553285">parent</a><span>|</span><a href="#42552520">next</a><span>|</span><label class="collapse" for="c-42556638">[-]</label><label class="expand" for="c-42556638">[1 more]</label></div><br/><div class="children"><div class="content">&gt; A Linux USB most likely requires Secure Boot to be turned off to boot<p>That hasn&#x27;t been my experience. All the recent laptops I&#x27;ve owned (Dell and HP) had a default secure boot setup that allowed booting to Ubuntu and Fedora without disabling Secure Boot. In fact, nowadays even Ventoy works with Secure Boot [0], and I&#x27;ve managed to use it with the setting enabled on all machines I&#x27;ve tested, however in this case you might need to enroll the keys on the first boot, which I imagine will trigger BitLocker.<p>Apparently what happened is that Microsoft now signs some third party certs for common Linux distributions, and some setups allow these to boot by default. However, it also looks like Microsoft wants these certs disabled by default [1], which should improve BitLocker integrity on average.<p>Although I believe what happened in OP&#x27;s situation was that BitLocker wasn&#x27;t actually enabled or working, likely due to misconfiguration or lack of any.<p>[0]: <a href="https:&#x2F;&#x2F;www.ventoy.net&#x2F;en&#x2F;doc_secure.html" rel="nofollow">https:&#x2F;&#x2F;www.ventoy.net&#x2F;en&#x2F;doc_secure.html</a><p>[1]: <a href="https:&#x2F;&#x2F;www.omglinux.com&#x2F;boot-linux-modern-lenovo-thinkpads-bios-setting&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.omglinux.com&#x2F;boot-linux-modern-lenovo-thinkpads-...</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>