<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1732525268515" as="style"/><link rel="stylesheet" href="styles.css?v=1732525268515"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sloonz.github.io/posts/wireguard-beyond-basic-configuration/">WireGuard: Beyond the most basic configuration</a> <span class="domain">(<a href="https://sloonz.github.io">sloonz.github.io</a>)</span></div><div class="subtext"><span>yamrzou</span> | <span>93 comments</span></div><br/><div><div id="42229893" class="c"><input type="checkbox" id="c-42229893" checked=""/><div class="controls bullet"><span class="by">entangledqubit</span><span>|</span><a href="#42229749">next</a><span>|</span><label class="collapse" for="c-42229893">[-]</label><label class="expand" for="c-42229893">[3 more]</label></div><br/><div class="children"><div class="content">Not to hijack but last time I was setting up wireguard, I found this site to be super useful: <a href="https:&#x2F;&#x2F;www.procustodibus.com&#x2F;blog&#x2F;2020&#x2F;10&#x2F;wireguard-topologies&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.procustodibus.com&#x2F;blog&#x2F;2020&#x2F;10&#x2F;wireguard-topolog...</a></div><br/><div id="42234022" class="c"><input type="checkbox" id="c-42234022" checked=""/><div class="controls bullet"><span class="by">franga2000</span><span>|</span><a href="#42229893">parent</a><span>|</span><a href="#42232635">next</a><span>|</span><label class="collapse" for="c-42234022">[-]</label><label class="expand" for="c-42234022">[1 more]</label></div><br/><div class="children"><div class="content">+1 for this, any time I or a colleague have a wireguard issue that smells of &quot;you&#x27;re using it wrong&quot; I come back to this set of articles (don&#x27;t miss the links to separate detailed posts for each configuration!)</div><br/></div></div><div id="42232635" class="c"><input type="checkbox" id="c-42232635" checked=""/><div class="controls bullet"><span class="by">filterfish</span><span>|</span><a href="#42229893">parent</a><span>|</span><a href="#42234022">prev</a><span>|</span><a href="#42229749">next</a><span>|</span><label class="collapse" for="c-42232635">[-]</label><label class="expand" for="c-42232635">[1 more]</label></div><br/><div class="children"><div class="content">Their blog is an incredibly useful resource for so many different scenarios.</div><br/></div></div></div></div><div id="42229749" class="c"><input type="checkbox" id="c-42229749" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#42229893">prev</a><span>|</span><a href="#42230840">next</a><span>|</span><label class="collapse" for="c-42229749">[-]</label><label class="expand" for="c-42229749">[34 more]</label></div><br/><div class="children"><div class="content">Setting up a dynamic DNS record to map a hostname to my home network’s dynamic IP actually makes private VPN usable.  It’s really a game changer to be able to access all the local services and resources on the road without exposing them to the public internet.</div><br/><div id="42229832" class="c"><input type="checkbox" id="c-42229832" checked=""/><div class="controls bullet"><span class="by">leetrout</span><span>|</span><a href="#42229749">parent</a><span>|</span><a href="#42231384">next</a><span>|</span><label class="collapse" for="c-42229832">[-]</label><label class="expand" for="c-42229832">[17 more]</label></div><br/><div class="children"><div class="content">Are you using an internal or external service? Curious what you or others recommend...<p>I&#x27;ve done a bit of both... I used CloudFlare which works fine and then I moved over to tailscale when playing with pxe &#x2F; netboot and I&#x27;ve not decided on what to use beyond tailscale&#x27;s magic dns. Unbound looks pretty nice.</div><br/><div id="42230195" class="c"><input type="checkbox" id="c-42230195" checked=""/><div class="controls bullet"><span class="by">atmosx</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229832">parent</a><span>|</span><a href="#42230197">next</a><span>|</span><label class="collapse" for="c-42230195">[-]</label><label class="expand" for="c-42230195">[1 more]</label></div><br/><div class="children"><div class="content">Unbound is perfect. The CLI is very handy as it allows you invalidate specific domains from the local cache. I have had a good experience with dnsmasq and dnscrypt2 as well.</div><br/></div></div><div id="42230197" class="c"><input type="checkbox" id="c-42230197" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229832">parent</a><span>|</span><a href="#42230195">prev</a><span>|</span><a href="#42229879">next</a><span>|</span><label class="collapse" for="c-42230197">[-]</label><label class="expand" for="c-42230197">[5 more]</label></div><br/><div class="children"><div class="content">I’m using an internal machine for the VPN server and port forwarded to it from the router. I also have Tailscale set up but if I remember correctly Tailscale requires all devices participating in its VPN to install its software, which is too much.</div><br/><div id="42230703" class="c"><input type="checkbox" id="c-42230703" checked=""/><div class="controls bullet"><span class="by">windexh8er</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230197">parent</a><span>|</span><a href="#42230559">next</a><span>|</span><label class="collapse" for="c-42230703">[-]</label><label class="expand" for="c-42230703">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I also have Tailscale set up but if I remember correctly Tailscale requires all devices participating in its VPN to install its software, which is too much.<p>This isn&#x27;t true.  You can use Tailscale &quot;Subnet Routers&quot; to access devices within a network without the Tailscale software installed.  You still need one device to act as SR, but that would be a requirement for leveraging any traditional VPN as well.<p>[0] <a href="https:&#x2F;&#x2F;tailscale.com&#x2F;kb&#x2F;1019&#x2F;subnets" rel="nofollow">https:&#x2F;&#x2F;tailscale.com&#x2F;kb&#x2F;1019&#x2F;subnets</a></div><br/></div></div><div id="42230559" class="c"><input type="checkbox" id="c-42230559" checked=""/><div class="controls bullet"><span class="by">criddell</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230197">parent</a><span>|</span><a href="#42230703">prev</a><span>|</span><a href="#42229879">next</a><span>|</span><label class="collapse" for="c-42230559">[-]</label><label class="expand" for="c-42230559">[3 more]</label></div><br/><div class="children"><div class="content">Is that true? I’m not 100% sure, but I think I’ve printed while I was away from home and I only have Tailscale software installed on my AppleTV.</div><br/><div id="42231280" class="c"><input type="checkbox" id="c-42231280" checked=""/><div class="controls bullet"><span class="by">atonse</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230559">parent</a><span>|</span><a href="#42229879">next</a><span>|</span><label class="collapse" for="c-42231280">[-]</label><label class="expand" for="c-42231280">[2 more]</label></div><br/><div class="children"><div class="content">Wha... since when does Tailscale have an AppleTV subnet node!??! Those guys are on fire and I missed this.</div><br/><div id="42232182" class="c"><input type="checkbox" id="c-42232182" checked=""/><div class="controls bullet"><span class="by">genghisjahn</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231280">parent</a><span>|</span><a href="#42229879">next</a><span>|</span><label class="collapse" for="c-42232182">[-]</label><label class="expand" for="c-42232182">[1 more]</label></div><br/><div class="children"><div class="content">I use mine as my Tailscale exit node.</div><br/></div></div></div></div></div></div></div></div><div id="42229879" class="c"><input type="checkbox" id="c-42229879" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229832">parent</a><span>|</span><a href="#42230197">prev</a><span>|</span><a href="#42231073">next</a><span>|</span><label class="collapse" for="c-42229879">[-]</label><label class="expand" for="c-42229879">[5 more]</label></div><br/><div class="children"><div class="content">A pretty common setup is to have a public VPS&#x2F;dedicated server with wireguard&#x2F;openvpn hosted at some trusted company and use that as an entry&#x2F;exit point. It&#x27;s basically what Tailscale is (massively simplified, obviously).</div><br/><div id="42230571" class="c"><input type="checkbox" id="c-42230571" checked=""/><div class="controls bullet"><span class="by">vladvasiliu</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229879">parent</a><span>|</span><a href="#42230058">next</a><span>|</span><label class="collapse" for="c-42230571">[-]</label><label class="expand" for="c-42230571">[2 more]</label></div><br/><div class="children"><div class="content">As far as I understand it, that&#x27;s not how Tailscale works most of the time. The actual connection is established between the VPN nodes, and actual traffic doesn&#x27;t travel through Tailscale&#x27;s servers.<p>The VPS solution is usually the hub of a star-shaped network, so everything has to go through it, which may be limiting, given that, at least where I live, gigabit fiber is fairly widespread and reasonably priced. Most VPSs I see have less bandwidth than that.<p>There&#x27;s headscale which allows setting up tailscale with a private server: <a href="https:&#x2F;&#x2F;github.com&#x2F;juanfont&#x2F;headscale&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;juanfont&#x2F;headscale&#x2F;</a></div><br/><div id="42234027" class="c"><input type="checkbox" id="c-42234027" checked=""/><div class="controls bullet"><span class="by">smashed</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230571">parent</a><span>|</span><a href="#42230058">next</a><span>|</span><label class="collapse" for="c-42234027">[-]</label><label class="expand" for="c-42234027">[1 more]</label></div><br/><div class="children"><div class="content">Tailscale will fallback to tuns servers  which are dumb &quot;cloud&quot; relays if direct connection can&#x27;t be established.</div><br/></div></div></div></div><div id="42230058" class="c"><input type="checkbox" id="c-42230058" checked=""/><div class="controls bullet"><span class="by">mbreese</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229879">parent</a><span>|</span><a href="#42230571">prev</a><span>|</span><a href="#42231073">next</a><span>|</span><label class="collapse" for="c-42230058">[-]</label><label class="expand" for="c-42230058">[2 more]</label></div><br/><div class="children"><div class="content">I think what the original post was referring to was using their home (dynamic IP) network instead of a public VPS&#x2F;dedicated server. That’s what I used to do — I’d use Cloudflare’s dynamic DNS to keep my home IP up to date and have a dedicated VM running at home that handles Wireguard connections.<p>Now, I have found it easier to manage devices using Tailscale. Also, Tailscale makes it very easy to manage some very dynamic routing (managing connections to external VPNs that mandate different non-wireguard clients).<p>Sadly, I’ve hit some issues with using tailscale’s DNS provider (my work configured Mac doesn’t like to have the DNS server changed), so I still have some work to do on that side.</div><br/><div id="42230861" class="c"><input type="checkbox" id="c-42230861" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230058">parent</a><span>|</span><a href="#42231073">next</a><span>|</span><label class="collapse" for="c-42230861">[-]</label><label class="expand" for="c-42230861">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I think what the original post was referring to was using their home (dynamic IP) network instead of a public VPS&#x2F;dedicated server.<p>Personally, I wouldn&#x27;t let incoming traffic hit my home IP&#x2F;router by itself, that&#x27;s why I suggested having something in-between public internet and your local network.<p>But, any way that works obviously works, the rest is just details :)</div><br/></div></div></div></div></div></div><div id="42231073" class="c"><input type="checkbox" id="c-42231073" checked=""/><div class="controls bullet"><span class="by">philjohn</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229832">parent</a><span>|</span><a href="#42229879">prev</a><span>|</span><a href="#42231446">next</a><span>|</span><label class="collapse" for="c-42231073">[-]</label><label class="expand" for="c-42231073">[1 more]</label></div><br/><div class="children"><div class="content">Wireguard running on my router (Unifi Dream Machine Pro) - but I have a static IPv4 address, as well as a routed &#x2F;48 IPv6 block.<p>Anything that <i>needs</i> to be exposed to the internet (which was essentially TeslaMate during setup) through a cloudflare tunnel, which terminates on a server behind my router.</div><br/></div></div><div id="42231446" class="c"><input type="checkbox" id="c-42231446" checked=""/><div class="controls bullet"><span class="by">denkmoon</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42229832">parent</a><span>|</span><a href="#42231073">prev</a><span>|</span><a href="#42231384">next</a><span>|</span><label class="collapse" for="c-42231446">[-]</label><label class="expand" for="c-42231446">[4 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been very pleased with powerdns for my self hosted internal DNS services. It implements basically everything you want for even the most esoteric DNS setups, and IMO, quite sanely.</div><br/><div id="42232211" class="c"><input type="checkbox" id="c-42232211" checked=""/><div class="controls bullet"><span class="by">speakspokespok</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231446">parent</a><span>|</span><a href="#42231384">next</a><span>|</span><label class="collapse" for="c-42232211">[-]</label><label class="expand" for="c-42232211">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve tried many times to setup PowerDNS and never complete it because I get bogged down in the complexity. I saw they had an ansible &#x2F; terraform script for deployments. Do you just use the team&#x27;s docs or something else?</div><br/><div id="42232891" class="c"><input type="checkbox" id="c-42232891" checked=""/><div class="controls bullet"><span class="by">denkmoon</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42232211">parent</a><span>|</span><a href="#42231384">next</a><span>|</span><label class="collapse" for="c-42232891">[-]</label><label class="expand" for="c-42232891">[2 more]</label></div><br/><div class="children"><div class="content">Yeah just the PDNS docs. They&#x27;re excellent. I&#x27;ll admit my personal setup isn&#x27;t particularly complex, but I&#x27;m not sure how much more complex it can get. I&#x27;ve just got an authoritative server for `lan.` and two secondaries, all 3 using sqlite as their database.<p>I just added their debian repo and apt install&#x27;d the two packages (dnsdist and pdns-server). Set the respective config files appropriately (dnsdist is a little hard, but googling got me there) and bam. I&#x27;ve got dnsdist serving DoH, DoT, and plain port53 DNS with some ACLs, was really easy IMO.</div><br/><div id="42233377" class="c"><input type="checkbox" id="c-42233377" checked=""/><div class="controls bullet"><span class="by">speakspokespok</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42232891">parent</a><span>|</span><a href="#42231384">next</a><span>|</span><label class="collapse" for="c-42233377">[-]</label><label class="expand" for="c-42233377">[1 more]</label></div><br/><div class="children"><div class="content">Cool! I&#x27;ll have to try once more. That sounds a lot more reasonable than going straight to postgres.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42231384" class="c"><input type="checkbox" id="c-42231384" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#42229749">parent</a><span>|</span><a href="#42229832">prev</a><span>|</span><a href="#42231028">next</a><span>|</span><label class="collapse" for="c-42231384">[-]</label><label class="expand" for="c-42231384">[11 more]</label></div><br/><div class="children"><div class="content">Why would you need a dynamic DNS record though? Within the VPN you should feel free to hard code any address you want. You control the network after all. In my own VPN I&#x27;ve never had a need to have IP addresses changed.</div><br/><div id="42231429" class="c"><input type="checkbox" id="c-42231429" checked=""/><div class="controls bullet"><span class="by">denkmoon</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231384">parent</a><span>|</span><a href="#42231028">next</a><span>|</span><label class="collapse" for="c-42231429">[-]</label><label class="expand" for="c-42231429">[10 more]</label></div><br/><div class="children"><div class="content">Dynamic IP. Hard coding an address is exactly what we want to avoid.</div><br/><div id="42231542" class="c"><input type="checkbox" id="c-42231542" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231429">parent</a><span>|</span><a href="#42231028">next</a><span>|</span><label class="collapse" for="c-42231542">[-]</label><label class="expand" for="c-42231542">[9 more]</label></div><br/><div class="children"><div class="content">Let&#x27;s go one level deeper. Why do you need dynamic IP in your own private network?</div><br/><div id="42231561" class="c"><input type="checkbox" id="c-42231561" checked=""/><div class="controls bullet"><span class="by">jwiz</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231542">parent</a><span>|</span><a href="#42231788">next</a><span>|</span><label class="collapse" for="c-42231561">[-]</label><label class="expand" for="c-42231561">[7 more]</label></div><br/><div class="children"><div class="content">There is a dynamic IP on the external address, from their ISP.</div><br/><div id="42231715" class="c"><input type="checkbox" id="c-42231715" checked=""/><div class="controls bullet"><span class="by">NhanH</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231561">parent</a><span>|</span><a href="#42231788">next</a><span>|</span><label class="collapse" for="c-42231715">[-]</label><label class="expand" for="c-42231715">[6 more]</label></div><br/><div class="children"><div class="content">Yeah but you don&#x27;t use the external IP for the purpose of accessing your VPN (not via a DNS record anyway). I am also unclear on the purpose of the dynamic DNS.</div><br/><div id="42231820" class="c"><input type="checkbox" id="c-42231820" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231715">parent</a><span>|</span><a href="#42232810">next</a><span>|</span><label class="collapse" for="c-42231820">[-]</label><label class="expand" for="c-42231820">[2 more]</label></div><br/><div class="children"><div class="content">Your external IP is dynamic because the ISP can rotate it. You want to reach your home&#x27;s external IP to VPN in. One common way is to create a public DNS record that&#x27;s dynamically updated (by a cronjob or whatever) to always contain whatever IP your ISP last handed you.</div><br/><div id="42233099" class="c"><input type="checkbox" id="c-42233099" checked=""/><div class="controls bullet"><span class="by">Salgat</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231820">parent</a><span>|</span><a href="#42232810">next</a><span>|</span><label class="collapse" for="c-42233099">[-]</label><label class="expand" for="c-42233099">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s what I do. Just a cronjob on my TrueNAS server to query my IP and update my subdomain&#x27;s A record if my IP has changed. That way when a power outage happens and my IP gets rotated, it makes no difference.</div><br/></div></div></div></div><div id="42232810" class="c"><input type="checkbox" id="c-42232810" checked=""/><div class="controls bullet"><span class="by">denkmoon</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231715">parent</a><span>|</span><a href="#42231820">prev</a><span>|</span><a href="#42231812">next</a><span>|</span><label class="collapse" for="c-42232810">[-]</label><label class="expand" for="c-42232810">[1 more]</label></div><br/><div class="children"><div class="content">Really?<p>Imagine, if you will, the following scenario: I have a wireguard endpoint on my home router. The home router uses a residential ISP connection and I don&#x27;t want to pay $10&#x2F;mo for a static IP because my ISP is cheeky and expensive. I want to have my phone connect to said wireguard endpoint to establish a secure link. I don&#x27;t want to have to change my wireguard configuration on my phone every time my home IP changes.<p>So, I set my phone to peer with the wireguard endpoint on `home.denk.moon:1234`. Every time my home router&#x27;s external IP changes, it sends a dynamic DNS update to my DNS server such that `home.denk.moon` reflects the new IP for my router. Now, whenever my phone attempts to connect to wireguard, it will resolve that domain name, get the latest IP for my router, and connect.</div><br/></div></div><div id="42231812" class="c"><input type="checkbox" id="c-42231812" checked=""/><div class="controls bullet"><span class="by">ww520</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231715">parent</a><span>|</span><a href="#42232810">prev</a><span>|</span><a href="#42231788">next</a><span>|</span><label class="collapse" for="c-42231812">[-]</label><label class="expand" for="c-42231812">[2 more]</label></div><br/><div class="children"><div class="content">How do you connect your VPN with your phone when you travel on the road?</div><br/></div></div></div></div></div></div><div id="42231788" class="c"><input type="checkbox" id="c-42231788" checked=""/><div class="controls bullet"><span class="by">rkagerer</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42231542">parent</a><span>|</span><a href="#42231561">prev</a><span>|</span><a href="#42231028">next</a><span>|</span><label class="collapse" for="c-42231788">[-]</label><label class="expand" for="c-42231788">[1 more]</label></div><br/><div class="children"><div class="content">To find your private network when you&#x27;re away and plugged into a public one and the former&#x27;s IP may have changed.  I gather the OP is talking about discovering their public-facing address, not doling out IP&#x27;s on their internal VPN.<p>Don&#x27;t ask next &quot;Why do you need to know your home IP address?&quot;</div><br/></div></div></div></div></div></div></div></div><div id="42231028" class="c"><input type="checkbox" id="c-42231028" checked=""/><div class="controls bullet"><span class="by">paravz</span><span>|</span><a href="#42229749">parent</a><span>|</span><a href="#42231384">prev</a><span>|</span><a href="#42230792">next</a><span>|</span><label class="collapse" for="c-42231028">[-]</label><label class="expand" for="c-42231028">[1 more]</label></div><br/><div class="children"><div class="content">for example <a href="https:&#x2F;&#x2F;freedns.afraid.org&#x2F;dynamic&#x2F;" rel="nofollow">https:&#x2F;&#x2F;freedns.afraid.org&#x2F;dynamic&#x2F;</a> + cron job on router to periodically update dns record</div><br/></div></div><div id="42230792" class="c"><input type="checkbox" id="c-42230792" checked=""/><div class="controls bullet"><span class="by">smw</span><span>|</span><a href="#42229749">parent</a><span>|</span><a href="#42231028">prev</a><span>|</span><a href="#42230840">next</a><span>|</span><label class="collapse" for="c-42230792">[-]</label><label class="expand" for="c-42230792">[4 more]</label></div><br/><div class="children"><div class="content">Just give in and use tailscale, life is so much better on the dark side!</div><br/><div id="42230927" class="c"><input type="checkbox" id="c-42230927" checked=""/><div class="controls bullet"><span class="by">zakki</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230792">parent</a><span>|</span><a href="#42233418">next</a><span>|</span><label class="collapse" for="c-42230927">[-]</label><label class="expand" for="c-42230927">[1 more]</label></div><br/><div class="children"><div class="content">I prefer Zerotier approach in relation between account and devices.
In Zerotier for each device added, no need to login to Zerotier account. Just add the network ID and approve it from the account.
In Tailscale I have to login from each device to add it to the network.</div><br/></div></div><div id="42233418" class="c"><input type="checkbox" id="c-42233418" checked=""/><div class="controls bullet"><span class="by">irunmyownemail</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42230792">parent</a><span>|</span><a href="#42230927">prev</a><span>|</span><a href="#42230840">next</a><span>|</span><label class="collapse" for="c-42233418">[-]</label><label class="expand" for="c-42233418">[2 more]</label></div><br/><div class="children"><div class="content">Staying with Wireguard. The article, by the way, is about Wireguard, not an opinion piece comparing alternative technologies.</div><br/><div id="42233936" class="c"><input type="checkbox" id="c-42233936" checked=""/><div class="controls bullet"><span class="by">tapirl</span><span>|</span><a href="#42229749">root</a><span>|</span><a href="#42233418">parent</a><span>|</span><a href="#42230840">next</a><span>|</span><label class="collapse" for="c-42233936">[-]</label><label class="expand" for="c-42233936">[1 more]</label></div><br/><div class="children"><div class="content">@smw just says that tailscale is more convenient than dynamic DNS.</div><br/></div></div></div></div></div></div></div></div><div id="42230840" class="c"><input type="checkbox" id="c-42230840" checked=""/><div class="controls bullet"><span class="by">opk</span><span>|</span><a href="#42229749">prev</a><span>|</span><a href="#42233942">next</a><span>|</span><label class="collapse" for="c-42230840">[-]</label><label class="expand" for="c-42230840">[1 more]</label></div><br/><div class="children"><div class="content">This article implies that you have to use NAT with Wireguard which really isn&#x27;t the case at all. Normal subnet routing works fine provided your destination hosts know to use the wireguard server as the gateway for the wireguard subnet. Just configuring a static route on the normal default router is generally enough. Certainly, there are cases where NAT is useful, for example I redirect attempts to use public DNS to my local DNS.</div><br/></div></div><div id="42233942" class="c"><input type="checkbox" id="c-42233942" checked=""/><div class="controls bullet"><span class="by">zaptheimpaler</span><span>|</span><a href="#42230840">prev</a><span>|</span><a href="#42234353">next</a><span>|</span><label class="collapse" for="c-42233942">[-]</label><label class="expand" for="c-42233942">[3 more]</label></div><br/><div class="children"><div class="content">Im trying to set up a personal server with services that may be accessible from the web with a real domain name or only via Tailscale. I got the web part working with Caddy and mapping subdomains to services, but the problem is Tailscale Magic DNS doesn&#x27;t support subdomains.  I could try to host services on paths like &quot;blah.blah.ts.net&#x2F;svc1&quot; and strip the paths in Caddy but that causes all sorts of problems that you have to debug per service - like maybe links breaking, websockets breaking etc. So it seems subdomains are the only clean solution.<p>I don&#x27;t know much about this stuff but it seems the best way to circumvent this limitation is to create a private DNS server that can resolve any subdomains I want to the tailscale IP, so i&#x27;m working on getting pihole setup to do that.. is this a limitation of Wireguard? How do people set up this kind of network?</div><br/><div id="42234472" class="c"><input type="checkbox" id="c-42234472" checked=""/><div class="controls bullet"><span class="by">aborsy</span><span>|</span><a href="#42233942">parent</a><span>|</span><a href="#42234278">next</a><span>|</span><label class="collapse" for="c-42234472">[-]</label><label class="expand" for="c-42234472">[1 more]</label></div><br/><div class="children"><div class="content">If you have a domain, you simply a dns record for the Tailscale IP.<p>You can also run your own dns server, like a pihole or AdGuard, on your Tailscale network. There you define any dns record.</div><br/></div></div><div id="42234278" class="c"><input type="checkbox" id="c-42234278" checked=""/><div class="controls bullet"><span class="by">inapis</span><span>|</span><a href="#42233942">parent</a><span>|</span><a href="#42234472">prev</a><span>|</span><a href="#42234353">next</a><span>|</span><label class="collapse" for="c-42234278">[-]</label><label class="expand" for="c-42234278">[1 more]</label></div><br/><div class="children"><div class="content">If you don&#x27;t have a lot of services to access, you can hard code the tailscale IP address in &#x2F;etc&#x2F;hosts.<p>My personal &#x2F;etc&#x2F;hosts is at 10 services all hard coded since the internal IP address of a machine on tailscale is static. Way cheaper and easier to deal with than setting up a separate DNS resolver.<p>Of course that won&#x27;t work if you have hundreds or thousands of services to work with.</div><br/></div></div></div></div><div id="42234353" class="c"><input type="checkbox" id="c-42234353" checked=""/><div class="controls bullet"><span class="by">aborsy</span><span>|</span><a href="#42233942">prev</a><span>|</span><a href="#42230304">next</a><span>|</span><label class="collapse" for="c-42234353">[-]</label><label class="expand" for="c-42234353">[1 more]</label></div><br/><div class="children"><div class="content">Is Wireguard the best piece of software made in the last decade?</div><br/></div></div><div id="42230304" class="c"><input type="checkbox" id="c-42230304" checked=""/><div class="controls bullet"><span class="by">t0mas88</span><span>|</span><a href="#42234353">prev</a><span>|</span><a href="#42233514">next</a><span>|</span><label class="collapse" for="c-42230304">[-]</label><label class="expand" for="c-42230304">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m using wireguard with ipv6, the only thing that I never got to work is for wireguard to do ipv6 prefix delegation allowing devices to pick (and change) their own address like they do on a normal ethernet subnet.<p>I like the randomisation that normally happens to make it invisible which phone&#x2F;device in the subnet made each request.</div><br/><div id="42230728" class="c"><input type="checkbox" id="c-42230728" checked=""/><div class="controls bullet"><span class="by">jeroenhd</span><span>|</span><a href="#42230304">parent</a><span>|</span><a href="#42230454">next</a><span>|</span><label class="collapse" for="c-42230728">[-]</label><label class="expand" for="c-42230728">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know about PD, but I found that native clients will accept RAs over WireGuard just fine. I only have a &#x2F;64 at the moment unfortunately, so I can&#x27;t really use this mechanism at the moment, but I did set up a ULA by giving radvd the following config:<p><pre><code>    interface wg-server
    {
        AdvDefaultLifetime 0;
        AdvSendAdvert on;
        prefix fdf4:a694:0e43:c0de::&#x2F;64 {
            AdvOnLink on;
            AdvAutonomous on;
        };
    };
    
</code></pre>
I use the equivalent of fdf4:a694:0e43::&#x2F;48 across all interfaces to make the ULA routable without too much effort.<p>I don&#x27;t see why you wouldn&#x27;t be able to set up a normal IPv6 SLAAC config, assuming you have the address space to advertise a full &#x2F;64 on the interface.</div><br/></div></div><div id="42230454" class="c"><input type="checkbox" id="c-42230454" checked=""/><div class="controls bullet"><span class="by">0x00_NULL</span><span>|</span><a href="#42230304">parent</a><span>|</span><a href="#42230728">prev</a><span>|</span><a href="#42233514">next</a><span>|</span><label class="collapse" for="c-42230454">[-]</label><label class="expand" for="c-42230454">[1 more]</label></div><br/><div class="children"><div class="content">I don’t know if the spec supports that on its own. Although, it’s a good feature request.<p>You’d have to update the WG configuration each time a new IPv6 address connected. So, you would probably need to connect through something like a  client that could push a config update and restart the service.<p>Not impossible, but that’s another layer of complexity to maintain.</div><br/></div></div></div></div><div id="42233514" class="c"><input type="checkbox" id="c-42233514" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#42230304">prev</a><span>|</span><a href="#42232945">next</a><span>|</span><label class="collapse" for="c-42233514">[-]</label><label class="expand" for="c-42233514">[2 more]</label></div><br/><div class="children"><div class="content">Is UPNP still a security nightmare in practice? If so, does this article&#x27;s use of it avoid the usual problems?</div><br/><div id="42233738" class="c"><input type="checkbox" id="c-42233738" checked=""/><div class="controls bullet"><span class="by">derkades</span><span>|</span><a href="#42233514">parent</a><span>|</span><a href="#42232945">next</a><span>|</span><label class="collapse" for="c-42233738">[-]</label><label class="expand" for="c-42233738">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a &quot;security nightmare&quot; because clients can make holes in your firewall. If you&#x27;re fine with that, then it&#x27;s okay.</div><br/></div></div></div></div><div id="42232945" class="c"><input type="checkbox" id="c-42232945" checked=""/><div class="controls bullet"><span class="by">logicziller</span><span>|</span><a href="#42233514">prev</a><span>|</span><a href="#42233767">next</a><span>|</span><label class="collapse" for="c-42232945">[-]</label><label class="expand" for="c-42232945">[5 more]</label></div><br/><div class="children"><div class="content">One that I could not get to work properly with Wireguard is port-forwarding without masquerading.<p>I need the source IP to remain intact, but unless I add 0.0.0.0&#x2F;0 to the AllowedIPs, the Wireguard peer will drop the packet. If I do add 0.0.0.0&#x2F;0 to AllowedIPs then it adds a route which prevents the response from my application to go back to the source.<p>Eventually gave up on it. Nobody had a clue how to fix this or what actually needs to be in the nft or firewalld rules for this to actually work properly.</div><br/><div id="42233004" class="c"><input type="checkbox" id="c-42233004" checked=""/><div class="controls bullet"><span class="by">mbilker</span><span>|</span><a href="#42232945">parent</a><span>|</span><a href="#42233477">next</a><span>|</span><label class="collapse" for="c-42233004">[-]</label><label class="expand" for="c-42233004">[2 more]</label></div><br/><div class="children"><div class="content">If you are using `wg-quick`, then you need `Table = off` to disable adding routes to the system route table automatically. After that, then you can add routes manually.</div><br/><div id="42233062" class="c"><input type="checkbox" id="c-42233062" checked=""/><div class="controls bullet"><span class="by">graton</span><span>|</span><a href="#42232945">root</a><span>|</span><a href="#42233004">parent</a><span>|</span><a href="#42233477">next</a><span>|</span><label class="collapse" for="c-42233062">[-]</label><label class="expand" for="c-42233062">[1 more]</label></div><br/><div class="children"><div class="content">This is the answer. I too ran into the same issue. Took me awhile to figure this part out.</div><br/></div></div></div></div><div id="42233477" class="c"><input type="checkbox" id="c-42233477" checked=""/><div class="controls bullet"><span class="by">irunmyownemail</span><span>|</span><a href="#42232945">parent</a><span>|</span><a href="#42233004">prev</a><span>|</span><a href="#42233143">next</a><span>|</span><label class="collapse" for="c-42233477">[-]</label><label class="expand" for="c-42233477">[1 more]</label></div><br/><div class="children"><div class="content">When a public Internet client connects to my VPS, WG routes the port traffic like 443 to the WG client here at home, then through Apache reverse proxy then to a node in my kube cluster running a spring boot app which is my main site. The logs shows the IP of the incoming public Internet client.<p>The response is routed all the way back out to the Internet client.<p>Is what I&#x27;m describing not achieving what you&#x27;re discussing?<p>Happy to post a sanitized version of my server and client config.</div><br/></div></div></div></div><div id="42233767" class="c"><input type="checkbox" id="c-42233767" checked=""/><div class="controls bullet"><span class="by">teleforce</span><span>|</span><a href="#42232945">prev</a><span>|</span><a href="#42231914">next</a><span>|</span><label class="collapse" for="c-42233767">[-]</label><label class="expand" for="c-42233767">[2 more]</label></div><br/><div class="children"><div class="content">Is there any good books on Wireguard that cover the principles, implementation and configurations?<p>We have plenty of books on IPSEC but for Wireguard it&#x27;s a rarity.</div><br/><div id="42233790" class="c"><input type="checkbox" id="c-42233790" checked=""/><div class="controls bullet"><span class="by">vardump</span><span>|</span><a href="#42233767">parent</a><span>|</span><a href="#42231914">next</a><span>|</span><label class="collapse" for="c-42233790">[-]</label><label class="expand" for="c-42233790">[1 more]</label></div><br/><div class="children"><div class="content">I don’t think you could write that thick of a book about wireguard.<p>For IPSEC you’re going to need a bookshelf.</div><br/></div></div></div></div><div id="42231914" class="c"><input type="checkbox" id="c-42231914" checked=""/><div class="controls bullet"><span class="by">wirewarden</span><span>|</span><a href="#42233767">prev</a><span>|</span><a href="#42231426">next</a><span>|</span><label class="collapse" for="c-42231914">[-]</label><label class="expand" for="c-42231914">[1 more]</label></div><br/><div class="children"><div class="content">Nice article, cool ideas.<p>I rely on IPv6 for my infrastructure: my home network and servers are all publically routable via IPv6.<p>I use something similar to OP&#x27;s IPv6 setup to provide my smartphone with IPv6 connectivity too, so smartphone is able to reach my infra.<p>It&#x27;s not clear what OP is getting by exposing public servers using Wireguard internally. Why not just assign servers IPv6 addresses at layer 3 and route as normal?<p>Given the vast majority of my infra has publically routable IPv6, it would be nice if I could keep&#x2F;use that addressing layer, but benefit from Wireguard (it&#x27;s modern crypto, and stateless design) without having to adopt the Wireguard addressing layer.<p>I guess I&#x27;m looking for something like Wireguard-without-addressing, or IPsec-transport-mode-but-stateless.</div><br/></div></div><div id="42231426" class="c"><input type="checkbox" id="c-42231426" checked=""/><div class="controls bullet"><span class="by">icelancer</span><span>|</span><a href="#42231914">prev</a><span>|</span><a href="#42229919">next</a><span>|</span><label class="collapse" for="c-42231426">[-]</label><label class="expand" for="c-42231426">[9 more]</label></div><br/><div class="children"><div class="content">No RBAC is sad, though understandable. Wireguard is so much faster than OpenVPN. We use Wireguard for S2S but unfortunately need OpenVPN for our employees and contractors due to RBAC.<p>All posts and writeups we&#x27;ve found trying to shoehorn RBAC into Wireguard ultimately ends up with people saying &quot;don&#x27;t do this.&quot;</div><br/><div id="42233146" class="c"><input type="checkbox" id="c-42233146" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#42231426">parent</a><span>|</span><a href="#42231477">next</a><span>|</span><label class="collapse" for="c-42233146">[-]</label><label class="expand" for="c-42233146">[3 more]</label></div><br/><div class="children"><div class="content">The point of the WireGuard design is to be agnostic to &quot;upper-layer&quot; concerns like this; it&#x27;s a fast (optionally) kernel-resident secure transport that you can build whatever you&#x27;d like on top of. WireGuard isn&#x27;t about RBAC and doesn&#x27;t have a &quot;don&#x27;t do RBAC&quot; position.</div><br/><div id="42233764" class="c"><input type="checkbox" id="c-42233764" checked=""/><div class="controls bullet"><span class="by">bogantech</span><span>|</span><a href="#42231426">root</a><span>|</span><a href="#42233146">parent</a><span>|</span><a href="#42231477">next</a><span>|</span><label class="collapse" for="c-42233764">[-]</label><label class="expand" for="c-42233764">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The point of the WireGuard design is to be agnostic to &quot;upper-layer&quot; concerns like this;<p>And there will probably never be any standard (non-commercial) &quot;upper-layer&quot; because of this.<p>The project prides itself on being much simpler than IPSEC etc but that&#x27;s easy when you leave out half of the functionality</div><br/><div id="42233867" class="c"><input type="checkbox" id="c-42233867" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#42231426">root</a><span>|</span><a href="#42233764">parent</a><span>|</span><a href="#42231477">next</a><span>|</span><label class="collapse" for="c-42233867">[-]</label><label class="expand" for="c-42233867">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a good thing. The higher up the stack you go, the less value there is in standardizing, and more painful the costs (of being constrained in implementation).<p>Also: it <i>is</i> much simpler than IPSEC. Pretty much everybody can get WireGuard working in minutes. It&#x27;s approximately as easy as setting up SSH. That&#x27;s simply not true of IPSEC.<p>Anyways, I think the jury is in on this one.</div><br/></div></div></div></div></div></div><div id="42231477" class="c"><input type="checkbox" id="c-42231477" checked=""/><div class="controls bullet"><span class="by">srockets</span><span>|</span><a href="#42231426">parent</a><span>|</span><a href="#42233146">prev</a><span>|</span><a href="#42231545">next</a><span>|</span><label class="collapse" for="c-42231477">[-]</label><label class="expand" for="c-42231477">[2 more]</label></div><br/><div class="children"><div class="content">There’s a very good implementation of Wireguard with RBAC. It’s called Tailscale.</div><br/></div></div><div id="42231545" class="c"><input type="checkbox" id="c-42231545" checked=""/><div class="controls bullet"><span class="by">gonzo</span><span>|</span><a href="#42231426">parent</a><span>|</span><a href="#42231477">prev</a><span>|</span><a href="#42233245">next</a><span>|</span><label class="collapse" for="c-42231545">[-]</label><label class="expand" for="c-42231545">[1 more]</label></div><br/><div class="children"><div class="content">Kernel wirguard may be (and often is) faster than OpenVPN without DCO, but OpenVPN with DCO is oftent substantially faster than kernel WireGuard.<p>DCO is available for Linux, FreeBSD and Windows.</div><br/></div></div><div id="42233245" class="c"><input type="checkbox" id="c-42233245" checked=""/><div class="controls bullet"><span class="by">ahalimah</span><span>|</span><a href="#42231426">parent</a><span>|</span><a href="#42231545">prev</a><span>|</span><a href="#42229919">next</a><span>|</span><label class="collapse" for="c-42233245">[-]</label><label class="expand" for="c-42233245">[2 more]</label></div><br/><div class="children"><div class="content">I like Defguard for this <a href="https:&#x2F;&#x2F;defguard.net&#x2F;" rel="nofollow">https:&#x2F;&#x2F;defguard.net&#x2F;</a></div><br/><div id="42234064" class="c"><input type="checkbox" id="c-42234064" checked=""/><div class="controls bullet"><span class="by">sintax</span><span>|</span><a href="#42231426">root</a><span>|</span><a href="#42233245">parent</a><span>|</span><a href="#42229919">next</a><span>|</span><label class="collapse" for="c-42234064">[-]</label><label class="expand" for="c-42234064">[1 more]</label></div><br/><div class="children"><div class="content">Not played with this yet, but <a href="https:&#x2F;&#x2F;github.com&#x2F;firezone&#x2F;firezone">https:&#x2F;&#x2F;github.com&#x2F;firezone&#x2F;firezone</a> is another example.</div><br/></div></div></div></div></div></div><div id="42229919" class="c"><input type="checkbox" id="c-42229919" checked=""/><div class="controls bullet"><span class="by">sevg</span><span>|</span><a href="#42231426">prev</a><span>|</span><a href="#42231940">next</a><span>|</span><label class="collapse" for="c-42229919">[-]</label><label class="expand" for="c-42229919">[14 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve always been slightly puzzled about why there isn&#x27;t an easy built-in way to tunnel all traffic (ie, AllowedIPs = 0.0.0.0&#x2F;0, ::&#x2F;0) EXCEPT for some specific IPs. You end up having to programmatically generate a massive list of CIDRs that include everything except those specific IPs.</div><br/><div id="42229988" class="c"><input type="checkbox" id="c-42229988" checked=""/><div class="controls bullet"><span class="by">adamcharnock</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42233530">next</a><span>|</span><label class="collapse" for="c-42229988">[-]</label><label class="expand" for="c-42229988">[3 more]</label></div><br/><div class="children"><div class="content">I agree that would be useful. I&#x27;m fairly sure it is because all the entries in `AllowedIPs` are just written as-is to the routing table, and the routing logic in the kernel (and most&#x2F;all routers?) has no facility for &#x27;does not match&#x27;.<p>Instead the solution would be to add a explicit route to state where the excluded CIDR <i>should</i> be sent to. That would would be more specific and would therefore be used for matching packets rather than the 0.0.0.0&#x2F;0 (or whatever) routed pointed at the wireguard tunnel.</div><br/><div id="42232661" class="c"><input type="checkbox" id="c-42232661" checked=""/><div class="controls bullet"><span class="by">dgl</span><span>|</span><a href="#42229919">root</a><span>|</span><a href="#42229988">parent</a><span>|</span><a href="#42233530">next</a><span>|</span><label class="collapse" for="c-42232661">[-]</label><label class="expand" for="c-42232661">[2 more]</label></div><br/><div class="children"><div class="content">To me this is actually one of the attractive aspects of Wireguard compared to some other VPNs, it doesn&#x27;t try to manage everything within the tool and delegates to the host&#x27;s normal routing mechanisms. However it still by default conflates AllowedIPs and the routing table -- you can actually separate them (Table=off with wg-quick) and then manually add routes.</div><br/><div id="42233504" class="c"><input type="checkbox" id="c-42233504" checked=""/><div class="controls bullet"><span class="by">irunmyownemail</span><span>|</span><a href="#42229919">root</a><span>|</span><a href="#42232661">parent</a><span>|</span><a href="#42233530">next</a><span>|</span><label class="collapse" for="c-42233504">[-]</label><label class="expand" for="c-42233504">[1 more]</label></div><br/><div class="children"><div class="content">I agree completely with the sentiment, though I never actually mess with the routing tables.</div><br/></div></div></div></div></div></div><div id="42233530" class="c"><input type="checkbox" id="c-42233530" checked=""/><div class="controls bullet"><span class="by">mrbluecoat</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42229988">prev</a><span>|</span><a href="#42231287">next</a><span>|</span><label class="collapse" for="c-42233530">[-]</label><label class="expand" for="c-42233530">[1 more]</label></div><br/><div class="children"><div class="content">See <a href="https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11717#issuecomment-2253271701">https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11717#issuecom...</a></div><br/></div></div><div id="42231287" class="c"><input type="checkbox" id="c-42231287" checked=""/><div class="controls bullet"><span class="by">tjoff</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42233530">prev</a><span>|</span><a href="#42233078">next</a><span>|</span><label class="collapse" for="c-42231287">[-]</label><label class="expand" for="c-42231287">[1 more]</label></div><br/><div class="children"><div class="content">Calculator for the workaround:
<a href="https:&#x2F;&#x2F;www.procustodibus.com&#x2F;blog&#x2F;2021&#x2F;03&#x2F;wireguard-allowedips-calculator&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.procustodibus.com&#x2F;blog&#x2F;2021&#x2F;03&#x2F;wireguard-allowed...</a></div><br/></div></div><div id="42233078" class="c"><input type="checkbox" id="c-42233078" checked=""/><div class="controls bullet"><span class="by">graton</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42231287">prev</a><span>|</span><a href="#42233014">next</a><span>|</span><label class="collapse" for="c-42233078">[-]</label><label class="expand" for="c-42233078">[1 more]</label></div><br/><div class="children"><div class="content">I think you need to use `Table = off`. With that you probably can get what you want.</div><br/></div></div><div id="42233014" class="c"><input type="checkbox" id="c-42233014" checked=""/><div class="controls bullet"><span class="by">pm2222</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42233078">prev</a><span>|</span><a href="#42230695">next</a><span>|</span><label class="collapse" for="c-42233014">[-]</label><label class="expand" for="c-42233014">[1 more]</label></div><br/><div class="children"><div class="content">ip route to blackhole works. 
ip rule works.
ip&#x2F;nftables works. 
tc works. 
ebpf works.</div><br/></div></div><div id="42230695" class="c"><input type="checkbox" id="c-42230695" checked=""/><div class="controls bullet"><span class="by">rudasn</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42233014">prev</a><span>|</span><a href="#42229961">next</a><span>|</span><label class="collapse" for="c-42230695">[-]</label><label class="expand" for="c-42230695">[3 more]</label></div><br/><div class="children"><div class="content">Can&#x27;t you do that with a prerouting firewall rule?<p>Genuinely asking, never tried myself but seems plausible.</div><br/><div id="42230837" class="c"><input type="checkbox" id="c-42230837" checked=""/><div class="controls bullet"><span class="by">sevg</span><span>|</span><a href="#42229919">root</a><span>|</span><a href="#42230695">parent</a><span>|</span><a href="#42229961">next</a><span>|</span><label class="collapse" for="c-42230837">[-]</label><label class="expand" for="c-42230837">[2 more]</label></div><br/><div class="children"><div class="content">There are a number of ways you could handle this, but none of them make wireguard seem user friendly for this use case.<p>If you&#x27;re using WireGuard for point to point or to access a specific subnet, this isn&#x27;t an issue.<p>But a common use case is to use WireGuard like you&#x27;d use Mullvad or Nordvpn and tunnel all traffic through it. And if you need exceptions for private address ranges or specific services, you end up having to generate a CIDR list (the WireGuard mobile app can do this for you if you check the &quot;exclude private addresses&quot; checkbox, but no such checkbox exists for wireguard tools on Linux, and it&#x27;s a hardcoded list anyway), or add routes yourself, or fiddle with firewall rules.</div><br/><div id="42233399" class="c"><input type="checkbox" id="c-42233399" checked=""/><div class="controls bullet"><span class="by">rudasn</span><span>|</span><a href="#42229919">root</a><span>|</span><a href="#42230837">parent</a><span>|</span><a href="#42229961">next</a><span>|</span><label class="collapse" for="c-42233399">[-]</label><label class="expand" for="c-42233399">[1 more]</label></div><br/><div class="children"><div class="content">Ah right.<p>Yeah it would be nice to have a negated allowed ips list, or adding an ! to signify &quot;not this one&quot;. Wonder how difficult that would be to implement.</div><br/></div></div></div></div></div></div><div id="42231714" class="c"><input type="checkbox" id="c-42231714" checked=""/><div class="controls bullet"><span class="by">bsder</span><span>|</span><a href="#42229919">parent</a><span>|</span><a href="#42229961">prev</a><span>|</span><a href="#42231940">next</a><span>|</span><label class="collapse" for="c-42231714">[-]</label><label class="expand" for="c-42231714">[2 more]</label></div><br/><div class="children"><div class="content">Or the reverse, most people have specific IPs that they&#x27;d like to route traffic through the VPN but mostly don&#x27;t care about the rest.<p>Again, you wind up creating a huge list of exact IPs and creating the routing rules is a PITA.</div><br/><div id="42232031" class="c"><input type="checkbox" id="c-42232031" checked=""/><div class="controls bullet"><span class="by">akerl_</span><span>|</span><a href="#42229919">root</a><span>|</span><a href="#42231714">parent</a><span>|</span><a href="#42231940">next</a><span>|</span><label class="collapse" for="c-42232031">[-]</label><label class="expand" for="c-42232031">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand. Having a specific list of IPs they want to route over Wireguard is the one that is easy today. It&#x27;s the inverse (everything except these IPs) that&#x27;s hard.</div><br/></div></div></div></div></div></div><div id="42231940" class="c"><input type="checkbox" id="c-42231940" checked=""/><div class="controls bullet"><span class="by">n4bz0r</span><span>|</span><a href="#42229919">prev</a><span>|</span><a href="#42232096">next</a><span>|</span><label class="collapse" for="c-42231940">[-]</label><label class="expand" for="c-42231940">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Some applications (looking at you, BitTorrent client) do not play well behind a NAT.<p>I&#x27;ve seen a number of such warnings, but never personally encountered the issue. Is that because I&#x27;ve been always sitting behind a router? Or that&#x27;s just an ISP thing that I got lucky with? Like, my IP isn&#x27;t &quot;grey&quot; enough? (always had dynamic IP)</div><br/><div id="42232010" class="c"><input type="checkbox" id="c-42232010" checked=""/><div class="controls bullet"><span class="by">akerl_</span><span>|</span><a href="#42231940">parent</a><span>|</span><a href="#42232096">next</a><span>|</span><label class="collapse" for="c-42232010">[-]</label><label class="expand" for="c-42232010">[1 more]</label></div><br/><div class="children"><div class="content">The reason that peer-to-peer tools tend not to work well behind NAT is because peers can&#x27;t initiate inbound connections to you.<p>So your router gets 1.2.3.4 as an external IP. And it assigns you 192.168.1.10 as an internal IP, and handles NAT for your outbound connections. You start your torrent client and it advertises &quot;hey, I have all these Linux ISOs, and I&#x27;m at 1.2.3.4:50000, come connect to me&quot;. Peers try to connect to 1.2.3.4:50000, and your router says &quot;who the hell is this&quot;.<p>This is what UPNP and related tools attempt to solve. UPNP works by allowing your computer to say to your router &quot;hey, I&#x27;m going to want inbound connections on port 50000, so if you get any, send them to me&quot;.<p>Other methods like STUN&#x2F;TURN&#x2F;etc use different techniques to get around the issue.</div><br/></div></div></div></div><div id="42232096" class="c"><input type="checkbox" id="c-42232096" checked=""/><div class="controls bullet"><span class="by">dangoodmanUT</span><span>|</span><a href="#42231940">prev</a><span>|</span><a href="#42230088">next</a><span>|</span><label class="collapse" for="c-42232096">[-]</label><label class="expand" for="c-42232096">[1 more]</label></div><br/><div class="children"><div class="content">Also check out slack&#x27;s nebula, easier to understand and configure IMO, and it has ACLs natively</div><br/></div></div><div id="42230088" class="c"><input type="checkbox" id="c-42230088" checked=""/><div class="controls bullet"><span class="by">qeternity</span><span>|</span><a href="#42232096">prev</a><span>|</span><a href="#42230037">next</a><span>|</span><label class="collapse" for="c-42230088">[-]</label><label class="expand" for="c-42230088">[3 more]</label></div><br/><div class="children"><div class="content">No affiliation with them but Tailscale is awesome.</div><br/><div id="42231370" class="c"><input type="checkbox" id="c-42231370" checked=""/><div class="controls bullet"><span class="by">nikisweeting</span><span>|</span><a href="#42230088">parent</a><span>|</span><a href="#42230037">next</a><span>|</span><label class="collapse" for="c-42231370">[-]</label><label class="expand" for="c-42231370">[2 more]</label></div><br/><div class="children"><div class="content">Their article on how NAT traversal works is an epic piece of work in its own right too:<p><a href="https:&#x2F;&#x2F;tailscale.com&#x2F;blog&#x2F;how-nat-traversal-works" rel="nofollow">https:&#x2F;&#x2F;tailscale.com&#x2F;blog&#x2F;how-nat-traversal-works</a></div><br/><div id="42231493" class="c"><input type="checkbox" id="c-42231493" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#42230088">root</a><span>|</span><a href="#42231370">parent</a><span>|</span><a href="#42230037">next</a><span>|</span><label class="collapse" for="c-42231493">[-]</label><label class="expand" for="c-42231493">[1 more]</label></div><br/><div class="children"><div class="content">I do not think the Tailscale software implements everything described in that article. For example, the article says<p>&gt; Now speak STUN through the NAT64 to discover your public ip:port on the NAT64, and you’re back to the classic NAT traversal problem — albeit with a bit more work.<p>I don&#x27;t think the Tailscale software does this step. You can find several GitHub issues about this, such as <a href="https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11438">https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11438</a> or <a href="https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11437">https:&#x2F;&#x2F;github.com&#x2F;tailscale&#x2F;tailscale&#x2F;issues&#x2F;11437</a></div><br/></div></div></div></div></div></div><div id="42230037" class="c"><input type="checkbox" id="c-42230037" checked=""/><div class="controls bullet"><span class="by">tomjen3</span><span>|</span><a href="#42230088">prev</a><span>|</span><a href="#42230155">next</a><span>|</span><label class="collapse" for="c-42230037">[-]</label><label class="expand" for="c-42230037">[6 more]</label></div><br/><div class="children"><div class="content">I had hoped that this included a way to configure wireguard to get clients from some other place: It would be really nifty if you could configure it to read from LDAP or similar.</div><br/><div id="42230653" class="c"><input type="checkbox" id="c-42230653" checked=""/><div class="controls bullet"><span class="by">Jnr</span><span>|</span><a href="#42230037">parent</a><span>|</span><a href="#42230747">next</a><span>|</span><label class="collapse" for="c-42230653">[-]</label><label class="expand" for="c-42230653">[3 more]</label></div><br/><div class="children"><div class="content">Tailscale (also using wireguard for transport) and similar overlay networks kind of do that.<p>With Tailscale there is a central server, you can sign in with single-sign-on, that server enables automatic mesh configuration and helps nodes communicate specifics for port knocking, routing, dns, etc. And there are derp servers (think of them like TURN servers) that can be used as proxies when direct communication can&#x27;t be established.<p>Altogether this is easier to set up than Wireguard, but the central server is not open source (but there is Headscale, and open source implementation), and it is not as well supported on routers (it is supported on OpenWRT though and probably can be set up using containers on Mikrotik).</div><br/><div id="42233521" class="c"><input type="checkbox" id="c-42233521" checked=""/><div class="controls bullet"><span class="by">irunmyownemail</span><span>|</span><a href="#42230037">root</a><span>|</span><a href="#42230653">parent</a><span>|</span><a href="#42230747">next</a><span>|</span><label class="collapse" for="c-42233521">[-]</label><label class="expand" for="c-42233521">[2 more]</label></div><br/><div class="children"><div class="content">With Wireguard I own or control everything. Why would I surrender any of that to Tailscale?</div><br/><div id="42234230" class="c"><input type="checkbox" id="c-42234230" checked=""/><div class="controls bullet"><span class="by">Jnr</span><span>|</span><a href="#42230037">root</a><span>|</span><a href="#42233521">parent</a><span>|</span><a href="#42230747">next</a><span>|</span><label class="collapse" for="c-42234230">[-]</label><label class="expand" for="c-42234230">[1 more]</label></div><br/><div class="children"><div class="content">Would be great if someone made something with the polish of Tailscale and made it completely free and open source, but I don&#x27;t think it is happening any time soon. Wireguard itself has been an unbelievably great gift to the whole IT ecosystem and Jason will forever be cemented in my hall of fame.<p>But he did intend for Wireguard to be used in all sorts of solutions and Tailscale is one of them.<p>Tailscale apps themselves are open source for open source platforms (linux, android) and the 3rd party management server Headscale is open source, enabling you to maintain control.</div><br/></div></div></div></div></div></div><div id="42230747" class="c"><input type="checkbox" id="c-42230747" checked=""/><div class="controls bullet"><span class="by">rudasn</span><span>|</span><a href="#42230037">parent</a><span>|</span><a href="#42230653">prev</a><span>|</span><a href="#42230706">next</a><span>|</span><label class="collapse" for="c-42230747">[-]</label><label class="expand" for="c-42230747">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, that&#x27;s the biggest pain point I think. Syncing configs once changes are made (new peers, new access rules, pre shared key rotation etc).<p>It&#x27;s one of the reasons I&#x27;m  working on wirehub[0], as a way to distribute configs to both end users (share a link) and machines (have a script to periodically pull from wirehub).<p>Not the perfect solution, but one that does not require additional clients&#x2F;agents&#x2F;software to be installed.<p>[0] <a href="https:&#x2F;&#x2F;wirehub.org" rel="nofollow">https:&#x2F;&#x2F;wirehub.org</a></div><br/></div></div><div id="42230706" class="c"><input type="checkbox" id="c-42230706" checked=""/><div class="controls bullet"><span class="by">tumdum_</span><span>|</span><a href="#42230037">parent</a><span>|</span><a href="#42230747">prev</a><span>|</span><a href="#42230155">next</a><span>|</span><label class="collapse" for="c-42230706">[-]</label><label class="expand" for="c-42230706">[1 more]</label></div><br/><div class="children"><div class="content">NordVPN meshnet is just like that.</div><br/></div></div></div></div><div id="42230155" class="c"><input type="checkbox" id="c-42230155" checked=""/><div class="controls bullet"><span class="by">imsurajkadam</span><span>|</span><a href="#42230037">prev</a><span>|</span><label class="collapse" for="c-42230155">[-]</label><label class="expand" for="c-42230155">[2 more]</label></div><br/><div class="children"><div class="content">why is this not basic for me? yes I am tech guy!</div><br/><div id="42230458" class="c"><input type="checkbox" id="c-42230458" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#42230155">parent</a><span>|</span><label class="collapse" for="c-42230458">[-]</label><label class="expand" for="c-42230458">[1 more]</label></div><br/><div class="children"><div class="content">Probably because networking itself is arcane. If you&#x27;re used to everything around it, wireguard itself is really simple. If you&#x27;re not, all the rest of it is going to drag you down.</div><br/></div></div></div></div></div></div></div></div></div></body></html>