<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1692522055730" as="style"/><link rel="stylesheet" href="styles.css?v=1692522055730"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://cr.openjdk.org/~jrose/values/larval-values.html">Project Valhalla, Simple as it can be, but not simpler</a>Â <span class="domain">(<a href="https://cr.openjdk.org">cr.openjdk.org</a>)</span></div><div class="subtext"><span>pmg1991</span> | <span>7 comments</span></div><br/><div><div id="37197218" class="c"><input type="checkbox" id="c-37197218" checked=""/><div class="controls bullet"><span class="by">quelltext</span><span>|</span><a href="#37196205">next</a><span>|</span><label class="collapse" for="c-37197218">[-]</label><label class="expand" for="c-37197218">[1 more]</label></div><br/><div class="children"><div class="content">From the start I was wondering if there&#x27;s no way for the JVM to solve this with less cruft on the bytecode level. Of course, that doesn&#x27;t mean I was aware of the challenges, just an intuition.<p>I do think they must have had similar intuitions in the beginning. Then identified big challenges with that and that what would be needed to overcome it more streamlined is some set of features or optimizations. It seems though that these emerged in isolation? At least to cross the threshold to saying &quot;there&#x27;s a way&quot;.<p>Seeing how long Valhalla has been in development, I&#x27;m curious how things went the way they did. The article mentions hindsight but that alone doesn&#x27;t explain the change in direction.</div><br/></div></div><div id="37196205" class="c"><input type="checkbox" id="c-37196205" checked=""/><div class="controls bullet"><span class="by">canvascritic</span><span>|</span><a href="#37197218">prev</a><span>|</span><a href="#37196593">next</a><span>|</span><label class="collapse" for="c-37196205">[-]</label><label class="expand" for="c-37196205">[1 more]</label></div><br/><div class="children"><div class="content">The shift in valhalla&#x27;s direction reminds me of the initial challenges i faced when experimenting with its early prototypes. i distinctly remember grappling with the introduction of q-types and v-bytecodes and trying to align it with my existing understanding of the jvm. it&#x27;s interesting to see how the design is evolving towards expressing struct-like values as normal java classes. from my own tinkering with valhalla, the convergence towards a more streamlined approach without losing out on performance seems promising. curious to see how these changes will play out in real world applications, especially considering the nuances of java&#x27;s memory model and optimization techniques.</div><br/></div></div><div id="37196593" class="c"><input type="checkbox" id="c-37196593" checked=""/><div class="controls bullet"><span class="by">lbj</span><span>|</span><a href="#37196205">prev</a><span>|</span><a href="#37196162">next</a><span>|</span><label class="collapse" for="c-37196593">[-]</label><label class="expand" for="c-37196593">[3 more]</label></div><br/><div class="children"><div class="content">Website is too small to read on Vivaldi, and in 2023 I can&#x27;t be bothered to zoom :)</div><br/><div id="37196714" class="c"><input type="checkbox" id="c-37196714" checked=""/><div class="controls bullet"><span class="by">eklavya</span><span>|</span><a href="#37196593">parent</a><span>|</span><a href="#37196162">next</a><span>|</span><label class="collapse" for="c-37196714">[-]</label><label class="expand" for="c-37196714">[2 more]</label></div><br/><div class="children"><div class="content">In 2023, do you have reader mode?</div><br/><div id="37196999" class="c"><input type="checkbox" id="c-37196999" checked=""/><div class="controls bullet"><span class="by">happymellon</span><span>|</span><a href="#37196593">root</a><span>|</span><a href="#37196714">parent</a><span>|</span><a href="#37196162">next</a><span>|</span><label class="collapse" for="c-37196999">[-]</label><label class="expand" for="c-37196999">[1 more]</label></div><br/><div class="children"><div class="content">In 2023 I do, but it&#x27;s still just a work around for people who can&#x27;t make webpages.<p>As such as can still complain about it.</div><br/></div></div></div></div></div></div><div id="37196162" class="c"><input type="checkbox" id="c-37196162" checked=""/><div class="controls bullet"><span class="by">nyanpasu64</span><span>|</span><a href="#37196593">prev</a><span>|</span><label class="collapse" for="c-37196162">[-]</label><label class="expand" for="c-37196162">[1 more]</label></div><br/><div class="children"><div class="content">Well I suppose that if you treat value types like a variation of an object reference rather than a variation of an object, then it would make sense that they cannot be mutated (since neither can object references but only their targets), with the added wrinkle of allowing such mutation during value constructors. To me this still feels less general than C or Go structs, which can have individual fields mutated in place (and even take the address of stack variables and pass pointers around, though that&#x27;s unsafe in C and may require heap&#x2F;GC allocation in Go unless escape analysis proves otherwise).</div><br/></div></div></div></div></div></div></div></body></html>