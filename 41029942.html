<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1721638876449" as="style"/><link rel="stylesheet" href="styles.css?v=1721638876449"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/jart/cosmopolitan/releases/tag/3.5.8">Cosmopolitan v3.5.8</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>sgammon</span> | <span>10 comments</span></div><br/><div><div id="41031810" class="c"><input type="checkbox" id="c-41031810" checked=""/><div class="controls bullet"><span class="by">schmorptron</span><span>|</span><a href="#41031990">next</a><span>|</span><label class="collapse" for="c-41031810">[-]</label><label class="expand" for="c-41031810">[2 more]</label></div><br/><div class="children"><div class="content">For those who don&#x27;t want to click through to the main github description: 
&quot;Cosmopolitan Libc makes C a build-anywhere run-anywhere language, like Java, except it doesn&#x27;t need an interpreter or virtual machine. Instead, it reconfigures stock GCC and Clang to output a POSIX-approved polyglot format that runs natively on Linux + Mac + Windows + FreeBSD + OpenBSD + NetBSD + BIOS on AMD64 and ARM64 with the best possible performance. &quot;</div><br/><div id="41032175" class="c"><input type="checkbox" id="c-41032175" checked=""/><div class="controls bullet"><span class="by">amelius</span><span>|</span><a href="#41031810">parent</a><span>|</span><a href="#41031990">next</a><span>|</span><label class="collapse" for="c-41032175">[-]</label><label class="expand" for="c-41032175">[1 more]</label></div><br/><div class="children"><div class="content">If this means the end of libc version errors, then count me in.<p>One question, is C++ supported?</div><br/></div></div></div></div><div id="41031990" class="c"><input type="checkbox" id="c-41031990" checked=""/><div class="controls bullet"><span class="by">relistan</span><span>|</span><a href="#41031810">prev</a><span>|</span><a href="#41030960">next</a><span>|</span><label class="collapse" for="c-41031990">[-]</label><label class="expand" for="c-41031990">[1 more]</label></div><br/><div class="children"><div class="content">Lots of focus in other comments on pedantry. This looks like a cool project.</div><br/></div></div><div id="41030960" class="c"><input type="checkbox" id="c-41030960" checked=""/><div class="controls bullet"><span class="by">oguz-ismail</span><span>|</span><a href="#41031990">prev</a><span>|</span><a href="#41031369">next</a><span>|</span><label class="collapse" for="c-41030960">[-]</label><label class="expand" for="c-41030960">[5 more]</label></div><br/><div class="children"><div class="content">The README for this project still says &quot;POSIX-approved&quot; but there is nothing in POSIX that allows mixing commands and binary data in a shell script.<p>It does allow appending binary data to the end of a shell script* as long as it is guarded from being parsed as shell code by an <i>exit</i>, <i>exec</i>, etc. but that&#x27;s it.<p>* <a href="https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9799919799&#x2F;utilities&#x2F;sh.html#tag_20_110_07" rel="nofollow">https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9799919799&#x2F;utilities&#x2F;s...</a></div><br/><div id="41032092" class="c"><input type="checkbox" id="c-41032092" checked=""/><div class="controls bullet"><span class="by">Cloudef</span><span>|</span><a href="#41030960">parent</a><span>|</span><a href="#41031582">next</a><span>|</span><label class="collapse" for="c-41032092">[-]</label><label class="expand" for="c-41032092">[1 more]</label></div><br/><div class="children"><div class="content">POSIX is one of those standards that don&#x27;t really define anything at all. Microsoft POSIX subsystem is one of the nicest examples of something that lets you tick the POSIX checkbox but does almost nothing. One of the recent posix annoyances I stumbled upon was the clock_gettime where every platform has slightly different idea how the different CLOCKs are supposed to be interpreted :)<p>Personally I don&#x27;t find the APE part of cosmopolitan that interesting, but their own POSIX API &lt;<a href="https:&#x2F;&#x2F;justine.lol&#x2F;cosmopolitan&#x2F;functions.html" rel="nofollow">https:&#x2F;&#x2F;justine.lol&#x2F;cosmopolitan&#x2F;functions.html</a>&gt; which also covers windows is interesting for sure. Zig&#x27;s std also offers something similar, but perhaps not as good coverage. Getting fork, mmap, and poll work on windows is not small feat.</div><br/></div></div><div id="41031582" class="c"><input type="checkbox" id="c-41031582" checked=""/><div class="controls bullet"><span class="by">imiric</span><span>|</span><a href="#41030960">parent</a><span>|</span><a href="#41032092">prev</a><span>|</span><a href="#41031162">next</a><span>|</span><label class="collapse" for="c-41031582">[-]</label><label class="expand" for="c-41031582">[2 more]</label></div><br/><div class="children"><div class="content">According to Justine herself[1], POSIX specifically changed their rules to allow this type of functionality[2].<p>The paragraph you linked to was part of it, but also this paragraph under RATIONALE[3]:<p>&gt; Earlier versions of this standard required that input files to the shell be text files except that line lengths were unlimited. However, that was overly restrictive in relation to the fact that shells can parse a script without a trailing newline, and in relation to a common practice of concatenating a shell script ending with an exit or exec $command with a binary data payload to form a single-file self-extracting archive.<p>So Cosmopolitan indeed seems to be POSIX-approved as far as this behavior goes.<p>[1]: <a href="https:&#x2F;&#x2F;justine.lol&#x2F;cosmo3&#x2F;" rel="nofollow">https:&#x2F;&#x2F;justine.lol&#x2F;cosmo3&#x2F;</a><p>[2]: <a href="https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250" rel="nofollow">https:&#x2F;&#x2F;austingroupbugs.net&#x2F;view.php?id=1250</a><p>[3]: <a href="https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9799919799&#x2F;utilities&#x2F;sh.html#tag_20_110_18" rel="nofollow">https:&#x2F;&#x2F;pubs.opengroup.org&#x2F;onlinepubs&#x2F;9799919799&#x2F;utilities&#x2F;s...</a></div><br/></div></div><div id="41031162" class="c"><input type="checkbox" id="c-41031162" checked=""/><div class="controls bullet"><span class="by">yawpitch</span><span>|</span><a href="#41030960">parent</a><span>|</span><a href="#41031582">prev</a><span>|</span><a href="#41031369">next</a><span>|</span><label class="collapse" for="c-41031162">[-]</label><label class="expand" for="c-41031162">[1 more]</label></div><br/><div class="children"><div class="content">Definitely not my area of either pedantry or expertise, but if I read this correctly:<p>&gt; The input file can be of any type, but the initial portion of the file intended to be parsed according to the shell grammar […] shall consist of characters and shall not contain the NUL character.<p>Then POSIX doesn’t proscribe against appending binary data at all, it just requires that binary data appears after whatever portion of the file is <i>intended</i> to be parsed according to the grammar… there’s nothing stating that intention can’t apply to a zero characters.<p>&gt; The shell shall not enforce any line length limits.<p>That seems to unambiguously allow a zero-length initial portion.<p>&gt; If the input file consists solely of zero or more blank lines and comments, sh shall exit with a zero exit status.<p>And so does that, while also making an enormous loophole for any input file that <i>is not</i> zero or more blank lines.<p>In other words it seems to me on a quick reading that a decent rules-lawyer could drive a planet through that part of the spec, as written.</div><br/></div></div></div></div><div id="41031369" class="c"><input type="checkbox" id="c-41031369" checked=""/><div class="controls bullet"><span class="by">DidYaWipe</span><span>|</span><a href="#41030960">prev</a><span>|</span><label class="collapse" for="c-41031369">[-]</label><label class="expand" for="c-41031369">[1 more]</label></div><br/><div class="children"><div class="content">Is what?</div><br/></div></div></div></div></div></div></div></body></html>