<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1733216467547" as="style"/><link rel="stylesheet" href="styles.css?v=1733216467547"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://vereis.com/posts/disterl_inbox">Distributed Erlang</a> <span class="domain">(<a href="https://vereis.com">vereis.com</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>15 comments</span></div><br/><div><div id="42304142" class="c"><input type="checkbox" id="c-42304142" checked=""/><div class="controls bullet"><span class="by">toast0</span><span>|</span><a href="#42303412">next</a><span>|</span><label class="collapse" for="c-42304142">[-]</label><label class="expand" for="c-42304142">[1 more]</label></div><br/><div class="children"><div class="content">&gt; This can lead to scalability issues in large clusters, as the number of connections that each node needs to maintain grows quadratically with the number of nodes in the cluster.<p>No, the total number of dist connections grows quadratically with the number of nodes, but the number of dist connections each node makes grows linearally.<p>&gt; Not only that, in order to keep the cluster connected, each node periodically sends heartbeat messages to every other node in the cluster.<p>IIRC, heat beats are once every 30 seconds by default.<p>&gt; This can lead to a lot of network traffic in large clusters, which can put a strain on the network.<p>Lets say I&#x27;m right about 30 seconds between heart beats, and you&#x27;ve got 1000 nodes. Every 30 seconds each node sends out 999 heartbeats (which almost certainly fit in a single tcp packet each, maybe less if they&#x27;re piggybacking on real data exchanges). That&#x27;s 999,000 packets every second, or 33k pps across your whole cluster. For reference, GigE line rate with full 1500 mtu packets is 80k pps. If you actually have 1000 nodes worth of work, the heartbeats are not at all a big deal.<p>&gt; Historically, a &quot;large&quot; cluster in Erlang was considered to be around 50-100 nodes. This may have changed in recent years, but it&#x27;s still something to be aware of when designing distributed Erlang systems.<p>I don&#x27;t have recent numbers, but Rick Reed&#x27;s presentation at Erlang Factory in 2014 shows a dist cluster with 400 nodes. I&#x27;m pretty sure I saw 1000+ node clusters too. I left WhatsApp in 2019, and any public presentations from WA are less about raw scale, because it&#x27;s passe.<p>Really, 1000 dist connections is nothing when you&#x27;re managing 500k client connections. Dist connections weren&#x27;t even a big deal when we went to smaller nodes in FB.<p>It&#x27;s good to have a solid backend network, and to try to bias towards fewer larger nodes, rather than more smaller nodes. If you want to play with large scale dist, so you spin up 1000 low cpu, low memory VMs, you might have some trouble. It makes sense to start with small nodes and whatever number makes you comfortable for availability, and then when you run into limits, reach for bigger nodes until you get to the point where adding nodes is more cost effective: WA ran dual xeon 2690 servers before the move to FB infra; facebook had better economics with smaller single Xeon D nodes; I dunno what makes sense today, maybe a single socket Epyc?</div><br/></div></div><div id="42303412" class="c"><input type="checkbox" id="c-42303412" checked=""/><div class="controls bullet"><span class="by">qart</span><span>|</span><a href="#42304142">prev</a><span>|</span><a href="#42303647">next</a><span>|</span><label class="collapse" for="c-42303412">[-]</label><label class="expand" for="c-42303412">[6 more]</label></div><br/><div class="children"><div class="content">What&#x27;s with the font? It seems to be flickering. Especially the headings. Is there a way to turn it off?</div><br/><div id="42303958" class="c"><input type="checkbox" id="c-42303958" checked=""/><div class="controls bullet"><span class="by">funkydata</span><span>|</span><a href="#42303412">parent</a><span>|</span><a href="#42304168">prev</a><span>|</span><a href="#42303435">next</a><span>|</span><label class="collapse" for="c-42303958">[-]</label><label class="expand" for="c-42303958">[1 more]</label></div><br/><div class="children"><div class="content">If one of your browsers has this feature, just toggle reader view.</div><br/></div></div><div id="42303435" class="c"><input type="checkbox" id="c-42303435" checked=""/><div class="controls bullet"><span class="by">dan353hehe</span><span>|</span><a href="#42303412">parent</a><span>|</span><a href="#42303958">prev</a><span>|</span><a href="#42303647">next</a><span>|</span><label class="collapse" for="c-42303435">[-]</label><label class="expand" for="c-42303435">[3 more]</label></div><br/><div class="children"><div class="content">I think it’s meant to replicate a CRT display? I has a real hard time with those headings buzzing slightly.</div><br/><div id="42303657" class="c"><input type="checkbox" id="c-42303657" checked=""/><div class="controls bullet"><span class="by">emmanueloga_</span><span>|</span><a href="#42303412">root</a><span>|</span><a href="#42303435">parent</a><span>|</span><a href="#42303647">next</a><span>|</span><label class="collapse" for="c-42303657">[-]</label><label class="expand" for="c-42303657">[2 more]</label></div><br/><div class="children"><div class="content">Uses @keyframes and text-shadow to try and mimic a CRT effect but makes the text unreadable (for me at least). The browser readability mode does work on the page though.</div><br/><div id="42303717" class="c"><input type="checkbox" id="c-42303717" checked=""/><div class="controls bullet"><span class="by">dkersten</span><span>|</span><a href="#42303412">root</a><span>|</span><a href="#42303657">parent</a><span>|</span><a href="#42303647">next</a><span>|</span><label class="collapse" for="c-42303717">[-]</label><label class="expand" for="c-42303717">[1 more]</label></div><br/><div class="children"><div class="content">Makes it unreadable for me too.</div><br/></div></div></div></div></div></div></div></div><div id="42303647" class="c"><input type="checkbox" id="c-42303647" checked=""/><div class="controls bullet"><span class="by">openrisk</span><span>|</span><a href="#42303412">prev</a><span>|</span><a href="#42303408">next</a><span>|</span><label class="collapse" for="c-42303647">[-]</label><label class="expand" for="c-42303647">[1 more]</label></div><br/><div class="children"><div class="content">Quite readable even for those not familiar with Erlang.<p>Is there a list of projects that shows distributed erlang in action (taking advantage of its strengths and avoiding the pitfals)?</div><br/></div></div><div id="42303408" class="c"><input type="checkbox" id="c-42303408" checked=""/><div class="controls bullet"><span class="by">behnamoh</span><span>|</span><a href="#42303647">prev</a><span>|</span><label class="collapse" for="c-42303408">[-]</label><label class="expand" for="c-42303408">[6 more]</label></div><br/><div class="children"><div class="content">fn&#x2F;n where n is parity of fn was confusing for me at first, but then I started to like the idea, esp. in dynamic languages it&#x27;s helpful to have at least some sense of how things work by just looking at them.<p>this made me think about a universal function definition syntax that captures everything except implementation details of the function. something like:<p><pre><code>    fn (a: int, b: float, c: T) {foo: callable, bar: callable, d: int} -&gt; maybe(bool | [str] | [T])

</code></pre>
which shows that the function fn receives a (integer), b (float), c (generic type T) and maybe returns something that&#x27;s either a boolean or a list of strings or a list of T, or it throws and doesn&#x27;t return anything. the function fn also makes use of foo and bar (other functions) and variable d which are not given to it as arguments but they exist in the &quot;context&quot; of fn.</div><br/><div id="42303933" class="c"><input type="checkbox" id="c-42303933" checked=""/><div class="controls bullet"><span class="by">elcritch</span><span>|</span><a href="#42303408">parent</a><span>|</span><a href="#42303605">next</a><span>|</span><label class="collapse" for="c-42303933">[-]</label><label class="expand" for="c-42303933">[2 more]</label></div><br/><div class="children"><div class="content">Well Erlang and Elixir both have a type checker, dialyzer, which has a type specification not to far from what you proposed. Well excluding the variable or function captures.<p>Elixir’s syntax for declaring type-specs can be found at <a href="https:&#x2F;&#x2F;hexdocs.pm&#x2F;elixir&#x2F;1.12&#x2F;typespecs.html" rel="nofollow">https:&#x2F;&#x2F;hexdocs.pm&#x2F;elixir&#x2F;1.12&#x2F;typespecs.html</a></div><br/><div id="42304105" class="c"><input type="checkbox" id="c-42304105" checked=""/><div class="controls bullet"><span class="by">the_duke</span><span>|</span><a href="#42303408">root</a><span>|</span><a href="#42303933">parent</a><span>|</span><a href="#42303605">next</a><span>|</span><label class="collapse" for="c-42304105">[-]</label><label class="expand" for="c-42304105">[1 more]</label></div><br/><div class="children"><div class="content">Elixir is also working on a proper type system with compile time + runtime type checks.</div><br/></div></div></div></div><div id="42303605" class="c"><input type="checkbox" id="c-42303605" checked=""/><div class="controls bullet"><span class="by">arlort</span><span>|</span><a href="#42303408">parent</a><span>|</span><a href="#42303933">prev</a><span>|</span><a href="#42303497">next</a><span>|</span><label class="collapse" for="c-42303605">[-]</label><label class="expand" for="c-42303605">[1 more]</label></div><br/><div class="children"><div class="content">minor nitpick, I think you meant arity. If it&#x27;s a typo sorry for the nitpick if you had only ever heard it spoken out loud before: arity is the number of parameters (in the context of functions), parity is whether a number is even or odd</div><br/></div></div><div id="42303497" class="c"><input type="checkbox" id="c-42303497" checked=""/><div class="controls bullet"><span class="by">jlarocco</span><span>|</span><a href="#42303408">parent</a><span>|</span><a href="#42303605">prev</a><span>|</span><label class="collapse" for="c-42303497">[-]</label><label class="expand" for="c-42303497">[2 more]</label></div><br/><div class="children"><div class="content">Meh, if I need that much detail I&#x27;ll just read the function.<p>And a function returning one of three types sounds like a <i>TERRIBLE</i> idea.</div><br/><div id="42303526" class="c"><input type="checkbox" id="c-42303526" checked=""/><div class="controls bullet"><span class="by">c0balt</span><span>|</span><a href="#42303408">root</a><span>|</span><a href="#42303497">parent</a><span>|</span><label class="collapse" for="c-42303526">[-]</label><label class="expand" for="c-42303526">[1 more]</label></div><br/><div class="children"><div class="content">&gt; And a function returning one of three types sounds like a TERRIBLE idea.<p>Should have been an enum :)</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>