<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1726304449836" as="style"/><link rel="stylesheet" href="styles.css?v=1726304449836"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://nochlin.com/blog/6-techniques-i-use-to-create-a-great-user-experience-for-shell-scripts">Techniques I use to create a great user experience for shell scripts</a>¬†<span class="domain">(<a href="https://nochlin.com">nochlin.com</a>)</span></div><div class="subtext"><span>hundredwatt</span> | <span>101 comments</span></div><br/><div><div id="41536036" class="c"><input type="checkbox" id="c-41536036" checked=""/><div class="controls bullet"><span class="by">haileys</span><span>|</span><a href="#41538483">next</a><span>|</span><label class="collapse" for="c-41536036">[-]</label><label class="expand" for="c-41536036">[5 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t output ANSI colour codes directly - your output could redirect to a file, or perhaps the user simply prefers no colour. Use tput instead, and add a little snippet like this to the top of your script:<p><pre><code>    command -v tput &amp;&gt;&#x2F;dev&#x2F;null &amp;&amp; [ -t 1 ] &amp;&amp; [ -z &quot;${NO_COLOR:-}&quot; ] || tput() { true; }
</code></pre>
This checks that the tput command exists (using the bash &#x27;command&#x27; builtin rather than which(1) - surprisingly, which can&#x27;t always be relied upon to be installed even on modern GNU&#x2F;Linux systems), that stdout is a tty, and that the NO_COLOR env var is not set. If any of these conditions are false, a no-op tput function is defined.<p>This little snippet of setup lets you sprinkle tput invocations through your script knowing that it&#x27;s going to do the right thing in any situation.</div><br/><div id="41537529" class="c"><input type="checkbox" id="c-41537529" checked=""/><div class="controls bullet"><span class="by">jph</span><span>|</span><a href="#41536036">parent</a><span>|</span><a href="#41536965">next</a><span>|</span><label class="collapse" for="c-41537529">[-]</label><label class="expand" for="c-41537529">[1 more]</label></div><br/><div class="children"><div class="content">Yes and even better for faster speed and greater shell compatibility for basic colors, you can use this POSIX code:<p><pre><code>    if [ -t 1 ] &amp;&amp; [ -z &quot;${NO_COLOR:-}&quot; ]; then
      COLOR_RESET=&#x27;[0m&#x27;
      COLOR_RED=&#x27;[31m&#x27;
      COLOR_GREEN=&#x27;[32m&#x27;
      COLOR_BLUE=&#x27;[34m&#x27;
    else
      COLOR_RESET=&#x27;&#x27;
      COLOR_RED=&#x27;&#x27;
      COLOR_GREEN=&#x27;&#x27;
      COLOR_BLUE=&#x27;&#x27;
    fi
</code></pre>
For more about this see Unix Shell Script Tactics: <a href="https:&#x2F;&#x2F;github.com&#x2F;SixArm&#x2F;unix-shell-script-tactics&#x2F;tree&#x2F;main&#x2F;doc&#x2F;use-color-with-terminal-escape-codes-and-no-color">https:&#x2F;&#x2F;github.com&#x2F;SixArm&#x2F;unix-shell-script-tactics&#x2F;tree&#x2F;mai...</a><p>Be aware there&#x27;s an escape character at the start of each of color string, which is the POSIX equivalent of $&#x27;\e&#x27;; Hacker News seems to cut out that escape character.</div><br/></div></div><div id="41536965" class="c"><input type="checkbox" id="c-41536965" checked=""/><div class="controls bullet"><span class="by">lilyball</span><span>|</span><a href="#41536036">parent</a><span>|</span><a href="#41537529">prev</a><span>|</span><a href="#41537251">next</a><span>|</span><label class="collapse" for="c-41536965">[-]</label><label class="expand" for="c-41536965">[1 more]</label></div><br/><div class="children"><div class="content">If you use tput a lot it&#x27;s also worth caching the output, because invoking it for every single color change and reset can really add up. If you know you&#x27;re going to use a bunch of colors up front you can just stuff them into vars<p><pre><code>  RED=$(tput setaf 1)
  GREEN=$(tput setaf 2)
  RESET=$(tput sgr0)</code></pre></div><br/></div></div><div id="41537251" class="c"><input type="checkbox" id="c-41537251" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#41536036">parent</a><span>|</span><a href="#41536965">prev</a><span>|</span><a href="#41536210">next</a><span>|</span><label class="collapse" for="c-41537251">[-]</label><label class="expand" for="c-41537251">[1 more]</label></div><br/><div class="children"><div class="content">There should just be a command for this. Like echo with a color flag that does something if you‚Äôre in a tty.</div><br/></div></div></div></div><div id="41538483" class="c"><input type="checkbox" id="c-41538483" checked=""/><div class="controls bullet"><span class="by">emmelaich</span><span>|</span><a href="#41536036">prev</a><span>|</span><a href="#41537483">next</a><span>|</span><label class="collapse" for="c-41538483">[-]</label><label class="expand" for="c-41538483">[1 more]</label></div><br/><div class="children"><div class="content">Tiny nitpick - usage errors are conventionally &#x27;exit 2&#x27; not &#x27;exit 1&#x27;</div><br/></div></div><div id="41537483" class="c"><input type="checkbox" id="c-41537483" checked=""/><div class="controls bullet"><span class="by">gorgoiler</span><span>|</span><a href="#41538483">prev</a><span>|</span><a href="#41536084">next</a><span>|</span><label class="collapse" for="c-41537483">[-]</label><label class="expand" for="c-41537483">[1 more]</label></div><br/><div class="children"><div class="content">It is impossible to write a safe shell script that does automatic error checking while using the features the language claims are available to you.<p>Here‚Äôs a script that uses <i>real language</i> things like a function and error checking, but which also prints ‚Äúoh no‚Äù:<p><pre><code>  set -e

  f() {
    false
    echo oh
  }

  if f
  then
    echo no
  fi
</code></pre>
<i>set -e</i> is off when your function is called as a predicate.  That‚Äôs such a letdown from expected- to actual-behavior that I threw it in the bin as a programming language.  The only remedy is for each function to be its own script.  Great!<p>In terms of sh enlightenment, one of the steps before getting to the above is realizing that every time you use ‚Äú;‚Äù you are using a technique to jam a multi-line expression onto a single line.  It starts to feel incongruous to mix single line and multi line syntax:<p><pre><code>  # weird
  if foo; then
    bar
  fi

  # ahah
  if foo
  then
    bar
  fi
</code></pre>
Writing long scripts without semicolons felt refreshing, like I was using the syntax in the way that nature intended.<p>Shell scripting has its place.  Command invocation with sh along with C functions is the de-facto API in Linux.  Shell scripts need to fail fast and hard though and leave it up to the caller (either a different language, or another shell script) to figure out how to handle errors.</div><br/></div></div><div id="41536084" class="c"><input type="checkbox" id="c-41536084" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#41537483">prev</a><span>|</span><a href="#41537554">next</a><span>|</span><label class="collapse" for="c-41536084">[-]</label><label class="expand" for="c-41536084">[8 more]</label></div><br/><div class="children"><div class="content">Nowhere in this list did I see ‚Äúuse shellcheck.‚Äù<p>On the scale of care, ‚Äúthe script can blow up in surprising ways‚Äù severely outweighs ‚Äúerror messages are in red.‚Äù Also, as someone else pointed out, what if I‚Äôm redirecting to a file?</div><br/><div id="41537661" class="c"><input type="checkbox" id="c-41537661" checked=""/><div class="controls bullet"><span class="by">hinkley</span><span>|</span><a href="#41536084">parent</a><span>|</span><a href="#41536909">next</a><span>|</span><label class="collapse" for="c-41537661">[-]</label><label class="expand" for="c-41537661">[3 more]</label></div><br/><div class="children"><div class="content">Always fun trying to read errors in a CI build and they are full of [[</div><br/><div id="41538372" class="c"><input type="checkbox" id="c-41538372" checked=""/><div class="controls bullet"><span class="by">wolletd</span><span>|</span><a href="#41536084">root</a><span>|</span><a href="#41537661">parent</a><span>|</span><a href="#41538265">next</a><span>|</span><label class="collapse" for="c-41538372">[-]</label><label class="expand" for="c-41538372">[1 more]</label></div><br/><div class="children"><div class="content">Depends on the CI used, I guess. Gitlab CI and Github Actions show colors and I use them deliberately in a format check job to show a colored diff in the output.</div><br/></div></div><div id="41538265" class="c"><input type="checkbox" id="c-41538265" checked=""/><div class="controls bullet"><span class="by">Etheryte</span><span>|</span><a href="#41536084">root</a><span>|</span><a href="#41537661">parent</a><span>|</span><a href="#41538372">prev</a><span>|</span><a href="#41536909">next</a><span>|</span><label class="collapse" for="c-41538265">[-]</label><label class="expand" for="c-41538265">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s just another Lisper wishing they weren&#x27;t writing Bash right now.</div><br/></div></div></div></div><div id="41536909" class="c"><input type="checkbox" id="c-41536909" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><a href="#41536084">parent</a><span>|</span><a href="#41537661">prev</a><span>|</span><a href="#41537554">next</a><span>|</span><label class="collapse" for="c-41536909">[-]</label><label class="expand" for="c-41536909">[4 more]</label></div><br/><div class="children"><div class="content">I find shellcheck to be a bit of a nuisance. For simple one-shot scripts, like cron jobs or wrappers, it&#x27;s fine. But for more complicated scripts or command line tools, it can have a pretty poor signal-to-noise ratio. Not universally, but often enough that I don&#x27;t really reach for it anymore.<p>In truth when I find myself writing a large &quot;program&quot; in Bash such that shellcheck is cumbersome it&#x27;s a good indication that it should instead be written in a compiled language.</div><br/><div id="41537738" class="c"><input type="checkbox" id="c-41537738" checked=""/><div class="controls bullet"><span class="by">plorkyeran</span><span>|</span><a href="#41536084">root</a><span>|</span><a href="#41536909">parent</a><span>|</span><a href="#41536971">next</a><span>|</span><label class="collapse" for="c-41537738">[-]</label><label class="expand" for="c-41537738">[1 more]</label></div><br/><div class="children"><div class="content">I‚Äôve definitely hit places where shellcheck is just plain wrong, but I‚Äôve started to just think of it as a different language that‚Äôs a subset of shell. It‚Äôs less of a linter and more like using gradual type checking, where there‚Äôs no guarantee that all valid programs will be accepted; only that the programs which are accepted are free of certain categories of bugs.</div><br/></div></div><div id="41536971" class="c"><input type="checkbox" id="c-41536971" checked=""/><div class="controls bullet"><span class="by">lilyball</span><span>|</span><a href="#41536084">root</a><span>|</span><a href="#41536909">parent</a><span>|</span><a href="#41537738">prev</a><span>|</span><a href="#41537554">next</a><span>|</span><label class="collapse" for="c-41536971">[-]</label><label class="expand" for="c-41536971">[2 more]</label></div><br/><div class="children"><div class="content">What sort of noise do you see? I find it&#x27;s pretty rare to run into something that needs to be suppressed.</div><br/><div id="41537006" class="c"><input type="checkbox" id="c-41537006" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><a href="#41536084">root</a><span>|</span><a href="#41536971">parent</a><span>|</span><a href="#41537554">next</a><span>|</span><label class="collapse" for="c-41537006">[-]</label><label class="expand" for="c-41537006">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s been so long since I used it seriously I couldn&#x27;t tell you.<p>There&#x27;s over 1000 open issues on the GitHub repo, and over 100 contain &quot;false positive&quot;. I recognize several of these at first glance.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;koalaman&#x2F;shellcheck&#x2F;issues?q=is%3Aissue+is%3Aopen+%22false+positive%22">https:&#x2F;&#x2F;github.com&#x2F;koalaman&#x2F;shellcheck&#x2F;issues?q=is%3Aissue+i...</a></div><br/></div></div></div></div></div></div></div></div><div id="41537554" class="c"><input type="checkbox" id="c-41537554" checked=""/><div class="controls bullet"><span class="by">Yasuraka</span><span>|</span><a href="#41536084">prev</a><span>|</span><a href="#41536146">next</a><span>|</span><label class="collapse" for="c-41537554">[-]</label><label class="expand" for="c-41537554">[2 more]</label></div><br/><div class="children"><div class="content">Here&#x27;s a script that left an impression on me the first time I saw it:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;containerd&#x2F;nerdctl&#x2F;blob&#x2F;main&#x2F;extras&#x2F;rootless&#x2F;containerd-rootless-setuptool.sh">https:&#x2F;&#x2F;github.com&#x2F;containerd&#x2F;nerdctl&#x2F;blob&#x2F;main&#x2F;extras&#x2F;rootl...</a><p>I have since copied this pattern for many scripts: logging functions, grouping all global vars and constants at the top and creating subcommands using shift.</div><br/><div id="41538305" class="c"><input type="checkbox" id="c-41538305" checked=""/><div class="controls bullet"><span class="by">oneshtein</span><span>|</span><a href="#41537554">parent</a><span>|</span><a href="#41536146">next</a><span>|</span><label class="collapse" for="c-41538305">[-]</label><label class="expand" for="c-41538305">[1 more]</label></div><br/><div class="children"><div class="content">You may like bash-modules then: <a href="https:&#x2F;&#x2F;github.com&#x2F;vlisivka&#x2F;bash-modules&#x2F;tree&#x2F;master&#x2F;bash-modules&#x2F;examples">https:&#x2F;&#x2F;github.com&#x2F;vlisivka&#x2F;bash-modules&#x2F;tree&#x2F;master&#x2F;bash-mo...</a></div><br/></div></div></div></div><div id="41536146" class="c"><input type="checkbox" id="c-41536146" checked=""/><div class="controls bullet"><span class="by">koolba</span><span>|</span><a href="#41537554">prev</a><span>|</span><a href="#41536680">next</a><span>|</span><label class="collapse" for="c-41536146">[-]</label><label class="expand" for="c-41536146">[4 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    if [ &quot;$(uname -s)&quot; == &quot;Linux‚Äù ]; then 
       stuff-goes-here
    else # Assume MacOS 
</code></pre>
While probably true for most folks, that‚Äôs hardly what I‚Äôd call great for everybody not on Linux or a Mac.</div><br/><div id="41536183" class="c"><input type="checkbox" id="c-41536183" checked=""/><div class="controls bullet"><span class="by">klysm</span><span>|</span><a href="#41536146">parent</a><span>|</span><a href="#41536227">next</a><span>|</span><label class="collapse" for="c-41536183">[-]</label><label class="expand" for="c-41536183">[2 more]</label></div><br/><div class="children"><div class="content">Gotta draw a line somewhere</div><br/><div id="41536988" class="c"><input type="checkbox" id="c-41536988" checked=""/><div class="controls bullet"><span class="by">edflsafoiewq</span><span>|</span><a href="#41536146">root</a><span>|</span><a href="#41536183">parent</a><span>|</span><a href="#41536227">next</a><span>|</span><label class="collapse" for="c-41536988">[-]</label><label class="expand" for="c-41536988">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, but you could at least elif is mac then ... else unsupported end.</div><br/></div></div></div></div><div id="41536227" class="c"><input type="checkbox" id="c-41536227" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#41536146">parent</a><span>|</span><a href="#41536183">prev</a><span>|</span><a href="#41536680">next</a><span>|</span><label class="collapse" for="c-41536227">[-]</label><label class="expand" for="c-41536227">[1 more]</label></div><br/><div class="children"><div class="content">Eh. It‚Äôs true for most, and if not, it‚Äôs probably still a *BSD, so there‚Äôs a good chance that anything written for a Mac will still work.<p>That said, I‚Äôve never used any of the BSDs, so I may be way off here.</div><br/></div></div></div></div><div id="41536680" class="c"><input type="checkbox" id="c-41536680" checked=""/><div class="controls bullet"><span class="by">dvrp</span><span>|</span><a href="#41536146">prev</a><span>|</span><a href="#41537960">next</a><span>|</span><label class="collapse" for="c-41536680">[-]</label><label class="expand" for="c-41536680">[13 more]</label></div><br/><div class="children"><div class="content">These are all about passive experiences (which are great don&#x27;t get me wrong!), but I think you can do better. It&#x27;s the same phenomenon DHH talked about in the Rails doctrine when he said to &quot;Optimize for programmer happiness&quot;.<p>The python excerpt is my favorite example:<p>```<p>$ irb<p>irb(main):001:0&gt; exit<p>$ irb<p>irb(main):001:0&gt; quit<p>$ python<p>&gt;&gt;&gt; exit<p>Use exit() or Ctrl-D (i.e. EOF) to exit<p>```<p>&lt;quote&gt;
Ruby accepts both exit and quit to accommodate the programmer‚Äôs obvious desire to quit its interactive console. Python, on the other hand, pedantically instructs the programmer how to properly do what‚Äôs requested, even though it obviously knows what is meant (since it‚Äôs displaying the error message). That‚Äôs a pretty clear-cut, albeit small, example of [Principle of Least Surprise].
&lt;&#x2F;quote&gt;</div><br/><div id="41537654" class="c"><input type="checkbox" id="c-41537654" checked=""/><div class="controls bullet"><span class="by">FragenAntworten</span><span>|</span><a href="#41536680">parent</a><span>|</span><a href="#41537651">next</a><span>|</span><label class="collapse" for="c-41537654">[-]</label><label class="expand" for="c-41537654">[1 more]</label></div><br/><div class="children"><div class="content">`exit` will work as expected in Python 3.13: <a href="https:&#x2F;&#x2F;docs.python.org&#x2F;3.13&#x2F;whatsnew&#x2F;3.13.html#whatsnew313-better-interactive-interpreter" rel="nofollow">https:&#x2F;&#x2F;docs.python.org&#x2F;3.13&#x2F;whatsnew&#x2F;3.13.html#whatsnew313-...</a></div><br/></div></div><div id="41537651" class="c"><input type="checkbox" id="c-41537651" checked=""/><div class="controls bullet"><span class="by">mixmastamyk</span><span>|</span><a href="#41536680">parent</a><span>|</span><a href="#41537654">prev</a><span>|</span><a href="#41537179">next</a><span>|</span><label class="collapse" for="c-41537651">[-]</label><label class="expand" for="c-41537651">[1 more]</label></div><br/><div class="children"><div class="content">Bad timing, this is changed in Python 3.12.<p>Still I‚Äôve always used Ctrl+D, which works everywhere unixy.</div><br/></div></div><div id="41537179" class="c"><input type="checkbox" id="c-41537179" checked=""/><div class="controls bullet"><span class="by">AlienRobot</span><span>|</span><a href="#41536680">parent</a><span>|</span><a href="#41537651">prev</a><span>|</span><a href="#41537482">next</a><span>|</span><label class="collapse" for="c-41537179">[-]</label><label class="expand" for="c-41537179">[3 more]</label></div><br/><div class="children"><div class="content">Yes. I&#x27;d be surprised if exit without parentheses quit the interactive shell when it doesn&#x27;t quit a normal python script.</div><br/><div id="41537478" class="c"><input type="checkbox" id="c-41537478" checked=""/><div class="controls bullet"><span class="by">wodenokoto</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537179">parent</a><span>|</span><a href="#41537482">next</a><span>|</span><label class="collapse" for="c-41537478">[-]</label><label class="expand" for="c-41537478">[2 more]</label></div><br/><div class="children"><div class="content">Ipython quits without parenthesis.</div><br/><div id="41537878" class="c"><input type="checkbox" id="c-41537878" checked=""/><div class="controls bullet"><span class="by">nerdponx</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537478">parent</a><span>|</span><a href="#41537482">next</a><span>|</span><label class="collapse" for="c-41537878">[-]</label><label class="expand" for="c-41537878">[1 more]</label></div><br/><div class="children"><div class="content">IPython includes a whole lot of extra magic of various kinds, compared to the built-in Python console.</div><br/></div></div></div></div></div></div><div id="41537482" class="c"><input type="checkbox" id="c-41537482" checked=""/><div class="controls bullet"><span class="by">tpmoney</span><span>|</span><a href="#41536680">parent</a><span>|</span><a href="#41537179">prev</a><span>|</span><a href="#41537180">next</a><span>|</span><label class="collapse" for="c-41537482">[-]</label><label class="expand" for="c-41537482">[3 more]</label></div><br/><div class="children"><div class="content">On the one hand, being generous in your inputs is always appreciated. On the other hand, the fact that both exit and quit will terminate ruby means the answer to &quot;how do I quit ruby&quot; now has two answers (technically 4 because `quit()` and `exit()` also work, and if we&#x27;re talking about &quot;least surprise&quot; if you accept &quot;exit&quot; and &quot;quit&quot;, why not also &quot;bye&quot; or &quot;leave&quot; or &quot;close&quot; or &quot;end&quot; or &quot;terminate&quot;.<p>Python might be surprising, but in this example, it&#x27;s only surprising once, and helpful when it surprises you. Now you know quitting requires calling a function and that function is named exit() (although amusingly python3 anyway also accepts quit()). And being fully pedantic it doesn&#x27;t know what you mean, it is assuming what you mean and making a suggestion, but that&#x27;s not the same as knowing.<p>From here on I&#x27;m not arguing the point anymore, just recording some of the interesting things I discovered exploring this in response to your comment:<p>You can do this in python (which IMO is surprising, but in a different way):<p><pre><code>  ```
  &gt;&gt;&gt; quit
  Use quit() or Ctrl-D (i.e. EOF) to exit
  &gt;&gt;&gt; quit=True
  &gt;&gt;&gt; quit
  True
  &gt;&gt;&gt; quit()
  Traceback (most recent call last):
    File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  TypeError: &#x27;bool&#x27; object is not callable
  &gt;&gt;&gt; exit()
  ```
</code></pre>
But this also gives some sense to python&#x27;s behavior. `quit` and `exit` are symbol names, and they have default assignments, but they&#x27;re re-assignable like any other symbol in python. So the behavior it exhibits makes sense if we assume that they&#x27;re not special objects beyond just being built int.<p>`exit` is a class isntance according to type. So we should be able to create something similar, and indeed we can:<p><pre><code>  ```
  &gt;&gt;&gt; class Bar:
  ...   def __repr__(self):
  ...     return &quot;Type bar() to quit!&quot;
  ...   def __call__(self):
  ...     print(&quot;I quit!&quot;)
  ...
  &gt;&gt;&gt; bar = Bar()
  &gt;&gt;&gt; bar
  Type bar() to quit!
  &gt;&gt;&gt; bar()
  I quit!
  &gt;&gt;&gt;
  ```
</code></pre>
Interestingly this suggests we should be able to replace exit with our own implementation that does what ruby does if we really wanted too:<p><pre><code>  ```
  &gt;&gt;&gt; class SuperExit:
  ...   def __init__(self, real):
  ...     self.real_exit=real
  ...   def __repr__(self):
  ...     print(&quot;Exiting via repr&quot;)
  ...     self.real_exit()
  ...   def __call__(self):
  ...     print(&quot;Exiting via call&quot;)
  ...     self.real_exit()
  ...
  &gt;&gt;&gt; exit = SuperExit(exit)
  &gt;&gt;&gt; exit
  Exiting via repr
  ```</code></pre></div><br/><div id="41537568" class="c"><input type="checkbox" id="c-41537568" checked=""/><div class="controls bullet"><span class="by">laserlight</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537482">parent</a><span>|</span><a href="#41537180">next</a><span>|</span><label class="collapse" for="c-41537568">[-]</label><label class="expand" for="c-41537568">[2 more]</label></div><br/><div class="children"><div class="content">&gt; why not also &quot;bye&quot; or &quot;leave&quot; or &quot;close&quot; or &quot;end&quot; or &quot;terminate&quot;.<p>We can include these as well, but each keyword that you include brings diminishing returns at the cost of clutter and inconsistence in the API. Python problematically decides that returns diminish after the first --- ‚Äúfirst‚Äù according to developers, that is --- possibility <i>in all cases</i>. Ruby anticipates that everyone&#x27;s first choice will be different and practically maximizes comfort of users.</div><br/><div id="41537898" class="c"><input type="checkbox" id="c-41537898" checked=""/><div class="controls bullet"><span class="by">tpmoney</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537568">parent</a><span>|</span><a href="#41537180">next</a><span>|</span><label class="collapse" for="c-41537898">[-]</label><label class="expand" for="c-41537898">[1 more]</label></div><br/><div class="children"><div class="content">&gt;Python problematically decides that returns diminish after the first --- ‚Äúfirst‚Äù according to developers, that is --- possibility in all cases<p>Eh, that feels pretty arbitrary to me. `quit()` and `exit()` both work, and looking at other languages, `exit()` should almost certainly be your first choice<p><pre><code>     C: exit(int)
  Java: System.exit(int)
  SBCL: (quit)&#x2F;(exit)
    C#: Environment.Exit(int)
   PHP: exit(int)&#x2F;exit(string)
  Rust: std::process::exit(int)
</code></pre>
Having `exit` or `quit` without the parens work might accommodate some people whose first choice isn&#x27;t to call a function (I guess because they&#x27;re thinking of the REPL as a shell?), but surely if you&#x27;re going that far `bye` is a reasonable and practical choice. ftp&#x2F;sftp use it to this day. At some point you make a cutoff, and where you do is pretty arbitrary. You can like that ruby is twice as lenient as python, but I think it&#x27;s a stretch to say that python using the single most common function call and a very common alias is &quot;problematic&quot; or even surprising. IMO, python&#x27;s behavior is less surprising because I don&#x27;t expect `exit` to be a special command that executes inside the REPL. I expect `exit()` because that&#x27;s what other programing languages do. And python famously ditched the inconsistent `print &quot;Foo&quot;` syntax in favor of `print(&quot;Foo&quot;)` in python3 exactly because inconsistency in what was and wasn&#x27;t a function call was surprising.</div><br/></div></div></div></div></div></div><div id="41537180" class="c"><input type="checkbox" id="c-41537180" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#41536680">parent</a><span>|</span><a href="#41537482">prev</a><span>|</span><a href="#41537960">next</a><span>|</span><label class="collapse" for="c-41537180">[-]</label><label class="expand" for="c-41537180">[4 more]</label></div><br/><div class="children"><div class="content">this actually completely turned me off from python when I first encountered it. I was like... &quot;the program KNEW WHAT I WAS TRYING TO DO, and instead of just DOING that it ADMONISHED me, fuck Python&quot; LOL<p>The proliferation of Python has only made my feelings worse. Try running a 6 month old Python project that you haven&#x27;t touched and see if it still runs. &#x2F;eyeroll</div><br/><div id="41537524" class="c"><input type="checkbox" id="c-41537524" checked=""/><div class="controls bullet"><span class="by">tpmoney</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537180">parent</a><span>|</span><a href="#41537960">next</a><span>|</span><label class="collapse" for="c-41537524">[-]</label><label class="expand" for="c-41537524">[3 more]</label></div><br/><div class="children"><div class="content">&gt;Try running a 6 month old Python project that you haven&#x27;t touched and see if it still runs.<p>My experience has been 6 month of python works fine. In fact, python is my go to these days for anything longer than a 5 line shell script (mostly because argparse is builtin now). On the other hand, running a newly written python script with a 6 month old version of python, that&#x27;s likely to get you into trouble.</div><br/><div id="41537534" class="c"><input type="checkbox" id="c-41537534" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537524">parent</a><span>|</span><a href="#41537960">next</a><span>|</span><label class="collapse" for="c-41537534">[-]</label><label class="expand" for="c-41537534">[2 more]</label></div><br/><div class="children"><div class="content">argparse? docopt or google-python-fire</div><br/><div id="41537770" class="c"><input type="checkbox" id="c-41537770" checked=""/><div class="controls bullet"><span class="by">tpmoney</span><span>|</span><a href="#41536680">root</a><span>|</span><a href="#41537534">parent</a><span>|</span><a href="#41537960">next</a><span>|</span><label class="collapse" for="c-41537770">[-]</label><label class="expand" for="c-41537770">[1 more]</label></div><br/><div class="children"><div class="content">argparse, because argparse is built in. I&#x27;m usually writing shell scripts to automate some process for myself and my co-workers. The last thing I want is for them to have to be fiddling with installing external requirements if I can avoid it.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41537960" class="c"><input type="checkbox" id="c-41537960" checked=""/><div class="controls bullet"><span class="by">teo_zero</span><span>|</span><a href="#41536680">prev</a><span>|</span><a href="#41535742">next</a><span>|</span><label class="collapse" for="c-41537960">[-]</label><label class="expand" for="c-41537960">[2 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  if [ -x &quot;$(command -v gtimeout)&quot; ]; then
</code></pre>
Interesting way to check if a command is installed. How is it better than the simpler and more common &quot;if command...; then&quot;?</div><br/><div id="41538117" class="c"><input type="checkbox" id="c-41538117" checked=""/><div class="controls bullet"><span class="by">mbivert</span><span>|</span><a href="#41537960">parent</a><span>|</span><a href="#41535742">next</a><span>|</span><label class="collapse" for="c-41538117">[-]</label><label class="expand" for="c-41538117">[1 more]</label></div><br/><div class="children"><div class="content">The form you propose runs `command`, which may have undesired side-effects. I always thought `which` to be standard, but TIL `command` (sh builtin) is[0].<p>[0]: <a href="https:&#x2F;&#x2F;hynek.me&#x2F;til&#x2F;which-not-posix&#x2F;" rel="nofollow">https:&#x2F;&#x2F;hynek.me&#x2F;til&#x2F;which-not-posix&#x2F;</a></div><br/></div></div></div></div><div id="41535742" class="c"><input type="checkbox" id="c-41535742" checked=""/><div class="controls bullet"><span class="by">bfung</span><span>|</span><a href="#41537960">prev</a><span>|</span><a href="#41537307">next</a><span>|</span><label class="collapse" for="c-41535742">[-]</label><label class="expand" for="c-41535742">[2 more]</label></div><br/><div class="children"><div class="content">Only one that‚Äôs shell specific is 4. The rest can be applied any code written.  Good work!</div><br/><div id="41535834" class="c"><input type="checkbox" id="c-41535834" checked=""/><div class="controls bullet"><span class="by">kemitche</span><span>|</span><a href="#41535742">parent</a><span>|</span><a href="#41537307">next</a><span>|</span><label class="collapse" for="c-41535834">[-]</label><label class="expand" for="c-41535834">[1 more]</label></div><br/><div class="children"><div class="content">Even 4 can be generalized to &quot;be deliberate about what you do with a failed function call (etc) - does it exit the command? Log&#x2F;print an error and continue? Get silently ignored? Handled?&quot;</div><br/></div></div></div></div><div id="41537307" class="c"><input type="checkbox" id="c-41537307" checked=""/><div class="controls bullet"><span class="by">jojo_</span><span>|</span><a href="#41535742">prev</a><span>|</span><a href="#41535658">next</a><span>|</span><label class="collapse" for="c-41537307">[-]</label><label class="expand" for="c-41537307">[1 more]</label></div><br/><div class="children"><div class="content">Few months ago, I wrote a bash script for an open-source project.<p>I created a small awk util that I used throughout the script to style the output. I found it very convenient. I wonder if something similar already exists.<p>Some screenshots in the PR: <a href="https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;pull&#x2F;18">https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;pull&#x2F;18</a><p>Let me know guys if you like it. Any comments appreciated.<p><pre><code>    function theme() {
        ! $IS_TTY &amp;&amp; cat || awk &#x27;

    &#x2F;^([[:space:]]*)SUCCESS:&#x2F;   { sub(&quot;SUCCESS:&quot;, &quot; \033[1;32m&amp;&quot;); print; printf &quot;\033[0m&quot;; next }
    &#x2F;^([[:space:]]*)ERROR:&#x2F;     { sub(&quot;ERROR:&quot;, &quot; \033[1;31m&amp;&quot;); print; printf &quot;\033[0m&quot;; next }

    &#x2F;^        &#x2F; { print; next }
    &#x2F;^    &#x2F;     { print &quot;\033[1m&quot; $0 &quot;\033[0m&quot;; next }
    &#x2F;^.&#x2F;        { print &quot;\033[4m&quot; $0 &quot;\033[0m&quot;; next }
                { print }

    END { printf &quot;\033[0;0m&quot; }&#x27;
    }</code></pre>
Go to source: <a href="https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playground&#x2F;play.sh#L560-L583">https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playg...</a><p>Example usage:<p><pre><code>    exit_with_help_message() {
        local exit_code=$1

        cat &lt;&lt;EOF | theme
    CQL Playground

    Sub-commands:
        help
            Show this help message
        hello
            Onboarding checklist ‚Äî Get ready to use the playground
        build-cql-compiler
            Rebuild the CQL compiler
</code></pre>
Go to source: <a href="https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playground&#x2F;play.sh#L26">https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playg...</a><p><pre><code>        cat &lt;&lt;EOF | theme
    CQL Playground ‚Äî Onboarding checklist

    Required Dependencies
        The CQL compiler
            $($cql_compiler_ready &amp;&amp; \
                echo &quot;SUCCESS: The CQL compiler is ready ($CQL)&quot; || \
                echo &quot;ERROR: The CQL compiler was not found. Build it with: $CLI_NAME build-cql-compiler&quot;
            )
</code></pre>
Go to source: <a href="https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playground&#x2F;play.sh#L114">https:&#x2F;&#x2F;github.com&#x2F;ricomariani&#x2F;CG-SQL-author&#x2F;blob&#x2F;main&#x2F;playg...</a></div><br/></div></div><div id="41535658" class="c"><input type="checkbox" id="c-41535658" checked=""/><div class="controls bullet"><span class="by">denvaar</span><span>|</span><a href="#41537307">prev</a><span>|</span><a href="#41538256">next</a><span>|</span><label class="collapse" for="c-41535658">[-]</label><label class="expand" for="c-41535658">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;d add that if you&#x27;re going to use color, then you should do the appropriate checks for determining if STDOUT isatty</div><br/><div id="41535730" class="c"><input type="checkbox" id="c-41535730" checked=""/><div class="controls bullet"><span class="by">zdw</span><span>|</span><a href="#41535658">parent</a><span>|</span><a href="#41538256">next</a><span>|</span><label class="collapse" for="c-41535730">[-]</label><label class="expand" for="c-41535730">[1 more]</label></div><br/><div class="children"><div class="content">Or $NO_COLOR, per <a href="https:&#x2F;&#x2F;no-color.org" rel="nofollow">https:&#x2F;&#x2F;no-color.org</a></div><br/></div></div></div></div><div id="41538256" class="c"><input type="checkbox" id="c-41538256" checked=""/><div class="controls bullet"><span class="by">thangalin</span><span>|</span><a href="#41535658">prev</a><span>|</span><a href="#41537824">next</a><span>|</span><label class="collapse" for="c-41538256">[-]</label><label class="expand" for="c-41538256">[1 more]</label></div><br/><div class="children"><div class="content">The first four parts of my Typesetting Markdown blog describes improving the user-friendliness of bash scripts. In particular, you can use bash to define a reusable script that allows isolating software dependencies, command-line arguments, and parsing.<p><a href="https:&#x2F;&#x2F;dave.autonoma.ca&#x2F;blog&#x2F;2019&#x2F;05&#x2F;22&#x2F;typesetting-markdown-part-1&#x2F;" rel="nofollow">https:&#x2F;&#x2F;dave.autonoma.ca&#x2F;blog&#x2F;2019&#x2F;05&#x2F;22&#x2F;typesetting-markdow...</a><p>In effect, create a list of dependencies and arguments:<p><pre><code>    #!&#x2F;usr&#x2F;bin&#x2F;env bash
    source $HOME&#x2F;bin&#x2F;build-template

    DEPENDENCIES=(
      &quot;gradle,https:&#x2F;&#x2F;gradle.org&quot;
      &quot;warp-packer,https:&#x2F;&#x2F;github.com&#x2F;Reisz&#x2F;warp&#x2F;releases&quot;
      &quot;linux-x64.warp-packer,https:&#x2F;&#x2F;github.com&#x2F;dgiagio&#x2F;warp&#x2F;releases&quot;
      &quot;osslsigncode,https:&#x2F;&#x2F;www.winehq.org&quot;
    )

    ARGUMENTS+=(
      &quot;a,arch,Target operating system architecture (amd64)&quot;
      &quot;o,os,Target operating system (linux, windows, macos)&quot;
      &quot;u,update,Java update version number (${ARG_JAVA_UPDATE})&quot;
      &quot;v,version,Full Java version (${ARG_JAVA_VERSION})&quot;
    )
</code></pre>
The build-template can then be reused to enhance other shell scripts. Note how by defining the command-line arguments as data you can provide a general solution to printing usage information:<p><a href="https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;scripts&#x2F;build-template?#L186" rel="nofollow">https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;scripts&#x2F;...</a><p>Further, the same command-line arguments list can be used to parse the options:<p><a href="https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;scripts&#x2F;build-template?#L186" rel="nofollow">https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;scripts&#x2F;...</a><p>If you want further generalization, it&#x27;s possible to have the template parse the command-line arguments automatically for any particular script. Tweak the arguments list slightly by prefixing the name of the variable to assign to the option value provided on the CLI:<p><pre><code>    ARGUMENTS+=(
      &quot;ARG_JAVA_ARCH,a,arch,Target operating system architecture (amd64)&quot;
      &quot;ARG_JAVA_OS,o,os,Target operating system (linux, windows, macos)&quot;
      &quot;ARG_JAVA_UPDATE,u,update,Java update version number (${ARG_JAVA_UPDATE})&quot;
      &quot;ARG_JAVA_VERSION,v,version,Full Java version (${ARG_JAVA_VERSION})&quot;
    )
</code></pre>
If the command-line options require running different code, it is possible to accommodate that as well, in a reusable solution.</div><br/></div></div><div id="41537824" class="c"><input type="checkbox" id="c-41537824" checked=""/><div class="controls bullet"><span class="by">teo_zero</span><span>|</span><a href="#41538256">prev</a><span>|</span><a href="#41536112">next</a><span>|</span><label class="collapse" for="c-41537824">[-]</label><label class="expand" for="c-41537824">[3 more]</label></div><br/><div class="children"><div class="content">In the 4th section, is there a reason why set +e is inside the loop while set -e is outside, or is it just an error?</div><br/><div id="41537907" class="c"><input type="checkbox" id="c-41537907" checked=""/><div class="controls bullet"><span class="by">kitd</span><span>|</span><a href="#41537824">parent</a><span>|</span><a href="#41536112">next</a><span>|</span><label class="collapse" for="c-41537907">[-]</label><label class="expand" for="c-41537907">[2 more]</label></div><br/><div class="children"><div class="content">He says in the article. &#x27;Set +e&#x27; prevents any error in a fork blitzing the whole script.</div><br/><div id="41537930" class="c"><input type="checkbox" id="c-41537930" checked=""/><div class="controls bullet"><span class="by">teo_zero</span><span>|</span><a href="#41537824">root</a><span>|</span><a href="#41537907">parent</a><span>|</span><a href="#41536112">next</a><span>|</span><label class="collapse" for="c-41537930">[-]</label><label class="expand" for="c-41537930">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s clear, my question is why the +e is inside the loop and thus is set at each iteration, while the -e is outside it and thus is set only once at the end.</div><br/></div></div></div></div></div></div><div id="41536112" class="c"><input type="checkbox" id="c-41536112" checked=""/><div class="controls bullet"><span class="by">xyzzy4747</span><span>|</span><a href="#41537824">prev</a><span>|</span><a href="#41535947">next</a><span>|</span><label class="collapse" for="c-41536112">[-]</label><label class="expand" for="c-41536112">[12 more]</label></div><br/><div class="children"><div class="content">Not trying to offend anyone here but I think shell scripts are the wrong solution for anything over ~50 lines of code.<p>Use a better programming language. Go, Typescript, Rust, Python, and even Perl come to mind.</div><br/><div id="41536552" class="c"><input type="checkbox" id="c-41536552" checked=""/><div class="controls bullet"><span class="by">heresie-dabord</span><span>|</span><a href="#41536112">parent</a><span>|</span><a href="#41536125">next</a><span>|</span><label class="collapse" for="c-41536552">[-]</label><label class="expand" for="c-41536552">[4 more]</label></div><br/><div class="children"><div class="content">&gt;  shell scripts are the wrong solution for anything over ~50 lines of code.<p>I don&#x27;t think LOC is the correct criterion.<p>I do solve many problems with bash and I enjoy the simplicity of shell coding. I even have long bash scripts. But I do agree that shell scripting is the right solution only if<p><pre><code>    = you can solve the problem quickly 
    = you don&#x27;t need data structures
    = you don&#x27;t need math 
    = you don&#x27;t need concurrency</code></pre></div><br/><div id="41536640" class="c"><input type="checkbox" id="c-41536640" checked=""/><div class="controls bullet"><span class="by">rbonvall</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41536552">parent</a><span>|</span><a href="#41537525">next</a><span>|</span><label class="collapse" for="c-41536640">[-]</label><label class="expand" for="c-41536640">[2 more]</label></div><br/><div class="children"><div class="content">In my opinion, shell scripting is the right tool when you need to do a lot of calling programs, piping, and redirecting. Such programs end up being cumbersome in &quot;proper&quot; languages.</div><br/><div id="41536828" class="c"><input type="checkbox" id="c-41536828" checked=""/><div class="controls bullet"><span class="by">skydhash</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41536640">parent</a><span>|</span><a href="#41537525">next</a><span>|</span><label class="collapse" for="c-41536828">[-]</label><label class="expand" for="c-41536828">[1 more]</label></div><br/><div class="children"><div class="content">If there are already software written to do the stuff and I&#x27;m just coordinating them (no other computation other than string manipulation) I&#x27;d take bash every day. I would only reach to python if I need to do stuff like manipulating complex data structures or something with heavy logic.</div><br/></div></div></div></div><div id="41537525" class="c"><input type="checkbox" id="c-41537525" checked=""/><div class="controls bullet"><span class="by">wuming2</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41536552">parent</a><span>|</span><a href="#41536640">prev</a><span>|</span><a href="#41536125">next</a><span>|</span><label class="collapse" for="c-41537525">[-]</label><label class="expand" for="c-41537525">[1 more]</label></div><br/><div class="children"><div class="content">~1k lines of bash with recutils for data persistency and dc for simple math. Was not quick to solve for me, custom invoices .fodt to .pdf to email, but I got it done. Shell is the only other scripting language I am familiar with other than Ruby. And I am worse at Ruby.<p>Sometimes options are limited to what you know already.</div><br/></div></div></div></div><div id="41536125" class="c"><input type="checkbox" id="c-41536125" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#41536112">parent</a><span>|</span><a href="#41536552">prev</a><span>|</span><a href="#41537214">next</a><span>|</span><label class="collapse" for="c-41536125">[-]</label><label class="expand" for="c-41536125">[2 more]</label></div><br/><div class="children"><div class="content">Some of us enjoy the masochism, thank you very much.</div><br/><div id="41536668" class="c"><input type="checkbox" id="c-41536668" checked=""/><div class="controls bullet"><span class="by">nativeit</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41536125">parent</a><span>|</span><a href="#41537214">next</a><span>|</span><label class="collapse" for="c-41536668">[-]</label><label class="expand" for="c-41536668">[1 more]</label></div><br/><div class="children"><div class="content">Hear, hear! Bash me datty.</div><br/></div></div></div></div><div id="41537214" class="c"><input type="checkbox" id="c-41537214" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#41536112">parent</a><span>|</span><a href="#41536125">prev</a><span>|</span><a href="#41536237">next</a><span>|</span><label class="collapse" for="c-41537214">[-]</label><label class="expand" for="c-41537214">[3 more]</label></div><br/><div class="children"><div class="content">Try running a 6 month old Python project that you haven&#x27;t run in that time and report back.<p>Meanwhile, 10 year old Bash scripts I&#x27;ve written still run unmodified.<p>Winner by a mile (from a software-longevity and low-maintenance perspective at least): Bash</div><br/><div id="41537749" class="c"><input type="checkbox" id="c-41537749" checked=""/><div class="controls bullet"><span class="by">bpshaver</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41537214">parent</a><span>|</span><a href="#41536237">next</a><span>|</span><label class="collapse" for="c-41537749">[-]</label><label class="expand" for="c-41537749">[2 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t compare a Python project to a Bash script an unfair comparison?<p>Compare a Python script to a Bash script. If your Python3 script (assuming no dependencies) doesn&#x27;t work after 6 months I got some questions for you.<p>(And I don&#x27;t really get how a 6 month old Python _project_ is likely to fail. I guess I&#x27;m just good at managing my dependencies?)</div><br/><div id="41537946" class="c"><input type="checkbox" id="c-41537946" checked=""/><div class="controls bullet"><span class="by">elashri</span><span>|</span><a href="#41536112">root</a><span>|</span><a href="#41537749">parent</a><span>|</span><a href="#41536237">next</a><span>|</span><label class="collapse" for="c-41537946">[-]</label><label class="expand" for="c-41537946">[1 more]</label></div><br/><div class="children"><div class="content">Unless you have pinned the exact version numbers in requirements.txt (which you should) or kept you conda&#x2F;venv..etc around it might be hard. I know at this stage this would be too much compared to what we are talking about regarding python scripts but non-python dependencies are real painful.<p>I know that this is probably beyond bash scripting vs python scripting but I was just replying to how 6 months project can have problems.<p>Also not a 6 months scale but the python standard library definitely changes and I would take bash anytime if I have to use venv for running util scripts.<p>Edit:  When python3.8 removed &#x27;time.clock()&#x27; it was annoying to change that. I know that it was deprecated since 3.3 (as I remember) but this is the example I have in mind now. But probably it was before I was born that people using<p>start=$(date +%s%N)<p>end=$(date +%s%N)<p>And I will be dead before&#x2F;if this becomes impossible to use.</div><br/></div></div></div></div></div></div><div id="41536237" class="c"><input type="checkbox" id="c-41536237" checked=""/><div class="controls bullet"><span class="by">httbs</span><span>|</span><a href="#41536112">parent</a><span>|</span><a href="#41537214">prev</a><span>|</span><a href="#41537794">next</a><span>|</span><label class="collapse" for="c-41536237">[-]</label><label class="expand" for="c-41536237">[1 more]</label></div><br/><div class="children"><div class="content">I draw the line at around 300 lines.</div><br/></div></div><div id="41537794" class="c"><input type="checkbox" id="c-41537794" checked=""/><div class="controls bullet"><span class="by">Hamuko</span><span>|</span><a href="#41536112">parent</a><span>|</span><a href="#41536237">prev</a><span>|</span><a href="#41535947">next</a><span>|</span><label class="collapse" for="c-41537794">[-]</label><label class="expand" for="c-41537794">[1 more]</label></div><br/><div class="children"><div class="content">I draw the line after a single if.</div><br/></div></div></div></div><div id="41535947" class="c"><input type="checkbox" id="c-41535947" checked=""/><div class="controls bullet"><span class="by">watmough</span><span>|</span><a href="#41536112">prev</a><span>|</span><a href="#41536027">next</a><span>|</span><label class="collapse" for="c-41535947">[-]</label><label class="expand" for="c-41535947">[1 more]</label></div><br/><div class="children"><div class="content">Good stuff.<p>One rule I like, is to ensure that, as well as validation, all validated information is dumped in a convenient format prior to running the rest of the script.<p>This is super helpful, assuming that some downstream process will need pathnames, or some other detail of the process just executed.</div><br/></div></div><div id="41536027" class="c"><input type="checkbox" id="c-41536027" checked=""/><div class="controls bullet"><span class="by">markus_zhang</span><span>|</span><a href="#41535947">prev</a><span>|</span><a href="#41512995">next</a><span>|</span><label class="collapse" for="c-41536027">[-]</label><label class="expand" for="c-41536027">[3 more]</label></div><br/><div class="children"><div class="content">I was so frustrated by having to enter a lot of information for every new git project (I use a new VM for each project) so I wrote a shell script that automates everything for me.<p>I&#x27;ll probably also combine a few git commands for every commit and push.</div><br/><div id="41536063" class="c"><input type="checkbox" id="c-41536063" checked=""/><div class="controls bullet"><span class="by">sureglymop</span><span>|</span><a href="#41536027">parent</a><span>|</span><a href="#41512995">next</a><span>|</span><label class="collapse" for="c-41536063">[-]</label><label class="expand" for="c-41536063">[2 more]</label></div><br/><div class="children"><div class="content">Sounds like a cool setup! Did you write it up somewhere publicly?<p>I also use VMs (qemu microvms) based on docker images for development.</div><br/><div id="41536154" class="c"><input type="checkbox" id="c-41536154" checked=""/><div class="controls bullet"><span class="by">markus_zhang</span><span>|</span><a href="#41536027">root</a><span>|</span><a href="#41536063">parent</a><span>|</span><a href="#41512995">next</a><span>|</span><label class="collapse" for="c-41536154">[-]</label><label class="expand" for="c-41536154">[1 more]</label></div><br/><div class="children"><div class="content">Sorry it&#x27;s on my other machine so I don&#x27;t have it at hand. But it&#x27;s an extremely simple setup that configs the email, the user, removes the need of --set-upstream when pushing, automate pushing with token.<p>I asked ChatGPT to write it and double checked btw.</div><br/></div></div></div></div></div></div><div id="41512995" class="c"><input type="checkbox" id="c-41512995" checked=""/><div class="controls bullet"><span class="by">mkmk</span><span>|</span><a href="#41536027">prev</a><span>|</span><a href="#41536854">next</a><span>|</span><label class="collapse" for="c-41512995">[-]</label><label class="expand" for="c-41512995">[3 more]</label></div><br/><div class="children"><div class="content">I don‚Äôt remember where I got it, but I have a simple implementation of a command-line spinner that I use keyboard shortcuts to add to most scripts. Has been a huge quality of life improvement but I wish I could just as seamlessly drop in a progress bar (of course, knowing how far along you are is more complex than knowing you‚Äôre still chugging along).</div><br/><div id="41535775" class="c"><input type="checkbox" id="c-41535775" checked=""/><div class="controls bullet"><span class="by">hipjiveguy</span><span>|</span><a href="#41512995">parent</a><span>|</span><a href="#41536854">next</a><span>|</span><label class="collapse" for="c-41535775">[-]</label><label class="expand" for="c-41535775">[2 more]</label></div><br/><div class="children"><div class="content">can you share it?</div><br/><div id="41535844" class="c"><input type="checkbox" id="c-41535844" checked=""/><div class="controls bullet"><span class="by">millzlane</span><span>|</span><a href="#41512995">root</a><span>|</span><a href="#41535775">parent</a><span>|</span><a href="#41536854">next</a><span>|</span><label class="collapse" for="c-41535844">[-]</label><label class="expand" for="c-41535844">[1 more]</label></div><br/><div class="children"><div class="content">Not OP but I have used this one with success.<p><a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;12498304&#x2F;using-bash-to-display-a-progress-indicator-spinner" rel="nofollow">https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;12498304&#x2F;using-bash-to-d...</a></div><br/></div></div></div></div></div></div><div id="41536854" class="c"><input type="checkbox" id="c-41536854" checked=""/><div class="controls bullet"><span class="by">TeeMassive</span><span>|</span><a href="#41512995">prev</a><span>|</span><a href="#41537368">next</a><span>|</span><label class="collapse" for="c-41536854">[-]</label><label class="expand" for="c-41536854">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;d add, in each my Bash scripts I add this line to get the script&#x27;s current directory:<p>SCRIPT_DIR=$( cd -- &quot;$( dirname -- &quot;${BASH_SOURCE[0]}&quot; )&quot; &amp;&gt; &#x2F;dev&#x2F;null &amp;&amp; pwd )<p>This is based on this SA&#x27;s answer: <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;59895&#x2F;how-do-i-get-the-directory-where-a-bash-script-is-located-from-within-the-script" rel="nofollow">https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;59895&#x2F;how-do-i-get-the-d...</a><p>I never got why Bash doesn&#x27;t have a reliable &quot;this file&#x27;s path&quot; feature and why people always take the current working directory for granted!</div><br/><div id="41538306" class="c"><input type="checkbox" id="c-41538306" checked=""/><div class="controls bullet"><span class="by">thangalin</span><span>|</span><a href="#41536854">parent</a><span>|</span><a href="#41537584">next</a><span>|</span><label class="collapse" for="c-41538306">[-]</label><label class="expand" for="c-41538306">[1 more]</label></div><br/><div class="children"><div class="content">I like:<p><pre><code>    readonly SCRIPT_SRC=&quot;$(dirname &quot;${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]}&quot;)&quot;
    readonly SCRIPT_DIR=&quot;$(cd &quot;${SCRIPT_SRC}&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;&amp; pwd)&quot;
    readonly SCRIPT_NAME=$(basename &quot;$0&quot;)</code></pre></div><br/></div></div><div id="41537584" class="c"><input type="checkbox" id="c-41537584" checked=""/><div class="controls bullet"><span class="by">Yasuraka</span><span>|</span><a href="#41536854">parent</a><span>|</span><a href="#41538306">prev</a><span>|</span><a href="#41537368">next</a><span>|</span><label class="collapse" for="c-41537584">[-]</label><label class="expand" for="c-41537584">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been using<p>script_dir=&quot;$(dirname &quot;$(realpath &quot;$0&quot;)&quot;)&quot;<p>Hasn&#x27;t failed me so far and it&#x27;s easy enough to remember</div><br/></div></div></div></div><div id="41537368" class="c"><input type="checkbox" id="c-41537368" checked=""/><div class="controls bullet"><span class="by">Myrmornis</span><span>|</span><a href="#41536854">prev</a><span>|</span><a href="#41537171">next</a><span>|</span><label class="collapse" for="c-41537368">[-]</label><label class="expand" for="c-41537368">[1 more]</label></div><br/><div class="children"><div class="content">In the first example, the error messages should be going to stderr.</div><br/></div></div><div id="41537171" class="c"><input type="checkbox" id="c-41537171" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#41537368">prev</a><span>|</span><a href="#41535782">next</a><span>|</span><label class="collapse" for="c-41537171">[-]</label><label class="expand" for="c-41537171">[1 more]</label></div><br/><div class="children"><div class="content">Regarding point 1, you should `exit 2` on bad usage, not 1, because it is widely considered that error code 2 is a USAGE error.</div><br/></div></div><div id="41535782" class="c"><input type="checkbox" id="c-41535782" checked=""/><div class="controls bullet"><span class="by">Rzor</span><span>|</span><a href="#41537171">prev</a><span>|</span><a href="#41537942">next</a><span>|</span><label class="collapse" for="c-41535782">[-]</label><label class="expand" for="c-41535782">[1 more]</label></div><br/><div class="children"><div class="content">Nicely done. I love everything about this.</div><br/></div></div><div id="41537942" class="c"><input type="checkbox" id="c-41537942" checked=""/><div class="controls bullet"><span class="by">gjvc</span><span>|</span><a href="#41535782">prev</a><span>|</span><a href="#41535809">next</a><span>|</span><label class="collapse" for="c-41537942">[-]</label><label class="expand" for="c-41537942">[1 more]</label></div><br/><div class="children"><div class="content">literally nothing here of interest</div><br/></div></div><div id="41535809" class="c"><input type="checkbox" id="c-41535809" checked=""/><div class="controls bullet"><span class="by">fragmede</span><span>|</span><a href="#41537942">prev</a><span>|</span><a href="#41537190">next</a><span>|</span><label class="collapse" for="c-41535809">[-]</label><label class="expand" for="c-41535809">[2 more]</label></div><br/><div class="children"><div class="content">Definitely don&#x27;t check that a variable is non-empty before running<p><pre><code>    rm -rf ${VAR}&#x2F;*
</code></pre>
That&#x27;s typically a great experience for shell scripts!</div><br/><div id="41535832" class="c"><input type="checkbox" id="c-41535832" checked=""/><div class="controls bullet"><span class="by">teroshan</span><span>|</span><a href="#41535809">parent</a><span>|</span><a href="#41537190">next</a><span>|</span><label class="collapse" for="c-41535832">[-]</label><label class="expand" for="c-41535832">[1 more]</label></div><br/><div class="children"><div class="content">It happens to the best of us<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ValveSoftware&#x2F;steam-for-linux&#x2F;issues&#x2F;3671">https:&#x2F;&#x2F;github.com&#x2F;ValveSoftware&#x2F;steam-for-linux&#x2F;issues&#x2F;3671</a></div><br/></div></div></div></div><div id="41537190" class="c"><input type="checkbox" id="c-41537190" checked=""/><div class="controls bullet"><span class="by">pmarreck</span><span>|</span><a href="#41535809">prev</a><span>|</span><a href="#41536235">next</a><span>|</span><label class="collapse" for="c-41537190">[-]</label><label class="expand" for="c-41537190">[4 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;charmbracelet&#x2F;glow">https:&#x2F;&#x2F;github.com&#x2F;charmbracelet&#x2F;glow</a> is pretty nice for stylized TUI output</div><br/><div id="41537219" class="c"><input type="checkbox" id="c-41537219" checked=""/><div class="controls bullet"><span class="by">bpshaver</span><span>|</span><a href="#41537190">parent</a><span>|</span><a href="#41536235">next</a><span>|</span><label class="collapse" for="c-41537219">[-]</label><label class="expand" for="c-41537219">[3 more]</label></div><br/><div class="children"><div class="content">Glow is awesome.</div><br/><div id="41537244" class="c"><input type="checkbox" id="c-41537244" checked=""/><div class="controls bullet"><span class="by">JoosToopit</span><span>|</span><a href="#41537190">root</a><span>|</span><a href="#41537219">parent</a><span>|</span><a href="#41536235">next</a><span>|</span><label class="collapse" for="c-41537244">[-]</label><label class="expand" for="c-41537244">[2 more]</label></div><br/><div class="children"><div class="content">No. Glow connects to internet servers, screw that.</div><br/><div id="41537736" class="c"><input type="checkbox" id="c-41537736" checked=""/><div class="controls bullet"><span class="by">bpshaver</span><span>|</span><a href="#41537190">root</a><span>|</span><a href="#41537244">parent</a><span>|</span><a href="#41536235">next</a><span>|</span><label class="collapse" for="c-41537736">[-]</label><label class="expand" for="c-41537736">[1 more]</label></div><br/><div class="children"><div class="content">Oops, I actually meant Gum, not Glow. Different project from the same folks.<p>That said, I use Glow to render markdown sometimes. When and how does it connect to internet servers?</div><br/></div></div></div></div></div></div></div></div><div id="41536235" class="c"><input type="checkbox" id="c-41536235" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#41537190">prev</a><span>|</span><a href="#41535934">next</a><span>|</span><label class="collapse" for="c-41536235">[-]</label><label class="expand" for="c-41536235">[1 more]</label></div><br/><div class="children"><div class="content">I liked the commenting style</div><br/></div></div><div id="41535934" class="c"><input type="checkbox" id="c-41535934" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41536235">prev</a><span>|</span><a href="#41536407">next</a><span>|</span><label class="collapse" for="c-41535934">[-]</label><label class="expand" for="c-41535934">[21 more]</label></div><br/><div class="children"><div class="content">Every time I see a ‚Äúgood‚Äù bash script it reminds me of how incredibly primitive every shell is other than PowerShell.<p>Validating parameters - a built in declarative feature! E.g.: ValidateNotNullOrEmpty.<p>Showing progress ‚Äî also built in, and <i>doesn‚Äôt</i> pollute the output stream so you can process returned text AND see progress at the same time. (Write-Progress)<p>Error handling ‚Äî Try { } Catch { } Finally { } works just like with proper programming languages.<p>Platform specific ‚Äî PowerShell doesn‚Äôt rely on a huge collection of non-standard CLI tools for essential functionality. It has built-in portable commands for sorting, filtering, format conversions, and many more. Works the same on Linux and Windows.<p>Etc‚Ä¶<p>PS: Another super power that bash users aren‚Äôt even aware they‚Äôre missing out on is that PowerShell can be embedded into a process as a library (not an external process!!) and used to build an entire GUI that just wraps the CLI commands. This works because the inputs and outputs are strongly typed objects so you can bind UI controls to them trivially. It can also define custom virtual file systems with arbitrary capabilities so you can bind tree navigation controls to your services or whatever. You can ‚Äúcd‚Äù into IIS, Exchange, and SQL and navigate them like they‚Äôre a drive. Try that with bash!</div><br/><div id="41536351" class="c"><input type="checkbox" id="c-41536351" checked=""/><div class="controls bullet"><span class="by">GuB-42</span><span>|</span><a href="#41535934">parent</a><span>|</span><a href="#41535992">next</a><span>|</span><label class="collapse" for="c-41536351">[-]</label><label class="expand" for="c-41536351">[1 more]</label></div><br/><div class="children"><div class="content">I also hate bash scripting, and as far as Unix shell go, bash is among the best. So many footguns... Dealing with filenames with spaces is a pain, and files that start with a &#x27;-&#x27;, &quot;rm -rf&quot; in a script is a disaster waiting to happen unless you triple check everything (empty strings, are you in the correct directory, etc...), globs that don&#x27;t match anything, etc...<p>But interactively, I much prefer Unix shells over PowerShell. When you don&#x27;t have edge cases and user input validation to deal with, these quirks become much more manageable. Maybe I am lacking experience, but I find PowerShell uncomfortable to use, and I don&#x27;t know if it has all these fancy interactive features many Unix shell have nowadays.<p>What you are saying essentially is that PowerShell is a better <i>programming language</i> than bash, quite a low bar actually. But then you have to compare it to real programming languages, like Perl or Python.<p>Perl has many shell-like features, the best regex support of any language, which is useful when everything is text, many powerful features, and an extensive ecosystem.<p>Python is less shell-like but is one of the most popular languages today, with a huge ecosystem, clean code, and pretty good two-way integration, which mean you can not only run Python from your executable, but Python can call it back.<p>If what you are for is portability and built-in commands, then the competition is Busybox, a ~1MB self-contained executable providing the most common Unix commands and a shell, very popular for embedded systems.</div><br/></div></div><div id="41535992" class="c"><input type="checkbox" id="c-41535992" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#41535934">parent</a><span>|</span><a href="#41536351">prev</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41535992">[-]</label><label class="expand" for="c-41535992">[9 more]</label></div><br/><div class="children"><div class="content">Bash also has a built-in to validate parameters; it‚Äôs called test, and is usually called with [], or [[]] for some bash-specifics.<p>Re: non-standard tools, if you‚Äôre referring to timeout, that‚Äôs part of GNU coreutils. It‚Äôs pretty standard for Linux. BSDs also have it from what I can tell, so it‚Äôs probably a Mac-ism. In any case, you could just pipe through sleep to achieve the same thing.<p>&gt; ‚Ä¶inputs and outputs are strongly typed objects<p>And herein is the difference. *nix-land has everything as a file. It‚Äôs the universal communication standard, and it‚Äôs extremely unlikely to change. I have zero desire to navigate a DB as though it were a mount point, and I‚Äôm unsure why you would ever want to. Surely SQL Server has a CLI tool like MySQL and Postgres.</div><br/><div id="41536018" class="c"><input type="checkbox" id="c-41536018" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41535992">parent</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41536018">[-]</label><label class="expand" for="c-41536018">[8 more]</label></div><br/><div class="children"><div class="content">The CLI tool <i>is</i> PowerShell.<p>You just said everything ‚Äúis a file‚Äù and then dismissed out of hand a system that takes that abstraction even further!<p>PowerShell is more UNIX than UNIX!</div><br/><div id="41536064" class="c"><input type="checkbox" id="c-41536064" checked=""/><div class="controls bullet"><span class="by">sgarland</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536018">parent</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41536064">[-]</label><label class="expand" for="c-41536064">[7 more]</label></div><br/><div class="children"><div class="content">What? How are typed objects files?<p>What I‚Äôm saying is that in *nix tooling, things are typically designed to do one thing well. So no, I don‚Äôt want my shell to also have to talk MySQL, Postgres, SQL Server, DB2, HTTP, FTP, SMTP‚Ä¶</div><br/><div id="41536648" class="c"><input type="checkbox" id="c-41536648" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536064">parent</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41536648">[-]</label><label class="expand" for="c-41536648">[6 more]</label></div><br/><div class="children"><div class="content">&gt; &quot;So no, I don‚Äôt want my shell to also have to talk...&quot;<p>What&#x27;s the point of the shell, if not to manage your databases, your REST APIs, files, and mail? Is it something you use for playing games on, or just for fun?<p>&gt; designed to do one thing well.<p>Eeexcept that this is not actually true in practice, because the abstraction was set at a level that&#x27;s <i>too low</i>. Shoving everything into a character (or byte) stream turned out to be a mistake. It means every &quot;one thing&quot; command is actually one thing plus a parser and and encoder. It means that &quot;ps&quot; has a built-in sort command, as do most other UNIX standard utilities, but they all do it differently. This also means that you just &quot;need to know&quot; how to convince each and every command to output machine-readable formats that other tools on the pipeline can pick up safely.<p>I&#x27;ll tell you a real troublshooting story, maybe that&#x27;ll help paint a picture:<p>I got called out to assist with an issue with a load balancer appliance used in front of a bunch of Linux servers. It was mostly working according to the customer, but their reporting tool was showing that it was sending traffic to the &quot;wrong&quot; services on each server.<p>The monitoring tool used &#x27;netstat&#x27; to track TCP connections, which had a bug in that version of RedHat where it would truncate the last <i>decimal digit</i> of the port number if the address:port combo had the maximum possible number of digits, e.g.: 123.123.123.123:54321 was shown as 123.123.123.123:5432 instead.<p>Their tool was just ingesting that <i>pretty printed</i> table intended for humans with &quot;aligned&quot; columns, throwing away the whitespace, and putting that into a database!<p>This gives me the <i>icks</i>, but apparently Just The Way Things Are Done in the UNIX world.<p>In PowerShell, Get-NetTCPConnection outputs <i>objects</i>, so this kind of error is basically impossible. Downstream tools aren&#x27;t <i>parsing</i> a text representation of a table or &quot;splitting it into columns&quot;, they receive the data <i>pre-parsed</i> with native types and everything.<p>So for example, this &quot;just works&quot;:<p><pre><code>    Get-NetTCPConnection | 
        Where-Object State -EQ &#x27;Bound&#x27; | 
        Group-Object LocalPort -NoElement | 
        Sort-Object Count -Descending -Top 10
</code></pre>
Please show me the equivalent using netstat. In case the above was not readable for you, it shows the top ten TCP ports by how many bound connections they have.<p>This kind of thing is a <i>challenge</i> with UNIX tools, and then is fragile forever. Any change to the output format of netstat breaks scripts in fun and create ways. Silently. In production.<p>I hope you never have to deal with IPv6.</div><br/><div id="41537752" class="c"><input type="checkbox" id="c-41537752" checked=""/><div class="controls bullet"><span class="by">tpmoney</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536648">parent</a><span>|</span><a href="#41537015">next</a><span>|</span><label class="collapse" for="c-41537752">[-]</label><label class="expand" for="c-41537752">[3 more]</label></div><br/><div class="children"><div class="content">For fun, I took a crack at your example and came up with this craziness (with the caveat it&#x27;s late and I didn&#x27;t spend much time on it), which is made a bit more awkward because grep doesn&#x27;t do capturing groups:<p><pre><code>  netstat -aln \
  | grep ESTABLISHED \
  | awk &#x27;{print $4}&#x27; \
  | grep -Po &#x27;\:\d+$&#x27; \
  | grep -Po &#x27;\d+&#x27; \
  | sort \
  | uniq -c \
  | sort -r \
  | head -n 10
</code></pre>
Changing the awk field to 5 instead of 4 should get you remote ports instead of local. But yeah, that will be fragile if netstat&#x27;s output ever changes. That said, even if you&#x27;re piping objects around, if the output of the thing putting out objects changes, your tool is always at risk of breaking. Yes objects breaking because field order changed is less likely, but what happens if `Get-NetTCPConnection` stops including a `State` field? I guess `Where-Object` might validate it found such a field, but I could also see it reasonably silently ignoring input that doesn&#x27;t have the field. Depends on whether it defaults to strict or lenient parsing behaviors.</div><br/><div id="41538275" class="c"><input type="checkbox" id="c-41538275" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41537752">parent</a><span>|</span><a href="#41537954">next</a><span>|</span><label class="collapse" for="c-41538275">[-]</label><label class="expand" for="c-41538275">[1 more]</label></div><br/><div class="children"><div class="content">I know this sounds like nit-picking but bear with me. It&#x27;s <i>the point</i> I&#x27;m trying to make:<p>1. Your script outputs an error when run, because &#x27;bash&#x27; itself doesn&#x27;t have netstat as a built-in. That&#x27;s an external command. In my WSL2, I had to install it. You can&#x27;t <i>declaratively</i> require this up-front, you script has to have an explicit check... or it&#x27;ll just fail half-way through. Or do nothing. Or who knows!?<p>PowerShell has up-front required prerequisites that you can declare: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;powershell&#x2F;module&#x2F;microsoft.powershell.core&#x2F;about&#x2F;about_requires?view=powershell-7.4" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;powershell&#x2F;module&#x2F;microsof...</a><p>Not that that&#x27;s needed, because Get-NetTcpConnection is a built-in command.<p>3. Speaking of which, the task was to get <i>tcp</i> connections, not <i>udp</i>, but I&#x27;ll let this one slide because it&#x27;s an easy fix.<p>4. Your script is very bravely trying to parse output that includes many different protocols, including: tcp, tcp6, udp, udp6, and unix domain sockets. I&#x27;m seeing random junk like &#x27;ACC&#x27; turn up after the first awk step.<p>5. Now imagine putting your script side-by-side with the PowerShell script, and giving it to people to <i>read</i>.<p>What are the chances that some random person could figure out what each one does?<p>Would they be able to modify the functionality successfully?<p>Note that you had to use &#x27;awk&#x27;, which is a parser, and then <i>three</i> uses of &#x27;grep&#x27; -- a regular expression language, which is also a kind of parsing.<p>The PowerShell version <i>has no parsing at all</i>. That&#x27;s why it&#x27;s just 4 pipeline expressions instead of 9 in your bash example.<p>Literally in every discussion about PowerShell there&#x27;s some Linux person who&#x27;s only ever used bash complaining that PS syntax is &quot;weird&quot; or &quot;hard to read&quot;. What are they talking about!? It&#x27;s <i>half</i> the complexity for the same functionality, reads like English, and doesn&#x27;t need write-only hieroglyphics for parameters.</div><br/></div></div><div id="41537954" class="c"><input type="checkbox" id="c-41537954" checked=""/><div class="controls bullet"><span class="by">gjvc</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41537752">parent</a><span>|</span><a href="#41538275">prev</a><span>|</span><a href="#41537015">next</a><span>|</span><label class="collapse" for="c-41537954">[-]</label><label class="expand" for="c-41537954">[1 more]</label></div><br/><div class="children"><div class="content">put the pipe character at the end of the line and you don&#x27;t need the backslashes</div><br/></div></div></div></div><div id="41537015" class="c"><input type="checkbox" id="c-41537015" checked=""/><div class="controls bullet"><span class="by">skydhash</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536648">parent</a><span>|</span><a href="#41537752">prev</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41537015">[-]</label><label class="expand" for="c-41537015">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <i>What&#x27;s the point of the shell, if not to manage your databases, your REST APIs, files, and mail? Is it something you use for playing games on, or just for fun?</i><p>It&#x27;s for communicating with the operating system, launching commands and viewing their output. And some scripting for repetitive workflows. If I&#x27;d want a full programming environment, I&#x27;d take a Lisp machine or Smalltalk (a programmable programming environment).<p>Any other systems that want to be interactive should have their own REPL.<p>&gt; <i>This kind of thing is a challenge with UNIX tools, and then is fragile forever. Any change to the output format of netstat breaks scripts in fun and create ways. Silently. In production.</i><p>The thing is if you&#x27;re using this kind of scripts in production, then not testing it after updating the system, that&#x27;s on you. In your story, they&#x27;d be better of writing a proper program. IMO, scripts are automating workflows (human guided), not for fire and forget process. Bash and the others deals in text because that&#x27;s all we can see and write. Objects are for programming languages.</div><br/><div id="41538241" class="c"><input type="checkbox" id="c-41538241" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41537015">parent</a><span>|</span><a href="#41536115">next</a><span>|</span><label class="collapse" for="c-41538241">[-]</label><label class="expand" for="c-41538241">[1 more]</label></div><br/><div class="children"><div class="content">&gt; In your story, they&#x27;d be better of writing a proper program.<p>Sure, on Linux, where your only common options bash or &quot;software&quot;.<p>On Windows, with PowerShell, I can <i>don&#x27;t have to write a software program</i>. I can write a script that reads like a hypothetical C# Shell would, but oriented towards interactive shells.<p>(Note that there <i>is</i> a CS-Script, but it&#x27;s a different thing intended for different use-cases.)</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="41536115" class="c"><input type="checkbox" id="c-41536115" checked=""/><div class="controls bullet"><span class="by">tomcam</span><span>|</span><a href="#41535934">parent</a><span>|</span><a href="#41535992">prev</a><span>|</span><a href="#41535954">next</a><span>|</span><label class="collapse" for="c-41536115">[-]</label><label class="expand" for="c-41536115">[2 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>   PowerShell can be embedded into a process as a library... and used to build an entire GUI that just wraps the CLI commands.
</code></pre>
Sounds pretty interesting. Can you tell me what search terms I&#x27;d use to learn more about the GUI controls? Are they portable to Linux?</div><br/><div id="41536194" class="c"><input type="checkbox" id="c-41536194" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536115">parent</a><span>|</span><a href="#41535954">next</a><span>|</span><label class="collapse" for="c-41536194">[-]</label><label class="expand" for="c-41536194">[1 more]</label></div><br/><div class="children"><div class="content">It doesn‚Äôt have GUI capabilities per-se. Instead, it is designed to be easy to use as the foundation of an admin GUI.<p>The .NET library for this is System.Management.Automation.<p>You can call a PowerShell pipeline with one line of code: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;dotnet&#x2F;api&#x2F;system.management.automation.powershell?view=powershellsdk-7.4.0" rel="nofollow">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;dotnet&#x2F;api&#x2F;system.manageme...</a><p>Unlike invoking bash (or whatever) as a process, this is much lighter weight and returns a sequence of objects with properties. You can trivially bind those to UI controls such as data tables.<p>Similarly the virtual file system providers expose metadata programmatically such as ‚Äúavailable operations‚Äù, all of which adhere to uniform interfaces. You can write a generic UI once for copy, paste, expand folder, etc and turn them on or off as needed to show only what‚Äôs available at each hierarchy level.<p>As an example, the Citrix management consoles all work like this. Anything you can do in the GUI you can do in the CLI <i>by definition</i> because the GUI is just some widgets driving the same CLI code.</div><br/></div></div></div></div><div id="41535954" class="c"><input type="checkbox" id="c-41535954" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#41535934">parent</a><span>|</span><a href="#41536115">prev</a><span>|</span><a href="#41537697">next</a><span>|</span><label class="collapse" for="c-41535954">[-]</label><label class="expand" for="c-41535954">[7 more]</label></div><br/><div class="children"><div class="content">I am Microsoft hater. I cannot stand Windows and only use Linux.<p>PowerShell blows bash out of the water. I love it.</div><br/><div id="41536241" class="c"><input type="checkbox" id="c-41536241" checked=""/><div class="controls bullet"><span class="by">sweeter</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41535954">parent</a><span>|</span><a href="#41536990">next</a><span>|</span><label class="collapse" for="c-41536241">[-]</label><label class="expand" for="c-41536241">[5 more]</label></div><br/><div class="children"><div class="content">except for the fact that it is slower than hell and the syntax is nuts. I don&#x27;t really understand the comparison, bash is basically just command glue for composing pipelines and pwsh is definitely more of a full-fledged language... but to me, I use bash because its quick and dirty and it fits well with the Unix system.<p>If I wanted the features that pwsh brings I would much rather just pick a language like Golang or Python where the experience is better and those things will work on any system imaginable. Whereas pwsh is really good on windows for specifically administrative tasks.</div><br/><div id="41536262" class="c"><input type="checkbox" id="c-41536262" checked=""/><div class="controls bullet"><span class="by">hollerith</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536241">parent</a><span>|</span><a href="#41536990">next</a><span>|</span><label class="collapse" for="c-41536262">[-]</label><label class="expand" for="c-41536262">[4 more]</label></div><br/><div class="children"><div class="content">The fact that it is &quot;basically just command glue for composing pipelines&quot; makes it even more regrettable that it takes more knowledge and mental focus to avoid shooting my foot off in bash than it does in any other programming language I use.</div><br/><div id="41537066" class="c"><input type="checkbox" id="c-41537066" checked=""/><div class="controls bullet"><span class="by">skydhash</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41536262">parent</a><span>|</span><a href="#41536990">next</a><span>|</span><label class="collapse" for="c-41537066">[-]</label><label class="expand" for="c-41537066">[3 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re trying to write a full fledged program in it, it&#x27;s going to be a pain as there are only strings (and arrays, I think). Bash is for scripting. If you have complex logic to be done, use another programming language like perl, ruby, python, $YOUR_PREFERRED_ONE,...</div><br/><div id="41537200" class="c"><input type="checkbox" id="c-41537200" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41537066">parent</a><span>|</span><a href="#41536990">next</a><span>|</span><label class="collapse" for="c-41537200">[-]</label><label class="expand" for="c-41537200">[2 more]</label></div><br/><div class="children"><div class="content">You‚Äôre arguing that the power of PowerShell is pointless because you‚Äôve resorted to alternatives to bash‚Ä¶ because it‚Äôs not good enough for common scenarios.<p>This is Stockholm Syndrome.<p>You‚Äôve internalised your limitations and have grown to like them.</div><br/><div id="41538173" class="c"><input type="checkbox" id="c-41538173" checked=""/><div class="controls bullet"><span class="by">skydhash</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41537200">parent</a><span>|</span><a href="#41536990">next</a><span>|</span><label class="collapse" for="c-41538173">[-]</label><label class="expand" for="c-41538173">[1 more]</label></div><br/><div class="children"><div class="content">No. bash as a shell is for interactive use or for automating said interactions. I want the computer to do stuff. The ‚Äúeverything is a file‚Äù and text oriented perspective in the unix world is just one model and bash is very suitable for it. Powershell is another model, just like lisp and smalltalk. I‚Äôm aware of the limitations of bash, but at the end of the day, it gets the job done and easily at that.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="41536990" class="c"><input type="checkbox" id="c-41536990" checked=""/><div class="controls bullet"><span class="by">vondur</span><span>|</span><a href="#41535934">root</a><span>|</span><a href="#41535954">parent</a><span>|</span><a href="#41536241">prev</a><span>|</span><a href="#41537697">next</a><span>|</span><label class="collapse" for="c-41536990">[-]</label><label class="expand" for="c-41536990">[1 more]</label></div><br/><div class="children"><div class="content">I‚Äôm curious. How useful is Powershell outside of a windows environment? I use it on Windows since much of the admin side of things requires it.</div><br/></div></div></div></div><div id="41537697" class="c"><input type="checkbox" id="c-41537697" checked=""/><div class="controls bullet"><span class="by">mixmastamyk</span><span>|</span><a href="#41535934">parent</a><span>|</span><a href="#41535954">prev</a><span>|</span><a href="#41536407">next</a><span>|</span><label class="collapse" for="c-41537697">[-]</label><label class="expand" for="c-41537697">[1 more]</label></div><br/><div class="children"><div class="content">Bash is crap and powershell an abomination with a few good ideas.<p>fish, Python, and oilshell (ysh) are ultimately on better footing.</div><br/></div></div></div></div></div></div></div></div></div></body></html>