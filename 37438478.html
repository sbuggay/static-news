<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1694250058644" as="style"/><link rel="stylesheet" href="styles.css?v=1694250058644"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://today.ucsd.edu/story/forwarding_based_spoofing">Scammers can exploit email forwarding flaws to impersonate high-profile domains</a> <span class="domain">(<a href="https://today.ucsd.edu">today.ucsd.edu</a>)</span></div><div class="subtext"><span>sizzle</span> | <span>47 comments</span></div><br/><div><div id="37440295" class="c"><input type="checkbox" id="c-37440295" checked=""/><div class="controls bullet"><span class="by">tric</span><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37440295">[-]</label><label class="expand" for="c-37440295">[9 more]</label></div><br/><div class="children"><div class="content">The diagram demonstrating the attack shows DMARC fails. All they have shown is that everyone should have DMARC configured properly, and use a reject or quarantine policy. This has been best practice for a long time now.<p>They use the example of state.gov. That domain&#x27;s policy is currently set to Reject, which is what all Federal government services have been using for years now.<p>Here&#x27;s CISA&#x27;s requirements:
<a href="https:&#x2F;&#x2F;www.cisa.gov&#x2F;news-events&#x2F;directives&#x2F;bod-18-01-enhance-email-and-web-security" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.cisa.gov&#x2F;news-events&#x2F;directives&#x2F;bod-18-01-enhanc...</a><p>Microsoft also uses their own auth mechanism in addition to DMARC. It&#x27;s called composite authentication. In my experience, comp-auth is more strict than DMARC alone.<p><a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;microsoft-365&#x2F;security&#x2F;office-365-security&#x2F;email-authentication-about?view=o365-worldwide#composite-authentication" rel="nofollow noreferrer">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;microsoft-365&#x2F;security&#x2F;off...</a><p>What am I missing? Why is this noteworthy?<p>EDIT:<p>After reading more of the paper, my conclusion is mentioned in a later reply:<p>&quot;They are demonstrating a problem with managed providers, and their opinionated configuration. You give up a lot of control as an admin when you use 365 as your front-end. This further proves that. &quot;</div><br/><div id="37440581" class="c"><input type="checkbox" id="c-37440581" checked=""/><div class="controls bullet"><span class="by">csharpminor</span><span>|</span><a href="#37440295">parent</a><span>|</span><a href="#37440743">next</a><span>|</span><label class="collapse" for="c-37440581">[-]</label><label class="expand" for="c-37440581">[3 more]</label></div><br/><div class="children"><div class="content">I completely agree. As an aside, for .gov domains, the DMARC offenders are primarily at the state, county, and local level. I would personally be in favor of extending CISA’s DMARC requirements to anyone with a .gov domain (and revoking domains that are non-compliant).<p>Another misconception among many CIO&#x2F;CISOs is that securing your individual subdomain with DMARC is enough. For example, dmv.ca.gov might have DMARC on its subdomain but not on the root, allowing a scammer to make up their own subdomain like “vehicles.ca.gov” and scam people into paying for fake vehicle registration. Of course there are other mechanisms inbox providers use to protect recipients, but without a DMARC policy on the root domain the door is left open.<p>This is especially prevalent at the state level where no one wants to own DMARC centrally.</div><br/><div id="37440699" class="c"><input type="checkbox" id="c-37440699" checked=""/><div class="controls bullet"><span class="by">tric</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37440581">parent</a><span>|</span><a href="#37440743">next</a><span>|</span><label class="collapse" for="c-37440699">[-]</label><label class="expand" for="c-37440699">[2 more]</label></div><br/><div class="children"><div class="content">&gt; the DMARC offenders are primarily at the state, county, and local level.<p>This has been my experience as well. Likely due to their systems being managed by lowest-bidder MSPs.<p>Someone once shared their own analysis of each state&#x27;s configuration a few years ago:<p><a href="https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;sysadmin&#x2F;comments&#x2F;cawch1&#x2F;united_states_dmarc_status_script&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;sysadmin&#x2F;comments&#x2F;cawch1&#x2F;united_sta...</a><p>I wonder how it looks today.</div><br/><div id="37440853" class="c"><input type="checkbox" id="c-37440853" checked=""/><div class="controls bullet"><span class="by">hhh</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37440699">parent</a><span>|</span><a href="#37440743">next</a><span>|</span><label class="collapse" for="c-37440853">[-]</label><label class="expand" for="c-37440853">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;nicewrld&#x2F;5aed533257f7469d6439f6a4646fdc3c" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;nicewrld&#x2F;5aed533257f7469d6439f6a4646...</a><p>output from the script as of today.</div><br/></div></div></div></div></div></div><div id="37440743" class="c"><input type="checkbox" id="c-37440743" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37440295">parent</a><span>|</span><a href="#37440581">prev</a><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37440743">[-]</label><label class="expand" for="c-37440743">[5 more]</label></div><br/><div class="children"><div class="content">This works against domains that have DMARC configured properly. First attack works against any domain that is using O365, regardless of their DMARC settings.</div><br/><div id="37440828" class="c"><input type="checkbox" id="c-37440828" checked=""/><div class="controls bullet"><span class="by">tric</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37440743">parent</a><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37440828">[-]</label><label class="expand" for="c-37440828">[4 more]</label></div><br/><div class="children"><div class="content">Your domain may have a policy of reject or quarantine, but does the receiving host correctly act on that policy?<p>I can understand if free email providers are more permissive with narrow authentication scenarios. Users aren&#x27;t usually able to contact support.<p>As someone suggested in this thread, this is a UX problem.<p>Policies need to appease a large number of users. A gov&#x2F;corp org receiving these messages can be more strict. Even in these orgs, people complain about not receiving an email that was appropriately rejected.</div><br/><div id="37440914" class="c"><input type="checkbox" id="c-37440914" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37440828">parent</a><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37440914">[-]</label><label class="expand" for="c-37440914">[3 more]</label></div><br/><div class="children"><div class="content">The attack works for spoofing email from domains that have DMARC configured with reject policy against receiving servers that validate DMARC and act correctly according to policy. Only requirement is that the domain the attacker is spoofing is using O365.<p>This is not a UX problem. This is a Microsoft problem.</div><br/><div id="37441051" class="c"><input type="checkbox" id="c-37441051" checked=""/><div class="controls bullet"><span class="by">tric</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37440914">parent</a><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37441051">[-]</label><label class="expand" for="c-37441051">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Only requirement is that the domain the attacker is spoofing is using O365.<p>This is not true. The paper mentions multiple service providers using more relaxed validation.<p>Table 3, section 5 in the paper shows which policies need to be in place on the domain they are piggy-backing on.<p>They reference Postfix:<p>&quot;Additionally, we note that mailing list software such as Listserv and Mailman require a backend MTA. In our experiments we used Postfix with DMARC turned on, a configuration which follows good security practice. However, in practice many organizations might not use this configuration because many MTAs (including Postfix) do not enforce DMARC by default. In these cases, the attacker can spoof email from any target domain, regard-
less of its DMARC policy, much like the attack against Gaggle.&quot;<p>I read this to mean that if you actually enable DMARC in Postfix, piggy-backing on another domain&#x27;s policies results in rejection.<p>No mention of results for receiving at ProofPoint, Mimecast, Trellix, or Cisco&#x27;s email appliance.<p>&gt; This is not a UX problem.<p>They are demonstrating a problem with managed providers, and their opinionated configuration. You give up a lot of control as an admin when you use 365 as your front-end. This further proves that.</div><br/><div id="37441102" class="c"><input type="checkbox" id="c-37441102" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37440295">root</a><span>|</span><a href="#37441051">parent</a><span>|</span><a href="#37439148">next</a><span>|</span><label class="collapse" for="c-37441102">[-]</label><label class="expand" for="c-37441102">[1 more]</label></div><br/><div class="children"><div class="content">Yes, they mention that Fastmail, GMX, Inbox.lv, and Pobox also allow per-user DMARC overrides, including overriding reject policy. But Microsoft is the only one of these using MFEF forwarding which enables the attack to be successful.<p>I suppose similar attack to the one in 5.1 would work against Fastmail, but the victim would be able to see the original envelope from to detect that the mail is spoofed.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="37439148" class="c"><input type="checkbox" id="c-37439148" checked=""/><div class="controls bullet"><span class="by">noman-land</span><span>|</span><a href="#37440295">prev</a><span>|</span><a href="#37439477">next</a><span>|</span><label class="collapse" for="c-37439148">[-]</label><label class="expand" for="c-37439148">[13 more]</label></div><br/><div class="children"><div class="content">&quot;The original protocol used to check the authenticity of an email implicitly assumes that each organization operates its own mailing infrastructure, with specific IP addresses not used by other domains. But today, many organizations outsource their email infrastructure to Gmail and Outlook. As a result, thousands of domains have delegated the right to send email on their behalf to the same third party.&quot;<p>&quot;For example, state.gov, the email domain for the Department of State, allows Outlook to send emails on their behalf. This means emails claiming to be from state.gov would be considered legitimate if they came from Outlook’s email servers. As a result, an attacker can create a spoofed email–an email with a fake identity–pretending, for example, to come from the Department of State--and then forward it through their personal Outlook account. Once they do this, the spoofed email will now be treated as legitimate by the recipient, as it is coming from an Outlook email server.&quot;</div><br/><div id="37439727" class="c"><input type="checkbox" id="c-37439727" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#37439148">parent</a><span>|</span><a href="#37439376">next</a><span>|</span><label class="collapse" for="c-37439727">[-]</label><label class="expand" for="c-37439727">[6 more]</label></div><br/><div class="children"><div class="content">But if they <i>forward</i> the email, then it&#x27;ll look like it&#x27;s coming from their own personal account.<p>These multi-tenant mail sender orgs generally prohibit sending from domains that haven&#x27;t been &quot;verified&quot;. All of Microsoft 365 and Azure works this way. They don&#x27;t let their customers spoof each other on shared infrastructure, you have to create TXT records in DNS zones to verify ownership.</div><br/><div id="37440190" class="c"><input type="checkbox" id="c-37440190" checked=""/><div class="controls bullet"><span class="by">belorn</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439727">parent</a><span>|</span><a href="#37441561">next</a><span>|</span><label class="collapse" for="c-37440190">[-]</label><label class="expand" for="c-37440190">[2 more]</label></div><br/><div class="children"><div class="content">The bug being described is that Microsoft will run spam checkers when receiving emails for Microsoft customers, and they will check domain ownership when sending outgoing emails, but they won&#x27;t run spam checkers or check ownership when email are received to an address which is used for email forwarding.<p>In addition, other major email services such like Gmail will not run spam checkers against Microsoft since they assume that Microsoft has done their due diligence when sending emails.</div><br/><div id="37440703" class="c"><input type="checkbox" id="c-37440703" checked=""/><div class="controls bullet"><span class="by">MichaelZuo</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37440190">parent</a><span>|</span><a href="#37441561">next</a><span>|</span><label class="collapse" for="c-37440703">[-]</label><label class="expand" for="c-37440703">[1 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t seem correct, if Microsoft truly does not do so in this scenario then it&#x27;s impossible for it not to have been known by many many thousands of people well before 2023.</div><br/></div></div></div></div><div id="37441561" class="c"><input type="checkbox" id="c-37441561" checked=""/><div class="controls bullet"><span class="by">None4U</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439727">parent</a><span>|</span><a href="#37440190">prev</a><span>|</span><a href="#37440073">next</a><span>|</span><label class="collapse" for="c-37441561">[-]</label><label class="expand" for="c-37441561">[1 more]</label></div><br/><div class="children"><div class="content">Just to be clear for any future readers, they don&#x27;t mean forwarding the email as in the forward button (which quotes or attaches it), they mean setting up mail forwarding on the entire inbox</div><br/></div></div><div id="37440073" class="c"><input type="checkbox" id="c-37440073" checked=""/><div class="controls bullet"><span class="by">deathhand</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439727">parent</a><span>|</span><a href="#37441561">prev</a><span>|</span><a href="#37439376">next</a><span>|</span><label class="collapse" for="c-37440073">[-]</label><label class="expand" for="c-37440073">[2 more]</label></div><br/><div class="children"><div class="content">Each Office 365 tenant does not have a personal Exhange server. The sending smtp server is being shared and can be verified with the email headers. That is how this flaw works.<p>I feel like an idiot because I see the same behavior with the variable &#x27;not in my organization&#x27; with transport rules and how many false positives I&#x27;ve had. I can clearly see the usage of different exchange servers being used in my environment when my company acquires a bunch of users. It falsely flags them because they are using a different shared exchange resource.</div><br/><div id="37440732" class="c"><input type="checkbox" id="c-37440732" checked=""/><div class="controls bullet"><span class="by">jiggawatts</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37440073">parent</a><span>|</span><a href="#37439376">next</a><span>|</span><label class="collapse" for="c-37440732">[-]</label><label class="expand" for="c-37440732">[1 more]</label></div><br/><div class="children"><div class="content">You can&#x27;t use Office 365 to send email that appears to be from a different org. It is an authenticated mail relay, and it&#x27;ll just reject your email.<p>You have to <i>verify</i> that you own the domains that you use in the from address to send mail via their service.</div><br/></div></div></div></div></div></div><div id="37439376" class="c"><input type="checkbox" id="c-37439376" checked=""/><div class="controls bullet"><span class="by">upofadown</span><span>|</span><a href="#37439148">parent</a><span>|</span><a href="#37439727">prev</a><span>|</span><a href="#37439477">next</a><span>|</span><label class="collapse" for="c-37439376">[-]</label><label class="expand" for="c-37439376">[6 more]</label></div><br/><div class="children"><div class="content">&gt;This means emails claiming to be from state.gov would be considered legitimate if they came from Outlook’s email servers.<p>Well they are legitimate. SPF and DKIM are not intended to be used as some sort of authentication of the sender. In this case the server authorized to send mail  for that domain is actually sending the mail. I don&#x27;t see the problem here.</div><br/><div id="37439647" class="c"><input type="checkbox" id="c-37439647" checked=""/><div class="controls bullet"><span class="by">function_seven</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439376">parent</a><span>|</span><a href="#37439418">prev</a><span>|</span><a href="#37439477">next</a><span>|</span><label class="collapse" for="c-37439647">[-]</label><label class="expand" for="c-37439647">[4 more]</label></div><br/><div class="children"><div class="content">The very next sentence in parent comment details the problem.</div><br/><div id="37439884" class="c"><input type="checkbox" id="c-37439884" checked=""/><div class="controls bullet"><span class="by">upofadown</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439647">parent</a><span>|</span><a href="#37439477">next</a><span>|</span><label class="collapse" for="c-37439884">[-]</label><label class="expand" for="c-37439884">[3 more]</label></div><br/><div class="children"><div class="content">The next sentence:<p>&gt;As a result, an attacker can create a spoofed email–an email with a fake identity–pretending, for example, to come from the Department of State--and then forward it through their personal Outlook account.<p>That contains the incorrect assumption, that DKIM&#x2F;SPF is intended and can be used as sender verification. Yes, <i>if</i> the DMARC policy can be and is set to &quot;reject&quot;, <i>if</i> the receiving email server actually pays any attention to the DMARC policy, <i>and</i> the server only sends mail for one domain then you will make things harder for those spoofing emails. But DKIM&#x2F;SPF has only ever been about server reputation. Retconing it without some sort of broad consensus is only going to lead to trouble down the way.</div><br/><div id="37440629" class="c"><input type="checkbox" id="c-37440629" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439884">parent</a><span>|</span><a href="#37440510">next</a><span>|</span><label class="collapse" for="c-37440629">[-]</label><label class="expand" for="c-37440629">[1 more]</label></div><br/><div class="children"><div class="content">The problem here is that Department of State has set their DMARC policy correctly to reject and the victim is using a server that correctly checks the policy, so sender spoofing should not be possible.<p>However, the Outlook server in between launders the email by 1) not honoring the DMARC policy and 2) rewriting the email headers to originate from Department of State.<p>As DMARC requires that either SPF or DKIM alignment passes, the laundered email will pass the DMARC check on the victim&#x27;s side who expects to be protected from this kind of spoofing.<p>Really the solution here should be an extension to DMARC where you can set a policy that BOTH SPF and DKIM checks need to pass and be aligned in order for the email to be delivered, rather than just one.</div><br/></div></div><div id="37440510" class="c"><input type="checkbox" id="c-37440510" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#37439148">root</a><span>|</span><a href="#37439884">parent</a><span>|</span><a href="#37440629">prev</a><span>|</span><a href="#37439477">next</a><span>|</span><label class="collapse" for="c-37440510">[-]</label><label class="expand" for="c-37440510">[1 more]</label></div><br/><div class="children"><div class="content">So, the problem is that DKIM&#x2F;SPF doesn’t check end-to-end invariants, and instead checks a property that few end-users understand, and that zero end-users care about.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37439477" class="c"><input type="checkbox" id="c-37439477" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#37439148">prev</a><span>|</span><a href="#37442606">next</a><span>|</span><label class="collapse" for="c-37439477">[-]</label><label class="expand" for="c-37439477">[5 more]</label></div><br/><div class="children"><div class="content">Some security problems are in fact UX problems. Many of the fine points of this paper boil down to the fact that MUAs do not necessarily bring it to the user&#x27;s prompt attention when messages are not DKIM authenticated. Some of these UI choices are, based on my personal experience, consequences of the fact that many large customers want features from email providers that are impossible to reconcile with strong authentication (i.e. they want to loop all their mail through some fourth-party system that is a piece of crap).<p>If you suspect you might have received an email from Anthony Blinken, I suggest checking the DKIM signature.</div><br/><div id="37439596" class="c"><input type="checkbox" id="c-37439596" checked=""/><div class="controls bullet"><span class="by">ale42</span><span>|</span><a href="#37439477">parent</a><span>|</span><a href="#37442606">next</a><span>|</span><label class="collapse" for="c-37439596">[-]</label><label class="expand" for="c-37439596">[4 more]</label></div><br/><div class="children"><div class="content">&gt; If you suspect you might have received an email from Anthony Blinken, I suggest checking the DKIM signature.<p>Definitely. But I think that the actual attack would rather be that you receive an e-mail (seemingly) from your bank asking to log in on some (phishing) portal, or from your ISP or whatever else urging to to install a (malware) software update...</div><br/><div id="37440015" class="c"><input type="checkbox" id="c-37440015" checked=""/><div class="controls bullet"><span class="by">pdonis</span><span>|</span><a href="#37439477">root</a><span>|</span><a href="#37439596">parent</a><span>|</span><a href="#37442606">next</a><span>|</span><label class="collapse" for="c-37440015">[-]</label><label class="expand" for="c-37440015">[3 more]</label></div><br/><div class="children"><div class="content">More good reasons to not click on links in emails. Use out of band methods instead (for example, if you think an email is from your bank, log on to their website separately, not through an email link, and check that way).</div><br/><div id="37440396" class="c"><input type="checkbox" id="c-37440396" checked=""/><div class="controls bullet"><span class="by">sizzle</span><span>|</span><a href="#37439477">root</a><span>|</span><a href="#37440015">parent</a><span>|</span><a href="#37442606">next</a><span>|</span><label class="collapse" for="c-37440396">[-]</label><label class="expand" for="c-37440396">[2 more]</label></div><br/><div class="children"><div class="content">For us working in tech- yes we can be vigilant, but for less tech savvy folks in large companies or government, good luck!</div><br/><div id="37443341" class="c"><input type="checkbox" id="c-37443341" checked=""/><div class="controls bullet"><span class="by">heywoods</span><span>|</span><a href="#37439477">root</a><span>|</span><a href="#37440396">parent</a><span>|</span><a href="#37442606">next</a><span>|</span><label class="collapse" for="c-37443341">[-]</label><label class="expand" for="c-37443341">[1 more]</label></div><br/><div class="children"><div class="content">I know everyone at my last company had to do compliance training with Kevin Mitnick for hours; not that I minded RIP. Fingers crossed my large company isn’t the outlier and people pay attention to the training. Still, this vulnerability is bad news. A well targeted attack that doesn’t trip any training red flags (links, attachments, etc.) for the victim is still a very real security threat, right?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37442606" class="c"><input type="checkbox" id="c-37442606" checked=""/><div class="controls bullet"><span class="by">kgeist</span><span>|</span><a href="#37439477">prev</a><span>|</span><a href="#37439227">next</a><span>|</span><label class="collapse" for="c-37442606">[-]</label><label class="expand" for="c-37442606">[2 more]</label></div><br/><div class="children"><div class="content">Reminded me of a story which happened earlier this year. Our organization has a bunch of servers in the local network which need to send emails. The admins decided that a firewall based on IP filtering is enough and didn&#x27;t enable any other form of authentication for the email server. I accidentally found out that if I try to send an email directly via SMTP using a Python script, the email server misidentified me as a server (because we&#x27;re both in the local network). The first thing I did as an experiment was to impersonate our CEO and send an email on his behalf with a fishing link to our chief security officer and other top managers. The link led to my own server hosted on OVH which tracked who opened the link. Basically, only one guy hesitated to open it, everyone else clicked on it (including CSO). DKIM&#x2F;DMARC for the email were shown as valid in Outlook. If our organization, which is the largest IT company in the region, with a whole department of system admins, cound&#x27;t set it up correctly, I&#x27;m afraid to think what happens in smaller companies.</div><br/><div id="37443204" class="c"><input type="checkbox" id="c-37443204" checked=""/><div class="controls bullet"><span class="by">LeonM</span><span>|</span><a href="#37442606">parent</a><span>|</span><a href="#37439227">next</a><span>|</span><label class="collapse" for="c-37443204">[-]</label><label class="expand" for="c-37443204">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If our organization, which is the largest IT company in the region, with a whole department of system admins, cound&#x27;t set it up correctly, I&#x27;m afraid to think what happens in smaller companies.<p>I advice organizations on email infrastructure configuration for a living, and I can tell you from experience that many organizations, and even MSPs, get it wrong. However, the problem is often not technical, but cultural. Many system admins have a hard time accepting, or convincing their boss, that they need external consultancy for something as seemingly simple as email. It also doesn&#x27;t help that for most MSPs, email is a loss-leader, their clients expect it to cost no more than a few bucks a month.<p>In most organizations I have consulted, email is treated as a simple set and forget service. Admins are expected to whip up an SMTP service in an hour and move on to other tasks. Whereas the reality is that email has become a minefield of subtle configuration mistakes, and requires continuous monitoring.</div><br/></div></div></div></div><div id="37439227" class="c"><input type="checkbox" id="c-37439227" checked=""/><div class="controls bullet"><span class="by">rediguanayum</span><span>|</span><a href="#37442606">prev</a><span>|</span><a href="#37440174">next</a><span>|</span><label class="collapse" for="c-37439227">[-]</label><label class="expand" for="c-37439227">[1 more]</label></div><br/><div class="children"><div class="content">Paper in question: <a href="https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2302.07287.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2302.07287.pdf</a>.  Apparently won the Euro  Privacy and Privacy best paper.  It publishes and draw attention to what in industry has been &quot;known&quot; lore about SPF and ARC vulnerabilities.  Kudos to the authors.</div><br/></div></div><div id="37440174" class="c"><input type="checkbox" id="c-37440174" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37439227">prev</a><span>|</span><a href="#37439406">next</a><span>|</span><label class="collapse" for="c-37440174">[-]</label><label class="expand" for="c-37440174">[5 more]</label></div><br/><div class="children"><div class="content">Hold on, am I reading the paper correctly? In the 5.1 attack, if you use &quot;Add to contacts&quot; in Outlook, this will bypass DMARC protection completely? So by adding someone to contacts you are essentially allowing their email to be spoofed?<p>What the hell Microsoft?</div><br/><div id="37440335" class="c"><input type="checkbox" id="c-37440335" checked=""/><div class="controls bullet"><span class="by">jabroni_salad</span><span>|</span><a href="#37440174">parent</a><span>|</span><a href="#37440479">next</a><span>|</span><label class="collapse" for="c-37440335">[-]</label><label class="expand" for="c-37440335">[3 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;support.microsoft.com&#x2F;en-us&#x2F;office&#x2F;add-recipients-of-my-email-messages-to-the-safe-senders-list-be1baea0-beab-4a30-b968-9004332336ce" rel="nofollow noreferrer">https:&#x2F;&#x2F;support.microsoft.com&#x2F;en-us&#x2F;office&#x2F;add-recipients-of...</a><p>Yes. Although I will say that ATP runs before safesenders or any other rule applies, and it&#x27;s been hair trigger lately.<p>Sadly this is the only way to do business sometimes. Every org has to deal with a couple other organizations that absolutely refuse to get their auth game together. Users just want their mail to work and the particulars don&#x27;t matter to them. The result is that your contacts can be spoofed.<p>If I (the admin) push back on this my boss will get a complaint like &quot;jabroni is interfering with my bazillion dollar sale&quot; and any argument to the contrary is obviously just me playing the blame game. So I whitelist it and now that company we are trading PDFs with can be spoofed by anybody and skips security scanning :)</div><br/><div id="37440546" class="c"><input type="checkbox" id="c-37440546" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37440174">root</a><span>|</span><a href="#37440335">parent</a><span>|</span><a href="#37440727">next</a><span>|</span><label class="collapse" for="c-37440546">[-]</label><label class="expand" for="c-37440546">[1 more]</label></div><br/><div class="children"><div class="content">I mean, yeah, I&#x27;ve been in that position, I get it for the poorly configured domains. However, if I set a DMARC policy for my domain to reject, I would expect at least Google and Microsoft who control something like 90% of the email market to respect that policy.<p>The realist in me realises that there is probably a non-negative number of domains out there with dmarc set to reject but failing absolutely all spf and dkim checks, but this should be their problem, not the receiver&#x27;s.</div><br/></div></div><div id="37440727" class="c"><input type="checkbox" id="c-37440727" checked=""/><div class="controls bullet"><span class="by">MichaelZuo</span><span>|</span><a href="#37440174">root</a><span>|</span><a href="#37440335">parent</a><span>|</span><a href="#37440546">prev</a><span>|</span><a href="#37440479">next</a><span>|</span><label class="collapse" for="c-37440727">[-]</label><label class="expand" for="c-37440727">[1 more]</label></div><br/><div class="children"><div class="content">If the other organization insists on sticking to older methods, then best practice is for all parties involved to revert to the last commonly and unarguably fully agreed-to method of communication, which is most likely fax in the US.</div><br/></div></div></div></div><div id="37440479" class="c"><input type="checkbox" id="c-37440479" checked=""/><div class="controls bullet"><span class="by">peanut-walrus</span><span>|</span><a href="#37440174">parent</a><span>|</span><a href="#37440335">prev</a><span>|</span><a href="#37439406">next</a><span>|</span><label class="collapse" for="c-37440479">[-]</label><label class="expand" for="c-37440479">[1 more]</label></div><br/><div class="children"><div class="content">Looks like this is fixed for Outlook.com<p>&gt; <i>Microsoft confirmed the vulnerabilities (with
severity “Important”, the highest severity assigned to
email spoofing bugs) and awarded us a bug bounty. They
have partially fixed the issues by rejecting spoofed email
messages purporting to be from domains that have a
DMARC policy of REJECT</i><p>However, I could still replicate this on an o365 domain, so this attack would still work if attacker has access to an o365 domain.</div><br/></div></div></div></div><div id="37439406" class="c"><input type="checkbox" id="c-37439406" checked=""/><div class="controls bullet"><span class="by">eli</span><span>|</span><a href="#37440174">prev</a><span>|</span><a href="#37439837">next</a><span>|</span><label class="collapse" for="c-37439406">[-]</label><label class="expand" for="c-37439406">[3 more]</label></div><br/><div class="children"><div class="content">Forwarding has always been a mess with SPF. The whole thing is a hack.</div><br/><div id="37440208" class="c"><input type="checkbox" id="c-37440208" checked=""/><div class="controls bullet"><span class="by">freedude</span><span>|</span><a href="#37439406">parent</a><span>|</span><a href="#37439459">next</a><span>|</span><label class="collapse" for="c-37440208">[-]</label><label class="expand" for="c-37440208">[1 more]</label></div><br/><div class="children"><div class="content">Yes, SPF makes forwarding suck</div><br/></div></div></div></div><div id="37439837" class="c"><input type="checkbox" id="c-37439837" checked=""/><div class="controls bullet"><span class="by">Zetobal</span><span>|</span><a href="#37439406">prev</a><span>|</span><a href="#37442420">next</a><span>|</span><label class="collapse" for="c-37439837">[-]</label><label class="expand" for="c-37439837">[1 more]</label></div><br/><div class="children"><div class="content">@dang can we fix the title?<p>Scammers can exploit email forwarding flaws to impersonate badly configured high-profile domains.</div><br/></div></div><div id="37442420" class="c"><input type="checkbox" id="c-37442420" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#37439837">prev</a><span>|</span><a href="#37439198">next</a><span>|</span><label class="collapse" for="c-37442420">[-]</label><label class="expand" for="c-37442420">[1 more]</label></div><br/><div class="children"><div class="content">Can someone explain why DKIM isn&#x27;t sufficient?<p>I really don&#x27;t get the point of SPF&#x2F;DMARC&#x2F;ARC everything else when DKIM exists. Why can&#x27;t everyone just set up DKIM and consider the problem solved?</div><br/></div></div><div id="37439198" class="c"><input type="checkbox" id="c-37439198" checked=""/><div class="controls bullet"><span class="by">comboy</span><span>|</span><a href="#37442420">prev</a><span>|</span><a href="#37441844">next</a><span>|</span><label class="collapse" for="c-37439198">[-]</label><label class="expand" for="c-37439198">[1 more]</label></div><br/><div class="children"><div class="content"><a href="http:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20230905131755&#x2F;https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2302.07287.pdf" rel="nofollow noreferrer">http:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20230905131755&#x2F;https:&#x2F;&#x2F;arxiv.org&#x2F;...</a><p>Page 9 gives you an idea</div><br/></div></div><div id="37441844" class="c"><input type="checkbox" id="c-37441844" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37439198">prev</a><span>|</span><a href="#37440602">next</a><span>|</span><label class="collapse" for="c-37441844">[-]</label><label class="expand" for="c-37441844">[2 more]</label></div><br/><div class="children"><div class="content">This feels like an implementation mistake by MS and G, not any kind of inherent design flaw (the latter being strongly implied by the article).<p>It&#x27;s a problem, and I&#x27;m glad it was explored, but c&#x27;mon.</div><br/><div id="37441860" class="c"><input type="checkbox" id="c-37441860" checked=""/><div class="controls bullet"><span class="by">dsr_</span><span>|</span><a href="#37441844">parent</a><span>|</span><a href="#37440602">next</a><span>|</span><label class="collapse" for="c-37441860">[-]</label><label class="expand" for="c-37441860">[1 more]</label></div><br/><div class="children"><div class="content">The inherent design flaw is that announcing via SPF &quot;Oh, yes, and Google is allowed to forge email on my behalf&quot; allows Google to forge email on your behalf.<p>All else follows. The enemy of security is convenience, and it&#x27;s very convenient to hand over mail to Microsoft, Google, etc.</div><br/></div></div></div></div><div id="37440602" class="c"><input type="checkbox" id="c-37440602" checked=""/><div class="controls bullet"><span class="by">istillwritecode</span><span>|</span><a href="#37441844">prev</a><span>|</span><a href="#37440367">next</a><span>|</span><label class="collapse" for="c-37440602">[-]</label><label class="expand" for="c-37440602">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s surprising that the paper doesn&#x27;t even mention SRS (Sender Rewrite Scheme).</div><br/></div></div><div id="37440367" class="c"><input type="checkbox" id="c-37440367" checked=""/><div class="controls bullet"><span class="by">jongjong</span><span>|</span><a href="#37440602">prev</a><span>|</span><a href="#37439998">next</a><span>|</span><label class="collapse" for="c-37440367">[-]</label><label class="expand" for="c-37440367">[1 more]</label></div><br/><div class="children"><div class="content">That seems like a big deal given that most websites rely on email-based authentication.</div><br/></div></div><div id="37439998" class="c"><input type="checkbox" id="c-37439998" checked=""/><div class="controls bullet"><span class="by">pdonis</span><span>|</span><a href="#37440367">prev</a><span>|</span><label class="collapse" for="c-37439998">[-]</label><label class="expand" for="c-37439998">[1 more]</label></div><br/><div class="children"><div class="content">TL&#x2F;DR: The US government and large companies are too incompetent to maintain their own email infrastructure, and instead are opening themselves up to spoofing attacks.</div><br/></div></div></div></div></div></div></div></body></html>