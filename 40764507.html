<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719133273248" as="style"/><link rel="stylesheet" href="styles.css?v=1719133273248"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="http://avtok.com/2014/11/05/interface-upgrades.html">Interface Upgrades in Go</a> <span class="domain">(<a href="http://avtok.com">avtok.com</a>)</span></div><div class="subtext"><span>panic</span> | <span>5 comments</span></div><br/><div><div id="40765828" class="c"><input type="checkbox" id="c-40765828" checked=""/><div class="controls bullet"><span class="by">nickcw</span><span>|</span><a href="#40765717">next</a><span>|</span><label class="collapse" for="c-40765828">[-]</label><label class="expand" for="c-40765828">[1 more]</label></div><br/><div class="children"><div class="content">I used to use interface upgrades in rclone (a program which syncs your data to many different cloud providers) for all the optional features a backend (cloud provider) might have, for example renaming a file.<p>However the proxy problem became unmanageable. That&#x27;s when I had a backend (eg the crypt backend which encrypts any other backend) which wraps another backend. Can the crypt backend rename things? That depends on what it is wrapping and you&#x27;d have to upgrade the interface call it and then get a special error to find out.<p>Eventually I switched to a table of bound method pointers which were easy to test against nil to see whether they were implemented and could be filled with a very small amount of reflection.<p>In my experience interface upgrades are useful but the proxy problem is very real so use sparingly only!<p>I did suggest at one point (to rsc) an addition to Go which would allow interface proxies to take methods away from their method set at run time to fix this problem, so the proxy could only have the methods it could implement. I&#x27;ve no idea how difficult this would be to implement though.</div><br/></div></div><div id="40765717" class="c"><input type="checkbox" id="c-40765717" checked=""/><div class="controls bullet"><span class="by">PUSH_AX</span><span>|</span><a href="#40765828">prev</a><span>|</span><a href="#40765687">next</a><span>|</span><label class="collapse" for="c-40765717">[-]</label><label class="expand" for="c-40765717">[2 more]</label></div><br/><div class="children"><div class="content">I remember working in a team that used interfaces for a ton of things. Every single one of those things only ever had one concrete implementation, still to this day. A lot of those things were also purely for mocking in tests too.<p>Today I don’t use them, unless I need it retrospectively. Which I find is rare.<p>This is not a knock on interfaces as a language feature. Just inserting a random anecdote about pragmatism..</div><br/><div id="40765799" class="c"><input type="checkbox" id="c-40765799" checked=""/><div class="controls bullet"><span class="by">radicalbyte</span><span>|</span><a href="#40765717">parent</a><span>|</span><a href="#40765687">next</a><span>|</span><label class="collapse" for="c-40765799">[-]</label><label class="expand" for="c-40765799">[1 more]</label></div><br/><div class="children"><div class="content">So you don&#x27;t test the parts of your system which need mocks to be effectively tested? How do you avoid the maintenance nightmare that causes?<p>I&#x27;m working on a Golang project where we&#x27;ve not yet introduced those kind of tests and, although it can be quicker to code initially, it&#x27;s slower overall. The project relies heavily on other Open Source systems so the Golang code isn&#x27;t even that complex.<p>I can&#x27;t imagine doing something hard and keeping it working over time without being to isolate dependencies to enable testing and keep the structure clear overall.</div><br/></div></div></div></div><div id="40765687" class="c"><input type="checkbox" id="c-40765687" checked=""/><div class="controls bullet"><span class="by">McMini</span><span>|</span><a href="#40765717">prev</a><span>|</span><label class="collapse" for="c-40765687">[-]</label><label class="expand" for="c-40765687">[1 more]</label></div><br/><div class="children"><div class="content">While the article highlights interface upgrades, it overlooks potential downsides like increased complexity in debugging. Anyone experienced issues with this?</div><br/></div></div></div></div></div></div></div></body></html>