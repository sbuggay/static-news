<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1705309267003" as="style"/><link rel="stylesheet" href="styles.css?v=1705309267003"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://johnstawinski.com/2024/01/11/playing-with-fire-how-we-executed-a-critical-supply-chain-attack-on-pytorch/">A supply chain attack on PyTorch</a> <span class="domain">(<a href="https://johnstawinski.com">johnstawinski.com</a>)</span></div><div class="subtext"><span>roblabla</span> | <span>91 comments</span></div><br/><div><div id="38992814" class="c"><input type="checkbox" id="c-38992814" checked=""/><div class="controls bullet"><span class="by">simonw</span><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38992814">[-]</label><label class="expand" for="c-38992814">[28 more]</label></div><br/><div class="children"><div class="content">The key to this attack is: &quot;The result of these settings is that, by default, any repository contributor can execute code on the self-hosted runner by submitting a malicious PR.&quot;<p>Problem: you need to be a &quot;contributor&quot; to the repo for your PR to trigger workflows without someone approving them first.<p>So: &quot;We needed to be a contributor to the PyTorch repository to execute workflows, but we didn’t feel like spending time adding features to PyTorch. Instead, we found a typo in a markdown file and submitted a fix.&quot;<p>I really don&#x27;t like this aspect of GitHub that people who have submitted a typo fix gain additional privileges on the repo by default. That&#x27;s something GitHub can fix: I think &quot;this user gets to trigger PRs without approval in the future&quot; should be an active button repo administrators need to click, maybe in the PR flow there could be &quot;Approve this run&quot; and &quot;Approve this run and all future runs by user X&quot; buttons.</div><br/><div id="38995946" class="c"><input type="checkbox" id="c-38995946" checked=""/><div class="controls bullet"><span class="by">schemescape</span><span>|</span><a href="#38992814">parent</a><span>|</span><a href="#38992968">next</a><span>|</span><label class="collapse" for="c-38995946">[-]</label><label class="expand" for="c-38995946">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I really don&#x27;t like this aspect of GitHub that people who have submitted a typo fix gain additional privileges on the repo by default.<p>What privileges do they gain? Anything other than the one you mentioned?<p>This was definitely not obvious to me, so thanks for bringing it up!</div><br/><div id="38996929" class="c"><input type="checkbox" id="c-38996929" checked=""/><div class="controls bullet"><span class="by">adnanthekhan</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38995946">parent</a><span>|</span><a href="#38992968">next</a><span>|</span><label class="collapse" for="c-38996929">[-]</label><label class="expand" for="c-38996929">[2 more]</label></div><br/><div class="children"><div class="content">This is more subtle, but there is an “author_association”field within Actions event contexts that can be one of:<p>NONE, CONTRIBUTOR, COLLABORATOR, MEMBER, OWNER<p>There are some cases where people use checks for that as part of gating for workflows that run on pull_request_target&#x2F;issue_comment, but might confuse contributor and collaborator (which requires explicitly adding someone to the repository). Ultimately this is a misconfiguration on part of the maintainer but another example where fixing a typo can play a part in an attack.</div><br/><div id="38997259" class="c"><input type="checkbox" id="c-38997259" checked=""/><div class="controls bullet"><span class="by">schemescape</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38996929">parent</a><span>|</span><a href="#38992968">next</a><span>|</span><label class="collapse" for="c-38997259">[-]</label><label class="expand" for="c-38997259">[1 more]</label></div><br/><div class="children"><div class="content">Thanks, that makes more sense than automatically granting privileges. It definitely seems easy to mix up those two terms, however!</div><br/></div></div></div></div></div></div><div id="38992968" class="c"><input type="checkbox" id="c-38992968" checked=""/><div class="controls bullet"><span class="by">trevyn</span><span>|</span><a href="#38992814">parent</a><span>|</span><a href="#38995946">prev</a><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38992968">[-]</label><label class="expand" for="c-38992968">[24 more]</label></div><br/><div class="children"><div class="content">The vast majority of repos should be able to run CI on pull requests with no privileges at all. GitHub can manage any resource utilization issues on their end.<p>Is the issue here that a self-hosted runner was needed for some hardware tests?</div><br/><div id="38993609" class="c"><input type="checkbox" id="c-38993609" checked=""/><div class="controls bullet"><span class="by">o11c</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38992968">parent</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38993609">[-]</label><label class="expand" for="c-38993609">[13 more]</label></div><br/><div class="children"><div class="content">The problem is that there are fundamentally 2 different kinds of builds, but the current tooling is weak:<p>* pre-merge builds on PRs.  These should not have privileges, but making the distinction between the two cases requires a lot of care.<p>* official builds of &quot;master&quot; or a feature branch from the main repo.  These &quot;need&quot; privileges to upload the resulting artifacts somewhere. Of course, if all it did was wake up some daemon elsewhere, which could download straight from the CI in a verified way based on the <i>CI&#x27;s</i> notion of the job name, it would be secure without privileges, but most CI systems don&#x27;t want to preserve huge artifacts, and maintaining the separate daemon is also annoying.</div><br/><div id="38997798" class="c"><input type="checkbox" id="c-38997798" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38993609">parent</a><span>|</span><a href="#38997518">next</a><span>|</span><label class="collapse" for="c-38997798">[-]</label><label class="expand" for="c-38997798">[1 more]</label></div><br/><div class="children"><div class="content">&gt; These &quot;need&quot; privileges to upload the resulting artifacts somewhere.<p>Only because pypi removed support for gpg and their only &quot;signature&quot; now basically is &quot;was uploaded from a gh action&quot;.<p>Otherwise a maintainer could do it offline without needing to give microsoft total access to uploading to pypi.</div><br/></div></div><div id="38997518" class="c"><input type="checkbox" id="c-38997518" checked=""/><div class="controls bullet"><span class="by">snnn</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38993609">parent</a><span>|</span><a href="#38997798">prev</a><span>|</span><a href="#38994312">next</a><span>|</span><label class="collapse" for="c-38997518">[-]</label><label class="expand" for="c-38997518">[1 more]</label></div><br/><div class="children"><div class="content">Ideally the builds for external PRs should not gain any access to any secret. But it is not practical. For example, you may want to use docker containers. Then you will need to download docker images from somewhere. For example, downloading ubuntu:20.04 from docker hub. That one requires a token, otherwise your request may get throttled. Even accessing most Github services requires a token. I agree with you that these things require a lot of care. In reality most dev teams are not willing to put enough time on securing their build system. That&#x27;s why supply chain attacks are so common today.</div><br/></div></div><div id="38994312" class="c"><input type="checkbox" id="c-38994312" checked=""/><div class="controls bullet"><span class="by">akx</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38993609">parent</a><span>|</span><a href="#38997518">prev</a><span>|</span><a href="#38994472">next</a><span>|</span><label class="collapse" for="c-38994312">[-]</label><label class="expand" for="c-38994312">[2 more]</label></div><br/><div class="children"><div class="content">For the second point, PyPI&#x27;s trusted publisher implementation does this very well: <a href="https:&#x2F;&#x2F;docs.pypi.org&#x2F;trusted-publishers&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.pypi.org&#x2F;trusted-publishers&#x2F;</a></div><br/><div id="38997805" class="c"><input type="checkbox" id="c-38997805" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994312">parent</a><span>|</span><a href="#38994472">next</a><span>|</span><label class="collapse" for="c-38997805">[-]</label><label class="expand" for="c-38997805">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t that what&#x27;s causing the problem?<p>Without that there would be no need to have an action to do an upload. It could be comfortably and safely done offline.</div><br/></div></div></div></div><div id="38994472" class="c"><input type="checkbox" id="c-38994472" checked=""/><div class="controls bullet"><span class="by">trevyn</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38993609">parent</a><span>|</span><a href="#38994312">prev</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38994472">[-]</label><label class="expand" for="c-38994472">[8 more]</label></div><br/><div class="children"><div class="content">It’s called GitHub secrets.<p>Builds off of main get the secrets, pull requests from randos don’t.<p>And public repos don’t pay for CI on GitHub.<p>Not rocket science, people.</div><br/><div id="38997807" class="c"><input type="checkbox" id="c-38997807" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994472">parent</a><span>|</span><a href="#38995075">next</a><span>|</span><label class="collapse" for="c-38997807">[-]</label><label class="expand" for="c-38997807">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Not rocket science, people.<p>The smugness and overconfidence of someone who&#x27;s about to be pwned?</div><br/></div></div><div id="38995075" class="c"><input type="checkbox" id="c-38995075" checked=""/><div class="controls bullet"><span class="by">mlazos</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994472">parent</a><span>|</span><a href="#38997807">prev</a><span>|</span><a href="#38994693">next</a><span>|</span><label class="collapse" for="c-38995075">[-]</label><label class="expand" for="c-38995075">[2 more]</label></div><br/><div class="children"><div class="content">If they use the same runners, couldn’t the attacker just wait? The runners would need to be sequestered too</div><br/><div id="38995308" class="c"><input type="checkbox" id="c-38995308" checked=""/><div class="controls bullet"><span class="by">kevin_nisbet</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38995075">parent</a><span>|</span><a href="#38994693">next</a><span>|</span><label class="collapse" for="c-38995308">[-]</label><label class="expand" for="c-38995308">[1 more]</label></div><br/><div class="children"><div class="content">Absolutely. The real difficulty is tests on PR are by definition remote code execution by an untrusted source, so a full risk analysis and hardening needs to be done.<p>Here&#x27;s a similar mistake on an OSS repo a company I worked for made: <a href="https:&#x2F;&#x2F;goteleport.com&#x2F;blog&#x2F;hack-via-pull-request&#x2F;" rel="nofollow">https:&#x2F;&#x2F;goteleport.com&#x2F;blog&#x2F;hack-via-pull-request&#x2F;</a></div><br/></div></div></div></div><div id="38994693" class="c"><input type="checkbox" id="c-38994693" checked=""/><div class="controls bullet"><span class="by">n2d4</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994472">parent</a><span>|</span><a href="#38995075">prev</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38994693">[-]</label><label class="expand" for="c-38994693">[4 more]</label></div><br/><div class="children"><div class="content">Pytorch did use GH secrets for the valuables and you can see that this wasn&#x27;t enough, right there in the OP, because the self-hosted runners are still shared</div><br/><div id="38995257" class="c"><input type="checkbox" id="c-38995257" checked=""/><div class="controls bullet"><span class="by">adnanthekhan</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994693">parent</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38995257">[-]</label><label class="expand" for="c-38995257">[3 more]</label></div><br/><div class="children"><div class="content">Yup! This is what makes this kind of attack scary and very unique to GitHub Actions. The baseline GITHUB_TOKEN just blows the door open on lateral movement via workflow_dispatch and and repository_dispatch events.<p>In several of our other operations, not just PyTorch, we leveraged workflow_dispatch to steal a PAT from another workflows. Developers tend to over-provision PATs so often. More often than not we&#x27;d end up with a PAT that has all scopes checked and org admin permissions. With that one could clean out all of the secrets from an organization in minutes using automated tools such as <a href="https:&#x2F;&#x2F;github.com&#x2F;praetorian-inc&#x2F;gato">https:&#x2F;&#x2F;github.com&#x2F;praetorian-inc&#x2F;gato</a>.</div><br/><div id="38995503" class="c"><input type="checkbox" id="c-38995503" checked=""/><div class="controls bullet"><span class="by">trevyn</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38995257">parent</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38995503">[-]</label><label class="expand" for="c-38995503">[2 more]</label></div><br/><div class="children"><div class="content">To clarify, this secret stealing is not an issue with GitHub-hosted runners, correct?</div><br/><div id="38995662" class="c"><input type="checkbox" id="c-38995662" checked=""/><div class="controls bullet"><span class="by">adnanthekhan</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38995503">parent</a><span>|</span><a href="#38994036">next</a><span>|</span><label class="collapse" for="c-38995662">[-]</label><label class="expand" for="c-38995662">[1 more]</label></div><br/><div class="children"><div class="content">Correct. For fork PR workflows on the pull_request trigger the GITHUB_TOKEN has read only permissions, so you can’t do anything with it.<p>The key thing with a non-ephemeral runner is that (after obtaining persistence) you can grab the GITHUB_TOKEN from a subsequent non-fork PR build or a build on another trigger, which will have write permissions unless restricted by the repository maintainers.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38994036" class="c"><input type="checkbox" id="c-38994036" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38992968">parent</a><span>|</span><a href="#38993609">prev</a><span>|</span><a href="#38993192">next</a><span>|</span><label class="collapse" for="c-38994036">[-]</label><label class="expand" for="c-38994036">[5 more]</label></div><br/><div class="children"><div class="content">&gt;<i>The vast majority of repos should be able to run CI on pull requests with no privileges at all</i><p>When there are no side effects and no in-container secrets and the hosting is free or reasonably limited to prevent abusers, ideally yes.<p>Outside that, heck no, that&#x27;d be crazy.  You&#x27;re allowing randos to run arbitrary code on your budget.  Locking it down until it&#x27;s reviewed is like step 1, they can validate locally until then.</div><br/><div id="38997953" class="c"><input type="checkbox" id="c-38997953" checked=""/><div class="controls bullet"><span class="by">guappa</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994036">parent</a><span>|</span><a href="#38994774">next</a><span>|</span><label class="collapse" for="c-38997953">[-]</label><label class="expand" for="c-38997953">[2 more]</label></div><br/><div class="children"><div class="content">They are so difficult. I wanted to stop random people to run code on my repository… I don&#x27;t have any secrets or write access or anything to exploit. Just to avoid burning quota.<p>The issue is that now the pull requests don&#x27;t get tested at all. I have to manually, locally, get all the commits, make a branch on the main repository with them, and then the actions run.</div><br/><div id="38998143" class="c"><input type="checkbox" id="c-38998143" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38997953">parent</a><span>|</span><a href="#38994774">next</a><span>|</span><label class="collapse" for="c-38998143">[-]</label><label class="expand" for="c-38998143">[1 more]</label></div><br/><div class="children"><div class="content">That just plain sounds Bad™, yeah.  In the buildkite setup I interact with, I can at least just hit the &quot;continue&quot; button on the paused pipeline, regardless of any other GitHub state... which feels like table stakes to me.</div><br/></div></div></div></div><div id="38994774" class="c"><input type="checkbox" id="c-38994774" checked=""/><div class="controls bullet"><span class="by">KptMarchewa</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994036">parent</a><span>|</span><a href="#38997953">prev</a><span>|</span><a href="#38993192">next</a><span>|</span><label class="collapse" for="c-38994774">[-]</label><label class="expand" for="c-38994774">[2 more]</label></div><br/><div class="children"><div class="content">GH actions are free on public repos.</div><br/><div id="38997287" class="c"><input type="checkbox" id="c-38997287" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994774">parent</a><span>|</span><a href="#38993192">next</a><span>|</span><label class="collapse" for="c-38997287">[-]</label><label class="expand" for="c-38997287">[1 more]</label></div><br/><div class="children"><div class="content">Until someone tries to mine Bitcoin in yours, yeah</div><br/></div></div></div></div></div></div><div id="38993192" class="c"><input type="checkbox" id="c-38993192" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38992968">parent</a><span>|</span><a href="#38994036">prev</a><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38993192">[-]</label><label class="expand" for="c-38993192">[5 more]</label></div><br/><div class="children"><div class="content">Self-hosted runners is the way to go, IMHO. Especially if you have bare metal resources. I love how fast my builds are with 16 cores, and gobs of ram.</div><br/><div id="38994506" class="c"><input type="checkbox" id="c-38994506" checked=""/><div class="controls bullet"><span class="by">ethbr1</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38993192">parent</a><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38994506">[-]</label><label class="expand" for="c-38994506">[4 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the GitHub Actions tooling like for emphemeral self-hosted runners?<p>Afaict, a huge portion of this attack came from persistence on the self-hosted runner.<p>Absent that, they would have needed a container jailbreak as well, which substantially ups the difficulty.<p>And if a repo is running &lt;100 builds a day, spin up + kill container seems a small per-build price to pay for the additional security isolation.</div><br/><div id="38994540" class="c"><input type="checkbox" id="c-38994540" checked=""/><div class="controls bullet"><span class="by">jackwilsdon</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994506">parent</a><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38994540">[-]</label><label class="expand" for="c-38994540">[3 more]</label></div><br/><div class="children"><div class="content">GitHub themselves don&#x27;t seem to provide any mechanism to make runners ephemeral. It looks like all they allow you to do is flag a runner as ephemeral, meaning it will be de-registered once a job is completed - you need to write your own tooling to wipe it yourself (either via starting a whole new runner in a new environment and registering that or wiping the existing runner and re-registering it).<p><a href="https:&#x2F;&#x2F;docs.github.com&#x2F;en&#x2F;actions&#x2F;hosting-your-own-runners&#x2F;managing-self-hosted-runners&#x2F;autoscaling-with-self-hosted-runners#using-ephemeral-runners-for-autoscaling" rel="nofollow">https:&#x2F;&#x2F;docs.github.com&#x2F;en&#x2F;actions&#x2F;hosting-your-own-runners&#x2F;...</a></div><br/><div id="38998456" class="c"><input type="checkbox" id="c-38998456" checked=""/><div class="controls bullet"><span class="by">crohr</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994540">parent</a><span>|</span><a href="#38995126">next</a><span>|</span><label class="collapse" for="c-38998456">[-]</label><label class="expand" for="c-38998456">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve just made runs-on [1] for that purpose: self-hosted, ephemeral runners for GitHub Action workflows. Long-running self-hosted runners are simply too risky if your project is public.<p>[1]: <a href="https:&#x2F;&#x2F;runs-on.com" rel="nofollow">https:&#x2F;&#x2F;runs-on.com</a></div><br/></div></div><div id="38995126" class="c"><input type="checkbox" id="c-38995126" checked=""/><div class="controls bullet"><span class="by">gz5</span><span>|</span><a href="#38992814">root</a><span>|</span><a href="#38994540">parent</a><span>|</span><a href="#38998456">prev</a><span>|</span><a href="#38993595">next</a><span>|</span><label class="collapse" for="c-38995126">[-]</label><label class="expand" for="c-38995126">[1 more]</label></div><br/><div class="children"><div class="content">there are 3rd party foss options (1):<p>1. ephemeral + zero implicit trust (2)
<a href="https:&#x2F;&#x2F;blog.openziti.io&#x2F;my-intern-assignment-call-a-dark-webhook-from-aws-lambda" rel="nofollow">https:&#x2F;&#x2F;blog.openziti.io&#x2F;my-intern-assignment-call-a-dark-we...</a><p>2. zero implicit trust:
<a href="https:&#x2F;&#x2F;github.com&#x2F;openziti&#x2F;ziti-webhook-action">https:&#x2F;&#x2F;github.com&#x2F;openziti&#x2F;ziti-webhook-action</a><p>(1) disclosure, maintainer
(2) zero implicit trust in this case = no open inbound ports on underlay; need to access via app-specific overlay which requires strong identity, authN, authZ</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38993595" class="c"><input type="checkbox" id="c-38993595" checked=""/><div class="controls bullet"><span class="by">zX41ZdbW</span><span>|</span><a href="#38992814">prev</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38993595">[-]</label><label class="expand" for="c-38993595">[9 more]</label></div><br/><div class="children"><div class="content">Recently, there were similar attempts (two) of supply chain attacks on the ClickHouse repository, but: - it didn&#x27;t do anything because CI does not run without approval; - the user&#x27;s account magically disappeared from GitHub with all pull requests within a day.<p>Also worth reading a similar example: <a href="https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;cloudflares-handling-of-an-rce-vulnerability-in-cdnjs" rel="nofollow">https:&#x2F;&#x2F;blog.cloudflare.com&#x2F;cloudflares-handling-of-an-rce-v...</a><p>Also, let me recommend our bug bounty program: <a href="https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;issues&#x2F;38986">https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;issues&#x2F;38986</a> It sounds easy - pick your favorite fuzzer, find a segfault (it should be easy because C++ isn&#x27;t a memory-safe language), and get your paycheck.</div><br/><div id="38993644" class="c"><input type="checkbox" id="c-38993644" checked=""/><div class="controls bullet"><span class="by">zX41ZdbW</span><span>|</span><a href="#38993595">parent</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38993644">[-]</label><label class="expand" for="c-38993644">[8 more]</label></div><br/><div class="children"><div class="content">But I continue to find garbage in some of our CI scripts.<p>Here is an example: <a href="https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;pull&#x2F;58794&#x2F;files">https:&#x2F;&#x2F;github.com&#x2F;ClickHouse&#x2F;ClickHouse&#x2F;pull&#x2F;58794&#x2F;files</a><p>The right way is to:<p>- always pin versions of all packages;
- this includes OS package repositories, Docker repositories, as well as pip, npm, cargo, and others;
- never download anything from the master&#x2F;main or other branches; specify commit sha;
- ideally, copy all Docker images to our own private registry;
- ideally, calculate hashes after download and compare them with what was before;
- frankly speaking, if CI runs air-gapped, it would be much better...</div><br/><div id="38995803" class="c"><input type="checkbox" id="c-38995803" checked=""/><div class="controls bullet"><span class="by">Twirrim</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38993644">parent</a><span>|</span><a href="#38994665">next</a><span>|</span><label class="collapse" for="c-38995803">[-]</label><label class="expand" for="c-38995803">[1 more]</label></div><br/><div class="children"><div class="content">Also:  Vendor your dependencies.  There&#x27;s <i>zero</i> reason to be wget&#x27;ing like that.  It&#x27;s two short perl scripts.</div><br/></div></div><div id="38994665" class="c"><input type="checkbox" id="c-38994665" checked=""/><div class="controls bullet"><span class="by">EE84M3i</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38993644">parent</a><span>|</span><a href="#38995803">prev</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38994665">[-]</label><label class="expand" for="c-38994665">[6 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand this PR. How is it an &quot;attack&quot;? It seems to just be pinning a package version, was the package compromised, or was this more a &quot;vulnerability&quot;?</div><br/><div id="38994965" class="c"><input type="checkbox" id="c-38994965" checked=""/><div class="controls bullet"><span class="by">korhojoa</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38994665">parent</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38994965">[-]</label><label class="expand" for="c-38994965">[5 more]</label></div><br/><div class="children"><div class="content">If they&#x27;re pulling from master instead of from a known version, it could be changed to be malicious, and the next time it is fetched, the malicious version would be used instead. It&#x27;s a vulnerability.</div><br/><div id="38995288" class="c"><input type="checkbox" id="c-38995288" checked=""/><div class="controls bullet"><span class="by">adnanthekhan</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38994965">parent</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38995288">[-]</label><label class="expand" for="c-38995288">[4 more]</label></div><br/><div class="children"><div class="content">Oh, you&#x27;ll like this one then. Until 3 months ago GitHub&#x27;s Runner images was pulling a package directly from Aliyun&#x27;s CDN. This was executed during image testing (version check). So anyone with the ability to modify Aliyun&#x27;s CDN in China could have carried out a pretty nasty attack. <a href="https:&#x2F;&#x2F;github.com&#x2F;actions&#x2F;runner-images&#x2F;commit&#x2F;6a98903627388773fcaffe342f74e1aacd3c39f8#diff-cca8140ace8b562da32b403bb6a46522c6988eb9064ea0ac3bb1e54a888d83d1">https:&#x2F;&#x2F;github.com&#x2F;actions&#x2F;runner-images&#x2F;commit&#x2F;6a9890362738...</a><p>Now it&#x27;s just anyone with write access to Aliyun&#x27;s repository. :) (p.s. GitHub doesn&#x27;t consider this a security issue).</div><br/><div id="38996193" class="c"><input type="checkbox" id="c-38996193" checked=""/><div class="controls bullet"><span class="by">mschuster91</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38995288">parent</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38996193">[-]</label><label class="expand" for="c-38996193">[3 more]</label></div><br/><div class="children"><div class="content">Whoa, there&#x27;s <i>a lot</i> of stuff in there [1] that gets installed straight from vendors, without pinning content checksums to a value <i>known-good to Github</i>.<p>I get it, they want to have the latest versions instead of depending on how long Ubuntu (or, worse, Debian) package maintainers take to package stuff into their mainline repositories... but creating this attack surface is nuts. Imagine being able to compromise just one of the various small tools they embed, and pivoting from there to all GitHub runners everywhere (e.g. by overwriting &#x2F;bin&#x2F;bash or any other popular entrypoint, or even libc itself, with a malware payload).<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;actions&#x2F;runner-images&#x2F;tree&#x2F;main&#x2F;images&#x2F;ubuntu&#x2F;scripts&#x2F;build">https:&#x2F;&#x2F;github.com&#x2F;actions&#x2F;runner-images&#x2F;tree&#x2F;main&#x2F;images&#x2F;ub...</a></div><br/><div id="38997845" class="c"><input type="checkbox" id="c-38997845" checked=""/><div class="controls bullet"><span class="by">LtWorf</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38996193">parent</a><span>|</span><a href="#38996642">next</a><span>|</span><label class="collapse" for="c-38997845">[-]</label><label class="expand" for="c-38997845">[1 more]</label></div><br/><div class="children"><div class="content">&gt; on how long Ubuntu (or, worse, Debian) package maintainers take to package stuff into their mainline repositories...<p>Really a misinformed comment.<p>For starters Ubuntu is for the most part a snapshot of Debian sid, so except for a few cases it will not have more modern versions.<p>The python packaging team is really hard working… In most cases stuff that doesn&#x27;t get updated immediately is because it breaks something or depends on something new that isn&#x27;t packaged yet.<p>Please stop demeaning the work of others when you seem to not know that it even happens at all.</div><br/></div></div><div id="38996642" class="c"><input type="checkbox" id="c-38996642" checked=""/><div class="controls bullet"><span class="by">adnanthekhan</span><span>|</span><a href="#38993595">root</a><span>|</span><a href="#38996193">parent</a><span>|</span><a href="#38997845">prev</a><span>|</span><a href="#38993375">next</a><span>|</span><label class="collapse" for="c-38996642">[-]</label><label class="expand" for="c-38996642">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, the security posture of that repository is kind of a mess (which is why something like <a href="https:&#x2F;&#x2F;adnanthekhan.com&#x2F;2023&#x2F;12&#x2F;20&#x2F;one-supply-chain-attack-to-rule-them-all&#x2F;" rel="nofollow">https:&#x2F;&#x2F;adnanthekhan.com&#x2F;2023&#x2F;12&#x2F;20&#x2F;one-supply-chain-attack-...</a> was even possible in the first place).<p>The balance there is overwhelmingly in favor of usability and having new tools (hence the 1 week deployment cadence). Maybe there is some process they have to go over everything before it makes it into the production pool, but that’s quite an undertaking to perform properly every week.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="38993375" class="c"><input type="checkbox" id="c-38993375" checked=""/><div class="controls bullet"><span class="by">SethMLarson</span><span>|</span><a href="#38993595">prev</a><span>|</span><a href="#38997460">next</a><span>|</span><label class="collapse" for="c-38993375">[-]</label><label class="expand" for="c-38993375">[6 more]</label></div><br/><div class="children"><div class="content">Great write-up! There&#x27;s a few things you can do as either a producer or consumer to thwart this sort of attack:<p>Producers:<p>* Self-hosted infrastructure should not be running anonymous code. PRs should be reviewed before code executes on your infrastructure. Potentially should be a GitHub default when using self-hosted runners?<p>* Permissions for workflows and tokens should be minimal and fine-grained. &quot;permissions: read-all&quot; should be your default when creating a new workflow. Prevents lateral movement via modifying workflow code.<p>* Self-hosted infrastructure should be isolated and ephemeral, persistence was key for lateral movement with this attack.<p>Consumers:<p>* Use a lock file with pinned hashes, either --require-hashes or poetry&#x2F;pipfile<p>* Review the diff of the file getting installed, not the GitHub source code. This will get easier when build provenance becomes a feature of PyPI.<p>* If your organization is large enough, consider mirroring PyPI with approved releases so the manual review effort can be amortized.<p>* More coming in this space for Python, like third-party attestations about malware, provenance, build reproducibility, etc. Stay tuned! :)</div><br/><div id="38993702" class="c"><input type="checkbox" id="c-38993702" checked=""/><div class="controls bullet"><span class="by">tlarkworthy</span><span>|</span><a href="#38993375">parent</a><span>|</span><a href="#38995612">next</a><span>|</span><label class="collapse" for="c-38993702">[-]</label><label class="expand" for="c-38993702">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Self-hosted infrastructure should be isolated and ephemeral, persistence was key for lateral movement with this attack.<p>Half the point of self hosting is to reuse cached resources.</div><br/><div id="38993739" class="c"><input type="checkbox" id="c-38993739" checked=""/><div class="controls bullet"><span class="by">SethMLarson</span><span>|</span><a href="#38993375">root</a><span>|</span><a href="#38993702">parent</a><span>|</span><a href="#38995612">next</a><span>|</span><label class="collapse" for="c-38993739">[-]</label><label class="expand" for="c-38993739">[1 more]</label></div><br/><div class="children"><div class="content">Isolation and ephemerality can still be accomplished using virtualization while providing the benefits of self-hosted resources.</div><br/></div></div></div></div><div id="38995612" class="c"><input type="checkbox" id="c-38995612" checked=""/><div class="controls bullet"><span class="by">sroussey</span><span>|</span><a href="#38993375">parent</a><span>|</span><a href="#38993702">prev</a><span>|</span><a href="#38996086">next</a><span>|</span><label class="collapse" for="c-38995612">[-]</label><label class="expand" for="c-38995612">[2 more]</label></div><br/><div class="children"><div class="content">I just wish python would isolate all the pip install stuff and put in the project folder like has been done with nodejs for years.</div><br/><div id="38995990" class="c"><input type="checkbox" id="c-38995990" checked=""/><div class="controls bullet"><span class="by">bloopernova</span><span>|</span><a href="#38993375">root</a><span>|</span><a href="#38995612">parent</a><span>|</span><a href="#38996086">next</a><span>|</span><label class="collapse" for="c-38995990">[-]</label><label class="expand" for="c-38995990">[1 more]</label></div><br/><div class="children"><div class="content">Python&#x27;s virtualenv does something similar by keeping all files under one directory.</div><br/></div></div></div></div><div id="38996086" class="c"><input type="checkbox" id="c-38996086" checked=""/><div class="controls bullet"><span class="by">YetAnotherNick</span><span>|</span><a href="#38993375">parent</a><span>|</span><a href="#38995612">prev</a><span>|</span><a href="#38997460">next</a><span>|</span><label class="collapse" for="c-38996086">[-]</label><label class="expand" for="c-38996086">[1 more]</label></div><br/><div class="children"><div class="content">&gt; PRs should be reviewed before code executes on your infrastructure<p>Very often local tests results can&#x27;t be trusted specially for projects with architecture level codes like pytorch. Before merging the test results needs to be checked. And it doesn&#x27;t require just PR review to be safe, it requires review of all the commits as the contributor is making the changes to fix the testcase. Even if we assume that the maintainer will review each of the commit within a day, it could take weeks or months for the contributor to fix the failing testcase with this and maintainer to be looking at the same PR everyday.</div><br/></div></div></div></div><div id="38971134" class="c"><input type="checkbox" id="c-38971134" checked=""/><div class="controls bullet"><span class="by">CoolCold</span><span>|</span><a href="#38997460">prev</a><span>|</span><a href="#38997543">next</a><span>|</span><label class="collapse" for="c-38971134">[-]</label><label class="expand" for="c-38971134">[1 more]</label></div><br/><div class="children"><div class="content">Among other nice things, I liked<p>&gt; We used our C2 repository to execute the pwd &amp;&amp; ls &amp;&amp; &#x2F;home &amp;&amp; ip a command on the runner labeled “jenkins-worker-rocm-amd-34”, confirming stable C2 and remote code execution. We also ran sudo -l to confirm we had root access.<p>While it&#x27;s not clear was it curated list of commands or just ALL, I assume the latter and that makes me feel no system administrator was involved into that pipelines setup - those guys are quite allergic to giving sudo&#x2F;root access at all</div><br/></div></div><div id="38997543" class="c"><input type="checkbox" id="c-38997543" checked=""/><div class="controls bullet"><span class="by">benreesman</span><span>|</span><a href="#38971134">prev</a><span>|</span><a href="#38992904">next</a><span>|</span><label class="collapse" for="c-38997543">[-]</label><label class="expand" for="c-38997543">[1 more]</label></div><br/><div class="children"><div class="content">I’m only going to get into detail if anyone cares, but the actionable, germane thing is to be ready to move to torch-like tensor libraries.<p>The same design flaws in PyTorch that make it an interest attack vector (which in a very, very small way I had a part in, I also got this wrong) are the same design flaws that basically dictate that’s it’s more like an API than an implementation now: and those flaws are all the ways it’s too big to easily audit or port.<p>It’s a very good UI to accelerated computing, and I suspect it’s the “last one” for a long time.<p>I hope the next mainstream implementation will be TinyGrad, I fear it’ll be MLX, and I’d settle for JAX, but it won’t be PyTorch per se.</div><br/></div></div><div id="38992904" class="c"><input type="checkbox" id="c-38992904" checked=""/><div class="controls bullet"><span class="by">1B05H1N</span><span>|</span><a href="#38997543">prev</a><span>|</span><a href="#38994438">next</a><span>|</span><label class="collapse" for="c-38992904">[-]</label><label class="expand" for="c-38992904">[1 more]</label></div><br/><div class="children"><div class="content">How should one detect this kind of stuff?<p>Also reverse props to the meta bug bounty program manager for not understanding the finding initially. I know it&#x27;s difficult managing a program but it&#x27;s not an excuse to brush something like this off.</div><br/></div></div><div id="38994438" class="c"><input type="checkbox" id="c-38994438" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#38992904">prev</a><span>|</span><a href="#38992534">next</a><span>|</span><label class="collapse" for="c-38994438">[-]</label><label class="expand" for="c-38994438">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Thankfully, we exploited this vulnerability before the bad guys.<p>How do you know?</div><br/></div></div><div id="38992534" class="c"><input type="checkbox" id="c-38992534" checked=""/><div class="controls bullet"><span class="by">vicktorium</span><span>|</span><a href="#38994438">prev</a><span>|</span><a href="#38992657">next</a><span>|</span><label class="collapse" for="c-38992534">[-]</label><label class="expand" for="c-38992534">[8 more]</label></div><br/><div class="children"><div class="content">very interesting<p>i wonder about the over-dependence on third party packages and modules<p>imagine the author of &#x27;is-odd&#x27; injects a trojan there<p>what are you gonna do?<p>C has this solved but &#x27;vendoring&#x27; is not as fast as this approach</div><br/><div id="38998016" class="c"><input type="checkbox" id="c-38998016" checked=""/><div class="controls bullet"><span class="by">guappa</span><span>|</span><a href="#38992534">parent</a><span>|</span><a href="#38993448">next</a><span>|</span><label class="collapse" for="c-38998016">[-]</label><label class="expand" for="c-38998016">[1 more]</label></div><br/><div class="children"><div class="content">&gt; C has this solved<p>It hasn&#x27;t… but C developers are much more careful about adding a dependency than js&#x2F;python&#x2F;rust&#x2F;go developers. Mostly because adding a dependency in C is more annoying. In those languages it&#x27;s just about adding one line.<p>Of course if you use a distribution and it&#x27;s a famous library, it&#x27;s to add a line as well. But then there is the filter of the distribution. Which would work for any language, but most developers vendor everything instead.</div><br/></div></div><div id="38993448" class="c"><input type="checkbox" id="c-38993448" checked=""/><div class="controls bullet"><span class="by">SethMLarson</span><span>|</span><a href="#38992534">parent</a><span>|</span><a href="#38998016">prev</a><span>|</span><a href="#38993687">next</a><span>|</span><label class="collapse" for="c-38993448">[-]</label><label class="expand" for="c-38993448">[1 more]</label></div><br/><div class="children"><div class="content">The recommended guidance is either vendoring dependencies or pinning to hashes (pip --require-hashes, poetry.lock, pipfile). When updating your dependencies you should review the actual file getting downloaded.<p>Compiled binaries are harder, you might consider compiling them from source and comparing the output. This is where build reproducibility comes in to play.<p>There&#x27;s a lot more coming in the Python packaging security space that&#x27;ll make this easier and just safer in general. Stay tuned :)</div><br/></div></div><div id="38993687" class="c"><input type="checkbox" id="c-38993687" checked=""/><div class="controls bullet"><span class="by">BirAdam</span><span>|</span><a href="#38992534">parent</a><span>|</span><a href="#38993448">prev</a><span>|</span><a href="#38993243">next</a><span>|</span><label class="collapse" for="c-38993687">[-]</label><label class="expand" for="c-38993687">[1 more]</label></div><br/><div class="children"><div class="content">Well… sort of. C has become a standard with several implementations. It gains supply chain security by being decentralized. Likewise, it has many package managers with different repos for language specific things, and it then has many package managers and repos if we consider UNIX&#x2F;Linux systems C development environments with dynamic linking and the like.<p>The issue is, for any given implementation, similar attacks could still happen, and the package repos are still probably vulnerable.</div><br/></div></div><div id="38993243" class="c"><input type="checkbox" id="c-38993243" checked=""/><div class="controls bullet"><span class="by">chuckadams</span><span>|</span><a href="#38992534">parent</a><span>|</span><a href="#38993687">prev</a><span>|</span><a href="#38992810">next</a><span>|</span><label class="collapse" for="c-38993243">[-]</label><label class="expand" for="c-38993243">[1 more]</label></div><br/><div class="children"><div class="content">&gt; C has this solved<p>&quot;Reflections on Trusting Trust&quot; was a demonstration of this in the C ecosystem long before package managers were a thing.</div><br/></div></div><div id="38992810" class="c"><input type="checkbox" id="c-38992810" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#38992534">parent</a><span>|</span><a href="#38993243">prev</a><span>|</span><a href="#38993204">next</a><span>|</span><label class="collapse" for="c-38992810">[-]</label><label class="expand" for="c-38992810">[2 more]</label></div><br/><div class="children"><div class="content">You can&#x27;t do much beyond setting up a corporate proxy that blocks or inspects outbound connections. Even then, you&#x27;re relying on luck.<p>These days it&#x27;s practically a necessity for companies to shell out money to some sort of supply-chain protection software (Sonatype, Socket.dev  etc.)</div><br/><div id="38994086" class="c"><input type="checkbox" id="c-38994086" checked=""/><div class="controls bullet"><span class="by">lanstin</span><span>|</span><a href="#38992534">root</a><span>|</span><a href="#38992810">parent</a><span>|</span><a href="#38993204">next</a><span>|</span><label class="collapse" for="c-38994086">[-]</label><label class="expand" for="c-38994086">[1 more]</label></div><br/><div class="children"><div class="content">Make the corporate proxy use an allow list only. Even then you fall prey to official PyPi hacked packages, but at least then the cryptominers or discord cred stealers can’t phone home.</div><br/></div></div></div></div></div></div><div id="38992657" class="c"><input type="checkbox" id="c-38992657" checked=""/><div class="controls bullet"><span class="by">gray_-_wolf</span><span>|</span><a href="#38992534">prev</a><span>|</span><a href="#38994090">next</a><span>|</span><label class="collapse" for="c-38992657">[-]</label><label class="expand" for="c-38992657">[6 more]</label></div><br/><div class="children"><div class="content">Hm, from the reading, it seem he was pretty careful to not do any harm, but still, is this type of practical research actually legal?</div><br/><div id="38994347" class="c"><input type="checkbox" id="c-38994347" checked=""/><div class="controls bullet"><span class="by">richardwhiuk</span><span>|</span><a href="#38992657">parent</a><span>|</span><a href="#38992741">next</a><span>|</span><label class="collapse" for="c-38994347">[-]</label><label class="expand" for="c-38994347">[2 more]</label></div><br/><div class="children"><div class="content">Essentially, generally, no.<p>Once you&#x27;ve discovered a security hole, exploiting it to see how much access you can get is generally frowned upon.</div><br/><div id="38995829" class="c"><input type="checkbox" id="c-38995829" checked=""/><div class="controls bullet"><span class="by">Twirrim</span><span>|</span><a href="#38992657">root</a><span>|</span><a href="#38994347">parent</a><span>|</span><a href="#38992741">next</a><span>|</span><label class="collapse" for="c-38995829">[-]</label><label class="expand" for="c-38995829">[1 more]</label></div><br/><div class="children"><div class="content">I know Marcus, the guy they mention that first caught the problem.  He had no end of trouble getting Meta to acknowledge the severity of what he&#x27;d found, and they just constantly went radio silence on him, in between not really understanding the problem.<p>I ended up having to reach out to someone senior I knew in the security org there to get them to swoop in and pick up the report, before it got any actual traction (I&#x27;d worked with that senior security engineer in a previous job).</div><br/></div></div></div></div><div id="38992741" class="c"><input type="checkbox" id="c-38992741" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#38992657">parent</a><span>|</span><a href="#38994347">prev</a><span>|</span><a href="#38994090">next</a><span>|</span><label class="collapse" for="c-38992741">[-]</label><label class="expand" for="c-38992741">[3 more]</label></div><br/><div class="children"><div class="content">It depends on the company. Many companies have bug bounty or vulnerability disclosure programs that explicitly guarantee safe harbor+protections for researchers.<p>However, not all organizations
are happy to be contacted about security issues. Sometimes doing the right thing can still result in (threats of) legal repercussions.<p><a href="https:&#x2F;&#x2F;arstechnica.com&#x2F;tech-policy&#x2F;2021&#x2F;10&#x2F;missouri-gov-calls-journalist-who-found-security-flaw-a-hacker-threatens-to-sue&#x2F;" rel="nofollow">https:&#x2F;&#x2F;arstechnica.com&#x2F;tech-policy&#x2F;2021&#x2F;10&#x2F;missouri-gov-cal...</a></div><br/><div id="38993280" class="c"><input type="checkbox" id="c-38993280" checked=""/><div class="controls bullet"><span class="by">azeemba</span><span>|</span><a href="#38992657">root</a><span>|</span><a href="#38992741">parent</a><span>|</span><a href="#38994090">next</a><span>|</span><label class="collapse" for="c-38993280">[-]</label><label class="expand" for="c-38993280">[2 more]</label></div><br/><div class="children"><div class="content">The bug bounties are usually pretty clear that you aren&#x27;t allowed to make changes in the production systems. Here they made many changes - including changing the name of a release.<p>The bug bounties also prefer seeing a working attack instead of theoretical reports. So not sure how they could have tested their attack in this situation without making actual changes.</div><br/><div id="38994034" class="c"><input type="checkbox" id="c-38994034" checked=""/><div class="controls bullet"><span class="by">richbell</span><span>|</span><a href="#38992657">root</a><span>|</span><a href="#38993280">parent</a><span>|</span><a href="#38994090">next</a><span>|</span><label class="collapse" for="c-38994034">[-]</label><label class="expand" for="c-38994034">[1 more]</label></div><br/><div class="children"><div class="content">It depends. Sometimes companies only permit testing in specific test domains, other times they permit it as long as your activity is clearly identifiable (e.g., including a custom header in all request).<p>It does seem like walking a precarious tight rope.</div><br/></div></div></div></div></div></div></div></div><div id="38994090" class="c"><input type="checkbox" id="c-38994090" checked=""/><div class="controls bullet"><span class="by">Klasiaster</span><span>|</span><a href="#38992657">prev</a><span>|</span><a href="#38992564">next</a><span>|</span><label class="collapse" for="c-38994090">[-]</label><label class="expand" for="c-38994090">[1 more]</label></div><br/><div class="children"><div class="content">With GARM (GitHub Actions Runner Manager) it&#x27;s easy to manage ephemeral runners: <a href="https:&#x2F;&#x2F;github.com&#x2F;cloudbase&#x2F;garm">https:&#x2F;&#x2F;github.com&#x2F;cloudbase&#x2F;garm</a><p>One should also use workflow approvals for external contributors.</div><br/></div></div><div id="38992564" class="c"><input type="checkbox" id="c-38992564" checked=""/><div class="controls bullet"><span class="by">dontupvoteme</span><span>|</span><a href="#38994090">prev</a><span>|</span><a href="#38997094">next</a><span>|</span><label class="collapse" for="c-38992564">[-]</label><label class="expand" for="c-38992564">[6 more]</label></div><br/><div class="children"><div class="content">I know that it is zeitgeist exploiting to say this, but seeing Boeing listed and not Airbus really says something to me.<p>Lockheed being listed makes me wonder if the FBI&#x2F;CIA really will (further) step up on cybercrime, because you now  have potential national security implications in a core supplier to multiple military branches.</div><br/><div id="38992776" class="c"><input type="checkbox" id="c-38992776" checked=""/><div class="controls bullet"><span class="by">Havoc</span><span>|</span><a href="#38992564">parent</a><span>|</span><a href="#38997094">next</a><span>|</span><label class="collapse" for="c-38992776">[-]</label><label class="expand" for="c-38992776">[5 more]</label></div><br/><div class="children"><div class="content">Boeing is a lot more into military tech than airbus</div><br/><div id="38993171" class="c"><input type="checkbox" id="c-38993171" checked=""/><div class="controls bullet"><span class="by">dralley</span><span>|</span><a href="#38992564">root</a><span>|</span><a href="#38992776">parent</a><span>|</span><a href="#38993256">next</a><span>|</span><label class="collapse" for="c-38993171">[-]</label><label class="expand" for="c-38993171">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s not entirely true, Airbus is a participant in most European military aircraft projects.  They participated in Eurofighter for example and are part of the FCAS program.<p>It&#x27;s true to the extent that the US does a lot more and broader military procurement in general, so Boeing gets a smaller piece of a much bigger pie.  Wheras Airbus is getting a piece of most European projects as a member of one consortium or another, it&#x27;s just a smaller pie.</div><br/></div></div><div id="38993256" class="c"><input type="checkbox" id="c-38993256" checked=""/><div class="controls bullet"><span class="by">shakow</span><span>|</span><a href="#38992564">root</a><span>|</span><a href="#38992776">parent</a><span>|</span><a href="#38993171">prev</a><span>|</span><a href="#38993254">next</a><span>|</span><label class="collapse" for="c-38993256">[-]</label><label class="expand" for="c-38993256">[1 more]</label></div><br/><div class="children"><div class="content">Are they? Airbus has its hands in quite a few major military programs (Eurofighter, A-400M, Tigre, Super-Puma, ...), as well as in spatial programs, especially satellite intelligence.</div><br/></div></div><div id="38993254" class="c"><input type="checkbox" id="c-38993254" checked=""/><div class="controls bullet"><span class="by">mshockwave</span><span>|</span><a href="#38992564">root</a><span>|</span><a href="#38992776">parent</a><span>|</span><a href="#38993256">prev</a><span>|</span><a href="#38997094">next</a><span>|</span><label class="collapse" for="c-38993254">[-]</label><label class="expand" for="c-38993254">[2 more]</label></div><br/><div class="children"><div class="content">compare to Boeing&#x27;s volume? maybe, but Airbus is one of _Europe_&#x27;s largest defense contractors</div><br/><div id="38993974" class="c"><input type="checkbox" id="c-38993974" checked=""/><div class="controls bullet"><span class="by">robertlagrant</span><span>|</span><a href="#38992564">root</a><span>|</span><a href="#38993254">parent</a><span>|</span><a href="#38997094">next</a><span>|</span><label class="collapse" for="c-38993974">[-]</label><label class="expand" for="c-38993974">[1 more]</label></div><br/><div class="children"><div class="content">Well, it does have quite a lot of European state ownership. It would be very surprising if it didn&#x27;t win a lot of European contracts.</div><br/></div></div></div></div></div></div></div></div><div id="38997094" class="c"><input type="checkbox" id="c-38997094" checked=""/><div class="controls bullet"><span class="by">apesternikov</span><span>|</span><a href="#38992564">prev</a><span>|</span><a href="#38992531">next</a><span>|</span><label class="collapse" for="c-38997094">[-]</label><label class="expand" for="c-38997094">[1 more]</label></div><br/><div class="children"><div class="content">shameless plug: there are ways to run custom sized runner without risks associated with self hosted runners. fasterci.com ephemeral runners is one of them.</div><br/></div></div><div id="38992531" class="c"><input type="checkbox" id="c-38992531" checked=""/><div class="controls bullet"><span class="by">davnn</span><span>|</span><a href="#38997094">prev</a><span>|</span><a href="#38995218">next</a><span>|</span><label class="collapse" for="c-38992531">[-]</label><label class="expand" for="c-38992531">[15 more]</label></div><br/><div class="children"><div class="content">Is 5k an appropriate amount for such a finding? Sounds incredibly cheap for such a large organization. How much would something like this be worth on the black market?</div><br/><div id="38992669" class="c"><input type="checkbox" id="c-38992669" checked=""/><div class="controls bullet"><span class="by">wslh</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38992823">next</a><span>|</span><label class="collapse" for="c-38992669">[-]</label><label class="expand" for="c-38992669">[1 more]</label></div><br/><div class="children"><div class="content">No, that is in general the issue with security bounties. They attract mainly people who have enough time for trial and error and&#x2F;or prior domain expertise and&#x2F;or extremely smart in specific software. Nowadays cybersecurity is a vast field and it is not the same to be a white hat hacker specialized in Google Chrome issues than one in iOS. Not saying it cannot be the same person but the amount of time required to catch issues is long.<p>I think supply chain attacks are not being taken very seriously. Think that people working, for example, in Python or JavaScript use pip or npm daily no matter if they work for a nuclear agency or your uncle&#x27;s bar.</div><br/></div></div><div id="38992823" class="c"><input type="checkbox" id="c-38992823" checked=""/><div class="controls bullet"><span class="by">mardifoufs</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38992669">prev</a><span>|</span><a href="#38993430">next</a><span>|</span><label class="collapse" for="c-38992823">[-]</label><label class="expand" for="c-38992823">[2 more]</label></div><br/><div class="children"><div class="content">In an earlier article about the exploitation of GitHub actions in general (which this specific attack on pytorch is part of) they said:<p>&gt;So far, we’ve submitted over 20 bug bounty reports, raking in hundreds of thousands of dollars in bounties.<p>So I think this is part of a chain of bounties? Though that can still be argued to be a bit too low for how powerful this exploit could be :)</div><br/><div id="38992880" class="c"><input type="checkbox" id="c-38992880" checked=""/><div class="controls bullet"><span class="by">nightpool</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38992823">parent</a><span>|</span><a href="#38993430">next</a><span>|</span><label class="collapse" for="c-38992880">[-]</label><label class="expand" for="c-38992880">[1 more]</label></div><br/><div class="children"><div class="content">Those are from different organizations, I think. So 5k from pytorch only but more from other orgs</div><br/></div></div></div></div><div id="38993430" class="c"><input type="checkbox" id="c-38993430" checked=""/><div class="controls bullet"><span class="by">sp332</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38992823">prev</a><span>|</span><a href="#38993099">next</a><span>|</span><label class="collapse" for="c-38993430">[-]</label><label class="expand" for="c-38993430">[1 more]</label></div><br/><div class="children"><div class="content">Bug bounties do not compete with the black market. Also on the business side, they are not as efficient as just paying an internal QA or security team. Katie Mousouris, who set up Microsoft&#x27;s original bug bounty program has gone into a lot of detail on this. E.g. <a href="https:&#x2F;&#x2F;www.zdnet.com&#x2F;article&#x2F;relying-on-bug-bounties-not-appropriate-risk-management-katie-moussouris&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.zdnet.com&#x2F;article&#x2F;relying-on-bug-bounties-not-ap...</a></div><br/></div></div><div id="38993099" class="c"><input type="checkbox" id="c-38993099" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38993430">prev</a><span>|</span><a href="#38992910">next</a><span>|</span><label class="collapse" for="c-38993099">[-]</label><label class="expand" for="c-38993099">[6 more]</label></div><br/><div class="children"><div class="content">This question comes of up frequently with these and it&#x27;s premised on the hypothetical value of the bug on &#x27;the black market&#x27;. The vast majority of such reported vulnerabilities have a &#x27;black market&#x27; value of roughly zero, though, including this one. This doesn&#x27;t say anything about the quality of the research, just that it&#x27;s pretty hard to get monetary or other value out of most vulnerabilities.</div><br/><div id="38993283" class="c"><input type="checkbox" id="c-38993283" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38993099">parent</a><span>|</span><a href="#38992910">next</a><span>|</span><label class="collapse" for="c-38993283">[-]</label><label class="expand" for="c-38993283">[5 more]</label></div><br/><div class="children"><div class="content">It’s quite a bit more nuanced than that. Businesses only want to pay because it costs less than the damage done to the brand and&#x2F;or lawsuits from users&#x2F;data controllers. They don’t want to pay more than that. Researchers need money and are able to sell the fruits of their research to whomever they want. Generally, good-natured people will especially see if the bounty is worth it. It’s clean money, so it has additional value vs. selling it on the black market.<p>So, as you can hopefully see, it is a balancing act between all parties.</div><br/><div id="38993541" class="c"><input type="checkbox" id="c-38993541" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38993283">parent</a><span>|</span><a href="#38992910">next</a><span>|</span><label class="collapse" for="c-38993541">[-]</label><label class="expand" for="c-38993541">[4 more]</label></div><br/><div class="children"><div class="content">No, I don&#x27;t think that holds much explanatory power - the vast majority of vulns have not only zero black market value, they also carry effectively zero brand or legal liability risk. This is also the  case for this vuln.</div><br/><div id="38993822" class="c"><input type="checkbox" id="c-38993822" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38993541">parent</a><span>|</span><a href="#38992910">next</a><span>|</span><label class="collapse" for="c-38993822">[-]</label><label class="expand" for="c-38993822">[3 more]</label></div><br/><div class="children"><div class="content">Generally, getting root on internal infrastructure is just a step away from doing whatever you want. Even if it is just waiting for someone to ssh in with -A set so they can steal your ash keys.</div><br/><div id="38997642" class="c"><input type="checkbox" id="c-38997642" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38993822">parent</a><span>|</span><a href="#38994787">next</a><span>|</span><label class="collapse" for="c-38997642">[-]</label><label class="expand" for="c-38997642">[1 more]</label></div><br/><div class="children"><div class="content">A good rule of thumb is that if an exploit doesn&#x27;t drop pin-compatibly into a pre-existing business model that has repeatedly used similar exploits in the past, it&#x27;s worth nothing in a &quot;commoditized&quot; vulnerability market --- the kind HN tends to think of in these stories (&quot;Zerodium&quot; being the most common example). You can theoretically find someone who will listen to your story and give you money, but at that point you aren&#x27;t so much selling a vulnerability as helping plan a heist.<p>I could be wrong about this, but I&#x27;ve been loud about it around people who do a lot of this stuff and none of them have dunked on me in public. :)</div><br/></div></div><div id="38994787" class="c"><input type="checkbox" id="c-38994787" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38993822">parent</a><span>|</span><a href="#38997642">prev</a><span>|</span><a href="#38992910">next</a><span>|</span><label class="collapse" for="c-38994787">[-]</label><label class="expand" for="c-38994787">[1 more]</label></div><br/><div class="children"><div class="content">Yes that is exactly the sort of thing that has zero non-bounty dollar value and next to no legal or brand risk.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38992910" class="c"><input type="checkbox" id="c-38992910" checked=""/><div class="controls bullet"><span class="by">1B05H1N</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38993099">prev</a><span>|</span><a href="#38992597">next</a><span>|</span><label class="collapse" for="c-38992910">[-]</label><label class="expand" for="c-38992910">[1 more]</label></div><br/><div class="children"><div class="content">Maybe 5k is the max payout for the bug class?</div><br/></div></div><div id="38992597" class="c"><input type="checkbox" id="c-38992597" checked=""/><div class="controls bullet"><span class="by">vicktorium</span><span>|</span><a href="#38992531">parent</a><span>|</span><a href="#38992910">prev</a><span>|</span><a href="#38992993">next</a><span>|</span><label class="collapse" for="c-38992597">[-]</label><label class="expand" for="c-38992597">[2 more]</label></div><br/><div class="children"><div class="content">you have to consider that in the black market the rates would absorb the illegality of the action. while 5k is &#x27;clean&#x27;</div><br/><div id="38992638" class="c"><input type="checkbox" id="c-38992638" checked=""/><div class="controls bullet"><span class="by">ZoomerCretin</span><span>|</span><a href="#38992531">root</a><span>|</span><a href="#38992597">parent</a><span>|</span><a href="#38992993">next</a><span>|</span><label class="collapse" for="c-38992638">[-]</label><label class="expand" for="c-38992638">[1 more]</label></div><br/><div class="children"><div class="content">Monero is always clean, too.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>