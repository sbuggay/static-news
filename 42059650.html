<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1731142866730" as="style"/><link rel="stylesheet" href="styles.css?v=1731142866730"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://blog.appsignal.com/2024/10/30/optimize-database-performance-in-ruby-on-rails-and-activerecord.html">Optimize Database Performance in Ruby on Rails and ActiveRecord</a> <span class="domain">(<a href="https://blog.appsignal.com">blog.appsignal.com</a>)</span></div><div class="subtext"><span>amalinovic</span> | <span>10 comments</span></div><br/><div><div id="42093041" class="c"><input type="checkbox" id="c-42093041" checked=""/><div class="controls bullet"><span class="by">bdcravens</span><span>|</span><a href="#42093155">next</a><span>|</span><label class="collapse" for="c-42093041">[-]</label><label class="expand" for="c-42093041">[3 more]</label></div><br/><div class="children"><div class="content">Another approach are materialized views, where you basically create a caching table with exactly the fields you need. Can be used for any query, but particularly valuable for rich reporting where you may be pulling data from all over your associations. It requires you to write the source query in raw SQL, but with the Scenic gem, pulls it into the Active Record ecosystem with models, migrations, etc.</div><br/><div id="42093292" class="c"><input type="checkbox" id="c-42093292" checked=""/><div class="controls bullet"><span class="by">Lio</span><span>|</span><a href="#42093041">parent</a><span>|</span><a href="#42093155">next</a><span>|</span><label class="collapse" for="c-42093292">[-]</label><label class="expand" for="c-42093292">[2 more]</label></div><br/><div class="children"><div class="content">I try to avoid materialized views when I can due to the problem of keeping them up to date.<p>If I see a materialized view I’d definitely go back to see if I could eke out any other optimisation in a straight view rather than use it.<p>With regard to Scenic, I like the way it separates out SQL but I’ve always found how it versions view files with an iteration in the file name a pain.<p>I wish it had the option to just pick up changes in the source file without needing a migration to bump that version number.<p>On larger projects it’s easy to run into version number clashes in different pull requests.</div><br/><div id="42093326" class="c"><input type="checkbox" id="c-42093326" checked=""/><div class="controls bullet"><span class="by">nesarkvechnep</span><span>|</span><a href="#42093041">root</a><span>|</span><a href="#42093292">parent</a><span>|</span><a href="#42093155">next</a><span>|</span><label class="collapse" for="c-42093326">[-]</label><label class="expand" for="c-42093326">[1 more]</label></div><br/><div class="children"><div class="content">You can have multiple small materialised views, which get updated when appropriate and are composed by a regular view. It’s more convenient than a single large materialised view.</div><br/></div></div></div></div></div></div><div id="42093155" class="c"><input type="checkbox" id="c-42093155" checked=""/><div class="controls bullet"><span class="by">mobilemidget</span><span>|</span><a href="#42093041">prev</a><span>|</span><a href="#42093266">next</a><span>|</span><label class="collapse" for="c-42093155">[-]</label><label class="expand" for="c-42093155">[3 more]</label></div><br/><div class="children"><div class="content">I have seen many projects where people use activerecord for their SQL interfacing. It is only the really simple queries that are okay, but as soon as there is some complexity the generated sql query are not so good quality to put it politely. Imho raw sql is always best, build your own query generator which you understand its logic fully and is tailored for your project.</div><br/><div id="42093238" class="c"><input type="checkbox" id="c-42093238" checked=""/><div class="controls bullet"><span class="by">Lio</span><span>|</span><a href="#42093155">parent</a><span>|</span><a href="#42093232">next</a><span>|</span><label class="collapse" for="c-42093238">[-]</label><label class="expand" for="c-42093238">[1 more]</label></div><br/><div class="children"><div class="content">I think I disagree with this.<p>Not about using raw SQL when needed. I would definitely do that for a hot, complex query if I felt I needed to but I think ActiveRecord is a rock solid if you know how to use it and how to examine its output.<p>There are times where an ORM is a very useful tool and I&#x27;ve found ActiveRecord to be better than most home made query generators I’ve run into regardless of base language.</div><br/></div></div><div id="42093232" class="c"><input type="checkbox" id="c-42093232" checked=""/><div class="controls bullet"><span class="by">matthewmacleod</span><span>|</span><a href="#42093155">parent</a><span>|</span><a href="#42093238">prev</a><span>|</span><a href="#42093266">next</a><span>|</span><label class="collapse" for="c-42093232">[-]</label><label class="expand" for="c-42093232">[1 more]</label></div><br/><div class="children"><div class="content">Absolutely not the case, in my experience.<p>Like any advanced tool, it’s possible to shoot yourself in the foot if you don’t use it correctly. But once you know it, it makes simple queries easy, complex queries tolerable, and allows progressively dropping to raw SQL if needed.<p>I’d go even further and say ActiveRecord (particularly when using Arel for complex query construction) is the single best ORM I’ve ever used. I miss it hard whenever I interact with an SQL database in any other language.</div><br/></div></div></div></div><div id="42093266" class="c"><input type="checkbox" id="c-42093266" checked=""/><div class="controls bullet"><span class="by">echelon</span><span>|</span><a href="#42093155">prev</a><span>|</span><label class="collapse" for="c-42093266">[-]</label><label class="expand" for="c-42093266">[3 more]</label></div><br/><div class="children"><div class="content">Are people using Rails for new startups?<p>It feels like I haven&#x27;t heard anything new about Rails for the past five years, but suddenly in the last few weeks it&#x27;s been a trending topic on HN.</div><br/><div id="42093323" class="c"><input type="checkbox" id="c-42093323" checked=""/><div class="controls bullet"><span class="by">chikere232</span><span>|</span><a href="#42093266">parent</a><span>|</span><a href="#42093324">next</a><span>|</span><label class="collapse" for="c-42093323">[-]</label><label class="expand" for="c-42093323">[1 more]</label></div><br/><div class="children"><div class="content">People have forgotten how horribly it failed last time</div><br/></div></div><div id="42093324" class="c"><input type="checkbox" id="c-42093324" checked=""/><div class="controls bullet"><span class="by">Lio</span><span>|</span><a href="#42093266">parent</a><span>|</span><a href="#42093323">prev</a><span>|</span><label class="collapse" for="c-42093324">[-]</label><label class="expand" for="c-42093324">[1 more]</label></div><br/><div class="children"><div class="content">Yeah seems like it. I’m still working with startups using Rails.<p>The changes coming with Rails 8 are really good for small teams working to tight budgets.<p>The new deployment strategy is amazing compared to some of the complex react, micro services, k8s and cloud stacks I’ve worked with.<p>They always involve a lot of engineering effort and a lot of expensive proprietary services.<p>If you want to get off the ground quick for little money a Rails monolith with the frontend using Hotwire still looks very hard to beat.</div><br/></div></div></div></div></div></div></div></div></div></body></html>