<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717664465038" as="style"/><link rel="stylesheet" href="styles.css?v=1717664465038"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://mkukri.xyz/2024/06/01/tpm-gpio-fail.html">TPM GPIO fail: How bad OEM firmware ruins Intel TPM security</a>Â <span class="domain">(<a href="https://mkukri.xyz">mkukri.xyz</a>)</span></div><div class="subtext"><span>osks</span> | <span>16 comments</span></div><br/><div><div id="40594663" class="c"><input type="checkbox" id="c-40594663" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><label class="collapse" for="c-40594663">[-]</label><label class="expand" for="c-40594663">[15 more]</label></div><br/><div class="children"><div class="content"><i>&gt; If attacker have physical access, the discrete TPM is an attack surface anyway and even a known attack already.</i><p>If you&#x27;re wondering what they mean by this, [1] has been around since 2018. It&#x27;s not unusual for a motherboard to put the TPM on a removable module, so you don&#x27;t even have to desolder the chip to MITM the communications.<p>The most recent Intel and AMD CPUs have &quot;firmware TPMs&quot; that run in the CPU&#x27;s so-called &quot;trusted execution environment&quot; so there&#x27;s no I2C to interpose. Of course, that doesn&#x27;t mean you&#x27;re protected against attackers who have physical access to the machine; they can simply install a keylogger.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;nccgroup&#x2F;TPMGenie">https:&#x2F;&#x2F;github.com&#x2F;nccgroup&#x2F;TPMGenie</a></div><br/><div id="40594818" class="c"><input type="checkbox" id="c-40594818" checked=""/><div class="controls bullet"><span class="by">p_l</span><span>|</span><a href="#40594663">parent</a><span>|</span><a href="#40595087">next</a><span>|</span><label class="collapse" for="c-40594818">[-]</label><label class="expand" for="c-40594818">[2 more]</label></div><br/><div class="children"><div class="content">Funnily enough, in TPM 2.0 there&#x27;s way around MITM attacks like that - you can establish encrypted connection between TPM and CPU, which outside first-time configuration (which should happen in controlled environment anyway) should provide reasonable roadblock to successful MITM attack.<p>But CPU-side software needs to use it, and without default well-known keys...</div><br/><div id="40594989" class="c"><input type="checkbox" id="c-40594989" checked=""/><div class="controls bullet"><span class="by">SSLy</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594818">parent</a><span>|</span><a href="#40595087">next</a><span>|</span><label class="collapse" for="c-40594989">[-]</label><label class="expand" for="c-40594989">[1 more]</label></div><br/><div class="children"><div class="content">vast majority of fTPM 2.0&#x27;s are chips placed on the CPU die anyway</div><br/></div></div></div></div><div id="40595087" class="c"><input type="checkbox" id="c-40595087" checked=""/><div class="controls bullet"><span class="by">Foxboron</span><span>|</span><a href="#40594663">parent</a><span>|</span><a href="#40594818">prev</a><span>|</span><a href="#40594827">next</a><span>|</span><label class="collapse" for="c-40595087">[-]</label><label class="expand" for="c-40595087">[1 more]</label></div><br/><div class="children"><div class="content">BUS interposers are trivially defeated with encrypted sessions and a PIN.<p>Bitlocker is traditionally the implementation susceptible for this attack, but for that I&#x27;ll just defer to Chris Fenner.<p><a href="https:&#x2F;&#x2F;www.dlp.rip&#x2F;tpm-genie" rel="nofollow">https:&#x2F;&#x2F;www.dlp.rip&#x2F;tpm-genie</a></div><br/></div></div><div id="40594827" class="c"><input type="checkbox" id="c-40594827" checked=""/><div class="controls bullet"><span class="by">izacus</span><span>|</span><a href="#40594663">parent</a><span>|</span><a href="#40595087">prev</a><span>|</span><label class="collapse" for="c-40594827">[-]</label><label class="expand" for="c-40594827">[11 more]</label></div><br/><div class="children"><div class="content">&gt; Of course, that doesn&#x27;t mean you&#x27;re protected against attackers who have physical access to the machine; they can simply install a keylogger.<p>How would that attack work if someone stole my Ryzen powered laptop with full disk encryption, TPM2.0 and secure boot with firmware password enabled?</div><br/><div id="40595119" class="c"><input type="checkbox" id="c-40595119" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594827">parent</a><span>|</span><a href="#40594897">next</a><span>|</span><label class="collapse" for="c-40595119">[-]</label><label class="expand" for="c-40595119">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d buy you an replacement laptop of the same model and then install a rendering of your boot process and password prompt on it. Doing a switcheroo and waiting in my bunker until the fake sends me the password you entered.<p>The screen&#x2F;keyboard is not authenticated to the user, and TPM is not capable of fixing that.<p>It doesn&#x27;t require some state actor to do that. Just money.</div><br/></div></div><div id="40594897" class="c"><input type="checkbox" id="c-40594897" checked=""/><div class="controls bullet"><span class="by">wooosh</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594827">parent</a><span>|</span><a href="#40595119">prev</a><span>|</span><a href="#40594941">next</a><span>|</span><label class="collapse" for="c-40594897">[-]</label><label class="expand" for="c-40594897">[4 more]</label></div><br/><div class="children"><div class="content">Probably not the most practical attack, but it is very possible to MITM the connection between the keyboard itself and the motherboard.</div><br/><div id="40595116" class="c"><input type="checkbox" id="c-40595116" checked=""/><div class="controls bullet"><span class="by">Foxboron</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594897">parent</a><span>|</span><a href="#40594983">next</a><span>|</span><label class="collapse" for="c-40595116">[-]</label><label class="expand" for="c-40595116">[1 more]</label></div><br/><div class="children"><div class="content">Glitter nailpolish on your machine seams&#x2F;screws and tamper detection. Keyboard sniffing is not as trivial as people make it out to be.</div><br/></div></div><div id="40594983" class="c"><input type="checkbox" id="c-40594983" checked=""/><div class="controls bullet"><span class="by">izacus</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594897">parent</a><span>|</span><a href="#40595116">prev</a><span>|</span><a href="#40594941">next</a><span>|</span><label class="collapse" for="c-40594983">[-]</label><label class="expand" for="c-40594983">[2 more]</label></div><br/><div class="children"><div class="content">And then return me my laptop and steal it again?</div><br/><div id="40595132" class="c"><input type="checkbox" id="c-40595132" checked=""/><div class="controls bullet"><span class="by">rwmj</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594983">parent</a><span>|</span><a href="#40594941">next</a><span>|</span><label class="collapse" for="c-40595132">[-]</label><label class="expand" for="c-40595132">[1 more]</label></div><br/><div class="children"><div class="content">Bluetooth keyloggers are a thing.  The attacker would need to be nearby.</div><br/></div></div></div></div></div></div><div id="40594941" class="c"><input type="checkbox" id="c-40594941" checked=""/><div class="controls bullet"><span class="by">fellerts</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594827">parent</a><span>|</span><a href="#40594897">prev</a><span>|</span><a href="#40594883">next</a><span>|</span><label class="collapse" for="c-40594941">[-]</label><label class="expand" for="c-40594941">[3 more]</label></div><br/><div class="children"><div class="content">I doubt your physical keyboard&#x27;s connection to the motherboard is encrypted (I&#x27;d guess USB, I2C or maybe even PS&#x2F;2 internally). I would also not be surprised if you can get small in-line sniffers that an attacker, with physical access for half an hour, could hide in your laptop.<p>All bets are off if your attacker is determined and has physical access.</div><br/><div id="40594974" class="c"><input type="checkbox" id="c-40594974" checked=""/><div class="controls bullet"><span class="by">atoav</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594941">parent</a><span>|</span><a href="#40594956">next</a><span>|</span><label class="collapse" for="c-40594974">[-]</label><label class="expand" for="c-40594974">[1 more]</label></div><br/><div class="children"><div class="content">There have been papers about extracting key presses from acceleration sensors of a phone, or from the sounds of key clicking by statistical inference what feels like a decade ago. You probably don&#x27;t even need to touch the laptop to do that.</div><br/></div></div><div id="40594956" class="c"><input type="checkbox" id="c-40594956" checked=""/><div class="controls bullet"><span class="by">izacus</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594941">parent</a><span>|</span><a href="#40594974">prev</a><span>|</span><a href="#40594883">next</a><span>|</span><label class="collapse" for="c-40594956">[-]</label><label class="expand" for="c-40594956">[1 more]</label></div><br/><div class="children"><div class="content">I mean, I wouldn&#x27;t be there to type in my password because the laptop was stolen.</div><br/></div></div></div></div><div id="40594883" class="c"><input type="checkbox" id="c-40594883" checked=""/><div class="controls bullet"><span class="by">user_7832</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594827">parent</a><span>|</span><a href="#40594941">prev</a><span>|</span><label class="collapse" for="c-40594883">[-]</label><label class="expand" for="c-40594883">[2 more]</label></div><br/><div class="children"><div class="content">There might be hardware &quot;solutions&quot; to that problem.</div><br/><div id="40595005" class="c"><input type="checkbox" id="c-40595005" checked=""/><div class="controls bullet"><span class="by">contingencies</span><span>|</span><a href="#40594663">root</a><span>|</span><a href="#40594883">parent</a><span>|</span><label class="collapse" for="c-40595005">[-]</label><label class="expand" for="c-40595005">[1 more]</label></div><br/><div class="children"><div class="content">I believe <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;538&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;538&#x2F;</a> is the comic you&#x27;re looking for.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>