<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1738659674228" as="style"/><link rel="stylesheet" href="styles.css?v=1738659674228"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/google/security-research/security/advisories/GHSA-4xq7-4mgh-gp6w">AMD: Microcode Signature Verification Vulnerability</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>94 comments</span></div><br/><div><div id="42921591" class="c"><input type="checkbox" id="c-42921591" checked=""/><div class="controls bullet"><span class="by">wrs</span><span>|</span><a href="#42927702">next</a><span>|</span><label class="collapse" for="c-42921591">[-]</label><label class="expand" for="c-42921591">[29 more]</label></div><br/><div class="children"><div class="content">&quot;A test payload for Milan and Genoa CPUs that makes the RDRAND instruction return 4&quot;... Turns out kernel RNG belt-and-suspenders was justified?</div><br/><div id="42922079" class="c"><input type="checkbox" id="c-42922079" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42921591">parent</a><span>|</span><a href="#42923382">next</a><span>|</span><label class="collapse" for="c-42922079">[-]</label><label class="expand" for="c-42922079">[15 more]</label></div><br/><div class="children"><div class="content">&quot;in theory&quot; Linux, at least, was supposed to use rdrand&#x27;s output as _one_ source of entropy, not _the only_ source.<p>No idea what Windows et al do for this, or if that&#x27;s still true, but I believe the above description was how the argument was originally ended.<p>Also, tbh, if you can patch arbitrary instruction behavior, just replacing rdrand seems like far too ham fisted a tool with the level of versatility in your hands...</div><br/><div id="42922314" class="c"><input type="checkbox" id="c-42922314" checked=""/><div class="controls bullet"><span class="by">Tuna-Fish</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922079">parent</a><span>|</span><a href="#42922335">next</a><span>|</span><label class="collapse" for="c-42922314">[-]</label><label class="expand" for="c-42922314">[8 more]</label></div><br/><div class="children"><div class="content">Linux&#x27;s rdrand use is proof against it returning bad output, but is not proof against malicious microcode. Reason for this is that the malicious microcode can examine register contents and alter the value it&#x27;s returning so that mixing it into the previous source of randomness produces the desired evil value.</div><br/><div id="42922398" class="c"><input type="checkbox" id="c-42922398" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922314">parent</a><span>|</span><a href="#42925180">next</a><span>|</span><label class="collapse" for="c-42922398">[-]</label><label class="expand" for="c-42922398">[6 more]</label></div><br/><div class="children"><div class="content">Sure, but as stated, if you don&#x27;t trust the CPU at all, rdrand becomes the least of your concerns.</div><br/><div id="42923294" class="c"><input type="checkbox" id="c-42923294" checked=""/><div class="controls bullet"><span class="by">Tuna-Fish</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922398">parent</a><span>|</span><a href="#42924778">next</a><span>|</span><label class="collapse" for="c-42923294">[-]</label><label class="expand" for="c-42923294">[4 more]</label></div><br/><div class="children"><div class="content">The thing is, all the other ways you can compromise the kernel from microcode are at least theoretically detectable. A security researcher could study how the cpu operates and find the exploit. If RDRAND is surreptitiously replacing all your random numbers with AES of the current time, you cannot find that out from observing behavior.<p>I agree that worrying about RDRAND shouldn&#x27;t probably be on the top of anyone&#x27;s priorities, but there is some cause to at least use it defensively, for example using it to pre-fill buffers with random values in a different context, so that subversion would in the very least require memory references, instead of running RDRAND in the context of your RNG.</div><br/><div id="42927707" class="c"><input type="checkbox" id="c-42927707" checked=""/><div class="controls bullet"><span class="by">wtallis</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42923294">parent</a><span>|</span><a href="#42924723">next</a><span>|</span><label class="collapse" for="c-42927707">[-]</label><label class="expand" for="c-42927707">[1 more]</label></div><br/><div class="children"><div class="content">I think you may be overestimating the scale of attack that can be accomplished within the constraints of a microcode update. Given that the CPU has to still <i>seem</i> to be operating normally while using malicious microcode, how much space out of the few kilobytes of a microcode update file is really available for implementing a subtle attack, complete with monitoring the state of the larger system to detect a trigger condition or locate specific information (such as the timestamp you mention)? Sure, malicious microcode <i>theoretically</i> has access to basically everything, but the severely limited payload makes it a lot harder to pull off complicated attacks.</div><br/></div></div><div id="42924723" class="c"><input type="checkbox" id="c-42924723" checked=""/><div class="controls bullet"><span class="by">Muromec</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42923294">parent</a><span>|</span><a href="#42927707">prev</a><span>|</span><a href="#42924778">next</a><span>|</span><label class="collapse" for="c-42924723">[-]</label><label class="expand" for="c-42924723">[2 more]</label></div><br/><div class="children"><div class="content">&gt; If RDRAND is surreptitiously replacing all your random numbers with AES of the current time, you cannot find that out from observing behavior.<p>Should you not see it from timing alone being wrong?</div><br/><div id="42925324" class="c"><input type="checkbox" id="c-42925324" checked=""/><div class="controls bullet"><span class="by">usrusr</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42924723">parent</a><span>|</span><a href="#42924778">next</a><span>|</span><label class="collapse" for="c-42925324">[-]</label><label class="expand" for="c-42925324">[1 more]</label></div><br/><div class="children"><div class="content">Had the same thought. But then on the other hand, when nobody is looking at the timing, nobody will see anything. And those who do see a timing artifact, will they really dig deeper or will they just shrug off another oddity? I would not like to bet on another Clifford Stoll in this day and age.</div><br/></div></div></div></div></div></div><div id="42924778" class="c"><input type="checkbox" id="c-42924778" checked=""/><div class="controls bullet"><span class="by">mmh0000</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922398">parent</a><span>|</span><a href="#42923294">prev</a><span>|</span><a href="#42925180">next</a><span>|</span><label class="collapse" for="c-42924778">[-]</label><label class="expand" for="c-42924778">[1 more]</label></div><br/><div class="children"><div class="content">And, you shouldn&#x27;t trust your CPU!<p>* <a href="https:&#x2F;&#x2F;www.eff.org&#x2F;deeplinks&#x2F;2017&#x2F;05&#x2F;intels-management-engine-security-hazard-and-users-need-way-disable-it" rel="nofollow">https:&#x2F;&#x2F;www.eff.org&#x2F;deeplinks&#x2F;2017&#x2F;05&#x2F;intels-management-engi...</a><p>* <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Intel_Management_Engine" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Intel_Management_Engine</a><p>* <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;AMD_Platform_Security_Processor" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;AMD_Platform_Security_Processo...</a><p>* <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ARM_architecture_family#Security_extensions" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ARM_architecture_family#Securi...</a></div><br/></div></div></div></div><div id="42925180" class="c"><input type="checkbox" id="c-42925180" checked=""/><div class="controls bullet"><span class="by">jstasiak</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922314">parent</a><span>|</span><a href="#42922398">prev</a><span>|</span><a href="#42922335">next</a><span>|</span><label class="collapse" for="c-42925180">[-]</label><label class="expand" for="c-42925180">[1 more]</label></div><br/><div class="children"><div class="content">An article mentioning this kind of attack: <a href="https:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140205-entropy.html" rel="nofollow">https:&#x2F;&#x2F;blog.cr.yp.to&#x2F;20140205-entropy.html</a></div><br/></div></div></div></div><div id="42922335" class="c"><input type="checkbox" id="c-42922335" checked=""/><div class="controls bullet"><span class="by">wahern</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922079">parent</a><span>|</span><a href="#42922314">prev</a><span>|</span><a href="#42923127">next</a><span>|</span><label class="collapse" for="c-42922335">[-]</label><label class="expand" for="c-42922335">[2 more]</label></div><br/><div class="children"><div class="content">For organizations like the NSA, a simple hack like this is the opposite of ham-fisted, though presumably they&#x27;d try to ensure the output would pass common statistical tests. The utility in quietly breaking cryptographic protocols is presumably a major reason why it was chosen for the proof-of-concept.</div><br/><div id="42922414" class="c"><input type="checkbox" id="c-42922414" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922335">parent</a><span>|</span><a href="#42923127">next</a><span>|</span><label class="collapse" for="c-42922414">[-]</label><label class="expand" for="c-42922414">[1 more]</label></div><br/><div class="children"><div class="content">Sure, but that was my point, was that just overriding rdrand would be much more ham-fisted than any practical attack I would expect someone to weaponize this into outside of a PoC.</div><br/></div></div></div></div><div id="42923127" class="c"><input type="checkbox" id="c-42923127" checked=""/><div class="controls bullet"><span class="by">dist-epoch</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922079">parent</a><span>|</span><a href="#42922335">prev</a><span>|</span><a href="#42922349">next</a><span>|</span><label class="collapse" for="c-42923127">[-]</label><label class="expand" for="c-42923127">[1 more]</label></div><br/><div class="children"><div class="content">Windows collects hardware device entropy and mixes it into the pool.<p>It also persists the pool across reboots so it doesn&#x27;t start empty.</div><br/></div></div><div id="42922349" class="c"><input type="checkbox" id="c-42922349" checked=""/><div class="controls bullet"><span class="by">dooglius</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922079">parent</a><span>|</span><a href="#42923127">prev</a><span>|</span><a href="#42923382">next</a><span>|</span><label class="collapse" for="c-42922349">[-]</label><label class="expand" for="c-42922349">[3 more]</label></div><br/><div class="children"><div class="content">Intel&#x27;s theory I believe was that it could become the only source. The argument in favor I think is the same one you are making now: anything that could hack the chip deeply enough to break rdrand is powerful enough to achieve the same goals in another way.</div><br/><div id="42922493" class="c"><input type="checkbox" id="c-42922493" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922349">parent</a><span>|</span><a href="#42923382">next</a><span>|</span><label class="collapse" for="c-42922493">[-]</label><label class="expand" for="c-42922493">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m sure Intel loved that idea, given that I don&#x27;t think RDRAND showed up on AMD chips for 3 years after Intel launched support for it, and that would let them look much better on a number of benchmarks for that duration...</div><br/><div id="42924031" class="c"><input type="checkbox" id="c-42924031" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922493">parent</a><span>|</span><a href="#42923382">next</a><span>|</span><label class="collapse" for="c-42924031">[-]</label><label class="expand" for="c-42924031">[1 more]</label></div><br/><div class="children"><div class="content">I think you misunderstand where in the pipeline RDRAND would sit. It&#x27;s not a high-performance RNG, that instruction takes hundreds of cycles and generates a couple bytes of data. It&#x27;s used to derive keys for the actual CSPRNG providing e.g. &#x2F;dev&#x2F;urandom (which is basically a stream cipher). Having or not having RDRAND would have no performance impact on the CSPRNG.</div><br/></div></div></div></div></div></div></div></div><div id="42923382" class="c"><input type="checkbox" id="c-42923382" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#42921591">parent</a><span>|</span><a href="#42922079">prev</a><span>|</span><a href="#42922197">next</a><span>|</span><label class="collapse" for="c-42923382">[-]</label><label class="expand" for="c-42923382">[3 more]</label></div><br/><div class="children"><div class="content">I wouldn&#x27;t focus so much on the rdrand part.  That&#x27;s more a proof that they have crafted a custom microcode than trying to say that rdrand is broken.</div><br/><div id="42924609" class="c"><input type="checkbox" id="c-42924609" checked=""/><div class="controls bullet"><span class="by">wrs</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42923382">parent</a><span>|</span><a href="#42922197">next</a><span>|</span><label class="collapse" for="c-42924609">[-]</label><label class="expand" for="c-42924609">[2 more]</label></div><br/><div class="children"><div class="content">I think the argument for entropy mixing was that RDRAND <i>could</i> be broken, not that it <i>was</i> broken. On these processors, apparently yes it could.</div><br/><div id="42925707" class="c"><input type="checkbox" id="c-42925707" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42924609">parent</a><span>|</span><a href="#42922197">next</a><span>|</span><label class="collapse" for="c-42925707">[-]</label><label class="expand" for="c-42925707">[1 more]</label></div><br/><div class="children"><div class="content">Rdrand was known to be previously broken.<p><a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;archlinux&#x2F;comments&#x2F;1d9aazw&#x2F;rdrand_not_working_on_amd_cpu&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;archlinux&#x2F;comments&#x2F;1d9aazw&#x2F;rdrand_n...</a></div><br/></div></div></div></div></div></div><div id="42922197" class="c"><input type="checkbox" id="c-42922197" checked=""/><div class="controls bullet"><span class="by">c2xlZXB5Cg1</span><span>|</span><a href="#42921591">parent</a><span>|</span><a href="#42923382">prev</a><span>|</span><a href="#42921861">next</a><span>|</span><label class="collapse" for="c-42922197">[-]</label><label class="expand" for="c-42922197">[7 more]</label></div><br/><div class="children"><div class="content">Life imitates art:
<a href="https:&#x2F;&#x2F;imgs.xkcd.com&#x2F;comics&#x2F;random_number.png" rel="nofollow">https:&#x2F;&#x2F;imgs.xkcd.com&#x2F;comics&#x2F;random_number.png</a></div><br/><div id="42922411" class="c"><input type="checkbox" id="c-42922411" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922197">parent</a><span>|</span><a href="#42923831">next</a><span>|</span><label class="collapse" for="c-42922411">[-]</label><label class="expand" for="c-42922411">[1 more]</label></div><br/><div class="children"><div class="content">I assume the Google engineers have a sense of humor</div><br/></div></div><div id="42923831" class="c"><input type="checkbox" id="c-42923831" checked=""/><div class="controls bullet"><span class="by">Lammy</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922197">parent</a><span>|</span><a href="#42922411">prev</a><span>|</span><a href="#42923716">next</a><span>|</span><label class="collapse" for="c-42923831">[-]</label><label class="expand" for="c-42923831">[1 more]</label></div><br/><div class="children"><div class="content">I realize the OP is explicitly (w&#x2F;r&#x2F;t 4) a reference to XKCD, but See Also: Dilbert 2001-10-25 :)<p><a href="https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20011027002011&#x2F;http:&#x2F;&#x2F;www.dilbert.com&#x2F;comics&#x2F;dilbert&#x2F;archive&#x2F;images&#x2F;dilbert2001182781025.gif" rel="nofollow">https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20011027002011&#x2F;http:&#x2F;&#x2F;www.dilber...</a><p><a href="https:&#x2F;&#x2F;dilbert-viewer.herokuapp.com&#x2F;2001-10-25" rel="nofollow">https:&#x2F;&#x2F;dilbert-viewer.herokuapp.com&#x2F;2001-10-25</a></div><br/></div></div><div id="42923716" class="c"><input type="checkbox" id="c-42923716" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42922197">parent</a><span>|</span><a href="#42923831">prev</a><span>|</span><a href="#42921861">next</a><span>|</span><label class="collapse" for="c-42923716">[-]</label><label class="expand" for="c-42923716">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a reference to the PS3&#x27;s RNG.</div><br/><div id="42924449" class="c"><input type="checkbox" id="c-42924449" checked=""/><div class="controls bullet"><span class="by">Karliss</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42923716">parent</a><span>|</span><a href="#42928925">next</a><span>|</span><label class="collapse" for="c-42924449">[-]</label><label class="expand" for="c-42924449">[2 more]</label></div><br/><div class="children"><div class="content">I always thought the same when seeing that XKCD comic, but turns out it was the opposite. PS3 hack (2010) came 3 years after the XKCD comic(2007), they even used it as one of slides during 27C3 presentation. <a href="https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;27c3-4087-en-console_hacking_2010#t=2332" rel="nofollow">https:&#x2F;&#x2F;media.ccc.de&#x2F;v&#x2F;27c3-4087-en-console_hacking_2010#t=2...</a></div><br/><div id="42928441" class="c"><input type="checkbox" id="c-42928441" checked=""/><div class="controls bullet"><span class="by">eptcyka</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42924449">parent</a><span>|</span><a href="#42928925">next</a><span>|</span><label class="collapse" for="c-42928441">[-]</label><label class="expand" for="c-42928441">[1 more]</label></div><br/><div class="children"><div class="content">Oh my.</div><br/></div></div></div></div><div id="42928925" class="c"><input type="checkbox" id="c-42928925" checked=""/><div class="controls bullet"><span class="by">nicman23</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42923716">parent</a><span>|</span><a href="#42924449">prev</a><span>|</span><a href="#42921861">next</a><span>|</span><label class="collapse" for="c-42928925">[-]</label><label class="expand" for="c-42928925">[1 more]</label></div><br/><div class="children"><div class="content">oh fuck i had forget that blast of a presentation</div><br/></div></div></div></div></div></div><div id="42921861" class="c"><input type="checkbox" id="c-42921861" checked=""/><div class="controls bullet"><span class="by">bestouff</span><span>|</span><a href="#42921591">parent</a><span>|</span><a href="#42922197">prev</a><span>|</span><a href="#42927702">next</a><span>|</span><label class="collapse" for="c-42921861">[-]</label><label class="expand" for="c-42921861">[3 more]</label></div><br/><div class="children"><div class="content">Yes ! I wonder what&#x27;s the Windows implementation of the equivalent API.</div><br/><div id="42925132" class="c"><input type="checkbox" id="c-42925132" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42921861">parent</a><span>|</span><a href="#42922278">next</a><span>|</span><label class="collapse" for="c-42925132">[-]</label><label class="expand" for="c-42925132">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Windows 10 has many entropy sources; these work together to ensure that the OS has good entropy. Different entropy sources guarantee good entropy in different situations; by using them all the best coverage is attained.<p>&gt; Interrupt Timings<p>&gt; The primary entropy source in Windows 10 is the interrupt timings. On each interrupt to a CPU the interrupt hander gets the Time Stamp Count (TSC) from the CPU. This is typically a counter that runs on the CPU clock frequency; on X86 and X64 CPUs this is done using the RDTSC instruction.<p>&gt; ...<p>&gt; The Intel RDRAND instruction is an on-demand high quality source of random data.<p>&gt; If the RDRAND instruction is present, Winload gathers 256 bits of entropy from the RDRAND instruction. Similarly, our kernel-mode code creates a high-pull source that provides 512 bits of entropy from the RDRAND instruction for each reseed. (As a high source, the first 256 bits are always put in pool 0; providing 512 bits ensures that the other pools also get entropy from this source.)<p>&gt; Due to some unfortunate design decisions in the internal RDRAND logic, the RDRAND instruction only provides random numbers with a 128-bit security level. The Win10 code tries to work around this limitation by gathering a large amount of output from RDRAND which should trigger a reseed of the RDRAND-internal PRNG to get more entropy. Whilst this solves the problem in most cases, it is possible for another thread to gather similar outputs form RDRAND which means that a 256-bit security level cannot be guaranteed.<p>&gt; Based on our feedback about this problem, Intel implemented the RDSEED instruction that gives direct access to the internal entropy source. When the RDSEED instruction is present, it is used in preference to RDRAND instruction which avoids the problem and provides the full desired guarantees. For each reseed, we gather 128 output bytes from RDSEED, hash them with SHA-512 to produce 64 output bytes. As explained before, 32 of these go into pool 0 and the others into the ‘next’ pool for this entropy source.<p><a href="https:&#x2F;&#x2F;aka.ms&#x2F;win10rng" rel="nofollow">https:&#x2F;&#x2F;aka.ms&#x2F;win10rng</a></div><br/></div></div><div id="42922278" class="c"><input type="checkbox" id="c-42922278" checked=""/><div class="controls bullet"><span class="by">cluckindan</span><span>|</span><a href="#42921591">root</a><span>|</span><a href="#42921861">parent</a><span>|</span><a href="#42925132">prev</a><span>|</span><a href="#42927702">next</a><span>|</span><label class="collapse" for="c-42922278">[-]</label><label class="expand" for="c-42922278">[1 more]</label></div><br/><div class="children"><div class="content">Run the patch and find out.</div><br/></div></div></div></div></div></div><div id="42927702" class="c"><input type="checkbox" id="c-42927702" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#42921591">prev</a><span>|</span><a href="#42923838">next</a><span>|</span><label class="collapse" for="c-42927702">[-]</label><label class="expand" for="c-42927702">[3 more]</label></div><br/><div class="children"><div class="content">This reminds me of a decade-old utility called &quot;Bulldozer Conditioner&quot; that claimed to increase performance of certain AMD CPUs dramatically (and was verified by benchmarks), yet the author was extremely avoidant of the technical details of how it was accomplished --- AFAIK no one publicly RE&#x27;d and posted information on it that I could find, and I never got around to doing it either, but now I wonder if he had figured out how to modify and optimise(!) the microcode.</div><br/><div id="42928474" class="c"><input type="checkbox" id="c-42928474" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#42927702">parent</a><span>|</span><a href="#42928588">next</a><span>|</span><label class="collapse" for="c-42928474">[-]</label><label class="expand" for="c-42928474">[1 more]</label></div><br/><div class="children"><div class="content">I was curious, so I took a look at Bulldozer Conditioner. It seems it&#x27;s working by flipping some chicken bits in un(or not very well)documented MSRs.  The same kind of registers that were used to disable certain processor optimizations in service to spectre mitigations.</div><br/></div></div><div id="42928588" class="c"><input type="checkbox" id="c-42928588" checked=""/><div class="controls bullet"><span class="by">neuroelectron</span><span>|</span><a href="#42927702">parent</a><span>|</span><a href="#42928474">prev</a><span>|</span><a href="#42923838">next</a><span>|</span><label class="collapse" for="c-42928588">[-]</label><label class="expand" for="c-42928588">[1 more]</label></div><br/><div class="children"><div class="content">It would be interesting to have an open source microcode community.</div><br/></div></div></div></div><div id="42923838" class="c"><input type="checkbox" id="c-42923838" checked=""/><div class="controls bullet"><span class="by">xmodem</span><span>|</span><a href="#42927702">prev</a><span>|</span><a href="#42921958">next</a><span>|</span><label class="collapse" for="c-42923838">[-]</label><label class="expand" for="c-42923838">[10 more]</label></div><br/><div class="children"><div class="content">Security implications aside, the ability to load custom microcode onto these chips could have fascinating implications for reverse engineering and understanding them better.</div><br/><div id="42924012" class="c"><input type="checkbox" id="c-42924012" checked=""/><div class="controls bullet"><span class="by">AnotherGoodName</span><span>|</span><a href="#42923838">parent</a><span>|</span><a href="#42926487">next</a><span>|</span><label class="collapse" for="c-42924012">[-]</label><label class="expand" for="c-42924012">[3 more]</label></div><br/><div class="children"><div class="content">Also I’m curious if there’s opportunity for an all out perf variant from home brewers.<p>Eg. Throw away all spectre mitigations, find all the hacks to get each instructions timing down, etc.</div><br/><div id="42927168" class="c"><input type="checkbox" id="c-42927168" checked=""/><div class="controls bullet"><span class="by">basementcat</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42924012">parent</a><span>|</span><a href="#42926487">next</a><span>|</span><label class="collapse" for="c-42927168">[-]</label><label class="expand" for="c-42927168">[2 more]</label></div><br/><div class="children"><div class="content">While you’re at it, allow for a few more ulp (units of least place) error for floating point ops.</div><br/><div id="42928653" class="c"><input type="checkbox" id="c-42928653" checked=""/><div class="controls bullet"><span class="by">basementcat</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42927168">parent</a><span>|</span><a href="#42926487">next</a><span>|</span><label class="collapse" for="c-42928653">[-]</label><label class="expand" for="c-42928653">[1 more]</label></div><br/><div class="children"><div class="content">Kidding aside, my understanding is this sort of thing cannot be microcode patched.<p>But I would be pleased to be proven wrong.</div><br/></div></div></div></div></div></div><div id="42926487" class="c"><input type="checkbox" id="c-42926487" checked=""/><div class="controls bullet"><span class="by">pabs3</span><span>|</span><a href="#42923838">parent</a><span>|</span><a href="#42924012">prev</a><span>|</span><a href="#42925075">next</a><span>|</span><label class="collapse" for="c-42926487">[-]</label><label class="expand" for="c-42926487">[1 more]</label></div><br/><div class="children"><div class="content">I wonder how much of the built-in microcode you could replace with Free-as-in-Freedom equivalents, I expect not all of it due to available SRAM?</div><br/></div></div><div id="42925075" class="c"><input type="checkbox" id="c-42925075" checked=""/><div class="controls bullet"><span class="by">mindslight</span><span>|</span><a href="#42923838">parent</a><span>|</span><a href="#42926487">prev</a><span>|</span><a href="#42921958">next</a><span>|</span><label class="collapse" for="c-42925075">[-]</label><label class="expand" for="c-42925075">[5 more]</label></div><br/><div class="children"><div class="content">Security implications? This is a win for distributed security - it&#x27;s a &quot;vulnerability&quot; in the sense of the end of a movie where the evil overlord&#x27;s plan falls apart.<p>&gt; <i>This vulnerability could be used by an adversary to compromise confidential computing workloads protected by the newest version of AMD Secure Encrypted Virtualization, SEV-SNP or to compromise Dynamic Root of Trust Measurement.</i><p>I don&#x27;t know whether the people who write this upside-down corpo newspeak are so coked up on the authoritarian paradigm that they&#x27;ve lost touch with the reality, or if they&#x27;re just paid well enough by the corpos to not care about making society worse, or what. But I&#x27;ll translate:<p>This &quot;vulnerability&quot; might be used by the <i>owner of a computer</i> to inspect what their computer is actually doing or to defend themselves against coercion aiming to control the software they&#x27;re running.</div><br/><div id="42928609" class="c"><input type="checkbox" id="c-42928609" checked=""/><div class="controls bullet"><span class="by">j16sdiz</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42925075">parent</a><span>|</span><a href="#42925856">next</a><span>|</span><label class="collapse" for="c-42928609">[-]</label><label class="expand" for="c-42928609">[1 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t follow the logic.<p>In the context of remote attestation, they can revoke the key and  vulnerability like these won&#x27;t help.</div><br/></div></div><div id="42925856" class="c"><input type="checkbox" id="c-42925856" checked=""/><div class="controls bullet"><span class="by">ngneer</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42925075">parent</a><span>|</span><a href="#42928609">prev</a><span>|</span><a href="#42921958">next</a><span>|</span><label class="collapse" for="c-42925856">[-]</label><label class="expand" for="c-42925856">[3 more]</label></div><br/><div class="children"><div class="content">I am all for Right to Repair, and am upset with the &quot;evil overlords&quot; as much as the next guy. But, to present the treacherous computing argument all on its own, is, well, incomplete. I am a huge fan of Ross Anderson, RIP. However, the reality is that while DRTM was originally envisioned primarily for DRM applications, it is nowadays leveraged to protect PCs against bootkits and the like. YOU may like to own your computer through and through, down to the microcode, but, for most people, their computer is viewed as a product, that they trust vendors to secure for them. If ultimate control is so important to you, can you not buy any machine you like, including one based on a RISC-V open-source processor?<p><a href="https:&#x2F;&#x2F;community.amd.com&#x2F;t5&#x2F;business&#x2F;amd-and-microsoft-secured-core-pc&#x2F;ba-p&#x2F;418204" rel="nofollow">https:&#x2F;&#x2F;community.amd.com&#x2F;t5&#x2F;business&#x2F;amd-and-microsoft-secu...</a></div><br/><div id="42926582" class="c"><input type="checkbox" id="c-42926582" checked=""/><div class="controls bullet"><span class="by">mindslight</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42925856">parent</a><span>|</span><a href="#42921958">next</a><span>|</span><label class="collapse" for="c-42926582">[-]</label><label class="expand" for="c-42926582">[2 more]</label></div><br/><div class="children"><div class="content">&gt; <i>If ultimate control is so important to you, can you not buy any machine you like, including one based on a RISC-V open-source processor?</i><p>This argument (or the individualist approach in general) no longer works in the context of remote attestation (&quot;Dynamic Root of Trust Measurement&quot;). As soon as the &quot;average person&quot; has a computer that can be counted on to betray what software they&#x27;re running, remote parties will start turning the screws of coercion and making everyone use such a machine.</div><br/><div id="42927954" class="c"><input type="checkbox" id="c-42927954" checked=""/><div class="controls bullet"><span class="by">ngneer</span><span>|</span><a href="#42923838">root</a><span>|</span><a href="#42926582">parent</a><span>|</span><a href="#42921958">next</a><span>|</span><label class="collapse" for="c-42927954">[-]</label><label class="expand" for="c-42927954">[1 more]</label></div><br/><div class="children"><div class="content">Yes, remote attestation is tantamount to the hardware snitching on the execution, and not necessarily to the benefit of the platform owner. I agree with you, that from a game theoretic perspective, as soon as the vast majority of platforms betray user trust, those seeking to use other machines will be left stranded. However, despite the above dynamics, you could still buy any machine you like and use it any way you like, just like app stores have alternatives. You may not like the alternative, but that is a different story.<p>Knowing nothing about you, it is safe to assume that you may use the dollar or similar currency, either directly or indirectly. Why would you choose to do that? Such currencies come with lots of rules and regulations about what you can and cannot do. Society must keep track of who has how much in banks, and individuals are held liable should there be an overdraft. Remote attestation may certainly put a damper on doing your own thing with your computer, but you can choose whether you wish to pay the price of participating in the economy. Not sure if the above is a great analogy, probably a terrible one, but the bygone ideal of having your computer acting solely in your interest is simply not very realistic. At the very least, controlling the microcode will not give you the control you seek, because there are too many other layers in the stack that are routinely broken, and you are always one exploit away from joining a botnet. No matter how you wish to spin it, your computer is not yours, and obeys many masters. If you feel otherwise, please offer a counterexample to the preceding statement.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42921958" class="c"><input type="checkbox" id="c-42921958" checked=""/><div class="controls bullet"><span class="by">hedora</span><span>|</span><a href="#42923838">prev</a><span>|</span><a href="#42922471">next</a><span>|</span><label class="collapse" for="c-42921958">[-]</label><label class="expand" for="c-42921958">[16 more]</label></div><br/><div class="children"><div class="content">As an end user, I wonder how my cloud provider can prove to me that they installed AMD&#x27;s fix and are not simply running a malicious version of the microcode on their CPU that claims to have the fix.</div><br/><div id="42923167" class="c"><input type="checkbox" id="c-42923167" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42922114">next</a><span>|</span><label class="collapse" for="c-42923167">[-]</label><label class="expand" for="c-42923167">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s in the CVE: &quot;AMD SEV-SNP users can verify the fix by confirming TCB values for SNP in their attestation reports.&quot;<p>You can read about how this works here: <a href="https:&#x2F;&#x2F;www.amd.com&#x2F;content&#x2F;dam&#x2F;amd&#x2F;en&#x2F;documents&#x2F;epyc-technical-docs&#x2F;specifications&#x2F;57230.pdf" rel="nofollow">https:&#x2F;&#x2F;www.amd.com&#x2F;content&#x2F;dam&#x2F;amd&#x2F;en&#x2F;documents&#x2F;epyc-techni...</a><p>If you aren&#x27;t using SEV-SNP &#x2F; attested compute, you have bigger fish to fry anyway since you have no actual trust in your hypervisor.</div><br/><div id="42924516" class="c"><input type="checkbox" id="c-42924516" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42923167">parent</a><span>|</span><a href="#42922114">next</a><span>|</span><label class="collapse" for="c-42924516">[-]</label><label class="expand" for="c-42924516">[2 more]</label></div><br/><div class="children"><div class="content">While I agree with you, from experience most people and most workloads definitely aren&#x27;t using SEV-SNP. The hypervisor and the cloud provider are always assumed to be honest.<p>I personally evaluated this technology a few years ago, and even just moving a small part of our team&#x27;s workload to SEV-SNP faced so much resistance from the VP level. I&#x27;m not sure if that&#x27;s more of a problem with bureaucracy at my old employer or a general problem.</div><br/><div id="42924599" class="c"><input type="checkbox" id="c-42924599" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42924516">parent</a><span>|</span><a href="#42922114">next</a><span>|</span><label class="collapse" for="c-42924599">[-]</label><label class="expand" for="c-42924599">[1 more]</label></div><br/><div class="children"><div class="content">Oh, 100%. My point was just: if you&#x27;re worried that you can&#x27;t audit your cloud provider&#x27;s microcode patch level because you aren&#x27;t using SEV-SNP, you have a threat model where their microcode patch level is not particularly relevant to you to begin with.</div><br/></div></div></div></div></div></div><div id="42922114" class="c"><input type="checkbox" id="c-42922114" checked=""/><div class="controls bullet"><span class="by">kyrra</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42923167">prev</a><span>|</span><a href="#42927955">next</a><span>|</span><label class="collapse" for="c-42922114">[-]</label><label class="expand" for="c-42922114">[1 more]</label></div><br/><div class="children"><div class="content">For the large providers (Amazon, Google, Microsoft), they buy so many CPUs that they for issues like this, they tend to be given the fixes before they are released to the public.  So I&#x27;d wager that those 3 already have patched their entire fleet.</div><br/></div></div><div id="42927955" class="c"><input type="checkbox" id="c-42927955" checked=""/><div class="controls bullet"><span class="by">RachelF</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42922114">prev</a><span>|</span><a href="#42922235">next</a><span>|</span><label class="collapse" for="c-42927955">[-]</label><label class="expand" for="c-42927955">[1 more]</label></div><br/><div class="children"><div class="content">Will the OS fix the microcode, or will a BIOS flash be required?</div><br/></div></div><div id="42922235" class="c"><input type="checkbox" id="c-42922235" checked=""/><div class="controls bullet"><span class="by">bornfreddy</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42927955">prev</a><span>|</span><a href="#42922619">next</a><span>|</span><label class="collapse" for="c-42922235">[-]</label><label class="expand" for="c-42922235">[2 more]</label></div><br/><div class="children"><div class="content">Try to install your own patch for RDRAND and check that it is returning 4? Of course, getting 4 multiple times doesn&#x27;t mean you have succeeded [0].<p>[0] <a href="https:&#x2F;&#x2F;duckduckgo.com&#x2F;?q=dilbert+random+generator+nine+nine&amp;t=fpas&amp;iar=images&amp;iax=images&amp;ia=images" rel="nofollow">https:&#x2F;&#x2F;duckduckgo.com&#x2F;?q=dilbert+random+generator+nine+nine...</a> (couldn&#x27;t find a good link to the comic)</div><br/><div id="42922861" class="c"><input type="checkbox" id="c-42922861" checked=""/><div class="controls bullet"><span class="by">tedunangst</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42922235">parent</a><span>|</span><a href="#42922619">next</a><span>|</span><label class="collapse" for="c-42922861">[-]</label><label class="expand" for="c-42922861">[1 more]</label></div><br/><div class="children"><div class="content">The exploit doesn&#x27;t work in a VM.</div><br/></div></div></div></div><div id="42922619" class="c"><input type="checkbox" id="c-42922619" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42922235">prev</a><span>|</span><a href="#42923099">next</a><span>|</span><label class="collapse" for="c-42922619">[-]</label><label class="expand" for="c-42922619">[3 more]</label></div><br/><div class="children"><div class="content">In theory the PSP should probably attest the microcode but I don&#x27;t know if that exists.</div><br/><div id="42922990" class="c"><input type="checkbox" id="c-42922990" checked=""/><div class="controls bullet"><span class="by">bpye</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42922619">parent</a><span>|</span><a href="#42923099">next</a><span>|</span><label class="collapse" for="c-42922990">[-]</label><label class="expand" for="c-42922990">[2 more]</label></div><br/><div class="children"><div class="content">SEV-SNP VMs can obtain an attestation report [0].<p>[0] - <a href="https:&#x2F;&#x2F;www.amd.com&#x2F;content&#x2F;dam&#x2F;amd&#x2F;en&#x2F;documents&#x2F;epyc-technical-docs&#x2F;specifications&#x2F;56860.pdf" rel="nofollow">https:&#x2F;&#x2F;www.amd.com&#x2F;content&#x2F;dam&#x2F;amd&#x2F;en&#x2F;documents&#x2F;epyc-techni...</a></div><br/><div id="42926370" class="c"><input type="checkbox" id="c-42926370" checked=""/><div class="controls bullet"><span class="by">anon2025b</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42922990">parent</a><span>|</span><a href="#42923099">next</a><span>|</span><label class="collapse" for="c-42926370">[-]</label><label class="expand" for="c-42926370">[1 more]</label></div><br/><div class="children"><div class="content">What does it actually attest though?<p>The running microcode&#x27;s revision ID?<p>Or the running microcode&#x27;s ROM version <i>plus</i> loaded patch lines <i>plus</i> active match registers <i>plus</i> whatever settings were adjusted in config registers during the act of loading?<p>That is, attest the actual and complete config that is running, or some pointless subset that instills a false sense of security?<p>It would be good for AMD (and Intel etc.) to provide better details here.</div><br/></div></div></div></div></div></div><div id="42923099" class="c"><input type="checkbox" id="c-42923099" checked=""/><div class="controls bullet"><span class="by">alberth</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42922619">prev</a><span>|</span><a href="#42922172">next</a><span>|</span><label class="collapse" for="c-42923099">[-]</label><label class="expand" for="c-42923099">[3 more]</label></div><br/><div class="children"><div class="content">Don&#x27;t microcode updates require a restart as well.</div><br/><div id="42923340" class="c"><input type="checkbox" id="c-42923340" checked=""/><div class="controls bullet"><span class="by">monocasa</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42923099">parent</a><span>|</span><a href="#42924060">next</a><span>|</span><label class="collapse" for="c-42923340">[-]</label><label class="expand" for="c-42923340">[1 more]</label></div><br/><div class="children"><div class="content">They do not.</div><br/></div></div><div id="42924060" class="c"><input type="checkbox" id="c-42924060" checked=""/><div class="controls bullet"><span class="by">formerly_proven</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42923099">parent</a><span>|</span><a href="#42923340">prev</a><span>|</span><a href="#42922172">next</a><span>|</span><label class="collapse" for="c-42924060">[-]</label><label class="expand" for="c-42924060">[1 more]</label></div><br/><div class="children"><div class="content">Microcode updates aren&#x27;t persistent, they&#x27;re loaded into on-CPU-SRAM by firmware and&#x2F;or kernel.</div><br/></div></div></div></div><div id="42922172" class="c"><input type="checkbox" id="c-42922172" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42921958">parent</a><span>|</span><a href="#42923099">prev</a><span>|</span><a href="#42922471">next</a><span>|</span><label class="collapse" for="c-42922172">[-]</label><label class="expand" for="c-42922172">[2 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think you can, necessarily, except by basically declaring bankruptcy on the old trust root on the systems and teaching everyone not to trust the old root.<p>As long as the vulnerability doesn&#x27;t let them actually extract the secrets necessary to simulate completely arbitrary operations including with any future keys, I _think_ you can trust the new attestation chain afterward?<p>I&#x27;ve not been paid to work on this, though, and it would be pretty easy to have accidentally built it in a way where this is a world-ending event, and truly paranoid workloads in the future are going to insist on only using silicon that can&#x27;t have ever been compromised by this either way.</div><br/><div id="42922297" class="c"><input type="checkbox" id="c-42922297" checked=""/><div class="controls bullet"><span class="by">cluckindan</span><span>|</span><a href="#42921958">root</a><span>|</span><a href="#42922172">parent</a><span>|</span><a href="#42922471">next</a><span>|</span><label class="collapse" for="c-42922297">[-]</label><label class="expand" for="c-42922297">[1 more]</label></div><br/><div class="children"><div class="content"><i>hugs the Q6600</i> don’t you ever die on me, you precious space heater.</div><br/></div></div></div></div></div></div><div id="42922471" class="c"><input type="checkbox" id="c-42922471" checked=""/><div class="controls bullet"><span class="by">nubinetwork</span><span>|</span><a href="#42921958">prev</a><span>|</span><a href="#42922709">next</a><span>|</span><label class="collapse" for="c-42922471">[-]</label><label class="expand" for="c-42922471">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know how exploitable this really is, as a lot of Linux systems load microcode at boot time...  once it&#x27;s been loaded, I don&#x27;t think it&#x27;s possible to load another one (outside of rebooting).</div><br/><div id="42922533" class="c"><input type="checkbox" id="c-42922533" checked=""/><div class="controls bullet"><span class="by">homebrewer</span><span>|</span><a href="#42922471">parent</a><span>|</span><a href="#42922709">next</a><span>|</span><label class="collapse" for="c-42922533">[-]</label><label class="expand" for="c-42922533">[2 more]</label></div><br/><div class="children"><div class="content">It is possible, but it&#x27;s generally not a good idea.<p><a href="https:&#x2F;&#x2F;wiki.archlinux.org&#x2F;title&#x2F;Microcode#Late_loading" rel="nofollow">https:&#x2F;&#x2F;wiki.archlinux.org&#x2F;title&#x2F;Microcode#Late_loading</a><p><a href="https:&#x2F;&#x2F;docs.kernel.org&#x2F;arch&#x2F;x86&#x2F;microcode.html#late-loading" rel="nofollow">https:&#x2F;&#x2F;docs.kernel.org&#x2F;arch&#x2F;x86&#x2F;microcode.html#late-loading</a><p>although quotes from this article claim that it&#x27;s fine specifically on AMD systems:<p><a href="https:&#x2F;&#x2F;www.phoronix.com&#x2F;news&#x2F;AMD-Late-Loading-Microcode" rel="nofollow">https:&#x2F;&#x2F;www.phoronix.com&#x2F;news&#x2F;AMD-Late-Loading-Microcode</a></div><br/><div id="42922650" class="c"><input type="checkbox" id="c-42922650" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42922471">root</a><span>|</span><a href="#42922533">parent</a><span>|</span><a href="#42922709">next</a><span>|</span><label class="collapse" for="c-42922650">[-]</label><label class="expand" for="c-42922650">[1 more]</label></div><br/><div class="children"><div class="content">To my understanding, part of the reason that was a problem was that Intel wanted to killswitch feature bits like SGX, but since Linux saves the feature bit state when it inits the CPUs, and then other things might change codepaths based on that, if you then killswitch it later, boom might go the dynamite.<p>(I believe this example would also still break on AMD-based systems, AMD just hasn&#x27;t killswitched a CPUID feature flag yet AFAIR...)</div><br/></div></div></div></div></div></div><div id="42922709" class="c"><input type="checkbox" id="c-42922709" checked=""/><div class="controls bullet"><span class="by">Kab1r</span><span>|</span><a href="#42922471">prev</a><span>|</span><a href="#42927475">next</a><span>|</span><label class="collapse" for="c-42922709">[-]</label><label class="expand" for="c-42922709">[3 more]</label></div><br/><div class="children"><div class="content">Does anyone know if this is the same vulnerability that ASUS leaked in a beta BIOS?</div><br/><div id="42923157" class="c"><input type="checkbox" id="c-42923157" checked=""/><div class="controls bullet"><span class="by">bri3d</span><span>|</span><a href="#42922709">parent</a><span>|</span><a href="#42923269">next</a><span>|</span><label class="collapse" for="c-42923157">[-]</label><label class="expand" for="c-42923157">[1 more]</label></div><br/><div class="children"><div class="content">To the very best of my knowledge, yes, it is.</div><br/></div></div></div></div><div id="42927475" class="c"><input type="checkbox" id="c-42927475" checked=""/><div class="controls bullet"><span class="by">thayne</span><span>|</span><a href="#42922709">prev</a><span>|</span><a href="#42924527">next</a><span>|</span><label class="collapse" for="c-42927475">[-]</label><label class="expand" for="c-42927475">[2 more]</label></div><br/><div class="children"><div class="content">High seems a bit extreme to me. If you have something malicious running in ring 0, you are already in big trouble.</div><br/><div id="42928798" class="c"><input type="checkbox" id="c-42928798" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#42927475">parent</a><span>|</span><a href="#42924527">next</a><span>|</span><label class="collapse" for="c-42928798">[-]</label><label class="expand" for="c-42928798">[1 more]</label></div><br/><div class="children"><div class="content">The idea of confidential compute &#x2F; AMD Secure Encrypted Virtualization is that even with root outside the VM, you can&#x27;t read the memory of the workloads running within a VM. Additionally, those inner workloads can attest that they are running in a secure environment.</div><br/></div></div></div></div><div id="42924527" class="c"><input type="checkbox" id="c-42924527" checked=""/><div class="controls bullet"><span class="by">9cb14c1ec0</span><span>|</span><a href="#42927475">prev</a><span>|</span><a href="#42925688">next</a><span>|</span><label class="collapse" for="c-42924527">[-]</label><label class="expand" for="c-42924527">[1 more]</label></div><br/><div class="children"><div class="content">Move over Android ROM enthusiasts, real geeks run their own microcode.</div><br/></div></div><div id="42925688" class="c"><input type="checkbox" id="c-42925688" checked=""/><div class="controls bullet"><span class="by">SubzeroCarnage</span><span>|</span><a href="#42924527">prev</a><span>|</span><a href="#42923171">next</a><span>|</span><label class="collapse" for="c-42925688">[-]</label><label class="expand" for="c-42925688">[1 more]</label></div><br/><div class="children"><div class="content">Reminder that AMD has stopped providing microcode updates for consumer platforms via linux-firmware.<p>index of linux-firmware, 41 cpus supported: <a href="https:&#x2F;&#x2F;github.com&#x2F;divestedcg&#x2F;real-ucode&#x2F;blob&#x2F;master&#x2F;index-amd-official.txt">https:&#x2F;&#x2F;github.com&#x2F;divestedcg&#x2F;real-ucode&#x2F;blob&#x2F;master&#x2F;index-a...</a><p>index of my real-ucode project, 106 cpus supported: <a href="https:&#x2F;&#x2F;github.com&#x2F;divestedcg&#x2F;real-ucode&#x2F;blob&#x2F;master&#x2F;index-amd.txt">https:&#x2F;&#x2F;github.com&#x2F;divestedcg&#x2F;real-ucode&#x2F;blob&#x2F;master&#x2F;index-a...</a><p>sadly, unless you have this recent agesa update you can no longer load recent microcodes due to this fix<p>which very well means quite a substantial amount of models whose vendors don&#x27;t provide a bios update for this (since it goes back to zen1) will not be able to load any future fixes via microcode</div><br/></div></div><div id="42923171" class="c"><input type="checkbox" id="c-42923171" checked=""/><div class="controls bullet"><span class="by">techwiz137</span><span>|</span><a href="#42925688">prev</a><span>|</span><a href="#42921843">next</a><span>|</span><label class="collapse" for="c-42923171">[-]</label><label class="expand" for="c-42923171">[2 more]</label></div><br/><div class="children"><div class="content">How do they know the internal microcode structure of instructions or even format?</div><br/><div id="42923229" class="c"><input type="checkbox" id="c-42923229" checked=""/><div class="controls bullet"><span class="by">ris</span><span>|</span><a href="#42923171">parent</a><span>|</span><a href="#42921843">next</a><span>|</span><label class="collapse" for="c-42923229">[-]</label><label class="expand" for="c-42923229">[1 more]</label></div><br/><div class="children"><div class="content">Some people are very good at this, e.g. <a href="https:&#x2F;&#x2F;app.media.ccc.de&#x2F;v&#x2F;35c3-9614-inside_the_amd_microcode_rom" rel="nofollow">https:&#x2F;&#x2F;app.media.ccc.de&#x2F;v&#x2F;35c3-9614-inside_the_amd_microcod...</a></div><br/></div></div></div></div><div id="42921843" class="c"><input type="checkbox" id="c-42921843" checked=""/><div class="controls bullet"><span class="by">unsnap_biceps</span><span>|</span><a href="#42923171">prev</a><span>|</span><a href="#42924842">next</a><span>|</span><label class="collapse" for="c-42921843">[-]</label><label class="expand" for="c-42921843">[6 more]</label></div><br/><div class="children"><div class="content">&gt; A test payload for Milan and Genoa CPUs that makes the RDRAND instruction return 4<p>I would be tickled pink if the 4 was in reference to <a href="https:&#x2F;&#x2F;xkcd.com&#x2F;221&#x2F;" rel="nofollow">https:&#x2F;&#x2F;xkcd.com&#x2F;221&#x2F;</a></div><br/><div id="42922179" class="c"><input type="checkbox" id="c-42922179" checked=""/><div class="controls bullet"><span class="by">nspaced</span><span>|</span><a href="#42921843">parent</a><span>|</span><a href="#42921857">next</a><span>|</span><label class="collapse" for="c-42922179">[-]</label><label class="expand" for="c-42922179">[4 more]</label></div><br/><div class="children"><div class="content">Hi, I&#x27;m one of the authors and yes it was :)</div><br/><div id="42922805" class="c"><input type="checkbox" id="c-42922805" checked=""/><div class="controls bullet"><span class="by">rcthompson</span><span>|</span><a href="#42921843">root</a><span>|</span><a href="#42922179">parent</a><span>|</span><a href="#42922421">next</a><span>|</span><label class="collapse" for="c-42922805">[-]</label><label class="expand" for="c-42922805">[2 more]</label></div><br/><div class="children"><div class="content">Did you roll your own die or just trust that Randall&#x27;s original die roll was sufficiently random?</div><br/><div id="42923459" class="c"><input type="checkbox" id="c-42923459" checked=""/><div class="controls bullet"><span class="by">ikiris</span><span>|</span><a href="#42921843">root</a><span>|</span><a href="#42922805">parent</a><span>|</span><a href="#42922421">next</a><span>|</span><label class="collapse" for="c-42923459">[-]</label><label class="expand" for="c-42923459">[1 more]</label></div><br/><div class="children"><div class="content">It’s a well recognized standard</div><br/></div></div></div></div><div id="42922421" class="c"><input type="checkbox" id="c-42922421" checked=""/><div class="controls bullet"><span class="by">saagarjha</span><span>|</span><a href="#42921843">root</a><span>|</span><a href="#42922179">parent</a><span>|</span><a href="#42922805">prev</a><span>|</span><a href="#42921857">next</a><span>|</span><label class="collapse" for="c-42922421">[-]</label><label class="expand" for="c-42922421">[1 more]</label></div><br/><div class="children"><div class="content">We thank you for your service</div><br/></div></div></div></div><div id="42921857" class="c"><input type="checkbox" id="c-42921857" checked=""/><div class="controls bullet"><span class="by">vardump</span><span>|</span><a href="#42921843">parent</a><span>|</span><a href="#42922179">prev</a><span>|</span><a href="#42924842">next</a><span>|</span><label class="collapse" for="c-42921857">[-]</label><label class="expand" for="c-42921857">[1 more]</label></div><br/><div class="children"><div class="content">Of course it was.</div><br/></div></div></div></div><div id="42924842" class="c"><input type="checkbox" id="c-42924842" checked=""/><div class="controls bullet"><span class="by">qwertox</span><span>|</span><a href="#42921843">prev</a><span>|</span><a href="#42922481">next</a><span>|</span><label class="collapse" for="c-42924842">[-]</label><label class="expand" for="c-42924842">[1 more]</label></div><br/><div class="children"><div class="content">Does this patch persist across power cycles &#x2F; reboots?</div><br/></div></div><div id="42922481" class="c"><input type="checkbox" id="c-42922481" checked=""/><div class="controls bullet"><span class="by">dooglius</span><span>|</span><a href="#42924842">prev</a><span>|</span><a href="#42921445">next</a><span>|</span><label class="collapse" for="c-42922481">[-]</label><label class="expand" for="c-42922481">[5 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t this give enough detail for someone to replicate easily? I&#x27;d think it would not be too hard to look at the signature and find the insecure function used.</div><br/><div id="42922557" class="c"><input type="checkbox" id="c-42922557" checked=""/><div class="controls bullet"><span class="by">rincebrain</span><span>|</span><a href="#42922481">parent</a><span>|</span><a href="#42921445">next</a><span>|</span><label class="collapse" for="c-42922557">[-]</label><label class="expand" for="c-42922557">[4 more]</label></div><br/><div class="children"><div class="content">There&#x27;s been a bunch of scattered public research on microcode payload signatures over the years.<p>I would speculate that the problem is less that the hash function is weak inherently (otherwise we&#x27;d have a really complicated horizon of needing to chain microcode updates since we&#x27;d eventually want to e.g. go from MD5 to SHA1 or something), and more that the implementation has a flaw (similar to things like Nintendo using strcmp and not memcmp on their hash comparisons in the Wii, so you only had to collide the function to the first \0).</div><br/><div id="42926723" class="c"><input type="checkbox" id="c-42926723" checked=""/><div class="controls bullet"><span class="by">SubzeroCarnage</span><span>|</span><a href="#42922481">root</a><span>|</span><a href="#42922557">parent</a><span>|</span><a href="#42921445">next</a><span>|</span><label class="collapse" for="c-42926723">[-]</label><label class="expand" for="c-42926723">[3 more]</label></div><br/><div class="children"><div class="content">recent microcode appears to be rejected by older agesa in my testing, so it is very possible it is more than an implementation issue<p>under agesa 1.2.0.2b<p>&gt; microcode: CPU1: update failed for patch_level=0x0a60120c<p>under agesa 1.2.0.3a PatchA (which asus leaked that it fixes this issue)<p>&gt; microcode: Updated early from: 0x0a60120c</div><br/><div id="42927897" class="c"><input type="checkbox" id="c-42927897" checked=""/><div class="controls bullet"><span class="by">eigenform</span><span>|</span><a href="#42922481">root</a><span>|</span><a href="#42926723">parent</a><span>|</span><a href="#42921445">next</a><span>|</span><label class="collapse" for="c-42927897">[-]</label><label class="expand" for="c-42927897">[2 more]</label></div><br/><div class="children"><div class="content">They&#x27;re trying to validate that you&#x27;re using a trusted version of AGESA. 
This is probably intentional, the AMD bulletin[^1] mentions this (ie. for Milan):<p>&gt; Minimum MilanPI_1.0.0.F is required to allow for hot-loading future microcode versions higher than those listed in the PI.<p>Now that runtime loading of microcode patches cannot be implicitly trusted, the machine <i>should not</i> attempt to prove AMD&#x27;s authorship of the newly-loaded patch without a concrete guarantee that <i>the current</i> microcode patch is trustworthy.<p><i>Presumably</i> (load-bearing italics), the contents of an AGESA release (which contains the patch applied by your BIOS at boot-time) can be verified in a different way that isn&#x27;t broken.<p>[^1]: <a href="https:&#x2F;&#x2F;www.amd.com&#x2F;en&#x2F;resources&#x2F;product-security&#x2F;bulletin&#x2F;amd-sb-3019.html" rel="nofollow">https:&#x2F;&#x2F;www.amd.com&#x2F;en&#x2F;resources&#x2F;product-security&#x2F;bulletin&#x2F;a...</a></div><br/><div id="42927958" class="c"><input type="checkbox" id="c-42927958" checked=""/><div class="controls bullet"><span class="by">SubzeroCarnage</span><span>|</span><a href="#42922481">root</a><span>|</span><a href="#42927897">parent</a><span>|</span><a href="#42921445">next</a><span>|</span><label class="collapse" for="c-42927958">[-]</label><label class="expand" for="c-42927958">[1 more]</label></div><br/><div class="children"><div class="content">interesting!<p>I suppose a sufficiently older agesa may actually load the newer microcode then if that was a recent addition in preparation for this</div><br/></div></div></div></div></div></div></div></div></div></div><div id="42921445" class="c"><input type="checkbox" id="c-42921445" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#42922481">prev</a><span>|</span><a href="#42923013">next</a><span>|</span><label class="collapse" for="c-42921445">[-]</label><label class="expand" for="c-42921445">[3 more]</label></div><br/><div class="children"><div class="content">&gt;  CPU uses an insecure hash function in the signature validation<p>Do we know what this &quot;insecure hash function&quot; is&#x2F;was?</div><br/><div id="42921668" class="c"><input type="checkbox" id="c-42921668" checked=""/><div class="controls bullet"><span class="by">dmitrygr</span><span>|</span><a href="#42921445">parent</a><span>|</span><a href="#42923013">next</a><span>|</span><label class="collapse" for="c-42921668">[-]</label><label class="expand" for="c-42921668">[2 more]</label></div><br/><div class="children"><div class="content">$5 says CRC32</div><br/><div id="42923413" class="c"><input type="checkbox" id="c-42923413" checked=""/><div class="controls bullet"><span class="by">ngneer</span><span>|</span><a href="#42921445">root</a><span>|</span><a href="#42921668">parent</a><span>|</span><a href="#42923013">next</a><span>|</span><label class="collapse" for="c-42923413">[-]</label><label class="expand" for="c-42923413">[1 more]</label></div><br/><div class="children"><div class="content">More likely a SHA variant that is susceptible to a second preimage (collision) attack.</div><br/></div></div></div></div></div></div><div id="42923013" class="c"><input type="checkbox" id="c-42923013" checked=""/><div class="controls bullet"><span class="by">bhaney</span><span>|</span><a href="#42921445">prev</a><span>|</span><a href="#42921425">next</a><span>|</span><label class="collapse" for="c-42923013">[-]</label><label class="expand" for="c-42923013">[1 more]</label></div><br/><div class="children"><div class="content">Damn, now all those hostile microcode patches I&#x27;m always attempting to load might actually work?</div><br/></div></div><div id="42921425" class="c"><input type="checkbox" id="c-42921425" checked=""/><div class="controls bullet"><span class="by">dmitrygr</span><span>|</span><a href="#42923013">prev</a><span>|</span><a href="#42922495">next</a><span>|</span><label class="collapse" for="c-42921425">[-]</label><label class="expand" for="c-42921425">[5 more]</label></div><br/><div class="children"><div class="content">&gt; we will not be sharing full details at this time in order to give users time to re-establish trust on their confidential-compute workloads.<p>What a load of shit! Confidence is earned, it does not grow back like a weed you stepped on!</div><br/><div id="42921623" class="c"><input type="checkbox" id="c-42921623" checked=""/><div class="controls bullet"><span class="by">kmeisthax</span><span>|</span><a href="#42921425">parent</a><span>|</span><a href="#42921833">next</a><span>|</span><label class="collapse" for="c-42921623">[-]</label><label class="expand" for="c-42921623">[1 more]</label></div><br/><div class="children"><div class="content">They promised additional details in March - a month away. If they don&#x27;t release that information in March <i>then</i> you can sharpen your pitchforks.</div><br/></div></div><div id="42921833" class="c"><input type="checkbox" id="c-42921833" checked=""/><div class="controls bullet"><span class="by">unsnap_biceps</span><span>|</span><a href="#42921425">parent</a><span>|</span><a href="#42921623">prev</a><span>|</span><a href="#42922180">next</a><span>|</span><label class="collapse" for="c-42921833">[-]</label><label class="expand" for="c-42921833">[1 more]</label></div><br/><div class="children"><div class="content">I feel like this is a technical trust re-establishment, hence calling out specifically confidential-compute workloads</div><br/></div></div><div id="42922180" class="c"><input type="checkbox" id="c-42922180" checked=""/><div class="controls bullet"><span class="by">Stevvo</span><span>|</span><a href="#42921425">parent</a><span>|</span><a href="#42921833">prev</a><span>|</span><a href="#42924057">next</a><span>|</span><label class="collapse" for="c-42922180">[-]</label><label class="expand" for="c-42922180">[1 more]</label></div><br/><div class="children"><div class="content">They only shared it now because Asus accidentally leaked it in release notes for a BIOS update Beta.</div><br/></div></div><div id="42924057" class="c"><input type="checkbox" id="c-42924057" checked=""/><div class="controls bullet"><span class="by">ThatMedicIsASpy</span><span>|</span><a href="#42921425">parent</a><span>|</span><a href="#42922180">prev</a><span>|</span><a href="#42922495">next</a><span>|</span><label class="collapse" for="c-42924057">[-]</label><label class="expand" for="c-42924057">[1 more]</label></div><br/><div class="children"><div class="content">With ASUS leaking the fix in a beta bios one could go that route.</div><br/></div></div></div></div><div id="42922495" class="c"><input type="checkbox" id="c-42922495" checked=""/><div class="controls bullet"><span class="by">garaetjjte</span><span>|</span><a href="#42921425">prev</a><span>|</span><label class="collapse" for="c-42922495">[-]</label><label class="expand" for="c-42922495">[2 more]</label></div><br/><div class="children"><div class="content">Privileged code can load microcode? Duh, &quot;vulnerability&quot;.</div><br/><div id="42923445" class="c"><input type="checkbox" id="c-42923445" checked=""/><div class="controls bullet"><span class="by">ngneer</span><span>|</span><a href="#42922495">parent</a><span>|</span><label class="collapse" for="c-42923445">[-]</label><label class="expand" for="c-42923445">[1 more]</label></div><br/><div class="children"><div class="content">There are multiple privilege levels. Microcode has higher privilege than an OS&#x2F;VMM does.</div><br/></div></div></div></div></div></div></div></div></div></body></html>