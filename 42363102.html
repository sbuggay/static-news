<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1733734861769" as="style"/><link rel="stylesheet" href="styles.css?v=1733734861769"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://flatt.tech/research/posts/compromising-openwrt-supply-chain-sha256-collision/">Compromising OpenWrt Supply Chain</a> <span class="domain">(<a href="https://flatt.tech">flatt.tech</a>)</span></div><div class="subtext"><span>udev4096</span> | <span>25 comments</span></div><br/><div><div id="42363322" class="c"><input type="checkbox" id="c-42363322" checked=""/><div class="controls bullet"><span class="by">micw</span><span>|</span><a href="#42363861">next</a><span>|</span><label class="collapse" for="c-42363322">[-]</label><label class="expand" for="c-42363322">[7 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why open source can never compete with business grade closed source stuff:<p>- they fixed the in 3 hours instead of making customers wait 6 months for a patch (if any)<p>- they did not try to sue the reporter of the issue<p>- they did not even tell the users to throw away the &quot;outdated&quot; but perfectly working devices, offering a small discount to buy new</div><br/><div id="42364255" class="c"><input type="checkbox" id="c-42364255" checked=""/><div class="controls bullet"><span class="by">orra</span><span>|</span><a href="#42363322">parent</a><span>|</span><a href="#42364243">next</a><span>|</span><label class="collapse" for="c-42364255">[-]</label><label class="expand" for="c-42364255">[1 more]</label></div><br/><div class="children"><div class="content">Whilst this is true, it looks like OpenWRT fixed the hash truncation but not the command injection.<p>I hope they&#x27;re planning on fixing the command injection. As the blog post says, the created images are signed. Even without the signing, it&#x27;s code execution from untrusted user input. And of course vulnerabilities can be strung together (just like in this hash collision case).</div><br/></div></div><div id="42364243" class="c"><input type="checkbox" id="c-42364243" checked=""/><div class="controls bullet"><span class="by">beAbU</span><span>|</span><a href="#42363322">parent</a><span>|</span><a href="#42364255">prev</a><span>|</span><a href="#42364086">next</a><span>|</span><label class="collapse" for="c-42364243">[-]</label><label class="expand" for="c-42364243">[1 more]</label></div><br/><div class="children"><div class="content">Maybe make it clear you are being sarcastic here. English is not my native language, and my initial interpretation was that &quot;they&quot; in your post referred to the &quot;business grade closed source stuff&quot;, and that OpenWRT is really a dangerous bet because they are guilty of all the things you listed.</div><br/></div></div><div id="42363731" class="c"><input type="checkbox" id="c-42363731" checked=""/><div class="controls bullet"><span class="by">tapper</span><span>|</span><a href="#42363322">parent</a><span>|</span><a href="#42364086">prev</a><span>|</span><a href="#42363484">next</a><span>|</span><label class="collapse" for="c-42363731">[-]</label><label class="expand" for="c-42363731">[1 more]</label></div><br/><div class="children"><div class="content">Just why I love OpenWrt. They even ask the people that use screen readers like me to test the web interface to make sure that all is working as it should.</div><br/></div></div><div id="42363480" class="c"><input type="checkbox" id="c-42363480" checked=""/><div class="controls bullet"><span class="by">holoduke</span><span>|</span><a href="#42363322">parent</a><span>|</span><a href="#42363484">prev</a><span>|</span><a href="#42363861">next</a><span>|</span><label class="collapse" for="c-42363480">[-]</label><label class="expand" for="c-42363480">[1 more]</label></div><br/><div class="children"><div class="content">Home assistant and vlc anyone?</div><br/></div></div></div></div><div id="42363861" class="c"><input type="checkbox" id="c-42363861" checked=""/><div class="controls bullet"><span class="by">misiek08</span><span>|</span><a href="#42363322">prev</a><span>|</span><a href="#42363573">next</a><span>|</span><label class="collapse" for="c-42363861">[-]</label><label class="expand" for="c-42363861">[1 more]</label></div><br/><div class="children"><div class="content">First - open source tool adjusted to the task it wasn’t made for in short time, only because it is open source and written without BuilderFactoryProvider.
(already mentioned so I’m sorry, but it’s killing me every day)
Big company would take probably -1 years to fix this, because it would just sue the guy, try to arrest him ASAP and never release patch.
OpenWrt after getting information just took the insecure service offline, checked the report (while clients were already safe, because of the shutdown), made patch and released in 3 hours. Wow!</div><br/></div></div><div id="42363573" class="c"><input type="checkbox" id="c-42363573" checked=""/><div class="controls bullet"><span class="by">nrvn</span><span>|</span><a href="#42363861">prev</a><span>|</span><a href="#42363716">next</a><span>|</span><label class="collapse" for="c-42363573">[-]</label><label class="expand" for="c-42363573">[6 more]</label></div><br/><div class="children"><div class="content">Loving this. I wonder how people even come up with an idea of truncating hashes. For what purpose or benefit?</div><br/><div id="42363825" class="c"><input type="checkbox" id="c-42363825" checked=""/><div class="controls bullet"><span class="by">iforgotpassword</span><span>|</span><a href="#42363573">parent</a><span>|</span><a href="#42364123">next</a><span>|</span><label class="collapse" for="c-42363825">[-]</label><label class="expand" for="c-42363825">[1 more]</label></div><br/><div class="children"><div class="content">Truncated hash functions are not vulnerable to length-extension attacks. But you usually take SHA512 and truncate to 256 bits. Anything shorter than this isn&#x27;t really considered safe these days.</div><br/></div></div><div id="42364123" class="c"><input type="checkbox" id="c-42364123" checked=""/><div class="controls bullet"><span class="by">ajb</span><span>|</span><a href="#42363573">parent</a><span>|</span><a href="#42363825">prev</a><span>|</span><a href="#42363627">next</a><span>|</span><label class="collapse" for="c-42364123">[-]</label><label class="expand" for="c-42364123">[1 more]</label></div><br/><div class="children"><div class="content">According to the commit, they did it to reduce the length of the downloaded filename and URL.</div><br/></div></div><div id="42363627" class="c"><input type="checkbox" id="c-42363627" checked=""/><div class="controls bullet"><span class="by">ffk</span><span>|</span><a href="#42363573">parent</a><span>|</span><a href="#42364123">prev</a><span>|</span><a href="#42363799">next</a><span>|</span><label class="collapse" for="c-42363627">[-]</label><label class="expand" for="c-42363627">[1 more]</label></div><br/><div class="children"><div class="content">Sometimes it’s done to fit into an existing tool&#x2F;database that has a preexisting limit. Or when the hash is used only as a locator rather than for integrity.<p>Not a good practice imo but people are pragmatic.</div><br/></div></div><div id="42363799" class="c"><input type="checkbox" id="c-42363799" checked=""/><div class="controls bullet"><span class="by">bflesch</span><span>|</span><a href="#42363573">parent</a><span>|</span><a href="#42363627">prev</a><span>|</span><a href="#42363716">next</a><span>|</span><label class="collapse" for="c-42363799">[-]</label><label class="expand" for="c-42363799">[2 more]</label></div><br/><div class="children"><div class="content">when you upgrade from sha1 to sha256 but you don&#x27;t want to change your data format for storing the integrity checks &#x2F; keys.</div><br/><div id="42363838" class="c"><input type="checkbox" id="c-42363838" checked=""/><div class="controls bullet"><span class="by">epcoa</span><span>|</span><a href="#42363573">root</a><span>|</span><a href="#42363799">parent</a><span>|</span><a href="#42363716">next</a><span>|</span><label class="collapse" for="c-42363838">[-]</label><label class="expand" for="c-42363838">[1 more]</label></div><br/><div class="children"><div class="content">A SHA-1 is not 12 characters (either in digest bytes or hex nibbles)</div><br/></div></div></div></div></div></div><div id="42363716" class="c"><input type="checkbox" id="c-42363716" checked=""/><div class="controls bullet"><span class="by">daghamm</span><span>|</span><a href="#42363573">prev</a><span>|</span><a href="#42363617">next</a><span>|</span><label class="collapse" for="c-42363716">[-]</label><label class="expand" for="c-42363716">[5 more]</label></div><br/><div class="children"><div class="content">First of all, nice writeup. I am a bit surprised that so much GPU power was needed to find such short collision but it was nice to see his implementation nevertheless.<p>Regarding the last section, is 40k a reasonable price for one month of security analysis? Does this mean that a good security researcher make about 500k&#x2F;yr?</div><br/><div id="42364246" class="c"><input type="checkbox" id="c-42364246" checked=""/><div class="controls bullet"><span class="by">rfoo</span><span>|</span><a href="#42363716">parent</a><span>|</span><a href="#42363756">next</a><span>|</span><label class="collapse" for="c-42364246">[-]</label><label class="expand" for="c-42364246">[1 more]</label></div><br/><div class="children"><div class="content">&gt; so much GPU power was needed<p>In post-LLM age one hour of compute on a 4090 is closer to &quot;so less&quot; than &quot;so much&quot;. You can have that for less than $1.</div><br/></div></div><div id="42363756" class="c"><input type="checkbox" id="c-42363756" checked=""/><div class="controls bullet"><span class="by">bigiain</span><span>|</span><a href="#42363716">parent</a><span>|</span><a href="#42364246">prev</a><span>|</span><a href="#42363919">next</a><span>|</span><label class="collapse" for="c-42363756">[-]</label><label class="expand" for="c-42363756">[1 more]</label></div><br/><div class="children"><div class="content">It means a good security research company might make $500k for a good researcher, if they could bring in enough work to keep them 100% utilised. Less actually, given paid time off.</div><br/></div></div><div id="42363919" class="c"><input type="checkbox" id="c-42363919" checked=""/><div class="controls bullet"><span class="by">Bluecobra</span><span>|</span><a href="#42363716">parent</a><span>|</span><a href="#42363756">prev</a><span>|</span><a href="#42363793">next</a><span>|</span><label class="collapse" for="c-42363919">[-]</label><label class="expand" for="c-42363919">[1 more]</label></div><br/><div class="children"><div class="content">That seems very reasonable to me. It seems like the pentest companies I have worked with in the past charge that much and just do a lazy nmap&#x2F;metasploit scan and wrap it into a nice PDF.</div><br/></div></div><div id="42363793" class="c"><input type="checkbox" id="c-42363793" checked=""/><div class="controls bullet"><span class="by">barbegal</span><span>|</span><a href="#42363716">parent</a><span>|</span><a href="#42363919">prev</a><span>|</span><a href="#42363617">next</a><span>|</span><label class="collapse" for="c-42363793">[-]</label><label class="expand" for="c-42363793">[1 more]</label></div><br/><div class="children"><div class="content">2^(12*4) is 281,474,976,710,656 possible 12 character strings so seriously impressive that it can look through that many in an hour.</div><br/></div></div></div></div><div id="42363617" class="c"><input type="checkbox" id="c-42363617" checked=""/><div class="controls bullet"><span class="by">teleforce</span><span>|</span><a href="#42363716">prev</a><span>|</span><a href="#42363380">next</a><span>|</span><label class="collapse" for="c-42363617">[-]</label><label class="expand" for="c-42363617">[1 more]</label></div><br/><div class="children"><div class="content">&gt;I immediately noticed that the length of the hash is truncated to 12, out of 64 characters.<p>Ouch...</div><br/></div></div><div id="42363380" class="c"><input type="checkbox" id="c-42363380" checked=""/><div class="controls bullet"><span class="by">rekttrader</span><span>|</span><a href="#42363617">prev</a><span>|</span><a href="#42363281">next</a><span>|</span><label class="collapse" for="c-42363380">[-]</label><label class="expand" for="c-42363380">[1 more]</label></div><br/><div class="children"><div class="content">Killer write up, very clever bit of code reading and exploit development.</div><br/></div></div><div id="42363281" class="c"><input type="checkbox" id="c-42363281" checked=""/><div class="controls bullet"><span class="by">efitz</span><span>|</span><a href="#42363380">prev</a><span>|</span><a href="#42363790">next</a><span>|</span><label class="collapse" for="c-42363281">[-]</label><label class="expand" for="c-42363281">[1 more]</label></div><br/><div class="children"><div class="content">Very well written and easy to follow description of your attack.</div><br/></div></div><div id="42363790" class="c"><input type="checkbox" id="c-42363790" checked=""/><div class="controls bullet"><span class="by">krige</span><span>|</span><a href="#42363281">prev</a><span>|</span><a href="#42363310">next</a><span>|</span><label class="collapse" for="c-42363790">[-]</label><label class="expand" for="c-42363790">[1 more]</label></div><br/><div class="children"><div class="content">What&#x27;s this about hashcat performance being orders of magnitude different depending on arg order? Is it scanning the argument line for target pattern with every execution?</div><br/></div></div><div id="42363310" class="c"><input type="checkbox" id="c-42363310" checked=""/><div class="controls bullet"><span class="by">renewiltord</span><span>|</span><a href="#42363790">prev</a><span>|</span><label class="collapse" for="c-42363310">[-]</label><label class="expand" for="c-42363310">[1 more]</label></div><br/><div class="children"><div class="content">Nicely done. Good write up too. I liked the bits about making hashcat do what you wanted.</div><br/></div></div></div></div></div></div></div></body></html>