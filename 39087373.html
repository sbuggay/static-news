<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1706000462890" as="style"/><link rel="stylesheet" href="styles.css?v=1706000462890"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://iter.ca/post/rust-skip-borrowck/">Turning off Rust&#x27;s borrow checker completely (2022)</a> <span class="domain">(<a href="https://iter.ca">iter.ca</a>)</span></div><div class="subtext"><span>voxal</span> | <span>20 comments</span></div><br/><div><div id="39101071" class="c"><input type="checkbox" id="c-39101071" checked=""/><div class="controls bullet"><span class="by">YetAnotherNick</span><span>|</span><a href="#39101042">next</a><span>|</span><label class="collapse" for="c-39101071">[-]</label><label class="expand" for="c-39101071">[1 more]</label></div><br/><div class="children"><div class="content">I have limited experience with Rust and the combination of slow compile time and borrow checker is irritating. My rust code was less than a thousand lines and it takes like 10-20 seconds to compile.<p>Rust really made me appreciate garbage collection after the number of times I resorted to things like Arc&lt;Box&lt;..&gt;&gt;.</div><br/></div></div><div id="39101042" class="c"><input type="checkbox" id="c-39101042" checked=""/><div class="controls bullet"><span class="by">dvt</span><span>|</span><a href="#39101071">prev</a><span>|</span><a href="#39095874">next</a><span>|</span><label class="collapse" for="c-39101042">[-]</label><label class="expand" for="c-39101042">[1 more]</label></div><br/><div class="children"><div class="content">I found the source code of the macro cited[1][2] way more interesting than the article. It&#x27;s not that big of a deal to find where compilation error counts are incremented in the compiler and just, you know, not increment them. The macro is pretty cool though (turning bounded into unbounded lifetimes).<p>[1] <a href="https:&#x2F;&#x2F;docs.rs&#x2F;you-can-build-macros&#x2F;0.0.14&#x2F;src&#x2F;you_can_build_macros&#x2F;lib.rs.html#33" rel="nofollow">https:&#x2F;&#x2F;docs.rs&#x2F;you-can-build-macros&#x2F;0.0.14&#x2F;src&#x2F;you_can_buil...</a><p>[2] <a href="https:&#x2F;&#x2F;docs.rs&#x2F;you-can&#x2F;latest&#x2F;src&#x2F;you_can&#x2F;lib.rs.html#17-25" rel="nofollow">https:&#x2F;&#x2F;docs.rs&#x2F;you-can&#x2F;latest&#x2F;src&#x2F;you_can&#x2F;lib.rs.html#17-25</a></div><br/></div></div><div id="39093061" class="c"><input type="checkbox" id="c-39093061" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39095874">prev</a><span>|</span><label class="collapse" for="c-39093061">[-]</label><label class="expand" for="c-39093061">[16 more]</label></div><br/><div class="children"><div class="content">I’ve only done some small PRs in rust to help fix some bugs. I don’t understand the borrow checker but it got in the way more often than not (say to output some debugging data and carry on). I hated it and it turned me off from doing anything serious with it.</div><br/><div id="39095711" class="c"><input type="checkbox" id="c-39095711" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#39093061">parent</a><span>|</span><a href="#39098151">next</a><span>|</span><label class="collapse" for="c-39095711">[-]</label><label class="expand" for="c-39095711">[10 more]</label></div><br/><div class="children"><div class="content">So the borrow checker is not necessary in Rust?</div><br/><div id="39095876" class="c"><input type="checkbox" id="c-39095876" checked=""/><div class="controls bullet"><span class="by">trklausss</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39095711">parent</a><span>|</span><a href="#39096073">next</a><span>|</span><label class="collapse" for="c-39095876">[-]</label><label class="expand" for="c-39095876">[1 more]</label></div><br/><div class="children"><div class="content">Not at all, you can encase everything on an “unsafe” block and live happy.<p>However you won’t have Rust’s guarantees of fearless concurrency and you expose yourself to other defects related to memory (free after use etc.)<p>If you understand the language, you even program much of the std libraries with unsafe code in them.<p>For more info you can consult the Rustonomicon.</div><br/></div></div><div id="39096073" class="c"><input type="checkbox" id="c-39096073" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39095711">parent</a><span>|</span><a href="#39095876">prev</a><span>|</span><a href="#39098151">next</a><span>|</span><label class="collapse" for="c-39096073">[-]</label><label class="expand" for="c-39096073">[8 more]</label></div><br/><div class="children"><div class="content">Technically the borrow checker only limits the set of valid programs and is not involved with compilation.<p>So if you can write perfectly correct code then you never have to deal with it. Just like when you write perfectly correct syntax you never have to work with the syntax checker.</div><br/><div id="39096432" class="c"><input type="checkbox" id="c-39096432" checked=""/><div class="controls bullet"><span class="by">steveklabnik</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39096073">parent</a><span>|</span><a href="#39098151">next</a><span>|</span><label class="collapse" for="c-39096432">[-]</label><label class="expand" for="c-39096432">[7 more]</label></div><br/><div class="children"><div class="content">To be a bit more precise: the borrow checker does not change the code generation part of the compiler. If you modified rustc to skip borrow checking, and you passed it a valid Rust program, you would get identical output.<p>However, that doesn&#x27;t mean that you can disregard the semantic rules that it enforces. It is &quot;involved in compilation&quot; in that sense. Even when writing unsafe code, you are expected to keep up the invariants that the language requires, and the rules of the borrow checker are one part of those invariants.</div><br/><div id="39097522" class="c"><input type="checkbox" id="c-39097522" checked=""/><div class="controls bullet"><span class="by">pests</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39096432">parent</a><span>|</span><a href="#39098151">next</a><span>|</span><label class="collapse" for="c-39097522">[-]</label><label class="expand" for="c-39097522">[6 more]</label></div><br/><div class="children"><div class="content">Yes thank you. That was my underlying point without explicitly saying it.<p>That the borrow checker does not influence compilation and just determines if a program is valid or not.<p>Just like you can ignore the syntax checker of languages as long as you never give it incorrect syntax.<p>I guess my core concept is that you wouldn&#x27;t do these things because they provide value. And that removing the rust borrow checker without restricting what programs you write does not make sense just like trying to pass incorrect syntax to a compiler with the syntax checker removed.<p>That to remove the borrow checker would still require you to still follow all the rules of the borrow checker! Now you just don&#x27;t know if you did it correctly or not.</div><br/><div id="39100007" class="c"><input type="checkbox" id="c-39100007" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39097522">parent</a><span>|</span><a href="#39100233">next</a><span>|</span><label class="collapse" for="c-39100007">[-]</label><label class="expand" for="c-39100007">[4 more]</label></div><br/><div class="children"><div class="content">Sometimes, especially when debugging, you don’t care about being “correct,” freeing memory properly, or any other safeties. You just want to narrow down where a bug is in the code so you can start stepping through the right parts and see what is going on.</div><br/><div id="39100132" class="c"><input type="checkbox" id="c-39100132" checked=""/><div class="controls bullet"><span class="by">nickm12</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39100007">parent</a><span>|</span><a href="#39100233">next</a><span>|</span><label class="collapse" for="c-39100132">[-]</label><label class="expand" for="c-39100132">[3 more]</label></div><br/><div class="children"><div class="content">You&#x27;re putting &quot;correctness&quot; in quotes as though it is a matter of being polite to the machine. The Rust compilation process depends on these invariants so that the code actually executes as written (specifically, has no undefined behavior). I&#x27;d argue there is never a very good time to expose your program to undefined behavior, but when you&#x27;re trying to debug an issue is a particularly bad time.<p>Rust as a language aims to move bugs &quot;to the left&quot; through a stricter compiler. The promise is an environment where building things takes longer, but the things you build are more reliable and the net amount of time debugging (and being exposed to production bugs) is lower.</div><br/><div id="39100225" class="c"><input type="checkbox" id="c-39100225" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39100132">parent</a><span>|</span><a href="#39100233">next</a><span>|</span><label class="collapse" for="c-39100225">[-]</label><label class="expand" for="c-39100225">[2 more]</label></div><br/><div class="children"><div class="content">It is a matter of being polite when it comes to semantics. Weird is English written in obtuse grammar, but it is still legible. Undefined behavior still compiles into _something_, and if it’s after the code I care about observing, it doesn’t matter. The very first C++ templates compilation was observed through undefined behavior and errors. If you don’t have some way to “escape” from proper semantics, just to experiment, then the language is useless unless you know exactly what you are building before you build it.<p>I guess that makes sense, now that I think about it. I see lots of “rewrite in rust!” But not a lot of new (from whole cloth, innovative) projects from rust. Then again, I’m not really in the rust community or do much in rust except a PR every year or so.</div><br/><div id="39101007" class="c"><input type="checkbox" id="c-39101007" checked=""/><div class="controls bullet"><span class="by">charlotte-fyi</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39100225">parent</a><span>|</span><a href="#39100233">next</a><span>|</span><label class="collapse" for="c-39101007">[-]</label><label class="expand" for="c-39101007">[1 more]</label></div><br/><div class="children"><div class="content">&gt; and if it’s after the code I care about observing, it doesn’t matter<p>That&#x27;s not how undefined behavior works, though. Undefined behavior doesn&#x27;t have an &quot;after.&quot; By definition it leaves your entire program in an undefined state, which means its behavior cannot be reasoned about temporally or spatially in this way. Sure, in a simple or trivial case you might &quot;get lucky&quot;, but merely by introducing undefined behavior you are no longer capable of observing the code you care about correctly.</div><br/></div></div></div></div></div></div></div></div><div id="39100233" class="c"><input type="checkbox" id="c-39100233" checked=""/><div class="controls bullet"><span class="by">sudosysgen</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39097522">parent</a><span>|</span><a href="#39100007">prev</a><span>|</span><a href="#39098151">next</a><span>|</span><label class="collapse" for="c-39100233">[-]</label><label class="expand" for="c-39100233">[1 more]</label></div><br/><div class="children"><div class="content">The borrow checker doesn&#x27;t determine whether a program is valid or not (if by valid you mean safe). It can be proven that doing so is actually imposible. What it does is that it attempts to prove that your program is valid, but will fail unless the proof is trivial, and it never tries to prove that your program is invalid.<p>The point is that you, the programmer, has intelligence and creativity and can prove that some programs are valid, while the borrow checker wouldn&#x27;t be able to. So the set of rules you&#x27;d follow might be different. This is true, in theory, of many programmers in C++ for example, with the drawback that you might have made a mistake in your proof to yourself.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="39098151" class="c"><input type="checkbox" id="c-39098151" checked=""/><div class="controls bullet"><span class="by">Klonoar</span><span>|</span><a href="#39093061">parent</a><span>|</span><a href="#39095711">prev</a><span>|</span><label class="collapse" for="c-39098151">[-]</label><label class="expand" for="c-39098151">[5 more]</label></div><br/><div class="children"><div class="content">You can’t really hate something that you profess to not deeply understand.</div><br/><div id="39100439" class="c"><input type="checkbox" id="c-39100439" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39098151">parent</a><span>|</span><a href="#39101065">next</a><span>|</span><label class="collapse" for="c-39100439">[-]</label><label class="expand" for="c-39100439">[1 more]</label></div><br/><div class="children"><div class="content">I can hate something for any reason I wish. They are my feelings that I wield. Who are you to tell me what I can and cannot feel?</div><br/></div></div><div id="39098942" class="c"><input type="checkbox" id="c-39098942" checked=""/><div class="controls bullet"><span class="by">austinjp</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39098151">parent</a><span>|</span><a href="#39101065">prev</a><span>|</span><a href="#39101056">next</a><span>|</span><label class="collapse" for="c-39098942">[-]</label><label class="expand" for="c-39098942">[1 more]</label></div><br/><div class="children"><div class="content">Sure, but you can think you hate it, and practically speaking what&#x27;s the difference?</div><br/></div></div><div id="39101056" class="c"><input type="checkbox" id="c-39101056" checked=""/><div class="controls bullet"><span class="by">josephg</span><span>|</span><a href="#39093061">root</a><span>|</span><a href="#39098151">parent</a><span>|</span><a href="#39098942">prev</a><span>|</span><label class="collapse" for="c-39101056">[-]</label><label class="expand" for="c-39101056">[1 more]</label></div><br/><div class="children"><div class="content">Of course you can. In fact, I think it’s often much easier to hate something when you don’t understand it fully.<p>But in this case, the GP was describing their experience programming with the borrow checker as a new rust programmer. Hatred is an emotion. It’s not up to you or me to decide if that feeling is present in someone else’s brain.</div><br/></div></div></div></div></div></div></div></div></div></div></div></body></html>