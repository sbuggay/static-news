<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1701766854762" as="style"/><link rel="stylesheet" href="styles.css?v=1701766854762"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://jvns.ca/blog/2023/12/04/mounting-git-commits-as-folders-with-nfs/">Mounting Git commits as folders with NFS</a> <span class="domain">(<a href="https://jvns.ca">jvns.ca</a>)</span></div><div class="subtext"><span>chmaynard</span> | <span>14 comments</span></div><br/><div><div id="38528165" class="c"><input type="checkbox" id="c-38528165" checked=""/><div class="controls bullet"><span class="by">mbakke</span><span>|</span><a href="#38528151">next</a><span>|</span><label class="collapse" for="c-38528165">[-]</label><label class="expand" for="c-38528165">[3 more]</label></div><br/><div class="children"><div class="content">For those who resonate with &quot;why might this be useful&quot;, here are &quot;plain git&quot; alternatives to this tool:<p>&gt; searching for a function I deleted<p><pre><code>    git log -G someFunc
</code></pre>
&gt; quickly looking at a file on another branch to copy a line from it<p>I use `git worktree` to &quot;mount&quot; long-running branches much to the same effect as Julias tool. To quickly look at a file from a non-mounted branch&#x2F;commit, I use:<p><pre><code>    git show $REF:$FILENAME
</code></pre>
&gt; searching every branch for a function<p><pre><code>    git log --all -G someFunc
</code></pre>
Note that -G can be replaced with -F for a speedup if the pattern you are searching for is a fixed string.</div><br/><div id="38528386" class="c"><input type="checkbox" id="c-38528386" checked=""/><div class="controls bullet"><span class="by">globular-toast</span><span>|</span><a href="#38528165">parent</a><span>|</span><a href="#38528173">next</a><span>|</span><label class="collapse" for="c-38528386">[-]</label><label class="expand" for="c-38528386">[1 more]</label></div><br/><div class="children"><div class="content">Magit has a really easy to use way to &quot;step&quot; through previous versions of files. It&#x27;s usually bound to something like &quot;C-f p&quot;. You get a read only buffer of the previous version open in the best text editor (emacs). You can then press n and p to step through next and previous versions of that file. Can be pretty useful!<p>It&#x27;s kind of funny, I think, how most git users don&#x27;t seem to know how to access any version other than the current one. So many people think of it simply as the annoying tool you have to use to make code changes but don&#x27;t really know what version control is.</div><br/></div></div><div id="38528173" class="c"><input type="checkbox" id="c-38528173" checked=""/><div class="controls bullet"><span class="by">levidos</span><span>|</span><a href="#38528165">parent</a><span>|</span><a href="#38528386">prev</a><span>|</span><a href="#38528151">next</a><span>|</span><label class="collapse" for="c-38528173">[-]</label><label class="expand" for="c-38528173">[1 more]</label></div><br/><div class="children"><div class="content">Extremely handy, saving these. Thank you.</div><br/></div></div></div></div><div id="38528151" class="c"><input type="checkbox" id="c-38528151" checked=""/><div class="controls bullet"><span class="by">masklinn</span><span>|</span><a href="#38528165">prev</a><span>|</span><a href="#38528461">next</a><span>|</span><label class="collapse" for="c-38528151">[-]</label><label class="expand" for="c-38528151">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Git repositories sometimes have submodules. I don’t understand anything about submodules so right now I’m just ignoring them.<p>Submodules are interesting, because they’re next to unusable from a user perspective (they’re a pain to maintain and interact with unless you never ever update them) but they’re ridiculously simple technically which I assume is what made them attractive.<p>A submodule is an entry in “.gitmodules” mapping a path to a repository URL (and branch), then at the specified path in the repository is a tree entry of mode 160000 (S_IFDIR + S_IFLNK), whose oid is the commit to check out (in the submodule-linked repository).</div><br/><div id="38528301" class="c"><input type="checkbox" id="c-38528301" checked=""/><div class="controls bullet"><span class="by">AceJohnny2</span><span>|</span><a href="#38528151">parent</a><span>|</span><a href="#38528461">next</a><span>|</span><label class="collapse" for="c-38528301">[-]</label><label class="expand" for="c-38528301">[1 more]</label></div><br/><div class="children"><div class="content">To add to this, Submodules are a hack on Git&#x27;s data model.<p>Git&#x27;s data model, put simply, is this:<p>* Branches are pointers to Commit objects<p>* Commit objects are a composite of {Commit_Comment, Tree, Parent Commit(s)}, referenced by the hash of that set<p>* a Tree (like a directory) is a list of Blobs and&#x2F;or Trees (associating filenames with them) referenced by the hash of its contents.<p>* a Blob is a file, referenced by the hash of its contents.<p>So the set of types of objects in Git are: Commits, Trees, and Blobs.<p>Note that I said that a Tree can contain other Trees or Blobs... but what if... you put a Commit in it!?<p>That&#x27;s a submodule!<p>Now if the Commit you reference doesn&#x27;t exist in the current repo, Git can&#x27;t do anything with it. That&#x27;s where the <i>.gitmodules</i> file comes in, to associate a given path with a repo, so that Git can look up the Commit object in that repo.</div><br/></div></div></div></div><div id="38528461" class="c"><input type="checkbox" id="c-38528461" checked=""/><div class="controls bullet"><span class="by">kristopolous</span><span>|</span><a href="#38528151">prev</a><span>|</span><a href="#38528049">next</a><span>|</span><label class="collapse" for="c-38528461">[-]</label><label class="expand" for="c-38528461">[1 more]</label></div><br/><div class="children"><div class="content">This reminds me of the SVN days.</div><br/></div></div><div id="38528049" class="c"><input type="checkbox" id="c-38528049" checked=""/><div class="controls bullet"><span class="by">reverius42</span><span>|</span><a href="#38528461">prev</a><span>|</span><a href="#38528093">next</a><span>|</span><label class="collapse" for="c-38528049">[-]</label><label class="expand" for="c-38528049">[3 more]</label></div><br/><div class="children"><div class="content">Very nice! I really like the design choices here. Though I (edit: am biased and) would personally have used Rust and <a href="https:&#x2F;&#x2F;github.com&#x2F;xetdata&#x2F;nfsserve">https:&#x2F;&#x2F;github.com&#x2F;xetdata&#x2F;nfsserve</a>.</div><br/><div id="38528459" class="c"><input type="checkbox" id="c-38528459" checked=""/><div class="controls bullet"><span class="by">rapnie</span><span>|</span><a href="#38528049">parent</a><span>|</span><a href="#38528072">next</a><span>|</span><label class="collapse" for="c-38528459">[-]</label><label class="expand" for="c-38528459">[1 more]</label></div><br/><div class="children"><div class="content">Functional but not complete. The project is looking for maintainers. Overall it is a pity how so many potentially great Rust projects are inactive and left in incomplete state.</div><br/></div></div><div id="38528072" class="c"><input type="checkbox" id="c-38528072" checked=""/><div class="controls bullet"><span class="by">eru</span><span>|</span><a href="#38528049">parent</a><span>|</span><a href="#38528459">prev</a><span>|</span><a href="#38528093">next</a><span>|</span><label class="collapse" for="c-38528072">[-]</label><label class="expand" for="c-38528072">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve built something like this as well, but in FUSE for Linux, not via NFS.<p>It really brings home how close git&#x27;s design already is to being a file system.</div><br/></div></div></div></div><div id="38528093" class="c"><input type="checkbox" id="c-38528093" checked=""/><div class="controls bullet"><span class="by">trollied</span><span>|</span><a href="#38528049">prev</a><span>|</span><a href="#38528225">next</a><span>|</span><label class="collapse" for="c-38528093">[-]</label><label class="expand" for="c-38528093">[3 more]</label></div><br/><div class="children"><div class="content">Reminds me of Rational ClearCase, which probably inspired the idea. You could specify a &quot;view&quot; using tags, and it&#x27;d present it as a filesystem to remote machines.<p>I think IBM now own them.</div><br/><div id="38528360" class="c"><input type="checkbox" id="c-38528360" checked=""/><div class="controls bullet"><span class="by">bigstrat2003</span><span>|</span><a href="#38528093">parent</a><span>|</span><a href="#38528375">next</a><span>|</span><label class="collapse" for="c-38528360">[-]</label><label class="expand" for="c-38528360">[1 more]</label></div><br/><div class="children"><div class="content">It also reminds me of ClearCase, which is why I kind of hate this, lol. ClearCase is fucking <i>awful</i> to work with, the last thing I want is to turn git into it.</div><br/></div></div><div id="38528375" class="c"><input type="checkbox" id="c-38528375" checked=""/><div class="controls bullet"><span class="by">roca</span><span>|</span><a href="#38528093">parent</a><span>|</span><a href="#38528360">prev</a><span>|</span><a href="#38528225">next</a><span>|</span><label class="collapse" for="c-38528375">[-]</label><label class="expand" for="c-38528375">[1 more]</label></div><br/><div class="children"><div class="content">IBM bought them in 2003.</div><br/></div></div></div></div><div id="38528225" class="c"><input type="checkbox" id="c-38528225" checked=""/><div class="controls bullet"><span class="by">okl</span><span>|</span><a href="#38528093">prev</a><span>|</span><label class="collapse" for="c-38528225">[-]</label><label class="expand" for="c-38528225">[1 more]</label></div><br/><div class="children"><div class="content">Git already has a similar feature. It&#x27;s called worktree <a href="https:&#x2F;&#x2F;git-scm.com&#x2F;docs&#x2F;git-worktree" rel="nofollow noreferrer">https:&#x2F;&#x2F;git-scm.com&#x2F;docs&#x2F;git-worktree</a><p>For example: `git worktree add &lt;folder&gt; &lt;commit-hash&gt;` checks out that commit in that folder.</div><br/></div></div></div></div></div></div></div></body></html>