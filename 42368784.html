<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1733821280183" as="style"/><link rel="stylesheet" href="styles.css?v=1733821280183"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://swarm.ptsecurity.com/new-dog-old-tricks-damagecard-attack-targets-memory-directly-thru-sd-card-reader/">New dog, old trick: DaMAgeCard attack targets memory directly via SD card reader</a>Â <span class="domain">(<a href="https://swarm.ptsecurity.com">swarm.ptsecurity.com</a>)</span></div><div class="subtext"><span>thebeardisred</span> | <span>18 comments</span></div><br/><div><div id="42374294" class="c"><input type="checkbox" id="c-42374294" checked=""/><div class="controls bullet"><span class="by">Animats</span><span>|</span><a href="#42369864">next</a><span>|</span><label class="collapse" for="c-42374294">[-]</label><label class="expand" for="c-42374294">[1 more]</label></div><br/><div class="children"><div class="content">FireWire had a backdoor into memory. FireWire isn&#x27;t a &quot;bus&quot;, it&#x27;s a local area network. Mostly you send packets around. IP over Firewire was a thing. But there are also built-in packets to read and write memory, one word at a time.
That&#x27;s how commands are sent. This probably made sense to people who thought in terms of device registers, rather than a command with parameters.<p>There&#x27;s a register in most Firewire controllers where you can set the address bounds for which that function is available. I once noted that the hard-coded default values for Linux were 0 .. 2^32-1, that is, the first 4GB. I reported this as a security bug and was told it was needed for the kernel debugger.<p>Sigh.</div><br/></div></div><div id="42369864" class="c"><input type="checkbox" id="c-42369864" checked=""/><div class="controls bullet"><span class="by">Syonyk</span><span>|</span><a href="#42374294">prev</a><span>|</span><a href="#42372792">next</a><span>|</span><label class="collapse" for="c-42369864">[-]</label><label class="expand" for="c-42369864">[11 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a solid writeup on the history of external DMA attacks!  Very nicely done, and well worth a read.<p>This sort of thing is why QubesOS tends to put hardware controllers in isolated VMs and only pass access through.  With a working IOMMU (any modern hardware has this), all you can get is DMA access into a VM that doesn&#x27;t actually have much of interest in it, and no access into other VMs...<p>&#x2F;&#x2F;EDIT: Though at a closer read, there&#x27;s some that... isn&#x27;t quite right, in how terms and examples are done.  I&#x27;d expect better from someone doing low level security work - INB copies to a general purpose register, not a memory address, a DMA controller is a &quot;discrete&quot; bit of hardware, it&#x27;s not very &quot;discreet,&quot; etc.  I&#x27;m not sure.  This is starting to feel very AI-assisted to me.  The overall concepts are fine, but a lot of the background section doesn&#x27;t read reasonably, or goes off into weird weeds and... never explores them.  The Intel Xeon is not a less exotic example of a DMA controller.  The PC&#x2F;AT platform did not have a PCI bus.<p>Eh.  I remain convinced it&#x27;s a decent enough overview of the matter, but a lot of the details just read really weird to me in the background sections.  To the point that this could be an interview discussion question.  &quot;What does this get subtly wrong?&quot;</div><br/><div id="42371015" class="c"><input type="checkbox" id="c-42371015" checked=""/><div class="controls bullet"><span class="by">gesser</span><span>|</span><a href="#42369864">parent</a><span>|</span><a href="#42370318">next</a><span>|</span><label class="collapse" for="c-42371015">[-]</label><label class="expand" for="c-42371015">[3 more]</label></div><br/><div class="children"><div class="content">Thank you for noticing (and reading at all). We&#x27;ll try to fix these asap. &quot;INB&quot; is a genuine mistake, &quot;PC&#x2F;AT&quot; should be &quot;PS&#x2F;2&quot; and &quot;discreet&quot; is a translation error.<p>Some Xeon chips have additional DMA controllers &quot;onboard&quot;.<p>No AI was used, each mistake here is handmade with love and 100% organic :) 
We wanted to give a decent (but not too deep) historical overview, however first and foremost we introduce new vector to conduct the attack.</div><br/><div id="42374846" class="c"><input type="checkbox" id="c-42374846" checked=""/><div class="controls bullet"><span class="by">trollbridge</span><span>|</span><a href="#42369864">root</a><span>|</span><a href="#42371015">parent</a><span>|</span><a href="#42371485">next</a><span>|</span><label class="collapse" for="c-42374846">[-]</label><label class="expand" for="c-42374846">[1 more]</label></div><br/><div class="children"><div class="content">Generally speaking, PS&#x2F;2s did not have a PCI bus either, although some of them did have an ISA bus.<p>(Both ISA and PS&#x2F;2 microchannel would allow busmastering of exactly what your article describes, though, so the point might as well stand - for that matter, so would other buses like EISA and VESA local bus.)</div><br/></div></div><div id="42371485" class="c"><input type="checkbox" id="c-42371485" checked=""/><div class="controls bullet"><span class="by">Syonyk</span><span>|</span><a href="#42369864">root</a><span>|</span><a href="#42371015">parent</a><span>|</span><a href="#42374846">prev</a><span>|</span><a href="#42370318">next</a><span>|</span><label class="collapse" for="c-42371485">[-]</label><label class="expand" for="c-42371485">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for responding!  Welcome to HN!<p>I write long form text posts as well, so I appreciate the format.  It just had a number of things that didn&#x27;t seem quite right to me, being in similar deep technical weeds.<p>Now try the attack on Qubes. ;)</div><br/></div></div></div></div><div id="42370318" class="c"><input type="checkbox" id="c-42370318" checked=""/><div class="controls bullet"><span class="by">assusdan</span><span>|</span><a href="#42369864">parent</a><span>|</span><a href="#42371015">prev</a><span>|</span><a href="#42371698">next</a><span>|</span><label class="collapse" for="c-42370318">[-]</label><label class="expand" for="c-42370318">[2 more]</label></div><br/><div class="children"><div class="content">Russian version of this article, published slightly earlier AFAIU ( <a href="https:&#x2F;&#x2F;habr.com&#x2F;ru&#x2F;companies&#x2F;pt&#x2F;articles&#x2F;863536&#x2F;" rel="nofollow">https:&#x2F;&#x2F;habr.com&#x2F;ru&#x2F;companies&#x2F;pt&#x2F;articles&#x2F;863536&#x2F;</a> ) does not look very AI-assisted, but still contains some of the weird moments you mentioned.<p>&quot;discreet&quot; looks like translation error, in russian version word &quot;special&quot; is used. PC&#x2F;AT is still there, as well as Xeon example (latter does not seem &quot;not quite right&quot; to me)</div><br/><div id="42370487" class="c"><input type="checkbox" id="c-42370487" checked=""/><div class="controls bullet"><span class="by">Syonyk</span><span>|</span><a href="#42369864">root</a><span>|</span><a href="#42370318">parent</a><span>|</span><a href="#42371698">next</a><span>|</span><label class="collapse" for="c-42370487">[-]</label><label class="expand" for="c-42370487">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, there were a few words early on that struck me as &quot;This is a non-native English speaker&quot; sort of translation issues, which don&#x27;t bother me in technical writing like this.  But when they started doing INB&#x2F;OUTB examples as memory addressed instructions, vs copying into a register... I get the point being made, but also, that&#x27;s not a translation error.  Don&#x27;t use the &quot;This is an actual instruction&quot; font if you&#x27;re not quoting actual instructions that exist on the hardware.  &quot;inb 0x8, 0xFF&quot; is not a valid x86 instruction, not even close.<p>Anyway, I&#x27;d also like to see some of their source, or hardware diagrams, but... it&#x27;ll come out eventually, I suppose.<p>Proper IOMMU configuration and assigning anything with DMA to a disposable service VM still solves a lot, though at least these attacks require physical access.  So far.  I&#x27;m sure someone, at some point, will release a SD Express card with awful enough firmware that you can pivot through it for a software-only attack on this sort of system.</div><br/></div></div></div></div><div id="42371698" class="c"><input type="checkbox" id="c-42371698" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#42369864">parent</a><span>|</span><a href="#42370318">prev</a><span>|</span><a href="#42370444">next</a><span>|</span><label class="collapse" for="c-42371698">[-]</label><label class="expand" for="c-42371698">[1 more]</label></div><br/><div class="children"><div class="content">With a working IOMMU (any modern hardware has this)...<p>I agree with the &quot;IOMMU&quot; part, but my experience with the &quot;working&quot; part is more hit-or-miss.</div><br/></div></div><div id="42370444" class="c"><input type="checkbox" id="c-42370444" checked=""/><div class="controls bullet"><span class="by">denotational</span><span>|</span><a href="#42369864">parent</a><span>|</span><a href="#42371698">prev</a><span>|</span><a href="#42373346">next</a><span>|</span><label class="collapse" for="c-42370444">[-]</label><label class="expand" for="c-42370444">[2 more]</label></div><br/><div class="children"><div class="content">&gt;  The Intel Xeon is not a less exotic example of a DMA controller.<p>The full context is:<p>&gt; The DMA controller is just used as an âmemcpy() hardware acceleratorâ. And this is not a joke. Sometimes those blocks are used in microcontrollers to copy large swathes of data inside RAM. A less exotic example of this we can mention are Intel Xeon platforms.<p>I interpreted this as a reference to the Data Streaming Accelerator (DSA) [1], which is a programmable DMA peripheral on the SoC that can be used to accelerate writes to and from I&#x2F;O devices (amongst other things).<p>[1] : <a href="https:&#x2F;&#x2F;www.intel.com&#x2F;content&#x2F;www&#x2F;us&#x2F;en&#x2F;products&#x2F;docs&#x2F;accelerator-engines&#x2F;data-streaming-accelerator.html" rel="nofollow">https:&#x2F;&#x2F;www.intel.com&#x2F;content&#x2F;www&#x2F;us&#x2F;en&#x2F;products&#x2F;docs&#x2F;accele...</a></div><br/><div id="42370497" class="c"><input type="checkbox" id="c-42370497" checked=""/><div class="controls bullet"><span class="by">Syonyk</span><span>|</span><a href="#42369864">root</a><span>|</span><a href="#42370444">parent</a><span>|</span><a href="#42373346">next</a><span>|</span><label class="collapse" for="c-42370497">[-]</label><label class="expand" for="c-42370497">[1 more]</label></div><br/><div class="children"><div class="content">But they never expand on that in the article.  They just drop the Xeon reference there, and carry on as though they&#x27;d never said a thing about a Xeon.<p>I agree, that&#x27;s probably what they&#x27;re referring to, but it was neither needed to make the points they were trying to make, nor expanded into something to further strengthen the points made.</div><br/></div></div></div></div><div id="42373346" class="c"><input type="checkbox" id="c-42373346" checked=""/><div class="controls bullet"><span class="by">bpye</span><span>|</span><a href="#42369864">parent</a><span>|</span><a href="#42370444">prev</a><span>|</span><a href="#42372792">next</a><span>|</span><label class="collapse" for="c-42373346">[-]</label><label class="expand" for="c-42373346">[2 more]</label></div><br/><div class="children"><div class="content">&gt; all you can get is DMA access into a VM that doesn&#x27;t actually have much of interest in it, and no access into other VMs...<p>Of course you have to ensure that you harden the interface between that VM and the host sufficiently.</div><br/><div id="42373488" class="c"><input type="checkbox" id="c-42373488" checked=""/><div class="controls bullet"><span class="by">Syonyk</span><span>|</span><a href="#42369864">root</a><span>|</span><a href="#42373346">parent</a><span>|</span><a href="#42372792">next</a><span>|</span><label class="collapse" for="c-42373488">[-]</label><label class="expand" for="c-42373488">[1 more]</label></div><br/><div class="children"><div class="content">Sure, this is literally the core of Qubes security model.  They run a massively stripped down Xen that eliminates a lot of the complex interfaces, the old legacy hardware emulation models, etc.  If you can pivot through Xen, you own Qubes entirely - you can get to Dom0, and do whatever you want.  They&#x27;ve gone very much out of their way to ensure that the VM to hypervisor interfaces are as limited as possible, and as hard as possible.</div><br/></div></div></div></div></div></div><div id="42372792" class="c"><input type="checkbox" id="c-42372792" checked=""/><div class="controls bullet"><span class="by">cjbprime</span><span>|</span><a href="#42369864">prev</a><span>|</span><a href="#42374802">next</a><span>|</span><label class="collapse" for="c-42372792">[-]</label><label class="expand" for="c-42372792">[1 more]</label></div><br/><div class="children"><div class="content">It would have been good to hear about whether there are still any mainstream computer platforms that ship with IOMMU off, since it is the mitigation here.</div><br/></div></div><div id="42374802" class="c"><input type="checkbox" id="c-42374802" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#42372792">prev</a><span>|</span><a href="#42372296">next</a><span>|</span><label class="collapse" for="c-42374802">[-]</label><label class="expand" for="c-42374802">[1 more]</label></div><br/><div class="children"><div class="content">DMA. The gift that keeps on giving.<p>God bless the blitter.<p>Fat Agnus be fat.</div><br/></div></div><div id="42372296" class="c"><input type="checkbox" id="c-42372296" checked=""/><div class="controls bullet"><span class="by">moreati</span><span>|</span><a href="#42374802">prev</a><span>|</span><a href="#42373865">next</a><span>|</span><label class="collapse" for="c-42372296">[-]</label><label class="expand" for="c-42372296">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m pleasantly surprised there are any devices supporting SD Express. I thought the standard had died on the vine. So Apple, please pull your finger out and include SD Express in the MBP models that have an SD slot.</div><br/></div></div><div id="42373865" class="c"><input type="checkbox" id="c-42373865" checked=""/><div class="controls bullet"><span class="by">speransky</span><span>|</span><a href="#42372296">prev</a><span>|</span><a href="#42370187">next</a><span>|</span><label class="collapse" for="c-42373865">[-]</label><label class="expand" for="c-42373865">[1 more]</label></div><br/><div class="children"><div class="content">Read like a novel, well done</div><br/></div></div></div></div></div></div></div></body></html>