<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1717578075940" as="style"/><link rel="stylesheet" href="styles.css?v=1717578075940"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://alexwlchan.net/2024/creating-a-safari-webarchive/">Creating a Safari webarchive from the command line</a> <span class="domain">(<a href="https://alexwlchan.net">alexwlchan.net</a>)</span></div><div class="subtext"><span>ingve</span> | <span>64 comments</span></div><br/><div><div id="40582808" class="c"><input type="checkbox" id="c-40582808" checked=""/><div class="controls bullet"><span class="by">donatj</span><span>|</span><a href="#40582526">next</a><span>|</span><label class="collapse" for="c-40582808">[-]</label><label class="expand" for="c-40582808">[1 more]</label></div><br/><div class="children"><div class="content">Hey hey, WebArchive. Haven&#x27;t thought about them in a long while. 11-ish years ago I was tasked with porting an existing dotnet application to PHP feature by feature. Their existing application had the strange ability to export reports to WebArchive.<p>I could find no pre-existing WebArchive package for PHP so I set forth building my own.<p>It&#x27;s ancient and creaky, but it got the job done<p>- <a href="https:&#x2F;&#x2F;github.com&#x2F;donatj&#x2F;Webarchive-PHP">https:&#x2F;&#x2F;github.com&#x2F;donatj&#x2F;Webarchive-PHP</a></div><br/></div></div><div id="40582526" class="c"><input type="checkbox" id="c-40582526" checked=""/><div class="controls bullet"><span class="by">janandonly</span><span>|</span><a href="#40582808">prev</a><span>|</span><a href="#40575554">next</a><span>|</span><label class="collapse" for="c-40582526">[-]</label><label class="expand" for="c-40582526">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve written before about the joys of saving webpages as PDF files for future (generations?) reference.<p>But having any other open&#x2F;known file format (like an all-containing HTML&#x2F;webarchive) will do the same trick just fine.</div><br/></div></div><div id="40575554" class="c"><input type="checkbox" id="c-40575554" checked=""/><div class="controls bullet"><span class="by">eltondegeneres</span><span>|</span><a href="#40582526">prev</a><span>|</span><a href="#40577085">next</a><span>|</span><label class="collapse" for="c-40575554">[-]</label><label class="expand" for="c-40575554">[28 more]</label></div><br/><div class="children"><div class="content">Is there a reason why you&#x27;d want to save archival material in a proprietary format? Wouldn&#x27;t it be better&#x2F;easier to use wget with the `--warc-file` flag?</div><br/><div id="40575730" class="c"><input type="checkbox" id="c-40575730" checked=""/><div class="controls bullet"><span class="by">alexwlchan</span><span>|</span><a href="#40575554">parent</a><span>|</span><a href="#40576056">next</a><span>|</span><label class="collapse" for="c-40575730">[-]</label><label class="expand" for="c-40575730">[17 more]</label></div><br/><div class="children"><div class="content">1&#x2F; Why not wget?<p>For this project I wanted a consistent file format for my entire collection.<p>I have a bunch of stuff I want to save which is behind paywalls&#x2F;logins&#x2F;clickthroughs that are tricky for wget to reach. I know I can hand wget a cookies file, but that’s mildly fiddly. I save those pages as Safari webarchive files, and then they can drop in alongside the files I’ve collected programatically. Then I can deal with all my saved pages as a homogeneous set, rather than being split into two formats.<p>Plus I couldn&#x27;t find anybody who&#x27;d done this, and it was fun :D<p>This is only for personal stuff where I know I&#x27;ll be using Safari&#x2F;macOS for the foreseeable future. I don&#x27;t envisage using this for anything professional, or a shared archive -- you&#x27;re right that a less proprietary format would be better in those contexts. I think I&#x27;m in a bit of a niche here.<p>(I&#x27;m honestly surprised this is on the front page; I didn&#x27;t think anybody else would be that interested.)<p>2&#x2F; Proprietary format: it is, but before I started I did some experiments to see what&#x27;s actually inside. It&#x27;s a binary plist and I can recover all the underlying HTML&#x2F;CSS&#x2F;JS files with Python, so I&#x27;m not totally hosed if Safari goes away.<p>Notes on that here: <a href="https:&#x2F;&#x2F;alexwlchan.net&#x2F;til&#x2F;2024&#x2F;whats-inside-safari-webarchive&#x2F;" rel="nofollow">https:&#x2F;&#x2F;alexwlchan.net&#x2F;til&#x2F;2024&#x2F;whats-inside-safari-webarchi...</a></div><br/><div id="40575874" class="c"><input type="checkbox" id="c-40575874" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575730">parent</a><span>|</span><a href="#40576056">next</a><span>|</span><label class="collapse" for="c-40575874">[-]</label><label class="expand" for="c-40575874">[16 more]</label></div><br/><div class="children"><div class="content"><i>I didn&#x27;t think anybody else would be that interested.</i><p>&#x27;Save the webpage as I see it in my browser&#x27; remains a surprisingly annoying and fiddly problem, especially programmatically, so the niche is probably a little roomier than you might initially suspect.</div><br/><div id="40576698" class="c"><input type="checkbox" id="c-40576698" checked=""/><div class="controls bullet"><span class="by">DaSHacka</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575874">parent</a><span>|</span><a href="#40579288">next</a><span>|</span><label class="collapse" for="c-40576698">[-]</label><label class="expand" for="c-40576698">[5 more]</label></div><br/><div class="children"><div class="content">&gt; &#x27;Save the webpage as I see it in my browser&#x27; remains a surprisingly annoying and fiddly problem<p>You may be interested in SingleFile[1]<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile">https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile</a><p>I use it all the time to archive webpages, and I imagine it wouldn&#x27;t be hard to throw together a script to use FireFox&#x27;s headless mode in combination with SingleFile to selfhost a clone of the wayback machine.</div><br/><div id="40580315" class="c"><input type="checkbox" id="c-40580315" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576698">parent</a><span>|</span><a href="#40576781">next</a><span>|</span><label class="collapse" for="c-40580315">[-]</label><label class="expand" for="c-40580315">[1 more]</label></div><br/><div class="children"><div class="content">This is what I was going to say as well.  Somebody on HN told me about SingleFile and I use it all the time now!  Really amazing extension.</div><br/></div></div><div id="40576781" class="c"><input type="checkbox" id="c-40576781" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576698">parent</a><span>|</span><a href="#40580315">prev</a><span>|</span><a href="#40579606">next</a><span>|</span><label class="collapse" for="c-40576781">[-]</label><label class="expand" for="c-40576781">[2 more]</label></div><br/><div class="children"><div class="content">Thanks, I&#x27;ve seen it, last I tried it it missed bg images. But my point is this is something browsers should support better and kind of sort of do now but even with that it&#x27;s a hassle.</div><br/><div id="40577008" class="c"><input type="checkbox" id="c-40577008" checked=""/><div class="controls bullet"><span class="by">tedmiston</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576781">parent</a><span>|</span><a href="#40579606">next</a><span>|</span><label class="collapse" for="c-40577008">[-]</label><label class="expand" for="c-40577008">[1 more]</label></div><br/><div class="children"><div class="content">I tested this just now on the blog post that this HN page points to and SingleFile handled the background image fine.</div><br/></div></div></div></div><div id="40579606" class="c"><input type="checkbox" id="c-40579606" checked=""/><div class="controls bullet"><span class="by">cxr</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576698">parent</a><span>|</span><a href="#40576781">prev</a><span>|</span><a href="#40579288">next</a><span>|</span><label class="collapse" for="c-40579606">[-]</label><label class="expand" for="c-40579606">[1 more]</label></div><br/><div class="children"><div class="content">&gt; FireFox&#x27;s<p>It&#x27;s just &quot;Firefox&quot;.</div><br/></div></div></div></div><div id="40579288" class="c"><input type="checkbox" id="c-40579288" checked=""/><div class="controls bullet"><span class="by">factormeta</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575874">parent</a><span>|</span><a href="#40576698">prev</a><span>|</span><a href="#40579302">next</a><span>|</span><label class="collapse" for="c-40579288">[-]</label><label class="expand" for="c-40579288">[3 more]</label></div><br/><div class="children"><div class="content">Thanks all the JS - SPA develops that insisting on putting JS all over the place. Wouldn&#x27;t it be better to have everything in one .html, using &lt;script&gt; &lt;style&gt; just inline. Then it is also just one file over the internet. There must be a bundler that does that no?<p>Seems JS developer just want their code to the obfuscated and unachievable as possible unless it is via their web server.</div><br/><div id="40579599" class="c"><input type="checkbox" id="c-40579599" checked=""/><div class="controls bullet"><span class="by">cxr</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40579288">parent</a><span>|</span><a href="#40579302">next</a><span>|</span><label class="collapse" for="c-40579599">[-]</label><label class="expand" for="c-40579599">[2 more]</label></div><br/><div class="children"><div class="content">&gt; using &lt;script&gt; &lt;style&gt; just inline<p>These SPA bundles are on the order of megabytes, not kilobytes.  You want your users, for their own sake and yours, to be able to cache as much as possible instead of delivering a unique megablob payload for every page they hit.</div><br/><div id="40581006" class="c"><input type="checkbox" id="c-40581006" checked=""/><div class="controls bullet"><span class="by">vmfunction</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40579599">parent</a><span>|</span><a href="#40579302">next</a><span>|</span><label class="collapse" for="c-40581006">[-]</label><label class="expand" for="c-40581006">[1 more]</label></div><br/><div class="children"><div class="content">Good point on the cache. However things such as putting background image in CSS, so user can right click to download the image is just stupid. Why is css all the sudden in control of the image display? It just makes archiving pages harder.</div><br/></div></div></div></div></div></div><div id="40579302" class="c"><input type="checkbox" id="c-40579302" checked=""/><div class="controls bullet"><span class="by">sturakov</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575874">parent</a><span>|</span><a href="#40579288">prev</a><span>|</span><a href="#40581586">next</a><span>|</span><label class="collapse" for="c-40579302">[-]</label><label class="expand" for="c-40579302">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve enjoyed using this<p><a href="https:&#x2F;&#x2F;github.com&#x2F;webrecorder">https:&#x2F;&#x2F;github.com&#x2F;webrecorder</a><p>It has a standardized format and acts like a recorder for what you see.</div><br/></div></div><div id="40581586" class="c"><input type="checkbox" id="c-40581586" checked=""/><div class="controls bullet"><span class="by">brnt</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575874">parent</a><span>|</span><a href="#40579302">prev</a><span>|</span><a href="#40576098">next</a><span>|</span><label class="collapse" for="c-40581586">[-]</label><label class="expand" for="c-40581586">[1 more]</label></div><br/><div class="children"><div class="content">Print to PDF seems to be the only way to ensure you record what you saw.</div><br/></div></div><div id="40576098" class="c"><input type="checkbox" id="c-40576098" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40575874">parent</a><span>|</span><a href="#40581586">prev</a><span>|</span><a href="#40576056">next</a><span>|</span><label class="collapse" for="c-40576098">[-]</label><label class="expand" for="c-40576098">[5 more]</label></div><br/><div class="children"><div class="content">&gt; &#x27;Save the webpage as I see it in my browser&#x27; remains a surprisingly annoying and fiddly problem<p>Is it really? I remember hacking around with with JavaScript&#x27;s XMLSerializer (I think) like 5 years ago and solved that for ~90% of the websites I tried to archive. It&#x27;d save the DOM as-is when executed.<p>Internet Archive&#x2F;ArchiveTeam also worked on that particular problem for a very long time, and are mostly successful as far as I can tell.</div><br/><div id="40576697" class="c"><input type="checkbox" id="c-40576697" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576098">parent</a><span>|</span><a href="#40577117">next</a><span>|</span><label class="collapse" for="c-40576697">[-]</label><label class="expand" for="c-40576697">[3 more]</label></div><br/><div class="children"><div class="content">90% feels like an overestimate to me but it&#x27;s already quite poor, you wouldn&#x27;t accept that for saving most other things. Another problem is highlighted in the piece - it&#x27;s a hassle to ensure external tools handle session state and credentials. Dynamic content is poorly handled, the default behaviours are miserable (a browser will run random Javascript from the network but not Javascript you&#x27;ve saved, etc).<p>There&#x27;s a lot of interest in &#x27;digital preservation&#x27; and perhaps one sign of how it&#x27;s very much early days of the field - it&#x27;s tricky to &#x27;just save&#x27; the results of one of the most basic current computer interactions - looking at a web page.</div><br/><div id="40576740" class="c"><input type="checkbox" id="c-40576740" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576697">parent</a><span>|</span><a href="#40577117">next</a><span>|</span><label class="collapse" for="c-40576740">[-]</label><label class="expand" for="c-40576740">[2 more]</label></div><br/><div class="children"><div class="content">But if you serialize the DOM as-is, you literally get what you see on the page when you archive it. Nothing about it is dynamic, and there is no sessions nor credentials to handle. Granted, it&#x27;s a static copy of a specific single page.<p>If you need more than that, then WARC is probably the best. For my measly needs of just preserving exactly what I see, serializing the DOM and saving the result seems to do just fine.</div><br/><div id="40576857" class="c"><input type="checkbox" id="c-40576857" checked=""/><div class="controls bullet"><span class="by">pvg</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576740">parent</a><span>|</span><a href="#40577117">next</a><span>|</span><label class="collapse" for="c-40576857">[-]</label><label class="expand" for="c-40576857">[1 more]</label></div><br/><div class="children"><div class="content">Yes you save something that&#x27;s mildly better than print-page-to-PDF. But it still misses things and the interactive stuff is very much part of &#x27;exactly what I see&#x27;. Like, a random article with an interactive graph, for instance - like this recent HN hit <a href="https:&#x2F;&#x2F;ciechanow.ski&#x2F;airfoil&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ciechanow.ski&#x2F;airfoil&#x2F;</a><p>It&#x27;s not that there aren&#x27;t workarounds, it&#x27;s that they are clunky and &#x27;you can&#x27;t actually save the most common computery entity you deal with&#x27; is just a strange state of affairs we&#x27;ve somehow Stockholmed ourselves to.</div><br/></div></div></div></div></div></div><div id="40577117" class="c"><input type="checkbox" id="c-40577117" checked=""/><div class="controls bullet"><span class="by">tedmiston</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576098">parent</a><span>|</span><a href="#40576697">prev</a><span>|</span><a href="#40576056">next</a><span>|</span><label class="collapse" for="c-40577117">[-]</label><label class="expand" for="c-40577117">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Internet Archive&#x2F;ArchiveTeam also worked on that particular problem for a very long time, and are mostly successful as far as I can tell.<p>One category that the archivers do poorly with is news articles where a pop-up renders on page load which then requires client-side JS execution to dismiss the pop-up.<p>Sometimes it is easily circumvented by manual DOM manipulation, but that&#x27;s hardly a bulletproof solution.  And it feels automateable.</div><br/></div></div></div></div></div></div></div></div><div id="40576056" class="c"><input type="checkbox" id="c-40576056" checked=""/><div class="controls bullet"><span class="by">buildbot</span><span>|</span><a href="#40575554">parent</a><span>|</span><a href="#40575730">prev</a><span>|</span><a href="#40575693">next</a><span>|</span><label class="collapse" for="c-40576056">[-]</label><label class="expand" for="c-40576056">[6 more]</label></div><br/><div class="children"><div class="content">How can you actually open and view a warc file? I&#x27;ve never found a good application for this, have I missed something obvious?</div><br/><div id="40576076" class="c"><input type="checkbox" id="c-40576076" checked=""/><div class="controls bullet"><span class="by">diggan</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576056">parent</a><span>|</span><a href="#40575693">next</a><span>|</span><label class="collapse" for="c-40576076">[-]</label><label class="expand" for="c-40576076">[5 more]</label></div><br/><div class="children"><div class="content">Lots of tools available, best index I&#x27;ve found of the ecosystem is this: <a href="https:&#x2F;&#x2F;wiki.archiveteam.org&#x2F;index.php&#x2F;The_WARC_Ecosystem" rel="nofollow">https:&#x2F;&#x2F;wiki.archiveteam.org&#x2F;index.php&#x2F;The_WARC_Ecosystem</a><p>Ultimately, this is the best viewer I&#x27;ve found so far: <a href="https:&#x2F;&#x2F;replayweb.page&#x2F;" rel="nofollow">https:&#x2F;&#x2F;replayweb.page&#x2F;</a></div><br/><div id="40576154" class="c"><input type="checkbox" id="c-40576154" checked=""/><div class="controls bullet"><span class="by">tivert</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576076">parent</a><span>|</span><a href="#40576404">next</a><span>|</span><label class="collapse" for="c-40576154">[-]</label><label class="expand" for="c-40576154">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Lots of tools available, best index I&#x27;ve found of the ecosystem is this: <a href="https:&#x2F;&#x2F;wiki.archiveteam.org&#x2F;index.php&#x2F;The_WARC_Ecosystem" rel="nofollow">https:&#x2F;&#x2F;wiki.archiveteam.org&#x2F;index.php&#x2F;The_WARC_Ecosystem</a><p>It looks like there&#x27;s a lot of tools for creating them, but not a a lot for viewing.<p>What they really need is browser support, or at least an extension so a browser can open the files directly.</div><br/><div id="40579662" class="c"><input type="checkbox" id="c-40579662" checked=""/><div class="controls bullet"><span class="by">cxr</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576154">parent</a><span>|</span><a href="#40577108">next</a><span>|</span><label class="collapse" for="c-40579662">[-]</label><label class="expand" for="c-40579662">[1 more]</label></div><br/><div class="children"><div class="content">&gt; What they really need is browser support, or at least an extension so a browser can open the files directly<p>That&#x27;s probably the wrong thing.  What browsers really need is a thin but standardized API that lets any third-party app that the user has installed on their machine to supply the content for various fetch&#x2F;reads.<p>You&#x27;d open the WARC in Firefox or Safari or whatever, but Safari et al wouldn&#x27;t have any special understanding of the format.  It would know that <i>your</i> app does WARCs, though, and then knock on the door and say, &quot;Please tell me the content I should be showing here; I&#x27;ll defer to you for any further &quot;requests&quot; associated with the file&#x2F;page loaded in this tab—just tell me the content I should use for those, too.&quot;</div><br/></div></div><div id="40577108" class="c"><input type="checkbox" id="c-40577108" checked=""/><div class="controls bullet"><span class="by">jamesgeck0</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576154">parent</a><span>|</span><a href="#40579662">prev</a><span>|</span><a href="#40576404">next</a><span>|</span><label class="collapse" for="c-40577108">[-]</label><label class="expand" for="c-40577108">[1 more]</label></div><br/><div class="children"><div class="content">There is a browser extension. It can record WARC files, but also has a viewing interface identical to ReplayWeb.page. <a href="https:&#x2F;&#x2F;archiveweb.page&#x2F;guide" rel="nofollow">https:&#x2F;&#x2F;archiveweb.page&#x2F;guide</a></div><br/></div></div></div></div><div id="40576404" class="c"><input type="checkbox" id="c-40576404" checked=""/><div class="controls bullet"><span class="by">lostemptations5</span><span>|</span><a href="#40575554">root</a><span>|</span><a href="#40576076">parent</a><span>|</span><a href="#40576154">prev</a><span>|</span><a href="#40575693">next</a><span>|</span><label class="collapse" for="c-40576404">[-]</label><label class="expand" for="c-40576404">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve never easily been to read warc files.</div><br/></div></div></div></div></div></div><div id="40575693" class="c"><input type="checkbox" id="c-40575693" checked=""/><div class="controls bullet"><span class="by">codetrotter</span><span>|</span><a href="#40575554">parent</a><span>|</span><a href="#40576056">prev</a><span>|</span><a href="#40575571">next</a><span>|</span><label class="collapse" for="c-40575693">[-]</label><label class="expand" for="c-40575693">[2 more]</label></div><br/><div class="children"><div class="content">FTA:<p>&gt; Although Safari is only maintained by Apple, the Safari webarchive format can be read by non-Apple tools – it’s a binary property list that stores the raw bytes of the original files. I’m comfortable that I’ll be able to open these archives for a while, even if Safari unexpectedly goes away.</div><br/></div></div><div id="40575571" class="c"><input type="checkbox" id="c-40575571" checked=""/><div class="controls bullet"><span class="by">simongr3dal</span><span>|</span><a href="#40575554">parent</a><span>|</span><a href="#40575693">prev</a><span>|</span><a href="#40577085">next</a><span>|</span><label class="collapse" for="c-40575571">[-]</label><label class="expand" for="c-40575571">[2 more]</label></div><br/><div class="children"><div class="content">It is proprietary, but it&#x27;s not like it&#x27;s difficult to decode or interpret.</div><br/></div></div></div></div><div id="40577085" class="c"><input type="checkbox" id="c-40577085" checked=""/><div class="controls bullet"><span class="by">tedmiston</span><span>|</span><a href="#40575554">prev</a><span>|</span><a href="#40576014">next</a><span>|</span><label class="collapse" for="c-40577085">[-]</label><label class="expand" for="c-40577085">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Running it over my bookmarks<p>&gt; Once I’d written the initial version of this script and put all the pieces together, I used it to create webarchives for 6000 or so bookmarks in my Pinboard account. It worked pretty well, and captured 85% of my bookmarks – the remaining 15% are broken due to link rot. I did a spot check of a few dozen archives that did get saved, and they all look good.<p>I was a tad confused by this part.<p>Did you (or <i>how</i> did you) verify that the headlessly saved web archives for thousands of bookmarks visually match the pages shown in the browser?<p>This is the biggest problem I&#x27;ve had with command-line archival tools: they save some version of the page, but it often differs substantially from what I actually see in my browser — things like pop-up artifacts covering the page or news articles are full of ads that are otherwise blocked in my headed browser.<p>The SingleFile extension for Chrome works more completely and accurately than anything else I&#x27;ve come across so far, but it does still break weirdly sometimes too.<p>I would love to find a programmatic way to automate the visual verification, e.g., archiving a page with multiple different tools and visually diffing the rendered pages across tools with small margins of error.  Maybe someone else has worked on this already.</div><br/><div id="40577202" class="c"><input type="checkbox" id="c-40577202" checked=""/><div class="controls bullet"><span class="by">kwhitefoot</span><span>|</span><a href="#40577085">parent</a><span>|</span><a href="#40577402">next</a><span>|</span><label class="collapse" for="c-40577202">[-]</label><label class="expand" for="c-40577202">[1 more]</label></div><br/><div class="children"><div class="content">WebScrapbook is also worth a look.  I find that I like it slightly better than SingleFile for creating copies that are not packaged as single files.  This lets me hard link identical asset files to save space.</div><br/></div></div><div id="40577402" class="c"><input type="checkbox" id="c-40577402" checked=""/><div class="controls bullet"><span class="by">byteknight</span><span>|</span><a href="#40577085">parent</a><span>|</span><a href="#40577202">prev</a><span>|</span><a href="#40576014">next</a><span>|</span><label class="collapse" for="c-40577402">[-]</label><label class="expand" for="c-40577402">[1 more]</label></div><br/><div class="children"><div class="content">Archivebox with its multi-method backups. Screenshots, text, html, etc.</div><br/></div></div></div></div><div id="40576014" class="c"><input type="checkbox" id="c-40576014" checked=""/><div class="controls bullet"><span class="by">BostonFern</span><span>|</span><a href="#40577085">prev</a><span>|</span><a href="#40575939">next</a><span>|</span><label class="collapse" for="c-40576014">[-]</label><label class="expand" for="c-40576014">[1 more]</label></div><br/><div class="children"><div class="content">I enjoyed reading this. It’s easy to follow along.<p>It’s also relatable to find answers to Swift documentation questions in some talk by an Apple insider rather than in Apple’s official documentation.</div><br/></div></div><div id="40575939" class="c"><input type="checkbox" id="c-40575939" checked=""/><div class="controls bullet"><span class="by">hu3</span><span>|</span><a href="#40576014">prev</a><span>|</span><a href="#40580187">next</a><span>|</span><label class="collapse" for="c-40575939">[-]</label><label class="expand" for="c-40575939">[3 more]</label></div><br/><div class="children"><div class="content">sidenote: be careful when opening a webarchive from a third party, if that improvable opportunity ever materializes:<p>&gt; In February 2013, a vulnerability with the webarchive format was discovered and reported by Joe Vennix, a Metasploit Project developer. The exploit allows an attacker to send a crafted webarchive to a user containing code to access cookies, local files, and other data. Apple&#x27;s response to the report was that it will not fix the bug, most likely because it requires action on the users&#x27; part in opening the file.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Webarchive#Vulnerability" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Webarchive#Vulnerability</a></div><br/><div id="40577193" class="c"><input type="checkbox" id="c-40577193" checked=""/><div class="controls bullet"><span class="by">tedmiston</span><span>|</span><a href="#40575939">parent</a><span>|</span><a href="#40577257">next</a><span>|</span><label class="collapse" for="c-40577193">[-]</label><label class="expand" for="c-40577193">[1 more]</label></div><br/><div class="children"><div class="content">I initially glossed over this believing it may be something trivial, but it really is a deeper XSS concern.<p>It feels weird me to dismiss as wontfix a security issue that gives the archived page far greater access to browser data than it has loaded at its original URL.<p>&gt; Last updated at Tue, 16 Jan 2024 16:26:37 GMT<p>&gt; tldr: For now, don&#x27;t open .webarchive files, and check the Metasploit module, Apple Safari .webarchive File Format UXSS<p>&gt; Safari&#x27;s webarchive format saves all the resources in a web page - images, scripts, stylesheets - into a single file. A flaw exists in the security model behind webarchives that allows us to execute script in the context of any domain (a Universal Cross-site Scripting bug). In order to exploit this vulnerability, an attacker must somehow deliver the webarchive file to the victim and have the victim manually open it ^1 (e.g. through email or a forced download), after ignoring a potential &quot;this content was downloaded from a webpage&quot; warning message ^2.<p>Just look at the number of (relatively trivial) attack vectors identified by the author in this post:<p>&gt; Attack Vector #1: Steal the user&#x27;s cookies.<p>&gt; Attack Vector #2: Steal CSRF tokens.<p>&gt; Attack Vector #3: Steal local files.<p>&gt; Attack Vector #4: Steal saved form passwords.<p>&gt; Attack Vector #5: Store poisoned javascript in the user&#x27;s cache.<p><a href="https:&#x2F;&#x2F;www.rapid7.com&#x2F;blog&#x2F;post&#x2F;2013&#x2F;04&#x2F;25&#x2F;abusing-safaris-webarchive-file-format&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.rapid7.com&#x2F;blog&#x2F;post&#x2F;2013&#x2F;04&#x2F;25&#x2F;abusing-safaris-...</a></div><br/></div></div></div></div><div id="40580187" class="c"><input type="checkbox" id="c-40580187" checked=""/><div class="controls bullet"><span class="by">kasperset</span><span>|</span><a href="#40575939">prev</a><span>|</span><a href="#40576915">next</a><span>|</span><label class="collapse" for="c-40580187">[-]</label><label class="expand" for="c-40580187">[2 more]</label></div><br/><div class="children"><div class="content">Mostly using Zotero for saving snapshots of webpage. Saving webpage is getting more and more difficult as it approaches the functionality of the desktop application.</div><br/><div id="40580713" class="c"><input type="checkbox" id="c-40580713" checked=""/><div class="controls bullet"><span class="by">extra88</span><span>|</span><a href="#40580187">parent</a><span>|</span><a href="#40576915">next</a><span>|</span><label class="collapse" for="c-40580713">[-]</label><label class="expand" for="c-40580713">[1 more]</label></div><br/><div class="children"><div class="content">There are reasons to also have local copies but for scholarly use, consider <a href="https:&#x2F;&#x2F;perma.cc&#x2F;" rel="nofollow">https:&#x2F;&#x2F;perma.cc&#x2F;</a></div><br/></div></div></div></div><div id="40575795" class="c"><input type="checkbox" id="c-40575795" checked=""/><div class="controls bullet"><span class="by">pzmarzly</span><span>|</span><a href="#40576915">prev</a><span>|</span><a href="#40577153">next</a><span>|</span><label class="collapse" for="c-40575795">[-]</label><label class="expand" for="c-40575795">[1 more]</label></div><br/><div class="children"><div class="content">Could this be compiled for Linux and WebKitGtk, or is this API Safari-specific?</div><br/></div></div><div id="40577153" class="c"><input type="checkbox" id="c-40577153" checked=""/><div class="controls bullet"><span class="by">stunpix</span><span>|</span><a href="#40575795">prev</a><span>|</span><a href="#40575717">next</a><span>|</span><label class="collapse" for="c-40577153">[-]</label><label class="expand" for="c-40577153">[4 more]</label></div><br/><div class="children"><div class="content">I was searching something for a web page preservation and also considered Safari web-archives, but decided this is a  “no go” for me because of private format which is basically a vendor lock. Thus I ended up with a Chrome extension named SingleFile which does a pretty decent job by saving the whole page (or its part) as a single self sufficient html file viewable by any browser. Also html files are easily indexed by Spotlight or other search engines. The extension has no command line though but personally I don’t need that.</div><br/><div id="40577437" class="c"><input type="checkbox" id="c-40577437" checked=""/><div class="controls bullet"><span class="by">Vegenoid</span><span>|</span><a href="#40577153">parent</a><span>|</span><a href="#40577214">next</a><span>|</span><label class="collapse" for="c-40577437">[-]</label><label class="expand" for="c-40577437">[1 more]</label></div><br/><div class="children"><div class="content">The author considered the proprietary nature of the webarchive format, and determined that it was readable without Apple software, and that it wouldn&#x27;t be too difficult to create a tool to view or transform webarchive files if Safari were to disappear: <a href="https:&#x2F;&#x2F;alexwlchan.net&#x2F;til&#x2F;2024&#x2F;whats-inside-safari-webarchive&#x2F;" rel="nofollow">https:&#x2F;&#x2F;alexwlchan.net&#x2F;til&#x2F;2024&#x2F;whats-inside-safari-webarchi...</a><p>Of course, without a working implementation, there could be hidden obstacles.</div><br/></div></div><div id="40577214" class="c"><input type="checkbox" id="c-40577214" checked=""/><div class="controls bullet"><span class="by">PaulHoule</span><span>|</span><a href="#40577153">parent</a><span>|</span><a href="#40577437">prev</a><span>|</span><a href="#40577172">next</a><span>|</span><label class="collapse" for="c-40577214">[-]</label><label class="expand" for="c-40577214">[1 more]</label></div><br/><div class="children"><div class="content">See <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;WARC_(file_format)" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;WARC_(file_format)</a></div><br/></div></div></div></div><div id="40575717" class="c"><input type="checkbox" id="c-40575717" checked=""/><div class="controls bullet"><span class="by">savolai</span><span>|</span><a href="#40577153">prev</a><span>|</span><a href="#40576307">next</a><span>|</span><label class="collapse" for="c-40575717">[-]</label><label class="expand" for="c-40575717">[5 more]</label></div><br/><div class="children"><div class="content">I’d love to have a viewer for this or converter to a standard html single page archive that works in other browsers too. Is there some reason for apple’s proprietary to exist over self contained html?  I have a bunch of apple webarchives too (stored from
ios to notion) and am worried if there is no durable solution to open these beyond ”code it yourself”.</div><br/><div id="40575793" class="c"><input type="checkbox" id="c-40575793" checked=""/><div class="controls bullet"><span class="by">Springtime</span><span>|</span><a href="#40575717">parent</a><span>|</span><a href="#40577297">next</a><span>|</span><label class="collapse" for="c-40575793">[-]</label><label class="expand" for="c-40575793">[2 more]</label></div><br/><div class="children"><div class="content"><i>&gt; I’d love to have a viewer for this or converter to a standard html single page archive that works in other browsers too</i><p>About 10 years ago I searched and found a webarchive to MHTML converter from someone&#x27;s small site. I recall there was one caveat, something like it didn&#x27;t include the date in the metadata of the output MHTML.<p>Sorry I don&#x27;t have the link on-hand, it&#x27;d be on the HDD I pulled from my old Macbook.<p>Edit: found an alternative script from my notes: <a href="https:&#x2F;&#x2F;blog.iefdev.se&#x2F;2016&#x2F;01&#x2F;converting-webarchive-to-mht&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.iefdev.se&#x2F;2016&#x2F;01&#x2F;converting-webarchive-to-mht&#x2F;</a><p>Edit 2: pretty sure this is the original converter, since I noted a caveat that it outputs the timestamp of the conversion not the time the file was originally saved (the script above handles this correctly otoh). <a href="https:&#x2F;&#x2F;langui.net&#x2F;webarchive-to-mht&#x2F;" rel="nofollow">https:&#x2F;&#x2F;langui.net&#x2F;webarchive-to-mht&#x2F;</a></div><br/><div id="40579158" class="c"><input type="checkbox" id="c-40579158" checked=""/><div class="controls bullet"><span class="by">lacop</span><span>|</span><a href="#40575717">root</a><span>|</span><a href="#40575793">parent</a><span>|</span><a href="#40577297">next</a><span>|</span><label class="collapse" for="c-40579158">[-]</label><label class="expand" for="c-40579158">[1 more]</label></div><br/><div class="children"><div class="content">Unfortunately I don&#x27;t think browsers handle opening MHTML well out of the box.<p>At least last time I checked in only worked for local paths (file:&#x2F;&#x2F;) and only some browsers. Otherwise it would either try to download or just show plain text.<p>I ended up using Chrome to dump to MHTML [1] and then reshuffle the content into individual files, rewriting the path references and fixing mime types [2]. That gives a reasonably faithful static capture of a page that can be shared as link.<p>[1] <a href="https:&#x2F;&#x2F;chromedevtools.github.io&#x2F;devtools-protocol&#x2F;tot&#x2F;Page&#x2F;#method-captureSnapshot" rel="nofollow">https:&#x2F;&#x2F;chromedevtools.github.io&#x2F;devtools-protocol&#x2F;tot&#x2F;Page&#x2F;...</a>
[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;lacop&#x2F;udrb&#x2F;blob&#x2F;master&#x2F;app&#x2F;src&#x2F;chrome&#x2F;mod.rs#L116">https:&#x2F;&#x2F;github.com&#x2F;lacop&#x2F;udrb&#x2F;blob&#x2F;master&#x2F;app&#x2F;src&#x2F;chrome&#x2F;mod...</a></div><br/></div></div></div></div><div id="40577297" class="c"><input type="checkbox" id="c-40577297" checked=""/><div class="controls bullet"><span class="by">tedmiston</span><span>|</span><a href="#40575717">parent</a><span>|</span><a href="#40575793">prev</a><span>|</span><a href="#40575878">next</a><span>|</span><label class="collapse" for="c-40577297">[-]</label><label class="expand" for="c-40577297">[1 more]</label></div><br/><div class="children"><div class="content">Something like ArchiveBox or SingleFile are in the same ballpark of tools, but SingleFile at least seems to eschew Safari Webarchive as a format.  ArchiveBox may support Safari webarchives, but for some reason they omit it in their docs.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile?tab=readme-ov-file#file-format-comparison">https:&#x2F;&#x2F;github.com&#x2F;gildas-lormeau&#x2F;SingleFile?tab=readme-ov-f...</a><p><a href="https:&#x2F;&#x2F;archivebox.io&#x2F;#output-formats" rel="nofollow">https:&#x2F;&#x2F;archivebox.io&#x2F;#output-formats</a></div><br/></div></div></div></div><div id="40576307" class="c"><input type="checkbox" id="c-40576307" checked=""/><div class="controls bullet"><span class="by">hu3</span><span>|</span><a href="#40575717">prev</a><span>|</span><a href="#40576228">next</a><span>|</span><label class="collapse" for="c-40576307">[-]</label><label class="expand" for="c-40576307">[5 more]</label></div><br/><div class="children"><div class="content">A cross-platform solution is to use headless Chromium to save pages as PDFs.<p>Example I just tried and worked for me:<p>$ chrome.exe --headless --no-sandbox --disable-gpu --print-to-pdf=page.pdf <a href="https:&#x2F;&#x2F;news.ycombinator.com">https:&#x2F;&#x2F;news.ycombinator.com</a><p>Taken from: <a href="https:&#x2F;&#x2F;circumeo.io&#x2F;blog&#x2F;entry&#x2F;html-to-pdf-using-python-and-headless-chrome&#x2F;" rel="nofollow">https:&#x2F;&#x2F;circumeo.io&#x2F;blog&#x2F;entry&#x2F;html-to-pdf-using-python-and-...</a><p>I know you can specify cookies, existing sessions and existing profiles in case authentication is required.</div><br/><div id="40577165" class="c"><input type="checkbox" id="c-40577165" checked=""/><div class="controls bullet"><span class="by">jamesgeck0</span><span>|</span><a href="#40576307">parent</a><span>|</span><a href="#40576345">next</a><span>|</span><label class="collapse" for="c-40577165">[-]</label><label class="expand" for="c-40577165">[3 more]</label></div><br/><div class="children"><div class="content">The main issue with this is that you lose text reflowing, so it&#x27;s more annoying to access on mobile. You also lose interactivity; I&#x27;ve seen links and menus implemented with JavaScript break.</div><br/><div id="40577639" class="c"><input type="checkbox" id="c-40577639" checked=""/><div class="controls bullet"><span class="by">hu3</span><span>|</span><a href="#40576307">root</a><span>|</span><a href="#40577165">parent</a><span>|</span><a href="#40577444">next</a><span>|</span><label class="collapse" for="c-40577639">[-]</label><label class="expand" for="c-40577639">[1 more]</label></div><br/><div class="children"><div class="content">Indeed. PDF is subpar for many websites.<p>HTML is also easier to fix is something gets in the way of content.</div><br/></div></div><div id="40577444" class="c"><input type="checkbox" id="c-40577444" checked=""/><div class="controls bullet"><span class="by">filleduchaos</span><span>|</span><a href="#40576307">root</a><span>|</span><a href="#40577165">parent</a><span>|</span><a href="#40577639">prev</a><span>|</span><a href="#40576345">next</a><span>|</span><label class="collapse" for="c-40577444">[-]</label><label class="expand" for="c-40577444">[1 more]</label></div><br/><div class="children"><div class="content">There are also just plenty of web pages worth saving that aren&#x27;t simple documents.</div><br/></div></div></div></div></div></div><div id="40576228" class="c"><input type="checkbox" id="c-40576228" checked=""/><div class="controls bullet"><span class="by">sed3</span><span>|</span><a href="#40576307">prev</a><span>|</span><a href="#40576055">next</a><span>|</span><label class="collapse" for="c-40576228">[-]</label><label class="expand" for="c-40576228">[5 more]</label></div><br/><div class="children"><div class="content">I save pages into PDF files. Low tech, but works since 2001.<p>I print with zero page margins, so in viewer it seems like continuous page. I found Firefox produced smallest pdfs. Chrome embeds fonts and other stuff. I also use UBlock rules to hide some elements.<p>Pretty useful for archiving discussions on Reddit.</div><br/><div id="40577059" class="c"><input type="checkbox" id="c-40577059" checked=""/><div class="controls bullet"><span class="by">bsnnkv</span><span>|</span><a href="#40576228">parent</a><span>|</span><a href="#40578813">next</a><span>|</span><label class="collapse" for="c-40577059">[-]</label><label class="expand" for="c-40577059">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Pretty useful for archiving discussions on Reddit.<p>What I do now is save the comments within the discussions (on HN, Reddit, Twitter etc) as text which is indexable and searchable with additional metadata which helps for filtering (author is the main one I use), while automatically archiving the entire URLs associated with them.[1]<p>For me, this is the best of both worlds - quick access via fault-tolerant search and filtering to the most interesting stuff while having a snapshot archive for the full context.<p>[1]: <a href="https:&#x2F;&#x2F;notado.app" rel="nofollow">https:&#x2F;&#x2F;notado.app</a> - I&#x27;ve been working on this for a few years now and have posted a lot in my HN comment history and technical blogs about how I have iterated on and evolved this workflow to the point where it is now</div><br/></div></div><div id="40578813" class="c"><input type="checkbox" id="c-40578813" checked=""/><div class="controls bullet"><span class="by">tannhaeuser</span><span>|</span><a href="#40576228">parent</a><span>|</span><a href="#40577059">prev</a><span>|</span><a href="#40576765">next</a><span>|</span><label class="collapse" for="c-40578813">[-]</label><label class="expand" for="c-40578813">[1 more]</label></div><br/><div class="children"><div class="content">I get you, but I still find it sad there&#x27;s so little trust left in the web stack that even a PDF is preferable. Technically, a PDF can contain anything (bitmaps, text&#x2F;glyphs without semantic ordering, even JavaScript).</div><br/></div></div><div id="40576765" class="c"><input type="checkbox" id="c-40576765" checked=""/><div class="controls bullet"><span class="by">DaSHacka</span><span>|</span><a href="#40576228">parent</a><span>|</span><a href="#40578813">prev</a><span>|</span><a href="#40576347">next</a><span>|</span><label class="collapse" for="c-40576765">[-]</label><label class="expand" for="c-40576765">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Pretty useful for archiving discussions on Reddit.<p>I use SingleFile for that, saves pages as a single self-contained html file. That way you can still interact with collapse comment buttons and outlinks.</div><br/></div></div></div></div><div id="40576055" class="c"><input type="checkbox" id="c-40576055" checked=""/><div class="controls bullet"><span class="by">1attice</span><span>|</span><a href="#40576228">prev</a><span>|</span><label class="collapse" for="c-40576055">[-]</label><label class="expand" for="c-40576055">[3 more]</label></div><br/><div class="children"><div class="content">Cool, but consider monolith for this instead (<a href="https:&#x2F;&#x2F;github.com&#x2F;Y2Z&#x2F;monolith">https:&#x2F;&#x2F;github.com&#x2F;Y2Z&#x2F;monolith</a>)<p>- Outputs a single .html file, consumable with any web browser on any platform<p>- Rust, so, you know, +1 HN (;D)</div><br/><div id="40576475" class="c"><input type="checkbox" id="c-40576475" checked=""/><div class="controls bullet"><span class="by">computershit</span><span>|</span><a href="#40576055">parent</a><span>|</span><a href="#40576092">next</a><span>|</span><label class="collapse" for="c-40576475">[-]</label><label class="expand" for="c-40576475">[1 more]</label></div><br/><div class="children"><div class="content">Thx for the recommendation, wasn&#x27;t aware of this</div><br/></div></div></div></div></div></div></div></div></div></body></html>