<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1713776468192" as="style"/><link rel="stylesheet" href="styles.css?v=1713776468192"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/google-deepmind/penzai">Penzai: JAX research toolkit for building, editing, and visualizing neural nets</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>mccoyb</span> | <span>45 comments</span></div><br/><div><div id="40111003" class="c"><input type="checkbox" id="c-40111003" checked=""/><div class="controls bullet"><span class="by">yklcs</span><span>|</span><a href="#40109043">next</a><span>|</span><label class="collapse" for="c-40111003">[-]</label><label class="expand" for="c-40111003">[2 more]</label></div><br/><div class="children"><div class="content">I like JAX, and find most of the core functionality as an &quot;accelerated NumPy&quot; great.
Ecosystem fragmentation and difficulties in interop make adopting JAX hard though.<p>There&#x27;s too much fragmentation within the JAX NN library space, which penzai isn&#x27;t helping with. I wish everyone using JAX could agree on a single set of libraries for NN, optimization, and data loading.<p>PyTorch code can&#x27;t be called, meaning a lot of reimplementation in JAX is needed when extending and iterating on prior works, which is the case for most of research. Custom CUDA kernels are a bit fiddly too, I haven&#x27;t been able to bring Gaussian Splatting to JAX yet.</div><br/><div id="40111126" class="c"><input type="checkbox" id="c-40111126" checked=""/><div class="controls bullet"><span class="by">abhgh</span><span>|</span><a href="#40111003">parent</a><span>|</span><a href="#40109043">next</a><span>|</span><label class="collapse" for="c-40111126">[-]</label><label class="expand" for="c-40111126">[1 more]</label></div><br/><div class="children"><div class="content">Another issue I&#x27;ve personally faced is debugging - although I am saying this from my experience from more than a yr ago, and maybe things are better now. I have used it mostly for optimization and the error messages aren&#x27;t helpful.</div><br/></div></div></div></div><div id="40109043" class="c"><input type="checkbox" id="c-40109043" checked=""/><div class="controls bullet"><span class="by">pizza</span><span>|</span><a href="#40111003">prev</a><span>|</span><a href="#40108135">next</a><span>|</span><label class="collapse" for="c-40109043">[-]</label><label class="expand" for="c-40109043">[4 more]</label></div><br/><div class="children"><div class="content">I remember pytorch has some pytree capability, no? So is it safe to say that the any-pytree-compatible modules here are already compatible w&#x2F; pytorch?</div><br/><div id="40109662" class="c"><input type="checkbox" id="c-40109662" checked=""/><div class="controls bullet"><span class="by">ddjohnson</span><span>|</span><a href="#40109043">parent</a><span>|</span><a href="#40109682">next</a><span>|</span><label class="collapse" for="c-40109662">[-]</label><label class="expand" for="c-40109662">[1 more]</label></div><br/><div class="children"><div class="content">Author here! I didn&#x27;t know PyTorch had its own pytree system. It looks like it&#x27;s separate from JAX&#x27;s pytree registry, though, so Penzai&#x27;s tooling probably won&#x27;t work with PyTorch out of the box.</div><br/></div></div><div id="40109682" class="c"><input type="checkbox" id="c-40109682" checked=""/><div class="controls bullet"><span class="by">sillysaurusx</span><span>|</span><a href="#40109043">parent</a><span>|</span><a href="#40109662">prev</a><span>|</span><a href="#40108135">next</a><span>|</span><label class="collapse" for="c-40109682">[-]</label><label class="expand" for="c-40109682">[2 more]</label></div><br/><div class="children"><div class="content">I implemented Jax’s pytrees in pure python. You can use it with whatever you want. <a href="https:&#x2F;&#x2F;github.com&#x2F;shawwn&#x2F;pytreez">https:&#x2F;&#x2F;github.com&#x2F;shawwn&#x2F;pytreez</a><p>The readme is a todo, but the tests are complete. They’re the same that Jax itself uses, but zero dependencies. <a href="https:&#x2F;&#x2F;github.com&#x2F;shawwn&#x2F;pytreez&#x2F;blob&#x2F;master&#x2F;tests&#x2F;test_pytreez.py">https:&#x2F;&#x2F;github.com&#x2F;shawwn&#x2F;pytreez&#x2F;blob&#x2F;master&#x2F;tests&#x2F;test_pyt...</a><p>The concept is simple. The hard part is cross pollination. Suppose you wanted to literally use Jax pytrees with PyTorch. Now you’ll have to import Jax, or my library, and register your modules with it. But anything else that ever uses pytrees need to use the same pytree library, because the registry (the thing that keeps track of pytree compatible classes) is in the library you choose. They don’t share registries.<p>A better way of phrasing it is that if you use a jax-style pytree interface, it should work with any other pytree library. But to my knowledge, the only pytree library besides Jax itself is mine here, and only I use it. So when you ask if pytree-compatible modules are compatible with PyTorch, it’s equivalent to asking whether PyTorch projects use jax, and the answer tends to be no.<p>EDIT: perhaps I’m outdated. OP says that PyTorch has pytree functionality now. <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40109662">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40109662</a> I guess yet again I was ahead of the times by a couple years; happy to see other ecosystems catch up. Hopefully seeing a simple implementation will clarify the tradeoffs.<p>The best approach for a universal pytree library would be to assume that any class with tree_flatten and tree_unflatten methods are pytreeable, and not require those classes to be explicitly registered. That way you don’t have to worry whether you’re using Jax or PyTorch pytrees. But I gave up trying to make library-agnostic ML modules; in practice it’s better just to choose Jax or PyTorch and be done with it, since making PyTorch modules run in Jax automatically (and vice versa) is a fool’s errand (I was the fool, and it was an errand) for many reasons, not the least of which is that Jax builds an explicit computation graph via jax.jit, a feature PyTorch has only recently (and reluctantly) embraced. But of course, that means if you pick the wrong ecosystem, you’ll miss out on the best tools — hello React vs Vue, or Unreal Engine vs Unity, or dozens of other examples.</div><br/><div id="40111982" class="c"><input type="checkbox" id="c-40111982" checked=""/><div class="controls bullet"><span class="by">albertzeyer</span><span>|</span><a href="#40109043">root</a><span>|</span><a href="#40109682">parent</a><span>|</span><a href="#40108135">next</a><span>|</span><label class="collapse" for="c-40111982">[-]</label><label class="expand" for="c-40111982">[1 more]</label></div><br/><div class="children"><div class="content">There are a couple more such libraries. One was inside tensorflow (nest) and then extracted into the standalone dm-tree: <a href="https:&#x2F;&#x2F;github.com&#x2F;deepmind&#x2F;tree">https:&#x2F;&#x2F;github.com&#x2F;deepmind&#x2F;tree</a><p>Or also: <a href="https:&#x2F;&#x2F;github.com&#x2F;metaopt&#x2F;optree">https:&#x2F;&#x2F;github.com&#x2F;metaopt&#x2F;optree</a><p>I think ideally you would try to use mostly standard types (dict, list, tuple, etc) which are supported by all those libraries in mostly the same way, so it&#x27;s easy to switch.<p>You have to be careful in some of the small differences though. E.g. what basic types are supported (e.g. dataclass, namedtuple, other derived instances from dict, tuple, etc), or how None is handled.</div><br/></div></div></div></div></div></div><div id="40108135" class="c"><input type="checkbox" id="c-40108135" checked=""/><div class="controls bullet"><span class="by">catgary</span><span>|</span><a href="#40109043">prev</a><span>|</span><a href="#40108268">next</a><span>|</span><label class="collapse" for="c-40108135">[-]</label><label class="expand" for="c-40108135">[5 more]</label></div><br/><div class="children"><div class="content">I’ve only been reading through the docs for a few moments, but I’m pleasantly surprised to find they the authors are using effect handlers to handle effectful computations in ML models. I was in the process of translating a model from torch to Jax using Equinox, this makes me think penzai could be a better choice.</div><br/><div id="40109257" class="c"><input type="checkbox" id="c-40109257" checked=""/><div class="controls bullet"><span class="by">patrickkidger</span><span>|</span><a href="#40108135">parent</a><span>|</span><a href="#40109894">next</a><span>|</span><label class="collapse" for="c-40109257">[-]</label><label class="expand" for="c-40109257">[2 more]</label></div><br/><div class="children"><div class="content">I was just reading this too! I think it&#x27;s a really interesting choice in the design space.<p>So to elucidate this a little bit, the trade-off is that this is now incompatible with e.g. `jax.grad` or `lax.scan`: you can&#x27;t compose things in the order `discharge_effect(jax.grad(your_model_here))`, or put an effectful `lax.scan` inside your forward pass, etc. The effect-discharging process only knows how to handle traversing pytree structures. (And they do mention this at the end of their docs.)<p>This kind of thing was actually something I explicitly considered later on in Equinox, but in part decided against as I couldn&#x27;t see a way to make that work either. The goal of Equinox was always absolute compatibility with arbitrary JAX code.<p>Now, none of that should be taken as a bash at Penzai! They&#x27;ve made a different set of trade-offs, and if the above incompatibility doesn&#x27;t affect your goals then indeed their effect system is incredibly elegant, so certainly give it a try. (Seriously, it&#x27;s been pretty cool to see the release of Penzai, which explicitly acknowledges how much it&#x27;s inspired by Equinox.)</div><br/><div id="40109867" class="c"><input type="checkbox" id="c-40109867" checked=""/><div class="controls bullet"><span class="by">ddjohnson</span><span>|</span><a href="#40108135">root</a><span>|</span><a href="#40109257">parent</a><span>|</span><a href="#40109894">next</a><span>|</span><label class="collapse" for="c-40109867">[-]</label><label class="expand" for="c-40109867">[1 more]</label></div><br/><div class="children"><div class="content">Author of Penzai here! In idiomatic Penzai usage, you should always discharge all effects before running your model. While it&#x27;s true you can&#x27;t do `discharge_effect(jax.grad(your_model_here))`, you can still do `jax.grad(discharge_effect(your_model_here))`, which is probably what you meant to do anyway in most cases. Once you&#x27;ve wrapped your model in a handler layer, it has a pure interface again, which makes it fully compatible with all arbitrary JAX transformations. The intended use of effects is as an internal helper to simplify plumbing of values into and out of layers, not as something that affects the top-level interface of using the model!<p>(As an example of this, the GemmaTransformer example model uses the SideInput effect internally to do attention masking. But it exposes a pure functional interface by using a handler internally, so you can call it anywhere you could call an Equinox model, and you shouldn&#x27;t have to think about the effect system at all as a user of the model.)<p>It&#x27;s not clear to me what the semantics of ordinary JAX transformations like `lax.scan` should be if the model has side effects. But if you don&#x27;t have any effects in your model, or if you&#x27;ve explicitly handled them already, then it&#x27;s perfectly fine to use `lax.scan`. This is similar to how it works in ordinary JAX; if you try to do a `lax.scan` over a function that mutates Python state, you&#x27;ll probably hit an error or get something unexpected. But if you mutate Python state internally inside `lax.scan`, it works fine.<p>I&#x27;ll also note that adding support for higher-order layer combinators (like &quot;layer scan&quot;) is something that&#x27;s on the roadmap! The goal would be to support some of the fancier features of libraries like Flax when you need them, while still admitting a simple purely-functional mental model when you don&#x27;t.</div><br/></div></div></div></div><div id="40109894" class="c"><input type="checkbox" id="c-40109894" checked=""/><div class="controls bullet"><span class="by">ddjohnson</span><span>|</span><a href="#40108135">parent</a><span>|</span><a href="#40109257">prev</a><span>|</span><a href="#40108268">next</a><span>|</span><label class="collapse" for="c-40109894">[-]</label><label class="expand" for="c-40109894">[2 more]</label></div><br/><div class="children"><div class="content">Thanks! This is one of the more experimental design choices I made in designing Penzai, but so far I&#x27;ve found it to be quite useful.<p>The effect system does come with a few sharp edges at the moment if you want to use JAX transformations inside the forward pass of your model (see my reply to Patrick), but I&#x27;m hoping to make it more flexible as time goes on. (Figuring out how effect systems should compose with function transformations is a bit nontrivial!)<p>Please let me know if you run into any issues using Penzai for your model! (Also, most of Penzai&#x27;s visualization and patching utilities should work with Equinox too, so you shouldn&#x27;t necessarily need to fully commit to either one.)</div><br/><div id="40110538" class="c"><input type="checkbox" id="c-40110538" checked=""/><div class="controls bullet"><span class="by">catgary</span><span>|</span><a href="#40108135">root</a><span>|</span><a href="#40109894">parent</a><span>|</span><a href="#40108268">next</a><span>|</span><label class="collapse" for="c-40110538">[-]</label><label class="expand" for="c-40110538">[1 more]</label></div><br/><div class="children"><div class="content">This something I’ve thought about in the past, since I messed around with trying to add monads to JAX - I think you made the right call with effect handlers. You might want to take a look at what Koka does, that was the best implementation of effect handlers the last time I checked.</div><br/></div></div></div></div></div></div><div id="40108268" class="c"><input type="checkbox" id="c-40108268" checked=""/><div class="controls bullet"><span class="by">ubj</span><span>|</span><a href="#40108135">prev</a><span>|</span><a href="#40107526">next</a><span>|</span><label class="collapse" for="c-40108268">[-]</label><label class="expand" for="c-40108268">[4 more]</label></div><br/><div class="children"><div class="content">Does anyone know if and how well Penzai can work with Diffrax [1]? I currently use Diffrax + Equinox for scientific machine learning. Penzai looks like an interesting alternative to Equinox.<p>[1]: <a href="https:&#x2F;&#x2F;docs.kidger.site&#x2F;diffrax&#x2F;" rel="nofollow">https:&#x2F;&#x2F;docs.kidger.site&#x2F;diffrax&#x2F;</a></div><br/><div id="40108559" class="c"><input type="checkbox" id="c-40108559" checked=""/><div class="controls bullet"><span class="by">thatguysaguy</span><span>|</span><a href="#40108268">parent</a><span>|</span><a href="#40109172">next</a><span>|</span><label class="collapse" for="c-40108559">[-]</label><label class="expand" for="c-40108559">[1 more]</label></div><br/><div class="children"><div class="content">Not sure on the specific combination, but since everything in Jax is functionally pure it&#x27;s generally really easy to compose libraries. E.g. I&#x27;ve written code which embedded a flax model inside a haiku model without much effort.</div><br/></div></div><div id="40109172" class="c"><input type="checkbox" id="c-40109172" checked=""/><div class="controls bullet"><span class="by">patrickkidger</span><span>|</span><a href="#40108268">parent</a><span>|</span><a href="#40108559">prev</a><span>|</span><a href="#40107526">next</a><span>|</span><label class="collapse" for="c-40109172">[-]</label><label class="expand" for="c-40109172">[2 more]</label></div><br/><div class="children"><div class="content">IIUC then penzai is (deliberately) sacrificing support for higher-order operations like `lax.{while_loop, scan, cond}` or `diffrax.diffeqsolve`, in return for some of the other new features it is trying out (treescope, effects).<p>So it&#x27;s slightly more framework-y than Equinox and will not be completely compatible with arbitrary JAX code. However I have already had a collaborator demonstrate that as long as you <i>don&#x27;t</i> use any higher-order operations, then treescope will actually work out-of-the-box with Equinox modules!<p>So I think the answer to your question is &quot;sort of&quot;:<p>* As long as you only try to inspect things that are happening outside of your `diffrax.diffeqsolve` then you should be good to go. And moreover can probably do this simply by using e.g. Penzai&#x27;s treescope directly alongside your existing Equinox code, without needing to move things over wholesale.<p>* But anything inside probably isn&#x27;t supported + if I understand their setup correctly can never be supported. (Not bashing Penzai there, which I think genuinely looks excellent -- I think it&#x27;s just fundamentally tricky at a technical level.)</div><br/><div id="40109779" class="c"><input type="checkbox" id="c-40109779" checked=""/><div class="controls bullet"><span class="by">ddjohnson</span><span>|</span><a href="#40108268">root</a><span>|</span><a href="#40109172">parent</a><span>|</span><a href="#40107526">next</a><span>|</span><label class="collapse" for="c-40109779">[-]</label><label class="expand" for="c-40109779">[1 more]</label></div><br/><div class="children"><div class="content">Author of Penzai here. I think the answer is a bit more nuanced (and closer to &quot;yes&quot;) than this:<p>- If you want to use the treescope pretty-printer or the pz.select tree manipulation utility, those should work out-of-the-box with both Equinox and Diffrax. Penzai&#x27;s utilities are designed to be as modular as possible (we explicitly try not to be &quot;frameworky&quot;) so they support arbitrary JAX pytrees; if you run into any problems with this please file an issue!<p>- If you want to call a Penzai model inside `diffrax.diffeqsolve`, that should also be fully supported out of the box. Penzai models expose a pure functional interface when called, so you should be able to call a Penzai model anywhere that you&#x27;d call an Equinox model. From the perspective of the model user, you should be able to think of the effect system as an implementation detail. Again, if you run into problems here, please file an issue.<p>- If you want to write your own Penzai layer that uses `diffrax.diffeqsolve` internally, that should also work. You can put arbitrary logic inside a Penzai layer as long as it&#x27;s pure.<p>- The specific thing that is <i>not</i> currently fully supported is:
  (1) defining a higher-order Penzai combinator <i>layer</i> that uses `diffrax.diffeqsolve` internally,
  (2) and having that layer run one of its sublayers inside the `diffrax.diffeqsolve` function,
  (3) while simultaneously having that internal sublayer use an effect (like random numbers, state, or parameter sharing),
  (4) where the handler for that effect is placed <i>outside</i> of the combinator layer.
  This is because the temporary effect implementation node that gets inserted while a handler is running isn&#x27;t a JAX array type, so you&#x27;ll get a JAX error when you try to pass it through a function transformation.<p>This last case is something I&#x27;d like to support as well, but I still need to figure out what the semantics of it should be. (E.g. what does it even mean to solve a differential equation that has a local state variable in it?) I think having side effects inside a transformed function is fundamentally hard to get right!</div><br/></div></div></div></div></div></div><div id="40107526" class="c"><input type="checkbox" id="c-40107526" checked=""/><div class="controls bullet"><span class="by">ein0p</span><span>|</span><a href="#40108268">prev</a><span>|</span><label class="collapse" for="c-40107526">[-]</label><label class="expand" for="c-40107526">[29 more]</label></div><br/><div class="children"><div class="content">Looks great, but outside Google I do not personally know anyone who uses Jax, and I work in this space.</div><br/><div id="40108084" class="c"><input type="checkbox" id="c-40108084" checked=""/><div class="controls bullet"><span class="by">MasterScrat</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107907">next</a><span>|</span><label class="collapse" for="c-40108084">[-]</label><label class="expand" for="c-40108084">[2 more]</label></div><br/><div class="children"><div class="content">We&#x27;ve built our startup from scratch on JAX, selling text-to-image model finetuning, and it&#x27;s given us a consistent edge not only in terms of pure performance but also in terms of &quot;dollars per unit of work&quot;</div><br/><div id="40112182" class="c"><input type="checkbox" id="c-40112182" checked=""/><div class="controls bullet"><span class="by">Havoc</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40108084">parent</a><span>|</span><a href="#40107907">next</a><span>|</span><label class="collapse" for="c-40112182">[-]</label><label class="expand" for="c-40112182">[1 more]</label></div><br/><div class="children"><div class="content">Is that gain from TPU usage or something else?</div><br/></div></div></div></div><div id="40107907" class="c"><input type="checkbox" id="c-40107907" checked=""/><div class="controls bullet"><span class="by">_ntka</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40108084">prev</a><span>|</span><a href="#40107988">next</a><span>|</span><label class="collapse" for="c-40107907">[-]</label><label class="expand" for="c-40107907">[3 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t JAX the most widely used framework in the GenAI space? Most companies there use it -- Cohere, Anthropic, CharacterAI, xAI, Midjourney etc.</div><br/><div id="40110309" class="c"><input type="checkbox" id="c-40110309" checked=""/><div class="controls bullet"><span class="by">smhx</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107907">parent</a><span>|</span><a href="#40109343">next</a><span>|</span><label class="collapse" for="c-40110309">[-]</label><label class="expand" for="c-40110309">[1 more]</label></div><br/><div class="children"><div class="content">most of the GenAI players use both PyTorch and JAX, depending on the hardware they are running on. Character, Anthro, Midjourney, etc. are dual shops (they use both). xAI only uses JAX afaik.</div><br/></div></div><div id="40109343" class="c"><input type="checkbox" id="c-40109343" checked=""/><div class="controls bullet"><span class="by">mistrial9</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107907">parent</a><span>|</span><a href="#40110309">prev</a><span>|</span><a href="#40107988">next</a><span>|</span><label class="collapse" for="c-40109343">[-]</label><label class="expand" for="c-40109343">[1 more]</label></div><br/><div class="children"><div class="content">just guessing that tech leadership at all of those traces back to Google somehow</div><br/></div></div></div></div><div id="40107988" class="c"><input type="checkbox" id="c-40107988" checked=""/><div class="controls bullet"><span class="by">KeplerBoy</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107907">prev</a><span>|</span><a href="#40107810">next</a><span>|</span><label class="collapse" for="c-40107988">[-]</label><label class="expand" for="c-40107988">[1 more]</label></div><br/><div class="children"><div class="content">I use it for GPU accelerated signal processing. It really delivers on the promise of &quot;Numpy but for GPU&quot; better than all competing libraries out there.</div><br/></div></div><div id="40107810" class="c"><input type="checkbox" id="c-40107810" checked=""/><div class="controls bullet"><span class="by">error9348</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107988">prev</a><span>|</span><a href="#40107744">next</a><span>|</span><label class="collapse" for="c-40107810">[-]</label><label class="expand" for="c-40107810">[9 more]</label></div><br/><div class="children"><div class="content">Jax trends on papers with code:<p><a href="https:&#x2F;&#x2F;paperswithcode.com&#x2F;trends" rel="nofollow">https:&#x2F;&#x2F;paperswithcode.com&#x2F;trends</a></div><br/><div id="40107922" class="c"><input type="checkbox" id="c-40107922" checked=""/><div class="controls bullet"><span class="by">nostrademons</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107810">parent</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40107922">[-]</label><label class="expand" for="c-40107922">[7 more]</label></div><br/><div class="children"><div class="content">Was gonna ask &quot;What&#x27;s that MindSpore thing that seems to be taking the research world by storm?&quot; but I Googled and it&#x27;s apparently Huawei&#x27;s open-source AI framework.  1% to 7% market share in 2 years is nothing to sneeze at - that&#x27;s growth rates similar to Chrome or Facebook in their heyday.<p>It&#x27;s telling that Huawei-backed MindSpore can go from 1% to 7% in 2 years, while Google-backed Jax is stuck at 2-3%.  Contrary to popular narrative in the Western world, Chinese dominance is alive and well.</div><br/><div id="40110953" class="c"><input type="checkbox" id="c-40110953" checked=""/><div class="controls bullet"><span class="by">niihau_island</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107922">parent</a><span>|</span><a href="#40107964">next</a><span>|</span><label class="collapse" for="c-40110953">[-]</label><label class="expand" for="c-40110953">[1 more]</label></div><br/><div class="children"><div class="content">When I looked into a random sampling of these uses, my impression was that it was a common kind of project in China to take a common paper (or another repo) and implement it in Mindspore. That accounted for the vast majority of the implementations.</div><br/></div></div><div id="40107964" class="c"><input type="checkbox" id="c-40107964" checked=""/><div class="controls bullet"><span class="by">logicchains</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107922">parent</a><span>|</span><a href="#40110953">prev</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40107964">[-]</label><label class="expand" for="c-40107964">[5 more]</label></div><br/><div class="children"><div class="content">&gt;It&#x27;s telling that Huawei-backed MindSpore can go from 1% to 7% in 2 years, while Google-backed Jax is stuck at 2-3%. Contrary to popular narrative in the Western world, Chinese dominance is alive and well.<p>MindSpore has an advantage there because of its integrated support for Huawei&#x27;s Ascend 910B, the only Chinese GPU that comes close to matching the A100. Given  the US banned export of A100 and H100s to China, this creates artificial demand for the Ascend 910B chips and the MindSpore framework that utilises them.</div><br/><div id="40108306" class="c"><input type="checkbox" id="c-40108306" checked=""/><div class="controls bullet"><span class="by">bigcat12345678</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107964">parent</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40108306">[-]</label><label class="expand" for="c-40108306">[4 more]</label></div><br/><div class="children"><div class="content">No, mindspore rises because of the chip embargo<p>No one is going to use stuff that one day is cut off supply.<p>This is one signal why Huawei was listed by Nvidia as competitor in 4 out of 5 categories of areas, in nvidia&#x27;s earnings</div><br/><div id="40108827" class="c"><input type="checkbox" id="c-40108827" checked=""/><div class="controls bullet"><span class="by">ein0p</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40108306">parent</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40108827">[-]</label><label class="expand" for="c-40108827">[3 more]</label></div><br/><div class="children"><div class="content">Its meteoric rise started well before the chip embargo. I&#x27;ve looked into it, it liberally borrows ideas from other frameworks, both PyTorch and Jax, and adds some of its own. You lose some of the conceptual purity, but it makes up for it in practical usability, assuming it works as it says on the tin, which it may or may not. PyTorch also has support for Ascend as far as I can tell <a href="https:&#x2F;&#x2F;github.com&#x2F;Ascend&#x2F;pytorch">https:&#x2F;&#x2F;github.com&#x2F;Ascend&#x2F;pytorch</a>, so that support does not necessarily explain MindSpore&#x27;s relative success. Why MindSpore is rising so rapidly is not entirely clear to me. Could be something as simple as preferring a domestic alternative that is adequate to the task and has better documentation in Chinese. Could be cost of compute. Could be both. Nowadays, however, I do agree that the various embargoes would help it (as well as Huawei) a great deal. As a side note I wish Huawei could export its silicon to the West. I bet that&#x27;d result in dramatically cheaper compute.</div><br/><div id="40109142" class="c"><input type="checkbox" id="c-40109142" checked=""/><div class="controls bullet"><span class="by">creato</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40108827">parent</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40109142">[-]</label><label class="expand" for="c-40109142">[2 more]</label></div><br/><div class="children"><div class="content">This data might just be unreliable. It had a weird spike in Dec 2021 that looks unusual compared to all the other frameworks.</div><br/><div id="40109588" class="c"><input type="checkbox" id="c-40109588" checked=""/><div class="controls bullet"><span class="by">VHRanger</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40109142">parent</a><span>|</span><a href="#40107850">next</a><span>|</span><label class="collapse" for="c-40109588">[-]</label><label class="expand" for="c-40109588">[1 more]</label></div><br/><div class="children"><div class="content">China publishes a looooootttttt of papers. A lot of it is careerist crap.<p>To be fair, a lot of US papers are also crap, but Chinese crap research is on another level. There&#x27;s a reason a lot of top US researchers are Chinese - there&#x27;s brain drain going on.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="40107850" class="c"><input type="checkbox" id="c-40107850" checked=""/><div class="controls bullet"><span class="by">ein0p</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107810">parent</a><span>|</span><a href="#40107922">prev</a><span>|</span><a href="#40107744">next</a><span>|</span><label class="collapse" for="c-40107850">[-]</label><label class="expand" for="c-40107850">[1 more]</label></div><br/><div class="children"><div class="content">Note that most of Jax’s minuscule share is Google.</div><br/></div></div></div></div><div id="40107744" class="c"><input type="checkbox" id="c-40107744" checked=""/><div class="controls bullet"><span class="by">j7ake</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107810">prev</a><span>|</span><a href="#40107735">next</a><span>|</span><label class="collapse" for="c-40107744">[-]</label><label class="expand" for="c-40107744">[2 more]</label></div><br/><div class="children"><div class="content">I’m in academia and I use jax because it’s closest to translate maths to code.</div><br/><div id="40109824" class="c"><input type="checkbox" id="c-40109824" checked=""/><div class="controls bullet"><span class="by">hyperbovine</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107744">parent</a><span>|</span><a href="#40107735">next</a><span>|</span><label class="collapse" for="c-40109824">[-]</label><label class="expand" for="c-40109824">[1 more]</label></div><br/><div class="children"><div class="content">Same, Jax is extremely popular  with the applied math&#x2F;modeling crowd.</div><br/></div></div></div></div><div id="40107735" class="c"><input type="checkbox" id="c-40107735" checked=""/><div class="controls bullet"><span class="by">polygamous_bat</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107744">prev</a><span>|</span><a href="#40107859">next</a><span>|</span><label class="collapse" for="c-40107735">[-]</label><label class="expand" for="c-40107735">[1 more]</label></div><br/><div class="children"><div class="content">A small addendum: the only people I know who uses Jax are people who work at Google, or people who had a big GCP grant and needed to use TPUs as a result.</div><br/></div></div><div id="40107859" class="c"><input type="checkbox" id="c-40107859" checked=""/><div class="controls bullet"><span class="by">mccoyb</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107735">prev</a><span>|</span><a href="#40107937">next</a><span>|</span><label class="collapse" for="c-40107859">[-]</label><label class="expand" for="c-40107859">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s cool -- but wouldn&#x27;t it be more constructive to discuss &quot;the ideas&quot; in this package anyways?<p>For instance, it would be interesting to discern if the design of PyTorch (and their modules) preclude or admit the same sort of visualization tooling? If you have expertise in PyTorch, perhaps you could help answer this sort of question?<p>JAX&#x27;s Pytrees are like &quot;immutable structs, with array leaves&quot; -- does PyTorch have a similar concept?</div><br/><div id="40107946" class="c"><input type="checkbox" id="c-40107946" checked=""/><div class="controls bullet"><span class="by">fpgamlirfanboy</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107859">parent</a><span>|</span><a href="#40107881">next</a><span>|</span><label class="collapse" for="c-40107946">[-]</label><label class="expand" for="c-40107946">[1 more]</label></div><br/><div class="children"><div class="content">&gt; does PyTorch have a similar concept<p>of course <a href="https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;pytorch&#x2F;blob&#x2F;main&#x2F;torch&#x2F;utils&#x2F;_pytree.py">https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;pytorch&#x2F;blob&#x2F;main&#x2F;torch&#x2F;utils&#x2F;_py...</a></div><br/></div></div><div id="40107881" class="c"><input type="checkbox" id="c-40107881" checked=""/><div class="controls bullet"><span class="by">ein0p</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107859">parent</a><span>|</span><a href="#40107946">prev</a><span>|</span><a href="#40107937">next</a><span>|</span><label class="collapse" for="c-40107881">[-]</label><label class="expand" for="c-40107881">[1 more]</label></div><br/><div class="children"><div class="content">Idk if you need that immutability actually. You could probably reconstruct enough to do this kind of viz from the autograd graph, or capture the graph and intermediates in the forward pass using hooks. My hunch is it should be doable.</div><br/></div></div></div></div><div id="40107937" class="c"><input type="checkbox" id="c-40107937" checked=""/><div class="controls bullet"><span class="by">logicchains</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107859">prev</a><span>|</span><a href="#40108003">next</a><span>|</span><label class="collapse" for="c-40107937">[-]</label><label class="expand" for="c-40107937">[1 more]</label></div><br/><div class="children"><div class="content">Not at Google but currently using Jax to leverage TPUs, because AWS&#x27;s GPU pricing is eye-gougingly expensive. For the lower-end A10 GPUs, the price-per-gpu for a 4 GPU machine is 1.5x the price for a 1 GPU machine, and the price-per-gpu for a 8 GPU machine is 2x the price of a 1 GPU machine! If you want a A100 or H100, the only option is renting an 8 GPU instance. With properly TPU-optimised code you get something like 30-50% cost saving on GCP TPUs compared to AWS (and I say that as someone who otherwise doesn&#x27;t like Google as a company and would prefer to avoid GCP if there wasn&#x27;t such a significant cost advantage).</div><br/></div></div><div id="40108003" class="c"><input type="checkbox" id="c-40108003" checked=""/><div class="controls bullet"><span class="by">sudosysgen</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107937">prev</a><span>|</span><a href="#40107704">next</a><span>|</span><label class="collapse" for="c-40108003">[-]</label><label class="expand" for="c-40108003">[3 more]</label></div><br/><div class="children"><div class="content">I use it all the time, and there&#x27;s also a few classes at my uni that use Jax. It&#x27;s really great for experimentation and research, you can do a lot of things in Jax you just can&#x27;t in, say, PyTorch.</div><br/><div id="40110865" class="c"><input type="checkbox" id="c-40110865" checked=""/><div class="controls bullet"><span class="by">p1esk</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40108003">parent</a><span>|</span><a href="#40107704">next</a><span>|</span><label class="collapse" for="c-40110865">[-]</label><label class="expand" for="c-40110865">[2 more]</label></div><br/><div class="children"><div class="content">Like what?</div><br/><div id="40110912" class="c"><input type="checkbox" id="c-40110912" checked=""/><div class="controls bullet"><span class="by">sudosysgen</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40110865">parent</a><span>|</span><a href="#40107704">next</a><span>|</span><label class="collapse" for="c-40110912">[-]</label><label class="expand" for="c-40110912">[1 more]</label></div><br/><div class="children"><div class="content">Anytime you want to make something GPU accelerated that doesn&#x27;t fit as standard operations on tensors. For example, I often write RL environments in Jax, which is something you can&#x27;t do in PyTorch. There&#x27;s also things you can do in PyTorch but that would be far more difficult, for example an efficient implementation of MCTS.<p>I also used Jax a lot for differential equations, not even sure how I would do that with PyTorch.<p>Basically, Torch is a lot more like a specialization of Numpy for neural networks, while Jax feels a lot more like if you could just write CUDA as Python, and also get the Jacobians (jacs! jax!) and jvp for free (of everything, you can even differentiate hyperparameters through your optimizer which is crazy).<p>At the end, when you&#x27;re doing fundamental research and coming up with something new, I think Jax is just better. If all I had to do was implementation, then I would be a happy PyTorch user.</div><br/></div></div></div></div></div></div><div id="40107704" class="c"><input type="checkbox" id="c-40107704" checked=""/><div class="controls bullet"><span class="by">yshvrdhn</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40108003">prev</a><span>|</span><a href="#40108264">next</a><span>|</span><label class="collapse" for="c-40107704">[-]</label><label class="expand" for="c-40107704">[2 more]</label></div><br/><div class="children"><div class="content">it would be great if we can have intelligent tools for building neural networks in pytorch.</div><br/><div id="40107868" class="c"><input type="checkbox" id="c-40107868" checked=""/><div class="controls bullet"><span class="by">Edmond</span><span>|</span><a href="#40107526">root</a><span>|</span><a href="#40107704">parent</a><span>|</span><a href="#40108264">next</a><span>|</span><label class="collapse" for="c-40107868">[-]</label><label class="expand" for="c-40107868">[1 more]</label></div><br/><div class="children"><div class="content">would a comprehensive object construction platform with schema support and the ability to hookup to a compiler (ie turn object data to code for instance) be a useful tool in this domain?<p>ex: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=fPnD6I9w84c" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=fPnD6I9w84c</a><p>I am the developer, happy to answer questions.</div><br/></div></div></div></div><div id="40108264" class="c"><input type="checkbox" id="c-40108264" checked=""/><div class="controls bullet"><span class="by">eli_gottlieb</span><span>|</span><a href="#40107526">parent</a><span>|</span><a href="#40107704">prev</a><span>|</span><label class="collapse" for="c-40108264">[-]</label><label class="expand" for="c-40108264">[1 more]</label></div><br/><div class="children"><div class="content">If JAX had affine_grid() and grid_sample(), I&#x27;d be using it instead of PyTorch for my current project.</div><br/></div></div></div></div></div></div></div></div></div></body></html>