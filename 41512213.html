<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1726477279973" as="style"/><link rel="stylesheet" href="styles.css?v=1726477279973"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://kristoff.it/blog/first-html-lsp/">The First HTML LSP That Reports Syntax Errors</a> <span class="domain">(<a href="https://kristoff.it">kristoff.it</a>)</span></div><div class="subtext"><span>todsacerdoti</span> | <span>20 comments</span></div><br/><div><div id="41552047" class="c"><input type="checkbox" id="c-41552047" checked=""/><div class="controls bullet"><span class="by">throw10920</span><span>|</span><a href="#41553128">next</a><span>|</span><label class="collapse" for="c-41552047">[-]</label><label class="expand" for="c-41552047">[7 more]</label></div><br/><div class="children"><div class="content">&gt; The best feature of SuperHTML is that it is based on the official HTML living specification, but it deviates from it when it makes sense to do so.<p>I think this is actually a decent design decision. Unlike in networking, where application of Postel&#x27;s Law (specifically, the &quot;be liberal in what you accept&quot; part) can lead to implementation details becoming de-facto part of the spec, SuperHTML isn&#x27;t outputting data to another system for further processing - it&#x27;s giving information (validation errors) to a <i>human</i> for their own use, and if this information leads to humans writing HTML that&#x27;s a more-robust strict subset of the formal HTML spec, all the better.</div><br/><div id="41552576" class="c"><input type="checkbox" id="c-41552576" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#41552047">parent</a><span>|</span><a href="#41553781">next</a><span>|</span><label class="collapse" for="c-41552576">[-]</label><label class="expand" for="c-41552576">[3 more]</label></div><br/><div class="children"><div class="content">&gt; a more-robust strict subset of the formal HTML spec<p>I still think we’d be better off just using XHTML. There are some practical problems with XHTML5 (e.g. there’s no named entities support for some reason), but the syntax makes sense at least.</div><br/><div id="41553677" class="c"><input type="checkbox" id="c-41553677" checked=""/><div class="controls bullet"><span class="by">zarzavat</span><span>|</span><a href="#41552047">root</a><span>|</span><a href="#41552576">parent</a><span>|</span><a href="#41553781">next</a><span>|</span><label class="collapse" for="c-41553677">[-]</label><label class="expand" for="c-41553677">[2 more]</label></div><br/><div class="children"><div class="content">That was tried 20 years ago and it turns out that humans are not good at writing XML.<p>XML makes sense if you are authoring HTML in an editor. However, this is not how most HTML is actually produced. It&#x27;s mostly produced by templating engines. This means that you can&#x27;t validate the XHTML during development because it&#x27;s being generated on the fly. You only find out that it&#x27;s valid in testing or production, perhaps only for a subset of users in certain situations. With HTML this is OK because there is error recovery. For XHTML you get literal downtime because the entire page shows a WSOD in the worst case.<p>Yes XHTML is okay as an internal tool, if for some reason your pipeline depends on parsing your own HTML then switching to XHTML internally could be a win. Just don&#x27;t ship XHTML to browsers.</div><br/><div id="41554098" class="c"><input type="checkbox" id="c-41554098" checked=""/><div class="controls bullet"><span class="by">bazoom42</span><span>|</span><a href="#41552047">root</a><span>|</span><a href="#41553677">parent</a><span>|</span><a href="#41553781">next</a><span>|</span><label class="collapse" for="c-41554098">[-]</label><label class="expand" for="c-41554098">[1 more]</label></div><br/><div class="children"><div class="content">Surely a template engine would be able to produce valid (X)HTML?<p>Strict XHTML failed on the web because older browsers could not show it at all (since it used a different mime type) so nobody would use it. It wasnt the strictness per se that was the problem, it was how it was introduced without concern for backwards compatibility.<p>JavaScript is strict in the sense any syntax error will terminate execution. This seems to work fine.</div><br/></div></div></div></div></div></div><div id="41553781" class="c"><input type="checkbox" id="c-41553781" checked=""/><div class="controls bullet"><span class="by">tannhaeuser</span><span>|</span><a href="#41552047">parent</a><span>|</span><a href="#41552576">prev</a><span>|</span><a href="#41553767">next</a><span>|</span><label class="collapse" for="c-41553781">[-]</label><label class="expand" for="c-41553781">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>but it deviates from it when it makes sense to do so</i><p>I guess it&#x27;s ok to take liberties when the &quot;official spec&quot; (WHATWG HTML? which version? a W3C snapshot? older redacted W3C spec? or even MDN as the author is saying elsewhere?) has evolved over the course of ten or more years, but the base and where the model deviates should be documented, shouldn&#x27;t it?<p>Doing so might also help with the issues found when this was first discussed [1], such as the bogus hgroup deprecation and possibly related h1-h6 end-element tags. For context, hgroup is not WHATWG-deprecated even though it was never part of W3C HTML until 2021 and marked deprecated according to the author&#x27;s consulted MDN reference (which is <i>not</i> canonical). What has changed (in a backward-incompatible way!) is its content model due to its role changing from providing a mechanism to prevent HTML outlining in ToC&#x2F;navigational content as outlining has been removed alltogether.<p>See the details in [3], and you can use the referenced SGML DTD grammar for checking against that particular (arguably bogus and not anymore deserving of the &quot;HTML 5&quot; moniker) HTML version&#x2F;snapshot, as well as earlier WHATWG and W3C HTML snapshots&#x2F;recommendations.<p>[1]: <a href="https:&#x2F;&#x2F;lobste.rs&#x2F;s&#x2F;o9khjn&#x2F;first_html_lsp_reports_syntax_errors" rel="nofollow">https:&#x2F;&#x2F;lobste.rs&#x2F;s&#x2F;o9khjn&#x2F;first_html_lsp_reports_syntax_err...</a><p>[2]: <a href="https:&#x2F;&#x2F;sgmljs.net&#x2F;docs&#x2F;html230116.html" rel="nofollow">https:&#x2F;&#x2F;sgmljs.net&#x2F;docs&#x2F;html230116.html</a><p>[3]: <a href="https:&#x2F;&#x2F;sgmljs.net&#x2F;blog&#x2F;blog2303.html" rel="nofollow">https:&#x2F;&#x2F;sgmljs.net&#x2F;blog&#x2F;blog2303.html</a></div><br/></div></div><div id="41553767" class="c"><input type="checkbox" id="c-41553767" checked=""/><div class="controls bullet"><span class="by">qbane</span><span>|</span><a href="#41552047">parent</a><span>|</span><a href="#41553781">prev</a><span>|</span><a href="#41553020">next</a><span>|</span><label class="collapse" for="c-41553767">[-]</label><label class="expand" for="c-41553767">[1 more]</label></div><br/><div class="children"><div class="content">Like what most linters do? Linters are supposedly more strict on the syntax so that programmers can enforce their own rules.</div><br/></div></div><div id="41553020" class="c"><input type="checkbox" id="c-41553020" checked=""/><div class="controls bullet"><span class="by">bazoom42</span><span>|</span><a href="#41552047">parent</a><span>|</span><a href="#41553767">prev</a><span>|</span><a href="#41553128">next</a><span>|</span><label class="collapse" for="c-41553020">[-]</label><label class="expand" for="c-41553020">[1 more]</label></div><br/><div class="children"><div class="content">It seems the deviations only make it more strict? It flags some valid HTML as errors.<p>But I agree about with you in genral about Postels Law.</div><br/></div></div></div></div><div id="41553128" class="c"><input type="checkbox" id="c-41553128" checked=""/><div class="controls bullet"><span class="by">chrismorgan</span><span>|</span><a href="#41552047">prev</a><span>|</span><a href="#41551901">next</a><span>|</span><label class="collapse" for="c-41553128">[-]</label><label class="expand" for="c-41553128">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>My favorite example is &lt;li&gt;item&lt;li&gt;, which is unfortunately both valid HTML and also an obvious typo.</i><p>If it’s &lt;li&gt;item&lt;li&gt; and then the next line is &lt;li&gt;item&lt;&#x2F;li&gt;, it’s an obvious error, but you certainly need to discriminate in that sort of way. Because if your thing goes complaining when I write &lt;li&gt;item&lt;li&gt;item, I’ll be upset.<p>(In practice, it would almost always be &lt;li&gt;item and then a next line &lt;li&gt;item; when doing things like horizontal menus, you <i>used</i> to use `display: inline-block` and need to avoid whitespace between list items, so you <i>would</i> find &lt;li&gt;item&lt;li&gt;item in serious code, but now you’d use flex and so whitespace between items gets vanished, so you can write it on multiple lines without it affecting the actual layout.)</div><br/></div></div><div id="41551901" class="c"><input type="checkbox" id="c-41551901" checked=""/><div class="controls bullet"><span class="by">catlifeonmars</span><span>|</span><a href="#41553128">prev</a><span>|</span><a href="#41551467">next</a><span>|</span><label class="collapse" for="c-41551901">[-]</label><label class="expand" for="c-41551901">[7 more]</label></div><br/><div class="children"><div class="content">This is totally pedantic, but LSP stands for “Language Server Protocol”. I think they mean LS (or Language Server)</div><br/><div id="41552454" class="c"><input type="checkbox" id="c-41552454" checked=""/><div class="controls bullet"><span class="by">aaronbrethorst</span><span>|</span><a href="#41551901">parent</a><span>|</span><a href="#41553021">next</a><span>|</span><label class="collapse" for="c-41552454">[-]</label><label class="expand" for="c-41552454">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a clarification that you can take all the way to the bank—or at least to the AT machine.</div><br/><div id="41553293" class="c"><input type="checkbox" id="c-41553293" checked=""/><div class="controls bullet"><span class="by">kreetx</span><span>|</span><a href="#41551901">root</a><span>|</span><a href="#41552454">parent</a><span>|</span><a href="#41553021">next</a><span>|</span><label class="collapse" for="c-41553293">[-]</label><label class="expand" for="c-41553293">[2 more]</label></div><br/><div class="children"><div class="content">Yup, much like pull request vs merge request - the &quot;wrong&quot; one is here to stay.</div><br/><div id="41553975" class="c"><input type="checkbox" id="c-41553975" checked=""/><div class="controls bullet"><span class="by">imjonse</span><span>|</span><a href="#41551901">root</a><span>|</span><a href="#41553293">parent</a><span>|</span><a href="#41553021">next</a><span>|</span><label class="collapse" for="c-41553975">[-]</label><label class="expand" for="c-41553975">[1 more]</label></div><br/><div class="children"><div class="content">On gitlab at least it is merge request, but the platform using the &quot;wrong&quot; term is more popular.</div><br/></div></div></div></div></div></div><div id="41553021" class="c"><input type="checkbox" id="c-41553021" checked=""/><div class="controls bullet"><span class="by">pimlottc</span><span>|</span><a href="#41551901">parent</a><span>|</span><a href="#41552454">prev</a><span>|</span><a href="#41552426">next</a><span>|</span><label class="collapse" for="c-41553021">[-]</label><label class="expand" for="c-41553021">[1 more]</label></div><br/><div class="children"><div class="content">Coming from a different background, LSP to me means “linguistic service provider” (i.e. human language translation). I wasn’t familiar with this LSP [0] at all.<p>0: <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Language_Server_Protocol" rel="nofollow">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Language_Server_Protocol</a></div><br/></div></div><div id="41552426" class="c"><input type="checkbox" id="c-41552426" checked=""/><div class="controls bullet"><span class="by">binary132</span><span>|</span><a href="#41551901">parent</a><span>|</span><a href="#41553021">prev</a><span>|</span><a href="#41551467">next</a><span>|</span><label class="collapse" for="c-41552426">[-]</label><label class="expand" for="c-41552426">[2 more]</label></div><br/><div class="children"><div class="content">Yeah, that detail of terminology always bothered me a bit.  That said, we do call HTTP servers that, not “Hypertext servers”.  Then again, we don’t call an HTTP server “an HTTP”.  :)</div><br/><div id="41552588" class="c"><input type="checkbox" id="c-41552588" checked=""/><div class="controls bullet"><span class="by">notpushkin</span><span>|</span><a href="#41551901">root</a><span>|</span><a href="#41552426">parent</a><span>|</span><a href="#41551467">next</a><span>|</span><label class="collapse" for="c-41552588">[-]</label><label class="expand" for="c-41552588">[1 more]</label></div><br/><div class="children"><div class="content">“LSP server” doesn’t sound too bad!</div><br/></div></div></div></div></div></div><div id="41551467" class="c"><input type="checkbox" id="c-41551467" checked=""/><div class="controls bullet"><span class="by">paranoidxprod</span><span>|</span><a href="#41551901">prev</a><span>|</span><label class="collapse" for="c-41551467">[-]</label><label class="expand" for="c-41551467">[4 more]</label></div><br/><div class="children"><div class="content">The LSP space is super interesting right now. Looking forward to diving deeper into&#x2F;trying this!</div><br/><div id="41551641" class="c"><input type="checkbox" id="c-41551641" checked=""/><div class="controls bullet"><span class="by">meiraleal</span><span>|</span><a href="#41551467">parent</a><span>|</span><label class="collapse" for="c-41551641">[-]</label><label class="expand" for="c-41551641">[3 more]</label></div><br/><div class="children"><div class="content">The specification is so huge and complex. I was interested for a while but that faded fast when I started to dig into it. Also no browser-only support made it a no-go for me. Although I have seem a few cool hacks to run it in a webworker.</div><br/><div id="41551680" class="c"><input type="checkbox" id="c-41551680" checked=""/><div class="controls bullet"><span class="by">ivanjermakov</span><span>|</span><a href="#41551467">root</a><span>|</span><a href="#41551641">parent</a><span>|</span><label class="collapse" for="c-41551680">[-]</label><label class="expand" for="c-41551680">[2 more]</label></div><br/><div class="children"><div class="content">LSP server does not have to implement all of the spec to be useful. Just using document change and diagnostics allows to implement basic linter or spell checker.<p>I can recommend a nice video series on implementing LSP from scratch: <a href="https:&#x2F;&#x2F;youtube.com&#x2F;playlist?list=PLq5tGLDKHlW9XKRj5-plHdvbkT5AOdM7-&amp;si=6r1WkhasHJJ3FkCg" rel="nofollow">https:&#x2F;&#x2F;youtube.com&#x2F;playlist?list=PLq5tGLDKHlW9XKRj5-plHdvbk...</a></div><br/><div id="41551697" class="c"><input type="checkbox" id="c-41551697" checked=""/><div class="controls bullet"><span class="by">kristoff_it</span><span>|</span><a href="#41551467">root</a><span>|</span><a href="#41551680">parent</a><span>|</span><label class="collapse" for="c-41551697">[-]</label><label class="expand" for="c-41551697">[1 more]</label></div><br/><div class="children"><div class="content">Yep, the LSP mentioned in the blog post (I&#x27;m the author) only implements diagnostics and autoformatting for now. With just that you can already provide a lot of utility.<p>This is my starting point for implementing language servers in Zig: <a href="https:&#x2F;&#x2F;github.com&#x2F;kristoff-it&#x2F;zig-lsp-kit">https:&#x2F;&#x2F;github.com&#x2F;kristoff-it&#x2F;zig-lsp-kit</a></div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>