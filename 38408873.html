<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1700902853467" as="style"/><link rel="stylesheet" href="styles.css?v=1700902853467"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/antirez/botlib">Botlib: C Telegram bot framework</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>rgbrgb</span> | <span>64 comments</span></div><br/><div><div id="38411970" class="c"><input type="checkbox" id="c-38411970" checked=""/><div class="controls bullet"><span class="by">antirez</span><span>|</span><a href="#38410031">next</a><span>|</span><label class="collapse" for="c-38411970">[-]</label><label class="expand" for="c-38411970">[2 more]</label></div><br/><div class="children"><div class="content">Author here, thank you for having this project on the front page! I want to explain why this bot is in C, while, for instance, another project of mine that implements a LoRa driver&#x2F;protocol for the ESP32 (a much lower level project, in theory) is in Python!<p>This code started as the Telegram bot Stonky, it&#x27;s on Github, and you&#x27;ll see the bot does a lot of financial analysis things, including Montecarlo simulations. I really needed the speed. Later my daughter was diagnosed with scoliosis, and requires to wear a corset. To take track of the time she wears it was a pita, so I wrote another bot (not released so far) and put it in our family channel.<p>Then... I needed another bot. And I finally extracted the common parts from the two. So:<p>1. For Stonky, speed was essential, but not for my next bot.<p>2. Once I needed to write the new bot for the corset I tried the Python lib. And... I started to have the first code compatibility issues (accross versions) of the modern software stack (context here: <a href="https:&#x2F;&#x2F;twitter.com&#x2F;antirez&#x2F;status&#x2F;1726305869032570992" rel="nofollow noreferrer">https:&#x2F;&#x2F;twitter.com&#x2F;antirez&#x2F;status&#x2F;1726305869032570992</a>).<p>3. Meanwhile Stocky was no longer able to work because I did the unescapable error of basing it on the Yahoo Finance API, now retired :( So I told myself, I don&#x27;t want to relay on a software stack that will make this bot unable to work or obsolete in 2&#x2F;3 years because all the libraries will change fast (and, if you check, you will see there was a lot of work that went into Stonky back in the couple of weeks when I worked at it constantly).<p>On top of that, with Stonky I decided to serve each request with a thread, and not in multiplexing. In the specific case of a Telegram bot this is basically able to simplify many things: many bot requests are long living, because you want to call an LLM API, or Whisper to transcribe, or do a Montecarlo simulation on a stock history, (btw the Whisper thing will be one of the official examples of this library) and so forth. Now in Stonky this approach worked so well because it&#x27;s written in C, so each thread consumes only minimaul resources associated with the OS thread creation.<p>Finally: With SDS lib, my JSON and Sqlite3 wrapper (the wrappers are the interesting part of the project IMHO) it is not so different than writing Python code. So, I said, why not?<p>P.S. this library is just a work in progress, hacked while I&#x27;m doing many other stuff. I hope it will improve in the next weeks. I use Telegram for more than 10 years now, with all my friends and family. So it is very likely I&#x27;ll require to write more bots in the future :D</div><br/><div id="38412264" class="c"><input type="checkbox" id="c-38412264" checked=""/><div class="controls bullet"><span class="by">jay-barronville</span><span>|</span><a href="#38411970">parent</a><span>|</span><a href="#38410031">next</a><span>|</span><label class="collapse" for="c-38412264">[-]</label><label class="expand" for="c-38412264">[1 more]</label></div><br/><div class="children"><div class="content">Unrelated: I just want to say thank you for all of your amazing work over the years. You’re a software hero of mine. I’m 100% certain your code and work has saved me time, money, and maybe even my job! Also, sorry to hear about your daughter. I’m going to pray for you and your family!</div><br/></div></div></div></div><div id="38410031" class="c"><input type="checkbox" id="c-38410031" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38411970">prev</a><span>|</span><a href="#38411935">next</a><span>|</span><label class="collapse" for="c-38410031">[-]</label><label class="expand" for="c-38410031">[7 more]</label></div><br/><div class="children"><div class="content">All: can we please talk about something more interesting than how you don&#x27;t like the language choice? If a project belongs on HN&#x27;s front page, which I presume this one does, there must be more interesting things to talk about than that.</div><br/><div id="38410300" class="c"><input type="checkbox" id="c-38410300" checked=""/><div class="controls bullet"><span class="by">davidw</span><span>|</span><a href="#38410031">parent</a><span>|</span><a href="#38411346">next</a><span>|</span><label class="collapse" for="c-38410300">[-]</label><label class="expand" for="c-38410300">[4 more]</label></div><br/><div class="children"><div class="content">On what is a day off in the middle of a long weekend for many in the US, there&#x27;s something comforting about returning to familiar traditions like eating leftover turkey, spending time with relatives, shopping, and arguing about programming languages.</div><br/><div id="38411275" class="c"><input type="checkbox" id="c-38411275" checked=""/><div class="controls bullet"><span class="by">bch</span><span>|</span><a href="#38410031">root</a><span>|</span><a href="#38410300">parent</a><span>|</span><a href="#38411346">next</a><span>|</span><label class="collapse" for="c-38411275">[-]</label><label class="expand" for="c-38411275">[3 more]</label></div><br/><div class="children"><div class="content">Ffs… I thought you were just joking around until I scrolled down into piles of dead threads.</div><br/><div id="38411302" class="c"><input type="checkbox" id="c-38411302" checked=""/><div class="controls bullet"><span class="by">davidw</span><span>|</span><a href="#38410031">root</a><span>|</span><a href="#38411275">parent</a><span>|</span><a href="#38411346">next</a><span>|</span><label class="collapse" for="c-38411302">[-]</label><label class="expand" for="c-38411302">[2 more]</label></div><br/><div class="children"><div class="content">My guess is it got posted and noticed because &quot;antirez did a thing&quot; rather than a particular interest in Telegram bots.<p>antirez is a bright guy and worth paying attention to, but I think this is just him having some fun.<p>Edit: aha, here&#x27;s what he&#x27;s actually using it for.<p><a href="https:&#x2F;&#x2F;twitter.com&#x2F;antirez&#x2F;status&#x2F;1727969700783460734" rel="nofollow noreferrer">https:&#x2F;&#x2F;twitter.com&#x2F;antirez&#x2F;status&#x2F;1727969700783460734</a></div><br/><div id="38411358" class="c"><input type="checkbox" id="c-38411358" checked=""/><div class="controls bullet"><span class="by">bch</span><span>|</span><a href="#38410031">root</a><span>|</span><a href="#38411302">parent</a><span>|</span><a href="#38411346">next</a><span>|</span><label class="collapse" for="c-38411358">[-]</label><label class="expand" for="c-38411358">[1 more]</label></div><br/><div class="children"><div class="content">Well, it’s sort of neat to me. I’ll probably build some bindings too. Know any good scripting languages?</div><br/></div></div></div></div></div></div></div></div><div id="38411346" class="c"><input type="checkbox" id="c-38411346" checked=""/><div class="controls bullet"><span class="by">Topgamer7</span><span>|</span><a href="#38410031">parent</a><span>|</span><a href="#38410300">prev</a><span>|</span><a href="#38410716">next</a><span>|</span><label class="collapse" for="c-38411346">[-]</label><label class="expand" for="c-38411346">[1 more]</label></div><br/><div class="children"><div class="content">Given that there is probably less attention for good ol&#x27; C projects these days, its probably educational for the masses of readers using interpreted languages to see a simple-ish project using a classic, compiled language.<p>In terms of binary size, memory usage, you probably can&#x27;t beat a slim C project.<p>Difficulty of clean code&#x2F;memory leaks&#x2F;security aside, I think everyone should read or write some C every once in a while. Fix that software that doesn&#x27;t work quite right on wine. Learn the linux kernel enough to fix a bug for hardware you own. Start some project like this. You might learn something, or strengthen some old mental muscles.</div><br/></div></div><div id="38410716" class="c"><input type="checkbox" id="c-38410716" checked=""/><div class="controls bullet"><span class="by">hombre_fatal</span><span>|</span><a href="#38410031">parent</a><span>|</span><a href="#38411346">prev</a><span>|</span><a href="#38411935">next</a><span>|</span><label class="collapse" for="c-38410716">[-]</label><label class="expand" for="c-38410716">[1 more]</label></div><br/><div class="children"><div class="content">To be fair, the Telegram bot API is amazing and speaks for itself, and this bot framework is such a thin wrapper around it that being written in C and the resulting idiosyncrasies are the points of interest.</div><br/></div></div></div></div><div id="38411935" class="c"><input type="checkbox" id="c-38411935" checked=""/><div class="controls bullet"><span class="by">maxlin</span><span>|</span><a href="#38410031">prev</a><span>|</span><a href="#38410121">next</a><span>|</span><label class="collapse" for="c-38411935">[-]</label><label class="expand" for="c-38411935">[1 more]</label></div><br/><div class="children"><div class="content">FYI using non-bot APIs like WTelegram for gathering messages and sending them (even while sending thru a bot account!) gets you rid of the 50MB and similar limits.<p>Source: Run a bot that aggregates and translates several Russian channels for transparency reasons. ~100k msgs processed until now, including hour-long documentaries</div><br/></div></div><div id="38410121" class="c"><input type="checkbox" id="c-38410121" checked=""/><div class="controls bullet"><span class="by">jcul</span><span>|</span><a href="#38411935">prev</a><span>|</span><a href="#38411796">next</a><span>|</span><label class="collapse" for="c-38410121">[-]</label><label class="expand" for="c-38410121">[7 more]</label></div><br/><div class="children"><div class="content">The example mybot.c looks very clean and simple, nice project.<p>It&#x27;s been a while since I played with telegram bots, but I remember thinking it is one of the best APIs I&#x27;ve used. So simple to register a bot directly through the chat interface with the not father, and a 5 second job to add message posting to a bash script etc.</div><br/><div id="38411462" class="c"><input type="checkbox" id="c-38411462" checked=""/><div class="controls bullet"><span class="by">lawik</span><span>|</span><a href="#38410121">parent</a><span>|</span><a href="#38410156">next</a><span>|</span><label class="collapse" for="c-38411462">[-]</label><label class="expand" for="c-38411462">[2 more]</label></div><br/><div class="children"><div class="content">That they offer long polling as one option for fetching updates makes it incredibly friendly for local development and one-offs.<p>I have had so much fun integrating with Telegram from Elixir. There is a lib (not in hex unfortunately) that makes it all quite straightforward.<p>I even gave a remote talk about it with an interactive demo: <a href="https:&#x2F;&#x2F;youtu.be&#x2F;DFGHaER6_j4?si=sooEsiyVTmfXPqNs" rel="nofollow noreferrer">https:&#x2F;&#x2F;youtu.be&#x2F;DFGHaER6_j4?si=sooEsiyVTmfXPqNs</a><p>Telegram is a mile simpler to get going with than the others.</div><br/><div id="38411484" class="c"><input type="checkbox" id="c-38411484" checked=""/><div class="controls bullet"><span class="by">lawik</span><span>|</span><a href="#38410121">root</a><span>|</span><a href="#38411462">parent</a><span>|</span><a href="#38410156">next</a><span>|</span><label class="collapse" for="c-38411484">[-]</label><label class="expand" for="c-38411484">[1 more]</label></div><br/><div class="children"><div class="content">By comparison I am currently doing some work with Google Chat of all things. If your bot is in a Space (channel&#x2F;grouo) it only gets webhooks when someone @-mentions it. Which is really not ideal if you are trying to have an assistant bot participate organically in the convo..<p>I poked around with doing a Slack bot recently and the hoops for an app were many and confusing. Not Google credentials level but more than I cared for.</div><br/></div></div></div></div><div id="38410156" class="c"><input type="checkbox" id="c-38410156" checked=""/><div class="controls bullet"><span class="by">hyperfuturism</span><span>|</span><a href="#38410121">parent</a><span>|</span><a href="#38411462">prev</a><span>|</span><a href="#38411796">next</a><span>|</span><label class="collapse" for="c-38410156">[-]</label><label class="expand" for="c-38410156">[4 more]</label></div><br/><div class="children"><div class="content">Seconded on the Telegram bot API.<p>I&#x27;ve used both Discord&#x27;s bot API as well, and can say it was <i>way</i> more convoluted to get up and going. Telegram&#x27;s API was a joy to build in. This was in Node.js.</div><br/><div id="38410424" class="c"><input type="checkbox" id="c-38410424" checked=""/><div class="controls bullet"><span class="by">pawelduda</span><span>|</span><a href="#38410121">root</a><span>|</span><a href="#38410156">parent</a><span>|</span><a href="#38411086">next</a><span>|</span><label class="collapse" for="c-38410424">[-]</label><label class="expand" for="c-38410424">[2 more]</label></div><br/><div class="children"><div class="content">Is there a simple API to read my chats programmatically? Not a bot, but on my own TG account? I was confused by this a while ago</div><br/><div id="38410842" class="c"><input type="checkbox" id="c-38410842" checked=""/><div class="controls bullet"><span class="by">GaggiX</span><span>|</span><a href="#38410121">root</a><span>|</span><a href="#38410424">parent</a><span>|</span><a href="#38411086">next</a><span>|</span><label class="collapse" for="c-38410842">[-]</label><label class="expand" for="c-38410842">[1 more]</label></div><br/><div class="children"><div class="content">You need to use the &quot;Telegram API&quot;: <a href="https:&#x2F;&#x2F;core.telegram.org&#x2F;api#telegram-api" rel="nofollow noreferrer">https:&#x2F;&#x2F;core.telegram.org&#x2F;api#telegram-api</a> (not the &quot;Bot API&quot;) to develop your client. It uses MTProto to communicate with the server, so I suggest you just use a library that supports it like Telethon if you want to program in Python.</div><br/></div></div></div></div><div id="38411086" class="c"><input type="checkbox" id="c-38411086" checked=""/><div class="controls bullet"><span class="by">nazcan</span><span>|</span><a href="#38410121">root</a><span>|</span><a href="#38410156">parent</a><span>|</span><a href="#38410424">prev</a><span>|</span><a href="#38411796">next</a><span>|</span><label class="collapse" for="c-38411086">[-]</label><label class="expand" for="c-38411086">[1 more]</label></div><br/><div class="children"><div class="content">Care to provide a concrete example of a difference? Curious.</div><br/></div></div></div></div></div></div><div id="38411796" class="c"><input type="checkbox" id="c-38411796" checked=""/><div class="controls bullet"><span class="by">seanvelasco</span><span>|</span><a href="#38410121">prev</a><span>|</span><a href="#38409406">next</a><span>|</span><label class="collapse" for="c-38411796">[-]</label><label class="expand" for="c-38411796">[1 more]</label></div><br/><div class="children"><div class="content">was just looking at the official telegram bot api just last night! i&#x27;m going to give this a try, as a way to get more comfortable with C.<p>on a separate note, does anyone know of a stable telegram api (not bot api) in javascript that doesn&#x27;t require polyfills?</div><br/></div></div></div></div></div></div></div></body></html>