<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719824481844" as="style"/><link rel="stylesheet" href="styles.css?v=1719824481844"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://graphite.dev/blog/google-perforce-to-piper-migration">How Google migrated billions of lines of code from Perforce to Piper</a> <span class="domain">(<a href="https://graphite.dev">graphite.dev</a>)</span></div><div class="subtext"><span>thunderbong</span> | <span>12 comments</span></div><br/><div><div id="40843265" class="c"><input type="checkbox" id="c-40843265" checked=""/><div class="controls bullet"><span class="by">kccqzy</span><span>|</span><a href="#40843272">next</a><span>|</span><label class="collapse" for="c-40843265">[-]</label><label class="expand" for="c-40843265">[6 more]</label></div><br/><div class="children"><div class="content">&gt; In an ideal world, a version control system should be strictly internal facing and be able to fall over without impacting live traffic; however the Piper team kept discovering that this wasn’t the case.<p>This is something that surprised me while I was at Google too. Of course a source code version control system shouldn&#x27;t be a dependency of production, but it turns out it is just so convenient to go from (1) use your source code system to store configuration so that they are versioned and tracked; (2) have tools to read configuration and apply them automatically, Terraform style; (3) have tools to modify said configuration automatically instead of manually. Voila your source version control system suddenly becomes a NoSQL database.</div><br/><div id="40843852" class="c"><input type="checkbox" id="c-40843852" checked=""/><div class="controls bullet"><span class="by">mingyizhao</span><span>|</span><a href="#40843265">parent</a><span>|</span><a href="#40843336">next</a><span>|</span><label class="collapse" for="c-40843852">[-]</label><label class="expand" for="c-40843852">[1 more]</label></div><br/><div class="children"><div class="content">Google&#x27;s source code system isn&#x27;t only used to store config: some teams also use it to store data like ML models. There&#x27;s a limit on the max file size, causing all sorts of trouble in the LLM era. So it&#x27;s a bit like Git LFS, but worse (why have the limit at all?).</div><br/></div></div><div id="40843336" class="c"><input type="checkbox" id="c-40843336" checked=""/><div class="controls bullet"><span class="by">ablatt89</span><span>|</span><a href="#40843265">parent</a><span>|</span><a href="#40843852">prev</a><span>|</span><a href="#40843272">next</a><span>|</span><label class="collapse" for="c-40843336">[-]</label><label class="expand" for="c-40843336">[4 more]</label></div><br/><div class="children"><div class="content">In addition to the benefits above, by storing storing config in version control is 2 party control, presubmit linting, and easy rollbacks. I suppose the trade off is slower rollouts of config and some delay time in pushing out a config but hey, there&#x27;s no free lunch :-)</div><br/><div id="40843526" class="c"><input type="checkbox" id="c-40843526" checked=""/><div class="controls bullet"><span class="by">daemin</span><span>|</span><a href="#40843265">root</a><span>|</span><a href="#40843336">parent</a><span>|</span><a href="#40843272">next</a><span>|</span><label class="collapse" for="c-40843526">[-]</label><label class="expand" for="c-40843526">[3 more]</label></div><br/><div class="children"><div class="content">Nothing preventing you from building a versioned configuration system using a database or similar, especially if you build tools to actually change the configuration rather than hand editing text files.</div><br/><div id="40843657" class="c"><input type="checkbox" id="c-40843657" checked=""/><div class="controls bullet"><span class="by">rockwotj</span><span>|</span><a href="#40843265">root</a><span>|</span><a href="#40843526">parent</a><span>|</span><a href="#40843272">next</a><span>|</span><label class="collapse" for="c-40843657">[-]</label><label class="expand" for="c-40843657">[2 more]</label></div><br/><div class="children"><div class="content">Google has this, IIRC it’s called CDPush</div><br/><div id="40843842" class="c"><input type="checkbox" id="c-40843842" checked=""/><div class="controls bullet"><span class="by">underdeserver</span><span>|</span><a href="#40843265">root</a><span>|</span><a href="#40843657">parent</a><span>|</span><a href="#40843272">next</a><span>|</span><label class="collapse" for="c-40843842">[-]</label><label class="expand" for="c-40843842">[1 more]</label></div><br/><div class="children"><div class="content">CDPush does versioning, canaried rollouts of... hand edited text files.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="40843272" class="c"><input type="checkbox" id="c-40843272" checked=""/><div class="controls bullet"><span class="by">readthenotes1</span><span>|</span><a href="#40843265">prev</a><span>|</span><label class="collapse" for="c-40843272">[-]</label><label class="expand" for="c-40843272">[5 more]</label></div><br/><div class="children"><div class="content">&quot;Jeff Dean, now Alphabet&#x27;s chief scientist, personally stopped by the room that day to check in on the progress, helping boost morale, and further emphasizing the critical nature of the project.&quot;<p>That is such a cringy, fearful, statement...</div><br/><div id="40843664" class="c"><input type="checkbox" id="c-40843664" checked=""/><div class="controls bullet"><span class="by">abraae</span><span>|</span><a href="#40843272">parent</a><span>|</span><a href="#40843390">next</a><span>|</span><label class="collapse" for="c-40843664">[-]</label><label class="expand" for="c-40843664">[2 more]</label></div><br/><div class="children"><div class="content">A bit like &quot;performing the routine heroics needed to keep Google’s source control server alive&quot;.<p>Though perhaps I lack perspective, having just toured Normandy where the D Day landings took place.</div><br/><div id="40843806" class="c"><input type="checkbox" id="c-40843806" checked=""/><div class="controls bullet"><span class="by">DrBazza</span><span>|</span><a href="#40843272">root</a><span>|</span><a href="#40843664">parent</a><span>|</span><a href="#40843390">next</a><span>|</span><label class="collapse" for="c-40843806">[-]</label><label class="expand" for="c-40843806">[1 more]</label></div><br/><div class="children"><div class="content">Also, heroism isn&#x27;t routine.</div><br/></div></div></div></div><div id="40843390" class="c"><input type="checkbox" id="c-40843390" checked=""/><div class="controls bullet"><span class="by">shiroiushi</span><span>|</span><a href="#40843272">parent</a><span>|</span><a href="#40843664">prev</a><span>|</span><a href="#40843837">next</a><span>|</span><label class="collapse" for="c-40843390">[-]</label><label class="expand" for="c-40843390">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like an instance of seagull management.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Seagull_management" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Seagull_management</a></div><br/></div></div><div id="40843837" class="c"><input type="checkbox" id="c-40843837" checked=""/><div class="controls bullet"><span class="by">underdeserver</span><span>|</span><a href="#40843272">parent</a><span>|</span><a href="#40843390">prev</a><span>|</span><label class="collapse" for="c-40843837">[-]</label><label class="expand" for="c-40843837">[1 more]</label></div><br/><div class="children"><div class="content">Why?</div><br/></div></div></div></div></div></div></div></div></div></body></html>