<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1719133273248" as="style"/><link rel="stylesheet" href="styles.css?v=1719133273248"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://sankalp.bearblog.dev/einsum-new/">Shape Rotation 101: An Intro to Einsum and Jax Transformers</a> <span class="domain">(<a href="https://sankalp.bearblog.dev">sankalp.bearblog.dev</a>)</span></div><div class="subtext"><span>dejavucoder</span> | <span>10 comments</span></div><br/><div><div id="40764856" class="c"><input type="checkbox" id="c-40764856" checked=""/><div class="controls bullet"><span class="by">tanvach</span><span>|</span><a href="#40765041">next</a><span>|</span><label class="collapse" for="c-40764856">[-]</label><label class="expand" for="c-40764856">[1 more]</label></div><br/><div class="children"><div class="content">Don’t know if the author will see this: in the table at the end of the article, there is an error where the text description of dot product and matrix multiplication are swapped.<p>Otherwise - great article! Didn’t know this exists in numpy. A really neat way to express matrix operations.</div><br/></div></div><div id="40765041" class="c"><input type="checkbox" id="c-40765041" checked=""/><div class="controls bullet"><span class="by">dima55</span><span>|</span><a href="#40764856">prev</a><span>|</span><a href="#40765052">next</a><span>|</span><label class="collapse" for="c-40765041">[-]</label><label class="expand" for="c-40765041">[1 more]</label></div><br/><div class="children"><div class="content">An important note about numpy broadcasting: numpy broadcasts from the back, so your life improves dramatically when you reference indices from the back as well: use axis references &lt; 0. So if you want to reference a row: refer to axis=-1. This will ALWAYS refer to the row (first broadcasting dimension), whether you have a 1D vector or 2D matrix or any N-D array. Numpy is deeply unfriendly if you don&#x27;t do this. To smooth out this an similar issues, there&#x27;s the numpysane library. But simply using negative axis references goes a long way.</div><br/></div></div><div id="40765052" class="c"><input type="checkbox" id="c-40765052" checked=""/><div class="controls bullet"><span class="by">cl3misch</span><span>|</span><a href="#40765041">prev</a><span>|</span><a href="#40764766">next</a><span>|</span><label class="collapse" for="c-40765052">[-]</label><label class="expand" for="c-40765052">[5 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re into shape rotations with numpy arrays check out einopt.<p>Also consider using &quot;None&quot;
instead of &quot;np.newaxis&quot;. To newcomers it&#x27;s not as self-explanatory but it results in more readable code imho.</div><br/><div id="40765126" class="c"><input type="checkbox" id="c-40765126" checked=""/><div class="controls bullet"><span class="by">majidmir</span><span>|</span><a href="#40765052">parent</a><span>|</span><a href="#40765109">next</a><span>|</span><label class="collapse" for="c-40765126">[-]</label><label class="expand" for="c-40765126">[3 more]</label></div><br/><div class="children"><div class="content">Or even better einx!</div><br/><div id="40765339" class="c"><input type="checkbox" id="c-40765339" checked=""/><div class="controls bullet"><span class="by">cl3misch</span><span>|</span><a href="#40765052">root</a><span>|</span><a href="#40765126">parent</a><span>|</span><a href="#40765250">next</a><span>|</span><label class="collapse" for="c-40765339">[-]</label><label class="expand" for="c-40765339">[1 more]</label></div><br/><div class="children"><div class="content">Wow, that looks like a whole tensor DSL for numpy (which itself is already an array DSL for Python).</div><br/></div></div><div id="40765250" class="c"><input type="checkbox" id="c-40765250" checked=""/><div class="controls bullet"><span class="by">cycomanic</span><span>|</span><a href="#40765052">root</a><span>|</span><a href="#40765126">parent</a><span>|</span><a href="#40765339">prev</a><span>|</span><a href="#40765109">next</a><span>|</span><label class="collapse" for="c-40765250">[-]</label><label class="expand" for="c-40765250">[1 more]</label></div><br/><div class="children"><div class="content">Why is ein better than einopt?</div><br/></div></div></div></div><div id="40765109" class="c"><input type="checkbox" id="c-40765109" checked=""/><div class="controls bullet"><span class="by">dejavucoder</span><span>|</span><a href="#40765052">parent</a><span>|</span><a href="#40765126">prev</a><span>|</span><a href="#40764766">next</a><span>|</span><label class="collapse" for="c-40765109">[-]</label><label class="expand" for="c-40765109">[1 more]</label></div><br/><div class="children"><div class="content">thanks, will check out on einops more.</div><br/></div></div></div></div><div id="40764766" class="c"><input type="checkbox" id="c-40764766" checked=""/><div class="controls bullet"><span class="by">ishan0102</span><span>|</span><a href="#40765052">prev</a><span>|</span><label class="collapse" for="c-40764766">[-]</label><label class="expand" for="c-40764766">[2 more]</label></div><br/><div class="children"><div class="content">so good</div><br/><div id="40764945" class="c"><input type="checkbox" id="c-40764945" checked=""/><div class="controls bullet"><span class="by">dejavucoder</span><span>|</span><a href="#40764766">parent</a><span>|</span><label class="collapse" for="c-40764945">[-]</label><label class="expand" for="c-40764945">[1 more]</label></div><br/><div class="children"><div class="content">thanks</div><br/></div></div></div></div></div></div></div></div></div></body></html>