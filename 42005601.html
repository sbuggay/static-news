<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1730451665107" as="style"/><link rel="stylesheet" href="styles.css?v=1730451665107"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://illya.sh/the-codeumentary-blog/regular-expression-check-if-number-is-prime/">Demystifying the regular expression that checks if a number is prime (2016)</a> <span class="domain">(<a href="https://illya.sh">illya.sh</a>)</span></div><div class="subtext"><span>aquir</span> | <span>14 comments</span></div><br/><div><div id="42014966" class="c"><input type="checkbox" id="c-42014966" checked=""/><div class="controls bullet"><span class="by">pxeger1</span><span>|</span><a href="#42014578">next</a><span>|</span><label class="collapse" for="c-42014966">[-]</label><label class="expand" for="c-42014966">[1 more]</label></div><br/><div class="children"><div class="content">I like this regex, which divides a number by sqrt(2):<p><pre><code>    (?=(x(x*)).*(?=\1*$)\2+$)(?=(x\1)+(x?(x*)))(?=\4(x(x*?))\1+$)(?=.*(?=(?=\4*$)\4\5+$)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\9))(?=.*(?=(?=\4*$)(?=\6*$)(?=\4\7+$)\6\5+$|$\4)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\13))(?=.*(?=\12\12\9$)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\17))(?*.*?(?=((?=\3*(x?(x*)))\21(x(x*?))\1+$)))(?=.*(?=\23*$)(\23\24+$))(?=.*(?=(?=\21*$)\21\22+$)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\27))(?=.*(?=(?=\21*$)(?=\23*$)(?=\21\24+$)\23\22+$|$\21)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\31))(?=.*(?=\30\30\27$)(x*?)(?=\3*$)(x?(x*?))(\1+$|$\35))(?=.*(?=\26\26)(?=\3*(x*))(\1(x)|))(?=.*(?=\34\34\40)(?=\3*(x*))(\1(x)|))(?=(?=(.*)\13\13\17(?=\6*$)\6\7+$)\44(x+|(?=.*(?!\16)\41|(?!.*(?!\38)\8).*(?=\16$)\41$))(\25\31\31\35){2}\43$)\20|xx?\B|
</code></pre>
Source: <a href="https:&#x2F;&#x2F;codegolf.stackexchange.com&#x2F;a&#x2F;198428" rel="nofollow">https:&#x2F;&#x2F;codegolf.stackexchange.com&#x2F;a&#x2F;198428</a></div><br/></div></div><div id="42014578" class="c"><input type="checkbox" id="c-42014578" checked=""/><div class="controls bullet"><span class="by">isoprophlex</span><span>|</span><a href="#42014966">prev</a><span>|</span><a href="#42005605">next</a><span>|</span><label class="collapse" for="c-42014578">[-]</label><label class="expand" for="c-42014578">[1 more]</label></div><br/><div class="children"><div class="content">The precondition that you need to first convert to a unary number makes this feel like it&#x27;s almost cheating.<p>The regex is not totally trivial, but it&#x27;s not super sophisticated either: conceptually &#x27;just&#x27; a Sieve of Eratosthenes.</div><br/></div></div><div id="42005605" class="c"><input type="checkbox" id="c-42005605" checked=""/><div class="controls bullet"><span class="by">aquir</span><span>|</span><a href="#42014578">prev</a><span>|</span><a href="#42014014">next</a><span>|</span><label class="collapse" for="c-42005605">[-]</label><label class="expand" for="c-42005605">[2 more]</label></div><br/><div class="children"><div class="content">Also check the Matt Parker video for a more entertaining explanation: <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=5vbk0TwkokM" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=5vbk0TwkokM</a></div><br/><div id="42014038" class="c"><input type="checkbox" id="c-42014038" checked=""/><div class="controls bullet"><span class="by">sbuttgereit</span><span>|</span><a href="#42005605">parent</a><span>|</span><a href="#42014014">next</a><span>|</span><label class="collapse" for="c-42014038">[-]</label><label class="expand" for="c-42014038">[1 more]</label></div><br/><div class="children"><div class="content">I appreciate that he picks a subject dealing with regexes for his Halloween video.  I can think of few things more frightening or appropriate.</div><br/></div></div></div></div><div id="42014014" class="c"><input type="checkbox" id="c-42014014" checked=""/><div class="controls bullet"><span class="by">IgorPartola</span><span>|</span><a href="#42005605">prev</a><span>|</span><a href="#42013978">next</a><span>|</span><label class="collapse" for="c-42014014">[-]</label><label class="expand" for="c-42014014">[6 more]</label></div><br/><div class="children"><div class="content">So in summary there is no special thing here about this being a regex: the program described by it basically just brute force tries to divide the given number by every number smaller than it, it’s just written in a way that isn’t obvious to understand.<p>That’s not to detract from the excellent post, just that this isn’t a mathematical trick that exploits some structure of primes but rather an incredibly clever way to write a computer program.</div><br/><div id="42014141" class="c"><input type="checkbox" id="c-42014141" checked=""/><div class="controls bullet"><span class="by">shagie</span><span>|</span><a href="#42014014">parent</a><span>|</span><a href="#42014066">next</a><span>|</span><label class="collapse" for="c-42014141">[-]</label><label class="expand" for="c-42014141">[4 more]</label></div><br/><div class="children"><div class="content">Part of it also that this isn&#x27;t a <i>regular</i> language.  The PCRE is more powerful a language than a Chomsky type 3 language in that there are strings that can be matched by a PCRE (such as a prime number expressed in unary) that are not recognized in a pure regular language.<p>Extending finite automata to efficiently match Perl-compatible regular expressions - <a href="http:&#x2F;&#x2F;dx.doi.org&#x2F;10.1145&#x2F;1544012.1544037" rel="nofollow">http:&#x2F;&#x2F;dx.doi.org&#x2F;10.1145&#x2F;1544012.1544037</a></div><br/><div id="42014526" class="c"><input type="checkbox" id="c-42014526" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#42014014">root</a><span>|</span><a href="#42014141">parent</a><span>|</span><a href="#42014066">next</a><span>|</span><label class="collapse" for="c-42014526">[-]</label><label class="expand" for="c-42014526">[3 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t know why people keep pointing this out - RegEx&#x27;s not being regular languages has been true for basically all of history (it is not just pcre, traditional unix (basic) regexes also have this). Most people&#x27;s only experience with &quot;regular&quot; things have been with non-regular regexes. Grep is 51 years old at this point.</div><br/><div id="42014895" class="c"><input type="checkbox" id="c-42014895" checked=""/><div class="controls bullet"><span class="by">jraph</span><span>|</span><a href="#42014014">root</a><span>|</span><a href="#42014526">parent</a><span>|</span><a href="#42015082">next</a><span>|</span><label class="collapse" for="c-42014895">[-]</label><label class="expand" for="c-42014895">[1 more]</label></div><br/><div class="children"><div class="content">Because recognizing a prime number using an actual regular expression would prove that prime numbers form a regular language, which would be an incredible result.<p>And somehow, some people like me are in computer science mode when reading such sentences, such reminders wakes us up: &quot;Oh, ok, not actually regular, not such a big deal&quot;</div><br/></div></div><div id="42015082" class="c"><input type="checkbox" id="c-42015082" checked=""/><div class="controls bullet"><span class="by">kreyenborgi</span><span>|</span><a href="#42014014">root</a><span>|</span><a href="#42014526">parent</a><span>|</span><a href="#42014895">prev</a><span>|</span><a href="#42014066">next</a><span>|</span><label class="collapse" for="c-42015082">[-]</label><label class="expand" for="c-42015082">[1 more]</label></div><br/><div class="children"><div class="content">The OP&#x27;s title uses the word &quot;regular&quot;, and it&#x27;s about doing mathy things which puts the brain in math mode, so it&#x27;s helpful to point out that this is only works with non-regular regexes.</div><br/></div></div></div></div></div></div><div id="42014066" class="c"><input type="checkbox" id="c-42014066" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#42014014">parent</a><span>|</span><a href="#42014141">prev</a><span>|</span><a href="#42013978">next</a><span>|</span><label class="collapse" for="c-42014066">[-]</label><label class="expand" for="c-42014066">[1 more]</label></div><br/><div class="children"><div class="content">...and the divide is effectively implemented by &quot;multiplication&quot;, i.e. repeating the same match group (via backreference). It&#x27;s one of those things that looks impossible at first, but you instantly turn to &quot;of course that&#x27;s how it works!&quot; once you understand. That said, I still think this article is on the verbose side.<p>Also, strictly speaking, it&#x27;s not a &quot;regular expression&quot; but a &quot;regex&quot;, as backreferences make the language more powerful than regular.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Regular_expression#Patterns_for_non-regular_languages" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Regular_expression#Patterns_fo...</a></div><br/></div></div></div></div><div id="42014562" class="c"><input type="checkbox" id="c-42014562" checked=""/><div class="controls bullet"><span class="by">bawolff</span><span>|</span><a href="#42013978">prev</a><span>|</span><a href="#42013818">next</a><span>|</span><label class="collapse" for="c-42014562">[-]</label><label class="expand" for="c-42014562">[1 more]</label></div><br/><div class="children"><div class="content">To save a click, the regex in question is: ^1?$|^(11+?)\1+$ (it checks if a unary number is not prime.<p>It is kind of surprising to hear that regex can do that, but once you see the regex its kind of obvious. Its just checking if the number is 1, or if the number can be represented by 2 or more 1&#x27;s repeated at least 2 times. Which is literally the definition of a prime (is the number divisible by a number &gt;= 2)</div><br/></div></div></div></div></div></div></div></body></html>