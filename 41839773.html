<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1728982876463" as="style"/><link rel="stylesheet" href="styles.css?v=1728982876463"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/spiraldb/vortex">Show HN: Vortex – a high-performance columnar file format</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>gatesn</span> | <span>42 comments</span></div><br/><div><div id="41844267" class="c"><input type="checkbox" id="c-41844267" checked=""/><div class="controls bullet"><span class="by">miere</span><span>|</span><a href="#41846123">next</a><span>|</span><label class="collapse" for="c-41844267">[-]</label><label class="expand" for="c-41844267">[2 more]</label></div><br/><div class="children"><div class="content">Imagine explaining to a newcomer that you write your app using Vert.x, it consumes AI models from GCP Vertex and uses Vortex for its high-performance columnar file structure.</div><br/><div id="41844577" class="c"><input type="checkbox" id="c-41844577" checked=""/><div class="controls bullet"><span class="by">mikeqq2024</span><span>|</span><a href="#41844267">parent</a><span>|</span><a href="#41846123">next</a><span>|</span><label class="collapse" for="c-41844577">[-]</label><label class="expand" for="c-41844577">[1 more]</label></div><br/><div class="children"><div class="content">confusing indeed</div><br/></div></div></div></div><div id="41846123" class="c"><input type="checkbox" id="c-41846123" checked=""/><div class="controls bullet"><span class="by">jarpineh</span><span>|</span><a href="#41844267">prev</a><span>|</span><a href="#41840459">next</a><span>|</span><label class="collapse" for="c-41846123">[-]</label><label class="expand" for="c-41846123">[1 more]</label></div><br/><div class="children"><div class="content">I do applaud this kind of work. Better, faster tooling for data as files and moving across runtimes is sorely needed.<p>Two things I would hope to see before I&#x27;d start using Vorter is geospatial data support (there&#x27;s already Geoparquet [1]) and WASM for in-browser Arrow processing. Things like Lonboard [2] and Observable framework [3] rely on Parquet, Arrow and Duckdb files for their powerful data analytics and visualisation.<p>[1] <a href="https:&#x2F;&#x2F;geoparquet.org" rel="nofollow">https:&#x2F;&#x2F;geoparquet.org</a><p>[2] <a href="https:&#x2F;&#x2F;developmentseed.org&#x2F;lonboard&#x2F;latest&#x2F;" rel="nofollow">https:&#x2F;&#x2F;developmentseed.org&#x2F;lonboard&#x2F;latest&#x2F;</a><p>[3] <a href="https:&#x2F;&#x2F;observablehq.com&#x2F;framework&#x2F;" rel="nofollow">https:&#x2F;&#x2F;observablehq.com&#x2F;framework&#x2F;</a></div><br/></div></div><div id="41840459" class="c"><input type="checkbox" id="c-41840459" checked=""/><div class="controls bullet"><span class="by">the_mitsuhiko</span><span>|</span><a href="#41846123">prev</a><span>|</span><a href="#41846329">next</a><span>|</span><label class="collapse" for="c-41840459">[-]</label><label class="expand" for="c-41840459">[12 more]</label></div><br/><div class="children"><div class="content">&gt; One of the unique attributes of the (in-progress) Vortex file format is that it encodes the physical layout of the data within the file&#x27;s footer. This allows the file format to be effectively self-describing and to evolve without breaking changes to the file format specification.<p>That is quite interesting.  One challenge in general with parqet and arrow in the otel &#x2F; observability ecosystem is that the shape of data is not quite known with spans.  There are arbitrary attributes on them, and they can change.  To the best of my knowledge no particularly great solution exists today for encoding this.  I wonder to which degree this system could be &quot;abused&quot; for that.</div><br/><div id="41842282" class="c"><input type="checkbox" id="c-41842282" checked=""/><div class="controls bullet"><span class="by">robert3005</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41840665">next</a><span>|</span><label class="collapse" for="c-41842282">[-]</label><label class="expand" for="c-41842282">[2 more]</label></div><br/><div class="children"><div class="content">The thing we are trying to achieve is to be able to experiment and tune the way data is groupped on disk. Parquet has one way of laying data out, csv is another (though it&#x27;s a text format so a bit moot), ORC is another, Lance has yet another different method. The file format itself stores how it&#x27;s physically laid out on disk so you can tune and tweak physical layouts to match the specific storage needs of your system (this is the toolkit part where you can take vortex and use it to implement your own file format). Having said that we will have an implementation of file format that follows particular layout.</div><br/><div id="41845178" class="c"><input type="checkbox" id="c-41845178" checked=""/><div class="controls bullet"><span class="by">infogulch</span><span>|</span><a href="#41840459">root</a><span>|</span><a href="#41842282">parent</a><span>|</span><a href="#41840665">next</a><span>|</span><label class="collapse" for="c-41845178">[-]</label><label class="expand" for="c-41845178">[1 more]</label></div><br/><div class="children"><div class="content">Wow, I think this is the thing I wished existed for years! Most file formats leave a huge compression opportunity on the table just because their choice of physical layout. (I call the simple case &quot;striding order&quot;, idk) But getting it right takes a lot of experimentation which becomes too much churn for applications, and can result in storage layouts that are great for compression but are annoying to code against. So the obvious answer (to me at least) is that you need to decouple physical and logical layouts. I&#x27;m glad someone is finally trying it!</div><br/></div></div></div></div><div id="41840665" class="c"><input type="checkbox" id="c-41840665" checked=""/><div class="controls bullet"><span class="by">gigatexal</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41842282">prev</a><span>|</span><a href="#41843259">next</a><span>|</span><label class="collapse" for="c-41840665">[-]</label><label class="expand" for="c-41840665">[2 more]</label></div><br/><div class="children"><div class="content">As someone who works in data schema on read formats like parquet are amazing. I hate having to guess schemas with CSVs.</div><br/><div id="41841700" class="c"><input type="checkbox" id="c-41841700" checked=""/><div class="controls bullet"><span class="by">physicsguy</span><span>|</span><a href="#41840459">root</a><span>|</span><a href="#41840665">parent</a><span>|</span><a href="#41843259">next</a><span>|</span><label class="collapse" for="c-41841700">[-]</label><label class="expand" for="c-41841700">[1 more]</label></div><br/><div class="children"><div class="content">Pandera is quite nice for at least forcing validation in Pandas for this</div><br/></div></div></div></div><div id="41843259" class="c"><input type="checkbox" id="c-41843259" checked=""/><div class="controls bullet"><span class="by">sa46</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41840665">prev</a><span>|</span><a href="#41844697">next</a><span>|</span><label class="collapse" for="c-41843259">[-]</label><label class="expand" for="c-41843259">[2 more]</label></div><br/><div class="children"><div class="content">Parquet also encodes the physical layout using footers [1], as does ORC [2]. Perhaps the author meant support for semi-structured data, like the spans you mention.<p>[1]: <a href="https:&#x2F;&#x2F;parquet.apache.org&#x2F;docs&#x2F;file-format&#x2F;" rel="nofollow">https:&#x2F;&#x2F;parquet.apache.org&#x2F;docs&#x2F;file-format&#x2F;</a><p>[2]: <a href="https:&#x2F;&#x2F;orc.apache.org&#x2F;specification&#x2F;ORCv2&#x2F;#file-tail" rel="nofollow">https:&#x2F;&#x2F;orc.apache.org&#x2F;specification&#x2F;ORCv2&#x2F;#file-tail</a></div><br/><div id="41844396" class="c"><input type="checkbox" id="c-41844396" checked=""/><div class="controls bullet"><span class="by">danking00</span><span>|</span><a href="#41840459">root</a><span>|</span><a href="#41843259">parent</a><span>|</span><a href="#41844697">next</a><span>|</span><label class="collapse" for="c-41844396">[-]</label><label class="expand" for="c-41844396">[1 more]</label></div><br/><div class="children"><div class="content">Yeah we should be more clear in our description about how our footers differ from Parquet. Parquet is a bit more prescriptive; for example, it requires row groups which are not required by Vortex. If you have a column with huge values and another column of 8 bit ints, they can be paged separately, if you like.</div><br/></div></div></div></div><div id="41844697" class="c"><input type="checkbox" id="c-41844697" checked=""/><div class="controls bullet"><span class="by">yawnxyz</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41843259">prev</a><span>|</span><a href="#41842347">next</a><span>|</span><label class="collapse" for="c-41844697">[-]</label><label class="expand" for="c-41844697">[1 more]</label></div><br/><div class="children"><div class="content">I think it was in a blog post or a podcast (a16z with motherduck?) where they said Snowflake apparently largely solved this problem, but since it&#x27;s proprietary and locked away, most people won&#x27;t get a chance to use or implement it?<p>I have no idea since I&#x27;ve never had access to Snowflake...</div><br/></div></div><div id="41842347" class="c"><input type="checkbox" id="c-41842347" checked=""/><div class="controls bullet"><span class="by">jnordwick</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41844697">prev</a><span>|</span><a href="#41842038">next</a><span>|</span><label class="collapse" for="c-41842347">[-]</label><label class="expand" for="c-41842347">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s in the footer, then I&#x27;m pending to the columns out of the question it seems without moving the footer.</div><br/></div></div><div id="41842038" class="c"><input type="checkbox" id="c-41842038" checked=""/><div class="controls bullet"><span class="by">cle</span><span>|</span><a href="#41840459">parent</a><span>|</span><a href="#41842347">prev</a><span>|</span><a href="#41846329">next</a><span>|</span><label class="collapse" for="c-41842038">[-]</label><label class="expand" for="c-41842038">[3 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t this what the Arrow IPC File format does too? Is there something unique about this?</div><br/><div id="41842276" class="c"><input type="checkbox" id="c-41842276" checked=""/><div class="controls bullet"><span class="by">_willmanning</span><span>|</span><a href="#41840459">root</a><span>|</span><a href="#41842038">parent</a><span>|</span><a href="#41846329">next</a><span>|</span><label class="collapse" for="c-41842276">[-]</label><label class="expand" for="c-41842276">[2 more]</label></div><br/><div class="children"><div class="content">Compression! Vortex can easily be 10x smaller than the equivalent Arrow representation (and decompresses very quickly into Arrow)</div><br/><div id="41843374" class="c"><input type="checkbox" id="c-41843374" checked=""/><div class="controls bullet"><span class="by">cle</span><span>|</span><a href="#41840459">root</a><span>|</span><a href="#41842276">parent</a><span>|</span><a href="#41846329">next</a><span>|</span><label class="collapse" for="c-41843374">[-]</label><label class="expand" for="c-41843374">[1 more]</label></div><br/><div class="children"><div class="content">Nice!</div><br/></div></div></div></div></div></div></div></div><div id="41846329" class="c"><input type="checkbox" id="c-41846329" checked=""/><div class="controls bullet"><span class="by">xiaodai</span><span>|</span><a href="#41840459">prev</a><span>|</span><a href="#41840555">next</a><span>|</span><label class="collapse" for="c-41846329">[-]</label><label class="expand" for="c-41846329">[1 more]</label></div><br/><div class="children"><div class="content">There are a bunch of these including fst in the R ecosystem. JDF.jl in the julia ecosystem etc.</div><br/></div></div><div id="41840555" class="c"><input type="checkbox" id="c-41840555" checked=""/><div class="controls bullet"><span class="by">ericyd</span><span>|</span><a href="#41846329">prev</a><span>|</span><a href="#41840455">next</a><span>|</span><label class="collapse" for="c-41840555">[-]</label><label class="expand" for="c-41840555">[7 more]</label></div><br/><div class="children"><div class="content">Thank God this file format is written in Rust, otherwise I&#x27;d be extremely skeptical.</div><br/><div id="41841345" class="c"><input type="checkbox" id="c-41841345" checked=""/><div class="controls bullet"><span class="by">smartmic</span><span>|</span><a href="#41840555">parent</a><span>|</span><a href="#41842509">next</a><span>|</span><label class="collapse" for="c-41841345">[-]</label><label class="expand" for="c-41841345">[1 more]</label></div><br/><div class="children"><div class="content">It‘s funny how „written in Rust“ has become a running gag here on HN - but only if mentioned already in the title…</div><br/></div></div><div id="41842509" class="c"><input type="checkbox" id="c-41842509" checked=""/><div class="controls bullet"><span class="by">keybored</span><span>|</span><a href="#41840555">parent</a><span>|</span><a href="#41841345">prev</a><span>|</span><a href="#41840649">next</a><span>|</span><label class="collapse" for="c-41842509">[-]</label><label class="expand" for="c-41842509">[2 more]</label></div><br/><div class="children"><div class="content">Is this a pun or something?</div><br/><div id="41842707" class="c"><input type="checkbox" id="c-41842707" checked=""/><div class="controls bullet"><span class="by">ericyd</span><span>|</span><a href="#41840555">root</a><span>|</span><a href="#41842509">parent</a><span>|</span><a href="#41840649">next</a><span>|</span><label class="collapse" for="c-41842707">[-]</label><label class="expand" for="c-41842707">[1 more]</label></div><br/><div class="children"><div class="content">I was being sarcastic, yes. Also the title used to include &quot;written in Rust&quot;</div><br/></div></div></div></div><div id="41840649" class="c"><input type="checkbox" id="c-41840649" checked=""/><div class="controls bullet"><span class="by">neeh0</span><span>|</span><a href="#41840555">parent</a><span>|</span><a href="#41842509">prev</a><span>|</span><a href="#41840455">next</a><span>|</span><label class="collapse" for="c-41840649">[-]</label><label class="expand" for="c-41840649">[3 more]</label></div><br/><div class="children"><div class="content">It gave me a moment of pause why Rust is part of the equation, but I concluded I&#x27;m too dumb</div><br/><div id="41843262" class="c"><input type="checkbox" id="c-41843262" checked=""/><div class="controls bullet"><span class="by">aduffy</span><span>|</span><a href="#41840555">root</a><span>|</span><a href="#41840649">parent</a><span>|</span><a href="#41842842">next</a><span>|</span><label class="collapse" for="c-41843262">[-]</label><label class="expand" for="c-41843262">[1 more]</label></div><br/><div class="children"><div class="content">Buried under the memes&#x2F;vibes there is an actual reason this is important for data tools.<p>The previous generation of analytics&#x2F;&quot;Big Data&quot; projects (think Hadoop, Spark, Kafka, Elastic) were all built in the JVM. They were monolithic distributed systems clusters hosted on VMs or on-premise. They were servers with clients implemented in Java. It is effectively impossible to embed a Java library into anything non-Java, the best you can do is fork a JVM with a carefully maintained classpath and hit it over the network (c.f. PySpark). Kafka has externally maintained bindings that lag the official JVM client.<p>Parquet was built during this era, so naturally its reference implementation was written in Java. For many years, the only implementation of Parquet was in Java. Even when parquet-cpp and subsequent implementations began to pop up, the Parquet Java implementation was still the best maintained. Over time as the spec got updated and new features made their way into Parquet, different implementations had different support. Files written by parquet-cpp or parquet-rs could not be opened via Spark or Presto.<p>The newer generation of data analytics tooling is meant to be easily embedded, so that generally means a native language that can export shared objects with a C ABI that can be consumed by the FFI layer of different languages. That leaves you a few options, and of those Rust is arguably the best for reasons of tooling and ecosystem, though different projects make different choices. DuckDB for example is an extremely popular library with bindings in several languages and it was built in C++ long after Rust became in-vogue.<p>While Vortex doesn&#x27;t (yet) have a C API, we do have Python bindings that we expect to be the main way people use it.</div><br/></div></div><div id="41842842" class="c"><input type="checkbox" id="c-41842842" checked=""/><div class="controls bullet"><span class="by">beAbU</span><span>|</span><a href="#41840555">root</a><span>|</span><a href="#41840649">parent</a><span>|</span><a href="#41843262">prev</a><span>|</span><a href="#41840455">next</a><span>|</span><label class="collapse" for="c-41842842">[-]</label><label class="expand" for="c-41842842">[1 more]</label></div><br/><div class="children"><div class="content">For a while &quot;written in Rust&quot; was sort of a &quot;trust me, bro&quot; label. The hivemind asserted that something written in rust must be automatically good and safe, because rust is good and safe.<p>Thank god everyone wisened up. The tool maketh not the craftsman. These days the &quot;written in rust&quot; tag is met with knee jerk skepticism, as-if the hive mind over corrected.</div><br/></div></div></div></div></div></div><div id="41840455" class="c"><input type="checkbox" id="c-41840455" checked=""/><div class="controls bullet"><span class="by">gkapur</span><span>|</span><a href="#41840555">prev</a><span>|</span><a href="#41840818">next</a><span>|</span><label class="collapse" for="c-41840455">[-]</label><label class="expand" for="c-41840455">[1 more]</label></div><br/><div class="children"><div class="content">Not an expert in the space at all and it does seem like people are exploring new file and table formats so that is really cool!<p>How does this compare to Lance (<a href="https:&#x2F;&#x2F;lancedb.github.io&#x2F;lance&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lancedb.github.io&#x2F;lance&#x2F;</a>)?<p>What do you think the key applied use case for Vortex is?</div><br/></div></div><div id="41840818" class="c"><input type="checkbox" id="c-41840818" checked=""/><div class="controls bullet"><span class="by">jagged-chisel</span><span>|</span><a href="#41840455">prev</a><span>|</span><a href="#41844709">next</a><span>|</span><label class="collapse" for="c-41840818">[-]</label><label class="expand" for="c-41840818">[4 more]</label></div><br/><div class="children"><div class="content">“Vortex is a toolkit for working with compressed Apache Arrow arrays in-memory, on-disk, and over-the-wire.”<p>So it’s a toolkit written in Rust. It is not a file format.</div><br/><div id="41841079" class="c"><input type="checkbox" id="c-41841079" checked=""/><div class="controls bullet"><span class="by">_willmanning</span><span>|</span><a href="#41840818">parent</a><span>|</span><a href="#41844709">next</a><span>|</span><label class="collapse" for="c-41841079">[-]</label><label class="expand" for="c-41841079">[3 more]</label></div><br/><div class="children"><div class="content">Perhaps that verbiage is just confusing. &quot;On-disk&quot; sort of implies &quot;file format&quot; but could be more explicit.<p>That said, the immediate next line in the README perhaps clarifies a bit?<p>&quot;Vortex is designed to be to columnar file formats what Apache DataFusion is to query engines (or, analogously, what LLVM + Clang are to compilers): a highly extensible &amp; extremely fast framework for building a modern columnar file format, with a state-of-the-art, &quot;batteries included&quot; reference implementation.&quot;</div><br/><div id="41842846" class="c"><input type="checkbox" id="c-41842846" checked=""/><div class="controls bullet"><span class="by">jagged-chisel</span><span>|</span><a href="#41840818">root</a><span>|</span><a href="#41841079">parent</a><span>|</span><a href="#41844709">next</a><span>|</span><label class="collapse" for="c-41842846">[-]</label><label class="expand" for="c-41842846">[2 more]</label></div><br/><div class="children"><div class="content">“Vortex is […] a highly extensible &amp; extremely fast framework for building a modern columnar file format.”<p>It’s a framework for building file formats. This does not indicate that Vortex is, itself, a file format.</div><br/><div id="41843130" class="c"><input type="checkbox" id="c-41843130" checked=""/><div class="controls bullet"><span class="by">aduffy</span><span>|</span><a href="#41840818">root</a><span>|</span><a href="#41842846">parent</a><span>|</span><a href="#41844709">next</a><span>|</span><label class="collapse" for="c-41843130">[-]</label><label class="expand" for="c-41843130">[1 more]</label></div><br/><div class="children"><div class="content">Will and I actually work on Vortex :wave:<p>Perhaps we should clean up the wording in the intro, but yes there is in fact a file format!<p>We actually built the toolkit first, before building the file format. The interesting thing here is that we have a consistent in-memory and on-disk representation of compressed, typed arrays.<p>This is nice for a couple of reasons:<p>(a) It makes it really easy to test out new compression algorithms and compute functions. We just implement a new codec and it&#x27;s automatically available for the file format.<p>(b) We spend a lot of energy on efficient push down. Many compute functions such as slicing and cloning are zero-cost, and all compute operations can execute directly over compressed data.<p>Highly encourage you to checkout the vortex-serde crate in the repo for file format things, and the vortex-datafusion crate for some examples of integrating the format into a query engine!</div><br/></div></div></div></div></div></div></div></div><div id="41844709" class="c"><input type="checkbox" id="c-41844709" checked=""/><div class="controls bullet"><span class="by">Centigonal</span><span>|</span><a href="#41840818">prev</a><span>|</span><a href="#41843590">next</a><span>|</span><label class="collapse" for="c-41844709">[-]</label><label class="expand" for="c-41844709">[1 more]</label></div><br/><div class="children"><div class="content">Let me see if I understand this right.<p>Vortex is a file format. In their canonicalized, uncompressed form, vortex files are simply Apache Arrow IPC files with some of the bits and bobs moved around a bit (enabling transformation to&#x2F;from Arrow), plus some extra metadata about types, summary statistics, data layout, etc.<p>The Vortex spec supports fancy strategies for compressing columns, the ability to store summary statistics alongside data, and the ability to specify special compute operations for particular data columns. Vortex also specifies the schema of the data as metadata, separately from the physical layout of the data on disk. All Arrow arrays can be converted zero-copy into Vortex arrays, but not vice-versa.<p>Vortex also supports extensions in the form of new encodings and compression strategies. The idea here is that, as new ways of encoding data appear, they can be supported by Vortex without creating a whole new file format.<p>Vortex-serde is a serde library for Vortex files. In addition to classic serialization&#x2F;deserialization, it supports giving applications access to all those fancy compute and summary statistics features I mentioned above.<p>You say &quot;Vortex is a toolkit for working with compressed Apache Arrow arrays in-memory, on-disk, and over-the-wire,&quot; but that&#x27;s kind of like saying &quot;MKV is a toolkit for working with compressed AVI and WAV files.&quot; It sounds like Vortex is a flexible file spec that lets you:<p>1. Work with Arrow arrays on disk with options for compression.<p>2. Create files that model data that can&#x27;t be modeled in Arrow due to Arrow&#x27;s hard coupling between encoding and logical typing.<p>3. Utilize a bunch of funky and innovative new features not available in existing data file formats and probably only really interesting to people who are nerds about this (laypeople will be interested in the performance improvements, though).</div><br/></div></div><div id="41843590" class="c"><input type="checkbox" id="c-41843590" checked=""/><div class="controls bullet"><span class="by">kwillets</span><span>|</span><a href="#41844709">prev</a><span>|</span><a href="#41840789">next</a><span>|</span><label class="collapse" for="c-41843590">[-]</label><label class="expand" for="c-41843590">[2 more]</label></div><br/><div class="children"><div class="content">Does this fragment columns into rowgroups like Parquet, or is it more of a pure columnstore? IME a data warehouse works much better if each column isn&#x27;t split into thousands of fragments.</div><br/><div id="41844366" class="c"><input type="checkbox" id="c-41844366" checked=""/><div class="controls bullet"><span class="by">danking00</span><span>|</span><a href="#41843590">parent</a><span>|</span><a href="#41840789">next</a><span>|</span><label class="collapse" for="c-41844366">[-]</label><label class="expand" for="c-41844366">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, you and us are on the same page (heh). We don’t want the format to require row grouping. The file format has a layout schema written in a footer. A row group style layout is supported but not required. Specification of the layout will probably evolve, but currently the in-memory structure becomes the on-disk structure. So, if you have a ChunkedArray of StructArray of ChunkedArray you’ll get row groups and pages within them. If you had a StructArray of ChunkedArray you’ll just get per-column pages.<p>I’m working on the Python API now. I think we probably want the user to specify, on write, whether they want row groups or not and then we can enforce that as we write.</div><br/></div></div></div></div><div id="41840789" class="c"><input type="checkbox" id="c-41840789" checked=""/><div class="controls bullet"><span class="by">gazpacho</span><span>|</span><a href="#41843590">prev</a><span>|</span><a href="#41844184">next</a><span>|</span><label class="collapse" for="c-41840789">[-]</label><label class="expand" for="c-41840789">[3 more]</label></div><br/><div class="children"><div class="content">Very cool! Any plans to offer more direct integrations with DataFusion, e.g. a `VertexReaderFactory`, hooks for pushdowns, etc?</div><br/><div id="41840981" class="c"><input type="checkbox" id="c-41840981" checked=""/><div class="controls bullet"><span class="by">aduffy</span><span>|</span><a href="#41840789">parent</a><span>|</span><a href="#41844184">next</a><span>|</span><label class="collapse" for="c-41840981">[-]</label><label class="expand" for="c-41840981">[2 more]</label></div><br/><div class="children"><div class="content">We have a TableProvider for use with Datafusion, checkout this crate and its examples: <a href="https:&#x2F;&#x2F;github.com&#x2F;spiraldb&#x2F;vortex&#x2F;tree&#x2F;develop&#x2F;vortex-datafusion">https:&#x2F;&#x2F;github.com&#x2F;spiraldb&#x2F;vortex&#x2F;tree&#x2F;develop&#x2F;vortex-dataf...</a></div><br/><div id="41841086" class="c"><input type="checkbox" id="c-41841086" checked=""/><div class="controls bullet"><span class="by">gazpacho</span><span>|</span><a href="#41840789">root</a><span>|</span><a href="#41840981">parent</a><span>|</span><a href="#41844184">next</a><span>|</span><label class="collapse" for="c-41841086">[-]</label><label class="expand" for="c-41841086">[1 more]</label></div><br/><div class="children"><div class="content">Thanks!</div><br/></div></div></div></div></div></div><div id="41844184" class="c"><input type="checkbox" id="c-41844184" checked=""/><div class="controls bullet"><span class="by">Bnjoroge</span><span>|</span><a href="#41840789">prev</a><span>|</span><a href="#41840621">next</a><span>|</span><label class="collapse" for="c-41844184">[-]</label><label class="expand" for="c-41844184">[1 more]</label></div><br/><div class="children"><div class="content">how does this compare to lance?</div><br/></div></div><div id="41840621" class="c"><input type="checkbox" id="c-41840621" checked=""/><div class="controls bullet"><span class="by">Havoc</span><span>|</span><a href="#41844184">prev</a><span>|</span><label class="collapse" for="c-41840621">[-]</label><label class="expand" for="c-41840621">[6 more]</label></div><br/><div class="children"><div class="content">Can one edit it in place?<p>That’s the main thing currently irritating me about parquet</div><br/><div id="41841001" class="c"><input type="checkbox" id="c-41841001" checked=""/><div class="controls bullet"><span class="by">aduffy</span><span>|</span><a href="#41840621">parent</a><span>|</span><a href="#41845342">next</a><span>|</span><label class="collapse" for="c-41841001">[-]</label><label class="expand" for="c-41841001">[4 more]</label></div><br/><div class="children"><div class="content">You&#x27;re unlikely to find this with any analytic file format (including Vortex). The main reason is that OLAP systems generally assume an immutable distributed object&#x2F;block layer (S3, HDFS, ABFS, etc.).<p>It&#x27;s then generally up to a higher-level component called a table format to handle the idea of edits. See for example how Apache Iceberg handles deletes <a href="https:&#x2F;&#x2F;iceberg.apache.org&#x2F;spec&#x2F;#row-level-deletes" rel="nofollow">https:&#x2F;&#x2F;iceberg.apache.org&#x2F;spec&#x2F;#row-level-deletes</a></div><br/><div id="41841714" class="c"><input type="checkbox" id="c-41841714" checked=""/><div class="controls bullet"><span class="by">slotrans</span><span>|</span><a href="#41840621">root</a><span>|</span><a href="#41841001">parent</a><span>|</span><a href="#41845342">next</a><span>|</span><label class="collapse" for="c-41841714">[-]</label><label class="expand" for="c-41841714">[3 more]</label></div><br/><div class="children"><div class="content">This is true, and in principle a good thing, but in the time since Parquet and ORC were created GDPR and CCPA are things that have come to exist. Any format we build in that space, today, needs to support in-place record-level deletion.</div><br/><div id="41841878" class="c"><input type="checkbox" id="c-41841878" checked=""/><div class="controls bullet"><span class="by">aduffy</span><span>|</span><a href="#41840621">root</a><span>|</span><a href="#41841714">parent</a><span>|</span><a href="#41844443">next</a><span>|</span><label class="collapse" for="c-41841878">[-]</label><label class="expand" for="c-41841878">[1 more]</label></div><br/><div class="children"><div class="content">Yea so the thing you do for this is called &quot;compaction&quot;, where you effectively merge the original + edits&#x2F;deletes into a new immutable file. You then change your table metadata pointer to point at the new compacted file, and delete the old files from S3.<p>Due to the way S3 and the ilk are structured as globally replicated KV stores, you&#x27;re not likely to get in-place edits anytime soon, and until the cost structure incentivizes otherwise you&#x27;re going to continue to see data systems that preference immutable cloud storage.</div><br/></div></div><div id="41844443" class="c"><input type="checkbox" id="c-41844443" checked=""/><div class="controls bullet"><span class="by">FridgeSeal</span><span>|</span><a href="#41840621">root</a><span>|</span><a href="#41841714">parent</a><span>|</span><a href="#41841878">prev</a><span>|</span><a href="#41845342">next</a><span>|</span><label class="collapse" for="c-41844443">[-]</label><label class="expand" for="c-41844443">[1 more]</label></div><br/><div class="children"><div class="content">I mean, you can have it you’ve just got to be happy to bear the cost of rewriting the file every time you mutate a row.</div><br/></div></div></div></div></div></div><div id="41845342" class="c"><input type="checkbox" id="c-41845342" checked=""/><div class="controls bullet"><span class="by">runeblaze</span><span>|</span><a href="#41840621">parent</a><span>|</span><a href="#41841001">prev</a><span>|</span><label class="collapse" for="c-41845342">[-]</label><label class="expand" for="c-41845342">[1 more]</label></div><br/><div class="children"><div class="content">Did not read too deep into the original post, but if you use arrow you <i>can</i> (not sure if one ever should) do random lookups into the storage buffer and wipe out bytes + put tombstones, at least if the column is encoded &quot;naively&quot;.<p>Of course if your arrow file is in some object store how you delete random bytes over that is unclear.</div><br/></div></div></div></div></div></div></div></div></div></body></html>