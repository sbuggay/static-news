<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1688288449529" as="style"/><link rel="stylesheet" href="styles.css?v=1688288449529"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/jwilk/git-landmine">Git-landmine – Create local malicious Git repo</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>pabs3</span> | <span>16 comments</span></div><br/><div><div id="36557008" class="c"><input type="checkbox" id="c-36557008" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><label class="collapse" for="c-36557008">[-]</label><label class="expand" for="c-36557008">[15 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not sure I understand how this is malicious. There is quite a bit of configuration of the client, which usually requires arbitrary execution capabilities anyways. What&#x27;s the actual exploit here?</div><br/><div id="36558002" class="c"><input type="checkbox" id="c-36558002" checked=""/><div class="controls bullet"><span class="by">chlorion</span><span>|</span><a href="#36557008">parent</a><span>|</span><a href="#36557056">next</a><span>|</span><label class="collapse" for="c-36558002">[-]</label><label class="expand" for="c-36558002">[2 more]</label></div><br/><div class="children"><div class="content">I think many people don&#x27;t realize that the git integrated shell prompts for example are not safe to use in untrusted git repos.<p>Lots of editors will also query git repo information for displaying information to the user, and may do this completely automatically.<p>If you &quot;git clone&quot; the repo, git will not clone hooks from my understanding, so the primary issue is unpacking a tarball with a git repo inside of it and then trying to do something with the repo.</div><br/><div id="36558692" class="c"><input type="checkbox" id="c-36558692" checked=""/><div class="controls bullet"><span class="by">abathur</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36558002">parent</a><span>|</span><a href="#36557056">next</a><span>|</span><label class="collapse" for="c-36558692">[-]</label><label class="expand" for="c-36558692">[1 more]</label></div><br/><div class="children"><div class="content">If your toolchain does something silly like eval some output from git, cloning and then triggering that interaction (probably cding in) could be enough.<p>I made a little test repo for this a while back <a href="https:&#x2F;&#x2F;github.com&#x2F;abathur&#x2F;LittleGaryGitles">https:&#x2F;&#x2F;github.com&#x2F;abathur&#x2F;LittleGaryGitles</a> :)</div><br/></div></div></div></div><div id="36557056" class="c"><input type="checkbox" id="c-36557056" checked=""/><div class="controls bullet"><span class="by">upon_drumhead</span><span>|</span><a href="#36557008">parent</a><span>|</span><a href="#36558002">prev</a><span>|</span><a href="#36557101">next</a><span>|</span><label class="collapse" for="c-36557056">[-]</label><label class="expand" for="c-36557056">[1 more]</label></div><br/><div class="children"><div class="content">It appears to set the pager setting for the repo to `cowsay &quot;pwned&quot;`, which appears to be able to be duplicated via setting an environment variable `GIT_PAGER=&quot;cowsay &#x27;pwned&#x27;&quot;` or setting it via `git config core.pager &quot;cowsay &#x27;pwned&#x27;&quot;`<p>I don&#x27;t see any actual exploit here.</div><br/></div></div><div id="36557101" class="c"><input type="checkbox" id="c-36557101" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#36557008">parent</a><span>|</span><a href="#36557056">prev</a><span>|</span><a href="#36557141">next</a><span>|</span><label class="collapse" for="c-36557101">[-]</label><label class="expand" for="c-36557101">[3 more]</label></div><br/><div class="children"><div class="content">You put the directory somewhere (eg. usb drive) and hope someone enters the directory and executes a git command.</div><br/><div id="36558214" class="c"><input type="checkbox" id="c-36558214" checked=""/><div class="controls bullet"><span class="by">naruhodo</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557101">parent</a><span>|</span><a href="#36557141">next</a><span>|</span><label class="collapse" for="c-36558214">[-]</label><label class="expand" for="c-36558214">[2 more]</label></div><br/><div class="children"><div class="content">To elaborate on your comment, on UNIX systems, you don&#x27;t put &quot;.&quot; in $PATH because someone might put a malicious executable named `ls` or `cd`, in a directory. It doesn&#x27;t have root privileges, but it runs as your user account and can get some kind of persistence by hooking `~&#x2F;.bashrc`. And perhaps by wrapping `sudo` it can eventually get root privileges.</div><br/><div id="36559618" class="c"><input type="checkbox" id="c-36559618" checked=""/><div class="controls bullet"><span class="by">jabbany</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36558214">parent</a><span>|</span><a href="#36557141">next</a><span>|</span><label class="collapse" for="c-36559618">[-]</label><label class="expand" for="c-36559618">[1 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t work if . is at the end of $PATH though? Since the real ones would take precedence due to how executable searching works...?</div><br/></div></div></div></div></div></div><div id="36557141" class="c"><input type="checkbox" id="c-36557141" checked=""/><div class="controls bullet"><span class="by">armada651</span><span>|</span><a href="#36557008">parent</a><span>|</span><a href="#36557101">prev</a><span>|</span><label class="collapse" for="c-36557141">[-]</label><label class="expand" for="c-36557141">[8 more]</label></div><br/><div class="children"><div class="content">There are quite a number of people not familiar with git who are unaware of the security risk of cloning a repo. My guess is this repo is trying to spread awareness.</div><br/><div id="36557177" class="c"><input type="checkbox" id="c-36557177" checked=""/><div class="controls bullet"><span class="by">meatmanek</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557141">parent</a><span>|</span><a href="#36559443">next</a><span>|</span><label class="collapse" for="c-36557177">[-]</label><label class="expand" for="c-36557177">[5 more]</label></div><br/><div class="children"><div class="content">I think the reason this is a script (`git-landmine`) and not just a repo is that git repos don&#x27;t include this sort of configuration when you clone them, for exactly this reason.<p>It&#x27;s inconvenient that you don&#x27;t get e.g. pre-commit hooks installed when you clone a repo, but it also makes total sense from a security perspective.</div><br/><div id="36557343" class="c"><input type="checkbox" id="c-36557343" checked=""/><div class="controls bullet"><span class="by">xyzzy_plugh</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557177">parent</a><span>|</span><a href="#36558747">next</a><span>|</span><label class="collapse" for="c-36557343">[-]</label><label class="expand" for="c-36557343">[3 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not inconvenient -- it&#x27;s great. I would never run a pre-commit hook someone else wrote. I&#x27;m not a child, I don&#x27;t need my hand held. If I want to create a commit object, create one.<p>I don&#x27;t understand folks who want their tools to fight them.</div><br/><div id="36557763" class="c"><input type="checkbox" id="c-36557763" checked=""/><div class="controls bullet"><span class="by">shortcake27</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557343">parent</a><span>|</span><a href="#36557674">next</a><span>|</span><label class="collapse" for="c-36557763">[-]</label><label class="expand" for="c-36557763">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I&#x27;m not a child, I don&#x27;t need my hand held … I don&#x27;t understand folks who want their tools to fight them.<p>The thing about teams is that they’re made up of people with different needs, and the tooling works to benefit the entire team not just one specific opinionated individual.<p>Formatting and linting is frequently done in precommit hooks. This avoids a much longer feedback loop of CI failures for trivial tasks that add at most a couple of seconds to a commit (usually less).<p>If you don’t like it, you can simply eject out of it using the no-verify flag instead of complaining about having to fight tooling that benefits everyone else.</div><br/></div></div><div id="36557674" class="c"><input type="checkbox" id="c-36557674" checked=""/><div class="controls bullet"><span class="by">thfuran</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557343">parent</a><span>|</span><a href="#36557763">prev</a><span>|</span><a href="#36558747">next</a><span>|</span><label class="collapse" for="c-36557674">[-]</label><label class="expand" for="c-36557674">[1 more]</label></div><br/><div class="children"><div class="content">Would you ever run a kernel written by someone else?</div><br/></div></div></div></div><div id="36558747" class="c"><input type="checkbox" id="c-36558747" checked=""/><div class="controls bullet"><span class="by">armada651</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557177">parent</a><span>|</span><a href="#36557343">prev</a><span>|</span><a href="#36559443">next</a><span>|</span><label class="collapse" for="c-36558747">[-]</label><label class="expand" for="c-36558747">[1 more]</label></div><br/><div class="children"><div class="content">Indeed you&#x27;re correct the risk is not when cloning a repo but when copying an existing one.</div><br/></div></div></div></div><div id="36559443" class="c"><input type="checkbox" id="c-36559443" checked=""/><div class="controls bullet"><span class="by">z3t4</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36557141">parent</a><span>|</span><a href="#36557177">prev</a><span>|</span><label class="collapse" for="c-36559443">[-]</label><label class="expand" for="c-36559443">[2 more]</label></div><br/><div class="children"><div class="content">What is the worse case scenario from running: sudo git clone <a href="https:&#x2F;&#x2F;bad.com&#x2F;xyz" rel="nofollow noreferrer">https:&#x2F;&#x2F;bad.com&#x2F;xyz</a> &amp;&amp; sudo cd xyz &amp;&amp; sudo git pull</div><br/><div id="36559573" class="c"><input type="checkbox" id="c-36559573" checked=""/><div class="controls bullet"><span class="by">jwilk</span><span>|</span><a href="#36557008">root</a><span>|</span><a href="#36559443">parent</a><span>|</span><label class="collapse" for="c-36559573">[-]</label><label class="expand" for="c-36559573">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>  sudo: cd: command not found
  sudo: &quot;cd&quot; is a shell built-in command, it cannot be run directly.
  sudo: the -s option may be used to run a privileged shell.
  sudo: the -D option may be used to run a command in a specific directory.</code></pre></div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>