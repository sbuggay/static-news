<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1691830860179" as="style"/><link rel="stylesheet" href="styles.css?v=1691830860179"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/lllyasviel/Fooocus">Fooocus: OSS for image generation by ControlNet author</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>dvrp</span> | <span>32 comments</span></div><br/><div><div id="37098310" class="c"><input type="checkbox" id="c-37098310" checked=""/><div class="controls bullet"><span class="by">politelemon</span><span>|</span><a href="#37096888">next</a><span>|</span><label class="collapse" for="c-37098310">[-]</label><label class="expand" for="c-37098310">[1 more]</label></div><br/><div class="children"><div class="content">For those who don&#x27;t know, ControlNet is often used in conjunction with Stable Diffusion. It lets you add extra conditions to guide what is being generated. There are extensions for Automatic1111&#x27;s stable diffusion webui that can make use of ControlNet. Some examples I&#x27;ve seen are copying the pose of a person&#x2F;animal in an image and outputting a different person with the same pose (and extending to videos). Also taking line art drawings and filling it in with style.<p><a href="https:&#x2F;&#x2F;stable-diffusion-art.com&#x2F;controlnet&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;stable-diffusion-art.com&#x2F;controlnet&#x2F;</a></div><br/></div></div><div id="37096888" class="c"><input type="checkbox" id="c-37096888" checked=""/><div class="controls bullet"><span class="by">erwannmillon</span><span>|</span><a href="#37098310">prev</a><span>|</span><a href="#37097213">next</a><span>|</span><label class="collapse" for="c-37096888">[-]</label><label class="expand" for="c-37096888">[6 more]</label></div><br/><div class="children"><div class="content">&quot;Native refiner swap inside one single k-sampler. The advantage is that now the refiner model can reuse the base model&#x27;s momentum (or ODE&#x27;s history parameters) collected from k-sampling to achieve more coherent sampling. In Automatic1111&#x27;s high-res fix and ComfyUI&#x27;s node system, the base model and refiner use two independent k-samplers, which means the momentum is largely wasted, and the sampling continuity is broken. Fooocus uses its own advanced k-diffusion sampling that ensures seamless, native, and continuous swap in a refiner setup.&quot;<p>This is so interesting and seems obvious in retrospect, but super impressive! The code is simple too, going to hack around with this over the weekend :)</div><br/><div id="37097357" class="c"><input type="checkbox" id="c-37097357" checked=""/><div class="controls bullet"><span class="by">Klaster_1</span><span>|</span><a href="#37096888">parent</a><span>|</span><a href="#37097021">next</a><span>|</span><label class="collapse" for="c-37097357">[-]</label><label class="expand" for="c-37097357">[3 more]</label></div><br/><div class="children"><div class="content">As a frontend developer, this reads to me as technobabble you&#x27;d find in entertainment media. In general, I learn about things not directly related to my sphere of interests by osmosis, but this is on another level. Reminds me of the time when I started my computing journey. I wonder if I&#x27;ll be able to understand this eventually just by reading a relevant comment or blog here and there.</div><br/><div id="37097480" class="c"><input type="checkbox" id="c-37097480" checked=""/><div class="controls bullet"><span class="by">orbital-decay</span><span>|</span><a href="#37096888">root</a><span>|</span><a href="#37097357">parent</a><span>|</span><a href="#37097576">next</a><span>|</span><label class="collapse" for="c-37097480">[-]</label><label class="expand" for="c-37097480">[1 more]</label></div><br/><div class="children"><div class="content">The image is produced by sampling the model, which is the most computationally intensive process in the pipeline. Stable Diffusion XL consists of several parts which have to be sampled separately, losing the context in the process. This samples both parts in a way that no context is lost, improving the result.</div><br/></div></div><div id="37097576" class="c"><input type="checkbox" id="c-37097576" checked=""/><div class="controls bullet"><span class="by">dvrp</span><span>|</span><a href="#37096888">root</a><span>|</span><a href="#37097357">parent</a><span>|</span><a href="#37097480">prev</a><span>|</span><a href="#37097021">next</a><span>|</span><label class="collapse" for="c-37097576">[-]</label><label class="expand" for="c-37097576">[1 more]</label></div><br/><div class="children"><div class="content">apply to work at KREA!<p>we’re looking for frontend engineers—especially if they have gamedev experience</div><br/></div></div></div></div><div id="37097021" class="c"><input type="checkbox" id="c-37097021" checked=""/><div class="controls bullet"><span class="by">liuliu</span><span>|</span><a href="#37096888">parent</a><span>|</span><a href="#37097357">prev</a><span>|</span><a href="#37097213">next</a><span>|</span><label class="collapse" for="c-37097021">[-]</label><label class="expand" for="c-37097021">[2 more]</label></div><br/><div class="children"><div class="content">Definitely interesting. It seems that I accidentally implemented that in Draw Things.</div><br/><div id="37097143" class="c"><input type="checkbox" id="c-37097143" checked=""/><div class="controls bullet"><span class="by">davely</span><span>|</span><a href="#37096888">root</a><span>|</span><a href="#37097021">parent</a><span>|</span><a href="#37097213">next</a><span>|</span><label class="collapse" for="c-37097143">[-]</label><label class="expand" for="c-37097143">[1 more]</label></div><br/><div class="children"><div class="content">Nice! I love that app. It’s wild that I can generate images natively on my iPhone.<p>I’ve used some of your ideas for inspiration for ArtBot (mobile friendly web front-end for the AI Horde distributed Stable Diffusion project).<p>I love seeing updates to it. Keep it up! (SDXL is so much fun)</div><br/></div></div></div></div></div></div><div id="37097213" class="c"><input type="checkbox" id="c-37097213" checked=""/><div class="controls bullet"><span class="by">airgapstopgap</span><span>|</span><a href="#37096888">prev</a><span>|</span><a href="#37098087">next</a><span>|</span><label class="collapse" for="c-37097213">[-]</label><label class="expand" for="c-37097213">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Linux and Mac<p>&gt; Coming soon ...<p>Ah well. Hopefully it is soon. Also, on behalf of all Apple Silicon Mac users, would be nice if the author looked into implementing Metal FlashAttention [1].<p>1. <a href="https:&#x2F;&#x2F;github.com&#x2F;philipturner&#x2F;metal-flash-attention">https:&#x2F;&#x2F;github.com&#x2F;philipturner&#x2F;metal-flash-attention</a></div><br/><div id="37098258" class="c"><input type="checkbox" id="c-37098258" checked=""/><div class="controls bullet"><span class="by">sunpazed</span><span>|</span><a href="#37097213">parent</a><span>|</span><a href="#37098087">next</a><span>|</span><label class="collapse" for="c-37098258">[-]</label><label class="expand" for="c-37098258">[1 more]</label></div><br/><div class="children"><div class="content">I can get this running on my M1 Mac Pro (CPU mode) with a few tweaks in the cv2win32.py file. I&#x27;ll submit a change request.</div><br/></div></div></div></div><div id="37098087" class="c"><input type="checkbox" id="c-37098087" checked=""/><div class="controls bullet"><span class="by">kashunstva</span><span>|</span><a href="#37097213">prev</a><span>|</span><a href="#37097868">next</a><span>|</span><label class="collapse" for="c-37098087">[-]</label><label class="expand" for="c-37098087">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Learned from Midjourney, the manual tweaking is not needed, and users only need to focus on the prompts and images<p>Except prompt-based tweaking doesn’t work very well in MJ; certainly not as well as manually-directed in-painting and out-painting. It’s virtually impossible in MJ to hold one part of the image constant while adding to&#x2F;modifying the remainder.</div><br/></div></div><div id="37097868" class="c"><input type="checkbox" id="c-37097868" checked=""/><div class="controls bullet"><span class="by">captn3m0</span><span>|</span><a href="#37098087">prev</a><span>|</span><a href="#37097310">next</a><span>|</span><label class="collapse" for="c-37097868">[-]</label><label class="expand" for="c-37097868">[4 more]</label></div><br/><div class="children"><div class="content">Are there ways to run such apps with a remote GPU over network? I want to run the UI on my laptop, but use my homeserver GPU from the local network.<p>Anything better than X forwarding?</div><br/><div id="37097904" class="c"><input type="checkbox" id="c-37097904" checked=""/><div class="controls bullet"><span class="by">freeone3000</span><span>|</span><a href="#37097868">parent</a><span>|</span><a href="#37097310">next</a><span>|</span><label class="collapse" for="c-37097904">[-]</label><label class="expand" for="c-37097904">[3 more]</label></div><br/><div class="children"><div class="content">This project returns results over HTTP. You get what you want by running the server binary on the server, then access it with your web browser.</div><br/><div id="37098301" class="c"><input type="checkbox" id="c-37098301" checked=""/><div class="controls bullet"><span class="by">boneitis</span><span>|</span><a href="#37097868">root</a><span>|</span><a href="#37097904">parent</a><span>|</span><a href="#37098004">next</a><span>|</span><label class="collapse" for="c-37098301">[-]</label><label class="expand" for="c-37098301">[1 more]</label></div><br/><div class="children"><div class="content">To flesh out this response with a common way to do this, the free tier of ngrok will likely help someone accomplish this, by running it on the server to get a routable endpoint to your ssh port (wouldn&#x27;t hurt to further lock it down with any firewalling, if that&#x27;s available ngrok-side.. haven&#x27;t used ngrok in a while).<p>For example, to run the Stable Diffusion webui (which defaults to port 7860), it would be something not too far off from:<p>$ ssh -p1234 -L7860:127.0.0.1:7860 assigned.dns.at.startup.ngrok.io<p>(IIRC ngrok free-tier will allocate you a random port on the public side every time you start the service)<p>Then, can just browse localhost:7860 from the remote field machine.<p>I got bit by the AI bug a few days ago, and I already rent some lightsail instances, one of which has a static IP reserved and one of my domain names pointing to it. So, I set up something a little more convoluted and perhaps unnecessarily complex, turning that lightsail VM into a jumpbox&#x2F;bastion host. Anywho:<p>AutoSSH from server to my lightsail instance, with two remote port forwards (not local port forwards): SSH and SD webui. Then, connect from the field machine anywhere in the world to the jumpbox with matching local port forwards.<p>Then, make a second ssh connection to the ssh local port forward back to the other end server running SD, after which you can finally fire up localhost:7860 in the web browser.</div><br/></div></div><div id="37098004" class="c"><input type="checkbox" id="c-37098004" checked=""/><div class="controls bullet"><span class="by">captn3m0</span><span>|</span><a href="#37097868">root</a><span>|</span><a href="#37097904">parent</a><span>|</span><a href="#37098301">prev</a><span>|</span><a href="#37097310">next</a><span>|</span><label class="collapse" for="c-37098004">[-]</label><label class="expand" for="c-37098004">[1 more]</label></div><br/><div class="children"><div class="content">Ooh, perfect.  Now just have to wait for a Linux&#x2F;docker release.</div><br/></div></div></div></div></div></div><div id="37097310" class="c"><input type="checkbox" id="c-37097310" checked=""/><div class="controls bullet"><span class="by">AbraKdabra</span><span>|</span><a href="#37097868">prev</a><span>|</span><a href="#37097585">next</a><span>|</span><label class="collapse" for="c-37097310">[-]</label><label class="expand" for="c-37097310">[2 more]</label></div><br/><div class="children"><div class="content">Those commits are something else.</div><br/><div id="37097706" class="c"><input type="checkbox" id="c-37097706" checked=""/><div class="controls bullet"><span class="by">dvrp</span><span>|</span><a href="#37097310">parent</a><span>|</span><a href="#37097585">next</a><span>|</span><label class="collapse" for="c-37097706">[-]</label><label class="expand" for="c-37097706">[1 more]</label></div><br/><div class="children"><div class="content">i</div><br/></div></div></div></div><div id="37097585" class="c"><input type="checkbox" id="c-37097585" checked=""/><div class="controls bullet"><span class="by">Hard_Space</span><span>|</span><a href="#37097310">prev</a><span>|</span><a href="#37097131">next</a><span>|</span><label class="collapse" for="c-37097585">[-]</label><label class="expand" for="c-37097585">[3 more]</label></div><br/><div class="children"><div class="content">Interesting, and I look forward to using it, but I wish the distribution had kept the folder-name conventions of AUTOMATIC1111, so that we could more easily have used symbolic links for folders of LoRAs and checkpoints etc. that we&#x27;d rather not duplicate.</div><br/><div id="37097596" class="c"><input type="checkbox" id="c-37097596" checked=""/><div class="controls bullet"><span class="by">dvrp</span><span>|</span><a href="#37097585">parent</a><span>|</span><a href="#37097131">next</a><span>|</span><label class="collapse" for="c-37097596">[-]</label><label class="expand" for="c-37097596">[2 more]</label></div><br/><div class="children"><div class="content">i’m sure there are ways around it no?</div><br/><div id="37097695" class="c"><input type="checkbox" id="c-37097695" checked=""/><div class="controls bullet"><span class="by">Hard_Space</span><span>|</span><a href="#37097585">root</a><span>|</span><a href="#37097596">parent</a><span>|</span><a href="#37097131">next</a><span>|</span><label class="collapse" for="c-37097695">[-]</label><label class="expand" for="c-37097695">[1 more]</label></div><br/><div class="children"><div class="content">Still installing. If it can read nested folders, yes.</div><br/></div></div></div></div></div></div><div id="37097131" class="c"><input type="checkbox" id="c-37097131" checked=""/><div class="controls bullet"><span class="by">yellow_postit</span><span>|</span><a href="#37097585">prev</a><span>|</span><a href="#37097059">next</a><span>|</span><label class="collapse" for="c-37097131">[-]</label><label class="expand" for="c-37097131">[1 more]</label></div><br/><div class="children"><div class="content">definitely the smoothest install process and relatively snappy on my local windows machine that I&#x27;ve come across. 
I do hope to see some ControlNet integrations as that&#x27;s become a key part of my workflow for exploring new images.</div><br/></div></div><div id="37097059" class="c"><input type="checkbox" id="c-37097059" checked=""/><div class="controls bullet"><span class="by">GaggiX</span><span>|</span><a href="#37097131">prev</a><span>|</span><a href="#37097211">next</a><span>|</span><label class="collapse" for="c-37097059">[-]</label><label class="expand" for="c-37097059">[7 more]</label></div><br/><div class="children"><div class="content">The names given to the commits are... peculiar.</div><br/><div id="37097356" class="c"><input type="checkbox" id="c-37097356" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#37097059">parent</a><span>|</span><a href="#37097374">next</a><span>|</span><label class="collapse" for="c-37097356">[-]</label><label class="expand" for="c-37097356">[4 more]</label></div><br/><div class="children"><div class="content">Tbh I’m (loosely) following commit message best practices in all of my projects out of irrational fear of being viewed as unprofessional. But <i>never</i> needed that effing prose in my workflow. Maybe a keyword from time to time. I’m using code, not messages to navigate history, and in a rare occasion. If all my messages turned into “i” I’d lose nothing, because all rationales and essentials are in code comments. I’d better seen dates (and related grouping) in a log by default and looked for a commit by some grepping patch contents rather than messages.</div><br/><div id="37098233" class="c"><input type="checkbox" id="c-37098233" checked=""/><div class="controls bullet"><span class="by">regularfry</span><span>|</span><a href="#37097059">root</a><span>|</span><a href="#37097356">parent</a><span>|</span><a href="#37097406">next</a><span>|</span><label class="collapse" for="c-37098233">[-]</label><label class="expand" for="c-37098233">[1 more]</label></div><br/><div class="children"><div class="content">On several occasions I&#x27;ve found that act of composing the commit message brings something to the front of my mind that I really ought to get into the patch but haven&#x27;t done yet.<p>Otherwise the main use case I have for a commit message is that it fills out the GitHub PR for me with something useful.</div><br/></div></div><div id="37097406" class="c"><input type="checkbox" id="c-37097406" checked=""/><div class="controls bullet"><span class="by">catiopatio</span><span>|</span><a href="#37097059">root</a><span>|</span><a href="#37097356">parent</a><span>|</span><a href="#37098233">prev</a><span>|</span><a href="#37097374">next</a><span>|</span><label class="collapse" for="c-37097406">[-]</label><label class="expand" for="c-37097406">[2 more]</label></div><br/><div class="children"><div class="content">Commit comments are how you find code diffs.<p>Focus on what&#x2F;why in your commit messages.<p>If you can’t articulate that in your commit messages, I can almost guarantee you’re thinking deeply enough about your code changes.</div><br/><div id="37097611" class="c"><input type="checkbox" id="c-37097611" checked=""/><div class="controls bullet"><span class="by">wruza</span><span>|</span><a href="#37097059">root</a><span>|</span><a href="#37097406">parent</a><span>|</span><a href="#37097374">next</a><span>|</span><label class="collapse" for="c-37097611">[-]</label><label class="expand" for="c-37097611">[1 more]</label></div><br/><div class="children"><div class="content">I appreciate advices, but I believe this one is not on point I expressed, as it only reiterates on a premise that I follow already but find mostly useless irl.</div><br/></div></div></div></div></div></div><div id="37097374" class="c"><input type="checkbox" id="c-37097374" checked=""/><div class="controls bullet"><span class="by">netghost</span><span>|</span><a href="#37097059">parent</a><span>|</span><a href="#37097356">prev</a><span>|</span><a href="#37097241">next</a><span>|</span><label class="collapse" for="c-37097374">[-]</label><label class="expand" for="c-37097374">[1 more]</label></div><br/><div class="children"><div class="content">SCM as Save Button.</div><br/></div></div><div id="37097241" class="c"><input type="checkbox" id="c-37097241" checked=""/><div class="controls bullet"><span class="by">peddling-brink</span><span>|</span><a href="#37097059">parent</a><span>|</span><a href="#37097374">prev</a><span>|</span><a href="#37097211">next</a><span>|</span><label class="collapse" for="c-37097241">[-]</label><label class="expand" for="c-37097241">[1 more]</label></div><br/><div class="children"><div class="content">i</div><br/></div></div></div></div><div id="37097211" class="c"><input type="checkbox" id="c-37097211" checked=""/><div class="controls bullet"><span class="by">natch</span><span>|</span><a href="#37097059">prev</a><span>|</span><a href="#37097568">next</a><span>|</span><label class="collapse" for="c-37097211">[-]</label><label class="expand" for="c-37097211">[2 more]</label></div><br/><div class="children"><div class="content">Great steps. I would still like to see something offline that can blend two disparate images into one generated scene, like artbreeder has.</div><br/><div id="37097635" class="c"><input type="checkbox" id="c-37097635" checked=""/><div class="controls bullet"><span class="by">dvrp</span><span>|</span><a href="#37097211">parent</a><span>|</span><a href="#37097568">next</a><span>|</span><label class="collapse" for="c-37097635">[-]</label><label class="expand" for="c-37097635">[1 more]</label></div><br/><div class="children"><div class="content">i know! it’s hard to make offline because of gpu requirements</div><br/></div></div></div></div><div id="37097568" class="c"><input type="checkbox" id="c-37097568" checked=""/><div class="controls bullet"><span class="by">bufferoverflow</span><span>|</span><a href="#37097211">prev</a><span>|</span><a href="#37096977">next</a><span>|</span><label class="collapse" for="c-37097568">[-]</label><label class="expand" for="c-37097568">[1 more]</label></div><br/><div class="children"><div class="content">The sample image on the github page doesn&#x27;t look great. Major problems with the eyes, something both SD and MJ have solved, for the most part.</div><br/></div></div><div id="37096977" class="c"><input type="checkbox" id="c-37096977" checked=""/><div class="controls bullet"><span class="by">brucethemoose2</span><span>|</span><a href="#37097568">prev</a><span>|</span><label class="collapse" for="c-37096977">[-]</label><label class="expand" for="c-37096977">[1 more]</label></div><br/><div class="children"><div class="content">I wonder if some of this can be ported to HF diffusers.<p>Lots of the changes just... make sense.</div><br/></div></div></div></div></div></div></div></body></html>